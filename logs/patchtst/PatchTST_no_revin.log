
=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2550365
	speed: 0.1512s/iter; left time: 3370.9083s
	iters: 200, epoch: 1 | loss: 0.2457977
	speed: 0.1083s/iter; left time: 2403.9254s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.95s
Steps: 224 | Train Loss: 0.2636525 Vali Loss: 0.2223240 Test Loss: 0.2203597
Validation loss decreased (inf --> 0.222324).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1520796
	speed: 0.2477s/iter; left time: 5468.0461s
	iters: 200, epoch: 2 | loss: 0.1205256
	speed: 0.1078s/iter; left time: 2370.0367s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.72s
Steps: 224 | Train Loss: 0.1539750 Vali Loss: 0.1156458 Test Loss: 0.1176853
Validation loss decreased (0.222324 --> 0.115646).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1005996
	speed: 0.2421s/iter; left time: 5291.0575s
	iters: 200, epoch: 3 | loss: 0.0970483
	speed: 0.1083s/iter; left time: 2355.3988s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.70s
Steps: 224 | Train Loss: 0.1041881 Vali Loss: 0.1089347 Test Loss: 0.1104642
Validation loss decreased (0.115646 --> 0.108935).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0982103
	speed: 0.2528s/iter; left time: 5466.9704s
	iters: 200, epoch: 4 | loss: 0.0984537
	speed: 0.1091s/iter; left time: 2349.5664s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.34s
Steps: 224 | Train Loss: 0.0939128 Vali Loss: 0.0990459 Test Loss: 0.1011217
Validation loss decreased (0.108935 --> 0.099046).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0911076
	speed: 0.2471s/iter; left time: 5288.4864s
	iters: 200, epoch: 5 | loss: 0.0862528
	speed: 0.1062s/iter; left time: 2263.2516s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.77s
Steps: 224 | Train Loss: 0.0887181 Vali Loss: 0.0971453 Test Loss: 0.0990388
Validation loss decreased (0.099046 --> 0.097145).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0950661
	speed: 0.2500s/iter; left time: 5295.2987s
	iters: 200, epoch: 6 | loss: 0.0842719
	speed: 0.1085s/iter; left time: 2288.1397s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.92s
Steps: 224 | Train Loss: 0.0861451 Vali Loss: 0.0956699 Test Loss: 0.0969987
Validation loss decreased (0.097145 --> 0.095670).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0839096
	speed: 0.2425s/iter; left time: 5081.4807s
	iters: 200, epoch: 7 | loss: 0.0866961
	speed: 0.1074s/iter; left time: 2239.1314s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.52s
Steps: 224 | Train Loss: 0.0841479 Vali Loss: 0.0947514 Test Loss: 0.0958692
Validation loss decreased (0.095670 --> 0.094751).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0829691
	speed: 0.2404s/iter; left time: 4984.6904s
	iters: 200, epoch: 8 | loss: 0.0823774
	speed: 0.1078s/iter; left time: 2225.1905s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:24.47s
Steps: 224 | Train Loss: 0.0832175 Vali Loss: 0.0942965 Test Loss: 0.0952594
Validation loss decreased (0.094751 --> 0.094296).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0858870
	speed: 0.2479s/iter; left time: 5083.8341s
	iters: 200, epoch: 9 | loss: 0.0867997
	speed: 0.1092s/iter; left time: 2229.4529s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.12s
Steps: 224 | Train Loss: 0.0821404 Vali Loss: 0.0937571 Test Loss: 0.0946131
Validation loss decreased (0.094296 --> 0.093757).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0825628
	speed: 0.2441s/iter; left time: 4951.4857s
	iters: 200, epoch: 10 | loss: 0.0792029
	speed: 0.1090s/iter; left time: 2200.0412s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:24.52s
Steps: 224 | Train Loss: 0.0810580 Vali Loss: 0.0932953 Test Loss: 0.0947511
Validation loss decreased (0.093757 --> 0.093295).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0754763
	speed: 0.2424s/iter; left time: 4862.7232s
	iters: 200, epoch: 11 | loss: 0.0797897
	speed: 0.1084s/iter; left time: 2164.5927s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:24.63s
Steps: 224 | Train Loss: 0.0806771 Vali Loss: 0.0926870 Test Loss: 0.0941004
Validation loss decreased (0.093295 --> 0.092687).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0781097
	speed: 0.2466s/iter; left time: 4891.8704s
	iters: 200, epoch: 12 | loss: 0.0794911
	speed: 0.1063s/iter; left time: 2098.7969s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:24.80s
Steps: 224 | Train Loss: 0.0802304 Vali Loss: 0.0920582 Test Loss: 0.0929922
Validation loss decreased (0.092687 --> 0.092058).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0742479
	speed: 0.2419s/iter; left time: 4744.7085s
	iters: 200, epoch: 13 | loss: 0.0781071
	speed: 0.1063s/iter; left time: 2074.6250s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:24.36s
Steps: 224 | Train Loss: 0.0792328 Vali Loss: 0.0923637 Test Loss: 0.0930975
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0793341
	speed: 0.2429s/iter; left time: 4709.5209s
	iters: 200, epoch: 14 | loss: 0.0800474
	speed: 0.1058s/iter; left time: 2040.0484s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:24.50s
Steps: 224 | Train Loss: 0.0789391 Vali Loss: 0.0918005 Test Loss: 0.0931362
Validation loss decreased (0.092058 --> 0.091800).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0771248
	speed: 0.2442s/iter; left time: 4679.4770s
	iters: 200, epoch: 15 | loss: 0.0753231
	speed: 0.1063s/iter; left time: 2027.3215s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:24.42s
Steps: 224 | Train Loss: 0.0787969 Vali Loss: 0.0915194 Test Loss: 0.0925866
Validation loss decreased (0.091800 --> 0.091519).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0782704
	speed: 0.2412s/iter; left time: 4567.9239s
	iters: 200, epoch: 16 | loss: 0.0772400
	speed: 0.1070s/iter; left time: 2015.4578s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:24.59s
Steps: 224 | Train Loss: 0.0784861 Vali Loss: 0.0913881 Test Loss: 0.0923093
Validation loss decreased (0.091519 --> 0.091388).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0805517
	speed: 0.2436s/iter; left time: 4559.5672s
	iters: 200, epoch: 17 | loss: 0.0789460
	speed: 0.1071s/iter; left time: 1994.0841s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:24.34s
Steps: 224 | Train Loss: 0.0782088 Vali Loss: 0.0910957 Test Loss: 0.0928803
Validation loss decreased (0.091388 --> 0.091096).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0786623
	speed: 0.2428s/iter; left time: 4489.9514s
	iters: 200, epoch: 18 | loss: 0.0864841
	speed: 0.1090s/iter; left time: 2004.0165s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:24.72s
Steps: 224 | Train Loss: 0.0781278 Vali Loss: 0.0906170 Test Loss: 0.0922537
Validation loss decreased (0.091096 --> 0.090617).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0733132
	speed: 0.2402s/iter; left time: 4389.0120s
	iters: 200, epoch: 19 | loss: 0.0748601
	speed: 0.1097s/iter; left time: 1992.9518s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:24.92s
Steps: 224 | Train Loss: 0.0776100 Vali Loss: 0.0925481 Test Loss: 0.0934079
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0750869
	speed: 0.2411s/iter; left time: 4351.1089s
	iters: 200, epoch: 20 | loss: 0.0796996
	speed: 0.1067s/iter; left time: 1914.3238s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:24.34s
Steps: 224 | Train Loss: 0.0776347 Vali Loss: 0.0912388 Test Loss: 0.0920733
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0717305
	speed: 0.2418s/iter; left time: 4308.3256s
	iters: 200, epoch: 21 | loss: 0.0779008
	speed: 0.1078s/iter; left time: 1910.2627s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:24.81s
Steps: 224 | Train Loss: 0.0773463 Vali Loss: 0.0907112 Test Loss: 0.0929124
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0695258
	speed: 0.2452s/iter; left time: 4314.8076s
	iters: 200, epoch: 22 | loss: 0.0743904
	speed: 0.1070s/iter; left time: 1872.9698s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:24.78s
Steps: 224 | Train Loss: 0.0772748 Vali Loss: 0.0906642 Test Loss: 0.0918941
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0765106
	speed: 0.2444s/iter; left time: 4245.4752s
	iters: 200, epoch: 23 | loss: 0.0724670
	speed: 0.1086s/iter; left time: 1875.7367s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:24.74s
Steps: 224 | Train Loss: 0.0771813 Vali Loss: 0.0903736 Test Loss: 0.0917934
Validation loss decreased (0.090617 --> 0.090374).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0761368
	speed: 0.2464s/iter; left time: 4225.4397s
	iters: 200, epoch: 24 | loss: 0.0754004
	speed: 0.1091s/iter; left time: 1860.3314s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:24.83s
Steps: 224 | Train Loss: 0.0769390 Vali Loss: 0.0905244 Test Loss: 0.0917674
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0757375
	speed: 0.2413s/iter; left time: 4083.5700s
	iters: 200, epoch: 25 | loss: 0.0855225
	speed: 0.1074s/iter; left time: 1807.0032s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:24.77s
Steps: 224 | Train Loss: 0.0769140 Vali Loss: 0.0903169 Test Loss: 0.0915357
Validation loss decreased (0.090374 --> 0.090317).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0757507
	speed: 0.2473s/iter; left time: 4130.6728s
	iters: 200, epoch: 26 | loss: 0.0741878
	speed: 0.1082s/iter; left time: 1796.8745s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:24.95s
Steps: 224 | Train Loss: 0.0768205 Vali Loss: 0.0904948 Test Loss: 0.0916539
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0808719
	speed: 0.2414s/iter; left time: 3977.5828s
	iters: 200, epoch: 27 | loss: 0.0802896
	speed: 0.1118s/iter; left time: 1831.3889s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:24.93s
Steps: 224 | Train Loss: 0.0766795 Vali Loss: 0.0902025 Test Loss: 0.0917831
Validation loss decreased (0.090317 --> 0.090203).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0725205
	speed: 0.2472s/iter; left time: 4018.3637s
	iters: 200, epoch: 28 | loss: 0.0790190
	speed: 0.1066s/iter; left time: 1721.4457s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:24.77s
Steps: 224 | Train Loss: 0.0766123 Vali Loss: 0.0903282 Test Loss: 0.0917660
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0783704
	speed: 0.2431s/iter; left time: 3896.7499s
	iters: 200, epoch: 29 | loss: 0.0704855
	speed: 0.1078s/iter; left time: 1717.6263s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:24.65s
Steps: 224 | Train Loss: 0.0764633 Vali Loss: 0.0900399 Test Loss: 0.0916202
Validation loss decreased (0.090203 --> 0.090040).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0822489
	speed: 0.2431s/iter; left time: 3842.3130s
	iters: 200, epoch: 30 | loss: 0.0782273
	speed: 0.1093s/iter; left time: 1715.8864s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:24.74s
Steps: 224 | Train Loss: 0.0764063 Vali Loss: 0.0900986 Test Loss: 0.0918674
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0760647
	speed: 0.2432s/iter; left time: 3788.6184s
	iters: 200, epoch: 31 | loss: 0.0729531
	speed: 0.1067s/iter; left time: 1651.1142s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:24.67s
Steps: 224 | Train Loss: 0.0764971 Vali Loss: 0.0904406 Test Loss: 0.0918275
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0721018
	speed: 0.2427s/iter; left time: 3726.4338s
	iters: 200, epoch: 32 | loss: 0.0794974
	speed: 0.1075s/iter; left time: 1640.8668s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:24.68s
Steps: 224 | Train Loss: 0.0763520 Vali Loss: 0.0900065 Test Loss: 0.0917493
Validation loss decreased (0.090040 --> 0.090006).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0815010
	speed: 0.2475s/iter; left time: 3745.5301s
	iters: 200, epoch: 33 | loss: 0.0701651
	speed: 0.1083s/iter; left time: 1627.6945s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:25.26s
Steps: 224 | Train Loss: 0.0763374 Vali Loss: 0.0906072 Test Loss: 0.0921051
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0747005
	speed: 0.2423s/iter; left time: 3612.9615s
	iters: 200, epoch: 34 | loss: 0.0780534
	speed: 0.1082s/iter; left time: 1601.7853s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:24.59s
Steps: 224 | Train Loss: 0.0763812 Vali Loss: 0.0904683 Test Loss: 0.0916902
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0778864
	speed: 0.2419s/iter; left time: 3552.5083s
	iters: 200, epoch: 35 | loss: 0.0721459
	speed: 0.1079s/iter; left time: 1574.0042s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:24.58s
Steps: 224 | Train Loss: 0.0762177 Vali Loss: 0.0901533 Test Loss: 0.0917088
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0776389
	speed: 0.2456s/iter; left time: 3552.2586s
	iters: 200, epoch: 36 | loss: 0.0809103
	speed: 0.1054s/iter; left time: 1513.8858s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:24.31s
Steps: 224 | Train Loss: 0.0762244 Vali Loss: 0.0907832 Test Loss: 0.0919312
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0838915
	speed: 0.2372s/iter; left time: 3377.7146s
	iters: 200, epoch: 37 | loss: 0.0783533
	speed: 0.1056s/iter; left time: 1493.0314s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:24.20s
Steps: 224 | Train Loss: 0.0762900 Vali Loss: 0.0904310 Test Loss: 0.0916811
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0742543
	speed: 0.2368s/iter; left time: 3317.6627s
	iters: 200, epoch: 38 | loss: 0.0717227
	speed: 0.1048s/iter; left time: 1458.6228s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:24.07s
Steps: 224 | Train Loss: 0.0762770 Vali Loss: 0.0905645 Test Loss: 0.0919782
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0804269
	speed: 0.2405s/iter; left time: 3315.9571s
	iters: 200, epoch: 39 | loss: 0.0715565
	speed: 0.1070s/iter; left time: 1464.9644s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:24.39s
Steps: 224 | Train Loss: 0.0762279 Vali Loss: 0.0899833 Test Loss: 0.0918329
Validation loss decreased (0.090006 --> 0.089983).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0722721
	speed: 0.2376s/iter; left time: 3222.5864s
	iters: 200, epoch: 40 | loss: 0.0838491
	speed: 0.1045s/iter; left time: 1407.6962s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:24.00s
Steps: 224 | Train Loss: 0.0761840 Vali Loss: 0.0900733 Test Loss: 0.0916720
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0712462
	speed: 0.2442s/iter; left time: 3258.0080s
	iters: 200, epoch: 41 | loss: 0.0757762
	speed: 0.1229s/iter; left time: 1627.0508s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:26.98s
Steps: 224 | Train Loss: 0.0762211 Vali Loss: 0.0899296 Test Loss: 0.0918514
Validation loss decreased (0.089983 --> 0.089930).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0745897
	speed: 0.2666s/iter; left time: 3497.3550s
	iters: 200, epoch: 42 | loss: 0.0823171
	speed: 0.1081s/iter; left time: 1406.4978s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:26.81s
Steps: 224 | Train Loss: 0.0762181 Vali Loss: 0.0901200 Test Loss: 0.0916466
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0824856
	speed: 0.2714s/iter; left time: 3499.1962s
	iters: 200, epoch: 43 | loss: 0.0770590
	speed: 0.1168s/iter; left time: 1494.0240s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:26.72s
Steps: 224 | Train Loss: 0.0762000 Vali Loss: 0.0902058 Test Loss: 0.0917577
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0722135
	speed: 0.2666s/iter; left time: 3377.2280s
	iters: 200, epoch: 44 | loss: 0.0762586
	speed: 0.1282s/iter; left time: 1611.7185s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:28.20s
Steps: 224 | Train Loss: 0.0761000 Vali Loss: 0.0901161 Test Loss: 0.0916589
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0769771
	speed: 0.2604s/iter; left time: 3240.8001s
	iters: 200, epoch: 45 | loss: 0.0785704
	speed: 0.1159s/iter; left time: 1431.2403s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:26.30s
Steps: 224 | Train Loss: 0.0760175 Vali Loss: 0.0901326 Test Loss: 0.0917347
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0757564
	speed: 0.2594s/iter; left time: 3169.8647s
	iters: 200, epoch: 46 | loss: 0.0814028
	speed: 0.1117s/iter; left time: 1353.9986s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:25.68s
Steps: 224 | Train Loss: 0.0761109 Vali Loss: 0.0901451 Test Loss: 0.0917158
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0753020
	speed: 0.2731s/iter; left time: 3276.1763s
	iters: 200, epoch: 47 | loss: 0.0748562
	speed: 0.1206s/iter; left time: 1435.3448s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:27.20s
Steps: 224 | Train Loss: 0.0760741 Vali Loss: 0.0902223 Test Loss: 0.0918635
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0774492
	speed: 0.2706s/iter; left time: 3185.7770s
	iters: 200, epoch: 48 | loss: 0.0754168
	speed: 0.1162s/iter; left time: 1356.0648s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:27.81s
Steps: 224 | Train Loss: 0.0760505 Vali Loss: 0.0900400 Test Loss: 0.0917029
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0775502
	speed: 0.2735s/iter; left time: 3158.6544s
	iters: 200, epoch: 49 | loss: 0.0808157
	speed: 0.1320s/iter; left time: 1510.7262s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:29.05s
Steps: 224 | Train Loss: 0.0760683 Vali Loss: 0.0899930 Test Loss: 0.0916899
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0717994
	speed: 0.2609s/iter; left time: 2954.9706s
	iters: 200, epoch: 50 | loss: 0.0748966
	speed: 0.1201s/iter; left time: 1348.2004s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:27.26s
Steps: 224 | Train Loss: 0.0760453 Vali Loss: 0.0907101 Test Loss: 0.0920141
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0711623
	speed: 0.2688s/iter; left time: 2984.2581s
	iters: 200, epoch: 51 | loss: 0.0779105
	speed: 0.1140s/iter; left time: 1253.7578s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:27.54s
Steps: 224 | Train Loss: 0.0760741 Vali Loss: 0.0902494 Test Loss: 0.0916917
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.0219077430665493, rmse:0.14801263809204102, mae:0.0918513685464859, rse:0.5223571062088013
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2613133
	speed: 0.1230s/iter; left time: 2744.1311s
	iters: 200, epoch: 1 | loss: 0.2378061
	speed: 0.1454s/iter; left time: 3228.4253s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.59s
Steps: 224 | Train Loss: 0.2633763 Vali Loss: 0.2141813 Test Loss: 0.2135043
Validation loss decreased (inf --> 0.214181).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1348917
	speed: 0.2645s/iter; left time: 5839.5659s
	iters: 200, epoch: 2 | loss: 0.1091313
	speed: 0.1158s/iter; left time: 2545.9722s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:27.27s
Steps: 224 | Train Loss: 0.1502631 Vali Loss: 0.1215096 Test Loss: 0.1213722
Validation loss decreased (0.214181 --> 0.121510).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0991456
	speed: 0.2823s/iter; left time: 6168.2100s
	iters: 200, epoch: 3 | loss: 0.1028467
	speed: 0.1247s/iter; left time: 2712.1968s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.60s
Steps: 224 | Train Loss: 0.1039570 Vali Loss: 0.1042667 Test Loss: 0.1060531
Validation loss decreased (0.121510 --> 0.104267).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0944739
	speed: 0.2747s/iter; left time: 5941.8837s
	iters: 200, epoch: 4 | loss: 0.0906489
	speed: 0.1103s/iter; left time: 2375.2789s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.35s
Steps: 224 | Train Loss: 0.0935735 Vali Loss: 0.0997090 Test Loss: 0.1010089
Validation loss decreased (0.104267 --> 0.099709).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0875830
	speed: 0.2443s/iter; left time: 5229.4803s
	iters: 200, epoch: 5 | loss: 0.0934917
	speed: 0.1053s/iter; left time: 2244.2023s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.69s
Steps: 224 | Train Loss: 0.0890781 Vali Loss: 0.0966424 Test Loss: 0.0981480
Validation loss decreased (0.099709 --> 0.096642).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0861180
	speed: 0.2424s/iter; left time: 5134.4485s
	iters: 200, epoch: 6 | loss: 0.0829359
	speed: 0.1062s/iter; left time: 2238.2237s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.22s
Steps: 224 | Train Loss: 0.0859295 Vali Loss: 0.0960166 Test Loss: 0.0969701
Validation loss decreased (0.096642 --> 0.096017).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0899564
	speed: 0.2406s/iter; left time: 5042.7237s
	iters: 200, epoch: 7 | loss: 0.0825942
	speed: 0.1095s/iter; left time: 2283.4213s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.61s
Steps: 224 | Train Loss: 0.0842214 Vali Loss: 0.0949593 Test Loss: 0.0966665
Validation loss decreased (0.096017 --> 0.094959).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0767608
	speed: 0.2423s/iter; left time: 5024.0582s
	iters: 200, epoch: 8 | loss: 0.0868971
	speed: 0.1050s/iter; left time: 2167.0930s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:24.21s
Steps: 224 | Train Loss: 0.0831380 Vali Loss: 0.0947526 Test Loss: 0.0960211
Validation loss decreased (0.094959 --> 0.094753).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0841403
	speed: 0.2419s/iter; left time: 4962.0523s
	iters: 200, epoch: 9 | loss: 0.0848030
	speed: 0.1065s/iter; left time: 2174.4421s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:24.31s
Steps: 224 | Train Loss: 0.0828001 Vali Loss: 0.0948078 Test Loss: 0.0960022
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0816145
	speed: 0.2396s/iter; left time: 4859.8447s
	iters: 200, epoch: 10 | loss: 0.0803980
	speed: 0.1076s/iter; left time: 2172.3881s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:24.80s
Steps: 224 | Train Loss: 0.0809367 Vali Loss: 0.0950351 Test Loss: 0.0961022
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0774165
	speed: 0.2649s/iter; left time: 5314.5085s
	iters: 200, epoch: 11 | loss: 0.0758484
	speed: 0.1300s/iter; left time: 2594.1143s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:32.17s
Steps: 224 | Train Loss: 0.0802822 Vali Loss: 0.0916017 Test Loss: 0.0935093
Validation loss decreased (0.094753 --> 0.091602).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0839585
	speed: 0.5408s/iter; left time: 10728.4096s
	iters: 200, epoch: 12 | loss: 0.0788689
	speed: 0.2028s/iter; left time: 4001.9722s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:47.69s
Steps: 224 | Train Loss: 0.0804069 Vali Loss: 0.0939275 Test Loss: 0.0949371
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0782914
	speed: 0.2683s/iter; left time: 5262.5800s
	iters: 200, epoch: 13 | loss: 0.0784861
	speed: 0.1135s/iter; left time: 2214.3359s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:26.47s
Steps: 224 | Train Loss: 0.0793854 Vali Loss: 0.0912577 Test Loss: 0.0931827
Validation loss decreased (0.091602 --> 0.091258).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0735934
	speed: 0.5369s/iter; left time: 10410.8767s
	iters: 200, epoch: 14 | loss: 0.0790708
	speed: 0.2510s/iter; left time: 4841.4135s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:58.23s
Steps: 224 | Train Loss: 0.0786873 Vali Loss: 0.0919591 Test Loss: 0.0934465
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0759815
	speed: 0.5854s/iter; left time: 11218.6524s
	iters: 200, epoch: 15 | loss: 0.0776908
	speed: 0.2552s/iter; left time: 4865.4070s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:57.35s
Steps: 224 | Train Loss: 0.0783673 Vali Loss: 0.0911349 Test Loss: 0.0928662
Validation loss decreased (0.091258 --> 0.091135).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0789143
	speed: 0.5877s/iter; left time: 11130.9549s
	iters: 200, epoch: 16 | loss: 0.0804386
	speed: 0.2430s/iter; left time: 4578.9894s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:55.62s
Steps: 224 | Train Loss: 0.0783604 Vali Loss: 0.0913257 Test Loss: 0.0931277
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0740282
	speed: 0.7075s/iter; left time: 13241.7670s
	iters: 200, epoch: 17 | loss: 0.0791384
	speed: 0.2536s/iter; left time: 4721.1037s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:12.32s
Steps: 224 | Train Loss: 0.0780464 Vali Loss: 0.0904279 Test Loss: 0.0924158
Validation loss decreased (0.091135 --> 0.090428).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0804243
	speed: 0.6128s/iter; left time: 11333.1378s
	iters: 200, epoch: 18 | loss: 0.0783238
	speed: 0.4248s/iter; left time: 7813.5611s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:17.38s
Steps: 224 | Train Loss: 0.0776671 Vali Loss: 0.0924424 Test Loss: 0.0937582
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0769621
	speed: 0.6785s/iter; left time: 12394.9323s
	iters: 200, epoch: 19 | loss: 0.0769336
	speed: 0.3051s/iter; left time: 5543.6788s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:10.64s
Steps: 224 | Train Loss: 0.0776793 Vali Loss: 0.0904061 Test Loss: 0.0922572
Validation loss decreased (0.090428 --> 0.090406).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0763526
	speed: 0.5938s/iter; left time: 10715.1350s
	iters: 200, epoch: 20 | loss: 0.0778286
	speed: 0.2581s/iter; left time: 4632.1380s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:00.37s
Steps: 224 | Train Loss: 0.0774899 Vali Loss: 0.0901770 Test Loss: 0.0921280
Validation loss decreased (0.090406 --> 0.090177).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0757957
	speed: 0.7333s/iter; left time: 13068.4842s
	iters: 200, epoch: 21 | loss: 0.0736768
	speed: 0.2811s/iter; left time: 4981.0144s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:01m:05.74s
Steps: 224 | Train Loss: 0.0771877 Vali Loss: 0.0917508 Test Loss: 0.0932515
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0798429
	speed: 0.6155s/iter; left time: 10831.2909s
	iters: 200, epoch: 22 | loss: 0.0763701
	speed: 0.2889s/iter; left time: 5054.4191s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:58.84s
Steps: 224 | Train Loss: 0.0769310 Vali Loss: 0.0910191 Test Loss: 0.0925784
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0767220
	speed: 0.3263s/iter; left time: 5669.2843s
	iters: 200, epoch: 23 | loss: 0.0793968
	speed: 0.1144s/iter; left time: 1976.5661s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:27.16s
Steps: 224 | Train Loss: 0.0769935 Vali Loss: 0.0900505 Test Loss: 0.0921190
Validation loss decreased (0.090177 --> 0.090050).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0806249
	speed: 0.2590s/iter; left time: 4442.0003s
	iters: 200, epoch: 24 | loss: 0.0744155
	speed: 0.1172s/iter; left time: 1997.6904s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:26.70s
Steps: 224 | Train Loss: 0.0769818 Vali Loss: 0.0898234 Test Loss: 0.0918337
Validation loss decreased (0.090050 --> 0.089823).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0764382
	speed: 0.2632s/iter; left time: 4454.1771s
	iters: 200, epoch: 25 | loss: 0.0735312
	speed: 0.1165s/iter; left time: 1960.0077s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:26.27s
Steps: 224 | Train Loss: 0.0768267 Vali Loss: 0.0901439 Test Loss: 0.0919796
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0763813
	speed: 0.2570s/iter; left time: 4292.0756s
	iters: 200, epoch: 26 | loss: 0.0757832
	speed: 0.1614s/iter; left time: 2678.7772s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:32.01s
Steps: 224 | Train Loss: 0.0766008 Vali Loss: 0.0901050 Test Loss: 0.0919692
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0752778
	speed: 0.3078s/iter; left time: 5071.3881s
	iters: 200, epoch: 27 | loss: 0.0755920
	speed: 0.1260s/iter; left time: 2062.8198s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:29.14s
Steps: 224 | Train Loss: 0.0764962 Vali Loss: 0.0905604 Test Loss: 0.0923967
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0744643
	speed: 0.2722s/iter; left time: 4424.0175s
	iters: 200, epoch: 28 | loss: 0.0749847
	speed: 0.1208s/iter; left time: 1950.9158s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:27.65s
Steps: 224 | Train Loss: 0.0765897 Vali Loss: 0.0897865 Test Loss: 0.0917170
Validation loss decreased (0.089823 --> 0.089786).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0751541
	speed: 0.2787s/iter; left time: 4467.0822s
	iters: 200, epoch: 29 | loss: 0.0740950
	speed: 0.1208s/iter; left time: 1923.9034s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:27.78s
Steps: 224 | Train Loss: 0.0764319 Vali Loss: 0.0901526 Test Loss: 0.0920242
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0806817
	speed: 0.2698s/iter; left time: 4263.5552s
	iters: 200, epoch: 30 | loss: 0.0741300
	speed: 0.1191s/iter; left time: 1869.7943s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:27.11s
Steps: 224 | Train Loss: 0.0764454 Vali Loss: 0.0910322 Test Loss: 0.0927493
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0785073
	speed: 0.2675s/iter; left time: 4168.4875s
	iters: 200, epoch: 31 | loss: 0.0822864
	speed: 0.1178s/iter; left time: 1823.5885s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:27.24s
Steps: 224 | Train Loss: 0.0763724 Vali Loss: 0.0905380 Test Loss: 0.0923370
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0720525
	speed: 0.2670s/iter; left time: 4099.7668s
	iters: 200, epoch: 32 | loss: 0.0754558
	speed: 0.1182s/iter; left time: 1803.1603s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:26.78s
Steps: 224 | Train Loss: 0.0762633 Vali Loss: 0.0902661 Test Loss: 0.0921785
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0764711
	speed: 0.2623s/iter; left time: 3969.2843s
	iters: 200, epoch: 33 | loss: 0.0753409
	speed: 0.1168s/iter; left time: 1755.5251s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:26.48s
Steps: 224 | Train Loss: 0.0762685 Vali Loss: 0.0898499 Test Loss: 0.0918554
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0713696
	speed: 0.2613s/iter; left time: 3896.4166s
	iters: 200, epoch: 34 | loss: 0.0775798
	speed: 0.1145s/iter; left time: 1695.9915s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:26.64s
Steps: 224 | Train Loss: 0.0761226 Vali Loss: 0.0897780 Test Loss: 0.0916997
Validation loss decreased (0.089786 --> 0.089778).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0767672
	speed: 0.2645s/iter; left time: 3883.9269s
	iters: 200, epoch: 35 | loss: 0.0773636
	speed: 0.1963s/iter; left time: 2862.8023s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:37.77s
Steps: 224 | Train Loss: 0.0762109 Vali Loss: 0.0896653 Test Loss: 0.0916823
Validation loss decreased (0.089778 --> 0.089665).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0710060
	speed: 0.5680s/iter; left time: 8213.1948s
	iters: 200, epoch: 36 | loss: 0.0774741
	speed: 0.1260s/iter; left time: 1809.4344s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:40.64s
Steps: 224 | Train Loss: 0.0761405 Vali Loss: 0.0903530 Test Loss: 0.0922118
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0769212
	speed: 0.2676s/iter; left time: 3810.4897s
	iters: 200, epoch: 37 | loss: 0.0737745
	speed: 0.1143s/iter; left time: 1615.2601s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:26.52s
Steps: 224 | Train Loss: 0.0761545 Vali Loss: 0.0899915 Test Loss: 0.0918158
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0786948
	speed: 0.4057s/iter; left time: 5685.5417s
	iters: 200, epoch: 38 | loss: 0.0819519
	speed: 0.1902s/iter; left time: 2645.7837s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:45.70s
Steps: 224 | Train Loss: 0.0760353 Vali Loss: 0.0901752 Test Loss: 0.0920487
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0791225
	speed: 0.5206s/iter; left time: 7178.7747s
	iters: 200, epoch: 39 | loss: 0.0748556
	speed: 0.2586s/iter; left time: 3540.2364s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:59.18s
Steps: 224 | Train Loss: 0.0761031 Vali Loss: 0.0903731 Test Loss: 0.0921540
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0743467
	speed: 0.5385s/iter; left time: 7305.1768s
	iters: 200, epoch: 40 | loss: 0.0701768
	speed: 0.2463s/iter; left time: 3315.8515s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:54.46s
Steps: 224 | Train Loss: 0.0761037 Vali Loss: 0.0899823 Test Loss: 0.0919424
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0750129
	speed: 0.5121s/iter; left time: 6831.3053s
	iters: 200, epoch: 41 | loss: 0.0762946
	speed: 0.2206s/iter; left time: 2920.8003s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:51.89s
Steps: 224 | Train Loss: 0.0761046 Vali Loss: 0.0899809 Test Loss: 0.0918796
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0789293
	speed: 0.5522s/iter; left time: 7243.3106s
	iters: 200, epoch: 42 | loss: 0.0742998
	speed: 0.2486s/iter; left time: 3236.6313s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:56.43s
Steps: 224 | Train Loss: 0.0760946 Vali Loss: 0.0904575 Test Loss: 0.0922634
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0779338
	speed: 0.5295s/iter; left time: 6827.0705s
	iters: 200, epoch: 43 | loss: 0.0743775
	speed: 0.2320s/iter; left time: 2967.4002s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:52.42s
Steps: 224 | Train Loss: 0.0760662 Vali Loss: 0.0898107 Test Loss: 0.0917817
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0754502
	speed: 0.5345s/iter; left time: 6771.5185s
	iters: 200, epoch: 44 | loss: 0.0784478
	speed: 0.2398s/iter; left time: 3014.3571s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:55.24s
Steps: 224 | Train Loss: 0.0759680 Vali Loss: 0.0896233 Test Loss: 0.0916874
Validation loss decreased (0.089665 --> 0.089623).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0741628
	speed: 0.5100s/iter; left time: 6346.5414s
	iters: 200, epoch: 45 | loss: 0.0764964
	speed: 0.2598s/iter; left time: 3207.0367s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:53.21s
Steps: 224 | Train Loss: 0.0759114 Vali Loss: 0.0901750 Test Loss: 0.0919436
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0750005
	speed: 0.5559s/iter; left time: 6793.8731s
	iters: 200, epoch: 46 | loss: 0.0753702
	speed: 0.2679s/iter; left time: 3246.6753s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:58.52s
Steps: 224 | Train Loss: 0.0759626 Vali Loss: 0.0899723 Test Loss: 0.0918334
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0721205
	speed: 0.5151s/iter; left time: 6179.4881s
	iters: 200, epoch: 47 | loss: 0.0742215
	speed: 0.2474s/iter; left time: 2943.5418s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:53.06s
Steps: 224 | Train Loss: 0.0758324 Vali Loss: 0.0900548 Test Loss: 0.0918610
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0769353
	speed: 0.3917s/iter; left time: 4611.3534s
	iters: 200, epoch: 48 | loss: 0.0775490
	speed: 0.1220s/iter; left time: 1424.6142s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:30.27s
Steps: 224 | Train Loss: 0.0759903 Vali Loss: 0.0901668 Test Loss: 0.0921282
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0747070
	speed: 0.3124s/iter; left time: 3608.3544s
	iters: 200, epoch: 49 | loss: 0.0788589
	speed: 0.1532s/iter; left time: 1753.4808s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:36.39s
Steps: 224 | Train Loss: 0.0759863 Vali Loss: 0.0901804 Test Loss: 0.0920464
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0756816
	speed: 0.2918s/iter; left time: 3305.0317s
	iters: 200, epoch: 50 | loss: 0.0746113
	speed: 0.1218s/iter; left time: 1366.6897s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:28.43s
Steps: 224 | Train Loss: 0.0758465 Vali Loss: 0.0899366 Test Loss: 0.0917983
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0800348
	speed: 0.2776s/iter; left time: 3081.9676s
	iters: 200, epoch: 51 | loss: 0.0769174
	speed: 0.1237s/iter; left time: 1360.4398s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:28.24s
Steps: 224 | Train Loss: 0.0757991 Vali Loss: 0.0899113 Test Loss: 0.0919283
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0765539
	speed: 0.2784s/iter; left time: 3027.8402s
	iters: 200, epoch: 52 | loss: 0.0767253
	speed: 0.1225s/iter; left time: 1320.5936s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:28.33s
Steps: 224 | Train Loss: 0.0759097 Vali Loss: 0.0906954 Test Loss: 0.0924402
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0756539
	speed: 0.2734s/iter; left time: 2912.8104s
	iters: 200, epoch: 53 | loss: 0.0754662
	speed: 0.1232s/iter; left time: 1300.4320s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:28.28s
Steps: 224 | Train Loss: 0.0758398 Vali Loss: 0.0899791 Test Loss: 0.0918872
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0751490
	speed: 0.2708s/iter; left time: 2824.2580s
	iters: 200, epoch: 54 | loss: 0.0724882
	speed: 0.1193s/iter; left time: 1231.8705s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:27.37s
Steps: 224 | Train Loss: 0.0758643 Vali Loss: 0.0899040 Test Loss: 0.0917923
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02174472063779831, rmse:0.1474609076976776, mae:0.09168744832277298, rse:0.5204100012779236
Intermediate time for DE and pred_len 24: 01h:21m:23.99s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2624439
	speed: 0.1655s/iter; left time: 3689.8555s
	iters: 200, epoch: 1 | loss: 0.2533581
	speed: 0.1182s/iter; left time: 2624.5063s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:27.72s
Steps: 224 | Train Loss: 0.2657103 Vali Loss: 0.2249349 Test Loss: 0.2257290
Validation loss decreased (inf --> 0.224935).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1578444
	speed: 0.3866s/iter; left time: 8536.0222s
	iters: 200, epoch: 2 | loss: 0.1355329
	speed: 0.1187s/iter; left time: 2609.1556s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:26.78s
Steps: 224 | Train Loss: 0.1630478 Vali Loss: 0.1429868 Test Loss: 0.1473229
Validation loss decreased (0.224935 --> 0.142987).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1218379
	speed: 0.6945s/iter; left time: 15175.8487s
	iters: 200, epoch: 3 | loss: 0.1212928
	speed: 0.2342s/iter; left time: 5094.9403s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:53.59s
Steps: 224 | Train Loss: 0.1243166 Vali Loss: 0.1323241 Test Loss: 0.1419654
Validation loss decreased (0.142987 --> 0.132324).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1167402
	speed: 0.3986s/iter; left time: 8621.6634s
	iters: 200, epoch: 4 | loss: 0.1118756
	speed: 0.1804s/iter; left time: 3884.5472s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.43s
Steps: 224 | Train Loss: 0.1161288 Vali Loss: 0.1285778 Test Loss: 0.1394080
Validation loss decreased (0.132324 --> 0.128578).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1120939
	speed: 0.8583s/iter; left time: 18372.1020s
	iters: 200, epoch: 5 | loss: 0.1029756
	speed: 0.2391s/iter; left time: 5093.2176s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:55.93s
Steps: 224 | Train Loss: 0.1115568 Vali Loss: 0.1238497 Test Loss: 0.1320646
Validation loss decreased (0.128578 --> 0.123850).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1175425
	speed: 0.8939s/iter; left time: 18934.2528s
	iters: 200, epoch: 6 | loss: 0.1142166
	speed: 0.2601s/iter; left time: 5483.4692s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:59.00s
Steps: 224 | Train Loss: 0.1093992 Vali Loss: 0.1259839 Test Loss: 0.1353314
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1083458
	speed: 0.8282s/iter; left time: 17355.9170s
	iters: 200, epoch: 7 | loss: 0.1027447
	speed: 0.2378s/iter; left time: 4959.0649s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:55.79s
Steps: 224 | Train Loss: 0.1081467 Vali Loss: 0.1243413 Test Loss: 0.1341996
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1075349
	speed: 0.8572s/iter; left time: 17772.2859s
	iters: 200, epoch: 8 | loss: 0.1041051
	speed: 0.2401s/iter; left time: 4954.9808s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:55.41s
Steps: 224 | Train Loss: 0.1069057 Vali Loss: 0.1231056 Test Loss: 0.1338573
Validation loss decreased (0.123850 --> 0.123106).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1053689
	speed: 0.9020s/iter; left time: 18500.0082s
	iters: 200, epoch: 9 | loss: 0.1085160
	speed: 0.2355s/iter; left time: 4805.9895s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:54.13s
Steps: 224 | Train Loss: 0.1065368 Vali Loss: 0.1244978 Test Loss: 0.1342114
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1047870
	speed: 0.8497s/iter; left time: 17235.6077s
	iters: 200, epoch: 10 | loss: 0.1017206
	speed: 0.2331s/iter; left time: 4705.7391s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:54.90s
Steps: 224 | Train Loss: 0.1056799 Vali Loss: 0.1234504 Test Loss: 0.1373607
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1044058
	speed: 0.9052s/iter; left time: 18158.8690s
	iters: 200, epoch: 11 | loss: 0.1065060
	speed: 0.2377s/iter; left time: 4745.3854s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:52.44s
Steps: 224 | Train Loss: 0.1052327 Vali Loss: 0.1222100 Test Loss: 0.1352888
Validation loss decreased (0.123106 --> 0.122210).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1066850
	speed: 0.4477s/iter; left time: 8881.0437s
	iters: 200, epoch: 12 | loss: 0.1037025
	speed: 0.1140s/iter; left time: 2249.0748s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:27.69s
Steps: 224 | Train Loss: 0.1049357 Vali Loss: 0.1230136 Test Loss: 0.1366802
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1043193
	speed: 0.5201s/iter; left time: 10201.2865s
	iters: 200, epoch: 13 | loss: 0.1049683
	speed: 0.1246s/iter; left time: 2430.8146s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:29.16s
Steps: 224 | Train Loss: 0.1044607 Vali Loss: 0.1213381 Test Loss: 0.1331712
Validation loss decreased (0.122210 --> 0.121338).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1062233
	speed: 0.4136s/iter; left time: 8019.4579s
	iters: 200, epoch: 14 | loss: 0.0998157
	speed: 0.1216s/iter; left time: 2344.6275s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.37s
Steps: 224 | Train Loss: 0.1040727 Vali Loss: 0.1226940 Test Loss: 0.1351359
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0996267
	speed: 0.3954s/iter; left time: 7577.6684s
	iters: 200, epoch: 15 | loss: 0.1062605
	speed: 0.1236s/iter; left time: 2356.4094s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.92s
Steps: 224 | Train Loss: 0.1039674 Vali Loss: 0.1219179 Test Loss: 0.1358486
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1072159
	speed: 0.3835s/iter; left time: 7264.2275s
	iters: 200, epoch: 16 | loss: 0.1091402
	speed: 0.1175s/iter; left time: 2213.5734s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:27.27s
Steps: 224 | Train Loss: 0.1037040 Vali Loss: 0.1214257 Test Loss: 0.1346061
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1043148
	speed: 0.3856s/iter; left time: 7218.1348s
	iters: 200, epoch: 17 | loss: 0.1040580
	speed: 0.1153s/iter; left time: 2145.9801s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:26.90s
Steps: 224 | Train Loss: 0.1034399 Vali Loss: 0.1213346 Test Loss: 0.1334521
Validation loss decreased (0.121338 --> 0.121335).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1028586
	speed: 0.3855s/iter; left time: 7128.6473s
	iters: 200, epoch: 18 | loss: 0.0969299
	speed: 0.1162s/iter; left time: 2137.9971s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:30.01s
Steps: 224 | Train Loss: 0.1032042 Vali Loss: 0.1209691 Test Loss: 0.1328134
Validation loss decreased (0.121335 --> 0.120969).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1028012
	speed: 0.7956s/iter; left time: 14535.6314s
	iters: 200, epoch: 19 | loss: 0.1008040
	speed: 0.1293s/iter; left time: 2349.1383s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:38.04s
Steps: 224 | Train Loss: 0.1032438 Vali Loss: 0.1215783 Test Loss: 0.1350771
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1028210
	speed: 0.3801s/iter; left time: 6858.9683s
	iters: 200, epoch: 20 | loss: 0.1061794
	speed: 0.1166s/iter; left time: 2091.6124s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:26.98s
Steps: 224 | Train Loss: 0.1028983 Vali Loss: 0.1210929 Test Loss: 0.1349423
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1033960
	speed: 0.5610s/iter; left time: 9996.8977s
	iters: 200, epoch: 21 | loss: 0.1023306
	speed: 0.3139s/iter; left time: 5563.2655s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:59.30s
Steps: 224 | Train Loss: 0.1026721 Vali Loss: 0.1210574 Test Loss: 0.1348963
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1006399
	speed: 0.8281s/iter; left time: 14572.4296s
	iters: 200, epoch: 22 | loss: 0.1029968
	speed: 0.2601s/iter; left time: 4551.7485s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:57.99s
Steps: 224 | Train Loss: 0.1025208 Vali Loss: 0.1210968 Test Loss: 0.1336726
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1028404
	speed: 0.8819s/iter; left time: 15321.0237s
	iters: 200, epoch: 23 | loss: 0.1074014
	speed: 0.2498s/iter; left time: 4313.9326s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:01m:01.41s
Steps: 224 | Train Loss: 0.1024946 Vali Loss: 0.1203637 Test Loss: 0.1331069
Validation loss decreased (0.120969 --> 0.120364).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1077754
	speed: 0.8649s/iter; left time: 14832.3594s
	iters: 200, epoch: 24 | loss: 0.1004269
	speed: 0.2687s/iter; left time: 4581.0617s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:58.66s
Steps: 224 | Train Loss: 0.1023391 Vali Loss: 0.1204766 Test Loss: 0.1342240
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1016895
	speed: 0.8483s/iter; left time: 14356.9109s
	iters: 200, epoch: 25 | loss: 0.0960510
	speed: 0.2323s/iter; left time: 3907.7853s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:55.92s
Steps: 224 | Train Loss: 0.1022619 Vali Loss: 0.1215099 Test Loss: 0.1329345
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1032051
	speed: 0.8813s/iter; left time: 14718.0882s
	iters: 200, epoch: 26 | loss: 0.1087515
	speed: 0.2591s/iter; left time: 4301.8084s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:59.69s
Steps: 224 | Train Loss: 0.1022497 Vali Loss: 0.1206701 Test Loss: 0.1335198
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1040444
	speed: 0.8396s/iter; left time: 13834.4424s
	iters: 200, epoch: 27 | loss: 0.0977249
	speed: 0.1568s/iter; left time: 2568.7156s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:44.75s
Steps: 224 | Train Loss: 0.1021985 Vali Loss: 0.1205080 Test Loss: 0.1342546
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1052764
	speed: 0.4244s/iter; left time: 6897.5054s
	iters: 200, epoch: 28 | loss: 0.0975134
	speed: 0.1886s/iter; left time: 3046.9562s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:35.15s
Steps: 224 | Train Loss: 0.1019502 Vali Loss: 0.1210460 Test Loss: 0.1345772
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0996965
	speed: 0.4606s/iter; left time: 7383.1543s
	iters: 200, epoch: 29 | loss: 0.1094052
	speed: 0.1286s/iter; left time: 2049.2603s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:30.30s
Steps: 224 | Train Loss: 0.1019759 Vali Loss: 0.1204747 Test Loss: 0.1332983
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0972120
	speed: 0.4294s/iter; left time: 6786.5756s
	iters: 200, epoch: 30 | loss: 0.1037831
	speed: 0.1281s/iter; left time: 2012.2139s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:29.77s
Steps: 224 | Train Loss: 0.1018909 Vali Loss: 0.1201878 Test Loss: 0.1332775
Validation loss decreased (0.120364 --> 0.120188).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0998103
	speed: 0.4215s/iter; left time: 6566.6763s
	iters: 200, epoch: 31 | loss: 0.0966518
	speed: 0.1279s/iter; left time: 1980.3362s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:29.46s
Steps: 224 | Train Loss: 0.1019227 Vali Loss: 0.1212375 Test Loss: 0.1331787
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1017513
	speed: 0.4254s/iter; left time: 6532.6847s
	iters: 200, epoch: 32 | loss: 0.1009322
	speed: 0.1268s/iter; left time: 1933.8477s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:29.33s
Steps: 224 | Train Loss: 0.1018305 Vali Loss: 0.1203657 Test Loss: 0.1338133
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1026395
	speed: 0.4018s/iter; left time: 6079.8228s
	iters: 200, epoch: 33 | loss: 0.1020070
	speed: 0.1209s/iter; left time: 1817.2060s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:27.75s
Steps: 224 | Train Loss: 0.1018055 Vali Loss: 0.1201956 Test Loss: 0.1328612
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.1067616
	speed: 0.3999s/iter; left time: 5962.5837s
	iters: 200, epoch: 34 | loss: 0.1023788
	speed: 0.1818s/iter; left time: 2692.7173s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:38.03s
Steps: 224 | Train Loss: 0.1017142 Vali Loss: 0.1204072 Test Loss: 0.1334088
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0938389
	speed: 0.7497s/iter; left time: 11009.5429s
	iters: 200, epoch: 35 | loss: 0.1035917
	speed: 0.1279s/iter; left time: 1865.3187s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:30.59s
Steps: 224 | Train Loss: 0.1016174 Vali Loss: 0.1205804 Test Loss: 0.1323296
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0989040
	speed: 0.6981s/iter; left time: 10094.5079s
	iters: 200, epoch: 36 | loss: 0.0989800
	speed: 0.2587s/iter; left time: 3714.6485s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:58.23s
Steps: 224 | Train Loss: 0.1016506 Vali Loss: 0.1203181 Test Loss: 0.1335595
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.1087715
	speed: 0.8550s/iter; left time: 12172.6308s
	iters: 200, epoch: 37 | loss: 0.1035411
	speed: 0.1438s/iter; left time: 2033.0224s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:41.01s
Steps: 224 | Train Loss: 0.1016309 Vali Loss: 0.1202777 Test Loss: 0.1338640
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.1005551
	speed: 0.7876s/iter; left time: 11036.0117s
	iters: 200, epoch: 38 | loss: 0.1086734
	speed: 0.2342s/iter; left time: 3258.1612s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:54.61s
Steps: 224 | Train Loss: 0.1015396 Vali Loss: 0.1201334 Test Loss: 0.1330781
Validation loss decreased (0.120188 --> 0.120133).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.1019120
	speed: 0.8587s/iter; left time: 11841.2038s
	iters: 200, epoch: 39 | loss: 0.1053489
	speed: 0.2526s/iter; left time: 3458.2343s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:56.50s
Steps: 224 | Train Loss: 0.1016398 Vali Loss: 0.1205702 Test Loss: 0.1335148
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.1039687
	speed: 0.8186s/iter; left time: 11103.6663s
	iters: 200, epoch: 40 | loss: 0.1052855
	speed: 0.2537s/iter; left time: 3416.2635s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:57.53s
Steps: 224 | Train Loss: 0.1016112 Vali Loss: 0.1201181 Test Loss: 0.1329917
Validation loss decreased (0.120133 --> 0.120118).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.1032790
	speed: 0.8241s/iter; left time: 10993.7257s
	iters: 200, epoch: 41 | loss: 0.0986189
	speed: 0.2480s/iter; left time: 3283.2351s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:57.15s
Steps: 224 | Train Loss: 0.1015481 Vali Loss: 0.1201114 Test Loss: 0.1333343
Validation loss decreased (0.120118 --> 0.120111).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.1040610
	speed: 0.8156s/iter; left time: 10697.7058s
	iters: 200, epoch: 42 | loss: 0.1028562
	speed: 0.2702s/iter; left time: 3517.3116s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:58.70s
Steps: 224 | Train Loss: 0.1015372 Vali Loss: 0.1203343 Test Loss: 0.1330506
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.1020140
	speed: 0.8194s/iter; left time: 10563.8796s
	iters: 200, epoch: 43 | loss: 0.0965043
	speed: 0.2248s/iter; left time: 2875.4296s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:53.58s
Steps: 224 | Train Loss: 0.1015124 Vali Loss: 0.1205626 Test Loss: 0.1332887
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.1006550
	speed: 0.5500s/iter; left time: 6968.2391s
	iters: 200, epoch: 44 | loss: 0.0985992
	speed: 0.1104s/iter; left time: 1387.2384s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:27.15s
Steps: 224 | Train Loss: 0.1015197 Vali Loss: 0.1200902 Test Loss: 0.1333098
Validation loss decreased (0.120111 --> 0.120090).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.1013960
	speed: 0.4970s/iter; left time: 6185.2816s
	iters: 200, epoch: 45 | loss: 0.1004077
	speed: 0.1324s/iter; left time: 1634.5825s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:30.90s
Steps: 224 | Train Loss: 0.1014997 Vali Loss: 0.1205729 Test Loss: 0.1332386
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0944509
	speed: 0.4059s/iter; left time: 4960.8590s
	iters: 200, epoch: 46 | loss: 0.1032707
	speed: 0.1219s/iter; left time: 1477.0612s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:27.79s
Steps: 224 | Train Loss: 0.1014372 Vali Loss: 0.1199568 Test Loss: 0.1329821
Validation loss decreased (0.120090 --> 0.119957).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.1047865
	speed: 0.4058s/iter; left time: 4867.9475s
	iters: 200, epoch: 47 | loss: 0.1014198
	speed: 0.1235s/iter; left time: 1469.3671s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:28.43s
Steps: 224 | Train Loss: 0.1014733 Vali Loss: 0.1202763 Test Loss: 0.1330418
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.1058092
	speed: 0.3916s/iter; left time: 4609.7357s
	iters: 200, epoch: 48 | loss: 0.0998233
	speed: 0.1173s/iter; left time: 1369.1639s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:27.70s
Steps: 224 | Train Loss: 0.1014681 Vali Loss: 0.1202359 Test Loss: 0.1334759
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.1017546
	speed: 0.3942s/iter; left time: 4552.5407s
	iters: 200, epoch: 49 | loss: 0.0944112
	speed: 0.1159s/iter; left time: 1327.1689s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:27.04s
Steps: 224 | Train Loss: 0.1014350 Vali Loss: 0.1203048 Test Loss: 0.1332014
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.1012539
	speed: 0.3794s/iter; left time: 4296.7012s
	iters: 200, epoch: 50 | loss: 0.0989887
	speed: 0.1199s/iter; left time: 1346.2740s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:27.45s
Steps: 224 | Train Loss: 0.1014373 Vali Loss: 0.1202343 Test Loss: 0.1333372
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.1002797
	speed: 0.5822s/iter; left time: 6462.5589s
	iters: 200, epoch: 51 | loss: 0.1037587
	speed: 0.2489s/iter; left time: 2738.2364s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:57.61s
Steps: 224 | Train Loss: 0.1013838 Vali Loss: 0.1202643 Test Loss: 0.1329726
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.1003040
	speed: 0.4638s/iter; left time: 5044.5349s
	iters: 200, epoch: 52 | loss: 0.1027404
	speed: 0.1160s/iter; left time: 1250.4068s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:26.95s
Steps: 224 | Train Loss: 0.1014626 Vali Loss: 0.1202116 Test Loss: 0.1333047
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.1025127
	speed: 0.4570s/iter; left time: 4867.9767s
	iters: 200, epoch: 53 | loss: 0.1010907
	speed: 0.2695s/iter; left time: 2844.4715s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:54.45s
Steps: 224 | Train Loss: 0.1015266 Vali Loss: 0.1201307 Test Loss: 0.1329808
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0957577
	speed: 0.8121s/iter; left time: 8469.1168s
	iters: 200, epoch: 54 | loss: 0.1033463
	speed: 0.2401s/iter; left time: 2479.9924s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:56.06s
Steps: 224 | Train Loss: 0.1014345 Vali Loss: 0.1200416 Test Loss: 0.1329347
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.1019332
	speed: 0.8461s/iter; left time: 8634.7176s
	iters: 200, epoch: 55 | loss: 0.0997111
	speed: 0.2452s/iter; left time: 2477.2847s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:56.52s
Steps: 224 | Train Loss: 0.1014097 Vali Loss: 0.1199121 Test Loss: 0.1326514
Validation loss decreased (0.119957 --> 0.119912).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.1037415
	speed: 0.8525s/iter; left time: 8509.0414s
	iters: 200, epoch: 56 | loss: 0.1031300
	speed: 0.2377s/iter; left time: 2348.4586s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:56.19s
Steps: 224 | Train Loss: 0.1014731 Vali Loss: 0.1202566 Test Loss: 0.1329472
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.1008514
	speed: 0.8013s/iter; left time: 7818.4867s
	iters: 200, epoch: 57 | loss: 0.1031975
	speed: 0.2705s/iter; left time: 2612.1617s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:58.50s
Steps: 224 | Train Loss: 0.1013736 Vali Loss: 0.1200582 Test Loss: 0.1330758
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.1050920
	speed: 0.8331s/iter; left time: 7941.6055s
	iters: 200, epoch: 58 | loss: 0.1070896
	speed: 0.2151s/iter; left time: 2028.8474s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:52.59s
Steps: 224 | Train Loss: 0.1014259 Vali Loss: 0.1205388 Test Loss: 0.1337711
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.1043649
	speed: 0.8516s/iter; left time: 7927.2217s
	iters: 200, epoch: 59 | loss: 0.1081941
	speed: 0.2484s/iter; left time: 2287.3356s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:55.67s
Steps: 224 | Train Loss: 0.1013385 Vali Loss: 0.1205128 Test Loss: 0.1335953
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0988084
	speed: 0.7956s/iter; left time: 7228.2403s
	iters: 200, epoch: 60 | loss: 0.1033372
	speed: 0.2171s/iter; left time: 1950.3318s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:51.53s
Steps: 224 | Train Loss: 0.1013759 Vali Loss: 0.1203726 Test Loss: 0.1334884
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0946015
	speed: 0.4507s/iter; left time: 3993.2869s
	iters: 200, epoch: 61 | loss: 0.0986594
	speed: 0.1157s/iter; left time: 1013.3095s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:27.18s
Steps: 224 | Train Loss: 0.1013898 Vali Loss: 0.1200167 Test Loss: 0.1329747
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.1028007
	speed: 0.5268s/iter; left time: 4549.7012s
	iters: 200, epoch: 62 | loss: 0.0947230
	speed: 0.1303s/iter; left time: 1112.1307s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:29.76s
Steps: 224 | Train Loss: 0.1014403 Vali Loss: 0.1200507 Test Loss: 0.1330406
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.1043935
	speed: 0.4010s/iter; left time: 3373.5372s
	iters: 200, epoch: 63 | loss: 0.1031553
	speed: 0.1229s/iter; left time: 1021.9637s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:28.35s
Steps: 224 | Train Loss: 0.1013708 Vali Loss: 0.1202125 Test Loss: 0.1334334
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0993519
	speed: 0.4078s/iter; left time: 3339.5816s
	iters: 200, epoch: 64 | loss: 0.0975773
	speed: 0.1208s/iter; left time: 977.5530s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:27.84s
Steps: 224 | Train Loss: 0.1014076 Vali Loss: 0.1202848 Test Loss: 0.1335480
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.1044489
	speed: 0.4025s/iter; left time: 3205.8998s
	iters: 200, epoch: 65 | loss: 0.0990196
	speed: 0.1207s/iter; left time: 949.1407s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:27.98s
Steps: 224 | Train Loss: 0.1013829 Vali Loss: 0.1203224 Test Loss: 0.1333933
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041031237691640854, rmse:0.20256169140338898, mae:0.13265147805213928, rse:0.7173118591308594
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2637779
	speed: 0.1372s/iter; left time: 3059.5645s
	iters: 200, epoch: 1 | loss: 0.2539923
	speed: 0.1345s/iter; left time: 2986.4745s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:30.36s
Steps: 224 | Train Loss: 0.2697836 Vali Loss: 0.2269523 Test Loss: 0.2268142
Validation loss decreased (inf --> 0.226952).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1553876
	speed: 0.4171s/iter; left time: 9207.8952s
	iters: 200, epoch: 2 | loss: 0.1364550
	speed: 0.1824s/iter; left time: 4008.5037s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.73s
Steps: 224 | Train Loss: 0.1634123 Vali Loss: 0.1403220 Test Loss: 0.1478905
Validation loss decreased (0.226952 --> 0.140322).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1286377
	speed: 0.7281s/iter; left time: 15910.8845s
	iters: 200, epoch: 3 | loss: 0.1138140
	speed: 0.1274s/iter; left time: 2772.0889s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:35.64s
Steps: 224 | Train Loss: 0.1238197 Vali Loss: 0.1302920 Test Loss: 0.1432873
Validation loss decreased (0.140322 --> 0.130292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1141549
	speed: 0.5290s/iter; left time: 11441.0569s
	iters: 200, epoch: 4 | loss: 0.1127083
	speed: 0.2532s/iter; left time: 5451.1752s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:56.28s
Steps: 224 | Train Loss: 0.1154949 Vali Loss: 0.1249511 Test Loss: 0.1344829
Validation loss decreased (0.130292 --> 0.124951).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1176004
	speed: 0.8327s/iter; left time: 17824.2131s
	iters: 200, epoch: 5 | loss: 0.1118314
	speed: 0.2622s/iter; left time: 5586.9675s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:59.04s
Steps: 224 | Train Loss: 0.1117181 Vali Loss: 0.1234926 Test Loss: 0.1330716
Validation loss decreased (0.124951 --> 0.123493).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1080893
	speed: 0.8528s/iter; left time: 18063.2646s
	iters: 200, epoch: 6 | loss: 0.1098259
	speed: 0.2863s/iter; left time: 6034.8184s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:02.03s
Steps: 224 | Train Loss: 0.1098882 Vali Loss: 0.1231055 Test Loss: 0.1313563
Validation loss decreased (0.123493 --> 0.123106).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1121295
	speed: 0.8423s/iter; left time: 17651.8771s
	iters: 200, epoch: 7 | loss: 0.1001399
	speed: 0.2452s/iter; left time: 5113.5324s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:55.69s
Steps: 224 | Train Loss: 0.1085345 Vali Loss: 0.1220433 Test Loss: 0.1314394
Validation loss decreased (0.123106 --> 0.122043).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1054836
	speed: 0.8403s/iter; left time: 17421.4164s
	iters: 200, epoch: 8 | loss: 0.1088158
	speed: 0.2380s/iter; left time: 4910.4341s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:56.40s
Steps: 224 | Train Loss: 0.1074146 Vali Loss: 0.1220296 Test Loss: 0.1324325
Validation loss decreased (0.122043 --> 0.122030).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1063514
	speed: 0.8752s/iter; left time: 17950.3079s
	iters: 200, epoch: 9 | loss: 0.1069098
	speed: 0.2653s/iter; left time: 5414.6269s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:00.40s
Steps: 224 | Train Loss: 0.1070694 Vali Loss: 0.1217695 Test Loss: 0.1323135
Validation loss decreased (0.122030 --> 0.121769).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1109394
	speed: 0.8571s/iter; left time: 17385.3396s
	iters: 200, epoch: 10 | loss: 0.1069677
	speed: 0.2456s/iter; left time: 4957.7641s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:57.45s
Steps: 224 | Train Loss: 0.1063840 Vali Loss: 0.1224054 Test Loss: 0.1326594
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1090138
	speed: 0.7265s/iter; left time: 14574.8101s
	iters: 200, epoch: 11 | loss: 0.1049139
	speed: 0.1345s/iter; left time: 2684.2671s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:36.06s
Steps: 224 | Train Loss: 0.1058753 Vali Loss: 0.1216009 Test Loss: 0.1337217
Validation loss decreased (0.121769 --> 0.121601).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1080899
	speed: 0.4648s/iter; left time: 9220.9210s
	iters: 200, epoch: 12 | loss: 0.1054267
	speed: 0.1415s/iter; left time: 2792.9273s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:36.18s
Steps: 224 | Train Loss: 0.1053662 Vali Loss: 0.1221200 Test Loss: 0.1341606
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1055244
	speed: 0.4462s/iter; left time: 8752.1789s
	iters: 200, epoch: 13 | loss: 0.1087706
	speed: 0.1303s/iter; left time: 2543.2865s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:29.99s
Steps: 224 | Train Loss: 0.1050417 Vali Loss: 0.1212838 Test Loss: 0.1324103
Validation loss decreased (0.121601 --> 0.121284).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1043101
	speed: 0.4238s/iter; left time: 8216.5703s
	iters: 200, epoch: 14 | loss: 0.1007886
	speed: 0.1276s/iter; left time: 2461.2887s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:29.55s
Steps: 224 | Train Loss: 0.1045775 Vali Loss: 0.1208834 Test Loss: 0.1339697
Validation loss decreased (0.121284 --> 0.120883).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1068064
	speed: 0.4174s/iter; left time: 8000.1406s
	iters: 200, epoch: 15 | loss: 0.0979744
	speed: 0.1218s/iter; left time: 2321.1736s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.32s
Steps: 224 | Train Loss: 0.1041305 Vali Loss: 0.1214591 Test Loss: 0.1339417
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1082182
	speed: 0.4103s/iter; left time: 7771.6859s
	iters: 200, epoch: 16 | loss: 0.1022706
	speed: 0.1186s/iter; left time: 2234.3934s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:27.62s
Steps: 224 | Train Loss: 0.1039353 Vali Loss: 0.1231866 Test Loss: 0.1344898
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1073123
	speed: 0.3983s/iter; left time: 7455.6463s
	iters: 200, epoch: 17 | loss: 0.1039126
	speed: 0.1233s/iter; left time: 2294.8785s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:27.86s
Steps: 224 | Train Loss: 0.1037457 Vali Loss: 0.1206146 Test Loss: 0.1327467
Validation loss decreased (0.120883 --> 0.120615).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1039048
	speed: 0.4899s/iter; left time: 9060.5731s
	iters: 200, epoch: 18 | loss: 0.1027165
	speed: 0.2188s/iter; left time: 4025.2858s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:49.55s
Steps: 224 | Train Loss: 0.1034835 Vali Loss: 0.1214214 Test Loss: 0.1346130
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1010692
	speed: 0.5714s/iter; left time: 10439.4127s
	iters: 200, epoch: 19 | loss: 0.1035050
	speed: 0.1217s/iter; left time: 2211.2607s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.23s
Steps: 224 | Train Loss: 0.1030755 Vali Loss: 0.1214949 Test Loss: 0.1360879
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1027409
	speed: 0.3985s/iter; left time: 7191.2009s
	iters: 200, epoch: 20 | loss: 0.1025753
	speed: 0.1598s/iter; left time: 2868.4306s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:34.36s
Steps: 224 | Train Loss: 0.1029724 Vali Loss: 0.1217011 Test Loss: 0.1374518
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1017875
	speed: 0.8156s/iter; left time: 14534.9035s
	iters: 200, epoch: 21 | loss: 0.1028564
	speed: 0.2403s/iter; left time: 4258.9846s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:54.89s
Steps: 224 | Train Loss: 0.1027034 Vali Loss: 0.1215911 Test Loss: 0.1348408
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1058805
	speed: 0.7412s/iter; left time: 13042.1944s
	iters: 200, epoch: 22 | loss: 0.1023147
	speed: 0.2253s/iter; left time: 3941.7214s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:54.09s
Steps: 224 | Train Loss: 0.1026770 Vali Loss: 0.1212407 Test Loss: 0.1360069
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0985907
	speed: 0.8257s/iter; left time: 14345.3529s
	iters: 200, epoch: 23 | loss: 0.0965465
	speed: 0.2411s/iter; left time: 4164.6608s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:57.13s
Steps: 224 | Train Loss: 0.1025187 Vali Loss: 0.1206689 Test Loss: 0.1343070
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1008442
	speed: 0.8186s/iter; left time: 14038.4567s
	iters: 200, epoch: 24 | loss: 0.1059913
	speed: 0.2668s/iter; left time: 4549.1425s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:01m:00.21s
Steps: 224 | Train Loss: 0.1023237 Vali Loss: 0.1219813 Test Loss: 0.1354348
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1031865
	speed: 0.8608s/iter; left time: 14569.8028s
	iters: 200, epoch: 25 | loss: 0.1060965
	speed: 0.2352s/iter; left time: 3957.9409s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:54.46s
Steps: 224 | Train Loss: 0.1021904 Vali Loss: 0.1211420 Test Loss: 0.1354917
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1074181
	speed: 0.8642s/iter; left time: 14433.5571s
	iters: 200, epoch: 26 | loss: 0.1013318
	speed: 0.2313s/iter; left time: 3839.0112s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:56.46s
Steps: 224 | Train Loss: 0.1020890 Vali Loss: 0.1218510 Test Loss: 0.1367242
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1010258
	speed: 0.8195s/iter; left time: 13502.3842s
	iters: 200, epoch: 27 | loss: 0.1017653
	speed: 0.2660s/iter; left time: 4356.9209s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:59.23s
Steps: 224 | Train Loss: 0.1020027 Vali Loss: 0.1219892 Test Loss: 0.1365549
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04001430422067642, rmse:0.20003575086593628, mae:0.13274672627449036, rse:0.7083670496940613
Intermediate time for DE and pred_len 96: 02h:06m:51.12s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2677401
	speed: 0.1820s/iter; left time: 4040.1145s
	iters: 200, epoch: 1 | loss: 0.2500999
	speed: 0.1208s/iter; left time: 2670.7722s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.46s
Steps: 223 | Train Loss: 0.2677914 Vali Loss: 0.2254755 Test Loss: 0.2269949
Validation loss decreased (inf --> 0.225476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1593123
	speed: 0.5065s/iter; left time: 11131.0234s
	iters: 200, epoch: 2 | loss: 0.1386128
	speed: 0.1369s/iter; left time: 2995.7880s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.79s
Steps: 223 | Train Loss: 0.1644203 Vali Loss: 0.1425524 Test Loss: 0.1512714
Validation loss decreased (0.225476 --> 0.142552).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1321919
	speed: 0.4190s/iter; left time: 9116.4001s
	iters: 200, epoch: 3 | loss: 0.1247367
	speed: 0.1273s/iter; left time: 2755.9920s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.85s
Steps: 223 | Train Loss: 0.1279126 Vali Loss: 0.1341396 Test Loss: 0.1474057
Validation loss decreased (0.142552 --> 0.134140).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1182213
	speed: 0.4161s/iter; left time: 8959.8817s
	iters: 200, epoch: 4 | loss: 0.1244321
	speed: 0.1242s/iter; left time: 2661.4433s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.72s
Steps: 223 | Train Loss: 0.1203479 Vali Loss: 0.1314158 Test Loss: 0.1428362
Validation loss decreased (0.134140 --> 0.131416).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1133140
	speed: 0.4057s/iter; left time: 8644.1970s
	iters: 200, epoch: 5 | loss: 0.1205413
	speed: 0.1257s/iter; left time: 2666.3926s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.20s
Steps: 223 | Train Loss: 0.1167874 Vali Loss: 0.1323499 Test Loss: 0.1460033
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1116394
	speed: 0.3879s/iter; left time: 8178.9912s
	iters: 200, epoch: 6 | loss: 0.1199970
	speed: 0.1190s/iter; left time: 2496.8097s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.91s
Steps: 223 | Train Loss: 0.1157549 Vali Loss: 0.1268357 Test Loss: 0.1388419
Validation loss decreased (0.131416 --> 0.126836).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1147387
	speed: 0.3745s/iter; left time: 7812.5994s
	iters: 200, epoch: 7 | loss: 0.1117559
	speed: 0.1141s/iter; left time: 2369.2890s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:26.73s
Steps: 223 | Train Loss: 0.1136810 Vali Loss: 0.1281963 Test Loss: 0.1412103
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1097705
	speed: 0.4119s/iter; left time: 8501.1668s
	iters: 200, epoch: 8 | loss: 0.1177658
	speed: 0.2162s/iter; left time: 4440.0782s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.15s
Steps: 223 | Train Loss: 0.1128562 Vali Loss: 0.1255399 Test Loss: 0.1383563
Validation loss decreased (0.126836 --> 0.125540).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1115139
	speed: 0.6424s/iter; left time: 13114.9236s
	iters: 200, epoch: 9 | loss: 0.1040265
	speed: 0.1242s/iter; left time: 2523.3825s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.41s
Steps: 223 | Train Loss: 0.1121096 Vali Loss: 0.1247006 Test Loss: 0.1388338
Validation loss decreased (0.125540 --> 0.124701).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1090760
	speed: 0.4173s/iter; left time: 8426.7990s
	iters: 200, epoch: 10 | loss: 0.1103452
	speed: 0.2344s/iter; left time: 4710.1678s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:44.13s
Steps: 223 | Train Loss: 0.1114390 Vali Loss: 0.1259230 Test Loss: 0.1378208
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1114614
	speed: 0.7927s/iter; left time: 15831.7958s
	iters: 200, epoch: 11 | loss: 0.1060762
	speed: 0.2121s/iter; left time: 4214.2286s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:51.49s
Steps: 223 | Train Loss: 0.1108384 Vali Loss: 0.1250621 Test Loss: 0.1402404
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1065840
	speed: 0.6699s/iter; left time: 13228.7014s
	iters: 200, epoch: 12 | loss: 0.1133321
	speed: 0.2306s/iter; left time: 4531.0612s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:48.12s
Steps: 223 | Train Loss: 0.1104513 Vali Loss: 0.1243598 Test Loss: 0.1387811
Validation loss decreased (0.124701 --> 0.124360).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1147133
	speed: 0.8004s/iter; left time: 15627.8795s
	iters: 200, epoch: 13 | loss: 0.1110229
	speed: 0.2324s/iter; left time: 4514.1184s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:50.87s
Steps: 223 | Train Loss: 0.1098902 Vali Loss: 0.1252507 Test Loss: 0.1385313
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1030627
	speed: 0.7667s/iter; left time: 14799.2301s
	iters: 200, epoch: 14 | loss: 0.1171217
	speed: 0.2492s/iter; left time: 4784.1928s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:53.88s
Steps: 223 | Train Loss: 0.1096920 Vali Loss: 0.1240418 Test Loss: 0.1379994
Validation loss decreased (0.124360 --> 0.124042).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1099146
	speed: 0.7925s/iter; left time: 15120.7059s
	iters: 200, epoch: 15 | loss: 0.1168502
	speed: 0.2386s/iter; left time: 4527.7700s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:54.25s
Steps: 223 | Train Loss: 0.1091754 Vali Loss: 0.1244492 Test Loss: 0.1391391
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1109005
	speed: 0.8506s/iter; left time: 16039.5180s
	iters: 200, epoch: 16 | loss: 0.1168759
	speed: 0.2385s/iter; left time: 4473.2860s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:56.54s
Steps: 223 | Train Loss: 0.1089259 Vali Loss: 0.1237585 Test Loss: 0.1388641
Validation loss decreased (0.124042 --> 0.123758).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1079608
	speed: 0.8065s/iter; left time: 15026.7810s
	iters: 200, epoch: 17 | loss: 0.1118281
	speed: 0.2684s/iter; left time: 4974.9967s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:60.00s
Steps: 223 | Train Loss: 0.1089215 Vali Loss: 0.1239117 Test Loss: 0.1385030
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1070187
	speed: 0.8212s/iter; left time: 15118.3243s
	iters: 200, epoch: 18 | loss: 0.1113766
	speed: 0.2308s/iter; left time: 4226.7087s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:54.10s
Steps: 223 | Train Loss: 0.1084525 Vali Loss: 0.1245929 Test Loss: 0.1390746
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1078872
	speed: 0.5102s/iter; left time: 9278.2869s
	iters: 200, epoch: 19 | loss: 0.1082217
	speed: 0.1234s/iter; left time: 2231.5405s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:29.64s
Steps: 223 | Train Loss: 0.1083489 Vali Loss: 0.1241439 Test Loss: 0.1387376
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1106229
	speed: 0.5091s/iter; left time: 9144.9814s
	iters: 200, epoch: 20 | loss: 0.1058486
	speed: 0.1367s/iter; left time: 2442.7850s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:30.81s
Steps: 223 | Train Loss: 0.1081340 Vali Loss: 0.1249562 Test Loss: 0.1388736
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1109785
	speed: 0.4165s/iter; left time: 7388.9705s
	iters: 200, epoch: 21 | loss: 0.1143317
	speed: 0.1311s/iter; left time: 2313.4206s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:29.82s
Steps: 223 | Train Loss: 0.1078482 Vali Loss: 0.1240840 Test Loss: 0.1393505
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1025771
	speed: 0.4115s/iter; left time: 7208.7390s
	iters: 200, epoch: 22 | loss: 0.1160046
	speed: 0.1290s/iter; left time: 2247.3632s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:29.41s
Steps: 223 | Train Loss: 0.1077650 Vali Loss: 0.1239440 Test Loss: 0.1394758
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1055426
	speed: 0.4009s/iter; left time: 6933.0544s
	iters: 200, epoch: 23 | loss: 0.1066774
	speed: 0.1223s/iter; left time: 2103.2561s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:28.36s
Steps: 223 | Train Loss: 0.1076436 Vali Loss: 0.1237174 Test Loss: 0.1397213
Validation loss decreased (0.123758 --> 0.123717).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1117916
	speed: 0.4060s/iter; left time: 6931.2183s
	iters: 200, epoch: 24 | loss: 0.1053094
	speed: 0.1229s/iter; left time: 2085.9421s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:28.45s
Steps: 223 | Train Loss: 0.1075170 Vali Loss: 0.1242549 Test Loss: 0.1396834
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1053841
	speed: 0.3909s/iter; left time: 6585.9963s
	iters: 200, epoch: 25 | loss: 0.1098340
	speed: 0.1257s/iter; left time: 2104.7875s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:27.87s
Steps: 223 | Train Loss: 0.1074955 Vali Loss: 0.1253681 Test Loss: 0.1398134
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1112672
	speed: 0.4496s/iter; left time: 7474.9399s
	iters: 200, epoch: 26 | loss: 0.1081250
	speed: 0.2468s/iter; left time: 4078.1517s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:48.45s
Steps: 223 | Train Loss: 0.1073715 Vali Loss: 0.1239515 Test Loss: 0.1398005
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1046215
	speed: 0.6356s/iter; left time: 10426.2286s
	iters: 200, epoch: 27 | loss: 0.1099223
	speed: 0.1248s/iter; left time: 2035.3032s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:30.29s
Steps: 223 | Train Loss: 0.1072185 Vali Loss: 0.1245477 Test Loss: 0.1405662
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1015848
	speed: 0.3879s/iter; left time: 6276.5514s
	iters: 200, epoch: 28 | loss: 0.1063603
	speed: 0.1238s/iter; left time: 1991.2611s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:28.48s
Steps: 223 | Train Loss: 0.1071196 Vali Loss: 0.1245505 Test Loss: 0.1407450
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1069006
	speed: 0.5189s/iter; left time: 8280.5286s
	iters: 200, epoch: 29 | loss: 0.1105788
	speed: 0.2086s/iter; left time: 3308.3820s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:48.76s
Steps: 223 | Train Loss: 0.1070262 Vali Loss: 0.1245916 Test Loss: 0.1401049
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.1082705
	speed: 0.8010s/iter; left time: 12603.3532s
	iters: 200, epoch: 30 | loss: 0.1039594
	speed: 0.2132s/iter; left time: 3333.4611s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:49.66s
Steps: 223 | Train Loss: 0.1069801 Vali Loss: 0.1240263 Test Loss: 0.1407945
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1060863
	speed: 0.8509s/iter; left time: 13198.8991s
	iters: 200, epoch: 31 | loss: 0.1059026
	speed: 0.2570s/iter; left time: 3960.3181s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:58.35s
Steps: 223 | Train Loss: 0.1069937 Vali Loss: 0.1243488 Test Loss: 0.1395311
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1063939
	speed: 0.8256s/iter; left time: 12621.6915s
	iters: 200, epoch: 32 | loss: 0.1106143
	speed: 0.2488s/iter; left time: 3778.6330s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:56.81s
Steps: 223 | Train Loss: 0.1068519 Vali Loss: 0.1243310 Test Loss: 0.1400480
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1028770
	speed: 0.7825s/iter; left time: 11788.2613s
	iters: 200, epoch: 33 | loss: 0.1085596
	speed: 0.2671s/iter; left time: 3997.2732s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:58.78s
Steps: 223 | Train Loss: 0.1068738 Vali Loss: 0.1245206 Test Loss: 0.1404692
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04376948997378349, rmse:0.2092115879058838, mae:0.13972122967243195, rse:0.7410442233085632
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2678179
	speed: 0.2540s/iter; left time: 5640.1258s
	iters: 200, epoch: 1 | loss: 0.2601849
	speed: 0.2870s/iter; left time: 6343.8273s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:59.61s
Steps: 223 | Train Loss: 0.2700721 Vali Loss: 0.2284293 Test Loss: 0.2284866
Validation loss decreased (inf --> 0.228429).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1526771
	speed: 0.7921s/iter; left time: 17407.7969s
	iters: 200, epoch: 2 | loss: 0.1368490
	speed: 0.2312s/iter; left time: 5057.8439s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:52.45s
Steps: 223 | Train Loss: 0.1647886 Vali Loss: 0.1434907 Test Loss: 0.1514495
Validation loss decreased (0.228429 --> 0.143491).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1290625
	speed: 0.5263s/iter; left time: 11448.8424s
	iters: 200, epoch: 3 | loss: 0.1342795
	speed: 0.1253s/iter; left time: 2714.2599s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:30.66s
Steps: 223 | Train Loss: 0.1285911 Vali Loss: 0.1325456 Test Loss: 0.1435570
Validation loss decreased (0.143491 --> 0.132546).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1286276
	speed: 0.5247s/iter; left time: 11297.1592s
	iters: 200, epoch: 4 | loss: 0.1129482
	speed: 0.1466s/iter; left time: 3141.9012s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:32.95s
Steps: 223 | Train Loss: 0.1204149 Vali Loss: 0.1294772 Test Loss: 0.1390823
Validation loss decreased (0.132546 --> 0.129477).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1217600
	speed: 0.4444s/iter; left time: 9470.6474s
	iters: 200, epoch: 5 | loss: 0.1188570
	speed: 0.1338s/iter; left time: 2837.7262s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:30.74s
Steps: 223 | Train Loss: 0.1169646 Vali Loss: 0.1268400 Test Loss: 0.1379709
Validation loss decreased (0.129477 --> 0.126840).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1114642
	speed: 0.4307s/iter; left time: 9081.9841s
	iters: 200, epoch: 6 | loss: 0.1119515
	speed: 0.1303s/iter; left time: 2734.6292s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:29.80s
Steps: 223 | Train Loss: 0.1150505 Vali Loss: 0.1270903 Test Loss: 0.1384747
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1139235
	speed: 0.4103s/iter; left time: 8559.3823s
	iters: 200, epoch: 7 | loss: 0.1189825
	speed: 0.1289s/iter; left time: 2676.6936s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:29.51s
Steps: 223 | Train Loss: 0.1139136 Vali Loss: 0.1262894 Test Loss: 0.1383724
Validation loss decreased (0.126840 --> 0.126289).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1130129
	speed: 0.4018s/iter; left time: 8293.9554s
	iters: 200, epoch: 8 | loss: 0.1207840
	speed: 0.1275s/iter; left time: 2619.4440s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.59s
Steps: 223 | Train Loss: 0.1127733 Vali Loss: 0.1258684 Test Loss: 0.1373622
Validation loss decreased (0.126289 --> 0.125868).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1110505
	speed: 0.4051s/iter; left time: 8271.9044s
	iters: 200, epoch: 9 | loss: 0.1110816
	speed: 0.1264s/iter; left time: 2568.4371s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.85s
Steps: 223 | Train Loss: 0.1121919 Vali Loss: 0.1263518 Test Loss: 0.1391543
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1166428
	speed: 0.7764s/iter; left time: 15678.3245s
	iters: 200, epoch: 10 | loss: 0.1149522
	speed: 0.1712s/iter; left time: 3439.2503s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:47.23s
Steps: 223 | Train Loss: 0.1114415 Vali Loss: 0.1262719 Test Loss: 0.1381124
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1055341
	speed: 0.3971s/iter; left time: 7930.6501s
	iters: 200, epoch: 11 | loss: 0.1137167
	speed: 0.2145s/iter; left time: 4262.9801s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:40.70s
Steps: 223 | Train Loss: 0.1108182 Vali Loss: 0.1267690 Test Loss: 0.1385165
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1069434
	speed: 0.8410s/iter; left time: 16608.4448s
	iters: 200, epoch: 12 | loss: 0.1059299
	speed: 0.2371s/iter; left time: 4657.7625s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:57.53s
Steps: 223 | Train Loss: 0.1103836 Vali Loss: 0.1263347 Test Loss: 0.1401135
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1044335
	speed: 0.7244s/iter; left time: 14143.1075s
	iters: 200, epoch: 13 | loss: 0.1083170
	speed: 0.2509s/iter; left time: 4874.1541s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:54.05s
Steps: 223 | Train Loss: 0.1099808 Vali Loss: 0.1268499 Test Loss: 0.1402075
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1096646
	speed: 0.8618s/iter; left time: 16635.2676s
	iters: 200, epoch: 14 | loss: 0.1067409
	speed: 0.2504s/iter; left time: 4807.3588s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:55.99s
Steps: 223 | Train Loss: 0.1094623 Vali Loss: 0.1260219 Test Loss: 0.1396585
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1064554
	speed: 0.7868s/iter; left time: 15010.7394s
	iters: 200, epoch: 15 | loss: 0.1081098
	speed: 0.2402s/iter; left time: 4559.5156s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:55.87s
Steps: 223 | Train Loss: 0.1093660 Vali Loss: 0.1271766 Test Loss: 0.1433219
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1019990
	speed: 0.8123s/iter; left time: 15316.9019s
	iters: 200, epoch: 16 | loss: 0.1077828
	speed: 0.2168s/iter; left time: 4065.5676s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:53.67s
Steps: 223 | Train Loss: 0.1088845 Vali Loss: 0.1253926 Test Loss: 0.1404834
Validation loss decreased (0.125868 --> 0.125393).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1036045
	speed: 0.8206s/iter; left time: 15289.7479s
	iters: 200, epoch: 17 | loss: 0.1056815
	speed: 0.2338s/iter; left time: 4332.1291s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:54.17s
Steps: 223 | Train Loss: 0.1086885 Vali Loss: 0.1257666 Test Loss: 0.1409977
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1111665
	speed: 0.8052s/iter; left time: 14824.3938s
	iters: 200, epoch: 18 | loss: 0.1033416
	speed: 0.2361s/iter; left time: 4322.5970s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:56.42s
Steps: 223 | Train Loss: 0.1084472 Vali Loss: 0.1270310 Test Loss: 0.1410703
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1108564
	speed: 0.8173s/iter; left time: 14863.9069s
	iters: 200, epoch: 19 | loss: 0.1109359
	speed: 0.1586s/iter; left time: 2867.9579s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:46.60s
Steps: 223 | Train Loss: 0.1081637 Vali Loss: 0.1256811 Test Loss: 0.1405032
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1067661
	speed: 0.4018s/iter; left time: 7218.3277s
	iters: 200, epoch: 20 | loss: 0.1044444
	speed: 0.1904s/iter; left time: 3400.8446s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:34.63s
Steps: 223 | Train Loss: 0.1079339 Vali Loss: 0.1257926 Test Loss: 0.1412392
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1056872
	speed: 0.4436s/iter; left time: 7870.1020s
	iters: 200, epoch: 21 | loss: 0.1056417
	speed: 0.1299s/iter; left time: 2291.7125s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:29.73s
Steps: 223 | Train Loss: 0.1077745 Vali Loss: 0.1258196 Test Loss: 0.1431788
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1139322
	speed: 0.4151s/iter; left time: 7272.0868s
	iters: 200, epoch: 22 | loss: 0.1058415
	speed: 0.1288s/iter; left time: 2243.4018s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:30.05s
Steps: 223 | Train Loss: 0.1075359 Vali Loss: 0.1259646 Test Loss: 0.1420330
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1095286
	speed: 0.4013s/iter; left time: 6941.1695s
	iters: 200, epoch: 23 | loss: 0.1078017
	speed: 0.1243s/iter; left time: 2138.0348s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:28.58s
Steps: 223 | Train Loss: 0.1074522 Vali Loss: 0.1257875 Test Loss: 0.1423701
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1091207
	speed: 0.3856s/iter; left time: 6582.4909s
	iters: 200, epoch: 24 | loss: 0.1038631
	speed: 0.1220s/iter; left time: 2071.0148s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:27.86s
Steps: 223 | Train Loss: 0.1073591 Vali Loss: 0.1257603 Test Loss: 0.1420650
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1121939
	speed: 0.3751s/iter; left time: 6320.0785s
	iters: 200, epoch: 25 | loss: 0.1112160
	speed: 0.1183s/iter; left time: 1980.6456s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:26.75s
Steps: 223 | Train Loss: 0.1072176 Vali Loss: 0.1256680 Test Loss: 0.1424301
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1042429
	speed: 0.3613s/iter; left time: 6007.2710s
	iters: 200, epoch: 26 | loss: 0.1059490
	speed: 0.1166s/iter; left time: 1926.1155s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:25.59s
Steps: 223 | Train Loss: 0.1070919 Vali Loss: 0.1255325 Test Loss: 0.1433024
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04371935874223709, rmse:0.20909175276756287, mae:0.14048337936401367, rse:0.7406197786331177
Intermediate time for DE and pred_len 168: 01h:15m:12.16s
Intermediate time for DE: 04h:43m:27.27s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2732777
	speed: 0.1593s/iter; left time: 3553.0049s
	iters: 200, epoch: 1 | loss: 0.2720621
	speed: 0.1189s/iter; left time: 2640.2591s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:26.88s
Steps: 224 | Train Loss: 0.2827680 Vali Loss: 0.2356778 Test Loss: 0.2525736
Validation loss decreased (inf --> 0.235678).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1387694
	speed: 0.2660s/iter; left time: 5873.2732s
	iters: 200, epoch: 2 | loss: 0.1159531
	speed: 0.1170s/iter; left time: 2571.3214s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:26.58s
Steps: 224 | Train Loss: 0.1535574 Vali Loss: 0.1098190 Test Loss: 0.1249808
Validation loss decreased (0.235678 --> 0.109819).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0959700
	speed: 0.2738s/iter; left time: 5983.0666s
	iters: 200, epoch: 3 | loss: 0.0960949
	speed: 0.1120s/iter; left time: 2435.6666s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:26.70s
Steps: 224 | Train Loss: 0.1007390 Vali Loss: 0.0985863 Test Loss: 0.1108643
Validation loss decreased (0.109819 --> 0.098586).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0849966
	speed: 0.2717s/iter; left time: 5876.0580s
	iters: 200, epoch: 4 | loss: 0.0877187
	speed: 0.1096s/iter; left time: 2359.4925s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.29s
Steps: 224 | Train Loss: 0.0908397 Vali Loss: 0.0958362 Test Loss: 0.1094365
Validation loss decreased (0.098586 --> 0.095836).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0867388
	speed: 0.2666s/iter; left time: 5707.3573s
	iters: 200, epoch: 5 | loss: 0.0858547
	speed: 0.1153s/iter; left time: 2456.8784s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:26.32s
Steps: 224 | Train Loss: 0.0873146 Vali Loss: 0.0950037 Test Loss: 0.1087565
Validation loss decreased (0.095836 --> 0.095004).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0896161
	speed: 0.2761s/iter; left time: 5847.8479s
	iters: 200, epoch: 6 | loss: 0.0897431
	speed: 0.1198s/iter; left time: 2524.4589s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:27.48s
Steps: 224 | Train Loss: 0.0856580 Vali Loss: 0.0942042 Test Loss: 0.1067638
Validation loss decreased (0.095004 --> 0.094204).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0861706
	speed: 0.2637s/iter; left time: 5526.9787s
	iters: 200, epoch: 7 | loss: 0.0910879
	speed: 0.1140s/iter; left time: 2378.4567s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:27.05s
Steps: 224 | Train Loss: 0.0843104 Vali Loss: 0.0939418 Test Loss: 0.1065206
Validation loss decreased (0.094204 --> 0.093942).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0868900
	speed: 0.2711s/iter; left time: 5621.1550s
	iters: 200, epoch: 8 | loss: 0.0891830
	speed: 0.1182s/iter; left time: 2438.7115s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:26.48s
Steps: 224 | Train Loss: 0.0837029 Vali Loss: 0.0930818 Test Loss: 0.1063534
Validation loss decreased (0.093942 --> 0.093082).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0808643
	speed: 0.2609s/iter; left time: 5351.4064s
	iters: 200, epoch: 9 | loss: 0.0846620
	speed: 0.1078s/iter; left time: 2199.8499s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.56s
Steps: 224 | Train Loss: 0.0823498 Vali Loss: 0.0925918 Test Loss: 0.1057123
Validation loss decreased (0.093082 --> 0.092592).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0857914
	speed: 0.2493s/iter; left time: 5056.6801s
	iters: 200, epoch: 10 | loss: 0.0791522
	speed: 0.1132s/iter; left time: 2284.5233s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:26.10s
Steps: 224 | Train Loss: 0.0818558 Vali Loss: 0.0929591 Test Loss: 0.1057555
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0838465
	speed: 0.2463s/iter; left time: 4941.1746s
	iters: 200, epoch: 11 | loss: 0.0808435
	speed: 0.1102s/iter; left time: 2199.9180s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.52s
Steps: 224 | Train Loss: 0.0815923 Vali Loss: 0.0924967 Test Loss: 0.1059232
Validation loss decreased (0.092592 --> 0.092497).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0839619
	speed: 0.2494s/iter; left time: 4947.5902s
	iters: 200, epoch: 12 | loss: 0.0779535
	speed: 0.1063s/iter; left time: 2098.6408s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:24.05s
Steps: 224 | Train Loss: 0.0812129 Vali Loss: 0.0923236 Test Loss: 0.1048749
Validation loss decreased (0.092497 --> 0.092324).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0790549
	speed: 0.2384s/iter; left time: 4674.9738s
	iters: 200, epoch: 13 | loss: 0.0779859
	speed: 0.1020s/iter; left time: 1990.0249s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:24.04s
Steps: 224 | Train Loss: 0.0807267 Vali Loss: 0.0921772 Test Loss: 0.1047238
Validation loss decreased (0.092324 --> 0.092177).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0853954
	speed: 0.2280s/iter; left time: 4420.5453s
	iters: 200, epoch: 14 | loss: 0.0746003
	speed: 0.1086s/iter; left time: 2095.6712s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:23.85s
Steps: 224 | Train Loss: 0.0802270 Vali Loss: 0.0931399 Test Loss: 0.1056225
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0734837
	speed: 0.2246s/iter; left time: 4304.6741s
	iters: 200, epoch: 15 | loss: 0.0766692
	speed: 0.1018s/iter; left time: 1939.8838s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:22.83s
Steps: 224 | Train Loss: 0.0799810 Vali Loss: 0.0919641 Test Loss: 0.1047651
Validation loss decreased (0.092177 --> 0.091964).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0803031
	speed: 0.2228s/iter; left time: 4220.1685s
	iters: 200, epoch: 16 | loss: 0.0833222
	speed: 0.1016s/iter; left time: 1914.0706s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:22.97s
Steps: 224 | Train Loss: 0.0796829 Vali Loss: 0.0916351 Test Loss: 0.1045505
Validation loss decreased (0.091964 --> 0.091635).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0800758
	speed: 0.2198s/iter; left time: 4114.2021s
	iters: 200, epoch: 17 | loss: 0.0850667
	speed: 0.0980s/iter; left time: 1824.4082s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.22s
Steps: 224 | Train Loss: 0.0794944 Vali Loss: 0.0918174 Test Loss: 0.1047843
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0795045
	speed: 0.2113s/iter; left time: 3908.4594s
	iters: 200, epoch: 18 | loss: 0.0793329
	speed: 0.0932s/iter; left time: 1713.8002s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:21.80s
Steps: 224 | Train Loss: 0.0791213 Vali Loss: 0.0920421 Test Loss: 0.1048954
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0752362
	speed: 0.2013s/iter; left time: 3678.1749s
	iters: 200, epoch: 19 | loss: 0.0795645
	speed: 0.0969s/iter; left time: 1760.8521s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:20.73s
Steps: 224 | Train Loss: 0.0790941 Vali Loss: 0.0919640 Test Loss: 0.1051726
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0693512
	speed: 0.1863s/iter; left time: 3361.8817s
	iters: 200, epoch: 20 | loss: 0.0776814
	speed: 0.0978s/iter; left time: 1755.7089s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:21.71s
Steps: 224 | Train Loss: 0.0793341 Vali Loss: 0.0919688 Test Loss: 0.1050962
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0803427
	speed: 0.2087s/iter; left time: 3718.5319s
	iters: 200, epoch: 21 | loss: 0.0761298
	speed: 0.0889s/iter; left time: 1574.9374s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:20.47s
Steps: 224 | Train Loss: 0.0786495 Vali Loss: 0.0917224 Test Loss: 0.1051333
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0793081
	speed: 0.2028s/iter; left time: 3567.8110s
	iters: 200, epoch: 22 | loss: 0.0722682
	speed: 0.0906s/iter; left time: 1584.4225s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:20.21s
Steps: 224 | Train Loss: 0.0786959 Vali Loss: 0.0915074 Test Loss: 0.1051770
Validation loss decreased (0.091635 --> 0.091507).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0766330
	speed: 0.1931s/iter; left time: 3354.2591s
	iters: 200, epoch: 23 | loss: 0.0733423
	speed: 0.0766s/iter; left time: 1322.8655s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:19.37s
Steps: 224 | Train Loss: 0.0784980 Vali Loss: 0.0919009 Test Loss: 0.1048966
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0761709
	speed: 0.2067s/iter; left time: 3545.3543s
	iters: 200, epoch: 24 | loss: 0.0780645
	speed: 0.0825s/iter; left time: 1406.2202s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:20.35s
Steps: 224 | Train Loss: 0.0783720 Vali Loss: 0.0916299 Test Loss: 0.1046226
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0810427
	speed: 0.1965s/iter; left time: 3325.5859s
	iters: 200, epoch: 25 | loss: 0.0821714
	speed: 0.0758s/iter; left time: 1274.8388s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:19.23s
Steps: 224 | Train Loss: 0.0782597 Vali Loss: 0.0912908 Test Loss: 0.1047380
Validation loss decreased (0.091507 --> 0.091291).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0789223
	speed: 0.1849s/iter; left time: 3088.1771s
	iters: 200, epoch: 26 | loss: 0.0750540
	speed: 0.0821s/iter; left time: 1362.9461s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:18.69s
Steps: 224 | Train Loss: 0.0782287 Vali Loss: 0.0915640 Test Loss: 0.1049205
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0766358
	speed: 0.1775s/iter; left time: 2925.1618s
	iters: 200, epoch: 27 | loss: 0.0834665
	speed: 0.0866s/iter; left time: 1417.6727s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:19.13s
Steps: 224 | Train Loss: 0.0782089 Vali Loss: 0.0913870 Test Loss: 0.1050899
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0840169
	speed: 0.1819s/iter; left time: 2956.5559s
	iters: 200, epoch: 28 | loss: 0.0778707
	speed: 0.0694s/iter; left time: 1121.6788s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:17.41s
Steps: 224 | Train Loss: 0.0782109 Vali Loss: 0.0915899 Test Loss: 0.1048287
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0804981
	speed: 0.1949s/iter; left time: 3124.6053s
	iters: 200, epoch: 29 | loss: 0.0728595
	speed: 0.0791s/iter; left time: 1259.6302s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:19.02s
Steps: 224 | Train Loss: 0.0780370 Vali Loss: 0.0912884 Test Loss: 0.1044882
Validation loss decreased (0.091291 --> 0.091288).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0806050
	speed: 0.1758s/iter; left time: 2778.0758s
	iters: 200, epoch: 30 | loss: 0.0777817
	speed: 0.0778s/iter; left time: 1221.2068s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:18.24s
Steps: 224 | Train Loss: 0.0780019 Vali Loss: 0.0915458 Test Loss: 0.1049417
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0720626
	speed: 0.1814s/iter; left time: 2826.3887s
	iters: 200, epoch: 31 | loss: 0.0781787
	speed: 0.0692s/iter; left time: 1071.6669s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:17.18s
Steps: 224 | Train Loss: 0.0779044 Vali Loss: 0.0917564 Test Loss: 0.1048540
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0772920
	speed: 0.1866s/iter; left time: 2865.1041s
	iters: 200, epoch: 32 | loss: 0.0818259
	speed: 0.0688s/iter; left time: 1050.4209s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:17.17s
Steps: 224 | Train Loss: 0.0780444 Vali Loss: 0.0914081 Test Loss: 0.1050759
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0771960
	speed: 0.1838s/iter; left time: 2780.7518s
	iters: 200, epoch: 33 | loss: 0.0779091
	speed: 0.0676s/iter; left time: 1016.7202s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:17.12s
Steps: 224 | Train Loss: 0.0779376 Vali Loss: 0.0916778 Test Loss: 0.1050947
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0783090
	speed: 0.1776s/iter; left time: 2648.0884s
	iters: 200, epoch: 34 | loss: 0.0801738
	speed: 0.0753s/iter; left time: 1114.4776s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:17.48s
Steps: 224 | Train Loss: 0.0778886 Vali Loss: 0.0916403 Test Loss: 0.1051711
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0825290
	speed: 0.1669s/iter; left time: 2451.3214s
	iters: 200, epoch: 35 | loss: 0.0802409
	speed: 0.0659s/iter; left time: 961.4715s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.0778877 Vali Loss: 0.0913229 Test Loss: 0.1050001
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0749355
	speed: 0.1694s/iter; left time: 2449.4018s
	iters: 200, epoch: 36 | loss: 0.0816746
	speed: 0.0678s/iter; left time: 973.0413s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:17.83s
Steps: 224 | Train Loss: 0.0777349 Vali Loss: 0.0917867 Test Loss: 0.1050216
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0813361
	speed: 0.1550s/iter; left time: 2206.3937s
	iters: 200, epoch: 37 | loss: 0.0754358
	speed: 0.0675s/iter; left time: 953.8513s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:16.45s
Steps: 224 | Train Loss: 0.0777111 Vali Loss: 0.0916470 Test Loss: 0.1050093
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0793837
	speed: 0.1662s/iter; left time: 2328.3784s
	iters: 200, epoch: 38 | loss: 0.0736020
	speed: 0.0722s/iter; left time: 1005.0475s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:16.68s
Steps: 224 | Train Loss: 0.0778182 Vali Loss: 0.0913163 Test Loss: 0.1047526
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0812351
	speed: 0.1567s/iter; left time: 2160.7461s
	iters: 200, epoch: 39 | loss: 0.0750793
	speed: 0.0675s/iter; left time: 924.2459s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:16.39s
Steps: 224 | Train Loss: 0.0778398 Vali Loss: 0.0914048 Test Loss: 0.1049108
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02613024413585663, rmse:0.16164852678775787, mae:0.10448814183473587, rse:0.5576415657997131
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2829589
	speed: 0.0706s/iter; left time: 1574.6817s
	iters: 200, epoch: 1 | loss: 0.2735544
	speed: 0.0784s/iter; left time: 1741.4684s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:16.50s
Steps: 224 | Train Loss: 0.2834174 Vali Loss: 0.2331240 Test Loss: 0.2490584
Validation loss decreased (inf --> 0.233124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1386662
	speed: 0.1546s/iter; left time: 3412.6168s
	iters: 200, epoch: 2 | loss: 0.1143011
	speed: 0.0729s/iter; left time: 1602.4080s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:16.68s
Steps: 224 | Train Loss: 0.1521513 Vali Loss: 0.1101775 Test Loss: 0.1256462
Validation loss decreased (0.233124 --> 0.110177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0974621
	speed: 0.1689s/iter; left time: 3690.2675s
	iters: 200, epoch: 3 | loss: 0.0961546
	speed: 0.0702s/iter; left time: 1526.9723s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.1001052 Vali Loss: 0.0974129 Test Loss: 0.1106429
Validation loss decreased (0.110177 --> 0.097413).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0973717
	speed: 0.1634s/iter; left time: 3533.6434s
	iters: 200, epoch: 4 | loss: 0.0828793
	speed: 0.0742s/iter; left time: 1596.5897s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:16.70s
Steps: 224 | Train Loss: 0.0902158 Vali Loss: 0.0951305 Test Loss: 0.1084296
Validation loss decreased (0.097413 --> 0.095130).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0863252
	speed: 0.1674s/iter; left time: 3583.7488s
	iters: 200, epoch: 5 | loss: 0.0836697
	speed: 0.0606s/iter; left time: 1291.1068s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.59s
Steps: 224 | Train Loss: 0.0872277 Vali Loss: 0.1001542 Test Loss: 0.1112641
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0821471
	speed: 0.1599s/iter; left time: 3387.2966s
	iters: 200, epoch: 6 | loss: 0.0882102
	speed: 0.0687s/iter; left time: 1448.5095s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:16.84s
Steps: 224 | Train Loss: 0.0855210 Vali Loss: 0.0939254 Test Loss: 0.1064992
Validation loss decreased (0.095130 --> 0.093925).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0843503
	speed: 0.1536s/iter; left time: 3219.2537s
	iters: 200, epoch: 7 | loss: 0.0793133
	speed: 0.0652s/iter; left time: 1360.3741s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:16.27s
Steps: 224 | Train Loss: 0.0841044 Vali Loss: 0.0936347 Test Loss: 0.1060433
Validation loss decreased (0.093925 --> 0.093635).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0857669
	speed: 0.1635s/iter; left time: 3388.8228s
	iters: 200, epoch: 8 | loss: 0.0738804
	speed: 0.0657s/iter; left time: 1356.3408s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:16.23s
Steps: 224 | Train Loss: 0.0832240 Vali Loss: 0.0942479 Test Loss: 0.1066506
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0770256
	speed: 0.1586s/iter; left time: 3252.2215s
	iters: 200, epoch: 9 | loss: 0.0815676
	speed: 0.0693s/iter; left time: 1414.7578s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:16.05s
Steps: 224 | Train Loss: 0.0824953 Vali Loss: 0.0954476 Test Loss: 0.1074440
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0811249
	speed: 0.1573s/iter; left time: 3190.3890s
	iters: 200, epoch: 10 | loss: 0.0843753
	speed: 0.0686s/iter; left time: 1385.5921s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:16.28s
Steps: 224 | Train Loss: 0.0820141 Vali Loss: 0.0959082 Test Loss: 0.1079797
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0834924
	speed: 0.1458s/iter; left time: 2925.4068s
	iters: 200, epoch: 11 | loss: 0.0825599
	speed: 0.0648s/iter; left time: 1293.3809s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.0818041 Vali Loss: 0.0939030 Test Loss: 0.1064604
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0840865
	speed: 0.1496s/iter; left time: 2967.7773s
	iters: 200, epoch: 12 | loss: 0.0901997
	speed: 0.0647s/iter; left time: 1277.2168s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.24s
Steps: 224 | Train Loss: 0.0811319 Vali Loss: 0.0924839 Test Loss: 0.1059597
Validation loss decreased (0.093635 --> 0.092484).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0816619
	speed: 0.1471s/iter; left time: 2885.1935s
	iters: 200, epoch: 13 | loss: 0.0857115
	speed: 0.0622s/iter; left time: 1212.8690s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.57s
Steps: 224 | Train Loss: 0.0808126 Vali Loss: 0.0922774 Test Loss: 0.1050042
Validation loss decreased (0.092484 --> 0.092277).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0798821
	speed: 0.1452s/iter; left time: 2815.4868s
	iters: 200, epoch: 14 | loss: 0.0821096
	speed: 0.0596s/iter; left time: 1148.8547s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.13s
Steps: 224 | Train Loss: 0.0803621 Vali Loss: 0.0928964 Test Loss: 0.1051456
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0801050
	speed: 0.1417s/iter; left time: 2715.9222s
	iters: 200, epoch: 15 | loss: 0.0803853
	speed: 0.0608s/iter; left time: 1159.7432s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0800876 Vali Loss: 0.0925348 Test Loss: 0.1050143
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0779930
	speed: 0.1426s/iter; left time: 2701.2965s
	iters: 200, epoch: 16 | loss: 0.0760460
	speed: 0.0613s/iter; left time: 1154.6692s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.24s
Steps: 224 | Train Loss: 0.0800769 Vali Loss: 0.0919332 Test Loss: 0.1048650
Validation loss decreased (0.092277 --> 0.091933).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0779226
	speed: 0.1445s/iter; left time: 2704.1343s
	iters: 200, epoch: 17 | loss: 0.0824409
	speed: 0.0601s/iter; left time: 1119.4918s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.36s
Steps: 224 | Train Loss: 0.0796293 Vali Loss: 0.0919880 Test Loss: 0.1047408
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0836078
	speed: 0.1426s/iter; left time: 2637.2727s
	iters: 200, epoch: 18 | loss: 0.0755881
	speed: 0.0616s/iter; left time: 1133.3184s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:14.34s
Steps: 224 | Train Loss: 0.0793821 Vali Loss: 0.0935409 Test Loss: 0.1057734
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0789372
	speed: 0.1441s/iter; left time: 2631.7090s
	iters: 200, epoch: 19 | loss: 0.0822771
	speed: 0.0639s/iter; left time: 1161.2007s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.66s
Steps: 224 | Train Loss: 0.0792881 Vali Loss: 0.0920678 Test Loss: 0.1049124
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0803816
	speed: 0.1377s/iter; left time: 2485.4572s
	iters: 200, epoch: 20 | loss: 0.0725582
	speed: 0.0629s/iter; left time: 1129.3756s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:14.42s
Steps: 224 | Train Loss: 0.0792481 Vali Loss: 0.0923251 Test Loss: 0.1047930
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0782624
	speed: 0.1479s/iter; left time: 2636.5923s
	iters: 200, epoch: 21 | loss: 0.0807235
	speed: 0.0613s/iter; left time: 1086.9552s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:14.35s
Steps: 224 | Train Loss: 0.0791205 Vali Loss: 0.0915585 Test Loss: 0.1047115
Validation loss decreased (0.091933 --> 0.091559).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0774362
	speed: 0.1436s/iter; left time: 2526.3506s
	iters: 200, epoch: 22 | loss: 0.0750218
	speed: 0.0652s/iter; left time: 1141.3035s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:15.12s
Steps: 224 | Train Loss: 0.0788140 Vali Loss: 0.0915766 Test Loss: 0.1046148
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0835078
	speed: 0.1657s/iter; left time: 2878.9221s
	iters: 200, epoch: 23 | loss: 0.0831055
	speed: 0.0622s/iter; left time: 1074.8287s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:16.68s
Steps: 224 | Train Loss: 0.0787915 Vali Loss: 0.0916489 Test Loss: 0.1047008
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0767098
	speed: 0.2093s/iter; left time: 3589.0231s
	iters: 200, epoch: 24 | loss: 0.0781655
	speed: 0.1273s/iter; left time: 2170.9226s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:27.76s
Steps: 224 | Train Loss: 0.0785680 Vali Loss: 0.0916642 Test Loss: 0.1045094
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0748016
	speed: 0.2687s/iter; left time: 4547.6541s
	iters: 200, epoch: 25 | loss: 0.0803296
	speed: 0.0989s/iter; left time: 1664.2259s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:27.99s
Steps: 224 | Train Loss: 0.0785531 Vali Loss: 0.0927032 Test Loss: 0.1051954
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0785484
	speed: 0.2619s/iter; left time: 4373.8124s
	iters: 200, epoch: 26 | loss: 0.0780891
	speed: 0.0738s/iter; left time: 1224.9797s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:20.72s
Steps: 224 | Train Loss: 0.0785391 Vali Loss: 0.0919392 Test Loss: 0.1046671
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0818643
	speed: 0.1645s/iter; left time: 2710.7259s
	iters: 200, epoch: 27 | loss: 0.0832281
	speed: 0.0771s/iter; left time: 1261.9662s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:17.18s
Steps: 224 | Train Loss: 0.0783988 Vali Loss: 0.0916684 Test Loss: 0.1046386
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0819602
	speed: 0.1616s/iter; left time: 2626.0116s
	iters: 200, epoch: 28 | loss: 0.0757173
	speed: 0.0965s/iter; left time: 1558.6478s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:18.74s
Steps: 224 | Train Loss: 0.0783943 Vali Loss: 0.0918128 Test Loss: 0.1046350
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0791748
	speed: 0.1647s/iter; left time: 2639.6766s
	iters: 200, epoch: 29 | loss: 0.0760127
	speed: 0.0707s/iter; left time: 1125.9012s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:17.13s
Steps: 224 | Train Loss: 0.0782546 Vali Loss: 0.0918441 Test Loss: 0.1047709
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0866583
	speed: 0.2445s/iter; left time: 3863.6753s
	iters: 200, epoch: 30 | loss: 0.0805861
	speed: 0.1218s/iter; left time: 1913.3439s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:27.96s
Steps: 224 | Train Loss: 0.0782145 Vali Loss: 0.0920427 Test Loss: 0.1048282
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0793006
	speed: 0.2284s/iter; left time: 3559.3344s
	iters: 200, epoch: 31 | loss: 0.0783196
	speed: 0.1508s/iter; left time: 2334.8935s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:27.79s
Steps: 224 | Train Loss: 0.0782091 Vali Loss: 0.0913861 Test Loss: 0.1045544
Validation loss decreased (0.091559 --> 0.091386).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0755953
	speed: 0.2049s/iter; left time: 3146.5898s
	iters: 200, epoch: 32 | loss: 0.0780552
	speed: 0.0609s/iter; left time: 928.7024s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:15.95s
Steps: 224 | Train Loss: 0.0781753 Vali Loss: 0.0913696 Test Loss: 0.1045366
Validation loss decreased (0.091386 --> 0.091370).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0786503
	speed: 0.1734s/iter; left time: 2624.4935s
	iters: 200, epoch: 33 | loss: 0.0741667
	speed: 0.0691s/iter; left time: 1038.9701s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0781753 Vali Loss: 0.0915798 Test Loss: 0.1045586
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0758473
	speed: 0.1742s/iter; left time: 2596.8696s
	iters: 200, epoch: 34 | loss: 0.0814890
	speed: 0.0687s/iter; left time: 1017.3928s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:18.19s
Steps: 224 | Train Loss: 0.0779901 Vali Loss: 0.0914310 Test Loss: 0.1044736
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0816251
	speed: 0.1587s/iter; left time: 2329.9572s
	iters: 200, epoch: 35 | loss: 0.0792780
	speed: 0.0690s/iter; left time: 1006.6384s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:15.85s
Steps: 224 | Train Loss: 0.0780430 Vali Loss: 0.0911854 Test Loss: 0.1043826
Validation loss decreased (0.091370 --> 0.091185).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0775518
	speed: 0.2167s/iter; left time: 3134.2909s
	iters: 200, epoch: 36 | loss: 0.0818657
	speed: 0.1418s/iter; left time: 2035.7948s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:30.25s
Steps: 224 | Train Loss: 0.0780594 Vali Loss: 0.0915816 Test Loss: 0.1045595
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0740627
	speed: 0.3494s/iter; left time: 4973.8520s
	iters: 200, epoch: 37 | loss: 0.0784322
	speed: 0.1255s/iter; left time: 1774.2076s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:29.86s
Steps: 224 | Train Loss: 0.0780414 Vali Loss: 0.0913854 Test Loss: 0.1044060
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0747805
	speed: 0.2479s/iter; left time: 3474.0910s
	iters: 200, epoch: 38 | loss: 0.0861316
	speed: 0.0821s/iter; left time: 1141.8509s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:19.09s
Steps: 224 | Train Loss: 0.0780091 Vali Loss: 0.0919002 Test Loss: 0.1047737
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0760940
	speed: 0.1696s/iter; left time: 2338.9796s
	iters: 200, epoch: 39 | loss: 0.0777859
	speed: 0.0720s/iter; left time: 985.4523s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:17.27s
Steps: 224 | Train Loss: 0.0779444 Vali Loss: 0.0914011 Test Loss: 0.1044038
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0799233
	speed: 0.1604s/iter; left time: 2176.3779s
	iters: 200, epoch: 40 | loss: 0.0754051
	speed: 0.0875s/iter; left time: 1177.5335s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:17.56s
Steps: 224 | Train Loss: 0.0778833 Vali Loss: 0.0916526 Test Loss: 0.1045305
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0744100
	speed: 0.1493s/iter; left time: 1991.2059s
	iters: 200, epoch: 41 | loss: 0.0791146
	speed: 0.0655s/iter; left time: 867.8199s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.28s
Steps: 224 | Train Loss: 0.0779660 Vali Loss: 0.0917087 Test Loss: 0.1047505
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0800332
	speed: 0.1913s/iter; left time: 2509.8755s
	iters: 200, epoch: 42 | loss: 0.0824590
	speed: 0.0591s/iter; left time: 769.8429s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:16.63s
Steps: 224 | Train Loss: 0.0779900 Vali Loss: 0.0919105 Test Loss: 0.1049223
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0784396
	speed: 0.2539s/iter; left time: 3274.0653s
	iters: 200, epoch: 43 | loss: 0.0829708
	speed: 0.0926s/iter; left time: 1184.7503s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:25.16s
Steps: 224 | Train Loss: 0.0778764 Vali Loss: 0.0915392 Test Loss: 0.1046613
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0719128
	speed: 0.2764s/iter; left time: 3502.1654s
	iters: 200, epoch: 44 | loss: 0.0779391
	speed: 0.1366s/iter; left time: 1717.3136s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:31.28s
Steps: 224 | Train Loss: 0.0778312 Vali Loss: 0.0913401 Test Loss: 0.1044554
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0845949
	speed: 0.1742s/iter; left time: 2168.5268s
	iters: 200, epoch: 45 | loss: 0.0814397
	speed: 0.0779s/iter; left time: 961.6872s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:17.66s
Steps: 224 | Train Loss: 0.0778472 Vali Loss: 0.0912811 Test Loss: 0.1044334
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02611997351050377, rmse:0.1616167426109314, mae:0.10438255965709686, rse:0.5575319528579712
Intermediate time for GB and pred_len 24: 00h:39m:38.10s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2811899
	speed: 0.1164s/iter; left time: 2595.9715s
	iters: 200, epoch: 1 | loss: 0.2773139
	speed: 0.0718s/iter; left time: 1594.9705s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.37s
Steps: 224 | Train Loss: 0.2828053 Vali Loss: 0.2358261 Test Loss: 0.2561615
Validation loss decreased (inf --> 0.235826).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1466443
	speed: 0.2590s/iter; left time: 5718.1337s
	iters: 200, epoch: 2 | loss: 0.1285976
	speed: 0.0777s/iter; left time: 1707.7011s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:21.21s
Steps: 224 | Train Loss: 0.1596364 Vali Loss: 0.1324323 Test Loss: 0.1522585
Validation loss decreased (0.235826 --> 0.132432).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1164060
	speed: 0.3459s/iter; left time: 7559.5957s
	iters: 200, epoch: 3 | loss: 0.1118729
	speed: 0.1181s/iter; left time: 2570.0235s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.08s
Steps: 224 | Train Loss: 0.1175868 Vali Loss: 0.1226253 Test Loss: 0.1469084
Validation loss decreased (0.132432 --> 0.122625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1088176
	speed: 0.3606s/iter; left time: 7799.0243s
	iters: 200, epoch: 4 | loss: 0.1094141
	speed: 0.0826s/iter; left time: 1778.8423s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:21.56s
Steps: 224 | Train Loss: 0.1116613 Vali Loss: 0.1230795 Test Loss: 0.1469986
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1095746
	speed: 0.2305s/iter; left time: 4932.9279s
	iters: 200, epoch: 5 | loss: 0.1039534
	speed: 0.0688s/iter; left time: 1464.8872s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:16.67s
Steps: 224 | Train Loss: 0.1092688 Vali Loss: 0.1258865 Test Loss: 0.1509726
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1110413
	speed: 0.2478s/iter; left time: 5248.2462s
	iters: 200, epoch: 6 | loss: 0.1123277
	speed: 0.0686s/iter; left time: 1446.7752s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:16.02s
Steps: 224 | Train Loss: 0.1075262 Vali Loss: 0.1218966 Test Loss: 0.1459282
Validation loss decreased (0.122625 --> 0.121897).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1124330
	speed: 0.2333s/iter; left time: 4888.2375s
	iters: 200, epoch: 7 | loss: 0.1046457
	speed: 0.1071s/iter; left time: 2233.8870s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.15s
Steps: 224 | Train Loss: 0.1067450 Vali Loss: 0.1230637 Test Loss: 0.1489426
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1063998
	speed: 0.3851s/iter; left time: 7984.5527s
	iters: 200, epoch: 8 | loss: 0.1066169
	speed: 0.1001s/iter; left time: 2064.8213s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:24.59s
Steps: 224 | Train Loss: 0.1057111 Vali Loss: 0.1230550 Test Loss: 0.1487140
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1042437
	speed: 0.3712s/iter; left time: 7612.3887s
	iters: 200, epoch: 9 | loss: 0.1064159
	speed: 0.0718s/iter; left time: 1464.5632s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:17.22s
Steps: 224 | Train Loss: 0.1051231 Vali Loss: 0.1218349 Test Loss: 0.1465024
Validation loss decreased (0.121897 --> 0.121835).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1070441
	speed: 0.1986s/iter; left time: 4028.5260s
	iters: 200, epoch: 10 | loss: 0.1019509
	speed: 0.0737s/iter; left time: 1488.3854s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.63s
Steps: 224 | Train Loss: 0.1045971 Vali Loss: 0.1219275 Test Loss: 0.1472034
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1038086
	speed: 0.2153s/iter; left time: 4319.1777s
	iters: 200, epoch: 11 | loss: 0.1048296
	speed: 0.0640s/iter; left time: 1277.7282s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:16.65s
Steps: 224 | Train Loss: 0.1043262 Vali Loss: 0.1218618 Test Loss: 0.1466882
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1061131
	speed: 0.1973s/iter; left time: 3913.8148s
	iters: 200, epoch: 12 | loss: 0.1024074
	speed: 0.0624s/iter; left time: 1231.0938s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.89s
Steps: 224 | Train Loss: 0.1040099 Vali Loss: 0.1222625 Test Loss: 0.1484645
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1036150
	speed: 0.1952s/iter; left time: 3827.6572s
	iters: 200, epoch: 13 | loss: 0.1049463
	speed: 0.0851s/iter; left time: 1661.0372s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:17.04s
Steps: 224 | Train Loss: 0.1034427 Vali Loss: 0.1218187 Test Loss: 0.1478378
Validation loss decreased (0.121835 --> 0.121819).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1026465
	speed: 0.2463s/iter; left time: 4775.7503s
	iters: 200, epoch: 14 | loss: 0.1020778
	speed: 0.1032s/iter; left time: 1991.1147s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:24.77s
Steps: 224 | Train Loss: 0.1031087 Vali Loss: 0.1234696 Test Loss: 0.1482420
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0989395
	speed: 0.3182s/iter; left time: 6098.3201s
	iters: 200, epoch: 15 | loss: 0.1011934
	speed: 0.0821s/iter; left time: 1565.0466s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:21.93s
Steps: 224 | Train Loss: 0.1032518 Vali Loss: 0.1219308 Test Loss: 0.1483418
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1068590
	speed: 0.2983s/iter; left time: 5649.9136s
	iters: 200, epoch: 16 | loss: 0.1081710
	speed: 0.0667s/iter; left time: 1256.6036s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:17.73s
Steps: 224 | Train Loss: 0.1028392 Vali Loss: 0.1229158 Test Loss: 0.1500667
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1007148
	speed: 0.2202s/iter; left time: 4122.3242s
	iters: 200, epoch: 17 | loss: 0.1020223
	speed: 0.0608s/iter; left time: 1132.6131s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:15.85s
Steps: 224 | Train Loss: 0.1024451 Vali Loss: 0.1222682 Test Loss: 0.1486770
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1035123
	speed: 0.2271s/iter; left time: 4199.2190s
	iters: 200, epoch: 18 | loss: 0.1021960
	speed: 0.0655s/iter; left time: 1204.7211s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:16.09s
Steps: 224 | Train Loss: 0.1023276 Vali Loss: 0.1229518 Test Loss: 0.1491501
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1033197
	speed: 0.2293s/iter; left time: 4188.6240s
	iters: 200, epoch: 19 | loss: 0.1077417
	speed: 0.0896s/iter; left time: 1627.3379s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:18.79s
Steps: 224 | Train Loss: 0.1022994 Vali Loss: 0.1221497 Test Loss: 0.1489767
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0977007
	speed: 0.3307s/iter; left time: 5966.8420s
	iters: 200, epoch: 20 | loss: 0.1003424
	speed: 0.1091s/iter; left time: 1957.5521s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:22.50s
Steps: 224 | Train Loss: 0.1019455 Vali Loss: 0.1224613 Test Loss: 0.1499345
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1033141
	speed: 0.3064s/iter; left time: 5460.2180s
	iters: 200, epoch: 21 | loss: 0.0951334
	speed: 0.0655s/iter; left time: 1161.4873s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:16.34s
Steps: 224 | Train Loss: 0.1018706 Vali Loss: 0.1225154 Test Loss: 0.1498047
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1002901
	speed: 0.2018s/iter; left time: 3551.8717s
	iters: 200, epoch: 22 | loss: 0.1056146
	speed: 0.0621s/iter; left time: 1085.9538s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:14.27s
Steps: 224 | Train Loss: 0.1018136 Vali Loss: 0.1228043 Test Loss: 0.1500367
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1037120
	speed: 0.2035s/iter; left time: 3534.6647s
	iters: 200, epoch: 23 | loss: 0.1074599
	speed: 0.0601s/iter; left time: 1037.8713s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.1016899 Vali Loss: 0.1222177 Test Loss: 0.1494471
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.046170711517333984, rmse:0.21487371623516083, mae:0.1478378027677536, rse:0.74306321144104
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2751544
	speed: 0.0942s/iter; left time: 2101.0951s
	iters: 200, epoch: 1 | loss: 0.2690022
	speed: 0.0601s/iter; left time: 1334.4382s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:16.91s
Steps: 224 | Train Loss: 0.2880403 Vali Loss: 0.2443856 Test Loss: 0.2635888
Validation loss decreased (inf --> 0.244386).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1471211
	speed: 0.2997s/iter; left time: 6615.6465s
	iters: 200, epoch: 2 | loss: 0.1257094
	speed: 0.0893s/iter; left time: 1961.6868s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:23.45s
Steps: 224 | Train Loss: 0.1623488 Vali Loss: 0.1323770 Test Loss: 0.1548301
Validation loss decreased (0.244386 --> 0.132377).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1156411
	speed: 0.3138s/iter; left time: 6856.9776s
	iters: 200, epoch: 3 | loss: 0.1155942
	speed: 0.1012s/iter; left time: 2202.0368s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:21.94s
Steps: 224 | Train Loss: 0.1178669 Vali Loss: 0.1236418 Test Loss: 0.1486955
Validation loss decreased (0.132377 --> 0.123642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1115227
	speed: 0.1962s/iter; left time: 4243.3604s
	iters: 200, epoch: 4 | loss: 0.1097663
	speed: 0.0605s/iter; left time: 1301.7081s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.94s
Steps: 224 | Train Loss: 0.1110766 Vali Loss: 0.1231859 Test Loss: 0.1460845
Validation loss decreased (0.123642 --> 0.123186).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1064800
	speed: 0.1808s/iter; left time: 3870.5084s
	iters: 200, epoch: 5 | loss: 0.1035658
	speed: 0.0740s/iter; left time: 1576.5757s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:16.05s
Steps: 224 | Train Loss: 0.1089646 Vali Loss: 0.1240072 Test Loss: 0.1480751
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1063515
	speed: 0.1845s/iter; left time: 3908.7830s
	iters: 200, epoch: 6 | loss: 0.1103406
	speed: 0.0590s/iter; left time: 1243.6748s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.04s
Steps: 224 | Train Loss: 0.1076616 Vali Loss: 0.1230691 Test Loss: 0.1457833
Validation loss decreased (0.123186 --> 0.123069).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1019193
	speed: 0.2065s/iter; left time: 4326.9002s
	iters: 200, epoch: 7 | loss: 0.1002145
	speed: 0.1017s/iter; left time: 2122.1129s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.10s
Steps: 224 | Train Loss: 0.1072305 Vali Loss: 0.1227324 Test Loss: 0.1465946
Validation loss decreased (0.123069 --> 0.122732).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1047203
	speed: 0.3192s/iter; left time: 6617.9938s
	iters: 200, epoch: 8 | loss: 0.1054557
	speed: 0.1202s/iter; left time: 2479.0844s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:26.34s
Steps: 224 | Train Loss: 0.1056827 Vali Loss: 0.1223315 Test Loss: 0.1469460
Validation loss decreased (0.122732 --> 0.122332).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1066574
	speed: 0.4266s/iter; left time: 8749.6327s
	iters: 200, epoch: 9 | loss: 0.1028503
	speed: 0.0600s/iter; left time: 1223.9317s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:17.05s
Steps: 224 | Train Loss: 0.1047605 Vali Loss: 0.1237396 Test Loss: 0.1499159
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1034151
	speed: 0.2063s/iter; left time: 4183.8318s
	iters: 200, epoch: 10 | loss: 0.1038620
	speed: 0.0622s/iter; left time: 1255.4163s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.80s
Steps: 224 | Train Loss: 0.1044648 Vali Loss: 0.1228130 Test Loss: 0.1473190
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1017232
	speed: 0.1879s/iter; left time: 3768.4609s
	iters: 200, epoch: 11 | loss: 0.1019154
	speed: 0.0727s/iter; left time: 1451.7768s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.93s
Steps: 224 | Train Loss: 0.1040054 Vali Loss: 0.1216314 Test Loss: 0.1474853
Validation loss decreased (0.122332 --> 0.121631).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1020506
	speed: 0.1901s/iter; left time: 3770.7642s
	iters: 200, epoch: 12 | loss: 0.1037784
	speed: 0.0616s/iter; left time: 1215.1654s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.14s
Steps: 224 | Train Loss: 0.1035084 Vali Loss: 0.1222913 Test Loss: 0.1485128
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1061251
	speed: 0.1796s/iter; left time: 3521.5960s
	iters: 200, epoch: 13 | loss: 0.1065978
	speed: 0.1081s/iter; left time: 2109.1766s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:20.77s
Steps: 224 | Train Loss: 0.1032757 Vali Loss: 0.1229722 Test Loss: 0.1485819
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0994283
	speed: 0.4018s/iter; left time: 7789.9260s
	iters: 200, epoch: 14 | loss: 0.1047804
	speed: 0.0800s/iter; left time: 1543.3809s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:21.42s
Steps: 224 | Train Loss: 0.1029077 Vali Loss: 0.1216839 Test Loss: 0.1486514
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1024000
	speed: 0.2913s/iter; left time: 5583.0224s
	iters: 200, epoch: 15 | loss: 0.1030937
	speed: 0.0827s/iter; left time: 1577.5060s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:21.54s
Steps: 224 | Train Loss: 0.1025582 Vali Loss: 0.1223017 Test Loss: 0.1490696
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0989172
	speed: 0.2044s/iter; left time: 3871.5684s
	iters: 200, epoch: 16 | loss: 0.0993790
	speed: 0.0609s/iter; left time: 1148.0605s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.74s
Steps: 224 | Train Loss: 0.1024495 Vali Loss: 0.1216694 Test Loss: 0.1483023
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0984783
	speed: 0.1802s/iter; left time: 3372.8909s
	iters: 200, epoch: 17 | loss: 0.1007645
	speed: 0.0590s/iter; left time: 1098.4165s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:13.61s
Steps: 224 | Train Loss: 0.1021411 Vali Loss: 0.1231461 Test Loss: 0.1493856
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1034188
	speed: 0.1685s/iter; left time: 3116.8703s
	iters: 200, epoch: 18 | loss: 0.1061611
	speed: 0.0596s/iter; left time: 1096.2874s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:13.64s
Steps: 224 | Train Loss: 0.1021219 Vali Loss: 0.1220998 Test Loss: 0.1483709
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1036211
	speed: 0.1679s/iter; left time: 3068.2041s
	iters: 200, epoch: 19 | loss: 0.1033579
	speed: 0.0588s/iter; left time: 1068.9463s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:13.45s
Steps: 224 | Train Loss: 0.1019313 Vali Loss: 0.1223465 Test Loss: 0.1501660
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1007602
	speed: 0.1474s/iter; left time: 2659.6100s
	iters: 200, epoch: 20 | loss: 0.0987899
	speed: 0.0598s/iter; left time: 1072.6115s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:14.00s
Steps: 224 | Train Loss: 0.1019313 Vali Loss: 0.1230411 Test Loss: 0.1515038
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1043691
	speed: 0.1531s/iter; left time: 2728.1489s
	iters: 200, epoch: 21 | loss: 0.0983655
	speed: 0.0591s/iter; left time: 1046.8257s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:13.66s
Steps: 224 | Train Loss: 0.1017233 Vali Loss: 0.1221559 Test Loss: 0.1496819
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04573627561330795, rmse:0.2138604074716568, mae:0.14748531579971313, rse:0.7395591139793396
Intermediate time for GB and pred_len 96: 00h:23m:58.78s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2805795
	speed: 0.0849s/iter; left time: 1885.6805s
	iters: 200, epoch: 1 | loss: 0.2665880
	speed: 0.0614s/iter; left time: 1356.6211s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.00s
Steps: 223 | Train Loss: 0.2841599 Vali Loss: 0.2366052 Test Loss: 0.2561878
Validation loss decreased (inf --> 0.236605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1437043
	speed: 0.1577s/iter; left time: 3466.4891s
	iters: 200, epoch: 2 | loss: 0.1314376
	speed: 0.0556s/iter; left time: 1216.1913s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:13.36s
Steps: 223 | Train Loss: 0.1595849 Vali Loss: 0.1343092 Test Loss: 0.1558792
Validation loss decreased (0.236605 --> 0.134309).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1214988
	speed: 0.1700s/iter; left time: 3697.9901s
	iters: 200, epoch: 3 | loss: 0.1159652
	speed: 0.0588s/iter; left time: 1274.0544s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.59s
Steps: 223 | Train Loss: 0.1207849 Vali Loss: 0.1272497 Test Loss: 0.1550700
Validation loss decreased (0.134309 --> 0.127250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1159328
	speed: 0.1418s/iter; left time: 3053.5483s
	iters: 200, epoch: 4 | loss: 0.1211720
	speed: 0.0612s/iter; left time: 1312.2880s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.03s
Steps: 223 | Train Loss: 0.1156752 Vali Loss: 0.1275790 Test Loss: 0.1541177
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1087668
	speed: 0.1580s/iter; left time: 3366.7634s
	iters: 200, epoch: 5 | loss: 0.1183135
	speed: 0.0562s/iter; left time: 1190.9281s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:13.18s
Steps: 223 | Train Loss: 0.1133053 Vali Loss: 0.1288943 Test Loss: 0.1578989
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1145881
	speed: 0.1673s/iter; left time: 3528.1159s
	iters: 200, epoch: 6 | loss: 0.1126134
	speed: 0.0593s/iter; left time: 1244.6455s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:13.74s
Steps: 223 | Train Loss: 0.1121655 Vali Loss: 0.1262892 Test Loss: 0.1520014
Validation loss decreased (0.127250 --> 0.126289).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1098545
	speed: 0.1616s/iter; left time: 3370.9452s
	iters: 200, epoch: 7 | loss: 0.1040441
	speed: 0.0599s/iter; left time: 1244.0221s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.64s
Steps: 223 | Train Loss: 0.1106994 Vali Loss: 0.1270565 Test Loss: 0.1523455
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1078050
	speed: 0.1713s/iter; left time: 3536.6142s
	iters: 200, epoch: 8 | loss: 0.1134647
	speed: 0.0600s/iter; left time: 1233.3576s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:13.69s
Steps: 223 | Train Loss: 0.1100026 Vali Loss: 0.1262635 Test Loss: 0.1524508
Validation loss decreased (0.126289 --> 0.126264).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1121218
	speed: 0.1585s/iter; left time: 3236.1811s
	iters: 200, epoch: 9 | loss: 0.1042695
	speed: 0.0580s/iter; left time: 1178.1435s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:13.38s
Steps: 223 | Train Loss: 0.1092496 Vali Loss: 0.1265422 Test Loss: 0.1536072
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1061702
	speed: 0.1732s/iter; left time: 3497.8461s
	iters: 200, epoch: 10 | loss: 0.1068518
	speed: 0.0563s/iter; left time: 1131.4124s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:13.31s
Steps: 223 | Train Loss: 0.1091715 Vali Loss: 0.1272561 Test Loss: 0.1545485
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1064177
	speed: 0.1674s/iter; left time: 3343.7573s
	iters: 200, epoch: 11 | loss: 0.1081345
	speed: 0.0590s/iter; left time: 1171.5186s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:13.38s
Steps: 223 | Train Loss: 0.1083997 Vali Loss: 0.1283244 Test Loss: 0.1554234
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1033464
	speed: 0.1701s/iter; left time: 3359.9938s
	iters: 200, epoch: 12 | loss: 0.1067691
	speed: 0.0559s/iter; left time: 1097.5961s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.11s
Steps: 223 | Train Loss: 0.1080228 Vali Loss: 0.1280793 Test Loss: 0.1546156
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1089391
	speed: 0.1657s/iter; left time: 3234.5999s
	iters: 200, epoch: 13 | loss: 0.1101136
	speed: 0.0599s/iter; left time: 1163.4084s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:13.87s
Steps: 223 | Train Loss: 0.1076153 Vali Loss: 0.1262170 Test Loss: 0.1541574
Validation loss decreased (0.126264 --> 0.126217).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1080553
	speed: 0.1651s/iter; left time: 3186.0856s
	iters: 200, epoch: 14 | loss: 0.1076848
	speed: 0.0611s/iter; left time: 1172.9437s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:13.68s
Steps: 223 | Train Loss: 0.1074516 Vali Loss: 0.1272199 Test Loss: 0.1567310
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1082365
	speed: 0.1709s/iter; left time: 3261.1932s
	iters: 200, epoch: 15 | loss: 0.1119653
	speed: 0.0600s/iter; left time: 1137.9151s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.84s
Steps: 223 | Train Loss: 0.1071711 Vali Loss: 0.1278471 Test Loss: 0.1553990
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1057544
	speed: 0.1682s/iter; left time: 3172.3196s
	iters: 200, epoch: 16 | loss: 0.1113250
	speed: 0.0594s/iter; left time: 1113.6443s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:13.67s
Steps: 223 | Train Loss: 0.1068134 Vali Loss: 0.1272139 Test Loss: 0.1558869
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1057327
	speed: 0.1719s/iter; left time: 3203.1942s
	iters: 200, epoch: 17 | loss: 0.1119125
	speed: 0.0580s/iter; left time: 1074.5981s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:13.52s
Steps: 223 | Train Loss: 0.1066584 Vali Loss: 0.1278494 Test Loss: 0.1559488
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1080534
	speed: 0.1719s/iter; left time: 3165.4081s
	iters: 200, epoch: 18 | loss: 0.1061387
	speed: 0.0597s/iter; left time: 1093.4072s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:13.76s
Steps: 223 | Train Loss: 0.1064652 Vali Loss: 0.1271346 Test Loss: 0.1559392
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1063600
	speed: 0.1490s/iter; left time: 2709.2162s
	iters: 200, epoch: 19 | loss: 0.1053678
	speed: 0.0583s/iter; left time: 1053.9979s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:13.65s
Steps: 223 | Train Loss: 0.1064515 Vali Loss: 0.1278743 Test Loss: 0.1555194
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1093144
	speed: 0.1677s/iter; left time: 3012.0809s
	iters: 200, epoch: 20 | loss: 0.1053254
	speed: 0.0618s/iter; left time: 1104.8155s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:13.98s
Steps: 223 | Train Loss: 0.1061429 Vali Loss: 0.1276555 Test Loss: 0.1559118
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1056989
	speed: 0.1685s/iter; left time: 2988.6161s
	iters: 200, epoch: 21 | loss: 0.1070963
	speed: 0.0593s/iter; left time: 1046.5392s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:13.62s
Steps: 223 | Train Loss: 0.1060465 Vali Loss: 0.1272785 Test Loss: 0.1558666
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1043583
	speed: 0.1519s/iter; left time: 2660.4587s
	iters: 200, epoch: 22 | loss: 0.1117992
	speed: 0.0588s/iter; left time: 1024.5183s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:13.43s
Steps: 223 | Train Loss: 0.1059251 Vali Loss: 0.1277202 Test Loss: 0.1564436
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1069213
	speed: 0.1528s/iter; left time: 2643.4708s
	iters: 200, epoch: 23 | loss: 0.1089702
	speed: 0.0589s/iter; left time: 1013.3399s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:13.49s
Steps: 223 | Train Loss: 0.1058554 Vali Loss: 0.1273729 Test Loss: 0.1572211
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04950212314724922, rmse:0.22249072790145874, mae:0.1541573852300644, rse:0.7714073061943054
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2798281
	speed: 0.0685s/iter; left time: 1520.2324s
	iters: 200, epoch: 1 | loss: 0.2796101
	speed: 0.0579s/iter; left time: 1279.9032s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.03s
Steps: 223 | Train Loss: 0.2874158 Vali Loss: 0.2419178 Test Loss: 0.2583910
Validation loss decreased (inf --> 0.241918).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1470139
	speed: 0.1576s/iter; left time: 3464.6054s
	iters: 200, epoch: 2 | loss: 0.1360404
	speed: 0.0580s/iter; left time: 1268.1784s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:13.40s
Steps: 223 | Train Loss: 0.1620429 Vali Loss: 0.1324001 Test Loss: 0.1555783
Validation loss decreased (0.241918 --> 0.132400).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1224503
	speed: 0.1718s/iter; left time: 3736.6508s
	iters: 200, epoch: 3 | loss: 0.1194079
	speed: 0.0587s/iter; left time: 1270.1073s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.65s
Steps: 223 | Train Loss: 0.1209563 Vali Loss: 0.1285254 Test Loss: 0.1587481
Validation loss decreased (0.132400 --> 0.128525).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1190334
	speed: 0.1627s/iter; left time: 3503.9184s
	iters: 200, epoch: 4 | loss: 0.1133567
	speed: 0.0560s/iter; left time: 1199.3982s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.24s
Steps: 223 | Train Loss: 0.1153008 Vali Loss: 0.1266772 Test Loss: 0.1528318
Validation loss decreased (0.128525 --> 0.126677).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1166971
	speed: 0.1708s/iter; left time: 3639.9572s
	iters: 200, epoch: 5 | loss: 0.1135501
	speed: 0.0578s/iter; left time: 1225.6723s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:13.40s
Steps: 223 | Train Loss: 0.1133565 Vali Loss: 0.1270372 Test Loss: 0.1530850
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1116466
	speed: 0.1672s/iter; left time: 3526.5418s
	iters: 200, epoch: 6 | loss: 0.1131961
	speed: 0.0581s/iter; left time: 1219.9708s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:13.44s
Steps: 223 | Train Loss: 0.1120323 Vali Loss: 0.1262882 Test Loss: 0.1512015
Validation loss decreased (0.126677 --> 0.126288).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1110709
	speed: 0.1718s/iter; left time: 3583.3838s
	iters: 200, epoch: 7 | loss: 0.1122461
	speed: 0.0614s/iter; left time: 1275.0331s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.80s
Steps: 223 | Train Loss: 0.1107886 Vali Loss: 0.1260154 Test Loss: 0.1505157
Validation loss decreased (0.126288 --> 0.126015).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1137041
	speed: 0.1548s/iter; left time: 3196.0656s
	iters: 200, epoch: 8 | loss: 0.1114934
	speed: 0.0569s/iter; left time: 1168.1100s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:13.18s
Steps: 223 | Train Loss: 0.1101817 Vali Loss: 0.1283005 Test Loss: 0.1520257
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1082447
	speed: 0.1606s/iter; left time: 3279.4971s
	iters: 200, epoch: 9 | loss: 0.1085083
	speed: 0.0554s/iter; left time: 1126.3157s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:13.23s
Steps: 223 | Train Loss: 0.1093660 Vali Loss: 0.1273274 Test Loss: 0.1535498
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1132136
	speed: 0.1588s/iter; left time: 3207.6975s
	iters: 200, epoch: 10 | loss: 0.1100807
	speed: 0.0587s/iter; left time: 1179.8049s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:13.31s
Steps: 223 | Train Loss: 0.1087154 Vali Loss: 0.1264748 Test Loss: 0.1527026
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1092578
	speed: 0.1699s/iter; left time: 3393.8324s
	iters: 200, epoch: 11 | loss: 0.1136826
	speed: 0.0583s/iter; left time: 1158.3641s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.05s
Steps: 223 | Train Loss: 0.1083815 Vali Loss: 0.1259720 Test Loss: 0.1532263
Validation loss decreased (0.126015 --> 0.125972).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1047081
	speed: 0.1624s/iter; left time: 3206.5003s
	iters: 200, epoch: 12 | loss: 0.1076780
	speed: 0.0587s/iter; left time: 1152.7582s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.47s
Steps: 223 | Train Loss: 0.1078201 Vali Loss: 0.1269041 Test Loss: 0.1554941
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1085408
	speed: 0.1379s/iter; left time: 2692.8286s
	iters: 200, epoch: 13 | loss: 0.1136421
	speed: 0.0578s/iter; left time: 1121.9046s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:13.30s
Steps: 223 | Train Loss: 0.1075764 Vali Loss: 0.1262433 Test Loss: 0.1552299
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1109355
	speed: 0.1441s/iter; left time: 2780.7429s
	iters: 200, epoch: 14 | loss: 0.1060089
	speed: 0.0551s/iter; left time: 1058.6062s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.90s
Steps: 223 | Train Loss: 0.1072533 Vali Loss: 0.1278901 Test Loss: 0.1560870
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1082978
	speed: 0.1564s/iter; left time: 2983.1299s
	iters: 200, epoch: 15 | loss: 0.1049112
	speed: 0.0587s/iter; left time: 1113.8211s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.76s
Steps: 223 | Train Loss: 0.1070636 Vali Loss: 0.1279757 Test Loss: 0.1570617
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1055828
	speed: 0.1409s/iter; left time: 2657.3262s
	iters: 200, epoch: 16 | loss: 0.1024492
	speed: 0.0575s/iter; left time: 1079.2855s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:13.07s
Steps: 223 | Train Loss: 0.1068914 Vali Loss: 0.1279063 Test Loss: 0.1571817
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1027009
	speed: 0.1499s/iter; left time: 2792.4229s
	iters: 200, epoch: 17 | loss: 0.1086375
	speed: 0.0528s/iter; left time: 979.2464s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.1065439 Vali Loss: 0.1273960 Test Loss: 0.1578892
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1072937
	speed: 0.1340s/iter; left time: 2467.6887s
	iters: 200, epoch: 18 | loss: 0.1089958
	speed: 0.0556s/iter; left time: 1018.9116s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.86s
Steps: 223 | Train Loss: 0.1064188 Vali Loss: 0.1278954 Test Loss: 0.1574066
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1050638
	speed: 0.1598s/iter; left time: 2906.7842s
	iters: 200, epoch: 19 | loss: 0.1049717
	speed: 0.0538s/iter; left time: 972.5369s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:13.06s
Steps: 223 | Train Loss: 0.1062466 Vali Loss: 0.1284166 Test Loss: 0.1578706
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1094487
	speed: 0.1204s/iter; left time: 2163.2699s
	iters: 200, epoch: 20 | loss: 0.1091652
	speed: 0.0589s/iter; left time: 1052.0845s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:13.53s
Steps: 223 | Train Loss: 0.1061791 Vali Loss: 0.1281609 Test Loss: 0.1586148
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1061795
	speed: 0.1071s/iter; left time: 1899.4123s
	iters: 200, epoch: 21 | loss: 0.1096702
	speed: 0.0575s/iter; left time: 1014.4477s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:12.72s
Steps: 223 | Train Loss: 0.1059624 Vali Loss: 0.1275128 Test Loss: 0.1575601
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.049270931631326675, rmse:0.2219705581665039, mae:0.15322630107402802, rse:0.7696038484573364
Intermediate time for GB and pred_len 168: 00h:16m:10.15s
Intermediate time for GB: 01h:19m:47.03s

=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2716131
	speed: 0.0620s/iter; left time: 1383.3947s
	iters: 200, epoch: 1 | loss: 0.2593319
	speed: 0.0391s/iter; left time: 867.3466s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.33s
Steps: 224 | Train Loss: 0.2778731 Vali Loss: 0.2073302 Test Loss: 0.2330006
Validation loss decreased (inf --> 0.207330).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1464825
	speed: 0.0917s/iter; left time: 2025.3139s
	iters: 200, epoch: 2 | loss: 0.1116916
	speed: 0.0403s/iter; left time: 886.3790s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.30s
Steps: 224 | Train Loss: 0.1571436 Vali Loss: 0.0884075 Test Loss: 0.0956739
Validation loss decreased (0.207330 --> 0.088407).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0997519
	speed: 0.0871s/iter; left time: 1903.5526s
	iters: 200, epoch: 3 | loss: 0.0955165
	speed: 0.0422s/iter; left time: 918.6867s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.1000043 Vali Loss: 0.0812965 Test Loss: 0.0899712
Validation loss decreased (0.088407 --> 0.081297).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0840793
	speed: 0.0827s/iter; left time: 1788.2187s
	iters: 200, epoch: 4 | loss: 0.0856045
	speed: 0.0376s/iter; left time: 809.2258s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0867236 Vali Loss: 0.0711788 Test Loss: 0.0805066
Validation loss decreased (0.081297 --> 0.071179).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0740249
	speed: 0.0972s/iter; left time: 2080.6764s
	iters: 200, epoch: 5 | loss: 0.0783605
	speed: 0.0430s/iter; left time: 916.4188s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.23s
Steps: 224 | Train Loss: 0.0776597 Vali Loss: 0.0685233 Test Loss: 0.0805469
Validation loss decreased (0.071179 --> 0.068523).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0707931
	speed: 0.0821s/iter; left time: 1739.6779s
	iters: 200, epoch: 6 | loss: 0.0718116
	speed: 0.0350s/iter; left time: 738.3943s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0726654 Vali Loss: 0.0661333 Test Loss: 0.0771873
Validation loss decreased (0.068523 --> 0.066133).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0774625
	speed: 0.0936s/iter; left time: 1962.0807s
	iters: 200, epoch: 7 | loss: 0.0722932
	speed: 0.0373s/iter; left time: 777.0009s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.90s
Steps: 224 | Train Loss: 0.0704756 Vali Loss: 0.0649412 Test Loss: 0.0773020
Validation loss decreased (0.066133 --> 0.064941).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0697776
	speed: 0.0982s/iter; left time: 2036.4373s
	iters: 200, epoch: 8 | loss: 0.0655571
	speed: 0.0415s/iter; left time: 856.7596s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0686286 Vali Loss: 0.0638556 Test Loss: 0.0769916
Validation loss decreased (0.064941 --> 0.063856).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0665638
	speed: 0.0914s/iter; left time: 1875.5252s
	iters: 200, epoch: 9 | loss: 0.0648902
	speed: 0.0407s/iter; left time: 830.7965s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.25s
Steps: 224 | Train Loss: 0.0675502 Vali Loss: 0.0635374 Test Loss: 0.0782119
Validation loss decreased (0.063856 --> 0.063537).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0682065
	speed: 0.0917s/iter; left time: 1859.4762s
	iters: 200, epoch: 10 | loss: 0.0665417
	speed: 0.0391s/iter; left time: 789.7248s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.25s
Steps: 224 | Train Loss: 0.0668213 Vali Loss: 0.0628312 Test Loss: 0.0764607
Validation loss decreased (0.063537 --> 0.062831).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0680640
	speed: 0.0975s/iter; left time: 1955.9046s
	iters: 200, epoch: 11 | loss: 0.0630656
	speed: 0.0399s/iter; left time: 797.4271s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0660543 Vali Loss: 0.0619433 Test Loss: 0.0762425
Validation loss decreased (0.062831 --> 0.061943).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0638028
	speed: 0.0978s/iter; left time: 1940.1685s
	iters: 200, epoch: 12 | loss: 0.0652062
	speed: 0.0392s/iter; left time: 772.8119s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.50s
Steps: 224 | Train Loss: 0.0650445 Vali Loss: 0.0612709 Test Loss: 0.0755187
Validation loss decreased (0.061943 --> 0.061271).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0625371
	speed: 0.0945s/iter; left time: 1853.4836s
	iters: 200, epoch: 13 | loss: 0.0627733
	speed: 0.0363s/iter; left time: 708.9159s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.15s
Steps: 224 | Train Loss: 0.0645904 Vali Loss: 0.0615720 Test Loss: 0.0754482
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0650286
	speed: 0.0848s/iter; left time: 1644.9258s
	iters: 200, epoch: 14 | loss: 0.0635685
	speed: 0.0462s/iter; left time: 890.6692s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.17s
Steps: 224 | Train Loss: 0.0643176 Vali Loss: 0.0610712 Test Loss: 0.0745695
Validation loss decreased (0.061271 --> 0.061071).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0648136
	speed: 0.0905s/iter; left time: 1734.2314s
	iters: 200, epoch: 15 | loss: 0.0631165
	speed: 0.0389s/iter; left time: 742.0290s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.11s
Steps: 224 | Train Loss: 0.0635331 Vali Loss: 0.0606045 Test Loss: 0.0749791
Validation loss decreased (0.061071 --> 0.060605).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0590337
	speed: 0.0887s/iter; left time: 1679.6016s
	iters: 200, epoch: 16 | loss: 0.0637494
	speed: 0.0352s/iter; left time: 662.8242s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.61s
Steps: 224 | Train Loss: 0.0633014 Vali Loss: 0.0602402 Test Loss: 0.0740316
Validation loss decreased (0.060605 --> 0.060240).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0605904
	speed: 0.0786s/iter; left time: 1471.0012s
	iters: 200, epoch: 17 | loss: 0.0624010
	speed: 0.0415s/iter; left time: 771.7794s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.05s
Steps: 224 | Train Loss: 0.0635225 Vali Loss: 0.0603043 Test Loss: 0.0742424
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0593180
	speed: 0.0895s/iter; left time: 1655.1360s
	iters: 200, epoch: 18 | loss: 0.0632965
	speed: 0.0242s/iter; left time: 445.4323s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.18s
Steps: 224 | Train Loss: 0.0626809 Vali Loss: 0.0599838 Test Loss: 0.0740956
Validation loss decreased (0.060240 --> 0.059984).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0612943
	speed: 0.0816s/iter; left time: 1491.1073s
	iters: 200, epoch: 19 | loss: 0.0634427
	speed: 0.0350s/iter; left time: 636.5802s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.39s
Steps: 224 | Train Loss: 0.0624049 Vali Loss: 0.0601246 Test Loss: 0.0740726
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0614391
	speed: 0.0861s/iter; left time: 1553.4367s
	iters: 200, epoch: 20 | loss: 0.0655361
	speed: 0.0386s/iter; left time: 692.0164s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.80s
Steps: 224 | Train Loss: 0.0622837 Vali Loss: 0.0598788 Test Loss: 0.0742467
Validation loss decreased (0.059984 --> 0.059879).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0737994
	speed: 0.0778s/iter; left time: 1386.7130s
	iters: 200, epoch: 21 | loss: 0.0640391
	speed: 0.0393s/iter; left time: 695.5571s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.95s
Steps: 224 | Train Loss: 0.0619410 Vali Loss: 0.0596888 Test Loss: 0.0747392
Validation loss decreased (0.059879 --> 0.059689).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0621355
	speed: 0.0939s/iter; left time: 1651.9794s
	iters: 200, epoch: 22 | loss: 0.0603194
	speed: 0.0355s/iter; left time: 621.1457s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.64s
Steps: 224 | Train Loss: 0.0623530 Vali Loss: 0.0593907 Test Loss: 0.0727883
Validation loss decreased (0.059689 --> 0.059391).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0599057
	speed: 0.0696s/iter; left time: 1208.6553s
	iters: 200, epoch: 23 | loss: 0.0608324
	speed: 0.0389s/iter; left time: 671.7460s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.49s
Steps: 224 | Train Loss: 0.0618754 Vali Loss: 0.0594392 Test Loss: 0.0731889
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0604659
	speed: 0.0706s/iter; left time: 1210.1898s
	iters: 200, epoch: 24 | loss: 0.0639650
	speed: 0.0339s/iter; left time: 577.2007s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0616088 Vali Loss: 0.0591857 Test Loss: 0.0736739
Validation loss decreased (0.059391 --> 0.059186).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0660595
	speed: 0.0760s/iter; left time: 1285.8850s
	iters: 200, epoch: 25 | loss: 0.0597431
	speed: 0.0265s/iter; left time: 446.3799s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.75s
Steps: 224 | Train Loss: 0.0615581 Vali Loss: 0.0593212 Test Loss: 0.0740524
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0617152
	speed: 0.0735s/iter; left time: 1228.1243s
	iters: 200, epoch: 26 | loss: 0.0594254
	speed: 0.0368s/iter; left time: 610.8378s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.37s
Steps: 224 | Train Loss: 0.0615665 Vali Loss: 0.0591473 Test Loss: 0.0734034
Validation loss decreased (0.059186 --> 0.059147).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0603081
	speed: 0.0733s/iter; left time: 1208.1742s
	iters: 200, epoch: 27 | loss: 0.0647205
	speed: 0.0368s/iter; left time: 602.9465s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0614026 Vali Loss: 0.0591085 Test Loss: 0.0735312
Validation loss decreased (0.059147 --> 0.059109).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0578692
	speed: 0.0729s/iter; left time: 1185.1252s
	iters: 200, epoch: 28 | loss: 0.0589528
	speed: 0.0384s/iter; left time: 620.8163s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.17s
Steps: 224 | Train Loss: 0.0612589 Vali Loss: 0.0589551 Test Loss: 0.0731288
Validation loss decreased (0.059109 --> 0.058955).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0601848
	speed: 0.0752s/iter; left time: 1205.6722s
	iters: 200, epoch: 29 | loss: 0.0609453
	speed: 0.0392s/iter; left time: 624.2129s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.48s
Steps: 224 | Train Loss: 0.0614763 Vali Loss: 0.0590970 Test Loss: 0.0733710
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0587087
	speed: 0.0745s/iter; left time: 1177.9392s
	iters: 200, epoch: 30 | loss: 0.0610784
	speed: 0.0302s/iter; left time: 473.7506s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.24s
Steps: 224 | Train Loss: 0.0610941 Vali Loss: 0.0589220 Test Loss: 0.0737904
Validation loss decreased (0.058955 --> 0.058922).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0618162
	speed: 0.0837s/iter; left time: 1304.7752s
	iters: 200, epoch: 31 | loss: 0.0635032
	speed: 0.0337s/iter; left time: 521.7064s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.16s
Steps: 224 | Train Loss: 0.0614045 Vali Loss: 0.0595656 Test Loss: 0.0737262
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0616083
	speed: 0.0818s/iter; left time: 1256.1973s
	iters: 200, epoch: 32 | loss: 0.0572779
	speed: 0.0290s/iter; left time: 442.6399s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0610035 Vali Loss: 0.0588141 Test Loss: 0.0732145
Validation loss decreased (0.058922 --> 0.058814).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0620334
	speed: 0.0694s/iter; left time: 1049.9153s
	iters: 200, epoch: 33 | loss: 0.0603480
	speed: 0.0357s/iter; left time: 536.0171s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0609497 Vali Loss: 0.0586152 Test Loss: 0.0732236
Validation loss decreased (0.058814 --> 0.058615).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0654920
	speed: 0.0833s/iter; left time: 1241.2000s
	iters: 200, epoch: 34 | loss: 0.0584530
	speed: 0.0329s/iter; left time: 486.9258s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0609431 Vali Loss: 0.0586743 Test Loss: 0.0730879
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0600631
	speed: 0.0670s/iter; left time: 984.3613s
	iters: 200, epoch: 35 | loss: 0.0608742
	speed: 0.0353s/iter; left time: 514.2754s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0609527 Vali Loss: 0.0587862 Test Loss: 0.0733456
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0629283
	speed: 0.0846s/iter; left time: 1223.3680s
	iters: 200, epoch: 36 | loss: 0.0615985
	speed: 0.0253s/iter; left time: 363.3484s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.21s
Steps: 224 | Train Loss: 0.0608360 Vali Loss: 0.0586137 Test Loss: 0.0733216
Validation loss decreased (0.058615 --> 0.058614).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0615572
	speed: 0.0742s/iter; left time: 1055.9211s
	iters: 200, epoch: 37 | loss: 0.0602170
	speed: 0.0370s/iter; left time: 523.4378s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0607253 Vali Loss: 0.0586815 Test Loss: 0.0732841
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0578529
	speed: 0.0791s/iter; left time: 1108.4269s
	iters: 200, epoch: 38 | loss: 0.0618689
	speed: 0.0283s/iter; left time: 393.2660s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0608215 Vali Loss: 0.0586132 Test Loss: 0.0734925
Validation loss decreased (0.058614 --> 0.058613).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0601412
	speed: 0.0563s/iter; left time: 776.3001s
	iters: 200, epoch: 39 | loss: 0.0578164
	speed: 0.0357s/iter; left time: 488.4868s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0605890 Vali Loss: 0.0586529 Test Loss: 0.0735201
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0572843
	speed: 0.0871s/iter; left time: 1181.4842s
	iters: 200, epoch: 40 | loss: 0.0614513
	speed: 0.0296s/iter; left time: 398.7391s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0606020 Vali Loss: 0.0585021 Test Loss: 0.0733150
Validation loss decreased (0.058613 --> 0.058502).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0591269
	speed: 0.0710s/iter; left time: 947.3505s
	iters: 200, epoch: 41 | loss: 0.0607502
	speed: 0.0395s/iter; left time: 522.5833s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.49s
Steps: 224 | Train Loss: 0.0606079 Vali Loss: 0.0586638 Test Loss: 0.0733574
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0627736
	speed: 0.0682s/iter; left time: 894.4352s
	iters: 200, epoch: 42 | loss: 0.0601050
	speed: 0.0368s/iter; left time: 479.2024s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0605499 Vali Loss: 0.0586009 Test Loss: 0.0735421
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0562877
	speed: 0.0699s/iter; left time: 901.3944s
	iters: 200, epoch: 43 | loss: 0.0592064
	speed: 0.0338s/iter; left time: 432.1572s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0607410 Vali Loss: 0.0587485 Test Loss: 0.0736325
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0617348
	speed: 0.0743s/iter; left time: 941.2455s
	iters: 200, epoch: 44 | loss: 0.0614126
	speed: 0.0228s/iter; left time: 287.0035s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.89s
Steps: 224 | Train Loss: 0.0606123 Vali Loss: 0.0585737 Test Loss: 0.0734087
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0604446
	speed: 0.0831s/iter; left time: 1034.3857s
	iters: 200, epoch: 45 | loss: 0.0666469
	speed: 0.0344s/iter; left time: 424.2265s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.49s
Steps: 224 | Train Loss: 0.0605810 Vali Loss: 0.0584803 Test Loss: 0.0734012
Validation loss decreased (0.058502 --> 0.058480).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0582605
	speed: 0.0660s/iter; left time: 806.1261s
	iters: 200, epoch: 46 | loss: 0.0636819
	speed: 0.0245s/iter; left time: 296.8228s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.99s
Steps: 224 | Train Loss: 0.0605376 Vali Loss: 0.0584897 Test Loss: 0.0730279
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0617488
	speed: 0.0779s/iter; left time: 934.4499s
	iters: 200, epoch: 47 | loss: 0.0661087
	speed: 0.0372s/iter; left time: 443.1035s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.64s
Steps: 224 | Train Loss: 0.0605746 Vali Loss: 0.0586828 Test Loss: 0.0737944
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0613210
	speed: 0.0762s/iter; left time: 897.5516s
	iters: 200, epoch: 48 | loss: 0.0577578
	speed: 0.0254s/iter; left time: 296.6563s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.41s
Steps: 224 | Train Loss: 0.0606481 Vali Loss: 0.0584786 Test Loss: 0.0732720
Validation loss decreased (0.058480 --> 0.058479).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0596579
	speed: 0.0717s/iter; left time: 828.3484s
	iters: 200, epoch: 49 | loss: 0.0626817
	speed: 0.0383s/iter; left time: 438.9985s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.78s
Steps: 224 | Train Loss: 0.0605355 Vali Loss: 0.0583748 Test Loss: 0.0731672
Validation loss decreased (0.058479 --> 0.058375).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0622368
	speed: 0.0666s/iter; left time: 754.4371s
	iters: 200, epoch: 50 | loss: 0.0606601
	speed: 0.0258s/iter; left time: 289.6600s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0604692 Vali Loss: 0.0586458 Test Loss: 0.0736936
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0577491
	speed: 0.0610s/iter; left time: 676.9807s
	iters: 200, epoch: 51 | loss: 0.0616590
	speed: 0.0350s/iter; left time: 385.4991s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0607899 Vali Loss: 0.0584731 Test Loss: 0.0731942
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0627529
	speed: 0.0751s/iter; left time: 816.6876s
	iters: 200, epoch: 52 | loss: 0.0618755
	speed: 0.0307s/iter; left time: 331.0471s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0604956 Vali Loss: 0.0586692 Test Loss: 0.0737382
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0614029
	speed: 0.0553s/iter; left time: 589.1858s
	iters: 200, epoch: 53 | loss: 0.0634207
	speed: 0.0347s/iter; left time: 366.5371s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0604386 Vali Loss: 0.0585684 Test Loss: 0.0734891
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0619802
	speed: 0.0707s/iter; left time: 737.7474s
	iters: 200, epoch: 54 | loss: 0.0586568
	speed: 0.0297s/iter; left time: 307.2079s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:07.03s
Steps: 224 | Train Loss: 0.0604947 Vali Loss: 0.0586781 Test Loss: 0.0738493
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0597096
	speed: 0.0553s/iter; left time: 563.8997s
	iters: 200, epoch: 55 | loss: 0.0618582
	speed: 0.0256s/iter; left time: 258.3619s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.89s
Steps: 224 | Train Loss: 0.0606621 Vali Loss: 0.0585085 Test Loss: 0.0733606
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0586016
	speed: 0.0746s/iter; left time: 744.5528s
	iters: 200, epoch: 56 | loss: 0.0651014
	speed: 0.0333s/iter; left time: 329.0567s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:07.74s
Steps: 224 | Train Loss: 0.0605923 Vali Loss: 0.0586657 Test Loss: 0.0734124
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0601418
	speed: 0.0625s/iter; left time: 610.0345s
	iters: 200, epoch: 57 | loss: 0.0607323
	speed: 0.0314s/iter; left time: 303.5014s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.86s
Steps: 224 | Train Loss: 0.0605401 Vali Loss: 0.0586670 Test Loss: 0.0736131
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0585449
	speed: 0.0747s/iter; left time: 712.1006s
	iters: 200, epoch: 58 | loss: 0.0581753
	speed: 0.0363s/iter; left time: 342.1683s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0603512 Vali Loss: 0.0585405 Test Loss: 0.0733575
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0599505
	speed: 0.0640s/iter; left time: 595.9604s
	iters: 200, epoch: 59 | loss: 0.0574748
	speed: 0.0280s/iter; left time: 257.9884s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0603631 Vali Loss: 0.0584929 Test Loss: 0.0734470
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.012924049980938435, rmse:0.11368399113416672, mae:0.07316716760396957, rse:0.33455824851989746
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2877905
	speed: 0.0373s/iter; left time: 831.3403s
	iters: 200, epoch: 1 | loss: 0.2638871
	speed: 0.0305s/iter; left time: 676.7040s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.40s
Steps: 224 | Train Loss: 0.2862083 Vali Loss: 0.2111465 Test Loss: 0.2343626
Validation loss decreased (inf --> 0.211147).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1492624
	speed: 0.0638s/iter; left time: 1407.5522s
	iters: 200, epoch: 2 | loss: 0.1152855
	speed: 0.0297s/iter; left time: 651.7953s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.87s
Steps: 224 | Train Loss: 0.1596880 Vali Loss: 0.0918335 Test Loss: 0.0994620
Validation loss decreased (0.211147 --> 0.091833).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1029339
	speed: 0.0545s/iter; left time: 1191.4308s
	iters: 200, epoch: 3 | loss: 0.0945148
	speed: 0.0297s/iter; left time: 646.3032s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.56s
Steps: 224 | Train Loss: 0.0993995 Vali Loss: 0.0775245 Test Loss: 0.0858982
Validation loss decreased (0.091833 --> 0.077524).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0870824
	speed: 0.0561s/iter; left time: 1213.9102s
	iters: 200, epoch: 4 | loss: 0.0815023
	speed: 0.0264s/iter; left time: 568.1189s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.84s
Steps: 224 | Train Loss: 0.0860380 Vali Loss: 0.0716859 Test Loss: 0.0803887
Validation loss decreased (0.077524 --> 0.071686).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0764270
	speed: 0.0563s/iter; left time: 1204.8606s
	iters: 200, epoch: 5 | loss: 0.0755505
	speed: 0.0265s/iter; left time: 564.8742s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.01s
Steps: 224 | Train Loss: 0.0773875 Vali Loss: 0.0691720 Test Loss: 0.0884821
Validation loss decreased (0.071686 --> 0.069172).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0737963
	speed: 0.0645s/iter; left time: 1367.0448s
	iters: 200, epoch: 6 | loss: 0.0713646
	speed: 0.0243s/iter; left time: 511.4126s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0728628 Vali Loss: 0.0663896 Test Loss: 0.0809351
Validation loss decreased (0.069172 --> 0.066390).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0698943
	speed: 0.0598s/iter; left time: 1254.2241s
	iters: 200, epoch: 7 | loss: 0.0737890
	speed: 0.0333s/iter; left time: 694.4965s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0706566 Vali Loss: 0.0645864 Test Loss: 0.0816118
Validation loss decreased (0.066390 --> 0.064586).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0694184
	speed: 0.0605s/iter; left time: 1254.3143s
	iters: 200, epoch: 8 | loss: 0.0706043
	speed: 0.0228s/iter; left time: 471.4338s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.57s
Steps: 224 | Train Loss: 0.0689727 Vali Loss: 0.0638241 Test Loss: 0.0809232
Validation loss decreased (0.064586 --> 0.063824).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0660098
	speed: 0.0613s/iter; left time: 1256.9677s
	iters: 200, epoch: 9 | loss: 0.0670574
	speed: 0.0297s/iter; left time: 606.6604s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.17s
Steps: 224 | Train Loss: 0.0678072 Vali Loss: 0.0630422 Test Loss: 0.0805838
Validation loss decreased (0.063824 --> 0.063042).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0685804
	speed: 0.0573s/iter; left time: 1163.1480s
	iters: 200, epoch: 10 | loss: 0.0675971
	speed: 0.0235s/iter; left time: 474.5309s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.82s
Steps: 224 | Train Loss: 0.0666880 Vali Loss: 0.0623324 Test Loss: 0.0792666
Validation loss decreased (0.063042 --> 0.062332).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0727281
	speed: 0.0553s/iter; left time: 1109.0684s
	iters: 200, epoch: 11 | loss: 0.0697532
	speed: 0.0258s/iter; left time: 515.6125s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.87s
Steps: 224 | Train Loss: 0.0664021 Vali Loss: 0.0620938 Test Loss: 0.0790071
Validation loss decreased (0.062332 --> 0.062094).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0692039
	speed: 0.0541s/iter; left time: 1073.1026s
	iters: 200, epoch: 12 | loss: 0.0633237
	speed: 0.0251s/iter; left time: 495.6565s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.93s
Steps: 224 | Train Loss: 0.0654965 Vali Loss: 0.0614724 Test Loss: 0.0783267
Validation loss decreased (0.062094 --> 0.061472).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0663230
	speed: 0.0621s/iter; left time: 1218.6507s
	iters: 200, epoch: 13 | loss: 0.0644192
	speed: 0.0242s/iter; left time: 472.6835s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.95s
Steps: 224 | Train Loss: 0.0647666 Vali Loss: 0.0608936 Test Loss: 0.0760295
Validation loss decreased (0.061472 --> 0.060894).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0687837
	speed: 0.0548s/iter; left time: 1062.3141s
	iters: 200, epoch: 14 | loss: 0.0678449
	speed: 0.0238s/iter; left time: 459.9092s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.73s
Steps: 224 | Train Loss: 0.0643334 Vali Loss: 0.0602578 Test Loss: 0.0752936
Validation loss decreased (0.060894 --> 0.060258).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0623422
	speed: 0.0674s/iter; left time: 1291.4343s
	iters: 200, epoch: 15 | loss: 0.0661111
	speed: 0.0237s/iter; left time: 451.5521s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0640402 Vali Loss: 0.0605470 Test Loss: 0.0750898
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0681814
	speed: 0.0489s/iter; left time: 926.0799s
	iters: 200, epoch: 16 | loss: 0.0622716
	speed: 0.0267s/iter; left time: 503.5467s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.82s
Steps: 224 | Train Loss: 0.0641407 Vali Loss: 0.0607534 Test Loss: 0.0760613
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0632059
	speed: 0.0599s/iter; left time: 1121.6365s
	iters: 200, epoch: 17 | loss: 0.0677324
	speed: 0.0289s/iter; left time: 538.4307s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.70s
Steps: 224 | Train Loss: 0.0633371 Vali Loss: 0.0607128 Test Loss: 0.0756752
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0676642
	speed: 0.0636s/iter; left time: 1175.3280s
	iters: 200, epoch: 18 | loss: 0.0611327
	speed: 0.0257s/iter; left time: 472.7043s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.05s
Steps: 224 | Train Loss: 0.0631575 Vali Loss: 0.0593235 Test Loss: 0.0744360
Validation loss decreased (0.060258 --> 0.059323).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0636197
	speed: 0.0486s/iter; left time: 888.4544s
	iters: 200, epoch: 19 | loss: 0.0633235
	speed: 0.0303s/iter; left time: 549.7640s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.52s
Steps: 224 | Train Loss: 0.0627403 Vali Loss: 0.0594330 Test Loss: 0.0742841
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0635506
	speed: 0.0592s/iter; left time: 1068.4226s
	iters: 200, epoch: 20 | loss: 0.0622648
	speed: 0.0221s/iter; left time: 396.7498s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0625273 Vali Loss: 0.0590419 Test Loss: 0.0737318
Validation loss decreased (0.059323 --> 0.059042).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0619661
	speed: 0.0685s/iter; left time: 1221.0642s
	iters: 200, epoch: 21 | loss: 0.0584053
	speed: 0.0336s/iter; left time: 594.6205s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0626985 Vali Loss: 0.0592678 Test Loss: 0.0749659
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0646252
	speed: 0.0499s/iter; left time: 878.0924s
	iters: 200, epoch: 22 | loss: 0.0588910
	speed: 0.0304s/iter; left time: 531.2168s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.35s
Steps: 224 | Train Loss: 0.0619731 Vali Loss: 0.0590993 Test Loss: 0.0746543
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0636457
	speed: 0.0583s/iter; left time: 1012.0700s
	iters: 200, epoch: 23 | loss: 0.0639213
	speed: 0.0262s/iter; left time: 452.7072s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.40s
Steps: 224 | Train Loss: 0.0618764 Vali Loss: 0.0595535 Test Loss: 0.0753576
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0565846
	speed: 0.0541s/iter; left time: 927.5493s
	iters: 200, epoch: 24 | loss: 0.0620618
	speed: 0.0249s/iter; left time: 425.2777s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0620649 Vali Loss: 0.0586336 Test Loss: 0.0746801
Validation loss decreased (0.059042 --> 0.058634).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0639940
	speed: 0.0610s/iter; left time: 1031.9849s
	iters: 200, epoch: 25 | loss: 0.0591630
	speed: 0.0275s/iter; left time: 462.6307s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0618124 Vali Loss: 0.0591847 Test Loss: 0.0742414
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0596955
	speed: 0.0680s/iter; left time: 1136.2434s
	iters: 200, epoch: 26 | loss: 0.0613243
	speed: 0.0220s/iter; left time: 365.0552s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.76s
Steps: 224 | Train Loss: 0.0616533 Vali Loss: 0.0583399 Test Loss: 0.0742313
Validation loss decreased (0.058634 --> 0.058340).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0597679
	speed: 0.0697s/iter; left time: 1148.5683s
	iters: 200, epoch: 27 | loss: 0.0643352
	speed: 0.0231s/iter; left time: 378.2617s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.42s
Steps: 224 | Train Loss: 0.0615879 Vali Loss: 0.0587037 Test Loss: 0.0734117
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0602489
	speed: 0.0462s/iter; left time: 750.4977s
	iters: 200, epoch: 28 | loss: 0.0589547
	speed: 0.0233s/iter; left time: 376.5196s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0613679 Vali Loss: 0.0587699 Test Loss: 0.0742184
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0589752
	speed: 0.0798s/iter; left time: 1278.5915s
	iters: 200, epoch: 29 | loss: 0.0617351
	speed: 0.0246s/iter; left time: 391.5686s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.71s
Steps: 224 | Train Loss: 0.0612729 Vali Loss: 0.0584835 Test Loss: 0.0732371
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0629638
	speed: 0.0471s/iter; left time: 743.7526s
	iters: 200, epoch: 30 | loss: 0.0575505
	speed: 0.0227s/iter; left time: 357.1753s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0615552 Vali Loss: 0.0583954 Test Loss: 0.0737525
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0595907
	speed: 0.0735s/iter; left time: 1144.9477s
	iters: 200, epoch: 31 | loss: 0.0623036
	speed: 0.0254s/iter; left time: 393.4021s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.91s
Steps: 224 | Train Loss: 0.0611098 Vali Loss: 0.0583293 Test Loss: 0.0739518
Validation loss decreased (0.058340 --> 0.058329).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0654049
	speed: 0.0634s/iter; left time: 973.5009s
	iters: 200, epoch: 32 | loss: 0.0628865
	speed: 0.0239s/iter; left time: 365.2610s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0612368 Vali Loss: 0.0582500 Test Loss: 0.0737642
Validation loss decreased (0.058329 --> 0.058250).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0642568
	speed: 0.0516s/iter; left time: 780.9929s
	iters: 200, epoch: 33 | loss: 0.0604563
	speed: 0.0368s/iter; left time: 552.5301s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.40s
Steps: 224 | Train Loss: 0.0608660 Vali Loss: 0.0581025 Test Loss: 0.0734115
Validation loss decreased (0.058250 --> 0.058103).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0618693
	speed: 0.0556s/iter; left time: 828.4284s
	iters: 200, epoch: 34 | loss: 0.0602822
	speed: 0.0223s/iter; left time: 329.6413s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.38s
Steps: 224 | Train Loss: 0.0609611 Vali Loss: 0.0583429 Test Loss: 0.0734754
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0639292
	speed: 0.0628s/iter; left time: 921.9673s
	iters: 200, epoch: 35 | loss: 0.0599125
	speed: 0.0307s/iter; left time: 447.0632s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0610319 Vali Loss: 0.0584516 Test Loss: 0.0738476
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0604735
	speed: 0.0501s/iter; left time: 723.9196s
	iters: 200, epoch: 36 | loss: 0.0553955
	speed: 0.0245s/iter; left time: 351.7939s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.77s
Steps: 224 | Train Loss: 0.0609390 Vali Loss: 0.0583936 Test Loss: 0.0738283
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0568553
	speed: 0.0560s/iter; left time: 797.2746s
	iters: 200, epoch: 37 | loss: 0.0597522
	speed: 0.0235s/iter; left time: 331.6437s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.70s
Steps: 224 | Train Loss: 0.0606664 Vali Loss: 0.0581718 Test Loss: 0.0734708
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0581451
	speed: 0.0652s/iter; left time: 913.0194s
	iters: 200, epoch: 38 | loss: 0.0630017
	speed: 0.0343s/iter; left time: 476.5427s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.44s
Steps: 224 | Train Loss: 0.0608828 Vali Loss: 0.0580958 Test Loss: 0.0737848
Validation loss decreased (0.058103 --> 0.058096).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0586447
	speed: 0.0483s/iter; left time: 666.1527s
	iters: 200, epoch: 39 | loss: 0.0649154
	speed: 0.0223s/iter; left time: 305.5510s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0607158 Vali Loss: 0.0581686 Test Loss: 0.0743360
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0599744
	speed: 0.0580s/iter; left time: 786.7101s
	iters: 200, epoch: 40 | loss: 0.0576915
	speed: 0.0330s/iter; left time: 444.4610s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.69s
Steps: 224 | Train Loss: 0.0608292 Vali Loss: 0.0581034 Test Loss: 0.0736245
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0619106
	speed: 0.0517s/iter; left time: 689.9634s
	iters: 200, epoch: 41 | loss: 0.0563842
	speed: 0.0220s/iter; left time: 291.4410s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0607239 Vali Loss: 0.0581008 Test Loss: 0.0740254
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0621693
	speed: 0.0588s/iter; left time: 771.4744s
	iters: 200, epoch: 42 | loss: 0.0602721
	speed: 0.0232s/iter; left time: 301.3904s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0607545 Vali Loss: 0.0581054 Test Loss: 0.0736836
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0579938
	speed: 0.0486s/iter; left time: 626.5627s
	iters: 200, epoch: 43 | loss: 0.0627912
	speed: 0.0244s/iter; left time: 311.9865s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.77s
Steps: 224 | Train Loss: 0.0606253 Vali Loss: 0.0581325 Test Loss: 0.0736885
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0614558
	speed: 0.0624s/iter; left time: 789.9374s
	iters: 200, epoch: 44 | loss: 0.0582512
	speed: 0.0218s/iter; left time: 274.0543s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.67s
Steps: 224 | Train Loss: 0.0605794 Vali Loss: 0.0581799 Test Loss: 0.0736219
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0598212
	speed: 0.0512s/iter; left time: 637.2990s
	iters: 200, epoch: 45 | loss: 0.0593993
	speed: 0.0308s/iter; left time: 380.3044s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.58s
Steps: 224 | Train Loss: 0.0606073 Vali Loss: 0.0579255 Test Loss: 0.0731540
Validation loss decreased (0.058096 --> 0.057925).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0618426
	speed: 0.0527s/iter; left time: 643.5973s
	iters: 200, epoch: 46 | loss: 0.0592247
	speed: 0.0283s/iter; left time: 343.2498s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0605780 Vali Loss: 0.0582018 Test Loss: 0.0738711
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0604415
	speed: 0.0539s/iter; left time: 646.9506s
	iters: 200, epoch: 47 | loss: 0.0577849
	speed: 0.0238s/iter; left time: 282.7529s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.52s
Steps: 224 | Train Loss: 0.0606646 Vali Loss: 0.0580042 Test Loss: 0.0732950
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0578090
	speed: 0.0521s/iter; left time: 612.9044s
	iters: 200, epoch: 48 | loss: 0.0599391
	speed: 0.0285s/iter; left time: 333.2084s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.43s
Steps: 224 | Train Loss: 0.0606206 Vali Loss: 0.0579175 Test Loss: 0.0728856
Validation loss decreased (0.057925 --> 0.057918).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0617991
	speed: 0.0659s/iter; left time: 761.1362s
	iters: 200, epoch: 49 | loss: 0.0634511
	speed: 0.0293s/iter; left time: 335.1870s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.68s
Steps: 224 | Train Loss: 0.0606752 Vali Loss: 0.0579695 Test Loss: 0.0735182
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0605634
	speed: 0.0667s/iter; left time: 755.3805s
	iters: 200, epoch: 50 | loss: 0.0630069
	speed: 0.0306s/iter; left time: 343.6580s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.72s
Steps: 224 | Train Loss: 0.0607077 Vali Loss: 0.0578800 Test Loss: 0.0732009
Validation loss decreased (0.057918 --> 0.057880).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0638899
	speed: 0.0516s/iter; left time: 573.1161s
	iters: 200, epoch: 51 | loss: 0.0582444
	speed: 0.0262s/iter; left time: 288.4492s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.98s
Steps: 224 | Train Loss: 0.0605479 Vali Loss: 0.0580509 Test Loss: 0.0732340
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0588226
	speed: 0.0478s/iter; left time: 519.9598s
	iters: 200, epoch: 52 | loss: 0.0580830
	speed: 0.0234s/iter; left time: 252.6863s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.44s
Steps: 224 | Train Loss: 0.0608150 Vali Loss: 0.0580036 Test Loss: 0.0732753
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0612364
	speed: 0.0732s/iter; left time: 779.3471s
	iters: 200, epoch: 53 | loss: 0.0602664
	speed: 0.0228s/iter; left time: 240.6802s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0605894 Vali Loss: 0.0578158 Test Loss: 0.0733499
Validation loss decreased (0.057880 --> 0.057816).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0612249
	speed: 0.0497s/iter; left time: 518.3190s
	iters: 200, epoch: 54 | loss: 0.0626555
	speed: 0.0226s/iter; left time: 233.5561s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0606305 Vali Loss: 0.0579054 Test Loss: 0.0728906
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0623724
	speed: 0.0559s/iter; left time: 570.5075s
	iters: 200, epoch: 55 | loss: 0.0563497
	speed: 0.0306s/iter; left time: 308.9545s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.70s
Steps: 224 | Train Loss: 0.0605508 Vali Loss: 0.0579716 Test Loss: 0.0731202
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0620142
	speed: 0.0686s/iter; left time: 684.2417s
	iters: 200, epoch: 56 | loss: 0.0586572
	speed: 0.0231s/iter; left time: 228.1796s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.69s
Steps: 224 | Train Loss: 0.0606216 Vali Loss: 0.0579800 Test Loss: 0.0732933
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0613465
	speed: 0.0533s/iter; left time: 519.7709s
	iters: 200, epoch: 57 | loss: 0.0593647
	speed: 0.0265s/iter; left time: 255.8858s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0609250 Vali Loss: 0.0579943 Test Loss: 0.0732995
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0602495
	speed: 0.0645s/iter; left time: 614.8183s
	iters: 200, epoch: 58 | loss: 0.0588583
	speed: 0.0243s/iter; left time: 229.4753s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.78s
Steps: 224 | Train Loss: 0.0604744 Vali Loss: 0.0580824 Test Loss: 0.0733517
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0596012
	speed: 0.0504s/iter; left time: 469.2024s
	iters: 200, epoch: 59 | loss: 0.0629138
	speed: 0.0239s/iter; left time: 220.4704s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.73s
Steps: 224 | Train Loss: 0.0604661 Vali Loss: 0.0578026 Test Loss: 0.0728349
Validation loss decreased (0.057816 --> 0.057803).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0583539
	speed: 0.0668s/iter; left time: 607.2010s
	iters: 200, epoch: 60 | loss: 0.0633144
	speed: 0.0229s/iter; left time: 206.1757s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.87s
Steps: 224 | Train Loss: 0.0605610 Vali Loss: 0.0577595 Test Loss: 0.0730932
Validation loss decreased (0.057803 --> 0.057759).  Saving model ...
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0619486
	speed: 0.0636s/iter; left time: 563.2169s
	iters: 200, epoch: 61 | loss: 0.0600652
	speed: 0.0231s/iter; left time: 202.2844s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:05.76s
Steps: 224 | Train Loss: 0.0605581 Vali Loss: 0.0580633 Test Loss: 0.0733728
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0612883
	speed: 0.0467s/iter; left time: 403.1129s
	iters: 200, epoch: 62 | loss: 0.0598977
	speed: 0.0291s/iter; left time: 248.8356s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0605784 Vali Loss: 0.0578533 Test Loss: 0.0728168
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0592462
	speed: 0.0572s/iter; left time: 481.2805s
	iters: 200, epoch: 63 | loss: 0.0612592
	speed: 0.0224s/iter; left time: 185.9191s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0606407 Vali Loss: 0.0581431 Test Loss: 0.0736098
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0592890
	speed: 0.0528s/iter; left time: 432.2228s
	iters: 200, epoch: 64 | loss: 0.0557728
	speed: 0.0312s/iter; left time: 252.0829s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:06.72s
Steps: 224 | Train Loss: 0.0605665 Vali Loss: 0.0579799 Test Loss: 0.0728870
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0594655
	speed: 0.0611s/iter; left time: 486.7320s
	iters: 200, epoch: 65 | loss: 0.0624393
	speed: 0.0221s/iter; left time: 173.4616s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:05.59s
Steps: 224 | Train Loss: 0.0603938 Vali Loss: 0.0579359 Test Loss: 0.0730231
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0584601
	speed: 0.0477s/iter; left time: 369.5386s
	iters: 200, epoch: 66 | loss: 0.0605349
	speed: 0.0240s/iter; left time: 183.4336s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:05.68s
Steps: 224 | Train Loss: 0.0604561 Vali Loss: 0.0581021 Test Loss: 0.0734265
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0601984
	speed: 0.0697s/iter; left time: 524.2843s
	iters: 200, epoch: 67 | loss: 0.0605302
	speed: 0.0253s/iter; left time: 187.8994s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0606215 Vali Loss: 0.0581030 Test Loss: 0.0734250
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0607060
	speed: 0.0497s/iter; left time: 362.3583s
	iters: 200, epoch: 68 | loss: 0.0581991
	speed: 0.0232s/iter; left time: 166.8285s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:05.42s
Steps: 224 | Train Loss: 0.0608544 Vali Loss: 0.0579180 Test Loss: 0.0731836
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0632075
	speed: 0.0501s/iter; left time: 354.4930s
	iters: 200, epoch: 69 | loss: 0.0613793
	speed: 0.0262s/iter; left time: 182.6931s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:05.93s
Steps: 224 | Train Loss: 0.0605738 Vali Loss: 0.0580780 Test Loss: 0.0736589
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0615018
	speed: 0.0483s/iter; left time: 330.5479s
	iters: 200, epoch: 70 | loss: 0.0607887
	speed: 0.0250s/iter; left time: 168.8374s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:05.67s
Steps: 224 | Train Loss: 0.0606270 Vali Loss: 0.0581670 Test Loss: 0.0734960
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.012619041837751865, rmse:0.11233451217412949, mae:0.0730932354927063, rse:0.33058688044548035
Intermediate time for ES and pred_len 24: 00h:21m:09.91s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2704993
	speed: 0.0560s/iter; left time: 1247.8731s
	iters: 200, epoch: 1 | loss: 0.2554511
	speed: 0.0363s/iter; left time: 806.2951s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.38s
Steps: 224 | Train Loss: 0.2778322 Vali Loss: 0.2091237 Test Loss: 0.2344305
Validation loss decreased (inf --> 0.209124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1443953
	speed: 0.0514s/iter; left time: 1135.2416s
	iters: 200, epoch: 2 | loss: 0.1187204
	speed: 0.0239s/iter; left time: 524.6010s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.57s
Steps: 224 | Train Loss: 0.1552305 Vali Loss: 0.1045255 Test Loss: 0.1173863
Validation loss decreased (0.209124 --> 0.104526).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1089211
	speed: 0.0534s/iter; left time: 1167.2588s
	iters: 200, epoch: 3 | loss: 0.1028839
	speed: 0.0225s/iter; left time: 488.3935s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.36s
Steps: 224 | Train Loss: 0.1089467 Vali Loss: 0.0931613 Test Loss: 0.1099090
Validation loss decreased (0.104526 --> 0.093161).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0921360
	speed: 0.0588s/iter; left time: 1271.9857s
	iters: 200, epoch: 4 | loss: 0.0907388
	speed: 0.0375s/iter; left time: 807.1668s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0957239 Vali Loss: 0.0871257 Test Loss: 0.1042031
Validation loss decreased (0.093161 --> 0.087126).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0918303
	speed: 0.0583s/iter; left time: 1248.3684s
	iters: 200, epoch: 5 | loss: 0.0875634
	speed: 0.0279s/iter; left time: 594.3987s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.45s
Steps: 224 | Train Loss: 0.0908779 Vali Loss: 0.0851532 Test Loss: 0.1045321
Validation loss decreased (0.087126 --> 0.085153).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0932905
	speed: 0.0527s/iter; left time: 1115.9048s
	iters: 200, epoch: 6 | loss: 0.0870134
	speed: 0.0242s/iter; left time: 510.0199s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.73s
Steps: 224 | Train Loss: 0.0886906 Vali Loss: 0.0837882 Test Loss: 0.1056718
Validation loss decreased (0.085153 --> 0.083788).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0887610
	speed: 0.0536s/iter; left time: 1122.4169s
	iters: 200, epoch: 7 | loss: 0.0822823
	speed: 0.0296s/iter; left time: 616.7336s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.44s
Steps: 224 | Train Loss: 0.0861625 Vali Loss: 0.0821757 Test Loss: 0.1054372
Validation loss decreased (0.083788 --> 0.082176).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0863238
	speed: 0.0508s/iter; left time: 1053.2908s
	iters: 200, epoch: 8 | loss: 0.0813287
	speed: 0.0239s/iter; left time: 492.1285s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.63s
Steps: 224 | Train Loss: 0.0849600 Vali Loss: 0.0809413 Test Loss: 0.1054865
Validation loss decreased (0.082176 --> 0.080941).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0837449
	speed: 0.0516s/iter; left time: 1058.5137s
	iters: 200, epoch: 9 | loss: 0.0798360
	speed: 0.0233s/iter; left time: 474.5186s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0837917 Vali Loss: 0.0810303 Test Loss: 0.1073283
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0854328
	speed: 0.0523s/iter; left time: 1061.9036s
	iters: 200, epoch: 10 | loss: 0.0859400
	speed: 0.0311s/iter; left time: 627.8248s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.46s
Steps: 224 | Train Loss: 0.0832026 Vali Loss: 0.0806594 Test Loss: 0.1060589
Validation loss decreased (0.080941 --> 0.080659).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0832818
	speed: 0.0501s/iter; left time: 1004.9937s
	iters: 200, epoch: 11 | loss: 0.0840366
	speed: 0.0228s/iter; left time: 454.8460s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.43s
Steps: 224 | Train Loss: 0.0827407 Vali Loss: 0.0801369 Test Loss: 0.1064315
Validation loss decreased (0.080659 --> 0.080137).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0837808
	speed: 0.0560s/iter; left time: 1110.2882s
	iters: 200, epoch: 12 | loss: 0.0812744
	speed: 0.0259s/iter; left time: 511.8218s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0821527 Vali Loss: 0.0798724 Test Loss: 0.1057109
Validation loss decreased (0.080137 --> 0.079872).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0783565
	speed: 0.0537s/iter; left time: 1053.0977s
	iters: 200, epoch: 13 | loss: 0.0837794
	speed: 0.0227s/iter; left time: 442.9544s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.66s
Steps: 224 | Train Loss: 0.0817536 Vali Loss: 0.0803160 Test Loss: 0.1077637
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0762014
	speed: 0.0508s/iter; left time: 984.4545s
	iters: 200, epoch: 14 | loss: 0.0786795
	speed: 0.0295s/iter; left time: 569.4708s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.39s
Steps: 224 | Train Loss: 0.0813115 Vali Loss: 0.0805098 Test Loss: 0.1053479
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0781552
	speed: 0.0589s/iter; left time: 1129.7244s
	iters: 200, epoch: 15 | loss: 0.0823384
	speed: 0.0253s/iter; left time: 483.1192s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.07s
Steps: 224 | Train Loss: 0.0810086 Vali Loss: 0.0794107 Test Loss: 0.1068668
Validation loss decreased (0.079872 --> 0.079411).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0775683
	speed: 0.0491s/iter; left time: 930.9083s
	iters: 200, epoch: 16 | loss: 0.0845360
	speed: 0.0250s/iter; left time: 470.4449s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.91s
Steps: 224 | Train Loss: 0.0810002 Vali Loss: 0.0793832 Test Loss: 0.1062732
Validation loss decreased (0.079411 --> 0.079383).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0785738
	speed: 0.0604s/iter; left time: 1129.5765s
	iters: 200, epoch: 17 | loss: 0.0830793
	speed: 0.0258s/iter; left time: 479.6877s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.67s
Steps: 224 | Train Loss: 0.0806805 Vali Loss: 0.0796757 Test Loss: 0.1081794
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0810726
	speed: 0.0534s/iter; left time: 987.6375s
	iters: 200, epoch: 18 | loss: 0.0812911
	speed: 0.0224s/iter; left time: 412.5904s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.75s
Steps: 224 | Train Loss: 0.0801853 Vali Loss: 0.0788049 Test Loss: 0.1056824
Validation loss decreased (0.079383 --> 0.078805).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0818440
	speed: 0.0505s/iter; left time: 923.3333s
	iters: 200, epoch: 19 | loss: 0.0842848
	speed: 0.0249s/iter; left time: 452.7294s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.82s
Steps: 224 | Train Loss: 0.0800752 Vali Loss: 0.0789717 Test Loss: 0.1065343
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0801755
	speed: 0.0604s/iter; left time: 1089.0852s
	iters: 200, epoch: 20 | loss: 0.0796499
	speed: 0.0252s/iter; left time: 452.8986s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.79s
Steps: 224 | Train Loss: 0.0799425 Vali Loss: 0.0790023 Test Loss: 0.1056895
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0788750
	speed: 0.0551s/iter; left time: 982.1864s
	iters: 200, epoch: 21 | loss: 0.0768064
	speed: 0.0280s/iter; left time: 495.5663s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0798105 Vali Loss: 0.0786801 Test Loss: 0.1066256
Validation loss decreased (0.078805 --> 0.078680).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0817088
	speed: 0.0487s/iter; left time: 857.2357s
	iters: 200, epoch: 22 | loss: 0.0811852
	speed: 0.0221s/iter; left time: 387.3115s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0794791 Vali Loss: 0.0787583 Test Loss: 0.1066551
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0780964
	speed: 0.0648s/iter; left time: 1126.6143s
	iters: 200, epoch: 23 | loss: 0.0819277
	speed: 0.0282s/iter; left time: 487.5984s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.97s
Steps: 224 | Train Loss: 0.0794437 Vali Loss: 0.0786141 Test Loss: 0.1061799
Validation loss decreased (0.078680 --> 0.078614).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0778028
	speed: 0.0554s/iter; left time: 950.4224s
	iters: 200, epoch: 24 | loss: 0.0758676
	speed: 0.0259s/iter; left time: 441.6405s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.96s
Steps: 224 | Train Loss: 0.0795189 Vali Loss: 0.0787810 Test Loss: 0.1073045
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0792079
	speed: 0.0528s/iter; left time: 893.6485s
	iters: 200, epoch: 25 | loss: 0.0812866
	speed: 0.0245s/iter; left time: 412.7581s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.94s
Steps: 224 | Train Loss: 0.0793172 Vali Loss: 0.0787688 Test Loss: 0.1074945
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0763770
	speed: 0.0562s/iter; left time: 939.0085s
	iters: 200, epoch: 26 | loss: 0.0783638
	speed: 0.0222s/iter; left time: 368.3912s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0792577 Vali Loss: 0.0787418 Test Loss: 0.1073678
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0775584
	speed: 0.0504s/iter; left time: 831.1723s
	iters: 200, epoch: 27 | loss: 0.0783684
	speed: 0.0295s/iter; left time: 482.5670s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0791592 Vali Loss: 0.0785288 Test Loss: 0.1066040
Validation loss decreased (0.078614 --> 0.078529).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0803237
	speed: 0.0662s/iter; left time: 1075.8438s
	iters: 200, epoch: 28 | loss: 0.0806329
	speed: 0.0351s/iter; left time: 567.4513s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.32s
Steps: 224 | Train Loss: 0.0789692 Vali Loss: 0.0784907 Test Loss: 0.1069626
Validation loss decreased (0.078529 --> 0.078491).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0771088
	speed: 0.0560s/iter; left time: 897.2086s
	iters: 200, epoch: 29 | loss: 0.0797537
	speed: 0.0275s/iter; left time: 438.0735s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.06s
Steps: 224 | Train Loss: 0.0789747 Vali Loss: 0.0785680 Test Loss: 0.1075136
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0768419
	speed: 0.0605s/iter; left time: 955.5593s
	iters: 200, epoch: 30 | loss: 0.0750424
	speed: 0.0298s/iter; left time: 468.5193s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.11s
Steps: 224 | Train Loss: 0.0790785 Vali Loss: 0.0785908 Test Loss: 0.1073105
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0787101
	speed: 0.0585s/iter; left time: 911.8833s
	iters: 200, epoch: 31 | loss: 0.0802411
	speed: 0.0247s/iter; left time: 381.6253s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.73s
Steps: 224 | Train Loss: 0.0789518 Vali Loss: 0.0784791 Test Loss: 0.1074833
Validation loss decreased (0.078491 --> 0.078479).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0823305
	speed: 0.0557s/iter; left time: 854.9853s
	iters: 200, epoch: 32 | loss: 0.0796036
	speed: 0.0286s/iter; left time: 436.6633s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.38s
Steps: 224 | Train Loss: 0.0788601 Vali Loss: 0.0782840 Test Loss: 0.1062653
Validation loss decreased (0.078479 --> 0.078284).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0793923
	speed: 0.3947s/iter; left time: 5972.4182s
	iters: 200, epoch: 33 | loss: 0.0793243
	speed: 0.2738s/iter; left time: 4116.2789s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:57.38s
Steps: 224 | Train Loss: 0.0788686 Vali Loss: 0.0784163 Test Loss: 0.1069686
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0756958
	speed: 0.8538s/iter; left time: 12728.7993s
	iters: 200, epoch: 34 | loss: 0.0838103
	speed: 0.2451s/iter; left time: 3629.9769s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:58.46s
Steps: 224 | Train Loss: 0.0788095 Vali Loss: 0.0782736 Test Loss: 0.1072011
Validation loss decreased (0.078284 --> 0.078274).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0812744
	speed: 0.8012s/iter; left time: 11765.4880s
	iters: 200, epoch: 35 | loss: 0.0821269
	speed: 0.2272s/iter; left time: 3313.6820s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:53.92s
Steps: 224 | Train Loss: 0.0787743 Vali Loss: 0.0782643 Test Loss: 0.1069137
Validation loss decreased (0.078274 --> 0.078264).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0798463
	speed: 0.7605s/iter; left time: 10997.1287s
	iters: 200, epoch: 36 | loss: 0.0770300
	speed: 0.2165s/iter; left time: 3108.8287s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:51.23s
Steps: 224 | Train Loss: 0.0787331 Vali Loss: 0.0783624 Test Loss: 0.1071056
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0807413
	speed: 0.5070s/iter; left time: 7217.6860s
	iters: 200, epoch: 37 | loss: 0.0780625
	speed: 0.0645s/iter; left time: 912.2967s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:18.51s
Steps: 224 | Train Loss: 0.0787729 Vali Loss: 0.0782518 Test Loss: 0.1068003
Validation loss decreased (0.078264 --> 0.078252).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0758653
	speed: 0.1457s/iter; left time: 2041.5289s
	iters: 200, epoch: 38 | loss: 0.0763736
	speed: 0.0452s/iter; left time: 628.9367s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:10.25s
Steps: 224 | Train Loss: 0.0786084 Vali Loss: 0.0782499 Test Loss: 0.1072317
Validation loss decreased (0.078252 --> 0.078250).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0760216
	speed: 0.0724s/iter; left time: 998.0064s
	iters: 200, epoch: 39 | loss: 0.0784634
	speed: 0.0334s/iter; left time: 456.6404s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.15s
Steps: 224 | Train Loss: 0.0785685 Vali Loss: 0.0782051 Test Loss: 0.1070562
Validation loss decreased (0.078250 --> 0.078205).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0802338
	speed: 0.0714s/iter; left time: 968.4450s
	iters: 200, epoch: 40 | loss: 0.0773618
	speed: 0.0298s/iter; left time: 401.1484s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.53s
Steps: 224 | Train Loss: 0.0786725 Vali Loss: 0.0781130 Test Loss: 0.1067497
Validation loss decreased (0.078205 --> 0.078113).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0785245
	speed: 0.0585s/iter; left time: 780.0350s
	iters: 200, epoch: 41 | loss: 0.0785387
	speed: 0.0243s/iter; left time: 322.2650s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.78s
Steps: 224 | Train Loss: 0.0785518 Vali Loss: 0.0784730 Test Loss: 0.1084492
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0791963
	speed: 0.0645s/iter; left time: 845.8526s
	iters: 200, epoch: 42 | loss: 0.0760376
	speed: 0.0362s/iter; left time: 471.4391s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:08.21s
Steps: 224 | Train Loss: 0.0786132 Vali Loss: 0.0782817 Test Loss: 0.1074298
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0778955
	speed: 0.0511s/iter; left time: 658.8355s
	iters: 200, epoch: 43 | loss: 0.0800252
	speed: 0.0286s/iter; left time: 366.4441s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0786420 Vali Loss: 0.0781189 Test Loss: 0.1067718
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0819997
	speed: 0.0542s/iter; left time: 687.1672s
	iters: 200, epoch: 44 | loss: 0.0814772
	speed: 0.0268s/iter; left time: 337.4000s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0786479 Vali Loss: 0.0782319 Test Loss: 0.1075585
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0748167
	speed: 0.1371s/iter; left time: 1706.3845s
	iters: 200, epoch: 45 | loss: 0.0806576
	speed: 0.1234s/iter; left time: 1523.9016s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:26.77s
Steps: 224 | Train Loss: 0.0785665 Vali Loss: 0.0781131 Test Loss: 0.1069098
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0779535
	speed: 0.4148s/iter; left time: 5069.2781s
	iters: 200, epoch: 46 | loss: 0.0775306
	speed: 0.1757s/iter; left time: 2129.2589s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:38.85s
Steps: 224 | Train Loss: 0.0789313 Vali Loss: 0.0782464 Test Loss: 0.1069450
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0779391
	speed: 0.5836s/iter; left time: 7001.9260s
	iters: 200, epoch: 47 | loss: 0.0755811
	speed: 0.1768s/iter; left time: 2103.8623s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:39.99s
Steps: 224 | Train Loss: 0.0785349 Vali Loss: 0.0782029 Test Loss: 0.1071916
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0790833
	speed: 0.6386s/iter; left time: 7518.3920s
	iters: 200, epoch: 48 | loss: 0.0748542
	speed: 0.1245s/iter; left time: 1453.4596s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:38.87s
Steps: 224 | Train Loss: 0.0785826 Vali Loss: 0.0781639 Test Loss: 0.1072817
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0800797
	speed: 0.6446s/iter; left time: 7444.5921s
	iters: 200, epoch: 49 | loss: 0.0780519
	speed: 0.1807s/iter; left time: 2068.3437s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:43.27s
Steps: 224 | Train Loss: 0.0786275 Vali Loss: 0.0782234 Test Loss: 0.1074842
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0796954
	speed: 0.6242s/iter; left time: 7068.8319s
	iters: 200, epoch: 50 | loss: 0.0800935
	speed: 0.1073s/iter; left time: 1204.9534s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:28.37s
Steps: 224 | Train Loss: 0.0785114 Vali Loss: 0.0783420 Test Loss: 0.1074089
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02606804110109806, rmse:0.16145600378513336, mae:0.10674968361854553, rse:0.47430914640426636
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2792787
	speed: 0.1123s/iter; left time: 2504.1473s
	iters: 200, epoch: 1 | loss: 0.2649852
	speed: 0.2170s/iter; left time: 4817.5636s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.81s
Steps: 224 | Train Loss: 0.2850079 Vali Loss: 0.2131646 Test Loss: 0.2377978
Validation loss decreased (inf --> 0.213165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1498872
	speed: 0.7532s/iter; left time: 16627.6748s
	iters: 200, epoch: 2 | loss: 0.1174857
	speed: 0.1869s/iter; left time: 4108.2810s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.52s
Steps: 224 | Train Loss: 0.1591635 Vali Loss: 0.1057102 Test Loss: 0.1189962
Validation loss decreased (0.213165 --> 0.105710).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1049837
	speed: 0.1610s/iter; left time: 3518.0804s
	iters: 200, epoch: 3 | loss: 0.1032990
	speed: 0.2035s/iter; left time: 4427.1211s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.82s
Steps: 224 | Train Loss: 0.1071122 Vali Loss: 0.0968849 Test Loss: 0.1164992
Validation loss decreased (0.105710 --> 0.096885).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0999881
	speed: 0.7049s/iter; left time: 15245.2421s
	iters: 200, epoch: 4 | loss: 0.0945148
	speed: 0.2131s/iter; left time: 4587.5351s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.43s
Steps: 224 | Train Loss: 0.0949442 Vali Loss: 0.0855487 Test Loss: 0.1054883
Validation loss decreased (0.096885 --> 0.085549).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0918293
	speed: 0.1286s/iter; left time: 2753.1486s
	iters: 200, epoch: 5 | loss: 0.0848560
	speed: 0.1432s/iter; left time: 3051.2196s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.35s
Steps: 224 | Train Loss: 0.0899307 Vali Loss: 0.0839947 Test Loss: 0.1064513
Validation loss decreased (0.085549 --> 0.083995).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0849024
	speed: 0.7414s/iter; left time: 15704.4504s
	iters: 200, epoch: 6 | loss: 0.0857075
	speed: 0.2066s/iter; left time: 4354.3372s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.79s
Steps: 224 | Train Loss: 0.0874642 Vali Loss: 0.0827074 Test Loss: 0.1042721
Validation loss decreased (0.083995 --> 0.082707).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0839053
	speed: 0.1686s/iter; left time: 3532.5966s
	iters: 200, epoch: 7 | loss: 0.0827757
	speed: 0.0300s/iter; left time: 626.5406s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.67s
Steps: 224 | Train Loss: 0.0866783 Vali Loss: 0.0823522 Test Loss: 0.1039911
Validation loss decreased (0.082707 --> 0.082352).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0826827
	speed: 0.0603s/iter; left time: 1250.0757s
	iters: 200, epoch: 8 | loss: 0.0804850
	speed: 0.2091s/iter; left time: 4313.4278s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.22s
Steps: 224 | Train Loss: 0.0850287 Vali Loss: 0.0804520 Test Loss: 0.1010032
Validation loss decreased (0.082352 --> 0.080452).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0822033
	speed: 0.7216s/iter; left time: 14799.2126s
	iters: 200, epoch: 9 | loss: 0.0845221
	speed: 0.2003s/iter; left time: 4087.5105s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:47.00s
Steps: 224 | Train Loss: 0.0845946 Vali Loss: 0.0813719 Test Loss: 0.1031057
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0825328
	speed: 0.3124s/iter; left time: 6336.8346s
	iters: 200, epoch: 10 | loss: 0.0838826
	speed: 0.0233s/iter; left time: 470.2486s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.28s
Steps: 224 | Train Loss: 0.0836564 Vali Loss: 0.0800238 Test Loss: 0.1021235
Validation loss decreased (0.080452 --> 0.080024).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0814183
	speed: 0.0510s/iter; left time: 1022.4978s
	iters: 200, epoch: 11 | loss: 0.0828138
	speed: 0.0225s/iter; left time: 448.5368s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0825868 Vali Loss: 0.0798358 Test Loss: 0.1017064
Validation loss decreased (0.080024 --> 0.079836).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0808523
	speed: 0.2032s/iter; left time: 4030.3804s
	iters: 200, epoch: 12 | loss: 0.0792476
	speed: 0.2275s/iter; left time: 4490.8502s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:46.41s
Steps: 224 | Train Loss: 0.0824364 Vali Loss: 0.0807601 Test Loss: 0.1016696
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0799127
	speed: 0.7428s/iter; left time: 14569.3599s
	iters: 200, epoch: 13 | loss: 0.0800191
	speed: 0.0284s/iter; left time: 554.5264s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:20.54s
Steps: 224 | Train Loss: 0.0824644 Vali Loss: 0.0793439 Test Loss: 0.1021537
Validation loss decreased (0.079836 --> 0.079344).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0812680
	speed: 0.0505s/iter; left time: 979.5646s
	iters: 200, epoch: 14 | loss: 0.0834910
	speed: 0.0221s/iter; left time: 426.8188s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0820589 Vali Loss: 0.0805328 Test Loss: 0.1022749
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0818415
	speed: 0.0529s/iter; left time: 1013.8770s
	iters: 200, epoch: 15 | loss: 0.0847595
	speed: 0.0249s/iter; left time: 474.1117s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.07s
Steps: 224 | Train Loss: 0.0816347 Vali Loss: 0.0789403 Test Loss: 0.1031928
Validation loss decreased (0.079344 --> 0.078940).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0810707
	speed: 0.0515s/iter; left time: 975.7457s
	iters: 200, epoch: 16 | loss: 0.0827591
	speed: 0.0274s/iter; left time: 515.4281s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.90s
Steps: 224 | Train Loss: 0.0810812 Vali Loss: 0.0792231 Test Loss: 0.1041535
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0777121
	speed: 0.0507s/iter; left time: 949.5416s
	iters: 200, epoch: 17 | loss: 0.0815162
	speed: 0.0230s/iter; left time: 427.2869s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.46s
Steps: 224 | Train Loss: 0.0807954 Vali Loss: 0.0791107 Test Loss: 0.1040923
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0780679
	speed: 0.0531s/iter; left time: 982.0820s
	iters: 200, epoch: 18 | loss: 0.0805871
	speed: 0.0290s/iter; left time: 533.7113s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.05s
Steps: 224 | Train Loss: 0.0807699 Vali Loss: 0.0792412 Test Loss: 0.1038266
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0765163
	speed: 0.0543s/iter; left time: 992.4047s
	iters: 200, epoch: 19 | loss: 0.0815112
	speed: 0.0235s/iter; left time: 426.7585s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.93s
Steps: 224 | Train Loss: 0.0804458 Vali Loss: 0.0788845 Test Loss: 0.1041001
Validation loss decreased (0.078940 --> 0.078885).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0801165
	speed: 0.0520s/iter; left time: 938.9256s
	iters: 200, epoch: 20 | loss: 0.0791187
	speed: 0.0285s/iter; left time: 511.8360s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0804614 Vali Loss: 0.0789123 Test Loss: 0.1037632
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0806711
	speed: 0.0578s/iter; left time: 1030.7559s
	iters: 200, epoch: 21 | loss: 0.0815572
	speed: 0.1401s/iter; left time: 2483.3305s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:19.95s
Steps: 224 | Train Loss: 0.0804909 Vali Loss: 0.0783832 Test Loss: 0.1024599
Validation loss decreased (0.078885 --> 0.078383).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0809093
	speed: 0.3965s/iter; left time: 6977.8942s
	iters: 200, epoch: 22 | loss: 0.0796040
	speed: 0.1332s/iter; left time: 2331.3592s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:30.89s
Steps: 224 | Train Loss: 0.0802909 Vali Loss: 0.0786344 Test Loss: 0.1040339
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0830954
	speed: 0.4559s/iter; left time: 7920.8444s
	iters: 200, epoch: 23 | loss: 0.0778427
	speed: 0.1095s/iter; left time: 1890.9211s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:26.81s
Steps: 224 | Train Loss: 0.0800006 Vali Loss: 0.0784222 Test Loss: 0.1044553
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0773367
	speed: 0.1509s/iter; left time: 2587.6522s
	iters: 200, epoch: 24 | loss: 0.0789202
	speed: 0.0252s/iter; left time: 429.5529s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.73s
Steps: 224 | Train Loss: 0.0798820 Vali Loss: 0.0782881 Test Loss: 0.1039032
Validation loss decreased (0.078383 --> 0.078288).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0797844
	speed: 0.0722s/iter; left time: 1222.4980s
	iters: 200, epoch: 25 | loss: 0.0784464
	speed: 0.0319s/iter; left time: 537.0458s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.0798312 Vali Loss: 0.0784625 Test Loss: 0.1041823
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0799882
	speed: 0.0519s/iter; left time: 867.5433s
	iters: 200, epoch: 26 | loss: 0.0793978
	speed: 0.0231s/iter; left time: 383.4286s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.48s
Steps: 224 | Train Loss: 0.0798466 Vali Loss: 0.0785042 Test Loss: 0.1049148
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0813180
	speed: 0.0582s/iter; left time: 958.8430s
	iters: 200, epoch: 27 | loss: 0.0806970
	speed: 0.0333s/iter; left time: 545.8540s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.72s
Steps: 224 | Train Loss: 0.0796077 Vali Loss: 0.0782184 Test Loss: 0.1042569
Validation loss decreased (0.078288 --> 0.078218).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0809176
	speed: 0.0730s/iter; left time: 1186.7856s
	iters: 200, epoch: 28 | loss: 0.0783188
	speed: 0.0426s/iter; left time: 688.6292s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0797784 Vali Loss: 0.0782920 Test Loss: 0.1042234
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0803838
	speed: 0.0568s/iter; left time: 910.7059s
	iters: 200, epoch: 29 | loss: 0.0735765
	speed: 0.0274s/iter; left time: 435.9098s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0795765 Vali Loss: 0.0783056 Test Loss: 0.1045026
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0800161
	speed: 0.0565s/iter; left time: 892.8838s
	iters: 200, epoch: 30 | loss: 0.0809262
	speed: 0.0240s/iter; left time: 377.5996s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.72s
Steps: 224 | Train Loss: 0.0793852 Vali Loss: 0.0783652 Test Loss: 0.1049954
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0801490
	speed: 0.0504s/iter; left time: 785.2314s
	iters: 200, epoch: 31 | loss: 0.0802145
	speed: 0.0222s/iter; left time: 343.0451s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0801062 Vali Loss: 0.0782773 Test Loss: 0.1041020
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0752822
	speed: 0.0489s/iter; left time: 750.3437s
	iters: 200, epoch: 32 | loss: 0.0803191
	speed: 0.0233s/iter; left time: 355.9119s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.80s
Steps: 224 | Train Loss: 0.0793204 Vali Loss: 0.0780731 Test Loss: 0.1041139
Validation loss decreased (0.078218 --> 0.078073).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0780417
	speed: 0.7921s/iter; left time: 11987.3402s
	iters: 200, epoch: 33 | loss: 0.0772895
	speed: 0.2483s/iter; left time: 3732.7423s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:56.14s
Steps: 224 | Train Loss: 0.0793370 Vali Loss: 0.0781708 Test Loss: 0.1053759
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0790620
	speed: 0.8496s/iter; left time: 12666.7549s
	iters: 200, epoch: 34 | loss: 0.0777277
	speed: 0.2543s/iter; left time: 3766.2556s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:57.48s
Steps: 224 | Train Loss: 0.0794318 Vali Loss: 0.0782324 Test Loss: 0.1049891
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0817989
	speed: 0.8616s/iter; left time: 12651.9174s
	iters: 200, epoch: 35 | loss: 0.0772448
	speed: 0.2481s/iter; left time: 3618.1794s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:58.17s
Steps: 224 | Train Loss: 0.0793121 Vali Loss: 0.0781840 Test Loss: 0.1047611
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0781003
	speed: 0.8514s/iter; left time: 12312.1161s
	iters: 200, epoch: 36 | loss: 0.0811642
	speed: 0.2283s/iter; left time: 3277.9179s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:54.93s
Steps: 224 | Train Loss: 0.0791830 Vali Loss: 0.0780559 Test Loss: 0.1044061
Validation loss decreased (0.078073 --> 0.078056).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0784464
	speed: 0.8834s/iter; left time: 12576.2804s
	iters: 200, epoch: 37 | loss: 0.0760975
	speed: 0.2326s/iter; left time: 3288.3291s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:57.21s
Steps: 224 | Train Loss: 0.0791224 Vali Loss: 0.0781889 Test Loss: 0.1049399
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0813418
	speed: 0.8238s/iter; left time: 11543.2200s
	iters: 200, epoch: 38 | loss: 0.0797402
	speed: 0.2500s/iter; left time: 3477.7202s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:56.48s
Steps: 224 | Train Loss: 0.0792424 Vali Loss: 0.0779811 Test Loss: 0.1042640
Validation loss decreased (0.078056 --> 0.077981).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0851971
	speed: 0.4956s/iter; left time: 6834.1378s
	iters: 200, epoch: 39 | loss: 0.0805692
	speed: 0.0615s/iter; left time: 841.4140s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:16.44s
Steps: 224 | Train Loss: 0.0794647 Vali Loss: 0.0780003 Test Loss: 0.1041515
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0819355
	speed: 0.1664s/iter; left time: 2257.6419s
	iters: 200, epoch: 40 | loss: 0.0819953
	speed: 0.0490s/iter; left time: 659.4674s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0791665 Vali Loss: 0.0780685 Test Loss: 0.1047305
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0768735
	speed: 0.1592s/iter; left time: 2124.4003s
	iters: 200, epoch: 41 | loss: 0.0772569
	speed: 0.0491s/iter; left time: 650.5351s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:11.41s
Steps: 224 | Train Loss: 0.0790473 Vali Loss: 0.0780292 Test Loss: 0.1046755
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0796933
	speed: 0.1379s/iter; left time: 1808.7054s
	iters: 200, epoch: 42 | loss: 0.0786233
	speed: 0.0412s/iter; left time: 536.7026s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.25s
Steps: 224 | Train Loss: 0.0793347 Vali Loss: 0.0778732 Test Loss: 0.1041902
Validation loss decreased (0.077981 --> 0.077873).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0764746
	speed: 0.0544s/iter; left time: 701.5526s
	iters: 200, epoch: 43 | loss: 0.0744639
	speed: 0.0232s/iter; left time: 296.2603s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.55s
Steps: 224 | Train Loss: 0.0791484 Vali Loss: 0.0780769 Test Loss: 0.1050623
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0755760
	speed: 0.0662s/iter; left time: 838.1293s
	iters: 200, epoch: 44 | loss: 0.0787479
	speed: 0.0299s/iter; left time: 375.2761s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0791972 Vali Loss: 0.0779868 Test Loss: 0.1043765
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0762714
	speed: 0.0746s/iter; left time: 927.7961s
	iters: 200, epoch: 45 | loss: 0.0759438
	speed: 0.0222s/iter; left time: 273.4962s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.78s
Steps: 224 | Train Loss: 0.0790206 Vali Loss: 0.0781770 Test Loss: 0.1054556
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0754517
	speed: 0.0546s/iter; left time: 667.5340s
	iters: 200, epoch: 46 | loss: 0.0785779
	speed: 0.0239s/iter; left time: 290.0434s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.92s
Steps: 224 | Train Loss: 0.0790998 Vali Loss: 0.0779618 Test Loss: 0.1047398
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0816835
	speed: 0.0557s/iter; left time: 668.4182s
	iters: 200, epoch: 47 | loss: 0.0801519
	speed: 0.0226s/iter; left time: 268.8318s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.69s
Steps: 224 | Train Loss: 0.0792747 Vali Loss: 0.0779582 Test Loss: 0.1046278
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0784598
	speed: 0.0545s/iter; left time: 641.7825s
	iters: 200, epoch: 48 | loss: 0.0811592
	speed: 0.0224s/iter; left time: 261.3685s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.51s
Steps: 224 | Train Loss: 0.0791503 Vali Loss: 0.0779428 Test Loss: 0.1043643
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0766961
	speed: 0.0525s/iter; left time: 606.8447s
	iters: 200, epoch: 49 | loss: 0.0796693
	speed: 0.0223s/iter; left time: 254.8217s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.40s
Steps: 224 | Train Loss: 0.0790683 Vali Loss: 0.0779037 Test Loss: 0.1040635
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0831854
	speed: 0.0518s/iter; left time: 586.1710s
	iters: 200, epoch: 50 | loss: 0.0752173
	speed: 0.0230s/iter; left time: 258.5602s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.63s
Steps: 224 | Train Loss: 0.0791010 Vali Loss: 0.0779972 Test Loss: 0.1044786
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0789320
	speed: 0.0512s/iter; left time: 568.7515s
	iters: 200, epoch: 51 | loss: 0.0761701
	speed: 0.0222s/iter; left time: 244.0749s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.43s
Steps: 224 | Train Loss: 0.0790944 Vali Loss: 0.0779185 Test Loss: 0.1042843
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0803050
	speed: 0.0509s/iter; left time: 553.3961s
	iters: 200, epoch: 52 | loss: 0.0811822
	speed: 0.0291s/iter; left time: 313.6942s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0790576 Vali Loss: 0.0779051 Test Loss: 0.1044083
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.023792318999767303, rmse:0.15424759685993195, mae:0.1041901558637619, rse:0.4531330168247223
Intermediate time for ES and pred_len 96: 00h:50m:39.49s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2741542
	speed: 0.0411s/iter; left time: 913.3161s
	iters: 200, epoch: 1 | loss: 0.2625363
	speed: 0.0228s/iter; left time: 503.1415s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.58s
Steps: 223 | Train Loss: 0.2789657 Vali Loss: 0.2099814 Test Loss: 0.2343885
Validation loss decreased (inf --> 0.209981).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1420116
	speed: 0.0517s/iter; left time: 1135.4608s
	iters: 200, epoch: 2 | loss: 0.1204582
	speed: 0.0228s/iter; left time: 498.0982s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.45s
Steps: 223 | Train Loss: 0.1545209 Vali Loss: 0.1098287 Test Loss: 0.1241958
Validation loss decreased (0.209981 --> 0.109829).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1149083
	speed: 0.0497s/iter; left time: 1081.0783s
	iters: 200, epoch: 3 | loss: 0.1036759
	speed: 0.0230s/iter; left time: 498.5417s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.1100028 Vali Loss: 0.0971829 Test Loss: 0.1128965
Validation loss decreased (0.109829 --> 0.097183).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0992307
	speed: 0.0575s/iter; left time: 1238.8396s
	iters: 200, epoch: 4 | loss: 0.0954987
	speed: 0.0239s/iter; left time: 512.6749s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0981677 Vali Loss: 0.0916976 Test Loss: 0.1122032
Validation loss decreased (0.097183 --> 0.091698).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0940899
	speed: 0.0499s/iter; left time: 1064.0593s
	iters: 200, epoch: 5 | loss: 0.0911457
	speed: 0.0240s/iter; left time: 508.5727s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.60s
Steps: 223 | Train Loss: 0.0938299 Vali Loss: 0.0894631 Test Loss: 0.1140021
Validation loss decreased (0.091698 --> 0.089463).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0889462
	speed: 0.0497s/iter; left time: 1047.7245s
	iters: 200, epoch: 6 | loss: 0.0896733
	speed: 0.0224s/iter; left time: 470.6073s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.48s
Steps: 223 | Train Loss: 0.0908899 Vali Loss: 0.0876844 Test Loss: 0.1145647
Validation loss decreased (0.089463 --> 0.087684).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0891580
	speed: 0.0533s/iter; left time: 1111.7686s
	iters: 200, epoch: 7 | loss: 0.0899919
	speed: 0.0239s/iter; left time: 496.8905s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.54s
Steps: 223 | Train Loss: 0.0894373 Vali Loss: 0.0871091 Test Loss: 0.1139508
Validation loss decreased (0.087684 --> 0.087109).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0847955
	speed: 0.0504s/iter; left time: 1041.1489s
	iters: 200, epoch: 8 | loss: 0.0884005
	speed: 0.0227s/iter; left time: 465.5024s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0885475 Vali Loss: 0.0869177 Test Loss: 0.1149949
Validation loss decreased (0.087109 --> 0.086918).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0868295
	speed: 0.0497s/iter; left time: 1013.7421s
	iters: 200, epoch: 9 | loss: 0.0845316
	speed: 0.0223s/iter; left time: 453.6431s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.42s
Steps: 223 | Train Loss: 0.0875132 Vali Loss: 0.0869876 Test Loss: 0.1171902
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0868861
	speed: 0.0479s/iter; left time: 968.2232s
	iters: 200, epoch: 10 | loss: 0.0906792
	speed: 0.0224s/iter; left time: 450.2099s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0868785 Vali Loss: 0.0860478 Test Loss: 0.1130730
Validation loss decreased (0.086918 --> 0.086048).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0893267
	speed: 0.0551s/iter; left time: 1100.3981s
	iters: 200, epoch: 11 | loss: 0.0827111
	speed: 0.0225s/iter; left time: 447.4964s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.56s
Steps: 223 | Train Loss: 0.0865897 Vali Loss: 0.0860126 Test Loss: 0.1144221
Validation loss decreased (0.086048 --> 0.086013).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0819745
	speed: 0.0489s/iter; left time: 965.6123s
	iters: 200, epoch: 12 | loss: 0.0886843
	speed: 0.0222s/iter; left time: 436.0645s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0861147 Vali Loss: 0.0857337 Test Loss: 0.1126444
Validation loss decreased (0.086013 --> 0.085734).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0843310
	speed: 0.0553s/iter; left time: 1079.3323s
	iters: 200, epoch: 13 | loss: 0.0851573
	speed: 0.0231s/iter; left time: 448.3385s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.02s
Steps: 223 | Train Loss: 0.0857890 Vali Loss: 0.0853501 Test Loss: 0.1129777
Validation loss decreased (0.085734 --> 0.085350).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0846311
	speed: 0.0493s/iter; left time: 950.8982s
	iters: 200, epoch: 14 | loss: 0.0863972
	speed: 0.0242s/iter; left time: 464.3177s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.53s
Steps: 223 | Train Loss: 0.0853135 Vali Loss: 0.0860326 Test Loss: 0.1155821
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0844489
	speed: 0.0499s/iter; left time: 952.9456s
	iters: 200, epoch: 15 | loss: 0.0898472
	speed: 0.0225s/iter; left time: 427.5287s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0852884 Vali Loss: 0.0856989 Test Loss: 0.1137507
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0848589
	speed: 0.0483s/iter; left time: 910.1439s
	iters: 200, epoch: 16 | loss: 0.0860770
	speed: 0.0226s/iter; left time: 423.7330s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0849384 Vali Loss: 0.0850861 Test Loss: 0.1144261
Validation loss decreased (0.085350 --> 0.085086).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0846847
	speed: 0.0565s/iter; left time: 1052.6888s
	iters: 200, epoch: 17 | loss: 0.0837189
	speed: 0.0240s/iter; left time: 445.4024s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.95s
Steps: 223 | Train Loss: 0.0848462 Vali Loss: 0.0850919 Test Loss: 0.1139559
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0814941
	speed: 0.0479s/iter; left time: 881.4486s
	iters: 200, epoch: 18 | loss: 0.0866240
	speed: 0.0223s/iter; left time: 408.2574s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.29s
Steps: 223 | Train Loss: 0.0844770 Vali Loss: 0.0848956 Test Loss: 0.1148819
Validation loss decreased (0.085086 --> 0.084896).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0841063
	speed: 0.0483s/iter; left time: 879.1632s
	iters: 200, epoch: 19 | loss: 0.0829668
	speed: 0.0224s/iter; left time: 405.3031s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.26s
Steps: 223 | Train Loss: 0.0844081 Vali Loss: 0.0847860 Test Loss: 0.1142331
Validation loss decreased (0.084896 --> 0.084786).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0865711
	speed: 0.0506s/iter; left time: 909.8474s
	iters: 200, epoch: 20 | loss: 0.0815339
	speed: 0.0223s/iter; left time: 399.0772s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0839790 Vali Loss: 0.0844200 Test Loss: 0.1142257
Validation loss decreased (0.084786 --> 0.084420).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0841301
	speed: 0.0494s/iter; left time: 875.8635s
	iters: 200, epoch: 21 | loss: 0.0852435
	speed: 0.0231s/iter; left time: 407.4899s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.33s
Steps: 223 | Train Loss: 0.0840244 Vali Loss: 0.0848042 Test Loss: 0.1145657
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0834487
	speed: 0.0482s/iter; left time: 845.0994s
	iters: 200, epoch: 22 | loss: 0.0854497
	speed: 0.0223s/iter; left time: 389.2361s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0837983 Vali Loss: 0.0846703 Test Loss: 0.1149464
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0797565
	speed: 0.0477s/iter; left time: 825.1302s
	iters: 200, epoch: 23 | loss: 0.0886405
	speed: 0.0224s/iter; left time: 385.8155s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.29s
Steps: 223 | Train Loss: 0.0837015 Vali Loss: 0.0848153 Test Loss: 0.1154751
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0827907
	speed: 0.0478s/iter; left time: 816.5478s
	iters: 200, epoch: 24 | loss: 0.0804853
	speed: 0.0226s/iter; left time: 382.7189s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.29s
Steps: 223 | Train Loss: 0.0839030 Vali Loss: 0.0849845 Test Loss: 0.1162583
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0866296
	speed: 0.0497s/iter; left time: 836.9247s
	iters: 200, epoch: 25 | loss: 0.0841012
	speed: 0.0224s/iter; left time: 375.5985s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.36s
Steps: 223 | Train Loss: 0.0836358 Vali Loss: 0.0844903 Test Loss: 0.1157465
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0883430
	speed: 0.0474s/iter; left time: 788.5813s
	iters: 200, epoch: 26 | loss: 0.0811828
	speed: 0.0223s/iter; left time: 368.0045s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0834041 Vali Loss: 0.0847251 Test Loss: 0.1161266
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0818763
	speed: 0.0496s/iter; left time: 814.0956s
	iters: 200, epoch: 27 | loss: 0.0849266
	speed: 0.0223s/iter; left time: 363.2673s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0833626 Vali Loss: 0.0846412 Test Loss: 0.1157158
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0802514
	speed: 0.0506s/iter; left time: 818.3934s
	iters: 200, epoch: 28 | loss: 0.0816113
	speed: 0.0223s/iter; left time: 357.8677s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.38s
Steps: 223 | Train Loss: 0.0832860 Vali Loss: 0.0843503 Test Loss: 0.1161194
Validation loss decreased (0.084420 --> 0.084350).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0844431
	speed: 0.0479s/iter; left time: 764.9561s
	iters: 200, epoch: 29 | loss: 0.0873203
	speed: 0.0225s/iter; left time: 356.5796s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.27s
Steps: 223 | Train Loss: 0.0833549 Vali Loss: 0.0845832 Test Loss: 0.1168200
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0824091
	speed: 0.0488s/iter; left time: 768.5213s
	iters: 200, epoch: 30 | loss: 0.0861688
	speed: 0.0222s/iter; left time: 347.4225s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.33s
Steps: 223 | Train Loss: 0.0833028 Vali Loss: 0.0843686 Test Loss: 0.1156648
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0835953
	speed: 0.0486s/iter; left time: 753.5353s
	iters: 200, epoch: 31 | loss: 0.0814292
	speed: 0.0222s/iter; left time: 341.9904s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.34s
Steps: 223 | Train Loss: 0.0834859 Vali Loss: 0.0845277 Test Loss: 0.1161598
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0804389
	speed: 0.0486s/iter; left time: 743.0883s
	iters: 200, epoch: 32 | loss: 0.0855126
	speed: 0.0222s/iter; left time: 337.8875s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.41s
Steps: 223 | Train Loss: 0.0831986 Vali Loss: 0.0842656 Test Loss: 0.1159719
Validation loss decreased (0.084350 --> 0.084266).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0863953
	speed: 0.0501s/iter; left time: 755.2867s
	iters: 200, epoch: 33 | loss: 0.0838326
	speed: 0.0225s/iter; left time: 337.1000s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.34s
Steps: 223 | Train Loss: 0.0831748 Vali Loss: 0.0843822 Test Loss: 0.1160463
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0808025
	speed: 0.0488s/iter; left time: 723.9458s
	iters: 200, epoch: 34 | loss: 0.0868584
	speed: 0.0222s/iter; left time: 327.9950s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.32s
Steps: 223 | Train Loss: 0.0830420 Vali Loss: 0.0843849 Test Loss: 0.1160896
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0853546
	speed: 0.0518s/iter; left time: 757.0629s
	iters: 200, epoch: 35 | loss: 0.0830138
	speed: 0.0222s/iter; left time: 322.3184s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.42s
Steps: 223 | Train Loss: 0.0830166 Vali Loss: 0.0843050 Test Loss: 0.1160584
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0823329
	speed: 0.0482s/iter; left time: 694.5629s
	iters: 200, epoch: 36 | loss: 0.0845633
	speed: 0.0257s/iter; left time: 367.3974s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.59s
Steps: 223 | Train Loss: 0.0828777 Vali Loss: 0.0842713 Test Loss: 0.1163082
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0866595
	speed: 0.0486s/iter; left time: 688.7751s
	iters: 200, epoch: 37 | loss: 0.0826903
	speed: 0.0221s/iter; left time: 311.6933s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.30s
Steps: 223 | Train Loss: 0.0829554 Vali Loss: 0.0842408 Test Loss: 0.1162088
Validation loss decreased (0.084266 --> 0.084241).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0889198
	speed: 0.0496s/iter; left time: 691.4277s
	iters: 200, epoch: 38 | loss: 0.0815963
	speed: 0.0222s/iter; left time: 307.7284s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0829357 Vali Loss: 0.0841646 Test Loss: 0.1161689
Validation loss decreased (0.084241 --> 0.084165).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0819173
	speed: 0.0512s/iter; left time: 703.1885s
	iters: 200, epoch: 39 | loss: 0.0850061
	speed: 0.0226s/iter; left time: 307.9730s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0829882 Vali Loss: 0.0842645 Test Loss: 0.1162499
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0827347
	speed: 0.0531s/iter; left time: 716.7213s
	iters: 200, epoch: 40 | loss: 0.0846230
	speed: 0.0294s/iter; left time: 393.9177s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0829915 Vali Loss: 0.0842339 Test Loss: 0.1159945
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0837643
	speed: 0.0528s/iter; left time: 701.2124s
	iters: 200, epoch: 41 | loss: 0.0824249
	speed: 0.0223s/iter; left time: 293.5927s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0831939 Vali Loss: 0.0841574 Test Loss: 0.1158621
Validation loss decreased (0.084165 --> 0.084157).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0813586
	speed: 0.0645s/iter; left time: 841.7738s
	iters: 200, epoch: 42 | loss: 0.0813456
	speed: 0.0522s/iter; left time: 675.8091s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.52s
Steps: 223 | Train Loss: 0.0828358 Vali Loss: 0.0843383 Test Loss: 0.1163305
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0834796
	speed: 0.0476s/iter; left time: 611.0854s
	iters: 200, epoch: 43 | loss: 0.0813733
	speed: 0.0222s/iter; left time: 283.3264s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0828592 Vali Loss: 0.0841866 Test Loss: 0.1161202
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0799217
	speed: 0.0475s/iter; left time: 599.0262s
	iters: 200, epoch: 44 | loss: 0.0826981
	speed: 0.0225s/iter; left time: 281.5792s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.30s
Steps: 223 | Train Loss: 0.0829095 Vali Loss: 0.0844392 Test Loss: 0.1166744
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0829774
	speed: 0.0499s/iter; left time: 617.8617s
	iters: 200, epoch: 45 | loss: 0.0829286
	speed: 0.0230s/iter; left time: 282.4665s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.44s
Steps: 223 | Train Loss: 0.0828461 Vali Loss: 0.0842382 Test Loss: 0.1163864
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0839270
	speed: 0.0484s/iter; left time: 588.6365s
	iters: 200, epoch: 46 | loss: 0.0843543
	speed: 0.0222s/iter; left time: 267.8328s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0828379 Vali Loss: 0.0842043 Test Loss: 0.1163348
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0796322
	speed: 0.0479s/iter; left time: 571.5518s
	iters: 200, epoch: 47 | loss: 0.0834307
	speed: 0.0223s/iter; left time: 264.0966s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0827978 Vali Loss: 0.0841979 Test Loss: 0.1164009
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0844782
	speed: 0.0476s/iter; left time: 557.8686s
	iters: 200, epoch: 48 | loss: 0.0807830
	speed: 0.0223s/iter; left time: 259.4295s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.26s
Steps: 223 | Train Loss: 0.0831386 Vali Loss: 0.0842695 Test Loss: 0.1163612
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0842269
	speed: 0.0498s/iter; left time: 572.5881s
	iters: 200, epoch: 49 | loss: 0.0786305
	speed: 0.0222s/iter; left time: 253.3831s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.32s
Steps: 223 | Train Loss: 0.0828130 Vali Loss: 0.0842645 Test Loss: 0.1165766
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0851781
	speed: 0.0495s/iter; left time: 558.0791s
	iters: 200, epoch: 50 | loss: 0.0817751
	speed: 0.0230s/iter; left time: 256.8171s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0828581 Vali Loss: 0.0842051 Test Loss: 0.1164734
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0830675
	speed: 0.2006s/iter; left time: 2217.0376s
	iters: 200, epoch: 51 | loss: 0.0815906
	speed: 0.0762s/iter; left time: 834.6704s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:16.45s
Steps: 223 | Train Loss: 0.0828718 Vali Loss: 0.0843836 Test Loss: 0.1167695
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03044012002646923, rmse:0.17447097599506378, mae:0.11586214601993561, rse:0.5125800371170044
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2715008
	speed: 0.1322s/iter; left time: 2934.7063s
	iters: 200, epoch: 1 | loss: 0.2621438
	speed: 0.0609s/iter; left time: 1344.9514s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:19.87s
Steps: 223 | Train Loss: 0.2808324 Vali Loss: 0.2086999 Test Loss: 0.2318538
Validation loss decreased (inf --> 0.208700).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1406341
	speed: 0.2592s/iter; left time: 5696.8053s
	iters: 200, epoch: 2 | loss: 0.1156944
	speed: 0.0643s/iter; left time: 1405.8682s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:23.57s
Steps: 223 | Train Loss: 0.1531506 Vali Loss: 0.1074509 Test Loss: 0.1221174
Validation loss decreased (0.208700 --> 0.107451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1058786
	speed: 0.1348s/iter; left time: 2933.1687s
	iters: 200, epoch: 3 | loss: 0.0988292
	speed: 0.1439s/iter; left time: 3115.1000s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.34s
Steps: 223 | Train Loss: 0.1088643 Vali Loss: 0.0949075 Test Loss: 0.1160958
Validation loss decreased (0.107451 --> 0.094908).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1014423
	speed: 0.3017s/iter; left time: 6495.2209s
	iters: 200, epoch: 4 | loss: 0.1010499
	speed: 0.0652s/iter; left time: 1396.9592s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.09s
Steps: 223 | Train Loss: 0.0973781 Vali Loss: 0.0909562 Test Loss: 0.1235237
Validation loss decreased (0.094908 --> 0.090956).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0913087
	speed: 0.5496s/iter; left time: 11710.6381s
	iters: 200, epoch: 5 | loss: 0.0929417
	speed: 0.1961s/iter; left time: 4158.1188s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.12s
Steps: 223 | Train Loss: 0.0935050 Vali Loss: 0.0888496 Test Loss: 0.1242957
Validation loss decreased (0.090956 --> 0.088850).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0904964
	speed: 0.0885s/iter; left time: 1866.7655s
	iters: 200, epoch: 6 | loss: 0.0928248
	speed: 0.0251s/iter; left time: 526.5184s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.75s
Steps: 223 | Train Loss: 0.0909621 Vali Loss: 0.0874295 Test Loss: 0.1247244
Validation loss decreased (0.088850 --> 0.087430).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0912138
	speed: 0.0999s/iter; left time: 2083.5726s
	iters: 200, epoch: 7 | loss: 0.0925503
	speed: 0.0225s/iter; left time: 467.1788s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.45s
Steps: 223 | Train Loss: 0.0895669 Vali Loss: 0.0888368 Test Loss: 0.1265373
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0887621
	speed: 0.0500s/iter; left time: 1031.3246s
	iters: 200, epoch: 8 | loss: 0.0896031
	speed: 0.0227s/iter; left time: 466.7546s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.38s
Steps: 223 | Train Loss: 0.0887712 Vali Loss: 0.0872580 Test Loss: 0.1197735
Validation loss decreased (0.087430 --> 0.087258).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0878859
	speed: 0.1417s/iter; left time: 2893.6165s
	iters: 200, epoch: 9 | loss: 0.0869749
	speed: 0.1261s/iter; left time: 2562.8032s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:27.34s
Steps: 223 | Train Loss: 0.0885864 Vali Loss: 0.0871530 Test Loss: 0.1097007
Validation loss decreased (0.087258 --> 0.087153).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0920990
	speed: 0.4117s/iter; left time: 8313.3375s
	iters: 200, epoch: 10 | loss: 0.0847813
	speed: 0.0643s/iter; left time: 1292.6056s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:20.84s
Steps: 223 | Train Loss: 0.0876953 Vali Loss: 0.0861443 Test Loss: 0.1178766
Validation loss decreased (0.087153 --> 0.086144).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0869060
	speed: 0.0616s/iter; left time: 1230.3363s
	iters: 200, epoch: 11 | loss: 0.0855299
	speed: 0.0226s/iter; left time: 449.8983s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.74s
Steps: 223 | Train Loss: 0.0868600 Vali Loss: 0.0855552 Test Loss: 0.1193667
Validation loss decreased (0.086144 --> 0.085555).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0883427
	speed: 0.0520s/iter; left time: 1025.9397s
	iters: 200, epoch: 12 | loss: 0.0818175
	speed: 0.0251s/iter; left time: 493.2019s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.72s
Steps: 223 | Train Loss: 0.0862828 Vali Loss: 0.0857884 Test Loss: 0.1194353
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0862641
	speed: 0.0536s/iter; left time: 1046.7910s
	iters: 200, epoch: 13 | loss: 0.0857989
	speed: 0.0225s/iter; left time: 436.4858s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.77s
Steps: 223 | Train Loss: 0.0859228 Vali Loss: 0.0854638 Test Loss: 0.1165428
Validation loss decreased (0.085555 --> 0.085464).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0894362
	speed: 0.0544s/iter; left time: 1050.1561s
	iters: 200, epoch: 14 | loss: 0.0860724
	speed: 0.0231s/iter; left time: 443.7900s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.81s
Steps: 223 | Train Loss: 0.0854616 Vali Loss: 0.0857663 Test Loss: 0.1200690
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0831092
	speed: 0.0529s/iter; left time: 1008.9988s
	iters: 200, epoch: 15 | loss: 0.0876814
	speed: 0.0223s/iter; left time: 424.0252s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.47s
Steps: 223 | Train Loss: 0.0851888 Vali Loss: 0.0851492 Test Loss: 0.1212800
Validation loss decreased (0.085464 --> 0.085149).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0824745
	speed: 0.0579s/iter; left time: 1092.1405s
	iters: 200, epoch: 16 | loss: 0.0850440
	speed: 0.0231s/iter; left time: 432.4899s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.65s
Steps: 223 | Train Loss: 0.0849335 Vali Loss: 0.0852520 Test Loss: 0.1180814
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0832800
	speed: 0.0563s/iter; left time: 1048.4469s
	iters: 200, epoch: 17 | loss: 0.0843466
	speed: 0.0222s/iter; left time: 411.9851s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.46s
Steps: 223 | Train Loss: 0.0846814 Vali Loss: 0.0847475 Test Loss: 0.1196820
Validation loss decreased (0.085149 --> 0.084747).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0875870
	speed: 0.0528s/iter; left time: 972.4698s
	iters: 200, epoch: 18 | loss: 0.0847477
	speed: 0.0227s/iter; left time: 415.0002s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.71s
Steps: 223 | Train Loss: 0.0846317 Vali Loss: 0.0845270 Test Loss: 0.1162244
Validation loss decreased (0.084747 --> 0.084527).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0821703
	speed: 0.0538s/iter; left time: 977.5800s
	iters: 200, epoch: 19 | loss: 0.0849935
	speed: 0.0241s/iter; left time: 436.3318s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.86s
Steps: 223 | Train Loss: 0.0844657 Vali Loss: 0.0848649 Test Loss: 0.1194516
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0802291
	speed: 0.0530s/iter; left time: 951.7404s
	iters: 200, epoch: 20 | loss: 0.0800778
	speed: 0.0249s/iter; left time: 445.1191s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.83s
Steps: 223 | Train Loss: 0.0844274 Vali Loss: 0.0844849 Test Loss: 0.1150948
Validation loss decreased (0.084527 --> 0.084485).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0838399
	speed: 0.0517s/iter; left time: 916.3918s
	iters: 200, epoch: 21 | loss: 0.0823502
	speed: 0.0226s/iter; left time: 399.2700s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.46s
Steps: 223 | Train Loss: 0.0842312 Vali Loss: 0.0847522 Test Loss: 0.1175591
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0856613
	speed: 0.0488s/iter; left time: 854.5653s
	iters: 200, epoch: 22 | loss: 0.0827729
	speed: 0.0223s/iter; left time: 388.1163s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.30s
Steps: 223 | Train Loss: 0.0838928 Vali Loss: 0.0850711 Test Loss: 0.1228586
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0865541
	speed: 0.0483s/iter; left time: 835.5106s
	iters: 200, epoch: 23 | loss: 0.0829072
	speed: 0.0227s/iter; left time: 389.7783s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.32s
Steps: 223 | Train Loss: 0.0838293 Vali Loss: 0.0848606 Test Loss: 0.1205242
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0785990
	speed: 0.0519s/iter; left time: 885.1978s
	iters: 200, epoch: 24 | loss: 0.0821744
	speed: 0.0229s/iter; left time: 388.0422s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.41s
Steps: 223 | Train Loss: 0.0838091 Vali Loss: 0.0847127 Test Loss: 0.1159968
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0839403
	speed: 0.0509s/iter; left time: 857.8227s
	iters: 200, epoch: 25 | loss: 0.0832041
	speed: 0.0250s/iter; left time: 418.6962s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.91s
Steps: 223 | Train Loss: 0.0836742 Vali Loss: 0.0844283 Test Loss: 0.1181025
Validation loss decreased (0.084485 --> 0.084428).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0831596
	speed: 0.0534s/iter; left time: 888.6234s
	iters: 200, epoch: 26 | loss: 0.0861969
	speed: 0.0224s/iter; left time: 370.8664s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.34s
Steps: 223 | Train Loss: 0.0835499 Vali Loss: 0.0844193 Test Loss: 0.1213674
Validation loss decreased (0.084428 --> 0.084419).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0881168
	speed: 0.0525s/iter; left time: 860.5811s
	iters: 200, epoch: 27 | loss: 0.0837724
	speed: 0.0236s/iter; left time: 383.9791s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.63s
Steps: 223 | Train Loss: 0.0837224 Vali Loss: 0.0842958 Test Loss: 0.1159074
Validation loss decreased (0.084419 --> 0.084296).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0820167
	speed: 0.0514s/iter; left time: 831.9788s
	iters: 200, epoch: 28 | loss: 0.0854088
	speed: 0.0245s/iter; left time: 393.7378s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.59s
Steps: 223 | Train Loss: 0.0835717 Vali Loss: 0.0845032 Test Loss: 0.1200302
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0830966
	speed: 0.0545s/iter; left time: 868.8940s
	iters: 200, epoch: 29 | loss: 0.0786469
	speed: 0.0231s/iter; left time: 365.8760s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.01s
Steps: 223 | Train Loss: 0.0833944 Vali Loss: 0.0842272 Test Loss: 0.1198121
Validation loss decreased (0.084296 --> 0.084227).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0836487
	speed: 0.0508s/iter; left time: 799.3045s
	iters: 200, epoch: 30 | loss: 0.0803401
	speed: 0.0227s/iter; left time: 355.5918s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.42s
Steps: 223 | Train Loss: 0.0832734 Vali Loss: 0.0841208 Test Loss: 0.1173771
Validation loss decreased (0.084227 --> 0.084121).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0809827
	speed: 0.0552s/iter; left time: 856.9800s
	iters: 200, epoch: 31 | loss: 0.0842370
	speed: 0.0224s/iter; left time: 345.0817s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.42s
Steps: 223 | Train Loss: 0.0834217 Vali Loss: 0.0842179 Test Loss: 0.1186745
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0793326
	speed: 0.0529s/iter; left time: 808.4634s
	iters: 200, epoch: 32 | loss: 0.0811508
	speed: 0.0222s/iter; left time: 336.8752s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0832636 Vali Loss: 0.0842897 Test Loss: 0.1188567
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0806536
	speed: 0.0509s/iter; left time: 766.1664s
	iters: 200, epoch: 33 | loss: 0.0816683
	speed: 0.0222s/iter; left time: 332.4514s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.49s
Steps: 223 | Train Loss: 0.0832670 Vali Loss: 0.0839720 Test Loss: 0.1184661
Validation loss decreased (0.084121 --> 0.083972).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0836224
	speed: 0.0505s/iter; left time: 750.1474s
	iters: 200, epoch: 34 | loss: 0.0844120
	speed: 0.0331s/iter; left time: 487.6187s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.42s
Steps: 223 | Train Loss: 0.0832786 Vali Loss: 0.0840682 Test Loss: 0.1174169
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0817028
	speed: 0.0497s/iter; left time: 725.9847s
	iters: 200, epoch: 35 | loss: 0.0823539
	speed: 0.0226s/iter; left time: 327.6722s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.41s
Steps: 223 | Train Loss: 0.0832299 Vali Loss: 0.0841118 Test Loss: 0.1174949
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0829380
	speed: 0.0514s/iter; left time: 740.4531s
	iters: 200, epoch: 36 | loss: 0.0796161
	speed: 0.0222s/iter; left time: 317.6182s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0831137 Vali Loss: 0.0840316 Test Loss: 0.1187578
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0838125
	speed: 0.0490s/iter; left time: 694.3179s
	iters: 200, epoch: 37 | loss: 0.0850530
	speed: 0.0221s/iter; left time: 311.5742s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.34s
Steps: 223 | Train Loss: 0.0831243 Vali Loss: 0.0842547 Test Loss: 0.1187132
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0824745
	speed: 0.0544s/iter; left time: 759.1829s
	iters: 200, epoch: 38 | loss: 0.0825395
	speed: 0.0223s/iter; left time: 309.4850s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.46s
Steps: 223 | Train Loss: 0.0831444 Vali Loss: 0.0838713 Test Loss: 0.1173147
Validation loss decreased (0.083972 --> 0.083871).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0854075
	speed: 0.0507s/iter; left time: 696.3349s
	iters: 200, epoch: 39 | loss: 0.0816420
	speed: 0.0221s/iter; left time: 301.6732s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.31s
Steps: 223 | Train Loss: 0.0832312 Vali Loss: 0.0839343 Test Loss: 0.1172149
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0818202
	speed: 0.0486s/iter; left time: 656.5611s
	iters: 200, epoch: 40 | loss: 0.0884314
	speed: 0.0496s/iter; left time: 664.4843s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:10.72s
Steps: 223 | Train Loss: 0.0831206 Vali Loss: 0.0842566 Test Loss: 0.1184728
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0827821
	speed: 0.3016s/iter; left time: 4005.2421s
	iters: 200, epoch: 41 | loss: 0.0795763
	speed: 0.1308s/iter; left time: 1723.4482s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:27.43s
Steps: 223 | Train Loss: 0.0830118 Vali Loss: 0.0839769 Test Loss: 0.1194157
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0845354
	speed: 0.4657s/iter; left time: 6081.2555s
	iters: 200, epoch: 42 | loss: 0.0829298
	speed: 0.1514s/iter; left time: 1962.1639s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:34.61s
Steps: 223 | Train Loss: 0.0831070 Vali Loss: 0.0840556 Test Loss: 0.1188590
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0832543
	speed: 0.5482s/iter; left time: 7036.5363s
	iters: 200, epoch: 43 | loss: 0.0820783
	speed: 0.1736s/iter; left time: 2210.4139s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:39.99s
Steps: 223 | Train Loss: 0.0830777 Vali Loss: 0.0838464 Test Loss: 0.1184260
Validation loss decreased (0.083871 --> 0.083846).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0821071
	speed: 0.6737s/iter; left time: 8497.3165s
	iters: 200, epoch: 44 | loss: 0.0839722
	speed: 0.1827s/iter; left time: 2286.2775s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:45.72s
Steps: 223 | Train Loss: 0.0830476 Vali Loss: 0.0839466 Test Loss: 0.1192060
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0812912
	speed: 0.6738s/iter; left time: 8347.1780s
	iters: 200, epoch: 45 | loss: 0.0849999
	speed: 0.1873s/iter; left time: 2302.2070s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:43.66s
Steps: 223 | Train Loss: 0.0830057 Vali Loss: 0.0840486 Test Loss: 0.1191918
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0830692
	speed: 0.4021s/iter; left time: 4892.0183s
	iters: 200, epoch: 46 | loss: 0.0840345
	speed: 0.0549s/iter; left time: 662.5758s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:13.72s
Steps: 223 | Train Loss: 0.0830333 Vali Loss: 0.0838347 Test Loss: 0.1183836
Validation loss decreased (0.083846 --> 0.083835).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0855173
	speed: 0.1588s/iter; left time: 1896.3097s
	iters: 200, epoch: 47 | loss: 0.0849277
	speed: 0.0275s/iter; left time: 325.4159s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.89s
Steps: 223 | Train Loss: 0.0829685 Vali Loss: 0.0840135 Test Loss: 0.1198245
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0814747
	speed: 0.0665s/iter; left time: 779.0993s
	iters: 200, epoch: 48 | loss: 0.0844937
	speed: 0.0304s/iter; left time: 353.0178s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.51s
Steps: 223 | Train Loss: 0.0829573 Vali Loss: 0.0838248 Test Loss: 0.1194821
Validation loss decreased (0.083835 --> 0.083825).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0810249
	speed: 0.0561s/iter; left time: 644.4281s
	iters: 200, epoch: 49 | loss: 0.0801658
	speed: 0.0273s/iter; left time: 310.6409s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.0829287 Vali Loss: 0.0837962 Test Loss: 0.1174986
Validation loss decreased (0.083825 --> 0.083796).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0813590
	speed: 0.0603s/iter; left time: 679.8552s
	iters: 200, epoch: 50 | loss: 0.0843758
	speed: 0.0296s/iter; left time: 330.7794s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.65s
Steps: 223 | Train Loss: 0.0830149 Vali Loss: 0.0839692 Test Loss: 0.1182753
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0855806
	speed: 0.0533s/iter; left time: 588.6377s
	iters: 200, epoch: 51 | loss: 0.0813496
	speed: 0.0228s/iter; left time: 249.4155s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.43s
Steps: 223 | Train Loss: 0.0829588 Vali Loss: 0.0838750 Test Loss: 0.1184985
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0826729
	speed: 0.0585s/iter; left time: 633.0245s
	iters: 200, epoch: 52 | loss: 0.0843770
	speed: 0.0293s/iter; left time: 314.4597s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.20s
Steps: 223 | Train Loss: 0.0828833 Vali Loss: 0.0838117 Test Loss: 0.1178757
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0807884
	speed: 0.0636s/iter; left time: 674.0047s
	iters: 200, epoch: 53 | loss: 0.0842347
	speed: 0.0230s/iter; left time: 241.8009s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.00s
Steps: 223 | Train Loss: 0.0829059 Vali Loss: 0.0838893 Test Loss: 0.1188719
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0866821
	speed: 0.0519s/iter; left time: 538.6363s
	iters: 200, epoch: 54 | loss: 0.0871154
	speed: 0.0256s/iter; left time: 263.0644s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.76s
Steps: 223 | Train Loss: 0.0830573 Vali Loss: 0.0839538 Test Loss: 0.1191130
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0805923
	speed: 0.0513s/iter; left time: 521.5899s
	iters: 200, epoch: 55 | loss: 0.0814596
	speed: 0.0225s/iter; left time: 226.4621s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.36s
Steps: 223 | Train Loss: 0.0829082 Vali Loss: 0.0839973 Test Loss: 0.1191791
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0827185
	speed: 0.0503s/iter; left time: 500.1209s
	iters: 200, epoch: 56 | loss: 0.0800721
	speed: 0.0239s/iter; left time: 234.6742s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.49s
Steps: 223 | Train Loss: 0.0829025 Vali Loss: 0.0839681 Test Loss: 0.1191142
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0834955
	speed: 0.0510s/iter; left time: 495.6749s
	iters: 200, epoch: 57 | loss: 0.0855532
	speed: 0.0250s/iter; left time: 239.9826s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.75s
Steps: 223 | Train Loss: 0.0837015 Vali Loss: 0.0841293 Test Loss: 0.1184584
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0803595
	speed: 0.0519s/iter; left time: 492.5632s
	iters: 200, epoch: 58 | loss: 0.0822290
	speed: 0.0224s/iter; left time: 210.7548s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.44s
Steps: 223 | Train Loss: 0.0829205 Vali Loss: 0.0839069 Test Loss: 0.1189180
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0823312
	speed: 0.0604s/iter; left time: 560.0524s
	iters: 200, epoch: 59 | loss: 0.0823177
	speed: 0.0334s/iter; left time: 306.5128s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:07.32s
Steps: 223 | Train Loss: 0.0830652 Vali Loss: 0.0839202 Test Loss: 0.1194182
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03177133947610855, rmse:0.1782451719045639, mae:0.11749859899282455, rse:0.5236682891845703
Intermediate time for ES and pred_len 168: 00h:24m:19.95s
Intermediate time for ES: 01h:36m:09.35s

=== Starting experiments for country: FR ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2181389
	speed: 0.0423s/iter; left time: 942.6217s
	iters: 200, epoch: 1 | loss: 0.2111445
	speed: 0.0217s/iter; left time: 482.8121s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.54s
Steps: 224 | Train Loss: 0.2282664 Vali Loss: 0.1756847 Test Loss: 0.1781302
Validation loss decreased (inf --> 0.175685).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1335730
	speed: 0.0453s/iter; left time: 1001.1880s
	iters: 200, epoch: 2 | loss: 0.1074380
	speed: 0.0218s/iter; left time: 478.7046s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.1404796 Vali Loss: 0.0845311 Test Loss: 0.0938503
Validation loss decreased (0.175685 --> 0.084531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0853166
	speed: 0.0509s/iter; left time: 1112.2445s
	iters: 200, epoch: 3 | loss: 0.0792229
	speed: 0.0220s/iter; left time: 479.5260s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.72s
Steps: 224 | Train Loss: 0.0880394 Vali Loss: 0.0806688 Test Loss: 0.0855705
Validation loss decreased (0.084531 --> 0.080669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0731423
	speed: 0.0498s/iter; left time: 1077.8728s
	iters: 200, epoch: 4 | loss: 0.0740642
	speed: 0.0217s/iter; left time: 467.3959s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0730655 Vali Loss: 0.0691024 Test Loss: 0.0712667
Validation loss decreased (0.080669 --> 0.069102).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0754679
	speed: 0.0524s/iter; left time: 1121.6967s
	iters: 200, epoch: 5 | loss: 0.0652138
	speed: 0.0230s/iter; left time: 489.0386s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.79s
Steps: 224 | Train Loss: 0.0662490 Vali Loss: 0.0648778 Test Loss: 0.0669197
Validation loss decreased (0.069102 --> 0.064878).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0644869
	speed: 0.0907s/iter; left time: 1920.4291s
	iters: 200, epoch: 6 | loss: 0.0584586
	speed: 0.0377s/iter; left time: 795.6066s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.68s
Steps: 224 | Train Loss: 0.0622531 Vali Loss: 0.0639652 Test Loss: 0.0666962
Validation loss decreased (0.064878 --> 0.063965).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0674949
	speed: 0.0746s/iter; left time: 1564.1282s
	iters: 200, epoch: 7 | loss: 0.0582944
	speed: 0.0343s/iter; left time: 714.4735s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.18s
Steps: 224 | Train Loss: 0.0588587 Vali Loss: 0.0622077 Test Loss: 0.0646266
Validation loss decreased (0.063965 --> 0.062208).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0585581
	speed: 0.0716s/iter; left time: 1484.8755s
	iters: 200, epoch: 8 | loss: 0.0569029
	speed: 0.0284s/iter; left time: 586.9076s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.45s
Steps: 224 | Train Loss: 0.0567618 Vali Loss: 0.0615584 Test Loss: 0.0641556
Validation loss decreased (0.062208 --> 0.061558).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0528698
	speed: 0.0658s/iter; left time: 1349.0457s
	iters: 200, epoch: 9 | loss: 0.0579437
	speed: 0.0720s/iter; left time: 1468.5759s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.05s
Steps: 224 | Train Loss: 0.0552896 Vali Loss: 0.0615507 Test Loss: 0.0641657
Validation loss decreased (0.061558 --> 0.061551).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0546288
	speed: 0.0760s/iter; left time: 1540.8223s
	iters: 200, epoch: 10 | loss: 0.0551801
	speed: 0.0310s/iter; left time: 625.8715s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.91s
Steps: 224 | Train Loss: 0.0542231 Vali Loss: 0.0603106 Test Loss: 0.0630094
Validation loss decreased (0.061551 --> 0.060311).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0561088
	speed: 0.1170s/iter; left time: 2347.8200s
	iters: 200, epoch: 11 | loss: 0.0542017
	speed: 0.0373s/iter; left time: 743.6668s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.84s
Steps: 224 | Train Loss: 0.0536799 Vali Loss: 0.0598929 Test Loss: 0.0625099
Validation loss decreased (0.060311 --> 0.059893).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0499799
	speed: 0.0700s/iter; left time: 1388.2059s
	iters: 200, epoch: 12 | loss: 0.0523489
	speed: 0.0221s/iter; left time: 435.5728s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0529196 Vali Loss: 0.0602319 Test Loss: 0.0624424
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0491447
	speed: 0.0902s/iter; left time: 1768.5301s
	iters: 200, epoch: 13 | loss: 0.0520317
	speed: 0.0384s/iter; left time: 748.9097s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.45s
Steps: 224 | Train Loss: 0.0523668 Vali Loss: 0.0609408 Test Loss: 0.0633019
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0507173
	speed: 0.1209s/iter; left time: 2344.1409s
	iters: 200, epoch: 14 | loss: 0.0496766
	speed: 0.0220s/iter; left time: 423.7006s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.74s
Steps: 224 | Train Loss: 0.0524151 Vali Loss: 0.0590211 Test Loss: 0.0615146
Validation loss decreased (0.059893 --> 0.059021).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0520709
	speed: 0.0549s/iter; left time: 1051.5509s
	iters: 200, epoch: 15 | loss: 0.0485042
	speed: 0.0229s/iter; left time: 435.9379s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.49s
Steps: 224 | Train Loss: 0.0517539 Vali Loss: 0.0590966 Test Loss: 0.0613239
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0489230
	speed: 0.0550s/iter; left time: 1041.2109s
	iters: 200, epoch: 16 | loss: 0.0493918
	speed: 0.0219s/iter; left time: 412.3841s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.77s
Steps: 224 | Train Loss: 0.0515838 Vali Loss: 0.0601093 Test Loss: 0.0623992
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0536681
	speed: 0.2253s/iter; left time: 4217.4673s
	iters: 200, epoch: 17 | loss: 0.0495015
	speed: 0.1086s/iter; left time: 2022.5506s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:24.66s
Steps: 224 | Train Loss: 0.0510330 Vali Loss: 0.0588917 Test Loss: 0.0610924
Validation loss decreased (0.059021 --> 0.058892).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0497430
	speed: 0.1394s/iter; left time: 2577.6853s
	iters: 200, epoch: 18 | loss: 0.0503742
	speed: 0.0221s/iter; left time: 406.8475s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0510123 Vali Loss: 0.0601279 Test Loss: 0.0624680
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0476078
	speed: 0.0588s/iter; left time: 1073.4730s
	iters: 200, epoch: 19 | loss: 0.0500075
	speed: 0.0221s/iter; left time: 401.1010s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.01s
Steps: 224 | Train Loss: 0.0507696 Vali Loss: 0.0584594 Test Loss: 0.0606458
Validation loss decreased (0.058892 --> 0.058459).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0492038
	speed: 0.0529s/iter; left time: 954.8555s
	iters: 200, epoch: 20 | loss: 0.0507360
	speed: 0.0225s/iter; left time: 403.7326s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.57s
Steps: 224 | Train Loss: 0.0507538 Vali Loss: 0.0582857 Test Loss: 0.0605878
Validation loss decreased (0.058459 --> 0.058286).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0492622
	speed: 0.0485s/iter; left time: 865.0052s
	iters: 200, epoch: 21 | loss: 0.0504524
	speed: 0.0221s/iter; left time: 391.7706s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0503666 Vali Loss: 0.0579396 Test Loss: 0.0603647
Validation loss decreased (0.058286 --> 0.057940).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0513644
	speed: 0.0503s/iter; left time: 885.3366s
	iters: 200, epoch: 22 | loss: 0.0459494
	speed: 0.0220s/iter; left time: 385.4845s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0505424 Vali Loss: 0.0588128 Test Loss: 0.0610600
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0497645
	speed: 0.0497s/iter; left time: 863.9255s
	iters: 200, epoch: 23 | loss: 0.0514681
	speed: 0.0222s/iter; left time: 383.8841s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0502120 Vali Loss: 0.0581234 Test Loss: 0.0604336
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0499401
	speed: 0.0471s/iter; left time: 808.3519s
	iters: 200, epoch: 24 | loss: 0.0499325
	speed: 0.0221s/iter; left time: 377.1389s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0504926 Vali Loss: 0.0588108 Test Loss: 0.0610789
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0513012
	speed: 0.0477s/iter; left time: 806.6728s
	iters: 200, epoch: 25 | loss: 0.0503770
	speed: 0.0224s/iter; left time: 377.6992s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.32s
Steps: 224 | Train Loss: 0.0501510 Vali Loss: 0.0581049 Test Loss: 0.0603452
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0496439
	speed: 0.0503s/iter; left time: 839.3671s
	iters: 200, epoch: 26 | loss: 0.0481229
	speed: 0.0221s/iter; left time: 367.0816s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0503726 Vali Loss: 0.0579120 Test Loss: 0.0601472
Validation loss decreased (0.057940 --> 0.057912).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0490163
	speed: 0.0485s/iter; left time: 798.3652s
	iters: 200, epoch: 27 | loss: 0.0505212
	speed: 0.0222s/iter; left time: 363.2949s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0496494 Vali Loss: 0.0579971 Test Loss: 0.0603009
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0505238
	speed: 0.0485s/iter; left time: 788.5522s
	iters: 200, epoch: 28 | loss: 0.0463742
	speed: 0.0220s/iter; left time: 354.9950s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0497998 Vali Loss: 0.0577769 Test Loss: 0.0599692
Validation loss decreased (0.057912 --> 0.057777).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0504089
	speed: 0.0482s/iter; left time: 773.2761s
	iters: 200, epoch: 29 | loss: 0.0454021
	speed: 0.0219s/iter; left time: 348.7729s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0504761 Vali Loss: 0.0579274 Test Loss: 0.0602867
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0521598
	speed: 0.0466s/iter; left time: 737.0820s
	iters: 200, epoch: 30 | loss: 0.0467220
	speed: 0.0219s/iter; left time: 344.1073s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0495564 Vali Loss: 0.0576815 Test Loss: 0.0600906
Validation loss decreased (0.057777 --> 0.057682).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0493723
	speed: 0.0476s/iter; left time: 741.8108s
	iters: 200, epoch: 31 | loss: 0.0491822
	speed: 0.0218s/iter; left time: 338.0048s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0498529 Vali Loss: 0.0577074 Test Loss: 0.0599608
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0486430
	speed: 0.0493s/iter; left time: 757.3346s
	iters: 200, epoch: 32 | loss: 0.0494532
	speed: 0.0219s/iter; left time: 334.1955s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0496040 Vali Loss: 0.0576057 Test Loss: 0.0598874
Validation loss decreased (0.057682 --> 0.057606).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0521381
	speed: 0.0601s/iter; left time: 909.3992s
	iters: 200, epoch: 33 | loss: 0.0496465
	speed: 0.0224s/iter; left time: 337.4179s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.95s
Steps: 224 | Train Loss: 0.0495375 Vali Loss: 0.0575679 Test Loss: 0.0599047
Validation loss decreased (0.057606 --> 0.057568).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0495186
	speed: 0.0554s/iter; left time: 826.2716s
	iters: 200, epoch: 34 | loss: 0.0505130
	speed: 0.0236s/iter; left time: 349.1493s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.61s
Steps: 224 | Train Loss: 0.0494590 Vali Loss: 0.0572821 Test Loss: 0.0598328
Validation loss decreased (0.057568 --> 0.057282).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0497583
	speed: 0.0492s/iter; left time: 722.4498s
	iters: 200, epoch: 35 | loss: 0.0494283
	speed: 0.0230s/iter; left time: 335.0708s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.55s
Steps: 224 | Train Loss: 0.0494937 Vali Loss: 0.0574199 Test Loss: 0.0597772
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0553845
	speed: 0.0490s/iter; left time: 707.9229s
	iters: 200, epoch: 36 | loss: 0.0485990
	speed: 0.0229s/iter; left time: 328.9182s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.42s
Steps: 224 | Train Loss: 0.0494848 Vali Loss: 0.0574528 Test Loss: 0.0598290
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0499468
	speed: 0.0522s/iter; left time: 743.0099s
	iters: 200, epoch: 37 | loss: 0.0467454
	speed: 0.0217s/iter; left time: 307.2157s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0492623 Vali Loss: 0.0573258 Test Loss: 0.0596462
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0515565
	speed: 0.0479s/iter; left time: 671.4395s
	iters: 200, epoch: 38 | loss: 0.0490454
	speed: 0.0220s/iter; left time: 306.1413s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0493678 Vali Loss: 0.0575336 Test Loss: 0.0599693
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0484858
	speed: 0.0518s/iter; left time: 713.7315s
	iters: 200, epoch: 39 | loss: 0.0442455
	speed: 0.0219s/iter; left time: 299.6128s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.36s
Steps: 224 | Train Loss: 0.0500937 Vali Loss: 0.0574429 Test Loss: 0.0596627
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0461038
	speed: 0.1501s/iter; left time: 2036.6287s
	iters: 200, epoch: 40 | loss: 0.0503352
	speed: 0.0849s/iter; left time: 1142.8588s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:19.47s
Steps: 224 | Train Loss: 0.0495371 Vali Loss: 0.0574576 Test Loss: 0.0597609
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0493464
	speed: 0.2096s/iter; left time: 2796.4139s
	iters: 200, epoch: 41 | loss: 0.0462544
	speed: 0.0948s/iter; left time: 1255.7473s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:21.90s
Steps: 224 | Train Loss: 0.0492944 Vali Loss: 0.0575011 Test Loss: 0.0597424
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0488407
	speed: 0.2330s/iter; left time: 3056.6766s
	iters: 200, epoch: 42 | loss: 0.0512784
	speed: 0.1033s/iter; left time: 1344.6906s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:23.84s
Steps: 224 | Train Loss: 0.0492729 Vali Loss: 0.0573449 Test Loss: 0.0596914
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0486517
	speed: 0.2438s/iter; left time: 3143.4189s
	iters: 200, epoch: 43 | loss: 0.0475234
	speed: 0.1096s/iter; left time: 1402.7301s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:25.14s
Steps: 224 | Train Loss: 0.0492627 Vali Loss: 0.0573355 Test Loss: 0.0596530
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0479487
	speed: 0.2491s/iter; left time: 3155.3380s
	iters: 200, epoch: 44 | loss: 0.0517511
	speed: 0.1237s/iter; left time: 1554.6595s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:27.17s
Steps: 224 | Train Loss: 0.0493188 Vali Loss: 0.0573661 Test Loss: 0.0596808
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010692856274545193, rmse:0.10340626537799835, mae:0.05983283743262291, rse:0.39893850684165955
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2238776
	speed: 0.1438s/iter; left time: 3207.2239s
	iters: 200, epoch: 1 | loss: 0.2199372
	speed: 0.1348s/iter; left time: 2992.8101s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:31.13s
Steps: 224 | Train Loss: 0.2308412 Vali Loss: 0.1738702 Test Loss: 0.1778450
Validation loss decreased (inf --> 0.173870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1397499
	speed: 0.3244s/iter; left time: 7160.9088s
	iters: 200, epoch: 2 | loss: 0.1070898
	speed: 0.1510s/iter; left time: 3319.5499s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.76s
Steps: 224 | Train Loss: 0.1410326 Vali Loss: 0.0851479 Test Loss: 0.0923280
Validation loss decreased (0.173870 --> 0.085148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0844316
	speed: 0.3156s/iter; left time: 6897.3151s
	iters: 200, epoch: 3 | loss: 0.0732632
	speed: 0.1415s/iter; left time: 3077.3625s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.31s
Steps: 224 | Train Loss: 0.0857306 Vali Loss: 0.0761224 Test Loss: 0.0807494
Validation loss decreased (0.085148 --> 0.076122).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0688671
	speed: 0.3335s/iter; left time: 7213.9760s
	iters: 200, epoch: 4 | loss: 0.0646466
	speed: 0.1455s/iter; left time: 3133.2291s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.94s
Steps: 224 | Train Loss: 0.0718340 Vali Loss: 0.0682892 Test Loss: 0.0719383
Validation loss decreased (0.076122 --> 0.068289).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0639480
	speed: 0.3358s/iter; left time: 7188.5156s
	iters: 200, epoch: 5 | loss: 0.0652785
	speed: 0.1518s/iter; left time: 3233.1168s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.15s
Steps: 224 | Train Loss: 0.0645230 Vali Loss: 0.0651082 Test Loss: 0.0669089
Validation loss decreased (0.068289 --> 0.065108).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0601370
	speed: 0.3324s/iter; left time: 7039.5063s
	iters: 200, epoch: 6 | loss: 0.0599416
	speed: 0.1346s/iter; left time: 2837.8386s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.26s
Steps: 224 | Train Loss: 0.0609692 Vali Loss: 0.0630643 Test Loss: 0.0658917
Validation loss decreased (0.065108 --> 0.063064).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0618367
	speed: 0.2052s/iter; left time: 4300.7352s
	iters: 200, epoch: 7 | loss: 0.0621108
	speed: 0.0636s/iter; left time: 1325.9109s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0583880 Vali Loss: 0.0617803 Test Loss: 0.0647742
Validation loss decreased (0.063064 --> 0.061780).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0603552
	speed: 0.1114s/iter; left time: 2309.3989s
	iters: 200, epoch: 8 | loss: 0.0552273
	speed: 0.0419s/iter; left time: 863.6267s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.89s
Steps: 224 | Train Loss: 0.0570003 Vali Loss: 0.0623857 Test Loss: 0.0651683
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0580590
	speed: 0.0712s/iter; left time: 1460.2524s
	iters: 200, epoch: 9 | loss: 0.0558249
	speed: 0.0222s/iter; left time: 453.6805s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.78s
Steps: 224 | Train Loss: 0.0554910 Vali Loss: 0.0606182 Test Loss: 0.0633043
Validation loss decreased (0.061780 --> 0.060618).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0514987
	speed: 0.0638s/iter; left time: 1293.4871s
	iters: 200, epoch: 10 | loss: 0.0537644
	speed: 0.0221s/iter; left time: 446.6063s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.91s
Steps: 224 | Train Loss: 0.0547479 Vali Loss: 0.0604669 Test Loss: 0.0629814
Validation loss decreased (0.060618 --> 0.060467).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0582203
	speed: 0.0478s/iter; left time: 959.0280s
	iters: 200, epoch: 11 | loss: 0.0510238
	speed: 0.0227s/iter; left time: 453.8767s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.38s
Steps: 224 | Train Loss: 0.0535369 Vali Loss: 0.0600753 Test Loss: 0.0629466
Validation loss decreased (0.060467 --> 0.060075).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0497893
	speed: 0.0474s/iter; left time: 940.1629s
	iters: 200, epoch: 12 | loss: 0.0549461
	speed: 0.0219s/iter; left time: 432.9156s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0530421 Vali Loss: 0.0598029 Test Loss: 0.0623554
Validation loss decreased (0.060075 --> 0.059803).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0514712
	speed: 0.0477s/iter; left time: 935.7059s
	iters: 200, epoch: 13 | loss: 0.0519583
	speed: 0.0221s/iter; left time: 431.7084s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0524211 Vali Loss: 0.0599230 Test Loss: 0.0622225
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0518662
	speed: 0.0476s/iter; left time: 923.8851s
	iters: 200, epoch: 14 | loss: 0.0576374
	speed: 0.0220s/iter; left time: 424.1745s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0520754 Vali Loss: 0.0591416 Test Loss: 0.0620827
Validation loss decreased (0.059803 --> 0.059142).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0500874
	speed: 0.0512s/iter; left time: 982.1009s
	iters: 200, epoch: 15 | loss: 0.0491530
	speed: 0.0224s/iter; left time: 427.5099s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.52s
Steps: 224 | Train Loss: 0.0517628 Vali Loss: 0.0592827 Test Loss: 0.0617519
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0495952
	speed: 0.0501s/iter; left time: 948.5709s
	iters: 200, epoch: 16 | loss: 0.0511160
	speed: 0.0228s/iter; left time: 429.5733s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0511870 Vali Loss: 0.0596020 Test Loss: 0.0618866
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0550806
	speed: 0.0479s/iter; left time: 896.2188s
	iters: 200, epoch: 17 | loss: 0.0539803
	speed: 0.0220s/iter; left time: 410.0405s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0509328 Vali Loss: 0.0591638 Test Loss: 0.0616277
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0543533
	speed: 0.0487s/iter; left time: 901.1706s
	iters: 200, epoch: 18 | loss: 0.0504614
	speed: 0.0222s/iter; left time: 407.4950s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0507323 Vali Loss: 0.0585130 Test Loss: 0.0611160
Validation loss decreased (0.059142 --> 0.058513).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0503640
	speed: 0.0486s/iter; left time: 887.2341s
	iters: 200, epoch: 19 | loss: 0.0508841
	speed: 0.0221s/iter; left time: 401.3528s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0505779 Vali Loss: 0.0590454 Test Loss: 0.0613929
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0510542
	speed: 0.0465s/iter; left time: 839.5827s
	iters: 200, epoch: 20 | loss: 0.0499415
	speed: 0.0221s/iter; left time: 396.1149s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0505025 Vali Loss: 0.0584744 Test Loss: 0.0609798
Validation loss decreased (0.058513 --> 0.058474).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0507782
	speed: 0.0488s/iter; left time: 870.1704s
	iters: 200, epoch: 21 | loss: 0.0505576
	speed: 0.0220s/iter; left time: 390.3540s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0504429 Vali Loss: 0.0583836 Test Loss: 0.0609875
Validation loss decreased (0.058474 --> 0.058384).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0523653
	speed: 0.0481s/iter; left time: 846.9052s
	iters: 200, epoch: 22 | loss: 0.0506558
	speed: 0.0226s/iter; left time: 396.1410s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0502916 Vali Loss: 0.0587589 Test Loss: 0.0612226
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0502890
	speed: 0.0481s/iter; left time: 835.2881s
	iters: 200, epoch: 23 | loss: 0.0524690
	speed: 0.0222s/iter; left time: 384.0273s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.39s
Steps: 224 | Train Loss: 0.0502929 Vali Loss: 0.0581677 Test Loss: 0.0607068
Validation loss decreased (0.058384 --> 0.058168).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0478213
	speed: 0.0486s/iter; left time: 832.8191s
	iters: 200, epoch: 24 | loss: 0.0495805
	speed: 0.0221s/iter; left time: 377.0914s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0498449 Vali Loss: 0.0580927 Test Loss: 0.0607255
Validation loss decreased (0.058168 --> 0.058093).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0524558
	speed: 0.0477s/iter; left time: 806.8037s
	iters: 200, epoch: 25 | loss: 0.0499604
	speed: 0.0228s/iter; left time: 383.0036s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0496702 Vali Loss: 0.0582178 Test Loss: 0.0607320
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0508272
	speed: 0.0461s/iter; left time: 770.6979s
	iters: 200, epoch: 26 | loss: 0.0493832
	speed: 0.0217s/iter; left time: 359.8553s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0496571 Vali Loss: 0.0579094 Test Loss: 0.0605363
Validation loss decreased (0.058093 --> 0.057909).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0494116
	speed: 0.0467s/iter; left time: 769.3822s
	iters: 200, epoch: 27 | loss: 0.0470841
	speed: 0.0268s/iter; left time: 439.3852s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.69s
Steps: 224 | Train Loss: 0.0497032 Vali Loss: 0.0579863 Test Loss: 0.0605785
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0500381
	speed: 0.0461s/iter; left time: 749.2422s
	iters: 200, epoch: 28 | loss: 0.0467145
	speed: 0.0218s/iter; left time: 352.2999s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0495302 Vali Loss: 0.0579791 Test Loss: 0.0605632
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0508404
	speed: 0.0463s/iter; left time: 741.9473s
	iters: 200, epoch: 29 | loss: 0.0487442
	speed: 0.0220s/iter; left time: 350.8613s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0494444 Vali Loss: 0.0576994 Test Loss: 0.0602702
Validation loss decreased (0.057909 --> 0.057699).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0509346
	speed: 0.0515s/iter; left time: 814.2687s
	iters: 200, epoch: 30 | loss: 0.0499654
	speed: 0.0225s/iter; left time: 353.9659s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.91s
Steps: 224 | Train Loss: 0.0495514 Vali Loss: 0.0583604 Test Loss: 0.0607955
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0472625
	speed: 0.0780s/iter; left time: 1214.7451s
	iters: 200, epoch: 31 | loss: 0.0488732
	speed: 0.0458s/iter; left time: 709.1260s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.45s
Steps: 224 | Train Loss: 0.0494602 Vali Loss: 0.0578260 Test Loss: 0.0604986
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0475019
	speed: 0.0792s/iter; left time: 1215.5292s
	iters: 200, epoch: 32 | loss: 0.0472471
	speed: 0.0284s/iter; left time: 433.4448s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.01s
Steps: 224 | Train Loss: 0.0493985 Vali Loss: 0.0577442 Test Loss: 0.0603134
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0515064
	speed: 0.0815s/iter; left time: 1233.2785s
	iters: 200, epoch: 33 | loss: 0.0511645
	speed: 0.0231s/iter; left time: 347.4126s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.70s
Steps: 224 | Train Loss: 0.0494639 Vali Loss: 0.0578927 Test Loss: 0.0603282
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0494170
	speed: 0.0725s/iter; left time: 1080.9080s
	iters: 200, epoch: 34 | loss: 0.0483500
	speed: 0.0337s/iter; left time: 498.5423s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0493969 Vali Loss: 0.0576735 Test Loss: 0.0601843
Validation loss decreased (0.057699 --> 0.057674).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0513475
	speed: 0.0916s/iter; left time: 1345.1856s
	iters: 200, epoch: 35 | loss: 0.0497545
	speed: 0.0492s/iter; left time: 717.5162s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:10.88s
Steps: 224 | Train Loss: 0.0492897 Vali Loss: 0.0577359 Test Loss: 0.0602614
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0486509
	speed: 0.0820s/iter; left time: 1186.3009s
	iters: 200, epoch: 36 | loss: 0.0486447
	speed: 0.0324s/iter; left time: 465.2463s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.05s
Steps: 224 | Train Loss: 0.0491634 Vali Loss: 0.0581053 Test Loss: 0.0604686
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0504069
	speed: 0.0544s/iter; left time: 774.4366s
	iters: 200, epoch: 37 | loss: 0.0508944
	speed: 0.0428s/iter; left time: 605.4606s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0493389 Vali Loss: 0.0580694 Test Loss: 0.0605951
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0498142
	speed: 0.0723s/iter; left time: 1013.6829s
	iters: 200, epoch: 38 | loss: 0.0535306
	speed: 0.0268s/iter; left time: 372.2390s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0491768 Vali Loss: 0.0577984 Test Loss: 0.0603210
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0479649
	speed: 0.0847s/iter; left time: 1168.4331s
	iters: 200, epoch: 39 | loss: 0.0483298
	speed: 0.0276s/iter; left time: 378.4172s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.27s
Steps: 224 | Train Loss: 0.0491452 Vali Loss: 0.0577033 Test Loss: 0.0602172
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0549906
	speed: 0.0586s/iter; left time: 794.7912s
	iters: 200, epoch: 40 | loss: 0.0484521
	speed: 0.0221s/iter; left time: 297.8997s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0490414 Vali Loss: 0.0580225 Test Loss: 0.0605082
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0504148
	speed: 0.0465s/iter; left time: 620.1265s
	iters: 200, epoch: 41 | loss: 0.0520856
	speed: 0.0241s/iter; left time: 318.5056s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.44s
Steps: 224 | Train Loss: 0.0492775 Vali Loss: 0.0578421 Test Loss: 0.0602738
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0487371
	speed: 0.0474s/iter; left time: 622.0906s
	iters: 200, epoch: 42 | loss: 0.0480233
	speed: 0.1175s/iter; left time: 1529.3307s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:16.71s
Steps: 224 | Train Loss: 0.0491841 Vali Loss: 0.0576177 Test Loss: 0.0601421
Validation loss decreased (0.057674 --> 0.057618).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0469763
	speed: 0.1284s/iter; left time: 1655.9647s
	iters: 200, epoch: 43 | loss: 0.0462332
	speed: 0.0224s/iter; left time: 286.1770s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.95s
Steps: 224 | Train Loss: 0.0491818 Vali Loss: 0.0580329 Test Loss: 0.0604734
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0474150
	speed: 0.0534s/iter; left time: 676.8829s
	iters: 200, epoch: 44 | loss: 0.0497090
	speed: 0.0220s/iter; left time: 276.0797s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0489806 Vali Loss: 0.0576674 Test Loss: 0.0601253
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0541993
	speed: 0.0502s/iter; left time: 624.5786s
	iters: 200, epoch: 45 | loss: 0.0468344
	speed: 0.0221s/iter; left time: 273.2984s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.52s
Steps: 224 | Train Loss: 0.0491557 Vali Loss: 0.0580009 Test Loss: 0.0605467
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0472145
	speed: 0.0472s/iter; left time: 576.9023s
	iters: 200, epoch: 46 | loss: 0.0499069
	speed: 0.0230s/iter; left time: 279.2257s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0491439 Vali Loss: 0.0577477 Test Loss: 0.0602472
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0478656
	speed: 0.0498s/iter; left time: 597.6648s
	iters: 200, epoch: 47 | loss: 0.0507970
	speed: 0.0221s/iter; left time: 263.1997s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.36s
Steps: 224 | Train Loss: 0.0490501 Vali Loss: 0.0577089 Test Loss: 0.0601807
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0484469
	speed: 0.0489s/iter; left time: 575.4132s
	iters: 200, epoch: 48 | loss: 0.0460149
	speed: 0.0230s/iter; left time: 267.9525s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.47s
Steps: 224 | Train Loss: 0.0489795 Vali Loss: 0.0576736 Test Loss: 0.0601960
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0465929
	speed: 0.0459s/iter; left time: 530.6530s
	iters: 200, epoch: 49 | loss: 0.0501260
	speed: 0.0218s/iter; left time: 249.4104s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0489428 Vali Loss: 0.0577261 Test Loss: 0.0603393
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0487732
	speed: 0.0475s/iter; left time: 537.9460s
	iters: 200, epoch: 50 | loss: 0.0506231
	speed: 0.0223s/iter; left time: 250.8056s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0490604 Vali Loss: 0.0577683 Test Loss: 0.0603072
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0501885
	speed: 0.0462s/iter; left time: 512.3241s
	iters: 200, epoch: 51 | loss: 0.0547067
	speed: 0.0220s/iter; left time: 241.9519s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0489707 Vali Loss: 0.0577308 Test Loss: 0.0602313
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0481584
	speed: 0.0483s/iter; left time: 525.2650s
	iters: 200, epoch: 52 | loss: 0.0509942
	speed: 0.0219s/iter; left time: 236.5295s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0489932 Vali Loss: 0.0576674 Test Loss: 0.0601333
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010759114287793636, rmse:0.10372614860534668, mae:0.060142070055007935, rse:0.400172621011734
Intermediate time for FR and pred_len 24: 00h:20m:38.01s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2240245
	speed: 0.0416s/iter; left time: 927.7392s
	iters: 200, epoch: 1 | loss: 0.2113192
	speed: 0.0222s/iter; left time: 492.1751s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.50s
Steps: 224 | Train Loss: 0.2283497 Vali Loss: 0.1739580 Test Loss: 0.1797017
Validation loss decreased (inf --> 0.173958).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1330688
	speed: 0.0480s/iter; left time: 1060.2614s
	iters: 200, epoch: 2 | loss: 0.0952607
	speed: 0.0221s/iter; left time: 485.5419s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.1327202 Vali Loss: 0.0966959 Test Loss: 0.1073981
Validation loss decreased (0.173958 --> 0.096696).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0883310
	speed: 0.0488s/iter; left time: 1065.5016s
	iters: 200, epoch: 3 | loss: 0.0831665
	speed: 0.0223s/iter; left time: 485.5828s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0886843 Vali Loss: 0.0872609 Test Loss: 0.0957687
Validation loss decreased (0.096696 --> 0.087261).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0776227
	speed: 0.0479s/iter; left time: 1036.5109s
	iters: 200, epoch: 4 | loss: 0.0792914
	speed: 0.0221s/iter; left time: 475.1677s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0803742 Vali Loss: 0.0814710 Test Loss: 0.0886934
Validation loss decreased (0.087261 --> 0.081471).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0765714
	speed: 0.0479s/iter; left time: 1026.1248s
	iters: 200, epoch: 5 | loss: 0.0724871
	speed: 0.0221s/iter; left time: 470.3463s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0753350 Vali Loss: 0.0804394 Test Loss: 0.0878026
Validation loss decreased (0.081471 --> 0.080439).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0765132
	speed: 0.0487s/iter; left time: 1031.2926s
	iters: 200, epoch: 6 | loss: 0.0706679
	speed: 0.0222s/iter; left time: 467.3439s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0723140 Vali Loss: 0.0791895 Test Loss: 0.0866288
Validation loss decreased (0.080439 --> 0.079189).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0731258
	speed: 0.0497s/iter; left time: 1040.6166s
	iters: 200, epoch: 7 | loss: 0.0666939
	speed: 0.0220s/iter; left time: 459.8172s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0704234 Vali Loss: 0.0786359 Test Loss: 0.0859985
Validation loss decreased (0.079189 --> 0.078636).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0726401
	speed: 0.0489s/iter; left time: 1014.1302s
	iters: 200, epoch: 8 | loss: 0.0644573
	speed: 0.0224s/iter; left time: 462.7235s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0691421 Vali Loss: 0.0781973 Test Loss: 0.0847168
Validation loss decreased (0.078636 --> 0.078197).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0663860
	speed: 0.0486s/iter; left time: 997.4943s
	iters: 200, epoch: 9 | loss: 0.0692389
	speed: 0.0222s/iter; left time: 454.0675s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0680945 Vali Loss: 0.0776647 Test Loss: 0.0845357
Validation loss decreased (0.078197 --> 0.077665).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0730154
	speed: 0.0480s/iter; left time: 972.7246s
	iters: 200, epoch: 10 | loss: 0.0654681
	speed: 0.0220s/iter; left time: 444.3771s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0673039 Vali Loss: 0.0768565 Test Loss: 0.0839240
Validation loss decreased (0.077665 --> 0.076856).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0669478
	speed: 0.0480s/iter; left time: 963.0611s
	iters: 200, epoch: 11 | loss: 0.0670770
	speed: 0.0221s/iter; left time: 441.8703s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0664055 Vali Loss: 0.0757632 Test Loss: 0.0831133
Validation loss decreased (0.076856 --> 0.075763).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0659748
	speed: 0.0481s/iter; left time: 953.4734s
	iters: 200, epoch: 12 | loss: 0.0649201
	speed: 0.0222s/iter; left time: 437.3905s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0657379 Vali Loss: 0.0752631 Test Loss: 0.0824693
Validation loss decreased (0.075763 --> 0.075263).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0651626
	speed: 0.0484s/iter; left time: 948.8708s
	iters: 200, epoch: 13 | loss: 0.0642733
	speed: 0.0222s/iter; left time: 432.8418s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0655296 Vali Loss: 0.0755158 Test Loss: 0.0822028
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0641511
	speed: 0.0487s/iter; left time: 943.4170s
	iters: 200, epoch: 14 | loss: 0.0636778
	speed: 0.0221s/iter; left time: 425.4525s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0651803 Vali Loss: 0.0754950 Test Loss: 0.0828709
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0597649
	speed: 0.0469s/iter; left time: 898.3442s
	iters: 200, epoch: 15 | loss: 0.0671977
	speed: 0.0222s/iter; left time: 422.3284s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0648215 Vali Loss: 0.0749222 Test Loss: 0.0825845
Validation loss decreased (0.075263 --> 0.074922).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0659904
	speed: 0.0523s/iter; left time: 991.1458s
	iters: 200, epoch: 16 | loss: 0.0663506
	speed: 0.0221s/iter; left time: 416.5408s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.67s
Steps: 224 | Train Loss: 0.0646141 Vali Loss: 0.0747127 Test Loss: 0.0831591
Validation loss decreased (0.074922 --> 0.074713).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0635233
	speed: 0.0477s/iter; left time: 891.9304s
	iters: 200, epoch: 17 | loss: 0.0653920
	speed: 0.0238s/iter; left time: 443.9899s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.38s
Steps: 224 | Train Loss: 0.0646924 Vali Loss: 0.0746150 Test Loss: 0.0824308
Validation loss decreased (0.074713 --> 0.074615).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0638666
	speed: 0.0500s/iter; left time: 924.2424s
	iters: 200, epoch: 18 | loss: 0.0626611
	speed: 0.0232s/iter; left time: 425.9482s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.54s
Steps: 224 | Train Loss: 0.0643123 Vali Loss: 0.0744744 Test Loss: 0.0818504
Validation loss decreased (0.074615 --> 0.074474).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0657596
	speed: 0.0528s/iter; left time: 964.4591s
	iters: 200, epoch: 19 | loss: 0.0669883
	speed: 0.0226s/iter; left time: 410.0647s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0640575 Vali Loss: 0.0742902 Test Loss: 0.0825695
Validation loss decreased (0.074474 --> 0.074290).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0678251
	speed: 0.0478s/iter; left time: 862.4559s
	iters: 200, epoch: 20 | loss: 0.0647803
	speed: 0.0220s/iter; left time: 394.8627s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0638947 Vali Loss: 0.0745984 Test Loss: 0.0827921
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0684504
	speed: 0.0480s/iter; left time: 855.8661s
	iters: 200, epoch: 21 | loss: 0.0588741
	speed: 0.0220s/iter; left time: 389.9513s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0638984 Vali Loss: 0.0741406 Test Loss: 0.0819883
Validation loss decreased (0.074290 --> 0.074141).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0637087
	speed: 0.0566s/iter; left time: 995.1361s
	iters: 200, epoch: 22 | loss: 0.0690711
	speed: 0.0263s/iter; left time: 459.3593s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0636500 Vali Loss: 0.0743338 Test Loss: 0.0825969
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0625623
	speed: 0.2479s/iter; left time: 4306.8308s
	iters: 200, epoch: 23 | loss: 0.0641554
	speed: 0.0849s/iter; left time: 1465.7164s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:19.39s
Steps: 224 | Train Loss: 0.0634766 Vali Loss: 0.0740194 Test Loss: 0.0820352
Validation loss decreased (0.074141 --> 0.074019).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0637390
	speed: 0.3130s/iter; left time: 5368.1550s
	iters: 200, epoch: 24 | loss: 0.0606070
	speed: 0.1151s/iter; left time: 1961.6912s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:25.51s
Steps: 224 | Train Loss: 0.0635890 Vali Loss: 0.0742006 Test Loss: 0.0827429
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0633780
	speed: 0.3987s/iter; left time: 6747.6332s
	iters: 200, epoch: 25 | loss: 0.0618385
	speed: 0.1243s/iter; left time: 2091.8173s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:28.84s
Steps: 224 | Train Loss: 0.0633556 Vali Loss: 0.0741020 Test Loss: 0.0825217
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0609069
	speed: 0.4256s/iter; left time: 7108.2215s
	iters: 200, epoch: 26 | loss: 0.0658677
	speed: 0.1384s/iter; left time: 2298.3380s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:31.04s
Steps: 224 | Train Loss: 0.0632520 Vali Loss: 0.0740732 Test Loss: 0.0827943
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0617492
	speed: 0.4468s/iter; left time: 7361.5735s
	iters: 200, epoch: 27 | loss: 0.0640935
	speed: 0.1481s/iter; left time: 2425.4712s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:33.53s
Steps: 224 | Train Loss: 0.0631660 Vali Loss: 0.0740148 Test Loss: 0.0825152
Validation loss decreased (0.074019 --> 0.074015).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0631003
	speed: 0.5189s/iter; left time: 8432.9106s
	iters: 200, epoch: 28 | loss: 0.0642913
	speed: 0.1586s/iter; left time: 2562.5899s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:36.13s
Steps: 224 | Train Loss: 0.0631812 Vali Loss: 0.0739217 Test Loss: 0.0823328
Validation loss decreased (0.074015 --> 0.073922).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0616707
	speed: 0.5634s/iter; left time: 9030.5401s
	iters: 200, epoch: 29 | loss: 0.0669227
	speed: 0.1665s/iter; left time: 2651.8406s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:38.19s
Steps: 224 | Train Loss: 0.0630494 Vali Loss: 0.0739371 Test Loss: 0.0823464
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0641048
	speed: 0.6002s/iter; left time: 9486.7922s
	iters: 200, epoch: 30 | loss: 0.0604357
	speed: 0.1739s/iter; left time: 2730.5389s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:38.86s
Steps: 224 | Train Loss: 0.0641775 Vali Loss: 0.0742520 Test Loss: 0.0832336
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0660663
	speed: 0.6060s/iter; left time: 9442.3751s
	iters: 200, epoch: 31 | loss: 0.0622601
	speed: 0.1706s/iter; left time: 2641.6507s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:41.56s
Steps: 224 | Train Loss: 0.0630109 Vali Loss: 0.0742410 Test Loss: 0.0831718
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0620665
	speed: 0.6355s/iter; left time: 9760.0290s
	iters: 200, epoch: 32 | loss: 0.0636683
	speed: 0.1865s/iter; left time: 2844.8022s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:41.63s
Steps: 224 | Train Loss: 0.0629453 Vali Loss: 0.0737900 Test Loss: 0.0822646
Validation loss decreased (0.073922 --> 0.073790).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0630421
	speed: 0.6778s/iter; left time: 10257.8095s
	iters: 200, epoch: 33 | loss: 0.0644787
	speed: 0.1781s/iter; left time: 2677.0944s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:43.01s
Steps: 224 | Train Loss: 0.0628614 Vali Loss: 0.0739471 Test Loss: 0.0824428
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0632831
	speed: 0.5310s/iter; left time: 7916.3074s
	iters: 200, epoch: 34 | loss: 0.0623300
	speed: 0.0778s/iter; left time: 1151.7777s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:22.65s
Steps: 224 | Train Loss: 0.0628739 Vali Loss: 0.0739185 Test Loss: 0.0825257
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0610376
	speed: 0.1789s/iter; left time: 2627.0455s
	iters: 200, epoch: 35 | loss: 0.0646330
	speed: 0.0501s/iter; left time: 731.2716s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:11.30s
Steps: 224 | Train Loss: 0.0629654 Vali Loss: 0.0736852 Test Loss: 0.0821136
Validation loss decreased (0.073790 --> 0.073685).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0610374
	speed: 0.0604s/iter; left time: 872.7934s
	iters: 200, epoch: 36 | loss: 0.0597058
	speed: 0.0310s/iter; left time: 445.6185s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.59s
Steps: 224 | Train Loss: 0.0628428 Vali Loss: 0.0738940 Test Loss: 0.0824627
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0640828
	speed: 0.0566s/iter; left time: 806.2312s
	iters: 200, epoch: 37 | loss: 0.0630297
	speed: 0.0232s/iter; left time: 328.6434s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.55s
Steps: 224 | Train Loss: 0.0628334 Vali Loss: 0.0740189 Test Loss: 0.0828486
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0609034
	speed: 0.0522s/iter; left time: 731.2162s
	iters: 200, epoch: 38 | loss: 0.0641180
	speed: 0.0223s/iter; left time: 310.1149s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.44s
Steps: 224 | Train Loss: 0.0628331 Vali Loss: 0.0738035 Test Loss: 0.0823092
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0585223
	speed: 0.0503s/iter; left time: 694.1082s
	iters: 200, epoch: 39 | loss: 0.0686546
	speed: 0.0221s/iter; left time: 303.1894s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0627320 Vali Loss: 0.0737875 Test Loss: 0.0822878
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0641906
	speed: 0.0510s/iter; left time: 691.6492s
	iters: 200, epoch: 40 | loss: 0.0646643
	speed: 0.0222s/iter; left time: 298.4415s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.36s
Steps: 224 | Train Loss: 0.0628855 Vali Loss: 0.0737326 Test Loss: 0.0820833
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0662549
	speed: 0.0501s/iter; left time: 668.4277s
	iters: 200, epoch: 41 | loss: 0.0582558
	speed: 0.0221s/iter; left time: 292.4984s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0627494 Vali Loss: 0.0740342 Test Loss: 0.0828347
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0630391
	speed: 0.0504s/iter; left time: 661.0425s
	iters: 200, epoch: 42 | loss: 0.0635225
	speed: 0.0221s/iter; left time: 287.2226s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.32s
Steps: 224 | Train Loss: 0.0627333 Vali Loss: 0.0738710 Test Loss: 0.0824965
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0646420
	speed: 0.0505s/iter; left time: 651.5405s
	iters: 200, epoch: 43 | loss: 0.0631472
	speed: 0.0225s/iter; left time: 287.2908s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.42s
Steps: 224 | Train Loss: 0.0627789 Vali Loss: 0.0737849 Test Loss: 0.0821379
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0644815
	speed: 0.0498s/iter; left time: 631.0076s
	iters: 200, epoch: 44 | loss: 0.0613300
	speed: 0.0225s/iter; left time: 283.2005s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0627792 Vali Loss: 0.0738404 Test Loss: 0.0823312
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0640033
	speed: 0.0504s/iter; left time: 627.6111s
	iters: 200, epoch: 45 | loss: 0.0641519
	speed: 0.0221s/iter; left time: 272.2985s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.32s
Steps: 224 | Train Loss: 0.0628419 Vali Loss: 0.0737427 Test Loss: 0.0821432
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01954476721584797, rmse:0.13980260491371155, mae:0.08211354166269302, rse:0.5407935976982117
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2294929
	speed: 0.0254s/iter; left time: 565.6436s
	iters: 200, epoch: 1 | loss: 0.2141254
	speed: 0.0221s/iter; left time: 491.4352s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.2334311 Vali Loss: 0.1722753 Test Loss: 0.1772561
Validation loss decreased (inf --> 0.172275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1282267
	speed: 0.0494s/iter; left time: 1091.2354s
	iters: 200, epoch: 2 | loss: 0.1004032
	speed: 0.0221s/iter; left time: 486.7634s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.1324808 Vali Loss: 0.0985475 Test Loss: 0.1091164
Validation loss decreased (0.172275 --> 0.098547).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0860634
	speed: 0.0496s/iter; left time: 1083.1344s
	iters: 200, epoch: 3 | loss: 0.0858575
	speed: 0.0221s/iter; left time: 479.7255s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0882981 Vali Loss: 0.0853176 Test Loss: 0.0929129
Validation loss decreased (0.098547 --> 0.085318).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0809617
	speed: 0.0487s/iter; left time: 1054.0262s
	iters: 200, epoch: 4 | loss: 0.0768849
	speed: 0.0220s/iter; left time: 474.3861s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0794786 Vali Loss: 0.0823246 Test Loss: 0.0894653
Validation loss decreased (0.085318 --> 0.082325).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0760063
	speed: 0.0488s/iter; left time: 1044.0511s
	iters: 200, epoch: 5 | loss: 0.0741239
	speed: 0.0221s/iter; left time: 470.1240s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0754624 Vali Loss: 0.0797599 Test Loss: 0.0867928
Validation loss decreased (0.082325 --> 0.079760).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0691110
	speed: 0.0494s/iter; left time: 1046.5392s
	iters: 200, epoch: 6 | loss: 0.0712478
	speed: 0.0221s/iter; left time: 466.2563s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0725687 Vali Loss: 0.0788398 Test Loss: 0.0863109
Validation loss decreased (0.079760 --> 0.078840).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0669708
	speed: 0.0492s/iter; left time: 1030.0945s
	iters: 200, epoch: 7 | loss: 0.0698299
	speed: 0.0220s/iter; left time: 459.8694s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0704604 Vali Loss: 0.0786574 Test Loss: 0.0861561
Validation loss decreased (0.078840 --> 0.078657).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0654070
	speed: 0.0484s/iter; left time: 1003.2186s
	iters: 200, epoch: 8 | loss: 0.0671207
	speed: 0.0221s/iter; left time: 455.4992s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0693980 Vali Loss: 0.0785316 Test Loss: 0.0860373
Validation loss decreased (0.078657 --> 0.078532).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0718002
	speed: 0.0487s/iter; left time: 999.6695s
	iters: 200, epoch: 9 | loss: 0.0773943
	speed: 0.0222s/iter; left time: 452.7229s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0683717 Vali Loss: 0.0769011 Test Loss: 0.0839162
Validation loss decreased (0.078532 --> 0.076901).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0698994
	speed: 0.0483s/iter; left time: 980.1023s
	iters: 200, epoch: 10 | loss: 0.0656860
	speed: 0.0220s/iter; left time: 443.5288s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0674244 Vali Loss: 0.0768939 Test Loss: 0.0844743
Validation loss decreased (0.076901 --> 0.076894).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0671276
	speed: 0.0486s/iter; left time: 974.5661s
	iters: 200, epoch: 11 | loss: 0.0659138
	speed: 0.0222s/iter; left time: 442.4072s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0668561 Vali Loss: 0.0759056 Test Loss: 0.0833722
Validation loss decreased (0.076894 --> 0.075906).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0613027
	speed: 0.0485s/iter; left time: 962.2508s
	iters: 200, epoch: 12 | loss: 0.0642147
	speed: 0.0222s/iter; left time: 437.3395s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0664663 Vali Loss: 0.0763738 Test Loss: 0.0830978
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0677178
	speed: 0.0482s/iter; left time: 945.9364s
	iters: 200, epoch: 13 | loss: 0.0614443
	speed: 0.0220s/iter; left time: 428.5029s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0659990 Vali Loss: 0.0758844 Test Loss: 0.0834444
Validation loss decreased (0.075906 --> 0.075884).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0634627
	speed: 0.0491s/iter; left time: 951.0647s
	iters: 200, epoch: 14 | loss: 0.0692620
	speed: 0.0220s/iter; left time: 424.7800s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0656032 Vali Loss: 0.0752800 Test Loss: 0.0831799
Validation loss decreased (0.075884 --> 0.075280).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0672221
	speed: 0.0488s/iter; left time: 934.5374s
	iters: 200, epoch: 15 | loss: 0.0633345
	speed: 0.0219s/iter; left time: 418.1441s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0650491 Vali Loss: 0.0756333 Test Loss: 0.0840749
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0610732
	speed: 0.0471s/iter; left time: 892.1804s
	iters: 200, epoch: 16 | loss: 0.0700565
	speed: 0.0219s/iter; left time: 412.1326s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0650323 Vali Loss: 0.0750159 Test Loss: 0.0832009
Validation loss decreased (0.075280 --> 0.075016).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0636975
	speed: 0.0481s/iter; left time: 900.6692s
	iters: 200, epoch: 17 | loss: 0.0597611
	speed: 0.0219s/iter; left time: 408.2889s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0648637 Vali Loss: 0.0746917 Test Loss: 0.0827398
Validation loss decreased (0.075016 --> 0.074692).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0653481
	speed: 0.0483s/iter; left time: 893.5987s
	iters: 200, epoch: 18 | loss: 0.0641423
	speed: 0.0219s/iter; left time: 402.7411s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0644399 Vali Loss: 0.0746251 Test Loss: 0.0825982
Validation loss decreased (0.074692 --> 0.074625).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0686329
	speed: 0.0478s/iter; left time: 872.7393s
	iters: 200, epoch: 19 | loss: 0.0665067
	speed: 0.0218s/iter; left time: 396.5179s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0644815 Vali Loss: 0.0744981 Test Loss: 0.0826726
Validation loss decreased (0.074625 --> 0.074498).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0658588
	speed: 0.0532s/iter; left time: 959.2962s
	iters: 200, epoch: 20 | loss: 0.0638259
	speed: 0.0220s/iter; left time: 394.8273s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.77s
Steps: 224 | Train Loss: 0.0642745 Vali Loss: 0.0742996 Test Loss: 0.0827153
Validation loss decreased (0.074498 --> 0.074300).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0624551
	speed: 0.0477s/iter; left time: 849.8152s
	iters: 200, epoch: 21 | loss: 0.0660841
	speed: 0.0219s/iter; left time: 388.3071s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0640175 Vali Loss: 0.0742694 Test Loss: 0.0828999
Validation loss decreased (0.074300 --> 0.074269).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0619114
	speed: 0.0481s/iter; left time: 846.3375s
	iters: 200, epoch: 22 | loss: 0.0643567
	speed: 0.0268s/iter; left time: 468.8550s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.71s
Steps: 224 | Train Loss: 0.0640181 Vali Loss: 0.0741758 Test Loss: 0.0829286
Validation loss decreased (0.074269 --> 0.074176).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0625725
	speed: 0.0631s/iter; left time: 1096.3423s
	iters: 200, epoch: 23 | loss: 0.0590775
	speed: 0.0439s/iter; left time: 757.8422s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.77s
Steps: 224 | Train Loss: 0.0639112 Vali Loss: 0.0740160 Test Loss: 0.0828236
Validation loss decreased (0.074176 --> 0.074016).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0649727
	speed: 0.0985s/iter; left time: 1689.3893s
	iters: 200, epoch: 24 | loss: 0.0631907
	speed: 0.0348s/iter; left time: 593.7492s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.40s
Steps: 224 | Train Loss: 0.0637529 Vali Loss: 0.0739267 Test Loss: 0.0825191
Validation loss decreased (0.074016 --> 0.073927).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0637167
	speed: 0.0923s/iter; left time: 1562.5232s
	iters: 200, epoch: 25 | loss: 0.0633136
	speed: 0.0325s/iter; left time: 547.4488s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.89s
Steps: 224 | Train Loss: 0.0637175 Vali Loss: 0.0739865 Test Loss: 0.0828237
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0652302
	speed: 0.0959s/iter; left time: 1601.3982s
	iters: 200, epoch: 26 | loss: 0.0637102
	speed: 0.0540s/iter; left time: 896.8070s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0635596 Vali Loss: 0.0740698 Test Loss: 0.0824577
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0624344
	speed: 0.1296s/iter; left time: 2136.1683s
	iters: 200, epoch: 27 | loss: 0.0636434
	speed: 0.0492s/iter; left time: 805.2769s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.35s
Steps: 224 | Train Loss: 0.0634665 Vali Loss: 0.0737717 Test Loss: 0.0822112
Validation loss decreased (0.073927 --> 0.073772).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0671510
	speed: 0.0521s/iter; left time: 846.5278s
	iters: 200, epoch: 28 | loss: 0.0627728
	speed: 0.0397s/iter; left time: 641.3040s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.68s
Steps: 224 | Train Loss: 0.0635948 Vali Loss: 0.0738380 Test Loss: 0.0822671
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0608605
	speed: 0.0960s/iter; left time: 1539.2174s
	iters: 200, epoch: 29 | loss: 0.0666260
	speed: 0.0312s/iter; left time: 496.4801s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0633621 Vali Loss: 0.0738937 Test Loss: 0.0823346
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0624807
	speed: 0.0762s/iter; left time: 1204.2630s
	iters: 200, epoch: 30 | loss: 0.0613603
	speed: 0.0293s/iter; left time: 460.5447s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.68s
Steps: 224 | Train Loss: 0.0635463 Vali Loss: 0.0738404 Test Loss: 0.0825350
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0631546
	speed: 0.1042s/iter; left time: 1623.5324s
	iters: 200, epoch: 31 | loss: 0.0665270
	speed: 0.0219s/iter; left time: 339.6944s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0633463 Vali Loss: 0.0739144 Test Loss: 0.0829653
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0584389
	speed: 0.0465s/iter; left time: 714.6513s
	iters: 200, epoch: 32 | loss: 0.0629507
	speed: 0.0219s/iter; left time: 334.0073s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0634271 Vali Loss: 0.0737236 Test Loss: 0.0823442
Validation loss decreased (0.073772 --> 0.073724).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0634116
	speed: 0.0476s/iter; left time: 720.4429s
	iters: 200, epoch: 33 | loss: 0.0655307
	speed: 0.0762s/iter; left time: 1145.2220s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0632614 Vali Loss: 0.0737668 Test Loss: 0.0827176
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0609357
	speed: 0.2995s/iter; left time: 4465.8943s
	iters: 200, epoch: 34 | loss: 0.0634871
	speed: 0.1313s/iter; left time: 1945.1318s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:28.58s
Steps: 224 | Train Loss: 0.0633259 Vali Loss: 0.0736853 Test Loss: 0.0824721
Validation loss decreased (0.073724 --> 0.073685).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0658228
	speed: 0.3888s/iter; left time: 5709.7782s
	iters: 200, epoch: 35 | loss: 0.0621590
	speed: 0.0397s/iter; left time: 579.3924s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:11.18s
Steps: 224 | Train Loss: 0.0631578 Vali Loss: 0.0737039 Test Loss: 0.0826853
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0673323
	speed: 0.0610s/iter; left time: 882.6185s
	iters: 200, epoch: 36 | loss: 0.0604972
	speed: 0.0229s/iter; left time: 328.2967s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.87s
Steps: 224 | Train Loss: 0.0630547 Vali Loss: 0.0736483 Test Loss: 0.0825203
Validation loss decreased (0.073685 --> 0.073648).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0635277
	speed: 0.0507s/iter; left time: 721.2296s
	iters: 200, epoch: 37 | loss: 0.0611792
	speed: 0.0223s/iter; left time: 314.6533s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0632276 Vali Loss: 0.0736629 Test Loss: 0.0823932
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0620902
	speed: 0.0482s/iter; left time: 675.8526s
	iters: 200, epoch: 38 | loss: 0.0666074
	speed: 0.0231s/iter; left time: 321.7804s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.43s
Steps: 224 | Train Loss: 0.0630680 Vali Loss: 0.0736212 Test Loss: 0.0826019
Validation loss decreased (0.073648 --> 0.073621).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0598154
	speed: 0.0496s/iter; left time: 683.7204s
	iters: 200, epoch: 39 | loss: 0.0604868
	speed: 0.0221s/iter; left time: 302.1943s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0631140 Vali Loss: 0.0736632 Test Loss: 0.0824528
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0615100
	speed: 0.0477s/iter; left time: 646.4065s
	iters: 200, epoch: 40 | loss: 0.0626080
	speed: 0.0221s/iter; left time: 297.9971s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0630364 Vali Loss: 0.0735574 Test Loss: 0.0826276
Validation loss decreased (0.073621 --> 0.073557).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0580416
	speed: 0.0486s/iter; left time: 649.0229s
	iters: 200, epoch: 41 | loss: 0.0660710
	speed: 0.0223s/iter; left time: 295.3818s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0630894 Vali Loss: 0.0736317 Test Loss: 0.0825958
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0658373
	speed: 0.0483s/iter; left time: 633.5021s
	iters: 200, epoch: 42 | loss: 0.0628427
	speed: 0.0222s/iter; left time: 288.4334s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0631375 Vali Loss: 0.0736379 Test Loss: 0.0822467
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0600216
	speed: 0.0472s/iter; left time: 607.9220s
	iters: 200, epoch: 43 | loss: 0.0605232
	speed: 0.0220s/iter; left time: 281.8905s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0630474 Vali Loss: 0.0736033 Test Loss: 0.0821347
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0635931
	speed: 0.0476s/iter; left time: 602.4242s
	iters: 200, epoch: 44 | loss: 0.0638608
	speed: 0.0219s/iter; left time: 275.6610s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0630168 Vali Loss: 0.0735331 Test Loss: 0.0823951
Validation loss decreased (0.073557 --> 0.073533).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0655058
	speed: 0.0485s/iter; left time: 603.8482s
	iters: 200, epoch: 45 | loss: 0.0630669
	speed: 0.0221s/iter; left time: 272.5059s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0629838 Vali Loss: 0.0735118 Test Loss: 0.0824546
Validation loss decreased (0.073533 --> 0.073512).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0617724
	speed: 0.0477s/iter; left time: 583.3207s
	iters: 200, epoch: 46 | loss: 0.0633209
	speed: 0.0219s/iter; left time: 265.7553s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0631229 Vali Loss: 0.0735310 Test Loss: 0.0822719
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0604569
	speed: 0.0473s/iter; left time: 567.3404s
	iters: 200, epoch: 47 | loss: 0.0643957
	speed: 0.0218s/iter; left time: 259.7840s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0631294 Vali Loss: 0.0735828 Test Loss: 0.0824356
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0613695
	speed: 0.0473s/iter; left time: 556.2885s
	iters: 200, epoch: 48 | loss: 0.0632272
	speed: 0.0219s/iter; left time: 255.4166s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0630086 Vali Loss: 0.0735530 Test Loss: 0.0824805
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0598075
	speed: 0.0477s/iter; left time: 550.9795s
	iters: 200, epoch: 49 | loss: 0.0621441
	speed: 0.0218s/iter; left time: 249.7595s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0629597 Vali Loss: 0.0735895 Test Loss: 0.0826616
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0680106
	speed: 0.0473s/iter; left time: 535.9361s
	iters: 200, epoch: 50 | loss: 0.0589682
	speed: 0.0219s/iter; left time: 245.8182s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0630845 Vali Loss: 0.0736245 Test Loss: 0.0825281
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0629302
	speed: 0.0472s/iter; left time: 523.9599s
	iters: 200, epoch: 51 | loss: 0.0630434
	speed: 0.0220s/iter; left time: 241.8037s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0630434 Vali Loss: 0.0735503 Test Loss: 0.0823759
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0676790
	speed: 0.0475s/iter; left time: 516.8913s
	iters: 200, epoch: 52 | loss: 0.0644478
	speed: 0.0219s/iter; left time: 236.0795s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0628469 Vali Loss: 0.0736275 Test Loss: 0.0824844
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0628749
	speed: 0.0473s/iter; left time: 503.9684s
	iters: 200, epoch: 53 | loss: 0.0655811
	speed: 0.0219s/iter; left time: 231.3781s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0629909 Vali Loss: 0.0735519 Test Loss: 0.0825564
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0661383
	speed: 0.0476s/iter; left time: 496.0919s
	iters: 200, epoch: 54 | loss: 0.0616498
	speed: 0.0220s/iter; left time: 227.3579s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0629410 Vali Loss: 0.0735419 Test Loss: 0.0822997
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0658125
	speed: 0.0472s/iter; left time: 481.4123s
	iters: 200, epoch: 55 | loss: 0.0579743
	speed: 0.0219s/iter; left time: 221.1717s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0629055 Vali Loss: 0.0735505 Test Loss: 0.0824005
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019625447690486908, rmse:0.14009085297584534, mae:0.08245458453893661, rse:0.5419086217880249
Intermediate time for FR and pred_len 96: 00h:25m:53.01s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2317283
	speed: 0.0419s/iter; left time: 929.7325s
	iters: 200, epoch: 1 | loss: 0.2119953
	speed: 0.0222s/iter; left time: 491.0332s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.55s
Steps: 223 | Train Loss: 0.2302330 Vali Loss: 0.1743387 Test Loss: 0.1786744
Validation loss decreased (inf --> 0.174339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1314083
	speed: 0.0480s/iter; left time: 1054.0578s
	iters: 200, epoch: 2 | loss: 0.0985461
	speed: 0.0222s/iter; left time: 486.7535s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.1297914 Vali Loss: 0.0987522 Test Loss: 0.1098587
Validation loss decreased (0.174339 --> 0.098752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0945369
	speed: 0.0523s/iter; left time: 1138.7334s
	iters: 200, epoch: 3 | loss: 0.0840309
	speed: 0.0221s/iter; left time: 479.3877s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0900157 Vali Loss: 0.0897248 Test Loss: 0.0989699
Validation loss decreased (0.098752 --> 0.089725).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0842518
	speed: 0.0490s/iter; left time: 1055.2420s
	iters: 200, epoch: 4 | loss: 0.0829651
	speed: 0.0222s/iter; left time: 475.1205s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0823543 Vali Loss: 0.0845757 Test Loss: 0.0921284
Validation loss decreased (0.089725 --> 0.084576).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0813215
	speed: 0.0505s/iter; left time: 1075.2825s
	iters: 200, epoch: 5 | loss: 0.0763549
	speed: 0.0236s/iter; left time: 500.2448s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.43s
Steps: 223 | Train Loss: 0.0779761 Vali Loss: 0.0830024 Test Loss: 0.0916281
Validation loss decreased (0.084576 --> 0.083002).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0711770
	speed: 0.0487s/iter; left time: 1026.4761s
	iters: 200, epoch: 6 | loss: 0.0761437
	speed: 0.0221s/iter; left time: 463.5132s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0750340 Vali Loss: 0.0815916 Test Loss: 0.0903480
Validation loss decreased (0.083002 --> 0.081592).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0764776
	speed: 0.0469s/iter; left time: 978.3045s
	iters: 200, epoch: 7 | loss: 0.0722997
	speed: 0.0221s/iter; left time: 458.2666s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0733261 Vali Loss: 0.0810975 Test Loss: 0.0901351
Validation loss decreased (0.081592 --> 0.081098).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0663537
	speed: 0.0520s/iter; left time: 1073.1008s
	iters: 200, epoch: 8 | loss: 0.0752048
	speed: 0.0220s/iter; left time: 451.2996s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.46s
Steps: 223 | Train Loss: 0.0722930 Vali Loss: 0.0804326 Test Loss: 0.0895729
Validation loss decreased (0.081098 --> 0.080433).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0726083
	speed: 0.0509s/iter; left time: 1039.3875s
	iters: 200, epoch: 9 | loss: 0.0662002
	speed: 0.0949s/iter; left time: 1927.3419s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.10s
Steps: 223 | Train Loss: 0.0712899 Vali Loss: 0.0797627 Test Loss: 0.0913882
Validation loss decreased (0.080433 --> 0.079763).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0687232
	speed: 0.5543s/iter; left time: 11193.5184s
	iters: 200, epoch: 10 | loss: 0.0681385
	speed: 0.1788s/iter; left time: 3592.9032s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:39.81s
Steps: 223 | Train Loss: 0.0703177 Vali Loss: 0.0791177 Test Loss: 0.0893971
Validation loss decreased (0.079763 --> 0.079118).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0767913
	speed: 0.3773s/iter; left time: 7534.2660s
	iters: 200, epoch: 11 | loss: 0.0669642
	speed: 0.0232s/iter; left time: 461.8834s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.90s
Steps: 223 | Train Loss: 0.0698199 Vali Loss: 0.0786923 Test Loss: 0.0910984
Validation loss decreased (0.079118 --> 0.078692).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0678120
	speed: 0.0501s/iter; left time: 990.2408s
	iters: 200, epoch: 12 | loss: 0.0690882
	speed: 0.0222s/iter; left time: 435.7322s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0692048 Vali Loss: 0.0783656 Test Loss: 0.0895246
Validation loss decreased (0.078692 --> 0.078366).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0699115
	speed: 0.0477s/iter; left time: 930.6391s
	iters: 200, epoch: 13 | loss: 0.0689497
	speed: 0.0220s/iter; left time: 427.5357s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0689567 Vali Loss: 0.0782556 Test Loss: 0.0902306
Validation loss decreased (0.078366 --> 0.078256).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0689784
	speed: 0.0461s/iter; left time: 890.6232s
	iters: 200, epoch: 14 | loss: 0.0712334
	speed: 0.0218s/iter; left time: 419.2342s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0686478 Vali Loss: 0.0780328 Test Loss: 0.0894486
Validation loss decreased (0.078256 --> 0.078033).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0661036
	speed: 0.0468s/iter; left time: 892.5463s
	iters: 200, epoch: 15 | loss: 0.0705416
	speed: 0.0219s/iter; left time: 415.5197s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0685273 Vali Loss: 0.0779664 Test Loss: 0.0901319
Validation loss decreased (0.078033 --> 0.077966).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0692449
	speed: 0.0483s/iter; left time: 910.9337s
	iters: 200, epoch: 16 | loss: 0.0698579
	speed: 0.0219s/iter; left time: 411.3843s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0680099 Vali Loss: 0.0779450 Test Loss: 0.0912172
Validation loss decreased (0.077966 --> 0.077945).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0666914
	speed: 0.0472s/iter; left time: 879.8152s
	iters: 200, epoch: 17 | loss: 0.0702515
	speed: 0.0264s/iter; left time: 488.8558s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.58s
Steps: 223 | Train Loss: 0.0680035 Vali Loss: 0.0781178 Test Loss: 0.0910641
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0680600
	speed: 0.0514s/iter; left time: 947.0094s
	iters: 200, epoch: 18 | loss: 0.0678294
	speed: 0.0220s/iter; left time: 402.3699s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.42s
Steps: 223 | Train Loss: 0.0677992 Vali Loss: 0.0781043 Test Loss: 0.0910614
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0656894
	speed: 0.0488s/iter; left time: 886.8078s
	iters: 200, epoch: 19 | loss: 0.0676644
	speed: 0.0219s/iter; left time: 395.6110s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0676094 Vali Loss: 0.0776037 Test Loss: 0.0894377
Validation loss decreased (0.077945 --> 0.077604).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0685511
	speed: 0.0465s/iter; left time: 834.7264s
	iters: 200, epoch: 20 | loss: 0.0641573
	speed: 0.0220s/iter; left time: 393.6543s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0675627 Vali Loss: 0.0778171 Test Loss: 0.0908302
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0650135
	speed: 0.0460s/iter; left time: 816.8365s
	iters: 200, epoch: 21 | loss: 0.0678574
	speed: 0.0223s/iter; left time: 393.5866s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0672910 Vali Loss: 0.0779659 Test Loss: 0.0916981
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0676335
	speed: 0.0470s/iter; left time: 823.9679s
	iters: 200, epoch: 22 | loss: 0.0747136
	speed: 0.0227s/iter; left time: 395.6133s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.33s
Steps: 223 | Train Loss: 0.0672116 Vali Loss: 0.0773651 Test Loss: 0.0899247
Validation loss decreased (0.077604 --> 0.077365).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0669376
	speed: 0.0470s/iter; left time: 813.1126s
	iters: 200, epoch: 23 | loss: 0.0675555
	speed: 0.0220s/iter; left time: 377.8988s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0670507 Vali Loss: 0.0776652 Test Loss: 0.0912330
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0712600
	speed: 0.0478s/iter; left time: 815.6306s
	iters: 200, epoch: 24 | loss: 0.0657399
	speed: 0.0220s/iter; left time: 374.1935s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0670268 Vali Loss: 0.0775723 Test Loss: 0.0907516
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0673945
	speed: 0.0471s/iter; left time: 793.3310s
	iters: 200, epoch: 25 | loss: 0.0703666
	speed: 0.0222s/iter; left time: 371.7494s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.26s
Steps: 223 | Train Loss: 0.0669197 Vali Loss: 0.0774367 Test Loss: 0.0903643
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0706103
	speed: 0.0470s/iter; left time: 781.7453s
	iters: 200, epoch: 26 | loss: 0.0660480
	speed: 0.0220s/iter; left time: 362.7732s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0668781 Vali Loss: 0.0775632 Test Loss: 0.0908478
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0640762
	speed: 0.0460s/iter; left time: 755.3207s
	iters: 200, epoch: 27 | loss: 0.0670196
	speed: 0.0220s/iter; left time: 358.8019s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0668569 Vali Loss: 0.0774982 Test Loss: 0.0906081
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0639818
	speed: 0.0470s/iter; left time: 760.6536s
	iters: 200, epoch: 28 | loss: 0.0672523
	speed: 0.0224s/iter; left time: 360.5096s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0667927 Vali Loss: 0.0771706 Test Loss: 0.0893452
Validation loss decreased (0.077365 --> 0.077171).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0658996
	speed: 0.0510s/iter; left time: 813.0607s
	iters: 200, epoch: 29 | loss: 0.0669276
	speed: 0.0220s/iter; left time: 349.1493s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0667988 Vali Loss: 0.0777658 Test Loss: 0.0917429
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0668975
	speed: 0.0462s/iter; left time: 727.5209s
	iters: 200, epoch: 30 | loss: 0.0684645
	speed: 0.0220s/iter; left time: 344.6252s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0667102 Vali Loss: 0.0776424 Test Loss: 0.0913128
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0629755
	speed: 0.0501s/iter; left time: 776.4016s
	iters: 200, epoch: 31 | loss: 0.0660803
	speed: 0.0221s/iter; left time: 341.1518s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.58s
Steps: 223 | Train Loss: 0.0666626 Vali Loss: 0.0775424 Test Loss: 0.0906453
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0671377
	speed: 0.0502s/iter; left time: 767.7252s
	iters: 200, epoch: 32 | loss: 0.0686621
	speed: 0.0220s/iter; left time: 333.4265s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.33s
Steps: 223 | Train Loss: 0.0665423 Vali Loss: 0.0774537 Test Loss: 0.0905649
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0632359
	speed: 0.0912s/iter; left time: 1374.6761s
	iters: 200, epoch: 33 | loss: 0.0663969
	speed: 0.0235s/iter; left time: 352.2256s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.57s
Steps: 223 | Train Loss: 0.0665035 Vali Loss: 0.0776388 Test Loss: 0.0908128
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0658519
	speed: 0.0506s/iter; left time: 750.5538s
	iters: 200, epoch: 34 | loss: 0.0709227
	speed: 0.0220s/iter; left time: 325.0158s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.57s
Steps: 223 | Train Loss: 0.0665535 Vali Loss: 0.0772696 Test Loss: 0.0902845
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0645690
	speed: 0.0454s/iter; left time: 663.1361s
	iters: 200, epoch: 35 | loss: 0.0661122
	speed: 0.0219s/iter; left time: 318.6395s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.32s
Steps: 223 | Train Loss: 0.0664603 Vali Loss: 0.0778828 Test Loss: 0.0916361
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0639788
	speed: 0.0472s/iter; left time: 679.2795s
	iters: 200, epoch: 36 | loss: 0.0686976
	speed: 0.0240s/iter; left time: 343.8171s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.38s
Steps: 223 | Train Loss: 0.0665468 Vali Loss: 0.0774591 Test Loss: 0.0906879
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0655376
	speed: 0.0483s/iter; left time: 684.6155s
	iters: 200, epoch: 37 | loss: 0.0657179
	speed: 0.0240s/iter; left time: 338.2750s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.46s
Steps: 223 | Train Loss: 0.0664091 Vali Loss: 0.0773421 Test Loss: 0.0903268
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0717241
	speed: 0.0471s/iter; left time: 656.8142s
	iters: 200, epoch: 38 | loss: 0.0667918
	speed: 0.0220s/iter; left time: 304.2532s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0663713 Vali Loss: 0.0772991 Test Loss: 0.0900583
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023250561207532883, rmse:0.152481347322464, mae:0.08934521675109863, rse:0.5905746817588806
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2254948
	speed: 0.0676s/iter; left time: 1500.9200s
	iters: 200, epoch: 1 | loss: 0.2089711
	speed: 0.1278s/iter; left time: 2824.3785s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:23.89s
Steps: 223 | Train Loss: 0.2316177 Vali Loss: 0.1768054 Test Loss: 0.1802489
Validation loss decreased (inf --> 0.176805).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1204020
	speed: 0.6510s/iter; left time: 14307.7268s
	iters: 200, epoch: 2 | loss: 0.1047688
	speed: 0.0321s/iter; left time: 701.9483s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:20.44s
Steps: 223 | Train Loss: 0.1304562 Vali Loss: 0.0986905 Test Loss: 0.1087013
Validation loss decreased (0.176805 --> 0.098690).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0886309
	speed: 0.0487s/iter; left time: 1059.7583s
	iters: 200, epoch: 3 | loss: 0.0896669
	speed: 0.0221s/iter; left time: 478.2736s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0900223 Vali Loss: 0.0894369 Test Loss: 0.0992814
Validation loss decreased (0.098690 --> 0.089437).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0856129
	speed: 0.0478s/iter; left time: 1029.8206s
	iters: 200, epoch: 4 | loss: 0.0797408
	speed: 0.0220s/iter; left time: 471.0564s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0819482 Vali Loss: 0.0853961 Test Loss: 0.0927934
Validation loss decreased (0.089437 --> 0.085396).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0815468
	speed: 0.0457s/iter; left time: 973.4219s
	iters: 200, epoch: 5 | loss: 0.0814852
	speed: 0.0220s/iter; left time: 465.5604s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0783020 Vali Loss: 0.0841476 Test Loss: 0.0929229
Validation loss decreased (0.085396 --> 0.084148).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0754093
	speed: 0.0456s/iter; left time: 960.8492s
	iters: 200, epoch: 6 | loss: 0.0764751
	speed: 0.0218s/iter; left time: 458.2323s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0757417 Vali Loss: 0.0831923 Test Loss: 0.0922795
Validation loss decreased (0.084148 --> 0.083192).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0740787
	speed: 0.0502s/iter; left time: 1047.0985s
	iters: 200, epoch: 7 | loss: 0.0730897
	speed: 0.0219s/iter; left time: 454.3442s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.59s
Steps: 223 | Train Loss: 0.0739870 Vali Loss: 0.0809666 Test Loss: 0.0911169
Validation loss decreased (0.083192 --> 0.080967).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0686533
	speed: 0.0459s/iter; left time: 947.8846s
	iters: 200, epoch: 8 | loss: 0.0749585
	speed: 0.0219s/iter; left time: 449.1181s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0725260 Vali Loss: 0.0803784 Test Loss: 0.0915120
Validation loss decreased (0.080967 --> 0.080378).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0724952
	speed: 0.0460s/iter; left time: 938.2571s
	iters: 200, epoch: 9 | loss: 0.0711124
	speed: 0.0223s/iter; left time: 452.3920s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0715886 Vali Loss: 0.0800627 Test Loss: 0.0912529
Validation loss decreased (0.080378 --> 0.080063).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0712858
	speed: 0.0496s/iter; left time: 1002.3273s
	iters: 200, epoch: 10 | loss: 0.0706808
	speed: 0.0220s/iter; left time: 441.2732s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0706921 Vali Loss: 0.0794149 Test Loss: 0.0921003
Validation loss decreased (0.080063 --> 0.079415).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0672549
	speed: 0.0462s/iter; left time: 923.3993s
	iters: 200, epoch: 11 | loss: 0.0664750
	speed: 0.0220s/iter; left time: 436.2091s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0700090 Vali Loss: 0.0793510 Test Loss: 0.0934827
Validation loss decreased (0.079415 --> 0.079351).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0636529
	speed: 0.0472s/iter; left time: 932.3252s
	iters: 200, epoch: 12 | loss: 0.0663576
	speed: 0.0225s/iter; left time: 443.0218s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.27s
Steps: 223 | Train Loss: 0.0696431 Vali Loss: 0.0789604 Test Loss: 0.0925588
Validation loss decreased (0.079351 --> 0.078960).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0698583
	speed: 0.0476s/iter; left time: 929.2751s
	iters: 200, epoch: 13 | loss: 0.0658346
	speed: 0.0220s/iter; left time: 426.8051s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0692430 Vali Loss: 0.0783537 Test Loss: 0.0909085
Validation loss decreased (0.078960 --> 0.078354).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0719903
	speed: 0.0460s/iter; left time: 887.0499s
	iters: 200, epoch: 14 | loss: 0.0748286
	speed: 0.0220s/iter; left time: 423.0015s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0688559 Vali Loss: 0.0788919 Test Loss: 0.0937054
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0668124
	speed: 0.0459s/iter; left time: 875.5293s
	iters: 200, epoch: 15 | loss: 0.0677921
	speed: 0.0220s/iter; left time: 418.0167s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0691085 Vali Loss: 0.0784468 Test Loss: 0.0921480
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0694731
	speed: 0.0461s/iter; left time: 868.8752s
	iters: 200, epoch: 16 | loss: 0.0662075
	speed: 0.0223s/iter; left time: 418.7156s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0684266 Vali Loss: 0.0786279 Test Loss: 0.0945559
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0721494
	speed: 0.0485s/iter; left time: 903.6100s
	iters: 200, epoch: 17 | loss: 0.0703329
	speed: 0.0224s/iter; left time: 415.5215s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0681249 Vali Loss: 0.0779675 Test Loss: 0.0922431
Validation loss decreased (0.078354 --> 0.077968).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0677019
	speed: 0.0491s/iter; left time: 904.5164s
	iters: 200, epoch: 18 | loss: 0.0700197
	speed: 0.0222s/iter; left time: 406.2226s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.31s
Steps: 223 | Train Loss: 0.0681090 Vali Loss: 0.0778762 Test Loss: 0.0930999
Validation loss decreased (0.077968 --> 0.077876).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0661288
	speed: 0.0470s/iter; left time: 855.4669s
	iters: 200, epoch: 19 | loss: 0.0693792
	speed: 0.0220s/iter; left time: 397.9793s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0679404 Vali Loss: 0.0776933 Test Loss: 0.0916552
Validation loss decreased (0.077876 --> 0.077693).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0685285
	speed: 0.0552s/iter; left time: 991.1316s
	iters: 200, epoch: 20 | loss: 0.0708071
	speed: 0.0220s/iter; left time: 392.2943s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0677031 Vali Loss: 0.0778025 Test Loss: 0.0924273
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0637514
	speed: 0.0457s/iter; left time: 811.1554s
	iters: 200, epoch: 21 | loss: 0.0648506
	speed: 0.0218s/iter; left time: 385.3821s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0677317 Vali Loss: 0.0777700 Test Loss: 0.0924312
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0695439
	speed: 0.0865s/iter; left time: 1514.4766s
	iters: 200, epoch: 22 | loss: 0.0696051
	speed: 0.0260s/iter; left time: 452.8522s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.58s
Steps: 223 | Train Loss: 0.0674149 Vali Loss: 0.0780544 Test Loss: 0.0937120
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0710265
	speed: 0.0451s/iter; left time: 780.5340s
	iters: 200, epoch: 23 | loss: 0.0640255
	speed: 0.0219s/iter; left time: 376.7585s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0674414 Vali Loss: 0.0773848 Test Loss: 0.0900734
Validation loss decreased (0.077693 --> 0.077385).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0665562
	speed: 0.0482s/iter; left time: 822.1368s
	iters: 200, epoch: 24 | loss: 0.0638807
	speed: 0.0241s/iter; left time: 408.4248s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.52s
Steps: 223 | Train Loss: 0.0674211 Vali Loss: 0.0780355 Test Loss: 0.0931235
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0679073
	speed: 0.0488s/iter; left time: 822.9557s
	iters: 200, epoch: 25 | loss: 0.0673683
	speed: 0.0230s/iter; left time: 385.7597s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.45s
Steps: 223 | Train Loss: 0.0672398 Vali Loss: 0.0782380 Test Loss: 0.0947364
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0671922
	speed: 0.0460s/iter; left time: 765.3417s
	iters: 200, epoch: 26 | loss: 0.0680550
	speed: 0.0222s/iter; left time: 367.5158s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0671696 Vali Loss: 0.0782886 Test Loss: 0.0947017
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0645071
	speed: 0.0468s/iter; left time: 767.0596s
	iters: 200, epoch: 27 | loss: 0.0674032
	speed: 0.0219s/iter; left time: 357.0445s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0669790 Vali Loss: 0.0776945 Test Loss: 0.0929749
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0630683
	speed: 0.0916s/iter; left time: 1482.7752s
	iters: 200, epoch: 28 | loss: 0.0686370
	speed: 0.1732s/iter; left time: 2785.3571s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:26.46s
Steps: 223 | Train Loss: 0.0670140 Vali Loss: 0.0778409 Test Loss: 0.0932657
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0647907
	speed: 0.0665s/iter; left time: 1061.3560s
	iters: 200, epoch: 29 | loss: 0.0636980
	speed: 0.0259s/iter; left time: 410.5936s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.52s
Steps: 223 | Train Loss: 0.0668772 Vali Loss: 0.0778030 Test Loss: 0.0935969
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0648133
	speed: 0.0452s/iter; left time: 711.6610s
	iters: 200, epoch: 30 | loss: 0.0652288
	speed: 0.0218s/iter; left time: 340.1392s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0668610 Vali Loss: 0.0780473 Test Loss: 0.0945063
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0654122
	speed: 0.0453s/iter; left time: 702.1949s
	iters: 200, epoch: 31 | loss: 0.0667105
	speed: 0.0220s/iter; left time: 338.8278s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0671501 Vali Loss: 0.0773408 Test Loss: 0.0913568
Validation loss decreased (0.077385 --> 0.077341).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0670493
	speed: 0.0477s/iter; left time: 729.0949s
	iters: 200, epoch: 32 | loss: 0.0677307
	speed: 0.0256s/iter; left time: 388.2189s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.60s
Steps: 223 | Train Loss: 0.0668682 Vali Loss: 0.0777121 Test Loss: 0.0932346
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0641261
	speed: 0.0483s/iter; left time: 728.0766s
	iters: 200, epoch: 33 | loss: 0.0638911
	speed: 0.0220s/iter; left time: 328.5820s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0667531 Vali Loss: 0.0777565 Test Loss: 0.0936645
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0659660
	speed: 0.0457s/iter; left time: 678.0325s
	iters: 200, epoch: 34 | loss: 0.0686335
	speed: 0.0220s/iter; left time: 324.7573s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0667856 Vali Loss: 0.0776200 Test Loss: 0.0932053
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0687392
	speed: 0.0459s/iter; left time: 670.3550s
	iters: 200, epoch: 35 | loss: 0.0690497
	speed: 0.0220s/iter; left time: 319.8788s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0668176 Vali Loss: 0.0777510 Test Loss: 0.0938380
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0702824
	speed: 0.0457s/iter; left time: 658.4812s
	iters: 200, epoch: 36 | loss: 0.0692371
	speed: 0.0221s/iter; left time: 315.6635s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0667884 Vali Loss: 0.0778013 Test Loss: 0.0936883
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0638370
	speed: 0.0457s/iter; left time: 648.3586s
	iters: 200, epoch: 37 | loss: 0.0651658
	speed: 0.0219s/iter; left time: 308.6571s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0666432 Vali Loss: 0.0777940 Test Loss: 0.0937219
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0693552
	speed: 0.0474s/iter; left time: 660.8188s
	iters: 200, epoch: 38 | loss: 0.0670007
	speed: 0.0219s/iter; left time: 303.7690s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0666645 Vali Loss: 0.0774632 Test Loss: 0.0924549
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0688250
	speed: 0.0456s/iter; left time: 626.4022s
	iters: 200, epoch: 39 | loss: 0.0682196
	speed: 0.0220s/iter; left time: 299.6299s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0665509 Vali Loss: 0.0774738 Test Loss: 0.0926666
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0675138
	speed: 0.0462s/iter; left time: 624.3812s
	iters: 200, epoch: 40 | loss: 0.0659483
	speed: 0.0221s/iter; left time: 296.2513s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0666897 Vali Loss: 0.0774995 Test Loss: 0.0929280
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0673696
	speed: 0.0455s/iter; left time: 604.5884s
	iters: 200, epoch: 41 | loss: 0.0683117
	speed: 0.0305s/iter; left time: 402.0973s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.00s
Steps: 223 | Train Loss: 0.0665603 Vali Loss: 0.0776642 Test Loss: 0.0936454
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02533787675201893, rmse:0.15917876362800598, mae:0.0913567990064621, rse:0.6165143847465515
Intermediate time for FR and pred_len 168: 00h:13m:01.92s
Intermediate time for FR: 00h:59m:32.94s

=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2558293
	speed: 0.0583s/iter; left time: 1299.2008s
	iters: 200, epoch: 1 | loss: 0.2381266
	speed: 0.0264s/iter; left time: 586.7419s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.2640084 Vali Loss: 0.1828401 Test Loss: 0.1919930
Validation loss decreased (inf --> 0.182840).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1497207
	speed: 0.0447s/iter; left time: 986.0919s
	iters: 200, epoch: 2 | loss: 0.1136334
	speed: 0.0216s/iter; left time: 474.3113s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.1526043 Vali Loss: 0.0876826 Test Loss: 0.0897644
Validation loss decreased (0.182840 --> 0.087683).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0962923
	speed: 0.0474s/iter; left time: 1035.7281s
	iters: 200, epoch: 3 | loss: 0.0930147
	speed: 0.0216s/iter; left time: 470.0641s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0976564 Vali Loss: 0.0842901 Test Loss: 0.0870943
Validation loss decreased (0.087683 --> 0.084290).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0853350
	speed: 0.0476s/iter; left time: 1030.3244s
	iters: 200, epoch: 4 | loss: 0.0813772
	speed: 0.0225s/iter; left time: 483.8457s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0857653 Vali Loss: 0.0750860 Test Loss: 0.0777485
Validation loss decreased (0.084290 --> 0.075086).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0786085
	speed: 0.0448s/iter; left time: 959.5265s
	iters: 200, epoch: 5 | loss: 0.0775412
	speed: 0.0216s/iter; left time: 461.2126s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0788653 Vali Loss: 0.0711707 Test Loss: 0.0729953
Validation loss decreased (0.075086 --> 0.071171).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0713746
	speed: 0.0492s/iter; left time: 1042.8112s
	iters: 200, epoch: 6 | loss: 0.0699616
	speed: 0.0215s/iter; left time: 453.6381s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0746095 Vali Loss: 0.0693904 Test Loss: 0.0717842
Validation loss decreased (0.071171 --> 0.069390).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0726239
	speed: 0.0749s/iter; left time: 1569.8836s
	iters: 200, epoch: 7 | loss: 0.0711424
	speed: 0.1032s/iter; left time: 2152.2105s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:17.69s
Steps: 224 | Train Loss: 0.0717863 Vali Loss: 0.0668192 Test Loss: 0.0691673
Validation loss decreased (0.069390 --> 0.066819).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0696084
	speed: 0.0999s/iter; left time: 2071.2352s
	iters: 200, epoch: 8 | loss: 0.0691015
	speed: 0.0217s/iter; left time: 447.5808s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.66s
Steps: 224 | Train Loss: 0.0701057 Vali Loss: 0.0644864 Test Loss: 0.0668698
Validation loss decreased (0.066819 --> 0.064486).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0651193
	speed: 0.0519s/iter; left time: 1064.2497s
	iters: 200, epoch: 9 | loss: 0.0705513
	speed: 0.0217s/iter; left time: 442.3955s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0683687 Vali Loss: 0.0637326 Test Loss: 0.0665478
Validation loss decreased (0.064486 --> 0.063733).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0670562
	speed: 0.0469s/iter; left time: 950.4787s
	iters: 200, epoch: 10 | loss: 0.0664813
	speed: 0.0218s/iter; left time: 439.3051s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0674084 Vali Loss: 0.0631605 Test Loss: 0.0655152
Validation loss decreased (0.063733 --> 0.063161).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0687384
	speed: 0.0450s/iter; left time: 902.5071s
	iters: 200, epoch: 11 | loss: 0.0619850
	speed: 0.0220s/iter; left time: 438.4017s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0662015 Vali Loss: 0.0619426 Test Loss: 0.0644772
Validation loss decreased (0.063161 --> 0.061943).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0613197
	speed: 0.0454s/iter; left time: 900.5905s
	iters: 200, epoch: 12 | loss: 0.0663613
	speed: 0.0216s/iter; left time: 426.4314s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0653727 Vali Loss: 0.0619607 Test Loss: 0.0646265
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0630805
	speed: 0.0451s/iter; left time: 884.7179s
	iters: 200, epoch: 13 | loss: 0.0707275
	speed: 0.0219s/iter; left time: 427.7477s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0648825 Vali Loss: 0.0615020 Test Loss: 0.0639694
Validation loss decreased (0.061943 --> 0.061502).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0660773
	speed: 0.0456s/iter; left time: 884.3580s
	iters: 200, epoch: 14 | loss: 0.0623470
	speed: 0.0216s/iter; left time: 417.5535s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0644683 Vali Loss: 0.0627952 Test Loss: 0.0651951
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0642073
	speed: 0.0454s/iter; left time: 870.1513s
	iters: 200, epoch: 15 | loss: 0.0644118
	speed: 0.0216s/iter; left time: 412.6467s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0637678 Vali Loss: 0.0605992 Test Loss: 0.0628750
Validation loss decreased (0.061502 --> 0.060599).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0658147
	speed: 0.0444s/iter; left time: 841.8252s
	iters: 200, epoch: 16 | loss: 0.0652734
	speed: 0.0216s/iter; left time: 406.8243s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0638448 Vali Loss: 0.0616660 Test Loss: 0.0639011
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0695060
	speed: 0.0446s/iter; left time: 834.2657s
	iters: 200, epoch: 17 | loss: 0.0646186
	speed: 0.0215s/iter; left time: 400.5514s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0632143 Vali Loss: 0.0603413 Test Loss: 0.0625113
Validation loss decreased (0.060599 --> 0.060341).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0601193
	speed: 0.0467s/iter; left time: 864.0151s
	iters: 200, epoch: 18 | loss: 0.0671429
	speed: 0.0218s/iter; left time: 400.5457s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0628841 Vali Loss: 0.0598996 Test Loss: 0.0623332
Validation loss decreased (0.060341 --> 0.059900).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0620406
	speed: 0.0449s/iter; left time: 819.9029s
	iters: 200, epoch: 19 | loss: 0.0675364
	speed: 0.0248s/iter; left time: 449.9114s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.99s
Steps: 224 | Train Loss: 0.0626531 Vali Loss: 0.0598602 Test Loss: 0.0621414
Validation loss decreased (0.059900 --> 0.059860).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0607891
	speed: 0.0526s/iter; left time: 948.6349s
	iters: 200, epoch: 20 | loss: 0.0612117
	speed: 0.0214s/iter; left time: 383.4019s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0622245 Vali Loss: 0.0596845 Test Loss: 0.0620242
Validation loss decreased (0.059860 --> 0.059684).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0640365
	speed: 0.0480s/iter; left time: 855.6586s
	iters: 200, epoch: 21 | loss: 0.0632473
	speed: 0.0217s/iter; left time: 384.9036s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0627094 Vali Loss: 0.0600732 Test Loss: 0.0623788
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0593488
	speed: 0.0504s/iter; left time: 887.1069s
	iters: 200, epoch: 22 | loss: 0.0564405
	speed: 0.0215s/iter; left time: 375.6947s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0620199 Vali Loss: 0.0600471 Test Loss: 0.0623457
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0580876
	speed: 0.0435s/iter; left time: 756.3923s
	iters: 200, epoch: 23 | loss: 0.0581126
	speed: 0.0215s/iter; left time: 371.2407s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0619198 Vali Loss: 0.0602437 Test Loss: 0.0624897
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0652360
	speed: 0.0454s/iter; left time: 778.7168s
	iters: 200, epoch: 24 | loss: 0.0625962
	speed: 0.0241s/iter; left time: 411.5967s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.32s
Steps: 224 | Train Loss: 0.0616465 Vali Loss: 0.0594193 Test Loss: 0.0616776
Validation loss decreased (0.059684 --> 0.059419).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0594608
	speed: 0.0482s/iter; left time: 816.4209s
	iters: 200, epoch: 25 | loss: 0.0646038
	speed: 0.0217s/iter; left time: 365.8492s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0616589 Vali Loss: 0.0592671 Test Loss: 0.0615980
Validation loss decreased (0.059419 --> 0.059267).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0613646
	speed: 0.0443s/iter; left time: 740.5675s
	iters: 200, epoch: 26 | loss: 0.0630684
	speed: 0.0217s/iter; left time: 359.6711s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0613635 Vali Loss: 0.0597764 Test Loss: 0.0620253
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0641902
	speed: 0.0542s/iter; left time: 893.3979s
	iters: 200, epoch: 27 | loss: 0.0659257
	speed: 0.0216s/iter; left time: 353.0790s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0615855 Vali Loss: 0.0591585 Test Loss: 0.0613262
Validation loss decreased (0.059267 --> 0.059158).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0631174
	speed: 0.1749s/iter; left time: 2842.6888s
	iters: 200, epoch: 28 | loss: 0.0584812
	speed: 0.0218s/iter; left time: 352.5141s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.0613162 Vali Loss: 0.0591988 Test Loss: 0.0614812
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0645844
	speed: 0.0483s/iter; left time: 773.6088s
	iters: 200, epoch: 29 | loss: 0.0621652
	speed: 0.0215s/iter; left time: 342.1806s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0612787 Vali Loss: 0.0593957 Test Loss: 0.0615460
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0615049
	speed: 0.0478s/iter; left time: 755.9328s
	iters: 200, epoch: 30 | loss: 0.0633583
	speed: 0.0215s/iter; left time: 336.8815s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0613180 Vali Loss: 0.0593140 Test Loss: 0.0615583
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0589669
	speed: 0.0472s/iter; left time: 735.7737s
	iters: 200, epoch: 31 | loss: 0.0624070
	speed: 0.0220s/iter; left time: 340.1247s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0613025 Vali Loss: 0.0590342 Test Loss: 0.0612142
Validation loss decreased (0.059158 --> 0.059034).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0611178
	speed: 0.0456s/iter; left time: 700.0957s
	iters: 200, epoch: 32 | loss: 0.0641520
	speed: 0.0215s/iter; left time: 328.5579s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0610763 Vali Loss: 0.0592478 Test Loss: 0.0614585
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0603973
	speed: 0.0443s/iter; left time: 671.0215s
	iters: 200, epoch: 33 | loss: 0.0601934
	speed: 0.0216s/iter; left time: 324.0572s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0611806 Vali Loss: 0.0590856 Test Loss: 0.0612788
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0621883
	speed: 0.0441s/iter; left time: 657.9643s
	iters: 200, epoch: 34 | loss: 0.0625794
	speed: 0.0215s/iter; left time: 318.3824s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0609800 Vali Loss: 0.0593187 Test Loss: 0.0615730
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0602998
	speed: 0.0447s/iter; left time: 656.3144s
	iters: 200, epoch: 35 | loss: 0.0634709
	speed: 0.0216s/iter; left time: 314.8413s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0609945 Vali Loss: 0.0589900 Test Loss: 0.0612031
Validation loss decreased (0.059034 --> 0.058990).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0627337
	speed: 0.0451s/iter; left time: 651.5712s
	iters: 200, epoch: 36 | loss: 0.0612281
	speed: 0.0215s/iter; left time: 309.4335s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0608968 Vali Loss: 0.0590414 Test Loss: 0.0612786
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0608527
	speed: 0.0445s/iter; left time: 633.1113s
	iters: 200, epoch: 37 | loss: 0.0579833
	speed: 0.0219s/iter; left time: 309.3335s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0608606 Vali Loss: 0.0588656 Test Loss: 0.0610627
Validation loss decreased (0.058990 --> 0.058866).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0588295
	speed: 0.0444s/iter; left time: 621.4773s
	iters: 200, epoch: 38 | loss: 0.0619932
	speed: 0.0215s/iter; left time: 299.0288s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0608767 Vali Loss: 0.0589144 Test Loss: 0.0611289
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0576887
	speed: 0.0441s/iter; left time: 607.8903s
	iters: 200, epoch: 39 | loss: 0.0610248
	speed: 0.0215s/iter; left time: 294.7627s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0610182 Vali Loss: 0.0590282 Test Loss: 0.0611487
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0619670
	speed: 0.0445s/iter; left time: 603.0828s
	iters: 200, epoch: 40 | loss: 0.0582836
	speed: 0.0216s/iter; left time: 290.2578s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0606941 Vali Loss: 0.0588290 Test Loss: 0.0609829
Validation loss decreased (0.058866 --> 0.058829).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0628615
	speed: 0.0515s/iter; left time: 686.9675s
	iters: 200, epoch: 41 | loss: 0.0571420
	speed: 0.0215s/iter; left time: 284.9104s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.36s
Steps: 224 | Train Loss: 0.0608291 Vali Loss: 0.0590452 Test Loss: 0.0612850
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0577372
	speed: 0.0490s/iter; left time: 643.1951s
	iters: 200, epoch: 42 | loss: 0.0628383
	speed: 0.0215s/iter; left time: 279.4579s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0606938 Vali Loss: 0.0590544 Test Loss: 0.0612045
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0580428
	speed: 0.0635s/iter; left time: 818.6499s
	iters: 200, epoch: 43 | loss: 0.0571793
	speed: 0.0215s/iter; left time: 274.9646s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0606902 Vali Loss: 0.0589120 Test Loss: 0.0610991
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0621199
	speed: 0.0436s/iter; left time: 552.2760s
	iters: 200, epoch: 44 | loss: 0.0615903
	speed: 0.0232s/iter; left time: 291.9607s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0607055 Vali Loss: 0.0588038 Test Loss: 0.0609950
Validation loss decreased (0.058829 --> 0.058804).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0636745
	speed: 0.0466s/iter; left time: 579.5945s
	iters: 200, epoch: 45 | loss: 0.0622497
	speed: 0.0215s/iter; left time: 264.8532s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0606451 Vali Loss: 0.0588683 Test Loss: 0.0609783
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0567975
	speed: 0.0497s/iter; left time: 607.5732s
	iters: 200, epoch: 46 | loss: 0.0648473
	speed: 0.0216s/iter; left time: 261.5607s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0606911 Vali Loss: 0.0589043 Test Loss: 0.0609757
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0655731
	speed: 0.1096s/iter; left time: 1314.7853s
	iters: 200, epoch: 47 | loss: 0.0558283
	speed: 0.0217s/iter; left time: 258.5800s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:11.81s
Steps: 224 | Train Loss: 0.0607113 Vali Loss: 0.0588308 Test Loss: 0.0610066
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0652989
	speed: 0.0495s/iter; left time: 582.8027s
	iters: 200, epoch: 48 | loss: 0.0593095
	speed: 0.0216s/iter; left time: 252.0905s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0606000 Vali Loss: 0.0589230 Test Loss: 0.0610860
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0606117
	speed: 0.0479s/iter; left time: 553.7672s
	iters: 200, epoch: 49 | loss: 0.0589852
	speed: 0.0213s/iter; left time: 244.0783s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0607032 Vali Loss: 0.0588051 Test Loss: 0.0609059
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0605193
	speed: 0.0478s/iter; left time: 540.9777s
	iters: 200, epoch: 50 | loss: 0.0565179
	speed: 0.0215s/iter; left time: 241.2160s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0609300 Vali Loss: 0.0588004 Test Loss: 0.0609711
Validation loss decreased (0.058804 --> 0.058800).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0593550
	speed: 0.0441s/iter; left time: 489.9093s
	iters: 200, epoch: 51 | loss: 0.0570721
	speed: 0.0215s/iter; left time: 236.4667s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0608113 Vali Loss: 0.0588238 Test Loss: 0.0609802
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0575402
	speed: 0.0443s/iter; left time: 481.7458s
	iters: 200, epoch: 52 | loss: 0.0584760
	speed: 0.0215s/iter; left time: 232.2068s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0607779 Vali Loss: 0.0587641 Test Loss: 0.0609836
Validation loss decreased (0.058800 --> 0.058764).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0609918
	speed: 0.0448s/iter; left time: 476.8247s
	iters: 200, epoch: 53 | loss: 0.0590186
	speed: 0.0215s/iter; left time: 226.8618s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0606655 Vali Loss: 0.0588417 Test Loss: 0.0610079
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0603701
	speed: 0.0450s/iter; left time: 469.8175s
	iters: 200, epoch: 54 | loss: 0.0658668
	speed: 0.0215s/iter; left time: 222.2880s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0606217 Vali Loss: 0.0588372 Test Loss: 0.0610132
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0622406
	speed: 0.0444s/iter; left time: 452.9827s
	iters: 200, epoch: 55 | loss: 0.0641512
	speed: 0.0215s/iter; left time: 217.2053s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0605781 Vali Loss: 0.0589146 Test Loss: 0.0610025
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0589377
	speed: 0.0442s/iter; left time: 440.9107s
	iters: 200, epoch: 56 | loss: 0.0632462
	speed: 0.0215s/iter; left time: 212.0508s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0606404 Vali Loss: 0.0587906 Test Loss: 0.0609302
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0613924
	speed: 0.0440s/iter; left time: 429.3505s
	iters: 200, epoch: 57 | loss: 0.0598141
	speed: 0.0219s/iter; left time: 211.2200s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0606566 Vali Loss: 0.0587561 Test Loss: 0.0609242
Validation loss decreased (0.058764 --> 0.058756).  Saving model ...
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0594092
	speed: 0.0442s/iter; left time: 421.4016s
	iters: 200, epoch: 58 | loss: 0.0611908
	speed: 0.0215s/iter; left time: 202.5056s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0605986 Vali Loss: 0.0588975 Test Loss: 0.0610290
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0619921
	speed: 0.0520s/iter; left time: 483.6931s
	iters: 200, epoch: 59 | loss: 0.0594159
	speed: 0.0216s/iter; left time: 198.7216s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0606584 Vali Loss: 0.0587411 Test Loss: 0.0609293
Validation loss decreased (0.058756 --> 0.058741).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0633881
	speed: 0.0515s/iter; left time: 468.2995s
	iters: 200, epoch: 60 | loss: 0.0643513
	speed: 0.0220s/iter; left time: 197.3073s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0605124 Vali Loss: 0.0586002 Test Loss: 0.0609298
Validation loss decreased (0.058741 --> 0.058600).  Saving model ...
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0633091
	speed: 0.0527s/iter; left time: 467.2106s
	iters: 200, epoch: 61 | loss: 0.0596545
	speed: 0.0214s/iter; left time: 187.8100s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0605479 Vali Loss: 0.0586904 Test Loss: 0.0609052
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0652157
	speed: 0.0435s/iter; left time: 375.5910s
	iters: 200, epoch: 62 | loss: 0.0628511
	speed: 0.0223s/iter; left time: 190.3472s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0606392 Vali Loss: 0.0587038 Test Loss: 0.0609069
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0592410
	speed: 0.0440s/iter; left time: 369.8502s
	iters: 200, epoch: 63 | loss: 0.0602573
	speed: 0.0214s/iter; left time: 177.8203s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0607000 Vali Loss: 0.0588222 Test Loss: 0.0609671
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0606475
	speed: 0.0429s/iter; left time: 351.0335s
	iters: 200, epoch: 64 | loss: 0.0611899
	speed: 0.0217s/iter; left time: 175.1838s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0605292 Vali Loss: 0.0587750 Test Loss: 0.0609327
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0613783
	speed: 0.0433s/iter; left time: 345.1782s
	iters: 200, epoch: 65 | loss: 0.0627323
	speed: 0.0218s/iter; left time: 171.5438s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0606951 Vali Loss: 0.0587247 Test Loss: 0.0609034
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0610044
	speed: 0.0439s/iter; left time: 339.7599s
	iters: 200, epoch: 66 | loss: 0.0592297
	speed: 0.0214s/iter; left time: 163.8589s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0606284 Vali Loss: 0.0588143 Test Loss: 0.0609449
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0617437
	speed: 0.0431s/iter; left time: 323.8011s
	iters: 200, epoch: 67 | loss: 0.0565457
	speed: 0.0216s/iter; left time: 159.9450s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0605625 Vali Loss: 0.0589558 Test Loss: 0.0610351
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0595081
	speed: 0.0434s/iter; left time: 316.7853s
	iters: 200, epoch: 68 | loss: 0.0592488
	speed: 0.0215s/iter; left time: 154.3736s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0605613 Vali Loss: 0.0587373 Test Loss: 0.0609406
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0647204
	speed: 0.0438s/iter; left time: 309.8727s
	iters: 200, epoch: 69 | loss: 0.0647961
	speed: 0.0215s/iter; left time: 149.8897s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0606047 Vali Loss: 0.0588343 Test Loss: 0.0609680
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0613908
	speed: 0.0442s/iter; left time: 302.3849s
	iters: 200, epoch: 70 | loss: 0.0563481
	speed: 0.0213s/iter; left time: 143.7615s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0605339 Vali Loss: 0.0588707 Test Loss: 0.0610547
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010719235055148602, rmse:0.10353373736143112, mae:0.06092977151274681, rse:0.39120301604270935
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2611395
	speed: 0.0237s/iter; left time: 528.0851s
	iters: 200, epoch: 1 | loss: 0.2397694
	speed: 0.0218s/iter; left time: 484.0669s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.2637589 Vali Loss: 0.1774064 Test Loss: 0.1851594
Validation loss decreased (inf --> 0.177406).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1366976
	speed: 0.0436s/iter; left time: 962.1698s
	iters: 200, epoch: 2 | loss: 0.1116794
	speed: 0.0217s/iter; left time: 476.9023s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.1488811 Vali Loss: 0.0879994 Test Loss: 0.0902984
Validation loss decreased (0.177406 --> 0.087999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0924387
	speed: 0.0435s/iter; left time: 949.9540s
	iters: 200, epoch: 3 | loss: 0.0903097
	speed: 0.0215s/iter; left time: 467.4351s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0963001 Vali Loss: 0.0786247 Test Loss: 0.0805651
Validation loss decreased (0.087999 --> 0.078625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0848974
	speed: 0.0442s/iter; left time: 955.6952s
	iters: 200, epoch: 4 | loss: 0.0828546
	speed: 0.0219s/iter; left time: 470.5902s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0845441 Vali Loss: 0.0745141 Test Loss: 0.0760568
Validation loss decreased (0.078625 --> 0.074514).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0806029
	speed: 0.0433s/iter; left time: 927.3836s
	iters: 200, epoch: 5 | loss: 0.0757570
	speed: 0.0218s/iter; left time: 463.8280s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0773773 Vali Loss: 0.0706822 Test Loss: 0.0728539
Validation loss decreased (0.074514 --> 0.070682).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0805508
	speed: 0.0438s/iter; left time: 926.9516s
	iters: 200, epoch: 6 | loss: 0.0753293
	speed: 0.0217s/iter; left time: 457.4310s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0731062 Vali Loss: 0.0679298 Test Loss: 0.0692633
Validation loss decreased (0.070682 --> 0.067930).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0717874
	speed: 0.0442s/iter; left time: 926.4026s
	iters: 200, epoch: 7 | loss: 0.0707016
	speed: 0.0214s/iter; left time: 446.8923s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0707317 Vali Loss: 0.0653223 Test Loss: 0.0674034
Validation loss decreased (0.067930 --> 0.065322).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0637238
	speed: 0.0440s/iter; left time: 911.3586s
	iters: 200, epoch: 8 | loss: 0.0697301
	speed: 0.0214s/iter; left time: 441.8654s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0697945 Vali Loss: 0.0659213 Test Loss: 0.0686247
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0715923
	speed: 0.0431s/iter; left time: 883.5511s
	iters: 200, epoch: 9 | loss: 0.0697949
	speed: 0.0217s/iter; left time: 442.0936s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0680556 Vali Loss: 0.0638103 Test Loss: 0.0660263
Validation loss decreased (0.065322 --> 0.063810).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0655236
	speed: 0.0442s/iter; left time: 897.2221s
	iters: 200, epoch: 10 | loss: 0.0690507
	speed: 0.0215s/iter; left time: 433.6646s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0668337 Vali Loss: 0.0628378 Test Loss: 0.0648429
Validation loss decreased (0.063810 --> 0.062838).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0657988
	speed: 0.0444s/iter; left time: 889.7120s
	iters: 200, epoch: 11 | loss: 0.0652519
	speed: 0.0215s/iter; left time: 429.5429s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0661722 Vali Loss: 0.0625293 Test Loss: 0.0645589
Validation loss decreased (0.062838 --> 0.062529).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0695261
	speed: 0.0428s/iter; left time: 849.0907s
	iters: 200, epoch: 12 | loss: 0.0621382
	speed: 0.0214s/iter; left time: 422.8587s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0655198 Vali Loss: 0.0620551 Test Loss: 0.0644802
Validation loss decreased (0.062529 --> 0.062055).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0651229
	speed: 0.0445s/iter; left time: 872.7562s
	iters: 200, epoch: 13 | loss: 0.0625030
	speed: 0.0215s/iter; left time: 418.9833s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0648721 Vali Loss: 0.0613815 Test Loss: 0.0635882
Validation loss decreased (0.062055 --> 0.061382).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0631140
	speed: 0.0430s/iter; left time: 833.2698s
	iters: 200, epoch: 14 | loss: 0.0600395
	speed: 0.0214s/iter; left time: 413.1089s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0642741 Vali Loss: 0.0616729 Test Loss: 0.0638172
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0626626
	speed: 0.0431s/iter; left time: 826.7124s
	iters: 200, epoch: 15 | loss: 0.0700633
	speed: 0.0220s/iter; left time: 419.0628s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0639949 Vali Loss: 0.0611219 Test Loss: 0.0631736
Validation loss decreased (0.061382 --> 0.061122).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0637753
	speed: 0.0454s/iter; left time: 860.3893s
	iters: 200, epoch: 16 | loss: 0.0626370
	speed: 0.0216s/iter; left time: 406.7126s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0636109 Vali Loss: 0.0605476 Test Loss: 0.0626584
Validation loss decreased (0.061122 --> 0.060548).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0671551
	speed: 0.0437s/iter; left time: 817.1891s
	iters: 200, epoch: 17 | loss: 0.0654119
	speed: 0.0215s/iter; left time: 400.5399s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0631128 Vali Loss: 0.0606507 Test Loss: 0.0629274
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0674544
	speed: 0.0435s/iter; left time: 803.8418s
	iters: 200, epoch: 18 | loss: 0.0648333
	speed: 0.0216s/iter; left time: 396.6396s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0628133 Vali Loss: 0.0607794 Test Loss: 0.0631163
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0631847
	speed: 0.0428s/iter; left time: 781.1902s
	iters: 200, epoch: 19 | loss: 0.0636560
	speed: 0.0215s/iter; left time: 391.1281s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0627711 Vali Loss: 0.0604789 Test Loss: 0.0626157
Validation loss decreased (0.060548 --> 0.060479).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0638389
	speed: 0.0433s/iter; left time: 780.7489s
	iters: 200, epoch: 20 | loss: 0.0623267
	speed: 0.0217s/iter; left time: 389.6559s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0622514 Vali Loss: 0.0599138 Test Loss: 0.0621311
Validation loss decreased (0.060479 --> 0.059914).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0639950
	speed: 0.0440s/iter; left time: 783.9777s
	iters: 200, epoch: 21 | loss: 0.0571222
	speed: 0.0216s/iter; left time: 382.0280s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0626983 Vali Loss: 0.0600219 Test Loss: 0.0622247
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0640250
	speed: 0.0433s/iter; left time: 761.1040s
	iters: 200, epoch: 22 | loss: 0.0594751
	speed: 0.0215s/iter; left time: 375.8157s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0619488 Vali Loss: 0.0598412 Test Loss: 0.0619801
Validation loss decreased (0.059914 --> 0.059841).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0618583
	speed: 0.0434s/iter; left time: 753.3231s
	iters: 200, epoch: 23 | loss: 0.0659301
	speed: 0.0214s/iter; left time: 370.4551s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0617583 Vali Loss: 0.0594401 Test Loss: 0.0617894
Validation loss decreased (0.059841 --> 0.059440).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0604866
	speed: 0.0433s/iter; left time: 742.7957s
	iters: 200, epoch: 24 | loss: 0.0597413
	speed: 0.0216s/iter; left time: 368.0477s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0618813 Vali Loss: 0.0599114 Test Loss: 0.0621233
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0579213
	speed: 0.0431s/iter; left time: 729.3066s
	iters: 200, epoch: 25 | loss: 0.0592436
	speed: 0.0214s/iter; left time: 360.5430s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0616787 Vali Loss: 0.0593819 Test Loss: 0.0618338
Validation loss decreased (0.059440 --> 0.059382).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0559742
	speed: 0.0434s/iter; left time: 725.1603s
	iters: 200, epoch: 26 | loss: 0.0588969
	speed: 0.0212s/iter; left time: 352.6334s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0613727 Vali Loss: 0.0593460 Test Loss: 0.0617737
Validation loss decreased (0.059382 --> 0.059346).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0569330
	speed: 0.0429s/iter; left time: 707.6190s
	iters: 200, epoch: 27 | loss: 0.0633800
	speed: 0.0215s/iter; left time: 351.3553s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0613782 Vali Loss: 0.0592712 Test Loss: 0.0615616
Validation loss decreased (0.059346 --> 0.059271).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0588916
	speed: 0.0439s/iter; left time: 713.3463s
	iters: 200, epoch: 28 | loss: 0.0644964
	speed: 0.0214s/iter; left time: 346.0272s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0612562 Vali Loss: 0.0590498 Test Loss: 0.0614208
Validation loss decreased (0.059271 --> 0.059050).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0596688
	speed: 0.0431s/iter; left time: 690.4052s
	iters: 200, epoch: 29 | loss: 0.0607262
	speed: 0.0214s/iter; left time: 340.7331s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0612384 Vali Loss: 0.0590770 Test Loss: 0.0615377
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0605518
	speed: 0.0433s/iter; left time: 684.7770s
	iters: 200, epoch: 30 | loss: 0.0619422
	speed: 0.0214s/iter; left time: 335.9309s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0611506 Vali Loss: 0.0591377 Test Loss: 0.0616194
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0623615
	speed: 0.0424s/iter; left time: 660.2194s
	iters: 200, epoch: 31 | loss: 0.0581465
	speed: 0.0217s/iter; left time: 335.8636s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0610847 Vali Loss: 0.0591891 Test Loss: 0.0616577
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0555499
	speed: 0.0424s/iter; left time: 650.7237s
	iters: 200, epoch: 32 | loss: 0.0639617
	speed: 0.0214s/iter; left time: 326.1958s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0610630 Vali Loss: 0.0592702 Test Loss: 0.0615814
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0619429
	speed: 0.0424s/iter; left time: 641.7239s
	iters: 200, epoch: 33 | loss: 0.0569813
	speed: 0.0214s/iter; left time: 322.0292s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0616960 Vali Loss: 0.0591274 Test Loss: 0.0614636
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0605883
	speed: 0.0433s/iter; left time: 645.1875s
	iters: 200, epoch: 34 | loss: 0.0625567
	speed: 0.0215s/iter; left time: 318.5614s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0609926 Vali Loss: 0.0590364 Test Loss: 0.0613999
Validation loss decreased (0.059050 --> 0.059036).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0572220
	speed: 0.0441s/iter; left time: 647.5548s
	iters: 200, epoch: 35 | loss: 0.0583723
	speed: 0.0215s/iter; left time: 313.6386s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0611139 Vali Loss: 0.0591306 Test Loss: 0.0615006
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0609590
	speed: 0.0437s/iter; left time: 631.2467s
	iters: 200, epoch: 36 | loss: 0.0572566
	speed: 0.0215s/iter; left time: 308.7305s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0610636 Vali Loss: 0.0588201 Test Loss: 0.0612896
Validation loss decreased (0.059036 --> 0.058820).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0612978
	speed: 0.0436s/iter; left time: 620.1305s
	iters: 200, epoch: 37 | loss: 0.0619081
	speed: 0.0215s/iter; left time: 303.4389s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0609768 Vali Loss: 0.0590234 Test Loss: 0.0613470
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0651834
	speed: 0.0427s/iter; left time: 598.6613s
	iters: 200, epoch: 38 | loss: 0.0617437
	speed: 0.0215s/iter; left time: 298.6442s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0607935 Vali Loss: 0.0588588 Test Loss: 0.0612302
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0585084
	speed: 0.0431s/iter; left time: 593.7338s
	iters: 200, epoch: 39 | loss: 0.0598131
	speed: 0.0214s/iter; left time: 293.2318s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0608596 Vali Loss: 0.0588001 Test Loss: 0.0612345
Validation loss decreased (0.058820 --> 0.058800).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0617629
	speed: 0.0447s/iter; left time: 606.9361s
	iters: 200, epoch: 40 | loss: 0.0632681
	speed: 0.0215s/iter; left time: 289.9212s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0609067 Vali Loss: 0.0589070 Test Loss: 0.0612779
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0596814
	speed: 0.0456s/iter; left time: 608.4195s
	iters: 200, epoch: 41 | loss: 0.0628248
	speed: 0.0220s/iter; left time: 291.0547s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0607505 Vali Loss: 0.0588210 Test Loss: 0.0612365
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0605137
	speed: 0.0428s/iter; left time: 560.9766s
	iters: 200, epoch: 42 | loss: 0.0597760
	speed: 0.0217s/iter; left time: 282.5189s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0607240 Vali Loss: 0.0589597 Test Loss: 0.0612811
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0635111
	speed: 0.0427s/iter; left time: 550.7720s
	iters: 200, epoch: 43 | loss: 0.0608119
	speed: 0.0215s/iter; left time: 274.9047s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0607631 Vali Loss: 0.0588552 Test Loss: 0.0612449
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0571789
	speed: 0.0437s/iter; left time: 554.0629s
	iters: 200, epoch: 44 | loss: 0.0547266
	speed: 0.0217s/iter; left time: 272.2702s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0613731 Vali Loss: 0.0588353 Test Loss: 0.0611756
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0639703
	speed: 0.0433s/iter; left time: 539.1153s
	iters: 200, epoch: 45 | loss: 0.0586866
	speed: 0.0216s/iter; left time: 266.4211s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0606743 Vali Loss: 0.0588826 Test Loss: 0.0612087
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0609062
	speed: 0.0429s/iter; left time: 524.3040s
	iters: 200, epoch: 46 | loss: 0.0616319
	speed: 0.0215s/iter; left time: 260.7066s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0606604 Vali Loss: 0.0588534 Test Loss: 0.0612595
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0569909
	speed: 0.0431s/iter; left time: 517.4061s
	iters: 200, epoch: 47 | loss: 0.0555084
	speed: 0.0216s/iter; left time: 256.8091s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0606640 Vali Loss: 0.0591372 Test Loss: 0.0613547
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0585967
	speed: 0.0438s/iter; left time: 516.2413s
	iters: 200, epoch: 48 | loss: 0.0645832
	speed: 0.0218s/iter; left time: 253.8881s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0606513 Vali Loss: 0.0587878 Test Loss: 0.0612191
Validation loss decreased (0.058800 --> 0.058788).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0667182
	speed: 0.0434s/iter; left time: 500.8918s
	iters: 200, epoch: 49 | loss: 0.0592124
	speed: 0.0216s/iter; left time: 247.8337s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0606127 Vali Loss: 0.0587384 Test Loss: 0.0611886
Validation loss decreased (0.058788 --> 0.058738).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0632392
	speed: 0.0437s/iter; left time: 495.2634s
	iters: 200, epoch: 50 | loss: 0.0596401
	speed: 0.0217s/iter; left time: 244.0535s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0606635 Vali Loss: 0.0589608 Test Loss: 0.0612556
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0614918
	speed: 0.0438s/iter; left time: 486.2412s
	iters: 200, epoch: 51 | loss: 0.0594857
	speed: 0.0216s/iter; left time: 237.9500s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0607044 Vali Loss: 0.0588970 Test Loss: 0.0612139
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0564673
	speed: 0.0434s/iter; left time: 472.5366s
	iters: 200, epoch: 52 | loss: 0.0573945
	speed: 0.0220s/iter; left time: 237.0827s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0608079 Vali Loss: 0.0589489 Test Loss: 0.0612592
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0597307
	speed: 0.0466s/iter; left time: 496.2018s
	iters: 200, epoch: 53 | loss: 0.0582788
	speed: 0.0227s/iter; left time: 239.3578s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0610792 Vali Loss: 0.0589152 Test Loss: 0.0612244
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0642910
	speed: 0.0433s/iter; left time: 451.5143s
	iters: 200, epoch: 54 | loss: 0.0603616
	speed: 0.0217s/iter; left time: 224.3910s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0607728 Vali Loss: 0.0587729 Test Loss: 0.0611971
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0600908
	speed: 0.0447s/iter; left time: 456.5265s
	iters: 200, epoch: 55 | loss: 0.0599116
	speed: 0.0218s/iter; left time: 219.8787s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0607213 Vali Loss: 0.0587583 Test Loss: 0.0611284
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0666340
	speed: 0.0437s/iter; left time: 435.7018s
	iters: 200, epoch: 56 | loss: 0.0604761
	speed: 0.0215s/iter; left time: 212.9035s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0607667 Vali Loss: 0.0587489 Test Loss: 0.0611228
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0571321
	speed: 0.0443s/iter; left time: 431.8755s
	iters: 200, epoch: 57 | loss: 0.0605484
	speed: 0.0215s/iter; left time: 207.3995s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0606934 Vali Loss: 0.0588651 Test Loss: 0.0611912
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0598596
	speed: 0.0428s/iter; left time: 408.0776s
	iters: 200, epoch: 58 | loss: 0.0604378
	speed: 0.0216s/iter; left time: 203.4032s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0606548 Vali Loss: 0.0588585 Test Loss: 0.0611659
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0597903
	speed: 0.0438s/iter; left time: 407.7661s
	iters: 200, epoch: 59 | loss: 0.0586092
	speed: 0.0226s/iter; left time: 207.6816s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0606029 Vali Loss: 0.0587847 Test Loss: 0.0611310
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010685726068913937, rmse:0.10337178409099579, mae:0.061188578605651855, rse:0.3905910551548004
Intermediate time for IT and pred_len 24: 00h:15m:09.41s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2580695
	speed: 0.0413s/iter; left time: 921.6375s
	iters: 200, epoch: 1 | loss: 0.2417672
	speed: 0.0219s/iter; left time: 485.4284s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.48s
Steps: 224 | Train Loss: 0.2647959 Vali Loss: 0.1834477 Test Loss: 0.1930840
Validation loss decreased (inf --> 0.183448).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1441503
	speed: 0.0468s/iter; left time: 1033.3766s
	iters: 200, epoch: 2 | loss: 0.1145335
	speed: 0.0219s/iter; left time: 480.9851s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.1525592 Vali Loss: 0.1030724 Test Loss: 0.1084467
Validation loss decreased (0.183448 --> 0.103072).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1089932
	speed: 0.0466s/iter; left time: 1018.2314s
	iters: 200, epoch: 3 | loss: 0.1033112
	speed: 0.0219s/iter; left time: 476.3226s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.1080724 Vali Loss: 0.0955559 Test Loss: 0.1006803
Validation loss decreased (0.103072 --> 0.095556).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0963017
	speed: 0.0476s/iter; left time: 1030.5557s
	iters: 200, epoch: 4 | loss: 0.0922064
	speed: 0.0219s/iter; left time: 472.0341s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0972062 Vali Loss: 0.0889518 Test Loss: 0.0936109
Validation loss decreased (0.095556 --> 0.088952).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0930544
	speed: 0.0467s/iter; left time: 998.6341s
	iters: 200, epoch: 5 | loss: 0.0900929
	speed: 0.0218s/iter; left time: 465.0539s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0917243 Vali Loss: 0.0863351 Test Loss: 0.0895492
Validation loss decreased (0.088952 --> 0.086335).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0915110
	speed: 0.0475s/iter; left time: 1005.8222s
	iters: 200, epoch: 6 | loss: 0.0871837
	speed: 0.0219s/iter; left time: 462.1631s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0882057 Vali Loss: 0.0828482 Test Loss: 0.0871179
Validation loss decreased (0.086335 --> 0.082848).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0877318
	speed: 0.0466s/iter; left time: 977.5162s
	iters: 200, epoch: 7 | loss: 0.0843585
	speed: 0.0218s/iter; left time: 454.3700s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0864494 Vali Loss: 0.0828761 Test Loss: 0.0860294
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0831594
	speed: 0.0463s/iter; left time: 960.9155s
	iters: 200, epoch: 8 | loss: 0.0790139
	speed: 0.0218s/iter; left time: 449.8154s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0849781 Vali Loss: 0.0813643 Test Loss: 0.0859066
Validation loss decreased (0.082848 --> 0.081364).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0836578
	speed: 0.0471s/iter; left time: 965.8222s
	iters: 200, epoch: 9 | loss: 0.0809430
	speed: 0.0218s/iter; left time: 444.6781s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0846447 Vali Loss: 0.0812173 Test Loss: 0.0855144
Validation loss decreased (0.081364 --> 0.081217).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0812332
	speed: 0.0467s/iter; left time: 946.9200s
	iters: 200, epoch: 10 | loss: 0.0877896
	speed: 0.0220s/iter; left time: 443.3351s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0835148 Vali Loss: 0.0807275 Test Loss: 0.0849319
Validation loss decreased (0.081217 --> 0.080727).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0848695
	speed: 0.0464s/iter; left time: 930.5152s
	iters: 200, epoch: 11 | loss: 0.0809705
	speed: 0.0218s/iter; left time: 435.7380s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0830249 Vali Loss: 0.0807374 Test Loss: 0.0851396
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0819496
	speed: 0.0464s/iter; left time: 921.0816s
	iters: 200, epoch: 12 | loss: 0.0838790
	speed: 0.0217s/iter; left time: 429.1794s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0822118 Vali Loss: 0.0811784 Test Loss: 0.0850530
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0817864
	speed: 0.0456s/iter; left time: 894.3661s
	iters: 200, epoch: 13 | loss: 0.0844896
	speed: 0.0218s/iter; left time: 424.4086s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0819507 Vali Loss: 0.0804386 Test Loss: 0.0841491
Validation loss decreased (0.080727 --> 0.080439).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0807772
	speed: 0.0481s/iter; left time: 933.5466s
	iters: 200, epoch: 14 | loss: 0.0788974
	speed: 0.0218s/iter; left time: 421.1842s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0816481 Vali Loss: 0.0800457 Test Loss: 0.0841762
Validation loss decreased (0.080439 --> 0.080046).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0797461
	speed: 0.0469s/iter; left time: 899.4349s
	iters: 200, epoch: 15 | loss: 0.0825874
	speed: 0.0218s/iter; left time: 414.7828s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0812736 Vali Loss: 0.0792437 Test Loss: 0.0835542
Validation loss decreased (0.080046 --> 0.079244).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0848858
	speed: 0.0466s/iter; left time: 882.6790s
	iters: 200, epoch: 16 | loss: 0.0824197
	speed: 0.0218s/iter; left time: 410.6950s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0811235 Vali Loss: 0.0790755 Test Loss: 0.0840130
Validation loss decreased (0.079244 --> 0.079075).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0821639
	speed: 0.0465s/iter; left time: 869.6015s
	iters: 200, epoch: 17 | loss: 0.0795800
	speed: 0.0217s/iter; left time: 404.8056s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0807425 Vali Loss: 0.0796269 Test Loss: 0.0842229
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0787953
	speed: 0.0464s/iter; left time: 857.6693s
	iters: 200, epoch: 18 | loss: 0.0841330
	speed: 0.0219s/iter; left time: 403.6399s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0804603 Vali Loss: 0.0793510 Test Loss: 0.0838747
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0777121
	speed: 0.0461s/iter; left time: 841.5085s
	iters: 200, epoch: 19 | loss: 0.0797780
	speed: 0.0218s/iter; left time: 395.5120s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0804237 Vali Loss: 0.0798827 Test Loss: 0.0843925
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0815642
	speed: 0.0464s/iter; left time: 836.6083s
	iters: 200, epoch: 20 | loss: 0.0798553
	speed: 0.0217s/iter; left time: 389.8875s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0801151 Vali Loss: 0.0794501 Test Loss: 0.0842532
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0831490
	speed: 0.0474s/iter; left time: 844.9527s
	iters: 200, epoch: 21 | loss: 0.0741697
	speed: 0.0218s/iter; left time: 386.8595s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0804597 Vali Loss: 0.0792035 Test Loss: 0.0839015
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0778923
	speed: 0.0465s/iter; left time: 818.9803s
	iters: 200, epoch: 22 | loss: 0.0797235
	speed: 0.0220s/iter; left time: 384.4465s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0798792 Vali Loss: 0.0791037 Test Loss: 0.0839395
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0785171
	speed: 0.0455s/iter; left time: 790.0579s
	iters: 200, epoch: 23 | loss: 0.0789667
	speed: 0.0217s/iter; left time: 374.9642s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0797583 Vali Loss: 0.0790717 Test Loss: 0.0836279
Validation loss decreased (0.079075 --> 0.079072).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0815551
	speed: 0.0464s/iter; left time: 795.8383s
	iters: 200, epoch: 24 | loss: 0.0766816
	speed: 0.0219s/iter; left time: 373.0618s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0796146 Vali Loss: 0.0798074 Test Loss: 0.0846000
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0778478
	speed: 0.0461s/iter; left time: 780.5910s
	iters: 200, epoch: 25 | loss: 0.0778329
	speed: 0.0224s/iter; left time: 376.9188s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0795955 Vali Loss: 0.0793961 Test Loss: 0.0840647
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0786318
	speed: 0.0460s/iter; left time: 768.9386s
	iters: 200, epoch: 26 | loss: 0.0818022
	speed: 0.0218s/iter; left time: 362.0867s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0797851 Vali Loss: 0.0793151 Test Loss: 0.0839431
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0803426
	speed: 0.0464s/iter; left time: 765.1645s
	iters: 200, epoch: 27 | loss: 0.0752964
	speed: 0.0218s/iter; left time: 356.4932s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0793590 Vali Loss: 0.0788792 Test Loss: 0.0837742
Validation loss decreased (0.079072 --> 0.078879).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0803743
	speed: 0.0464s/iter; left time: 754.1558s
	iters: 200, epoch: 28 | loss: 0.0777649
	speed: 0.0218s/iter; left time: 352.8462s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0792849 Vali Loss: 0.0786742 Test Loss: 0.0838089
Validation loss decreased (0.078879 --> 0.078674).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0825134
	speed: 0.0454s/iter; left time: 727.2797s
	iters: 200, epoch: 29 | loss: 0.0788454
	speed: 0.0215s/iter; left time: 342.8901s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0792496 Vali Loss: 0.0790493 Test Loss: 0.0838136
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0794239
	speed: 0.0454s/iter; left time: 718.0415s
	iters: 200, epoch: 30 | loss: 0.0799008
	speed: 0.0217s/iter; left time: 340.7091s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0795035 Vali Loss: 0.0788530 Test Loss: 0.0838181
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0800056
	speed: 0.0457s/iter; left time: 712.6387s
	iters: 200, epoch: 31 | loss: 0.0757689
	speed: 0.0217s/iter; left time: 336.2269s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0791669 Vali Loss: 0.0787831 Test Loss: 0.0837968
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0809065
	speed: 0.0455s/iter; left time: 698.6614s
	iters: 200, epoch: 32 | loss: 0.0841759
	speed: 0.0217s/iter; left time: 330.8645s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0791132 Vali Loss: 0.0790590 Test Loss: 0.0839365
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0780007
	speed: 0.0459s/iter; left time: 693.8501s
	iters: 200, epoch: 33 | loss: 0.0838579
	speed: 0.0218s/iter; left time: 327.1926s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0790995 Vali Loss: 0.0786118 Test Loss: 0.0835228
Validation loss decreased (0.078674 --> 0.078612).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0775447
	speed: 0.0463s/iter; left time: 691.0096s
	iters: 200, epoch: 34 | loss: 0.0795887
	speed: 0.0217s/iter; left time: 321.4039s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0790968 Vali Loss: 0.0785501 Test Loss: 0.0836284
Validation loss decreased (0.078612 --> 0.078550).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0764855
	speed: 0.0462s/iter; left time: 678.5346s
	iters: 200, epoch: 35 | loss: 0.0821868
	speed: 0.0217s/iter; left time: 316.7910s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0790602 Vali Loss: 0.0784518 Test Loss: 0.0834040
Validation loss decreased (0.078550 --> 0.078452).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0769309
	speed: 0.0470s/iter; left time: 679.8876s
	iters: 200, epoch: 36 | loss: 0.0770906
	speed: 0.0218s/iter; left time: 313.7128s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0797029 Vali Loss: 0.0786868 Test Loss: 0.0836559
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0815985
	speed: 0.0453s/iter; left time: 644.3152s
	iters: 200, epoch: 37 | loss: 0.0793569
	speed: 0.0217s/iter; left time: 306.3337s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0790845 Vali Loss: 0.0785647 Test Loss: 0.0834830
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0751892
	speed: 0.0444s/iter; left time: 622.0103s
	iters: 200, epoch: 38 | loss: 0.0813473
	speed: 0.0216s/iter; left time: 300.7106s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0790720 Vali Loss: 0.0786881 Test Loss: 0.0836144
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0812576
	speed: 0.0463s/iter; left time: 637.8750s
	iters: 200, epoch: 39 | loss: 0.0778940
	speed: 0.0217s/iter; left time: 297.0167s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0790250 Vali Loss: 0.0786932 Test Loss: 0.0839777
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0793259
	speed: 0.0462s/iter; left time: 626.1600s
	iters: 200, epoch: 40 | loss: 0.0792196
	speed: 0.0217s/iter; left time: 291.9825s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0788296 Vali Loss: 0.0786599 Test Loss: 0.0837624
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0775406
	speed: 0.0463s/iter; left time: 617.8394s
	iters: 200, epoch: 41 | loss: 0.0767219
	speed: 0.0217s/iter; left time: 287.5939s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0789886 Vali Loss: 0.0783118 Test Loss: 0.0836967
Validation loss decreased (0.078452 --> 0.078312).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0819803
	speed: 0.0462s/iter; left time: 605.8045s
	iters: 200, epoch: 42 | loss: 0.0767679
	speed: 0.0218s/iter; left time: 283.2626s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0788847 Vali Loss: 0.0788048 Test Loss: 0.0839608
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0824770
	speed: 0.0449s/iter; left time: 579.2412s
	iters: 200, epoch: 43 | loss: 0.0828410
	speed: 0.0216s/iter; left time: 276.4531s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0788485 Vali Loss: 0.0787041 Test Loss: 0.0836403
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0814335
	speed: 0.0449s/iter; left time: 568.3762s
	iters: 200, epoch: 44 | loss: 0.0798881
	speed: 0.0217s/iter; left time: 272.3031s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0789872 Vali Loss: 0.0787718 Test Loss: 0.0836522
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0803211
	speed: 0.0459s/iter; left time: 571.4261s
	iters: 200, epoch: 45 | loss: 0.0766883
	speed: 0.0219s/iter; left time: 269.9088s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0791085 Vali Loss: 0.0788773 Test Loss: 0.0837836
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0776779
	speed: 0.0450s/iter; left time: 549.4992s
	iters: 200, epoch: 46 | loss: 0.0785439
	speed: 0.0217s/iter; left time: 262.9203s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0788168 Vali Loss: 0.0785216 Test Loss: 0.0836760
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0819852
	speed: 0.0456s/iter; left time: 547.2081s
	iters: 200, epoch: 47 | loss: 0.0764217
	speed: 0.0217s/iter; left time: 258.1698s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0788838 Vali Loss: 0.0784394 Test Loss: 0.0835491
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0801561
	speed: 0.0453s/iter; left time: 533.5707s
	iters: 200, epoch: 48 | loss: 0.0759512
	speed: 0.0217s/iter; left time: 253.0743s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0788972 Vali Loss: 0.0786097 Test Loss: 0.0835465
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0837191
	speed: 0.0458s/iter; left time: 529.5029s
	iters: 200, epoch: 49 | loss: 0.0782832
	speed: 0.0217s/iter; left time: 248.1192s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0787839 Vali Loss: 0.0786563 Test Loss: 0.0837891
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0809384
	speed: 0.0472s/iter; left time: 534.0162s
	iters: 200, epoch: 50 | loss: 0.0818458
	speed: 0.0218s/iter; left time: 244.9204s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0788235 Vali Loss: 0.0787580 Test Loss: 0.0837762
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0774208
	speed: 0.0459s/iter; left time: 509.0606s
	iters: 200, epoch: 51 | loss: 0.0799777
	speed: 0.0217s/iter; left time: 238.9280s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0788820 Vali Loss: 0.0786916 Test Loss: 0.0836173
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018824005499482155, rmse:0.13720060884952545, mae:0.08369677513837814, rse:0.5187702775001526
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2654191
	speed: 0.0241s/iter; left time: 538.1012s
	iters: 200, epoch: 1 | loss: 0.2492951
	speed: 0.0217s/iter; left time: 480.9847s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.2720975 Vali Loss: 0.1865720 Test Loss: 0.1956336
Validation loss decreased (inf --> 0.186572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1399787
	speed: 0.0458s/iter; left time: 1011.0653s
	iters: 200, epoch: 2 | loss: 0.1225978
	speed: 0.0218s/iter; left time: 479.8645s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.1536042 Vali Loss: 0.1050887 Test Loss: 0.1120235
Validation loss decreased (0.186572 --> 0.105089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1091442
	speed: 0.0453s/iter; left time: 990.8433s
	iters: 200, epoch: 3 | loss: 0.1053985
	speed: 0.0217s/iter; left time: 472.0399s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.1085688 Vali Loss: 0.0955726 Test Loss: 0.0993485
Validation loss decreased (0.105089 --> 0.095573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0951333
	speed: 0.0461s/iter; left time: 996.2139s
	iters: 200, epoch: 4 | loss: 0.0935304
	speed: 0.0218s/iter; left time: 469.4004s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0973197 Vali Loss: 0.0879738 Test Loss: 0.0907920
Validation loss decreased (0.095573 --> 0.087974).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0927496
	speed: 0.0473s/iter; left time: 1012.9622s
	iters: 200, epoch: 5 | loss: 0.0889635
	speed: 0.0217s/iter; left time: 462.6658s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0919887 Vali Loss: 0.0847625 Test Loss: 0.0883146
Validation loss decreased (0.087974 --> 0.084763).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0863985
	speed: 0.0456s/iter; left time: 965.3170s
	iters: 200, epoch: 6 | loss: 0.0812696
	speed: 0.0218s/iter; left time: 459.4074s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0887311 Vali Loss: 0.0829828 Test Loss: 0.0867898
Validation loss decreased (0.084763 --> 0.082983).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0859024
	speed: 0.0470s/iter; left time: 984.9223s
	iters: 200, epoch: 7 | loss: 0.0824680
	speed: 0.0220s/iter; left time: 458.1755s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0867531 Vali Loss: 0.0823170 Test Loss: 0.0859335
Validation loss decreased (0.082983 --> 0.082317).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0829310
	speed: 0.0457s/iter; left time: 948.4520s
	iters: 200, epoch: 8 | loss: 0.0867653
	speed: 0.0218s/iter; left time: 449.3740s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0859316 Vali Loss: 0.0816922 Test Loss: 0.0854676
Validation loss decreased (0.082317 --> 0.081692).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0843637
	speed: 0.0474s/iter; left time: 972.4026s
	iters: 200, epoch: 9 | loss: 0.0852142
	speed: 0.0217s/iter; left time: 443.4741s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0842771 Vali Loss: 0.0803814 Test Loss: 0.0849513
Validation loss decreased (0.081692 --> 0.080381).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0870816
	speed: 0.0464s/iter; left time: 940.4863s
	iters: 200, epoch: 10 | loss: 0.0879768
	speed: 0.0218s/iter; left time: 440.0127s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0836242 Vali Loss: 0.0797547 Test Loss: 0.0844912
Validation loss decreased (0.080381 --> 0.079755).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0812169
	speed: 0.0461s/iter; left time: 925.5945s
	iters: 200, epoch: 11 | loss: 0.0777536
	speed: 0.0217s/iter; left time: 432.8882s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0829738 Vali Loss: 0.0804546 Test Loss: 0.0843853
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0864148
	speed: 0.0452s/iter; left time: 896.6602s
	iters: 200, epoch: 12 | loss: 0.0833272
	speed: 0.0217s/iter; left time: 428.4840s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0828118 Vali Loss: 0.0791410 Test Loss: 0.0840591
Validation loss decreased (0.079755 --> 0.079141).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0858637
	speed: 0.0455s/iter; left time: 893.2174s
	iters: 200, epoch: 13 | loss: 0.0811261
	speed: 0.0217s/iter; left time: 423.6663s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0820563 Vali Loss: 0.0792300 Test Loss: 0.0841731
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0792796
	speed: 0.0457s/iter; left time: 886.0508s
	iters: 200, epoch: 14 | loss: 0.0850237
	speed: 0.0218s/iter; left time: 420.6221s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0819308 Vali Loss: 0.0791319 Test Loss: 0.0841701
Validation loss decreased (0.079141 --> 0.079132).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0816897
	speed: 0.0459s/iter; left time: 878.8331s
	iters: 200, epoch: 15 | loss: 0.0837741
	speed: 0.0217s/iter; left time: 414.0805s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0818446 Vali Loss: 0.0790949 Test Loss: 0.0838779
Validation loss decreased (0.079132 --> 0.079095).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0772030
	speed: 0.0458s/iter; left time: 867.5762s
	iters: 200, epoch: 16 | loss: 0.0822015
	speed: 0.0219s/iter; left time: 413.0002s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0812685 Vali Loss: 0.0790294 Test Loss: 0.0839537
Validation loss decreased (0.079095 --> 0.079029).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0825713
	speed: 0.0471s/iter; left time: 882.2171s
	iters: 200, epoch: 17 | loss: 0.0802149
	speed: 0.0219s/iter; left time: 407.7756s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0809672 Vali Loss: 0.0786991 Test Loss: 0.0841665
Validation loss decreased (0.079029 --> 0.078699).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0789418
	speed: 0.0461s/iter; left time: 851.8721s
	iters: 200, epoch: 18 | loss: 0.0843566
	speed: 0.0218s/iter; left time: 400.7013s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0809835 Vali Loss: 0.0788321 Test Loss: 0.0836655
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0792370
	speed: 0.0459s/iter; left time: 838.3063s
	iters: 200, epoch: 19 | loss: 0.0805640
	speed: 0.0219s/iter; left time: 397.2642s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0805153 Vali Loss: 0.0783761 Test Loss: 0.0838527
Validation loss decreased (0.078699 --> 0.078376).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0802716
	speed: 0.0467s/iter; left time: 843.0910s
	iters: 200, epoch: 20 | loss: 0.0811779
	speed: 0.0218s/iter; left time: 391.0617s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0803617 Vali Loss: 0.0781926 Test Loss: 0.0836971
Validation loss decreased (0.078376 --> 0.078193).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814950
	speed: 0.0459s/iter; left time: 817.4507s
	iters: 200, epoch: 21 | loss: 0.0779797
	speed: 0.0218s/iter; left time: 386.2328s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0803367 Vali Loss: 0.0780951 Test Loss: 0.0833912
Validation loss decreased (0.078193 --> 0.078095).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0752782
	speed: 0.0457s/iter; left time: 803.3243s
	iters: 200, epoch: 22 | loss: 0.0836513
	speed: 0.0217s/iter; left time: 380.3938s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0799694 Vali Loss: 0.0783406 Test Loss: 0.0837624
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0772950
	speed: 0.0454s/iter; left time: 787.8871s
	iters: 200, epoch: 23 | loss: 0.0788521
	speed: 0.0218s/iter; left time: 376.0150s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0798195 Vali Loss: 0.0780636 Test Loss: 0.0836977
Validation loss decreased (0.078095 --> 0.078064).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0814265
	speed: 0.0452s/iter; left time: 774.2932s
	iters: 200, epoch: 24 | loss: 0.0788700
	speed: 0.0218s/iter; left time: 371.1320s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0798068 Vali Loss: 0.0778582 Test Loss: 0.0834748
Validation loss decreased (0.078064 --> 0.077858).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0803527
	speed: 0.0461s/iter; left time: 779.8283s
	iters: 200, epoch: 25 | loss: 0.0848269
	speed: 0.0217s/iter; left time: 365.7078s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0798114 Vali Loss: 0.0780343 Test Loss: 0.0838131
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0838103
	speed: 0.0454s/iter; left time: 757.7270s
	iters: 200, epoch: 26 | loss: 0.0776953
	speed: 0.0218s/iter; left time: 361.7082s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0795814 Vali Loss: 0.0778576 Test Loss: 0.0835398
Validation loss decreased (0.077858 --> 0.077858).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0771144
	speed: 0.0471s/iter; left time: 776.1938s
	iters: 200, epoch: 27 | loss: 0.0803550
	speed: 0.0218s/iter; left time: 357.4137s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0797561 Vali Loss: 0.0780170 Test Loss: 0.0836571
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0777727
	speed: 0.0451s/iter; left time: 733.4159s
	iters: 200, epoch: 28 | loss: 0.0748627
	speed: 0.0217s/iter; left time: 351.0779s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0795140 Vali Loss: 0.0779177 Test Loss: 0.0836448
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0832448
	speed: 0.0453s/iter; left time: 726.1415s
	iters: 200, epoch: 29 | loss: 0.0789319
	speed: 0.0218s/iter; left time: 346.9720s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0795038 Vali Loss: 0.0777554 Test Loss: 0.0836502
Validation loss decreased (0.077858 --> 0.077755).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0811197
	speed: 0.0459s/iter; left time: 724.9185s
	iters: 200, epoch: 30 | loss: 0.0765274
	speed: 0.0218s/iter; left time: 342.4718s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0794699 Vali Loss: 0.0783273 Test Loss: 0.0839464
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0803536
	speed: 0.0457s/iter; left time: 712.1239s
	iters: 200, epoch: 31 | loss: 0.0779944
	speed: 0.0217s/iter; left time: 336.4809s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0793642 Vali Loss: 0.0775169 Test Loss: 0.0833227
Validation loss decreased (0.077755 --> 0.077517).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0745973
	speed: 0.0461s/iter; left time: 707.4138s
	iters: 200, epoch: 32 | loss: 0.0782623
	speed: 0.0218s/iter; left time: 332.0141s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0792247 Vali Loss: 0.0776478 Test Loss: 0.0833616
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0801016
	speed: 0.0451s/iter; left time: 682.5111s
	iters: 200, epoch: 33 | loss: 0.0779588
	speed: 0.0218s/iter; left time: 327.3951s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0799833 Vali Loss: 0.0777766 Test Loss: 0.0834873
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0816889
	speed: 0.0450s/iter; left time: 671.4194s
	iters: 200, epoch: 34 | loss: 0.0831700
	speed: 0.0217s/iter; left time: 321.6817s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0792972 Vali Loss: 0.0779381 Test Loss: 0.0835514
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0768755
	speed: 0.0452s/iter; left time: 663.1688s
	iters: 200, epoch: 35 | loss: 0.0796030
	speed: 0.0218s/iter; left time: 317.6736s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0791943 Vali Loss: 0.0777968 Test Loss: 0.0835614
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0773502
	speed: 0.0460s/iter; left time: 665.0932s
	iters: 200, epoch: 36 | loss: 0.0780936
	speed: 0.0220s/iter; left time: 315.5054s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0791645 Vali Loss: 0.0775731 Test Loss: 0.0833945
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0796844
	speed: 0.0457s/iter; left time: 650.1146s
	iters: 200, epoch: 37 | loss: 0.0773664
	speed: 0.0218s/iter; left time: 308.8219s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0792220 Vali Loss: 0.0775868 Test Loss: 0.0835307
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0818282
	speed: 0.0455s/iter; left time: 636.9339s
	iters: 200, epoch: 38 | loss: 0.0762107
	speed: 0.0219s/iter; left time: 304.2655s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0790748 Vali Loss: 0.0777856 Test Loss: 0.0835588
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0811020
	speed: 0.0455s/iter; left time: 626.8747s
	iters: 200, epoch: 39 | loss: 0.0792930
	speed: 0.0217s/iter; left time: 297.6207s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0791693 Vali Loss: 0.0778655 Test Loss: 0.0836741
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0785080
	speed: 0.0457s/iter; left time: 619.8744s
	iters: 200, epoch: 40 | loss: 0.0768711
	speed: 0.0218s/iter; left time: 292.8648s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0789317 Vali Loss: 0.0776449 Test Loss: 0.0834714
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0819468
	speed: 0.0463s/iter; left time: 617.9193s
	iters: 200, epoch: 41 | loss: 0.0790669
	speed: 0.0218s/iter; left time: 288.7923s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0790118 Vali Loss: 0.0776679 Test Loss: 0.0834917
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018634524196386337, rmse:0.13650833070278168, mae:0.08332263678312302, rse:0.5161527395248413
Intermediate time for IT and pred_len 96: 00h:10m:34.19s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2593685
	speed: 0.0405s/iter; left time: 898.9807s
	iters: 200, epoch: 1 | loss: 0.2436044
	speed: 0.0220s/iter; left time: 486.0357s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.42s
Steps: 223 | Train Loss: 0.2658861 Vali Loss: 0.1834447 Test Loss: 0.1922477
Validation loss decreased (inf --> 0.183445).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1407781
	speed: 0.0461s/iter; left time: 1014.0556s
	iters: 200, epoch: 2 | loss: 0.1193458
	speed: 0.0221s/iter; left time: 482.6069s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.1517239 Vali Loss: 0.1063502 Test Loss: 0.1113415
Validation loss decreased (0.183445 --> 0.106350).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1147257
	speed: 0.0481s/iter; left time: 1046.0926s
	iters: 200, epoch: 3 | loss: 0.1031990
	speed: 0.0222s/iter; left time: 480.0104s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.1103073 Vali Loss: 0.1010213 Test Loss: 0.1056513
Validation loss decreased (0.106350 --> 0.101021).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1029070
	speed: 0.0472s/iter; left time: 1016.9723s
	iters: 200, epoch: 4 | loss: 0.1007020
	speed: 0.0221s/iter; left time: 473.9418s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.1000806 Vali Loss: 0.0917719 Test Loss: 0.0934857
Validation loss decreased (0.101021 --> 0.091772).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0904802
	speed: 0.0475s/iter; left time: 1012.0715s
	iters: 200, epoch: 5 | loss: 0.0915495
	speed: 0.0221s/iter; left time: 469.3125s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0945440 Vali Loss: 0.0885954 Test Loss: 0.0915012
Validation loss decreased (0.091772 --> 0.088595).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0913310
	speed: 0.0465s/iter; left time: 981.2804s
	iters: 200, epoch: 6 | loss: 0.0933463
	speed: 0.0220s/iter; left time: 462.0953s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0920161 Vali Loss: 0.0871038 Test Loss: 0.0899142
Validation loss decreased (0.088595 --> 0.087104).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0896496
	speed: 0.0464s/iter; left time: 968.5718s
	iters: 200, epoch: 7 | loss: 0.0911744
	speed: 0.0221s/iter; left time: 458.6023s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0899998 Vali Loss: 0.0861870 Test Loss: 0.0892110
Validation loss decreased (0.087104 --> 0.086187).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0874285
	speed: 0.0474s/iter; left time: 978.4582s
	iters: 200, epoch: 8 | loss: 0.0868309
	speed: 0.0222s/iter; left time: 455.2393s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0887113 Vali Loss: 0.0859383 Test Loss: 0.0894966
Validation loss decreased (0.086187 --> 0.085938).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0855003
	speed: 0.0476s/iter; left time: 970.8596s
	iters: 200, epoch: 9 | loss: 0.0856321
	speed: 0.0222s/iter; left time: 450.5544s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0878365 Vali Loss: 0.0863210 Test Loss: 0.0901244
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0847125
	speed: 0.0474s/iter; left time: 957.1523s
	iters: 200, epoch: 10 | loss: 0.0874492
	speed: 0.0222s/iter; left time: 445.1648s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0870967 Vali Loss: 0.0845443 Test Loss: 0.0875666
Validation loss decreased (0.085938 --> 0.084544).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0871908
	speed: 0.0471s/iter; left time: 940.1918s
	iters: 200, epoch: 11 | loss: 0.0818305
	speed: 0.0221s/iter; left time: 439.5144s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0863422 Vali Loss: 0.0841798 Test Loss: 0.0872976
Validation loss decreased (0.084544 --> 0.084180).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0837236
	speed: 0.0473s/iter; left time: 933.5158s
	iters: 200, epoch: 12 | loss: 0.0858295
	speed: 0.0221s/iter; left time: 433.3770s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0862503 Vali Loss: 0.0846573 Test Loss: 0.0883181
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0840104
	speed: 0.0463s/iter; left time: 903.0344s
	iters: 200, epoch: 13 | loss: 0.0873080
	speed: 0.0221s/iter; left time: 428.4650s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0858051 Vali Loss: 0.0841540 Test Loss: 0.0875185
Validation loss decreased (0.084180 --> 0.084154).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0842696
	speed: 0.0473s/iter; left time: 912.9072s
	iters: 200, epoch: 14 | loss: 0.0864293
	speed: 0.0221s/iter; left time: 424.6854s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0852016 Vali Loss: 0.0839391 Test Loss: 0.0871678
Validation loss decreased (0.084154 --> 0.083939).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0835843
	speed: 0.0468s/iter; left time: 893.7223s
	iters: 200, epoch: 15 | loss: 0.0903612
	speed: 0.0220s/iter; left time: 418.3282s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0850153 Vali Loss: 0.0849698 Test Loss: 0.0885047
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0866383
	speed: 0.0467s/iter; left time: 881.0883s
	iters: 200, epoch: 16 | loss: 0.0840572
	speed: 0.0220s/iter; left time: 412.5113s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0846479 Vali Loss: 0.0838537 Test Loss: 0.0874743
Validation loss decreased (0.083939 --> 0.083854).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0856122
	speed: 0.0471s/iter; left time: 878.2778s
	iters: 200, epoch: 17 | loss: 0.0852672
	speed: 0.0220s/iter; left time: 408.4244s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0853350 Vali Loss: 0.0845202 Test Loss: 0.0880538
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0798638
	speed: 0.0462s/iter; left time: 850.9026s
	iters: 200, epoch: 18 | loss: 0.0865999
	speed: 0.0220s/iter; left time: 402.8317s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0847002 Vali Loss: 0.0843393 Test Loss: 0.0880147
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0824680
	speed: 0.0460s/iter; left time: 836.3134s
	iters: 200, epoch: 19 | loss: 0.0845451
	speed: 0.0220s/iter; left time: 397.0613s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0840779 Vali Loss: 0.0829712 Test Loss: 0.0871362
Validation loss decreased (0.083854 --> 0.082971).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0837010
	speed: 0.0460s/iter; left time: 826.4075s
	iters: 200, epoch: 20 | loss: 0.0806240
	speed: 0.0220s/iter; left time: 392.2075s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0840868 Vali Loss: 0.0831228 Test Loss: 0.0872801
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0838653
	speed: 0.0461s/iter; left time: 817.0826s
	iters: 200, epoch: 21 | loss: 0.0840183
	speed: 0.0220s/iter; left time: 388.1818s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0838349 Vali Loss: 0.0828729 Test Loss: 0.0870302
Validation loss decreased (0.082971 --> 0.082873).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0847097
	speed: 0.0467s/iter; left time: 817.3500s
	iters: 200, epoch: 22 | loss: 0.0875652
	speed: 0.0221s/iter; left time: 384.1618s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0837299 Vali Loss: 0.0827980 Test Loss: 0.0872208
Validation loss decreased (0.082873 --> 0.082798).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0790841
	speed: 0.0460s/iter; left time: 795.1605s
	iters: 200, epoch: 23 | loss: 0.0829606
	speed: 0.0219s/iter; left time: 377.3997s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0837755 Vali Loss: 0.0830272 Test Loss: 0.0870533
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0868019
	speed: 0.0460s/iter; left time: 784.4881s
	iters: 200, epoch: 24 | loss: 0.0897313
	speed: 0.0219s/iter; left time: 372.0221s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0836040 Vali Loss: 0.0829900 Test Loss: 0.0873390
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0835902
	speed: 0.0455s/iter; left time: 766.2783s
	iters: 200, epoch: 25 | loss: 0.0825780
	speed: 0.0219s/iter; left time: 367.4116s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0835581 Vali Loss: 0.0830822 Test Loss: 0.0870602
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0857956
	speed: 0.0470s/iter; left time: 781.0885s
	iters: 200, epoch: 26 | loss: 0.0841903
	speed: 0.0220s/iter; left time: 363.4675s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0834239 Vali Loss: 0.0828397 Test Loss: 0.0869646
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0810797
	speed: 0.0460s/iter; left time: 754.0497s
	iters: 200, epoch: 27 | loss: 0.0865426
	speed: 0.0219s/iter; left time: 357.7710s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0834309 Vali Loss: 0.0834939 Test Loss: 0.0877459
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0841784
	speed: 0.0462s/iter; left time: 747.3007s
	iters: 200, epoch: 28 | loss: 0.0836473
	speed: 0.0220s/iter; left time: 354.4484s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.25s
Steps: 223 | Train Loss: 0.0833612 Vali Loss: 0.0831791 Test Loss: 0.0874583
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0798603
	speed: 0.0456s/iter; left time: 726.8698s
	iters: 200, epoch: 29 | loss: 0.0834853
	speed: 0.0220s/iter; left time: 349.2857s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0831603 Vali Loss: 0.0829199 Test Loss: 0.0874351
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0816144
	speed: 0.0469s/iter; left time: 737.3853s
	iters: 200, epoch: 30 | loss: 0.0862560
	speed: 0.0220s/iter; left time: 344.6944s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0831205 Vali Loss: 0.0827721 Test Loss: 0.0871754
Validation loss decreased (0.082798 --> 0.082772).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0850103
	speed: 0.0476s/iter; left time: 738.3852s
	iters: 200, epoch: 31 | loss: 0.0829719
	speed: 0.0220s/iter; left time: 338.8399s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0831990 Vali Loss: 0.0827966 Test Loss: 0.0871364
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0816215
	speed: 0.0459s/iter; left time: 701.7504s
	iters: 200, epoch: 32 | loss: 0.0827003
	speed: 0.0220s/iter; left time: 334.4242s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0830870 Vali Loss: 0.0832036 Test Loss: 0.0876115
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0822320
	speed: 0.0455s/iter; left time: 685.9821s
	iters: 200, epoch: 33 | loss: 0.0830600
	speed: 0.0220s/iter; left time: 329.1575s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0830390 Vali Loss: 0.0826716 Test Loss: 0.0873047
Validation loss decreased (0.082772 --> 0.082672).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0803795
	speed: 0.0465s/iter; left time: 689.9992s
	iters: 200, epoch: 34 | loss: 0.0844212
	speed: 0.0220s/iter; left time: 323.7350s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0829971 Vali Loss: 0.0829689 Test Loss: 0.0872176
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0836070
	speed: 0.0464s/iter; left time: 678.1191s
	iters: 200, epoch: 35 | loss: 0.0822811
	speed: 0.0219s/iter; left time: 318.5841s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0829739 Vali Loss: 0.0829763 Test Loss: 0.0873647
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0822121
	speed: 0.0456s/iter; left time: 656.3899s
	iters: 200, epoch: 36 | loss: 0.0837157
	speed: 0.0220s/iter; left time: 314.0795s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0829454 Vali Loss: 0.0826224 Test Loss: 0.0870566
Validation loss decreased (0.082672 --> 0.082622).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0821490
	speed: 0.0465s/iter; left time: 659.3375s
	iters: 200, epoch: 37 | loss: 0.0808399
	speed: 0.0220s/iter; left time: 309.0158s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0831293 Vali Loss: 0.0828235 Test Loss: 0.0872067
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0868248
	speed: 0.0467s/iter; left time: 651.4406s
	iters: 200, epoch: 38 | loss: 0.0834173
	speed: 0.0220s/iter; left time: 304.0136s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.26s
Steps: 223 | Train Loss: 0.0831270 Vali Loss: 0.0828858 Test Loss: 0.0871896
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0833493
	speed: 0.0470s/iter; left time: 645.0403s
	iters: 200, epoch: 39 | loss: 0.0841909
	speed: 0.0220s/iter; left time: 300.4392s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0829811 Vali Loss: 0.0828958 Test Loss: 0.0873336
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0824400
	speed: 0.0457s/iter; left time: 617.6108s
	iters: 200, epoch: 40 | loss: 0.0821157
	speed: 0.0220s/iter; left time: 294.8123s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0830106 Vali Loss: 0.0828837 Test Loss: 0.0871975
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0823991
	speed: 0.0464s/iter; left time: 615.7225s
	iters: 200, epoch: 41 | loss: 0.0807214
	speed: 0.0219s/iter; left time: 289.1728s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0828080 Vali Loss: 0.0830184 Test Loss: 0.0873392
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0841578
	speed: 0.0465s/iter; left time: 607.5300s
	iters: 200, epoch: 42 | loss: 0.0809948
	speed: 0.0221s/iter; left time: 285.9513s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0828283 Vali Loss: 0.0825982 Test Loss: 0.0871560
Validation loss decreased (0.082622 --> 0.082598).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0829908
	speed: 0.0459s/iter; left time: 588.8886s
	iters: 200, epoch: 43 | loss: 0.0835017
	speed: 0.0220s/iter; left time: 279.7391s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0828749 Vali Loss: 0.0826529 Test Loss: 0.0871838
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0827640
	speed: 0.0460s/iter; left time: 580.5419s
	iters: 200, epoch: 44 | loss: 0.0828017
	speed: 0.0220s/iter; left time: 275.8122s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0828612 Vali Loss: 0.0826238 Test Loss: 0.0872305
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0829563
	speed: 0.0461s/iter; left time: 570.6787s
	iters: 200, epoch: 45 | loss: 0.0845657
	speed: 0.0219s/iter; left time: 269.7385s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0827854 Vali Loss: 0.0828263 Test Loss: 0.0873275
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0868040
	speed: 0.0457s/iter; left time: 556.2922s
	iters: 200, epoch: 46 | loss: 0.0862150
	speed: 0.0221s/iter; left time: 266.8522s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0827368 Vali Loss: 0.0827539 Test Loss: 0.0872403
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0846043
	speed: 0.0466s/iter; left time: 556.4608s
	iters: 200, epoch: 47 | loss: 0.0840427
	speed: 0.0220s/iter; left time: 260.5911s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0826896 Vali Loss: 0.0826987 Test Loss: 0.0872980
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0892193
	speed: 0.0459s/iter; left time: 538.0240s
	iters: 200, epoch: 48 | loss: 0.0814552
	speed: 0.0220s/iter; left time: 255.9023s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0828820 Vali Loss: 0.0830107 Test Loss: 0.0873947
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0841394
	speed: 0.0467s/iter; left time: 537.0289s
	iters: 200, epoch: 49 | loss: 0.0814938
	speed: 0.0220s/iter; left time: 250.6868s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0828457 Vali Loss: 0.0824850 Test Loss: 0.0870350
Validation loss decreased (0.082598 --> 0.082485).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0864921
	speed: 0.0459s/iter; left time: 517.8780s
	iters: 200, epoch: 50 | loss: 0.0840216
	speed: 0.0220s/iter; left time: 246.1675s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0827708 Vali Loss: 0.0827214 Test Loss: 0.0871683
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0822083
	speed: 0.0455s/iter; left time: 502.8970s
	iters: 200, epoch: 51 | loss: 0.0828765
	speed: 0.0219s/iter; left time: 240.0809s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0827678 Vali Loss: 0.0828792 Test Loss: 0.0872527
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0832035
	speed: 0.0459s/iter; left time: 496.7346s
	iters: 200, epoch: 52 | loss: 0.0844733
	speed: 0.0220s/iter; left time: 235.7535s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0826931 Vali Loss: 0.0825402 Test Loss: 0.0871795
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0801339
	speed: 0.0453s/iter; left time: 480.5976s
	iters: 200, epoch: 53 | loss: 0.0849573
	speed: 0.0220s/iter; left time: 230.6947s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0827957 Vali Loss: 0.0825594 Test Loss: 0.0871752
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0821759
	speed: 0.0453s/iter; left time: 470.1620s
	iters: 200, epoch: 54 | loss: 0.0818415
	speed: 0.0220s/iter; left time: 226.4498s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0827428 Vali Loss: 0.0826589 Test Loss: 0.0872044
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0848550
	speed: 0.0458s/iter; left time: 465.7023s
	iters: 200, epoch: 55 | loss: 0.0852969
	speed: 0.0220s/iter; left time: 221.2054s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0827881 Vali Loss: 0.0825741 Test Loss: 0.0872493
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0825167
	speed: 0.0456s/iter; left time: 452.9776s
	iters: 200, epoch: 56 | loss: 0.0810092
	speed: 0.0219s/iter; left time: 215.7721s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0826493 Vali Loss: 0.0825289 Test Loss: 0.0872128
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0799878
	speed: 0.0456s/iter; left time: 442.9017s
	iters: 200, epoch: 57 | loss: 0.0830834
	speed: 0.0220s/iter; left time: 211.7394s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0826917 Vali Loss: 0.0825688 Test Loss: 0.0871434
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0829910
	speed: 0.0475s/iter; left time: 450.3544s
	iters: 200, epoch: 58 | loss: 0.0806161
	speed: 0.0220s/iter; left time: 206.1620s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0826969 Vali Loss: 0.0825653 Test Loss: 0.0871960
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0799795
	speed: 0.0457s/iter; left time: 423.5705s
	iters: 200, epoch: 59 | loss: 0.0835380
	speed: 0.0220s/iter; left time: 201.5382s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0826923 Vali Loss: 0.0824179 Test Loss: 0.0871157
Validation loss decreased (0.082485 --> 0.082418).  Saving model ...
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0828893
	speed: 0.0464s/iter; left time: 419.4648s
	iters: 200, epoch: 60 | loss: 0.0850512
	speed: 0.0220s/iter; left time: 197.0472s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0825990 Vali Loss: 0.0826143 Test Loss: 0.0871236
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0886924
	speed: 0.0455s/iter; left time: 401.0363s
	iters: 200, epoch: 61 | loss: 0.0793289
	speed: 0.0220s/iter; left time: 191.4408s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0827438 Vali Loss: 0.0821354 Test Loss: 0.0871118
Validation loss decreased (0.082418 --> 0.082135).  Saving model ...
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0824173
	speed: 0.0457s/iter; left time: 392.7647s
	iters: 200, epoch: 62 | loss: 0.0811318
	speed: 0.0220s/iter; left time: 186.5739s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0827405 Vali Loss: 0.0824807 Test Loss: 0.0870766
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0835284
	speed: 0.0467s/iter; left time: 390.9252s
	iters: 200, epoch: 63 | loss: 0.1137236
	speed: 0.0221s/iter; left time: 182.6318s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.27s
Steps: 223 | Train Loss: 0.0828660 Vali Loss: 0.0826132 Test Loss: 0.0872791
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0830507
	speed: 0.0467s/iter; left time: 380.5016s
	iters: 200, epoch: 64 | loss: 0.0820392
	speed: 0.0220s/iter; left time: 177.3068s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0826460 Vali Loss: 0.0827017 Test Loss: 0.0873357
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0806877
	speed: 0.0464s/iter; left time: 367.5741s
	iters: 200, epoch: 65 | loss: 0.0851976
	speed: 0.0220s/iter; left time: 172.5304s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0826986 Vali Loss: 0.0823724 Test Loss: 0.0871242
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0820866
	speed: 0.0458s/iter; left time: 353.2676s
	iters: 200, epoch: 66 | loss: 0.0867027
	speed: 0.0219s/iter; left time: 166.6152s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0827033 Vali Loss: 0.0826242 Test Loss: 0.0871462
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0812859
	speed: 0.0450s/iter; left time: 336.5091s
	iters: 200, epoch: 67 | loss: 0.0821370
	speed: 0.0219s/iter; left time: 161.4200s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0827175 Vali Loss: 0.0826630 Test Loss: 0.0871136
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0808324
	speed: 0.0459s/iter; left time: 333.2064s
	iters: 200, epoch: 68 | loss: 0.0796144
	speed: 0.0219s/iter; left time: 156.8106s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0827011 Vali Loss: 0.0825143 Test Loss: 0.0871246
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0830997
	speed: 0.0446s/iter; left time: 314.0972s
	iters: 200, epoch: 69 | loss: 0.0856903
	speed: 0.0219s/iter; left time: 151.9899s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0828258 Vali Loss: 0.0828641 Test Loss: 0.0873644
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0812915
	speed: 0.0461s/iter; left time: 314.3249s
	iters: 200, epoch: 70 | loss: 0.0829005
	speed: 0.0220s/iter; left time: 147.9147s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0827522 Vali Loss: 0.0826536 Test Loss: 0.0871776
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.595044557171442e-08
	iters: 100, epoch: 71 | loss: 0.0844976
	speed: 0.0458s/iter; left time: 301.7250s
	iters: 200, epoch: 71 | loss: 0.0787759
	speed: 0.0219s/iter; left time: 142.3047s
-------------------------------------------------------------------------------------
Epoch: 71
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0826554 Vali Loss: 0.0824497 Test Loss: 0.0870941
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01985550858080387, rmse:0.1409095823764801, mae:0.08711183071136475, rse:0.53328937292099
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2663303
	speed: 0.0241s/iter; left time: 534.3388s
	iters: 200, epoch: 1 | loss: 0.2495897
	speed: 0.0218s/iter; left time: 482.7113s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.2699061 Vali Loss: 0.1853016 Test Loss: 0.1929747
Validation loss decreased (inf --> 0.185302).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1406610
	speed: 0.0461s/iter; left time: 1012.8444s
	iters: 200, epoch: 2 | loss: 0.1205855
	speed: 0.0221s/iter; left time: 482.4941s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.1529040 Vali Loss: 0.1062459 Test Loss: 0.1111591
Validation loss decreased (0.185302 --> 0.106246).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1135620
	speed: 0.0472s/iter; left time: 1027.5622s
	iters: 200, epoch: 3 | loss: 0.1049397
	speed: 0.0219s/iter; left time: 475.0577s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.1101596 Vali Loss: 0.0964184 Test Loss: 0.0986221
Validation loss decreased (0.106246 --> 0.096418).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0955819
	speed: 0.0466s/iter; left time: 1003.8268s
	iters: 200, epoch: 4 | loss: 0.0951034
	speed: 0.0219s/iter; left time: 469.6974s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0991363 Vali Loss: 0.0909867 Test Loss: 0.0931468
Validation loss decreased (0.096418 --> 0.090987).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0971086
	speed: 0.0483s/iter; left time: 1030.2709s
	iters: 200, epoch: 5 | loss: 0.0963634
	speed: 0.0219s/iter; left time: 465.1810s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0943635 Vali Loss: 0.0883152 Test Loss: 0.0912352
Validation loss decreased (0.090987 --> 0.088315).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0913551
	speed: 0.0466s/iter; left time: 982.0530s
	iters: 200, epoch: 6 | loss: 0.0931478
	speed: 0.0219s/iter; left time: 460.5485s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0915802 Vali Loss: 0.0879002 Test Loss: 0.0911573
Validation loss decreased (0.088315 --> 0.087900).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0909168
	speed: 0.0474s/iter; left time: 989.1074s
	iters: 200, epoch: 7 | loss: 0.0904019
	speed: 0.0219s/iter; left time: 455.2580s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0903473 Vali Loss: 0.0862856 Test Loss: 0.0900857
Validation loss decreased (0.087900 --> 0.086286).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0890367
	speed: 0.0464s/iter; left time: 957.4247s
	iters: 200, epoch: 8 | loss: 0.0926520
	speed: 0.0219s/iter; left time: 449.9032s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0889100 Vali Loss: 0.0848608 Test Loss: 0.0887103
Validation loss decreased (0.086286 --> 0.084861).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0864818
	speed: 0.0470s/iter; left time: 960.5250s
	iters: 200, epoch: 9 | loss: 0.0847912
	speed: 0.0219s/iter; left time: 445.4111s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0878572 Vali Loss: 0.0856829 Test Loss: 0.0890467
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0902095
	speed: 0.0462s/iter; left time: 933.7491s
	iters: 200, epoch: 10 | loss: 0.0849279
	speed: 0.0219s/iter; left time: 439.7982s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0872292 Vali Loss: 0.0849854 Test Loss: 0.0889889
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0811704
	speed: 0.0461s/iter; left time: 920.5602s
	iters: 200, epoch: 11 | loss: 0.0881951
	speed: 0.0219s/iter; left time: 435.4500s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0868251 Vali Loss: 0.0849550 Test Loss: 0.0886877
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0847403
	speed: 0.0458s/iter; left time: 903.8987s
	iters: 200, epoch: 12 | loss: 0.0856506
	speed: 0.0219s/iter; left time: 430.5590s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0863239 Vali Loss: 0.0835640 Test Loss: 0.0883936
Validation loss decreased (0.084861 --> 0.083564).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0884693
	speed: 0.0465s/iter; left time: 907.5706s
	iters: 200, epoch: 13 | loss: 0.0836527
	speed: 0.0219s/iter; left time: 425.7883s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0857635 Vali Loss: 0.0841969 Test Loss: 0.0885494
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0834788
	speed: 0.0458s/iter; left time: 883.7222s
	iters: 200, epoch: 14 | loss: 0.0901838
	speed: 0.0220s/iter; left time: 422.5986s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0855193 Vali Loss: 0.0839952 Test Loss: 0.0887053
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0869290
	speed: 0.0461s/iter; left time: 879.5211s
	iters: 200, epoch: 15 | loss: 0.0855318
	speed: 0.0219s/iter; left time: 414.7219s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0850765 Vali Loss: 0.0832955 Test Loss: 0.0882019
Validation loss decreased (0.083564 --> 0.083296).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0821112
	speed: 0.0463s/iter; left time: 873.0776s
	iters: 200, epoch: 16 | loss: 0.0844743
	speed: 0.0220s/iter; left time: 412.3356s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0849393 Vali Loss: 0.0835920 Test Loss: 0.0881210
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0907413
	speed: 0.0457s/iter; left time: 850.7743s
	iters: 200, epoch: 17 | loss: 0.0843844
	speed: 0.0219s/iter; left time: 405.4810s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0845680 Vali Loss: 0.0829000 Test Loss: 0.0882578
Validation loss decreased (0.083296 --> 0.082900).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0878235
	speed: 0.0456s/iter; left time: 839.2290s
	iters: 200, epoch: 18 | loss: 0.0827412
	speed: 0.0219s/iter; left time: 400.3961s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0844269 Vali Loss: 0.0832814 Test Loss: 0.0883249
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0869892
	speed: 0.0454s/iter; left time: 825.8668s
	iters: 200, epoch: 19 | loss: 0.0847519
	speed: 0.0220s/iter; left time: 397.8060s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0842619 Vali Loss: 0.0830225 Test Loss: 0.0879700
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0837383
	speed: 0.0468s/iter; left time: 841.1474s
	iters: 200, epoch: 20 | loss: 0.0859412
	speed: 0.0219s/iter; left time: 391.4542s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0842205 Vali Loss: 0.0827590 Test Loss: 0.0878483
Validation loss decreased (0.082900 --> 0.082759).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0813399
	speed: 0.0459s/iter; left time: 814.1196s
	iters: 200, epoch: 21 | loss: 0.0846907
	speed: 0.0219s/iter; left time: 386.6326s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0838792 Vali Loss: 0.0828150 Test Loss: 0.0884018
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0840088
	speed: 0.0453s/iter; left time: 794.3800s
	iters: 200, epoch: 22 | loss: 0.0823603
	speed: 0.0219s/iter; left time: 382.2902s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0838453 Vali Loss: 0.0830889 Test Loss: 0.0882742
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0839935
	speed: 0.0458s/iter; left time: 792.6348s
	iters: 200, epoch: 23 | loss: 0.0839733
	speed: 0.0219s/iter; left time: 376.2266s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0835122 Vali Loss: 0.0826695 Test Loss: 0.0882341
Validation loss decreased (0.082759 --> 0.082670).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0827538
	speed: 0.0458s/iter; left time: 781.6747s
	iters: 200, epoch: 24 | loss: 0.0846985
	speed: 0.0219s/iter; left time: 370.9666s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0835666 Vali Loss: 0.0826776 Test Loss: 0.0880646
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0829660
	speed: 0.0458s/iter; left time: 772.1862s
	iters: 200, epoch: 25 | loss: 0.0848448
	speed: 0.0222s/iter; left time: 372.1517s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0835243 Vali Loss: 0.0827565 Test Loss: 0.0883843
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0828879
	speed: 0.0454s/iter; left time: 754.4651s
	iters: 200, epoch: 26 | loss: 0.0840080
	speed: 0.0219s/iter; left time: 361.7626s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0834005 Vali Loss: 0.0826957 Test Loss: 0.0882677
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0852914
	speed: 0.0456s/iter; left time: 748.4981s
	iters: 200, epoch: 27 | loss: 0.0843093
	speed: 0.0219s/iter; left time: 357.6886s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0831468 Vali Loss: 0.0826491 Test Loss: 0.0884727
Validation loss decreased (0.082670 --> 0.082649).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0855318
	speed: 0.0463s/iter; left time: 748.9012s
	iters: 200, epoch: 28 | loss: 0.0809674
	speed: 0.0219s/iter; left time: 352.6394s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0830994 Vali Loss: 0.0826731 Test Loss: 0.0883053
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0818016
	speed: 0.0468s/iter; left time: 746.9632s
	iters: 200, epoch: 29 | loss: 0.0822558
	speed: 0.0219s/iter; left time: 346.9320s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0830391 Vali Loss: 0.0824894 Test Loss: 0.0879897
Validation loss decreased (0.082649 --> 0.082489).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0802267
	speed: 0.0463s/iter; left time: 729.1256s
	iters: 200, epoch: 30 | loss: 0.0829845
	speed: 0.0221s/iter; left time: 345.4484s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0831334 Vali Loss: 0.0825363 Test Loss: 0.0881116
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0839852
	speed: 0.0470s/iter; left time: 729.6307s
	iters: 200, epoch: 31 | loss: 0.0814398
	speed: 0.0220s/iter; left time: 339.7769s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0831460 Vali Loss: 0.0827973 Test Loss: 0.0882100
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0812603
	speed: 0.0461s/iter; left time: 704.7270s
	iters: 200, epoch: 32 | loss: 0.0818972
	speed: 0.0219s/iter; left time: 333.3018s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0829502 Vali Loss: 0.0825992 Test Loss: 0.0880885
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0834544
	speed: 0.0459s/iter; left time: 691.6956s
	iters: 200, epoch: 33 | loss: 0.0835315
	speed: 0.0219s/iter; left time: 328.4681s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0829364 Vali Loss: 0.0823315 Test Loss: 0.0881189
Validation loss decreased (0.082489 --> 0.082332).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0862341
	speed: 0.0461s/iter; left time: 684.7455s
	iters: 200, epoch: 34 | loss: 0.0865677
	speed: 0.0219s/iter; left time: 322.8449s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0828982 Vali Loss: 0.0827680 Test Loss: 0.0883268
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0824191
	speed: 0.0458s/iter; left time: 669.8288s
	iters: 200, epoch: 35 | loss: 0.0848275
	speed: 0.0219s/iter; left time: 318.0464s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0828251 Vali Loss: 0.0822350 Test Loss: 0.0883389
Validation loss decreased (0.082332 --> 0.082235).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0823399
	speed: 0.0462s/iter; left time: 665.1212s
	iters: 200, epoch: 36 | loss: 0.0801759
	speed: 0.0220s/iter; left time: 315.0711s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0828478 Vali Loss: 0.0825154 Test Loss: 0.0881657
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0836879
	speed: 0.0463s/iter; left time: 656.3157s
	iters: 200, epoch: 37 | loss: 0.0847765
	speed: 0.0220s/iter; left time: 308.9125s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0827734 Vali Loss: 0.0824253 Test Loss: 0.0882355
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0813420
	speed: 0.0454s/iter; left time: 633.1072s
	iters: 200, epoch: 38 | loss: 0.0832034
	speed: 0.0219s/iter; left time: 303.0147s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0827893 Vali Loss: 0.0825257 Test Loss: 0.0882378
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0781291
	speed: 0.0460s/iter; left time: 632.1010s
	iters: 200, epoch: 39 | loss: 0.0790620
	speed: 0.0220s/iter; left time: 300.1258s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0826738 Vali Loss: 0.0823739 Test Loss: 0.0882329
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0861765
	speed: 0.0455s/iter; left time: 614.6231s
	iters: 200, epoch: 40 | loss: 0.0769260
	speed: 0.0219s/iter; left time: 293.7609s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0827674 Vali Loss: 0.0825134 Test Loss: 0.0881216
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0824871
	speed: 0.0450s/iter; left time: 597.6093s
	iters: 200, epoch: 41 | loss: 0.0781540
	speed: 0.0219s/iter; left time: 288.6634s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0825981 Vali Loss: 0.0824952 Test Loss: 0.0882609
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0817961
	speed: 0.0454s/iter; left time: 592.5179s
	iters: 200, epoch: 42 | loss: 0.0831403
	speed: 0.0219s/iter; left time: 284.1682s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0826483 Vali Loss: 0.0823805 Test Loss: 0.0882437
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0845329
	speed: 0.0462s/iter; left time: 593.2627s
	iters: 200, epoch: 43 | loss: 0.0830000
	speed: 0.0219s/iter; left time: 279.4649s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0826157 Vali Loss: 0.0824634 Test Loss: 0.0882632
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0831473
	speed: 0.0464s/iter; left time: 585.6305s
	iters: 200, epoch: 44 | loss: 0.0868006
	speed: 0.0219s/iter; left time: 273.6515s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0826969 Vali Loss: 0.0823577 Test Loss: 0.0882242
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0828054
	speed: 0.0449s/iter; left time: 556.0483s
	iters: 200, epoch: 45 | loss: 0.0823779
	speed: 0.0219s/iter; left time: 268.7185s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0826836 Vali Loss: 0.0823471 Test Loss: 0.0883763
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0206295233219862, rmse:0.14362981915473938, mae:0.08833886682987213, rse:0.5435844659805298
Intermediate time for IT and pred_len 168: 00h:13m:21.76s
Intermediate time for IT: 00h:39m:05.36s
Total time: 09h:18m:02.20s
