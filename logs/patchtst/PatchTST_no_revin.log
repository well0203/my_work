
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2566070
	speed: 0.0532s/iter; left time: 1186.9556s
	iters: 200, epoch: 1 | loss: 0.2419528
	speed: 0.0264s/iter; left time: 586.3910s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.43s
Steps: 224 | Train Loss: 0.2636380 Vali Loss: 0.2222575 Test Loss: 0.2204070
Validation loss decreased (inf --> 0.222257).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1490381
	speed: 0.0511s/iter; left time: 1127.0547s
	iters: 200, epoch: 2 | loss: 0.1197937
	speed: 0.0264s/iter; left time: 580.8670s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.1535841 Vali Loss: 0.1151092 Test Loss: 0.1171536
Validation loss decreased (0.222257 --> 0.115109).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1010839
	speed: 0.0512s/iter; left time: 1118.3096s
	iters: 200, epoch: 3 | loss: 0.0979355
	speed: 0.0265s/iter; left time: 575.5686s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.1034884 Vali Loss: 0.1062425 Test Loss: 0.1076204
Validation loss decreased (0.115109 --> 0.106242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0974420
	speed: 0.0511s/iter; left time: 1105.8981s
	iters: 200, epoch: 4 | loss: 0.0977694
	speed: 0.0264s/iter; left time: 568.3734s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0933482 Vali Loss: 0.0992072 Test Loss: 0.1010505
Validation loss decreased (0.106242 --> 0.099207).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0909457
	speed: 0.0501s/iter; left time: 1071.7958s
	iters: 200, epoch: 5 | loss: 0.0860357
	speed: 0.0267s/iter; left time: 568.7304s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0887532 Vali Loss: 0.0971549 Test Loss: 0.0991021
Validation loss decreased (0.099207 --> 0.097155).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0950104
	speed: 0.0508s/iter; left time: 1075.6494s
	iters: 200, epoch: 6 | loss: 0.0841039
	speed: 0.0266s/iter; left time: 560.7301s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0859246 Vali Loss: 0.0970220 Test Loss: 0.0979300
Validation loss decreased (0.097155 --> 0.097022).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0830651
	speed: 0.0506s/iter; left time: 1060.1059s
	iters: 200, epoch: 7 | loss: 0.0861730
	speed: 0.0266s/iter; left time: 554.3986s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0841975 Vali Loss: 0.0949431 Test Loss: 0.0963822
Validation loss decreased (0.097022 --> 0.094943).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0834699
	speed: 0.0510s/iter; left time: 1058.0602s
	iters: 200, epoch: 8 | loss: 0.0826666
	speed: 0.0266s/iter; left time: 549.6483s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0832470 Vali Loss: 0.0940332 Test Loss: 0.0951022
Validation loss decreased (0.094943 --> 0.094033).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0867406
	speed: 0.0510s/iter; left time: 1046.0574s
	iters: 200, epoch: 9 | loss: 0.0859180
	speed: 0.0269s/iter; left time: 549.8397s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0822038 Vali Loss: 0.0939286 Test Loss: 0.0947163
Validation loss decreased (0.094033 --> 0.093929).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0839390
	speed: 0.0511s/iter; left time: 1037.1268s
	iters: 200, epoch: 10 | loss: 0.0786523
	speed: 0.0266s/iter; left time: 536.8034s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0808735 Vali Loss: 0.0932474 Test Loss: 0.0947599
Validation loss decreased (0.093929 --> 0.093247).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0754465
	speed: 0.0522s/iter; left time: 1047.4553s
	iters: 200, epoch: 11 | loss: 0.0798902
	speed: 0.0272s/iter; left time: 542.5924s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0805028 Vali Loss: 0.0930160 Test Loss: 0.0942361
Validation loss decreased (0.093247 --> 0.093016).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0777061
	speed: 0.0515s/iter; left time: 1021.7330s
	iters: 200, epoch: 12 | loss: 0.0808789
	speed: 0.0265s/iter; left time: 523.4146s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0801001 Vali Loss: 0.0921757 Test Loss: 0.0932652
Validation loss decreased (0.093016 --> 0.092176).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0751510
	speed: 0.0514s/iter; left time: 1008.9151s
	iters: 200, epoch: 13 | loss: 0.0770847
	speed: 0.0265s/iter; left time: 517.7729s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0791738 Vali Loss: 0.0924514 Test Loss: 0.0932204
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0782727
	speed: 0.0501s/iter; left time: 971.1566s
	iters: 200, epoch: 14 | loss: 0.0786983
	speed: 0.0265s/iter; left time: 511.0841s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0787759 Vali Loss: 0.0920219 Test Loss: 0.0935162
Validation loss decreased (0.092176 --> 0.092022).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0777310
	speed: 0.0506s/iter; left time: 968.8588s
	iters: 200, epoch: 15 | loss: 0.0735414
	speed: 0.0265s/iter; left time: 504.8558s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0786300 Vali Loss: 0.0917478 Test Loss: 0.0926336
Validation loss decreased (0.092022 --> 0.091748).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0785231
	speed: 0.0516s/iter; left time: 976.5916s
	iters: 200, epoch: 16 | loss: 0.0768834
	speed: 0.0268s/iter; left time: 504.5949s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0784725 Vali Loss: 0.0918264 Test Loss: 0.0926172
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0798664
	speed: 0.0509s/iter; left time: 952.5160s
	iters: 200, epoch: 17 | loss: 0.0797044
	speed: 0.0267s/iter; left time: 496.1904s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0783037 Vali Loss: 0.0910420 Test Loss: 0.0925358
Validation loss decreased (0.091748 --> 0.091042).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0781114
	speed: 0.0517s/iter; left time: 956.2847s
	iters: 200, epoch: 18 | loss: 0.0855012
	speed: 0.0267s/iter; left time: 490.2361s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0779318 Vali Loss: 0.0907866 Test Loss: 0.0921505
Validation loss decreased (0.091042 --> 0.090787).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0735422
	speed: 0.0510s/iter; left time: 931.0906s
	iters: 200, epoch: 19 | loss: 0.0740805
	speed: 0.0262s/iter; left time: 476.3598s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0774609 Vali Loss: 0.0919343 Test Loss: 0.0928579
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0746833
	speed: 0.0508s/iter; left time: 916.9543s
	iters: 200, epoch: 20 | loss: 0.0807188
	speed: 0.0265s/iter; left time: 475.6114s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0773912 Vali Loss: 0.0916482 Test Loss: 0.0923388
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0721470
	speed: 0.0507s/iter; left time: 903.8251s
	iters: 200, epoch: 21 | loss: 0.0779014
	speed: 0.0264s/iter; left time: 467.6491s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0773700 Vali Loss: 0.0906744 Test Loss: 0.0923040
Validation loss decreased (0.090787 --> 0.090674).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0702513
	speed: 0.0505s/iter; left time: 889.1419s
	iters: 200, epoch: 22 | loss: 0.0733673
	speed: 0.0265s/iter; left time: 462.8013s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0772820 Vali Loss: 0.0907303 Test Loss: 0.0918452
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0767162
	speed: 0.0503s/iter; left time: 873.2458s
	iters: 200, epoch: 23 | loss: 0.0720851
	speed: 0.0266s/iter; left time: 459.2972s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0770278 Vali Loss: 0.0907926 Test Loss: 0.0918527
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0754888
	speed: 0.0506s/iter; left time: 866.9338s
	iters: 200, epoch: 24 | loss: 0.0748333
	speed: 0.0270s/iter; left time: 459.6732s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0768529 Vali Loss: 0.0908272 Test Loss: 0.0918088
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0754161
	speed: 0.0507s/iter; left time: 858.4506s
	iters: 200, epoch: 25 | loss: 0.0849064
	speed: 0.0265s/iter; left time: 445.5056s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0768403 Vali Loss: 0.0907090 Test Loss: 0.0916022
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0744077
	speed: 0.0504s/iter; left time: 841.0716s
	iters: 200, epoch: 26 | loss: 0.0762815
	speed: 0.0262s/iter; left time: 435.3680s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.05s
Steps: 224 | Train Loss: 0.0767571 Vali Loss: 0.0906516 Test Loss: 0.0917031
Validation loss decreased (0.090674 --> 0.090652).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0812616
	speed: 0.0512s/iter; left time: 843.3900s
	iters: 200, epoch: 27 | loss: 0.0799414
	speed: 0.0267s/iter; left time: 436.5331s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0765723 Vali Loss: 0.0903748 Test Loss: 0.0915898
Validation loss decreased (0.090652 --> 0.090375).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0726214
	speed: 0.0505s/iter; left time: 820.6343s
	iters: 200, epoch: 28 | loss: 0.0789795
	speed: 0.0265s/iter; left time: 427.3477s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0765280 Vali Loss: 0.0905175 Test Loss: 0.0916367
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0772127
	speed: 0.0508s/iter; left time: 814.9108s
	iters: 200, epoch: 29 | loss: 0.0697870
	speed: 0.0263s/iter; left time: 418.8013s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0765321 Vali Loss: 0.0904983 Test Loss: 0.0915829
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0811062
	speed: 0.0504s/iter; left time: 796.4451s
	iters: 200, epoch: 30 | loss: 0.0780678
	speed: 0.0266s/iter; left time: 418.0783s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0765154 Vali Loss: 0.0902160 Test Loss: 0.0915959
Validation loss decreased (0.090375 --> 0.090216).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0766579
	speed: 0.0504s/iter; left time: 785.6363s
	iters: 200, epoch: 31 | loss: 0.0730054
	speed: 0.0264s/iter; left time: 408.5233s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0764262 Vali Loss: 0.0905278 Test Loss: 0.0917065
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0711051
	speed: 0.0503s/iter; left time: 772.1789s
	iters: 200, epoch: 32 | loss: 0.0803683
	speed: 0.0264s/iter; left time: 402.9564s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0763533 Vali Loss: 0.0901207 Test Loss: 0.0914401
Validation loss decreased (0.090216 --> 0.090121).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0823469
	speed: 0.0512s/iter; left time: 775.0922s
	iters: 200, epoch: 33 | loss: 0.0713614
	speed: 0.0263s/iter; left time: 394.9717s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0763147 Vali Loss: 0.0905146 Test Loss: 0.0916492
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0752804
	speed: 0.0506s/iter; left time: 754.7313s
	iters: 200, epoch: 34 | loss: 0.0791326
	speed: 0.0265s/iter; left time: 392.0304s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0762617 Vali Loss: 0.0903647 Test Loss: 0.0914449
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0792777
	speed: 0.0506s/iter; left time: 742.4060s
	iters: 200, epoch: 35 | loss: 0.0719633
	speed: 0.0266s/iter; left time: 388.5645s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0761660 Vali Loss: 0.0903345 Test Loss: 0.0914848
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0769392
	speed: 0.0510s/iter; left time: 737.3572s
	iters: 200, epoch: 36 | loss: 0.0812033
	speed: 0.0266s/iter; left time: 381.4199s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0762252 Vali Loss: 0.0910000 Test Loss: 0.0918637
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0839674
	speed: 0.0504s/iter; left time: 717.6566s
	iters: 200, epoch: 37 | loss: 0.0782146
	speed: 0.0265s/iter; left time: 375.0487s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0761717 Vali Loss: 0.0904660 Test Loss: 0.0915176
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0749981
	speed: 0.0511s/iter; left time: 715.5154s
	iters: 200, epoch: 38 | loss: 0.0715419
	speed: 0.0269s/iter; left time: 374.4998s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0761763 Vali Loss: 0.0906010 Test Loss: 0.0916540
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0792945
	speed: 0.0503s/iter; left time: 694.0618s
	iters: 200, epoch: 39 | loss: 0.0729343
	speed: 0.0268s/iter; left time: 366.8243s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0762594 Vali Loss: 0.0901306 Test Loss: 0.0913918
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0725834
	speed: 0.0503s/iter; left time: 681.7558s
	iters: 200, epoch: 40 | loss: 0.0821638
	speed: 0.0265s/iter; left time: 357.4303s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0761080 Vali Loss: 0.0901505 Test Loss: 0.0913605
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0714317
	speed: 0.0510s/iter; left time: 681.0408s
	iters: 200, epoch: 41 | loss: 0.0747623
	speed: 0.0267s/iter; left time: 353.4224s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0761157 Vali Loss: 0.0900619 Test Loss: 0.0915041
Validation loss decreased (0.090121 --> 0.090062).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0739755
	speed: 0.0516s/iter; left time: 677.1821s
	iters: 200, epoch: 42 | loss: 0.0810414
	speed: 0.0268s/iter; left time: 348.5688s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0761380 Vali Loss: 0.0903147 Test Loss: 0.0914038
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0811172
	speed: 0.0507s/iter; left time: 653.3830s
	iters: 200, epoch: 43 | loss: 0.0779029
	speed: 0.0265s/iter; left time: 339.2456s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0760796 Vali Loss: 0.0902422 Test Loss: 0.0914716
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0723317
	speed: 0.0508s/iter; left time: 643.8286s
	iters: 200, epoch: 44 | loss: 0.0762026
	speed: 0.0266s/iter; left time: 334.4649s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0759945 Vali Loss: 0.0902213 Test Loss: 0.0914703
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0768227
	speed: 0.0508s/iter; left time: 631.6453s
	iters: 200, epoch: 45 | loss: 0.0778465
	speed: 0.0265s/iter; left time: 327.6660s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0760749 Vali Loss: 0.0902847 Test Loss: 0.0914034
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0757674
	speed: 0.0499s/iter; left time: 610.1826s
	iters: 200, epoch: 46 | loss: 0.0817664
	speed: 0.0267s/iter; left time: 323.4300s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0760586 Vali Loss: 0.0901711 Test Loss: 0.0912951
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0757344
	speed: 0.0508s/iter; left time: 610.0356s
	iters: 200, epoch: 47 | loss: 0.0739751
	speed: 0.0266s/iter; left time: 316.8831s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0760620 Vali Loss: 0.0903189 Test Loss: 0.0914689
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0769868
	speed: 0.0509s/iter; left time: 598.9188s
	iters: 200, epoch: 48 | loss: 0.0761500
	speed: 0.0264s/iter; left time: 308.1511s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0760214 Vali Loss: 0.0901692 Test Loss: 0.0913794
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0779364
	speed: 0.0509s/iter; left time: 587.8916s
	iters: 200, epoch: 49 | loss: 0.0800145
	speed: 0.0266s/iter; left time: 304.3929s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0760802 Vali Loss: 0.0900943 Test Loss: 0.0913661
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0724418
	speed: 0.0508s/iter; left time: 574.8073s
	iters: 200, epoch: 50 | loss: 0.0738002
	speed: 0.0264s/iter; left time: 296.2975s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0759310 Vali Loss: 0.0905732 Test Loss: 0.0915211
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0714924
	speed: 0.0506s/iter; left time: 561.2670s
	iters: 200, epoch: 51 | loss: 0.0791853
	speed: 0.0264s/iter; left time: 290.7496s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0759803 Vali Loss: 0.0902920 Test Loss: 0.0913586
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021748371422290802, rmse:0.1474732905626297, mae:0.0915040671825409, rse:0.5204536318778992
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2623934
	speed: 0.0291s/iter; left time: 648.2670s
	iters: 200, epoch: 1 | loss: 0.2396158
	speed: 0.0265s/iter; left time: 588.2434s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.2633231 Vali Loss: 0.2145368 Test Loss: 0.2137502
Validation loss decreased (inf --> 0.214537).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1374790
	speed: 0.0520s/iter; left time: 1148.1994s
	iters: 200, epoch: 2 | loss: 0.1093387
	speed: 0.0265s/iter; left time: 581.7916s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.1501679 Vali Loss: 0.1194519 Test Loss: 0.1199035
Validation loss decreased (0.214537 --> 0.119452).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0990194
	speed: 0.0511s/iter; left time: 1117.7147s
	iters: 200, epoch: 3 | loss: 0.1039781
	speed: 0.0265s/iter; left time: 575.7345s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.1039293 Vali Loss: 0.1051352 Test Loss: 0.1071176
Validation loss decreased (0.119452 --> 0.105135).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0944413
	speed: 0.0514s/iter; left time: 1111.5284s
	iters: 200, epoch: 4 | loss: 0.0901303
	speed: 0.0264s/iter; left time: 568.8120s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0936006 Vali Loss: 0.0998318 Test Loss: 0.1013047
Validation loss decreased (0.105135 --> 0.099832).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0877668
	speed: 0.0514s/iter; left time: 1101.2320s
	iters: 200, epoch: 5 | loss: 0.0928216
	speed: 0.0265s/iter; left time: 563.5568s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0888237 Vali Loss: 0.0964812 Test Loss: 0.0980058
Validation loss decreased (0.099832 --> 0.096481).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0847580
	speed: 0.0513s/iter; left time: 1087.4706s
	iters: 200, epoch: 6 | loss: 0.0826628
	speed: 0.0264s/iter; left time: 556.1620s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0858948 Vali Loss: 0.0959795 Test Loss: 0.0970195
Validation loss decreased (0.096481 --> 0.095980).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0905109
	speed: 0.0516s/iter; left time: 1081.4807s
	iters: 200, epoch: 7 | loss: 0.0828156
	speed: 0.0264s/iter; left time: 550.7738s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0842266 Vali Loss: 0.0946363 Test Loss: 0.0962865
Validation loss decreased (0.095980 --> 0.094636).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0775391
	speed: 0.0514s/iter; left time: 1065.6817s
	iters: 200, epoch: 8 | loss: 0.0855141
	speed: 0.0264s/iter; left time: 545.3546s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0828761 Vali Loss: 0.0938537 Test Loss: 0.0953314
Validation loss decreased (0.094636 --> 0.093854).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0816690
	speed: 0.0519s/iter; left time: 1064.9083s
	iters: 200, epoch: 9 | loss: 0.0851879
	speed: 0.0267s/iter; left time: 545.1764s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0829858 Vali Loss: 0.0947143 Test Loss: 0.0958647
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0823175
	speed: 0.0513s/iter; left time: 1040.4598s
	iters: 200, epoch: 10 | loss: 0.0796459
	speed: 0.0264s/iter; left time: 532.9212s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0809271 Vali Loss: 0.0935037 Test Loss: 0.0946443
Validation loss decreased (0.093854 --> 0.093504).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0768127
	speed: 0.0516s/iter; left time: 1034.3691s
	iters: 200, epoch: 11 | loss: 0.0761531
	speed: 0.0266s/iter; left time: 530.2924s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0801934 Vali Loss: 0.0916781 Test Loss: 0.0932157
Validation loss decreased (0.093504 --> 0.091678).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0837837
	speed: 0.0517s/iter; left time: 1025.0865s
	iters: 200, epoch: 12 | loss: 0.0775089
	speed: 0.0265s/iter; left time: 522.8158s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0802700 Vali Loss: 0.0934207 Test Loss: 0.0943639
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0784073
	speed: 0.0514s/iter; left time: 1007.9049s
	iters: 200, epoch: 13 | loss: 0.0782698
	speed: 0.0264s/iter; left time: 514.9457s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0792549 Vali Loss: 0.0911230 Test Loss: 0.0926930
Validation loss decreased (0.091678 --> 0.091123).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0733982
	speed: 0.0516s/iter; left time: 999.9662s
	iters: 200, epoch: 14 | loss: 0.0791362
	speed: 0.0268s/iter; left time: 516.1016s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0786626 Vali Loss: 0.0918051 Test Loss: 0.0929869
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0759531
	speed: 0.0511s/iter; left time: 979.1617s
	iters: 200, epoch: 15 | loss: 0.0776807
	speed: 0.0263s/iter; left time: 502.1820s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0783810 Vali Loss: 0.0908538 Test Loss: 0.0923476
Validation loss decreased (0.091123 --> 0.090854).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0793302
	speed: 0.0515s/iter; left time: 975.7433s
	iters: 200, epoch: 16 | loss: 0.0803491
	speed: 0.0265s/iter; left time: 499.1765s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0782527 Vali Loss: 0.0906397 Test Loss: 0.0923295
Validation loss decreased (0.090854 --> 0.090640).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0744852
	speed: 0.0509s/iter; left time: 953.1146s
	iters: 200, epoch: 17 | loss: 0.0786489
	speed: 0.0264s/iter; left time: 491.1716s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0779015 Vali Loss: 0.0903674 Test Loss: 0.0920459
Validation loss decreased (0.090640 --> 0.090367).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0812337
	speed: 0.0517s/iter; left time: 956.0485s
	iters: 200, epoch: 18 | loss: 0.0783246
	speed: 0.0265s/iter; left time: 486.8890s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0775950 Vali Loss: 0.0926962 Test Loss: 0.0936254
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0784258
	speed: 0.0518s/iter; left time: 945.8514s
	iters: 200, epoch: 19 | loss: 0.0762034
	speed: 0.0265s/iter; left time: 480.8397s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0777468 Vali Loss: 0.0910056 Test Loss: 0.0922556
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0757184
	speed: 0.0525s/iter; left time: 947.1240s
	iters: 200, epoch: 20 | loss: 0.0782048
	speed: 0.0265s/iter; left time: 475.6223s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0774940 Vali Loss: 0.0901802 Test Loss: 0.0919014
Validation loss decreased (0.090367 --> 0.090180).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0752977
	speed: 0.0519s/iter; left time: 924.6541s
	iters: 200, epoch: 21 | loss: 0.0739630
	speed: 0.0264s/iter; left time: 467.5208s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0772572 Vali Loss: 0.0915566 Test Loss: 0.0928652
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0792587
	speed: 0.0519s/iter; left time: 912.7213s
	iters: 200, epoch: 22 | loss: 0.0784705
	speed: 0.0269s/iter; left time: 469.9750s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0769730 Vali Loss: 0.0908989 Test Loss: 0.0921991
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0772055
	speed: 0.0516s/iter; left time: 896.0212s
	iters: 200, epoch: 23 | loss: 0.0812640
	speed: 0.0264s/iter; left time: 456.3482s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0770093 Vali Loss: 0.0900116 Test Loss: 0.0918345
Validation loss decreased (0.090180 --> 0.090012).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0803091
	speed: 0.0508s/iter; left time: 871.6293s
	iters: 200, epoch: 24 | loss: 0.0759364
	speed: 0.0264s/iter; left time: 449.8751s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0770596 Vali Loss: 0.0899609 Test Loss: 0.0916573
Validation loss decreased (0.090012 --> 0.089961).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0758617
	speed: 0.0517s/iter; left time: 874.5700s
	iters: 200, epoch: 25 | loss: 0.0737996
	speed: 0.0269s/iter; left time: 452.7037s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0769033 Vali Loss: 0.0899511 Test Loss: 0.0915681
Validation loss decreased (0.089961 --> 0.089951).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0765661
	speed: 0.0522s/iter; left time: 872.2105s
	iters: 200, epoch: 26 | loss: 0.0763971
	speed: 0.0264s/iter; left time: 437.5066s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0765872 Vali Loss: 0.0900413 Test Loss: 0.0916204
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0758144
	speed: 0.0518s/iter; left time: 853.8591s
	iters: 200, epoch: 27 | loss: 0.0757976
	speed: 0.0270s/iter; left time: 442.6177s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0764685 Vali Loss: 0.0906311 Test Loss: 0.0921329
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0758253
	speed: 0.0508s/iter; left time: 825.5056s
	iters: 200, epoch: 28 | loss: 0.0753282
	speed: 0.0262s/iter; left time: 423.2454s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.05s
Steps: 224 | Train Loss: 0.0765909 Vali Loss: 0.0898152 Test Loss: 0.0914769
Validation loss decreased (0.089951 --> 0.089815).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0749874
	speed: 0.0516s/iter; left time: 827.0840s
	iters: 200, epoch: 29 | loss: 0.0735045
	speed: 0.0263s/iter; left time: 419.1765s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0764512 Vali Loss: 0.0897418 Test Loss: 0.0915002
Validation loss decreased (0.089815 --> 0.089742).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0812473
	speed: 0.0509s/iter; left time: 803.7272s
	iters: 200, epoch: 30 | loss: 0.0751119
	speed: 0.0265s/iter; left time: 416.2900s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0764347 Vali Loss: 0.0904919 Test Loss: 0.0919945
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0783717
	speed: 0.0511s/iter; left time: 796.6079s
	iters: 200, epoch: 31 | loss: 0.0838023
	speed: 0.0263s/iter; left time: 407.2658s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0763518 Vali Loss: 0.0900647 Test Loss: 0.0916321
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0714996
	speed: 0.0508s/iter; left time: 780.8560s
	iters: 200, epoch: 32 | loss: 0.0752642
	speed: 0.0265s/iter; left time: 404.2121s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0763182 Vali Loss: 0.0899387 Test Loss: 0.0916039
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0770082
	speed: 0.0517s/iter; left time: 782.5797s
	iters: 200, epoch: 33 | loss: 0.0753402
	speed: 0.0264s/iter; left time: 396.9559s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0762349 Vali Loss: 0.0896231 Test Loss: 0.0914508
Validation loss decreased (0.089742 --> 0.089623).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0725115
	speed: 0.0518s/iter; left time: 771.5771s
	iters: 200, epoch: 34 | loss: 0.0776233
	speed: 0.0264s/iter; left time: 391.3439s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0762119 Vali Loss: 0.0895975 Test Loss: 0.0913485
Validation loss decreased (0.089623 --> 0.089597).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0771235
	speed: 0.0512s/iter; left time: 751.4118s
	iters: 200, epoch: 35 | loss: 0.0781061
	speed: 0.0264s/iter; left time: 384.9643s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0761741 Vali Loss: 0.0895915 Test Loss: 0.0913442
Validation loss decreased (0.089597 --> 0.089591).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0696032
	speed: 0.0512s/iter; left time: 739.9131s
	iters: 200, epoch: 36 | loss: 0.0770035
	speed: 0.0264s/iter; left time: 379.4754s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0760867 Vali Loss: 0.0900567 Test Loss: 0.0917049
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0778791
	speed: 0.0505s/iter; left time: 719.5481s
	iters: 200, epoch: 37 | loss: 0.0745140
	speed: 0.0264s/iter; left time: 372.6496s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0762562 Vali Loss: 0.0897121 Test Loss: 0.0913620
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0783371
	speed: 0.0511s/iter; left time: 716.0441s
	iters: 200, epoch: 38 | loss: 0.0818648
	speed: 0.0266s/iter; left time: 369.9822s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0761213 Vali Loss: 0.0900666 Test Loss: 0.0917065
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0803079
	speed: 0.0518s/iter; left time: 714.8789s
	iters: 200, epoch: 39 | loss: 0.0745575
	speed: 0.0266s/iter; left time: 364.5465s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0760805 Vali Loss: 0.0901203 Test Loss: 0.0916768
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0744408
	speed: 0.0513s/iter; left time: 696.1614s
	iters: 200, epoch: 40 | loss: 0.0698902
	speed: 0.0268s/iter; left time: 360.7493s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0760944 Vali Loss: 0.0897818 Test Loss: 0.0915024
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0756303
	speed: 0.0514s/iter; left time: 685.3262s
	iters: 200, epoch: 41 | loss: 0.0757952
	speed: 0.0264s/iter; left time: 349.6103s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0760046 Vali Loss: 0.0898426 Test Loss: 0.0915377
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0779208
	speed: 0.0510s/iter; left time: 669.5759s
	iters: 200, epoch: 42 | loss: 0.0747404
	speed: 0.0265s/iter; left time: 345.2799s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0761344 Vali Loss: 0.0901287 Test Loss: 0.0917811
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0771934
	speed: 0.0508s/iter; left time: 654.6272s
	iters: 200, epoch: 43 | loss: 0.0749607
	speed: 0.0264s/iter; left time: 337.6077s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0759900 Vali Loss: 0.0897255 Test Loss: 0.0914727
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0743435
	speed: 0.0510s/iter; left time: 646.1299s
	iters: 200, epoch: 44 | loss: 0.0800619
	speed: 0.0264s/iter; left time: 331.9518s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0760069 Vali Loss: 0.0894995 Test Loss: 0.0912929
Validation loss decreased (0.089591 --> 0.089500).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0732608
	speed: 0.0514s/iter; left time: 639.3487s
	iters: 200, epoch: 45 | loss: 0.0766907
	speed: 0.0264s/iter; left time: 325.9549s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0759964 Vali Loss: 0.0898933 Test Loss: 0.0914188
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0741571
	speed: 0.0508s/iter; left time: 620.4704s
	iters: 200, epoch: 46 | loss: 0.0754467
	speed: 0.0264s/iter; left time: 319.8579s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0760600 Vali Loss: 0.0897355 Test Loss: 0.0913146
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0713772
	speed: 0.0511s/iter; left time: 612.7077s
	iters: 200, epoch: 47 | loss: 0.0743333
	speed: 0.0264s/iter; left time: 314.0654s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0758811 Vali Loss: 0.0899609 Test Loss: 0.0915293
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0764152
	speed: 0.0508s/iter; left time: 598.5441s
	iters: 200, epoch: 48 | loss: 0.0770819
	speed: 0.0263s/iter; left time: 307.4708s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0759072 Vali Loss: 0.0899988 Test Loss: 0.0916863
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0743392
	speed: 0.0514s/iter; left time: 593.3161s
	iters: 200, epoch: 49 | loss: 0.0781718
	speed: 0.0264s/iter; left time: 302.1229s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0759080 Vali Loss: 0.0899594 Test Loss: 0.0915774
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0756658
	speed: 0.0515s/iter; left time: 582.9967s
	iters: 200, epoch: 50 | loss: 0.0756160
	speed: 0.0265s/iter; left time: 297.6079s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0759219 Vali Loss: 0.0898047 Test Loss: 0.0914517
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0815681
	speed: 0.0510s/iter; left time: 565.7757s
	iters: 200, epoch: 51 | loss: 0.0765514
	speed: 0.0268s/iter; left time: 294.2899s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0759615 Vali Loss: 0.0896021 Test Loss: 0.0913982
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0764843
	speed: 0.0508s/iter; left time: 552.8893s
	iters: 200, epoch: 52 | loss: 0.0764052
	speed: 0.0263s/iter; left time: 283.6687s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0758922 Vali Loss: 0.0901767 Test Loss: 0.0917404
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0747740
	speed: 0.0511s/iter; left time: 544.3491s
	iters: 200, epoch: 53 | loss: 0.0760180
	speed: 0.0266s/iter; left time: 280.7264s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0758861 Vali Loss: 0.0898443 Test Loss: 0.0914755
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0749051
	speed: 0.0508s/iter; left time: 529.6588s
	iters: 200, epoch: 54 | loss: 0.0723748
	speed: 0.0263s/iter; left time: 271.8668s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0758602 Vali Loss: 0.0899249 Test Loss: 0.0915471
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021651936694979668, rmse:0.14714597165584564, mae:0.09129294008016586, rse:0.5192984938621521
Intermediate time for DE and pred_len 24: 00h:13m:47.28s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2630768
	speed: 0.0542s/iter; left time: 1207.9141s
	iters: 200, epoch: 1 | loss: 0.2523208
	speed: 0.0267s/iter; left time: 592.7196s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.51s
Steps: 224 | Train Loss: 0.2658288 Vali Loss: 0.2251827 Test Loss: 0.2259640
Validation loss decreased (inf --> 0.225183).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1566545
	speed: 0.0547s/iter; left time: 1206.5166s
	iters: 200, epoch: 2 | loss: 0.1344758
	speed: 0.0270s/iter; left time: 594.4068s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.1630470 Vali Loss: 0.1419773 Test Loss: 0.1463934
Validation loss decreased (0.225183 --> 0.141977).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1215972
	speed: 0.0547s/iter; left time: 1195.0206s
	iters: 200, epoch: 3 | loss: 0.1200278
	speed: 0.0271s/iter; left time: 588.4833s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.1237614 Vali Loss: 0.1315045 Test Loss: 0.1411074
Validation loss decreased (0.141977 --> 0.131504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1162965
	speed: 0.0543s/iter; left time: 1175.0955s
	iters: 200, epoch: 4 | loss: 0.1118230
	speed: 0.0268s/iter; left time: 577.1557s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1159266 Vali Loss: 0.1265297 Test Loss: 0.1361486
Validation loss decreased (0.131504 --> 0.126530).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1119742
	speed: 0.0548s/iter; left time: 1172.4131s
	iters: 200, epoch: 5 | loss: 0.1024615
	speed: 0.0272s/iter; left time: 578.9377s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.1114667 Vali Loss: 0.1237297 Test Loss: 0.1319537
Validation loss decreased (0.126530 --> 0.123730).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1169698
	speed: 0.0545s/iter; left time: 1154.8920s
	iters: 200, epoch: 6 | loss: 0.1130258
	speed: 0.0269s/iter; left time: 567.5599s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.1092667 Vali Loss: 0.1252045 Test Loss: 0.1344381
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1088223
	speed: 0.0541s/iter; left time: 1134.3021s
	iters: 200, epoch: 7 | loss: 0.1025394
	speed: 0.0268s/iter; left time: 559.1629s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1081086 Vali Loss: 0.1233292 Test Loss: 0.1324626
Validation loss decreased (0.123730 --> 0.123329).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1078237
	speed: 0.0539s/iter; left time: 1117.8815s
	iters: 200, epoch: 8 | loss: 0.1050049
	speed: 0.0269s/iter; left time: 554.2000s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1069662 Vali Loss: 0.1241076 Test Loss: 0.1364119
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1043864
	speed: 0.0536s/iter; left time: 1099.1176s
	iters: 200, epoch: 9 | loss: 0.1087614
	speed: 0.0268s/iter; left time: 546.2300s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1064280 Vali Loss: 0.1238246 Test Loss: 0.1345607
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1045793
	speed: 0.0534s/iter; left time: 1083.4344s
	iters: 200, epoch: 10 | loss: 0.1018358
	speed: 0.0268s/iter; left time: 540.9044s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1057379 Vali Loss: 0.1222734 Test Loss: 0.1342183
Validation loss decreased (0.123329 --> 0.122273).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1041998
	speed: 0.0544s/iter; left time: 1091.7696s
	iters: 200, epoch: 11 | loss: 0.1064309
	speed: 0.0268s/iter; left time: 535.0045s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1052918 Vali Loss: 0.1218130 Test Loss: 0.1341903
Validation loss decreased (0.122273 --> 0.121813).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1075441
	speed: 0.0550s/iter; left time: 1091.1220s
	iters: 200, epoch: 12 | loss: 0.1031930
	speed: 0.0268s/iter; left time: 529.7916s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.1050196 Vali Loss: 0.1237139 Test Loss: 0.1364160
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1033154
	speed: 0.0535s/iter; left time: 1048.3443s
	iters: 200, epoch: 13 | loss: 0.1055321
	speed: 0.0268s/iter; left time: 523.5825s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1045794 Vali Loss: 0.1209626 Test Loss: 0.1324102
Validation loss decreased (0.121813 --> 0.120963).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1063844
	speed: 0.0544s/iter; left time: 1054.4512s
	iters: 200, epoch: 14 | loss: 0.0993380
	speed: 0.0268s/iter; left time: 517.4790s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1041206 Vali Loss: 0.1223020 Test Loss: 0.1336385
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1000154
	speed: 0.0545s/iter; left time: 1045.2792s
	iters: 200, epoch: 15 | loss: 0.1074960
	speed: 0.0268s/iter; left time: 510.1996s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.36s
Steps: 224 | Train Loss: 0.1039088 Vali Loss: 0.1211749 Test Loss: 0.1334180
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1062298
	speed: 0.0543s/iter; left time: 1029.3910s
	iters: 200, epoch: 16 | loss: 0.1089683
	speed: 0.0268s/iter; left time: 505.5662s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1037323 Vali Loss: 0.1214976 Test Loss: 0.1345197
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1044505
	speed: 0.0540s/iter; left time: 1010.1687s
	iters: 200, epoch: 17 | loss: 0.1032697
	speed: 0.0269s/iter; left time: 500.6301s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1033718 Vali Loss: 0.1213387 Test Loss: 0.1326196
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1037102
	speed: 0.0536s/iter; left time: 992.0721s
	iters: 200, epoch: 18 | loss: 0.0965601
	speed: 0.0268s/iter; left time: 493.5536s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1032211 Vali Loss: 0.1220027 Test Loss: 0.1338869
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1047857
	speed: 0.0533s/iter; left time: 973.6991s
	iters: 200, epoch: 19 | loss: 0.1013042
	speed: 0.0266s/iter; left time: 482.8955s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1032059 Vali Loss: 0.1214463 Test Loss: 0.1339297
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1024989
	speed: 0.0530s/iter; left time: 956.8924s
	iters: 200, epoch: 20 | loss: 0.1063105
	speed: 0.0268s/iter; left time: 480.9085s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1028468 Vali Loss: 0.1211054 Test Loss: 0.1342192
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1037339
	speed: 0.0536s/iter; left time: 955.2516s
	iters: 200, epoch: 21 | loss: 0.1006454
	speed: 0.0267s/iter; left time: 473.0090s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1026506 Vali Loss: 0.1204992 Test Loss: 0.1325146
Validation loss decreased (0.120963 --> 0.120499).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1000729
	speed: 0.0540s/iter; left time: 950.0677s
	iters: 200, epoch: 22 | loss: 0.1034170
	speed: 0.0268s/iter; left time: 468.4759s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1025371 Vali Loss: 0.1214155 Test Loss: 0.1330793
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1027614
	speed: 0.0540s/iter; left time: 938.3108s
	iters: 200, epoch: 23 | loss: 0.1070890
	speed: 0.0268s/iter; left time: 463.7723s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1025378 Vali Loss: 0.1209115 Test Loss: 0.1327856
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1087525
	speed: 0.0534s/iter; left time: 915.3060s
	iters: 200, epoch: 24 | loss: 0.1019634
	speed: 0.0268s/iter; left time: 456.5884s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1023301 Vali Loss: 0.1208278 Test Loss: 0.1334575
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1021076
	speed: 0.0541s/iter; left time: 916.2209s
	iters: 200, epoch: 25 | loss: 0.0962020
	speed: 0.0268s/iter; left time: 451.0519s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1022461 Vali Loss: 0.1214957 Test Loss: 0.1320013
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1025795
	speed: 0.0538s/iter; left time: 898.0434s
	iters: 200, epoch: 26 | loss: 0.1094282
	speed: 0.0268s/iter; left time: 445.4709s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1022684 Vali Loss: 0.1208365 Test Loss: 0.1331772
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1048568
	speed: 0.0540s/iter; left time: 890.0040s
	iters: 200, epoch: 27 | loss: 0.0978019
	speed: 0.0269s/iter; left time: 440.0567s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.1021241 Vali Loss: 0.1205537 Test Loss: 0.1334286
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1058979
	speed: 0.0539s/iter; left time: 876.0864s
	iters: 200, epoch: 28 | loss: 0.0972636
	speed: 0.0270s/iter; left time: 435.8167s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.1019857 Vali Loss: 0.1211016 Test Loss: 0.1341732
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0994898
	speed: 0.0527s/iter; left time: 844.8960s
	iters: 200, epoch: 29 | loss: 0.1098837
	speed: 0.0266s/iter; left time: 423.9760s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.1019027 Vali Loss: 0.1206129 Test Loss: 0.1327567
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0969293
	speed: 0.0523s/iter; left time: 826.5597s
	iters: 200, epoch: 30 | loss: 0.1035311
	speed: 0.0266s/iter; left time: 417.4073s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.1019406 Vali Loss: 0.1203134 Test Loss: 0.1327153
Validation loss decreased (0.120499 --> 0.120313).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1005189
	speed: 0.0549s/iter; left time: 855.1103s
	iters: 200, epoch: 31 | loss: 0.0965765
	speed: 0.0269s/iter; left time: 416.6207s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.1018233 Vali Loss: 0.1209129 Test Loss: 0.1321092
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1016091
	speed: 0.0541s/iter; left time: 830.5493s
	iters: 200, epoch: 32 | loss: 0.0999834
	speed: 0.0268s/iter; left time: 409.3189s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1017181 Vali Loss: 0.1205590 Test Loss: 0.1335080
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1027758
	speed: 0.0536s/iter; left time: 811.2318s
	iters: 200, epoch: 33 | loss: 0.1013042
	speed: 0.0268s/iter; left time: 403.0957s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1018047 Vali Loss: 0.1199106 Test Loss: 0.1315414
Validation loss decreased (0.120313 --> 0.119911).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.1062437
	speed: 0.0541s/iter; left time: 807.1133s
	iters: 200, epoch: 34 | loss: 0.1017529
	speed: 0.0268s/iter; left time: 397.1693s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.1017372 Vali Loss: 0.1207020 Test Loss: 0.1334199
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0940395
	speed: 0.0539s/iter; left time: 791.9974s
	iters: 200, epoch: 35 | loss: 0.1029754
	speed: 0.0268s/iter; left time: 391.4756s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.1016491 Vali Loss: 0.1203779 Test Loss: 0.1315859
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0991473
	speed: 0.0540s/iter; left time: 780.7937s
	iters: 200, epoch: 36 | loss: 0.0991397
	speed: 0.0275s/iter; left time: 394.4514s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.36s
Steps: 224 | Train Loss: 0.1016296 Vali Loss: 0.1205082 Test Loss: 0.1332344
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.1093032
	speed: 0.0540s/iter; left time: 768.5256s
	iters: 200, epoch: 37 | loss: 0.1040935
	speed: 0.0272s/iter; left time: 384.5511s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.1015898 Vali Loss: 0.1202581 Test Loss: 0.1331425
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.1015609
	speed: 0.0537s/iter; left time: 753.0022s
	iters: 200, epoch: 38 | loss: 0.1085721
	speed: 0.0267s/iter; left time: 371.5794s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1015484 Vali Loss: 0.1200872 Test Loss: 0.1324675
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.1009265
	speed: 0.0540s/iter; left time: 745.0839s
	iters: 200, epoch: 39 | loss: 0.1050294
	speed: 0.0269s/iter; left time: 368.3336s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1014567 Vali Loss: 0.1208096 Test Loss: 0.1335476
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.1040717
	speed: 0.0533s/iter; left time: 722.8202s
	iters: 200, epoch: 40 | loss: 0.1048451
	speed: 0.0268s/iter; left time: 360.2835s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1016315 Vali Loss: 0.1201720 Test Loss: 0.1320668
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.1029412
	speed: 0.0540s/iter; left time: 720.7618s
	iters: 200, epoch: 41 | loss: 0.0981407
	speed: 0.0268s/iter; left time: 355.4190s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.1014452 Vali Loss: 0.1203151 Test Loss: 0.1331452
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.1041843
	speed: 0.0534s/iter; left time: 700.3534s
	iters: 200, epoch: 42 | loss: 0.1030122
	speed: 0.0268s/iter; left time: 348.6079s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1014580 Vali Loss: 0.1201773 Test Loss: 0.1325983
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.1003520
	speed: 0.0534s/iter; left time: 688.5246s
	iters: 200, epoch: 43 | loss: 0.0968324
	speed: 0.0268s/iter; left time: 343.0807s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1014142 Vali Loss: 0.1205596 Test Loss: 0.1329429
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.039896149188280106, rmse:0.1997402012348175, mae:0.131541445851326, rse:0.7073204517364502
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2669973
	speed: 0.0291s/iter; left time: 648.2990s
	iters: 200, epoch: 1 | loss: 0.2499191
	speed: 0.0268s/iter; left time: 594.3812s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.2689866 Vali Loss: 0.2273162 Test Loss: 0.2270883
Validation loss decreased (inf --> 0.227316).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1548644
	speed: 0.0549s/iter; left time: 1212.0782s
	iters: 200, epoch: 2 | loss: 0.1396128
	speed: 0.0272s/iter; left time: 597.6643s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.35s
Steps: 224 | Train Loss: 0.1645374 Vali Loss: 0.1408917 Test Loss: 0.1471085
Validation loss decreased (0.227316 --> 0.140892).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1251144
	speed: 0.0544s/iter; left time: 1189.4396s
	iters: 200, epoch: 3 | loss: 0.1199172
	speed: 0.0268s/iter; left time: 582.5264s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1237215 Vali Loss: 0.1293459 Test Loss: 0.1392646
Validation loss decreased (0.140892 --> 0.129346).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1163457
	speed: 0.0545s/iter; left time: 1179.4749s
	iters: 200, epoch: 4 | loss: 0.1112435
	speed: 0.0268s/iter; left time: 576.4302s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1150312 Vali Loss: 0.1266522 Test Loss: 0.1362955
Validation loss decreased (0.129346 --> 0.126652).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1040357
	speed: 0.0537s/iter; left time: 1148.7079s
	iters: 200, epoch: 5 | loss: 0.1130875
	speed: 0.0268s/iter; left time: 570.1500s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1114461 Vali Loss: 0.1241973 Test Loss: 0.1328583
Validation loss decreased (0.126652 --> 0.124197).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1117986
	speed: 0.0541s/iter; left time: 1146.6777s
	iters: 200, epoch: 6 | loss: 0.1089615
	speed: 0.0266s/iter; left time: 560.8301s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1095231 Vali Loss: 0.1235853 Test Loss: 0.1330164
Validation loss decreased (0.124197 --> 0.123585).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1080385
	speed: 0.0541s/iter; left time: 1132.8421s
	iters: 200, epoch: 7 | loss: 0.1036248
	speed: 0.0266s/iter; left time: 555.7006s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1082786 Vali Loss: 0.1228077 Test Loss: 0.1324385
Validation loss decreased (0.123585 --> 0.122808).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1041789
	speed: 0.0542s/iter; left time: 1124.7235s
	iters: 200, epoch: 8 | loss: 0.1064302
	speed: 0.0268s/iter; left time: 553.7759s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.1075046 Vali Loss: 0.1221856 Test Loss: 0.1321981
Validation loss decreased (0.122808 --> 0.122186).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1060224
	speed: 0.0539s/iter; left time: 1105.5875s
	iters: 200, epoch: 9 | loss: 0.1037400
	speed: 0.0266s/iter; left time: 543.4706s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.1067069 Vali Loss: 0.1222393 Test Loss: 0.1330903
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1100116
	speed: 0.0539s/iter; left time: 1093.4243s
	iters: 200, epoch: 10 | loss: 0.1031807
	speed: 0.0266s/iter; left time: 536.8010s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.1061626 Vali Loss: 0.1216754 Test Loss: 0.1323753
Validation loss decreased (0.122186 --> 0.121675).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1025820
	speed: 0.0538s/iter; left time: 1079.0492s
	iters: 200, epoch: 11 | loss: 0.1052802
	speed: 0.0269s/iter; left time: 536.2703s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1057314 Vali Loss: 0.1224910 Test Loss: 0.1328006
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1058313
	speed: 0.0534s/iter; left time: 1060.2226s
	iters: 200, epoch: 12 | loss: 0.1041818
	speed: 0.0267s/iter; left time: 526.0893s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1052416 Vali Loss: 0.1243058 Test Loss: 0.1365962
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1032766
	speed: 0.0534s/iter; left time: 1046.9839s
	iters: 200, epoch: 13 | loss: 0.1077306
	speed: 0.0268s/iter; left time: 523.7595s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1050440 Vali Loss: 0.1220603 Test Loss: 0.1344615
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1021536
	speed: 0.0534s/iter; left time: 1035.5258s
	iters: 200, epoch: 14 | loss: 0.1046405
	speed: 0.0267s/iter; left time: 515.0617s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.1047762 Vali Loss: 0.1225811 Test Loss: 0.1338924
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1044356
	speed: 0.0545s/iter; left time: 1044.8756s
	iters: 200, epoch: 15 | loss: 0.1005543
	speed: 0.0269s/iter; left time: 512.9980s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.1043475 Vali Loss: 0.1213009 Test Loss: 0.1326865
Validation loss decreased (0.121675 --> 0.121301).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1048859
	speed: 0.0540s/iter; left time: 1022.8323s
	iters: 200, epoch: 16 | loss: 0.1073394
	speed: 0.0269s/iter; left time: 507.4309s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1039374 Vali Loss: 0.1212771 Test Loss: 0.1320987
Validation loss decreased (0.121301 --> 0.121277).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1051285
	speed: 0.0549s/iter; left time: 1027.4564s
	iters: 200, epoch: 17 | loss: 0.1010679
	speed: 0.0269s/iter; left time: 500.8634s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.1038081 Vali Loss: 0.1213366 Test Loss: 0.1325993
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0991897
	speed: 0.0545s/iter; left time: 1008.4405s
	iters: 200, epoch: 18 | loss: 0.1046743
	speed: 0.0269s/iter; left time: 494.8963s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.1034109 Vali Loss: 0.1218144 Test Loss: 0.1340982
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0968954
	speed: 0.0537s/iter; left time: 981.9191s
	iters: 200, epoch: 19 | loss: 0.1019711
	speed: 0.0269s/iter; left time: 488.5783s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1033139 Vali Loss: 0.1208791 Test Loss: 0.1313206
Validation loss decreased (0.121277 --> 0.120879).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1070008
	speed: 0.0543s/iter; left time: 979.2531s
	iters: 200, epoch: 20 | loss: 0.1064007
	speed: 0.0268s/iter; left time: 480.6417s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1032069 Vali Loss: 0.1206882 Test Loss: 0.1321557
Validation loss decreased (0.120879 --> 0.120688).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1015853
	speed: 0.0545s/iter; left time: 971.9514s
	iters: 200, epoch: 21 | loss: 0.1097577
	speed: 0.0265s/iter; left time: 470.2246s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1029773 Vali Loss: 0.1212966 Test Loss: 0.1336874
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1017909
	speed: 0.0540s/iter; left time: 950.4521s
	iters: 200, epoch: 22 | loss: 0.1038301
	speed: 0.0267s/iter; left time: 466.7663s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1027577 Vali Loss: 0.1214426 Test Loss: 0.1345916
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0982991
	speed: 0.0535s/iter; left time: 929.2058s
	iters: 200, epoch: 23 | loss: 0.1047580
	speed: 0.0269s/iter; left time: 464.7017s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1027925 Vali Loss: 0.1207157 Test Loss: 0.1328590
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1034600
	speed: 0.0528s/iter; left time: 905.5511s
	iters: 200, epoch: 24 | loss: 0.1051510
	speed: 0.0267s/iter; left time: 455.4818s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1025946 Vali Loss: 0.1216530 Test Loss: 0.1352093
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1028438
	speed: 0.0524s/iter; left time: 886.5080s
	iters: 200, epoch: 25 | loss: 0.0966356
	speed: 0.0269s/iter; left time: 452.4392s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1026048 Vali Loss: 0.1210366 Test Loss: 0.1333753
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1035642
	speed: 0.0541s/iter; left time: 903.3394s
	iters: 200, epoch: 26 | loss: 0.1013549
	speed: 0.0268s/iter; left time: 445.6060s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.1023992 Vali Loss: 0.1216036 Test Loss: 0.1348441
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1081149
	speed: 0.0540s/iter; left time: 890.5193s
	iters: 200, epoch: 27 | loss: 0.1037228
	speed: 0.0268s/iter; left time: 438.8686s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1024023 Vali Loss: 0.1204499 Test Loss: 0.1331628
Validation loss decreased (0.120688 --> 0.120450).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1005158
	speed: 0.0541s/iter; left time: 878.6005s
	iters: 200, epoch: 28 | loss: 0.1030452
	speed: 0.0267s/iter; left time: 430.9146s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1023325 Vali Loss: 0.1203885 Test Loss: 0.1324828
Validation loss decreased (0.120450 --> 0.120388).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1038010
	speed: 0.0544s/iter; left time: 871.5227s
	iters: 200, epoch: 29 | loss: 0.0961380
	speed: 0.0268s/iter; left time: 427.2107s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1022584 Vali Loss: 0.1205274 Test Loss: 0.1322376
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0989264
	speed: 0.0537s/iter; left time: 848.0358s
	iters: 200, epoch: 30 | loss: 0.1042494
	speed: 0.0266s/iter; left time: 418.3128s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1021098 Vali Loss: 0.1208396 Test Loss: 0.1335907
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1034334
	speed: 0.0534s/iter; left time: 832.7826s
	iters: 200, epoch: 31 | loss: 0.1014686
	speed: 0.0269s/iter; left time: 416.9045s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1020975 Vali Loss: 0.1210884 Test Loss: 0.1335009
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1016325
	speed: 0.0534s/iter; left time: 819.5112s
	iters: 200, epoch: 32 | loss: 0.1032996
	speed: 0.0267s/iter; left time: 407.3522s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1019933 Vali Loss: 0.1205121 Test Loss: 0.1333751
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1052899
	speed: 0.0540s/iter; left time: 817.5288s
	iters: 200, epoch: 33 | loss: 0.0988395
	speed: 0.0268s/iter; left time: 403.4300s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.1020614 Vali Loss: 0.1206313 Test Loss: 0.1333139
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.1053393
	speed: 0.0541s/iter; left time: 807.0602s
	iters: 200, epoch: 34 | loss: 0.1010254
	speed: 0.0266s/iter; left time: 393.8549s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1019011 Vali Loss: 0.1207969 Test Loss: 0.1332408
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.1035039
	speed: 0.0542s/iter; left time: 796.0329s
	iters: 200, epoch: 35 | loss: 0.1049854
	speed: 0.0267s/iter; left time: 389.6007s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1019402 Vali Loss: 0.1208092 Test Loss: 0.1337095
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.1013041
	speed: 0.0525s/iter; left time: 758.7460s
	iters: 200, epoch: 36 | loss: 0.0980874
	speed: 0.0265s/iter; left time: 381.1676s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.1018536 Vali Loss: 0.1204284 Test Loss: 0.1332987
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.1045307
	speed: 0.0539s/iter; left time: 766.9765s
	iters: 200, epoch: 37 | loss: 0.0954375
	speed: 0.0269s/iter; left time: 379.6880s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1018151 Vali Loss: 0.1215746 Test Loss: 0.1352356
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.1059201
	speed: 0.0533s/iter; left time: 746.3598s
	iters: 200, epoch: 38 | loss: 0.1002588
	speed: 0.0266s/iter; left time: 369.8158s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1018667 Vali Loss: 0.1203720 Test Loss: 0.1324616
Validation loss decreased (0.120388 --> 0.120372).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.1054295
	speed: 0.0541s/iter; left time: 746.1437s
	iters: 200, epoch: 39 | loss: 0.1024275
	speed: 0.0267s/iter; left time: 365.5433s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1018485 Vali Loss: 0.1205335 Test Loss: 0.1327809
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.1032095
	speed: 0.0531s/iter; left time: 719.7531s
	iters: 200, epoch: 40 | loss: 0.1009113
	speed: 0.0265s/iter; left time: 357.4903s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1018323 Vali Loss: 0.1206866 Test Loss: 0.1337668
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.1007862
	speed: 0.0533s/iter; left time: 711.3404s
	iters: 200, epoch: 41 | loss: 0.1018894
	speed: 0.0266s/iter; left time: 352.1950s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1017909 Vali Loss: 0.1210196 Test Loss: 0.1332831
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.1013647
	speed: 0.0541s/iter; left time: 710.2563s
	iters: 200, epoch: 42 | loss: 0.1019138
	speed: 0.0266s/iter; left time: 346.7586s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.1017286 Vali Loss: 0.1206163 Test Loss: 0.1335710
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0992487
	speed: 0.0528s/iter; left time: 681.3525s
	iters: 200, epoch: 43 | loss: 0.1036323
	speed: 0.0265s/iter; left time: 338.6754s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.1017129 Vali Loss: 0.1208370 Test Loss: 0.1340242
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.1043643
	speed: 0.0525s/iter; left time: 664.4967s
	iters: 200, epoch: 44 | loss: 0.1003388
	speed: 0.0265s/iter; left time: 333.5110s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.1017266 Vali Loss: 0.1208941 Test Loss: 0.1337463
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0952285
	speed: 0.0535s/iter; left time: 666.1059s
	iters: 200, epoch: 45 | loss: 0.0951335
	speed: 0.0270s/iter; left time: 333.0809s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.1016882 Vali Loss: 0.1207762 Test Loss: 0.1334585
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0998819
	speed: 0.0534s/iter; left time: 652.0819s
	iters: 200, epoch: 46 | loss: 0.1063564
	speed: 0.0266s/iter; left time: 322.9070s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1016775 Vali Loss: 0.1205455 Test Loss: 0.1334468
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.1025925
	speed: 0.0534s/iter; left time: 640.1678s
	iters: 200, epoch: 47 | loss: 0.1063050
	speed: 0.0267s/iter; left time: 317.2070s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1016528 Vali Loss: 0.1207108 Test Loss: 0.1335262
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.1062247
	speed: 0.0539s/iter; left time: 634.4334s
	iters: 200, epoch: 48 | loss: 0.1005530
	speed: 0.0268s/iter; left time: 312.7111s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.1016578 Vali Loss: 0.1206686 Test Loss: 0.1333757
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04114912077784538, rmse:0.20285245776176453, mae:0.13246160745620728, rse:0.718341588973999
Intermediate time for DE and pred_len 96: 00h:12m:26.98s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2694588
	speed: 0.0552s/iter; left time: 1224.7381s
	iters: 200, epoch: 1 | loss: 0.2494408
	speed: 0.0271s/iter; left time: 598.0186s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.53s
Steps: 223 | Train Loss: 0.2678130 Vali Loss: 0.2256625 Test Loss: 0.2271173
Validation loss decreased (inf --> 0.225662).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1588242
	speed: 0.0538s/iter; left time: 1182.2961s
	iters: 200, epoch: 2 | loss: 0.1380554
	speed: 0.0270s/iter; left time: 591.3112s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.1643799 Vali Loss: 0.1423661 Test Loss: 0.1508600
Validation loss decreased (0.225662 --> 0.142366).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1310375
	speed: 0.0547s/iter; left time: 1189.6865s
	iters: 200, epoch: 3 | loss: 0.1250534
	speed: 0.0272s/iter; left time: 589.0188s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1280863 Vali Loss: 0.1337826 Test Loss: 0.1466388
Validation loss decreased (0.142366 --> 0.133783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1168175
	speed: 0.0558s/iter; left time: 1201.8038s
	iters: 200, epoch: 4 | loss: 0.1242551
	speed: 0.0271s/iter; left time: 581.1549s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1204302 Vali Loss: 0.1299775 Test Loss: 0.1410140
Validation loss decreased (0.133783 --> 0.129977).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1135532
	speed: 0.0549s/iter; left time: 1170.3497s
	iters: 200, epoch: 5 | loss: 0.1206374
	speed: 0.0271s/iter; left time: 575.1671s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1170739 Vali Loss: 0.1344015 Test Loss: 0.1487388
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1135251
	speed: 0.0537s/iter; left time: 1131.7627s
	iters: 200, epoch: 6 | loss: 0.1191229
	speed: 0.0271s/iter; left time: 568.8494s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1156737 Vali Loss: 0.1268869 Test Loss: 0.1388794
Validation loss decreased (0.129977 --> 0.126887).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1148158
	speed: 0.0568s/iter; left time: 1184.1567s
	iters: 200, epoch: 7 | loss: 0.1113933
	speed: 0.0275s/iter; left time: 571.9155s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.51s
Steps: 223 | Train Loss: 0.1136320 Vali Loss: 0.1272786 Test Loss: 0.1386431
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1087779
	speed: 0.0543s/iter; left time: 1121.3235s
	iters: 200, epoch: 8 | loss: 0.1179757
	speed: 0.0270s/iter; left time: 554.5896s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1128987 Vali Loss: 0.1260758 Test Loss: 0.1385074
Validation loss decreased (0.126887 --> 0.126076).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1112111
	speed: 0.0562s/iter; left time: 1147.8760s
	iters: 200, epoch: 9 | loss: 0.1040103
	speed: 0.0271s/iter; left time: 550.6992s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1120882 Vali Loss: 0.1248956 Test Loss: 0.1389382
Validation loss decreased (0.126076 --> 0.124896).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1084555
	speed: 0.0540s/iter; left time: 1090.7371s
	iters: 200, epoch: 10 | loss: 0.1098599
	speed: 0.0269s/iter; left time: 541.3912s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.1114377 Vali Loss: 0.1259496 Test Loss: 0.1390752
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1112702
	speed: 0.0532s/iter; left time: 1062.3973s
	iters: 200, epoch: 11 | loss: 0.1071776
	speed: 0.0270s/iter; left time: 535.9145s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.1108791 Vali Loss: 0.1254558 Test Loss: 0.1400634
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1060586
	speed: 0.0544s/iter; left time: 1073.7341s
	iters: 200, epoch: 12 | loss: 0.1133663
	speed: 0.0271s/iter; left time: 531.6741s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1103929 Vali Loss: 0.1251655 Test Loss: 0.1393932
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1157562
	speed: 0.0548s/iter; left time: 1069.7461s
	iters: 200, epoch: 13 | loss: 0.1112933
	speed: 0.0270s/iter; left time: 524.8407s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1099508 Vali Loss: 0.1248499 Test Loss: 0.1389184
Validation loss decreased (0.124896 --> 0.124850).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1031506
	speed: 0.0547s/iter; left time: 1056.6042s
	iters: 200, epoch: 14 | loss: 0.1168942
	speed: 0.0272s/iter; left time: 522.4708s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1096748 Vali Loss: 0.1241475 Test Loss: 0.1385670
Validation loss decreased (0.124850 --> 0.124147).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1090125
	speed: 0.0588s/iter; left time: 1122.7144s
	iters: 200, epoch: 15 | loss: 0.1169378
	speed: 0.0271s/iter; left time: 513.6158s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1092719 Vali Loss: 0.1249807 Test Loss: 0.1392617
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1112845
	speed: 0.0547s/iter; left time: 1030.9061s
	iters: 200, epoch: 16 | loss: 0.1171693
	speed: 0.0271s/iter; left time: 507.3727s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1090011 Vali Loss: 0.1237507 Test Loss: 0.1397156
Validation loss decreased (0.124147 --> 0.123751).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1085970
	speed: 0.0552s/iter; left time: 1027.7934s
	iters: 200, epoch: 17 | loss: 0.1124511
	speed: 0.0271s/iter; left time: 502.2944s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1088298 Vali Loss: 0.1237531 Test Loss: 0.1388248
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1071712
	speed: 0.0542s/iter; left time: 997.9987s
	iters: 200, epoch: 18 | loss: 0.1117891
	speed: 0.0271s/iter; left time: 496.0025s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1085106 Vali Loss: 0.1250654 Test Loss: 0.1391321
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1095252
	speed: 0.0543s/iter; left time: 986.8619s
	iters: 200, epoch: 19 | loss: 0.1084045
	speed: 0.0271s/iter; left time: 489.5136s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1083448 Vali Loss: 0.1253616 Test Loss: 0.1393350
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1102001
	speed: 0.0546s/iter; left time: 981.6163s
	iters: 200, epoch: 20 | loss: 0.1061500
	speed: 0.0270s/iter; left time: 482.2655s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1081657 Vali Loss: 0.1245547 Test Loss: 0.1393294
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1117846
	speed: 0.0545s/iter; left time: 966.7442s
	iters: 200, epoch: 21 | loss: 0.1123026
	speed: 0.0270s/iter; left time: 476.6042s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1079122 Vali Loss: 0.1238274 Test Loss: 0.1397963
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1029315
	speed: 0.0542s/iter; left time: 949.4588s
	iters: 200, epoch: 22 | loss: 0.1159650
	speed: 0.0270s/iter; left time: 469.7862s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1077999 Vali Loss: 0.1237673 Test Loss: 0.1400765
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1040981
	speed: 0.0549s/iter; left time: 949.2440s
	iters: 200, epoch: 23 | loss: 0.1068356
	speed: 0.0273s/iter; left time: 468.6965s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1077011 Vali Loss: 0.1238438 Test Loss: 0.1395416
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1130653
	speed: 0.0545s/iter; left time: 929.7970s
	iters: 200, epoch: 24 | loss: 0.1057272
	speed: 0.0271s/iter; left time: 459.3940s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1076156 Vali Loss: 0.1240128 Test Loss: 0.1398824
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1053374
	speed: 0.0574s/iter; left time: 967.4682s
	iters: 200, epoch: 25 | loss: 0.1097853
	speed: 0.0274s/iter; left time: 458.1337s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.65s
Steps: 223 | Train Loss: 0.1075735 Vali Loss: 0.1251452 Test Loss: 0.1397400
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1110702
	speed: 0.0545s/iter; left time: 906.2075s
	iters: 200, epoch: 26 | loss: 0.1068365
	speed: 0.0273s/iter; left time: 450.8314s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1074012 Vali Loss: 0.1236224 Test Loss: 0.1401185
Validation loss decreased (0.123751 --> 0.123622).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1045682
	speed: 0.0552s/iter; left time: 905.0831s
	iters: 200, epoch: 27 | loss: 0.1105434
	speed: 0.0270s/iter; left time: 440.5292s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1073121 Vali Loss: 0.1244636 Test Loss: 0.1406418
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1013705
	speed: 0.0537s/iter; left time: 868.1799s
	iters: 200, epoch: 28 | loss: 0.1062632
	speed: 0.0270s/iter; left time: 434.8375s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1071771 Vali Loss: 0.1245068 Test Loss: 0.1402753
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1071039
	speed: 0.0542s/iter; left time: 864.4046s
	iters: 200, epoch: 29 | loss: 0.1107840
	speed: 0.0269s/iter; left time: 427.2778s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.1071781 Vali Loss: 0.1247383 Test Loss: 0.1401076
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.1089579
	speed: 0.0541s/iter; left time: 851.6652s
	iters: 200, epoch: 30 | loss: 0.1040116
	speed: 0.0270s/iter; left time: 421.4495s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1070503 Vali Loss: 0.1241704 Test Loss: 0.1408251
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1058714
	speed: 0.0551s/iter; left time: 853.9583s
	iters: 200, epoch: 31 | loss: 0.1062244
	speed: 0.0271s/iter; left time: 417.7224s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1070863 Vali Loss: 0.1242928 Test Loss: 0.1399416
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1062264
	speed: 0.0548s/iter; left time: 838.3116s
	iters: 200, epoch: 32 | loss: 0.1099966
	speed: 0.0270s/iter; left time: 410.6067s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1069084 Vali Loss: 0.1242390 Test Loss: 0.1404155
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1034179
	speed: 0.0549s/iter; left time: 827.4123s
	iters: 200, epoch: 33 | loss: 0.1076491
	speed: 0.0270s/iter; left time: 403.4975s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1068814 Vali Loss: 0.1246129 Test Loss: 0.1405573
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.1070711
	speed: 0.0549s/iter; left time: 815.2384s
	iters: 200, epoch: 34 | loss: 0.1085021
	speed: 0.0271s/iter; left time: 398.9046s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1069560 Vali Loss: 0.1244370 Test Loss: 0.1408949
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.1049294
	speed: 0.0545s/iter; left time: 797.3256s
	iters: 200, epoch: 35 | loss: 0.1038471
	speed: 0.0271s/iter; left time: 393.2330s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1068299 Vali Loss: 0.1241320 Test Loss: 0.1411497
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.1098494
	speed: 0.0543s/iter; left time: 782.0134s
	iters: 200, epoch: 36 | loss: 0.1050852
	speed: 0.0269s/iter; left time: 385.2087s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1068699 Vali Loss: 0.1244320 Test Loss: 0.1406202
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04431525990366936, rmse:0.21051189303398132, mae:0.1401185244321823, rse:0.745650053024292
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2717605
	speed: 0.0295s/iter; left time: 654.4038s
	iters: 200, epoch: 1 | loss: 0.2497348
	speed: 0.0272s/iter; left time: 600.5845s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.2706402 Vali Loss: 0.2244382 Test Loss: 0.2255183
Validation loss decreased (inf --> 0.224438).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1527811
	speed: 0.0557s/iter; left time: 1224.9892s
	iters: 200, epoch: 2 | loss: 0.1387502
	speed: 0.0271s/iter; left time: 592.8055s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1653805 Vali Loss: 0.1436438 Test Loss: 0.1523493
Validation loss decreased (0.224438 --> 0.143644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1230632
	speed: 0.0557s/iter; left time: 1212.0715s
	iters: 200, epoch: 3 | loss: 0.1206774
	speed: 0.0270s/iter; left time: 583.6102s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1282984 Vali Loss: 0.1361505 Test Loss: 0.1495952
Validation loss decreased (0.143644 --> 0.136151).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1197004
	speed: 0.0550s/iter; left time: 1185.1254s
	iters: 200, epoch: 4 | loss: 0.1239574
	speed: 0.0270s/iter; left time: 578.9722s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1201374 Vali Loss: 0.1296212 Test Loss: 0.1417666
Validation loss decreased (0.136151 --> 0.129621).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1169373
	speed: 0.0556s/iter; left time: 1184.0687s
	iters: 200, epoch: 5 | loss: 0.1243026
	speed: 0.0271s/iter; left time: 575.5743s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1167164 Vali Loss: 0.1283937 Test Loss: 0.1403232
Validation loss decreased (0.129621 --> 0.128394).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1118112
	speed: 0.0564s/iter; left time: 1188.5351s
	iters: 200, epoch: 6 | loss: 0.1142436
	speed: 0.0271s/iter; left time: 568.3745s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1147682 Vali Loss: 0.1283294 Test Loss: 0.1415380
Validation loss decreased (0.128394 --> 0.128329).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1179367
	speed: 0.0561s/iter; left time: 1171.1309s
	iters: 200, epoch: 7 | loss: 0.1164256
	speed: 0.0274s/iter; left time: 567.9589s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1136461 Vali Loss: 0.1264505 Test Loss: 0.1372013
Validation loss decreased (0.128329 --> 0.126451).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1085146
	speed: 0.0555s/iter; left time: 1146.3352s
	iters: 200, epoch: 8 | loss: 0.1157306
	speed: 0.0270s/iter; left time: 554.8997s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1126392 Vali Loss: 0.1277611 Test Loss: 0.1413333
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1089189
	speed: 0.0547s/iter; left time: 1116.3828s
	iters: 200, epoch: 9 | loss: 0.1077685
	speed: 0.0270s/iter; left time: 549.1141s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1121741 Vali Loss: 0.1275626 Test Loss: 0.1438202
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1066347
	speed: 0.0557s/iter; left time: 1123.8937s
	iters: 200, epoch: 10 | loss: 0.1085937
	speed: 0.0270s/iter; left time: 543.3534s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1113941 Vali Loss: 0.1272142 Test Loss: 0.1444350
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1123278
	speed: 0.0551s/iter; left time: 1101.0992s
	iters: 200, epoch: 11 | loss: 0.1101279
	speed: 0.0269s/iter; left time: 534.8663s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.1109960 Vali Loss: 0.1259657 Test Loss: 0.1395051
Validation loss decreased (0.126451 --> 0.125966).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1070488
	speed: 0.0550s/iter; left time: 1086.2275s
	iters: 200, epoch: 12 | loss: 0.1095819
	speed: 0.0270s/iter; left time: 531.2348s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1104357 Vali Loss: 0.1272518 Test Loss: 0.1414926
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1036251
	speed: 0.0554s/iter; left time: 1080.9484s
	iters: 200, epoch: 13 | loss: 0.1088385
	speed: 0.0271s/iter; left time: 526.1045s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.1099431 Vali Loss: 0.1252747 Test Loss: 0.1399227
Validation loss decreased (0.125966 --> 0.125275).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1030467
	speed: 0.0563s/iter; left time: 1087.3423s
	iters: 200, epoch: 14 | loss: 0.1086750
	speed: 0.0271s/iter; left time: 519.5117s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1096007 Vali Loss: 0.1251468 Test Loss: 0.1390274
Validation loss decreased (0.125275 --> 0.125147).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1130099
	speed: 0.0553s/iter; left time: 1054.7983s
	iters: 200, epoch: 15 | loss: 0.1032722
	speed: 0.0271s/iter; left time: 514.9943s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1093529 Vali Loss: 0.1260432 Test Loss: 0.1412244
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1124173
	speed: 0.0547s/iter; left time: 1031.7254s
	iters: 200, epoch: 16 | loss: 0.1127571
	speed: 0.0270s/iter; left time: 506.3334s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1091081 Vali Loss: 0.1250219 Test Loss: 0.1372206
Validation loss decreased (0.125147 --> 0.125022).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1095243
	speed: 0.0562s/iter; left time: 1047.0096s
	iters: 200, epoch: 17 | loss: 0.1056836
	speed: 0.0270s/iter; left time: 500.4790s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1088649 Vali Loss: 0.1250639 Test Loss: 0.1414303
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1073400
	speed: 0.0554s/iter; left time: 1019.8852s
	iters: 200, epoch: 18 | loss: 0.1063695
	speed: 0.0270s/iter; left time: 494.6555s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1084461 Vali Loss: 0.1252620 Test Loss: 0.1424867
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1156768
	speed: 0.0545s/iter; left time: 991.4157s
	iters: 200, epoch: 19 | loss: 0.1058337
	speed: 0.0270s/iter; left time: 488.9932s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1083064 Vali Loss: 0.1245592 Test Loss: 0.1410565
Validation loss decreased (0.125022 --> 0.124559).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1095986
	speed: 0.0549s/iter; left time: 986.9857s
	iters: 200, epoch: 20 | loss: 0.1091317
	speed: 0.0270s/iter; left time: 482.9722s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1080848 Vali Loss: 0.1245383 Test Loss: 0.1408349
Validation loss decreased (0.124559 --> 0.124538).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1101300
	speed: 0.0553s/iter; left time: 981.7747s
	iters: 200, epoch: 21 | loss: 0.1040779
	speed: 0.0270s/iter; left time: 476.9504s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1079569 Vali Loss: 0.1243153 Test Loss: 0.1404460
Validation loss decreased (0.124538 --> 0.124315).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1128185
	speed: 0.0568s/iter; left time: 995.7225s
	iters: 200, epoch: 22 | loss: 0.1128093
	speed: 0.0271s/iter; left time: 471.8340s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.33s
Steps: 223 | Train Loss: 0.1076719 Vali Loss: 0.1247798 Test Loss: 0.1418921
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1050721
	speed: 0.0555s/iter; left time: 959.1245s
	iters: 200, epoch: 23 | loss: 0.1063960
	speed: 0.0270s/iter; left time: 463.9779s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1075455 Vali Loss: 0.1248229 Test Loss: 0.1425713
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1091020
	speed: 0.0544s/iter; left time: 928.7713s
	iters: 200, epoch: 24 | loss: 0.1096076
	speed: 0.0270s/iter; left time: 458.3996s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1073950 Vali Loss: 0.1245639 Test Loss: 0.1406815
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1097365
	speed: 0.0542s/iter; left time: 913.7001s
	iters: 200, epoch: 25 | loss: 0.1018156
	speed: 0.0270s/iter; left time: 451.3987s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1073257 Vali Loss: 0.1250512 Test Loss: 0.1418965
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1078187
	speed: 0.0549s/iter; left time: 912.7843s
	iters: 200, epoch: 26 | loss: 0.1050411
	speed: 0.0273s/iter; left time: 450.9840s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1071412 Vali Loss: 0.1250405 Test Loss: 0.1421759
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1098222
	speed: 0.0550s/iter; left time: 901.3794s
	iters: 200, epoch: 27 | loss: 0.1058681
	speed: 0.0270s/iter; left time: 440.7958s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1070719 Vali Loss: 0.1245344 Test Loss: 0.1412885
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1065511
	speed: 0.0553s/iter; left time: 894.4245s
	iters: 200, epoch: 28 | loss: 0.1106282
	speed: 0.0270s/iter; left time: 434.8052s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1069628 Vali Loss: 0.1253483 Test Loss: 0.1421668
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1023793
	speed: 0.0545s/iter; left time: 870.1654s
	iters: 200, epoch: 29 | loss: 0.1069401
	speed: 0.0270s/iter; left time: 428.4353s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1069073 Vali Loss: 0.1242450 Test Loss: 0.1414697
Validation loss decreased (0.124315 --> 0.124245).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.1019570
	speed: 0.0557s/iter; left time: 876.1648s
	iters: 200, epoch: 30 | loss: 0.1062927
	speed: 0.0269s/iter; left time: 421.2673s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1068318 Vali Loss: 0.1248964 Test Loss: 0.1429121
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1077381
	speed: 0.0546s/iter; left time: 846.6325s
	iters: 200, epoch: 31 | loss: 0.1063283
	speed: 0.0270s/iter; left time: 416.4787s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1067886 Vali Loss: 0.1251295 Test Loss: 0.1429515
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1073042
	speed: 0.0544s/iter; left time: 831.3801s
	iters: 200, epoch: 32 | loss: 0.1063897
	speed: 0.0270s/iter; left time: 410.4489s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1067653 Vali Loss: 0.1244331 Test Loss: 0.1432744
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1053505
	speed: 0.0554s/iter; left time: 834.1189s
	iters: 200, epoch: 33 | loss: 0.1072904
	speed: 0.0280s/iter; left time: 419.5771s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.44s
Steps: 223 | Train Loss: 0.1065941 Vali Loss: 0.1245723 Test Loss: 0.1420990
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.1058740
	speed: 0.0553s/iter; left time: 820.2343s
	iters: 200, epoch: 34 | loss: 0.1065225
	speed: 0.0273s/iter; left time: 402.8703s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.1065375 Vali Loss: 0.1245974 Test Loss: 0.1424081
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.1051413
	speed: 0.0553s/iter; left time: 807.9574s
	iters: 200, epoch: 35 | loss: 0.0990082
	speed: 0.0275s/iter; left time: 398.7572s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.1066114 Vali Loss: 0.1243352 Test Loss: 0.1414857
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.1041255
	speed: 0.0558s/iter; left time: 803.5647s
	iters: 200, epoch: 36 | loss: 0.1066304
	speed: 0.0272s/iter; left time: 389.1165s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.1064593 Vali Loss: 0.1244077 Test Loss: 0.1428552
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.1080189
	speed: 0.0553s/iter; left time: 783.4120s
	iters: 200, epoch: 37 | loss: 0.1072931
	speed: 0.0272s/iter; left time: 382.5497s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1064730 Vali Loss: 0.1247789 Test Loss: 0.1439544
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.1067841
	speed: 0.0558s/iter; left time: 778.7763s
	iters: 200, epoch: 38 | loss: 0.1071450
	speed: 0.0272s/iter; left time: 376.7000s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1064397 Vali Loss: 0.1247913 Test Loss: 0.1433378
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.1057215
	speed: 0.0550s/iter; left time: 755.6179s
	iters: 200, epoch: 39 | loss: 0.1080193
	speed: 0.0272s/iter; left time: 370.6245s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.1064028 Vali Loss: 0.1242686 Test Loss: 0.1419638
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04567323625087738, rmse:0.21371297538280487, mae:0.14146965742111206, rse:0.7569885849952698
Intermediate time for DE and pred_len 168: 00h:10m:30.76sIntermediate time for DE: 00h:36m:45.02s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2768023
	speed: 0.0520s/iter; left time: 1160.3643s
	iters: 200, epoch: 1 | loss: 0.2690596
	speed: 0.0263s/iter; left time: 584.9899s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.2826750 Vali Loss: 0.2354308 Test Loss: 0.2522551
Validation loss decreased (inf --> 0.235431).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1396006
	speed: 0.0511s/iter; left time: 1127.8921s
	iters: 200, epoch: 2 | loss: 0.1164763
	speed: 0.0264s/iter; left time: 579.6471s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.1529604 Vali Loss: 0.1122059 Test Loss: 0.1267973
Validation loss decreased (0.235431 --> 0.112206).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0966394
	speed: 0.0526s/iter; left time: 1149.1262s
	iters: 200, epoch: 3 | loss: 0.0966364
	speed: 0.0265s/iter; left time: 575.5264s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1003180 Vali Loss: 0.0975877 Test Loss: 0.1097753
Validation loss decreased (0.112206 --> 0.097588).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0853399
	speed: 0.0513s/iter; left time: 1109.6436s
	iters: 200, epoch: 4 | loss: 0.0865217
	speed: 0.0264s/iter; left time: 569.2754s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0909225 Vali Loss: 0.0965700 Test Loss: 0.1102376
Validation loss decreased (0.097588 --> 0.096570).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0861233
	speed: 0.0511s/iter; left time: 1093.1139s
	iters: 200, epoch: 5 | loss: 0.0854768
	speed: 0.0264s/iter; left time: 562.5402s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0870366 Vali Loss: 0.0945423 Test Loss: 0.1075835
Validation loss decreased (0.096570 --> 0.094542).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0900608
	speed: 0.0511s/iter; left time: 1081.4984s
	iters: 200, epoch: 6 | loss: 0.0898061
	speed: 0.0265s/iter; left time: 557.9827s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0854425 Vali Loss: 0.0940791 Test Loss: 0.1066109
Validation loss decreased (0.094542 --> 0.094079).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0848851
	speed: 0.0524s/iter; left time: 1098.2402s
	iters: 200, epoch: 7 | loss: 0.0917123
	speed: 0.0265s/iter; left time: 553.0558s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0843855 Vali Loss: 0.0945964 Test Loss: 0.1069779
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0866622
	speed: 0.0512s/iter; left time: 1061.4857s
	iters: 200, epoch: 8 | loss: 0.0893530
	speed: 0.0263s/iter; left time: 543.6785s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0836836 Vali Loss: 0.0930915 Test Loss: 0.1061764
Validation loss decreased (0.094079 --> 0.093092).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0803224
	speed: 0.0511s/iter; left time: 1049.0163s
	iters: 200, epoch: 9 | loss: 0.0854001
	speed: 0.0263s/iter; left time: 535.9007s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0823254 Vali Loss: 0.0925307 Test Loss: 0.1057673
Validation loss decreased (0.093092 --> 0.092531).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0864102
	speed: 0.0513s/iter; left time: 1041.6057s
	iters: 200, epoch: 10 | loss: 0.0792464
	speed: 0.0264s/iter; left time: 532.7681s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0817801 Vali Loss: 0.0928679 Test Loss: 0.1055995
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0835089
	speed: 0.0510s/iter; left time: 1022.8234s
	iters: 200, epoch: 11 | loss: 0.0814737
	speed: 0.0271s/iter; left time: 541.7347s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0812240 Vali Loss: 0.0922058 Test Loss: 0.1056192
Validation loss decreased (0.092531 --> 0.092206).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0846820
	speed: 0.0516s/iter; left time: 1023.9693s
	iters: 200, epoch: 12 | loss: 0.0766829
	speed: 0.0265s/iter; left time: 522.5596s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0808361 Vali Loss: 0.0920979 Test Loss: 0.1049938
Validation loss decreased (0.092206 --> 0.092098).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0781128
	speed: 0.0523s/iter; left time: 1026.0289s
	iters: 200, epoch: 13 | loss: 0.0791380
	speed: 0.0266s/iter; left time: 519.5781s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0807068 Vali Loss: 0.0919241 Test Loss: 0.1046759
Validation loss decreased (0.092098 --> 0.091924).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0847301
	speed: 0.0527s/iter; left time: 1022.6688s
	iters: 200, epoch: 14 | loss: 0.0746568
	speed: 0.0268s/iter; left time: 517.3736s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0801385 Vali Loss: 0.0931495 Test Loss: 0.1059648
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0733164
	speed: 0.0512s/iter; left time: 981.9909s
	iters: 200, epoch: 15 | loss: 0.0755852
	speed: 0.0263s/iter; left time: 502.2321s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0798146 Vali Loss: 0.0925728 Test Loss: 0.1053378
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0780552
	speed: 0.0515s/iter; left time: 976.2470s
	iters: 200, epoch: 16 | loss: 0.0810713
	speed: 0.0268s/iter; left time: 504.8143s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0796394 Vali Loss: 0.0917714 Test Loss: 0.1051183
Validation loss decreased (0.091924 --> 0.091771).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0804468
	speed: 0.0523s/iter; left time: 979.7383s
	iters: 200, epoch: 17 | loss: 0.0858267
	speed: 0.0265s/iter; left time: 493.9202s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0794315 Vali Loss: 0.0931107 Test Loss: 0.1060146
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0788002
	speed: 0.0510s/iter; left time: 943.6644s
	iters: 200, epoch: 18 | loss: 0.0785697
	speed: 0.0266s/iter; left time: 489.2590s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0792040 Vali Loss: 0.0925627 Test Loss: 0.1054443
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0758029
	speed: 0.0516s/iter; left time: 942.0671s
	iters: 200, epoch: 19 | loss: 0.0807317
	speed: 0.0267s/iter; left time: 484.5364s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0789865 Vali Loss: 0.0916071 Test Loss: 0.1051683
Validation loss decreased (0.091771 --> 0.091607).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0712235
	speed: 0.0524s/iter; left time: 945.7370s
	iters: 200, epoch: 20 | loss: 0.0769432
	speed: 0.0265s/iter; left time: 475.5683s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0791350 Vali Loss: 0.0927929 Test Loss: 0.1058215
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0816098
	speed: 0.0516s/iter; left time: 919.1630s
	iters: 200, epoch: 21 | loss: 0.0770771
	speed: 0.0266s/iter; left time: 470.8147s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0786526 Vali Loss: 0.0916404 Test Loss: 0.1053026
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0810547
	speed: 0.0512s/iter; left time: 900.2478s
	iters: 200, epoch: 22 | loss: 0.0723379
	speed: 0.0267s/iter; left time: 466.4448s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0786124 Vali Loss: 0.0915176 Test Loss: 0.1052929
Validation loss decreased (0.091607 --> 0.091518).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0762598
	speed: 0.0515s/iter; left time: 895.3479s
	iters: 200, epoch: 23 | loss: 0.0729632
	speed: 0.0267s/iter; left time: 460.6804s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0783870 Vali Loss: 0.0918097 Test Loss: 0.1056085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0758494
	speed: 0.0519s/iter; left time: 890.3174s
	iters: 200, epoch: 24 | loss: 0.0774529
	speed: 0.0266s/iter; left time: 453.9809s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0783730 Vali Loss: 0.0919080 Test Loss: 0.1053921
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0797093
	speed: 0.0507s/iter; left time: 858.3683s
	iters: 200, epoch: 25 | loss: 0.0817427
	speed: 0.0265s/iter; left time: 446.1017s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0782914 Vali Loss: 0.0914279 Test Loss: 0.1051226
Validation loss decreased (0.091518 --> 0.091428).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0797179
	speed: 0.0520s/iter; left time: 868.1012s
	iters: 200, epoch: 26 | loss: 0.0738131
	speed: 0.0264s/iter; left time: 437.5319s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0780965 Vali Loss: 0.0915349 Test Loss: 0.1052917
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0776839
	speed: 0.0510s/iter; left time: 840.6260s
	iters: 200, epoch: 27 | loss: 0.0815676
	speed: 0.0266s/iter; left time: 436.2955s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0779962 Vali Loss: 0.0915907 Test Loss: 0.1057428
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0834855
	speed: 0.0515s/iter; left time: 836.5873s
	iters: 200, epoch: 28 | loss: 0.0779398
	speed: 0.0263s/iter; left time: 424.1894s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0780605 Vali Loss: 0.0914833 Test Loss: 0.1049431
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0809719
	speed: 0.0509s/iter; left time: 815.9558s
	iters: 200, epoch: 29 | loss: 0.0730176
	speed: 0.0266s/iter; left time: 423.3475s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0779959 Vali Loss: 0.0912019 Test Loss: 0.1048643
Validation loss decreased (0.091428 --> 0.091202).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0792539
	speed: 0.0513s/iter; left time: 810.8188s
	iters: 200, epoch: 30 | loss: 0.0805271
	speed: 0.0265s/iter; left time: 415.5903s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0779152 Vali Loss: 0.0916280 Test Loss: 0.1053808
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0727329
	speed: 0.0507s/iter; left time: 789.5886s
	iters: 200, epoch: 31 | loss: 0.0777411
	speed: 0.0264s/iter; left time: 408.2922s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0778470 Vali Loss: 0.0914851 Test Loss: 0.1049981
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0777380
	speed: 0.0507s/iter; left time: 778.8636s
	iters: 200, epoch: 32 | loss: 0.0824563
	speed: 0.0264s/iter; left time: 402.4176s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0779417 Vali Loss: 0.0913363 Test Loss: 0.1053300
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0774576
	speed: 0.0507s/iter; left time: 767.8918s
	iters: 200, epoch: 33 | loss: 0.0775550
	speed: 0.0264s/iter; left time: 396.4873s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0778261 Vali Loss: 0.0914713 Test Loss: 0.1053499
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0793290
	speed: 0.0505s/iter; left time: 752.6819s
	iters: 200, epoch: 34 | loss: 0.0801169
	speed: 0.0265s/iter; left time: 392.9740s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0778284 Vali Loss: 0.0916595 Test Loss: 0.1053581
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0834418
	speed: 0.0512s/iter; left time: 751.3283s
	iters: 200, epoch: 35 | loss: 0.0801361
	speed: 0.0266s/iter; left time: 387.8585s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0777533 Vali Loss: 0.0913651 Test Loss: 0.1053995
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0738646
	speed: 0.0507s/iter; left time: 733.5634s
	iters: 200, epoch: 36 | loss: 0.0822736
	speed: 0.0265s/iter; left time: 380.8086s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0777149 Vali Loss: 0.0918364 Test Loss: 0.1053436
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0805845
	speed: 0.0507s/iter; left time: 722.0075s
	iters: 200, epoch: 37 | loss: 0.0764420
	speed: 0.0271s/iter; left time: 383.0728s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0777972 Vali Loss: 0.0913822 Test Loss: 0.1050786
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0802590
	speed: 0.0512s/iter; left time: 718.0743s
	iters: 200, epoch: 38 | loss: 0.0745805
	speed: 0.0264s/iter; left time: 367.2841s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0777992 Vali Loss: 0.0911898 Test Loss: 0.1048385
Validation loss decreased (0.091202 --> 0.091190).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0808173
	speed: 0.0519s/iter; left time: 715.7601s
	iters: 200, epoch: 39 | loss: 0.0738091
	speed: 0.0266s/iter; left time: 364.3881s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0777701 Vali Loss: 0.0913999 Test Loss: 0.1052986
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0709983
	speed: 0.0507s/iter; left time: 687.1930s
	iters: 200, epoch: 40 | loss: 0.0794273
	speed: 0.0263s/iter; left time: 354.4903s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0777075 Vali Loss: 0.0913741 Test Loss: 0.1051616
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0762141
	speed: 0.0508s/iter; left time: 677.8248s
	iters: 200, epoch: 41 | loss: 0.0792581
	speed: 0.0264s/iter; left time: 349.8896s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0776347 Vali Loss: 0.0914643 Test Loss: 0.1055149
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0765117
	speed: 0.0505s/iter; left time: 662.6103s
	iters: 200, epoch: 42 | loss: 0.0817911
	speed: 0.0266s/iter; left time: 346.0235s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0777820 Vali Loss: 0.0912480 Test Loss: 0.1051673
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0792320
	speed: 0.0520s/iter; left time: 670.1390s
	iters: 200, epoch: 43 | loss: 0.0746386
	speed: 0.0264s/iter; left time: 337.2650s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0775621 Vali Loss: 0.0913317 Test Loss: 0.1051571
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0815854
	speed: 0.0512s/iter; left time: 648.6464s
	iters: 200, epoch: 44 | loss: 0.0786278
	speed: 0.0265s/iter; left time: 332.5710s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0775377 Vali Loss: 0.0915934 Test Loss: 0.1054193
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0750691
	speed: 0.0516s/iter; left time: 642.0950s
	iters: 200, epoch: 45 | loss: 0.0801307
	speed: 0.0268s/iter; left time: 330.6310s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0775832 Vali Loss: 0.0914495 Test Loss: 0.1055241
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0750430
	speed: 0.0510s/iter; left time: 622.7631s
	iters: 200, epoch: 46 | loss: 0.0785095
	speed: 0.0264s/iter; left time: 320.0909s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0776136 Vali Loss: 0.0912142 Test Loss: 0.1048869
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0809008
	speed: 0.0508s/iter; left time: 609.0180s
	iters: 200, epoch: 47 | loss: 0.0786260
	speed: 0.0263s/iter; left time: 312.4288s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0776177 Vali Loss: 0.0914550 Test Loss: 0.1052804
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0809292
	speed: 0.0507s/iter; left time: 596.8191s
	iters: 200, epoch: 48 | loss: 0.0802007
	speed: 0.0265s/iter; left time: 309.3350s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0776070 Vali Loss: 0.0912948 Test Loss: 0.1048513
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.026396317407488823, rmse:0.16246943175792694, mae:0.10483850538730621, rse:0.5604735016822815
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2831325
	speed: 0.0285s/iter; left time: 634.9854s
	iters: 200, epoch: 1 | loss: 0.2748790
	speed: 0.0263s/iter; left time: 584.0651s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.2827698 Vali Loss: 0.2247546 Test Loss: 0.2389833
Validation loss decreased (inf --> 0.224755).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1392212
	speed: 0.0527s/iter; left time: 1162.4602s
	iters: 200, epoch: 2 | loss: 0.1127653
	speed: 0.0263s/iter; left time: 578.9710s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.1509554 Vali Loss: 0.1069294 Test Loss: 0.1218970
Validation loss decreased (0.224755 --> 0.106929).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1035824
	speed: 0.0514s/iter; left time: 1123.9124s
	iters: 200, epoch: 3 | loss: 0.0969158
	speed: 0.0263s/iter; left time: 571.9503s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.1004396 Vali Loss: 0.0970727 Test Loss: 0.1099363
Validation loss decreased (0.106929 --> 0.097073).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0924200
	speed: 0.0515s/iter; left time: 1113.3622s
	iters: 200, epoch: 4 | loss: 0.0912534
	speed: 0.0264s/iter; left time: 567.3194s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0904126 Vali Loss: 0.0982219 Test Loss: 0.1102611
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0849355
	speed: 0.0517s/iter; left time: 1107.6642s
	iters: 200, epoch: 5 | loss: 0.0868860
	speed: 0.0264s/iter; left time: 562.8759s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0871105 Vali Loss: 0.0962601 Test Loss: 0.1084892
Validation loss decreased (0.097073 --> 0.096260).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0850953
	speed: 0.0527s/iter; left time: 1115.3089s
	iters: 200, epoch: 6 | loss: 0.0857744
	speed: 0.0270s/iter; left time: 569.7825s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.0857400 Vali Loss: 0.0939873 Test Loss: 0.1071745
Validation loss decreased (0.096260 --> 0.093987).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0826016
	speed: 0.0530s/iter; left time: 1110.1893s
	iters: 200, epoch: 7 | loss: 0.0799290
	speed: 0.0272s/iter; left time: 567.4804s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.0844087 Vali Loss: 0.0949427 Test Loss: 0.1075168
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0785458
	speed: 0.0516s/iter; left time: 1069.1487s
	iters: 200, epoch: 8 | loss: 0.0849302
	speed: 0.0264s/iter; left time: 544.6200s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0831335 Vali Loss: 0.0931183 Test Loss: 0.1061979
Validation loss decreased (0.093987 --> 0.093118).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0863896
	speed: 0.0514s/iter; left time: 1054.8210s
	iters: 200, epoch: 9 | loss: 0.0786775
	speed: 0.0264s/iter; left time: 538.2264s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0824960 Vali Loss: 0.0940065 Test Loss: 0.1063517
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0834831
	speed: 0.0517s/iter; left time: 1048.3422s
	iters: 200, epoch: 10 | loss: 0.0846980
	speed: 0.0265s/iter; left time: 534.2815s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0817676 Vali Loss: 0.0926972 Test Loss: 0.1058642
Validation loss decreased (0.093118 --> 0.092697).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0831312
	speed: 0.0521s/iter; left time: 1044.6435s
	iters: 200, epoch: 11 | loss: 0.0779260
	speed: 0.0265s/iter; left time: 528.3286s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0816162 Vali Loss: 0.0923844 Test Loss: 0.1052562
Validation loss decreased (0.092697 --> 0.092384).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0804793
	speed: 0.0521s/iter; left time: 1033.8849s
	iters: 200, epoch: 12 | loss: 0.0829738
	speed: 0.0263s/iter; left time: 518.4916s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0814688 Vali Loss: 0.0933902 Test Loss: 0.1054446
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0787470
	speed: 0.0509s/iter; left time: 997.9265s
	iters: 200, epoch: 13 | loss: 0.0772950
	speed: 0.0263s/iter; left time: 512.8757s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0805543 Vali Loss: 0.0942995 Test Loss: 0.1063472
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0808383
	speed: 0.0518s/iter; left time: 1003.4389s
	iters: 200, epoch: 14 | loss: 0.0837163
	speed: 0.0264s/iter; left time: 508.3430s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0808124 Vali Loss: 0.0934229 Test Loss: 0.1068777
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0774124
	speed: 0.0512s/iter; left time: 981.4122s
	iters: 200, epoch: 15 | loss: 0.0799625
	speed: 0.0263s/iter; left time: 500.6385s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0800025 Vali Loss: 0.0928943 Test Loss: 0.1049107
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0760297
	speed: 0.0513s/iter; left time: 970.9940s
	iters: 200, epoch: 16 | loss: 0.0811618
	speed: 0.0264s/iter; left time: 496.8939s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0799718 Vali Loss: 0.0917975 Test Loss: 0.1047251
Validation loss decreased (0.092384 --> 0.091797).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0785883
	speed: 0.0518s/iter; left time: 970.3528s
	iters: 200, epoch: 17 | loss: 0.0792641
	speed: 0.0263s/iter; left time: 489.3725s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0796954 Vali Loss: 0.0927667 Test Loss: 0.1048445
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0823887
	speed: 0.0519s/iter; left time: 960.0942s
	iters: 200, epoch: 18 | loss: 0.0842160
	speed: 0.0264s/iter; left time: 486.0793s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0795874 Vali Loss: 0.0918494 Test Loss: 0.1048132
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0840449
	speed: 0.0510s/iter; left time: 931.9776s
	iters: 200, epoch: 19 | loss: 0.0781681
	speed: 0.0264s/iter; left time: 479.1304s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0795493 Vali Loss: 0.0929090 Test Loss: 0.1050895
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0819640
	speed: 0.0518s/iter; left time: 934.8575s
	iters: 200, epoch: 20 | loss: 0.0777349
	speed: 0.0270s/iter; left time: 484.3165s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0791481 Vali Loss: 0.0918442 Test Loss: 0.1043831
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0832979
	speed: 0.0522s/iter; left time: 930.0349s
	iters: 200, epoch: 21 | loss: 0.0786715
	speed: 0.0267s/iter; left time: 473.4174s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0789646 Vali Loss: 0.0917289 Test Loss: 0.1042227
Validation loss decreased (0.091797 --> 0.091729).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0795581
	speed: 0.0516s/iter; left time: 908.4547s
	iters: 200, epoch: 22 | loss: 0.0778644
	speed: 0.0263s/iter; left time: 460.3737s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0788485 Vali Loss: 0.0922574 Test Loss: 0.1046677
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0764752
	speed: 0.0512s/iter; left time: 889.9035s
	iters: 200, epoch: 23 | loss: 0.0785109
	speed: 0.0263s/iter; left time: 454.4788s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0787337 Vali Loss: 0.0916821 Test Loss: 0.1044795
Validation loss decreased (0.091729 --> 0.091682).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0790807
	speed: 0.0519s/iter; left time: 890.5109s
	iters: 200, epoch: 24 | loss: 0.0744595
	speed: 0.0264s/iter; left time: 449.9300s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0786183 Vali Loss: 0.0923451 Test Loss: 0.1047116
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0769751
	speed: 0.0514s/iter; left time: 869.3717s
	iters: 200, epoch: 25 | loss: 0.0824329
	speed: 0.0263s/iter; left time: 442.7684s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0786068 Vali Loss: 0.0919198 Test Loss: 0.1043650
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0814634
	speed: 0.0518s/iter; left time: 865.7523s
	iters: 200, epoch: 26 | loss: 0.0791285
	speed: 0.0263s/iter; left time: 437.1522s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0784842 Vali Loss: 0.0912537 Test Loss: 0.1041023
Validation loss decreased (0.091682 --> 0.091254).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0782784
	speed: 0.0519s/iter; left time: 855.9210s
	iters: 200, epoch: 27 | loss: 0.0819619
	speed: 0.0264s/iter; left time: 431.8538s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0785140 Vali Loss: 0.0914912 Test Loss: 0.1041647
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0745717
	speed: 0.0510s/iter; left time: 828.2621s
	iters: 200, epoch: 28 | loss: 0.0787156
	speed: 0.0265s/iter; left time: 427.7901s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0785302 Vali Loss: 0.0916318 Test Loss: 0.1041128
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0762582
	speed: 0.0514s/iter; left time: 824.3721s
	iters: 200, epoch: 29 | loss: 0.0878928
	speed: 0.0264s/iter; left time: 420.8700s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0784402 Vali Loss: 0.0915924 Test Loss: 0.1043333
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0758294
	speed: 0.0512s/iter; left time: 809.3834s
	iters: 200, epoch: 30 | loss: 0.0773198
	speed: 0.0264s/iter; left time: 414.5511s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0781407 Vali Loss: 0.0916876 Test Loss: 0.1042017
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0804063
	speed: 0.0507s/iter; left time: 790.4607s
	iters: 200, epoch: 31 | loss: 0.0762394
	speed: 0.0264s/iter; left time: 407.9582s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0782146 Vali Loss: 0.0916409 Test Loss: 0.1041947
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0734557
	speed: 0.0512s/iter; left time: 787.0077s
	iters: 200, epoch: 32 | loss: 0.0786449
	speed: 0.0267s/iter; left time: 407.0253s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0781491 Vali Loss: 0.0913309 Test Loss: 0.1041235
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0799010
	speed: 0.0511s/iter; left time: 772.9220s
	iters: 200, epoch: 33 | loss: 0.0813502
	speed: 0.0263s/iter; left time: 394.8730s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0781196 Vali Loss: 0.0915800 Test Loss: 0.1043300
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0787300
	speed: 0.0517s/iter; left time: 770.1646s
	iters: 200, epoch: 34 | loss: 0.0830562
	speed: 0.0266s/iter; left time: 394.3150s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0780620 Vali Loss: 0.0923515 Test Loss: 0.1049419
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0719172
	speed: 0.0513s/iter; left time: 753.7581s
	iters: 200, epoch: 35 | loss: 0.0790544
	speed: 0.0266s/iter; left time: 387.5144s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0780186 Vali Loss: 0.0913748 Test Loss: 0.1041244
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0840530
	speed: 0.0513s/iter; left time: 741.9974s
	iters: 200, epoch: 36 | loss: 0.0817567
	speed: 0.0268s/iter; left time: 384.3797s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0780826 Vali Loss: 0.0917967 Test Loss: 0.1043762
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025816407054662704, rmse:0.16067485511302948, mae:0.10410226881504059, rse:0.5542826652526855
Intermediate time for GB and pred_len 24: 00h:11m:07.08s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2814036
	speed: 0.0521s/iter; left time: 1161.3120s
	iters: 200, epoch: 1 | loss: 0.2753287
	speed: 0.0267s/iter; left time: 593.5026s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.50s
Steps: 224 | Train Loss: 0.2828317 Vali Loss: 0.2363253 Test Loss: 0.2565018
Validation loss decreased (inf --> 0.236325).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1474670
	speed: 0.0527s/iter; left time: 1162.4719s
	iters: 200, epoch: 2 | loss: 0.1273948
	speed: 0.0267s/iter; left time: 587.2384s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.1595674 Vali Loss: 0.1317870 Test Loss: 0.1517740
Validation loss decreased (0.236325 --> 0.131787).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1161193
	speed: 0.0527s/iter; left time: 1151.7672s
	iters: 200, epoch: 3 | loss: 0.1116192
	speed: 0.0268s/iter; left time: 582.9938s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1176064 Vali Loss: 0.1224016 Test Loss: 0.1461472
Validation loss decreased (0.131787 --> 0.122402).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1084016
	speed: 0.0529s/iter; left time: 1143.3399s
	iters: 200, epoch: 4 | loss: 0.1096157
	speed: 0.0268s/iter; left time: 576.2966s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1117506 Vali Loss: 0.1229639 Test Loss: 0.1461970
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1102678
	speed: 0.0530s/iter; left time: 1133.5948s
	iters: 200, epoch: 5 | loss: 0.1033464
	speed: 0.0267s/iter; left time: 569.2240s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1091738 Vali Loss: 0.1245078 Test Loss: 0.1500876
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1108893
	speed: 0.0526s/iter; left time: 1114.3905s
	iters: 200, epoch: 6 | loss: 0.1105880
	speed: 0.0268s/iter; left time: 564.4466s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1074941 Vali Loss: 0.1217878 Test Loss: 0.1453244
Validation loss decreased (0.122402 --> 0.121788).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1112695
	speed: 0.0532s/iter; left time: 1114.2485s
	iters: 200, epoch: 7 | loss: 0.1039074
	speed: 0.0268s/iter; left time: 559.5262s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1066327 Vali Loss: 0.1223853 Test Loss: 0.1476428
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1067520
	speed: 0.0530s/iter; left time: 1098.8605s
	iters: 200, epoch: 8 | loss: 0.1073765
	speed: 0.0267s/iter; left time: 551.4561s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1057427 Vali Loss: 0.1224101 Test Loss: 0.1475627
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1046958
	speed: 0.0521s/iter; left time: 1068.5893s
	iters: 200, epoch: 9 | loss: 0.1060490
	speed: 0.0270s/iter; left time: 550.8499s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1051168 Vali Loss: 0.1220276 Test Loss: 0.1466655
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1066586
	speed: 0.0525s/iter; left time: 1064.2395s
	iters: 200, epoch: 10 | loss: 0.1026679
	speed: 0.0272s/iter; left time: 548.6985s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1048020 Vali Loss: 0.1225210 Test Loss: 0.1481434
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1041008
	speed: 0.0526s/iter; left time: 1054.8852s
	iters: 200, epoch: 11 | loss: 0.1051459
	speed: 0.0267s/iter; left time: 533.7162s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.1043860 Vali Loss: 0.1220439 Test Loss: 0.1479996
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1071432
	speed: 0.0517s/iter; left time: 1026.4725s
	iters: 200, epoch: 12 | loss: 0.1028520
	speed: 0.0267s/iter; left time: 526.0996s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.1038470 Vali Loss: 0.1223071 Test Loss: 0.1481694
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1030630
	speed: 0.0516s/iter; left time: 1012.7252s
	iters: 200, epoch: 13 | loss: 0.1053017
	speed: 0.0267s/iter; left time: 520.5989s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.1033771 Vali Loss: 0.1219326 Test Loss: 0.1481578
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1018425
	speed: 0.0519s/iter; left time: 1005.4070s
	iters: 200, epoch: 14 | loss: 0.1015304
	speed: 0.0267s/iter; left time: 515.2784s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.1031317 Vali Loss: 0.1236653 Test Loss: 0.1483163
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0979186
	speed: 0.0518s/iter; left time: 992.5996s
	iters: 200, epoch: 15 | loss: 0.1018396
	speed: 0.0267s/iter; left time: 509.5061s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1031128 Vali Loss: 0.1220715 Test Loss: 0.1481973
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1082179
	speed: 0.0519s/iter; left time: 982.5411s
	iters: 200, epoch: 16 | loss: 0.1085084
	speed: 0.0267s/iter; left time: 503.2558s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.1026982 Vali Loss: 0.1227267 Test Loss: 0.1496199
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04409452900290489, rmse:0.20998696982860565, mae:0.14532437920570374, rse:0.7261641621589661
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2846584
	speed: 0.0292s/iter; left time: 650.1794s
	iters: 200, epoch: 1 | loss: 0.2699768
	speed: 0.0268s/iter; left time: 595.4413s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.2836303 Vali Loss: 0.2366667 Test Loss: 0.2559556
Validation loss decreased (inf --> 0.236667).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1467806
	speed: 0.0536s/iter; left time: 1183.9823s
	iters: 200, epoch: 2 | loss: 0.1212378
	speed: 0.0267s/iter; left time: 586.1307s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1587569 Vali Loss: 0.1335573 Test Loss: 0.1563327
Validation loss decreased (0.236667 --> 0.133557).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1182128
	speed: 0.0531s/iter; left time: 1159.8147s
	iters: 200, epoch: 3 | loss: 0.1108566
	speed: 0.0267s/iter; left time: 580.9927s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1174105 Vali Loss: 0.1239376 Test Loss: 0.1492593
Validation loss decreased (0.133557 --> 0.123938).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1095036
	speed: 0.0537s/iter; left time: 1161.5073s
	iters: 200, epoch: 4 | loss: 0.1127791
	speed: 0.0267s/iter; left time: 573.9902s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1116511 Vali Loss: 0.1268119 Test Loss: 0.1492081
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1085521
	speed: 0.0527s/iter; left time: 1127.8519s
	iters: 200, epoch: 5 | loss: 0.1101375
	speed: 0.0270s/iter; left time: 574.6277s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1089843 Vali Loss: 0.1230369 Test Loss: 0.1471350
Validation loss decreased (0.123938 --> 0.123037).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1056317
	speed: 0.0537s/iter; left time: 1136.3907s
	iters: 200, epoch: 6 | loss: 0.1103429
	speed: 0.0267s/iter; left time: 562.9603s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1079973 Vali Loss: 0.1220587 Test Loss: 0.1466280
Validation loss decreased (0.123037 --> 0.122059).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1001976
	speed: 0.0535s/iter; left time: 1121.5434s
	iters: 200, epoch: 7 | loss: 0.1116034
	speed: 0.0267s/iter; left time: 556.6957s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.1067057 Vali Loss: 0.1223284 Test Loss: 0.1477152
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1038238
	speed: 0.0528s/iter; left time: 1095.2135s
	iters: 200, epoch: 8 | loss: 0.1031946
	speed: 0.0268s/iter; left time: 552.1388s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1062257 Vali Loss: 0.1221051 Test Loss: 0.1471668
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1042598
	speed: 0.0530s/iter; left time: 1087.5716s
	iters: 200, epoch: 9 | loss: 0.1046804
	speed: 0.0267s/iter; left time: 544.4659s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.1050419 Vali Loss: 0.1221812 Test Loss: 0.1481853
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1037594
	speed: 0.0530s/iter; left time: 1074.6176s
	iters: 200, epoch: 10 | loss: 0.1060991
	speed: 0.0267s/iter; left time: 539.1450s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.1045060 Vali Loss: 0.1221735 Test Loss: 0.1489151
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1025115
	speed: 0.0537s/iter; left time: 1076.2830s
	iters: 200, epoch: 11 | loss: 0.1044383
	speed: 0.0267s/iter; left time: 532.8554s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.1040485 Vali Loss: 0.1244292 Test Loss: 0.1488840
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1007124
	speed: 0.0524s/iter; left time: 1039.9118s
	iters: 200, epoch: 12 | loss: 0.0999209
	speed: 0.0265s/iter; left time: 522.3538s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.1041343 Vali Loss: 0.1233486 Test Loss: 0.1491758
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1018817
	speed: 0.0534s/iter; left time: 1048.2999s
	iters: 200, epoch: 13 | loss: 0.1073372
	speed: 0.0266s/iter; left time: 519.4013s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1034051 Vali Loss: 0.1221586 Test Loss: 0.1487453
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0980571
	speed: 0.0536s/iter; left time: 1039.5974s
	iters: 200, epoch: 14 | loss: 0.0966746
	speed: 0.0269s/iter; left time: 519.0697s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1033476 Vali Loss: 0.1220342 Test Loss: 0.1475085
Validation loss decreased (0.122059 --> 0.122034).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1018572
	speed: 0.0539s/iter; left time: 1032.0988s
	iters: 200, epoch: 15 | loss: 0.1013139
	speed: 0.0269s/iter; left time: 512.0799s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1029051 Vali Loss: 0.1224381 Test Loss: 0.1489764
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1042031
	speed: 0.0535s/iter; left time: 1012.6724s
	iters: 200, epoch: 16 | loss: 0.1017121
	speed: 0.0266s/iter; left time: 500.4321s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1027763 Vali Loss: 0.1224150 Test Loss: 0.1491477
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1016523
	speed: 0.0529s/iter; left time: 989.2444s
	iters: 200, epoch: 17 | loss: 0.1017423
	speed: 0.0267s/iter; left time: 497.1393s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1026483 Vali Loss: 0.1224918 Test Loss: 0.1497179
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0996995
	speed: 0.0546s/iter; left time: 1010.5751s
	iters: 200, epoch: 18 | loss: 0.0996360
	speed: 0.0267s/iter; left time: 491.6321s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1022454 Vali Loss: 0.1228503 Test Loss: 0.1507155
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1015451
	speed: 0.0533s/iter; left time: 973.9086s
	iters: 200, epoch: 19 | loss: 0.1031634
	speed: 0.0267s/iter; left time: 484.6144s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1021936 Vali Loss: 0.1234197 Test Loss: 0.1504315
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1040580
	speed: 0.0536s/iter; left time: 966.4951s
	iters: 200, epoch: 20 | loss: 0.1058707
	speed: 0.0266s/iter; left time: 477.9318s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1020462 Vali Loss: 0.1223244 Test Loss: 0.1498982
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0979514
	speed: 0.0533s/iter; left time: 949.1253s
	iters: 200, epoch: 21 | loss: 0.1028729
	speed: 0.0267s/iter; left time: 472.7048s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1021163 Vali Loss: 0.1223535 Test Loss: 0.1498355
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1017197
	speed: 0.0531s/iter; left time: 934.0271s
	iters: 200, epoch: 22 | loss: 0.1024606
	speed: 0.0265s/iter; left time: 463.6743s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.1019055 Vali Loss: 0.1225047 Test Loss: 0.1504854
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0987281
	speed: 0.0527s/iter; left time: 914.7572s
	iters: 200, epoch: 23 | loss: 0.0985532
	speed: 0.0266s/iter; left time: 459.9213s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1016765 Vali Loss: 0.1227167 Test Loss: 0.1502586
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0983642
	speed: 0.0534s/iter; left time: 915.5519s
	iters: 200, epoch: 24 | loss: 0.1002519
	speed: 0.0266s/iter; left time: 454.2678s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1015580 Vali Loss: 0.1238900 Test Loss: 0.1516141
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04726178199052811, rmse:0.2173977494239807, mae:0.1475084275007248, rse:0.751791775226593
Intermediate time for GB and pred_len 96: 00h:05m:31.57s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2818827
	speed: 0.0516s/iter; left time: 1145.7299s
	iters: 200, epoch: 1 | loss: 0.2665040
	speed: 0.0270s/iter; left time: 596.0770s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.52s
Steps: 223 | Train Loss: 0.2841303 Vali Loss: 0.2368239 Test Loss: 0.2563688
Validation loss decreased (inf --> 0.236824).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1424722
	speed: 0.0540s/iter; left time: 1187.1126s
	iters: 200, epoch: 2 | loss: 0.1319111
	speed: 0.0271s/iter; left time: 592.1765s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1594881 Vali Loss: 0.1341513 Test Loss: 0.1558863
Validation loss decreased (0.236824 --> 0.134151).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1212322
	speed: 0.0541s/iter; left time: 1177.9296s
	iters: 200, epoch: 3 | loss: 0.1163176
	speed: 0.0269s/iter; left time: 582.2077s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1208286 Vali Loss: 0.1281839 Test Loss: 0.1570600
Validation loss decreased (0.134151 --> 0.128184).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1163680
	speed: 0.0550s/iter; left time: 1183.3326s
	iters: 200, epoch: 4 | loss: 0.1215556
	speed: 0.0268s/iter; left time: 575.3869s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1158307 Vali Loss: 0.1278227 Test Loss: 0.1549095
Validation loss decreased (0.128184 --> 0.127823).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1092537
	speed: 0.0543s/iter; left time: 1156.0976s
	iters: 200, epoch: 5 | loss: 0.1196612
	speed: 0.0269s/iter; left time: 570.8296s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1134607 Vali Loss: 0.1279475 Test Loss: 0.1562080
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1147250
	speed: 0.0528s/iter; left time: 1112.8738s
	iters: 200, epoch: 6 | loss: 0.1129685
	speed: 0.0269s/iter; left time: 563.9213s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.1122165 Vali Loss: 0.1273455 Test Loss: 0.1527181
Validation loss decreased (0.127823 --> 0.127345).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1098032
	speed: 0.0528s/iter; left time: 1101.0993s
	iters: 200, epoch: 7 | loss: 0.1037844
	speed: 0.0269s/iter; left time: 558.6205s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.1107435 Vali Loss: 0.1265944 Test Loss: 0.1525330
Validation loss decreased (0.127345 --> 0.126594).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1080589
	speed: 0.0538s/iter; left time: 1110.8850s
	iters: 200, epoch: 8 | loss: 0.1135441
	speed: 0.0269s/iter; left time: 551.7355s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.1100194 Vali Loss: 0.1267046 Test Loss: 0.1521989
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1114064
	speed: 0.0535s/iter; left time: 1092.1450s
	iters: 200, epoch: 9 | loss: 0.1044170
	speed: 0.0270s/iter; left time: 548.3205s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1092463 Vali Loss: 0.1267319 Test Loss: 0.1544835
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1059442
	speed: 0.0527s/iter; left time: 1064.1076s
	iters: 200, epoch: 10 | loss: 0.1071255
	speed: 0.0269s/iter; left time: 541.4820s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1092395 Vali Loss: 0.1275749 Test Loss: 0.1536383
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1064268
	speed: 0.0523s/iter; left time: 1043.8998s
	iters: 200, epoch: 11 | loss: 0.1085364
	speed: 0.0270s/iter; left time: 536.6946s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1086081 Vali Loss: 0.1268966 Test Loss: 0.1543059
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1044744
	speed: 0.0523s/iter; left time: 1033.4242s
	iters: 200, epoch: 12 | loss: 0.1057234
	speed: 0.0268s/iter; left time: 526.2600s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.21s
Steps: 223 | Train Loss: 0.1079693 Vali Loss: 0.1271530 Test Loss: 0.1547495
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1104869
	speed: 0.0533s/iter; left time: 1040.7659s
	iters: 200, epoch: 13 | loss: 0.1099807
	speed: 0.0269s/iter; left time: 523.1679s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1076578 Vali Loss: 0.1258683 Test Loss: 0.1548358
Validation loss decreased (0.126594 --> 0.125868).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1087319
	speed: 0.0538s/iter; left time: 1038.9436s
	iters: 200, epoch: 14 | loss: 0.1076828
	speed: 0.0270s/iter; left time: 518.1532s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1073149 Vali Loss: 0.1271001 Test Loss: 0.1564167
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1079066
	speed: 0.0533s/iter; left time: 1017.3473s
	iters: 200, epoch: 15 | loss: 0.1118923
	speed: 0.0270s/iter; left time: 512.1101s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1070774 Vali Loss: 0.1279857 Test Loss: 0.1554484
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1058325
	speed: 0.0532s/iter; left time: 1002.6135s
	iters: 200, epoch: 16 | loss: 0.1115175
	speed: 0.0270s/iter; left time: 506.3136s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.1067632 Vali Loss: 0.1271370 Test Loss: 0.1564911
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1060647
	speed: 0.0529s/iter; left time: 984.8497s
	iters: 200, epoch: 17 | loss: 0.1118538
	speed: 0.0270s/iter; left time: 500.2927s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1066689 Vali Loss: 0.1275171 Test Loss: 0.1562652
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1085790
	speed: 0.0533s/iter; left time: 981.5909s
	iters: 200, epoch: 18 | loss: 0.1064080
	speed: 0.0270s/iter; left time: 494.2950s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1064147 Vali Loss: 0.1272083 Test Loss: 0.1565073
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1063684
	speed: 0.0528s/iter; left time: 961.0433s
	iters: 200, epoch: 19 | loss: 0.1050237
	speed: 0.0269s/iter; left time: 487.2226s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1064823 Vali Loss: 0.1276555 Test Loss: 0.1556628
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1101118
	speed: 0.0529s/iter; left time: 950.0410s
	iters: 200, epoch: 20 | loss: 0.1062415
	speed: 0.0269s/iter; left time: 481.3326s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1061652 Vali Loss: 0.1275631 Test Loss: 0.1559166
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1057082
	speed: 0.0533s/iter; left time: 946.3014s
	iters: 200, epoch: 21 | loss: 0.1068663
	speed: 0.0269s/iter; left time: 474.8646s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1059219 Vali Loss: 0.1272919 Test Loss: 0.1561544
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1041760
	speed: 0.0527s/iter; left time: 922.3411s
	iters: 200, epoch: 22 | loss: 0.1125320
	speed: 0.0270s/iter; left time: 469.8628s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1058360 Vali Loss: 0.1276802 Test Loss: 0.1565375
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1073441
	speed: 0.0527s/iter; left time: 910.6097s
	iters: 200, epoch: 23 | loss: 0.1092194
	speed: 0.0270s/iter; left time: 464.7364s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1057776 Vali Loss: 0.1272340 Test Loss: 0.1571711
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.049206092953681946, rmse:0.22182446718215942, mae:0.15483571588993073, rse:0.7690972685813904
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2795618
	speed: 0.0292s/iter; left time: 647.4021s
	iters: 200, epoch: 1 | loss: 0.2796665
	speed: 0.0270s/iter; left time: 596.5963s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.2873887 Vali Loss: 0.2419844 Test Loss: 0.2583843
Validation loss decreased (inf --> 0.241984).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1467684
	speed: 0.0542s/iter; left time: 1190.1795s
	iters: 200, epoch: 2 | loss: 0.1370764
	speed: 0.0268s/iter; left time: 585.3150s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1619935 Vali Loss: 0.1329342 Test Loss: 0.1557617
Validation loss decreased (0.241984 --> 0.132934).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1239461
	speed: 0.0547s/iter; left time: 1190.1673s
	iters: 200, epoch: 3 | loss: 0.1191477
	speed: 0.0268s/iter; left time: 579.9736s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.1212261 Vali Loss: 0.1291059 Test Loss: 0.1607811
Validation loss decreased (0.132934 --> 0.129106).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1183607
	speed: 0.0543s/iter; left time: 1168.2171s
	iters: 200, epoch: 4 | loss: 0.1134157
	speed: 0.0268s/iter; left time: 574.6369s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1153331 Vali Loss: 0.1264300 Test Loss: 0.1516634
Validation loss decreased (0.129106 --> 0.126430).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1158319
	speed: 0.0552s/iter; left time: 1175.8985s
	iters: 200, epoch: 5 | loss: 0.1141421
	speed: 0.0270s/iter; left time: 572.0923s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1133761 Vali Loss: 0.1266857 Test Loss: 0.1515137
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1114554
	speed: 0.0542s/iter; left time: 1143.5219s
	iters: 200, epoch: 6 | loss: 0.1133449
	speed: 0.0269s/iter; left time: 565.1775s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1120483 Vali Loss: 0.1270977 Test Loss: 0.1518112
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1107215
	speed: 0.0548s/iter; left time: 1142.8942s
	iters: 200, epoch: 7 | loss: 0.1120520
	speed: 0.0271s/iter; left time: 562.8978s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1109283 Vali Loss: 0.1266328 Test Loss: 0.1500296
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1137405
	speed: 0.0540s/iter; left time: 1113.9764s
	iters: 200, epoch: 8 | loss: 0.1111502
	speed: 0.0271s/iter; left time: 555.6368s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1102262 Vali Loss: 0.1283991 Test Loss: 0.1520599
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1074144
	speed: 0.0545s/iter; left time: 1112.1959s
	iters: 200, epoch: 9 | loss: 0.1080249
	speed: 0.0270s/iter; left time: 548.0270s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1095048 Vali Loss: 0.1269158 Test Loss: 0.1524674
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1141485
	speed: 0.0539s/iter; left time: 1088.3401s
	iters: 200, epoch: 10 | loss: 0.1097387
	speed: 0.0270s/iter; left time: 542.0034s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.1087921 Vali Loss: 0.1275121 Test Loss: 0.1524081
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1074808
	speed: 0.0545s/iter; left time: 1088.7350s
	iters: 200, epoch: 11 | loss: 0.1133830
	speed: 0.0271s/iter; left time: 537.6079s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1082795 Vali Loss: 0.1264917 Test Loss: 0.1526808
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1047437
	speed: 0.0538s/iter; left time: 1062.3840s
	iters: 200, epoch: 12 | loss: 0.1077340
	speed: 0.0270s/iter; left time: 530.4994s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.25s
Steps: 223 | Train Loss: 0.1078610 Vali Loss: 0.1269894 Test Loss: 0.1548681
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1090030
	speed: 0.0546s/iter; left time: 1065.6033s
	iters: 200, epoch: 13 | loss: 0.1128828
	speed: 0.0270s/iter; left time: 524.1187s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1076234 Vali Loss: 0.1268795 Test Loss: 0.1549348
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1104816
	speed: 0.0544s/iter; left time: 1050.3553s
	iters: 200, epoch: 14 | loss: 0.1079465
	speed: 0.0270s/iter; left time: 518.5130s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1073064 Vali Loss: 0.1277648 Test Loss: 0.1556179
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04769879952073097, rmse:0.21840055286884308, mae:0.1516633927822113, rse:0.7572260499000549
Intermediate time for GB and pred_len 168: 00h:05m:11.16sIntermediate time for GB: 00h:21m:49.81s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2708257
	speed: 0.0431s/iter; left time: 961.8683s
	iters: 200, epoch: 1 | loss: 0.2622724
	speed: 0.0172s/iter; left time: 382.3562s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.2779982 Vali Loss: 0.2074505 Test Loss: 0.2332473
Validation loss decreased (inf --> 0.207451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1510847
	speed: 0.0377s/iter; left time: 832.8636s
	iters: 200, epoch: 2 | loss: 0.1117425
	speed: 0.0178s/iter; left time: 390.1154s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.1574519 Vali Loss: 0.0915035 Test Loss: 0.0991069
Validation loss decreased (0.207451 --> 0.091504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1003834
	speed: 0.0362s/iter; left time: 790.3797s
	iters: 200, epoch: 3 | loss: 0.0931744
	speed: 0.0178s/iter; left time: 388.2166s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.1002942 Vali Loss: 0.0830410 Test Loss: 0.0912976
Validation loss decreased (0.091504 --> 0.083041).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0863603
	speed: 0.0375s/iter; left time: 812.0179s
	iters: 200, epoch: 4 | loss: 0.0836940
	speed: 0.0174s/iter; left time: 374.5555s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0864073 Vali Loss: 0.0718561 Test Loss: 0.0806061
Validation loss decreased (0.083041 --> 0.071856).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0736417
	speed: 0.0362s/iter; left time: 774.3423s
	iters: 200, epoch: 5 | loss: 0.0762774
	speed: 0.0172s/iter; left time: 367.4864s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0774616 Vali Loss: 0.0680598 Test Loss: 0.0780765
Validation loss decreased (0.071856 --> 0.068060).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0711824
	speed: 0.0370s/iter; left time: 783.2915s
	iters: 200, epoch: 6 | loss: 0.0742073
	speed: 0.0172s/iter; left time: 363.2834s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0727056 Vali Loss: 0.0657509 Test Loss: 0.0764956
Validation loss decreased (0.068060 --> 0.065751).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0758830
	speed: 0.0363s/iter; left time: 759.8080s
	iters: 200, epoch: 7 | loss: 0.0721870
	speed: 0.0172s/iter; left time: 358.6724s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0708751 Vali Loss: 0.0660416 Test Loss: 0.0778710
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0714698
	speed: 0.0356s/iter; left time: 738.7222s
	iters: 200, epoch: 8 | loss: 0.0658485
	speed: 0.0174s/iter; left time: 359.9211s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0689583 Vali Loss: 0.0642446 Test Loss: 0.0767666
Validation loss decreased (0.065751 --> 0.064245).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0694290
	speed: 0.0374s/iter; left time: 766.3435s
	iters: 200, epoch: 9 | loss: 0.0644000
	speed: 0.0175s/iter; left time: 356.1884s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0676455 Vali Loss: 0.0636601 Test Loss: 0.0770834
Validation loss decreased (0.064245 --> 0.063660).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0700247
	speed: 0.0396s/iter; left time: 803.6515s
	iters: 200, epoch: 10 | loss: 0.0655249
	speed: 0.0172s/iter; left time: 347.2225s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0667840 Vali Loss: 0.0626065 Test Loss: 0.0754004
Validation loss decreased (0.063660 --> 0.062607).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0672422
	speed: 0.0398s/iter; left time: 797.4488s
	iters: 200, epoch: 11 | loss: 0.0646161
	speed: 0.0172s/iter; left time: 344.2409s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0662278 Vali Loss: 0.0625945 Test Loss: 0.0761153
Validation loss decreased (0.062607 --> 0.062595).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0648139
	speed: 0.0360s/iter; left time: 714.0072s
	iters: 200, epoch: 12 | loss: 0.0664951
	speed: 0.0193s/iter; left time: 380.1342s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0654111 Vali Loss: 0.0617924 Test Loss: 0.0757005
Validation loss decreased (0.062595 --> 0.061792).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0622444
	speed: 0.0369s/iter; left time: 724.5179s
	iters: 200, epoch: 13 | loss: 0.0599254
	speed: 0.0174s/iter; left time: 338.5729s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0647105 Vali Loss: 0.0609597 Test Loss: 0.0746203
Validation loss decreased (0.061792 --> 0.060960).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0647993
	speed: 0.0363s/iter; left time: 702.9770s
	iters: 200, epoch: 14 | loss: 0.0610652
	speed: 0.0175s/iter; left time: 337.2731s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0643186 Vali Loss: 0.0609952 Test Loss: 0.0744172
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0624425
	speed: 0.0359s/iter; left time: 687.0738s
	iters: 200, epoch: 15 | loss: 0.0644481
	speed: 0.0173s/iter; left time: 330.1042s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0640143 Vali Loss: 0.0605438 Test Loss: 0.0741187
Validation loss decreased (0.060960 --> 0.060544).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0600056
	speed: 0.0369s/iter; left time: 698.4483s
	iters: 200, epoch: 16 | loss: 0.0635128
	speed: 0.0174s/iter; left time: 327.9892s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0634908 Vali Loss: 0.0608249 Test Loss: 0.0749933
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0606074
	speed: 0.0401s/iter; left time: 750.1237s
	iters: 200, epoch: 17 | loss: 0.0622914
	speed: 0.0175s/iter; left time: 324.9580s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0630818 Vali Loss: 0.0603432 Test Loss: 0.0748148
Validation loss decreased (0.060544 --> 0.060343).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0615552
	speed: 0.0376s/iter; left time: 696.0776s
	iters: 200, epoch: 18 | loss: 0.0634372
	speed: 0.0175s/iter; left time: 321.4361s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0628284 Vali Loss: 0.0602996 Test Loss: 0.0743554
Validation loss decreased (0.060343 --> 0.060300).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0640946
	speed: 0.0389s/iter; left time: 709.9305s
	iters: 200, epoch: 19 | loss: 0.0632057
	speed: 0.0186s/iter; left time: 337.4349s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0628115 Vali Loss: 0.0604891 Test Loss: 0.0746229
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0630374
	speed: 0.0374s/iter; left time: 674.6480s
	iters: 200, epoch: 20 | loss: 0.0633529
	speed: 0.0203s/iter; left time: 364.4162s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0625326 Vali Loss: 0.0596575 Test Loss: 0.0737812
Validation loss decreased (0.060300 --> 0.059657).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0616223
	speed: 0.0387s/iter; left time: 689.1233s
	iters: 200, epoch: 21 | loss: 0.0649464
	speed: 0.0176s/iter; left time: 311.6238s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0621714 Vali Loss: 0.0597556 Test Loss: 0.0742557
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0627824
	speed: 0.0374s/iter; left time: 658.9723s
	iters: 200, epoch: 22 | loss: 0.0598262
	speed: 0.0179s/iter; left time: 313.8517s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.41s
Steps: 224 | Train Loss: 0.0622700 Vali Loss: 0.0598124 Test Loss: 0.0740635
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0619051
	speed: 0.0364s/iter; left time: 632.9487s
	iters: 200, epoch: 23 | loss: 0.0605921
	speed: 0.0218s/iter; left time: 376.1183s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0617665 Vali Loss: 0.0594863 Test Loss: 0.0737347
Validation loss decreased (0.059657 --> 0.059486).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0607017
	speed: 0.0374s/iter; left time: 640.6185s
	iters: 200, epoch: 24 | loss: 0.0636367
	speed: 0.0174s/iter; left time: 297.4201s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0617854 Vali Loss: 0.0594426 Test Loss: 0.0740125
Validation loss decreased (0.059486 --> 0.059443).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0673195
	speed: 0.0370s/iter; left time: 627.0664s
	iters: 200, epoch: 25 | loss: 0.0601358
	speed: 0.0173s/iter; left time: 291.1563s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0616259 Vali Loss: 0.0594604 Test Loss: 0.0745333
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0618991
	speed: 0.0359s/iter; left time: 599.4528s
	iters: 200, epoch: 26 | loss: 0.0608135
	speed: 0.0174s/iter; left time: 289.2792s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0614542 Vali Loss: 0.0593405 Test Loss: 0.0739550
Validation loss decreased (0.059443 --> 0.059341).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0631193
	speed: 0.0378s/iter; left time: 622.9195s
	iters: 200, epoch: 27 | loss: 0.0657145
	speed: 0.0175s/iter; left time: 285.8289s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0616794 Vali Loss: 0.0594699 Test Loss: 0.0737223
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0565359
	speed: 0.0352s/iter; left time: 572.6145s
	iters: 200, epoch: 28 | loss: 0.0595181
	speed: 0.0176s/iter; left time: 284.0410s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0612757 Vali Loss: 0.0591323 Test Loss: 0.0734891
Validation loss decreased (0.059341 --> 0.059132).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0586638
	speed: 0.0377s/iter; left time: 603.9051s
	iters: 200, epoch: 29 | loss: 0.0608017
	speed: 0.0176s/iter; left time: 280.1487s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0612530 Vali Loss: 0.0590975 Test Loss: 0.0735919
Validation loss decreased (0.059132 --> 0.059097).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0592039
	speed: 0.0378s/iter; left time: 598.1524s
	iters: 200, epoch: 30 | loss: 0.0614624
	speed: 0.0172s/iter; left time: 270.7232s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0612326 Vali Loss: 0.0595413 Test Loss: 0.0739768
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0617800
	speed: 0.0353s/iter; left time: 550.1535s
	iters: 200, epoch: 31 | loss: 0.0633619
	speed: 0.0172s/iter; left time: 267.0281s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0611033 Vali Loss: 0.0588847 Test Loss: 0.0730694
Validation loss decreased (0.059097 --> 0.058885).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0632723
	speed: 0.0362s/iter; left time: 555.4123s
	iters: 200, epoch: 32 | loss: 0.0576704
	speed: 0.0176s/iter; left time: 269.1563s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0609722 Vali Loss: 0.0589661 Test Loss: 0.0733982
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0627338
	speed: 0.0366s/iter; left time: 553.6994s
	iters: 200, epoch: 33 | loss: 0.0608308
	speed: 0.0175s/iter; left time: 262.5274s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0609542 Vali Loss: 0.0587706 Test Loss: 0.0731882
Validation loss decreased (0.058885 --> 0.058771).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0627589
	speed: 0.0357s/iter; left time: 532.3419s
	iters: 200, epoch: 34 | loss: 0.0576832
	speed: 0.0189s/iter; left time: 279.6784s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0610260 Vali Loss: 0.0588217 Test Loss: 0.0729814
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0592602
	speed: 0.0388s/iter; left time: 570.0832s
	iters: 200, epoch: 35 | loss: 0.0609397
	speed: 0.0189s/iter; left time: 275.6954s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0608695 Vali Loss: 0.0589980 Test Loss: 0.0734148
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0628913
	speed: 0.0379s/iter; left time: 548.7383s
	iters: 200, epoch: 36 | loss: 0.0595104
	speed: 0.0175s/iter; left time: 251.5391s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0607886 Vali Loss: 0.0588238 Test Loss: 0.0731824
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0592520
	speed: 0.0364s/iter; left time: 518.4111s
	iters: 200, epoch: 37 | loss: 0.0619801
	speed: 0.0174s/iter; left time: 246.0736s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0608522 Vali Loss: 0.0588781 Test Loss: 0.0733389
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0571876
	speed: 0.0387s/iter; left time: 541.9268s
	iters: 200, epoch: 38 | loss: 0.0626874
	speed: 0.0180s/iter; left time: 249.9739s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0609661 Vali Loss: 0.0588733 Test Loss: 0.0733372
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0603451
	speed: 0.0379s/iter; left time: 522.7241s
	iters: 200, epoch: 39 | loss: 0.0607890
	speed: 0.0204s/iter; left time: 279.7694s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.70s
Steps: 224 | Train Loss: 0.0607698 Vali Loss: 0.0588193 Test Loss: 0.0732570
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0569031
	speed: 0.0362s/iter; left time: 491.4571s
	iters: 200, epoch: 40 | loss: 0.0604230
	speed: 0.0173s/iter; left time: 232.4761s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0607826 Vali Loss: 0.0588016 Test Loss: 0.0730469
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0587654
	speed: 0.0353s/iter; left time: 470.5666s
	iters: 200, epoch: 41 | loss: 0.0610591
	speed: 0.0174s/iter; left time: 230.4923s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0606978 Vali Loss: 0.0587396 Test Loss: 0.0732739
Validation loss decreased (0.058771 --> 0.058740).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0635448
	speed: 0.0374s/iter; left time: 490.6760s
	iters: 200, epoch: 42 | loss: 0.0613662
	speed: 0.0177s/iter; left time: 229.9712s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0607116 Vali Loss: 0.0586978 Test Loss: 0.0730936
Validation loss decreased (0.058740 --> 0.058698).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0577063
	speed: 0.0375s/iter; left time: 482.9128s
	iters: 200, epoch: 43 | loss: 0.0591121
	speed: 0.0179s/iter; left time: 228.6328s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0606261 Vali Loss: 0.0589224 Test Loss: 0.0736936
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0624545
	speed: 0.0374s/iter; left time: 473.2334s
	iters: 200, epoch: 44 | loss: 0.0616844
	speed: 0.0177s/iter; left time: 222.8918s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0611692 Vali Loss: 0.0586782 Test Loss: 0.0729012
Validation loss decreased (0.058698 --> 0.058678).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0593653
	speed: 0.0367s/iter; left time: 456.1249s
	iters: 200, epoch: 45 | loss: 0.0636859
	speed: 0.0180s/iter; left time: 222.8020s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0605644 Vali Loss: 0.0586519 Test Loss: 0.0729312
Validation loss decreased (0.058678 --> 0.058652).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0588403
	speed: 0.0367s/iter; left time: 447.9213s
	iters: 200, epoch: 46 | loss: 0.0612193
	speed: 0.0173s/iter; left time: 209.3276s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0606294 Vali Loss: 0.0587211 Test Loss: 0.0729838
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0612823
	speed: 0.0371s/iter; left time: 444.5024s
	iters: 200, epoch: 47 | loss: 0.0574999
	speed: 0.0213s/iter; left time: 253.7182s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0608826 Vali Loss: 0.0586566 Test Loss: 0.0730382
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0617604
	speed: 0.0408s/iter; left time: 479.9069s
	iters: 200, epoch: 48 | loss: 0.0574106
	speed: 0.0184s/iter; left time: 215.2205s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0606421 Vali Loss: 0.0585935 Test Loss: 0.0729641
Validation loss decreased (0.058652 --> 0.058594).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0595661
	speed: 0.0370s/iter; left time: 427.1111s
	iters: 200, epoch: 49 | loss: 0.0651810
	speed: 0.0210s/iter; left time: 240.2620s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0605826 Vali Loss: 0.0586438 Test Loss: 0.0729285
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0635316
	speed: 0.0403s/iter; left time: 455.9508s
	iters: 200, epoch: 50 | loss: 0.0610907
	speed: 0.0192s/iter; left time: 215.3810s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0609660 Vali Loss: 0.0588212 Test Loss: 0.0732808
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0592435
	speed: 0.0364s/iter; left time: 403.8199s
	iters: 200, epoch: 51 | loss: 0.0632765
	speed: 0.0172s/iter; left time: 189.1344s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0606898 Vali Loss: 0.0586598 Test Loss: 0.0730526
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0635184
	speed: 0.0355s/iter; left time: 386.0589s
	iters: 200, epoch: 52 | loss: 0.0610863
	speed: 0.0174s/iter; left time: 187.8384s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0605371 Vali Loss: 0.0588704 Test Loss: 0.0736128
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0603129
	speed: 0.0368s/iter; left time: 392.5245s
	iters: 200, epoch: 53 | loss: 0.0641348
	speed: 0.0174s/iter; left time: 183.5541s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0606629 Vali Loss: 0.0587345 Test Loss: 0.0732306
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0610451
	speed: 0.0396s/iter; left time: 413.3096s
	iters: 200, epoch: 54 | loss: 0.0583071
	speed: 0.0227s/iter; left time: 234.2796s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0608471 Vali Loss: 0.0588552 Test Loss: 0.0735912
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0600205
	speed: 0.0401s/iter; left time: 409.7278s
	iters: 200, epoch: 55 | loss: 0.0605740
	speed: 0.0172s/iter; left time: 174.2211s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0605078 Vali Loss: 0.0587326 Test Loss: 0.0732537
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0583362
	speed: 0.0396s/iter; left time: 395.6195s
	iters: 200, epoch: 56 | loss: 0.0632899
	speed: 0.0220s/iter; left time: 217.6750s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0607032 Vali Loss: 0.0586046 Test Loss: 0.0729888
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0592648
	speed: 0.0368s/iter; left time: 359.5028s
	iters: 200, epoch: 57 | loss: 0.0603010
	speed: 0.0172s/iter; left time: 166.4651s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0605897 Vali Loss: 0.0587299 Test Loss: 0.0734092
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0576204
	speed: 0.0404s/iter; left time: 385.3957s
	iters: 200, epoch: 58 | loss: 0.0604421
	speed: 0.0172s/iter; left time: 162.3787s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.59s
Steps: 224 | Train Loss: 0.0606295 Vali Loss: 0.0587746 Test Loss: 0.0731275
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.012697300873696804, rmse:0.1126822978258133, mae:0.07296409457921982, rse:0.33161038160324097
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2723186
	speed: 0.0221s/iter; left time: 492.4084s
	iters: 200, epoch: 1 | loss: 0.2594370
	speed: 0.0175s/iter; left time: 388.9339s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.2804108 Vali Loss: 0.2111473 Test Loss: 0.2331517
Validation loss decreased (inf --> 0.211147).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1487849
	speed: 0.0380s/iter; left time: 838.0859s
	iters: 200, epoch: 2 | loss: 0.1122121
	speed: 0.0178s/iter; left time: 392.1645s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.1569681 Vali Loss: 0.0871886 Test Loss: 0.0957581
Validation loss decreased (0.211147 --> 0.087189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0998303
	speed: 0.0372s/iter; left time: 814.0209s
	iters: 200, epoch: 3 | loss: 0.0900539
	speed: 0.0225s/iter; left time: 489.4117s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0995899 Vali Loss: 0.0780850 Test Loss: 0.0863740
Validation loss decreased (0.087189 --> 0.078085).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0908242
	speed: 0.0389s/iter; left time: 840.8064s
	iters: 200, epoch: 4 | loss: 0.0860295
	speed: 0.0174s/iter; left time: 374.4297s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0868707 Vali Loss: 0.0739030 Test Loss: 0.0811787
Validation loss decreased (0.078085 --> 0.073903).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0818111
	speed: 0.0365s/iter; left time: 782.2635s
	iters: 200, epoch: 5 | loss: 0.0754183
	speed: 0.0173s/iter; left time: 367.6941s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0790223 Vali Loss: 0.0694488 Test Loss: 0.0807753
Validation loss decreased (0.073903 --> 0.069449).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0741047
	speed: 0.0364s/iter; left time: 770.4307s
	iters: 200, epoch: 6 | loss: 0.0749590
	speed: 0.0174s/iter; left time: 367.2747s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0735093 Vali Loss: 0.0666800 Test Loss: 0.0808575
Validation loss decreased (0.069449 --> 0.066680).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0736243
	speed: 0.0368s/iter; left time: 770.3161s
	iters: 200, epoch: 7 | loss: 0.0661629
	speed: 0.0173s/iter; left time: 359.8820s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0714205 Vali Loss: 0.0655510 Test Loss: 0.0802032
Validation loss decreased (0.066680 --> 0.065551).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0729664
	speed: 0.0362s/iter; left time: 750.8221s
	iters: 200, epoch: 8 | loss: 0.0714460
	speed: 0.0187s/iter; left time: 386.7971s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0694222 Vali Loss: 0.0644655 Test Loss: 0.0811112
Validation loss decreased (0.065551 --> 0.064465).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0659208
	speed: 0.0385s/iter; left time: 789.5922s
	iters: 200, epoch: 9 | loss: 0.0711732
	speed: 0.0180s/iter; left time: 366.5734s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0683030 Vali Loss: 0.0633331 Test Loss: 0.0808911
Validation loss decreased (0.064465 --> 0.063333).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0658178
	speed: 0.0370s/iter; left time: 750.0383s
	iters: 200, epoch: 10 | loss: 0.0632657
	speed: 0.0174s/iter; left time: 352.2262s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0671876 Vali Loss: 0.0626942 Test Loss: 0.0810161
Validation loss decreased (0.063333 --> 0.062694).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0675375
	speed: 0.0384s/iter; left time: 770.6675s
	iters: 200, epoch: 11 | loss: 0.0656089
	speed: 0.0185s/iter; left time: 368.9169s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0663821 Vali Loss: 0.0650089 Test Loss: 0.0835631
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0698378
	speed: 0.0362s/iter; left time: 717.3985s
	iters: 200, epoch: 12 | loss: 0.0709315
	speed: 0.0173s/iter; left time: 341.4758s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0658216 Vali Loss: 0.0622524 Test Loss: 0.0804868
Validation loss decreased (0.062694 --> 0.062252).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0702056
	speed: 0.0378s/iter; left time: 742.1324s
	iters: 200, epoch: 13 | loss: 0.0646744
	speed: 0.0178s/iter; left time: 347.5473s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0651245 Vali Loss: 0.0614892 Test Loss: 0.0798468
Validation loss decreased (0.062252 --> 0.061489).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0666263
	speed: 0.0365s/iter; left time: 706.8843s
	iters: 200, epoch: 14 | loss: 0.0637792
	speed: 0.0172s/iter; left time: 331.9585s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0645446 Vali Loss: 0.0609676 Test Loss: 0.0781604
Validation loss decreased (0.061489 --> 0.060968).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0713808
	speed: 0.0359s/iter; left time: 687.0857s
	iters: 200, epoch: 15 | loss: 0.0672789
	speed: 0.0172s/iter; left time: 327.9898s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0644304 Vali Loss: 0.0603074 Test Loss: 0.0764001
Validation loss decreased (0.060968 --> 0.060307).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0611395
	speed: 0.0399s/iter; left time: 755.9626s
	iters: 200, epoch: 16 | loss: 0.0639924
	speed: 0.0185s/iter; left time: 347.6895s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0638584 Vali Loss: 0.0604877 Test Loss: 0.0751136
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0645290
	speed: 0.0364s/iter; left time: 680.8836s
	iters: 200, epoch: 17 | loss: 0.0622595
	speed: 0.0175s/iter; left time: 324.9140s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0634671 Vali Loss: 0.0599232 Test Loss: 0.0762809
Validation loss decreased (0.060307 --> 0.059923).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0624876
	speed: 0.0362s/iter; left time: 670.0254s
	iters: 200, epoch: 18 | loss: 0.0637171
	speed: 0.0174s/iter; left time: 320.8195s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0630357 Vali Loss: 0.0595618 Test Loss: 0.0750244
Validation loss decreased (0.059923 --> 0.059562).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0617419
	speed: 0.0364s/iter; left time: 664.9845s
	iters: 200, epoch: 19 | loss: 0.0608804
	speed: 0.0181s/iter; left time: 329.5885s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0629090 Vali Loss: 0.0596770 Test Loss: 0.0742886
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0633113
	speed: 0.0355s/iter; left time: 640.7500s
	iters: 200, epoch: 20 | loss: 0.0655701
	speed: 0.0172s/iter; left time: 308.7671s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0625126 Vali Loss: 0.0595197 Test Loss: 0.0756664
Validation loss decreased (0.059562 --> 0.059520).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0628558
	speed: 0.0360s/iter; left time: 641.1518s
	iters: 200, epoch: 21 | loss: 0.0602739
	speed: 0.0175s/iter; left time: 309.5026s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0623610 Vali Loss: 0.0591243 Test Loss: 0.0753350
Validation loss decreased (0.059520 --> 0.059124).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0651103
	speed: 0.0360s/iter; left time: 634.1747s
	iters: 200, epoch: 22 | loss: 0.0575442
	speed: 0.0172s/iter; left time: 300.9765s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0621670 Vali Loss: 0.0592054 Test Loss: 0.0741855
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0664264
	speed: 0.0383s/iter; left time: 665.3958s
	iters: 200, epoch: 23 | loss: 0.0587535
	speed: 0.0204s/iter; left time: 352.1925s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0620225 Vali Loss: 0.0589292 Test Loss: 0.0742925
Validation loss decreased (0.059124 --> 0.058929).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0641541
	speed: 0.0411s/iter; left time: 704.7218s
	iters: 200, epoch: 24 | loss: 0.0634813
	speed: 0.0192s/iter; left time: 326.6584s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.77s
Steps: 224 | Train Loss: 0.0621247 Vali Loss: 0.0589253 Test Loss: 0.0734498
Validation loss decreased (0.058929 --> 0.058925).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0564462
	speed: 0.0393s/iter; left time: 664.4384s
	iters: 200, epoch: 25 | loss: 0.0637565
	speed: 0.0179s/iter; left time: 301.5824s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.41s
Steps: 224 | Train Loss: 0.0617372 Vali Loss: 0.0589466 Test Loss: 0.0749519
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0636609
	speed: 0.0386s/iter; left time: 645.4398s
	iters: 200, epoch: 26 | loss: 0.0584842
	speed: 0.0197s/iter; left time: 327.3689s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0616560 Vali Loss: 0.0590757 Test Loss: 0.0742946
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0581466
	speed: 0.0381s/iter; left time: 627.2260s
	iters: 200, epoch: 27 | loss: 0.0603953
	speed: 0.0173s/iter; left time: 283.4906s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0616052 Vali Loss: 0.0585262 Test Loss: 0.0741448
Validation loss decreased (0.058925 --> 0.058526).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0577278
	speed: 0.0414s/iter; left time: 672.7993s
	iters: 200, epoch: 28 | loss: 0.0644682
	speed: 0.0191s/iter; left time: 308.4929s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0618389 Vali Loss: 0.0587341 Test Loss: 0.0739767
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0625474
	speed: 0.0374s/iter; left time: 600.0340s
	iters: 200, epoch: 29 | loss: 0.0580867
	speed: 0.0173s/iter; left time: 275.1407s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0613939 Vali Loss: 0.0586087 Test Loss: 0.0742347
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0590229
	speed: 0.0360s/iter; left time: 569.2042s
	iters: 200, epoch: 30 | loss: 0.0606227
	speed: 0.0177s/iter; left time: 277.4562s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0611694 Vali Loss: 0.0584188 Test Loss: 0.0739610
Validation loss decreased (0.058526 --> 0.058419).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0643775
	speed: 0.0365s/iter; left time: 568.8613s
	iters: 200, epoch: 31 | loss: 0.0578023
	speed: 0.0175s/iter; left time: 270.8767s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0611918 Vali Loss: 0.0583375 Test Loss: 0.0744160
Validation loss decreased (0.058419 --> 0.058337).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0579711
	speed: 0.0386s/iter; left time: 593.2586s
	iters: 200, epoch: 32 | loss: 0.0620027
	speed: 0.0217s/iter; left time: 330.9704s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0612068 Vali Loss: 0.0583986 Test Loss: 0.0742417
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0653523
	speed: 0.0377s/iter; left time: 570.6031s
	iters: 200, epoch: 33 | loss: 0.0614485
	speed: 0.0174s/iter; left time: 261.9256s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0611182 Vali Loss: 0.0582882 Test Loss: 0.0733675
Validation loss decreased (0.058337 --> 0.058288).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0647610
	speed: 0.0373s/iter; left time: 556.1559s
	iters: 200, epoch: 34 | loss: 0.0633823
	speed: 0.0172s/iter; left time: 255.2070s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0610971 Vali Loss: 0.0584576 Test Loss: 0.0729061
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0626284
	speed: 0.0370s/iter; left time: 543.8397s
	iters: 200, epoch: 35 | loss: 0.0601387
	speed: 0.0174s/iter; left time: 253.5479s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0610140 Vali Loss: 0.0582965 Test Loss: 0.0737146
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0639531
	speed: 0.0383s/iter; left time: 554.4759s
	iters: 200, epoch: 36 | loss: 0.0608174
	speed: 0.0234s/iter; left time: 335.4104s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0611647 Vali Loss: 0.0582508 Test Loss: 0.0736249
Validation loss decreased (0.058288 --> 0.058251).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0602419
	speed: 0.0379s/iter; left time: 538.8731s
	iters: 200, epoch: 37 | loss: 0.0581153
	speed: 0.0173s/iter; left time: 244.8450s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0610484 Vali Loss: 0.0583448 Test Loss: 0.0732000
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0600050
	speed: 0.0365s/iter; left time: 511.9540s
	iters: 200, epoch: 38 | loss: 0.0618239
	speed: 0.0201s/iter; left time: 280.1040s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0609829 Vali Loss: 0.0584209 Test Loss: 0.0728817
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0601002
	speed: 0.0364s/iter; left time: 502.0879s
	iters: 200, epoch: 39 | loss: 0.0637596
	speed: 0.0172s/iter; left time: 235.9682s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0608545 Vali Loss: 0.0582400 Test Loss: 0.0727859
Validation loss decreased (0.058251 --> 0.058240).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0579164
	speed: 0.0365s/iter; left time: 495.6784s
	iters: 200, epoch: 40 | loss: 0.0646479
	speed: 0.0174s/iter; left time: 234.4913s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0608278 Vali Loss: 0.0582177 Test Loss: 0.0733635
Validation loss decreased (0.058240 --> 0.058218).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0616952
	speed: 0.0365s/iter; left time: 486.6934s
	iters: 200, epoch: 41 | loss: 0.0571715
	speed: 0.0172s/iter; left time: 228.3225s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0608960 Vali Loss: 0.0581996 Test Loss: 0.0732759
Validation loss decreased (0.058218 --> 0.058200).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0631871
	speed: 0.0396s/iter; left time: 519.5681s
	iters: 200, epoch: 42 | loss: 0.0568571
	speed: 0.0202s/iter; left time: 262.4273s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0608211 Vali Loss: 0.0580944 Test Loss: 0.0728690
Validation loss decreased (0.058200 --> 0.058094).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0618066
	speed: 0.0367s/iter; left time: 473.7841s
	iters: 200, epoch: 43 | loss: 0.0615122
	speed: 0.0173s/iter; left time: 220.7493s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0611374 Vali Loss: 0.0583234 Test Loss: 0.0724586
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0589104
	speed: 0.0361s/iter; left time: 457.3284s
	iters: 200, epoch: 44 | loss: 0.0627911
	speed: 0.0176s/iter; left time: 221.7782s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0609306 Vali Loss: 0.0582577 Test Loss: 0.0726218
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0628825
	speed: 0.0363s/iter; left time: 451.2431s
	iters: 200, epoch: 45 | loss: 0.0587390
	speed: 0.0175s/iter; left time: 215.7462s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0613185 Vali Loss: 0.0582871 Test Loss: 0.0725785
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0598876
	speed: 0.0362s/iter; left time: 442.6862s
	iters: 200, epoch: 46 | loss: 0.0615125
	speed: 0.0172s/iter; left time: 208.8586s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0608629 Vali Loss: 0.0581948 Test Loss: 0.0726809
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0631883
	speed: 0.0368s/iter; left time: 441.1357s
	iters: 200, epoch: 47 | loss: 0.0606678
	speed: 0.0180s/iter; left time: 214.5661s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0607024 Vali Loss: 0.0582297 Test Loss: 0.0723210
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0599459
	speed: 0.0377s/iter; left time: 443.7037s
	iters: 200, epoch: 48 | loss: 0.0553894
	speed: 0.0195s/iter; left time: 227.9092s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0608386 Vali Loss: 0.0579962 Test Loss: 0.0727201
Validation loss decreased (0.058094 --> 0.057996).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0578657
	speed: 0.0419s/iter; left time: 483.6811s
	iters: 200, epoch: 49 | loss: 0.0608033
	speed: 0.0197s/iter; left time: 225.2118s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.80s
Steps: 224 | Train Loss: 0.0609807 Vali Loss: 0.0581391 Test Loss: 0.0725509
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0621150
	speed: 0.0378s/iter; left time: 427.7616s
	iters: 200, epoch: 50 | loss: 0.0631911
	speed: 0.0172s/iter; left time: 193.5064s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0607364 Vali Loss: 0.0581990 Test Loss: 0.0728008
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0609419
	speed: 0.0377s/iter; left time: 418.7132s
	iters: 200, epoch: 51 | loss: 0.0609045
	speed: 0.0180s/iter; left time: 198.2711s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0605976 Vali Loss: 0.0580235 Test Loss: 0.0729227
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0613372
	speed: 0.0361s/iter; left time: 392.1944s
	iters: 200, epoch: 52 | loss: 0.0578110
	speed: 0.0174s/iter; left time: 187.2669s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0606016 Vali Loss: 0.0580805 Test Loss: 0.0728458
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0597081
	speed: 0.0395s/iter; left time: 420.8255s
	iters: 200, epoch: 53 | loss: 0.0599167
	speed: 0.0176s/iter; left time: 185.6117s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0606716 Vali Loss: 0.0581069 Test Loss: 0.0723052
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0602916
	speed: 0.0366s/iter; left time: 381.8918s
	iters: 200, epoch: 54 | loss: 0.0620375
	speed: 0.0183s/iter; left time: 188.8218s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0607120 Vali Loss: 0.0583016 Test Loss: 0.0727637
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0623368
	speed: 0.0356s/iter; left time: 363.1763s
	iters: 200, epoch: 55 | loss: 0.0654304
	speed: 0.0172s/iter; left time: 173.6876s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0606441 Vali Loss: 0.0581952 Test Loss: 0.0731348
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0625696
	speed: 0.0362s/iter; left time: 361.7058s
	iters: 200, epoch: 56 | loss: 0.0563569
	speed: 0.0196s/iter; left time: 193.2622s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0607840 Vali Loss: 0.0580681 Test Loss: 0.0729142
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0616411
	speed: 0.0371s/iter; left time: 361.9640s
	iters: 200, epoch: 57 | loss: 0.0601746
	speed: 0.0191s/iter; left time: 184.3597s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0605397 Vali Loss: 0.0581108 Test Loss: 0.0730427
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0618836
	speed: 0.0388s/iter; left time: 369.5926s
	iters: 200, epoch: 58 | loss: 0.0594452
	speed: 0.0175s/iter; left time: 165.1943s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0606900 Vali Loss: 0.0581163 Test Loss: 0.0726102
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01282523199915886, rmse:0.1132485419511795, mae:0.07272014766931534, rse:0.33327677845954895
Intermediate time for ES and pred_len 24: 00h:10m:55.45s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2699923
	speed: 0.0448s/iter; left time: 997.9702s
	iters: 200, epoch: 1 | loss: 0.2550710
	speed: 0.0179s/iter; left time: 396.6636s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.2779176 Vali Loss: 0.2090562 Test Loss: 0.2344670
Validation loss decreased (inf --> 0.209056).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1451056
	speed: 0.0402s/iter; left time: 886.8529s
	iters: 200, epoch: 2 | loss: 0.1162974
	speed: 0.0176s/iter; left time: 387.2512s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.1551280 Vali Loss: 0.1042353 Test Loss: 0.1172750
Validation loss decreased (0.209056 --> 0.104235).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1089795
	speed: 0.0390s/iter; left time: 851.2131s
	iters: 200, epoch: 3 | loss: 0.1037570
	speed: 0.0182s/iter; left time: 394.8534s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.1090032 Vali Loss: 0.0926297 Test Loss: 0.1092328
Validation loss decreased (0.104235 --> 0.092630).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0931839
	speed: 0.0442s/iter; left time: 957.0213s
	iters: 200, epoch: 4 | loss: 0.0921412
	speed: 0.0193s/iter; left time: 415.4771s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0958092 Vali Loss: 0.0869654 Test Loss: 0.1052669
Validation loss decreased (0.092630 --> 0.086965).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0885624
	speed: 0.0423s/iter; left time: 905.8974s
	iters: 200, epoch: 5 | loss: 0.0861385
	speed: 0.0231s/iter; left time: 493.0838s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0911318 Vali Loss: 0.0844819 Test Loss: 0.1059624
Validation loss decreased (0.086965 --> 0.084482).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0869646
	speed: 0.0396s/iter; left time: 837.8166s
	iters: 200, epoch: 6 | loss: 0.0883404
	speed: 0.0179s/iter; left time: 377.2970s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0878641 Vali Loss: 0.0837793 Test Loss: 0.1088766
Validation loss decreased (0.084482 --> 0.083779).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0886907
	speed: 0.0388s/iter; left time: 812.1509s
	iters: 200, epoch: 7 | loss: 0.0817665
	speed: 0.0177s/iter; left time: 369.9700s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0862188 Vali Loss: 0.0827717 Test Loss: 0.1055454
Validation loss decreased (0.083779 --> 0.082772).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0847801
	speed: 0.0390s/iter; left time: 809.1093s
	iters: 200, epoch: 8 | loss: 0.0820215
	speed: 0.0176s/iter; left time: 363.6903s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0846143 Vali Loss: 0.0810567 Test Loss: 0.1060755
Validation loss decreased (0.082772 --> 0.081057).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0844776
	speed: 0.0400s/iter; left time: 820.7257s
	iters: 200, epoch: 9 | loss: 0.0794606
	speed: 0.0188s/iter; left time: 383.0678s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0838625 Vali Loss: 0.0811782 Test Loss: 0.1076061
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0855363
	speed: 0.0382s/iter; left time: 773.8898s
	iters: 200, epoch: 10 | loss: 0.0853410
	speed: 0.0177s/iter; left time: 358.2599s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0832864 Vali Loss: 0.0808300 Test Loss: 0.1084978
Validation loss decreased (0.081057 --> 0.080830).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0816533
	speed: 0.0384s/iter; left time: 771.2038s
	iters: 200, epoch: 11 | loss: 0.0852584
	speed: 0.0175s/iter; left time: 349.9698s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0824372 Vali Loss: 0.0800179 Test Loss: 0.1059387
Validation loss decreased (0.080830 --> 0.080018).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0845546
	speed: 0.0380s/iter; left time: 753.7459s
	iters: 200, epoch: 12 | loss: 0.0818359
	speed: 0.0219s/iter; left time: 432.6995s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0820708 Vali Loss: 0.0797471 Test Loss: 0.1046065
Validation loss decreased (0.080018 --> 0.079747).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0820495
	speed: 0.0404s/iter; left time: 791.8239s
	iters: 200, epoch: 13 | loss: 0.0821259
	speed: 0.0187s/iter; left time: 365.2692s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0817390 Vali Loss: 0.0797309 Test Loss: 0.1047793
Validation loss decreased (0.079747 --> 0.079731).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0771034
	speed: 0.0379s/iter; left time: 735.2599s
	iters: 200, epoch: 14 | loss: 0.0803334
	speed: 0.0185s/iter; left time: 356.6395s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0816818 Vali Loss: 0.0795235 Test Loss: 0.1054109
Validation loss decreased (0.079731 --> 0.079524).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0790244
	speed: 0.0381s/iter; left time: 729.6871s
	iters: 200, epoch: 15 | loss: 0.0830677
	speed: 0.0176s/iter; left time: 335.8347s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0809772 Vali Loss: 0.0793998 Test Loss: 0.1049986
Validation loss decreased (0.079524 --> 0.079400).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0790241
	speed: 0.0379s/iter; left time: 718.0002s
	iters: 200, epoch: 16 | loss: 0.0845467
	speed: 0.0176s/iter; left time: 330.9786s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0810577 Vali Loss: 0.0812501 Test Loss: 0.1041506
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0794203
	speed: 0.0368s/iter; left time: 688.2631s
	iters: 200, epoch: 17 | loss: 0.0831470
	speed: 0.0178s/iter; left time: 331.2596s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0806764 Vali Loss: 0.0792494 Test Loss: 0.1062545
Validation loss decreased (0.079400 --> 0.079249).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0804426
	speed: 0.0426s/iter; left time: 787.6370s
	iters: 200, epoch: 18 | loss: 0.0796953
	speed: 0.0236s/iter; left time: 433.3435s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.38s
Steps: 224 | Train Loss: 0.0806038 Vali Loss: 0.0788590 Test Loss: 0.1040276
Validation loss decreased (0.079249 --> 0.078859).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0802150
	speed: 0.0386s/iter; left time: 705.5230s
	iters: 200, epoch: 19 | loss: 0.0840697
	speed: 0.0174s/iter; left time: 315.8269s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0800741 Vali Loss: 0.0789752 Test Loss: 0.1047164
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0799749
	speed: 0.0367s/iter; left time: 662.0051s
	iters: 200, epoch: 20 | loss: 0.0796723
	speed: 0.0175s/iter; left time: 314.2498s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0799620 Vali Loss: 0.0787971 Test Loss: 0.1043757
Validation loss decreased (0.078859 --> 0.078797).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814895
	speed: 0.0422s/iter; left time: 751.8593s
	iters: 200, epoch: 21 | loss: 0.0775726
	speed: 0.0231s/iter; left time: 408.7049s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0799304 Vali Loss: 0.0786215 Test Loss: 0.1053541
Validation loss decreased (0.078797 --> 0.078622).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0822030
	speed: 0.0386s/iter; left time: 679.1259s
	iters: 200, epoch: 22 | loss: 0.0822271
	speed: 0.0176s/iter; left time: 308.0636s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0797733 Vali Loss: 0.0788172 Test Loss: 0.1050946
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0782094
	speed: 0.0380s/iter; left time: 660.4837s
	iters: 200, epoch: 23 | loss: 0.0817364
	speed: 0.0178s/iter; left time: 307.6080s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0796080 Vali Loss: 0.0783708 Test Loss: 0.1048175
Validation loss decreased (0.078622 --> 0.078371).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0782946
	speed: 0.0445s/iter; left time: 762.6778s
	iters: 200, epoch: 24 | loss: 0.0759547
	speed: 0.0176s/iter; left time: 300.2310s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0795476 Vali Loss: 0.0784284 Test Loss: 0.1046700
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0781184
	speed: 0.0380s/iter; left time: 642.4495s
	iters: 200, epoch: 25 | loss: 0.0811927
	speed: 0.0176s/iter; left time: 296.9156s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0799517 Vali Loss: 0.0786431 Test Loss: 0.1045798
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0762303
	speed: 0.0371s/iter; left time: 620.2186s
	iters: 200, epoch: 26 | loss: 0.0799544
	speed: 0.0188s/iter; left time: 312.7621s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0793796 Vali Loss: 0.0786190 Test Loss: 0.1051480
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0789374
	speed: 0.0389s/iter; left time: 640.2158s
	iters: 200, epoch: 27 | loss: 0.0780281
	speed: 0.0220s/iter; left time: 360.6754s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.95s
Steps: 224 | Train Loss: 0.0792773 Vali Loss: 0.0784299 Test Loss: 0.1052233
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0814020
	speed: 0.0388s/iter; left time: 630.4335s
	iters: 200, epoch: 28 | loss: 0.0798138
	speed: 0.0177s/iter; left time: 285.9927s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0791199 Vali Loss: 0.0783501 Test Loss: 0.1047811
Validation loss decreased (0.078371 --> 0.078350).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0820562
	speed: 0.0375s/iter; left time: 601.5273s
	iters: 200, epoch: 29 | loss: 0.0808358
	speed: 0.0183s/iter; left time: 291.8285s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0791596 Vali Loss: 0.0785035 Test Loss: 0.1055300
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0763969
	speed: 0.0397s/iter; left time: 627.3603s
	iters: 200, epoch: 30 | loss: 0.0771363
	speed: 0.0263s/iter; left time: 413.4392s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0791952 Vali Loss: 0.0784093 Test Loss: 0.1051583
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0785842
	speed: 0.0382s/iter; left time: 594.4761s
	iters: 200, epoch: 31 | loss: 0.0813041
	speed: 0.0176s/iter; left time: 272.8500s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0790166 Vali Loss: 0.0783721 Test Loss: 0.1051348
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0805069
	speed: 0.0378s/iter; left time: 580.9724s
	iters: 200, epoch: 32 | loss: 0.0800453
	speed: 0.0174s/iter; left time: 264.8091s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0790431 Vali Loss: 0.0783341 Test Loss: 0.1047582
Validation loss decreased (0.078350 --> 0.078334).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0781617
	speed: 0.0392s/iter; left time: 593.6105s
	iters: 200, epoch: 33 | loss: 0.0795569
	speed: 0.0182s/iter; left time: 273.3284s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0790344 Vali Loss: 0.0783522 Test Loss: 0.1054242
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0754284
	speed: 0.0376s/iter; left time: 560.2990s
	iters: 200, epoch: 34 | loss: 0.0840273
	speed: 0.0177s/iter; left time: 262.6275s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0790746 Vali Loss: 0.0782857 Test Loss: 0.1051250
Validation loss decreased (0.078334 --> 0.078286).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0800861
	speed: 0.0375s/iter; left time: 550.3961s
	iters: 200, epoch: 35 | loss: 0.0839135
	speed: 0.0177s/iter; left time: 258.3323s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0789047 Vali Loss: 0.0782892 Test Loss: 0.1051449
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0803963
	speed: 0.0397s/iter; left time: 574.3842s
	iters: 200, epoch: 36 | loss: 0.0774545
	speed: 0.0178s/iter; left time: 255.7070s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.47s
Steps: 224 | Train Loss: 0.0788350 Vali Loss: 0.0783046 Test Loss: 0.1055788
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0808286
	speed: 0.0378s/iter; left time: 537.7878s
	iters: 200, epoch: 37 | loss: 0.0770837
	speed: 0.0179s/iter; left time: 253.2337s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0788810 Vali Loss: 0.0783464 Test Loss: 0.1056055
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0771653
	speed: 0.0376s/iter; left time: 527.1019s
	iters: 200, epoch: 38 | loss: 0.0761486
	speed: 0.0177s/iter; left time: 246.4906s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0791125 Vali Loss: 0.0782723 Test Loss: 0.1056459
Validation loss decreased (0.078286 --> 0.078272).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0771597
	speed: 0.0374s/iter; left time: 516.3477s
	iters: 200, epoch: 39 | loss: 0.0795766
	speed: 0.0178s/iter; left time: 244.1686s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0789243 Vali Loss: 0.0781249 Test Loss: 0.1045209
Validation loss decreased (0.078272 --> 0.078125).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0800514
	speed: 0.0378s/iter; left time: 512.8787s
	iters: 200, epoch: 40 | loss: 0.0769166
	speed: 0.0178s/iter; left time: 239.1717s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0787367 Vali Loss: 0.0781777 Test Loss: 0.1055735
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0788939
	speed: 0.0372s/iter; left time: 496.6777s
	iters: 200, epoch: 41 | loss: 0.0796120
	speed: 0.0173s/iter; left time: 229.4973s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0787654 Vali Loss: 0.0783776 Test Loss: 0.1058984
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0801310
	speed: 0.0411s/iter; left time: 538.4760s
	iters: 200, epoch: 42 | loss: 0.0760927
	speed: 0.0193s/iter; left time: 250.7222s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.66s
Steps: 224 | Train Loss: 0.0787919 Vali Loss: 0.0782467 Test Loss: 0.1052588
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0780973
	speed: 0.0388s/iter; left time: 500.4722s
	iters: 200, epoch: 43 | loss: 0.0798386
	speed: 0.0177s/iter; left time: 226.1385s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0787492 Vali Loss: 0.0781928 Test Loss: 0.1050963
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0823438
	speed: 0.0380s/iter; left time: 481.9794s
	iters: 200, epoch: 44 | loss: 0.0814990
	speed: 0.0173s/iter; left time: 217.2351s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0787495 Vali Loss: 0.0783943 Test Loss: 0.1058547
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0747283
	speed: 0.0375s/iter; left time: 467.0660s
	iters: 200, epoch: 45 | loss: 0.0808855
	speed: 0.0178s/iter; left time: 219.6370s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0786864 Vali Loss: 0.0781960 Test Loss: 0.1050198
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0759459
	speed: 0.0395s/iter; left time: 483.0345s
	iters: 200, epoch: 46 | loss: 0.0787885
	speed: 0.0197s/iter; left time: 238.4083s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0786618 Vali Loss: 0.0782442 Test Loss: 0.1055460
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0770903
	speed: 0.0394s/iter; left time: 472.3410s
	iters: 200, epoch: 47 | loss: 0.0741980
	speed: 0.0192s/iter; left time: 228.1236s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0786734 Vali Loss: 0.0782155 Test Loss: 0.1053684
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0808809
	speed: 0.0368s/iter; left time: 433.0627s
	iters: 200, epoch: 48 | loss: 0.0765063
	speed: 0.0182s/iter; left time: 212.1640s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0787458 Vali Loss: 0.0782955 Test Loss: 0.1055569
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0781761
	speed: 0.0378s/iter; left time: 435.9825s
	iters: 200, epoch: 49 | loss: 0.0780755
	speed: 0.0177s/iter; left time: 202.6651s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0785175 Vali Loss: 0.0782023 Test Loss: 0.1054485
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02427673526108265, rmse:0.1558099389076233, mae:0.10452089458703995, rse:0.4577226936817169
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2807732
	speed: 0.0206s/iter; left time: 459.5975s
	iters: 200, epoch: 1 | loss: 0.2653032
	speed: 0.0179s/iter; left time: 397.4262s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.2841145 Vali Loss: 0.2130373 Test Loss: 0.2379890
Validation loss decreased (inf --> 0.213037).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1392819
	speed: 0.0402s/iter; left time: 886.4672s
	iters: 200, epoch: 2 | loss: 0.1165387
	speed: 0.0187s/iter; left time: 410.2446s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.1551139 Vali Loss: 0.1124424 Test Loss: 0.1264123
Validation loss decreased (0.213037 --> 0.112442).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1126997
	speed: 0.0390s/iter; left time: 853.2412s
	iters: 200, epoch: 3 | loss: 0.1035556
	speed: 0.0208s/iter; left time: 452.9659s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.1085227 Vali Loss: 0.0961990 Test Loss: 0.1101242
Validation loss decreased (0.112442 --> 0.096199).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0962838
	speed: 0.0414s/iter; left time: 895.3841s
	iters: 200, epoch: 4 | loss: 0.0969591
	speed: 0.0178s/iter; left time: 383.1466s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0975332 Vali Loss: 0.0874930 Test Loss: 0.1175036
Validation loss decreased (0.096199 --> 0.087493).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0933458
	speed: 0.0385s/iter; left time: 823.3431s
	iters: 200, epoch: 5 | loss: 0.0946651
	speed: 0.0176s/iter; left time: 374.6907s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0918568 Vali Loss: 0.0853591 Test Loss: 0.1164506
Validation loss decreased (0.087493 --> 0.085359).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0905998
	speed: 0.0378s/iter; left time: 799.6482s
	iters: 200, epoch: 6 | loss: 0.0834064
	speed: 0.0175s/iter; left time: 369.1243s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0886637 Vali Loss: 0.0833173 Test Loss: 0.1190308
Validation loss decreased (0.085359 --> 0.083317).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0859550
	speed: 0.0422s/iter; left time: 883.7168s
	iters: 200, epoch: 7 | loss: 0.0857930
	speed: 0.0200s/iter; left time: 417.2119s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0870941 Vali Loss: 0.0824725 Test Loss: 0.1289645
Validation loss decreased (0.083317 --> 0.082472).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0835487
	speed: 0.0394s/iter; left time: 816.2403s
	iters: 200, epoch: 8 | loss: 0.0800077
	speed: 0.0174s/iter; left time: 359.3395s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0859448 Vali Loss: 0.0809953 Test Loss: 0.1246080
Validation loss decreased (0.082472 --> 0.080995).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0829436
	speed: 0.0419s/iter; left time: 859.9700s
	iters: 200, epoch: 9 | loss: 0.0795209
	speed: 0.0220s/iter; left time: 447.9780s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0850060 Vali Loss: 0.0815726 Test Loss: 0.1122439
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0820003
	speed: 0.0468s/iter; left time: 948.6396s
	iters: 200, epoch: 10 | loss: 0.0848408
	speed: 0.0194s/iter; left time: 391.8755s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0839826 Vali Loss: 0.0810251 Test Loss: 0.1215878
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0819815
	speed: 0.0383s/iter; left time: 769.2619s
	iters: 200, epoch: 11 | loss: 0.0843423
	speed: 0.0177s/iter; left time: 352.4287s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0837573 Vali Loss: 0.0803522 Test Loss: 0.1226014
Validation loss decreased (0.080995 --> 0.080352).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0821579
	speed: 0.0391s/iter; left time: 776.3223s
	iters: 200, epoch: 12 | loss: 0.0825495
	speed: 0.0176s/iter; left time: 348.2790s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0829496 Vali Loss: 0.0797525 Test Loss: 0.1239641
Validation loss decreased (0.080352 --> 0.079753).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0780287
	speed: 0.0379s/iter; left time: 744.1807s
	iters: 200, epoch: 13 | loss: 0.0800011
	speed: 0.0193s/iter; left time: 376.1003s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0824018 Vali Loss: 0.0796889 Test Loss: 0.1207599
Validation loss decreased (0.079753 --> 0.079689).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0824617
	speed: 0.0382s/iter; left time: 740.5484s
	iters: 200, epoch: 14 | loss: 0.0812564
	speed: 0.0183s/iter; left time: 352.6248s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0819560 Vali Loss: 0.0796502 Test Loss: 0.1245411
Validation loss decreased (0.079689 --> 0.079650).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0830183
	speed: 0.0404s/iter; left time: 773.3778s
	iters: 200, epoch: 15 | loss: 0.0822272
	speed: 0.0174s/iter; left time: 332.3140s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0817088 Vali Loss: 0.0795031 Test Loss: 0.1285043
Validation loss decreased (0.079650 --> 0.079503).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0823791
	speed: 0.0423s/iter; left time: 800.6043s
	iters: 200, epoch: 16 | loss: 0.0843695
	speed: 0.0216s/iter; left time: 406.2710s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.95s
Steps: 224 | Train Loss: 0.0813237 Vali Loss: 0.0790901 Test Loss: 0.1307180
Validation loss decreased (0.079503 --> 0.079090).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0792187
	speed: 0.0381s/iter; left time: 712.6779s
	iters: 200, epoch: 17 | loss: 0.0829362
	speed: 0.0176s/iter; left time: 326.8204s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0812568 Vali Loss: 0.0794295 Test Loss: 0.1282273
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0772294
	speed: 0.0377s/iter; left time: 697.5757s
	iters: 200, epoch: 18 | loss: 0.0806995
	speed: 0.0175s/iter; left time: 321.1499s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0811110 Vali Loss: 0.0793635 Test Loss: 0.1272759
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0784017
	speed: 0.0380s/iter; left time: 694.8510s
	iters: 200, epoch: 19 | loss: 0.0811006
	speed: 0.0176s/iter; left time: 320.3751s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0807204 Vali Loss: 0.0791787 Test Loss: 0.1262407
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0806236
	speed: 0.0407s/iter; left time: 733.6630s
	iters: 200, epoch: 20 | loss: 0.0801287
	speed: 0.0178s/iter; left time: 319.4320s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0805928 Vali Loss: 0.0788154 Test Loss: 0.1241784
Validation loss decreased (0.079090 --> 0.078815).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814793
	speed: 0.0377s/iter; left time: 672.4910s
	iters: 200, epoch: 21 | loss: 0.0794477
	speed: 0.0174s/iter; left time: 308.9184s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0805322 Vali Loss: 0.0791230 Test Loss: 0.1281666
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0802228
	speed: 0.0378s/iter; left time: 665.2633s
	iters: 200, epoch: 22 | loss: 0.0822596
	speed: 0.0189s/iter; left time: 330.0630s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0803095 Vali Loss: 0.0789785 Test Loss: 0.1211020
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0813869
	speed: 0.0385s/iter; left time: 669.5588s
	iters: 200, epoch: 23 | loss: 0.0802233
	speed: 0.0174s/iter; left time: 300.7948s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0803901 Vali Loss: 0.0790809 Test Loss: 0.1202924
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0823530
	speed: 0.0371s/iter; left time: 636.8709s
	iters: 200, epoch: 24 | loss: 0.0754244
	speed: 0.0176s/iter; left time: 300.4073s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0799929 Vali Loss: 0.0786709 Test Loss: 0.1282071
Validation loss decreased (0.078815 --> 0.078671).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0769625
	speed: 0.0387s/iter; left time: 654.2461s
	iters: 200, epoch: 25 | loss: 0.0787524
	speed: 0.0179s/iter; left time: 301.6757s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0799626 Vali Loss: 0.0787696 Test Loss: 0.1272044
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0821803
	speed: 0.0377s/iter; left time: 629.3065s
	iters: 200, epoch: 26 | loss: 0.0780077
	speed: 0.0177s/iter; left time: 293.9766s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0799785 Vali Loss: 0.0786442 Test Loss: 0.1239915
Validation loss decreased (0.078671 --> 0.078644).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0795876
	speed: 0.0385s/iter; left time: 633.7366s
	iters: 200, epoch: 27 | loss: 0.0790085
	speed: 0.0180s/iter; left time: 295.3341s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0797704 Vali Loss: 0.0786359 Test Loss: 0.1259093
Validation loss decreased (0.078644 --> 0.078636).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0818633
	speed: 0.0389s/iter; left time: 631.4870s
	iters: 200, epoch: 28 | loss: 0.0793344
	speed: 0.0177s/iter; left time: 285.3434s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0797060 Vali Loss: 0.0784768 Test Loss: 0.1269663
Validation loss decreased (0.078636 --> 0.078477).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0812629
	speed: 0.0401s/iter; left time: 641.9916s
	iters: 200, epoch: 29 | loss: 0.0797160
	speed: 0.0187s/iter; left time: 298.5312s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0796613 Vali Loss: 0.0785777 Test Loss: 0.1275836
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0785135
	speed: 0.0408s/iter; left time: 644.4706s
	iters: 200, epoch: 30 | loss: 0.0747149
	speed: 0.0200s/iter; left time: 314.0007s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.71s
Steps: 224 | Train Loss: 0.0795775 Vali Loss: 0.0786406 Test Loss: 0.1256996
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0790730
	speed: 0.0390s/iter; left time: 608.3640s
	iters: 200, epoch: 31 | loss: 0.0801010
	speed: 0.0182s/iter; left time: 282.0768s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0794757 Vali Loss: 0.0785512 Test Loss: 0.1254068
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0801477
	speed: 0.0413s/iter; left time: 634.2224s
	iters: 200, epoch: 32 | loss: 0.0805202
	speed: 0.0215s/iter; left time: 328.5048s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.94s
Steps: 224 | Train Loss: 0.0794999 Vali Loss: 0.0785085 Test Loss: 0.1251069
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0760565
	speed: 0.0380s/iter; left time: 574.3085s
	iters: 200, epoch: 33 | loss: 0.0793328
	speed: 0.0175s/iter; left time: 263.3110s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0795171 Vali Loss: 0.0785686 Test Loss: 0.1274197
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0773843
	speed: 0.0382s/iter; left time: 569.6855s
	iters: 200, epoch: 34 | loss: 0.0792592
	speed: 0.0174s/iter; left time: 258.2988s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0794413 Vali Loss: 0.0782065 Test Loss: 0.1235717
Validation loss decreased (0.078477 --> 0.078206).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0784409
	speed: 0.0406s/iter; left time: 595.8480s
	iters: 200, epoch: 35 | loss: 0.0783178
	speed: 0.0184s/iter; left time: 268.8876s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0795024 Vali Loss: 0.0784416 Test Loss: 0.1234996
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0821839
	speed: 0.0389s/iter; left time: 562.5106s
	iters: 200, epoch: 36 | loss: 0.0777974
	speed: 0.0175s/iter; left time: 251.7997s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0793642 Vali Loss: 0.0781588 Test Loss: 0.1211270
Validation loss decreased (0.078206 --> 0.078159).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0747080
	speed: 0.0386s/iter; left time: 549.7333s
	iters: 200, epoch: 37 | loss: 0.0795331
	speed: 0.0176s/iter; left time: 248.7248s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0792608 Vali Loss: 0.0784312 Test Loss: 0.1257160
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0776572
	speed: 0.0392s/iter; left time: 549.2437s
	iters: 200, epoch: 38 | loss: 0.0762254
	speed: 0.0229s/iter; left time: 318.2909s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0794165 Vali Loss: 0.0782640 Test Loss: 0.1224292
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0813769
	speed: 0.0409s/iter; left time: 564.1603s
	iters: 200, epoch: 39 | loss: 0.0792352
	speed: 0.0187s/iter; left time: 256.2299s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0793261 Vali Loss: 0.0783679 Test Loss: 0.1225942
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0799571
	speed: 0.0379s/iter; left time: 513.7359s
	iters: 200, epoch: 40 | loss: 0.0804243
	speed: 0.0198s/iter; left time: 267.1909s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.47s
Steps: 224 | Train Loss: 0.0792455 Vali Loss: 0.0784150 Test Loss: 0.1252133
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0813761
	speed: 0.0407s/iter; left time: 542.5395s
	iters: 200, epoch: 41 | loss: 0.0816666
	speed: 0.0181s/iter; left time: 239.8034s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0792573 Vali Loss: 0.0782532 Test Loss: 0.1225800
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0778905
	speed: 0.0373s/iter; left time: 488.8481s
	iters: 200, epoch: 42 | loss: 0.0788236
	speed: 0.0192s/iter; left time: 250.4762s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0792435 Vali Loss: 0.0781906 Test Loss: 0.1238133
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0783627
	speed: 0.0406s/iter; left time: 523.9880s
	iters: 200, epoch: 43 | loss: 0.0787241
	speed: 0.0176s/iter; left time: 224.7120s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0793239 Vali Loss: 0.0781083 Test Loss: 0.1231488
Validation loss decreased (0.078159 --> 0.078108).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0763025
	speed: 0.0382s/iter; left time: 484.4711s
	iters: 200, epoch: 44 | loss: 0.0738823
	speed: 0.0174s/iter; left time: 218.9517s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0792564 Vali Loss: 0.0784912 Test Loss: 0.1267495
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0757882
	speed: 0.0386s/iter; left time: 479.8134s
	iters: 200, epoch: 45 | loss: 0.0789459
	speed: 0.0203s/iter; left time: 250.7978s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0793981 Vali Loss: 0.0783084 Test Loss: 0.1237282
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0772759
	speed: 0.0379s/iter; left time: 463.5877s
	iters: 200, epoch: 46 | loss: 0.0767787
	speed: 0.0179s/iter; left time: 216.5259s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0790786 Vali Loss: 0.0783964 Test Loss: 0.1239477
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0750165
	speed: 0.0378s/iter; left time: 453.3052s
	iters: 200, epoch: 47 | loss: 0.0791191
	speed: 0.0218s/iter; left time: 259.7552s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0791732 Vali Loss: 0.0784350 Test Loss: 0.1260129
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0822771
	speed: 0.0430s/iter; left time: 506.5437s
	iters: 200, epoch: 48 | loss: 0.0833114
	speed: 0.0229s/iter; left time: 266.9940s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0792517 Vali Loss: 0.0783070 Test Loss: 0.1245301
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0782012
	speed: 0.0421s/iter; left time: 486.6283s
	iters: 200, epoch: 49 | loss: 0.0790513
	speed: 0.0176s/iter; left time: 201.5146s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0790816 Vali Loss: 0.0784223 Test Loss: 0.1252991
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0769528
	speed: 0.0379s/iter; left time: 429.3553s
	iters: 200, epoch: 50 | loss: 0.0796110
	speed: 0.0176s/iter; left time: 197.8750s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0792062 Vali Loss: 0.0781806 Test Loss: 0.1240269
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0821458
	speed: 0.0373s/iter; left time: 414.2755s
	iters: 200, epoch: 51 | loss: 0.0748606
	speed: 0.0175s/iter; left time: 192.3489s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0791860 Vali Loss: 0.0783969 Test Loss: 0.1252220
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0788861
	speed: 0.0379s/iter; left time: 412.2790s
	iters: 200, epoch: 52 | loss: 0.0744792
	speed: 0.0178s/iter; left time: 191.6416s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0791129 Vali Loss: 0.0783578 Test Loss: 0.1260209
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0779445
	speed: 0.0388s/iter; left time: 413.3772s
	iters: 200, epoch: 53 | loss: 0.0807185
	speed: 0.0182s/iter; left time: 192.4847s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0790737 Vali Loss: 0.0782593 Test Loss: 0.1245420
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04175650700926781, rmse:0.20434409379959106, mae:0.1231488287448883, rse:0.6003013849258423
Intermediate time for ES and pred_len 96: 00h:10m:01.04s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2749318
	speed: 0.0438s/iter; left time: 973.3953s
	iters: 200, epoch: 1 | loss: 0.2637250
	speed: 0.0179s/iter; left time: 395.2655s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.53s
Steps: 223 | Train Loss: 0.2789764 Vali Loss: 0.2100756 Test Loss: 0.2343825
Validation loss decreased (inf --> 0.210076).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1421229
	speed: 0.0391s/iter; left time: 860.0037s
	iters: 200, epoch: 2 | loss: 0.1207080
	speed: 0.0178s/iter; left time: 390.1726s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.1543833 Vali Loss: 0.1086527 Test Loss: 0.1232387
Validation loss decreased (0.210076 --> 0.108653).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1143583
	speed: 0.0403s/iter; left time: 876.4387s
	iters: 200, epoch: 3 | loss: 0.1035095
	speed: 0.0179s/iter; left time: 386.9633s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.1096992 Vali Loss: 0.0961292 Test Loss: 0.1119838
Validation loss decreased (0.108653 --> 0.096129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0991537
	speed: 0.0404s/iter; left time: 870.3899s
	iters: 200, epoch: 4 | loss: 0.0941834
	speed: 0.0199s/iter; left time: 425.7368s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.56s
Steps: 223 | Train Loss: 0.0979566 Vali Loss: 0.0913458 Test Loss: 0.1117256
Validation loss decreased (0.096129 --> 0.091346).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0948883
	speed: 0.0382s/iter; left time: 813.5286s
	iters: 200, epoch: 5 | loss: 0.0904951
	speed: 0.0178s/iter; left time: 377.0533s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0934428 Vali Loss: 0.0899405 Test Loss: 0.1138975
Validation loss decreased (0.091346 --> 0.089940).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0889967
	speed: 0.0388s/iter; left time: 817.6555s
	iters: 200, epoch: 6 | loss: 0.0896095
	speed: 0.0179s/iter; left time: 376.5492s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0908615 Vali Loss: 0.0874881 Test Loss: 0.1135529
Validation loss decreased (0.089940 --> 0.087488).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0891786
	speed: 0.0392s/iter; left time: 816.9278s
	iters: 200, epoch: 7 | loss: 0.0887473
	speed: 0.0184s/iter; left time: 381.1705s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0893473 Vali Loss: 0.0867286 Test Loss: 0.1134460
Validation loss decreased (0.087488 --> 0.086729).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0847037
	speed: 0.0384s/iter; left time: 793.5267s
	iters: 200, epoch: 8 | loss: 0.0879599
	speed: 0.0178s/iter; left time: 364.8447s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0882717 Vali Loss: 0.0867410 Test Loss: 0.1150925
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0870168
	speed: 0.0411s/iter; left time: 838.1825s
	iters: 200, epoch: 9 | loss: 0.0849715
	speed: 0.0191s/iter; left time: 387.6222s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.79s
Steps: 223 | Train Loss: 0.0878216 Vali Loss: 0.0872022 Test Loss: 0.1176080
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0875702
	speed: 0.0423s/iter; left time: 854.7382s
	iters: 200, epoch: 10 | loss: 0.0899240
	speed: 0.0176s/iter; left time: 354.4951s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.54s
Steps: 223 | Train Loss: 0.0869609 Vali Loss: 0.0860930 Test Loss: 0.1131297
Validation loss decreased (0.086729 --> 0.086093).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0882442
	speed: 0.0381s/iter; left time: 761.3512s
	iters: 200, epoch: 11 | loss: 0.0836711
	speed: 0.0178s/iter; left time: 354.4867s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0865654 Vali Loss: 0.0859699 Test Loss: 0.1132639
Validation loss decreased (0.086093 --> 0.085970).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0827679
	speed: 0.0405s/iter; left time: 799.5681s
	iters: 200, epoch: 12 | loss: 0.0866363
	speed: 0.0189s/iter; left time: 370.3687s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0860623 Vali Loss: 0.0858304 Test Loss: 0.1128382
Validation loss decreased (0.085970 --> 0.085830).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0829732
	speed: 0.0411s/iter; left time: 801.9210s
	iters: 200, epoch: 13 | loss: 0.0850765
	speed: 0.0205s/iter; left time: 398.4228s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.70s
Steps: 223 | Train Loss: 0.0856914 Vali Loss: 0.0856651 Test Loss: 0.1135978
Validation loss decreased (0.085830 --> 0.085665).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0841183
	speed: 0.0388s/iter; left time: 748.0326s
	iters: 200, epoch: 14 | loss: 0.0859597
	speed: 0.0182s/iter; left time: 350.2327s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0852342 Vali Loss: 0.0856685 Test Loss: 0.1136733
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0842968
	speed: 0.0398s/iter; left time: 760.1188s
	iters: 200, epoch: 15 | loss: 0.0909677
	speed: 0.0195s/iter; left time: 370.2253s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.0852555 Vali Loss: 0.0855243 Test Loss: 0.1138341
Validation loss decreased (0.085665 --> 0.085524).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0852345
	speed: 0.0411s/iter; left time: 775.2726s
	iters: 200, epoch: 16 | loss: 0.0851248
	speed: 0.0200s/iter; left time: 375.0127s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0847901 Vali Loss: 0.0851691 Test Loss: 0.1139723
Validation loss decreased (0.085524 --> 0.085169).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0839362
	speed: 0.0413s/iter; left time: 768.8718s
	iters: 200, epoch: 17 | loss: 0.0833548
	speed: 0.0181s/iter; left time: 334.8673s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.43s
Steps: 223 | Train Loss: 0.0845173 Vali Loss: 0.0850614 Test Loss: 0.1140275
Validation loss decreased (0.085169 --> 0.085061).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0813416
	speed: 0.0378s/iter; left time: 695.3286s
	iters: 200, epoch: 18 | loss: 0.0866940
	speed: 0.0176s/iter; left time: 322.6209s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0843307 Vali Loss: 0.0847981 Test Loss: 0.1144203
Validation loss decreased (0.085061 --> 0.084798).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0843313
	speed: 0.0429s/iter; left time: 779.3747s
	iters: 200, epoch: 19 | loss: 0.0832647
	speed: 0.0194s/iter; left time: 349.9905s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.72s
Steps: 223 | Train Loss: 0.0842799 Vali Loss: 0.0846771 Test Loss: 0.1141960
Validation loss decreased (0.084798 --> 0.084677).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0862335
	speed: 0.0393s/iter; left time: 706.1303s
	iters: 200, epoch: 20 | loss: 0.0817612
	speed: 0.0180s/iter; left time: 321.6322s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0838804 Vali Loss: 0.0843563 Test Loss: 0.1145415
Validation loss decreased (0.084677 --> 0.084356).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0837195
	speed: 0.0380s/iter; left time: 674.5413s
	iters: 200, epoch: 21 | loss: 0.1031141
	speed: 0.0176s/iter; left time: 310.9999s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0839049 Vali Loss: 0.0849667 Test Loss: 0.1150237
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0836587
	speed: 0.0372s/iter; left time: 651.5937s
	iters: 200, epoch: 22 | loss: 0.0852197
	speed: 0.0206s/iter; left time: 358.8810s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.53s
Steps: 223 | Train Loss: 0.0837684 Vali Loss: 0.0846416 Test Loss: 0.1158141
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0795333
	speed: 0.0416s/iter; left time: 719.3145s
	iters: 200, epoch: 23 | loss: 0.0865810
	speed: 0.0195s/iter; left time: 335.4357s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.84s
Steps: 223 | Train Loss: 0.0835962 Vali Loss: 0.0847980 Test Loss: 0.1160617
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0831024
	speed: 0.0409s/iter; left time: 698.0340s
	iters: 200, epoch: 24 | loss: 0.0805572
	speed: 0.0177s/iter; left time: 300.1273s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0839736 Vali Loss: 0.0847975 Test Loss: 0.1165650
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0849554
	speed: 0.0380s/iter; left time: 639.5161s
	iters: 200, epoch: 25 | loss: 0.0840587
	speed: 0.0176s/iter; left time: 294.8000s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0834544 Vali Loss: 0.0845328 Test Loss: 0.1162506
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0892217
	speed: 0.0388s/iter; left time: 644.8478s
	iters: 200, epoch: 26 | loss: 0.0807220
	speed: 0.0211s/iter; left time: 348.0118s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0833992 Vali Loss: 0.0846728 Test Loss: 0.1164240
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0810502
	speed: 0.0372s/iter; left time: 610.3947s
	iters: 200, epoch: 27 | loss: 0.0854318
	speed: 0.0209s/iter; left time: 341.3486s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.0833067 Vali Loss: 0.0845248 Test Loss: 0.1158283
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0797867
	speed: 0.0376s/iter; left time: 607.8944s
	iters: 200, epoch: 28 | loss: 0.0819262
	speed: 0.0176s/iter; left time: 282.4657s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0833002 Vali Loss: 0.0843592 Test Loss: 0.1163825
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0846014
	speed: 0.0383s/iter; left time: 610.5661s
	iters: 200, epoch: 29 | loss: 0.0876969
	speed: 0.0184s/iter; left time: 291.4180s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.46s
Steps: 223 | Train Loss: 0.0833116 Vali Loss: 0.0845298 Test Loss: 0.1166252
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0819796
	speed: 0.0379s/iter; left time: 597.0009s
	iters: 200, epoch: 30 | loss: 0.0857283
	speed: 0.0178s/iter; left time: 278.4099s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0831343 Vali Loss: 0.0845026 Test Loss: 0.1163839
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0290948748588562, rmse:0.1705721914768219, mae:0.11454156041145325, rse:0.5011257529258728
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2807395
	speed: 0.0203s/iter; left time: 450.8486s
	iters: 200, epoch: 1 | loss: 0.2651633
	speed: 0.0179s/iter; left time: 395.4331s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.2830992 Vali Loss: 0.2142654 Test Loss: 0.2370222
Validation loss decreased (inf --> 0.214265).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1453094
	speed: 0.0386s/iter; left time: 847.3696s
	iters: 200, epoch: 2 | loss: 0.1242578
	speed: 0.0177s/iter; left time: 386.8902s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.1572299 Vali Loss: 0.1083790 Test Loss: 0.1231012
Validation loss decreased (0.214265 --> 0.108379).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1133961
	speed: 0.0401s/iter; left time: 871.8265s
	iters: 200, epoch: 3 | loss: 0.0982893
	speed: 0.0177s/iter; left time: 382.7173s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.1100277 Vali Loss: 0.0972046 Test Loss: 0.1224924
Validation loss decreased (0.108379 --> 0.097205).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0974868
	speed: 0.0390s/iter; left time: 840.0239s
	iters: 200, epoch: 4 | loss: 0.0972847
	speed: 0.0176s/iter; left time: 377.0333s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.15s
Steps: 223 | Train Loss: 0.0984315 Vali Loss: 0.0914870 Test Loss: 0.1193569
Validation loss decreased (0.097205 --> 0.091487).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0947529
	speed: 0.0387s/iter; left time: 824.6876s
	iters: 200, epoch: 5 | loss: 0.0937127
	speed: 0.0222s/iter; left time: 471.4026s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.70s
Steps: 223 | Train Loss: 0.0946569 Vali Loss: 0.0894347 Test Loss: 0.1191490
Validation loss decreased (0.091487 --> 0.089435).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0918505
	speed: 0.0398s/iter; left time: 840.0801s
	iters: 200, epoch: 6 | loss: 0.0901247
	speed: 0.0193s/iter; left time: 404.9231s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.47s
Steps: 223 | Train Loss: 0.0917058 Vali Loss: 0.0881212 Test Loss: 0.1236080
Validation loss decreased (0.089435 --> 0.088121).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0917704
	speed: 0.0433s/iter; left time: 903.8441s
	iters: 200, epoch: 7 | loss: 0.0922219
	speed: 0.0191s/iter; left time: 396.2991s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.69s
Steps: 223 | Train Loss: 0.0899804 Vali Loss: 0.0864551 Test Loss: 0.1166708
Validation loss decreased (0.088121 --> 0.086455).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0917562
	speed: 0.0384s/iter; left time: 792.5316s
	iters: 200, epoch: 8 | loss: 0.0877953
	speed: 0.0183s/iter; left time: 375.9067s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0890128 Vali Loss: 0.0861659 Test Loss: 0.1123231
Validation loss decreased (0.086455 --> 0.086166).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0919937
	speed: 0.0438s/iter; left time: 894.8178s
	iters: 200, epoch: 9 | loss: 0.0899467
	speed: 0.0192s/iter; left time: 390.8664s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0910410 Vali Loss: 0.0899233 Test Loss: 0.1119124
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0895764
	speed: 0.0384s/iter; left time: 774.9918s
	iters: 200, epoch: 10 | loss: 0.0906453
	speed: 0.0176s/iter; left time: 354.5463s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0887168 Vali Loss: 0.0859634 Test Loss: 0.1185711
Validation loss decreased (0.086166 --> 0.085963).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0892631
	speed: 0.0399s/iter; left time: 796.3830s
	iters: 200, epoch: 11 | loss: 0.0895315
	speed: 0.0190s/iter; left time: 377.9678s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0871117 Vali Loss: 0.0853329 Test Loss: 0.1164193
Validation loss decreased (0.085963 --> 0.085333).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0869905
	speed: 0.0397s/iter; left time: 784.2642s
	iters: 200, epoch: 12 | loss: 0.0848289
	speed: 0.0177s/iter; left time: 347.6889s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0865530 Vali Loss: 0.0852942 Test Loss: 0.1179176
Validation loss decreased (0.085333 --> 0.085294).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0864150
	speed: 0.0393s/iter; left time: 767.6902s
	iters: 200, epoch: 13 | loss: 0.0838847
	speed: 0.0177s/iter; left time: 344.5167s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0862789 Vali Loss: 0.0850571 Test Loss: 0.1164684
Validation loss decreased (0.085294 --> 0.085057).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0867992
	speed: 0.0396s/iter; left time: 764.5853s
	iters: 200, epoch: 14 | loss: 0.0845527
	speed: 0.0177s/iter; left time: 339.3237s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0858124 Vali Loss: 0.0850595 Test Loss: 0.1153065
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0845146
	speed: 0.0444s/iter; left time: 847.3245s
	iters: 200, epoch: 15 | loss: 0.0846549
	speed: 0.0201s/iter; left time: 381.9025s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.00s
Steps: 223 | Train Loss: 0.0856219 Vali Loss: 0.0849426 Test Loss: 0.1166757
Validation loss decreased (0.085057 --> 0.084943).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0845102
	speed: 0.0405s/iter; left time: 764.5244s
	iters: 200, epoch: 16 | loss: 0.0888782
	speed: 0.0179s/iter; left time: 335.1952s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.32s
Steps: 223 | Train Loss: 0.0858942 Vali Loss: 0.0853336 Test Loss: 0.1119651
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0912922
	speed: 0.0399s/iter; left time: 742.7110s
	iters: 200, epoch: 17 | loss: 0.0889382
	speed: 0.0177s/iter; left time: 328.7491s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0856840 Vali Loss: 0.0851839 Test Loss: 0.1192388
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0845657
	speed: 0.0412s/iter; left time: 758.4120s
	iters: 200, epoch: 18 | loss: 0.0815924
	speed: 0.0202s/iter; left time: 369.3739s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.72s
Steps: 223 | Train Loss: 0.0849107 Vali Loss: 0.0853217 Test Loss: 0.1206380
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0849029
	speed: 0.0443s/iter; left time: 805.2851s
	iters: 200, epoch: 19 | loss: 0.0853960
	speed: 0.0178s/iter; left time: 322.0125s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.65s
Steps: 223 | Train Loss: 0.0848261 Vali Loss: 0.0846747 Test Loss: 0.1192671
Validation loss decreased (0.084943 --> 0.084675).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0811674
	speed: 0.0393s/iter; left time: 705.1242s
	iters: 200, epoch: 20 | loss: 0.0817534
	speed: 0.0178s/iter; left time: 318.2709s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0845942 Vali Loss: 0.0847365 Test Loss: 0.1183660
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0826207
	speed: 0.0443s/iter; left time: 786.5047s
	iters: 200, epoch: 21 | loss: 0.0816803
	speed: 0.0214s/iter; left time: 377.8793s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0843873 Vali Loss: 0.0846548 Test Loss: 0.1183502
Validation loss decreased (0.084675 --> 0.084655).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0834691
	speed: 0.0410s/iter; left time: 717.6705s
	iters: 200, epoch: 22 | loss: 0.0883418
	speed: 0.0179s/iter; left time: 312.5777s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.48s
Steps: 223 | Train Loss: 0.0843994 Vali Loss: 0.0845420 Test Loss: 0.1178532
Validation loss decreased (0.084655 --> 0.084542).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0847441
	speed: 0.0397s/iter; left time: 686.2741s
	iters: 200, epoch: 23 | loss: 0.0805724
	speed: 0.0176s/iter; left time: 303.0658s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0841674 Vali Loss: 0.0844933 Test Loss: 0.1170921
Validation loss decreased (0.084542 --> 0.084493).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0839649
	speed: 0.0396s/iter; left time: 676.2839s
	iters: 200, epoch: 24 | loss: 0.0834868
	speed: 0.0178s/iter; left time: 301.6561s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0841976 Vali Loss: 0.0846161 Test Loss: 0.1172125
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0881067
	speed: 0.0391s/iter; left time: 658.7945s
	iters: 200, epoch: 25 | loss: 0.0828818
	speed: 0.0178s/iter; left time: 297.4196s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0841515 Vali Loss: 0.0843772 Test Loss: 0.1175339
Validation loss decreased (0.084493 --> 0.084377).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0825793
	speed: 0.0403s/iter; left time: 670.3831s
	iters: 200, epoch: 26 | loss: 0.0856509
	speed: 0.0180s/iter; left time: 296.7333s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0842238 Vali Loss: 0.0844084 Test Loss: 0.1173107
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0819396
	speed: 0.0404s/iter; left time: 661.9741s
	iters: 200, epoch: 27 | loss: 0.0869512
	speed: 0.0193s/iter; left time: 313.9014s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.56s
Steps: 223 | Train Loss: 0.0840297 Vali Loss: 0.0846008 Test Loss: 0.1175796
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0859564
	speed: 0.0400s/iter; left time: 647.4605s
	iters: 200, epoch: 28 | loss: 0.0873584
	speed: 0.0176s/iter; left time: 283.2306s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0837992 Vali Loss: 0.0845674 Test Loss: 0.1199782
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0821546
	speed: 0.0394s/iter; left time: 628.3312s
	iters: 200, epoch: 29 | loss: 0.0846214
	speed: 0.0176s/iter; left time: 278.9822s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0837742 Vali Loss: 0.0844055 Test Loss: 0.1191112
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0844201
	speed: 0.0392s/iter; left time: 616.1672s
	iters: 200, epoch: 30 | loss: 0.0841895
	speed: 0.0176s/iter; left time: 275.9239s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0837221 Vali Loss: 0.0842772 Test Loss: 0.1190496
Validation loss decreased (0.084377 --> 0.084277).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0870948
	speed: 0.0390s/iter; left time: 604.7622s
	iters: 200, epoch: 31 | loss: 0.0821873
	speed: 0.0176s/iter; left time: 270.7022s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.14s
Steps: 223 | Train Loss: 0.0836353 Vali Loss: 0.0842929 Test Loss: 0.1206920
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0848337
	speed: 0.0402s/iter; left time: 614.4786s
	iters: 200, epoch: 32 | loss: 0.0830336
	speed: 0.0208s/iter; left time: 315.6664s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.75s
Steps: 223 | Train Loss: 0.0837642 Vali Loss: 0.0842275 Test Loss: 0.1182323
Validation loss decreased (0.084277 --> 0.084228).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0846711
	speed: 0.0411s/iter; left time: 619.1505s
	iters: 200, epoch: 33 | loss: 0.0801985
	speed: 0.0181s/iter; left time: 270.1589s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0836584 Vali Loss: 0.0844522 Test Loss: 0.1194240
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0836901
	speed: 0.0406s/iter; left time: 602.9054s
	iters: 200, epoch: 34 | loss: 0.0838794
	speed: 0.0177s/iter; left time: 261.5917s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0836737 Vali Loss: 0.0843503 Test Loss: 0.1194371
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0843293
	speed: 0.0386s/iter; left time: 564.5556s
	iters: 200, epoch: 35 | loss: 0.0848211
	speed: 0.0177s/iter; left time: 257.4590s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0835618 Vali Loss: 0.0844821 Test Loss: 0.1200642
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0810826
	speed: 0.0378s/iter; left time: 544.4553s
	iters: 200, epoch: 36 | loss: 0.0852567
	speed: 0.0176s/iter; left time: 251.1851s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0838000 Vali Loss: 0.0845061 Test Loss: 0.1194763
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0803306
	speed: 0.0385s/iter; left time: 545.4165s
	iters: 200, epoch: 37 | loss: 0.0833322
	speed: 0.0176s/iter; left time: 247.8230s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0835411 Vali Loss: 0.0843955 Test Loss: 0.1186716
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0823816
	speed: 0.0390s/iter; left time: 544.7125s
	iters: 200, epoch: 38 | loss: 0.0843670
	speed: 0.0183s/iter; left time: 253.1478s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0834298 Vali Loss: 0.0843624 Test Loss: 0.1192587
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0864377
	speed: 0.0414s/iter; left time: 568.6201s
	iters: 200, epoch: 39 | loss: 0.0857570
	speed: 0.0189s/iter; left time: 256.9373s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.58s
Steps: 223 | Train Loss: 0.0836104 Vali Loss: 0.0843764 Test Loss: 0.1198429
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0814850
	speed: 0.0386s/iter; left time: 521.7193s
	iters: 200, epoch: 40 | loss: 0.0841378
	speed: 0.0182s/iter; left time: 243.5265s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0839965 Vali Loss: 0.0844893 Test Loss: 0.1194120
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0799215
	speed: 0.0399s/iter; left time: 530.0786s
	iters: 200, epoch: 41 | loss: 0.0783022
	speed: 0.0179s/iter; left time: 235.8019s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0834080 Vali Loss: 0.0841839 Test Loss: 0.1189149
Validation loss decreased (0.084228 --> 0.084184).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0835249
	speed: 0.0396s/iter; left time: 517.6016s
	iters: 200, epoch: 42 | loss: 0.0811903
	speed: 0.0177s/iter; left time: 228.7974s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0834037 Vali Loss: 0.0844404 Test Loss: 0.1207593
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0831517
	speed: 0.0390s/iter; left time: 500.6978s
	iters: 200, epoch: 43 | loss: 0.0815078
	speed: 0.0176s/iter; left time: 224.0696s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0834141 Vali Loss: 0.0845041 Test Loss: 0.1203174
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0865642
	speed: 0.0387s/iter; left time: 487.8656s
	iters: 200, epoch: 44 | loss: 0.0847886
	speed: 0.0178s/iter; left time: 222.4821s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0835477 Vali Loss: 0.0844085 Test Loss: 0.1198660
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0788437
	speed: 0.0382s/iter; left time: 472.8884s
	iters: 200, epoch: 45 | loss: 0.0816742
	speed: 0.0176s/iter; left time: 216.6890s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0834426 Vali Loss: 0.0842027 Test Loss: 0.1195737
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0830794
	speed: 0.0399s/iter; left time: 485.2382s
	iters: 200, epoch: 46 | loss: 0.0839437
	speed: 0.0176s/iter; left time: 212.6512s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0833704 Vali Loss: 0.0842480 Test Loss: 0.1193747
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0823590
	speed: 0.0386s/iter; left time: 461.1781s
	iters: 200, epoch: 47 | loss: 0.0856680
	speed: 0.0176s/iter; left time: 208.9305s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0832862 Vali Loss: 0.0841228 Test Loss: 0.1197550
Validation loss decreased (0.084184 --> 0.084123).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0883429
	speed: 0.0453s/iter; left time: 530.7049s
	iters: 200, epoch: 48 | loss: 0.0826623
	speed: 0.0187s/iter; left time: 217.0098s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.91s
Steps: 223 | Train Loss: 0.0833737 Vali Loss: 0.0842797 Test Loss: 0.1200274
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0815217
	speed: 0.0405s/iter; left time: 465.1589s
	iters: 200, epoch: 49 | loss: 0.0848437
	speed: 0.0208s/iter; left time: 237.5433s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.65s
Steps: 223 | Train Loss: 0.0833760 Vali Loss: 0.0841590 Test Loss: 0.1200445
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0827644
	speed: 0.0400s/iter; left time: 451.0382s
	iters: 200, epoch: 50 | loss: 0.0767582
	speed: 0.0185s/iter; left time: 206.9561s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0832877 Vali Loss: 0.0839660 Test Loss: 0.1184397
Validation loss decreased (0.084123 --> 0.083966).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0835075
	speed: 0.0434s/iter; left time: 480.0762s
	iters: 200, epoch: 51 | loss: 0.0817596
	speed: 0.0180s/iter; left time: 197.4372s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.65s
Steps: 223 | Train Loss: 0.0832505 Vali Loss: 0.0842132 Test Loss: 0.1197245
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0808008
	speed: 0.0384s/iter; left time: 416.1238s
	iters: 200, epoch: 52 | loss: 0.0849158
	speed: 0.0178s/iter; left time: 190.8772s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0834962 Vali Loss: 0.0841127 Test Loss: 0.1192776
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0800299
	speed: 0.0389s/iter; left time: 412.1408s
	iters: 200, epoch: 53 | loss: 0.0820698
	speed: 0.0177s/iter; left time: 185.6782s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0832694 Vali Loss: 0.0842121 Test Loss: 0.1194684
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0802618
	speed: 0.0386s/iter; left time: 400.3582s
	iters: 200, epoch: 54 | loss: 0.0827059
	speed: 0.0185s/iter; left time: 190.4180s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0833176 Vali Loss: 0.0842278 Test Loss: 0.1203044
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0861164
	speed: 0.0390s/iter; left time: 396.3525s
	iters: 200, epoch: 55 | loss: 0.0852268
	speed: 0.0176s/iter; left time: 177.0272s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0833072 Vali Loss: 0.0842820 Test Loss: 0.1206407
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0806998
	speed: 0.0392s/iter; left time: 389.7057s
	iters: 200, epoch: 56 | loss: 0.0823214
	speed: 0.0177s/iter; left time: 174.2658s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0834395 Vali Loss: 0.0842447 Test Loss: 0.1202066
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0837483
	speed: 0.0389s/iter; left time: 378.1445s
	iters: 200, epoch: 57 | loss: 0.0801571
	speed: 0.0178s/iter; left time: 171.3463s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0833268 Vali Loss: 0.0842674 Test Loss: 0.1203132
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0821808
	speed: 0.0387s/iter; left time: 367.6385s
	iters: 200, epoch: 58 | loss: 0.0829196
	speed: 0.0177s/iter; left time: 166.2460s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0832269 Vali Loss: 0.0843088 Test Loss: 0.1198582
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0822175
	speed: 0.0403s/iter; left time: 373.6472s
	iters: 200, epoch: 59 | loss: 0.0831296
	speed: 0.0176s/iter; left time: 161.3924s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.36s
Steps: 223 | Train Loss: 0.0833064 Vali Loss: 0.0840443 Test Loss: 0.1194816
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0843803
	speed: 0.0407s/iter; left time: 368.4259s
	iters: 200, epoch: 60 | loss: 0.0825238
	speed: 0.0177s/iter; left time: 158.2406s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0836524 Vali Loss: 0.0842534 Test Loss: 0.1202688
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03208500146865845, rmse:0.17912286520004272, mae:0.1184396892786026, rse:0.5262468457221985
Intermediate time for ES and pred_len 168: 00h:08m:56.15sIntermediate time for ES: 00h:29m:52.64s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2189905
	speed: 0.0447s/iter; left time: 997.8993s
	iters: 200, epoch: 1 | loss: 0.2094398
	speed: 0.0173s/iter; left time: 383.2317s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.2283985 Vali Loss: 0.1756238 Test Loss: 0.1780087
Validation loss decreased (inf --> 0.175624).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1347274
	speed: 0.0367s/iter; left time: 810.4678s
	iters: 200, epoch: 2 | loss: 0.1058855
	speed: 0.0173s/iter; left time: 379.6729s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.1412683 Vali Loss: 0.0861683 Test Loss: 0.0953128
Validation loss decreased (0.175624 --> 0.086168).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0858258
	speed: 0.0366s/iter; left time: 799.0799s
	iters: 200, epoch: 3 | loss: 0.0784642
	speed: 0.0173s/iter; left time: 375.2809s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0877591 Vali Loss: 0.0783186 Test Loss: 0.0834705
Validation loss decreased (0.086168 --> 0.078319).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0740882
	speed: 0.0363s/iter; left time: 786.1294s
	iters: 200, epoch: 4 | loss: 0.0751335
	speed: 0.0191s/iter; left time: 411.4021s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0729271 Vali Loss: 0.0701618 Test Loss: 0.0721456
Validation loss decreased (0.078319 --> 0.070162).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0732238
	speed: 0.0365s/iter; left time: 781.9660s
	iters: 200, epoch: 5 | loss: 0.0658085
	speed: 0.0180s/iter; left time: 384.4943s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0662810 Vali Loss: 0.0654406 Test Loss: 0.0673504
Validation loss decreased (0.070162 --> 0.065441).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0640738
	speed: 0.0357s/iter; left time: 756.4553s
	iters: 200, epoch: 6 | loss: 0.0585620
	speed: 0.0192s/iter; left time: 405.5923s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0619704 Vali Loss: 0.0635439 Test Loss: 0.0665006
Validation loss decreased (0.065441 --> 0.063544).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0728307
	speed: 0.0392s/iter; left time: 821.9312s
	iters: 200, epoch: 7 | loss: 0.0582666
	speed: 0.0192s/iter; left time: 401.0378s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0588843 Vali Loss: 0.0620328 Test Loss: 0.0647599
Validation loss decreased (0.063544 --> 0.062033).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0576182
	speed: 0.0366s/iter; left time: 758.6566s
	iters: 200, epoch: 8 | loss: 0.0582239
	speed: 0.0175s/iter; left time: 361.7967s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0563831 Vali Loss: 0.0620485 Test Loss: 0.0640849
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0529686
	speed: 0.0361s/iter; left time: 739.6494s
	iters: 200, epoch: 9 | loss: 0.0567693
	speed: 0.0172s/iter; left time: 351.3044s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0552574 Vali Loss: 0.0612383 Test Loss: 0.0637068
Validation loss decreased (0.062033 --> 0.061238).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0530840
	speed: 0.0370s/iter; left time: 749.5542s
	iters: 200, epoch: 10 | loss: 0.0547498
	speed: 0.0174s/iter; left time: 351.9716s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0539950 Vali Loss: 0.0601991 Test Loss: 0.0627014
Validation loss decreased (0.061238 --> 0.060199).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0550270
	speed: 0.0361s/iter; left time: 723.3991s
	iters: 200, epoch: 11 | loss: 0.0529360
	speed: 0.0175s/iter; left time: 348.7186s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0536804 Vali Loss: 0.0596398 Test Loss: 0.0623860
Validation loss decreased (0.060199 --> 0.059640).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0509884
	speed: 0.0367s/iter; left time: 727.4579s
	iters: 200, epoch: 12 | loss: 0.0549822
	speed: 0.0182s/iter; left time: 359.2126s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0531124 Vali Loss: 0.0593827 Test Loss: 0.0619096
Validation loss decreased (0.059640 --> 0.059383).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0497535
	speed: 0.0378s/iter; left time: 740.5790s
	iters: 200, epoch: 13 | loss: 0.0497219
	speed: 0.0173s/iter; left time: 337.0638s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0523422 Vali Loss: 0.0598866 Test Loss: 0.0626116
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0506681
	speed: 0.0383s/iter; left time: 741.8863s
	iters: 200, epoch: 14 | loss: 0.0503455
	speed: 0.0177s/iter; left time: 341.0834s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0518808 Vali Loss: 0.0589341 Test Loss: 0.0617417
Validation loss decreased (0.059383 --> 0.058934).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0516162
	speed: 0.0365s/iter; left time: 699.9821s
	iters: 200, epoch: 15 | loss: 0.0477661
	speed: 0.0180s/iter; left time: 343.6846s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0518157 Vali Loss: 0.0586784 Test Loss: 0.0613603
Validation loss decreased (0.058934 --> 0.058678).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0483342
	speed: 0.0360s/iter; left time: 681.1734s
	iters: 200, epoch: 16 | loss: 0.0493364
	speed: 0.0173s/iter; left time: 326.5407s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0512816 Vali Loss: 0.0602284 Test Loss: 0.0628952
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0539204
	speed: 0.0401s/iter; left time: 749.9528s
	iters: 200, epoch: 17 | loss: 0.0494316
	speed: 0.0190s/iter; left time: 354.3990s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0510176 Vali Loss: 0.0584819 Test Loss: 0.0611233
Validation loss decreased (0.058678 --> 0.058482).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0500257
	speed: 0.0361s/iter; left time: 668.3985s
	iters: 200, epoch: 18 | loss: 0.0504019
	speed: 0.0210s/iter; left time: 387.0058s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0508184 Vali Loss: 0.0582690 Test Loss: 0.0609066
Validation loss decreased (0.058482 --> 0.058269).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0475260
	speed: 0.0372s/iter; left time: 679.7461s
	iters: 200, epoch: 19 | loss: 0.0503758
	speed: 0.0175s/iter; left time: 317.1558s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0506279 Vali Loss: 0.0581391 Test Loss: 0.0607202
Validation loss decreased (0.058269 --> 0.058139).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0505285
	speed: 0.0379s/iter; left time: 684.7220s
	iters: 200, epoch: 20 | loss: 0.0497725
	speed: 0.0175s/iter; left time: 313.3267s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0506970 Vali Loss: 0.0583651 Test Loss: 0.0609205
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0512311
	speed: 0.0356s/iter; left time: 634.2959s
	iters: 200, epoch: 21 | loss: 0.0495510
	speed: 0.0174s/iter; left time: 308.1601s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0501595 Vali Loss: 0.0580995 Test Loss: 0.0606243
Validation loss decreased (0.058139 --> 0.058099).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0473480
	speed: 0.0359s/iter; left time: 632.5131s
	iters: 200, epoch: 22 | loss: 0.0477828
	speed: 0.0175s/iter; left time: 305.8150s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0504072 Vali Loss: 0.0587346 Test Loss: 0.0612521
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0500846
	speed: 0.0360s/iter; left time: 624.9034s
	iters: 200, epoch: 23 | loss: 0.0525214
	speed: 0.0179s/iter; left time: 309.7527s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0504408 Vali Loss: 0.0579735 Test Loss: 0.0607307
Validation loss decreased (0.058099 --> 0.057974).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0480558
	speed: 0.0354s/iter; left time: 607.1094s
	iters: 200, epoch: 24 | loss: 0.0507211
	speed: 0.0173s/iter; left time: 295.1379s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0502628 Vali Loss: 0.0580043 Test Loss: 0.0605459
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0504762
	speed: 0.0385s/iter; left time: 652.3293s
	iters: 200, epoch: 25 | loss: 0.0537197
	speed: 0.0182s/iter; left time: 305.9539s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0498962 Vali Loss: 0.0578188 Test Loss: 0.0603671
Validation loss decreased (0.057974 --> 0.057819).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0486984
	speed: 0.0365s/iter; left time: 608.8245s
	iters: 200, epoch: 26 | loss: 0.0455609
	speed: 0.0188s/iter; left time: 312.5707s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0503198 Vali Loss: 0.0577315 Test Loss: 0.0603220
Validation loss decreased (0.057819 --> 0.057732).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0486343
	speed: 0.0401s/iter; left time: 660.7798s
	iters: 200, epoch: 27 | loss: 0.0508078
	speed: 0.0214s/iter; left time: 350.9652s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0495923 Vali Loss: 0.0578376 Test Loss: 0.0603566
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0503271
	speed: 0.0386s/iter; left time: 626.8296s
	iters: 200, epoch: 28 | loss: 0.0459004
	speed: 0.0200s/iter; left time: 323.7449s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0495713 Vali Loss: 0.0577886 Test Loss: 0.0602553
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0524027
	speed: 0.0393s/iter; left time: 630.0518s
	iters: 200, epoch: 29 | loss: 0.0464738
	speed: 0.0190s/iter; left time: 302.2834s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0498332 Vali Loss: 0.0576925 Test Loss: 0.0602051
Validation loss decreased (0.057732 --> 0.057692).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0516865
	speed: 0.0374s/iter; left time: 590.6686s
	iters: 200, epoch: 30 | loss: 0.0477378
	speed: 0.0174s/iter; left time: 273.5475s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0494292 Vali Loss: 0.0579241 Test Loss: 0.0604471
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0495388
	speed: 0.0361s/iter; left time: 562.1820s
	iters: 200, epoch: 31 | loss: 0.0503760
	speed: 0.0183s/iter; left time: 283.9992s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0496792 Vali Loss: 0.0575059 Test Loss: 0.0599858
Validation loss decreased (0.057692 --> 0.057506).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0482864
	speed: 0.0424s/iter; left time: 650.5668s
	iters: 200, epoch: 32 | loss: 0.0502361
	speed: 0.0208s/iter; left time: 316.7476s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0494227 Vali Loss: 0.0574768 Test Loss: 0.0599407
Validation loss decreased (0.057506 --> 0.057477).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0517188
	speed: 0.0425s/iter; left time: 643.2173s
	iters: 200, epoch: 33 | loss: 0.0492935
	speed: 0.0172s/iter; left time: 259.0971s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0496386 Vali Loss: 0.0577618 Test Loss: 0.0601959
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0497171
	speed: 0.0375s/iter; left time: 558.5965s
	iters: 200, epoch: 34 | loss: 0.1120931
	speed: 0.0193s/iter; left time: 285.3142s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0495713 Vali Loss: 0.0575163 Test Loss: 0.0601913
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0492985
	speed: 0.0381s/iter; left time: 559.5225s
	iters: 200, epoch: 35 | loss: 0.0487842
	speed: 0.0187s/iter; left time: 273.0602s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0493602 Vali Loss: 0.0576364 Test Loss: 0.0601227
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0468738
	speed: 0.0378s/iter; left time: 547.0831s
	iters: 200, epoch: 36 | loss: 0.0486434
	speed: 0.0172s/iter; left time: 247.1983s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0493726 Vali Loss: 0.0575348 Test Loss: 0.0600171
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0508832
	speed: 0.0357s/iter; left time: 508.4945s
	iters: 200, epoch: 37 | loss: 0.0465933
	speed: 0.0172s/iter; left time: 243.6972s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0493064 Vali Loss: 0.0574129 Test Loss: 0.0599025
Validation loss decreased (0.057477 --> 0.057413).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0512414
	speed: 0.0373s/iter; left time: 523.0214s
	iters: 200, epoch: 38 | loss: 0.0495993
	speed: 0.0172s/iter; left time: 239.4604s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0496147 Vali Loss: 0.0575160 Test Loss: 0.0600982
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0481962
	speed: 0.0380s/iter; left time: 524.0205s
	iters: 200, epoch: 39 | loss: 0.0456776
	speed: 0.0209s/iter; left time: 285.5316s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.81s
Steps: 224 | Train Loss: 0.0493605 Vali Loss: 0.0575157 Test Loss: 0.0600691
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0459758
	speed: 0.0361s/iter; left time: 489.3920s
	iters: 200, epoch: 40 | loss: 0.0505996
	speed: 0.0174s/iter; left time: 234.4136s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0492454 Vali Loss: 0.0574911 Test Loss: 0.0600893
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0497500
	speed: 0.0409s/iter; left time: 545.8449s
	iters: 200, epoch: 41 | loss: 0.0457567
	speed: 0.0219s/iter; left time: 290.0590s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0492883 Vali Loss: 0.0575777 Test Loss: 0.0600463
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0492255
	speed: 0.0421s/iter; left time: 551.7524s
	iters: 200, epoch: 42 | loss: 0.0519431
	speed: 0.0221s/iter; left time: 287.4615s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0492720 Vali Loss: 0.0573690 Test Loss: 0.0599045
Validation loss decreased (0.057413 --> 0.057369).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0481818
	speed: 0.0395s/iter; left time: 509.2732s
	iters: 200, epoch: 43 | loss: 0.0480127
	speed: 0.0173s/iter; left time: 220.9924s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0491732 Vali Loss: 0.0574247 Test Loss: 0.0599618
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0485913
	speed: 0.0354s/iter; left time: 448.8938s
	iters: 200, epoch: 44 | loss: 0.0524267
	speed: 0.0172s/iter; left time: 216.0711s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.02s
Steps: 224 | Train Loss: 0.0491129 Vali Loss: 0.0573343 Test Loss: 0.0597940
Validation loss decreased (0.057369 --> 0.057334).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0492738
	speed: 0.0379s/iter; left time: 471.7080s
	iters: 200, epoch: 45 | loss: 0.0507723
	speed: 0.0185s/iter; left time: 228.7869s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0493416 Vali Loss: 0.0573820 Test Loss: 0.0598268
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0466329
	speed: 0.0359s/iter; left time: 438.6723s
	iters: 200, epoch: 46 | loss: 0.0478777
	speed: 0.0174s/iter; left time: 210.5781s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0491535 Vali Loss: 0.0577590 Test Loss: 0.0602383
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0475169
	speed: 0.0360s/iter; left time: 431.9920s
	iters: 200, epoch: 47 | loss: 0.0476974
	speed: 0.0174s/iter; left time: 207.1603s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0492178 Vali Loss: 0.0573777 Test Loss: 0.0598855
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0472250
	speed: 0.0355s/iter; left time: 417.9496s
	iters: 200, epoch: 48 | loss: 0.0502291
	speed: 0.0175s/iter; left time: 203.9946s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0496917 Vali Loss: 0.0574500 Test Loss: 0.0599635
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0496751
	speed: 0.0373s/iter; left time: 430.8747s
	iters: 200, epoch: 49 | loss: 0.0517711
	speed: 0.0190s/iter; left time: 218.0619s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0491967 Vali Loss: 0.0574847 Test Loss: 0.0599832
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0506651
	speed: 0.0395s/iter; left time: 447.4884s
	iters: 200, epoch: 50 | loss: 0.0472021
	speed: 0.0217s/iter; left time: 243.7816s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0491663 Vali Loss: 0.0576522 Test Loss: 0.0602551
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0474933
	speed: 0.0439s/iter; left time: 487.1982s
	iters: 200, epoch: 51 | loss: 0.0453514
	speed: 0.0240s/iter; left time: 264.2819s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.59s
Steps: 224 | Train Loss: 0.0491722 Vali Loss: 0.0573052 Test Loss: 0.0598379
Validation loss decreased (0.057334 --> 0.057305).  Saving model ...
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0489133
	speed: 0.0409s/iter; left time: 444.8613s
	iters: 200, epoch: 52 | loss: 0.0550193
	speed: 0.0174s/iter; left time: 187.0583s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0494006 Vali Loss: 0.0574015 Test Loss: 0.0600319
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0497700
	speed: 0.0360s/iter; left time: 383.0731s
	iters: 200, epoch: 53 | loss: 0.0514682
	speed: 0.0179s/iter; left time: 189.2858s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0492078 Vali Loss: 0.0575005 Test Loss: 0.0599812
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0472670
	speed: 0.0381s/iter; left time: 397.7214s
	iters: 200, epoch: 54 | loss: 0.0458579
	speed: 0.0172s/iter; left time: 177.7982s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0490864 Vali Loss: 0.0575138 Test Loss: 0.0601399
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0475249
	speed: 0.0398s/iter; left time: 406.4096s
	iters: 200, epoch: 55 | loss: 0.0529579
	speed: 0.0203s/iter; left time: 204.6364s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.80s
Steps: 224 | Train Loss: 0.0491312 Vali Loss: 0.0574530 Test Loss: 0.0599372
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0514820
	speed: 0.0356s/iter; left time: 355.5929s
	iters: 200, epoch: 56 | loss: 0.0481791
	speed: 0.0172s/iter; left time: 170.2678s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0491052 Vali Loss: 0.0574432 Test Loss: 0.0599785
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0493848
	speed: 0.0401s/iter; left time: 391.7294s
	iters: 200, epoch: 57 | loss: 0.0465032
	speed: 0.0226s/iter; left time: 218.3561s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0491957 Vali Loss: 0.0573411 Test Loss: 0.0598234
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0511922
	speed: 0.0386s/iter; left time: 367.5829s
	iters: 200, epoch: 58 | loss: 0.0503263
	speed: 0.0183s/iter; left time: 172.9647s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0490021 Vali Loss: 0.0575003 Test Loss: 0.0599627
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0506980
	speed: 0.0362s/iter; left time: 337.2117s
	iters: 200, epoch: 59 | loss: 0.0491531
	speed: 0.0176s/iter; left time: 162.0777s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0491681 Vali Loss: 0.0573054 Test Loss: 0.0598622
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0476131
	speed: 0.0360s/iter; left time: 327.3956s
	iters: 200, epoch: 60 | loss: 0.0460834
	speed: 0.0192s/iter; left time: 172.2928s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0491034 Vali Loss: 0.0572696 Test Loss: 0.0598422
Validation loss decreased (0.057305 --> 0.057270).  Saving model ...
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0492449
	speed: 0.0383s/iter; left time: 338.9422s
	iters: 200, epoch: 61 | loss: 0.0475657
	speed: 0.0209s/iter; left time: 182.8456s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.66s
Steps: 224 | Train Loss: 0.0497441 Vali Loss: 0.0574630 Test Loss: 0.0599516
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0489767
	speed: 0.0378s/iter; left time: 326.1079s
	iters: 200, epoch: 62 | loss: 0.0438914
	speed: 0.0175s/iter; left time: 149.1630s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0491614 Vali Loss: 0.0575841 Test Loss: 0.0600992
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0485266
	speed: 0.0364s/iter; left time: 306.3704s
	iters: 200, epoch: 63 | loss: 0.0485745
	speed: 0.0202s/iter; left time: 167.8442s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:04.41s
Steps: 224 | Train Loss: 0.0490892 Vali Loss: 0.0574127 Test Loss: 0.0598990
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0500127
	speed: 0.0385s/iter; left time: 314.9289s
	iters: 200, epoch: 64 | loss: 0.0486416
	speed: 0.0206s/iter; left time: 166.2779s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.87s
Steps: 224 | Train Loss: 0.0492301 Vali Loss: 0.0573969 Test Loss: 0.0599315
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0514936
	speed: 0.0397s/iter; left time: 316.5102s
	iters: 200, epoch: 65 | loss: 0.0519952
	speed: 0.0209s/iter; left time: 164.3907s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0490190 Vali Loss: 0.0574190 Test Loss: 0.0599423
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0482965
	speed: 0.0391s/iter; left time: 302.5245s
	iters: 200, epoch: 66 | loss: 0.0458699
	speed: 0.0175s/iter; left time: 133.3716s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0490600 Vali Loss: 0.0575020 Test Loss: 0.0600639
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0507162
	speed: 0.0361s/iter; left time: 271.7122s
	iters: 200, epoch: 67 | loss: 0.0494047
	speed: 0.0172s/iter; left time: 127.9266s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0491147 Vali Loss: 0.0573377 Test Loss: 0.0598302
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0515755
	speed: 0.0363s/iter; left time: 265.0690s
	iters: 200, epoch: 68 | loss: 0.0506050
	speed: 0.0175s/iter; left time: 125.8164s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0491012 Vali Loss: 0.0574193 Test Loss: 0.0599533
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0500110
	speed: 0.0365s/iter; left time: 257.7478s
	iters: 200, epoch: 69 | loss: 0.0475658
	speed: 0.0174s/iter; left time: 121.3719s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0490177 Vali Loss: 0.0573800 Test Loss: 0.0600168
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0488470
	speed: 0.0368s/iter; left time: 251.9017s
	iters: 200, epoch: 70 | loss: 0.0483024
	speed: 0.0202s/iter; left time: 136.4495s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0491240 Vali Loss: 0.0573181 Test Loss: 0.0598424
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010684304870665073, rmse:0.10336491465568542, mae:0.05984216183423996, rse:0.3987789750099182
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2283663
	speed: 0.0249s/iter; left time: 554.4766s
	iters: 200, epoch: 1 | loss: 0.2152799
	speed: 0.0223s/iter; left time: 495.2096s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.2290822 Vali Loss: 0.1706432 Test Loss: 0.1762997
Validation loss decreased (inf --> 0.170643).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1328232
	speed: 0.0410s/iter; left time: 904.7223s
	iters: 200, epoch: 2 | loss: 0.0982406
	speed: 0.0197s/iter; left time: 433.0558s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.1371360 Vali Loss: 0.0832083 Test Loss: 0.0899777
Validation loss decreased (0.170643 --> 0.083208).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0842378
	speed: 0.0362s/iter; left time: 791.0964s
	iters: 200, epoch: 3 | loss: 0.0776716
	speed: 0.0182s/iter; left time: 396.3139s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0840879 Vali Loss: 0.0742344 Test Loss: 0.0786118
Validation loss decreased (0.083208 --> 0.074234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0748460
	speed: 0.0395s/iter; left time: 854.7550s
	iters: 200, epoch: 4 | loss: 0.0699650
	speed: 0.0208s/iter; left time: 446.9618s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0715947 Vali Loss: 0.0694890 Test Loss: 0.0728493
Validation loss decreased (0.074234 --> 0.069489).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0635823
	speed: 0.0374s/iter; left time: 800.1831s
	iters: 200, epoch: 5 | loss: 0.0625224
	speed: 0.0190s/iter; left time: 405.5500s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0642759 Vali Loss: 0.0649201 Test Loss: 0.0670199
Validation loss decreased (0.069489 --> 0.064920).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0616188
	speed: 0.0367s/iter; left time: 777.4081s
	iters: 200, epoch: 6 | loss: 0.0563325
	speed: 0.0176s/iter; left time: 370.5719s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0610357 Vali Loss: 0.0635758 Test Loss: 0.0660962
Validation loss decreased (0.064920 --> 0.063576).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0604849
	speed: 0.0377s/iter; left time: 789.2933s
	iters: 200, epoch: 7 | loss: 0.0595101
	speed: 0.0172s/iter; left time: 359.1129s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0582681 Vali Loss: 0.0630666 Test Loss: 0.0653816
Validation loss decreased (0.063576 --> 0.063067).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0534247
	speed: 0.0357s/iter; left time: 740.8882s
	iters: 200, epoch: 8 | loss: 0.0546402
	speed: 0.0172s/iter; left time: 355.1349s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0561636 Vali Loss: 0.0619535 Test Loss: 0.0645303
Validation loss decreased (0.063067 --> 0.061954).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0576266
	speed: 0.0369s/iter; left time: 756.8943s
	iters: 200, epoch: 9 | loss: 0.0535413
	speed: 0.0173s/iter; left time: 353.1077s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0548653 Vali Loss: 0.0609104 Test Loss: 0.0631791
Validation loss decreased (0.061954 --> 0.060910).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0540497
	speed: 0.0391s/iter; left time: 792.7855s
	iters: 200, epoch: 10 | loss: 0.0524245
	speed: 0.0174s/iter; left time: 351.5773s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0538714 Vali Loss: 0.0613841 Test Loss: 0.0634718
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0538256
	speed: 0.0356s/iter; left time: 714.8931s
	iters: 200, epoch: 11 | loss: 0.0564994
	speed: 0.0178s/iter; left time: 354.8962s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0530556 Vali Loss: 0.0599989 Test Loss: 0.0622630
Validation loss decreased (0.060910 --> 0.059999).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0528109
	speed: 0.0360s/iter; left time: 713.2821s
	iters: 200, epoch: 12 | loss: 0.0582618
	speed: 0.0172s/iter; left time: 339.8603s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0527736 Vali Loss: 0.0610509 Test Loss: 0.0630525
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0496846
	speed: 0.0361s/iter; left time: 708.1250s
	iters: 200, epoch: 13 | loss: 0.0500449
	speed: 0.0182s/iter; left time: 354.6745s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0522214 Vali Loss: 0.0594596 Test Loss: 0.0616471
Validation loss decreased (0.059999 --> 0.059460).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0569025
	speed: 0.0391s/iter; left time: 758.4405s
	iters: 200, epoch: 14 | loss: 0.0515646
	speed: 0.0188s/iter; left time: 361.7202s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0515061 Vali Loss: 0.0588724 Test Loss: 0.0612824
Validation loss decreased (0.059460 --> 0.058872).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0528493
	speed: 0.0402s/iter; left time: 770.6906s
	iters: 200, epoch: 15 | loss: 0.0525881
	speed: 0.0236s/iter; left time: 449.7286s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0512514 Vali Loss: 0.0588800 Test Loss: 0.0610992
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0520019
	speed: 0.0392s/iter; left time: 742.4410s
	iters: 200, epoch: 16 | loss: 0.0495123
	speed: 0.0195s/iter; left time: 366.7046s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0511952 Vali Loss: 0.0588662 Test Loss: 0.0610870
Validation loss decreased (0.058872 --> 0.058866).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0465449
	speed: 0.0387s/iter; left time: 723.7301s
	iters: 200, epoch: 17 | loss: 0.0471932
	speed: 0.0174s/iter; left time: 323.3683s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0508977 Vali Loss: 0.0585394 Test Loss: 0.0608667
Validation loss decreased (0.058866 --> 0.058539).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0489227
	speed: 0.0397s/iter; left time: 734.0641s
	iters: 200, epoch: 18 | loss: 0.0511102
	speed: 0.0179s/iter; left time: 328.7897s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0506655 Vali Loss: 0.0581182 Test Loss: 0.0605069
Validation loss decreased (0.058539 --> 0.058118).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0540787
	speed: 0.0394s/iter; left time: 719.1443s
	iters: 200, epoch: 19 | loss: 0.0497480
	speed: 0.0211s/iter; left time: 383.8292s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.80s
Steps: 224 | Train Loss: 0.0507588 Vali Loss: 0.0584153 Test Loss: 0.0607866
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0504777
	speed: 0.0360s/iter; left time: 650.3326s
	iters: 200, epoch: 20 | loss: 0.0506826
	speed: 0.0173s/iter; left time: 311.0023s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0506910 Vali Loss: 0.0583143 Test Loss: 0.0605581
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0482379
	speed: 0.0366s/iter; left time: 651.6398s
	iters: 200, epoch: 21 | loss: 0.0489982
	speed: 0.0172s/iter; left time: 304.4197s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0507082 Vali Loss: 0.0580792 Test Loss: 0.0604281
Validation loss decreased (0.058118 --> 0.058079).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0487917
	speed: 0.0429s/iter; left time: 754.9433s
	iters: 200, epoch: 22 | loss: 0.0470085
	speed: 0.0231s/iter; left time: 403.6888s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0500168 Vali Loss: 0.0580225 Test Loss: 0.0605449
Validation loss decreased (0.058079 --> 0.058023).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0590072
	speed: 0.0378s/iter; left time: 657.0053s
	iters: 200, epoch: 23 | loss: 0.0518484
	speed: 0.0209s/iter; left time: 360.6087s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0499528 Vali Loss: 0.0576724 Test Loss: 0.0602709
Validation loss decreased (0.058023 --> 0.057672).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0509322
	speed: 0.0375s/iter; left time: 642.6042s
	iters: 200, epoch: 24 | loss: 0.0513161
	speed: 0.0187s/iter; left time: 318.5876s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0498988 Vali Loss: 0.0579281 Test Loss: 0.0604220
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0508513
	speed: 0.0373s/iter; left time: 631.8427s
	iters: 200, epoch: 25 | loss: 0.0553270
	speed: 0.0211s/iter; left time: 354.6347s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.75s
Steps: 224 | Train Loss: 0.0499958 Vali Loss: 0.0580391 Test Loss: 0.0603604
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0489895
	speed: 0.0376s/iter; left time: 628.1109s
	iters: 200, epoch: 26 | loss: 0.0511790
	speed: 0.0173s/iter; left time: 287.2541s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0497630 Vali Loss: 0.0579244 Test Loss: 0.0602479
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0486151
	speed: 0.0384s/iter; left time: 632.6095s
	iters: 200, epoch: 27 | loss: 0.0506114
	speed: 0.0175s/iter; left time: 286.7406s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0498856 Vali Loss: 0.0577455 Test Loss: 0.0601126
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0446018
	speed: 0.0367s/iter; left time: 596.6074s
	iters: 200, epoch: 28 | loss: 0.0462449
	speed: 0.0195s/iter; left time: 314.9467s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0497051 Vali Loss: 0.0577175 Test Loss: 0.0601918
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0520386
	speed: 0.0375s/iter; left time: 601.7198s
	iters: 200, epoch: 29 | loss: 0.0481251
	speed: 0.0202s/iter; left time: 321.6519s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0495512 Vali Loss: 0.0576138 Test Loss: 0.0600061
Validation loss decreased (0.057672 --> 0.057614).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0497224
	speed: 0.0424s/iter; left time: 669.7863s
	iters: 200, epoch: 30 | loss: 0.0503757
	speed: 0.0203s/iter; left time: 318.8097s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.83s
Steps: 224 | Train Loss: 0.0493888 Vali Loss: 0.0581249 Test Loss: 0.0604352
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0504061
	speed: 0.0367s/iter; left time: 571.0777s
	iters: 200, epoch: 31 | loss: 0.0497857
	speed: 0.0179s/iter; left time: 277.3164s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0493865 Vali Loss: 0.0575889 Test Loss: 0.0599255
Validation loss decreased (0.057614 --> 0.057589).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0520289
	speed: 0.0361s/iter; left time: 554.0145s
	iters: 200, epoch: 32 | loss: 0.0470548
	speed: 0.0175s/iter; left time: 266.3995s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0493500 Vali Loss: 0.0574853 Test Loss: 0.0598739
Validation loss decreased (0.057589 --> 0.057485).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0489791
	speed: 0.0372s/iter; left time: 563.0859s
	iters: 200, epoch: 33 | loss: 0.0510819
	speed: 0.0174s/iter; left time: 261.3483s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0493776 Vali Loss: 0.0573947 Test Loss: 0.0598598
Validation loss decreased (0.057485 --> 0.057395).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0449547
	speed: 0.0381s/iter; left time: 567.9186s
	iters: 200, epoch: 34 | loss: 0.0496961
	speed: 0.0175s/iter; left time: 258.6109s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0492386 Vali Loss: 0.0574011 Test Loss: 0.0597518
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0499091
	speed: 0.0351s/iter; left time: 516.1472s
	iters: 200, epoch: 35 | loss: 0.0491820
	speed: 0.0183s/iter; left time: 266.5762s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0491809 Vali Loss: 0.0574168 Test Loss: 0.0597811
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0526245
	speed: 0.0371s/iter; left time: 535.8339s
	iters: 200, epoch: 36 | loss: 0.0488593
	speed: 0.0178s/iter; left time: 255.0305s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0491984 Vali Loss: 0.0574023 Test Loss: 0.0598615
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0492538
	speed: 0.0355s/iter; left time: 504.8853s
	iters: 200, epoch: 37 | loss: 0.0506678
	speed: 0.0172s/iter; left time: 243.0682s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.03s
Steps: 224 | Train Loss: 0.0492787 Vali Loss: 0.0574776 Test Loss: 0.0598653
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0519817
	speed: 0.0360s/iter; left time: 504.3952s
	iters: 200, epoch: 38 | loss: 0.0477081
	speed: 0.0180s/iter; left time: 250.3432s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0491747 Vali Loss: 0.0573329 Test Loss: 0.0597114
Validation loss decreased (0.057395 --> 0.057333).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0495917
	speed: 0.0377s/iter; left time: 519.8914s
	iters: 200, epoch: 39 | loss: 0.0463310
	speed: 0.0173s/iter; left time: 236.3319s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0490367 Vali Loss: 0.0573715 Test Loss: 0.0596787
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0481286
	speed: 0.0383s/iter; left time: 520.0067s
	iters: 200, epoch: 40 | loss: 0.0492089
	speed: 0.0172s/iter; left time: 231.8151s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0490243 Vali Loss: 0.0572552 Test Loss: 0.0596854
Validation loss decreased (0.057333 --> 0.057255).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0489064
	speed: 0.0391s/iter; left time: 522.2394s
	iters: 200, epoch: 41 | loss: 0.0486024
	speed: 0.0189s/iter; left time: 249.8162s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0491074 Vali Loss: 0.0573465 Test Loss: 0.0596638
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0542865
	speed: 0.0354s/iter; left time: 464.5191s
	iters: 200, epoch: 42 | loss: 0.0508040
	speed: 0.0180s/iter; left time: 234.0324s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0491071 Vali Loss: 0.0572566 Test Loss: 0.0596496
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0509735
	speed: 0.0407s/iter; left time: 525.1014s
	iters: 200, epoch: 43 | loss: 0.0494964
	speed: 0.0174s/iter; left time: 222.9179s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0491612 Vali Loss: 0.0572893 Test Loss: 0.0597281
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0502248
	speed: 0.0364s/iter; left time: 461.4337s
	iters: 200, epoch: 44 | loss: 0.0443589
	speed: 0.0223s/iter; left time: 280.2778s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.81s
Steps: 224 | Train Loss: 0.0490794 Vali Loss: 0.0572941 Test Loss: 0.0596752
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0495226
	speed: 0.0376s/iter; left time: 468.0482s
	iters: 200, epoch: 45 | loss: 0.0487141
	speed: 0.0172s/iter; left time: 212.4430s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0490192 Vali Loss: 0.0573532 Test Loss: 0.0596827
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0493966
	speed: 0.0429s/iter; left time: 524.3831s
	iters: 200, epoch: 46 | loss: 0.0463138
	speed: 0.0224s/iter; left time: 271.7382s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0492276 Vali Loss: 0.0576674 Test Loss: 0.0599896
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0485500
	speed: 0.0396s/iter; left time: 475.0283s
	iters: 200, epoch: 47 | loss: 0.0474930
	speed: 0.0174s/iter; left time: 207.2939s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0489630 Vali Loss: 0.0575855 Test Loss: 0.0599361
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0476843
	speed: 0.0389s/iter; left time: 458.4570s
	iters: 200, epoch: 48 | loss: 0.0503357
	speed: 0.0175s/iter; left time: 203.7748s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0490957 Vali Loss: 0.0572898 Test Loss: 0.0596848
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0546042
	speed: 0.0359s/iter; left time: 414.4026s
	iters: 200, epoch: 49 | loss: 0.0484213
	speed: 0.0205s/iter; left time: 235.2693s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0491670 Vali Loss: 0.0572665 Test Loss: 0.0596485
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0510215
	speed: 0.0408s/iter; left time: 462.1339s
	iters: 200, epoch: 50 | loss: 0.0490253
	speed: 0.0194s/iter; left time: 218.2440s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.87s
Steps: 224 | Train Loss: 0.0489847 Vali Loss: 0.0573010 Test Loss: 0.0596603
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010642945766448975, rmse:0.10316465049982071, mae:0.059685416519641876, rse:0.3980063796043396
Intermediate time for FR and pred_len 24: 00h:11m:29.76s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2247583
	speed: 0.0441s/iter; left time: 983.2509s
	iters: 200, epoch: 1 | loss: 0.2110642
	speed: 0.0176s/iter; left time: 391.0672s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.2283931 Vali Loss: 0.1739245 Test Loss: 0.1796148
Validation loss decreased (inf --> 0.173925).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1307912
	speed: 0.0381s/iter; left time: 840.4995s
	iters: 200, epoch: 2 | loss: 0.0952648
	speed: 0.0177s/iter; left time: 388.3584s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.1318476 Vali Loss: 0.0961500 Test Loss: 0.1068681
Validation loss decreased (0.173925 --> 0.096150).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878664
	speed: 0.0387s/iter; left time: 846.0929s
	iters: 200, epoch: 3 | loss: 0.0826205
	speed: 0.0176s/iter; left time: 382.1929s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0886377 Vali Loss: 0.0875749 Test Loss: 0.0960391
Validation loss decreased (0.096150 --> 0.087575).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0775627
	speed: 0.0376s/iter; left time: 812.6053s
	iters: 200, epoch: 4 | loss: 0.0800580
	speed: 0.0176s/iter; left time: 378.7673s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0805322 Vali Loss: 0.0821570 Test Loss: 0.0895570
Validation loss decreased (0.087575 --> 0.082157).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0765028
	speed: 0.0381s/iter; left time: 816.1289s
	iters: 200, epoch: 5 | loss: 0.0727876
	speed: 0.0176s/iter; left time: 373.9181s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0753626 Vali Loss: 0.0803998 Test Loss: 0.0879519
Validation loss decreased (0.082157 --> 0.080400).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0774372
	speed: 0.0383s/iter; left time: 811.4563s
	iters: 200, epoch: 6 | loss: 0.0735677
	speed: 0.0175s/iter; left time: 369.1063s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0726207 Vali Loss: 0.0797703 Test Loss: 0.0875197
Validation loss decreased (0.080400 --> 0.079770).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0743370
	speed: 0.0381s/iter; left time: 798.1986s
	iters: 200, epoch: 7 | loss: 0.0678488
	speed: 0.0185s/iter; left time: 386.3393s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0706009 Vali Loss: 0.0782221 Test Loss: 0.0855775
Validation loss decreased (0.079770 --> 0.078222).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0727910
	speed: 0.0396s/iter; left time: 820.7160s
	iters: 200, epoch: 8 | loss: 0.0646456
	speed: 0.0202s/iter; left time: 416.7974s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0691813 Vali Loss: 0.0775231 Test Loss: 0.0844578
Validation loss decreased (0.078222 --> 0.077523).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0674671
	speed: 0.0388s/iter; left time: 795.2426s
	iters: 200, epoch: 9 | loss: 0.0665397
	speed: 0.0181s/iter; left time: 369.3307s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0683832 Vali Loss: 0.0776606 Test Loss: 0.0849660
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0729846
	speed: 0.0390s/iter; left time: 790.4316s
	iters: 200, epoch: 10 | loss: 0.0656892
	speed: 0.0180s/iter; left time: 363.0290s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0674439 Vali Loss: 0.0762555 Test Loss: 0.0836048
Validation loss decreased (0.077523 --> 0.076255).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0676251
	speed: 0.0415s/iter; left time: 831.7014s
	iters: 200, epoch: 11 | loss: 0.0668655
	speed: 0.0176s/iter; left time: 352.1759s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0665991 Vali Loss: 0.0755719 Test Loss: 0.0840431
Validation loss decreased (0.076255 --> 0.075572).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0662990
	speed: 0.0403s/iter; left time: 800.3438s
	iters: 200, epoch: 12 | loss: 0.0658202
	speed: 0.0186s/iter; left time: 366.9118s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0661504 Vali Loss: 0.0767297 Test Loss: 0.0833037
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0653353
	speed: 0.0384s/iter; left time: 752.3992s
	iters: 200, epoch: 13 | loss: 0.0644610
	speed: 0.0175s/iter; left time: 341.8296s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0657464 Vali Loss: 0.0751664 Test Loss: 0.0825177
Validation loss decreased (0.075572 --> 0.075166).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0647618
	speed: 0.0407s/iter; left time: 788.2741s
	iters: 200, epoch: 14 | loss: 0.0649751
	speed: 0.0174s/iter; left time: 336.3461s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0654680 Vali Loss: 0.0749129 Test Loss: 0.0827685
Validation loss decreased (0.075166 --> 0.074913).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0605934
	speed: 0.0378s/iter; left time: 724.9586s
	iters: 200, epoch: 15 | loss: 0.0671939
	speed: 0.0205s/iter; left time: 391.2797s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.69s
Steps: 224 | Train Loss: 0.0650269 Vali Loss: 0.0746628 Test Loss: 0.0827791
Validation loss decreased (0.074913 --> 0.074663).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0647860
	speed: 0.0473s/iter; left time: 895.9576s
	iters: 200, epoch: 16 | loss: 0.0672728
	speed: 0.0223s/iter; left time: 420.5385s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0646335 Vali Loss: 0.0746252 Test Loss: 0.0836227
Validation loss decreased (0.074663 --> 0.074625).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0634853
	speed: 0.0394s/iter; left time: 737.0697s
	iters: 200, epoch: 17 | loss: 0.0662486
	speed: 0.0174s/iter; left time: 324.0408s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0650164 Vali Loss: 0.0747181 Test Loss: 0.0829482
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0650601
	speed: 0.0384s/iter; left time: 710.6017s
	iters: 200, epoch: 18 | loss: 0.0635075
	speed: 0.0211s/iter; left time: 387.6871s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0644976 Vali Loss: 0.0743944 Test Loss: 0.0835960
Validation loss decreased (0.074625 --> 0.074394).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0655558
	speed: 0.0412s/iter; left time: 752.7291s
	iters: 200, epoch: 19 | loss: 0.0673271
	speed: 0.0190s/iter; left time: 345.9133s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0643014 Vali Loss: 0.0742977 Test Loss: 0.0832769
Validation loss decreased (0.074394 --> 0.074298).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0649739
	speed: 0.0418s/iter; left time: 753.6531s
	iters: 200, epoch: 20 | loss: 0.0651673
	speed: 0.0200s/iter; left time: 358.3906s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0643234 Vali Loss: 0.0742534 Test Loss: 0.0832492
Validation loss decreased (0.074298 --> 0.074253).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0683060
	speed: 0.0419s/iter; left time: 746.7093s
	iters: 200, epoch: 21 | loss: 0.0584680
	speed: 0.0193s/iter; left time: 342.0173s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0640115 Vali Loss: 0.0740189 Test Loss: 0.0823374
Validation loss decreased (0.074253 --> 0.074019).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0640669
	speed: 0.0410s/iter; left time: 722.1082s
	iters: 200, epoch: 22 | loss: 0.0680301
	speed: 0.0189s/iter; left time: 330.9203s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0636955 Vali Loss: 0.0740751 Test Loss: 0.0825475
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0641997
	speed: 0.0394s/iter; left time: 684.0788s
	iters: 200, epoch: 23 | loss: 0.0647988
	speed: 0.0180s/iter; left time: 311.5136s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0636366 Vali Loss: 0.0740381 Test Loss: 0.0825958
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0642621
	speed: 0.0434s/iter; left time: 744.2203s
	iters: 200, epoch: 24 | loss: 0.0604572
	speed: 0.0176s/iter; left time: 299.8014s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0634552 Vali Loss: 0.0742615 Test Loss: 0.0832317
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0624321
	speed: 0.0376s/iter; left time: 636.5003s
	iters: 200, epoch: 25 | loss: 0.0617251
	speed: 0.0176s/iter; left time: 296.5901s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0633835 Vali Loss: 0.0741187 Test Loss: 0.0830197
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0612301
	speed: 0.0377s/iter; left time: 630.0752s
	iters: 200, epoch: 26 | loss: 0.0659279
	speed: 0.0181s/iter; left time: 301.2018s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0633406 Vali Loss: 0.0738879 Test Loss: 0.0828041
Validation loss decreased (0.074019 --> 0.073888).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0613242
	speed: 0.0381s/iter; left time: 627.0067s
	iters: 200, epoch: 27 | loss: 0.0652461
	speed: 0.0176s/iter; left time: 287.4464s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0635310 Vali Loss: 0.0738510 Test Loss: 0.0825673
Validation loss decreased (0.073888 --> 0.073851).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0632376
	speed: 0.0399s/iter; left time: 648.5459s
	iters: 200, epoch: 28 | loss: 0.0636772
	speed: 0.0173s/iter; left time: 280.1219s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0633069 Vali Loss: 0.0738611 Test Loss: 0.0824119
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0618980
	speed: 0.0385s/iter; left time: 617.7237s
	iters: 200, epoch: 29 | loss: 0.0679610
	speed: 0.0198s/iter; left time: 315.5763s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0633181 Vali Loss: 0.0739335 Test Loss: 0.0823843
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0639477
	speed: 0.0387s/iter; left time: 612.0914s
	iters: 200, epoch: 30 | loss: 0.0601007
	speed: 0.0175s/iter; left time: 274.1658s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0633556 Vali Loss: 0.0741023 Test Loss: 0.0828930
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0651662
	speed: 0.0374s/iter; left time: 582.4796s
	iters: 200, epoch: 31 | loss: 0.0620232
	speed: 0.0174s/iter; left time: 269.4802s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0631821 Vali Loss: 0.0740046 Test Loss: 0.0828805
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0624187
	speed: 0.0379s/iter; left time: 581.6493s
	iters: 200, epoch: 32 | loss: 0.0643874
	speed: 0.0177s/iter; left time: 270.5746s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0631632 Vali Loss: 0.0739178 Test Loss: 0.0826334
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0638696
	speed: 0.0372s/iter; left time: 563.0954s
	iters: 200, epoch: 33 | loss: 0.0637890
	speed: 0.0174s/iter; left time: 261.0877s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0630920 Vali Loss: 0.0739848 Test Loss: 0.0825740
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0630978
	speed: 0.0394s/iter; left time: 586.9319s
	iters: 200, epoch: 34 | loss: 0.0630619
	speed: 0.0206s/iter; left time: 305.2426s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0631138 Vali Loss: 0.0739563 Test Loss: 0.0827014
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0606765
	speed: 0.0377s/iter; left time: 554.3040s
	iters: 200, epoch: 35 | loss: 0.0647627
	speed: 0.0179s/iter; left time: 260.4236s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0630331 Vali Loss: 0.0736615 Test Loss: 0.0821839
Validation loss decreased (0.073851 --> 0.073662).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0611204
	speed: 0.0436s/iter; left time: 630.0488s
	iters: 200, epoch: 36 | loss: 0.0601015
	speed: 0.0176s/iter; left time: 252.7117s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0629634 Vali Loss: 0.0738245 Test Loss: 0.0824375
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0645292
	speed: 0.0386s/iter; left time: 550.0190s
	iters: 200, epoch: 37 | loss: 0.0631087
	speed: 0.0186s/iter; left time: 262.5134s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0629622 Vali Loss: 0.0739686 Test Loss: 0.0829979
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0614005
	speed: 0.0416s/iter; left time: 582.9921s
	iters: 200, epoch: 38 | loss: 0.0646622
	speed: 0.0177s/iter; left time: 245.7252s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0629720 Vali Loss: 0.0738572 Test Loss: 0.0826879
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0592805
	speed: 0.0411s/iter; left time: 567.1784s
	iters: 200, epoch: 39 | loss: 0.0682494
	speed: 0.0263s/iter; left time: 360.4959s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.58s
Steps: 224 | Train Loss: 0.0628646 Vali Loss: 0.0737171 Test Loss: 0.0822277
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0636136
	speed: 0.0395s/iter; left time: 536.1692s
	iters: 200, epoch: 40 | loss: 0.0640101
	speed: 0.0176s/iter; left time: 236.5435s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0630662 Vali Loss: 0.0738709 Test Loss: 0.0826220
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0667536
	speed: 0.0413s/iter; left time: 550.6096s
	iters: 200, epoch: 41 | loss: 0.0584305
	speed: 0.0193s/iter; left time: 255.9952s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0628251 Vali Loss: 0.0740194 Test Loss: 0.0829386
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0631080
	speed: 0.0378s/iter; left time: 496.4576s
	iters: 200, epoch: 42 | loss: 0.0638256
	speed: 0.0176s/iter; left time: 229.5376s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0629956 Vali Loss: 0.0738227 Test Loss: 0.0824970
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0646805
	speed: 0.0378s/iter; left time: 487.1329s
	iters: 200, epoch: 43 | loss: 0.0633970
	speed: 0.0176s/iter; left time: 225.6464s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0628065 Vali Loss: 0.0737748 Test Loss: 0.0824351
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0663955
	speed: 0.0372s/iter; left time: 471.8630s
	iters: 200, epoch: 44 | loss: 0.0614184
	speed: 0.0174s/iter; left time: 218.1152s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0629094 Vali Loss: 0.0738258 Test Loss: 0.0826319
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0646778
	speed: 0.0371s/iter; left time: 461.2824s
	iters: 200, epoch: 45 | loss: 0.0636121
	speed: 0.0176s/iter; left time: 216.8965s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0628988 Vali Loss: 0.0737582 Test Loss: 0.0824334
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019680019468069077, rmse:0.14028549194335938, mae:0.08218392729759216, rse:0.5426615476608276
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2284414
	speed: 0.0245s/iter; left time: 545.3045s
	iters: 200, epoch: 1 | loss: 0.2151139
	speed: 0.0199s/iter; left time: 441.7353s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.89s
Steps: 224 | Train Loss: 0.2333744 Vali Loss: 0.1724914 Test Loss: 0.1774697
Validation loss decreased (inf --> 0.172491).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1269303
	speed: 0.0415s/iter; left time: 916.2325s
	iters: 200, epoch: 2 | loss: 0.1001725
	speed: 0.0191s/iter; left time: 419.6760s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.1325294 Vali Loss: 0.0990750 Test Loss: 0.1096021
Validation loss decreased (0.172491 --> 0.099075).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0865366
	speed: 0.0401s/iter; left time: 875.7817s
	iters: 200, epoch: 3 | loss: 0.0872007
	speed: 0.0180s/iter; left time: 390.5646s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0884579 Vali Loss: 0.0861872 Test Loss: 0.0937232
Validation loss decreased (0.099075 --> 0.086187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0809731
	speed: 0.0394s/iter; left time: 852.0079s
	iters: 200, epoch: 4 | loss: 0.0770818
	speed: 0.0176s/iter; left time: 379.1457s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0796711 Vali Loss: 0.0844280 Test Loss: 0.0910993
Validation loss decreased (0.086187 --> 0.084428).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0759911
	speed: 0.0392s/iter; left time: 838.3852s
	iters: 200, epoch: 5 | loss: 0.0739146
	speed: 0.0177s/iter; left time: 376.8931s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0753532 Vali Loss: 0.0798179 Test Loss: 0.0870115
Validation loss decreased (0.084428 --> 0.079818).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0676676
	speed: 0.0414s/iter; left time: 876.8319s
	iters: 200, epoch: 6 | loss: 0.0717228
	speed: 0.0177s/iter; left time: 373.9328s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0722853 Vali Loss: 0.0791006 Test Loss: 0.0863080
Validation loss decreased (0.079818 --> 0.079101).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0678237
	speed: 0.0426s/iter; left time: 893.6780s
	iters: 200, epoch: 7 | loss: 0.0696619
	speed: 0.0237s/iter; left time: 493.2990s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0703334 Vali Loss: 0.0780156 Test Loss: 0.0856910
Validation loss decreased (0.079101 --> 0.078016).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0655424
	speed: 0.0419s/iter; left time: 868.0402s
	iters: 200, epoch: 8 | loss: 0.0672451
	speed: 0.0175s/iter; left time: 362.0113s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0693712 Vali Loss: 0.0775701 Test Loss: 0.0851063
Validation loss decreased (0.078016 --> 0.077570).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0726505
	speed: 0.0415s/iter; left time: 850.8317s
	iters: 200, epoch: 9 | loss: 0.0755221
	speed: 0.0180s/iter; left time: 368.3225s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0682698 Vali Loss: 0.0767766 Test Loss: 0.0837281
Validation loss decreased (0.077570 --> 0.076777).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0696447
	speed: 0.0384s/iter; left time: 778.0057s
	iters: 200, epoch: 10 | loss: 0.0655050
	speed: 0.0176s/iter; left time: 355.5780s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0672856 Vali Loss: 0.0774400 Test Loss: 0.0852725
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0677388
	speed: 0.0389s/iter; left time: 780.2298s
	iters: 200, epoch: 11 | loss: 0.0660179
	speed: 0.0176s/iter; left time: 351.3439s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0668714 Vali Loss: 0.0757332 Test Loss: 0.0832309
Validation loss decreased (0.076777 --> 0.075733).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0627297
	speed: 0.0399s/iter; left time: 791.1354s
	iters: 200, epoch: 12 | loss: 0.0637292
	speed: 0.0198s/iter; left time: 390.4583s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0662595 Vali Loss: 0.0762811 Test Loss: 0.0833561
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0679668
	speed: 0.0424s/iter; left time: 831.2221s
	iters: 200, epoch: 13 | loss: 0.0620509
	speed: 0.0189s/iter; left time: 369.4711s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0656262 Vali Loss: 0.0755052 Test Loss: 0.0833319
Validation loss decreased (0.075733 --> 0.075505).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0637436
	speed: 0.0380s/iter; left time: 737.2326s
	iters: 200, epoch: 14 | loss: 0.0679394
	speed: 0.0174s/iter; left time: 335.5480s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0654845 Vali Loss: 0.0749590 Test Loss: 0.0828288
Validation loss decreased (0.075505 --> 0.074959).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0673762
	speed: 0.0389s/iter; left time: 745.1107s
	iters: 200, epoch: 15 | loss: 0.0637540
	speed: 0.0176s/iter; left time: 336.3742s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0651479 Vali Loss: 0.0747173 Test Loss: 0.0833911
Validation loss decreased (0.074959 --> 0.074717).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0621715
	speed: 0.0389s/iter; left time: 737.4282s
	iters: 200, epoch: 16 | loss: 0.0673409
	speed: 0.0207s/iter; left time: 389.3642s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.59s
Steps: 224 | Train Loss: 0.0647666 Vali Loss: 0.0745301 Test Loss: 0.0828806
Validation loss decreased (0.074717 --> 0.074530).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0645612
	speed: 0.0386s/iter; left time: 722.2511s
	iters: 200, epoch: 17 | loss: 0.0596500
	speed: 0.0175s/iter; left time: 326.0319s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0648331 Vali Loss: 0.0742863 Test Loss: 0.0828043
Validation loss decreased (0.074530 --> 0.074286).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0642966
	speed: 0.0391s/iter; left time: 722.3137s
	iters: 200, epoch: 18 | loss: 0.0643684
	speed: 0.0206s/iter; left time: 378.3981s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0642719 Vali Loss: 0.0739853 Test Loss: 0.0824876
Validation loss decreased (0.074286 --> 0.073985).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0682903
	speed: 0.0389s/iter; left time: 710.4045s
	iters: 200, epoch: 19 | loss: 0.0667571
	speed: 0.0175s/iter; left time: 317.2031s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0642246 Vali Loss: 0.0740721 Test Loss: 0.0826298
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0613630
	speed: 0.0384s/iter; left time: 692.7923s
	iters: 200, epoch: 20 | loss: 0.0639390
	speed: 0.0190s/iter; left time: 341.4522s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0640536 Vali Loss: 0.0737642 Test Loss: 0.0826450
Validation loss decreased (0.073985 --> 0.073764).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0625804
	speed: 0.0396s/iter; left time: 705.4584s
	iters: 200, epoch: 21 | loss: 0.0654177
	speed: 0.0184s/iter; left time: 325.6939s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0640878 Vali Loss: 0.0737960 Test Loss: 0.0825673
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0607531
	speed: 0.0380s/iter; left time: 668.1070s
	iters: 200, epoch: 22 | loss: 0.0649099
	speed: 0.0174s/iter; left time: 304.0163s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0638094 Vali Loss: 0.0736277 Test Loss: 0.0830579
Validation loss decreased (0.073764 --> 0.073628).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0616302
	speed: 0.0382s/iter; left time: 662.9623s
	iters: 200, epoch: 23 | loss: 0.0592529
	speed: 0.0177s/iter; left time: 306.5675s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0637394 Vali Loss: 0.0735366 Test Loss: 0.0823405
Validation loss decreased (0.073628 --> 0.073537).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0646890
	speed: 0.0403s/iter; left time: 691.1626s
	iters: 200, epoch: 24 | loss: 0.0634022
	speed: 0.0222s/iter; left time: 379.3095s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0636263 Vali Loss: 0.0734140 Test Loss: 0.0824214
Validation loss decreased (0.073537 --> 0.073414).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0623656
	speed: 0.0406s/iter; left time: 687.8228s
	iters: 200, epoch: 25 | loss: 0.0630045
	speed: 0.0177s/iter; left time: 297.9238s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0635586 Vali Loss: 0.0734150 Test Loss: 0.0823226
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0644196
	speed: 0.0436s/iter; left time: 728.6859s
	iters: 200, epoch: 26 | loss: 0.0642436
	speed: 0.0202s/iter; left time: 335.3950s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0634620 Vali Loss: 0.0738082 Test Loss: 0.0823546
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0621702
	speed: 0.0381s/iter; left time: 627.6604s
	iters: 200, epoch: 27 | loss: 0.0636371
	speed: 0.0191s/iter; left time: 312.1788s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0633896 Vali Loss: 0.0733780 Test Loss: 0.0819248
Validation loss decreased (0.073414 --> 0.073378).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0670925
	speed: 0.0398s/iter; left time: 646.4603s
	iters: 200, epoch: 28 | loss: 0.0628431
	speed: 0.0175s/iter; left time: 283.0774s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0634301 Vali Loss: 0.0733993 Test Loss: 0.0823185
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0612113
	speed: 0.0390s/iter; left time: 625.7341s
	iters: 200, epoch: 29 | loss: 0.0665068
	speed: 0.0176s/iter; left time: 280.8766s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0633498 Vali Loss: 0.0734619 Test Loss: 0.0819948
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0626834
	speed: 0.0385s/iter; left time: 607.7644s
	iters: 200, epoch: 30 | loss: 0.0615458
	speed: 0.0174s/iter; left time: 273.6563s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0633269 Vali Loss: 0.0732484 Test Loss: 0.0825042
Validation loss decreased (0.073378 --> 0.073248).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0625415
	speed: 0.0388s/iter; left time: 603.8948s
	iters: 200, epoch: 31 | loss: 0.0673994
	speed: 0.0177s/iter; left time: 273.4155s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0632653 Vali Loss: 0.0733413 Test Loss: 0.0826836
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0583663
	speed: 0.0398s/iter; left time: 610.5682s
	iters: 200, epoch: 32 | loss: 0.0625218
	speed: 0.0198s/iter; left time: 302.5581s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0632355 Vali Loss: 0.0732359 Test Loss: 0.0821653
Validation loss decreased (0.073248 --> 0.073236).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0630707
	speed: 0.0394s/iter; left time: 595.6786s
	iters: 200, epoch: 33 | loss: 0.0647555
	speed: 0.0176s/iter; left time: 263.8631s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0631756 Vali Loss: 0.0732615 Test Loss: 0.0824250
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0610265
	speed: 0.0381s/iter; left time: 568.5660s
	iters: 200, epoch: 34 | loss: 0.0629594
	speed: 0.0176s/iter; left time: 261.2516s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0630419 Vali Loss: 0.0731823 Test Loss: 0.0821405
Validation loss decreased (0.073236 --> 0.073182).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0651123
	speed: 0.0408s/iter; left time: 598.6879s
	iters: 200, epoch: 35 | loss: 0.0626166
	speed: 0.0176s/iter; left time: 256.7227s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0630429 Vali Loss: 0.0731572 Test Loss: 0.0825000
Validation loss decreased (0.073182 --> 0.073157).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0676148
	speed: 0.0393s/iter; left time: 568.0607s
	iters: 200, epoch: 36 | loss: 0.0607777
	speed: 0.0176s/iter; left time: 253.1740s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0629283 Vali Loss: 0.0731764 Test Loss: 0.0821953
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0638510
	speed: 0.0378s/iter; left time: 537.5346s
	iters: 200, epoch: 37 | loss: 0.0606790
	speed: 0.0175s/iter; left time: 248.0959s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0629828 Vali Loss: 0.0731762 Test Loss: 0.0823688
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0626185
	speed: 0.0379s/iter; left time: 530.9683s
	iters: 200, epoch: 38 | loss: 0.0677540
	speed: 0.0186s/iter; left time: 258.7731s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0630360 Vali Loss: 0.0731249 Test Loss: 0.0822642
Validation loss decreased (0.073157 --> 0.073125).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0594267
	speed: 0.0420s/iter; left time: 579.4960s
	iters: 200, epoch: 39 | loss: 0.0592867
	speed: 0.0183s/iter; left time: 249.9079s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.0629004 Vali Loss: 0.0731309 Test Loss: 0.0823867
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0624202
	speed: 0.0398s/iter; left time: 539.8608s
	iters: 200, epoch: 40 | loss: 0.0626078
	speed: 0.0206s/iter; left time: 276.7819s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.80s
Steps: 224 | Train Loss: 0.0629448 Vali Loss: 0.0730758 Test Loss: 0.0823547
Validation loss decreased (0.073125 --> 0.073076).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0585274
	speed: 0.0409s/iter; left time: 545.1142s
	iters: 200, epoch: 41 | loss: 0.0654995
	speed: 0.0183s/iter; left time: 241.7582s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0629022 Vali Loss: 0.0731006 Test Loss: 0.0824329
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0662732
	speed: 0.0389s/iter; left time: 510.7989s
	iters: 200, epoch: 42 | loss: 0.0638925
	speed: 0.0175s/iter; left time: 227.6936s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0629260 Vali Loss: 0.0731194 Test Loss: 0.0822936
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0624809
	speed: 0.0402s/iter; left time: 518.3971s
	iters: 200, epoch: 43 | loss: 0.0598410
	speed: 0.0214s/iter; left time: 273.6937s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0628966 Vali Loss: 0.0730038 Test Loss: 0.0820691
Validation loss decreased (0.073076 --> 0.073004).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0637282
	speed: 0.0437s/iter; left time: 553.6389s
	iters: 200, epoch: 44 | loss: 0.0634378
	speed: 0.0193s/iter; left time: 242.5591s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.83s
Steps: 224 | Train Loss: 0.0628899 Vali Loss: 0.0729619 Test Loss: 0.0821936
Validation loss decreased (0.073004 --> 0.072962).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0644619
	speed: 0.0399s/iter; left time: 495.9471s
	iters: 200, epoch: 45 | loss: 0.0628364
	speed: 0.0178s/iter; left time: 219.1958s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0628545 Vali Loss: 0.0729947 Test Loss: 0.0822399
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0642725
	speed: 0.0377s/iter; left time: 460.8121s
	iters: 200, epoch: 46 | loss: 0.0629762
	speed: 0.0174s/iter; left time: 210.8627s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0629435 Vali Loss: 0.0730896 Test Loss: 0.0822521
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0616131
	speed: 0.0415s/iter; left time: 497.7589s
	iters: 200, epoch: 47 | loss: 0.0646186
	speed: 0.0195s/iter; left time: 232.2788s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.77s
Steps: 224 | Train Loss: 0.0630293 Vali Loss: 0.0731405 Test Loss: 0.0821996
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0608085
	speed: 0.0394s/iter; left time: 463.3427s
	iters: 200, epoch: 48 | loss: 0.0619352
	speed: 0.0177s/iter; left time: 206.8375s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0629598 Vali Loss: 0.0731355 Test Loss: 0.0823273
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0595867
	speed: 0.0378s/iter; left time: 436.5124s
	iters: 200, epoch: 49 | loss: 0.0611303
	speed: 0.0183s/iter; left time: 209.2064s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0628467 Vali Loss: 0.0730247 Test Loss: 0.0825256
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0653134
	speed: 0.0436s/iter; left time: 494.3080s
	iters: 200, epoch: 50 | loss: 0.0591919
	speed: 0.0177s/iter; left time: 199.0045s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0628510 Vali Loss: 0.0731374 Test Loss: 0.0824137
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0623601
	speed: 0.0387s/iter; left time: 430.0506s
	iters: 200, epoch: 51 | loss: 0.0633687
	speed: 0.0177s/iter; left time: 194.5603s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0628592 Vali Loss: 0.0729967 Test Loss: 0.0822993
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0676762
	speed: 0.0379s/iter; left time: 412.1308s
	iters: 200, epoch: 52 | loss: 0.0648613
	speed: 0.0175s/iter; left time: 189.1117s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0627263 Vali Loss: 0.0732131 Test Loss: 0.0825580
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0645146
	speed: 0.0416s/iter; left time: 443.1645s
	iters: 200, epoch: 53 | loss: 0.0648449
	speed: 0.0174s/iter; left time: 183.2132s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0629098 Vali Loss: 0.0730307 Test Loss: 0.0825109
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0656283
	speed: 0.0384s/iter; left time: 400.0912s
	iters: 200, epoch: 54 | loss: 0.0613380
	speed: 0.0198s/iter; left time: 204.5111s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.0628620 Vali Loss: 0.0730089 Test Loss: 0.0822609
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01964399963617325, rmse:0.1401570588350296, mae:0.08219358325004578, rse:0.5421647429466248
Intermediate time for FR and pred_len 96: 00h:09m:47.62s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2331251
	speed: 0.0348s/iter; left time: 772.0667s
	iters: 200, epoch: 1 | loss: 0.2124415
	speed: 0.0183s/iter; left time: 403.4618s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.62s
Steps: 223 | Train Loss: 0.2301618 Vali Loss: 0.1742980 Test Loss: 0.1785990
Validation loss decreased (inf --> 0.174298).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1321372
	speed: 0.0404s/iter; left time: 887.4506s
	iters: 200, epoch: 2 | loss: 0.0986593
	speed: 0.0181s/iter; left time: 395.8700s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.1298941 Vali Loss: 0.0991115 Test Loss: 0.1104057
Validation loss decreased (0.174298 --> 0.099111).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0942273
	speed: 0.0412s/iter; left time: 895.6911s
	iters: 200, epoch: 3 | loss: 0.0837540
	speed: 0.0181s/iter; left time: 391.4723s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0901285 Vali Loss: 0.0897258 Test Loss: 0.0991279
Validation loss decreased (0.099111 --> 0.089726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836681
	speed: 0.0399s/iter; left time: 859.5682s
	iters: 200, epoch: 4 | loss: 0.0837559
	speed: 0.0181s/iter; left time: 388.1226s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0824823 Vali Loss: 0.0846098 Test Loss: 0.0920205
Validation loss decreased (0.089726 --> 0.084610).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0822264
	speed: 0.0394s/iter; left time: 840.3433s
	iters: 200, epoch: 5 | loss: 0.0768700
	speed: 0.0177s/iter; left time: 375.0812s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0782840 Vali Loss: 0.0833012 Test Loss: 0.0921557
Validation loss decreased (0.084610 --> 0.083301).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0719065
	speed: 0.0412s/iter; left time: 869.4494s
	iters: 200, epoch: 6 | loss: 0.0762894
	speed: 0.0180s/iter; left time: 378.1237s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0751740 Vali Loss: 0.0819572 Test Loss: 0.0909903
Validation loss decreased (0.083301 --> 0.081957).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0761901
	speed: 0.0422s/iter; left time: 880.3028s
	iters: 200, epoch: 7 | loss: 0.0726519
	speed: 0.0201s/iter; left time: 417.5357s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.89s
Steps: 223 | Train Loss: 0.0736603 Vali Loss: 0.0814691 Test Loss: 0.0893811
Validation loss decreased (0.081957 --> 0.081469).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0669216
	speed: 0.0424s/iter; left time: 875.1552s
	iters: 200, epoch: 8 | loss: 0.0754231
	speed: 0.0180s/iter; left time: 369.5589s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0723458 Vali Loss: 0.0809321 Test Loss: 0.0924311
Validation loss decreased (0.081469 --> 0.080932).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0727989
	speed: 0.0388s/iter; left time: 792.1490s
	iters: 200, epoch: 9 | loss: 0.0671195
	speed: 0.0177s/iter; left time: 359.8555s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0713408 Vali Loss: 0.0797568 Test Loss: 0.0923679
Validation loss decreased (0.080932 --> 0.079757).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0683972
	speed: 0.0405s/iter; left time: 817.1563s
	iters: 200, epoch: 10 | loss: 0.0688428
	speed: 0.0189s/iter; left time: 380.3301s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.48s
Steps: 223 | Train Loss: 0.0704662 Vali Loss: 0.0788295 Test Loss: 0.0906416
Validation loss decreased (0.079757 --> 0.078830).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0760151
	speed: 0.0393s/iter; left time: 783.9271s
	iters: 200, epoch: 11 | loss: 0.0659735
	speed: 0.0205s/iter; left time: 407.8690s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.46s
Steps: 223 | Train Loss: 0.0698830 Vali Loss: 0.0787371 Test Loss: 0.0913422
Validation loss decreased (0.078830 --> 0.078737).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0676855
	speed: 0.0389s/iter; left time: 767.7499s
	iters: 200, epoch: 12 | loss: 0.0701122
	speed: 0.0195s/iter; left time: 383.4898s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0692690 Vali Loss: 0.0787894 Test Loss: 0.0932875
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0701766
	speed: 0.0392s/iter; left time: 764.9497s
	iters: 200, epoch: 13 | loss: 0.0692856
	speed: 0.0178s/iter; left time: 345.4384s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0691316 Vali Loss: 0.0783091 Test Loss: 0.0898682
Validation loss decreased (0.078737 --> 0.078309).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0690016
	speed: 0.0406s/iter; left time: 784.3569s
	iters: 200, epoch: 14 | loss: 0.0711716
	speed: 0.0181s/iter; left time: 347.1951s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0685913 Vali Loss: 0.0783116 Test Loss: 0.0919532
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0656164
	speed: 0.0390s/iter; left time: 744.0563s
	iters: 200, epoch: 15 | loss: 0.0713738
	speed: 0.0180s/iter; left time: 342.4122s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0685032 Vali Loss: 0.0786223 Test Loss: 0.0913661
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0695635
	speed: 0.0379s/iter; left time: 715.5347s
	iters: 200, epoch: 16 | loss: 0.0691783
	speed: 0.0177s/iter; left time: 332.4023s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0680074 Vali Loss: 0.0780811 Test Loss: 0.0919043
Validation loss decreased (0.078309 --> 0.078081).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0680425
	speed: 0.0395s/iter; left time: 736.1828s
	iters: 200, epoch: 17 | loss: 0.0696930
	speed: 0.0195s/iter; left time: 361.6886s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.48s
Steps: 223 | Train Loss: 0.0678470 Vali Loss: 0.0775457 Test Loss: 0.0893896
Validation loss decreased (0.078081 --> 0.077546).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0698916
	speed: 0.0397s/iter; left time: 730.7978s
	iters: 200, epoch: 18 | loss: 0.0676719
	speed: 0.0184s/iter; left time: 337.3926s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0677600 Vali Loss: 0.0777570 Test Loss: 0.0909423
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0653757
	speed: 0.0391s/iter; left time: 711.2592s
	iters: 200, epoch: 19 | loss: 0.0676356
	speed: 0.0182s/iter; left time: 329.6164s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0675428 Vali Loss: 0.0773521 Test Loss: 0.0890149
Validation loss decreased (0.077546 --> 0.077352).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0683559
	speed: 0.0398s/iter; left time: 714.4407s
	iters: 200, epoch: 20 | loss: 0.0639949
	speed: 0.0180s/iter; left time: 320.7575s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0676722 Vali Loss: 0.0775077 Test Loss: 0.0910440
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0646337
	speed: 0.0384s/iter; left time: 680.4631s
	iters: 200, epoch: 21 | loss: 0.0659115
	speed: 0.0176s/iter; left time: 311.2567s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0672509 Vali Loss: 0.0776907 Test Loss: 0.0908001
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0670489
	speed: 0.0382s/iter; left time: 669.3835s
	iters: 200, epoch: 22 | loss: 0.0742496
	speed: 0.0183s/iter; left time: 318.5510s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0671914 Vali Loss: 0.0771561 Test Loss: 0.0883760
Validation loss decreased (0.077352 --> 0.077156).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0651396
	speed: 0.0397s/iter; left time: 687.0519s
	iters: 200, epoch: 23 | loss: 0.0670115
	speed: 0.0178s/iter; left time: 305.7846s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0670595 Vali Loss: 0.0775332 Test Loss: 0.0899414
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0732589
	speed: 0.0391s/iter; left time: 667.1251s
	iters: 200, epoch: 24 | loss: 0.0654945
	speed: 0.0178s/iter; left time: 301.8487s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0669309 Vali Loss: 0.0774002 Test Loss: 0.0899760
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0684945
	speed: 0.0430s/iter; left time: 724.8585s
	iters: 200, epoch: 25 | loss: 0.0701072
	speed: 0.0183s/iter; left time: 306.3342s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.72s
Steps: 223 | Train Loss: 0.0669362 Vali Loss: 0.0772586 Test Loss: 0.0891542
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0694126
	speed: 0.0392s/iter; left time: 650.9989s
	iters: 200, epoch: 26 | loss: 0.0657393
	speed: 0.0179s/iter; left time: 295.2251s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0668841 Vali Loss: 0.0774661 Test Loss: 0.0903360
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0636524
	speed: 0.0428s/iter; left time: 701.9727s
	iters: 200, epoch: 27 | loss: 0.0675355
	speed: 0.0183s/iter; left time: 298.4665s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.68s
Steps: 223 | Train Loss: 0.0667550 Vali Loss: 0.0773848 Test Loss: 0.0904554
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0638153
	speed: 0.0392s/iter; left time: 634.4178s
	iters: 200, epoch: 28 | loss: 0.0673073
	speed: 0.0188s/iter; left time: 301.6964s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0667330 Vali Loss: 0.0773026 Test Loss: 0.0881627
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0657105
	speed: 0.0424s/iter; left time: 676.9987s
	iters: 200, epoch: 29 | loss: 0.0671053
	speed: 0.0182s/iter; left time: 289.2427s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0667498 Vali Loss: 0.0774495 Test Loss: 0.0902981
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0669222
	speed: 0.0401s/iter; left time: 631.0496s
	iters: 200, epoch: 30 | loss: 0.0673720
	speed: 0.0181s/iter; left time: 282.2231s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0666635 Vali Loss: 0.0774009 Test Loss: 0.0905739
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0634968
	speed: 0.0389s/iter; left time: 603.3196s
	iters: 200, epoch: 31 | loss: 0.0644372
	speed: 0.0176s/iter; left time: 271.4407s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0667213 Vali Loss: 0.0772319 Test Loss: 0.0896221
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0664342
	speed: 0.0404s/iter; left time: 617.8321s
	iters: 200, epoch: 32 | loss: 0.0692329
	speed: 0.0180s/iter; left time: 274.1081s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.63s
Steps: 223 | Train Loss: 0.0664226 Vali Loss: 0.0772566 Test Loss: 0.0898893
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.022333160042762756, rmse:0.14944283664226532, mae:0.0883760005235672, rse:0.5788062810897827
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2338009
	speed: 0.0201s/iter; left time: 446.0482s
	iters: 200, epoch: 1 | loss: 0.2113497
	speed: 0.0178s/iter; left time: 393.2316s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.2351485 Vali Loss: 0.1777055 Test Loss: 0.1820173
Validation loss decreased (inf --> 0.177705).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1296885
	speed: 0.0404s/iter; left time: 888.7276s
	iters: 200, epoch: 2 | loss: 0.1060445
	speed: 0.0175s/iter; left time: 383.9326s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.1309497 Vali Loss: 0.1010024 Test Loss: 0.1117636
Validation loss decreased (0.177705 --> 0.101002).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0898933
	speed: 0.0445s/iter; left time: 968.0530s
	iters: 200, epoch: 3 | loss: 0.0850986
	speed: 0.0180s/iter; left time: 390.1429s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.66s
Steps: 223 | Train Loss: 0.0903900 Vali Loss: 0.0884563 Test Loss: 0.0977771
Validation loss decreased (0.101002 --> 0.088456).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0851167
	speed: 0.0404s/iter; left time: 869.0622s
	iters: 200, epoch: 4 | loss: 0.0821580
	speed: 0.0177s/iter; left time: 379.3091s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0821500 Vali Loss: 0.0849737 Test Loss: 0.0932884
Validation loss decreased (0.088456 --> 0.084974).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0837977
	speed: 0.0413s/iter; left time: 880.7097s
	iters: 200, epoch: 5 | loss: 0.0703436
	speed: 0.0178s/iter; left time: 378.3061s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.32s
Steps: 223 | Train Loss: 0.0775127 Vali Loss: 0.0828958 Test Loss: 0.0914282
Validation loss decreased (0.084974 --> 0.082896).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0745545
	speed: 0.0410s/iter; left time: 863.7999s
	iters: 200, epoch: 6 | loss: 0.0744729
	speed: 0.0179s/iter; left time: 375.7078s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0745978 Vali Loss: 0.0821939 Test Loss: 0.0909900
Validation loss decreased (0.082896 --> 0.082194).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0731700
	speed: 0.0425s/iter; left time: 886.7511s
	iters: 200, epoch: 7 | loss: 0.0701108
	speed: 0.0201s/iter; left time: 416.8276s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.85s
Steps: 223 | Train Loss: 0.0730689 Vali Loss: 0.0816647 Test Loss: 0.0913772
Validation loss decreased (0.082194 --> 0.081665).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0700859
	speed: 0.0437s/iter; left time: 900.9994s
	iters: 200, epoch: 8 | loss: 0.0771661
	speed: 0.0186s/iter; left time: 381.6433s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.42s
Steps: 223 | Train Loss: 0.0716500 Vali Loss: 0.0805202 Test Loss: 0.0901807
Validation loss decreased (0.081665 --> 0.080520).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0721290
	speed: 0.0404s/iter; left time: 824.8038s
	iters: 200, epoch: 9 | loss: 0.0726074
	speed: 0.0179s/iter; left time: 364.3706s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0708523 Vali Loss: 0.0799291 Test Loss: 0.0895342
Validation loss decreased (0.080520 --> 0.079929).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0701376
	speed: 0.0430s/iter; left time: 868.5910s
	iters: 200, epoch: 10 | loss: 0.0696241
	speed: 0.0179s/iter; left time: 358.7377s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.50s
Steps: 223 | Train Loss: 0.0701862 Vali Loss: 0.0797360 Test Loss: 0.0909912
Validation loss decreased (0.079929 --> 0.079736).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0727235
	speed: 0.0442s/iter; left time: 882.4450s
	iters: 200, epoch: 11 | loss: 0.0719530
	speed: 0.0210s/iter; left time: 418.2359s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.02s
Steps: 223 | Train Loss: 0.0696189 Vali Loss: 0.0792079 Test Loss: 0.0916442
Validation loss decreased (0.079736 --> 0.079208).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0694411
	speed: 0.0397s/iter; left time: 784.4346s
	iters: 200, epoch: 12 | loss: 0.0701601
	speed: 0.0177s/iter; left time: 347.1533s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0691945 Vali Loss: 0.0792702 Test Loss: 0.0921250
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0706597
	speed: 0.0387s/iter; left time: 756.1448s
	iters: 200, epoch: 13 | loss: 0.0664091
	speed: 0.0177s/iter; left time: 344.0905s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0686682 Vali Loss: 0.0784566 Test Loss: 0.0906340
Validation loss decreased (0.079208 --> 0.078457).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0664055
	speed: 0.0405s/iter; left time: 782.2171s
	iters: 200, epoch: 14 | loss: 0.0713549
	speed: 0.0185s/iter; left time: 355.3006s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0684731 Vali Loss: 0.0782182 Test Loss: 0.0892464
Validation loss decreased (0.078457 --> 0.078218).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0699410
	speed: 0.0424s/iter; left time: 809.3043s
	iters: 200, epoch: 15 | loss: 0.0682169
	speed: 0.0211s/iter; left time: 399.7423s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.78s
Steps: 223 | Train Loss: 0.0684699 Vali Loss: 0.0780147 Test Loss: 0.0898599
Validation loss decreased (0.078218 --> 0.078015).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0680146
	speed: 0.0397s/iter; left time: 747.6787s
	iters: 200, epoch: 16 | loss: 0.0677583
	speed: 0.0177s/iter; left time: 332.0250s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0680419 Vali Loss: 0.0782818 Test Loss: 0.0908714
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0671236
	speed: 0.0390s/iter; left time: 725.9557s
	iters: 200, epoch: 17 | loss: 0.0664326
	speed: 0.0178s/iter; left time: 329.8612s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0679523 Vali Loss: 0.0789498 Test Loss: 0.0928031
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0618326
	speed: 0.0393s/iter; left time: 724.1540s
	iters: 200, epoch: 18 | loss: 0.0646246
	speed: 0.0177s/iter; left time: 323.3319s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0678683 Vali Loss: 0.0786893 Test Loss: 0.0923784
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0697901
	speed: 0.0403s/iter; left time: 732.7224s
	iters: 200, epoch: 19 | loss: 0.0634456
	speed: 0.0181s/iter; left time: 327.8728s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.45s
Steps: 223 | Train Loss: 0.0675773 Vali Loss: 0.0775630 Test Loss: 0.0896100
Validation loss decreased (0.078015 --> 0.077563).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0713500
	speed: 0.0420s/iter; left time: 754.6242s
	iters: 200, epoch: 20 | loss: 0.0695355
	speed: 0.0212s/iter; left time: 377.8863s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.95s
Steps: 223 | Train Loss: 0.0675087 Vali Loss: 0.0786587 Test Loss: 0.0923917
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0657799
	speed: 0.0433s/iter; left time: 767.9694s
	iters: 200, epoch: 21 | loss: 0.0677098
	speed: 0.0177s/iter; left time: 312.7954s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.48s
Steps: 223 | Train Loss: 0.0672962 Vali Loss: 0.0777801 Test Loss: 0.0899067
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0690822
	speed: 0.0385s/iter; left time: 674.6683s
	iters: 200, epoch: 22 | loss: 0.0640728
	speed: 0.0176s/iter; left time: 307.3307s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0672103 Vali Loss: 0.0775899 Test Loss: 0.0897816
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0701658
	speed: 0.0426s/iter; left time: 737.0696s
	iters: 200, epoch: 23 | loss: 0.0661751
	speed: 0.0180s/iter; left time: 309.1872s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.58s
Steps: 223 | Train Loss: 0.0670811 Vali Loss: 0.0779882 Test Loss: 0.0916405
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0700050
	speed: 0.0426s/iter; left time: 726.5921s
	iters: 200, epoch: 24 | loss: 0.0684151
	speed: 0.0180s/iter; left time: 306.0768s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.52s
Steps: 223 | Train Loss: 0.0671400 Vali Loss: 0.0772222 Test Loss: 0.0890531
Validation loss decreased (0.077563 --> 0.077222).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0648551
	speed: 0.0425s/iter; left time: 716.7336s
	iters: 200, epoch: 25 | loss: 0.0685759
	speed: 0.0183s/iter; left time: 305.7663s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.55s
Steps: 223 | Train Loss: 0.0671076 Vali Loss: 0.0775080 Test Loss: 0.0902300
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0675120
	speed: 0.0394s/iter; left time: 655.7062s
	iters: 200, epoch: 26 | loss: 0.0694718
	speed: 0.0177s/iter; left time: 292.2617s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0669079 Vali Loss: 0.0777307 Test Loss: 0.0908990
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0634031
	speed: 0.0381s/iter; left time: 625.6566s
	iters: 200, epoch: 27 | loss: 0.0635816
	speed: 0.0177s/iter; left time: 288.7122s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0668347 Vali Loss: 0.0775759 Test Loss: 0.0907329
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0687936
	speed: 0.0401s/iter; left time: 648.8057s
	iters: 200, epoch: 28 | loss: 0.0681904
	speed: 0.0177s/iter; left time: 285.2756s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.36s
Steps: 223 | Train Loss: 0.0668545 Vali Loss: 0.0777343 Test Loss: 0.0911858
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0675881
	speed: 0.0416s/iter; left time: 664.1756s
	iters: 200, epoch: 29 | loss: 0.0632508
	speed: 0.0197s/iter; left time: 312.7967s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.65s
Steps: 223 | Train Loss: 0.0667225 Vali Loss: 0.0780558 Test Loss: 0.0921468
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0664763
	speed: 0.0387s/iter; left time: 609.6658s
	iters: 200, epoch: 30 | loss: 0.0651597
	speed: 0.0179s/iter; left time: 279.3101s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0666217 Vali Loss: 0.0772186 Test Loss: 0.0897463
Validation loss decreased (0.077222 --> 0.077219).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0678580
	speed: 0.0407s/iter; left time: 631.5925s
	iters: 200, epoch: 31 | loss: 0.0678781
	speed: 0.0185s/iter; left time: 284.6192s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0666143 Vali Loss: 0.0780442 Test Loss: 0.0923045
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0662480
	speed: 0.0398s/iter; left time: 608.8923s
	iters: 200, epoch: 32 | loss: 0.0668110
	speed: 0.0179s/iter; left time: 271.4694s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.32s
Steps: 223 | Train Loss: 0.0668373 Vali Loss: 0.0774316 Test Loss: 0.0905306
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0657418
	speed: 0.0394s/iter; left time: 593.4808s
	iters: 200, epoch: 33 | loss: 0.0670040
	speed: 0.0178s/iter; left time: 266.7652s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0665792 Vali Loss: 0.0772628 Test Loss: 0.0899137
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0633922
	speed: 0.0398s/iter; left time: 590.6545s
	iters: 200, epoch: 34 | loss: 0.0681318
	speed: 0.0207s/iter; left time: 304.5200s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.63s
Steps: 223 | Train Loss: 0.0665149 Vali Loss: 0.0776413 Test Loss: 0.0905718
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0645623
	speed: 0.0439s/iter; left time: 641.5640s
	iters: 200, epoch: 35 | loss: 0.0610137
	speed: 0.0195s/iter; left time: 282.4944s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.77s
Steps: 223 | Train Loss: 0.0667504 Vali Loss: 0.0775892 Test Loss: 0.0910387
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0649652
	speed: 0.0396s/iter; left time: 570.7519s
	iters: 200, epoch: 36 | loss: 0.0659663
	speed: 0.0182s/iter; left time: 260.0314s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0664823 Vali Loss: 0.0775485 Test Loss: 0.0911583
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0650879
	speed: 0.0396s/iter; left time: 561.7855s
	iters: 200, epoch: 37 | loss: 0.0669365
	speed: 0.0178s/iter; left time: 249.9567s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0665093 Vali Loss: 0.0773734 Test Loss: 0.0903130
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0664747
	speed: 0.0404s/iter; left time: 564.1421s
	iters: 200, epoch: 38 | loss: 0.0678473
	speed: 0.0191s/iter; left time: 263.9785s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.0665654 Vali Loss: 0.0774224 Test Loss: 0.0905910
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0640347
	speed: 0.0406s/iter; left time: 557.8665s
	iters: 200, epoch: 39 | loss: 0.0625794
	speed: 0.0179s/iter; left time: 243.9989s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0666471 Vali Loss: 0.0774096 Test Loss: 0.0905216
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0646422
	speed: 0.0419s/iter; left time: 566.2285s
	iters: 200, epoch: 40 | loss: 0.0696381
	speed: 0.0179s/iter; left time: 239.8055s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.52s
Steps: 223 | Train Loss: 0.0665738 Vali Loss: 0.0775945 Test Loss: 0.0911420
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023340126499533653, rmse:0.15277475118637085, mae:0.08974632620811462, rse:0.5917111039161682
Intermediate time for FR and pred_len 168: 00h:07m:13.42sIntermediate time for FR: 00h:28m:30.81s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2560055
	speed: 0.0304s/iter; left time: 676.9225s
	iters: 200, epoch: 1 | loss: 0.2423811
	speed: 0.0175s/iter; left time: 388.2763s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.2639609 Vali Loss: 0.1822851 Test Loss: 0.1915715
Validation loss decreased (inf --> 0.182285).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1499175
	speed: 0.0392s/iter; left time: 865.6721s
	iters: 200, epoch: 2 | loss: 0.1110561
	speed: 0.0175s/iter; left time: 384.0894s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.1521612 Vali Loss: 0.0901437 Test Loss: 0.0920071
Validation loss decreased (0.182285 --> 0.090144).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0964962
	speed: 0.0376s/iter; left time: 822.0139s
	iters: 200, epoch: 3 | loss: 0.0906514
	speed: 0.0176s/iter; left time: 383.4783s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0976476 Vali Loss: 0.0847392 Test Loss: 0.0874494
Validation loss decreased (0.090144 --> 0.084739).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0864783
	speed: 0.0376s/iter; left time: 814.1386s
	iters: 200, epoch: 4 | loss: 0.0808783
	speed: 0.0214s/iter; left time: 461.0338s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0859300 Vali Loss: 0.0745625 Test Loss: 0.0767037
Validation loss decreased (0.084739 --> 0.074563).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0772275
	speed: 0.0386s/iter; left time: 825.7412s
	iters: 200, epoch: 5 | loss: 0.0778586
	speed: 0.0175s/iter; left time: 372.6430s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0791329 Vali Loss: 0.0722122 Test Loss: 0.0735523
Validation loss decreased (0.074563 --> 0.072212).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0728484
	speed: 0.0382s/iter; left time: 810.0153s
	iters: 200, epoch: 6 | loss: 0.0703937
	speed: 0.0174s/iter; left time: 367.2156s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0749529 Vali Loss: 0.0680712 Test Loss: 0.0702668
Validation loss decreased (0.072212 --> 0.068071).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0738745
	speed: 0.0382s/iter; left time: 800.5918s
	iters: 200, epoch: 7 | loss: 0.0698383
	speed: 0.0211s/iter; left time: 440.1896s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.69s
Steps: 224 | Train Loss: 0.0722505 Vali Loss: 0.0665125 Test Loss: 0.0687683
Validation loss decreased (0.068071 --> 0.066513).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0688370
	speed: 0.0385s/iter; left time: 797.6860s
	iters: 200, epoch: 8 | loss: 0.0689583
	speed: 0.0188s/iter; left time: 387.0181s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0702076 Vali Loss: 0.0653898 Test Loss: 0.0675688
Validation loss decreased (0.066513 --> 0.065390).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0647229
	speed: 0.0357s/iter; left time: 732.6824s
	iters: 200, epoch: 9 | loss: 0.0688971
	speed: 0.0173s/iter; left time: 352.7447s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0684367 Vali Loss: 0.0633853 Test Loss: 0.0661179
Validation loss decreased (0.065390 --> 0.063385).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0661676
	speed: 0.0369s/iter; left time: 747.5107s
	iters: 200, epoch: 10 | loss: 0.0664062
	speed: 0.0181s/iter; left time: 366.1668s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0671174 Vali Loss: 0.0630891 Test Loss: 0.0654256
Validation loss decreased (0.063385 --> 0.063089).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0693754
	speed: 0.0375s/iter; left time: 752.4592s
	iters: 200, epoch: 11 | loss: 0.0624651
	speed: 0.0172s/iter; left time: 343.2314s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0662988 Vali Loss: 0.0635253 Test Loss: 0.0655094
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0611211
	speed: 0.0387s/iter; left time: 766.8558s
	iters: 200, epoch: 12 | loss: 0.0669602
	speed: 0.0178s/iter; left time: 351.5566s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0656425 Vali Loss: 0.0622943 Test Loss: 0.0649446
Validation loss decreased (0.063089 --> 0.062294).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0642260
	speed: 0.0356s/iter; left time: 698.5475s
	iters: 200, epoch: 13 | loss: 0.0644801
	speed: 0.0172s/iter; left time: 335.9136s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0647798 Vali Loss: 0.0621777 Test Loss: 0.0645988
Validation loss decreased (0.062294 --> 0.062178).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0674695
	speed: 0.0360s/iter; left time: 697.7282s
	iters: 200, epoch: 14 | loss: 0.0632765
	speed: 0.0189s/iter; left time: 365.5181s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0646523 Vali Loss: 0.0618180 Test Loss: 0.0642300
Validation loss decreased (0.062178 --> 0.061818).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0655746
	speed: 0.0392s/iter; left time: 752.1274s
	iters: 200, epoch: 15 | loss: 0.0638550
	speed: 0.0174s/iter; left time: 331.8465s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0637141 Vali Loss: 0.0608835 Test Loss: 0.0631070
Validation loss decreased (0.061818 --> 0.060883).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0640039
	speed: 0.0383s/iter; left time: 726.0784s
	iters: 200, epoch: 16 | loss: 0.0642456
	speed: 0.0199s/iter; left time: 374.5112s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0636292 Vali Loss: 0.0608949 Test Loss: 0.0631435
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0685354
	speed: 0.0361s/iter; left time: 676.4537s
	iters: 200, epoch: 17 | loss: 0.0637547
	speed: 0.0173s/iter; left time: 321.1864s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0630940 Vali Loss: 0.0606412 Test Loss: 0.0629768
Validation loss decreased (0.060883 --> 0.060641).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0598314
	speed: 0.0415s/iter; left time: 766.9315s
	iters: 200, epoch: 18 | loss: 0.0647024
	speed: 0.0233s/iter; left time: 427.7571s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0630775 Vali Loss: 0.0606949 Test Loss: 0.0630801
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0620685
	speed: 0.0358s/iter; left time: 653.1507s
	iters: 200, epoch: 19 | loss: 0.0674284
	speed: 0.0176s/iter; left time: 320.4150s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0624383 Vali Loss: 0.0603855 Test Loss: 0.0626716
Validation loss decreased (0.060641 --> 0.060385).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0621745
	speed: 0.0359s/iter; left time: 648.3252s
	iters: 200, epoch: 20 | loss: 0.0610410
	speed: 0.0188s/iter; left time: 337.8408s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0623783 Vali Loss: 0.0597838 Test Loss: 0.0622265
Validation loss decreased (0.060385 --> 0.059784).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0643027
	speed: 0.0386s/iter; left time: 688.3263s
	iters: 200, epoch: 21 | loss: 0.0635789
	speed: 0.0193s/iter; left time: 342.2956s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0620359 Vali Loss: 0.0599911 Test Loss: 0.0622726
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0596088
	speed: 0.0380s/iter; left time: 668.4387s
	iters: 200, epoch: 22 | loss: 0.0565989
	speed: 0.0176s/iter; left time: 307.7359s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0619664 Vali Loss: 0.0603789 Test Loss: 0.0627585
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0617142
	speed: 0.0367s/iter; left time: 637.1185s
	iters: 200, epoch: 23 | loss: 0.0577852
	speed: 0.0175s/iter; left time: 302.0240s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0620533 Vali Loss: 0.0601866 Test Loss: 0.0625348
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0658285
	speed: 0.0392s/iter; left time: 671.5639s
	iters: 200, epoch: 24 | loss: 0.0624162
	speed: 0.0214s/iter; left time: 364.0427s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0617895 Vali Loss: 0.0595263 Test Loss: 0.0618030
Validation loss decreased (0.059784 --> 0.059526).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0604893
	speed: 0.0438s/iter; left time: 741.8350s
	iters: 200, epoch: 25 | loss: 0.0644202
	speed: 0.0229s/iter; left time: 385.8357s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0616262 Vali Loss: 0.0594431 Test Loss: 0.0618435
Validation loss decreased (0.059526 --> 0.059443).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0633843
	speed: 0.0404s/iter; left time: 675.5006s
	iters: 200, epoch: 26 | loss: 0.0642667
	speed: 0.0203s/iter; left time: 336.7469s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0613934 Vali Loss: 0.0597313 Test Loss: 0.0621125
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0635059
	speed: 0.0372s/iter; left time: 612.8952s
	iters: 200, epoch: 27 | loss: 0.0648736
	speed: 0.0173s/iter; left time: 282.6535s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0616678 Vali Loss: 0.0593503 Test Loss: 0.0616880
Validation loss decreased (0.059443 --> 0.059350).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0627745
	speed: 0.0388s/iter; left time: 630.8490s
	iters: 200, epoch: 28 | loss: 0.0599788
	speed: 0.0176s/iter; left time: 283.5790s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0613947 Vali Loss: 0.0594047 Test Loss: 0.0617809
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0639490
	speed: 0.0396s/iter; left time: 634.7008s
	iters: 200, epoch: 29 | loss: 0.0592804
	speed: 0.0202s/iter; left time: 321.6507s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0612338 Vali Loss: 0.0593479 Test Loss: 0.0617195
Validation loss decreased (0.059350 --> 0.059348).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0607678
	speed: 0.0377s/iter; left time: 596.4333s
	iters: 200, epoch: 30 | loss: 0.0641361
	speed: 0.0175s/iter; left time: 274.5664s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0611303 Vali Loss: 0.0593081 Test Loss: 0.0616164
Validation loss decreased (0.059348 --> 0.059308).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0588564
	speed: 0.0376s/iter; left time: 585.0672s
	iters: 200, epoch: 31 | loss: 0.0648428
	speed: 0.0173s/iter; left time: 268.3321s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0613387 Vali Loss: 0.0591463 Test Loss: 0.0613821
Validation loss decreased (0.059308 --> 0.059146).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0604499
	speed: 0.0367s/iter; left time: 564.1100s
	iters: 200, epoch: 32 | loss: 0.0640636
	speed: 0.0172s/iter; left time: 262.4252s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0612083 Vali Loss: 0.0594587 Test Loss: 0.0617125
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0624675
	speed: 0.0349s/iter; left time: 528.0813s
	iters: 200, epoch: 33 | loss: 0.0600911
	speed: 0.0172s/iter; left time: 258.5296s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.04s
Steps: 224 | Train Loss: 0.0609271 Vali Loss: 0.0592494 Test Loss: 0.0614855
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0635118
	speed: 0.0358s/iter; left time: 533.0532s
	iters: 200, epoch: 34 | loss: 0.0946214
	speed: 0.0204s/iter; left time: 302.4767s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0611602 Vali Loss: 0.0593447 Test Loss: 0.0616473
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0602311
	speed: 0.0366s/iter; left time: 538.1458s
	iters: 200, epoch: 35 | loss: 0.0621813
	speed: 0.0176s/iter; left time: 257.1629s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0609819 Vali Loss: 0.0590882 Test Loss: 0.0613859
Validation loss decreased (0.059146 --> 0.059088).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0620438
	speed: 0.0380s/iter; left time: 548.8782s
	iters: 200, epoch: 36 | loss: 0.0598730
	speed: 0.0176s/iter; left time: 253.0003s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0609751 Vali Loss: 0.0590834 Test Loss: 0.0613925
Validation loss decreased (0.059088 --> 0.059083).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0600442
	speed: 0.0404s/iter; left time: 575.3891s
	iters: 200, epoch: 37 | loss: 0.0591222
	speed: 0.0233s/iter; left time: 329.1502s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0609594 Vali Loss: 0.0589771 Test Loss: 0.0613019
Validation loss decreased (0.059083 --> 0.058977).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0589398
	speed: 0.0386s/iter; left time: 540.5845s
	iters: 200, epoch: 38 | loss: 0.0614082
	speed: 0.0206s/iter; left time: 286.2924s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0607794 Vali Loss: 0.0589334 Test Loss: 0.0612865
Validation loss decreased (0.058977 --> 0.058933).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0574795
	speed: 0.0394s/iter; left time: 542.6203s
	iters: 200, epoch: 39 | loss: 0.0624223
	speed: 0.0182s/iter; left time: 249.0872s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0611033 Vali Loss: 0.0591056 Test Loss: 0.0613814
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0639464
	speed: 0.0355s/iter; left time: 481.2856s
	iters: 200, epoch: 40 | loss: 0.0595626
	speed: 0.0175s/iter; left time: 234.9922s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0608663 Vali Loss: 0.0589405 Test Loss: 0.0612287
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0621145
	speed: 0.0387s/iter; left time: 516.7067s
	iters: 200, epoch: 41 | loss: 0.0573874
	speed: 0.0175s/iter; left time: 232.2955s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0607561 Vali Loss: 0.0590657 Test Loss: 0.0614425
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0572144
	speed: 0.0380s/iter; left time: 497.8001s
	iters: 200, epoch: 42 | loss: 0.0644505
	speed: 0.0188s/iter; left time: 244.9009s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0607047 Vali Loss: 0.0591092 Test Loss: 0.0613679
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0579505
	speed: 0.0389s/iter; left time: 502.0051s
	iters: 200, epoch: 43 | loss: 0.0580008
	speed: 0.0197s/iter; left time: 252.1301s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.0607837 Vali Loss: 0.0590627 Test Loss: 0.0613699
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0629449
	speed: 0.0376s/iter; left time: 476.1771s
	iters: 200, epoch: 44 | loss: 0.0596044
	speed: 0.0173s/iter; left time: 217.1594s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0606620 Vali Loss: 0.0589061 Test Loss: 0.0612458
Validation loss decreased (0.058933 --> 0.058906).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0618322
	speed: 0.0364s/iter; left time: 452.6790s
	iters: 200, epoch: 45 | loss: 0.0619233
	speed: 0.0174s/iter; left time: 214.7077s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0607194 Vali Loss: 0.0589944 Test Loss: 0.0612786
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0583248
	speed: 0.0376s/iter; left time: 458.9229s
	iters: 200, epoch: 46 | loss: 0.0663955
	speed: 0.0180s/iter; left time: 217.7332s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0607617 Vali Loss: 0.0589031 Test Loss: 0.0611764
Validation loss decreased (0.058906 --> 0.058903).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0660463
	speed: 0.0403s/iter; left time: 483.5874s
	iters: 200, epoch: 47 | loss: 0.0552468
	speed: 0.0223s/iter; left time: 265.7866s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0606627 Vali Loss: 0.0588262 Test Loss: 0.0611966
Validation loss decreased (0.058903 --> 0.058826).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0637724
	speed: 0.0386s/iter; left time: 454.2796s
	iters: 200, epoch: 48 | loss: 0.0581999
	speed: 0.0174s/iter; left time: 202.9162s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0606510 Vali Loss: 0.0588008 Test Loss: 0.0611676
Validation loss decreased (0.058826 --> 0.058801).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0612788
	speed: 0.0370s/iter; left time: 427.6264s
	iters: 200, epoch: 49 | loss: 0.0595845
	speed: 0.0172s/iter; left time: 196.4773s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0607609 Vali Loss: 0.0589493 Test Loss: 0.0612049
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0606880
	speed: 0.0359s/iter; left time: 406.4402s
	iters: 200, epoch: 50 | loss: 0.0575103
	speed: 0.0176s/iter; left time: 197.7273s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0605927 Vali Loss: 0.0588233 Test Loss: 0.0611529
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0583223
	speed: 0.0360s/iter; left time: 399.6193s
	iters: 200, epoch: 51 | loss: 0.0564286
	speed: 0.0175s/iter; left time: 193.0200s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0606428 Vali Loss: 0.0589695 Test Loss: 0.0612331
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0586103
	speed: 0.0362s/iter; left time: 393.3556s
	iters: 200, epoch: 52 | loss: 0.0599242
	speed: 0.0174s/iter; left time: 187.5579s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0609928 Vali Loss: 0.0589494 Test Loss: 0.0612600
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0607768
	speed: 0.0352s/iter; left time: 375.3503s
	iters: 200, epoch: 53 | loss: 0.0578123
	speed: 0.0172s/iter; left time: 181.9672s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0605673 Vali Loss: 0.0589965 Test Loss: 0.0612734
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0582478
	speed: 0.0351s/iter; left time: 365.7491s
	iters: 200, epoch: 54 | loss: 0.0650805
	speed: 0.0172s/iter; left time: 177.4844s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.04s
Steps: 224 | Train Loss: 0.0608260 Vali Loss: 0.0589558 Test Loss: 0.0612622
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0621394
	speed: 0.0364s/iter; left time: 371.8522s
	iters: 200, epoch: 55 | loss: 0.0649265
	speed: 0.0209s/iter; left time: 211.2089s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.71s
Steps: 224 | Train Loss: 0.0605743 Vali Loss: 0.0588586 Test Loss: 0.0611447
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0603352
	speed: 0.0409s/iter; left time: 408.6260s
	iters: 200, epoch: 56 | loss: 0.0634415
	speed: 0.0176s/iter; left time: 173.6850s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0607421 Vali Loss: 0.0590274 Test Loss: 0.0612483
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0622949
	speed: 0.0353s/iter; left time: 344.6568s
	iters: 200, epoch: 57 | loss: 0.0601036
	speed: 0.0175s/iter; left time: 168.6042s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0606561 Vali Loss: 0.0588887 Test Loss: 0.0612124
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0599005
	speed: 0.0364s/iter; left time: 347.3906s
	iters: 200, epoch: 58 | loss: 0.0614105
	speed: 0.0174s/iter; left time: 163.9379s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0604505 Vali Loss: 0.0589556 Test Loss: 0.0612334
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010705658234655857, rmse:0.1034681499004364, mae:0.061167631298303604, rse:0.3909551799297333
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2627974
	speed: 0.0193s/iter; left time: 430.5646s
	iters: 200, epoch: 1 | loss: 0.2482974
	speed: 0.0175s/iter; left time: 388.4034s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.2667958 Vali Loss: 0.1863317 Test Loss: 0.1942592
Validation loss decreased (inf --> 0.186332).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1461807
	speed: 0.0373s/iter; left time: 824.3923s
	iters: 200, epoch: 2 | loss: 0.1113860
	speed: 0.0175s/iter; left time: 385.2994s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.1526986 Vali Loss: 0.0869366 Test Loss: 0.0887382
Validation loss decreased (0.186332 --> 0.086937).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0986181
	speed: 0.0362s/iter; left time: 790.3761s
	iters: 200, epoch: 3 | loss: 0.0901592
	speed: 0.0183s/iter; left time: 398.4785s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0963260 Vali Loss: 0.0807218 Test Loss: 0.0841014
Validation loss decreased (0.086937 --> 0.080722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0871330
	speed: 0.0402s/iter; left time: 870.2912s
	iters: 200, epoch: 4 | loss: 0.0840114
	speed: 0.0191s/iter; left time: 411.6920s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0852837 Vali Loss: 0.0751896 Test Loss: 0.0769653
Validation loss decreased (0.080722 --> 0.075190).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0768439
	speed: 0.0388s/iter; left time: 830.3850s
	iters: 200, epoch: 5 | loss: 0.0793418
	speed: 0.0175s/iter; left time: 373.7232s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0780172 Vali Loss: 0.0714483 Test Loss: 0.0738530
Validation loss decreased (0.075190 --> 0.071448).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0694878
	speed: 0.0416s/iter; left time: 882.0605s
	iters: 200, epoch: 6 | loss: 0.0743181
	speed: 0.0201s/iter; left time: 422.7854s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0743077 Vali Loss: 0.0710880 Test Loss: 0.0734069
Validation loss decreased (0.071448 --> 0.071088).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0744916
	speed: 0.0365s/iter; left time: 765.6697s
	iters: 200, epoch: 7 | loss: 0.0658048
	speed: 0.0174s/iter; left time: 363.3347s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0720179 Vali Loss: 0.0662823 Test Loss: 0.0683096
Validation loss decreased (0.071088 --> 0.066282).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0715183
	speed: 0.0368s/iter; left time: 762.7043s
	iters: 200, epoch: 8 | loss: 0.0724966
	speed: 0.0177s/iter; left time: 365.0577s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0697359 Vali Loss: 0.0648159 Test Loss: 0.0669165
Validation loss decreased (0.066282 --> 0.064816).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0668630
	speed: 0.0404s/iter; left time: 829.0244s
	iters: 200, epoch: 9 | loss: 0.0695754
	speed: 0.0205s/iter; left time: 418.1882s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.77s
Steps: 224 | Train Loss: 0.0680483 Vali Loss: 0.0635846 Test Loss: 0.0658263
Validation loss decreased (0.064816 --> 0.063585).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0655731
	speed: 0.0363s/iter; left time: 737.0032s
	iters: 200, epoch: 10 | loss: 0.0673971
	speed: 0.0181s/iter; left time: 365.8813s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0670103 Vali Loss: 0.0635516 Test Loss: 0.0655961
Validation loss decreased (0.063585 --> 0.063552).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0665270
	speed: 0.0368s/iter; left time: 737.6568s
	iters: 200, epoch: 11 | loss: 0.0609907
	speed: 0.0179s/iter; left time: 356.4799s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0659983 Vali Loss: 0.0625107 Test Loss: 0.0645274
Validation loss decreased (0.063552 --> 0.062511).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0692555
	speed: 0.0361s/iter; left time: 716.5178s
	iters: 200, epoch: 12 | loss: 0.0660140
	speed: 0.0174s/iter; left time: 343.4087s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0652268 Vali Loss: 0.0622787 Test Loss: 0.0640785
Validation loss decreased (0.062511 --> 0.062279).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0641926
	speed: 0.0361s/iter; left time: 708.6438s
	iters: 200, epoch: 13 | loss: 0.0653889
	speed: 0.0173s/iter; left time: 337.2091s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0647603 Vali Loss: 0.0619080 Test Loss: 0.0636974
Validation loss decreased (0.062279 --> 0.061908).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0642686
	speed: 0.0377s/iter; left time: 731.4140s
	iters: 200, epoch: 14 | loss: 0.0605915
	speed: 0.0173s/iter; left time: 332.7868s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0643771 Vali Loss: 0.0613482 Test Loss: 0.0635745
Validation loss decreased (0.061908 --> 0.061348).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0620587
	speed: 0.0375s/iter; left time: 718.6670s
	iters: 200, epoch: 15 | loss: 0.0655933
	speed: 0.0175s/iter; left time: 333.3668s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0638910 Vali Loss: 0.0607766 Test Loss: 0.0626828
Validation loss decreased (0.061348 --> 0.060777).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0618527
	speed: 0.0381s/iter; left time: 720.9613s
	iters: 200, epoch: 16 | loss: 0.0637665
	speed: 0.0192s/iter; left time: 361.7772s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0635206 Vali Loss: 0.0609402 Test Loss: 0.0630070
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0652005
	speed: 0.0368s/iter; left time: 688.1737s
	iters: 200, epoch: 17 | loss: 0.0630468
	speed: 0.0173s/iter; left time: 321.3474s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0629550 Vali Loss: 0.0602277 Test Loss: 0.0622284
Validation loss decreased (0.060777 --> 0.060228).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0679912
	speed: 0.0367s/iter; left time: 679.1837s
	iters: 200, epoch: 18 | loss: 0.0651876
	speed: 0.0177s/iter; left time: 326.0893s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0628191 Vali Loss: 0.0599023 Test Loss: 0.0619776
Validation loss decreased (0.060228 --> 0.059902).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0635181
	speed: 0.0361s/iter; left time: 658.7932s
	iters: 200, epoch: 19 | loss: 0.0645638
	speed: 0.0172s/iter; left time: 312.5175s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0626648 Vali Loss: 0.0603637 Test Loss: 0.0622229
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0580611
	speed: 0.0381s/iter; left time: 686.6253s
	iters: 200, epoch: 20 | loss: 0.0628925
	speed: 0.0200s/iter; left time: 359.6547s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0624406 Vali Loss: 0.0599697 Test Loss: 0.0619383
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0711100
	speed: 0.0426s/iter; left time: 759.6886s
	iters: 200, epoch: 21 | loss: 0.0645816
	speed: 0.0222s/iter; left time: 393.8255s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0621689 Vali Loss: 0.0596436 Test Loss: 0.0616355
Validation loss decreased (0.059902 --> 0.059644).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0582503
	speed: 0.0400s/iter; left time: 704.0043s
	iters: 200, epoch: 22 | loss: 0.0627619
	speed: 0.0187s/iter; left time: 326.8185s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0621025 Vali Loss: 0.0594025 Test Loss: 0.0614220
Validation loss decreased (0.059644 --> 0.059403).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0611445
	speed: 0.0418s/iter; left time: 726.9927s
	iters: 200, epoch: 23 | loss: 0.0618353
	speed: 0.0187s/iter; left time: 323.7044s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0618943 Vali Loss: 0.0593977 Test Loss: 0.0614119
Validation loss decreased (0.059403 --> 0.059398).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0679248
	speed: 0.0388s/iter; left time: 665.4331s
	iters: 200, epoch: 24 | loss: 0.0606133
	speed: 0.0191s/iter; left time: 325.5702s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0617276 Vali Loss: 0.0598767 Test Loss: 0.0617889
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0623691
	speed: 0.0383s/iter; left time: 647.9886s
	iters: 200, epoch: 25 | loss: 0.0598570
	speed: 0.0175s/iter; left time: 293.7856s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0617205 Vali Loss: 0.0593523 Test Loss: 0.0613467
Validation loss decreased (0.059398 --> 0.059352).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0600722
	speed: 0.0369s/iter; left time: 615.9920s
	iters: 200, epoch: 26 | loss: 0.0593836
	speed: 0.0200s/iter; left time: 332.7071s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0614930 Vali Loss: 0.0593502 Test Loss: 0.0612584
Validation loss decreased (0.059352 --> 0.059350).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0632631
	speed: 0.0401s/iter; left time: 660.4494s
	iters: 200, epoch: 27 | loss: 0.0630781
	speed: 0.0191s/iter; left time: 312.3329s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0616397 Vali Loss: 0.0592269 Test Loss: 0.0612088
Validation loss decreased (0.059350 --> 0.059227).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0618017
	speed: 0.0413s/iter; left time: 670.4767s
	iters: 200, epoch: 28 | loss: 0.0607987
	speed: 0.0241s/iter; left time: 388.6030s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0613251 Vali Loss: 0.0593490 Test Loss: 0.0612670
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0644551
	speed: 0.0413s/iter; left time: 662.2073s
	iters: 200, epoch: 29 | loss: 0.0655226
	speed: 0.0182s/iter; left time: 289.5898s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0615183 Vali Loss: 0.0591007 Test Loss: 0.0611095
Validation loss decreased (0.059227 --> 0.059101).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0664257
	speed: 0.0381s/iter; left time: 601.9028s
	iters: 200, epoch: 30 | loss: 0.0627920
	speed: 0.0180s/iter; left time: 282.0062s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0612978 Vali Loss: 0.0591229 Test Loss: 0.0610999
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0620899
	speed: 0.0423s/iter; left time: 659.8320s
	iters: 200, epoch: 31 | loss: 0.0607894
	speed: 0.0197s/iter; left time: 304.2079s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.85s
Steps: 224 | Train Loss: 0.0612123 Vali Loss: 0.0591392 Test Loss: 0.0611416
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0620529
	speed: 0.0431s/iter; left time: 661.4097s
	iters: 200, epoch: 32 | loss: 0.0619041
	speed: 0.0230s/iter; left time: 350.3439s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0613713 Vali Loss: 0.0593856 Test Loss: 0.0613479
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0619630
	speed: 0.0427s/iter; left time: 646.0509s
	iters: 200, epoch: 33 | loss: 0.0566477
	speed: 0.0179s/iter; left time: 269.4237s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0611536 Vali Loss: 0.0589994 Test Loss: 0.0610205
Validation loss decreased (0.059101 --> 0.058999).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0623833
	speed: 0.0391s/iter; left time: 582.7121s
	iters: 200, epoch: 34 | loss: 0.0577790
	speed: 0.0190s/iter; left time: 281.0569s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0611065 Vali Loss: 0.0590976 Test Loss: 0.0610434
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0605745
	speed: 0.0366s/iter; left time: 537.4654s
	iters: 200, epoch: 35 | loss: 0.0655310
	speed: 0.0171s/iter; left time: 250.0339s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0610947 Vali Loss: 0.0590545 Test Loss: 0.0609568
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0582355
	speed: 0.0379s/iter; left time: 548.3079s
	iters: 200, epoch: 36 | loss: 0.0577565
	speed: 0.0197s/iter; left time: 282.2497s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0610722 Vali Loss: 0.0593121 Test Loss: 0.0611070
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0573750
	speed: 0.0389s/iter; left time: 554.3860s
	iters: 200, epoch: 37 | loss: 0.0579213
	speed: 0.0196s/iter; left time: 276.5481s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0610631 Vali Loss: 0.0590559 Test Loss: 0.0610414
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0544301
	speed: 0.0387s/iter; left time: 542.6548s
	iters: 200, epoch: 38 | loss: 0.0596081
	speed: 0.0200s/iter; left time: 278.5226s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.70s
Steps: 224 | Train Loss: 0.0608733 Vali Loss: 0.0589671 Test Loss: 0.0609717
Validation loss decreased (0.058999 --> 0.058967).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0568072
	speed: 0.0400s/iter; left time: 551.1060s
	iters: 200, epoch: 39 | loss: 0.0630284
	speed: 0.0197s/iter; left time: 269.7078s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0608011 Vali Loss: 0.0588598 Test Loss: 0.0608266
Validation loss decreased (0.058967 --> 0.058860).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0575882
	speed: 0.0423s/iter; left time: 573.1905s
	iters: 200, epoch: 40 | loss: 0.0650143
	speed: 0.0207s/iter; left time: 278.2470s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0608132 Vali Loss: 0.0588868 Test Loss: 0.0608633
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0590181
	speed: 0.0393s/iter; left time: 524.9369s
	iters: 200, epoch: 41 | loss: 0.0607992
	speed: 0.0177s/iter; left time: 234.7449s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0608190 Vali Loss: 0.0590502 Test Loss: 0.0609728
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0619558
	speed: 0.0364s/iter; left time: 477.3899s
	iters: 200, epoch: 42 | loss: 0.0621211
	speed: 0.0178s/iter; left time: 232.1458s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0609334 Vali Loss: 0.0588145 Test Loss: 0.0608321
Validation loss decreased (0.058860 --> 0.058814).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0615486
	speed: 0.0403s/iter; left time: 519.6059s
	iters: 200, epoch: 43 | loss: 0.0570586
	speed: 0.0243s/iter; left time: 310.5397s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0608828 Vali Loss: 0.0589712 Test Loss: 0.0609513
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0568614
	speed: 0.0402s/iter; left time: 508.7358s
	iters: 200, epoch: 44 | loss: 0.0636867
	speed: 0.0207s/iter; left time: 259.5811s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.69s
Steps: 224 | Train Loss: 0.0609143 Vali Loss: 0.0590896 Test Loss: 0.0609673
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0624496
	speed: 0.0380s/iter; left time: 472.6744s
	iters: 200, epoch: 45 | loss: 0.0557643
	speed: 0.0186s/iter; left time: 229.8456s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0607798 Vali Loss: 0.0588787 Test Loss: 0.0608122
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0582896
	speed: 0.0423s/iter; left time: 517.2451s
	iters: 200, epoch: 46 | loss: 0.0600299
	speed: 0.0214s/iter; left time: 259.6104s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0606731 Vali Loss: 0.0587618 Test Loss: 0.0607486
Validation loss decreased (0.058814 --> 0.058762).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0574329
	speed: 0.0383s/iter; left time: 459.1380s
	iters: 200, epoch: 47 | loss: 0.0574801
	speed: 0.0172s/iter; left time: 204.8640s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0608053 Vali Loss: 0.0589745 Test Loss: 0.0609324
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0612617
	speed: 0.0409s/iter; left time: 481.2634s
	iters: 200, epoch: 48 | loss: 0.0586047
	speed: 0.0180s/iter; left time: 210.6830s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0607525 Vali Loss: 0.0588990 Test Loss: 0.0608540
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0599462
	speed: 0.0435s/iter; left time: 502.7869s
	iters: 200, epoch: 49 | loss: 0.0602446
	speed: 0.0235s/iter; left time: 268.9632s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.50s
Steps: 224 | Train Loss: 0.0606914 Vali Loss: 0.0588749 Test Loss: 0.0607733
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0643789
	speed: 0.0427s/iter; left time: 483.4032s
	iters: 200, epoch: 50 | loss: 0.0623915
	speed: 0.0201s/iter; left time: 225.4204s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0606604 Vali Loss: 0.0589239 Test Loss: 0.0607977
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0569400
	speed: 0.0386s/iter; left time: 428.7284s
	iters: 200, epoch: 51 | loss: 0.0602231
	speed: 0.0206s/iter; left time: 226.7860s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0606344 Vali Loss: 0.0587940 Test Loss: 0.0607396
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0622999
	speed: 0.0410s/iter; left time: 445.6390s
	iters: 200, epoch: 52 | loss: 0.0640980
	speed: 0.0183s/iter; left time: 197.6143s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0606872 Vali Loss: 0.0587773 Test Loss: 0.0607380
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0584325
	speed: 0.0368s/iter; left time: 391.5507s
	iters: 200, epoch: 53 | loss: 0.0610537
	speed: 0.0172s/iter; left time: 181.2162s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0605868 Vali Loss: 0.0588708 Test Loss: 0.0607831
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0620976
	speed: 0.0368s/iter; left time: 383.7663s
	iters: 200, epoch: 54 | loss: 0.0603975
	speed: 0.0174s/iter; left time: 179.7003s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0606225 Vali Loss: 0.0587787 Test Loss: 0.0607135
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0620877
	speed: 0.0369s/iter; left time: 376.9220s
	iters: 200, epoch: 55 | loss: 0.0590931
	speed: 0.0171s/iter; left time: 173.0039s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0606608 Vali Loss: 0.0588166 Test Loss: 0.0607272
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0580562
	speed: 0.0364s/iter; left time: 362.9874s
	iters: 200, epoch: 56 | loss: 0.0539987
	speed: 0.0195s/iter; left time: 192.8356s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0605068 Vali Loss: 0.0587827 Test Loss: 0.0607081
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010598608292639256, rmse:0.10294954478740692, mae:0.0607486292719841, rse:0.3889956474304199
Intermediate time for IT and pred_len 24: 00h:10m:58.33s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2604629
	speed: 0.0422s/iter; left time: 940.2215s
	iters: 200, epoch: 1 | loss: 0.2423152
	speed: 0.0175s/iter; left time: 389.2494s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.2648623 Vali Loss: 0.1834424 Test Loss: 0.1930739
Validation loss decreased (inf --> 0.183442).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1424379
	speed: 0.0377s/iter; left time: 832.0443s
	iters: 200, epoch: 2 | loss: 0.1129646
	speed: 0.0175s/iter; left time: 384.7421s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.1525857 Vali Loss: 0.1033205 Test Loss: 0.1089858
Validation loss decreased (0.183442 --> 0.103320).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1093492
	speed: 0.0408s/iter; left time: 890.7279s
	iters: 200, epoch: 3 | loss: 0.1031741
	speed: 0.0193s/iter; left time: 419.1132s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.1081475 Vali Loss: 0.0955844 Test Loss: 0.1005626
Validation loss decreased (0.103320 --> 0.095584).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0958332
	speed: 0.0398s/iter; left time: 861.1281s
	iters: 200, epoch: 4 | loss: 0.0928613
	speed: 0.0176s/iter; left time: 379.8645s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0971412 Vali Loss: 0.0887435 Test Loss: 0.0933526
Validation loss decreased (0.095584 --> 0.088743).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0926998
	speed: 0.0376s/iter; left time: 805.6997s
	iters: 200, epoch: 5 | loss: 0.0891793
	speed: 0.0177s/iter; left time: 376.8354s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0914521 Vali Loss: 0.0856440 Test Loss: 0.0892723
Validation loss decreased (0.088743 --> 0.085644).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0913657
	speed: 0.0380s/iter; left time: 805.5923s
	iters: 200, epoch: 6 | loss: 0.0861900
	speed: 0.0179s/iter; left time: 376.4628s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0882072 Vali Loss: 0.0826065 Test Loss: 0.0869915
Validation loss decreased (0.085644 --> 0.082606).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0878516
	speed: 0.0396s/iter; left time: 829.0945s
	iters: 200, epoch: 7 | loss: 0.0830736
	speed: 0.0201s/iter; left time: 418.9856s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0863684 Vali Loss: 0.0824323 Test Loss: 0.0853957
Validation loss decreased (0.082606 --> 0.082432).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0853143
	speed: 0.0396s/iter; left time: 821.8514s
	iters: 200, epoch: 8 | loss: 0.0793520
	speed: 0.0196s/iter; left time: 404.3501s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0849917 Vali Loss: 0.0812135 Test Loss: 0.0853825
Validation loss decreased (0.082432 --> 0.081214).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0831149
	speed: 0.0377s/iter; left time: 772.7803s
	iters: 200, epoch: 9 | loss: 0.0795631
	speed: 0.0176s/iter; left time: 360.0931s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0847246 Vali Loss: 0.0808714 Test Loss: 0.0850799
Validation loss decreased (0.081214 --> 0.080871).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0807580
	speed: 0.0385s/iter; left time: 781.6510s
	iters: 200, epoch: 10 | loss: 0.0867554
	speed: 0.0177s/iter; left time: 356.6888s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0833497 Vali Loss: 0.0810849 Test Loss: 0.0853150
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0853099
	speed: 0.0401s/iter; left time: 804.0430s
	iters: 200, epoch: 11 | loss: 0.0809132
	speed: 0.0214s/iter; left time: 427.2596s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.89s
Steps: 224 | Train Loss: 0.0829447 Vali Loss: 0.0799023 Test Loss: 0.0841955
Validation loss decreased (0.080871 --> 0.079902).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0814938
	speed: 0.0392s/iter; left time: 777.1048s
	iters: 200, epoch: 12 | loss: 0.0847448
	speed: 0.0182s/iter; left time: 358.5585s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0822131 Vali Loss: 0.0804344 Test Loss: 0.0841287
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0809954
	speed: 0.0373s/iter; left time: 731.8970s
	iters: 200, epoch: 13 | loss: 0.0858219
	speed: 0.0186s/iter; left time: 362.9457s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0820751 Vali Loss: 0.0805065 Test Loss: 0.0840351
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0806159
	speed: 0.0364s/iter; left time: 706.4534s
	iters: 200, epoch: 14 | loss: 0.0795833
	speed: 0.0175s/iter; left time: 337.4606s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0816624 Vali Loss: 0.0804602 Test Loss: 0.0844575
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0779172
	speed: 0.0378s/iter; left time: 725.1374s
	iters: 200, epoch: 15 | loss: 0.0824445
	speed: 0.0181s/iter; left time: 345.2149s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0812928 Vali Loss: 0.0793254 Test Loss: 0.0834020
Validation loss decreased (0.079902 --> 0.079325).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0927447
	speed: 0.0375s/iter; left time: 709.8501s
	iters: 200, epoch: 16 | loss: 0.0828852
	speed: 0.0175s/iter; left time: 330.2680s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0811191 Vali Loss: 0.0797241 Test Loss: 0.0843871
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0811357
	speed: 0.0372s/iter; left time: 696.5983s
	iters: 200, epoch: 17 | loss: 0.0798844
	speed: 0.0175s/iter; left time: 324.9076s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0809317 Vali Loss: 0.0797516 Test Loss: 0.0837846
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0797971
	speed: 0.0382s/iter; left time: 707.2021s
	iters: 200, epoch: 18 | loss: 0.0834154
	speed: 0.0180s/iter; left time: 330.6393s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0805756 Vali Loss: 0.0792588 Test Loss: 0.0833703
Validation loss decreased (0.079325 --> 0.079259).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0777356
	speed: 0.0405s/iter; left time: 740.5875s
	iters: 200, epoch: 19 | loss: 0.0803758
	speed: 0.0182s/iter; left time: 329.7680s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0807877 Vali Loss: 0.0796320 Test Loss: 0.0839161
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0809253
	speed: 0.0384s/iter; left time: 692.1384s
	iters: 200, epoch: 20 | loss: 0.0807327
	speed: 0.0199s/iter; left time: 356.7581s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0803043 Vali Loss: 0.0803296 Test Loss: 0.0847105
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814064
	speed: 0.0368s/iter; left time: 656.5285s
	iters: 200, epoch: 21 | loss: 0.0740589
	speed: 0.0190s/iter; left time: 336.3338s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0803020 Vali Loss: 0.0793213 Test Loss: 0.0837104
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0788433
	speed: 0.0380s/iter; left time: 669.0341s
	iters: 200, epoch: 22 | loss: 0.0801094
	speed: 0.0179s/iter; left time: 313.8118s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0799116 Vali Loss: 0.0794162 Test Loss: 0.0836434
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0780965
	speed: 0.0385s/iter; left time: 669.4752s
	iters: 200, epoch: 23 | loss: 0.0793583
	speed: 0.0182s/iter; left time: 313.7329s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0797848 Vali Loss: 0.0791958 Test Loss: 0.0836920
Validation loss decreased (0.079259 --> 0.079196).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0816518
	speed: 0.0412s/iter; left time: 706.5450s
	iters: 200, epoch: 24 | loss: 0.0771318
	speed: 0.0197s/iter; left time: 336.4145s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.79s
Steps: 224 | Train Loss: 0.0798217 Vali Loss: 0.0807391 Test Loss: 0.0849686
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0804060
	speed: 0.0379s/iter; left time: 642.0584s
	iters: 200, epoch: 25 | loss: 0.0775783
	speed: 0.0196s/iter; left time: 329.2558s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0797370 Vali Loss: 0.0794826 Test Loss: 0.0838034
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0790573
	speed: 0.0396s/iter; left time: 661.3285s
	iters: 200, epoch: 26 | loss: 0.0821203
	speed: 0.0216s/iter; left time: 358.4795s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0795945 Vali Loss: 0.0791850 Test Loss: 0.0836309
Validation loss decreased (0.079196 --> 0.079185).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0807247
	speed: 0.0399s/iter; left time: 657.2338s
	iters: 200, epoch: 27 | loss: 0.0761688
	speed: 0.0189s/iter; left time: 310.2597s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0795645 Vali Loss: 0.0788539 Test Loss: 0.0835670
Validation loss decreased (0.079185 --> 0.078854).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0810647
	speed: 0.0382s/iter; left time: 621.0593s
	iters: 200, epoch: 28 | loss: 0.0775783
	speed: 0.0175s/iter; left time: 281.9439s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0794294 Vali Loss: 0.0790341 Test Loss: 0.0836024
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0791476
	speed: 0.0372s/iter; left time: 596.9193s
	iters: 200, epoch: 29 | loss: 0.0792168
	speed: 0.0176s/iter; left time: 280.0199s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0793715 Vali Loss: 0.0791466 Test Loss: 0.0836969
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0792660
	speed: 0.0375s/iter; left time: 592.9876s
	iters: 200, epoch: 30 | loss: 0.0794438
	speed: 0.0186s/iter; left time: 292.1582s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0793188 Vali Loss: 0.0790983 Test Loss: 0.0838351
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0807952
	speed: 0.0370s/iter; left time: 576.2128s
	iters: 200, epoch: 31 | loss: 0.0756893
	speed: 0.0177s/iter; left time: 273.4235s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0792780 Vali Loss: 0.0789480 Test Loss: 0.0837407
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0803414
	speed: 0.0374s/iter; left time: 575.0831s
	iters: 200, epoch: 32 | loss: 0.0832933
	speed: 0.0214s/iter; left time: 326.6123s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.67s
Steps: 224 | Train Loss: 0.0791073 Vali Loss: 0.0790042 Test Loss: 0.0836918
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0774591
	speed: 0.0389s/iter; left time: 587.9616s
	iters: 200, epoch: 33 | loss: 0.0834226
	speed: 0.0176s/iter; left time: 265.1648s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0791703 Vali Loss: 0.0786317 Test Loss: 0.0832839
Validation loss decreased (0.078854 --> 0.078632).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0779626
	speed: 0.0373s/iter; left time: 555.4768s
	iters: 200, epoch: 34 | loss: 0.0791747
	speed: 0.0176s/iter; left time: 260.9697s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0791629 Vali Loss: 0.0787512 Test Loss: 0.0835474
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0755134
	speed: 0.0414s/iter; left time: 608.0829s
	iters: 200, epoch: 35 | loss: 0.0837611
	speed: 0.0187s/iter; left time: 273.0211s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.70s
Steps: 224 | Train Loss: 0.0792482 Vali Loss: 0.0783733 Test Loss: 0.0830684
Validation loss decreased (0.078632 --> 0.078373).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0782254
	speed: 0.0379s/iter; left time: 548.5207s
	iters: 200, epoch: 36 | loss: 0.0776678
	speed: 0.0181s/iter; left time: 260.3977s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0794613 Vali Loss: 0.0785407 Test Loss: 0.0834308
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0818818
	speed: 0.0391s/iter; left time: 556.0398s
	iters: 200, epoch: 37 | loss: 0.0786573
	speed: 0.0179s/iter; left time: 252.4836s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0791341 Vali Loss: 0.0786149 Test Loss: 0.0834020
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0758005
	speed: 0.0379s/iter; left time: 530.6879s
	iters: 200, epoch: 38 | loss: 0.0819356
	speed: 0.0192s/iter; left time: 267.3365s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0790339 Vali Loss: 0.0784416 Test Loss: 0.0832714
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0806531
	speed: 0.0394s/iter; left time: 543.5236s
	iters: 200, epoch: 39 | loss: 0.0777452
	speed: 0.0188s/iter; left time: 257.5661s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0790220 Vali Loss: 0.0785469 Test Loss: 0.0835634
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0808816
	speed: 0.0411s/iter; left time: 557.1258s
	iters: 200, epoch: 40 | loss: 0.0779331
	speed: 0.0184s/iter; left time: 248.3672s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0790106 Vali Loss: 0.0784936 Test Loss: 0.0833236
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0770621
	speed: 0.0396s/iter; left time: 528.8388s
	iters: 200, epoch: 41 | loss: 0.0769058
	speed: 0.0177s/iter; left time: 234.2338s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0790752 Vali Loss: 0.0785050 Test Loss: 0.0834829
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0816045
	speed: 0.0395s/iter; left time: 517.5127s
	iters: 200, epoch: 42 | loss: 0.0768652
	speed: 0.0184s/iter; left time: 239.7384s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0789593 Vali Loss: 0.0786374 Test Loss: 0.0834311
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0823383
	speed: 0.0389s/iter; left time: 501.2683s
	iters: 200, epoch: 43 | loss: 0.0827467
	speed: 0.0182s/iter; left time: 232.4001s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0789068 Vali Loss: 0.0785045 Test Loss: 0.0833443
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0810998
	speed: 0.0374s/iter; left time: 474.2018s
	iters: 200, epoch: 44 | loss: 0.0810645
	speed: 0.0177s/iter; left time: 222.3618s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0789337 Vali Loss: 0.0786096 Test Loss: 0.0833639
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0796581
	speed: 0.0383s/iter; left time: 476.1345s
	iters: 200, epoch: 45 | loss: 0.0772102
	speed: 0.0188s/iter; left time: 232.6732s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0789322 Vali Loss: 0.0784388 Test Loss: 0.0832606
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018459854647517204, rmse:0.13586704432964325, mae:0.0830683708190918, rse:0.5137279629707336
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2633902
	speed: 0.0199s/iter; left time: 444.8449s
	iters: 200, epoch: 1 | loss: 0.2498939
	speed: 0.0174s/iter; left time: 387.3025s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.2701202 Vali Loss: 0.1831898 Test Loss: 0.1920654
Validation loss decreased (inf --> 0.183190).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1412768
	speed: 0.0411s/iter; left time: 906.2863s
	iters: 200, epoch: 2 | loss: 0.1198113
	speed: 0.0201s/iter; left time: 442.6369s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.1530998 Vali Loss: 0.1046383 Test Loss: 0.1103508
Validation loss decreased (0.183190 --> 0.104638).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1075058
	speed: 0.0381s/iter; left time: 832.6648s
	iters: 200, epoch: 3 | loss: 0.1024728
	speed: 0.0175s/iter; left time: 381.4894s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.1081631 Vali Loss: 0.0960207 Test Loss: 0.1003207
Validation loss decreased (0.104638 --> 0.096021).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0989143
	speed: 0.0377s/iter; left time: 815.7902s
	iters: 200, epoch: 4 | loss: 0.0959302
	speed: 0.0177s/iter; left time: 380.3129s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0969617 Vali Loss: 0.0876513 Test Loss: 0.0912269
Validation loss decreased (0.096021 --> 0.087651).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0922850
	speed: 0.0392s/iter; left time: 839.2089s
	iters: 200, epoch: 5 | loss: 0.0925212
	speed: 0.0182s/iter; left time: 387.6014s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0911765 Vali Loss: 0.0846339 Test Loss: 0.0885949
Validation loss decreased (0.087651 --> 0.084634).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0807054
	speed: 0.0380s/iter; left time: 804.4260s
	iters: 200, epoch: 6 | loss: 0.0900945
	speed: 0.0210s/iter; left time: 443.5663s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0888132 Vali Loss: 0.0833841 Test Loss: 0.0867837
Validation loss decreased (0.084634 --> 0.083384).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0852673
	speed: 0.0394s/iter; left time: 825.1896s
	iters: 200, epoch: 7 | loss: 0.0861322
	speed: 0.0177s/iter; left time: 368.4266s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0865695 Vali Loss: 0.0825928 Test Loss: 0.0858456
Validation loss decreased (0.083384 --> 0.082593).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0809142
	speed: 0.0395s/iter; left time: 819.5413s
	iters: 200, epoch: 8 | loss: 0.0852987
	speed: 0.0175s/iter; left time: 360.9607s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0856313 Vali Loss: 0.0831936 Test Loss: 0.0871715
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0835497
	speed: 0.0390s/iter; left time: 800.5870s
	iters: 200, epoch: 9 | loss: 0.0909500
	speed: 0.0177s/iter; left time: 360.4279s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0848892 Vali Loss: 0.0809508 Test Loss: 0.0849843
Validation loss decreased (0.082593 --> 0.080951).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0832622
	speed: 0.0386s/iter; left time: 782.9861s
	iters: 200, epoch: 10 | loss: 0.0816330
	speed: 0.0181s/iter; left time: 364.5804s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0838950 Vali Loss: 0.0810119 Test Loss: 0.0843500
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0823479
	speed: 0.0369s/iter; left time: 741.0397s
	iters: 200, epoch: 11 | loss: 0.0797392
	speed: 0.0205s/iter; left time: 409.7724s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0834092 Vali Loss: 0.0804584 Test Loss: 0.0841500
Validation loss decreased (0.080951 --> 0.080458).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0788790
	speed: 0.0395s/iter; left time: 783.1219s
	iters: 200, epoch: 12 | loss: 0.0763031
	speed: 0.0178s/iter; left time: 351.8266s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0825815 Vali Loss: 0.0798619 Test Loss: 0.0837918
Validation loss decreased (0.080458 --> 0.079862).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0810508
	speed: 0.0385s/iter; left time: 755.5665s
	iters: 200, epoch: 13 | loss: 0.0791811
	speed: 0.0176s/iter; left time: 344.2559s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0822505 Vali Loss: 0.0801797 Test Loss: 0.0839376
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0800357
	speed: 0.0377s/iter; left time: 730.6998s
	iters: 200, epoch: 14 | loss: 0.0825908
	speed: 0.0179s/iter; left time: 345.9528s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0821585 Vali Loss: 0.0798246 Test Loss: 0.0841053
Validation loss decreased (0.079862 --> 0.079825).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0803743
	speed: 0.0379s/iter; left time: 726.9469s
	iters: 200, epoch: 15 | loss: 0.0822192
	speed: 0.0178s/iter; left time: 339.1870s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0819028 Vali Loss: 0.0798835 Test Loss: 0.0839211
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0815150
	speed: 0.0371s/iter; left time: 702.3098s
	iters: 200, epoch: 16 | loss: 0.0846371
	speed: 0.0176s/iter; left time: 331.1991s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0812258 Vali Loss: 0.0792488 Test Loss: 0.0837073
Validation loss decreased (0.079825 --> 0.079249).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0787798
	speed: 0.0383s/iter; left time: 716.0123s
	iters: 200, epoch: 17 | loss: 0.0758536
	speed: 0.0176s/iter; left time: 328.1706s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0809318 Vali Loss: 0.0792728 Test Loss: 0.0835242
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0856505
	speed: 0.0375s/iter; left time: 693.5057s
	iters: 200, epoch: 18 | loss: 0.0821285
	speed: 0.0177s/iter; left time: 325.2321s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0807226 Vali Loss: 0.0791358 Test Loss: 0.0838297
Validation loss decreased (0.079249 --> 0.079136).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0854405
	speed: 0.0382s/iter; left time: 698.2759s
	iters: 200, epoch: 19 | loss: 0.0808203
	speed: 0.0177s/iter; left time: 322.2733s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0805419 Vali Loss: 0.0786519 Test Loss: 0.0832431
Validation loss decreased (0.079136 --> 0.078652).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0768757
	speed: 0.0384s/iter; left time: 692.5387s
	iters: 200, epoch: 20 | loss: 0.0836926
	speed: 0.0177s/iter; left time: 316.9618s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0808815 Vali Loss: 0.0788314 Test Loss: 0.0833596
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0788373
	speed: 0.0376s/iter; left time: 669.9588s
	iters: 200, epoch: 21 | loss: 0.0830935
	speed: 0.0177s/iter; left time: 313.8214s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0802833 Vali Loss: 0.0785787 Test Loss: 0.0832150
Validation loss decreased (0.078652 --> 0.078579).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0764465
	speed: 0.0406s/iter; left time: 713.6416s
	iters: 200, epoch: 22 | loss: 0.0798683
	speed: 0.0208s/iter; left time: 363.8867s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0804388 Vali Loss: 0.0785920 Test Loss: 0.0833893
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0800391
	speed: 0.0376s/iter; left time: 652.8931s
	iters: 200, epoch: 23 | loss: 0.0768104
	speed: 0.0177s/iter; left time: 305.4515s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0799818 Vali Loss: 0.0783198 Test Loss: 0.0832006
Validation loss decreased (0.078579 --> 0.078320).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0780598
	speed: 0.0396s/iter; left time: 679.6285s
	iters: 200, epoch: 24 | loss: 0.0812857
	speed: 0.0181s/iter; left time: 308.0206s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0798504 Vali Loss: 0.0789208 Test Loss: 0.0834581
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0797256
	speed: 0.0375s/iter; left time: 635.3555s
	iters: 200, epoch: 25 | loss: 0.0803634
	speed: 0.0175s/iter; left time: 293.6357s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0799274 Vali Loss: 0.0784315 Test Loss: 0.0832071
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0801724
	speed: 0.0407s/iter; left time: 678.9461s
	iters: 200, epoch: 26 | loss: 0.0792413
	speed: 0.0189s/iter; left time: 313.6101s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0797059 Vali Loss: 0.0782750 Test Loss: 0.0831834
Validation loss decreased (0.078320 --> 0.078275).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0806413
	speed: 0.0427s/iter; left time: 703.6826s
	iters: 200, epoch: 27 | loss: 0.0788254
	speed: 0.0175s/iter; left time: 286.6471s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0795695 Vali Loss: 0.0782672 Test Loss: 0.0829756
Validation loss decreased (0.078275 --> 0.078267).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0762409
	speed: 0.0420s/iter; left time: 683.3500s
	iters: 200, epoch: 28 | loss: 0.0832204
	speed: 0.0179s/iter; left time: 288.5273s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0795220 Vali Loss: 0.0783756 Test Loss: 0.0831942
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0755171
	speed: 0.0391s/iter; left time: 627.4245s
	iters: 200, epoch: 29 | loss: 0.0799543
	speed: 0.0179s/iter; left time: 285.0723s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0795414 Vali Loss: 0.0783198 Test Loss: 0.0832834
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0809168
	speed: 0.0392s/iter; left time: 618.9313s
	iters: 200, epoch: 30 | loss: 0.0776021
	speed: 0.0174s/iter; left time: 272.9005s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0793517 Vali Loss: 0.0782524 Test Loss: 0.0834267
Validation loss decreased (0.078267 --> 0.078252).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0798810
	speed: 0.0393s/iter; left time: 611.5846s
	iters: 200, epoch: 31 | loss: 0.0847576
	speed: 0.0197s/iter; left time: 305.1765s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0793432 Vali Loss: 0.0785735 Test Loss: 0.0833395
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0820202
	speed: 0.0386s/iter; left time: 592.8653s
	iters: 200, epoch: 32 | loss: 0.0780760
	speed: 0.0175s/iter; left time: 266.3611s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0793279 Vali Loss: 0.0781227 Test Loss: 0.0831220
Validation loss decreased (0.078252 --> 0.078123).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0784964
	speed: 0.0399s/iter; left time: 603.2432s
	iters: 200, epoch: 33 | loss: 0.0800942
	speed: 0.0181s/iter; left time: 271.4749s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0792461 Vali Loss: 0.0781400 Test Loss: 0.0830985
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0783564
	speed: 0.0450s/iter; left time: 670.6480s
	iters: 200, epoch: 34 | loss: 0.0756153
	speed: 0.0240s/iter; left time: 355.1404s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.64s
Steps: 224 | Train Loss: 0.0793294 Vali Loss: 0.0780001 Test Loss: 0.0831595
Validation loss decreased (0.078123 --> 0.078000).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0827296
	speed: 0.0426s/iter; left time: 625.7874s
	iters: 200, epoch: 35 | loss: 0.0781024
	speed: 0.0211s/iter; left time: 307.8270s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.89s
Steps: 224 | Train Loss: 0.0793010 Vali Loss: 0.0781735 Test Loss: 0.0831860
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0829730
	speed: 0.0399s/iter; left time: 577.7028s
	iters: 200, epoch: 36 | loss: 0.0764428
	speed: 0.0175s/iter; left time: 251.5983s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0791474 Vali Loss: 0.0781738 Test Loss: 0.0831930
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0818572
	speed: 0.0374s/iter; left time: 531.7544s
	iters: 200, epoch: 37 | loss: 0.0786788
	speed: 0.0177s/iter; left time: 249.5984s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0791359 Vali Loss: 0.0780627 Test Loss: 0.0831984
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0735988
	speed: 0.0371s/iter; left time: 520.1814s
	iters: 200, epoch: 38 | loss: 0.0772743
	speed: 0.0175s/iter; left time: 243.4005s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0790314 Vali Loss: 0.0782232 Test Loss: 0.0831310
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0803424
	speed: 0.0385s/iter; left time: 531.3018s
	iters: 200, epoch: 39 | loss: 0.0774279
	speed: 0.0173s/iter; left time: 237.2389s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0794683 Vali Loss: 0.0782137 Test Loss: 0.0831036
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0824025
	speed: 0.0385s/iter; left time: 522.3132s
	iters: 200, epoch: 40 | loss: 0.0808806
	speed: 0.0188s/iter; left time: 252.6167s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0789695 Vali Loss: 0.0782394 Test Loss: 0.0832140
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0765408
	speed: 0.0388s/iter; left time: 517.0474s
	iters: 200, epoch: 41 | loss: 0.0806076
	speed: 0.0183s/iter; left time: 242.2816s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0791506 Vali Loss: 0.0783099 Test Loss: 0.0832641
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0782502
	speed: 0.0374s/iter; left time: 490.2872s
	iters: 200, epoch: 42 | loss: 0.0761774
	speed: 0.0180s/iter; left time: 234.8814s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0790142 Vali Loss: 0.0779812 Test Loss: 0.0830856
Validation loss decreased (0.078000 --> 0.077981).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0794970
	speed: 0.0393s/iter; left time: 507.3315s
	iters: 200, epoch: 43 | loss: 0.0779923
	speed: 0.0175s/iter; left time: 223.8657s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0794099 Vali Loss: 0.0781618 Test Loss: 0.0831427
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0826394
	speed: 0.0369s/iter; left time: 468.0010s
	iters: 200, epoch: 44 | loss: 0.0761337
	speed: 0.0176s/iter; left time: 221.6712s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0789953 Vali Loss: 0.0781651 Test Loss: 0.0831567
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0786274
	speed: 0.0394s/iter; left time: 490.3835s
	iters: 200, epoch: 45 | loss: 0.0807655
	speed: 0.0184s/iter; left time: 227.5804s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0789668 Vali Loss: 0.0780502 Test Loss: 0.0831159
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0769732
	speed: 0.0408s/iter; left time: 498.4777s
	iters: 200, epoch: 46 | loss: 0.0772156
	speed: 0.0182s/iter; left time: 220.9963s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0789443 Vali Loss: 0.0779427 Test Loss: 0.0830539
Validation loss decreased (0.077981 --> 0.077943).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0804595
	speed: 0.0395s/iter; left time: 473.5711s
	iters: 200, epoch: 47 | loss: 0.0782881
	speed: 0.0179s/iter; left time: 212.9434s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0789955 Vali Loss: 0.0780217 Test Loss: 0.0830913
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0784007
	speed: 0.0382s/iter; left time: 449.3469s
	iters: 200, epoch: 48 | loss: 0.0771884
	speed: 0.0204s/iter; left time: 238.5987s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0790766 Vali Loss: 0.0781744 Test Loss: 0.0831143
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0783620
	speed: 0.0393s/iter; left time: 453.3140s
	iters: 200, epoch: 49 | loss: 0.0763013
	speed: 0.0177s/iter; left time: 202.6763s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0788638 Vali Loss: 0.0781407 Test Loss: 0.0832584
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0797226
	speed: 0.0411s/iter; left time: 465.5889s
	iters: 200, epoch: 50 | loss: 0.0782608
	speed: 0.0190s/iter; left time: 213.4033s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0789711 Vali Loss: 0.0780533 Test Loss: 0.0831397
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0804075
	speed: 0.0388s/iter; left time: 430.4697s
	iters: 200, epoch: 51 | loss: 0.0838626
	speed: 0.0177s/iter; left time: 194.3465s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0789737 Vali Loss: 0.0783615 Test Loss: 0.0833214
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0822536
	speed: 0.0375s/iter; left time: 408.3638s
	iters: 200, epoch: 52 | loss: 0.0792260
	speed: 0.0175s/iter; left time: 189.0503s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0789445 Vali Loss: 0.0779912 Test Loss: 0.0830515
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0799038
	speed: 0.0383s/iter; left time: 408.0374s
	iters: 200, epoch: 53 | loss: 0.0754777
	speed: 0.0180s/iter; left time: 189.7857s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0789257 Vali Loss: 0.0780353 Test Loss: 0.0831481
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0802066
	speed: 0.0381s/iter; left time: 396.8304s
	iters: 200, epoch: 54 | loss: 0.0771957
	speed: 0.0175s/iter; left time: 180.9735s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0792655 Vali Loss: 0.0781010 Test Loss: 0.0831064
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0827046
	speed: 0.0387s/iter; left time: 394.9468s
	iters: 200, epoch: 55 | loss: 0.0743920
	speed: 0.0178s/iter; left time: 179.5708s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0790204 Vali Loss: 0.0782403 Test Loss: 0.0831909
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0775810
	speed: 0.0381s/iter; left time: 379.9134s
	iters: 200, epoch: 56 | loss: 0.0783878
	speed: 0.0176s/iter; left time: 173.6579s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0792037 Vali Loss: 0.0780373 Test Loss: 0.0830897
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01852767914533615, rmse:0.1361164152622223, mae:0.08305386453866959, rse:0.5146708488464355
Intermediate time for IT and pred_len 96: 00h:09m:49.18s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2618526
	speed: 0.0305s/iter; left time: 677.9446s
	iters: 200, epoch: 1 | loss: 0.2437329
	speed: 0.0178s/iter; left time: 393.0227s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.46s
Steps: 223 | Train Loss: 0.2659036 Vali Loss: 0.1835878 Test Loss: 0.1923225
Validation loss decreased (inf --> 0.183588).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1408188
	speed: 0.0404s/iter; left time: 888.4358s
	iters: 200, epoch: 2 | loss: 0.1191315
	speed: 0.0200s/iter; left time: 437.6589s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.67s
Steps: 223 | Train Loss: 0.1517580 Vali Loss: 0.1063494 Test Loss: 0.1110453
Validation loss decreased (0.183588 --> 0.106349).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1138826
	speed: 0.0400s/iter; left time: 869.9507s
	iters: 200, epoch: 3 | loss: 0.1030243
	speed: 0.0179s/iter; left time: 386.8005s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.1102856 Vali Loss: 0.1004769 Test Loss: 0.1051075
Validation loss decreased (0.106349 --> 0.100477).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1014542
	speed: 0.0386s/iter; left time: 831.5773s
	iters: 200, epoch: 4 | loss: 0.1005135
	speed: 0.0187s/iter; left time: 401.6495s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0996700 Vali Loss: 0.0918122 Test Loss: 0.0940000
Validation loss decreased (0.100477 --> 0.091812).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0907509
	speed: 0.0436s/iter; left time: 929.4594s
	iters: 200, epoch: 5 | loss: 0.0912171
	speed: 0.0185s/iter; left time: 391.6411s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.63s
Steps: 223 | Train Loss: 0.0947535 Vali Loss: 0.0885435 Test Loss: 0.0914100
Validation loss decreased (0.091812 --> 0.088544).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0906665
	speed: 0.0388s/iter; left time: 818.5845s
	iters: 200, epoch: 6 | loss: 0.0929077
	speed: 0.0176s/iter; left time: 369.1588s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0915389 Vali Loss: 0.0868798 Test Loss: 0.0899508
Validation loss decreased (0.088544 --> 0.086880).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0905956
	speed: 0.0416s/iter; left time: 867.3586s
	iters: 200, epoch: 7 | loss: 0.0907880
	speed: 0.0175s/iter; left time: 363.7980s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0898464 Vali Loss: 0.0865407 Test Loss: 0.0891372
Validation loss decreased (0.086880 --> 0.086541).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0865913
	speed: 0.0406s/iter; left time: 837.8577s
	iters: 200, epoch: 8 | loss: 0.0852502
	speed: 0.0196s/iter; left time: 402.2505s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0885017 Vali Loss: 0.0852268 Test Loss: 0.0887005
Validation loss decreased (0.086541 --> 0.085227).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0862438
	speed: 0.0411s/iter; left time: 838.7830s
	iters: 200, epoch: 9 | loss: 0.0848469
	speed: 0.0177s/iter; left time: 359.8800s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.40s
Steps: 223 | Train Loss: 0.0876411 Vali Loss: 0.0876688 Test Loss: 0.0913752
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0852093
	speed: 0.0399s/iter; left time: 805.2072s
	iters: 200, epoch: 10 | loss: 0.0877460
	speed: 0.0244s/iter; left time: 489.4556s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0870991 Vali Loss: 0.0846349 Test Loss: 0.0878684
Validation loss decreased (0.085227 --> 0.084635).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1038115
	speed: 0.0420s/iter; left time: 838.0884s
	iters: 200, epoch: 11 | loss: 0.0825079
	speed: 0.0187s/iter; left time: 370.9480s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.46s
Steps: 223 | Train Loss: 0.0866282 Vali Loss: 0.0844627 Test Loss: 0.0876917
Validation loss decreased (0.084635 --> 0.084463).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0848862
	speed: 0.0413s/iter; left time: 815.2028s
	iters: 200, epoch: 12 | loss: 0.0860416
	speed: 0.0198s/iter; left time: 388.8303s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.67s
Steps: 223 | Train Loss: 0.0861590 Vali Loss: 0.0843448 Test Loss: 0.0876028
Validation loss decreased (0.084463 --> 0.084345).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0836668
	speed: 0.0402s/iter; left time: 785.2082s
	iters: 200, epoch: 13 | loss: 0.0862086
	speed: 0.0191s/iter; left time: 371.2688s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0857145 Vali Loss: 0.0839328 Test Loss: 0.0872818
Validation loss decreased (0.084345 --> 0.083933).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0848311
	speed: 0.0417s/iter; left time: 804.7374s
	iters: 200, epoch: 14 | loss: 0.0857376
	speed: 0.0194s/iter; left time: 371.6960s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.68s
Steps: 223 | Train Loss: 0.0852117 Vali Loss: 0.0847552 Test Loss: 0.0878138
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0834751
	speed: 0.0404s/iter; left time: 770.2587s
	iters: 200, epoch: 15 | loss: 0.0915823
	speed: 0.0190s/iter; left time: 361.2826s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.52s
Steps: 223 | Train Loss: 0.0849433 Vali Loss: 0.0841904 Test Loss: 0.0875766
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0860700
	speed: 0.0438s/iter; left time: 826.7907s
	iters: 200, epoch: 16 | loss: 0.0841868
	speed: 0.0197s/iter; left time: 368.9963s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.95s
Steps: 223 | Train Loss: 0.0848660 Vali Loss: 0.0835877 Test Loss: 0.0872214
Validation loss decreased (0.083933 --> 0.083588).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0860361
	speed: 0.0414s/iter; left time: 771.7841s
	iters: 200, epoch: 17 | loss: 0.0865286
	speed: 0.0178s/iter; left time: 329.9787s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0849234 Vali Loss: 0.0841695 Test Loss: 0.0881402
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0808376
	speed: 0.0386s/iter; left time: 710.9850s
	iters: 200, epoch: 18 | loss: 0.0866519
	speed: 0.0177s/iter; left time: 323.2019s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0844290 Vali Loss: 0.0839188 Test Loss: 0.0877824
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0827186
	speed: 0.0381s/iter; left time: 693.2600s
	iters: 200, epoch: 19 | loss: 0.0852388
	speed: 0.0184s/iter; left time: 333.6682s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0842245 Vali Loss: 0.0831437 Test Loss: 0.0875251
Validation loss decreased (0.083588 --> 0.083144).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0842740
	speed: 0.0412s/iter; left time: 740.3701s
	iters: 200, epoch: 20 | loss: 0.0798561
	speed: 0.0185s/iter; left time: 329.7748s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.43s
Steps: 223 | Train Loss: 0.0839738 Vali Loss: 0.0835456 Test Loss: 0.0876565
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0844715
	speed: 0.0403s/iter; left time: 714.3296s
	iters: 200, epoch: 21 | loss: 0.0844097
	speed: 0.0192s/iter; left time: 339.1569s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.59s
Steps: 223 | Train Loss: 0.0839412 Vali Loss: 0.0833058 Test Loss: 0.0873658
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0835519
	speed: 0.0408s/iter; left time: 715.4605s
	iters: 200, epoch: 22 | loss: 0.0868410
	speed: 0.0177s/iter; left time: 307.6031s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0836301 Vali Loss: 0.0827821 Test Loss: 0.0871706
Validation loss decreased (0.083144 --> 0.082782).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0787933
	speed: 0.0387s/iter; left time: 669.7411s
	iters: 200, epoch: 23 | loss: 0.0835324
	speed: 0.0176s/iter; left time: 303.2379s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0839153 Vali Loss: 0.0830652 Test Loss: 0.0870562
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0858449
	speed: 0.0397s/iter; left time: 678.0082s
	iters: 200, epoch: 24 | loss: 0.0827970
	speed: 0.0204s/iter; left time: 345.6837s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.66s
Steps: 223 | Train Loss: 0.0833876 Vali Loss: 0.0825687 Test Loss: 0.0870922
Validation loss decreased (0.082782 --> 0.082569).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0830724
	speed: 0.0394s/iter; left time: 664.2001s
	iters: 200, epoch: 25 | loss: 0.0819455
	speed: 0.0178s/iter; left time: 298.9575s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0834162 Vali Loss: 0.0829770 Test Loss: 0.0871466
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0862517
	speed: 0.0376s/iter; left time: 625.9024s
	iters: 200, epoch: 26 | loss: 0.0832444
	speed: 0.0179s/iter; left time: 295.0242s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0836620 Vali Loss: 0.0828633 Test Loss: 0.0868982
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0810724
	speed: 0.0387s/iter; left time: 634.5376s
	iters: 200, epoch: 27 | loss: 0.0871291
	speed: 0.0186s/iter; left time: 303.8823s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0833860 Vali Loss: 0.0832820 Test Loss: 0.0875993
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0828814
	speed: 0.0384s/iter; left time: 621.6235s
	iters: 200, epoch: 28 | loss: 0.0834261
	speed: 0.0202s/iter; left time: 325.5774s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.53s
Steps: 223 | Train Loss: 0.0832057 Vali Loss: 0.0830274 Test Loss: 0.0874306
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0795119
	speed: 0.0379s/iter; left time: 604.5026s
	iters: 200, epoch: 29 | loss: 0.0835493
	speed: 0.0179s/iter; left time: 283.3365s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0831295 Vali Loss: 0.0828504 Test Loss: 0.0873075
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0820471
	speed: 0.0396s/iter; left time: 622.9232s
	iters: 200, epoch: 30 | loss: 0.0849657
	speed: 0.0198s/iter; left time: 309.3678s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.69s
Steps: 223 | Train Loss: 0.0831793 Vali Loss: 0.0829110 Test Loss: 0.0872107
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0845075
	speed: 0.0410s/iter; left time: 635.6578s
	iters: 200, epoch: 31 | loss: 0.0835567
	speed: 0.0235s/iter; left time: 362.2765s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0830533 Vali Loss: 0.0830682 Test Loss: 0.0872975
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0820101
	speed: 0.0405s/iter; left time: 619.6774s
	iters: 200, epoch: 32 | loss: 0.0822481
	speed: 0.0182s/iter; left time: 276.0996s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.32s
Steps: 223 | Train Loss: 0.0831543 Vali Loss: 0.0829948 Test Loss: 0.0874315
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0814776
	speed: 0.0406s/iter; left time: 611.7506s
	iters: 200, epoch: 33 | loss: 0.0830027
	speed: 0.0200s/iter; left time: 299.8629s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.65s
Steps: 223 | Train Loss: 0.0829303 Vali Loss: 0.0826190 Test Loss: 0.0872689
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0803830
	speed: 0.0407s/iter; left time: 603.8938s
	iters: 200, epoch: 34 | loss: 0.0853011
	speed: 0.0214s/iter; left time: 316.1368s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.79s
Steps: 223 | Train Loss: 0.0830261 Vali Loss: 0.0829794 Test Loss: 0.0871384
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019714010879397392, rmse:0.14040659368038177, mae:0.08709219098091125, rse:0.5313858389854431
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2722960
	speed: 0.0235s/iter; left time: 522.0063s
	iters: 200, epoch: 1 | loss: 0.2520403
	speed: 0.0225s/iter; left time: 497.4038s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.2729355 Vali Loss: 0.1871675 Test Loss: 0.1942406
Validation loss decreased (inf --> 0.187168).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1451315
	speed: 0.0433s/iter; left time: 951.7937s
	iters: 200, epoch: 2 | loss: 0.1175948
	speed: 0.0176s/iter; left time: 386.0414s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.55s
Steps: 223 | Train Loss: 0.1519489 Vali Loss: 0.1065287 Test Loss: 0.1124682
Validation loss decreased (0.187168 --> 0.106529).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1093920
	speed: 0.0388s/iter; left time: 843.5858s
	iters: 200, epoch: 3 | loss: 0.1011367
	speed: 0.0176s/iter; left time: 381.9942s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.1095336 Vali Loss: 0.0991193 Test Loss: 0.1020565
Validation loss decreased (0.106529 --> 0.099119).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1005649
	speed: 0.0412s/iter; left time: 887.5448s
	iters: 200, epoch: 4 | loss: 0.0982407
	speed: 0.0195s/iter; left time: 417.6720s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.55s
Steps: 223 | Train Loss: 0.0996083 Vali Loss: 0.0927828 Test Loss: 0.0957338
Validation loss decreased (0.099119 --> 0.092783).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0915633
	speed: 0.0407s/iter; left time: 866.7162s
	iters: 200, epoch: 5 | loss: 0.0933431
	speed: 0.0194s/iter; left time: 412.3335s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.68s
Steps: 223 | Train Loss: 0.0943571 Vali Loss: 0.0890659 Test Loss: 0.0916014
Validation loss decreased (0.092783 --> 0.089066).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0901610
	speed: 0.0436s/iter; left time: 920.3169s
	iters: 200, epoch: 6 | loss: 0.0907858
	speed: 0.0197s/iter; left time: 413.0765s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.62s
Steps: 223 | Train Loss: 0.0922208 Vali Loss: 0.0875594 Test Loss: 0.0909533
Validation loss decreased (0.089066 --> 0.087559).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0865553
	speed: 0.0396s/iter; left time: 826.2321s
	iters: 200, epoch: 7 | loss: 0.0909120
	speed: 0.0177s/iter; left time: 368.5266s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0900594 Vali Loss: 0.0859338 Test Loss: 0.0903283
Validation loss decreased (0.087559 --> 0.085934).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0875558
	speed: 0.0412s/iter; left time: 849.5548s
	iters: 200, epoch: 8 | loss: 0.0910288
	speed: 0.0178s/iter; left time: 365.5032s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0887726 Vali Loss: 0.0861879 Test Loss: 0.0898933
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0925807
	speed: 0.0413s/iter; left time: 843.0904s
	iters: 200, epoch: 9 | loss: 0.0852723
	speed: 0.0205s/iter; left time: 417.1838s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.86s
Steps: 223 | Train Loss: 0.0880142 Vali Loss: 0.0854083 Test Loss: 0.0899860
Validation loss decreased (0.085934 --> 0.085408).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0877279
	speed: 0.0441s/iter; left time: 891.2089s
	iters: 200, epoch: 10 | loss: 0.0881637
	speed: 0.0230s/iter; left time: 461.7380s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0870026 Vali Loss: 0.0842553 Test Loss: 0.0891894
Validation loss decreased (0.085408 --> 0.084255).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0845610
	speed: 0.0413s/iter; left time: 825.6375s
	iters: 200, epoch: 11 | loss: 0.0836188
	speed: 0.0197s/iter; left time: 390.8066s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.47s
Steps: 223 | Train Loss: 0.0865821 Vali Loss: 0.0840564 Test Loss: 0.0891234
Validation loss decreased (0.084255 --> 0.084056).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0851073
	speed: 0.0409s/iter; left time: 807.1010s
	iters: 200, epoch: 12 | loss: 0.0875089
	speed: 0.0218s/iter; left time: 428.1492s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.87s
Steps: 223 | Train Loss: 0.0859562 Vali Loss: 0.0838318 Test Loss: 0.0894333
Validation loss decreased (0.084056 --> 0.083832).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0848750
	speed: 0.0420s/iter; left time: 819.2236s
	iters: 200, epoch: 13 | loss: 0.0861893
	speed: 0.0183s/iter; left time: 355.5466s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.48s
Steps: 223 | Train Loss: 0.0858611 Vali Loss: 0.0833734 Test Loss: 0.0887535
Validation loss decreased (0.083832 --> 0.083373).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0860830
	speed: 0.0420s/iter; left time: 810.3363s
	iters: 200, epoch: 14 | loss: 0.0848291
	speed: 0.0226s/iter; left time: 434.3396s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.94s
Steps: 223 | Train Loss: 0.0854367 Vali Loss: 0.0841547 Test Loss: 0.0900619
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0818479
	speed: 0.0419s/iter; left time: 798.8150s
	iters: 200, epoch: 15 | loss: 0.0812685
	speed: 0.0206s/iter; left time: 391.0031s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.89s
Steps: 223 | Train Loss: 0.0850249 Vali Loss: 0.0830967 Test Loss: 0.0891032
Validation loss decreased (0.083373 --> 0.083097).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0832635
	speed: 0.0427s/iter; left time: 804.8350s
	iters: 200, epoch: 16 | loss: 0.0835396
	speed: 0.0184s/iter; left time: 345.9199s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.0846237 Vali Loss: 0.0839857 Test Loss: 0.0897158
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0865859
	speed: 0.0420s/iter; left time: 781.8145s
	iters: 200, epoch: 17 | loss: 0.0830418
	speed: 0.0233s/iter; left time: 431.1910s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0846093 Vali Loss: 0.0829229 Test Loss: 0.0888173
Validation loss decreased (0.083097 --> 0.082923).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0878394
	speed: 0.0420s/iter; left time: 772.8597s
	iters: 200, epoch: 18 | loss: 0.0843701
	speed: 0.0207s/iter; left time: 378.6477s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.79s
Steps: 223 | Train Loss: 0.0842403 Vali Loss: 0.0827744 Test Loss: 0.0888727
Validation loss decreased (0.082923 --> 0.082774).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800858
	speed: 0.0430s/iter; left time: 782.7241s
	iters: 200, epoch: 19 | loss: 0.0841985
	speed: 0.0208s/iter; left time: 377.0210s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.83s
Steps: 223 | Train Loss: 0.0839250 Vali Loss: 0.0828307 Test Loss: 0.0890774
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0823361
	speed: 0.0394s/iter; left time: 707.7687s
	iters: 200, epoch: 20 | loss: 0.0813437
	speed: 0.0176s/iter; left time: 313.9295s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0838102 Vali Loss: 0.0836323 Test Loss: 0.0896494
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0843800
	speed: 0.0403s/iter; left time: 714.2671s
	iters: 200, epoch: 21 | loss: 0.0815336
	speed: 0.0218s/iter; left time: 385.4117s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.92s
Steps: 223 | Train Loss: 0.0835798 Vali Loss: 0.0830011 Test Loss: 0.0888385
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0837442
	speed: 0.0399s/iter; left time: 699.3352s
	iters: 200, epoch: 22 | loss: 0.0840666
	speed: 0.0185s/iter; left time: 322.0325s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0833981 Vali Loss: 0.0827323 Test Loss: 0.0891256
Validation loss decreased (0.082774 --> 0.082732).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0806301
	speed: 0.0441s/iter; left time: 763.0869s
	iters: 200, epoch: 23 | loss: 0.0837485
	speed: 0.0213s/iter; left time: 366.0868s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.07s
Steps: 223 | Train Loss: 0.0831782 Vali Loss: 0.0830684 Test Loss: 0.0891765
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0847063
	speed: 0.0417s/iter; left time: 711.2161s
	iters: 200, epoch: 24 | loss: 0.0892751
	speed: 0.0179s/iter; left time: 302.9875s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0832580 Vali Loss: 0.0834589 Test Loss: 0.0896644
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0811307
	speed: 0.0404s/iter; left time: 679.9608s
	iters: 200, epoch: 25 | loss: 0.0808395
	speed: 0.0178s/iter; left time: 297.3802s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0834092 Vali Loss: 0.0836975 Test Loss: 0.0896986
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0824584
	speed: 0.0393s/iter; left time: 653.1168s
	iters: 200, epoch: 26 | loss: 0.0837605
	speed: 0.0181s/iter; left time: 299.5267s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0829938 Vali Loss: 0.0828161 Test Loss: 0.0889473
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0861984
	speed: 0.0393s/iter; left time: 645.4068s
	iters: 200, epoch: 27 | loss: 0.0795609
	speed: 0.0183s/iter; left time: 298.5623s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0832123 Vali Loss: 0.0828130 Test Loss: 0.0890543
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0834852
	speed: 0.0424s/iter; left time: 685.4439s
	iters: 200, epoch: 28 | loss: 0.0844575
	speed: 0.0178s/iter; left time: 286.1779s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0829307 Vali Loss: 0.0832087 Test Loss: 0.0893112
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0846860
	speed: 0.0382s/iter; left time: 608.9777s
	iters: 200, epoch: 29 | loss: 0.0851766
	speed: 0.0175s/iter; left time: 276.8984s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.12s
Steps: 223 | Train Loss: 0.0829010 Vali Loss: 0.0828926 Test Loss: 0.0890503
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0829685
	speed: 0.0389s/iter; left time: 612.0914s
	iters: 200, epoch: 30 | loss: 0.0811437
	speed: 0.0216s/iter; left time: 337.7311s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.70s
Steps: 223 | Train Loss: 0.0829337 Vali Loss: 0.0829649 Test Loss: 0.0891979
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0834660
	speed: 0.0415s/iter; left time: 644.0878s
	iters: 200, epoch: 31 | loss: 0.0847687
	speed: 0.0212s/iter; left time: 326.2597s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.96s
Steps: 223 | Train Loss: 0.0828318 Vali Loss: 0.0832319 Test Loss: 0.0892689
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0830979
	speed: 0.0414s/iter; left time: 633.4162s
	iters: 200, epoch: 32 | loss: 0.0814148
	speed: 0.0194s/iter; left time: 294.4085s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.58s
Steps: 223 | Train Loss: 0.0827432 Vali Loss: 0.0831890 Test Loss: 0.0893123
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020823365077376366, rmse:0.14430303871631622, mae:0.08912559598684311, rse:0.5461323857307434
Intermediate time for IT and pred_len 168: 00h:06m:44.81sIntermediate time for IT: 00h:27m:32.32sTotal time: 02h:24m:30.60s