=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1222990
	speed: 0.0613s/iter; left time: 1365.9819s
	iters: 200, epoch: 1 | loss: 0.1122023
	speed: 0.0312s/iter; left time: 693.7261s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.1267766 Vali Loss: 0.0935439 Test Loss: 0.0950520
Validation loss decreased (inf --> 0.093544).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0419376
	speed: 0.0607s/iter; left time: 1339.2066s
	iters: 200, epoch: 2 | loss: 0.0284766
	speed: 0.0316s/iter; left time: 694.4481s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.37s
Steps: 224 | Train Loss: 0.0480114 Vali Loss: 0.0276108 Test Loss: 0.0294567
Validation loss decreased (0.093544 --> 0.027611).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0220861
	speed: 0.0613s/iter; left time: 1338.8868s
	iters: 200, epoch: 3 | loss: 0.0211231
	speed: 0.0317s/iter; left time: 690.3014s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.37s
Steps: 224 | Train Loss: 0.0230827 Vali Loss: 0.0250716 Test Loss: 0.0266407
Validation loss decreased (0.027611 --> 0.025072).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0220476
	speed: 0.0602s/iter; left time: 1301.6703s
	iters: 200, epoch: 4 | loss: 0.0232012
	speed: 0.0317s/iter; left time: 682.4173s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0197940 Vali Loss: 0.0232434 Test Loss: 0.0251538
Validation loss decreased (0.025072 --> 0.023243).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0189569
	speed: 0.0614s/iter; left time: 1314.2460s
	iters: 200, epoch: 5 | loss: 0.0175613
	speed: 0.0324s/iter; left time: 689.2760s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0180648 Vali Loss: 0.0219851 Test Loss: 0.0238013
Validation loss decreased (0.023243 --> 0.021985).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0212432
	speed: 0.0611s/iter; left time: 1294.1797s
	iters: 200, epoch: 6 | loss: 0.0167787
	speed: 0.0318s/iter; left time: 670.6090s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0171204 Vali Loss: 0.0217660 Test Loss: 0.0235090
Validation loss decreased (0.021985 --> 0.021766).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0163779
	speed: 0.0619s/iter; left time: 1296.7421s
	iters: 200, epoch: 7 | loss: 0.0178758
	speed: 0.0320s/iter; left time: 667.8398s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0164427 Vali Loss: 0.0213234 Test Loss: 0.0231106
Validation loss decreased (0.021766 --> 0.021323).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0153116
	speed: 0.0618s/iter; left time: 1281.3828s
	iters: 200, epoch: 8 | loss: 0.0156371
	speed: 0.0318s/iter; left time: 657.0754s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0160626 Vali Loss: 0.0215641 Test Loss: 0.0235629
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0175868
	speed: 0.0613s/iter; left time: 1257.8290s
	iters: 200, epoch: 9 | loss: 0.0172233
	speed: 0.0321s/iter; left time: 655.4217s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0157584 Vali Loss: 0.0211341 Test Loss: 0.0230975
Validation loss decreased (0.021323 --> 0.021134).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0164381
	speed: 0.0615s/iter; left time: 1247.0120s
	iters: 200, epoch: 10 | loss: 0.0152910
	speed: 0.0320s/iter; left time: 645.5465s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0154029 Vali Loss: 0.0212651 Test Loss: 0.0235113
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0129175
	speed: 0.0606s/iter; left time: 1215.8429s
	iters: 200, epoch: 11 | loss: 0.0147491
	speed: 0.0321s/iter; left time: 640.5145s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.43s
Steps: 224 | Train Loss: 0.0152441 Vali Loss: 0.0207131 Test Loss: 0.0226023
Validation loss decreased (0.021134 --> 0.020713).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0151582
	speed: 0.0617s/iter; left time: 1223.1939s
	iters: 200, epoch: 12 | loss: 0.0152677
	speed: 0.0321s/iter; left time: 633.5226s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0150385 Vali Loss: 0.0210057 Test Loss: 0.0228386
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0136673
	speed: 0.0604s/iter; left time: 1185.0591s
	iters: 200, epoch: 13 | loss: 0.0141618
	speed: 0.0330s/iter; left time: 643.2613s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0149006 Vali Loss: 0.0205923 Test Loss: 0.0225011
Validation loss decreased (0.020713 --> 0.020592).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0141812
	speed: 0.0610s/iter; left time: 1182.7181s
	iters: 200, epoch: 14 | loss: 0.0148937
	speed: 0.0321s/iter; left time: 618.7816s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0147474 Vali Loss: 0.0204325 Test Loss: 0.0223470
Validation loss decreased (0.020592 --> 0.020433).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0142198
	speed: 0.0626s/iter; left time: 1199.0431s
	iters: 200, epoch: 15 | loss: 0.0126263
	speed: 0.0321s/iter; left time: 612.3347s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0146567 Vali Loss: 0.0203714 Test Loss: 0.0223274
Validation loss decreased (0.020433 --> 0.020371).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0147880
	speed: 0.0618s/iter; left time: 1170.3107s
	iters: 200, epoch: 16 | loss: 0.0144410
	speed: 0.0323s/iter; left time: 608.6422s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0146212 Vali Loss: 0.0207287 Test Loss: 0.0225603
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0148663
	speed: 0.0618s/iter; left time: 1157.2427s
	iters: 200, epoch: 17 | loss: 0.0141908
	speed: 0.0322s/iter; left time: 599.9513s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0144554 Vali Loss: 0.0202148 Test Loss: 0.0221464
Validation loss decreased (0.020371 --> 0.020215).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0148504
	speed: 0.0634s/iter; left time: 1173.1980s
	iters: 200, epoch: 18 | loss: 0.0172588
	speed: 0.0330s/iter; left time: 607.7259s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0144195 Vali Loss: 0.0200641 Test Loss: 0.0218430
Validation loss decreased (0.020215 --> 0.020064).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0126696
	speed: 0.0628s/iter; left time: 1146.6626s
	iters: 200, epoch: 19 | loss: 0.0133310
	speed: 0.0325s/iter; left time: 591.0060s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0143151 Vali Loss: 0.0205285 Test Loss: 0.0225459
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0141876
	speed: 0.0620s/iter; left time: 1118.9593s
	iters: 200, epoch: 20 | loss: 0.0154408
	speed: 0.0325s/iter; left time: 582.6493s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0142808 Vali Loss: 0.0203298 Test Loss: 0.0220595
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0120954
	speed: 0.0624s/iter; left time: 1112.0831s
	iters: 200, epoch: 21 | loss: 0.0147030
	speed: 0.0325s/iter; left time: 575.6891s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0142541 Vali Loss: 0.0202322 Test Loss: 0.0224036
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0121426
	speed: 0.0614s/iter; left time: 1079.7388s
	iters: 200, epoch: 22 | loss: 0.0135340
	speed: 0.0337s/iter; left time: 589.0041s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0141983 Vali Loss: 0.0201447 Test Loss: 0.0221023
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0145164
	speed: 0.0613s/iter; left time: 1065.5831s
	iters: 200, epoch: 23 | loss: 0.0128908
	speed: 0.0324s/iter; left time: 559.3210s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0141312 Vali Loss: 0.0203349 Test Loss: 0.0227068
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0137177
	speed: 0.0605s/iter; left time: 1036.7531s
	iters: 200, epoch: 24 | loss: 0.0136329
	speed: 0.0320s/iter; left time: 545.3447s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0140988 Vali Loss: 0.0202100 Test Loss: 0.0221388
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0139595
	speed: 0.0582s/iter; left time: 985.3597s
	iters: 200, epoch: 25 | loss: 0.0172756
	speed: 0.0322s/iter; left time: 541.0742s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0140711 Vali Loss: 0.0200398 Test Loss: 0.0219033
Validation loss decreased (0.020064 --> 0.020040).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0137785
	speed: 0.0594s/iter; left time: 991.2793s
	iters: 200, epoch: 26 | loss: 0.0135769
	speed: 0.0319s/iter; left time: 529.0913s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0140351 Vali Loss: 0.0200323 Test Loss: 0.0218325
Validation loss decreased (0.020040 --> 0.020032).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0150175
	speed: 0.0582s/iter; left time: 958.7707s
	iters: 200, epoch: 27 | loss: 0.0154345
	speed: 0.0323s/iter; left time: 529.1345s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.40s
Steps: 224 | Train Loss: 0.0139935 Vali Loss: 0.0199558 Test Loss: 0.0218374
Validation loss decreased (0.020032 --> 0.019956).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0122481
	speed: 0.0620s/iter; left time: 1008.3606s
	iters: 200, epoch: 28 | loss: 0.0150768
	speed: 0.0320s/iter; left time: 517.3078s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.44s
Steps: 224 | Train Loss: 0.0139888 Vali Loss: 0.0201497 Test Loss: 0.0222160
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0144535
	speed: 0.0578s/iter; left time: 926.5491s
	iters: 200, epoch: 29 | loss: 0.0119596
	speed: 0.0318s/iter; left time: 506.6883s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.31s
Steps: 224 | Train Loss: 0.0139765 Vali Loss: 0.0200327 Test Loss: 0.0220907
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0161402
	speed: 0.0594s/iter; left time: 938.5773s
	iters: 200, epoch: 30 | loss: 0.0147173
	speed: 0.0325s/iter; left time: 511.1246s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0139347 Vali Loss: 0.0199370 Test Loss: 0.0221591
Validation loss decreased (0.019956 --> 0.019937).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0135855
	speed: 0.0615s/iter; left time: 957.6345s
	iters: 200, epoch: 31 | loss: 0.0129211
	speed: 0.0329s/iter; left time: 508.6179s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0139453 Vali Loss: 0.0200089 Test Loss: 0.0217233
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0130386
	speed: 0.0644s/iter; left time: 988.5046s
	iters: 200, epoch: 32 | loss: 0.0151058
	speed: 0.0357s/iter; left time: 544.7457s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0139052 Vali Loss: 0.0198388 Test Loss: 0.0217656
Validation loss decreased (0.019937 --> 0.019839).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0151810
	speed: 0.0651s/iter; left time: 985.8966s
	iters: 200, epoch: 33 | loss: 0.0121507
	speed: 0.0357s/iter; left time: 535.9345s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0138984 Vali Loss: 0.0199295 Test Loss: 0.0219177
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0138505
	speed: 0.0660s/iter; left time: 983.3781s
	iters: 200, epoch: 34 | loss: 0.0144497
	speed: 0.0342s/iter; left time: 505.8203s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0138961 Vali Loss: 0.0199464 Test Loss: 0.0218640
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0145499
	speed: 0.0688s/iter; left time: 1010.8486s
	iters: 200, epoch: 35 | loss: 0.0122951
	speed: 0.0339s/iter; left time: 494.1309s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0138513 Vali Loss: 0.0198913 Test Loss: 0.0217917
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0140391
	speed: 0.0666s/iter; left time: 962.9506s
	iters: 200, epoch: 36 | loss: 0.0156457
	speed: 0.0347s/iter; left time: 497.6383s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0138767 Vali Loss: 0.0201202 Test Loss: 0.0219720
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0174159
	speed: 0.0648s/iter; left time: 923.0512s
	iters: 200, epoch: 37 | loss: 0.0135666
	speed: 0.0340s/iter; left time: 481.0490s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0138484 Vali Loss: 0.0199732 Test Loss: 0.0218658
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0138687
	speed: 0.0650s/iter; left time: 910.7446s
	iters: 200, epoch: 38 | loss: 0.0129105
	speed: 0.0345s/iter; left time: 479.5221s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0138696 Vali Loss: 0.0199889 Test Loss: 0.0218638
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0153570
	speed: 0.0644s/iter; left time: 887.8654s
	iters: 200, epoch: 39 | loss: 0.0127968
	speed: 0.0344s/iter; left time: 470.9072s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0138804 Vali Loss: 0.0198075 Test Loss: 0.0218017
Validation loss decreased (0.019839 --> 0.019807).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0122012
	speed: 0.0659s/iter; left time: 893.5174s
	iters: 200, epoch: 40 | loss: 0.0156413
	speed: 0.0365s/iter; left time: 490.9232s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.17s
Steps: 224 | Train Loss: 0.0138368 Vali Loss: 0.0199014 Test Loss: 0.0218669
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0124090
	speed: 0.0655s/iter; left time: 873.6033s
	iters: 200, epoch: 41 | loss: 0.0136367
	speed: 0.0337s/iter; left time: 446.8212s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0138275 Vali Loss: 0.0198964 Test Loss: 0.0220496
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0127942
	speed: 0.0647s/iter; left time: 848.3028s
	iters: 200, epoch: 42 | loss: 0.0153207
	speed: 0.0347s/iter; left time: 452.1709s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0138310 Vali Loss: 0.0199408 Test Loss: 0.0219102
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0150594
	speed: 0.0666s/iter; left time: 858.7574s
	iters: 200, epoch: 43 | loss: 0.0142191
	speed: 0.0352s/iter; left time: 450.0219s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0138246 Vali Loss: 0.0199161 Test Loss: 0.0220573
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0119022
	speed: 0.0658s/iter; left time: 833.1813s
	iters: 200, epoch: 44 | loss: 0.0138348
	speed: 0.0340s/iter; left time: 427.6046s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0137990 Vali Loss: 0.0199644 Test Loss: 0.0219828
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0142369
	speed: 0.0663s/iter; left time: 825.3889s
	iters: 200, epoch: 45 | loss: 0.0147083
	speed: 0.0339s/iter; left time: 418.2626s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0138106 Vali Loss: 0.0199118 Test Loss: 0.0219210
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0138345
	speed: 0.0656s/iter; left time: 802.0637s
	iters: 200, epoch: 46 | loss: 0.0150223
	speed: 0.0350s/iter; left time: 424.0148s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0137858 Vali Loss: 0.0199091 Test Loss: 0.0218749
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0139790
	speed: 0.0641s/iter; left time: 768.4079s
	iters: 200, epoch: 47 | loss: 0.0130415
	speed: 0.0349s/iter; left time: 415.6390s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0137935 Vali Loss: 0.0199717 Test Loss: 0.0220268
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0148001
	speed: 0.0634s/iter; left time: 746.6352s
	iters: 200, epoch: 48 | loss: 0.0131510
	speed: 0.0338s/iter; left time: 395.0902s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0137964 Vali Loss: 0.0198949 Test Loss: 0.0219121
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0140426
	speed: 0.0647s/iter; left time: 747.0507s
	iters: 200, epoch: 49 | loss: 0.0147091
	speed: 0.0333s/iter; left time: 381.6140s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0137915 Vali Loss: 0.0198982 Test Loss: 0.0218868
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02180168777704239, rmse:0.1476539522409439, mae:0.09520922601222992, rse:0.5210912227630615
Intermediate time for DE and pred_len 24: 00h:08m:00.96s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1211567
	speed: 0.0795s/iter; left time: 1757.5864s
	iters: 200, epoch: 1 | loss: 0.1046408
	speed: 0.0497s/iter; left time: 1094.2503s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.60s
Steps: 222 | Train Loss: 0.1242929 Vali Loss: 0.0921334 Test Loss: 0.0956747
Validation loss decreased (inf --> 0.092133).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0427316
	speed: 0.0925s/iter; left time: 2024.8100s
	iters: 200, epoch: 2 | loss: 0.0360543
	speed: 0.0503s/iter; left time: 1095.4724s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.50s
Steps: 222 | Train Loss: 0.0495366 Vali Loss: 0.0375714 Test Loss: 0.0424508
Validation loss decreased (0.092133 --> 0.037571).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0282392
	speed: 0.0945s/iter; left time: 2047.2490s
	iters: 200, epoch: 3 | loss: 0.0292974
	speed: 0.0500s/iter; left time: 1076.9347s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.37s
Steps: 222 | Train Loss: 0.0303366 Vali Loss: 0.0345866 Test Loss: 0.0395371
Validation loss decreased (0.037571 --> 0.034587).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0250123
	speed: 0.0925s/iter; left time: 1982.9671s
	iters: 200, epoch: 4 | loss: 0.0266757
	speed: 0.0508s/iter; left time: 1083.4839s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.52s
Steps: 222 | Train Loss: 0.0267789 Vali Loss: 0.0351737 Test Loss: 0.0422639
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0277342
	speed: 0.0912s/iter; left time: 1934.9650s
	iters: 200, epoch: 5 | loss: 0.0253331
	speed: 0.0500s/iter; left time: 1055.3085s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.37s
Steps: 222 | Train Loss: 0.0252380 Vali Loss: 0.0339698 Test Loss: 0.0410371
Validation loss decreased (0.034587 --> 0.033970).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0240003
	speed: 0.0936s/iter; left time: 1964.8351s
	iters: 200, epoch: 6 | loss: 0.0239523
	speed: 0.0490s/iter; left time: 1023.7036s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.30s
Steps: 222 | Train Loss: 0.0244408 Vali Loss: 0.0329343 Test Loss: 0.0393448
Validation loss decreased (0.033970 --> 0.032934).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0246434
	speed: 0.0935s/iter; left time: 1941.9605s
	iters: 200, epoch: 7 | loss: 0.0262259
	speed: 0.0501s/iter; left time: 1034.9272s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.39s
Steps: 222 | Train Loss: 0.0240215 Vali Loss: 0.0328176 Test Loss: 0.0386598
Validation loss decreased (0.032934 --> 0.032818).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0231876
	speed: 0.0922s/iter; left time: 1894.9070s
	iters: 200, epoch: 8 | loss: 0.0238847
	speed: 0.0501s/iter; left time: 1024.7123s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.35s
Steps: 222 | Train Loss: 0.0236295 Vali Loss: 0.0320381 Test Loss: 0.0376855
Validation loss decreased (0.032818 --> 0.032038).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0231493
	speed: 0.0995s/iter; left time: 2022.9142s
	iters: 200, epoch: 9 | loss: 0.0213140
	speed: 0.0512s/iter; left time: 1036.3602s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.70s
Steps: 222 | Train Loss: 0.0233542 Vali Loss: 0.0310939 Test Loss: 0.0364179
Validation loss decreased (0.032038 --> 0.031094).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0240150
	speed: 0.0930s/iter; left time: 1869.0709s
	iters: 200, epoch: 10 | loss: 0.0250064
	speed: 0.0492s/iter; left time: 985.1227s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.34s
Steps: 222 | Train Loss: 0.0230431 Vali Loss: 0.0318775 Test Loss: 0.0378130
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0221963
	speed: 0.0931s/iter; left time: 1851.7991s
	iters: 200, epoch: 11 | loss: 0.0231455
	speed: 0.0516s/iter; left time: 1020.6763s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.53s
Steps: 222 | Train Loss: 0.0229509 Vali Loss: 0.0310655 Test Loss: 0.0365913
Validation loss decreased (0.031094 --> 0.031065).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0235978
	speed: 0.0920s/iter; left time: 1808.2538s
	iters: 200, epoch: 12 | loss: 0.0198639
	speed: 0.0506s/iter; left time: 988.9222s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.47s
Steps: 222 | Train Loss: 0.0227393 Vali Loss: 0.0312596 Test Loss: 0.0370144
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0211119
	speed: 0.0918s/iter; left time: 1783.4331s
	iters: 200, epoch: 13 | loss: 0.0218012
	speed: 0.0493s/iter; left time: 952.4029s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.30s
Steps: 222 | Train Loss: 0.0226356 Vali Loss: 0.0310768 Test Loss: 0.0369859
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0216071
	speed: 0.0907s/iter; left time: 1743.7480s
	iters: 200, epoch: 14 | loss: 0.0224764
	speed: 0.0493s/iter; left time: 942.5669s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0224288 Vali Loss: 0.0311917 Test Loss: 0.0372712
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0242154
	speed: 0.0918s/iter; left time: 1742.9386s
	iters: 200, epoch: 15 | loss: 0.0240646
	speed: 0.0489s/iter; left time: 924.6183s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0224298 Vali Loss: 0.0313455 Test Loss: 0.0377980
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0246799
	speed: 0.0916s/iter; left time: 1719.4874s
	iters: 200, epoch: 16 | loss: 0.0186449
	speed: 0.0502s/iter; left time: 936.7278s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.41s
Steps: 222 | Train Loss: 0.0222451 Vali Loss: 0.0310605 Test Loss: 0.0372748
Validation loss decreased (0.031065 --> 0.031061).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0223297
	speed: 0.0910s/iter; left time: 1687.8289s
	iters: 200, epoch: 17 | loss: 0.0224854
	speed: 0.0510s/iter; left time: 941.3186s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.40s
Steps: 222 | Train Loss: 0.0221587 Vali Loss: 0.0311874 Test Loss: 0.0372214
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0234007
	speed: 0.0929s/iter; left time: 1703.3257s
	iters: 200, epoch: 18 | loss: 0.0206719
	speed: 0.0505s/iter; left time: 920.2323s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.33s
Steps: 222 | Train Loss: 0.0221142 Vali Loss: 0.0305699 Test Loss: 0.0367941
Validation loss decreased (0.031061 --> 0.030570).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0215925
	speed: 0.0941s/iter; left time: 1703.7624s
	iters: 200, epoch: 19 | loss: 0.0215316
	speed: 0.0504s/iter; left time: 907.3937s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.63s
Steps: 222 | Train Loss: 0.0219753 Vali Loss: 0.0307330 Test Loss: 0.0371570
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0211730
	speed: 0.0966s/iter; left time: 1727.7496s
	iters: 200, epoch: 20 | loss: 0.0200390
	speed: 0.0491s/iter; left time: 872.9667s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.38s
Steps: 222 | Train Loss: 0.0218705 Vali Loss: 0.0308751 Test Loss: 0.0372903
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0211775
	speed: 0.0909s/iter; left time: 1604.8162s
	iters: 200, epoch: 21 | loss: 0.0211960
	speed: 0.0496s/iter; left time: 871.0781s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.31s
Steps: 222 | Train Loss: 0.0218680 Vali Loss: 0.0309477 Test Loss: 0.0376379
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0190556
	speed: 0.0917s/iter; left time: 1598.8915s
	iters: 200, epoch: 22 | loss: 0.0211424
	speed: 0.0499s/iter; left time: 865.7267s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.33s
Steps: 222 | Train Loss: 0.0218106 Vali Loss: 0.0301766 Test Loss: 0.0363203
Validation loss decreased (0.030570 --> 0.030177).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0218515
	speed: 0.0932s/iter; left time: 1605.3351s
	iters: 200, epoch: 23 | loss: 0.0205890
	speed: 0.0493s/iter; left time: 843.1417s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.39s
Steps: 222 | Train Loss: 0.0217329 Vali Loss: 0.0304868 Test Loss: 0.0365636
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0217730
	speed: 0.0908s/iter; left time: 1542.4728s
	iters: 200, epoch: 24 | loss: 0.0215464
	speed: 0.0504s/iter; left time: 851.6977s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.38s
Steps: 222 | Train Loss: 0.0216485 Vali Loss: 0.0305330 Test Loss: 0.0369576
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0208029
	speed: 0.0904s/iter; left time: 1516.2784s
	iters: 200, epoch: 25 | loss: 0.0230684
	speed: 0.0489s/iter; left time: 815.2146s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0216396 Vali Loss: 0.0307227 Test Loss: 0.0374036
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0216803
	speed: 0.0894s/iter; left time: 1479.2788s
	iters: 200, epoch: 26 | loss: 0.0221263
	speed: 0.0510s/iter; left time: 838.8345s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.51s
Steps: 222 | Train Loss: 0.0216196 Vali Loss: 0.0304883 Test Loss: 0.0369750
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0219150
	speed: 0.0909s/iter; left time: 1484.9353s
	iters: 200, epoch: 27 | loss: 0.0205100
	speed: 0.0509s/iter; left time: 826.7998s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.47s
Steps: 222 | Train Loss: 0.0215644 Vali Loss: 0.0305989 Test Loss: 0.0369882
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0214528
	speed: 0.0921s/iter; left time: 1483.0199s
	iters: 200, epoch: 28 | loss: 0.0225728
	speed: 0.0505s/iter; left time: 808.7824s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:11.43s
Steps: 222 | Train Loss: 0.0215246 Vali Loss: 0.0305688 Test Loss: 0.0372255
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0228054
	speed: 0.0979s/iter; left time: 1555.4951s
	iters: 200, epoch: 29 | loss: 0.0198161
	speed: 0.0509s/iter; left time: 803.5571s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:11.65s
Steps: 222 | Train Loss: 0.0214989 Vali Loss: 0.0308266 Test Loss: 0.0376735
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0225791
	speed: 0.0898s/iter; left time: 1406.4823s
	iters: 200, epoch: 30 | loss: 0.0206602
	speed: 0.0501s/iter; left time: 779.8894s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0214766 Vali Loss: 0.0305522 Test Loss: 0.0371724
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0220604
	speed: 0.0937s/iter; left time: 1446.7781s
	iters: 200, epoch: 31 | loss: 0.0228703
	speed: 0.0486s/iter; left time: 745.0544s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.25s
Steps: 222 | Train Loss: 0.0214585 Vali Loss: 0.0305483 Test Loss: 0.0373443
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0206055
	speed: 0.0893s/iter; left time: 1359.1688s
	iters: 200, epoch: 32 | loss: 0.0194962
	speed: 0.0502s/iter; left time: 758.6881s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:11.27s
Steps: 222 | Train Loss: 0.0214005 Vali Loss: 0.0306938 Test Loss: 0.0374660
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0363202802836895, rmse:0.19057880342006683, mae:0.1305510699748993, rse:0.6748781204223633
Intermediate time for DE and pred_len 96: 00h:07m:48.74s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1201970
	speed: 0.0648s/iter; left time: 1431.4377s
	iters: 200, epoch: 1 | loss: 0.1105937
	speed: 0.0497s/iter; left time: 1092.4091s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.73s
Steps: 222 | Train Loss: 0.1248253 Vali Loss: 0.0926596 Test Loss: 0.0964285
Validation loss decreased (inf --> 0.092660).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0401608
	speed: 0.1001s/iter; left time: 2190.7127s
	iters: 200, epoch: 2 | loss: 0.0348200
	speed: 0.0507s/iter; left time: 1104.4066s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.61s
Steps: 222 | Train Loss: 0.0505578 Vali Loss: 0.0382297 Test Loss: 0.0440547
Validation loss decreased (0.092660 --> 0.038230).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0341885
	speed: 0.0972s/iter; left time: 2105.0437s
	iters: 200, epoch: 3 | loss: 0.0301632
	speed: 0.0497s/iter; left time: 1072.4435s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.60s
Steps: 222 | Train Loss: 0.0315709 Vali Loss: 0.0371159 Test Loss: 0.0438923
Validation loss decreased (0.038230 --> 0.037116).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0303969
	speed: 0.1027s/iter; left time: 2201.9701s
	iters: 200, epoch: 4 | loss: 0.0268241
	speed: 0.0523s/iter; left time: 1115.1075s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.72s
Steps: 222 | Train Loss: 0.0282432 Vali Loss: 0.0384147 Test Loss: 0.0474597
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0252197
	speed: 0.0941s/iter; left time: 1995.4230s
	iters: 200, epoch: 5 | loss: 0.0290112
	speed: 0.0495s/iter; left time: 1044.3064s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.48s
Steps: 222 | Train Loss: 0.0270696 Vali Loss: 0.0356162 Test Loss: 0.0434251
Validation loss decreased (0.037116 --> 0.035616).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0258138
	speed: 0.0957s/iter; left time: 2008.1879s
	iters: 200, epoch: 6 | loss: 0.0258394
	speed: 0.0503s/iter; left time: 1051.2614s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.53s
Steps: 222 | Train Loss: 0.0261948 Vali Loss: 0.0369859 Test Loss: 0.0446513
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0253084
	speed: 0.0927s/iter; left time: 1924.9626s
	iters: 200, epoch: 7 | loss: 0.0254496
	speed: 0.0508s/iter; left time: 1050.0359s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.48s
Steps: 222 | Train Loss: 0.0256539 Vali Loss: 0.0347947 Test Loss: 0.0414930
Validation loss decreased (0.035616 --> 0.034795).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0247787
	speed: 0.0940s/iter; left time: 1931.9962s
	iters: 200, epoch: 8 | loss: 0.0252390
	speed: 0.0504s/iter; left time: 1029.7618s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.46s
Steps: 222 | Train Loss: 0.0252846 Vali Loss: 0.0341283 Test Loss: 0.0409065
Validation loss decreased (0.034795 --> 0.034128).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0245752
	speed: 0.0928s/iter; left time: 1886.6479s
	iters: 200, epoch: 9 | loss: 0.0251687
	speed: 0.0501s/iter; left time: 1013.2576s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.35s
Steps: 222 | Train Loss: 0.0250233 Vali Loss: 0.0326594 Test Loss: 0.0391561
Validation loss decreased (0.034128 --> 0.032659).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0240354
	speed: 0.0925s/iter; left time: 1860.0336s
	iters: 200, epoch: 10 | loss: 0.0253937
	speed: 0.0506s/iter; left time: 1012.6363s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.40s
Steps: 222 | Train Loss: 0.0247593 Vali Loss: 0.0332664 Test Loss: 0.0404661
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0261423
	speed: 0.0922s/iter; left time: 1833.5847s
	iters: 200, epoch: 11 | loss: 0.0256753
	speed: 0.0497s/iter; left time: 983.4680s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.36s
Steps: 222 | Train Loss: 0.0245814 Vali Loss: 0.0325092 Test Loss: 0.0393523
Validation loss decreased (0.032659 --> 0.032509).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0264353
	speed: 0.0940s/iter; left time: 1848.8127s
	iters: 200, epoch: 12 | loss: 0.0250716
	speed: 0.0505s/iter; left time: 988.4411s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.50s
Steps: 222 | Train Loss: 0.0244160 Vali Loss: 0.0331964 Test Loss: 0.0405376
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0224045
	speed: 0.0980s/iter; left time: 1905.0400s
	iters: 200, epoch: 13 | loss: 0.0240942
	speed: 0.0500s/iter; left time: 966.6507s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.38s
Steps: 222 | Train Loss: 0.0241919 Vali Loss: 0.0327617 Test Loss: 0.0397237
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0224042
	speed: 0.0930s/iter; left time: 1787.1382s
	iters: 200, epoch: 14 | loss: 0.0228675
	speed: 0.0511s/iter; left time: 977.4657s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.51s
Steps: 222 | Train Loss: 0.0240532 Vali Loss: 0.0325049 Test Loss: 0.0400462
Validation loss decreased (0.032509 --> 0.032505).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0224264
	speed: 0.0981s/iter; left time: 1864.0594s
	iters: 200, epoch: 15 | loss: 0.0239447
	speed: 0.0517s/iter; left time: 975.9017s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.59s
Steps: 222 | Train Loss: 0.0238901 Vali Loss: 0.0326816 Test Loss: 0.0407697
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0228343
	speed: 0.0941s/iter; left time: 1766.4159s
	iters: 200, epoch: 16 | loss: 0.0244847
	speed: 0.0502s/iter; left time: 936.7524s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.50s
Steps: 222 | Train Loss: 0.0238586 Vali Loss: 0.0328233 Test Loss: 0.0409972
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0249028
	speed: 0.0937s/iter; left time: 1737.2823s
	iters: 200, epoch: 17 | loss: 0.0245231
	speed: 0.0498s/iter; left time: 918.8094s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.47s
Steps: 222 | Train Loss: 0.0236727 Vali Loss: 0.0318149 Test Loss: 0.0389934
Validation loss decreased (0.032505 --> 0.031815).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0259864
	speed: 0.0936s/iter; left time: 1714.8901s
	iters: 200, epoch: 18 | loss: 0.0249082
	speed: 0.0509s/iter; left time: 928.2427s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.45s
Steps: 222 | Train Loss: 0.0236133 Vali Loss: 0.0326205 Test Loss: 0.0401949
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0230845
	speed: 0.0912s/iter; left time: 1651.2096s
	iters: 200, epoch: 19 | loss: 0.0244532
	speed: 0.0502s/iter; left time: 904.5764s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.37s
Steps: 222 | Train Loss: 0.0234732 Vali Loss: 0.0324181 Test Loss: 0.0406701
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0229646
	speed: 0.0930s/iter; left time: 1663.2793s
	iters: 200, epoch: 20 | loss: 0.0225817
	speed: 0.0500s/iter; left time: 888.4947s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.40s
Steps: 222 | Train Loss: 0.0233922 Vali Loss: 0.0328225 Test Loss: 0.0413763
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0235294
	speed: 0.0924s/iter; left time: 1631.6374s
	iters: 200, epoch: 21 | loss: 0.0233960
	speed: 0.0508s/iter; left time: 891.5378s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.41s
Steps: 222 | Train Loss: 0.0233425 Vali Loss: 0.0323448 Test Loss: 0.0405806
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0227897
	speed: 0.0918s/iter; left time: 1600.9618s
	iters: 200, epoch: 22 | loss: 0.0233587
	speed: 0.0511s/iter; left time: 885.7920s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.46s
Steps: 222 | Train Loss: 0.0232400 Vali Loss: 0.0327108 Test Loss: 0.0415128
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0230084
	speed: 0.0923s/iter; left time: 1589.5557s
	iters: 200, epoch: 23 | loss: 0.0227019
	speed: 0.0503s/iter; left time: 861.2833s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.51s
Steps: 222 | Train Loss: 0.0231599 Vali Loss: 0.0328264 Test Loss: 0.0417051
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0220565
	speed: 0.0949s/iter; left time: 1612.9663s
	iters: 200, epoch: 24 | loss: 0.0225118
	speed: 0.0491s/iter; left time: 829.3603s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0231256 Vali Loss: 0.0326759 Test Loss: 0.0414577
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0253219
	speed: 0.0909s/iter; left time: 1525.4396s
	iters: 200, epoch: 25 | loss: 0.0229667
	speed: 0.0506s/iter; left time: 843.3038s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.45s
Steps: 222 | Train Loss: 0.0230608 Vali Loss: 0.0324623 Test Loss: 0.0410861
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0217467
	speed: 0.0909s/iter; left time: 1504.6154s
	iters: 200, epoch: 26 | loss: 0.0222396
	speed: 0.0505s/iter; left time: 830.3565s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.34s
Steps: 222 | Train Loss: 0.0230109 Vali Loss: 0.0326253 Test Loss: 0.0417797
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0220535
	speed: 0.0938s/iter; left time: 1530.8813s
	iters: 200, epoch: 27 | loss: 0.0242244
	speed: 0.0510s/iter; left time: 827.1126s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.51s
Steps: 222 | Train Loss: 0.0229573 Vali Loss: 0.0326033 Test Loss: 0.0413879
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0389934666454792, rmse:0.197467640042305, mae:0.1372816115617752, rse:0.6994462013244629
Intermediate time for DE and pred_len 168: 00h:06m:38.81s
Intermediate time for DE: 00h:22m:28.51s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1296732
	speed: 0.0642s/iter; left time: 1424.7886s
	iters: 200, epoch: 1 | loss: 0.1225555
	speed: 0.0491s/iter; left time: 1085.7828s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.54s
Steps: 223 | Train Loss: 0.1316660 Vali Loss: 0.0944922 Test Loss: 0.1096129
Validation loss decreased (inf --> 0.094492).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0377319
	speed: 0.0930s/iter; left time: 2043.8811s
	iters: 200, epoch: 2 | loss: 0.0261822
	speed: 0.0498s/iter; left time: 1090.4178s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.56s
Steps: 223 | Train Loss: 0.0454864 Vali Loss: 0.0248178 Test Loss: 0.0346409
Validation loss decreased (0.094492 --> 0.024818).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0243949
	speed: 0.0902s/iter; left time: 1962.3430s
	iters: 200, epoch: 3 | loss: 0.0203790
	speed: 0.0503s/iter; left time: 1088.3158s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.41s
Steps: 223 | Train Loss: 0.0222196 Vali Loss: 0.0212921 Test Loss: 0.0278196
Validation loss decreased (0.024818 --> 0.021292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0207562
	speed: 0.0921s/iter; left time: 1982.1556s
	iters: 200, epoch: 4 | loss: 0.0200337
	speed: 0.0494s/iter; left time: 1058.8152s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.29s
Steps: 223 | Train Loss: 0.0183250 Vali Loss: 0.0207108 Test Loss: 0.0272615
Validation loss decreased (0.021292 --> 0.020711).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0151180
	speed: 0.0898s/iter; left time: 1914.2871s
	iters: 200, epoch: 5 | loss: 0.0161550
	speed: 0.0496s/iter; left time: 1052.0268s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.33s
Steps: 223 | Train Loss: 0.0166715 Vali Loss: 0.0204913 Test Loss: 0.0278639
Validation loss decreased (0.020711 --> 0.020491).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0140818
	speed: 0.0897s/iter; left time: 1890.7865s
	iters: 200, epoch: 6 | loss: 0.0173617
	speed: 0.0496s/iter; left time: 1041.6864s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.28s
Steps: 223 | Train Loss: 0.0157911 Vali Loss: 0.0205434 Test Loss: 0.0280114
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0153887
	speed: 0.0896s/iter; left time: 1869.9129s
	iters: 200, epoch: 7 | loss: 0.0141236
	speed: 0.0496s/iter; left time: 1030.0978s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.34s
Steps: 223 | Train Loss: 0.0154214 Vali Loss: 0.0204262 Test Loss: 0.0280592
Validation loss decreased (0.020491 --> 0.020426).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0162005
	speed: 0.0900s/iter; left time: 1857.6455s
	iters: 200, epoch: 8 | loss: 0.0151308
	speed: 0.0483s/iter; left time: 992.8827s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.17s
Steps: 223 | Train Loss: 0.0151685 Vali Loss: 0.0205546 Test Loss: 0.0274767
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0159596
	speed: 0.0912s/iter; left time: 1862.4431s
	iters: 200, epoch: 9 | loss: 0.0138793
	speed: 0.0501s/iter; left time: 1017.7224s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.57s
Steps: 223 | Train Loss: 0.0149537 Vali Loss: 0.0201726 Test Loss: 0.0266926
Validation loss decreased (0.020426 --> 0.020173).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0142701
	speed: 0.0892s/iter; left time: 1800.5891s
	iters: 200, epoch: 10 | loss: 0.0156937
	speed: 0.0494s/iter; left time: 993.1446s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.29s
Steps: 223 | Train Loss: 0.0147354 Vali Loss: 0.0200238 Test Loss: 0.0267262
Validation loss decreased (0.020173 --> 0.020024).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0162956
	speed: 0.0890s/iter; left time: 1776.5867s
	iters: 200, epoch: 11 | loss: 0.0157453
	speed: 0.0491s/iter; left time: 976.4388s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.22s
Steps: 223 | Train Loss: 0.0147208 Vali Loss: 0.0202973 Test Loss: 0.0269148
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0120478
	speed: 0.0902s/iter; left time: 1781.3780s
	iters: 200, epoch: 12 | loss: 0.0157311
	speed: 0.0494s/iter; left time: 969.8544s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.35s
Steps: 223 | Train Loss: 0.0144875 Vali Loss: 0.0199512 Test Loss: 0.0266800
Validation loss decreased (0.020024 --> 0.019951).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0137041
	speed: 0.0914s/iter; left time: 1783.6364s
	iters: 200, epoch: 13 | loss: 0.0147808
	speed: 0.0507s/iter; left time: 984.8644s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.47s
Steps: 223 | Train Loss: 0.0143374 Vali Loss: 0.0200135 Test Loss: 0.0267759
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0139965
	speed: 0.0905s/iter; left time: 1746.9507s
	iters: 200, epoch: 14 | loss: 0.0139776
	speed: 0.0487s/iter; left time: 934.5460s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.21s
Steps: 223 | Train Loss: 0.0142924 Vali Loss: 0.0201385 Test Loss: 0.0269570
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0141281
	speed: 0.0904s/iter; left time: 1724.9560s
	iters: 200, epoch: 15 | loss: 0.0135372
	speed: 0.0496s/iter; left time: 940.9557s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.25s
Steps: 223 | Train Loss: 0.0141842 Vali Loss: 0.0197869 Test Loss: 0.0266150
Validation loss decreased (0.019951 --> 0.019787).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0136077
	speed: 0.0910s/iter; left time: 1715.0691s
	iters: 200, epoch: 16 | loss: 0.0126454
	speed: 0.0494s/iter; left time: 925.9890s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.37s
Steps: 223 | Train Loss: 0.0141280 Vali Loss: 0.0200392 Test Loss: 0.0273709
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0148440
	speed: 0.0888s/iter; left time: 1653.9312s
	iters: 200, epoch: 17 | loss: 0.0133331
	speed: 0.0505s/iter; left time: 936.0830s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.42s
Steps: 223 | Train Loss: 0.0140650 Vali Loss: 0.0198028 Test Loss: 0.0266699
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0139154
	speed: 0.0897s/iter; left time: 1650.5469s
	iters: 200, epoch: 18 | loss: 0.0142051
	speed: 0.0499s/iter; left time: 913.0987s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.39s
Steps: 223 | Train Loss: 0.0139809 Vali Loss: 0.0200569 Test Loss: 0.0271863
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0132001
	speed: 0.0898s/iter; left time: 1632.2960s
	iters: 200, epoch: 19 | loss: 0.0152973
	speed: 0.0497s/iter; left time: 899.7510s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.32s
Steps: 223 | Train Loss: 0.0138989 Vali Loss: 0.0201339 Test Loss: 0.0271165
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0138798
	speed: 0.0902s/iter; left time: 1620.6189s
	iters: 200, epoch: 20 | loss: 0.0122192
	speed: 0.0498s/iter; left time: 889.2672s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.43s
Steps: 223 | Train Loss: 0.0138612 Vali Loss: 0.0199807 Test Loss: 0.0271351
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0130000
	speed: 0.0895s/iter; left time: 1588.4832s
	iters: 200, epoch: 21 | loss: 0.0156088
	speed: 0.0493s/iter; left time: 869.0453s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.33s
Steps: 223 | Train Loss: 0.0138289 Vali Loss: 0.0198444 Test Loss: 0.0270159
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0137042
	speed: 0.0902s/iter; left time: 1580.2412s
	iters: 200, epoch: 22 | loss: 0.0144793
	speed: 0.0480s/iter; left time: 835.8598s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.02s
Steps: 223 | Train Loss: 0.0137971 Vali Loss: 0.0200208 Test Loss: 0.0274525
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0149143
	speed: 0.0905s/iter; left time: 1565.7847s
	iters: 200, epoch: 23 | loss: 0.0120591
	speed: 0.0504s/iter; left time: 866.6580s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.58s
Steps: 223 | Train Loss: 0.0137535 Vali Loss: 0.0198494 Test Loss: 0.0272250
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0139830
	speed: 0.0920s/iter; left time: 1569.8186s
	iters: 200, epoch: 24 | loss: 0.0142577
	speed: 0.0505s/iter; left time: 856.8954s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.56s
Steps: 223 | Train Loss: 0.0137470 Vali Loss: 0.0199485 Test Loss: 0.0269865
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0144327
	speed: 0.0920s/iter; left time: 1549.5189s
	iters: 200, epoch: 25 | loss: 0.0133431
	speed: 0.0492s/iter; left time: 824.1753s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.17s
Steps: 223 | Train Loss: 0.0136602 Vali Loss: 0.0199846 Test Loss: 0.0274140
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.026614956557750702, rmse:0.1631409078836441, mae:0.10954777151346207, rse:0.5627899169921875
Intermediate time for GB and pred_len 24: 00h:05m:57.47s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1323240
	speed: 0.0647s/iter; left time: 1430.2825s
	iters: 200, epoch: 1 | loss: 0.1149986
	speed: 0.0489s/iter; left time: 1076.0708s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.54s
Steps: 222 | Train Loss: 0.1320870 Vali Loss: 0.0994640 Test Loss: 0.1168359
Validation loss decreased (inf --> 0.099464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0393860
	speed: 0.0945s/iter; left time: 2067.8632s
	iters: 200, epoch: 2 | loss: 0.0319159
	speed: 0.0487s/iter; left time: 1059.7558s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.22s
Steps: 222 | Train Loss: 0.0481805 Vali Loss: 0.0330101 Test Loss: 0.0472668
Validation loss decreased (0.099464 --> 0.033010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0261547
	speed: 0.0906s/iter; left time: 1963.0412s
	iters: 200, epoch: 3 | loss: 0.0259022
	speed: 0.0494s/iter; left time: 1065.5595s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.32s
Steps: 222 | Train Loss: 0.0273623 Vali Loss: 0.0302135 Test Loss: 0.0438073
Validation loss decreased (0.033010 --> 0.030213).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0226433
	speed: 0.0986s/iter; left time: 2113.7828s
	iters: 200, epoch: 4 | loss: 0.0245221
	speed: 0.0495s/iter; left time: 1055.2120s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.40s
Steps: 222 | Train Loss: 0.0241833 Vali Loss: 0.0304314 Test Loss: 0.0490374
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0251091
	speed: 0.0916s/iter; left time: 1942.7026s
	iters: 200, epoch: 5 | loss: 0.0233933
	speed: 0.0503s/iter; left time: 1061.3379s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.47s
Steps: 222 | Train Loss: 0.0231457 Vali Loss: 0.0307405 Test Loss: 0.0483087
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0226541
	speed: 0.0910s/iter; left time: 1910.3219s
	iters: 200, epoch: 6 | loss: 0.0229256
	speed: 0.0499s/iter; left time: 1041.9831s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.30s
Steps: 222 | Train Loss: 0.0226541 Vali Loss: 0.0304898 Test Loss: 0.0448133
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0223542
	speed: 0.0918s/iter; left time: 1906.7280s
	iters: 200, epoch: 7 | loss: 0.0214087
	speed: 0.0498s/iter; left time: 1030.3454s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.43s
Steps: 222 | Train Loss: 0.0222953 Vali Loss: 0.0299704 Test Loss: 0.0423198
Validation loss decreased (0.030213 --> 0.029970).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0221992
	speed: 0.0919s/iter; left time: 1888.2188s
	iters: 200, epoch: 8 | loss: 0.0222362
	speed: 0.0497s/iter; left time: 1016.9253s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.34s
Steps: 222 | Train Loss: 0.0220033 Vali Loss: 0.0299967 Test Loss: 0.0426890
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0217263
	speed: 0.0906s/iter; left time: 1842.3125s
	iters: 200, epoch: 9 | loss: 0.0209402
	speed: 0.0505s/iter; left time: 1020.3849s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.37s
Steps: 222 | Train Loss: 0.0217836 Vali Loss: 0.0296291 Test Loss: 0.0417050
Validation loss decreased (0.029970 --> 0.029629).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0209449
	speed: 0.0932s/iter; left time: 1873.5750s
	iters: 200, epoch: 10 | loss: 0.0209933
	speed: 0.0493s/iter; left time: 986.1424s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0215704 Vali Loss: 0.0298925 Test Loss: 0.0420922
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0209658
	speed: 0.0925s/iter; left time: 1839.4380s
	iters: 200, epoch: 11 | loss: 0.0199631
	speed: 0.0498s/iter; left time: 985.4300s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.40s
Steps: 222 | Train Loss: 0.0214490 Vali Loss: 0.0293610 Test Loss: 0.0405640
Validation loss decreased (0.029629 --> 0.029361).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0216354
	speed: 0.0979s/iter; left time: 1923.9231s
	iters: 200, epoch: 12 | loss: 0.0204532
	speed: 0.0493s/iter; left time: 963.9546s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.31s
Steps: 222 | Train Loss: 0.0212971 Vali Loss: 0.0297991 Test Loss: 0.0413098
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0192091
	speed: 0.0949s/iter; left time: 1844.5210s
	iters: 200, epoch: 13 | loss: 0.0213485
	speed: 0.0501s/iter; left time: 968.8332s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.36s
Steps: 222 | Train Loss: 0.0212116 Vali Loss: 0.0300655 Test Loss: 0.0417966
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0204063
	speed: 0.0917s/iter; left time: 1762.2465s
	iters: 200, epoch: 14 | loss: 0.0211266
	speed: 0.0493s/iter; left time: 941.9815s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.40s
Steps: 222 | Train Loss: 0.0211267 Vali Loss: 0.0298509 Test Loss: 0.0411874
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0234450
	speed: 0.0951s/iter; left time: 1805.6532s
	iters: 200, epoch: 15 | loss: 0.0221137
	speed: 0.0495s/iter; left time: 935.5911s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.24s
Steps: 222 | Train Loss: 0.0210179 Vali Loss: 0.0296575 Test Loss: 0.0406219
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0207905
	speed: 0.0913s/iter; left time: 1713.8075s
	iters: 200, epoch: 16 | loss: 0.0185365
	speed: 0.0497s/iter; left time: 928.3932s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.30s
Steps: 222 | Train Loss: 0.0209206 Vali Loss: 0.0299610 Test Loss: 0.0415653
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0202313
	speed: 0.0898s/iter; left time: 1664.9106s
	iters: 200, epoch: 17 | loss: 0.0208116
	speed: 0.0511s/iter; left time: 942.5208s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.46s
Steps: 222 | Train Loss: 0.0208105 Vali Loss: 0.0303820 Test Loss: 0.0420282
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0221342
	speed: 0.0924s/iter; left time: 1694.0103s
	iters: 200, epoch: 18 | loss: 0.0200218
	speed: 0.0494s/iter; left time: 901.0935s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.33s
Steps: 222 | Train Loss: 0.0207714 Vali Loss: 0.0299171 Test Loss: 0.0420240
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0193397
	speed: 0.0903s/iter; left time: 1634.6046s
	iters: 200, epoch: 19 | loss: 0.0221446
	speed: 0.0499s/iter; left time: 898.2636s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.37s
Steps: 222 | Train Loss: 0.0206576 Vali Loss: 0.0299749 Test Loss: 0.0419878
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0193885
	speed: 0.0910s/iter; left time: 1626.8947s
	iters: 200, epoch: 20 | loss: 0.0205301
	speed: 0.0502s/iter; left time: 893.2843s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.36s
Steps: 222 | Train Loss: 0.0206312 Vali Loss: 0.0298362 Test Loss: 0.0417427
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0197740
	speed: 0.0917s/iter; left time: 1619.6744s
	iters: 200, epoch: 21 | loss: 0.0227434
	speed: 0.0507s/iter; left time: 890.4546s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.41s
Steps: 222 | Train Loss: 0.0206033 Vali Loss: 0.0300504 Test Loss: 0.0424300
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.040564022958278656, rmse:0.2014051228761673, mae:0.1430739164352417, rse:0.6964869499206543
Intermediate time for GB and pred_len 96: 00h:05m:08.04s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1281811
	speed: 0.0763s/iter; left time: 1686.8462s
	iters: 200, epoch: 1 | loss: 0.1206248
	speed: 0.0498s/iter; left time: 1096.5213s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.47s
Steps: 222 | Train Loss: 0.1323972 Vali Loss: 0.1000619 Test Loss: 0.1167016
Validation loss decreased (inf --> 0.100062).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0420797
	speed: 0.0914s/iter; left time: 1998.8544s
	iters: 200, epoch: 2 | loss: 0.0311064
	speed: 0.0495s/iter; left time: 1077.9152s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.0486551 Vali Loss: 0.0341354 Test Loss: 0.0488688
Validation loss decreased (0.100062 --> 0.034135).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0288977
	speed: 0.0959s/iter; left time: 2075.8970s
	iters: 200, epoch: 3 | loss: 0.0273455
	speed: 0.0494s/iter; left time: 1065.5569s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.25s
Steps: 222 | Train Loss: 0.0279936 Vali Loss: 0.0316944 Test Loss: 0.0481999
Validation loss decreased (0.034135 --> 0.031694).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0267540
	speed: 0.0914s/iter; left time: 1958.9806s
	iters: 200, epoch: 4 | loss: 0.0237245
	speed: 0.0497s/iter; left time: 1059.7725s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.33s
Steps: 222 | Train Loss: 0.0252568 Vali Loss: 0.0321467 Test Loss: 0.0511265
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0232651
	speed: 0.0917s/iter; left time: 1944.7708s
	iters: 200, epoch: 5 | loss: 0.0249807
	speed: 0.0501s/iter; left time: 1056.7997s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.26s
Steps: 222 | Train Loss: 0.0244643 Vali Loss: 0.0326758 Test Loss: 0.0522774
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0223662
	speed: 0.0910s/iter; left time: 1909.6339s
	iters: 200, epoch: 6 | loss: 0.0243166
	speed: 0.0494s/iter; left time: 1032.7791s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.30s
Steps: 222 | Train Loss: 0.0239696 Vali Loss: 0.0324708 Test Loss: 0.0497946
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0234233
	speed: 0.0883s/iter; left time: 1833.4758s
	iters: 200, epoch: 7 | loss: 0.0236040
	speed: 0.0498s/iter; left time: 1030.0115s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.43s
Steps: 222 | Train Loss: 0.0235794 Vali Loss: 0.0324006 Test Loss: 0.0479286
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0232106
	speed: 0.0965s/iter; left time: 1983.6651s
	iters: 200, epoch: 8 | loss: 0.0215790
	speed: 0.0506s/iter; left time: 1034.8418s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.44s
Steps: 222 | Train Loss: 0.0232308 Vali Loss: 0.0325789 Test Loss: 0.0474472
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0229674
	speed: 0.0908s/iter; left time: 1845.9255s
	iters: 200, epoch: 9 | loss: 0.0228480
	speed: 0.0516s/iter; left time: 1043.5017s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.53s
Steps: 222 | Train Loss: 0.0230120 Vali Loss: 0.0318836 Test Loss: 0.0453121
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0225253
	speed: 0.0954s/iter; left time: 1917.6663s
	iters: 200, epoch: 10 | loss: 0.0229859
	speed: 0.0499s/iter; left time: 997.7649s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.56s
Steps: 222 | Train Loss: 0.0228531 Vali Loss: 0.0317617 Test Loss: 0.0442896
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0240105
	speed: 0.0924s/iter; left time: 1837.1662s
	iters: 200, epoch: 11 | loss: 0.0231950
	speed: 0.0492s/iter; left time: 972.8934s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.33s
Steps: 222 | Train Loss: 0.0226830 Vali Loss: 0.0319622 Test Loss: 0.0452901
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0240522
	speed: 0.0930s/iter; left time: 1828.0749s
	iters: 200, epoch: 12 | loss: 0.0224349
	speed: 0.0509s/iter; left time: 996.3293s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.66s
Steps: 222 | Train Loss: 0.0225790 Vali Loss: 0.0319162 Test Loss: 0.0447830
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0210353
	speed: 0.0938s/iter; left time: 1822.4410s
	iters: 200, epoch: 13 | loss: 0.0226072
	speed: 0.0499s/iter; left time: 965.1226s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.51s
Steps: 222 | Train Loss: 0.0224231 Vali Loss: 0.0321067 Test Loss: 0.0451294
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.048199884593486786, rmse:0.21954472362995148, mae:0.15564729273319244, rse:0.7611930966377258
Intermediate time for GB and pred_len 168: 00h:03m:16.33s
Intermediate time for GB: 00h:14m:21.84s

=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1235685
	speed: 0.0390s/iter; left time: 868.9787s
	iters: 200, epoch: 1 | loss: 0.1166312
	speed: 0.0210s/iter; left time: 467.2693s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.60s
Steps: 224 | Train Loss: 0.1306442 Vali Loss: 0.0743393 Test Loss: 0.0910288
Validation loss decreased (inf --> 0.074339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0414139
	speed: 0.0446s/iter; left time: 984.8645s
	iters: 200, epoch: 2 | loss: 0.0266411
	speed: 0.0212s/iter; left time: 466.4558s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0490632 Vali Loss: 0.0170418 Test Loss: 0.0199101
Validation loss decreased (0.074339 --> 0.017042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0221347
	speed: 0.0448s/iter; left time: 978.7034s
	iters: 200, epoch: 3 | loss: 0.0209304
	speed: 0.0207s/iter; left time: 451.1952s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0225532 Vali Loss: 0.0141340 Test Loss: 0.0165208
Validation loss decreased (0.017042 --> 0.014134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0175069
	speed: 0.0459s/iter; left time: 992.7903s
	iters: 200, epoch: 4 | loss: 0.0180933
	speed: 0.0208s/iter; left time: 448.1361s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0189549 Vali Loss: 0.0126682 Test Loss: 0.0149519
Validation loss decreased (0.014134 --> 0.012668).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0158055
	speed: 0.0438s/iter; left time: 937.6032s
	iters: 200, epoch: 5 | loss: 0.0164286
	speed: 0.0230s/iter; left time: 489.4497s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0169486 Vali Loss: 0.0124042 Test Loss: 0.0145784
Validation loss decreased (0.012668 --> 0.012404).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0160598
	speed: 0.0498s/iter; left time: 1054.0352s
	iters: 200, epoch: 6 | loss: 0.0156461
	speed: 0.0211s/iter; left time: 445.7079s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0154126 Vali Loss: 0.0123237 Test Loss: 0.0142485
Validation loss decreased (0.012404 --> 0.012324).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0163689
	speed: 0.0448s/iter; left time: 939.4813s
	iters: 200, epoch: 7 | loss: 0.0149154
	speed: 0.0205s/iter; left time: 427.0370s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.90s
Steps: 224 | Train Loss: 0.0142636 Vali Loss: 0.0114231 Test Loss: 0.0135450
Validation loss decreased (0.012324 --> 0.011423).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0132940
	speed: 0.0455s/iter; left time: 943.5529s
	iters: 200, epoch: 8 | loss: 0.0116993
	speed: 0.0212s/iter; left time: 437.8071s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0130814 Vali Loss: 0.0109222 Test Loss: 0.0140578
Validation loss decreased (0.011423 --> 0.010922).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0113352
	speed: 0.0448s/iter; left time: 919.0434s
	iters: 200, epoch: 9 | loss: 0.0105395
	speed: 0.0209s/iter; left time: 425.7818s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0120762 Vali Loss: 0.0108338 Test Loss: 0.0172134
Validation loss decreased (0.010922 --> 0.010834).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0116649
	speed: 0.0455s/iter; left time: 922.6808s
	iters: 200, epoch: 10 | loss: 0.0099158
	speed: 0.0241s/iter; left time: 486.5839s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0114562 Vali Loss: 0.0104998 Test Loss: 0.0165373
Validation loss decreased (0.010834 --> 0.010500).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0113771
	speed: 0.0491s/iter; left time: 985.4491s
	iters: 200, epoch: 11 | loss: 0.0114219
	speed: 0.0204s/iter; left time: 406.2655s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0110821 Vali Loss: 0.0103820 Test Loss: 0.0219415
Validation loss decreased (0.010500 --> 0.010382).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0108638
	speed: 0.0437s/iter; left time: 866.4537s
	iters: 200, epoch: 12 | loss: 0.0102516
	speed: 0.0207s/iter; left time: 408.2405s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.87s
Steps: 224 | Train Loss: 0.0106935 Vali Loss: 0.0100026 Test Loss: 0.0214718
Validation loss decreased (0.010382 --> 0.010003).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0098957
	speed: 0.0440s/iter; left time: 863.6807s
	iters: 200, epoch: 13 | loss: 0.0092505
	speed: 0.0211s/iter; left time: 412.6698s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.95s
Steps: 224 | Train Loss: 0.0104717 Vali Loss: 0.0099261 Test Loss: 0.0182114
Validation loss decreased (0.010003 --> 0.009926).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0108826
	speed: 0.0465s/iter; left time: 900.9547s
	iters: 200, epoch: 14 | loss: 0.0088690
	speed: 0.0213s/iter; left time: 410.9291s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0102703 Vali Loss: 0.0098426 Test Loss: 0.0177606
Validation loss decreased (0.009926 --> 0.009843).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0105166
	speed: 0.0485s/iter; left time: 929.9886s
	iters: 200, epoch: 15 | loss: 0.0097342
	speed: 0.0236s/iter; left time: 450.5054s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.63s
Steps: 224 | Train Loss: 0.0101483 Vali Loss: 0.0098085 Test Loss: 0.0205569
Validation loss decreased (0.009843 --> 0.009809).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0087296
	speed: 0.0486s/iter; left time: 920.4659s
	iters: 200, epoch: 16 | loss: 0.0096730
	speed: 0.0205s/iter; left time: 386.9364s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.95s
Steps: 224 | Train Loss: 0.0101333 Vali Loss: 0.0097114 Test Loss: 0.0196735
Validation loss decreased (0.009809 --> 0.009711).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0108441
	speed: 0.0452s/iter; left time: 845.9819s
	iters: 200, epoch: 17 | loss: 0.0097255
	speed: 0.0209s/iter; left time: 388.8264s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0099599 Vali Loss: 0.0095411 Test Loss: 0.0179444
Validation loss decreased (0.009711 --> 0.009541).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0088029
	speed: 0.0469s/iter; left time: 867.0468s
	iters: 200, epoch: 18 | loss: 0.0095050
	speed: 0.0204s/iter; left time: 376.0770s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0098107 Vali Loss: 0.0095047 Test Loss: 0.0188733
Validation loss decreased (0.009541 --> 0.009505).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0096069
	speed: 0.0449s/iter; left time: 820.5002s
	iters: 200, epoch: 19 | loss: 0.0100707
	speed: 0.0206s/iter; left time: 374.7365s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0097356 Vali Loss: 0.0095299 Test Loss: 0.0189880
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0096012
	speed: 0.0479s/iter; left time: 864.6471s
	iters: 200, epoch: 20 | loss: 0.0103081
	speed: 0.0241s/iter; left time: 431.9204s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.54s
Steps: 224 | Train Loss: 0.0096700 Vali Loss: 0.0094713 Test Loss: 0.0193751
Validation loss decreased (0.009505 --> 0.009471).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0099798
	speed: 0.0468s/iter; left time: 834.6476s
	iters: 200, epoch: 21 | loss: 0.0106904
	speed: 0.0208s/iter; left time: 368.2852s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0096355 Vali Loss: 0.0094038 Test Loss: 0.0190703
Validation loss decreased (0.009471 --> 0.009404).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0098239
	speed: 0.0452s/iter; left time: 795.9743s
	iters: 200, epoch: 22 | loss: 0.0093015
	speed: 0.0207s/iter; left time: 362.5382s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.95s
Steps: 224 | Train Loss: 0.0095963 Vali Loss: 0.0094222 Test Loss: 0.0179196
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0091338
	speed: 0.0464s/iter; left time: 805.9490s
	iters: 200, epoch: 23 | loss: 0.0098065
	speed: 0.0209s/iter; left time: 360.8202s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0095129 Vali Loss: 0.0092669 Test Loss: 0.0183864
Validation loss decreased (0.009404 --> 0.009267).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0093905
	speed: 0.0456s/iter; left time: 782.6386s
	iters: 200, epoch: 24 | loss: 0.0102782
	speed: 0.0209s/iter; left time: 355.8069s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0095316 Vali Loss: 0.0093195 Test Loss: 0.0209839
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0104343
	speed: 0.0585s/iter; left time: 989.4332s
	iters: 200, epoch: 25 | loss: 0.0088957
	speed: 0.0229s/iter; left time: 385.1195s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.56s
Steps: 224 | Train Loss: 0.0094462 Vali Loss: 0.0092798 Test Loss: 0.0181019
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0092811
	speed: 0.0439s/iter; left time: 732.5904s
	iters: 200, epoch: 26 | loss: 0.0094501
	speed: 0.0208s/iter; left time: 345.7400s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.87s
Steps: 224 | Train Loss: 0.0096182 Vali Loss: 0.0094344 Test Loss: 0.0172716
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0091324
	speed: 0.0433s/iter; left time: 714.1331s
	iters: 200, epoch: 27 | loss: 0.0106261
	speed: 0.0213s/iter; left time: 349.0559s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0094139 Vali Loss: 0.0092859 Test Loss: 0.0192018
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0077775
	speed: 0.0488s/iter; left time: 792.9774s
	iters: 200, epoch: 28 | loss: 0.0089043
	speed: 0.0215s/iter; left time: 346.5681s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0093605 Vali Loss: 0.0092553 Test Loss: 0.0188021
Validation loss decreased (0.009267 --> 0.009255).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0087630
	speed: 0.0510s/iter; left time: 816.9954s
	iters: 200, epoch: 29 | loss: 0.0096931
	speed: 0.0219s/iter; left time: 348.2522s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0093333 Vali Loss: 0.0091649 Test Loss: 0.0186937
Validation loss decreased (0.009255 --> 0.009165).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0092893
	speed: 0.0516s/iter; left time: 814.9851s
	iters: 200, epoch: 30 | loss: 0.0085216
	speed: 0.0221s/iter; left time: 347.7434s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0094238 Vali Loss: 0.0093011 Test Loss: 0.0215952
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0095737
	speed: 0.0485s/iter; left time: 755.2774s
	iters: 200, epoch: 31 | loss: 0.0114639
	speed: 0.0237s/iter; left time: 366.7788s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0093481 Vali Loss: 0.0091937 Test Loss: 0.0199297
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0099808
	speed: 0.0479s/iter; left time: 735.4189s
	iters: 200, epoch: 32 | loss: 0.0079586
	speed: 0.0247s/iter; left time: 376.7539s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.59s
Steps: 224 | Train Loss: 0.0092504 Vali Loss: 0.0091131 Test Loss: 0.0179925
Validation loss decreased (0.009165 --> 0.009113).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0097558
	speed: 0.0504s/iter; left time: 763.0779s
	iters: 200, epoch: 33 | loss: 0.0094637
	speed: 0.0218s/iter; left time: 327.5777s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0092967 Vali Loss: 0.0091046 Test Loss: 0.0196414
Validation loss decreased (0.009113 --> 0.009105).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0093406
	speed: 0.0515s/iter; left time: 767.4945s
	iters: 200, epoch: 34 | loss: 0.0088018
	speed: 0.0218s/iter; left time: 322.7226s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0092845 Vali Loss: 0.0091666 Test Loss: 0.0193905
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0092743
	speed: 0.0504s/iter; left time: 739.9328s
	iters: 200, epoch: 35 | loss: 0.0083632
	speed: 0.0214s/iter; left time: 312.4219s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0092069 Vali Loss: 0.0090927 Test Loss: 0.0179031
Validation loss decreased (0.009105 --> 0.009093).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0098525
	speed: 0.0501s/iter; left time: 724.4961s
	iters: 200, epoch: 36 | loss: 0.0083036
	speed: 0.0245s/iter; left time: 351.4289s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.58s
Steps: 224 | Train Loss: 0.0092492 Vali Loss: 0.0090937 Test Loss: 0.0208244
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0083163
	speed: 0.0496s/iter; left time: 706.3787s
	iters: 200, epoch: 37 | loss: 0.0091936
	speed: 0.0246s/iter; left time: 347.6624s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.58s
Steps: 224 | Train Loss: 0.0092016 Vali Loss: 0.0090485 Test Loss: 0.0183503
Validation loss decreased (0.009093 --> 0.009049).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0080988
	speed: 0.0480s/iter; left time: 672.8010s
	iters: 200, epoch: 38 | loss: 0.0095375
	speed: 0.0217s/iter; left time: 301.6484s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0092376 Vali Loss: 0.0091220 Test Loss: 0.0189542
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0091136
	speed: 0.0507s/iter; left time: 699.1222s
	iters: 200, epoch: 39 | loss: 0.0088850
	speed: 0.0231s/iter; left time: 316.0700s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0092021 Vali Loss: 0.0090822 Test Loss: 0.0201605
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0085782
	speed: 0.0523s/iter; left time: 710.1104s
	iters: 200, epoch: 40 | loss: 0.0086339
	speed: 0.0218s/iter; left time: 293.8584s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0091749 Vali Loss: 0.0090968 Test Loss: 0.0189611
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0097929
	speed: 0.0514s/iter; left time: 685.7722s
	iters: 200, epoch: 41 | loss: 0.0088069
	speed: 0.0251s/iter; left time: 332.6106s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.65s
Steps: 224 | Train Loss: 0.0091887 Vali Loss: 0.0091413 Test Loss: 0.0185922
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0104537
	speed: 0.0476s/iter; left time: 624.0175s
	iters: 200, epoch: 42 | loss: 0.0085751
	speed: 0.0237s/iter; left time: 308.5987s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.44s
Steps: 224 | Train Loss: 0.0092292 Vali Loss: 0.0091321 Test Loss: 0.0179263
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0089744
	speed: 0.0499s/iter; left time: 642.7301s
	iters: 200, epoch: 43 | loss: 0.0091920
	speed: 0.0238s/iter; left time: 303.9073s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.40s
Steps: 224 | Train Loss: 0.0092599 Vali Loss: 0.0091090 Test Loss: 0.0174770
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0096402
	speed: 0.0519s/iter; left time: 657.3166s
	iters: 200, epoch: 44 | loss: 0.0095632
	speed: 0.0208s/iter; left time: 260.8448s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0092053 Vali Loss: 0.0091317 Test Loss: 0.0196726
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0099961
	speed: 0.0459s/iter; left time: 570.8017s
	iters: 200, epoch: 45 | loss: 0.0104771
	speed: 0.0202s/iter; left time: 249.3631s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0092551 Vali Loss: 0.0091076 Test Loss: 0.0179130
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0084438
	speed: 0.0508s/iter; left time: 620.7413s
	iters: 200, epoch: 46 | loss: 0.0094436
	speed: 0.0215s/iter; left time: 260.1835s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0091619 Vali Loss: 0.0090871 Test Loss: 0.0172821
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0097950
	speed: 0.0594s/iter; left time: 712.9968s
	iters: 200, epoch: 47 | loss: 0.0084180
	speed: 0.0206s/iter; left time: 245.3597s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0091385 Vali Loss: 0.0091280 Test Loss: 0.0175781
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01835033856332302, rmse:0.1354634165763855, mae:0.08412059396505356, rse:0.39865246415138245
Intermediate time for ES and pred_len 24: 00h:05m:37.05s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1243099
	speed: 0.0408s/iter; left time: 909.8857s
	iters: 200, epoch: 1 | loss: 0.1112777
	speed: 0.0269s/iter; left time: 596.4748s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.1304680 Vali Loss: 0.0749759 Test Loss: 0.0934199
Validation loss decreased (inf --> 0.074976).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0422750
	speed: 0.0489s/iter; left time: 1080.3395s
	iters: 200, epoch: 2 | loss: 0.0295403
	speed: 0.0228s/iter; left time: 500.0161s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.75s
Steps: 224 | Train Loss: 0.0484345 Vali Loss: 0.0234643 Test Loss: 0.0291021
Validation loss decreased (0.074976 --> 0.023464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0261098
	speed: 0.0590s/iter; left time: 1290.1647s
	iters: 200, epoch: 3 | loss: 0.0251757
	speed: 0.0210s/iter; left time: 456.4315s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0267445 Vali Loss: 0.0204402 Test Loss: 0.0251841
Validation loss decreased (0.023464 --> 0.020440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0220553
	speed: 0.0576s/iter; left time: 1246.2445s
	iters: 200, epoch: 4 | loss: 0.0216708
	speed: 0.0215s/iter; left time: 462.3749s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.03s
Steps: 224 | Train Loss: 0.0230021 Vali Loss: 0.0190462 Test Loss: 0.0245052
Validation loss decreased (0.020440 --> 0.019046).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0207762
	speed: 0.0516s/iter; left time: 1103.9211s
	iters: 200, epoch: 5 | loss: 0.0181857
	speed: 0.0282s/iter; left time: 601.4712s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.04s
Steps: 224 | Train Loss: 0.0199932 Vali Loss: 0.0178145 Test Loss: 0.0349214
Validation loss decreased (0.019046 --> 0.017814).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0178383
	speed: 0.0516s/iter; left time: 1092.2344s
	iters: 200, epoch: 6 | loss: 0.0184396
	speed: 0.0259s/iter; left time: 546.8263s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.05s
Steps: 224 | Train Loss: 0.0179342 Vali Loss: 0.0170949 Test Loss: 0.0270423
Validation loss decreased (0.017814 --> 0.017095).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0178106
	speed: 0.0560s/iter; left time: 1172.8880s
	iters: 200, epoch: 7 | loss: 0.0158232
	speed: 0.0219s/iter; left time: 456.0232s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0169621 Vali Loss: 0.0164534 Test Loss: 0.0254716
Validation loss decreased (0.017095 --> 0.016453).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0172422
	speed: 0.0583s/iter; left time: 1208.9053s
	iters: 200, epoch: 8 | loss: 0.0163265
	speed: 0.0217s/iter; left time: 447.1165s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.95s
Steps: 224 | Train Loss: 0.0164334 Vali Loss: 0.0159479 Test Loss: 0.0251510
Validation loss decreased (0.016453 --> 0.015948).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0159623
	speed: 0.0501s/iter; left time: 1026.6598s
	iters: 200, epoch: 9 | loss: 0.0149368
	speed: 0.0284s/iter; left time: 579.1308s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.91s
Steps: 224 | Train Loss: 0.0161261 Vali Loss: 0.0157977 Test Loss: 0.0278607
Validation loss decreased (0.015948 --> 0.015798).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0162833
	speed: 0.0500s/iter; left time: 1014.1826s
	iters: 200, epoch: 10 | loss: 0.0167888
	speed: 0.0237s/iter; left time: 479.2145s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.65s
Steps: 224 | Train Loss: 0.0157125 Vali Loss: 0.0157265 Test Loss: 0.0291120
Validation loss decreased (0.015798 --> 0.015727).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0157385
	speed: 0.0579s/iter; left time: 1161.2911s
	iters: 200, epoch: 11 | loss: 0.0161697
	speed: 0.0217s/iter; left time: 432.5084s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0155772 Vali Loss: 0.0154291 Test Loss: 0.0283270
Validation loss decreased (0.015727 --> 0.015429).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0157377
	speed: 0.0561s/iter; left time: 1113.0318s
	iters: 200, epoch: 12 | loss: 0.0161220
	speed: 0.0223s/iter; left time: 439.3078s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.88s
Steps: 224 | Train Loss: 0.0153947 Vali Loss: 0.0155128 Test Loss: 0.0267294
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0145680
	speed: 0.0482s/iter; left time: 945.9392s
	iters: 200, epoch: 13 | loss: 0.0151161
	speed: 0.0303s/iter; left time: 591.0740s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.05s
Steps: 224 | Train Loss: 0.0152482 Vali Loss: 0.0152456 Test Loss: 0.0313342
Validation loss decreased (0.015429 --> 0.015246).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0144295
	speed: 0.0499s/iter; left time: 966.7032s
	iters: 200, epoch: 14 | loss: 0.0149595
	speed: 0.0218s/iter; left time: 420.8543s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0156610 Vali Loss: 0.0153661 Test Loss: 0.0282838
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0138063
	speed: 0.0495s/iter; left time: 949.3575s
	iters: 200, epoch: 15 | loss: 0.0160840
	speed: 0.0220s/iter; left time: 418.8333s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0153227 Vali Loss: 0.0163661 Test Loss: 0.0256972
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0147027
	speed: 0.0573s/iter; left time: 1084.7788s
	iters: 200, epoch: 16 | loss: 0.0159377
	speed: 0.0230s/iter; left time: 432.9811s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0152654 Vali Loss: 0.0152266 Test Loss: 0.0313957
Validation loss decreased (0.015246 --> 0.015227).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0147857
	speed: 0.0495s/iter; left time: 926.3405s
	iters: 200, epoch: 17 | loss: 0.0158567
	speed: 0.0276s/iter; left time: 513.0748s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.96s
Steps: 224 | Train Loss: 0.0149680 Vali Loss: 0.0152546 Test Loss: 0.0288141
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0150313
	speed: 0.0534s/iter; left time: 987.7152s
	iters: 200, epoch: 18 | loss: 0.0153670
	speed: 0.0217s/iter; left time: 398.4083s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0148922 Vali Loss: 0.0151359 Test Loss: 0.0352062
Validation loss decreased (0.015227 --> 0.015136).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0152953
	speed: 0.0577s/iter; left time: 1054.6472s
	iters: 200, epoch: 19 | loss: 0.0164243
	speed: 0.0208s/iter; left time: 378.7296s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.68s
Steps: 224 | Train Loss: 0.0154202 Vali Loss: 0.0154077 Test Loss: 0.0260406
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0139980
	speed: 0.0535s/iter; left time: 965.1725s
	iters: 200, epoch: 20 | loss: 0.0153673
	speed: 0.0294s/iter; left time: 527.0029s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.41s
Steps: 224 | Train Loss: 0.0148775 Vali Loss: 0.0150819 Test Loss: 0.0291436
Validation loss decreased (0.015136 --> 0.015082).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0152630
	speed: 0.0539s/iter; left time: 960.7991s
	iters: 200, epoch: 21 | loss: 0.0139147
	speed: 0.0249s/iter; left time: 441.7064s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0147524 Vali Loss: 0.0150175 Test Loss: 0.0302568
Validation loss decreased (0.015082 --> 0.015018).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0152948
	speed: 0.0604s/iter; left time: 1063.5700s
	iters: 200, epoch: 22 | loss: 0.0151246
	speed: 0.0221s/iter; left time: 386.3076s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0147291 Vali Loss: 0.0150637 Test Loss: 0.0294112
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0138211
	speed: 0.0629s/iter; left time: 1092.2086s
	iters: 200, epoch: 23 | loss: 0.0160007
	speed: 0.0218s/iter; left time: 377.1996s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.51s
Steps: 224 | Train Loss: 0.0146824 Vali Loss: 0.0149438 Test Loss: 0.0299825
Validation loss decreased (0.015018 --> 0.014944).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0137403
	speed: 0.0496s/iter; left time: 851.4460s
	iters: 200, epoch: 24 | loss: 0.0137934
	speed: 0.0311s/iter; left time: 529.4937s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0146960 Vali Loss: 0.0149939 Test Loss: 0.0284647
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0147044
	speed: 0.0503s/iter; left time: 851.2193s
	iters: 200, epoch: 25 | loss: 0.0162568
	speed: 0.0231s/iter; left time: 388.5475s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.0146439 Vali Loss: 0.0149701 Test Loss: 0.0297256
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0135267
	speed: 0.0602s/iter; left time: 1005.8288s
	iters: 200, epoch: 26 | loss: 0.0140600
	speed: 0.0210s/iter; left time: 348.9544s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0146344 Vali Loss: 0.0149647 Test Loss: 0.0292373
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0148893
	speed: 0.0540s/iter; left time: 890.1667s
	iters: 200, epoch: 27 | loss: 0.0141754
	speed: 0.0248s/iter; left time: 406.3985s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0145488 Vali Loss: 0.0149350 Test Loss: 0.0312378
Validation loss decreased (0.014944 --> 0.014935).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0155144
	speed: 0.0496s/iter; left time: 805.6401s
	iters: 200, epoch: 28 | loss: 0.0170834
	speed: 0.0262s/iter; left time: 423.5397s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.81s
Steps: 224 | Train Loss: 0.0145691 Vali Loss: 0.0149834 Test Loss: 0.0311552
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0156587
	speed: 0.0500s/iter; left time: 801.7907s
	iters: 200, epoch: 29 | loss: 0.0152508
	speed: 0.0218s/iter; left time: 346.8408s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0145267 Vali Loss: 0.0149104 Test Loss: 0.0324814
Validation loss decreased (0.014935 --> 0.014910).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0140890
	speed: 0.0583s/iter; left time: 921.2751s
	iters: 200, epoch: 30 | loss: 0.0135267
	speed: 0.0219s/iter; left time: 344.6854s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.95s
Steps: 224 | Train Loss: 0.0145276 Vali Loss: 0.0149391 Test Loss: 0.0319644
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0140089
	speed: 0.0494s/iter; left time: 769.8832s
	iters: 200, epoch: 31 | loss: 0.0148899
	speed: 0.0288s/iter; left time: 446.1483s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0144888 Vali Loss: 0.0148844 Test Loss: 0.0310164
Validation loss decreased (0.014910 --> 0.014884).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0149111
	speed: 0.0499s/iter; left time: 766.1411s
	iters: 200, epoch: 32 | loss: 0.0149692
	speed: 0.0212s/iter; left time: 323.2594s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0145123 Vali Loss: 0.0149362 Test Loss: 0.0324887
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0149417
	speed: 0.0498s/iter; left time: 753.7339s
	iters: 200, epoch: 33 | loss: 0.0151715
	speed: 0.0259s/iter; left time: 389.3683s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.87s
Steps: 224 | Train Loss: 0.0145124 Vali Loss: 0.0149080 Test Loss: 0.0316317
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0130034
	speed: 0.0498s/iter; left time: 743.0850s
	iters: 200, epoch: 34 | loss: 0.0153687
	speed: 0.0242s/iter; left time: 358.3881s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.66s
Steps: 224 | Train Loss: 0.0144306 Vali Loss: 0.0149091 Test Loss: 0.0325113
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0147780
	speed: 0.0527s/iter; left time: 773.5512s
	iters: 200, epoch: 35 | loss: 0.0155870
	speed: 0.0241s/iter; left time: 350.8509s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.83s
Steps: 224 | Train Loss: 0.0145847 Vali Loss: 0.0149064 Test Loss: 0.0315548
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0142555
	speed: 0.0543s/iter; left time: 784.7606s
	iters: 200, epoch: 36 | loss: 0.0138206
	speed: 0.0223s/iter; left time: 320.6794s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.85s
Steps: 224 | Train Loss: 0.0145906 Vali Loss: 0.0149479 Test Loss: 0.0295329
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0151577
	speed: 0.0573s/iter; left time: 815.2827s
	iters: 200, epoch: 37 | loss: 0.0137488
	speed: 0.0237s/iter; left time: 334.9976s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0144642 Vali Loss: 0.0148912 Test Loss: 0.0300454
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0134963
	speed: 0.0567s/iter; left time: 794.7362s
	iters: 200, epoch: 38 | loss: 0.0137275
	speed: 0.0229s/iter; left time: 318.1253s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.98s
Steps: 224 | Train Loss: 0.0147023 Vali Loss: 0.0149361 Test Loss: 0.0297693
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0135200
	speed: 0.0570s/iter; left time: 786.6198s
	iters: 200, epoch: 39 | loss: 0.0149992
	speed: 0.0232s/iter; left time: 317.8585s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0145202 Vali Loss: 0.0149646 Test Loss: 0.0300370
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0150121
	speed: 0.0539s/iter; left time: 730.6786s
	iters: 200, epoch: 40 | loss: 0.0140267
	speed: 0.0219s/iter; left time: 295.2207s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.64s
Steps: 224 | Train Loss: 0.0145302 Vali Loss: 0.0149335 Test Loss: 0.0295037
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0145172
	speed: 0.0535s/iter; left time: 714.4068s
	iters: 200, epoch: 41 | loss: 0.0145294
	speed: 0.0255s/iter; left time: 337.3747s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.74s
Steps: 224 | Train Loss: 0.0144130 Vali Loss: 0.0149308 Test Loss: 0.0298137
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.031016401946544647, rmse:0.1761147379875183, mae:0.11428863555192947, rse:0.5173721313476562
Intermediate time for ES and pred_len 96: 00h:05m:26.67s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1284169
	speed: 0.0524s/iter; left time: 1163.3076s
	iters: 200, epoch: 1 | loss: 0.1172287
	speed: 0.0246s/iter; left time: 544.2204s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.96s
Steps: 223 | Train Loss: 0.1315195 Vali Loss: 0.0755308 Test Loss: 0.0935711
Validation loss decreased (inf --> 0.075531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0394520
	speed: 0.0530s/iter; left time: 1164.6696s
	iters: 200, epoch: 2 | loss: 0.0300034
	speed: 0.0277s/iter; left time: 606.4663s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0483511 Vali Loss: 0.0254592 Test Loss: 0.0312638
Validation loss decreased (0.075531 --> 0.025459).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0298315
	speed: 0.0561s/iter; left time: 1221.3866s
	iters: 200, epoch: 3 | loss: 0.0257679
	speed: 0.0241s/iter; left time: 522.1400s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.03s
Steps: 223 | Train Loss: 0.0275876 Vali Loss: 0.0222081 Test Loss: 0.0273541
Validation loss decreased (0.025459 --> 0.022208).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0234629
	speed: 0.0582s/iter; left time: 1252.6069s
	iters: 200, epoch: 4 | loss: 0.0214712
	speed: 0.0207s/iter; left time: 443.4441s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.00s
Steps: 223 | Train Loss: 0.0232781 Vali Loss: 0.0205097 Test Loss: 0.0334549
Validation loss decreased (0.022208 --> 0.020510).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0214271
	speed: 0.0517s/iter; left time: 1102.6461s
	iters: 200, epoch: 5 | loss: 0.0183603
	speed: 0.0248s/iter; left time: 526.3614s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.78s
Steps: 223 | Train Loss: 0.0199682 Vali Loss: 0.0189914 Test Loss: 0.0321025
Validation loss decreased (0.020510 --> 0.018991).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0175757
	speed: 0.0596s/iter; left time: 1256.9485s
	iters: 200, epoch: 6 | loss: 0.0184193
	speed: 0.0235s/iter; left time: 492.5546s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.02s
Steps: 223 | Train Loss: 0.0184786 Vali Loss: 0.0183154 Test Loss: 0.0325361
Validation loss decreased (0.018991 --> 0.018315).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0176433
	speed: 0.0559s/iter; left time: 1166.0189s
	iters: 200, epoch: 7 | loss: 0.0172115
	speed: 0.0265s/iter; left time: 549.2930s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0178102 Vali Loss: 0.0178938 Test Loss: 0.0310357
Validation loss decreased (0.018315 --> 0.017894).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0161289
	speed: 0.0564s/iter; left time: 1165.1145s
	iters: 200, epoch: 8 | loss: 0.0173672
	speed: 0.0304s/iter; left time: 624.1347s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0174180 Vali Loss: 0.0177719 Test Loss: 0.0310839
Validation loss decreased (0.017894 --> 0.017772).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0172031
	speed: 0.0568s/iter; left time: 1159.1500s
	iters: 200, epoch: 9 | loss: 0.0161021
	speed: 0.0246s/iter; left time: 500.3097s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0170769 Vali Loss: 0.0179210 Test Loss: 0.0304198
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0170793
	speed: 0.0587s/iter; left time: 1186.3701s
	iters: 200, epoch: 10 | loss: 0.0183556
	speed: 0.0241s/iter; left time: 484.8811s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.0170377 Vali Loss: 0.0174098 Test Loss: 0.0347562
Validation loss decreased (0.017772 --> 0.017410).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0170728
	speed: 0.0588s/iter; left time: 1173.3801s
	iters: 200, epoch: 11 | loss: 0.0171281
	speed: 0.0233s/iter; left time: 462.4850s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.24s
Steps: 223 | Train Loss: 0.0183533 Vali Loss: 0.0177499 Test Loss: 0.0281153
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0142452
	speed: 0.0619s/iter; left time: 1222.7719s
	iters: 200, epoch: 12 | loss: 0.0168665
	speed: 0.0284s/iter; left time: 558.0180s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0166846 Vali Loss: 0.0173330 Test Loss: 0.0298354
Validation loss decreased (0.017410 --> 0.017333).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0161570
	speed: 0.0564s/iter; left time: 1101.0648s
	iters: 200, epoch: 13 | loss: 0.0165948
	speed: 0.0299s/iter; left time: 581.4689s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.50s
Steps: 223 | Train Loss: 0.0166812 Vali Loss: 0.0173812 Test Loss: 0.0305343
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0160646
	speed: 0.0580s/iter; left time: 1120.3349s
	iters: 200, epoch: 14 | loss: 0.0174675
	speed: 0.0300s/iter; left time: 575.3751s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.64s
Steps: 223 | Train Loss: 0.0164507 Vali Loss: 0.0174721 Test Loss: 0.0310623
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0159258
	speed: 0.0585s/iter; left time: 1115.2378s
	iters: 200, epoch: 15 | loss: 0.0180293
	speed: 0.0224s/iter; left time: 424.5677s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.10s
Steps: 223 | Train Loss: 0.0163814 Vali Loss: 0.0171970 Test Loss: 0.0328074
Validation loss decreased (0.017333 --> 0.017197).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0171973
	speed: 0.0501s/iter; left time: 944.4440s
	iters: 200, epoch: 16 | loss: 0.0169949
	speed: 0.0218s/iter; left time: 408.5448s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0166250 Vali Loss: 0.0173631 Test Loss: 0.0302975
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0154431
	speed: 0.0539s/iter; left time: 1005.0651s
	iters: 200, epoch: 17 | loss: 0.0158963
	speed: 0.0213s/iter; left time: 394.8036s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.66s
Steps: 223 | Train Loss: 0.0163361 Vali Loss: 0.0173100 Test Loss: 0.0320395
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0158747
	speed: 0.0562s/iter; left time: 1034.8290s
	iters: 200, epoch: 18 | loss: 0.0172246
	speed: 0.0217s/iter; left time: 396.5335s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.78s
Steps: 223 | Train Loss: 0.0162627 Vali Loss: 0.0172289 Test Loss: 0.0336265
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0153920
	speed: 0.0572s/iter; left time: 1039.5450s
	iters: 200, epoch: 19 | loss: 0.0159192
	speed: 0.0217s/iter; left time: 393.0789s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.92s
Steps: 223 | Train Loss: 0.0161746 Vali Loss: 0.0171079 Test Loss: 0.0315786
Validation loss decreased (0.017197 --> 0.017108).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0172178
	speed: 0.0557s/iter; left time: 1001.4507s
	iters: 200, epoch: 20 | loss: 0.0154738
	speed: 0.0216s/iter; left time: 385.1928s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.81s
Steps: 223 | Train Loss: 0.0162445 Vali Loss: 0.0171308 Test Loss: 0.0327551
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0156633
	speed: 0.0563s/iter; left time: 998.0374s
	iters: 200, epoch: 21 | loss: 0.0158444
	speed: 0.0223s/iter; left time: 392.8931s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.97s
Steps: 223 | Train Loss: 0.0161826 Vali Loss: 0.0171602 Test Loss: 0.0327335
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0160388
	speed: 0.0589s/iter; left time: 1030.9458s
	iters: 200, epoch: 22 | loss: 0.0170065
	speed: 0.0209s/iter; left time: 364.5106s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.37s
Steps: 223 | Train Loss: 0.0160776 Vali Loss: 0.0170937 Test Loss: 0.0331659
Validation loss decreased (0.017108 --> 0.017094).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0147220
	speed: 0.0566s/iter; left time: 979.3674s
	iters: 200, epoch: 23 | loss: 0.0174204
	speed: 0.0218s/iter; left time: 374.5212s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0160284 Vali Loss: 0.0170745 Test Loss: 0.0332947
Validation loss decreased (0.017094 --> 0.017074).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0157670
	speed: 0.0562s/iter; left time: 958.7489s
	iters: 200, epoch: 24 | loss: 0.0147003
	speed: 0.0212s/iter; left time: 359.3181s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0159721 Vali Loss: 0.0169896 Test Loss: 0.0325431
Validation loss decreased (0.017074 --> 0.016990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0167779
	speed: 0.0568s/iter; left time: 957.3935s
	iters: 200, epoch: 25 | loss: 0.0158870
	speed: 0.0217s/iter; left time: 363.2943s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.29s
Steps: 223 | Train Loss: 0.0160009 Vali Loss: 0.0169696 Test Loss: 0.0342427
Validation loss decreased (0.016990 --> 0.016970).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0182935
	speed: 0.0596s/iter; left time: 990.8976s
	iters: 200, epoch: 26 | loss: 0.0152293
	speed: 0.0222s/iter; left time: 366.3654s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.36s
Steps: 223 | Train Loss: 0.0159626 Vali Loss: 0.0170733 Test Loss: 0.0365577
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0150043
	speed: 0.0633s/iter; left time: 1037.6241s
	iters: 200, epoch: 27 | loss: 0.0167594
	speed: 0.0218s/iter; left time: 355.8895s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.37s
Steps: 223 | Train Loss: 0.0158955 Vali Loss: 0.0169665 Test Loss: 0.0339735
Validation loss decreased (0.016970 --> 0.016967).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0150428
	speed: 0.0610s/iter; left time: 987.0886s
	iters: 200, epoch: 28 | loss: 0.0171211
	speed: 0.0215s/iter; left time: 346.4888s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0160956 Vali Loss: 0.0170350 Test Loss: 0.0318645
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0164731
	speed: 0.0489s/iter; left time: 780.6280s
	iters: 200, epoch: 29 | loss: 0.0175466
	speed: 0.0242s/iter; left time: 383.6763s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.57s
Steps: 223 | Train Loss: 0.0159007 Vali Loss: 0.0170863 Test Loss: 0.0330290
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0160695
	speed: 0.0539s/iter; left time: 847.6881s
	iters: 200, epoch: 30 | loss: 0.0164711
	speed: 0.0228s/iter; left time: 356.8785s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.73s
Steps: 223 | Train Loss: 0.0158933 Vali Loss: 0.0171437 Test Loss: 0.0331343
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0156804
	speed: 0.0567s/iter; left time: 878.9248s
	iters: 200, epoch: 31 | loss: 0.0155068
	speed: 0.0244s/iter; left time: 376.6577s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.78s
Steps: 223 | Train Loss: 0.0158197 Vali Loss: 0.0170106 Test Loss: 0.0339011
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0151057
	speed: 0.0530s/iter; left time: 810.8884s
	iters: 200, epoch: 32 | loss: 0.0165237
	speed: 0.0235s/iter; left time: 356.7748s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.60s
Steps: 223 | Train Loss: 0.0159418 Vali Loss: 0.0170865 Test Loss: 0.0326944
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0154904
	speed: 0.0533s/iter; left time: 803.4754s
	iters: 200, epoch: 33 | loss: 0.0160965
	speed: 0.0235s/iter; left time: 351.4242s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.63s
Steps: 223 | Train Loss: 0.0159461 Vali Loss: 0.0170641 Test Loss: 0.0318416
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0153600
	speed: 0.0536s/iter; left time: 796.0348s
	iters: 200, epoch: 34 | loss: 0.0170636
	speed: 0.0245s/iter; left time: 361.6019s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.63s
Steps: 223 | Train Loss: 0.0158354 Vali Loss: 0.0170254 Test Loss: 0.0326165
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0164788
	speed: 0.0520s/iter; left time: 760.6979s
	iters: 200, epoch: 35 | loss: 0.0158054
	speed: 0.0263s/iter; left time: 381.6591s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.82s
Steps: 223 | Train Loss: 0.0158333 Vali Loss: 0.0169850 Test Loss: 0.0334912
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0153885
	speed: 0.0530s/iter; left time: 762.3483s
	iters: 200, epoch: 36 | loss: 0.0159685
	speed: 0.0277s/iter; left time: 396.3024s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.04s
Steps: 223 | Train Loss: 0.0157919 Vali Loss: 0.0170162 Test Loss: 0.0343361
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0170595
	speed: 0.0532s/iter; left time: 753.4112s
	iters: 200, epoch: 37 | loss: 0.0156103
	speed: 0.0273s/iter; left time: 384.6836s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.23s
Steps: 223 | Train Loss: 0.0157774 Vali Loss: 0.0169519 Test Loss: 0.0330856
Validation loss decreased (0.016967 --> 0.016952).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0175597
	speed: 0.0543s/iter; left time: 757.3635s
	iters: 200, epoch: 38 | loss: 0.0155797
	speed: 0.0234s/iter; left time: 324.2870s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.82s
Steps: 223 | Train Loss: 0.0158271 Vali Loss: 0.0170436 Test Loss: 0.0333813
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0153492
	speed: 0.0539s/iter; left time: 739.9745s
	iters: 200, epoch: 39 | loss: 0.0160599
	speed: 0.0229s/iter; left time: 311.8109s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.82s
Steps: 223 | Train Loss: 0.0157613 Vali Loss: 0.0169965 Test Loss: 0.0336042
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0156489
	speed: 0.0547s/iter; left time: 739.1188s
	iters: 200, epoch: 40 | loss: 0.0156041
	speed: 0.0253s/iter; left time: 339.7186s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0159860 Vali Loss: 0.0170430 Test Loss: 0.0325757
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0168099
	speed: 0.0561s/iter; left time: 745.1231s
	iters: 200, epoch: 41 | loss: 0.0156008
	speed: 0.0256s/iter; left time: 337.2177s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.93s
Steps: 223 | Train Loss: 0.0157786 Vali Loss: 0.0170154 Test Loss: 0.0328521
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0149853
	speed: 0.0556s/iter; left time: 725.7657s
	iters: 200, epoch: 42 | loss: 0.0156122
	speed: 0.0287s/iter; left time: 372.3287s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0157521 Vali Loss: 0.0169720 Test Loss: 0.0328154
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0155255
	speed: 0.0493s/iter; left time: 632.3585s
	iters: 200, epoch: 43 | loss: 0.0152470
	speed: 0.0222s/iter; left time: 282.1869s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0157695 Vali Loss: 0.0169560 Test Loss: 0.0332695
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0151010
	speed: 0.0468s/iter; left time: 589.7841s
	iters: 200, epoch: 44 | loss: 0.0157190
	speed: 0.0252s/iter; left time: 315.2813s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.53s
Steps: 223 | Train Loss: 0.0158228 Vali Loss: 0.0170257 Test Loss: 0.0328763
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0156760
	speed: 0.0569s/iter; left time: 704.9917s
	iters: 200, epoch: 45 | loss: 0.0156764
	speed: 0.0241s/iter; left time: 296.7446s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.0157282 Vali Loss: 0.0169368 Test Loss: 0.0327699
Validation loss decreased (0.016952 --> 0.016937).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0161030
	speed: 0.0577s/iter; left time: 701.9405s
	iters: 200, epoch: 46 | loss: 0.0172997
	speed: 0.0243s/iter; left time: 293.1598s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.09s
Steps: 223 | Train Loss: 0.0157710 Vali Loss: 0.0169600 Test Loss: 0.0329193
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0147430
	speed: 0.0590s/iter; left time: 704.2325s
	iters: 200, epoch: 47 | loss: 0.0161302
	speed: 0.0267s/iter; left time: 316.0707s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0157679 Vali Loss: 0.0169480 Test Loss: 0.0331634
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0164486
	speed: 0.0602s/iter; left time: 705.8398s
	iters: 200, epoch: 48 | loss: 0.0148175
	speed: 0.0279s/iter; left time: 324.3523s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0157819 Vali Loss: 0.0169770 Test Loss: 0.0333828
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0163971
	speed: 0.0550s/iter; left time: 632.5106s
	iters: 200, epoch: 49 | loss: 0.0148533
	speed: 0.0324s/iter; left time: 368.8891s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.58s
Steps: 223 | Train Loss: 0.0157606 Vali Loss: 0.0168984 Test Loss: 0.0325417
Validation loss decreased (0.016937 --> 0.016898).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0165030
	speed: 0.0520s/iter; left time: 585.6893s
	iters: 200, epoch: 50 | loss: 0.0154998
	speed: 0.0303s/iter; left time: 338.1065s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0157381 Vali Loss: 0.0169541 Test Loss: 0.0337758
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0161881
	speed: 0.0580s/iter; left time: 640.8526s
	iters: 200, epoch: 51 | loss: 0.0148654
	speed: 0.0242s/iter; left time: 265.1323s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.16s
Steps: 223 | Train Loss: 0.0157762 Vali Loss: 0.0169161 Test Loss: 0.0328058
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0165587
	speed: 0.0585s/iter; left time: 633.8590s
	iters: 200, epoch: 52 | loss: 0.0159679
	speed: 0.0238s/iter; left time: 254.8991s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.0157141 Vali Loss: 0.0169452 Test Loss: 0.0326098
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0154703
	speed: 0.0578s/iter; left time: 613.2819s
	iters: 200, epoch: 53 | loss: 0.0147402
	speed: 0.0239s/iter; left time: 251.3977s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0157296 Vali Loss: 0.0169105 Test Loss: 0.0328408
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0152968
	speed: 0.0619s/iter; left time: 642.4387s
	iters: 200, epoch: 54 | loss: 0.0161895
	speed: 0.0228s/iter; left time: 234.4221s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.06s
Steps: 223 | Train Loss: 0.0157269 Vali Loss: 0.0169528 Test Loss: 0.0334324
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0161664
	speed: 0.0598s/iter; left time: 607.6549s
	iters: 200, epoch: 55 | loss: 0.0158240
	speed: 0.0304s/iter; left time: 305.7205s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.0157380 Vali Loss: 0.0169289 Test Loss: 0.0334821
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0162431
	speed: 0.0574s/iter; left time: 569.9137s
	iters: 200, epoch: 56 | loss: 0.0165172
	speed: 0.0216s/iter; left time: 212.6983s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.60s
Steps: 223 | Train Loss: 0.0157867 Vali Loss: 0.0168710 Test Loss: 0.0329189
Validation loss decreased (0.016898 --> 0.016871).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0147179
	speed: 0.0473s/iter; left time: 459.4196s
	iters: 200, epoch: 57 | loss: 0.0167741
	speed: 0.0245s/iter; left time: 235.1707s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0158918 Vali Loss: 0.0170040 Test Loss: 0.0338830
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0151420
	speed: 0.0565s/iter; left time: 536.0585s
	iters: 200, epoch: 58 | loss: 0.0155338
	speed: 0.0262s/iter; left time: 246.0373s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.44s
Steps: 223 | Train Loss: 0.0157274 Vali Loss: 0.0169733 Test Loss: 0.0335529
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0157903
	speed: 0.0601s/iter; left time: 556.7467s
	iters: 200, epoch: 59 | loss: 0.0146947
	speed: 0.0230s/iter; left time: 210.5659s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.19s
Steps: 223 | Train Loss: 0.0157228 Vali Loss: 0.0170033 Test Loss: 0.0348816
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0163458
	speed: 0.0610s/iter; left time: 551.2444s
	iters: 200, epoch: 60 | loss: 0.0159373
	speed: 0.0242s/iter; left time: 216.2076s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.02s
Steps: 223 | Train Loss: 0.0157675 Vali Loss: 0.0168795 Test Loss: 0.0327201
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0158163
	speed: 0.0611s/iter; left time: 539.3154s
	iters: 200, epoch: 61 | loss: 0.0149162
	speed: 0.0266s/iter; left time: 232.3363s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0157603 Vali Loss: 0.0169108 Test Loss: 0.0329584
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0162279
	speed: 0.0564s/iter; left time: 484.8630s
	iters: 200, epoch: 62 | loss: 0.0151691
	speed: 0.0295s/iter; left time: 251.1132s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:06.28s
Steps: 223 | Train Loss: 0.0157876 Vali Loss: 0.0169134 Test Loss: 0.0335492
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0156255
	speed: 0.0505s/iter; left time: 422.5204s
	iters: 200, epoch: 63 | loss: 0.0155422
	speed: 0.0305s/iter; left time: 252.4653s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:06.20s
Steps: 223 | Train Loss: 0.0157253 Vali Loss: 0.0169123 Test Loss: 0.0329814
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0164308
	speed: 0.0583s/iter; left time: 475.5381s
	iters: 200, epoch: 64 | loss: 0.0141026
	speed: 0.0235s/iter; left time: 189.6175s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:06.22s
Steps: 223 | Train Loss: 0.0157296 Vali Loss: 0.0169038 Test Loss: 0.0327831
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0158460
	speed: 0.0586s/iter; left time: 464.7772s
	iters: 200, epoch: 65 | loss: 0.0152336
	speed: 0.0255s/iter; left time: 199.7689s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.0157248 Vali Loss: 0.0169858 Test Loss: 0.0333585
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0160218
	speed: 0.0621s/iter; left time: 478.1986s
	iters: 200, epoch: 66 | loss: 0.0162508
	speed: 0.0244s/iter; left time: 185.9102s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:06.17s
Steps: 223 | Train Loss: 0.0157725 Vali Loss: 0.0169603 Test Loss: 0.0329206
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03291890770196915, rmse:0.181435689330101, mae:0.12120398133993149, rse:0.5330417156219482
Intermediate time for ES and pred_len 168: 00h:09m:06.54s
Intermediate time for ES: 00h:20m:10.26s

=== Starting experiments for country: FR ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1128716
	speed: 0.0367s/iter; left time: 826.3518s
	iters: 200, epoch: 1 | loss: 0.0919740
	speed: 0.0243s/iter; left time: 544.4542s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.89s
Steps: 226 | Train Loss: 0.1099309 Vali Loss: 0.0601149 Test Loss: 0.0664455
Validation loss decreased (inf --> 0.060115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0454220
	speed: 0.0475s/iter; left time: 1057.0121s
	iters: 200, epoch: 2 | loss: 0.0240695
	speed: 0.0253s/iter; left time: 562.1266s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.08s
Steps: 226 | Train Loss: 0.0443392 Vali Loss: 0.0177004 Test Loss: 0.0197107
Validation loss decreased (0.060115 --> 0.017700).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0174665
	speed: 0.0471s/iter; left time: 1037.8882s
	iters: 200, epoch: 3 | loss: 0.0156029
	speed: 0.0259s/iter; left time: 569.0298s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.14s
Steps: 226 | Train Loss: 0.0176472 Vali Loss: 0.0159071 Test Loss: 0.0172814
Validation loss decreased (0.017700 --> 0.015907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0167951
	speed: 0.0426s/iter; left time: 929.6801s
	iters: 200, epoch: 4 | loss: 0.0133514
	speed: 0.0227s/iter; left time: 493.0963s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.24s
Steps: 226 | Train Loss: 0.0145339 Vali Loss: 0.0150010 Test Loss: 0.0160672
Validation loss decreased (0.015907 --> 0.015001).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0125075
	speed: 0.0489s/iter; left time: 1056.3346s
	iters: 200, epoch: 5 | loss: 0.0118828
	speed: 0.0257s/iter; left time: 553.4823s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.43s
Steps: 226 | Train Loss: 0.0128717 Vali Loss: 0.0137019 Test Loss: 0.0140345
Validation loss decreased (0.015001 --> 0.013702).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0114066
	speed: 0.0476s/iter; left time: 1017.8518s
	iters: 200, epoch: 6 | loss: 0.0113185
	speed: 0.0245s/iter; left time: 521.6975s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.75s
Steps: 226 | Train Loss: 0.0118683 Vali Loss: 0.0131602 Test Loss: 0.0132944
Validation loss decreased (0.013702 --> 0.013160).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0114604
	speed: 0.0449s/iter; left time: 950.4081s
	iters: 200, epoch: 7 | loss: 0.0117390
	speed: 0.0224s/iter; left time: 472.3927s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.51s
Steps: 226 | Train Loss: 0.0110327 Vali Loss: 0.0118688 Test Loss: 0.0124213
Validation loss decreased (0.013160 --> 0.011869).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0095407
	speed: 0.0464s/iter; left time: 971.3975s
	iters: 200, epoch: 8 | loss: 0.0096248
	speed: 0.0242s/iter; left time: 504.8198s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.97s
Steps: 226 | Train Loss: 0.0102839 Vali Loss: 0.0116305 Test Loss: 0.0123497
Validation loss decreased (0.011869 --> 0.011631).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0097565
	speed: 0.0488s/iter; left time: 1010.0380s
	iters: 200, epoch: 9 | loss: 0.0093351
	speed: 0.0252s/iter; left time: 519.7482s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.19s
Steps: 226 | Train Loss: 0.0097569 Vali Loss: 0.0111807 Test Loss: 0.0120926
Validation loss decreased (0.011631 --> 0.011181).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0086483
	speed: 0.0487s/iter; left time: 996.2656s
	iters: 200, epoch: 10 | loss: 0.0097031
	speed: 0.0255s/iter; left time: 519.5460s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.09s
Steps: 226 | Train Loss: 0.0093534 Vali Loss: 0.0108828 Test Loss: 0.0119646
Validation loss decreased (0.011181 --> 0.010883).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0088099
	speed: 0.0471s/iter; left time: 952.5624s
	iters: 200, epoch: 11 | loss: 0.0084883
	speed: 0.0242s/iter; left time: 486.7701s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.67s
Steps: 226 | Train Loss: 0.0090376 Vali Loss: 0.0107497 Test Loss: 0.0119239
Validation loss decreased (0.010883 --> 0.010750).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0105577
	speed: 0.0452s/iter; left time: 904.0544s
	iters: 200, epoch: 12 | loss: 0.0092621
	speed: 0.0248s/iter; left time: 493.2401s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.94s
Steps: 226 | Train Loss: 0.0087718 Vali Loss: 0.0106976 Test Loss: 0.0119551
Validation loss decreased (0.010750 --> 0.010698).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0079246
	speed: 0.0404s/iter; left time: 799.8532s
	iters: 200, epoch: 13 | loss: 0.0085691
	speed: 0.0254s/iter; left time: 499.7591s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.50s
Steps: 226 | Train Loss: 0.0085790 Vali Loss: 0.0104539 Test Loss: 0.0117490
Validation loss decreased (0.010698 --> 0.010454).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0095796
	speed: 0.0490s/iter; left time: 958.9949s
	iters: 200, epoch: 14 | loss: 0.0087225
	speed: 0.0257s/iter; left time: 500.5856s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.17s
Steps: 226 | Train Loss: 0.0084359 Vali Loss: 0.0104884 Test Loss: 0.0118595
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0077258
	speed: 0.0465s/iter; left time: 899.1372s
	iters: 200, epoch: 15 | loss: 0.0071234
	speed: 0.0264s/iter; left time: 507.8580s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.17s
Steps: 226 | Train Loss: 0.0082627 Vali Loss: 0.0103015 Test Loss: 0.0115612
Validation loss decreased (0.010454 --> 0.010302).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0081572
	speed: 0.0468s/iter; left time: 894.6238s
	iters: 200, epoch: 16 | loss: 0.0073905
	speed: 0.0280s/iter; left time: 532.9382s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.28s
Steps: 226 | Train Loss: 0.0081118 Vali Loss: 0.0102584 Test Loss: 0.0115973
Validation loss decreased (0.010302 --> 0.010258).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0077903
	speed: 0.0450s/iter; left time: 850.3065s
	iters: 200, epoch: 17 | loss: 0.0085271
	speed: 0.0272s/iter; left time: 510.4301s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.01s
Steps: 226 | Train Loss: 0.0080381 Vali Loss: 0.0102395 Test Loss: 0.0115598
Validation loss decreased (0.010258 --> 0.010239).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0074358
	speed: 0.0483s/iter; left time: 901.3562s
	iters: 200, epoch: 18 | loss: 0.0079556
	speed: 0.0273s/iter; left time: 507.0421s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.38s
Steps: 226 | Train Loss: 0.0080005 Vali Loss: 0.0101840 Test Loss: 0.0115057
Validation loss decreased (0.010239 --> 0.010184).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0083683
	speed: 0.0481s/iter; left time: 887.3875s
	iters: 200, epoch: 19 | loss: 0.0084214
	speed: 0.0279s/iter; left time: 510.9362s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.39s
Steps: 226 | Train Loss: 0.0078926 Vali Loss: 0.0100710 Test Loss: 0.0114132
Validation loss decreased (0.010184 --> 0.010071).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0084008
	speed: 0.0459s/iter; left time: 835.2010s
	iters: 200, epoch: 20 | loss: 0.0095158
	speed: 0.0275s/iter; left time: 497.1251s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.09s
Steps: 226 | Train Loss: 0.0078249 Vali Loss: 0.0101010 Test Loss: 0.0114476
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0076617
	speed: 0.0457s/iter; left time: 821.0012s
	iters: 200, epoch: 21 | loss: 0.0072457
	speed: 0.0245s/iter; left time: 438.2443s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.74s
Steps: 226 | Train Loss: 0.0077804 Vali Loss: 0.0100627 Test Loss: 0.0113515
Validation loss decreased (0.010071 --> 0.010063).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0068569
	speed: 0.0459s/iter; left time: 814.8669s
	iters: 200, epoch: 22 | loss: 0.0080052
	speed: 0.0259s/iter; left time: 457.8088s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.11s
Steps: 226 | Train Loss: 0.0077491 Vali Loss: 0.0100271 Test Loss: 0.0113290
Validation loss decreased (0.010063 --> 0.010027).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0075235
	speed: 0.0487s/iter; left time: 853.9193s
	iters: 200, epoch: 23 | loss: 0.0069177
	speed: 0.0224s/iter; left time: 389.7305s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.78s
Steps: 226 | Train Loss: 0.0076993 Vali Loss: 0.0099996 Test Loss: 0.0113290
Validation loss decreased (0.010027 --> 0.010000).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0078292
	speed: 0.0469s/iter; left time: 810.7168s
	iters: 200, epoch: 24 | loss: 0.0076700
	speed: 0.0269s/iter; left time: 463.3922s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.32s
Steps: 226 | Train Loss: 0.0076460 Vali Loss: 0.0099254 Test Loss: 0.0112511
Validation loss decreased (0.010000 --> 0.009925).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0077398
	speed: 0.0470s/iter; left time: 802.2339s
	iters: 200, epoch: 25 | loss: 0.0080779
	speed: 0.0264s/iter; left time: 447.3652s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.08s
Steps: 226 | Train Loss: 0.0076634 Vali Loss: 0.0099582 Test Loss: 0.0112776
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0074780
	speed: 0.0466s/iter; left time: 785.9828s
	iters: 200, epoch: 26 | loss: 0.0075827
	speed: 0.0261s/iter; left time: 436.3797s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0076121 Vali Loss: 0.0099094 Test Loss: 0.0112128
Validation loss decreased (0.009925 --> 0.009909).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0079850
	speed: 0.0500s/iter; left time: 831.7564s
	iters: 200, epoch: 27 | loss: 0.0078030
	speed: 0.0250s/iter; left time: 412.5499s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.32s
Steps: 226 | Train Loss: 0.0075464 Vali Loss: 0.0099611 Test Loss: 0.0113010
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0069769
	speed: 0.0478s/iter; left time: 783.5626s
	iters: 200, epoch: 28 | loss: 0.0071861
	speed: 0.0264s/iter; left time: 431.0163s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.14s
Steps: 226 | Train Loss: 0.0075400 Vali Loss: 0.0099150 Test Loss: 0.0112339
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0080889
	speed: 0.0491s/iter; left time: 793.3192s
	iters: 200, epoch: 29 | loss: 0.0076567
	speed: 0.0248s/iter; left time: 399.3400s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0075251 Vali Loss: 0.0099069 Test Loss: 0.0112995
Validation loss decreased (0.009909 --> 0.009907).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0065259
	speed: 0.0439s/iter; left time: 700.6394s
	iters: 200, epoch: 30 | loss: 0.0075698
	speed: 0.0271s/iter; left time: 429.9469s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.00s
Steps: 226 | Train Loss: 0.0074991 Vali Loss: 0.0098355 Test Loss: 0.0111918
Validation loss decreased (0.009907 --> 0.009836).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0075317
	speed: 0.0473s/iter; left time: 743.7332s
	iters: 200, epoch: 31 | loss: 0.0086341
	speed: 0.0250s/iter; left time: 390.9650s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.94s
Steps: 226 | Train Loss: 0.0074795 Vali Loss: 0.0098114 Test Loss: 0.0111375
Validation loss decreased (0.009836 --> 0.009811).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0076852
	speed: 0.0475s/iter; left time: 736.3181s
	iters: 200, epoch: 32 | loss: 0.0069425
	speed: 0.0267s/iter; left time: 411.8058s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.20s
Steps: 226 | Train Loss: 0.0074564 Vali Loss: 0.0098412 Test Loss: 0.0112313
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0085172
	speed: 0.0451s/iter; left time: 688.2950s
	iters: 200, epoch: 33 | loss: 0.0081953
	speed: 0.0265s/iter; left time: 402.2795s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.97s
Steps: 226 | Train Loss: 0.0074508 Vali Loss: 0.0098692 Test Loss: 0.0112476
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0063183
	speed: 0.0441s/iter; left time: 662.9747s
	iters: 200, epoch: 34 | loss: 0.0077615
	speed: 0.0264s/iter; left time: 395.2159s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.01s
Steps: 226 | Train Loss: 0.0074334 Vali Loss: 0.0098005 Test Loss: 0.0111092
Validation loss decreased (0.009811 --> 0.009801).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0068418
	speed: 0.0480s/iter; left time: 710.5507s
	iters: 200, epoch: 35 | loss: 0.0075842
	speed: 0.0262s/iter; left time: 385.0667s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.23s
Steps: 226 | Train Loss: 0.0074288 Vali Loss: 0.0098764 Test Loss: 0.0112255
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0085077
	speed: 0.0449s/iter; left time: 655.8095s
	iters: 200, epoch: 36 | loss: 0.0076539
	speed: 0.0263s/iter; left time: 381.6022s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.01s
Steps: 226 | Train Loss: 0.0074260 Vali Loss: 0.0097790 Test Loss: 0.0110372
Validation loss decreased (0.009801 --> 0.009779).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0069371
	speed: 0.0482s/iter; left time: 692.4355s
	iters: 200, epoch: 37 | loss: 0.0080106
	speed: 0.0239s/iter; left time: 341.3171s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.96s
Steps: 226 | Train Loss: 0.0074054 Vali Loss: 0.0098604 Test Loss: 0.0112190
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0070336
	speed: 0.0484s/iter; left time: 684.4896s
	iters: 200, epoch: 38 | loss: 0.0076715
	speed: 0.0273s/iter; left time: 382.5688s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.21s
Steps: 226 | Train Loss: 0.0073978 Vali Loss: 0.0098322 Test Loss: 0.0112414
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0071844
	speed: 0.0469s/iter; left time: 652.0552s
	iters: 200, epoch: 39 | loss: 0.0066780
	speed: 0.0268s/iter; left time: 370.6447s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.31s
Steps: 226 | Train Loss: 0.0074299 Vali Loss: 0.0097835 Test Loss: 0.0111078
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0065640
	speed: 0.0477s/iter; left time: 653.5499s
	iters: 200, epoch: 40 | loss: 0.0078668
	speed: 0.0264s/iter; left time: 358.1417s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0073860 Vali Loss: 0.0097779 Test Loss: 0.0111073
Validation loss decreased (0.009779 --> 0.009778).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0077651
	speed: 0.0498s/iter; left time: 670.7447s
	iters: 200, epoch: 41 | loss: 0.0065422
	speed: 0.0269s/iter; left time: 359.9463s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.48s
Steps: 226 | Train Loss: 0.0073971 Vali Loss: 0.0098634 Test Loss: 0.0112728
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0071227
	speed: 0.0487s/iter; left time: 644.4144s
	iters: 200, epoch: 42 | loss: 0.0074113
	speed: 0.0265s/iter; left time: 348.5710s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.23s
Steps: 226 | Train Loss: 0.0073542 Vali Loss: 0.0097589 Test Loss: 0.0111162
Validation loss decreased (0.009778 --> 0.009759).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0076495
	speed: 0.0474s/iter; left time: 616.0548s
	iters: 200, epoch: 43 | loss: 0.0071825
	speed: 0.0265s/iter; left time: 341.6872s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.24s
Steps: 226 | Train Loss: 0.0073650 Vali Loss: 0.0097709 Test Loss: 0.0110386
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0085925
	speed: 0.0438s/iter; left time: 559.5586s
	iters: 200, epoch: 44 | loss: 0.0074999
	speed: 0.0262s/iter; left time: 331.8429s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.12s
Steps: 226 | Train Loss: 0.0073613 Vali Loss: 0.0097453 Test Loss: 0.0110496
Validation loss decreased (0.009759 --> 0.009745).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0071460
	speed: 0.0486s/iter; left time: 610.2360s
	iters: 200, epoch: 45 | loss: 0.0082683
	speed: 0.0272s/iter; left time: 338.3396s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.10s
Steps: 226 | Train Loss: 0.0073519 Vali Loss: 0.0098793 Test Loss: 0.0111911
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0077008
	speed: 0.0442s/iter; left time: 544.8672s
	iters: 200, epoch: 46 | loss: 0.0069996
	speed: 0.0269s/iter; left time: 329.0903s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.12s
Steps: 226 | Train Loss: 0.0073610 Vali Loss: 0.0098040 Test Loss: 0.0111710
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0078941
	speed: 0.0477s/iter; left time: 577.4845s
	iters: 200, epoch: 47 | loss: 0.0078461
	speed: 0.0262s/iter; left time: 314.8649s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.14s
Steps: 226 | Train Loss: 0.0073608 Vali Loss: 0.0099016 Test Loss: 0.0113324
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0077719
	speed: 0.0480s/iter; left time: 570.4268s
	iters: 200, epoch: 48 | loss: 0.0059703
	speed: 0.0283s/iter; left time: 333.7328s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.48s
Steps: 226 | Train Loss: 0.0073397 Vali Loss: 0.0097900 Test Loss: 0.0111150
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0076034
	speed: 0.0472s/iter; left time: 550.4222s
	iters: 200, epoch: 49 | loss: 0.0076480
	speed: 0.0255s/iter; left time: 294.5639s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.05s
Steps: 226 | Train Loss: 0.0073238 Vali Loss: 0.0097820 Test Loss: 0.0111313
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0077784
	speed: 0.0458s/iter; left time: 523.2287s
	iters: 200, epoch: 50 | loss: 0.0086826
	speed: 0.0249s/iter; left time: 281.7022s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.87s
Steps: 226 | Train Loss: 0.0073742 Vali Loss: 0.0097795 Test Loss: 0.0111120
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0070409
	speed: 0.0390s/iter; left time: 436.8578s
	iters: 200, epoch: 51 | loss: 0.0080854
	speed: 0.0229s/iter; left time: 254.4288s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.29s
Steps: 226 | Train Loss: 0.0073432 Vali Loss: 0.0097531 Test Loss: 0.0110949
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0080639
	speed: 0.0417s/iter; left time: 457.5949s
	iters: 200, epoch: 52 | loss: 0.0076307
	speed: 0.0251s/iter; left time: 272.8667s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.72s
Steps: 226 | Train Loss: 0.0073577 Vali Loss: 0.0097429 Test Loss: 0.0110933
Validation loss decreased (0.009745 --> 0.009743).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0067979
	speed: 0.0474s/iter; left time: 509.8565s
	iters: 200, epoch: 53 | loss: 0.0070733
	speed: 0.0275s/iter; left time: 292.4261s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.38s
Steps: 226 | Train Loss: 0.0073570 Vali Loss: 0.0097354 Test Loss: 0.0110799
Validation loss decreased (0.009743 --> 0.009735).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0074099
	speed: 0.0454s/iter; left time: 477.4238s
	iters: 200, epoch: 54 | loss: 0.0065128
	speed: 0.0231s/iter; left time: 241.0124s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.61s
Steps: 226 | Train Loss: 0.0073377 Vali Loss: 0.0098519 Test Loss: 0.0112452
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0073642
	speed: 0.0460s/iter; left time: 473.5861s
	iters: 200, epoch: 55 | loss: 0.0070603
	speed: 0.0264s/iter; left time: 268.8456s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.94s
Steps: 226 | Train Loss: 0.0073712 Vali Loss: 0.0097421 Test Loss: 0.0110505
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0075464
	speed: 0.0466s/iter; left time: 469.0349s
	iters: 200, epoch: 56 | loss: 0.0079625
	speed: 0.0254s/iter; left time: 253.3787s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.09s
Steps: 226 | Train Loss: 0.0073074 Vali Loss: 0.0098135 Test Loss: 0.0111922
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0062994
	speed: 0.0486s/iter; left time: 478.6940s
	iters: 200, epoch: 57 | loss: 0.0074914
	speed: 0.0267s/iter; left time: 260.6590s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.34s
Steps: 226 | Train Loss: 0.0073146 Vali Loss: 0.0097597 Test Loss: 0.0111272
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0070301
	speed: 0.0492s/iter; left time: 472.9524s
	iters: 200, epoch: 58 | loss: 0.0080159
	speed: 0.0253s/iter; left time: 240.5907s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0073411 Vali Loss: 0.0098542 Test Loss: 0.0112294
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0077752
	speed: 0.0432s/iter; left time: 406.1894s
	iters: 200, epoch: 59 | loss: 0.0071535
	speed: 0.0261s/iter; left time: 242.6972s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.80s
Steps: 226 | Train Loss: 0.0073310 Vali Loss: 0.0098229 Test Loss: 0.0111914
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0076468
	speed: 0.0496s/iter; left time: 454.7313s
	iters: 200, epoch: 60 | loss: 0.0069263
	speed: 0.0272s/iter; left time: 246.3952s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.44s
Steps: 226 | Train Loss: 0.0073323 Vali Loss: 0.0097625 Test Loss: 0.0110864
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0074560
	speed: 0.0471s/iter; left time: 421.5195s
	iters: 200, epoch: 61 | loss: 0.0083241
	speed: 0.0235s/iter; left time: 207.5506s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:05.86s
Steps: 226 | Train Loss: 0.0073178 Vali Loss: 0.0097292 Test Loss: 0.0110488
Validation loss decreased (0.009735 --> 0.009729).  Saving model ...
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0072145
	speed: 0.0462s/iter; left time: 402.2560s
	iters: 200, epoch: 62 | loss: 0.0068843
	speed: 0.0226s/iter; left time: 195.0023s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.60s
Steps: 226 | Train Loss: 0.0073189 Vali Loss: 0.0097757 Test Loss: 0.0110886
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0078795
	speed: 0.0470s/iter; left time: 398.6356s
	iters: 200, epoch: 63 | loss: 0.0076407
	speed: 0.0255s/iter; left time: 214.0120s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.98s
Steps: 226 | Train Loss: 0.0073113 Vali Loss: 0.0098350 Test Loss: 0.0112361
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0063528
	speed: 0.0450s/iter; left time: 371.9840s
	iters: 200, epoch: 64 | loss: 0.0075218
	speed: 0.0249s/iter; left time: 203.4058s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:05.90s
Steps: 226 | Train Loss: 0.0073152 Vali Loss: 0.0098300 Test Loss: 0.0111841
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0070828
	speed: 0.0433s/iter; left time: 347.6982s
	iters: 200, epoch: 65 | loss: 0.0068030
	speed: 0.0254s/iter; left time: 201.9666s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:05.61s
Steps: 226 | Train Loss: 0.0073437 Vali Loss: 0.0097178 Test Loss: 0.0109760
Validation loss decreased (0.009729 --> 0.009718).  Saving model ...
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0071458
	speed: 0.0479s/iter; left time: 373.8890s
	iters: 200, epoch: 66 | loss: 0.0072068
	speed: 0.0272s/iter; left time: 209.4415s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:06.26s
Steps: 226 | Train Loss: 0.0073280 Vali Loss: 0.0097456 Test Loss: 0.0110517
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0083490
	speed: 0.0485s/iter; left time: 368.0396s
	iters: 200, epoch: 67 | loss: 0.0076469
	speed: 0.0261s/iter; left time: 195.6571s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:06.25s
Steps: 226 | Train Loss: 0.0072792 Vali Loss: 0.0097689 Test Loss: 0.0110874
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0069373
	speed: 0.0475s/iter; left time: 349.4323s
	iters: 200, epoch: 68 | loss: 0.0075724
	speed: 0.0266s/iter; left time: 193.3757s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:06.29s
Steps: 226 | Train Loss: 0.0073193 Vali Loss: 0.0098146 Test Loss: 0.0111480
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0078234
	speed: 0.0478s/iter; left time: 340.9984s
	iters: 200, epoch: 69 | loss: 0.0066599
	speed: 0.0265s/iter; left time: 186.0542s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:06.25s
Steps: 226 | Train Loss: 0.0073367 Vali Loss: 0.0097884 Test Loss: 0.0111599
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0059663
	speed: 0.0494s/iter; left time: 341.0797s
	iters: 200, epoch: 70 | loss: 0.0079825
	speed: 0.0260s/iter; left time: 176.6865s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:06.29s
Steps: 226 | Train Loss: 0.0073102 Vali Loss: 0.0097673 Test Loss: 0.0111429
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.595044557171442e-08
	iters: 100, epoch: 71 | loss: 0.0081901
	speed: 0.0460s/iter; left time: 307.0410s
	iters: 200, epoch: 71 | loss: 0.0072638
	speed: 0.0260s/iter; left time: 171.0411s
-------------------------------------------------------------------------------------
Epoch: 71
Cost time: 00h:00m:05.92s
Steps: 226 | Train Loss: 0.0073409 Vali Loss: 0.0097836 Test Loss: 0.0111003
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.735540101454298e-08
	iters: 100, epoch: 72 | loss: 0.0067434
	speed: 0.0493s/iter; left time: 318.0908s
	iters: 200, epoch: 72 | loss: 0.0084814
	speed: 0.0267s/iter; left time: 169.5453s
-------------------------------------------------------------------------------------
Epoch: 72
Cost time: 00h:00m:06.46s
Steps: 226 | Train Loss: 0.0073292 Vali Loss: 0.0097669 Test Loss: 0.0111092
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.961986091308869e-08
	iters: 100, epoch: 73 | loss: 0.0083585
	speed: 0.0458s/iter; left time: 285.5602s
	iters: 200, epoch: 73 | loss: 0.0078706
	speed: 0.0282s/iter; left time: 173.0990s
-------------------------------------------------------------------------------------
Epoch: 73
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0073063 Vali Loss: 0.0097382 Test Loss: 0.0110653
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.265787482177981e-08
	iters: 100, epoch: 74 | loss: 0.0060933
	speed: 0.0476s/iter; left time: 285.4438s
	iters: 200, epoch: 74 | loss: 0.0085692
	speed: 0.0273s/iter; left time: 161.0397s
-------------------------------------------------------------------------------------
Epoch: 74
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0073037 Vali Loss: 0.0097348 Test Loss: 0.0110978
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.639208733960184e-08
	iters: 100, epoch: 75 | loss: 0.0066312
	speed: 0.0472s/iter; left time: 272.8819s
	iters: 200, epoch: 75 | loss: 0.0079251
	speed: 0.0263s/iter; left time: 149.5174s
-------------------------------------------------------------------------------------
Epoch: 75
Cost time: 00h:00m:06.18s
Steps: 226 | Train Loss: 0.0073133 Vali Loss: 0.0097491 Test Loss: 0.0110843
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01097604539245367, rmse:0.10476662218570709, mae:0.06404493004083633, rse:0.4041867256164551
Intermediate time for FR and pred_len 24: 00h:09m:10.94s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1113841
	speed: 0.0408s/iter; left time: 914.6024s
	iters: 200, epoch: 1 | loss: 0.0960350
	speed: 0.0205s/iter; left time: 457.8952s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.1140842 Vali Loss: 0.0640091 Test Loss: 0.0724323
Validation loss decreased (inf --> 0.064009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0396767
	speed: 0.0352s/iter; left time: 781.1620s
	iters: 200, epoch: 2 | loss: 0.0237787
	speed: 0.0205s/iter; left time: 453.5848s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0416248 Vali Loss: 0.0233879 Test Loss: 0.0283799
Validation loss decreased (0.064009 --> 0.023388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0195205
	speed: 0.0432s/iter; left time: 949.2620s
	iters: 200, epoch: 3 | loss: 0.0207301
	speed: 0.0214s/iter; left time: 467.6039s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.22s
Steps: 225 | Train Loss: 0.0201231 Vali Loss: 0.0215313 Test Loss: 0.0250091
Validation loss decreased (0.023388 --> 0.021531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0159275
	speed: 0.0474s/iter; left time: 1029.7220s
	iters: 200, epoch: 4 | loss: 0.0168217
	speed: 0.0232s/iter; left time: 501.0622s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.58s
Steps: 225 | Train Loss: 0.0174908 Vali Loss: 0.0196409 Test Loss: 0.0223041
Validation loss decreased (0.021531 --> 0.019641).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0158458
	speed: 0.0460s/iter; left time: 988.0546s
	iters: 200, epoch: 5 | loss: 0.0151958
	speed: 0.0206s/iter; left time: 441.2402s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.42s
Steps: 225 | Train Loss: 0.0158961 Vali Loss: 0.0179276 Test Loss: 0.0212669
Validation loss decreased (0.019641 --> 0.017928).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0146401
	speed: 0.0456s/iter; left time: 969.9722s
	iters: 200, epoch: 6 | loss: 0.0138012
	speed: 0.0248s/iter; left time: 524.5493s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.67s
Steps: 225 | Train Loss: 0.0148701 Vali Loss: 0.0172438 Test Loss: 0.0206284
Validation loss decreased (0.017928 --> 0.017244).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0131631
	speed: 0.0473s/iter; left time: 995.8564s
	iters: 200, epoch: 7 | loss: 0.0135497
	speed: 0.0271s/iter; left time: 568.0906s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0141523 Vali Loss: 0.0167315 Test Loss: 0.0206269
Validation loss decreased (0.017244 --> 0.016731).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0155353
	speed: 0.0477s/iter; left time: 993.6517s
	iters: 200, epoch: 8 | loss: 0.0145908
	speed: 0.0259s/iter; left time: 536.5331s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.97s
Steps: 225 | Train Loss: 0.0136613 Vali Loss: 0.0164862 Test Loss: 0.0204916
Validation loss decreased (0.016731 --> 0.016486).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0124979
	speed: 0.0487s/iter; left time: 1002.8748s
	iters: 200, epoch: 9 | loss: 0.0141903
	speed: 0.0259s/iter; left time: 530.1232s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.01s
Steps: 225 | Train Loss: 0.0132657 Vali Loss: 0.0163018 Test Loss: 0.0203900
Validation loss decreased (0.016486 --> 0.016302).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0130249
	speed: 0.0478s/iter; left time: 973.9434s
	iters: 200, epoch: 10 | loss: 0.0145992
	speed: 0.0191s/iter; left time: 387.0053s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0130031 Vali Loss: 0.0162973 Test Loss: 0.0206071
Validation loss decreased (0.016302 --> 0.016297).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0117351
	speed: 0.0388s/iter; left time: 782.7197s
	iters: 200, epoch: 11 | loss: 0.0126542
	speed: 0.0160s/iter; left time: 321.0418s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.83s
Steps: 225 | Train Loss: 0.0128600 Vali Loss: 0.0161040 Test Loss: 0.0201517
Validation loss decreased (0.016297 --> 0.016104).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0118891
	speed: 0.0406s/iter; left time: 809.8770s
	iters: 200, epoch: 12 | loss: 0.0141304
	speed: 0.0177s/iter; left time: 350.5664s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0126416 Vali Loss: 0.0161925 Test Loss: 0.0203752
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0115469
	speed: 0.0373s/iter; left time: 734.5803s
	iters: 200, epoch: 13 | loss: 0.0135689
	speed: 0.0162s/iter; left time: 318.5020s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0124961 Vali Loss: 0.0161324 Test Loss: 0.0203338
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0133804
	speed: 0.0362s/iter; left time: 705.3949s
	iters: 200, epoch: 14 | loss: 0.0134761
	speed: 0.0153s/iter; left time: 296.2817s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.72s
Steps: 225 | Train Loss: 0.0123601 Vali Loss: 0.0159018 Test Loss: 0.0199754
Validation loss decreased (0.016104 --> 0.015902).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0123548
	speed: 0.0398s/iter; left time: 766.5722s
	iters: 200, epoch: 15 | loss: 0.0117204
	speed: 0.0196s/iter; left time: 374.9376s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0122618 Vali Loss: 0.0158032 Test Loss: 0.0197771
Validation loss decreased (0.015902 --> 0.015803).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0119051
	speed: 0.0367s/iter; left time: 698.0305s
	iters: 200, epoch: 16 | loss: 0.0120862
	speed: 0.0155s/iter; left time: 293.9645s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.83s
Steps: 225 | Train Loss: 0.0121902 Vali Loss: 0.0158244 Test Loss: 0.0198974
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0119850
	speed: 0.0363s/iter; left time: 682.0079s
	iters: 200, epoch: 17 | loss: 0.0132078
	speed: 0.0161s/iter; left time: 300.5830s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0120864 Vali Loss: 0.0159179 Test Loss: 0.0201066
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0134467
	speed: 0.0397s/iter; left time: 736.6075s
	iters: 200, epoch: 18 | loss: 0.0124690
	speed: 0.0152s/iter; left time: 280.7597s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.94s
Steps: 225 | Train Loss: 0.0120324 Vali Loss: 0.0157427 Test Loss: 0.0197965
Validation loss decreased (0.015803 --> 0.015743).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0115921
	speed: 0.0366s/iter; left time: 671.8514s
	iters: 200, epoch: 19 | loss: 0.0118622
	speed: 0.0157s/iter; left time: 286.4176s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0119771 Vali Loss: 0.0157152 Test Loss: 0.0197621
Validation loss decreased (0.015743 --> 0.015715).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0113165
	speed: 0.0359s/iter; left time: 650.2540s
	iters: 200, epoch: 20 | loss: 0.0128192
	speed: 0.0177s/iter; left time: 318.9280s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.14s
Steps: 225 | Train Loss: 0.0119356 Vali Loss: 0.0156835 Test Loss: 0.0197760
Validation loss decreased (0.015715 --> 0.015684).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0105805
	speed: 0.0393s/iter; left time: 703.6825s
	iters: 200, epoch: 21 | loss: 0.0113129
	speed: 0.0155s/iter; left time: 275.2871s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0118538 Vali Loss: 0.0157063 Test Loss: 0.0198067
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0119138
	speed: 0.0349s/iter; left time: 617.7095s
	iters: 200, epoch: 22 | loss: 0.0130232
	speed: 0.0166s/iter; left time: 292.6130s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0118490 Vali Loss: 0.0157687 Test Loss: 0.0199778
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0140942
	speed: 0.0424s/iter; left time: 740.6491s
	iters: 200, epoch: 23 | loss: 0.0104837
	speed: 0.0153s/iter; left time: 266.2464s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.0117976 Vali Loss: 0.0155976 Test Loss: 0.0196915
Validation loss decreased (0.015684 --> 0.015598).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0119596
	speed: 0.0377s/iter; left time: 648.9023s
	iters: 200, epoch: 24 | loss: 0.0122438
	speed: 0.0155s/iter; left time: 265.8476s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0117347 Vali Loss: 0.0155869 Test Loss: 0.0196945
Validation loss decreased (0.015598 --> 0.015587).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0110265
	speed: 0.0375s/iter; left time: 638.2705s
	iters: 200, epoch: 25 | loss: 0.0106533
	speed: 0.0181s/iter; left time: 305.6683s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.07s
Steps: 225 | Train Loss: 0.0117112 Vali Loss: 0.0156426 Test Loss: 0.0198788
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0123516
	speed: 0.0395s/iter; left time: 662.9959s
	iters: 200, epoch: 26 | loss: 0.0110251
	speed: 0.0169s/iter; left time: 282.2685s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0117144 Vali Loss: 0.0156266 Test Loss: 0.0196654
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0118690
	speed: 0.0396s/iter; left time: 654.8026s
	iters: 200, epoch: 27 | loss: 0.0126628
	speed: 0.0160s/iter; left time: 263.0844s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.0116711 Vali Loss: 0.0155167 Test Loss: 0.0196460
Validation loss decreased (0.015587 --> 0.015517).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0111083
	speed: 0.0411s/iter; left time: 670.6492s
	iters: 200, epoch: 28 | loss: 0.0124047
	speed: 0.0184s/iter; left time: 298.7979s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0116553 Vali Loss: 0.0155300 Test Loss: 0.0196517
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0111487
	speed: 0.0366s/iter; left time: 589.7061s
	iters: 200, epoch: 29 | loss: 0.0116333
	speed: 0.0164s/iter; left time: 262.9206s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0116603 Vali Loss: 0.0154778 Test Loss: 0.0194986
Validation loss decreased (0.015517 --> 0.015478).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0111717
	speed: 0.0387s/iter; left time: 613.9011s
	iters: 200, epoch: 30 | loss: 0.0109237
	speed: 0.0169s/iter; left time: 266.6478s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.10s
Steps: 225 | Train Loss: 0.0116186 Vali Loss: 0.0155104 Test Loss: 0.0196734
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0108955
	speed: 0.0385s/iter; left time: 602.0151s
	iters: 200, epoch: 31 | loss: 0.0120876
	speed: 0.0154s/iter; left time: 239.2646s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0115731 Vali Loss: 0.0155629 Test Loss: 0.0196749
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0112643
	speed: 0.0374s/iter; left time: 576.8115s
	iters: 200, epoch: 32 | loss: 0.0106460
	speed: 0.0159s/iter; left time: 243.8734s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.0116208 Vali Loss: 0.0154745 Test Loss: 0.0194838
Validation loss decreased (0.015478 --> 0.015474).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0120849
	speed: 0.0411s/iter; left time: 624.1683s
	iters: 200, epoch: 33 | loss: 0.0106973
	speed: 0.0213s/iter; left time: 321.8344s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.76s
Steps: 225 | Train Loss: 0.0115906 Vali Loss: 0.0154839 Test Loss: 0.0196082
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0114681
	speed: 0.0376s/iter; left time: 563.8245s
	iters: 200, epoch: 34 | loss: 0.0103871
	speed: 0.0179s/iter; left time: 266.1766s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0115730 Vali Loss: 0.0153933 Test Loss: 0.0194390
Validation loss decreased (0.015474 --> 0.015393).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0116464
	speed: 0.0395s/iter; left time: 582.9110s
	iters: 200, epoch: 35 | loss: 0.0106844
	speed: 0.0174s/iter; left time: 255.3271s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.0115658 Vali Loss: 0.0154608 Test Loss: 0.0195885
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0130586
	speed: 0.0395s/iter; left time: 574.2656s
	iters: 200, epoch: 36 | loss: 0.0131336
	speed: 0.0172s/iter; left time: 248.5702s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0115078 Vali Loss: 0.0154698 Test Loss: 0.0195335
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0120452
	speed: 0.0369s/iter; left time: 527.4090s
	iters: 200, epoch: 37 | loss: 0.0121271
	speed: 0.0174s/iter; left time: 246.8181s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0115680 Vali Loss: 0.0154238 Test Loss: 0.0195199
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0119433
	speed: 0.0402s/iter; left time: 565.6545s
	iters: 200, epoch: 38 | loss: 0.0110818
	speed: 0.0199s/iter; left time: 278.1313s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.63s
Steps: 225 | Train Loss: 0.0115156 Vali Loss: 0.0153970 Test Loss: 0.0194227
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0100204
	speed: 0.0388s/iter; left time: 537.5923s
	iters: 200, epoch: 39 | loss: 0.0113502
	speed: 0.0160s/iter; left time: 220.2156s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0115199 Vali Loss: 0.0154849 Test Loss: 0.0196535
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0115077
	speed: 0.0388s/iter; left time: 528.1749s
	iters: 200, epoch: 40 | loss: 0.0103217
	speed: 0.0152s/iter; left time: 204.9452s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.0115064 Vali Loss: 0.0154055 Test Loss: 0.0194664
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0103715
	speed: 0.0406s/iter; left time: 544.6653s
	iters: 200, epoch: 41 | loss: 0.0105630
	speed: 0.0177s/iter; left time: 235.3172s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0115057 Vali Loss: 0.0154118 Test Loss: 0.0195385
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0116243
	speed: 0.0414s/iter; left time: 546.0989s
	iters: 200, epoch: 42 | loss: 0.0111042
	speed: 0.0176s/iter; left time: 230.1162s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.20s
Steps: 225 | Train Loss: 0.0114945 Vali Loss: 0.0154482 Test Loss: 0.0195912
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0120247
	speed: 0.0407s/iter; left time: 527.4954s
	iters: 200, epoch: 43 | loss: 0.0122419
	speed: 0.0194s/iter; left time: 248.7993s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.64s
Steps: 225 | Train Loss: 0.0115088 Vali Loss: 0.0153739 Test Loss: 0.0193811
Validation loss decreased (0.015393 --> 0.015374).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0123291
	speed: 0.0399s/iter; left time: 507.4273s
	iters: 200, epoch: 44 | loss: 0.0108651
	speed: 0.0178s/iter; left time: 224.7418s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0115130 Vali Loss: 0.0154280 Test Loss: 0.0196132
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0116522
	speed: 0.0400s/iter; left time: 500.3381s
	iters: 200, epoch: 45 | loss: 0.0100763
	speed: 0.0194s/iter; left time: 240.3175s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0115149 Vali Loss: 0.0154189 Test Loss: 0.0195373
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0119316
	speed: 0.0431s/iter; left time: 529.3590s
	iters: 200, epoch: 46 | loss: 0.0121877
	speed: 0.0176s/iter; left time: 214.4317s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0114768 Vali Loss: 0.0154554 Test Loss: 0.0196083
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0123775
	speed: 0.0387s/iter; left time: 466.5767s
	iters: 200, epoch: 47 | loss: 0.0115821
	speed: 0.0168s/iter; left time: 201.2726s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0114788 Vali Loss: 0.0153788 Test Loss: 0.0194893
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0123712
	speed: 0.0459s/iter; left time: 542.5049s
	iters: 200, epoch: 48 | loss: 0.0106740
	speed: 0.0213s/iter; left time: 249.7321s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.12s
Steps: 225 | Train Loss: 0.0115063 Vali Loss: 0.0153871 Test Loss: 0.0194643
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0134893
	speed: 0.0404s/iter; left time: 469.1885s
	iters: 200, epoch: 49 | loss: 0.0116201
	speed: 0.0169s/iter; left time: 194.5966s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.11s
Steps: 225 | Train Loss: 0.0114783 Vali Loss: 0.0154132 Test Loss: 0.0195795
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0116107
	speed: 0.0401s/iter; left time: 455.7130s
	iters: 200, epoch: 50 | loss: 0.0103245
	speed: 0.0196s/iter; left time: 221.3832s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.77s
Steps: 225 | Train Loss: 0.0114765 Vali Loss: 0.0153764 Test Loss: 0.0194849
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0117851
	speed: 0.0446s/iter; left time: 496.9526s
	iters: 200, epoch: 51 | loss: 0.0107125
	speed: 0.0162s/iter; left time: 178.7868s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0114667 Vali Loss: 0.0154133 Test Loss: 0.0194795
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0106644
	speed: 0.0373s/iter; left time: 407.3283s
	iters: 200, epoch: 52 | loss: 0.0115350
	speed: 0.0155s/iter; left time: 167.6295s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0114815 Vali Loss: 0.0153970 Test Loss: 0.0195376
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0115413
	speed: 0.0445s/iter; left time: 475.7675s
	iters: 200, epoch: 53 | loss: 0.0111369
	speed: 0.0204s/iter; left time: 215.7892s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0114722 Vali Loss: 0.0154105 Test Loss: 0.0195179
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019381113350391388, rmse:0.13921606540679932, mae:0.087315134704113, rse:0.5385247468948364
Intermediate time for FR and pred_len 96: 00h:05m:21.19s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1163086
	speed: 0.0407s/iter; left time: 911.0389s
	iters: 200, epoch: 1 | loss: 0.0959582
	speed: 0.0156s/iter; left time: 348.3436s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.1164011 Vali Loss: 0.0671606 Test Loss: 0.0756801
Validation loss decreased (inf --> 0.067161).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0380078
	speed: 0.0387s/iter; left time: 857.1911s
	iters: 200, epoch: 2 | loss: 0.0249385
	speed: 0.0164s/iter; left time: 362.2370s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0402786 Vali Loss: 0.0245649 Test Loss: 0.0294748
Validation loss decreased (0.067161 --> 0.024565).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0198591
	speed: 0.0410s/iter; left time: 899.4307s
	iters: 200, epoch: 3 | loss: 0.0181067
	speed: 0.0217s/iter; left time: 474.2215s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0208037 Vali Loss: 0.0224972 Test Loss: 0.0261129
Validation loss decreased (0.024565 --> 0.022497).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0205366
	speed: 0.0397s/iter; left time: 863.3462s
	iters: 200, epoch: 4 | loss: 0.0180572
	speed: 0.0159s/iter; left time: 342.8854s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.0183149 Vali Loss: 0.0198551 Test Loss: 0.0232241
Validation loss decreased (0.022497 --> 0.019855).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0173023
	speed: 0.0417s/iter; left time: 896.1665s
	iters: 200, epoch: 5 | loss: 0.0153106
	speed: 0.0165s/iter; left time: 353.5063s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0167519 Vali Loss: 0.0186968 Test Loss: 0.0227034
Validation loss decreased (0.019855 --> 0.018697).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0151763
	speed: 0.0472s/iter; left time: 1005.0808s
	iters: 200, epoch: 6 | loss: 0.0169578
	speed: 0.0166s/iter; left time: 350.7544s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0158253 Vali Loss: 0.0187366 Test Loss: 0.0234431
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0141559
	speed: 0.0396s/iter; left time: 833.3195s
	iters: 200, epoch: 7 | loss: 0.0142905
	speed: 0.0173s/iter; left time: 361.9078s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.0150663 Vali Loss: 0.0178995 Test Loss: 0.0225593
Validation loss decreased (0.018697 --> 0.017900).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0129712
	speed: 0.0383s/iter; left time: 797.0842s
	iters: 200, epoch: 8 | loss: 0.0136827
	speed: 0.0230s/iter; left time: 476.7195s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0145871 Vali Loss: 0.0177982 Test Loss: 0.0223871
Validation loss decreased (0.017900 --> 0.017798).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0150651
	speed: 0.0398s/iter; left time: 820.3513s
	iters: 200, epoch: 9 | loss: 0.0142423
	speed: 0.0163s/iter; left time: 333.2855s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0142830 Vali Loss: 0.0177567 Test Loss: 0.0227289
Validation loss decreased (0.017798 --> 0.017757).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0143350
	speed: 0.0377s/iter; left time: 767.3888s
	iters: 200, epoch: 10 | loss: 0.0136892
	speed: 0.0157s/iter; left time: 318.5943s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0140856 Vali Loss: 0.0176054 Test Loss: 0.0224962
Validation loss decreased (0.017757 --> 0.017605).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0144481
	speed: 0.0448s/iter; left time: 903.6252s
	iters: 200, epoch: 11 | loss: 0.0122086
	speed: 0.0167s/iter; left time: 334.6707s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0139002 Vali Loss: 0.0175063 Test Loss: 0.0222891
Validation loss decreased (0.017605 --> 0.017506).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0130901
	speed: 0.0390s/iter; left time: 777.0067s
	iters: 200, epoch: 12 | loss: 0.0136973
	speed: 0.0160s/iter; left time: 317.9730s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0136572 Vali Loss: 0.0174897 Test Loss: 0.0223212
Validation loss decreased (0.017506 --> 0.017490).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0129098
	speed: 0.0392s/iter; left time: 772.1506s
	iters: 200, epoch: 13 | loss: 0.0127208
	speed: 0.0214s/iter; left time: 420.2287s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.0136023 Vali Loss: 0.0174103 Test Loss: 0.0221600
Validation loss decreased (0.017490 --> 0.017410).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0145014
	speed: 0.0417s/iter; left time: 812.7398s
	iters: 200, epoch: 14 | loss: 0.0142842
	speed: 0.0160s/iter; left time: 309.7685s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0134571 Vali Loss: 0.0173082 Test Loss: 0.0219032
Validation loss decreased (0.017410 --> 0.017308).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0122999
	speed: 0.0383s/iter; left time: 737.0365s
	iters: 200, epoch: 15 | loss: 0.0124080
	speed: 0.0159s/iter; left time: 303.9583s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0133875 Vali Loss: 0.0173671 Test Loss: 0.0223021
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0129976
	speed: 0.0471s/iter; left time: 896.2514s
	iters: 200, epoch: 16 | loss: 0.0143465
	speed: 0.0162s/iter; left time: 305.6643s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0132982 Vali Loss: 0.0173716 Test Loss: 0.0222940
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0128105
	speed: 0.0384s/iter; left time: 721.0799s
	iters: 200, epoch: 17 | loss: 0.0133504
	speed: 0.0164s/iter; left time: 307.6095s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0131884 Vali Loss: 0.0171983 Test Loss: 0.0221098
Validation loss decreased (0.017308 --> 0.017198).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0127477
	speed: 0.0390s/iter; left time: 725.3888s
	iters: 200, epoch: 18 | loss: 0.0133616
	speed: 0.0215s/iter; left time: 396.6378s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0131289 Vali Loss: 0.0172486 Test Loss: 0.0223695
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0132135
	speed: 0.0466s/iter; left time: 854.6046s
	iters: 200, epoch: 19 | loss: 0.0139983
	speed: 0.0231s/iter; left time: 420.8309s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.17s
Steps: 225 | Train Loss: 0.0130505 Vali Loss: 0.0171564 Test Loss: 0.0222004
Validation loss decreased (0.017198 --> 0.017156).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0127651
	speed: 0.0384s/iter; left time: 696.5206s
	iters: 200, epoch: 20 | loss: 0.0131906
	speed: 0.0156s/iter; left time: 280.5278s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0130117 Vali Loss: 0.0170236 Test Loss: 0.0218656
Validation loss decreased (0.017156 --> 0.017024).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0132290
	speed: 0.0383s/iter; left time: 685.8056s
	iters: 200, epoch: 21 | loss: 0.0138149
	speed: 0.0153s/iter; left time: 273.2173s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.0129826 Vali Loss: 0.0170017 Test Loss: 0.0218221
Validation loss decreased (0.017024 --> 0.017002).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0138705
	speed: 0.0396s/iter; left time: 700.5474s
	iters: 200, epoch: 22 | loss: 0.0132168
	speed: 0.0226s/iter; left time: 397.4560s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0129330 Vali Loss: 0.0171318 Test Loss: 0.0222023
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0117958
	speed: 0.0405s/iter; left time: 707.4557s
	iters: 200, epoch: 23 | loss: 0.0121447
	speed: 0.0156s/iter; left time: 270.4232s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0128791 Vali Loss: 0.0169629 Test Loss: 0.0218639
Validation loss decreased (0.017002 --> 0.016963).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0117950
	speed: 0.0393s/iter; left time: 677.3486s
	iters: 200, epoch: 24 | loss: 0.0116022
	speed: 0.0155s/iter; left time: 265.2126s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0128464 Vali Loss: 0.0169410 Test Loss: 0.0217760
Validation loss decreased (0.016963 --> 0.016941).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0132211
	speed: 0.0447s/iter; left time: 760.1049s
	iters: 200, epoch: 25 | loss: 0.0133817
	speed: 0.0179s/iter; left time: 302.0139s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0128302 Vali Loss: 0.0170455 Test Loss: 0.0220150
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0118063
	speed: 0.0380s/iter; left time: 637.8996s
	iters: 200, epoch: 26 | loss: 0.0115659
	speed: 0.0158s/iter; left time: 263.3682s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.0127902 Vali Loss: 0.0169368 Test Loss: 0.0216894
Validation loss decreased (0.016941 --> 0.016937).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0110586
	speed: 0.0389s/iter; left time: 644.3470s
	iters: 200, epoch: 27 | loss: 0.0133453
	speed: 0.0208s/iter; left time: 341.6108s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0127443 Vali Loss: 0.0169492 Test Loss: 0.0217148
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0135904
	speed: 0.0429s/iter; left time: 700.4644s
	iters: 200, epoch: 28 | loss: 0.0124276
	speed: 0.0169s/iter; left time: 274.1935s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0127048 Vali Loss: 0.0169174 Test Loss: 0.0216821
Validation loss decreased (0.016937 --> 0.016917).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0128987
	speed: 0.0372s/iter; left time: 598.7599s
	iters: 200, epoch: 29 | loss: 0.0128150
	speed: 0.0155s/iter; left time: 248.1545s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.82s
Steps: 225 | Train Loss: 0.0127015 Vali Loss: 0.0168976 Test Loss: 0.0216197
Validation loss decreased (0.016917 --> 0.016898).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0123768
	speed: 0.0433s/iter; left time: 687.1347s
	iters: 200, epoch: 30 | loss: 0.0126488
	speed: 0.0238s/iter; left time: 375.8884s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.21s
Steps: 225 | Train Loss: 0.0126791 Vali Loss: 0.0169204 Test Loss: 0.0216944
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0132034
	speed: 0.0378s/iter; left time: 591.7431s
	iters: 200, epoch: 31 | loss: 0.0124356
	speed: 0.0154s/iter; left time: 239.7172s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.0126608 Vali Loss: 0.0169443 Test Loss: 0.0217171
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0126917
	speed: 0.0397s/iter; left time: 612.2016s
	iters: 200, epoch: 32 | loss: 0.0139379
	speed: 0.0150s/iter; left time: 230.5296s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0126862 Vali Loss: 0.0168743 Test Loss: 0.0216627
Validation loss decreased (0.016898 --> 0.016874).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0121382
	speed: 0.0487s/iter; left time: 740.9962s
	iters: 200, epoch: 33 | loss: 0.0134788
	speed: 0.0159s/iter; left time: 240.5201s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0126394 Vali Loss: 0.0168715 Test Loss: 0.0216864
Validation loss decreased (0.016874 --> 0.016871).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0133380
	speed: 0.0386s/iter; left time: 577.5417s
	iters: 200, epoch: 34 | loss: 0.0120537
	speed: 0.0158s/iter; left time: 235.2861s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0126101 Vali Loss: 0.0168341 Test Loss: 0.0216229
Validation loss decreased (0.016871 --> 0.016834).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0127342
	speed: 0.0386s/iter; left time: 569.5485s
	iters: 200, epoch: 35 | loss: 0.0137883
	speed: 0.0204s/iter; left time: 299.0700s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0126581 Vali Loss: 0.0168800 Test Loss: 0.0216368
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0129292
	speed: 0.0430s/iter; left time: 625.1072s
	iters: 200, epoch: 36 | loss: 0.0142377
	speed: 0.0158s/iter; left time: 227.8650s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0126065 Vali Loss: 0.0168263 Test Loss: 0.0216261
Validation loss decreased (0.016834 --> 0.016826).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0144185
	speed: 0.0388s/iter; left time: 554.9932s
	iters: 200, epoch: 37 | loss: 0.0119868
	speed: 0.0151s/iter; left time: 215.1416s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0125955 Vali Loss: 0.0169518 Test Loss: 0.0218011
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0122964
	speed: 0.0443s/iter; left time: 623.1646s
	iters: 200, epoch: 38 | loss: 0.0118971
	speed: 0.0211s/iter; left time: 295.5919s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.05s
Steps: 225 | Train Loss: 0.0125857 Vali Loss: 0.0168467 Test Loss: 0.0216006
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0128205
	speed: 0.0403s/iter; left time: 558.1238s
	iters: 200, epoch: 39 | loss: 0.0116396
	speed: 0.0167s/iter; left time: 229.2487s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.0125828 Vali Loss: 0.0168230 Test Loss: 0.0214886
Validation loss decreased (0.016826 --> 0.016823).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0135852
	speed: 0.0387s/iter; left time: 527.0576s
	iters: 200, epoch: 40 | loss: 0.0120434
	speed: 0.0207s/iter; left time: 279.9543s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.79s
Steps: 225 | Train Loss: 0.0125880 Vali Loss: 0.0168890 Test Loss: 0.0216618
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0116446
	speed: 0.0483s/iter; left time: 646.7323s
	iters: 200, epoch: 41 | loss: 0.0124125
	speed: 0.0173s/iter; left time: 229.7905s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.0125534 Vali Loss: 0.0168535 Test Loss: 0.0215649
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0124781
	speed: 0.0422s/iter; left time: 555.5906s
	iters: 200, epoch: 42 | loss: 0.0123067
	speed: 0.0213s/iter; left time: 278.2179s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.85s
Steps: 225 | Train Loss: 0.0125586 Vali Loss: 0.0168594 Test Loss: 0.0216211
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0127494
	speed: 0.0471s/iter; left time: 610.3690s
	iters: 200, epoch: 43 | loss: 0.0140274
	speed: 0.0223s/iter; left time: 286.8690s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.36s
Steps: 225 | Train Loss: 0.0125723 Vali Loss: 0.0168140 Test Loss: 0.0215049
Validation loss decreased (0.016823 --> 0.016814).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0122186
	speed: 0.0391s/iter; left time: 497.0265s
	iters: 200, epoch: 44 | loss: 0.0118770
	speed: 0.0164s/iter; left time: 206.4759s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0125745 Vali Loss: 0.0167932 Test Loss: 0.0215052
Validation loss decreased (0.016814 --> 0.016793).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0120009
	speed: 0.0387s/iter; left time: 483.6525s
	iters: 200, epoch: 45 | loss: 0.0124589
	speed: 0.0197s/iter; left time: 243.7141s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0125587 Vali Loss: 0.0168187 Test Loss: 0.0215558
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0133484
	speed: 0.0488s/iter; left time: 598.8816s
	iters: 200, epoch: 46 | loss: 0.0134764
	speed: 0.0162s/iter; left time: 197.7391s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.14s
Steps: 225 | Train Loss: 0.0125362 Vali Loss: 0.0168852 Test Loss: 0.0217203
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0124050
	speed: 0.0387s/iter; left time: 466.7395s
	iters: 200, epoch: 47 | loss: 0.0133607
	speed: 0.0158s/iter; left time: 189.2435s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.94s
Steps: 225 | Train Loss: 0.0125397 Vali Loss: 0.0167599 Test Loss: 0.0214477
Validation loss decreased (0.016793 --> 0.016760).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0133222
	speed: 0.0450s/iter; left time: 532.3111s
	iters: 200, epoch: 48 | loss: 0.0111298
	speed: 0.0214s/iter; left time: 251.0576s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.13s
Steps: 225 | Train Loss: 0.0125691 Vali Loss: 0.0169273 Test Loss: 0.0217705
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0110154
	speed: 0.0456s/iter; left time: 528.4407s
	iters: 200, epoch: 49 | loss: 0.0124768
	speed: 0.0225s/iter; left time: 259.1402s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.40s
Steps: 225 | Train Loss: 0.0125564 Vali Loss: 0.0168432 Test Loss: 0.0215787
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0128464
	speed: 0.0424s/iter; left time: 482.3756s
	iters: 200, epoch: 50 | loss: 0.0131624
	speed: 0.0222s/iter; left time: 250.6670s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.17s
Steps: 225 | Train Loss: 0.0125534 Vali Loss: 0.0168483 Test Loss: 0.0216448
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0111215
	speed: 0.0430s/iter; left time: 479.0803s
	iters: 200, epoch: 51 | loss: 0.0122721
	speed: 0.0172s/iter; left time: 190.1557s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.0125398 Vali Loss: 0.0168382 Test Loss: 0.0215763
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0140247
	speed: 0.0411s/iter; left time: 449.1896s
	iters: 200, epoch: 52 | loss: 0.0110990
	speed: 0.0162s/iter; left time: 174.8441s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.0125283 Vali Loss: 0.0168521 Test Loss: 0.0215805
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0119962
	speed: 0.0444s/iter; left time: 475.1415s
	iters: 200, epoch: 53 | loss: 0.0125828
	speed: 0.0201s/iter; left time: 212.8281s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0125533 Vali Loss: 0.0168662 Test Loss: 0.0217082
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0110893
	speed: 0.0394s/iter; left time: 413.0468s
	iters: 200, epoch: 54 | loss: 0.0135871
	speed: 0.0163s/iter; left time: 169.4941s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0125420 Vali Loss: 0.0168111 Test Loss: 0.0215567
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0126214
	speed: 0.0407s/iter; left time: 417.3350s
	iters: 200, epoch: 55 | loss: 0.0112188
	speed: 0.0192s/iter; left time: 194.5268s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0125635 Vali Loss: 0.0168251 Test Loss: 0.0216542
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0120411
	speed: 0.0409s/iter; left time: 409.6515s
	iters: 200, epoch: 56 | loss: 0.0110059
	speed: 0.0184s/iter; left time: 182.2896s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0125221 Vali Loss: 0.0169018 Test Loss: 0.0217581
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0125544
	speed: 0.0399s/iter; left time: 391.1170s
	iters: 200, epoch: 57 | loss: 0.0121166
	speed: 0.0164s/iter; left time: 158.8493s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.00s
Steps: 225 | Train Loss: 0.0125559 Vali Loss: 0.0168544 Test Loss: 0.0216700
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021447671577334404, rmse:0.1464502364397049, mae:0.09291932731866837, rse:0.567215621471405
Intermediate time for FR and pred_len 168: 00h:05m:47.83s
Intermediate time for FR: 00h:20m:19.96s

=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1377798
	speed: 0.0314s/iter; left time: 707.1201s
	iters: 200, epoch: 1 | loss: 0.1134172
	speed: 0.0169s/iter; left time: 378.1894s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.1356952 Vali Loss: 0.0691775 Test Loss: 0.0705373
Validation loss decreased (inf --> 0.069177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0454729
	speed: 0.0403s/iter; left time: 897.9605s
	iters: 200, epoch: 2 | loss: 0.0281168
	speed: 0.0166s/iter; left time: 367.4979s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.15s
Steps: 226 | Train Loss: 0.0508938 Vali Loss: 0.0187556 Test Loss: 0.0189566
Validation loss decreased (0.069177 --> 0.018756).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0249880
	speed: 0.0380s/iter; left time: 837.9958s
	iters: 200, epoch: 3 | loss: 0.0227560
	speed: 0.0156s/iter; left time: 343.0872s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.89s
Steps: 226 | Train Loss: 0.0242646 Vali Loss: 0.0175866 Test Loss: 0.0178655
Validation loss decreased (0.018756 --> 0.017587).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0204239
	speed: 0.0374s/iter; left time: 816.9283s
	iters: 200, epoch: 4 | loss: 0.0167463
	speed: 0.0181s/iter; left time: 392.6846s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0206555 Vali Loss: 0.0154143 Test Loss: 0.0155426
Validation loss decreased (0.017587 --> 0.015414).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0191221
	speed: 0.0401s/iter; left time: 865.8100s
	iters: 200, epoch: 5 | loss: 0.0179364
	speed: 0.0166s/iter; left time: 356.6793s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0187411 Vali Loss: 0.0150593 Test Loss: 0.0152536
Validation loss decreased (0.015414 --> 0.015059).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0172716
	speed: 0.0366s/iter; left time: 781.9464s
	iters: 200, epoch: 6 | loss: 0.0160908
	speed: 0.0158s/iter; left time: 335.3546s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0173488 Vali Loss: 0.0142850 Test Loss: 0.0140409
Validation loss decreased (0.015059 --> 0.014285).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0192723
	speed: 0.0388s/iter; left time: 821.4624s
	iters: 200, epoch: 7 | loss: 0.0155777
	speed: 0.0155s/iter; left time: 325.4104s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.84s
Steps: 226 | Train Loss: 0.0162256 Vali Loss: 0.0136374 Test Loss: 0.0131467
Validation loss decreased (0.014285 --> 0.013637).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0142089
	speed: 0.0372s/iter; left time: 778.5808s
	iters: 200, epoch: 8 | loss: 0.0156101
	speed: 0.0154s/iter; left time: 321.6397s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0153529 Vali Loss: 0.0132084 Test Loss: 0.0128746
Validation loss decreased (0.013637 --> 0.013208).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0145481
	speed: 0.0356s/iter; left time: 737.3247s
	iters: 200, epoch: 9 | loss: 0.0146893
	speed: 0.0176s/iter; left time: 363.1967s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0145578 Vali Loss: 0.0127671 Test Loss: 0.0125622
Validation loss decreased (0.013208 --> 0.012767).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0143092
	speed: 0.0400s/iter; left time: 817.7824s
	iters: 200, epoch: 10 | loss: 0.0153943
	speed: 0.0153s/iter; left time: 311.9292s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.91s
Steps: 226 | Train Loss: 0.0139438 Vali Loss: 0.0124113 Test Loss: 0.0123004
Validation loss decreased (0.012767 --> 0.012411).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0136494
	speed: 0.0383s/iter; left time: 774.2644s
	iters: 200, epoch: 11 | loss: 0.0137830
	speed: 0.0154s/iter; left time: 311.1302s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0135146 Vali Loss: 0.0120716 Test Loss: 0.0119796
Validation loss decreased (0.012411 --> 0.012072).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0143659
	speed: 0.0392s/iter; left time: 783.6507s
	iters: 200, epoch: 12 | loss: 0.0141641
	speed: 0.0160s/iter; left time: 319.1634s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0132291 Vali Loss: 0.0119187 Test Loss: 0.0118970
Validation loss decreased (0.012072 --> 0.011919).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0125218
	speed: 0.0374s/iter; left time: 739.4350s
	iters: 200, epoch: 13 | loss: 0.0105008
	speed: 0.0155s/iter; left time: 306.1304s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.72s
Steps: 226 | Train Loss: 0.0128624 Vali Loss: 0.0116479 Test Loss: 0.0117148
Validation loss decreased (0.011919 --> 0.011648).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0129370
	speed: 0.0386s/iter; left time: 755.8248s
	iters: 200, epoch: 14 | loss: 0.0128722
	speed: 0.0188s/iter; left time: 365.2389s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0126495 Vali Loss: 0.0116615 Test Loss: 0.0116488
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0116378
	speed: 0.0387s/iter; left time: 748.0828s
	iters: 200, epoch: 15 | loss: 0.0139435
	speed: 0.0166s/iter; left time: 318.6525s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.97s
Steps: 226 | Train Loss: 0.0124032 Vali Loss: 0.0113834 Test Loss: 0.0114933
Validation loss decreased (0.011648 --> 0.011383).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0125016
	speed: 0.0367s/iter; left time: 701.9640s
	iters: 200, epoch: 16 | loss: 0.0106876
	speed: 0.0158s/iter; left time: 299.9581s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.76s
Steps: 226 | Train Loss: 0.0122276 Vali Loss: 0.0113101 Test Loss: 0.0114584
Validation loss decreased (0.011383 --> 0.011310).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0115151
	speed: 0.0387s/iter; left time: 731.5339s
	iters: 200, epoch: 17 | loss: 0.0120240
	speed: 0.0162s/iter; left time: 305.2480s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0120420 Vali Loss: 0.0112633 Test Loss: 0.0113524
Validation loss decreased (0.011310 --> 0.011263).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0127090
	speed: 0.0381s/iter; left time: 710.4053s
	iters: 200, epoch: 18 | loss: 0.0114372
	speed: 0.0158s/iter; left time: 292.6143s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.80s
Steps: 226 | Train Loss: 0.0119783 Vali Loss: 0.0111370 Test Loss: 0.0113526
Validation loss decreased (0.011263 --> 0.011137).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0128387
	speed: 0.0366s/iter; left time: 674.8819s
	iters: 200, epoch: 19 | loss: 0.0113665
	speed: 0.0160s/iter; left time: 292.4530s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.97s
Steps: 226 | Train Loss: 0.0118393 Vali Loss: 0.0110697 Test Loss: 0.0112947
Validation loss decreased (0.011137 --> 0.011070).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0107364
	speed: 0.0411s/iter; left time: 748.1290s
	iters: 200, epoch: 20 | loss: 0.0134741
	speed: 0.0162s/iter; left time: 292.8654s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0116963 Vali Loss: 0.0109283 Test Loss: 0.0112035
Validation loss decreased (0.011070 --> 0.010928).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0119992
	speed: 0.0371s/iter; left time: 667.2474s
	iters: 200, epoch: 21 | loss: 0.0122915
	speed: 0.0162s/iter; left time: 289.3438s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0116031 Vali Loss: 0.0109897 Test Loss: 0.0112439
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0104237
	speed: 0.0400s/iter; left time: 709.7304s
	iters: 200, epoch: 22 | loss: 0.0119740
	speed: 0.0196s/iter; left time: 345.3108s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.49s
Steps: 226 | Train Loss: 0.0115132 Vali Loss: 0.0108854 Test Loss: 0.0111452
Validation loss decreased (0.010928 --> 0.010885).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0096794
	speed: 0.0427s/iter; left time: 747.6887s
	iters: 200, epoch: 23 | loss: 0.0107608
	speed: 0.0175s/iter; left time: 304.7474s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.49s
Steps: 226 | Train Loss: 0.0114976 Vali Loss: 0.0107883 Test Loss: 0.0111224
Validation loss decreased (0.010885 --> 0.010788).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0098029
	speed: 0.0372s/iter; left time: 643.5511s
	iters: 200, epoch: 24 | loss: 0.0121425
	speed: 0.0159s/iter; left time: 274.0367s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0114222 Vali Loss: 0.0107622 Test Loss: 0.0111308
Validation loss decreased (0.010788 --> 0.010762).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0106548
	speed: 0.0396s/iter; left time: 676.6428s
	iters: 200, epoch: 25 | loss: 0.0118627
	speed: 0.0156s/iter; left time: 264.3130s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0113376 Vali Loss: 0.0107183 Test Loss: 0.0110923
Validation loss decreased (0.010762 --> 0.010718).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0095081
	speed: 0.0400s/iter; left time: 674.5490s
	iters: 200, epoch: 26 | loss: 0.0126063
	speed: 0.0240s/iter; left time: 402.0363s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.23s
Steps: 226 | Train Loss: 0.0113432 Vali Loss: 0.0106847 Test Loss: 0.0110543
Validation loss decreased (0.010718 --> 0.010685).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0102837
	speed: 0.0411s/iter; left time: 682.6351s
	iters: 200, epoch: 27 | loss: 0.0128509
	speed: 0.0154s/iter; left time: 253.7999s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.83s
Steps: 226 | Train Loss: 0.0112524 Vali Loss: 0.0106316 Test Loss: 0.0110191
Validation loss decreased (0.010685 --> 0.010632).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0112080
	speed: 0.0379s/iter; left time: 621.3778s
	iters: 200, epoch: 28 | loss: 0.0097912
	speed: 0.0160s/iter; left time: 261.3668s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0112507 Vali Loss: 0.0106654 Test Loss: 0.0110507
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0117082
	speed: 0.0456s/iter; left time: 737.3555s
	iters: 200, epoch: 29 | loss: 0.0121781
	speed: 0.0150s/iter; left time: 240.7264s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0112207 Vali Loss: 0.0106669 Test Loss: 0.0110702
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0096842
	speed: 0.0361s/iter; left time: 575.5568s
	iters: 200, epoch: 30 | loss: 0.0130751
	speed: 0.0153s/iter; left time: 242.5021s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.74s
Steps: 226 | Train Loss: 0.0111561 Vali Loss: 0.0106135 Test Loss: 0.0109990
Validation loss decreased (0.010632 --> 0.010614).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0104511
	speed: 0.0394s/iter; left time: 618.7753s
	iters: 200, epoch: 31 | loss: 0.0122376
	speed: 0.0193s/iter; left time: 301.8339s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.48s
Steps: 226 | Train Loss: 0.0111730 Vali Loss: 0.0105777 Test Loss: 0.0109957
Validation loss decreased (0.010614 --> 0.010578).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0099746
	speed: 0.0429s/iter; left time: 665.1567s
	iters: 200, epoch: 32 | loss: 0.0106001
	speed: 0.0168s/iter; left time: 259.0305s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.01s
Steps: 226 | Train Loss: 0.0111217 Vali Loss: 0.0105124 Test Loss: 0.0109593
Validation loss decreased (0.010578 --> 0.010512).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0115203
	speed: 0.0366s/iter; left time: 559.4682s
	iters: 200, epoch: 33 | loss: 0.0115479
	speed: 0.0152s/iter; left time: 231.3184s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0111433 Vali Loss: 0.0105266 Test Loss: 0.0109338
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0098360
	speed: 0.0469s/iter; left time: 706.2570s
	iters: 200, epoch: 34 | loss: 0.0118058
	speed: 0.0164s/iter; left time: 244.6445s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.61s
Steps: 226 | Train Loss: 0.0110997 Vali Loss: 0.0105341 Test Loss: 0.0109536
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0106727
	speed: 0.0352s/iter; left time: 521.5914s
	iters: 200, epoch: 35 | loss: 0.0121903
	speed: 0.0168s/iter; left time: 246.5298s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.88s
Steps: 226 | Train Loss: 0.0110825 Vali Loss: 0.0105078 Test Loss: 0.0109191
Validation loss decreased (0.010512 --> 0.010508).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0109003
	speed: 0.0425s/iter; left time: 620.2390s
	iters: 200, epoch: 36 | loss: 0.0107535
	speed: 0.0212s/iter; left time: 307.8069s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0110776 Vali Loss: 0.0104943 Test Loss: 0.0109287
Validation loss decreased (0.010508 --> 0.010494).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0111721
	speed: 0.0437s/iter; left time: 627.5663s
	iters: 200, epoch: 37 | loss: 0.0111821
	speed: 0.0165s/iter; left time: 235.6323s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0110402 Vali Loss: 0.0104634 Test Loss: 0.0109022
Validation loss decreased (0.010494 --> 0.010463).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0107937
	speed: 0.0412s/iter; left time: 583.2147s
	iters: 200, epoch: 38 | loss: 0.0121695
	speed: 0.0154s/iter; left time: 216.5530s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0110640 Vali Loss: 0.0104891 Test Loss: 0.0109258
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0102771
	speed: 0.0486s/iter; left time: 675.8196s
	iters: 200, epoch: 39 | loss: 0.0103673
	speed: 0.0199s/iter; left time: 274.8001s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.07s
Steps: 226 | Train Loss: 0.0110183 Vali Loss: 0.0104331 Test Loss: 0.0108840
Validation loss decreased (0.010463 --> 0.010433).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0122261
	speed: 0.0368s/iter; left time: 504.2283s
	iters: 200, epoch: 40 | loss: 0.0112992
	speed: 0.0182s/iter; left time: 247.8934s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0110450 Vali Loss: 0.0104266 Test Loss: 0.0109060
Validation loss decreased (0.010433 --> 0.010427).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0105818
	speed: 0.0376s/iter; left time: 506.4033s
	iters: 200, epoch: 41 | loss: 0.0132477
	speed: 0.0219s/iter; left time: 292.4338s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.76s
Steps: 226 | Train Loss: 0.0110133 Vali Loss: 0.0104213 Test Loss: 0.0108878
Validation loss decreased (0.010427 --> 0.010421).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0100628
	speed: 0.0434s/iter; left time: 574.7919s
	iters: 200, epoch: 42 | loss: 0.0111368
	speed: 0.0186s/iter; left time: 243.9086s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.50s
Steps: 226 | Train Loss: 0.0109489 Vali Loss: 0.0104123 Test Loss: 0.0108733
Validation loss decreased (0.010421 --> 0.010412).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0115083
	speed: 0.0402s/iter; left time: 522.8612s
	iters: 200, epoch: 43 | loss: 0.0104760
	speed: 0.0185s/iter; left time: 239.0482s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0109990 Vali Loss: 0.0103668 Test Loss: 0.0108622
Validation loss decreased (0.010412 --> 0.010367).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0111897
	speed: 0.0484s/iter; left time: 618.6437s
	iters: 200, epoch: 44 | loss: 0.0107037
	speed: 0.0172s/iter; left time: 218.4136s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.32s
Steps: 226 | Train Loss: 0.0110186 Vali Loss: 0.0104406 Test Loss: 0.0108855
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0110654
	speed: 0.0381s/iter; left time: 478.3879s
	iters: 200, epoch: 45 | loss: 0.0112306
	speed: 0.0153s/iter; left time: 190.6268s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.0110232 Vali Loss: 0.0103820 Test Loss: 0.0108644
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0123103
	speed: 0.0368s/iter; left time: 454.1900s
	iters: 200, epoch: 46 | loss: 0.0101690
	speed: 0.0212s/iter; left time: 259.1501s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.65s
Steps: 226 | Train Loss: 0.0109794 Vali Loss: 0.0104060 Test Loss: 0.0108795
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0109692
	speed: 0.0389s/iter; left time: 470.5442s
	iters: 200, epoch: 47 | loss: 0.0125076
	speed: 0.0162s/iter; left time: 194.4782s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.91s
Steps: 226 | Train Loss: 0.0109345 Vali Loss: 0.0103910 Test Loss: 0.0108578
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0114056
	speed: 0.0374s/iter; left time: 444.4565s
	iters: 200, epoch: 48 | loss: 0.0106638
	speed: 0.0172s/iter; left time: 202.0412s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0109523 Vali Loss: 0.0104009 Test Loss: 0.0108567
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0106638
	speed: 0.0453s/iter; left time: 528.1298s
	iters: 200, epoch: 49 | loss: 0.0125533
	speed: 0.0154s/iter; left time: 177.8244s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0109971 Vali Loss: 0.0104058 Test Loss: 0.0108558
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0118140
	speed: 0.0383s/iter; left time: 438.2017s
	iters: 200, epoch: 50 | loss: 0.0120683
	speed: 0.0156s/iter; left time: 176.2724s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0109812 Vali Loss: 0.0104026 Test Loss: 0.0108490
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0122474
	speed: 0.0415s/iter; left time: 464.7840s
	iters: 200, epoch: 51 | loss: 0.0104948
	speed: 0.0204s/iter; left time: 226.8309s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.81s
Steps: 226 | Train Loss: 0.0109754 Vali Loss: 0.0103916 Test Loss: 0.0108564
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0111523
	speed: 0.0487s/iter; left time: 534.3213s
	iters: 200, epoch: 52 | loss: 0.0121978
	speed: 0.0230s/iter; left time: 250.0751s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.31s
Steps: 226 | Train Loss: 0.0109734 Vali Loss: 0.0103702 Test Loss: 0.0108537
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0112344
	speed: 0.0447s/iter; left time: 480.0841s
	iters: 200, epoch: 53 | loss: 0.0115661
	speed: 0.0268s/iter; left time: 285.0449s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.91s
Steps: 226 | Train Loss: 0.0109682 Vali Loss: 0.0103765 Test Loss: 0.0108480
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01086221169680357, rmse:0.10422193259000778, mae:0.06578190624713898, rse:0.3938033878803253
Intermediate time for IT and pred_len 24: 00h:05m:10.46s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1392661
	speed: 0.0307s/iter; left time: 688.2546s
	iters: 200, epoch: 1 | loss: 0.1204742
	speed: 0.0182s/iter; left time: 406.0846s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.1416145 Vali Loss: 0.0775000 Test Loss: 0.0788219
Validation loss decreased (inf --> 0.077500).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0494399
	speed: 0.0501s/iter; left time: 1111.1051s
	iters: 200, epoch: 2 | loss: 0.0351452
	speed: 0.0159s/iter; left time: 351.1722s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0541683 Vali Loss: 0.0280526 Test Loss: 0.0307065
Validation loss decreased (0.077500 --> 0.028053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0307060
	speed: 0.0398s/iter; left time: 873.9285s
	iters: 200, epoch: 3 | loss: 0.0298869
	speed: 0.0187s/iter; left time: 408.9647s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0315663 Vali Loss: 0.0246129 Test Loss: 0.0260684
Validation loss decreased (0.028053 --> 0.024613).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0269790
	speed: 0.0395s/iter; left time: 857.2184s
	iters: 200, epoch: 4 | loss: 0.0263730
	speed: 0.0246s/iter; left time: 532.0685s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.0273871 Vali Loss: 0.0219977 Test Loss: 0.0225720
Validation loss decreased (0.024613 --> 0.021998).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0226175
	speed: 0.0406s/iter; left time: 872.2530s
	iters: 200, epoch: 5 | loss: 0.0209078
	speed: 0.0154s/iter; left time: 328.9814s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0243868 Vali Loss: 0.0199966 Test Loss: 0.0200491
Validation loss decreased (0.021998 --> 0.019997).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0221272
	speed: 0.0414s/iter; left time: 880.3996s
	iters: 200, epoch: 6 | loss: 0.0230589
	speed: 0.0164s/iter; left time: 346.6339s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.0224359 Vali Loss: 0.0190496 Test Loss: 0.0193386
Validation loss decreased (0.019997 --> 0.019050).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0198746
	speed: 0.0531s/iter; left time: 1118.7714s
	iters: 200, epoch: 7 | loss: 0.0217593
	speed: 0.0159s/iter; left time: 333.1639s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.59s
Steps: 225 | Train Loss: 0.0213778 Vali Loss: 0.0183945 Test Loss: 0.0188222
Validation loss decreased (0.019050 --> 0.018394).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0216212
	speed: 0.0397s/iter; left time: 826.0295s
	iters: 200, epoch: 8 | loss: 0.0201936
	speed: 0.0155s/iter; left time: 320.3548s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0206121 Vali Loss: 0.0181737 Test Loss: 0.0186618
Validation loss decreased (0.018394 --> 0.018174).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0186395
	speed: 0.0385s/iter; left time: 793.5908s
	iters: 200, epoch: 9 | loss: 0.0181642
	speed: 0.0234s/iter; left time: 479.1724s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0200061 Vali Loss: 0.0179292 Test Loss: 0.0186835
Validation loss decreased (0.018174 --> 0.017929).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0188193
	speed: 0.0399s/iter; left time: 812.9797s
	iters: 200, epoch: 10 | loss: 0.0192629
	speed: 0.0192s/iter; left time: 389.1762s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0196039 Vali Loss: 0.0174620 Test Loss: 0.0184903
Validation loss decreased (0.017929 --> 0.017462).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0191812
	speed: 0.0393s/iter; left time: 791.6841s
	iters: 200, epoch: 11 | loss: 0.0187980
	speed: 0.0165s/iter; left time: 331.2367s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0191906 Vali Loss: 0.0173062 Test Loss: 0.0184059
Validation loss decreased (0.017462 --> 0.017306).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0182141
	speed: 0.0501s/iter; left time: 997.6922s
	iters: 200, epoch: 12 | loss: 0.0185133
	speed: 0.0160s/iter; left time: 316.3352s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.77s
Steps: 225 | Train Loss: 0.0188441 Vali Loss: 0.0172411 Test Loss: 0.0183969
Validation loss decreased (0.017306 --> 0.017241).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0194464
	speed: 0.0430s/iter; left time: 847.1020s
	iters: 200, epoch: 13 | loss: 0.0186859
	speed: 0.0170s/iter; left time: 333.6627s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0186049 Vali Loss: 0.0170427 Test Loss: 0.0182708
Validation loss decreased (0.017241 --> 0.017043).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0203162
	speed: 0.0383s/iter; left time: 745.2474s
	iters: 200, epoch: 14 | loss: 0.0189898
	speed: 0.0213s/iter; left time: 412.9784s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.0185252 Vali Loss: 0.0170671 Test Loss: 0.0182412
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0181951
	speed: 0.0438s/iter; left time: 843.1686s
	iters: 200, epoch: 15 | loss: 0.0186964
	speed: 0.0154s/iter; left time: 294.6511s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.0185144 Vali Loss: 0.0168636 Test Loss: 0.0181672
Validation loss decreased (0.017043 --> 0.016864).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0191887
	speed: 0.0386s/iter; left time: 733.9795s
	iters: 200, epoch: 16 | loss: 0.0185525
	speed: 0.0161s/iter; left time: 304.2775s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0181708 Vali Loss: 0.0168464 Test Loss: 0.0181170
Validation loss decreased (0.016864 --> 0.016846).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0163151
	speed: 0.0435s/iter; left time: 817.9885s
	iters: 200, epoch: 17 | loss: 0.0181100
	speed: 0.0170s/iter; left time: 318.0484s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0180505 Vali Loss: 0.0168423 Test Loss: 0.0181461
Validation loss decreased (0.016846 --> 0.016842).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0194149
	speed: 0.0385s/iter; left time: 714.3310s
	iters: 200, epoch: 18 | loss: 0.0171451
	speed: 0.0156s/iter; left time: 289.1414s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.0181414 Vali Loss: 0.0169269 Test Loss: 0.0180586
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0182438
	speed: 0.0373s/iter; left time: 685.1473s
	iters: 200, epoch: 19 | loss: 0.0176386
	speed: 0.0194s/iter; left time: 354.4164s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0179795 Vali Loss: 0.0167794 Test Loss: 0.0180080
Validation loss decreased (0.016842 --> 0.016779).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0172766
	speed: 0.0477s/iter; left time: 864.4272s
	iters: 200, epoch: 20 | loss: 0.0182251
	speed: 0.0157s/iter; left time: 283.8901s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0178784 Vali Loss: 0.0166909 Test Loss: 0.0179906
Validation loss decreased (0.016779 --> 0.016691).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0180581
	speed: 0.0361s/iter; left time: 646.7739s
	iters: 200, epoch: 21 | loss: 0.0151387
	speed: 0.0185s/iter; left time: 329.9807s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.10s
Steps: 225 | Train Loss: 0.0179008 Vali Loss: 0.0167441 Test Loss: 0.0179501
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0192179
	speed: 0.0394s/iter; left time: 697.1273s
	iters: 200, epoch: 22 | loss: 0.0170067
	speed: 0.0236s/iter; left time: 414.3055s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0178270 Vali Loss: 0.0167418 Test Loss: 0.0179967
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0188884
	speed: 0.0380s/iter; left time: 663.6254s
	iters: 200, epoch: 23 | loss: 0.0179435
	speed: 0.0155s/iter; left time: 269.5471s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.82s
Steps: 225 | Train Loss: 0.0178563 Vali Loss: 0.0167881 Test Loss: 0.0179131
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0166721
	speed: 0.0409s/iter; left time: 704.5206s
	iters: 200, epoch: 24 | loss: 0.0167049
	speed: 0.0182s/iter; left time: 311.3412s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.0177363 Vali Loss: 0.0166589 Test Loss: 0.0179240
Validation loss decreased (0.016691 --> 0.016659).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0176328
	speed: 0.0437s/iter; left time: 743.7240s
	iters: 200, epoch: 25 | loss: 0.0188900
	speed: 0.0169s/iter; left time: 285.7572s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0177095 Vali Loss: 0.0166848 Test Loss: 0.0179018
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0192010
	speed: 0.0395s/iter; left time: 662.8999s
	iters: 200, epoch: 26 | loss: 0.0169397
	speed: 0.0162s/iter; left time: 270.7029s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0176629 Vali Loss: 0.0166513 Test Loss: 0.0178868
Validation loss decreased (0.016659 --> 0.016651).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0183525
	speed: 0.0360s/iter; left time: 596.6274s
	iters: 200, epoch: 27 | loss: 0.0177022
	speed: 0.0161s/iter; left time: 265.6034s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0176258 Vali Loss: 0.0166351 Test Loss: 0.0179146
Validation loss decreased (0.016651 --> 0.016635).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0178615
	speed: 0.0470s/iter; left time: 767.7431s
	iters: 200, epoch: 28 | loss: 0.0168865
	speed: 0.0189s/iter; left time: 306.3214s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.0176033 Vali Loss: 0.0166053 Test Loss: 0.0178937
Validation loss decreased (0.016635 --> 0.016605).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0178555
	speed: 0.0448s/iter; left time: 720.5228s
	iters: 200, epoch: 29 | loss: 0.0161150
	speed: 0.0198s/iter; left time: 316.2341s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.13s
Steps: 225 | Train Loss: 0.0177332 Vali Loss: 0.0166127 Test Loss: 0.0179433
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0179884
	speed: 0.0407s/iter; left time: 646.0243s
	iters: 200, epoch: 30 | loss: 0.0178666
	speed: 0.0174s/iter; left time: 274.2310s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0176146 Vali Loss: 0.0166176 Test Loss: 0.0178403
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0168105
	speed: 0.0417s/iter; left time: 653.0652s
	iters: 200, epoch: 31 | loss: 0.0173617
	speed: 0.0166s/iter; left time: 258.5197s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0176003 Vali Loss: 0.0166262 Test Loss: 0.0179176
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0176612
	speed: 0.0419s/iter; left time: 646.9951s
	iters: 200, epoch: 32 | loss: 0.0180373
	speed: 0.0186s/iter; left time: 285.6559s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0175764 Vali Loss: 0.0165676 Test Loss: 0.0178750
Validation loss decreased (0.016605 --> 0.016568).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0189767
	speed: 0.0430s/iter; left time: 654.1170s
	iters: 200, epoch: 33 | loss: 0.0189711
	speed: 0.0186s/iter; left time: 280.9845s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0175471 Vali Loss: 0.0165941 Test Loss: 0.0178602
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0194196
	speed: 0.0400s/iter; left time: 598.6058s
	iters: 200, epoch: 34 | loss: 0.0171694
	speed: 0.0188s/iter; left time: 279.3051s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0177479 Vali Loss: 0.0165743 Test Loss: 0.0179026
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0174454
	speed: 0.0399s/iter; left time: 588.7410s
	iters: 200, epoch: 35 | loss: 0.0170476
	speed: 0.0169s/iter; left time: 248.0224s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.0175278 Vali Loss: 0.0165909 Test Loss: 0.0178695
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0187867
	speed: 0.0420s/iter; left time: 609.7748s
	iters: 200, epoch: 36 | loss: 0.0183198
	speed: 0.0179s/iter; left time: 257.9643s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0174957 Vali Loss: 0.0165789 Test Loss: 0.0178887
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0183138
	speed: 0.0410s/iter; left time: 587.0511s
	iters: 200, epoch: 37 | loss: 0.0150607
	speed: 0.0162s/iter; left time: 229.8148s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.06s
Steps: 225 | Train Loss: 0.0174517 Vali Loss: 0.0165912 Test Loss: 0.0178495
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0182852
	speed: 0.0420s/iter; left time: 590.7422s
	iters: 200, epoch: 38 | loss: 0.0169175
	speed: 0.0171s/iter; left time: 238.8473s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.24s
Steps: 225 | Train Loss: 0.0175080 Vali Loss: 0.0166019 Test Loss: 0.0178501
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0156278
	speed: 0.0421s/iter; left time: 582.4355s
	iters: 200, epoch: 39 | loss: 0.0177135
	speed: 0.0164s/iter; left time: 224.9442s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0174615 Vali Loss: 0.0165793 Test Loss: 0.0178496
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0160366
	speed: 0.0396s/iter; left time: 539.8779s
	iters: 200, epoch: 40 | loss: 0.0179165
	speed: 0.0169s/iter; left time: 228.9658s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.0175011 Vali Loss: 0.0165816 Test Loss: 0.0178705
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0154619
	speed: 0.0416s/iter; left time: 557.3494s
	iters: 200, epoch: 41 | loss: 0.0161167
	speed: 0.0164s/iter; left time: 217.5904s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.25s
Steps: 225 | Train Loss: 0.0175633 Vali Loss: 0.0166112 Test Loss: 0.0177791
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0202491
	speed: 0.0427s/iter; left time: 562.0311s
	iters: 200, epoch: 42 | loss: 0.0169839
	speed: 0.0180s/iter; left time: 235.1703s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.0174733 Vali Loss: 0.0166012 Test Loss: 0.0178329
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01787497289478779, rmse:0.13369731605052948, mae:0.08597136288881302, rse:0.5055239796638489
Intermediate time for IT and pred_len 96: 00h:04m:16.29s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_revin_IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_revin_IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1453078
	speed: 0.0322s/iter; left time: 721.7015s
	iters: 200, epoch: 1 | loss: 0.1207458
	speed: 0.0168s/iter; left time: 374.5495s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.1447215 Vali Loss: 0.0810303 Test Loss: 0.0813294
Validation loss decreased (inf --> 0.081030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0436250
	speed: 0.0401s/iter; left time: 888.7858s
	iters: 200, epoch: 2 | loss: 0.0376781
	speed: 0.0192s/iter; left time: 424.3142s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0535831 Vali Loss: 0.0297240 Test Loss: 0.0314284
Validation loss decreased (0.081030 --> 0.029724).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0338296
	speed: 0.0488s/iter; left time: 1072.2832s
	iters: 200, epoch: 3 | loss: 0.0325195
	speed: 0.0248s/iter; left time: 542.5256s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.69s
Steps: 225 | Train Loss: 0.0330422 Vali Loss: 0.0259590 Test Loss: 0.0272268
Validation loss decreased (0.029724 --> 0.025959).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0318606
	speed: 0.0404s/iter; left time: 878.8154s
	iters: 200, epoch: 4 | loss: 0.0266739
	speed: 0.0237s/iter; left time: 512.9830s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0283657 Vali Loss: 0.0227529 Test Loss: 0.0220421
Validation loss decreased (0.025959 --> 0.022753).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0238208
	speed: 0.0437s/iter; left time: 939.5025s
	iters: 200, epoch: 5 | loss: 0.0228798
	speed: 0.0200s/iter; left time: 427.9773s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.78s
Steps: 225 | Train Loss: 0.0252112 Vali Loss: 0.0213654 Test Loss: 0.0207886
Validation loss decreased (0.022753 --> 0.021365).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0247101
	speed: 0.0426s/iter; left time: 906.8229s
	iters: 200, epoch: 6 | loss: 0.0228858
	speed: 0.0168s/iter; left time: 356.5408s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0235146 Vali Loss: 0.0199140 Test Loss: 0.0200730
Validation loss decreased (0.021365 --> 0.019914).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0229948
	speed: 0.0491s/iter; left time: 1032.5559s
	iters: 200, epoch: 7 | loss: 0.0219986
	speed: 0.0166s/iter; left time: 347.7827s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.0223978 Vali Loss: 0.0194992 Test Loss: 0.0198671
Validation loss decreased (0.019914 --> 0.019499).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0198778
	speed: 0.0511s/iter; left time: 1063.3477s
	iters: 200, epoch: 8 | loss: 0.0218490
	speed: 0.0171s/iter; left time: 353.7793s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0218119 Vali Loss: 0.0193452 Test Loss: 0.0198867
Validation loss decreased (0.019499 --> 0.019345).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0218882
	speed: 0.0493s/iter; left time: 1016.2603s
	iters: 200, epoch: 9 | loss: 0.0207634
	speed: 0.0166s/iter; left time: 340.7163s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0212938 Vali Loss: 0.0188900 Test Loss: 0.0195716
Validation loss decreased (0.019345 --> 0.018890).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0212140
	speed: 0.0479s/iter; left time: 976.0093s
	iters: 200, epoch: 10 | loss: 0.0213589
	speed: 0.0169s/iter; left time: 342.3834s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0206631 Vali Loss: 0.0189463 Test Loss: 0.0195167
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0210216
	speed: 0.0483s/iter; left time: 974.0693s
	iters: 200, epoch: 11 | loss: 0.0209635
	speed: 0.0175s/iter; left time: 350.2636s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0201509 Vali Loss: 0.0184880 Test Loss: 0.0193298
Validation loss decreased (0.018890 --> 0.018488).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0192917
	speed: 0.0490s/iter; left time: 975.5385s
	iters: 200, epoch: 12 | loss: 0.0195717
	speed: 0.0210s/iter; left time: 417.1946s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.81s
Steps: 225 | Train Loss: 0.0199455 Vali Loss: 0.0186785 Test Loss: 0.0193164
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0193675
	speed: 0.0428s/iter; left time: 843.9610s
	iters: 200, epoch: 13 | loss: 0.0198724
	speed: 0.0205s/iter; left time: 401.7550s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.74s
Steps: 225 | Train Loss: 0.0204984 Vali Loss: 0.0184913 Test Loss: 0.0194524
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0189032
	speed: 0.0437s/iter; left time: 851.2255s
	iters: 200, epoch: 14 | loss: 0.0198566
	speed: 0.0202s/iter; left time: 391.6641s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0197242 Vali Loss: 0.0185386 Test Loss: 0.0192303
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0193591
	speed: 0.0432s/iter; left time: 832.3689s
	iters: 200, epoch: 15 | loss: 0.0191613
	speed: 0.0223s/iter; left time: 426.4516s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0195737 Vali Loss: 0.0185342 Test Loss: 0.0192261
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0198897
	speed: 0.0440s/iter; left time: 836.3660s
	iters: 200, epoch: 16 | loss: 0.0210519
	speed: 0.0204s/iter; left time: 386.4928s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0194667 Vali Loss: 0.0184915 Test Loss: 0.0191256
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0184417
	speed: 0.0502s/iter; left time: 943.0232s
	iters: 200, epoch: 17 | loss: 0.0198883
	speed: 0.0249s/iter; left time: 465.5056s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.78s
Steps: 225 | Train Loss: 0.0194164 Vali Loss: 0.0183380 Test Loss: 0.0191246
Validation loss decreased (0.018488 --> 0.018338).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0193421
	speed: 0.0507s/iter; left time: 940.9454s
	iters: 200, epoch: 18 | loss: 0.0193089
	speed: 0.0190s/iter; left time: 351.2651s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.31s
Steps: 225 | Train Loss: 0.0193018 Vali Loss: 0.0183337 Test Loss: 0.0190956
Validation loss decreased (0.018338 --> 0.018334).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0180100
	speed: 0.0474s/iter; left time: 869.4505s
	iters: 200, epoch: 19 | loss: 0.0208043
	speed: 0.0218s/iter; left time: 397.9688s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.12s
Steps: 225 | Train Loss: 0.0192760 Vali Loss: 0.0182659 Test Loss: 0.0190671
Validation loss decreased (0.018334 --> 0.018266).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0189537
	speed: 0.0390s/iter; left time: 707.0205s
	iters: 200, epoch: 20 | loss: 0.0194589
	speed: 0.0259s/iter; left time: 466.8717s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.04s
Steps: 225 | Train Loss: 0.0192607 Vali Loss: 0.0183959 Test Loss: 0.0191063
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0189893
	speed: 0.0404s/iter; left time: 723.1905s
	iters: 200, epoch: 21 | loss: 0.0187753
	speed: 0.0209s/iter; left time: 372.0814s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.84s
Steps: 225 | Train Loss: 0.0192075 Vali Loss: 0.0182782 Test Loss: 0.0190127
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0194451
	speed: 0.0424s/iter; left time: 749.5785s
	iters: 200, epoch: 22 | loss: 0.0195122
	speed: 0.0205s/iter; left time: 360.9811s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.77s
Steps: 225 | Train Loss: 0.0191497 Vali Loss: 0.0182339 Test Loss: 0.0190123
Validation loss decreased (0.018266 --> 0.018234).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0185303
	speed: 0.0445s/iter; left time: 776.8425s
	iters: 200, epoch: 23 | loss: 0.0185139
	speed: 0.0170s/iter; left time: 294.6427s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0191384 Vali Loss: 0.0182579 Test Loss: 0.0190225
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0191628
	speed: 0.0482s/iter; left time: 830.7634s
	iters: 200, epoch: 24 | loss: 0.0272066
	speed: 0.0176s/iter; left time: 300.8628s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0190796 Vali Loss: 0.0184180 Test Loss: 0.0190936
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0196890
	speed: 0.0517s/iter; left time: 878.8391s
	iters: 200, epoch: 25 | loss: 0.0194826
	speed: 0.0183s/iter; left time: 309.8283s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0190040 Vali Loss: 0.0181813 Test Loss: 0.0189833
Validation loss decreased (0.018234 --> 0.018181).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0181253
	speed: 0.0502s/iter; left time: 842.8770s
	iters: 200, epoch: 26 | loss: 0.0187839
	speed: 0.0165s/iter; left time: 274.7301s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.59s
Steps: 225 | Train Loss: 0.0189785 Vali Loss: 0.0181851 Test Loss: 0.0189863
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0186646
	speed: 0.0527s/iter; left time: 872.7093s
	iters: 200, epoch: 27 | loss: 0.0195630
	speed: 0.0177s/iter; left time: 291.2806s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0190600 Vali Loss: 0.0182300 Test Loss: 0.0189839
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0203652
	speed: 0.0537s/iter; left time: 876.7723s
	iters: 200, epoch: 28 | loss: 0.0199740
	speed: 0.0169s/iter; left time: 273.4299s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0189316 Vali Loss: 0.0181757 Test Loss: 0.0189563
Validation loss decreased (0.018181 --> 0.018176).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0206350
	speed: 0.0514s/iter; left time: 828.1764s
	iters: 200, epoch: 29 | loss: 0.0181286
	speed: 0.0175s/iter; left time: 280.2370s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.74s
Steps: 225 | Train Loss: 0.0188996 Vali Loss: 0.0181486 Test Loss: 0.0190109
Validation loss decreased (0.018176 --> 0.018149).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0196977
	speed: 0.0497s/iter; left time: 789.4193s
	iters: 200, epoch: 30 | loss: 0.0200620
	speed: 0.0175s/iter; left time: 275.6010s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0189143 Vali Loss: 0.0181804 Test Loss: 0.0189311
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0180183
	speed: 0.0516s/iter; left time: 807.7268s
	iters: 200, epoch: 31 | loss: 0.0181029
	speed: 0.0168s/iter; left time: 261.7345s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0190194 Vali Loss: 0.0182616 Test Loss: 0.0189574
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0182489
	speed: 0.0499s/iter; left time: 769.0311s
	iters: 200, epoch: 32 | loss: 0.0195527
	speed: 0.0181s/iter; left time: 276.8467s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.67s
Steps: 225 | Train Loss: 0.0190022 Vali Loss: 0.0181670 Test Loss: 0.0189566
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0196477
	speed: 0.0528s/iter; left time: 802.3022s
	iters: 200, epoch: 33 | loss: 0.0195144
	speed: 0.0257s/iter; left time: 388.3721s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.55s
Steps: 225 | Train Loss: 0.0188667 Vali Loss: 0.0181575 Test Loss: 0.0189364
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0190932
	speed: 0.0499s/iter; left time: 746.7050s
	iters: 200, epoch: 34 | loss: 0.0182831
	speed: 0.0291s/iter; left time: 433.1500s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.62s
Steps: 225 | Train Loss: 0.0189012 Vali Loss: 0.0181455 Test Loss: 0.0189204
Validation loss decreased (0.018149 --> 0.018145).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0182164
	speed: 0.0487s/iter; left time: 719.0844s
	iters: 200, epoch: 35 | loss: 0.0195959
	speed: 0.0289s/iter; left time: 423.2001s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.21s
Steps: 225 | Train Loss: 0.0188660 Vali Loss: 0.0181558 Test Loss: 0.0189215
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0192430
	speed: 0.0424s/iter; left time: 615.8216s
	iters: 200, epoch: 36 | loss: 0.0184059
	speed: 0.0267s/iter; left time: 385.5996s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.91s
Steps: 225 | Train Loss: 0.0188386 Vali Loss: 0.0181532 Test Loss: 0.0189139
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0203774
	speed: 0.0496s/iter; left time: 709.7479s
	iters: 200, epoch: 37 | loss: 0.0187826
	speed: 0.0264s/iter; left time: 375.4847s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.34s
Steps: 225 | Train Loss: 0.0188490 Vali Loss: 0.0180972 Test Loss: 0.0189571
Validation loss decreased (0.018145 --> 0.018097).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0191643
	speed: 0.0483s/iter; left time: 680.0791s
	iters: 200, epoch: 38 | loss: 0.0181443
	speed: 0.0251s/iter; left time: 350.3224s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.86s
Steps: 225 | Train Loss: 0.0188056 Vali Loss: 0.0181692 Test Loss: 0.0188996
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0184905
	speed: 0.0479s/iter; left time: 663.5101s
	iters: 200, epoch: 39 | loss: 0.0178740
	speed: 0.0257s/iter; left time: 354.0836s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.09s
Steps: 225 | Train Loss: 0.0188431 Vali Loss: 0.0181344 Test Loss: 0.0189271
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0185107
	speed: 0.0448s/iter; left time: 610.3057s
	iters: 200, epoch: 40 | loss: 0.0184007
	speed: 0.0244s/iter; left time: 330.5293s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.62s
Steps: 225 | Train Loss: 0.0188096 Vali Loss: 0.0181285 Test Loss: 0.0189206
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0174925
	speed: 0.0467s/iter; left time: 625.9813s
	iters: 200, epoch: 41 | loss: 0.0192582
	speed: 0.0243s/iter; left time: 323.8159s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.60s
Steps: 225 | Train Loss: 0.0187985 Vali Loss: 0.0181139 Test Loss: 0.0189121
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0177357
	speed: 0.0449s/iter; left time: 591.2866s
	iters: 200, epoch: 42 | loss: 0.0188432
	speed: 0.0266s/iter; left time: 347.3000s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.27s
Steps: 225 | Train Loss: 0.0188488 Vali Loss: 0.0180975 Test Loss: 0.0189411
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0186121
	speed: 0.0501s/iter; left time: 648.3163s
	iters: 200, epoch: 43 | loss: 0.0201827
	speed: 0.0275s/iter; left time: 353.3531s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.27s
Steps: 225 | Train Loss: 0.0188482 Vali Loss: 0.0181299 Test Loss: 0.0189098
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0187149
	speed: 0.0450s/iter; left time: 572.1567s
	iters: 200, epoch: 44 | loss: 0.0181006
	speed: 0.0281s/iter; left time: 354.7640s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.28s
Steps: 225 | Train Loss: 0.0187628 Vali Loss: 0.0180758 Test Loss: 0.0189177
Validation loss decreased (0.018097 --> 0.018076).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0181435
	speed: 0.0521s/iter; left time: 651.6721s
	iters: 200, epoch: 45 | loss: 0.0196680
	speed: 0.0259s/iter; left time: 320.9418s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.29s
Steps: 225 | Train Loss: 0.0187586 Vali Loss: 0.0181032 Test Loss: 0.0189198
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0186186
	speed: 0.0465s/iter; left time: 570.3167s
	iters: 200, epoch: 46 | loss: 0.0185255
	speed: 0.0270s/iter; left time: 328.8205s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.00s
Steps: 225 | Train Loss: 0.0187782 Vali Loss: 0.0180834 Test Loss: 0.0189319
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0172828
	speed: 0.0475s/iter; left time: 572.9542s
	iters: 200, epoch: 47 | loss: 0.0193958
	speed: 0.0273s/iter; left time: 325.8086s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.27s
Steps: 225 | Train Loss: 0.0187856 Vali Loss: 0.0181030 Test Loss: 0.0188926
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0187976
	speed: 0.0485s/iter; left time: 573.2992s
	iters: 200, epoch: 48 | loss: 0.0174188
	speed: 0.0286s/iter; left time: 335.1820s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.26s
Steps: 225 | Train Loss: 0.0187455 Vali Loss: 0.0180691 Test Loss: 0.0189094
Validation loss decreased (0.018076 --> 0.018069).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0197352
	speed: 0.0501s/iter; left time: 580.8285s
	iters: 200, epoch: 49 | loss: 0.0174863
	speed: 0.0289s/iter; left time: 332.1918s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.59s
Steps: 225 | Train Loss: 0.0188050 Vali Loss: 0.0181176 Test Loss: 0.0188957
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0180126
	speed: 0.0503s/iter; left time: 572.6959s
	iters: 200, epoch: 50 | loss: 0.0206608
	speed: 0.0273s/iter; left time: 308.2766s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.18s
Steps: 225 | Train Loss: 0.0188263 Vali Loss: 0.0180650 Test Loss: 0.0188972
Validation loss decreased (0.018069 --> 0.018065).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0170122
	speed: 0.0449s/iter; left time: 500.5756s
	iters: 200, epoch: 51 | loss: 0.0184574
	speed: 0.0283s/iter; left time: 312.7791s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.17s
Steps: 225 | Train Loss: 0.0188780 Vali Loss: 0.0181203 Test Loss: 0.0189263
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0204459
	speed: 0.0498s/iter; left time: 543.9412s
	iters: 200, epoch: 52 | loss: 0.0183172
	speed: 0.0249s/iter; left time: 269.6140s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.06s
Steps: 225 | Train Loss: 0.0187591 Vali Loss: 0.0180762 Test Loss: 0.0188945
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0190909
	speed: 0.0462s/iter; left time: 494.3914s
	iters: 200, epoch: 53 | loss: 0.0182948
	speed: 0.0249s/iter; left time: 264.4795s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.89s
Steps: 225 | Train Loss: 0.0187505 Vali Loss: 0.0180655 Test Loss: 0.0189294
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0201165
	speed: 0.0467s/iter; left time: 488.9342s
	iters: 200, epoch: 54 | loss: 0.0195936
	speed: 0.0162s/iter; left time: 167.7459s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.59s
Steps: 225 | Train Loss: 0.0187627 Vali Loss: 0.0180803 Test Loss: 0.0189013
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0197573
	speed: 0.0428s/iter; left time: 439.1817s
	iters: 200, epoch: 55 | loss: 0.0185649
	speed: 0.0158s/iter; left time: 160.4360s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.19s
Steps: 225 | Train Loss: 0.0187140 Vali Loss: 0.0180478 Test Loss: 0.0189054
Validation loss decreased (0.018065 --> 0.018048).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0179772
	speed: 0.0431s/iter; left time: 432.5783s
	iters: 200, epoch: 56 | loss: 0.0185630
	speed: 0.0171s/iter; left time: 170.1690s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0189897 Vali Loss: 0.0180521 Test Loss: 0.0189287
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0185743
	speed: 0.0437s/iter; left time: 428.2494s
	iters: 200, epoch: 57 | loss: 0.0180025
	speed: 0.0169s/iter; left time: 163.5950s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0188075 Vali Loss: 0.0180966 Test Loss: 0.0189194
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0188034
	speed: 0.0438s/iter; left time: 419.4573s
	iters: 200, epoch: 58 | loss: 0.0187247
	speed: 0.0174s/iter; left time: 165.0577s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0188204 Vali Loss: 0.0180457 Test Loss: 0.0189054
Validation loss decreased (0.018048 --> 0.018046).  Saving model ...
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0192051
	speed: 0.0436s/iter; left time: 407.8222s
	iters: 200, epoch: 59 | loss: 0.0188715
	speed: 0.0152s/iter; left time: 140.5351s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0187089 Vali Loss: 0.0180814 Test Loss: 0.0189237
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0189546
	speed: 0.0413s/iter; left time: 377.1464s
	iters: 200, epoch: 60 | loss: 0.0185984
	speed: 0.0180s/iter; left time: 162.6092s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0187344 Vali Loss: 0.0181039 Test Loss: 0.0189054
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0181787
	speed: 0.0443s/iter; left time: 393.8750s
	iters: 200, epoch: 61 | loss: 0.0182559
	speed: 0.0164s/iter; left time: 144.5154s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0187585 Vali Loss: 0.0180341 Test Loss: 0.0189171
Validation loss decreased (0.018046 --> 0.018034).  Saving model ...
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0185583
	speed: 0.0428s/iter; left time: 371.4303s
	iters: 200, epoch: 62 | loss: 0.0187741
	speed: 0.0184s/iter; left time: 158.0706s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0187532 Vali Loss: 0.0180761 Test Loss: 0.0189095
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0177707
	speed: 0.0457s/iter; left time: 386.6311s
	iters: 200, epoch: 63 | loss: 0.0186384
	speed: 0.0166s/iter; left time: 138.4133s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:04.76s
Steps: 225 | Train Loss: 0.0188340 Vali Loss: 0.0180893 Test Loss: 0.0189124
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0192905
	speed: 0.0433s/iter; left time: 356.1375s
	iters: 200, epoch: 64 | loss: 0.0201995
	speed: 0.0154s/iter; left time: 125.3958s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0187623 Vali Loss: 0.0180487 Test Loss: 0.0189027
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0164961
	speed: 0.0429s/iter; left time: 343.1238s
	iters: 200, epoch: 65 | loss: 0.0189645
	speed: 0.0171s/iter; left time: 135.4261s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0187791 Vali Loss: 0.0180567 Test Loss: 0.0189105
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0186134
	speed: 0.0441s/iter; left time: 342.9573s
	iters: 200, epoch: 66 | loss: 0.0193064
	speed: 0.0168s/iter; left time: 129.1047s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0187621 Vali Loss: 0.0180707 Test Loss: 0.0189063
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0169868
	speed: 0.0444s/iter; left time: 335.2970s
	iters: 200, epoch: 67 | loss: 0.0187755
	speed: 0.0172s/iter; left time: 127.9428s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.0187363 Vali Loss: 0.0180527 Test Loss: 0.0189101
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0205655
	speed: 0.0429s/iter; left time: 314.0892s
	iters: 200, epoch: 68 | loss: 0.0192052
	speed: 0.0156s/iter; left time: 113.0725s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.0187399 Vali Loss: 0.0180342 Test Loss: 0.0189029
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0181332
	speed: 0.0467s/iter; left time: 331.9297s
	iters: 200, epoch: 69 | loss: 0.0181357
	speed: 0.0178s/iter; left time: 124.4025s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0187259 Vali Loss: 0.0180604 Test Loss: 0.0189235
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0190984
	speed: 0.0446s/iter; left time: 306.5891s
	iters: 200, epoch: 70 | loss: 0.0191101
	speed: 0.0157s/iter; left time: 106.6014s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0187441 Vali Loss: 0.0180864 Test Loss: 0.0189139
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.595044557171442e-08
	iters: 100, epoch: 71 | loss: 0.0190680
	speed: 0.0418s/iter; left time: 277.8912s
	iters: 200, epoch: 71 | loss: 0.0193501
	speed: 0.0163s/iter; left time: 106.7338s
-------------------------------------------------------------------------------------
Epoch: 71
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0187691 Vali Loss: 0.0180732 Test Loss: 0.0188935
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_revin_IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.018917052075266838, rmse:0.13753926753997803, mae:0.08967844396829605, rse:0.520534098148346
Intermediate time for IT and pred_len 168: 00h:08m:05.48s
Intermediate time for IT: 00h:17m:32.23s
Total time: 01h:34m:52.81s
