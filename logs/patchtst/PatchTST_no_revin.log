
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_outliers_no_revin_GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data_new.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_outliers_no_revin_GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1244073
	speed: 0.0749s/iter; left time: 1662.0936s
	iters: 200, epoch: 1 | loss: 0.1176813
	speed: 0.0466s/iter; left time: 1029.0412s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.91s
Steps: 223 | Train Loss: 0.1267753 Vali Loss: 0.0940013 Test Loss: 0.1089936
Validation loss decreased (inf --> 0.094001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0384000
	speed: 0.0853s/iter; left time: 1875.8094s
	iters: 200, epoch: 2 | loss: 0.0266127
	speed: 0.0465s/iter; left time: 1018.1141s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.66s
Steps: 223 | Train Loss: 0.0454170 Vali Loss: 0.0249390 Test Loss: 0.0346667
Validation loss decreased (0.094001 --> 0.024939).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0237448
	speed: 0.0850s/iter; left time: 1848.1967s
	iters: 200, epoch: 3 | loss: 0.0198930
	speed: 0.0467s/iter; left time: 1011.5216s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.64s
Steps: 223 | Train Loss: 0.0219407 Vali Loss: 0.0212463 Test Loss: 0.0277511
Validation loss decreased (0.024939 --> 0.021246).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0208119
	speed: 0.0844s/iter; left time: 1818.3062s
	iters: 200, epoch: 4 | loss: 0.0200961
	speed: 0.0468s/iter; left time: 1002.0697s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.66s
Steps: 223 | Train Loss: 0.0182399 Vali Loss: 0.0210393 Test Loss: 0.0276593
Validation loss decreased (0.021246 --> 0.021039).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0150578
	speed: 0.0846s/iter; left time: 1802.8697s
	iters: 200, epoch: 5 | loss: 0.0163067
	speed: 0.0470s/iter; left time: 997.3114s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.72s
Steps: 223 | Train Loss: 0.0166892 Vali Loss: 0.0207341 Test Loss: 0.0281381
Validation loss decreased (0.021039 --> 0.020734).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0142145
	speed: 0.0850s/iter; left time: 1792.0456s
	iters: 200, epoch: 6 | loss: 0.0175426
	speed: 0.0463s/iter; left time: 972.3974s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.64s
Steps: 223 | Train Loss: 0.0158944 Vali Loss: 0.0207792 Test Loss: 0.0284950
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0156249
	speed: 0.0814s/iter; left time: 1698.8864s
	iters: 200, epoch: 7 | loss: 0.0142546
	speed: 0.0472s/iter; left time: 980.9013s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.75s
Steps: 223 | Train Loss: 0.0155555 Vali Loss: 0.0206535 Test Loss: 0.0284376
Validation loss decreased (0.020734 --> 0.020654).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0165259
	speed: 0.0860s/iter; left time: 1774.5886s
	iters: 200, epoch: 8 | loss: 0.0152326
	speed: 0.0472s/iter; left time: 968.5643s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.77s
Steps: 223 | Train Loss: 0.0153165 Vali Loss: 0.0207704 Test Loss: 0.0276095
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0161124
	speed: 0.0846s/iter; left time: 1726.3933s
	iters: 200, epoch: 9 | loss: 0.0140249
	speed: 0.0472s/iter; left time: 958.8026s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.76s
Steps: 223 | Train Loss: 0.0150784 Vali Loss: 0.0203086 Test Loss: 0.0268710
Validation loss decreased (0.020654 --> 0.020309).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0143674
	speed: 0.0853s/iter; left time: 1722.3466s
	iters: 200, epoch: 10 | loss: 0.0157508
	speed: 0.0475s/iter; left time: 954.3449s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.82s
Steps: 223 | Train Loss: 0.0148455 Vali Loss: 0.0201842 Test Loss: 0.0270238
Validation loss decreased (0.020309 --> 0.020184).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0164965
	speed: 0.0863s/iter; left time: 1722.5095s
	iters: 200, epoch: 11 | loss: 0.0158760
	speed: 0.0478s/iter; left time: 948.8596s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.89s
Steps: 223 | Train Loss: 0.0148584 Vali Loss: 0.0204785 Test Loss: 0.0271726
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0121544
	speed: 0.0848s/iter; left time: 1675.2354s
	iters: 200, epoch: 12 | loss: 0.0158793
	speed: 0.0475s/iter; left time: 932.5540s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.82s
Steps: 223 | Train Loss: 0.0146100 Vali Loss: 0.0200453 Test Loss: 0.0266486
Validation loss decreased (0.020184 --> 0.020045).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0137476
	speed: 0.0858s/iter; left time: 1676.1882s
	iters: 200, epoch: 13 | loss: 0.0149794
	speed: 0.0475s/iter; left time: 923.3602s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.87s
Steps: 223 | Train Loss: 0.0144587 Vali Loss: 0.0200264 Test Loss: 0.0266688
Validation loss decreased (0.020045 --> 0.020026).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0141716
	speed: 0.0856s/iter; left time: 1651.6939s
	iters: 200, epoch: 14 | loss: 0.0140526
	speed: 0.0475s/iter; left time: 911.8136s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.84s
Steps: 223 | Train Loss: 0.0144077 Vali Loss: 0.0202406 Test Loss: 0.0269560
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0143215
	speed: 0.0847s/iter; left time: 1615.3578s
	iters: 200, epoch: 15 | loss: 0.0136560
	speed: 0.0475s/iter; left time: 900.7778s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.81s
Steps: 223 | Train Loss: 0.0142961 Vali Loss: 0.0198701 Test Loss: 0.0266428
Validation loss decreased (0.020026 --> 0.019870).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0136261
	speed: 0.0858s/iter; left time: 1618.7503s
	iters: 200, epoch: 16 | loss: 0.0127296
	speed: 0.0475s/iter; left time: 890.6676s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.89s
Steps: 223 | Train Loss: 0.0142301 Vali Loss: 0.0201080 Test Loss: 0.0274499
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0148282
	speed: 0.0862s/iter; left time: 1606.6090s
	iters: 200, epoch: 17 | loss: 0.0132890
	speed: 0.0476s/iter; left time: 882.6745s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.87s
Steps: 223 | Train Loss: 0.0141759 Vali Loss: 0.0198568 Test Loss: 0.0266295
Validation loss decreased (0.019870 --> 0.019857).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0139410
	speed: 0.0858s/iter; left time: 1580.3258s
	iters: 200, epoch: 18 | loss: 0.0142552
	speed: 0.0476s/iter; left time: 871.7514s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.86s
Steps: 223 | Train Loss: 0.0140903 Vali Loss: 0.0201418 Test Loss: 0.0271959
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0133088
	speed: 0.0849s/iter; left time: 1543.7251s
	iters: 200, epoch: 19 | loss: 0.0154610
	speed: 0.0475s/iter; left time: 859.7683s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.84s
Steps: 223 | Train Loss: 0.0140211 Vali Loss: 0.0201959 Test Loss: 0.0270690
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0139708
	speed: 0.0857s/iter; left time: 1539.8229s
	iters: 200, epoch: 20 | loss: 0.0123683
	speed: 0.0476s/iter; left time: 850.1343s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.85s
Steps: 223 | Train Loss: 0.0139802 Vali Loss: 0.0200129 Test Loss: 0.0270160
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0130937
	speed: 0.0852s/iter; left time: 1511.9598s
	iters: 200, epoch: 21 | loss: 0.0157320
	speed: 0.0475s/iter; left time: 838.7522s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.84s
Steps: 223 | Train Loss: 0.0139475 Vali Loss: 0.0198937 Test Loss: 0.0268523
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0137721
	speed: 0.0857s/iter; left time: 1500.5826s
	iters: 200, epoch: 22 | loss: 0.0144720
	speed: 0.0476s/iter; left time: 828.9468s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.86s
Steps: 223 | Train Loss: 0.0139068 Vali Loss: 0.0200308 Test Loss: 0.0272258
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0150069
	speed: 0.0853s/iter; left time: 1475.4119s
	iters: 200, epoch: 23 | loss: 0.0121667
	speed: 0.0477s/iter; left time: 819.5160s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.88s
Steps: 223 | Train Loss: 0.0138664 Vali Loss: 0.0198748 Test Loss: 0.0270324
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0141130
	speed: 0.0860s/iter; left time: 1468.1255s
	iters: 200, epoch: 24 | loss: 0.0143699
	speed: 0.0476s/iter; left time: 807.8973s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.88s
Steps: 223 | Train Loss: 0.0138457 Vali Loss: 0.0199568 Test Loss: 0.0268451
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0144105
	speed: 0.0862s/iter; left time: 1452.3313s
	iters: 200, epoch: 25 | loss: 0.0134898
	speed: 0.0476s/iter; left time: 796.8914s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.86s
Steps: 223 | Train Loss: 0.0137632 Vali Loss: 0.0200222 Test Loss: 0.0271989
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0126074
	speed: 0.0852s/iter; left time: 1416.2256s
	iters: 200, epoch: 26 | loss: 0.0131049
	speed: 0.0476s/iter; left time: 786.4616s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.84s
Steps: 223 | Train Loss: 0.0137622 Vali Loss: 0.0199821 Test Loss: 0.0271711
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0144456
	speed: 0.0850s/iter; left time: 1394.1905s
	iters: 200, epoch: 27 | loss: 0.0144747
	speed: 0.0476s/iter; left time: 776.8368s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.87s
Steps: 223 | Train Loss: 0.0137394 Vali Loss: 0.0199936 Test Loss: 0.0273226
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_outliers_no_revin_GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02662954293191433, rmse:0.16318561136722565, mae:0.10998011380434036, rse:0.5676156878471375
Intermediate time for GB and pred_len 24: 00h:06m:08.90s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_outliers_no_revin_GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data_new.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_outliers_no_revin_GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1277484
	speed: 0.0761s/iter; left time: 1681.0916s
	iters: 200, epoch: 1 | loss: 0.1105688
	speed: 0.0474s/iter; left time: 1042.5530s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.18s
Steps: 222 | Train Loss: 0.1275293 Vali Loss: 0.0996873 Test Loss: 0.1169330
Validation loss decreased (inf --> 0.099687).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0396113
	speed: 0.0902s/iter; left time: 1973.0911s
	iters: 200, epoch: 2 | loss: 0.0316610
	speed: 0.0477s/iter; left time: 1038.1517s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.85s
Steps: 222 | Train Loss: 0.0477875 Vali Loss: 0.0329726 Test Loss: 0.0469587
Validation loss decreased (0.099687 --> 0.032973).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0259816
	speed: 0.0880s/iter; left time: 1905.5810s
	iters: 200, epoch: 3 | loss: 0.0258741
	speed: 0.0479s/iter; left time: 1031.7230s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.90s
Steps: 222 | Train Loss: 0.0271180 Vali Loss: 0.0306961 Test Loss: 0.0461644
Validation loss decreased (0.032973 --> 0.030696).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0224891
	speed: 0.0878s/iter; left time: 1881.0279s
	iters: 200, epoch: 4 | loss: 0.0245912
	speed: 0.0478s/iter; left time: 1019.5808s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.86s
Steps: 222 | Train Loss: 0.0241611 Vali Loss: 0.0310721 Test Loss: 0.0510838
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0248933
	speed: 0.0874s/iter; left time: 1853.3116s
	iters: 200, epoch: 5 | loss: 0.0234952
	speed: 0.0479s/iter; left time: 1010.2657s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.91s
Steps: 222 | Train Loss: 0.0232249 Vali Loss: 0.0314988 Test Loss: 0.0510794
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0227747
	speed: 0.0869s/iter; left time: 1825.0550s
	iters: 200, epoch: 6 | loss: 0.0229812
	speed: 0.0479s/iter; left time: 1000.5854s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.91s
Steps: 222 | Train Loss: 0.0227524 Vali Loss: 0.0309934 Test Loss: 0.0464433
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0225947
	speed: 0.0870s/iter; left time: 1806.1535s
	iters: 200, epoch: 7 | loss: 0.0214749
	speed: 0.0479s/iter; left time: 990.3233s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.88s
Steps: 222 | Train Loss: 0.0223699 Vali Loss: 0.0304921 Test Loss: 0.0436644
Validation loss decreased (0.030696 --> 0.030492).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0223484
	speed: 0.0878s/iter; left time: 1803.9380s
	iters: 200, epoch: 8 | loss: 0.0223088
	speed: 0.0479s/iter; left time: 979.5104s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.90s
Steps: 222 | Train Loss: 0.0220757 Vali Loss: 0.0304858 Test Loss: 0.0445817
Validation loss decreased (0.030492 --> 0.030486).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0217350
	speed: 0.0879s/iter; left time: 1786.3577s
	iters: 200, epoch: 9 | loss: 0.0211748
	speed: 0.0479s/iter; left time: 969.1913s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.89s
Steps: 222 | Train Loss: 0.0218478 Vali Loss: 0.0298603 Test Loss: 0.0428153
Validation loss decreased (0.030486 --> 0.029860).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0210856
	speed: 0.0904s/iter; left time: 1817.0286s
	iters: 200, epoch: 10 | loss: 0.0210287
	speed: 0.0480s/iter; left time: 960.3638s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.90s
Steps: 222 | Train Loss: 0.0216425 Vali Loss: 0.0306545 Test Loss: 0.0445956
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0210099
	speed: 0.0871s/iter; left time: 1731.3773s
	iters: 200, epoch: 11 | loss: 0.0200109
	speed: 0.0479s/iter; left time: 946.5862s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.90s
Steps: 222 | Train Loss: 0.0215405 Vali Loss: 0.0297202 Test Loss: 0.0420539
Validation loss decreased (0.029860 --> 0.029720).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0214709
	speed: 0.0869s/iter; left time: 1708.8436s
	iters: 200, epoch: 12 | loss: 0.0205379
	speed: 0.0479s/iter; left time: 936.8241s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.89s
Steps: 222 | Train Loss: 0.0213686 Vali Loss: 0.0301132 Test Loss: 0.0428274
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0192222
	speed: 0.0876s/iter; left time: 1702.8857s
	iters: 200, epoch: 13 | loss: 0.0211983
	speed: 0.0479s/iter; left time: 926.5020s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.91s
Steps: 222 | Train Loss: 0.0212856 Vali Loss: 0.0303281 Test Loss: 0.0432985
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0204989
	speed: 0.0868s/iter; left time: 1667.2094s
	iters: 200, epoch: 14 | loss: 0.0211937
	speed: 0.0481s/iter; left time: 919.1514s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.92s
Steps: 222 | Train Loss: 0.0212257 Vali Loss: 0.0301415 Test Loss: 0.0426247
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0236250
	speed: 0.0866s/iter; left time: 1645.6826s
	iters: 200, epoch: 15 | loss: 0.0221896
	speed: 0.0479s/iter; left time: 904.5638s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.88s
Steps: 222 | Train Loss: 0.0210869 Vali Loss: 0.0300319 Test Loss: 0.0423191
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0209516
	speed: 0.0861s/iter; left time: 1616.5395s
	iters: 200, epoch: 16 | loss: 0.0186915
	speed: 0.0479s/iter; left time: 894.8879s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.89s
Steps: 222 | Train Loss: 0.0209981 Vali Loss: 0.0303171 Test Loss: 0.0429077
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0201732
	speed: 0.0869s/iter; left time: 1612.7192s
	iters: 200, epoch: 17 | loss: 0.0209619
	speed: 0.0480s/iter; left time: 884.9696s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.90s
Steps: 222 | Train Loss: 0.0209122 Vali Loss: 0.0307355 Test Loss: 0.0434550
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0222549
	speed: 0.0869s/iter; left time: 1591.8212s
	iters: 200, epoch: 18 | loss: 0.0199029
	speed: 0.0480s/iter; left time: 874.2991s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.92s
Steps: 222 | Train Loss: 0.0208540 Vali Loss: 0.0302686 Test Loss: 0.0431604
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0193379
	speed: 0.0869s/iter; left time: 1572.6425s
	iters: 200, epoch: 19 | loss: 0.0223832
	speed: 0.0480s/iter; left time: 863.4604s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.89s
Steps: 222 | Train Loss: 0.0207686 Vali Loss: 0.0303039 Test Loss: 0.0429730
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0196274
	speed: 0.0872s/iter; left time: 1559.8350s
	iters: 200, epoch: 20 | loss: 0.0206015
	speed: 0.0479s/iter; left time: 851.5192s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.87s
Steps: 222 | Train Loss: 0.0207312 Vali Loss: 0.0301241 Test Loss: 0.0424815
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0198095
	speed: 0.0866s/iter; left time: 1529.9866s
	iters: 200, epoch: 21 | loss: 0.0227735
	speed: 0.0480s/iter; left time: 842.8760s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.87s
Steps: 222 | Train Loss: 0.0206810 Vali Loss: 0.0301876 Test Loss: 0.0427990
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_outliers_no_revin_GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04205385968089104, rmse:0.2050703763961792, mae:0.14662711322307587, rse:0.7151989340782166
Intermediate time for GB and pred_len 96: 00h:04m:56.41s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_outliers_no_revin_GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data_new.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_outliers_no_revin_GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1237701
	speed: 0.0777s/iter; left time: 1716.7565s
	iters: 200, epoch: 1 | loss: 0.1164568
	speed: 0.0476s/iter; left time: 1048.3253s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.28s
Steps: 222 | Train Loss: 0.1279938 Vali Loss: 0.1003439 Test Loss: 0.1168319
Validation loss decreased (inf --> 0.100344).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0414207
	speed: 0.0885s/iter; left time: 1936.2712s
	iters: 200, epoch: 2 | loss: 0.0309294
	speed: 0.0476s/iter; left time: 1037.6290s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.93s
Steps: 222 | Train Loss: 0.0481190 Vali Loss: 0.0343527 Test Loss: 0.0490068
Validation loss decreased (0.100344 --> 0.034353).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0287404
	speed: 0.0913s/iter; left time: 1978.3668s
	iters: 200, epoch: 3 | loss: 0.0275198
	speed: 0.0481s/iter; left time: 1036.8234s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.98s
Steps: 222 | Train Loss: 0.0279552 Vali Loss: 0.0322467 Test Loss: 0.0512701
Validation loss decreased (0.034353 --> 0.032247).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0268840
	speed: 0.0913s/iter; left time: 1957.8268s
	iters: 200, epoch: 4 | loss: 0.0240252
	speed: 0.0480s/iter; left time: 1024.8803s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.06s
Steps: 222 | Train Loss: 0.0254077 Vali Loss: 0.0327636 Test Loss: 0.0536329
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0233899
	speed: 0.0893s/iter; left time: 1895.2890s
	iters: 200, epoch: 5 | loss: 0.0252921
	speed: 0.0479s/iter; left time: 1010.6618s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.99s
Steps: 222 | Train Loss: 0.0246268 Vali Loss: 0.0333259 Test Loss: 0.0539267
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0226340
	speed: 0.0890s/iter; left time: 1868.4848s
	iters: 200, epoch: 6 | loss: 0.0243396
	speed: 0.0481s/iter; left time: 1004.6214s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.99s
Steps: 222 | Train Loss: 0.0241429 Vali Loss: 0.0325398 Test Loss: 0.0486072
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0234801
	speed: 0.0908s/iter; left time: 1885.3515s
	iters: 200, epoch: 7 | loss: 0.0236296
	speed: 0.0482s/iter; left time: 996.1790s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.03s
Steps: 222 | Train Loss: 0.0237094 Vali Loss: 0.0326204 Test Loss: 0.0464402
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0234830
	speed: 0.0884s/iter; left time: 1815.8246s
	iters: 200, epoch: 8 | loss: 0.0215452
	speed: 0.0481s/iter; left time: 983.4910s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.98s
Steps: 222 | Train Loss: 0.0233615 Vali Loss: 0.0330032 Test Loss: 0.0461395
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0232363
	speed: 0.0885s/iter; left time: 1798.4050s
	iters: 200, epoch: 9 | loss: 0.0230493
	speed: 0.0481s/iter; left time: 972.6111s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.94s
Steps: 222 | Train Loss: 0.0231210 Vali Loss: 0.0320860 Test Loss: 0.0435966
Validation loss decreased (0.032247 --> 0.032086).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0227674
	speed: 0.0889s/iter; left time: 1787.5593s
	iters: 200, epoch: 10 | loss: 0.0230295
	speed: 0.0481s/iter; left time: 961.4519s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.94s
Steps: 222 | Train Loss: 0.0229645 Vali Loss: 0.0321824 Test Loss: 0.0431622
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0241527
	speed: 0.0885s/iter; left time: 1759.0596s
	iters: 200, epoch: 11 | loss: 0.0232794
	speed: 0.0481s/iter; left time: 951.1272s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.91s
Steps: 222 | Train Loss: 0.0228119 Vali Loss: 0.0323835 Test Loss: 0.0437122
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0241883
	speed: 0.0880s/iter; left time: 1729.1273s
	iters: 200, epoch: 12 | loss: 0.0225999
	speed: 0.0480s/iter; left time: 938.4961s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.92s
Steps: 222 | Train Loss: 0.0226900 Vali Loss: 0.0326535 Test Loss: 0.0442543
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0212769
	speed: 0.0880s/iter; left time: 1710.8001s
	iters: 200, epoch: 13 | loss: 0.0227571
	speed: 0.0480s/iter; left time: 928.6161s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.94s
Steps: 222 | Train Loss: 0.0225336 Vali Loss: 0.0325103 Test Loss: 0.0440546
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0208707
	speed: 0.0879s/iter; left time: 1688.0395s
	iters: 200, epoch: 14 | loss: 0.0224494
	speed: 0.0480s/iter; left time: 917.5247s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.96s
Steps: 222 | Train Loss: 0.0224375 Vali Loss: 0.0330522 Test Loss: 0.0451421
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0230468
	speed: 0.0880s/iter; left time: 1671.9936s
	iters: 200, epoch: 15 | loss: 0.0212044
	speed: 0.0481s/iter; left time: 909.4586s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.94s
Steps: 222 | Train Loss: 0.0223891 Vali Loss: 0.0324046 Test Loss: 0.0438901
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0217093
	speed: 0.0880s/iter; left time: 1650.9228s
	iters: 200, epoch: 16 | loss: 0.0222104
	speed: 0.0480s/iter; left time: 896.3471s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.92s
Steps: 222 | Train Loss: 0.0223561 Vali Loss: 0.0327737 Test Loss: 0.0449965
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0240783
	speed: 0.0882s/iter; left time: 1636.3138s
	iters: 200, epoch: 17 | loss: 0.0236116
	speed: 0.0480s/iter; left time: 885.4251s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.97s
Steps: 222 | Train Loss: 0.0221888 Vali Loss: 0.0326069 Test Loss: 0.0444371
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0231026
	speed: 0.0883s/iter; left time: 1617.7693s
	iters: 200, epoch: 18 | loss: 0.0220676
	speed: 0.0480s/iter; left time: 874.6553s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.93s
Steps: 222 | Train Loss: 0.0221504 Vali Loss: 0.0323706 Test Loss: 0.0439783
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0210069
	speed: 0.0878s/iter; left time: 1589.4847s
	iters: 200, epoch: 19 | loss: 0.0220666
	speed: 0.0481s/iter; left time: 866.0427s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.92s
Steps: 222 | Train Loss: 0.0220821 Vali Loss: 0.0327219 Test Loss: 0.0447983
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_outliers_no_revin_GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04359659552574158, rmse:0.20879797637462616, mae:0.15036597847938538, rse:0.7302772402763367
Intermediate time for GB and pred_len 168: 00h:04m:32.60sIntermediate time for GB: 00h:15m:37.92sTotal time: 00h:15m:37.96s