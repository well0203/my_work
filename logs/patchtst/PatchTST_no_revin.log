
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2566070
	speed: 0.0697s/iter; left time: 1554.3492s
	iters: 200, epoch: 1 | loss: 0.2419528
	speed: 0.0297s/iter; left time: 660.4204s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.56s
Steps: 224 | Train Loss: 0.2636380 Vali Loss: 0.2222575 Test Loss: 0.2204070
Validation loss decreased (inf --> 0.222257).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1490381
	speed: 0.0510s/iter; left time: 1125.5861s
	iters: 200, epoch: 2 | loss: 0.1197937
	speed: 0.0264s/iter; left time: 580.1624s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.1535841 Vali Loss: 0.1151092 Test Loss: 0.1171536
Validation loss decreased (0.222257 --> 0.115109).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1010839
	speed: 0.0513s/iter; left time: 1121.7780s
	iters: 200, epoch: 3 | loss: 0.0979355
	speed: 0.0264s/iter; left time: 574.0318s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.1034884 Vali Loss: 0.1062425 Test Loss: 0.1076204
Validation loss decreased (0.115109 --> 0.106242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0974420
	speed: 0.0515s/iter; left time: 1113.9680s
	iters: 200, epoch: 4 | loss: 0.0977694
	speed: 0.0264s/iter; left time: 567.9155s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0933482 Vali Loss: 0.0992072 Test Loss: 0.1010505
Validation loss decreased (0.106242 --> 0.099207).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0909457
	speed: 0.0512s/iter; left time: 1095.1722s
	iters: 200, epoch: 5 | loss: 0.0860357
	speed: 0.0263s/iter; left time: 560.0035s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0887532 Vali Loss: 0.0971549 Test Loss: 0.0991021
Validation loss decreased (0.099207 --> 0.097155).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0950104
	speed: 0.0511s/iter; left time: 1082.2264s
	iters: 200, epoch: 6 | loss: 0.0841039
	speed: 0.0263s/iter; left time: 553.8650s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0859246 Vali Loss: 0.0970220 Test Loss: 0.0979300
Validation loss decreased (0.097155 --> 0.097022).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0830651
	speed: 0.0514s/iter; left time: 1077.2520s
	iters: 200, epoch: 7 | loss: 0.0861730
	speed: 0.0266s/iter; left time: 554.7573s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0841975 Vali Loss: 0.0949431 Test Loss: 0.0963822
Validation loss decreased (0.097022 --> 0.094943).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0834699
	speed: 0.0515s/iter; left time: 1067.3835s
	iters: 200, epoch: 8 | loss: 0.0826666
	speed: 0.0262s/iter; left time: 541.5249s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0832470 Vali Loss: 0.0940332 Test Loss: 0.0951022
Validation loss decreased (0.094943 --> 0.094033).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0867406
	speed: 0.0513s/iter; left time: 1051.3144s
	iters: 200, epoch: 9 | loss: 0.0859180
	speed: 0.0265s/iter; left time: 541.3087s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0822038 Vali Loss: 0.0939286 Test Loss: 0.0947163
Validation loss decreased (0.094033 --> 0.093929).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0839390
	speed: 0.0520s/iter; left time: 1055.6915s
	iters: 200, epoch: 10 | loss: 0.0786523
	speed: 0.0266s/iter; left time: 536.4196s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0808735 Vali Loss: 0.0932474 Test Loss: 0.0947599
Validation loss decreased (0.093929 --> 0.093247).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0754465
	speed: 0.0518s/iter; left time: 1038.5746s
	iters: 200, epoch: 11 | loss: 0.0798902
	speed: 0.0265s/iter; left time: 528.4970s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0805028 Vali Loss: 0.0930160 Test Loss: 0.0942361
Validation loss decreased (0.093247 --> 0.093016).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0777061
	speed: 0.0517s/iter; left time: 1025.7292s
	iters: 200, epoch: 12 | loss: 0.0808789
	speed: 0.0264s/iter; left time: 520.3353s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0801001 Vali Loss: 0.0921757 Test Loss: 0.0932652
Validation loss decreased (0.093016 --> 0.092176).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0751510
	speed: 0.0514s/iter; left time: 1008.7788s
	iters: 200, epoch: 13 | loss: 0.0770847
	speed: 0.0264s/iter; left time: 514.6912s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0791738 Vali Loss: 0.0924514 Test Loss: 0.0932204
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0782727
	speed: 0.0512s/iter; left time: 992.9978s
	iters: 200, epoch: 14 | loss: 0.0786983
	speed: 0.0264s/iter; left time: 509.4893s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0787759 Vali Loss: 0.0920219 Test Loss: 0.0935162
Validation loss decreased (0.092176 --> 0.092022).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0777310
	speed: 0.0522s/iter; left time: 999.8995s
	iters: 200, epoch: 15 | loss: 0.0735414
	speed: 0.0266s/iter; left time: 506.5297s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0786300 Vali Loss: 0.0917478 Test Loss: 0.0926336
Validation loss decreased (0.092022 --> 0.091748).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0785231
	speed: 0.0512s/iter; left time: 970.0143s
	iters: 200, epoch: 16 | loss: 0.0768834
	speed: 0.0265s/iter; left time: 499.4976s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0784725 Vali Loss: 0.0918264 Test Loss: 0.0926172
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0798664
	speed: 0.0514s/iter; left time: 962.0186s
	iters: 200, epoch: 17 | loss: 0.0797044
	speed: 0.0264s/iter; left time: 491.6201s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0783037 Vali Loss: 0.0910420 Test Loss: 0.0925358
Validation loss decreased (0.091748 --> 0.091042).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0781114
	speed: 0.0513s/iter; left time: 948.8579s
	iters: 200, epoch: 18 | loss: 0.0855012
	speed: 0.0266s/iter; left time: 489.8054s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0779318 Vali Loss: 0.0907866 Test Loss: 0.0921505
Validation loss decreased (0.091042 --> 0.090787).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0735422
	speed: 0.0517s/iter; left time: 944.8442s
	iters: 200, epoch: 19 | loss: 0.0740805
	speed: 0.0264s/iter; left time: 479.6136s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0774609 Vali Loss: 0.0919343 Test Loss: 0.0928579
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0746833
	speed: 0.0504s/iter; left time: 908.8097s
	iters: 200, epoch: 20 | loss: 0.0807188
	speed: 0.0267s/iter; left time: 478.4274s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0773912 Vali Loss: 0.0916482 Test Loss: 0.0923388
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0721470
	speed: 0.0508s/iter; left time: 904.9998s
	iters: 200, epoch: 21 | loss: 0.0779014
	speed: 0.0264s/iter; left time: 466.9820s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0773700 Vali Loss: 0.0906744 Test Loss: 0.0923040
Validation loss decreased (0.090787 --> 0.090674).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0702513
	speed: 0.0510s/iter; left time: 897.7170s
	iters: 200, epoch: 22 | loss: 0.0733673
	speed: 0.0269s/iter; left time: 470.6345s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0772820 Vali Loss: 0.0907303 Test Loss: 0.0918452
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0767162
	speed: 0.0518s/iter; left time: 900.4560s
	iters: 200, epoch: 23 | loss: 0.0720851
	speed: 0.0265s/iter; left time: 458.5923s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0770278 Vali Loss: 0.0907926 Test Loss: 0.0918527
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0754888
	speed: 0.0509s/iter; left time: 873.5967s
	iters: 200, epoch: 24 | loss: 0.0748333
	speed: 0.0264s/iter; left time: 449.9587s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0768529 Vali Loss: 0.0908272 Test Loss: 0.0918088
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0754161
	speed: 0.0504s/iter; left time: 853.8475s
	iters: 200, epoch: 25 | loss: 0.0849064
	speed: 0.0267s/iter; left time: 449.4896s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0768403 Vali Loss: 0.0907090 Test Loss: 0.0916022
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0744077
	speed: 0.0511s/iter; left time: 854.0449s
	iters: 200, epoch: 26 | loss: 0.0762815
	speed: 0.0264s/iter; left time: 437.7518s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0767571 Vali Loss: 0.0906516 Test Loss: 0.0917031
Validation loss decreased (0.090674 --> 0.090652).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0812616
	speed: 0.0513s/iter; left time: 845.1961s
	iters: 200, epoch: 27 | loss: 0.0799414
	speed: 0.0263s/iter; left time: 430.9567s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0765723 Vali Loss: 0.0903748 Test Loss: 0.0915898
Validation loss decreased (0.090652 --> 0.090375).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0726214
	speed: 0.0510s/iter; left time: 828.6620s
	iters: 200, epoch: 28 | loss: 0.0789795
	speed: 0.0264s/iter; left time: 426.4562s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0765280 Vali Loss: 0.0905175 Test Loss: 0.0916367
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0772127
	speed: 0.0507s/iter; left time: 812.8412s
	iters: 200, epoch: 29 | loss: 0.0697870
	speed: 0.0263s/iter; left time: 419.7097s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0765321 Vali Loss: 0.0904983 Test Loss: 0.0915829
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0811062
	speed: 0.0508s/iter; left time: 802.3043s
	iters: 200, epoch: 30 | loss: 0.0780678
	speed: 0.0265s/iter; left time: 416.2433s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0765154 Vali Loss: 0.0902160 Test Loss: 0.0915959
Validation loss decreased (0.090375 --> 0.090216).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0766579
	speed: 0.0522s/iter; left time: 812.7127s
	iters: 200, epoch: 31 | loss: 0.0730054
	speed: 0.0264s/iter; left time: 409.0530s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0764262 Vali Loss: 0.0905278 Test Loss: 0.0917065
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0711051
	speed: 0.0509s/iter; left time: 782.1983s
	iters: 200, epoch: 32 | loss: 0.0803683
	speed: 0.0263s/iter; left time: 401.6960s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0763533 Vali Loss: 0.0901207 Test Loss: 0.0914401
Validation loss decreased (0.090216 --> 0.090121).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0823469
	speed: 0.0515s/iter; left time: 779.3056s
	iters: 200, epoch: 33 | loss: 0.0713614
	speed: 0.0264s/iter; left time: 396.1586s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0763147 Vali Loss: 0.0905146 Test Loss: 0.0916492
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0752804
	speed: 0.0506s/iter; left time: 755.0867s
	iters: 200, epoch: 34 | loss: 0.0791326
	speed: 0.0265s/iter; left time: 392.9595s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0762617 Vali Loss: 0.0903647 Test Loss: 0.0914449
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0792777
	speed: 0.0513s/iter; left time: 753.7300s
	iters: 200, epoch: 35 | loss: 0.0719633
	speed: 0.0263s/iter; left time: 382.9059s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0761660 Vali Loss: 0.0903345 Test Loss: 0.0914848
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0769392
	speed: 0.0504s/iter; left time: 728.1795s
	iters: 200, epoch: 36 | loss: 0.0812033
	speed: 0.0263s/iter; left time: 377.0112s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0762252 Vali Loss: 0.0910000 Test Loss: 0.0918637
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0839674
	speed: 0.0506s/iter; left time: 720.8292s
	iters: 200, epoch: 37 | loss: 0.0782146
	speed: 0.0265s/iter; left time: 374.3928s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0761717 Vali Loss: 0.0904660 Test Loss: 0.0915176
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0749981
	speed: 0.0510s/iter; left time: 714.8634s
	iters: 200, epoch: 38 | loss: 0.0715419
	speed: 0.0263s/iter; left time: 365.8777s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0761763 Vali Loss: 0.0906010 Test Loss: 0.0916540
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0792945
	speed: 0.0514s/iter; left time: 708.8584s
	iters: 200, epoch: 39 | loss: 0.0729343
	speed: 0.0263s/iter; left time: 360.4861s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0762594 Vali Loss: 0.0901306 Test Loss: 0.0913918
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0725834
	speed: 0.0507s/iter; left time: 687.9009s
	iters: 200, epoch: 40 | loss: 0.0821638
	speed: 0.0264s/iter; left time: 355.7920s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0761080 Vali Loss: 0.0901505 Test Loss: 0.0913605
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0714317
	speed: 0.0503s/iter; left time: 671.1363s
	iters: 200, epoch: 41 | loss: 0.0747623
	speed: 0.0263s/iter; left time: 348.0577s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0761157 Vali Loss: 0.0900619 Test Loss: 0.0915041
Validation loss decreased (0.090121 --> 0.090062).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0739755
	speed: 0.0511s/iter; left time: 669.7266s
	iters: 200, epoch: 42 | loss: 0.0810414
	speed: 0.0262s/iter; left time: 341.5211s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0761380 Vali Loss: 0.0903147 Test Loss: 0.0914038
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0811172
	speed: 0.0505s/iter; left time: 651.0997s
	iters: 200, epoch: 43 | loss: 0.0779029
	speed: 0.0263s/iter; left time: 336.3816s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0760796 Vali Loss: 0.0902422 Test Loss: 0.0914716
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0723317
	speed: 0.0510s/iter; left time: 645.5269s
	iters: 200, epoch: 44 | loss: 0.0762026
	speed: 0.0263s/iter; left time: 330.3537s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0759945 Vali Loss: 0.0902213 Test Loss: 0.0914703
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0768227
	speed: 0.0506s/iter; left time: 629.5039s
	iters: 200, epoch: 45 | loss: 0.0778465
	speed: 0.0263s/iter; left time: 324.5055s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0760749 Vali Loss: 0.0902847 Test Loss: 0.0914034
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0757674
	speed: 0.0508s/iter; left time: 620.4236s
	iters: 200, epoch: 46 | loss: 0.0817664
	speed: 0.0264s/iter; left time: 320.3826s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0760586 Vali Loss: 0.0901711 Test Loss: 0.0912951
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0757344
	speed: 0.0512s/iter; left time: 614.4499s
	iters: 200, epoch: 47 | loss: 0.0739751
	speed: 0.0263s/iter; left time: 312.6975s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0760620 Vali Loss: 0.0903189 Test Loss: 0.0914689
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0769868
	speed: 0.0510s/iter; left time: 600.1422s
	iters: 200, epoch: 48 | loss: 0.0761500
	speed: 0.0264s/iter; left time: 308.1459s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0760214 Vali Loss: 0.0901692 Test Loss: 0.0913794
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0779364
	speed: 0.0504s/iter; left time: 581.5220s
	iters: 200, epoch: 49 | loss: 0.0800145
	speed: 0.0263s/iter; left time: 301.3702s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0760802 Vali Loss: 0.0900943 Test Loss: 0.0913661
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0724418
	speed: 0.0503s/iter; left time: 570.1542s
	iters: 200, epoch: 50 | loss: 0.0738002
	speed: 0.0263s/iter; left time: 294.9540s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.08s
Steps: 224 | Train Loss: 0.0759310 Vali Loss: 0.0905732 Test Loss: 0.0915211
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0714924
	speed: 0.0504s/iter; left time: 559.1858s
	iters: 200, epoch: 51 | loss: 0.0791853
	speed: 0.0265s/iter; left time: 291.1441s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0759803 Vali Loss: 0.0902920 Test Loss: 0.0913586
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021748371422290802, rmse:0.1474732905626297, mae:0.0915040671825409, rse:0.5204536318778992
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2623934
	speed: 0.0283s/iter; left time: 631.1664s
	iters: 200, epoch: 1 | loss: 0.2396158
	speed: 0.0264s/iter; left time: 585.1619s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.2633231 Vali Loss: 0.2145368 Test Loss: 0.2137502
Validation loss decreased (inf --> 0.214537).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1374790
	speed: 0.0518s/iter; left time: 1143.5152s
	iters: 200, epoch: 2 | loss: 0.1093387
	speed: 0.0264s/iter; left time: 580.5247s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.1501679 Vali Loss: 0.1194519 Test Loss: 0.1199035
Validation loss decreased (0.214537 --> 0.119452).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0990194
	speed: 0.0530s/iter; left time: 1157.8753s
	iters: 200, epoch: 3 | loss: 0.1039781
	speed: 0.0264s/iter; left time: 573.7290s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.1039293 Vali Loss: 0.1051352 Test Loss: 0.1071176
Validation loss decreased (0.119452 --> 0.105135).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0944413
	speed: 0.0521s/iter; left time: 1127.6466s
	iters: 200, epoch: 4 | loss: 0.0901303
	speed: 0.0266s/iter; left time: 572.4442s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0936006 Vali Loss: 0.0998318 Test Loss: 0.1013047
Validation loss decreased (0.105135 --> 0.099832).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0877668
	speed: 0.0516s/iter; left time: 1103.8633s
	iters: 200, epoch: 5 | loss: 0.0928216
	speed: 0.0264s/iter; left time: 562.6199s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0888237 Vali Loss: 0.0964812 Test Loss: 0.0980058
Validation loss decreased (0.099832 --> 0.096481).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0847580
	speed: 0.0515s/iter; left time: 1089.9201s
	iters: 200, epoch: 6 | loss: 0.0826628
	speed: 0.0263s/iter; left time: 554.9186s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0858948 Vali Loss: 0.0959795 Test Loss: 0.0970195
Validation loss decreased (0.096481 --> 0.095980).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0905109
	speed: 0.0516s/iter; left time: 1080.8875s
	iters: 200, epoch: 7 | loss: 0.0828156
	speed: 0.0263s/iter; left time: 548.3310s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0842266 Vali Loss: 0.0946363 Test Loss: 0.0962865
Validation loss decreased (0.095980 --> 0.094636).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0775391
	speed: 0.0517s/iter; left time: 1071.6379s
	iters: 200, epoch: 8 | loss: 0.0855141
	speed: 0.0268s/iter; left time: 552.7891s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0828761 Vali Loss: 0.0938537 Test Loss: 0.0953314
Validation loss decreased (0.094636 --> 0.093854).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0816690
	speed: 0.0520s/iter; left time: 1067.0735s
	iters: 200, epoch: 9 | loss: 0.0851879
	speed: 0.0264s/iter; left time: 539.0021s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0829858 Vali Loss: 0.0947143 Test Loss: 0.0958647
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0823175
	speed: 0.0512s/iter; left time: 1039.1988s
	iters: 200, epoch: 10 | loss: 0.0796459
	speed: 0.0263s/iter; left time: 531.3518s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0809271 Vali Loss: 0.0935037 Test Loss: 0.0946443
Validation loss decreased (0.093854 --> 0.093504).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0768127
	speed: 0.0528s/iter; left time: 1058.8666s
	iters: 200, epoch: 11 | loss: 0.0761531
	speed: 0.0265s/iter; left time: 528.0351s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0801934 Vali Loss: 0.0916781 Test Loss: 0.0932157
Validation loss decreased (0.093504 --> 0.091678).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0837837
	speed: 0.0515s/iter; left time: 1022.5853s
	iters: 200, epoch: 12 | loss: 0.0775089
	speed: 0.0265s/iter; left time: 522.1811s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0802700 Vali Loss: 0.0934207 Test Loss: 0.0943639
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0784073
	speed: 0.0511s/iter; left time: 1003.1424s
	iters: 200, epoch: 13 | loss: 0.0782698
	speed: 0.0264s/iter; left time: 515.5103s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0792549 Vali Loss: 0.0911230 Test Loss: 0.0926930
Validation loss decreased (0.091678 --> 0.091123).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0733982
	speed: 0.0512s/iter; left time: 993.5707s
	iters: 200, epoch: 14 | loss: 0.0791362
	speed: 0.0263s/iter; left time: 506.9016s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0786626 Vali Loss: 0.0918051 Test Loss: 0.0929869
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0759531
	speed: 0.0514s/iter; left time: 984.9887s
	iters: 200, epoch: 15 | loss: 0.0776807
	speed: 0.0263s/iter; left time: 501.2031s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0783810 Vali Loss: 0.0908538 Test Loss: 0.0923476
Validation loss decreased (0.091123 --> 0.090854).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0793302
	speed: 0.0515s/iter; left time: 975.4116s
	iters: 200, epoch: 16 | loss: 0.0803491
	speed: 0.0265s/iter; left time: 498.5663s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0782527 Vali Loss: 0.0906397 Test Loss: 0.0923295
Validation loss decreased (0.090854 --> 0.090640).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0744852
	speed: 0.0522s/iter; left time: 976.6843s
	iters: 200, epoch: 17 | loss: 0.0786489
	speed: 0.0265s/iter; left time: 492.4357s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0779015 Vali Loss: 0.0903674 Test Loss: 0.0920459
Validation loss decreased (0.090640 --> 0.090367).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0812337
	speed: 0.0523s/iter; left time: 966.3005s
	iters: 200, epoch: 18 | loss: 0.0783246
	speed: 0.0267s/iter; left time: 490.5978s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0775950 Vali Loss: 0.0926962 Test Loss: 0.0936254
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0784258
	speed: 0.0514s/iter; left time: 938.3536s
	iters: 200, epoch: 19 | loss: 0.0762034
	speed: 0.0263s/iter; left time: 478.3941s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0777468 Vali Loss: 0.0910056 Test Loss: 0.0922556
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0757184
	speed: 0.0521s/iter; left time: 939.6522s
	iters: 200, epoch: 20 | loss: 0.0782048
	speed: 0.0265s/iter; left time: 475.0869s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0774940 Vali Loss: 0.0901802 Test Loss: 0.0919014
Validation loss decreased (0.090367 --> 0.090180).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0752977
	speed: 0.0520s/iter; left time: 926.6258s
	iters: 200, epoch: 21 | loss: 0.0739630
	speed: 0.0264s/iter; left time: 468.3145s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0772572 Vali Loss: 0.0915566 Test Loss: 0.0928652
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0792587
	speed: 0.0516s/iter; left time: 907.9606s
	iters: 200, epoch: 22 | loss: 0.0784705
	speed: 0.0264s/iter; left time: 461.4505s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0769730 Vali Loss: 0.0908989 Test Loss: 0.0921991
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0772055
	speed: 0.0514s/iter; left time: 893.6607s
	iters: 200, epoch: 23 | loss: 0.0812640
	speed: 0.0263s/iter; left time: 454.8712s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0770093 Vali Loss: 0.0900116 Test Loss: 0.0918345
Validation loss decreased (0.090180 --> 0.090012).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0803091
	speed: 0.0524s/iter; left time: 897.8110s
	iters: 200, epoch: 24 | loss: 0.0759364
	speed: 0.0262s/iter; left time: 447.2752s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0770596 Vali Loss: 0.0899609 Test Loss: 0.0916573
Validation loss decreased (0.090012 --> 0.089961).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0758617
	speed: 0.0518s/iter; left time: 876.7166s
	iters: 200, epoch: 25 | loss: 0.0737996
	speed: 0.0264s/iter; left time: 443.4279s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0769033 Vali Loss: 0.0899511 Test Loss: 0.0915681
Validation loss decreased (0.089961 --> 0.089951).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0765661
	speed: 0.0519s/iter; left time: 866.3557s
	iters: 200, epoch: 26 | loss: 0.0763971
	speed: 0.0263s/iter; left time: 437.3978s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0765872 Vali Loss: 0.0900413 Test Loss: 0.0916204
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0758144
	speed: 0.0510s/iter; left time: 839.5982s
	iters: 200, epoch: 27 | loss: 0.0757976
	speed: 0.0264s/iter; left time: 432.3219s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0764685 Vali Loss: 0.0906311 Test Loss: 0.0921329
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0758253
	speed: 0.0519s/iter; left time: 843.7484s
	iters: 200, epoch: 28 | loss: 0.0753282
	speed: 0.0263s/iter; left time: 424.8827s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0765909 Vali Loss: 0.0898152 Test Loss: 0.0914769
Validation loss decreased (0.089951 --> 0.089815).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0749874
	speed: 0.0517s/iter; left time: 829.3648s
	iters: 200, epoch: 29 | loss: 0.0735045
	speed: 0.0265s/iter; left time: 422.7348s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0764512 Vali Loss: 0.0897418 Test Loss: 0.0915002
Validation loss decreased (0.089815 --> 0.089742).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0812473
	speed: 0.0523s/iter; left time: 826.7454s
	iters: 200, epoch: 30 | loss: 0.0751119
	speed: 0.0264s/iter; left time: 415.2961s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0764347 Vali Loss: 0.0904919 Test Loss: 0.0919945
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0783717
	speed: 0.0513s/iter; left time: 798.7433s
	iters: 200, epoch: 31 | loss: 0.0838023
	speed: 0.0265s/iter; left time: 410.9278s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0763518 Vali Loss: 0.0900647 Test Loss: 0.0916321
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0714996
	speed: 0.0524s/iter; left time: 805.4191s
	iters: 200, epoch: 32 | loss: 0.0752642
	speed: 0.0265s/iter; left time: 404.5273s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0763182 Vali Loss: 0.0899387 Test Loss: 0.0916039
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0770082
	speed: 0.0509s/iter; left time: 770.3764s
	iters: 200, epoch: 33 | loss: 0.0753402
	speed: 0.0266s/iter; left time: 400.2229s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0762349 Vali Loss: 0.0896231 Test Loss: 0.0914508
Validation loss decreased (0.089742 --> 0.089623).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0725115
	speed: 0.0526s/iter; left time: 783.9538s
	iters: 200, epoch: 34 | loss: 0.0776233
	speed: 0.0263s/iter; left time: 389.1455s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0762119 Vali Loss: 0.0895975 Test Loss: 0.0913485
Validation loss decreased (0.089623 --> 0.089597).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0771235
	speed: 0.0517s/iter; left time: 759.8852s
	iters: 200, epoch: 35 | loss: 0.0781061
	speed: 0.0263s/iter; left time: 383.7256s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.11s
Steps: 224 | Train Loss: 0.0761741 Vali Loss: 0.0895915 Test Loss: 0.0913442
Validation loss decreased (0.089597 --> 0.089591).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0696032
	speed: 0.0517s/iter; left time: 748.2079s
	iters: 200, epoch: 36 | loss: 0.0770035
	speed: 0.0263s/iter; left time: 377.9562s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0760867 Vali Loss: 0.0900567 Test Loss: 0.0917049
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0778791
	speed: 0.0509s/iter; left time: 724.6042s
	iters: 200, epoch: 37 | loss: 0.0745140
	speed: 0.0263s/iter; left time: 371.6000s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0762562 Vali Loss: 0.0897121 Test Loss: 0.0913620
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0783371
	speed: 0.0509s/iter; left time: 713.1096s
	iters: 200, epoch: 38 | loss: 0.0818648
	speed: 0.0263s/iter; left time: 365.7976s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0761213 Vali Loss: 0.0900666 Test Loss: 0.0917065
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0803079
	speed: 0.0513s/iter; left time: 706.7780s
	iters: 200, epoch: 39 | loss: 0.0745575
	speed: 0.0265s/iter; left time: 363.2237s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0760805 Vali Loss: 0.0901203 Test Loss: 0.0916768
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0744408
	speed: 0.0508s/iter; left time: 689.1131s
	iters: 200, epoch: 40 | loss: 0.0698902
	speed: 0.0263s/iter; left time: 354.3091s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0760944 Vali Loss: 0.0897818 Test Loss: 0.0915024
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0756303
	speed: 0.0513s/iter; left time: 683.9743s
	iters: 200, epoch: 41 | loss: 0.0757952
	speed: 0.0263s/iter; left time: 348.6051s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0760046 Vali Loss: 0.0898426 Test Loss: 0.0915377
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0779208
	speed: 0.0514s/iter; left time: 674.5092s
	iters: 200, epoch: 42 | loss: 0.0747404
	speed: 0.0265s/iter; left time: 345.1440s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0761344 Vali Loss: 0.0901287 Test Loss: 0.0917811
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0771934
	speed: 0.0514s/iter; left time: 662.9252s
	iters: 200, epoch: 43 | loss: 0.0749607
	speed: 0.0264s/iter; left time: 337.2370s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0759900 Vali Loss: 0.0897255 Test Loss: 0.0914727
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0743435
	speed: 0.0513s/iter; left time: 649.7218s
	iters: 200, epoch: 44 | loss: 0.0800619
	speed: 0.0263s/iter; left time: 330.9807s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0760069 Vali Loss: 0.0894995 Test Loss: 0.0912929
Validation loss decreased (0.089591 --> 0.089500).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0732608
	speed: 0.0516s/iter; left time: 641.8608s
	iters: 200, epoch: 45 | loss: 0.0766907
	speed: 0.0265s/iter; left time: 327.2289s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0759964 Vali Loss: 0.0898933 Test Loss: 0.0914188
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0741571
	speed: 0.0509s/iter; left time: 622.2045s
	iters: 200, epoch: 46 | loss: 0.0754467
	speed: 0.0264s/iter; left time: 319.9092s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0760600 Vali Loss: 0.0897355 Test Loss: 0.0913146
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0713772
	speed: 0.0510s/iter; left time: 612.1991s
	iters: 200, epoch: 47 | loss: 0.0743333
	speed: 0.0262s/iter; left time: 312.1347s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0758811 Vali Loss: 0.0899609 Test Loss: 0.0915293
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0764152
	speed: 0.0509s/iter; left time: 599.2296s
	iters: 200, epoch: 48 | loss: 0.0770819
	speed: 0.0263s/iter; left time: 307.1081s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0759072 Vali Loss: 0.0899988 Test Loss: 0.0916863
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0743392
	speed: 0.0508s/iter; left time: 586.3439s
	iters: 200, epoch: 49 | loss: 0.0781718
	speed: 0.0267s/iter; left time: 305.1282s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0759080 Vali Loss: 0.0899594 Test Loss: 0.0915774
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0756658
	speed: 0.0511s/iter; left time: 578.9039s
	iters: 200, epoch: 50 | loss: 0.0756160
	speed: 0.0263s/iter; left time: 295.1804s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0759219 Vali Loss: 0.0898047 Test Loss: 0.0914517
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0815681
	speed: 0.0512s/iter; left time: 568.4181s
	iters: 200, epoch: 51 | loss: 0.0765514
	speed: 0.0263s/iter; left time: 289.4510s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0759615 Vali Loss: 0.0896021 Test Loss: 0.0913982
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0764843
	speed: 0.0511s/iter; left time: 555.8316s
	iters: 200, epoch: 52 | loss: 0.0764052
	speed: 0.0264s/iter; left time: 283.9931s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0758922 Vali Loss: 0.0901767 Test Loss: 0.0917404
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0747740
	speed: 0.0513s/iter; left time: 546.0956s
	iters: 200, epoch: 53 | loss: 0.0760180
	speed: 0.0263s/iter; left time: 277.6196s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0758861 Vali Loss: 0.0898443 Test Loss: 0.0914755
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0749051
	speed: 0.0510s/iter; left time: 532.3610s
	iters: 200, epoch: 54 | loss: 0.0723748
	speed: 0.0263s/iter; left time: 271.5319s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.10s
Steps: 224 | Train Loss: 0.0758602 Vali Loss: 0.0899249 Test Loss: 0.0915471
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021651936694979668, rmse:0.14714597165584564, mae:0.09129294008016586, rse:0.5192984938621521
Intermediate time for DE and pred_len 24: 00h:13m:50.19s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2567174
	speed: 0.0628s/iter; left time: 1388.0100s
	iters: 200, epoch: 1 | loss: 0.2369715
	speed: 0.0412s/iter; left time: 906.9908s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.57s
Steps: 222 | Train Loss: 0.2615639 Vali Loss: 0.2209979 Test Loss: 0.2222324
Validation loss decreased (inf --> 0.220998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1564926
	speed: 0.0754s/iter; left time: 1649.4417s
	iters: 200, epoch: 2 | loss: 0.1341260
	speed: 0.0410s/iter; left time: 893.7510s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1608338 Vali Loss: 0.1363482 Test Loss: 0.1418259
Validation loss decreased (0.220998 --> 0.136348).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1162611
	speed: 0.0761s/iter; left time: 1649.0645s
	iters: 200, epoch: 3 | loss: 0.1177480
	speed: 0.0409s/iter; left time: 880.8507s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1208445 Vali Loss: 0.1277944 Test Loss: 0.1374204
Validation loss decreased (0.136348 --> 0.127794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1102845
	speed: 0.0763s/iter; left time: 1636.2639s
	iters: 200, epoch: 4 | loss: 0.1140750
	speed: 0.0409s/iter; left time: 873.5184s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1129174 Vali Loss: 0.1251605 Test Loss: 0.1341668
Validation loss decreased (0.127794 --> 0.125161).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1166949
	speed: 0.0760s/iter; left time: 1611.2576s
	iters: 200, epoch: 5 | loss: 0.1081393
	speed: 0.0407s/iter; left time: 859.4197s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1103549 Vali Loss: 0.1227886 Test Loss: 0.1303220
Validation loss decreased (0.125161 --> 0.122789).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1062442
	speed: 0.0756s/iter; left time: 1586.8452s
	iters: 200, epoch: 6 | loss: 0.1072186
	speed: 0.0409s/iter; left time: 855.0407s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1078670 Vali Loss: 0.1219471 Test Loss: 0.1291881
Validation loss decreased (0.122789 --> 0.121947).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1061169
	speed: 0.0762s/iter; left time: 1583.3644s
	iters: 200, epoch: 7 | loss: 0.1112051
	speed: 0.0407s/iter; left time: 841.3640s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1068713 Vali Loss: 0.1213121 Test Loss: 0.1290444
Validation loss decreased (0.121947 --> 0.121312).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1057692
	speed: 0.0757s/iter; left time: 1555.9161s
	iters: 200, epoch: 8 | loss: 0.1068326
	speed: 0.0408s/iter; left time: 833.9347s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1059914 Vali Loss: 0.1224635 Test Loss: 0.1298995
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1034219
	speed: 0.0754s/iter; left time: 1532.3575s
	iters: 200, epoch: 9 | loss: 0.0999100
	speed: 0.0408s/iter; left time: 825.6375s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1050044 Vali Loss: 0.1230605 Test Loss: 0.1317926
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1093468
	speed: 0.0748s/iter; left time: 1504.2936s
	iters: 200, epoch: 10 | loss: 0.1081782
	speed: 0.0411s/iter; left time: 821.1721s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1045642 Vali Loss: 0.1219349 Test Loss: 0.1301681
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1027195
	speed: 0.0743s/iter; left time: 1477.2936s
	iters: 200, epoch: 11 | loss: 0.1048118
	speed: 0.0407s/iter; left time: 805.3636s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1038951 Vali Loss: 0.1220826 Test Loss: 0.1309490
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1036500
	speed: 0.0756s/iter; left time: 1486.8648s
	iters: 200, epoch: 12 | loss: 0.0967905
	speed: 0.0407s/iter; left time: 795.0850s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1036535 Vali Loss: 0.1236033 Test Loss: 0.1331385
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1004048
	speed: 0.0750s/iter; left time: 1457.8008s
	iters: 200, epoch: 13 | loss: 0.0993740
	speed: 0.0409s/iter; left time: 790.2178s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1033556 Vali Loss: 0.1226675 Test Loss: 0.1322711
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1005409
	speed: 0.0760s/iter; left time: 1459.5280s
	iters: 200, epoch: 14 | loss: 0.1024006
	speed: 0.0409s/iter; left time: 780.9383s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1029066 Vali Loss: 0.1230128 Test Loss: 0.1320505
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1068955
	speed: 0.0756s/iter; left time: 1435.2907s
	iters: 200, epoch: 15 | loss: 0.1093898
	speed: 0.0410s/iter; left time: 773.8387s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1028959 Vali Loss: 0.1227752 Test Loss: 0.1326943
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1076504
	speed: 0.0754s/iter; left time: 1416.2298s
	iters: 200, epoch: 16 | loss: 0.0938831
	speed: 0.0408s/iter; left time: 760.8655s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1022091 Vali Loss: 0.1224919 Test Loss: 0.1329917
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1013022
	speed: 0.0748s/iter; left time: 1387.4968s
	iters: 200, epoch: 17 | loss: 0.1030388
	speed: 0.0409s/iter; left time: 754.5603s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1022000 Vali Loss: 0.1220423 Test Loss: 0.1307992
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03688869625329971, rmse:0.1920643001794815, mae:0.12904435396194458, rse:0.6801385283470154
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2674383
	speed: 0.0430s/iter; left time: 951.1925s
	iters: 200, epoch: 1 | loss: 0.2461667
	speed: 0.0409s/iter; left time: 899.5050s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.2638501 Vali Loss: 0.2226131 Test Loss: 0.2216158
Validation loss decreased (inf --> 0.222613).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1543895
	speed: 0.0770s/iter; left time: 1684.2141s
	iters: 200, epoch: 2 | loss: 0.1398169
	speed: 0.0410s/iter; left time: 892.0417s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1605066 Vali Loss: 0.1367813 Test Loss: 0.1428790
Validation loss decreased (0.222613 --> 0.136781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1166887
	speed: 0.0773s/iter; left time: 1673.4618s
	iters: 200, epoch: 3 | loss: 0.1116634
	speed: 0.0410s/iter; left time: 884.7100s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1194075 Vali Loss: 0.1278751 Test Loss: 0.1380406
Validation loss decreased (0.136781 --> 0.127875).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1114147
	speed: 0.0766s/iter; left time: 1641.8385s
	iters: 200, epoch: 4 | loss: 0.1107357
	speed: 0.0407s/iter; left time: 869.3579s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1119658 Vali Loss: 0.1239229 Test Loss: 0.1325669
Validation loss decreased (0.127875 --> 0.123923).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1104820
	speed: 0.0773s/iter; left time: 1640.6833s
	iters: 200, epoch: 5 | loss: 0.1076826
	speed: 0.0410s/iter; left time: 864.8064s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1088037 Vali Loss: 0.1234485 Test Loss: 0.1317335
Validation loss decreased (0.123923 --> 0.123449).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1043967
	speed: 0.0769s/iter; left time: 1613.9428s
	iters: 200, epoch: 6 | loss: 0.1043626
	speed: 0.0408s/iter; left time: 853.3950s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1072132 Vali Loss: 0.1251106 Test Loss: 0.1335774
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1115653
	speed: 0.0757s/iter; left time: 1572.3607s
	iters: 200, epoch: 7 | loss: 0.1044515
	speed: 0.0408s/iter; left time: 843.3674s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1065478 Vali Loss: 0.1222214 Test Loss: 0.1305019
Validation loss decreased (0.123449 --> 0.122221).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1077851
	speed: 0.0769s/iter; left time: 1579.9063s
	iters: 200, epoch: 8 | loss: 0.1084414
	speed: 0.0410s/iter; left time: 837.7699s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1052958 Vali Loss: 0.1238670 Test Loss: 0.1318427
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1064024
	speed: 0.0757s/iter; left time: 1538.7054s
	iters: 200, epoch: 9 | loss: 0.1059458
	speed: 0.0407s/iter; left time: 823.5472s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1049578 Vali Loss: 0.1226378 Test Loss: 0.1321362
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1027817
	speed: 0.0758s/iter; left time: 1523.4538s
	iters: 200, epoch: 10 | loss: 0.1018352
	speed: 0.0409s/iter; left time: 817.6640s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1040832 Vali Loss: 0.1221598 Test Loss: 0.1312657
Validation loss decreased (0.122221 --> 0.122160).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1044997
	speed: 0.0763s/iter; left time: 1516.9135s
	iters: 200, epoch: 11 | loss: 0.1089497
	speed: 0.0407s/iter; left time: 804.8415s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1037177 Vali Loss: 0.1224726 Test Loss: 0.1325074
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1011573
	speed: 0.0753s/iter; left time: 1480.9254s
	iters: 200, epoch: 12 | loss: 0.1064023
	speed: 0.0408s/iter; left time: 798.8417s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1033040 Vali Loss: 0.1231317 Test Loss: 0.1332391
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1020794
	speed: 0.0763s/iter; left time: 1483.3208s
	iters: 200, epoch: 13 | loss: 0.1041973
	speed: 0.0408s/iter; left time: 788.3484s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1027258 Vali Loss: 0.1206543 Test Loss: 0.1306935
Validation loss decreased (0.122160 --> 0.120654).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1010036
	speed: 0.0767s/iter; left time: 1473.0943s
	iters: 200, epoch: 14 | loss: 0.1005691
	speed: 0.0407s/iter; left time: 777.9007s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1023238 Vali Loss: 0.1209531 Test Loss: 0.1310647
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1021855
	speed: 0.0757s/iter; left time: 1437.1194s
	iters: 200, epoch: 15 | loss: 0.1030579
	speed: 0.0409s/iter; left time: 773.2666s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1019652 Vali Loss: 0.1216964 Test Loss: 0.1336367
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0990499
	speed: 0.0751s/iter; left time: 1409.2914s
	iters: 200, epoch: 16 | loss: 0.1013082
	speed: 0.0409s/iter; left time: 762.7429s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1017566 Vali Loss: 0.1207150 Test Loss: 0.1311256
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0989789
	speed: 0.0764s/iter; left time: 1417.7488s
	iters: 200, epoch: 17 | loss: 0.1032420
	speed: 0.0409s/iter; left time: 755.3538s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1016855 Vali Loss: 0.1216641 Test Loss: 0.1335739
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1009876
	speed: 0.0755s/iter; left time: 1383.5795s
	iters: 200, epoch: 18 | loss: 0.0992788
	speed: 0.0407s/iter; left time: 741.6790s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1016551 Vali Loss: 0.1225416 Test Loss: 0.1356461
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0994656
	speed: 0.0761s/iter; left time: 1376.9440s
	iters: 200, epoch: 19 | loss: 0.1023100
	speed: 0.0406s/iter; left time: 731.2902s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1011918 Vali Loss: 0.1226855 Test Loss: 0.1347964
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1051435
	speed: 0.0755s/iter; left time: 1350.2551s
	iters: 200, epoch: 20 | loss: 0.1025466
	speed: 0.0409s/iter; left time: 727.3270s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1011156 Vali Loss: 0.1218346 Test Loss: 0.1332678
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1033999
	speed: 0.0756s/iter; left time: 1336.0540s
	iters: 200, epoch: 21 | loss: 0.1037384
	speed: 0.0407s/iter; left time: 715.3239s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1009183 Vali Loss: 0.1211568 Test Loss: 0.1323556
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1021763
	speed: 0.0763s/iter; left time: 1331.2421s
	iters: 200, epoch: 22 | loss: 0.0984414
	speed: 0.0406s/iter; left time: 704.7040s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1006230 Vali Loss: 0.1213428 Test Loss: 0.1328119
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0972030
	speed: 0.0760s/iter; left time: 1308.8892s
	iters: 200, epoch: 23 | loss: 0.0972501
	speed: 0.0408s/iter; left time: 698.3746s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1005551 Vali Loss: 0.1217129 Test Loss: 0.1332923
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03879741579294205, rmse:0.196970596909523, mae:0.1306934952735901, rse:0.6975127458572388
Intermediate time for DE and pred_len 96: 00h:07m:59.75s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2547011
	speed: 0.0659s/iter; left time: 1455.6398s
	iters: 200, epoch: 1 | loss: 0.2446538
	speed: 0.0413s/iter; left time: 908.3826s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.62s
Steps: 222 | Train Loss: 0.2621706 Vali Loss: 0.2210747 Test Loss: 0.2229995
Validation loss decreased (inf --> 0.221075).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1477357
	speed: 0.0766s/iter; left time: 1676.1026s
	iters: 200, epoch: 2 | loss: 0.1341442
	speed: 0.0412s/iter; left time: 898.1266s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1630918 Vali Loss: 0.1387679 Test Loss: 0.1472351
Validation loss decreased (0.221075 --> 0.138768).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1283511
	speed: 0.0767s/iter; left time: 1660.0239s
	iters: 200, epoch: 3 | loss: 0.1233076
	speed: 0.0414s/iter; left time: 891.5262s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1242776 Vali Loss: 0.1343270 Test Loss: 0.1477458
Validation loss decreased (0.138768 --> 0.134327).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1228040
	speed: 0.0773s/iter; left time: 1656.7594s
	iters: 200, epoch: 4 | loss: 0.1145430
	speed: 0.0412s/iter; left time: 879.8497s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1177692 Vali Loss: 0.1332793 Test Loss: 0.1471356
Validation loss decreased (0.134327 --> 0.133279).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1108847
	speed: 0.0781s/iter; left time: 1656.7242s
	iters: 200, epoch: 5 | loss: 0.1184591
	speed: 0.0411s/iter; left time: 868.7648s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1150895 Vali Loss: 0.1292599 Test Loss: 0.1394582
Validation loss decreased (0.133279 --> 0.129260).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1109404
	speed: 0.0758s/iter; left time: 1590.2715s
	iters: 200, epoch: 6 | loss: 0.1151391
	speed: 0.0412s/iter; left time: 860.7552s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1130198 Vali Loss: 0.1282362 Test Loss: 0.1374332
Validation loss decreased (0.129260 --> 0.128236).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1107276
	speed: 0.0768s/iter; left time: 1594.0727s
	iters: 200, epoch: 7 | loss: 0.1117783
	speed: 0.0412s/iter; left time: 851.7463s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1117408 Vali Loss: 0.1297795 Test Loss: 0.1401883
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1098032
	speed: 0.0762s/iter; left time: 1566.2717s
	iters: 200, epoch: 8 | loss: 0.1121785
	speed: 0.0411s/iter; left time: 840.9857s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.1110236 Vali Loss: 0.1291916 Test Loss: 0.1372601
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1095344
	speed: 0.0760s/iter; left time: 1544.2785s
	iters: 200, epoch: 9 | loss: 0.1124224
	speed: 0.0411s/iter; left time: 831.4406s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1099584 Vali Loss: 0.1276474 Test Loss: 0.1373459
Validation loss decreased (0.128236 --> 0.127647).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1069649
	speed: 0.0765s/iter; left time: 1538.7754s
	iters: 200, epoch: 10 | loss: 0.1128789
	speed: 0.0412s/iter; left time: 824.2495s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1094869 Vali Loss: 0.1279376 Test Loss: 0.1391968
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1130599
	speed: 0.0768s/iter; left time: 1527.6429s
	iters: 200, epoch: 11 | loss: 0.1103044
	speed: 0.0411s/iter; left time: 813.4730s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1087799 Vali Loss: 0.1274702 Test Loss: 0.1376306
Validation loss decreased (0.127647 --> 0.127470).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1128469
	speed: 0.0771s/iter; left time: 1514.9593s
	iters: 200, epoch: 12 | loss: 0.1105351
	speed: 0.0413s/iter; left time: 808.1190s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.45s
Steps: 222 | Train Loss: 0.1082214 Vali Loss: 0.1273075 Test Loss: 0.1389605
Validation loss decreased (0.127470 --> 0.127308).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1044768
	speed: 0.0771s/iter; left time: 1499.1437s
	iters: 200, epoch: 13 | loss: 0.1075517
	speed: 0.0411s/iter; left time: 794.5731s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1078091 Vali Loss: 0.1270512 Test Loss: 0.1373295
Validation loss decreased (0.127308 --> 0.127051).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1049805
	speed: 0.0777s/iter; left time: 1492.5376s
	iters: 200, epoch: 14 | loss: 0.1062305
	speed: 0.0411s/iter; left time: 786.3334s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1075614 Vali Loss: 0.1272584 Test Loss: 0.1405276
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1024106
	speed: 0.0761s/iter; left time: 1444.7472s
	iters: 200, epoch: 15 | loss: 0.1068587
	speed: 0.0412s/iter; left time: 778.5298s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1072686 Vali Loss: 0.1271282 Test Loss: 0.1395907
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1049831
	speed: 0.0761s/iter; left time: 1428.1250s
	iters: 200, epoch: 16 | loss: 0.1086448
	speed: 0.0411s/iter; left time: 766.9669s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1069641 Vali Loss: 0.1280589 Test Loss: 0.1429418
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1084256
	speed: 0.0753s/iter; left time: 1396.3966s
	iters: 200, epoch: 17 | loss: 0.1095028
	speed: 0.0411s/iter; left time: 757.4327s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1066884 Vali Loss: 0.1263519 Test Loss: 0.1385314
Validation loss decreased (0.127051 --> 0.126352).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1123055
	speed: 0.0773s/iter; left time: 1416.9853s
	iters: 200, epoch: 18 | loss: 0.1091762
	speed: 0.0411s/iter; left time: 749.1287s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.43s
Steps: 222 | Train Loss: 0.1065208 Vali Loss: 0.1267130 Test Loss: 0.1371872
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1051615
	speed: 0.0758s/iter; left time: 1373.1484s
	iters: 200, epoch: 19 | loss: 0.1084474
	speed: 0.0411s/iter; left time: 739.9549s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1062202 Vali Loss: 0.1266989 Test Loss: 0.1404610
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1065915
	speed: 0.0763s/iter; left time: 1365.3596s
	iters: 200, epoch: 20 | loss: 0.1041478
	speed: 0.0411s/iter; left time: 730.4748s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1061190 Vali Loss: 0.1269398 Test Loss: 0.1404824
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1061094
	speed: 0.0755s/iter; left time: 1334.2136s
	iters: 200, epoch: 21 | loss: 0.1058959
	speed: 0.0415s/iter; left time: 728.2216s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1059716 Vali Loss: 0.1267279 Test Loss: 0.1402840
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1044017
	speed: 0.0755s/iter; left time: 1316.3296s
	iters: 200, epoch: 22 | loss: 0.1075009
	speed: 0.0414s/iter; left time: 718.3517s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1057801 Vali Loss: 0.1281811 Test Loss: 0.1419328
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1047539
	speed: 0.0758s/iter; left time: 1305.3737s
	iters: 200, epoch: 23 | loss: 0.1052754
	speed: 0.0410s/iter; left time: 701.6967s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1056472 Vali Loss: 0.1271066 Test Loss: 0.1417327
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1032366
	speed: 0.0759s/iter; left time: 1289.4818s
	iters: 200, epoch: 24 | loss: 0.1044951
	speed: 0.0411s/iter; left time: 693.8931s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1055431 Vali Loss: 0.1264203 Test Loss: 0.1404810
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1115490
	speed: 0.0749s/iter; left time: 1256.6678s
	iters: 200, epoch: 25 | loss: 0.1035964
	speed: 0.0411s/iter; left time: 686.0076s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1053842 Vali Loss: 0.1263358 Test Loss: 0.1400815
Validation loss decreased (0.126352 --> 0.126336).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1036159
	speed: 0.0761s/iter; left time: 1259.7895s
	iters: 200, epoch: 26 | loss: 0.1037731
	speed: 0.0411s/iter; left time: 675.4162s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1051834 Vali Loss: 0.1265433 Test Loss: 0.1410923
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1022529
	speed: 0.0753s/iter; left time: 1229.3054s
	iters: 200, epoch: 27 | loss: 0.1063197
	speed: 0.0412s/iter; left time: 667.9426s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1051369 Vali Loss: 0.1266984 Test Loss: 0.1409570
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1050435
	speed: 0.0764s/iter; left time: 1231.3200s
	iters: 200, epoch: 28 | loss: 0.1088132
	speed: 0.0411s/iter; left time: 658.0444s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1050999 Vali Loss: 0.1260449 Test Loss: 0.1398182
Validation loss decreased (0.126336 --> 0.126045).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1074791
	speed: 0.0766s/iter; left time: 1216.7442s
	iters: 200, epoch: 29 | loss: 0.1086402
	speed: 0.0412s/iter; left time: 650.8129s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1049540 Vali Loss: 0.1264877 Test Loss: 0.1398621
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.1017556
	speed: 0.0749s/iter; left time: 1173.1060s
	iters: 200, epoch: 30 | loss: 0.1018851
	speed: 0.0412s/iter; left time: 640.5907s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1050275 Vali Loss: 0.1266508 Test Loss: 0.1413750
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1069471
	speed: 0.0754s/iter; left time: 1163.7781s
	iters: 200, epoch: 31 | loss: 0.1028269
	speed: 0.0411s/iter; left time: 630.5249s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1049095 Vali Loss: 0.1261828 Test Loss: 0.1394460
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.1106816
	speed: 0.0761s/iter; left time: 1157.5232s
	iters: 200, epoch: 32 | loss: 0.1046448
	speed: 0.0412s/iter; left time: 622.1907s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.45s
Steps: 222 | Train Loss: 0.1047826 Vali Loss: 0.1264209 Test Loss: 0.1406406
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1042348
	speed: 0.0758s/iter; left time: 1136.8372s
	iters: 200, epoch: 33 | loss: 0.1059592
	speed: 0.0411s/iter; left time: 612.9490s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1047775 Vali Loss: 0.1266658 Test Loss: 0.1412112
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.1083043
	speed: 0.0753s/iter; left time: 1113.1941s
	iters: 200, epoch: 34 | loss: 0.1091277
	speed: 0.0410s/iter; left time: 601.9288s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1047314 Vali Loss: 0.1269310 Test Loss: 0.1415482
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.1050427
	speed: 0.0746s/iter; left time: 1085.8634s
	iters: 200, epoch: 35 | loss: 0.1053451
	speed: 0.0411s/iter; left time: 593.8324s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1046090 Vali Loss: 0.1260353 Test Loss: 0.1401784
Validation loss decreased (0.126045 --> 0.126035).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.1072772
	speed: 0.0758s/iter; left time: 1086.7973s
	iters: 200, epoch: 36 | loss: 0.1069313
	speed: 0.0410s/iter; left time: 584.0907s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1046577 Vali Loss: 0.1265546 Test Loss: 0.1414028
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.1073018
	speed: 0.0749s/iter; left time: 1056.0987s
	iters: 200, epoch: 37 | loss: 0.1043714
	speed: 0.0410s/iter; left time: 574.6869s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1046224 Vali Loss: 0.1261640 Test Loss: 0.1402127
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.1110265
	speed: 0.0759s/iter; left time: 1053.3801s
	iters: 200, epoch: 38 | loss: 0.1001320
	speed: 0.0410s/iter; left time: 565.5466s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1045099 Vali Loss: 0.1261084 Test Loss: 0.1405019
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.1004808
	speed: 0.0753s/iter; left time: 1028.4516s
	iters: 200, epoch: 39 | loss: 0.1060599
	speed: 0.0411s/iter; left time: 558.1876s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1045482 Vali Loss: 0.1261528 Test Loss: 0.1404652
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.1076685
	speed: 0.0749s/iter; left time: 1007.5148s
	iters: 200, epoch: 40 | loss: 0.1019712
	speed: 0.0411s/iter; left time: 548.3667s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1044784 Vali Loss: 0.1262912 Test Loss: 0.1407943
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.1066837
	speed: 0.0756s/iter; left time: 999.6501s
	iters: 200, epoch: 41 | loss: 0.1006510
	speed: 0.0413s/iter; left time: 541.9486s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1045106 Vali Loss: 0.1259988 Test Loss: 0.1401316
Validation loss decreased (0.126035 --> 0.125999).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.1069852
	speed: 0.0774s/iter; left time: 1006.1285s
	iters: 200, epoch: 42 | loss: 0.1012278
	speed: 0.0411s/iter; left time: 529.9154s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1044709 Vali Loss: 0.1263843 Test Loss: 0.1406530
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.1050513
	speed: 0.0751s/iter; left time: 958.9403s
	iters: 200, epoch: 43 | loss: 0.1035220
	speed: 0.0412s/iter; left time: 521.8023s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1044019 Vali Loss: 0.1262721 Test Loss: 0.1411214
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.1099950
	speed: 0.0762s/iter; left time: 956.2018s
	iters: 200, epoch: 44 | loss: 0.1008029
	speed: 0.0413s/iter; left time: 514.0173s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.1043530 Vali Loss: 0.1268223 Test Loss: 0.1418868
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.1062310
	speed: 0.0748s/iter; left time: 922.6622s
	iters: 200, epoch: 45 | loss: 0.0978017
	speed: 0.0411s/iter; left time: 502.9413s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1043717 Vali Loss: 0.1263294 Test Loss: 0.1411482
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.1073297
	speed: 0.0739s/iter; left time: 895.3941s
	iters: 200, epoch: 46 | loss: 0.1029892
	speed: 0.0411s/iter; left time: 493.3324s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1043665 Vali Loss: 0.1261325 Test Loss: 0.1409885
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.1039653
	speed: 0.0761s/iter; left time: 905.1491s
	iters: 200, epoch: 47 | loss: 0.1021439
	speed: 0.0411s/iter; left time: 484.1952s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1044277 Vali Loss: 0.1264205 Test Loss: 0.1413692
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.1047657
	speed: 0.0753s/iter; left time: 879.0226s
	iters: 200, epoch: 48 | loss: 0.1039199
	speed: 0.0410s/iter; left time: 474.2047s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1043820 Vali Loss: 0.1264119 Test Loss: 0.1411667
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.1022447
	speed: 0.0757s/iter; left time: 866.2159s
	iters: 200, epoch: 49 | loss: 0.1015952
	speed: 0.0412s/iter; left time: 467.2662s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1043758 Vali Loss: 0.1260933 Test Loss: 0.1404598
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.1026140
	speed: 0.0743s/iter; left time: 834.1814s
	iters: 200, epoch: 50 | loss: 0.0980135
	speed: 0.0412s/iter; left time: 457.9941s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1043637 Vali Loss: 0.1261517 Test Loss: 0.1409613
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.1067247
	speed: 0.0754s/iter; left time: 829.5468s
	iters: 200, epoch: 51 | loss: 0.1038287
	speed: 0.0412s/iter; left time: 449.5097s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1043192 Vali Loss: 0.1263004 Test Loss: 0.1410258
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04456966370344162, rmse:0.2111152857542038, mae:0.14013166725635529, rse:0.747787356376648
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2695983
	speed: 0.0435s/iter; left time: 960.9874s
	iters: 200, epoch: 1 | loss: 0.2458136
	speed: 0.0412s/iter; left time: 905.8396s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.2653355 Vali Loss: 0.2224486 Test Loss: 0.2230866
Validation loss decreased (inf --> 0.222449).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1459184
	speed: 0.0775s/iter; left time: 1695.2316s
	iters: 200, epoch: 2 | loss: 0.1344317
	speed: 0.0411s/iter; left time: 894.6112s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1615751 Vali Loss: 0.1398708 Test Loss: 0.1480999
Validation loss decreased (0.222449 --> 0.139871).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1242755
	speed: 0.0788s/iter; left time: 1705.8541s
	iters: 200, epoch: 3 | loss: 0.1158472
	speed: 0.0413s/iter; left time: 889.2333s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1242331 Vali Loss: 0.1310286 Test Loss: 0.1426450
Validation loss decreased (0.139871 --> 0.131029).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1153544
	speed: 0.0851s/iter; left time: 1824.0587s
	iters: 200, epoch: 4 | loss: 0.1145391
	speed: 0.0412s/iter; left time: 878.8417s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1171351 Vali Loss: 0.1277771 Test Loss: 0.1371709
Validation loss decreased (0.131029 --> 0.127777).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1219279
	speed: 0.0780s/iter; left time: 1653.8863s
	iters: 200, epoch: 5 | loss: 0.1114400
	speed: 0.0411s/iter; left time: 867.4408s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1141187 Vali Loss: 0.1312206 Test Loss: 0.1432557
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1113654
	speed: 0.0761s/iter; left time: 1596.7595s
	iters: 200, epoch: 6 | loss: 0.1110327
	speed: 0.0410s/iter; left time: 857.3071s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1122951 Vali Loss: 0.1279132 Test Loss: 0.1393908
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1125884
	speed: 0.0772s/iter; left time: 1602.6943s
	iters: 200, epoch: 7 | loss: 0.1114042
	speed: 0.0410s/iter; left time: 848.4471s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1113330 Vali Loss: 0.1264910 Test Loss: 0.1378686
Validation loss decreased (0.127777 --> 0.126491).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1113305
	speed: 0.0778s/iter; left time: 1598.4130s
	iters: 200, epoch: 8 | loss: 0.1078927
	speed: 0.0410s/iter; left time: 839.1236s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1103155 Vali Loss: 0.1271214 Test Loss: 0.1400218
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1121107
	speed: 0.0766s/iter; left time: 1556.5739s
	iters: 200, epoch: 9 | loss: 0.1082017
	speed: 0.0413s/iter; left time: 836.0363s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1099665 Vali Loss: 0.1268901 Test Loss: 0.1410304
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1071596
	speed: 0.0771s/iter; left time: 1549.6833s
	iters: 200, epoch: 10 | loss: 0.1088479
	speed: 0.0411s/iter; left time: 822.6311s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.40s
Steps: 222 | Train Loss: 0.1091042 Vali Loss: 0.1271832 Test Loss: 0.1428634
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1068706
	speed: 0.0762s/iter; left time: 1515.5644s
	iters: 200, epoch: 11 | loss: 0.1111364
	speed: 0.0413s/iter; left time: 816.2670s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1084925 Vali Loss: 0.1307015 Test Loss: 0.1492935
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1100810
	speed: 0.0774s/iter; left time: 1520.8222s
	iters: 200, epoch: 12 | loss: 0.1114843
	speed: 0.0412s/iter; left time: 805.1268s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.43s
Steps: 222 | Train Loss: 0.1080450 Vali Loss: 0.1283088 Test Loss: 0.1461065
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1144699
	speed: 0.0764s/iter; left time: 1484.2761s
	iters: 200, epoch: 13 | loss: 0.1059909
	speed: 0.0411s/iter; left time: 794.5458s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1073719 Vali Loss: 0.1269572 Test Loss: 0.1428572
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1083283
	speed: 0.0763s/iter; left time: 1466.8498s
	iters: 200, epoch: 14 | loss: 0.1086156
	speed: 0.0411s/iter; left time: 786.1331s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1069796 Vali Loss: 0.1259924 Test Loss: 0.1436143
Validation loss decreased (0.126491 --> 0.125992).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1066480
	speed: 0.0780s/iter; left time: 1482.3102s
	iters: 200, epoch: 15 | loss: 0.1062846
	speed: 0.0411s/iter; left time: 777.0487s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1068378 Vali Loss: 0.1262309 Test Loss: 0.1440513
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1067633
	speed: 0.0765s/iter; left time: 1435.6313s
	iters: 200, epoch: 16 | loss: 0.1104817
	speed: 0.0412s/iter; left time: 769.1754s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.1063836 Vali Loss: 0.1261759 Test Loss: 0.1427229
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1053825
	speed: 0.0766s/iter; left time: 1420.5417s
	iters: 200, epoch: 17 | loss: 0.1034071
	speed: 0.0410s/iter; left time: 756.5807s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1059606 Vali Loss: 0.1266880 Test Loss: 0.1433154
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1074457
	speed: 0.0763s/iter; left time: 1398.0312s
	iters: 200, epoch: 18 | loss: 0.1025829
	speed: 0.0411s/iter; left time: 748.5073s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1056170 Vali Loss: 0.1255190 Test Loss: 0.1441649
Validation loss decreased (0.125992 --> 0.125519).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1041701
	speed: 0.0774s/iter; left time: 1401.8615s
	iters: 200, epoch: 19 | loss: 0.1018132
	speed: 0.0412s/iter; left time: 740.9868s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1052355 Vali Loss: 0.1258863 Test Loss: 0.1445787
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1048761
	speed: 0.0761s/iter; left time: 1360.8724s
	iters: 200, epoch: 20 | loss: 0.1065127
	speed: 0.0412s/iter; left time: 732.6337s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1051658 Vali Loss: 0.1252106 Test Loss: 0.1429672
Validation loss decreased (0.125519 --> 0.125211).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1035283
	speed: 0.0769s/iter; left time: 1357.3456s
	iters: 200, epoch: 21 | loss: 0.1084166
	speed: 0.0411s/iter; left time: 721.9864s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1050887 Vali Loss: 0.1262848 Test Loss: 0.1436059
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1018366
	speed: 0.0779s/iter; left time: 1359.2956s
	iters: 200, epoch: 22 | loss: 0.1031664
	speed: 0.0411s/iter; left time: 712.6848s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.45s
Steps: 222 | Train Loss: 0.1047694 Vali Loss: 0.1251836 Test Loss: 0.1430537
Validation loss decreased (0.125211 --> 0.125184).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1010575
	speed: 0.0776s/iter; left time: 1335.4983s
	iters: 200, epoch: 23 | loss: 0.1016529
	speed: 0.0410s/iter; left time: 701.9794s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1047283 Vali Loss: 0.1250855 Test Loss: 0.1421348
Validation loss decreased (0.125184 --> 0.125085).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1066785
	speed: 0.0774s/iter; left time: 1316.1817s
	iters: 200, epoch: 24 | loss: 0.1021970
	speed: 0.0411s/iter; left time: 694.2526s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1045605 Vali Loss: 0.1252609 Test Loss: 0.1430158
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1062797
	speed: 0.0768s/iter; left time: 1288.2655s
	iters: 200, epoch: 25 | loss: 0.1052838
	speed: 0.0412s/iter; left time: 687.0779s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1042314 Vali Loss: 0.1257189 Test Loss: 0.1448543
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1088224
	speed: 0.0765s/iter; left time: 1266.0218s
	iters: 200, epoch: 26 | loss: 0.1028319
	speed: 0.0411s/iter; left time: 676.0099s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1042463 Vali Loss: 0.1254094 Test Loss: 0.1445392
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1050898
	speed: 0.0764s/iter; left time: 1248.0756s
	iters: 200, epoch: 27 | loss: 0.1036657
	speed: 0.0411s/iter; left time: 667.7491s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1041168 Vali Loss: 0.1252972 Test Loss: 0.1431515
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1059706
	speed: 0.0763s/iter; left time: 1229.3850s
	iters: 200, epoch: 28 | loss: 0.1038235
	speed: 0.0410s/iter; left time: 656.8088s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1038388 Vali Loss: 0.1252899 Test Loss: 0.1423092
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1048199
	speed: 0.0766s/iter; left time: 1217.3585s
	iters: 200, epoch: 29 | loss: 0.1049025
	speed: 0.0412s/iter; left time: 650.3140s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1037922 Vali Loss: 0.1254297 Test Loss: 0.1428744
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.1042742
	speed: 0.0760s/iter; left time: 1190.2551s
	iters: 200, epoch: 30 | loss: 0.1088455
	speed: 0.0414s/iter; left time: 643.9882s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1037990 Vali Loss: 0.1253161 Test Loss: 0.1436195
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1021391
	speed: 0.0767s/iter; left time: 1184.9977s
	iters: 200, epoch: 31 | loss: 0.1076526
	speed: 0.0411s/iter; left time: 629.8870s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1036785 Vali Loss: 0.1253694 Test Loss: 0.1436673
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0983822
	speed: 0.0762s/iter; left time: 1159.9313s
	iters: 200, epoch: 32 | loss: 0.1030093
	speed: 0.0411s/iter; left time: 621.7746s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1036134 Vali Loss: 0.1252570 Test Loss: 0.1444752
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1020824
	speed: 0.0768s/iter; left time: 1152.4882s
	iters: 200, epoch: 33 | loss: 0.1070113
	speed: 0.0412s/iter; left time: 614.2713s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.42s
Steps: 222 | Train Loss: 0.1035500 Vali Loss: 0.1254304 Test Loss: 0.1442089
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04730448126792908, rmse:0.21749593317508698, mae:0.14213477075099945, rse:0.770388126373291
Intermediate time for DE and pred_len 168: 00h:16m:40.88sIntermediate time for DE: 00h:38m:30.83s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2713369
	speed: 0.0642s/iter; left time: 1426.1914s
	iters: 200, epoch: 1 | loss: 0.2666838
	speed: 0.0406s/iter; left time: 896.4586s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.52s
Steps: 223 | Train Loss: 0.2775031 Vali Loss: 0.2227723 Test Loss: 0.2392421
Validation loss decreased (inf --> 0.222772).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1425531
	speed: 0.0736s/iter; left time: 1618.4386s
	iters: 200, epoch: 2 | loss: 0.1142946
	speed: 0.0404s/iter; left time: 883.1687s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.18s
Steps: 223 | Train Loss: 0.1516249 Vali Loss: 0.1061840 Test Loss: 0.1243391
Validation loss decreased (0.222772 --> 0.106184).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1043676
	speed: 0.0740s/iter; left time: 1608.9193s
	iters: 200, epoch: 3 | loss: 0.0964127
	speed: 0.0405s/iter; left time: 876.3062s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.1000793 Vali Loss: 0.0966325 Test Loss: 0.1096701
Validation loss decreased (0.106184 --> 0.096632).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0971016
	speed: 0.0745s/iter; left time: 1604.4450s
	iters: 200, epoch: 4 | loss: 0.0946171
	speed: 0.0404s/iter; left time: 866.2746s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0896545 Vali Loss: 0.0937908 Test Loss: 0.1082869
Validation loss decreased (0.096632 --> 0.093791).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0815196
	speed: 0.0736s/iter; left time: 1567.2898s
	iters: 200, epoch: 5 | loss: 0.0840815
	speed: 0.0404s/iter; left time: 856.9541s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0858922 Vali Loss: 0.0940853 Test Loss: 0.1072255
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0800261
	speed: 0.0738s/iter; left time: 1556.8144s
	iters: 200, epoch: 6 | loss: 0.0847688
	speed: 0.0404s/iter; left time: 848.7940s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0843575 Vali Loss: 0.0934700 Test Loss: 0.1070231
Validation loss decreased (0.093791 --> 0.093470).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0830629
	speed: 0.0735s/iter; left time: 1532.6763s
	iters: 200, epoch: 7 | loss: 0.0818849
	speed: 0.0405s/iter; left time: 840.9300s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0830517 Vali Loss: 0.0935562 Test Loss: 0.1062768
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0861846
	speed: 0.0726s/iter; left time: 1498.8984s
	iters: 200, epoch: 8 | loss: 0.0820004
	speed: 0.0405s/iter; left time: 831.0199s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0825876 Vali Loss: 0.0935195 Test Loss: 0.1072546
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0820624
	speed: 0.0733s/iter; left time: 1496.6125s
	iters: 200, epoch: 9 | loss: 0.0781329
	speed: 0.0404s/iter; left time: 821.6965s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0817799 Vali Loss: 0.0945552 Test Loss: 0.1062779
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0802087
	speed: 0.0729s/iter; left time: 1472.0468s
	iters: 200, epoch: 10 | loss: 0.0832409
	speed: 0.0407s/iter; left time: 818.2452s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0810398 Vali Loss: 0.0922729 Test Loss: 0.1053363
Validation loss decreased (0.093470 --> 0.092273).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0854504
	speed: 0.0736s/iter; left time: 1470.1661s
	iters: 200, epoch: 11 | loss: 0.0827603
	speed: 0.0405s/iter; left time: 804.0218s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0806057 Vali Loss: 0.0923044 Test Loss: 0.1049127
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0715239
	speed: 0.0728s/iter; left time: 1437.5269s
	iters: 200, epoch: 12 | loss: 0.0846490
	speed: 0.0406s/iter; left time: 798.0289s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0804665 Vali Loss: 0.0916704 Test Loss: 0.1046567
Validation loss decreased (0.092273 --> 0.091670).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0789320
	speed: 0.0735s/iter; left time: 1435.9416s
	iters: 200, epoch: 13 | loss: 0.0801651
	speed: 0.0404s/iter; left time: 784.5553s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0798680 Vali Loss: 0.0913420 Test Loss: 0.1045888
Validation loss decreased (0.091670 --> 0.091342).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0795190
	speed: 0.0740s/iter; left time: 1427.8847s
	iters: 200, epoch: 14 | loss: 0.0791162
	speed: 0.0405s/iter; left time: 777.1902s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.30s
Steps: 223 | Train Loss: 0.0797841 Vali Loss: 0.0914175 Test Loss: 0.1047300
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0785403
	speed: 0.0732s/iter; left time: 1396.1154s
	iters: 200, epoch: 15 | loss: 0.0783143
	speed: 0.0404s/iter; left time: 766.6822s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0794608 Vali Loss: 0.0913306 Test Loss: 0.1041831
Validation loss decreased (0.091342 --> 0.091331).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0761678
	speed: 0.0737s/iter; left time: 1389.3648s
	iters: 200, epoch: 16 | loss: 0.0737287
	speed: 0.0404s/iter; left time: 758.1598s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0792677 Vali Loss: 0.0918222 Test Loss: 0.1056311
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0833909
	speed: 0.0731s/iter; left time: 1361.4509s
	iters: 200, epoch: 17 | loss: 0.0813364
	speed: 0.0406s/iter; left time: 751.7802s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0788700 Vali Loss: 0.0909332 Test Loss: 0.1044233
Validation loss decreased (0.091331 --> 0.090933).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0786313
	speed: 0.0738s/iter; left time: 1358.7282s
	iters: 200, epoch: 18 | loss: 0.0771805
	speed: 0.0404s/iter; left time: 740.1378s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0787176 Vali Loss: 0.0909456 Test Loss: 0.1046183
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0785226
	speed: 0.0728s/iter; left time: 1323.6296s
	iters: 200, epoch: 19 | loss: 0.0825728
	speed: 0.0408s/iter; left time: 738.8520s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0784871 Vali Loss: 0.0913229 Test Loss: 0.1046131
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0773899
	speed: 0.0730s/iter; left time: 1312.1622s
	iters: 200, epoch: 20 | loss: 0.0719374
	speed: 0.0406s/iter; left time: 724.4741s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0783474 Vali Loss: 0.0913036 Test Loss: 0.1047586
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0767777
	speed: 0.0737s/iter; left time: 1306.6265s
	iters: 200, epoch: 21 | loss: 0.0832794
	speed: 0.0405s/iter; left time: 713.7119s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0781011 Vali Loss: 0.0910498 Test Loss: 0.1046779
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0779329
	speed: 0.0732s/iter; left time: 1282.5354s
	iters: 200, epoch: 22 | loss: 0.0787014
	speed: 0.0404s/iter; left time: 704.4442s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0782003 Vali Loss: 0.0910638 Test Loss: 0.1044707
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0808069
	speed: 0.0743s/iter; left time: 1284.7940s
	iters: 200, epoch: 23 | loss: 0.0714334
	speed: 0.0404s/iter; left time: 695.0588s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0781985 Vali Loss: 0.0906492 Test Loss: 0.1044392
Validation loss decreased (0.090933 --> 0.090649).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0796330
	speed: 0.0730s/iter; left time: 1246.6551s
	iters: 200, epoch: 24 | loss: 0.0792855
	speed: 0.0404s/iter; left time: 685.8442s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0781420 Vali Loss: 0.0928221 Test Loss: 0.1059146
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0789801
	speed: 0.0738s/iter; left time: 1242.9445s
	iters: 200, epoch: 25 | loss: 0.0770648
	speed: 0.0405s/iter; left time: 678.8454s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0778025 Vali Loss: 0.0910814 Test Loss: 0.1047692
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0750756
	speed: 0.0735s/iter; left time: 1222.6360s
	iters: 200, epoch: 26 | loss: 0.0734449
	speed: 0.0405s/iter; left time: 668.7703s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0777318 Vali Loss: 0.0906680 Test Loss: 0.1045140
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0786629
	speed: 0.0731s/iter; left time: 1199.1492s
	iters: 200, epoch: 27 | loss: 0.0804909
	speed: 0.0404s/iter; left time: 659.0553s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0775561 Vali Loss: 0.0909488 Test Loss: 0.1053258
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0729849
	speed: 0.0735s/iter; left time: 1188.6991s
	iters: 200, epoch: 28 | loss: 0.0823348
	speed: 0.0406s/iter; left time: 652.5158s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0775038 Vali Loss: 0.0906877 Test Loss: 0.1043712
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0803065
	speed: 0.0728s/iter; left time: 1161.3404s
	iters: 200, epoch: 29 | loss: 0.0776471
	speed: 0.0404s/iter; left time: 641.1638s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0775364 Vali Loss: 0.0904995 Test Loss: 0.1043667
Validation loss decreased (0.090649 --> 0.090499).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0795126
	speed: 0.0740s/iter; left time: 1164.1134s
	iters: 200, epoch: 30 | loss: 0.0834667
	speed: 0.0405s/iter; left time: 632.5401s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0774307 Vali Loss: 0.0906215 Test Loss: 0.1045543
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0763445
	speed: 0.0729s/iter; left time: 1131.1346s
	iters: 200, epoch: 31 | loss: 0.0814237
	speed: 0.0404s/iter; left time: 622.7547s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0773705 Vali Loss: 0.0906609 Test Loss: 0.1045952
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0799850
	speed: 0.0731s/iter; left time: 1117.6484s
	iters: 200, epoch: 32 | loss: 0.0796433
	speed: 0.0405s/iter; left time: 614.7204s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0773739 Vali Loss: 0.0906913 Test Loss: 0.1047461
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0764047
	speed: 0.0733s/iter; left time: 1103.7078s
	iters: 200, epoch: 33 | loss: 0.0748812
	speed: 0.0404s/iter; left time: 605.2630s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0772914 Vali Loss: 0.0904291 Test Loss: 0.1046706
Validation loss decreased (0.090499 --> 0.090429).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0757065
	speed: 0.0744s/iter; left time: 1104.3862s
	iters: 200, epoch: 34 | loss: 0.0784300
	speed: 0.0404s/iter; left time: 595.8476s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0774925 Vali Loss: 0.0904285 Test Loss: 0.1045240
Validation loss decreased (0.090429 --> 0.090428).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0789417
	speed: 0.0737s/iter; left time: 1077.2250s
	iters: 200, epoch: 35 | loss: 0.0795636
	speed: 0.0404s/iter; left time: 587.0956s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0772180 Vali Loss: 0.0903595 Test Loss: 0.1044108
Validation loss decreased (0.090428 --> 0.090360).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0779223
	speed: 0.0741s/iter; left time: 1067.2375s
	iters: 200, epoch: 36 | loss: 0.0729762
	speed: 0.0405s/iter; left time: 578.6734s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0771922 Vali Loss: 0.0907313 Test Loss: 0.1047319
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0809649
	speed: 0.0729s/iter; left time: 1032.8605s
	iters: 200, epoch: 37 | loss: 0.0781822
	speed: 0.0404s/iter; left time: 568.9658s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.19s
Steps: 223 | Train Loss: 0.0771938 Vali Loss: 0.0908119 Test Loss: 0.1048842
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0790581
	speed: 0.0730s/iter; left time: 1018.4860s
	iters: 200, epoch: 38 | loss: 0.0769915
	speed: 0.0405s/iter; left time: 560.7515s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0771616 Vali Loss: 0.0907066 Test Loss: 0.1046624
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0794891
	speed: 0.0736s/iter; left time: 1010.2209s
	iters: 200, epoch: 39 | loss: 0.0770491
	speed: 0.0405s/iter; left time: 551.6163s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0770720 Vali Loss: 0.0905792 Test Loss: 0.1047044
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0841586
	speed: 0.0729s/iter; left time: 984.7676s
	iters: 200, epoch: 40 | loss: 0.0748983
	speed: 0.0409s/iter; left time: 547.6888s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0771946 Vali Loss: 0.0904707 Test Loss: 0.1045962
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0774204
	speed: 0.0731s/iter; left time: 970.2207s
	iters: 200, epoch: 41 | loss: 0.0755066
	speed: 0.0405s/iter; left time: 533.7910s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0771183 Vali Loss: 0.0908790 Test Loss: 0.1048907
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0775084
	speed: 0.0732s/iter; left time: 956.0669s
	iters: 200, epoch: 42 | loss: 0.0691002
	speed: 0.0404s/iter; left time: 524.0220s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0771249 Vali Loss: 0.0906246 Test Loss: 0.1047030
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0784101
	speed: 0.0732s/iter; left time: 940.1250s
	iters: 200, epoch: 43 | loss: 0.0804814
	speed: 0.0404s/iter; left time: 514.9575s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0770689 Vali Loss: 0.0905814 Test Loss: 0.1046426
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0731711
	speed: 0.0733s/iter; left time: 924.2530s
	iters: 200, epoch: 44 | loss: 0.0752849
	speed: 0.0406s/iter; left time: 508.3404s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0769947 Vali Loss: 0.0905712 Test Loss: 0.1047970
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0773128
	speed: 0.0739s/iter; left time: 915.1414s
	iters: 200, epoch: 45 | loss: 0.0740729
	speed: 0.0407s/iter; left time: 500.0395s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0770263 Vali Loss: 0.0906391 Test Loss: 0.1048571
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.026252198964357376, rmse:0.1620253026485443, mae:0.10441073030233383, rse:0.5589413642883301
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2769710
	speed: 0.0422s/iter; left time: 936.9427s
	iters: 200, epoch: 1 | loss: 0.2703775
	speed: 0.0404s/iter; left time: 893.2489s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.2823273 Vali Loss: 0.2324963 Test Loss: 0.2465261
Validation loss decreased (inf --> 0.232496).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1442659
	speed: 0.0752s/iter; left time: 1653.5216s
	iters: 200, epoch: 2 | loss: 0.1169949
	speed: 0.0405s/iter; left time: 887.0572s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.1555963 Vali Loss: 0.1053269 Test Loss: 0.1230106
Validation loss decreased (0.232496 --> 0.105327).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0988071
	speed: 0.0756s/iter; left time: 1644.9951s
	iters: 200, epoch: 3 | loss: 0.0924419
	speed: 0.0405s/iter; left time: 877.6750s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0987847 Vali Loss: 0.0956057 Test Loss: 0.1094963
Validation loss decreased (0.105327 --> 0.095606).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0906304
	speed: 0.0741s/iter; left time: 1595.9171s
	iters: 200, epoch: 4 | loss: 0.0859146
	speed: 0.0406s/iter; left time: 870.8884s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0896020 Vali Loss: 0.0942191 Test Loss: 0.1084674
Validation loss decreased (0.095606 --> 0.094219).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0833325
	speed: 0.0744s/iter; left time: 1586.0871s
	iters: 200, epoch: 5 | loss: 0.0874665
	speed: 0.0404s/iter; left time: 857.5373s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0865134 Vali Loss: 0.0941752 Test Loss: 0.1083765
Validation loss decreased (0.094219 --> 0.094175).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0809869
	speed: 0.0748s/iter; left time: 1577.3494s
	iters: 200, epoch: 6 | loss: 0.0877753
	speed: 0.0404s/iter; left time: 848.5874s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0840436 Vali Loss: 0.0927668 Test Loss: 0.1062152
Validation loss decreased (0.094175 --> 0.092767).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0832490
	speed: 0.0747s/iter; left time: 1558.7404s
	iters: 200, epoch: 7 | loss: 0.0829870
	speed: 0.0405s/iter; left time: 839.8681s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0835418 Vali Loss: 0.0924259 Test Loss: 0.1067966
Validation loss decreased (0.092767 --> 0.092426).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0888897
	speed: 0.0747s/iter; left time: 1542.5103s
	iters: 200, epoch: 8 | loss: 0.0776150
	speed: 0.0405s/iter; left time: 832.2374s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0817162 Vali Loss: 0.0922475 Test Loss: 0.1054070
Validation loss decreased (0.092426 --> 0.092248).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0843962
	speed: 0.0742s/iter; left time: 1514.0752s
	iters: 200, epoch: 9 | loss: 0.0838336
	speed: 0.0405s/iter; left time: 821.9022s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0816821 Vali Loss: 0.0933507 Test Loss: 0.1062168
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0810641
	speed: 0.0744s/iter; left time: 1502.5885s
	iters: 200, epoch: 10 | loss: 0.0758244
	speed: 0.0405s/iter; left time: 813.9880s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0805795 Vali Loss: 0.0916511 Test Loss: 0.1045354
Validation loss decreased (0.092248 --> 0.091651).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0785524
	speed: 0.0747s/iter; left time: 1492.0473s
	iters: 200, epoch: 11 | loss: 0.0734199
	speed: 0.0404s/iter; left time: 802.7129s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0804764 Vali Loss: 0.0922665 Test Loss: 0.1044703
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0815930
	speed: 0.0741s/iter; left time: 1463.5480s
	iters: 200, epoch: 12 | loss: 0.0852654
	speed: 0.0405s/iter; left time: 796.3335s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0801125 Vali Loss: 0.0941295 Test Loss: 0.1052972
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0784688
	speed: 0.0745s/iter; left time: 1455.5487s
	iters: 200, epoch: 13 | loss: 0.0802191
	speed: 0.0405s/iter; left time: 786.6449s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0796360 Vali Loss: 0.0911914 Test Loss: 0.1038486
Validation loss decreased (0.091651 --> 0.091191).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0795192
	speed: 0.0744s/iter; left time: 1436.1961s
	iters: 200, epoch: 14 | loss: 0.0730847
	speed: 0.0405s/iter; left time: 776.8044s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0789982 Vali Loss: 0.0926355 Test Loss: 0.1048882
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0796765
	speed: 0.0743s/iter; left time: 1417.1129s
	iters: 200, epoch: 15 | loss: 0.0771256
	speed: 0.0404s/iter; left time: 767.4386s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0790234 Vali Loss: 0.0907969 Test Loss: 0.1034538
Validation loss decreased (0.091191 --> 0.090797).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0818546
	speed: 0.0750s/iter; left time: 1413.9264s
	iters: 200, epoch: 16 | loss: 0.0809140
	speed: 0.0405s/iter; left time: 760.4547s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.28s
Steps: 223 | Train Loss: 0.0784743 Vali Loss: 0.0916429 Test Loss: 0.1039903
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0794071
	speed: 0.0747s/iter; left time: 1392.2929s
	iters: 200, epoch: 17 | loss: 0.0774146
	speed: 0.0405s/iter; left time: 750.5844s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0785013 Vali Loss: 0.0909371 Test Loss: 0.1035683
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0766296
	speed: 0.0744s/iter; left time: 1369.0815s
	iters: 200, epoch: 18 | loss: 0.0832104
	speed: 0.0405s/iter; left time: 741.3880s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0784101 Vali Loss: 0.0908933 Test Loss: 0.1042490
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0762396
	speed: 0.0737s/iter; left time: 1341.2443s
	iters: 200, epoch: 19 | loss: 0.0799202
	speed: 0.0405s/iter; left time: 732.3048s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0783316 Vali Loss: 0.0916444 Test Loss: 0.1038889
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0802529
	speed: 0.0745s/iter; left time: 1337.9869s
	iters: 200, epoch: 20 | loss: 0.0766167
	speed: 0.0404s/iter; left time: 722.3084s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0781671 Vali Loss: 0.0909578 Test Loss: 0.1033743
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0780121
	speed: 0.0742s/iter; left time: 1315.8856s
	iters: 200, epoch: 21 | loss: 0.0757186
	speed: 0.0411s/iter; left time: 725.0790s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.30s
Steps: 223 | Train Loss: 0.0778531 Vali Loss: 0.0906028 Test Loss: 0.1035582
Validation loss decreased (0.090797 --> 0.090603).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0755088
	speed: 0.0748s/iter; left time: 1310.5108s
	iters: 200, epoch: 22 | loss: 0.0724161
	speed: 0.0406s/iter; left time: 706.5124s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0779181 Vali Loss: 0.0907662 Test Loss: 0.1033700
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0793474
	speed: 0.0742s/iter; left time: 1283.5519s
	iters: 200, epoch: 23 | loss: 0.0752869
	speed: 0.0405s/iter; left time: 696.5507s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0778138 Vali Loss: 0.0906027 Test Loss: 0.1033847
Validation loss decreased (0.090603 --> 0.090603).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0718337
	speed: 0.0744s/iter; left time: 1270.7808s
	iters: 200, epoch: 24 | loss: 0.0822986
	speed: 0.0406s/iter; left time: 688.6936s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.26s
Steps: 223 | Train Loss: 0.0774387 Vali Loss: 0.0905964 Test Loss: 0.1033350
Validation loss decreased (0.090603 --> 0.090596).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0781854
	speed: 0.0745s/iter; left time: 1254.6554s
	iters: 200, epoch: 25 | loss: 0.0776588
	speed: 0.0405s/iter; left time: 678.5457s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0773905 Vali Loss: 0.0911812 Test Loss: 0.1039794
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0843180
	speed: 0.0743s/iter; left time: 1234.5543s
	iters: 200, epoch: 26 | loss: 0.0786229
	speed: 0.0405s/iter; left time: 669.0103s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0774403 Vali Loss: 0.0905203 Test Loss: 0.1033267
Validation loss decreased (0.090596 --> 0.090520).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0778569
	speed: 0.0743s/iter; left time: 1219.0835s
	iters: 200, epoch: 27 | loss: 0.0760914
	speed: 0.0404s/iter; left time: 659.4523s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0773498 Vali Loss: 0.0905446 Test Loss: 0.1034297
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0765770
	speed: 0.0744s/iter; left time: 1203.1410s
	iters: 200, epoch: 28 | loss: 0.0764705
	speed: 0.0406s/iter; left time: 652.0977s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0774625 Vali Loss: 0.0907428 Test Loss: 0.1031926
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0801089
	speed: 0.0742s/iter; left time: 1184.2724s
	iters: 200, epoch: 29 | loss: 0.0829091
	speed: 0.0405s/iter; left time: 641.6503s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0771658 Vali Loss: 0.0908485 Test Loss: 0.1035190
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0761231
	speed: 0.0744s/iter; left time: 1171.0462s
	iters: 200, epoch: 30 | loss: 0.0838616
	speed: 0.0405s/iter; left time: 632.4530s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.27s
Steps: 223 | Train Loss: 0.0771273 Vali Loss: 0.0904082 Test Loss: 0.1034668
Validation loss decreased (0.090520 --> 0.090408).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0791246
	speed: 0.0746s/iter; left time: 1156.6156s
	iters: 200, epoch: 31 | loss: 0.0760335
	speed: 0.0404s/iter; left time: 622.7406s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0771556 Vali Loss: 0.0904834 Test Loss: 0.1033723
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0727148
	speed: 0.0739s/iter; left time: 1129.9757s
	iters: 200, epoch: 32 | loss: 0.0771118
	speed: 0.0405s/iter; left time: 615.4426s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0770119 Vali Loss: 0.0905958 Test Loss: 0.1032845
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0780054
	speed: 0.0745s/iter; left time: 1122.0629s
	iters: 200, epoch: 33 | loss: 0.0763030
	speed: 0.0404s/iter; left time: 604.9782s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0770482 Vali Loss: 0.0905138 Test Loss: 0.1034147
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0723855
	speed: 0.0740s/iter; left time: 1098.3092s
	iters: 200, epoch: 34 | loss: 0.0809077
	speed: 0.0405s/iter; left time: 597.6511s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0769784 Vali Loss: 0.0901652 Test Loss: 0.1032317
Validation loss decreased (0.090408 --> 0.090165).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0753601
	speed: 0.0743s/iter; left time: 1085.6582s
	iters: 200, epoch: 35 | loss: 0.0833676
	speed: 0.0404s/iter; left time: 586.9795s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0770012 Vali Loss: 0.0904131 Test Loss: 0.1032534
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0741394
	speed: 0.0736s/iter; left time: 1059.4413s
	iters: 200, epoch: 36 | loss: 0.0772207
	speed: 0.0404s/iter; left time: 578.1975s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0768503 Vali Loss: 0.0902097 Test Loss: 0.1032458
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0748613
	speed: 0.0738s/iter; left time: 1045.4778s
	iters: 200, epoch: 37 | loss: 0.0764078
	speed: 0.0404s/iter; left time: 569.0177s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0768296 Vali Loss: 0.0906790 Test Loss: 0.1035006
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0836533
	speed: 0.0739s/iter; left time: 1030.3494s
	iters: 200, epoch: 38 | loss: 0.0738607
	speed: 0.0405s/iter; left time: 561.4411s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.24s
Steps: 223 | Train Loss: 0.0768080 Vali Loss: 0.0905389 Test Loss: 0.1032715
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0852324
	speed: 0.0734s/iter; left time: 1008.1749s
	iters: 200, epoch: 39 | loss: 0.0836052
	speed: 0.0404s/iter; left time: 551.1308s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0769123 Vali Loss: 0.0903165 Test Loss: 0.1031685
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0723093
	speed: 0.0737s/iter; left time: 995.6857s
	iters: 200, epoch: 40 | loss: 0.0770771
	speed: 0.0405s/iter; left time: 542.2184s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.21s
Steps: 223 | Train Loss: 0.0767563 Vali Loss: 0.0902461 Test Loss: 0.1032339
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0769785
	speed: 0.0738s/iter; left time: 979.6360s
	iters: 200, epoch: 41 | loss: 0.0785568
	speed: 0.0404s/iter; left time: 532.7537s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0768789 Vali Loss: 0.0903825 Test Loss: 0.1032286
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0765508
	speed: 0.0740s/iter; left time: 966.8555s
	iters: 200, epoch: 42 | loss: 0.0757153
	speed: 0.0407s/iter; left time: 526.8323s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.25s
Steps: 223 | Train Loss: 0.0767883 Vali Loss: 0.0905485 Test Loss: 0.1033848
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0777456
	speed: 0.0736s/iter; left time: 944.6847s
	iters: 200, epoch: 43 | loss: 0.0803093
	speed: 0.0404s/iter; left time: 514.8267s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.20s
Steps: 223 | Train Loss: 0.0768418 Vali Loss: 0.0903485 Test Loss: 0.1032215
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0777099
	speed: 0.0737s/iter; left time: 929.3859s
	iters: 200, epoch: 44 | loss: 0.0776393
	speed: 0.0404s/iter; left time: 505.7067s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.22s
Steps: 223 | Train Loss: 0.0767603 Vali Loss: 0.0905746 Test Loss: 0.1033903
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02546694502234459, rmse:0.1595836579799652, mae:0.10323171317577362, rse:0.5505183935165405
Intermediate time for GB and pred_len 24: 00h:17m:10.22s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2754908
	speed: 0.0654s/iter; left time: 1445.2351s
	iters: 200, epoch: 1 | loss: 0.2565268
	speed: 0.0408s/iter; left time: 896.8160s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.52s
Steps: 222 | Train Loss: 0.2785139 Vali Loss: 0.2301577 Test Loss: 0.2489777
Validation loss decreased (inf --> 0.230158).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1454410
	speed: 0.0743s/iter; left time: 1626.4319s
	iters: 200, epoch: 2 | loss: 0.1294792
	speed: 0.0408s/iter; left time: 889.1679s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1582182 Vali Loss: 0.1259280 Test Loss: 0.1505259
Validation loss decreased (0.230158 --> 0.125928).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1139631
	speed: 0.0758s/iter; left time: 1642.2493s
	iters: 200, epoch: 3 | loss: 0.1146949
	speed: 0.0407s/iter; left time: 876.7197s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1160379 Vali Loss: 0.1217796 Test Loss: 0.1469357
Validation loss decreased (0.125928 --> 0.121780).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1060906
	speed: 0.0755s/iter; left time: 1618.8844s
	iters: 200, epoch: 4 | loss: 0.1110405
	speed: 0.0407s/iter; left time: 869.0712s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1105263 Vali Loss: 0.1205399 Test Loss: 0.1479875
Validation loss decreased (0.121780 --> 0.120540).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1105473
	speed: 0.0755s/iter; left time: 1600.8842s
	iters: 200, epoch: 5 | loss: 0.1073875
	speed: 0.0408s/iter; left time: 860.5413s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1084831 Vali Loss: 0.1211721 Test Loss: 0.1462333
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1060356
	speed: 0.0748s/iter; left time: 1570.8243s
	iters: 200, epoch: 6 | loss: 0.1084735
	speed: 0.0409s/iter; left time: 855.4098s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1067980 Vali Loss: 0.1211017 Test Loss: 0.1448717
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1049255
	speed: 0.0742s/iter; left time: 1540.1646s
	iters: 200, epoch: 7 | loss: 0.1024340
	speed: 0.0408s/iter; left time: 843.8230s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1059185 Vali Loss: 0.1197927 Test Loss: 0.1431326
Validation loss decreased (0.120540 --> 0.119793).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1077000
	speed: 0.0756s/iter; left time: 1552.6685s
	iters: 200, epoch: 8 | loss: 0.1062740
	speed: 0.0408s/iter; left time: 833.5108s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.24s
Steps: 222 | Train Loss: 0.1051765 Vali Loss: 0.1208388 Test Loss: 0.1449344
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1044981
	speed: 0.0745s/iter; left time: 1514.6372s
	iters: 200, epoch: 9 | loss: 0.1011425
	speed: 0.0409s/iter; left time: 827.9057s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1047338 Vali Loss: 0.1204256 Test Loss: 0.1450119
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1024128
	speed: 0.0751s/iter; left time: 1509.6850s
	iters: 200, epoch: 10 | loss: 0.1052173
	speed: 0.0407s/iter; left time: 813.6001s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1041979 Vali Loss: 0.1203746 Test Loss: 0.1434776
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1026772
	speed: 0.0750s/iter; left time: 1491.2236s
	iters: 200, epoch: 11 | loss: 0.1031066
	speed: 0.0408s/iter; left time: 806.5353s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1035710 Vali Loss: 0.1205041 Test Loss: 0.1424923
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1012086
	speed: 0.0746s/iter; left time: 1466.9986s
	iters: 200, epoch: 12 | loss: 0.1012537
	speed: 0.0407s/iter; left time: 796.1226s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1031444 Vali Loss: 0.1206255 Test Loss: 0.1456862
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0988313
	speed: 0.0750s/iter; left time: 1458.6676s
	iters: 200, epoch: 13 | loss: 0.1054351
	speed: 0.0407s/iter; left time: 787.2148s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1028723 Vali Loss: 0.1207204 Test Loss: 0.1443202
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1001708
	speed: 0.0750s/iter; left time: 1440.9286s
	iters: 200, epoch: 14 | loss: 0.1036020
	speed: 0.0407s/iter; left time: 778.0399s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1025796 Vali Loss: 0.1213824 Test Loss: 0.1413605
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1079437
	speed: 0.0744s/iter; left time: 1412.1922s
	iters: 200, epoch: 15 | loss: 0.1065903
	speed: 0.0407s/iter; left time: 768.8275s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1024036 Vali Loss: 0.1207993 Test Loss: 0.1439709
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1031587
	speed: 0.0742s/iter; left time: 1393.1864s
	iters: 200, epoch: 16 | loss: 0.0969950
	speed: 0.0407s/iter; left time: 760.6339s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1019742 Vali Loss: 0.1192834 Test Loss: 0.1435636
Validation loss decreased (0.119793 --> 0.119283).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1015605
	speed: 0.0743s/iter; left time: 1377.5497s
	iters: 200, epoch: 17 | loss: 0.1000266
	speed: 0.0407s/iter; left time: 751.4653s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1017171 Vali Loss: 0.1209069 Test Loss: 0.1445591
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1034859
	speed: 0.0737s/iter; left time: 1349.9659s
	iters: 200, epoch: 18 | loss: 0.1006415
	speed: 0.0408s/iter; left time: 743.4568s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1016131 Vali Loss: 0.1202661 Test Loss: 0.1447202
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0975137
	speed: 0.0741s/iter; left time: 1341.5279s
	iters: 200, epoch: 19 | loss: 0.1048678
	speed: 0.0408s/iter; left time: 734.6294s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1013461 Vali Loss: 0.1196784 Test Loss: 0.1444775
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0967539
	speed: 0.0740s/iter; left time: 1323.4880s
	iters: 200, epoch: 20 | loss: 0.1014193
	speed: 0.0408s/iter; left time: 725.7344s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1012372 Vali Loss: 0.1201976 Test Loss: 0.1447031
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1000276
	speed: 0.0744s/iter; left time: 1314.8539s
	iters: 200, epoch: 21 | loss: 0.1064060
	speed: 0.0407s/iter; left time: 714.7966s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1009980 Vali Loss: 0.1195866 Test Loss: 0.1452566
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0979460
	speed: 0.0738s/iter; left time: 1286.8706s
	iters: 200, epoch: 22 | loss: 0.0992387
	speed: 0.0408s/iter; left time: 708.2139s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1010185 Vali Loss: 0.1197461 Test Loss: 0.1442865
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0942505
	speed: 0.0739s/iter; left time: 1271.8307s
	iters: 200, epoch: 23 | loss: 0.0990180
	speed: 0.0410s/iter; left time: 702.1462s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1007635 Vali Loss: 0.1201730 Test Loss: 0.1457032
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0997986
	speed: 0.0738s/iter; left time: 1254.8725s
	iters: 200, epoch: 24 | loss: 0.1051661
	speed: 0.0407s/iter; left time: 687.4366s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.23s
Steps: 222 | Train Loss: 0.1006523 Vali Loss: 0.1204499 Test Loss: 0.1449772
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0943325
	speed: 0.0744s/iter; left time: 1248.4015s
	iters: 200, epoch: 25 | loss: 0.1028278
	speed: 0.0408s/iter; left time: 679.7424s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1005114 Vali Loss: 0.1195987 Test Loss: 0.1457044
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0993995
	speed: 0.0738s/iter; left time: 1221.8400s
	iters: 200, epoch: 26 | loss: 0.1025434
	speed: 0.0407s/iter; left time: 669.7240s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1004969 Vali Loss: 0.1198426 Test Loss: 0.1459493
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04348594695329666, rmse:0.20853284001350403, mae:0.14356358349323273, rse:0.7211356163024902
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2774166
	speed: 0.0426s/iter; left time: 942.1830s
	iters: 200, epoch: 1 | loss: 0.2675685
	speed: 0.0408s/iter; left time: 898.5948s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.2809886 Vali Loss: 0.2336099 Test Loss: 0.2500508
Validation loss decreased (inf --> 0.233610).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1459654
	speed: 0.0762s/iter; left time: 1667.1326s
	iters: 200, epoch: 2 | loss: 0.1273764
	speed: 0.0411s/iter; left time: 896.1594s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1587790 Vali Loss: 0.1263587 Test Loss: 0.1510657
Validation loss decreased (0.233610 --> 0.126359).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1151451
	speed: 0.0761s/iter; left time: 1648.5984s
	iters: 200, epoch: 3 | loss: 0.1132580
	speed: 0.0407s/iter; left time: 876.9527s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1159257 Vali Loss: 0.1221918 Test Loss: 0.1485164
Validation loss decreased (0.126359 --> 0.122192).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1162400
	speed: 0.0761s/iter; left time: 1630.1607s
	iters: 200, epoch: 4 | loss: 0.1102432
	speed: 0.0408s/iter; left time: 870.0015s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.28s
Steps: 222 | Train Loss: 0.1102180 Vali Loss: 0.1223790 Test Loss: 0.1495408
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1053681
	speed: 0.0759s/iter; left time: 1610.8944s
	iters: 200, epoch: 5 | loss: 0.1080542
	speed: 0.0408s/iter; left time: 861.5252s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1080120 Vali Loss: 0.1205955 Test Loss: 0.1468638
Validation loss decreased (0.122192 --> 0.120595).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1048465
	speed: 0.0758s/iter; left time: 1592.0341s
	iters: 200, epoch: 6 | loss: 0.1037291
	speed: 0.0408s/iter; left time: 852.3388s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1066948 Vali Loss: 0.1201176 Test Loss: 0.1445497
Validation loss decreased (0.120595 --> 0.120118).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1026185
	speed: 0.0759s/iter; left time: 1577.0352s
	iters: 200, epoch: 7 | loss: 0.1106706
	speed: 0.0408s/iter; left time: 842.5379s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1056956 Vali Loss: 0.1220439 Test Loss: 0.1470570
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1022454
	speed: 0.0753s/iter; left time: 1546.2830s
	iters: 200, epoch: 8 | loss: 0.1057987
	speed: 0.0408s/iter; left time: 833.5066s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1047436 Vali Loss: 0.1197518 Test Loss: 0.1431227
Validation loss decreased (0.120118 --> 0.119752).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0995139
	speed: 0.0760s/iter; left time: 1543.9720s
	iters: 200, epoch: 9 | loss: 0.1068991
	speed: 0.0407s/iter; left time: 823.6297s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1040069 Vali Loss: 0.1207591 Test Loss: 0.1448716
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0977267
	speed: 0.0754s/iter; left time: 1515.2548s
	iters: 200, epoch: 10 | loss: 0.1050342
	speed: 0.0407s/iter; left time: 813.6096s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.25s
Steps: 222 | Train Loss: 0.1034888 Vali Loss: 0.1209808 Test Loss: 0.1457036
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1062801
	speed: 0.0751s/iter; left time: 1492.5965s
	iters: 200, epoch: 11 | loss: 0.1037657
	speed: 0.0408s/iter; left time: 806.7440s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1032361 Vali Loss: 0.1218010 Test Loss: 0.1467660
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1031072
	speed: 0.0764s/iter; left time: 1502.4624s
	iters: 200, epoch: 12 | loss: 0.1042846
	speed: 0.0408s/iter; left time: 797.4080s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1025889 Vali Loss: 0.1222248 Test Loss: 0.1471041
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1004958
	speed: 0.0760s/iter; left time: 1478.1091s
	iters: 200, epoch: 13 | loss: 0.1037003
	speed: 0.0407s/iter; left time: 787.8146s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1026253 Vali Loss: 0.1218507 Test Loss: 0.1469564
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0960027
	speed: 0.0748s/iter; left time: 1437.5752s
	iters: 200, epoch: 14 | loss: 0.1035357
	speed: 0.0407s/iter; left time: 778.1344s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.26s
Steps: 222 | Train Loss: 0.1021841 Vali Loss: 0.1208755 Test Loss: 0.1459521
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1015870
	speed: 0.0750s/iter; left time: 1424.3674s
	iters: 200, epoch: 15 | loss: 0.1023352
	speed: 0.0408s/iter; left time: 770.9132s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1016365 Vali Loss: 0.1208185 Test Loss: 0.1465824
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0990154
	speed: 0.0753s/iter; left time: 1414.3787s
	iters: 200, epoch: 16 | loss: 0.1074008
	speed: 0.0407s/iter; left time: 760.3590s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.27s
Steps: 222 | Train Loss: 0.1014939 Vali Loss: 0.1214339 Test Loss: 0.1468978
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1053690
	speed: 0.0750s/iter; left time: 1392.0747s
	iters: 200, epoch: 17 | loss: 0.1010550
	speed: 0.0408s/iter; left time: 752.5972s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1012388 Vali Loss: 0.1209148 Test Loss: 0.1468553
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0994772
	speed: 0.0755s/iter; left time: 1383.4358s
	iters: 200, epoch: 18 | loss: 0.0990921
	speed: 0.0407s/iter; left time: 742.2632s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.29s
Steps: 222 | Train Loss: 0.1008607 Vali Loss: 0.1210824 Test Loss: 0.1476732
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.042964570224285126, rmse:0.20727896690368652, mae:0.14312276244163513, rse:0.7167995572090149
Intermediate time for GB and pred_len 96: 00h:08m:42.42s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2716153
	speed: 0.0660s/iter; left time: 1459.4963s
	iters: 200, epoch: 1 | loss: 0.2638517
	speed: 0.0412s/iter; left time: 907.1952s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.65s
Steps: 222 | Train Loss: 0.2787672 Vali Loss: 0.2309910 Test Loss: 0.2493199
Validation loss decreased (inf --> 0.230991).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1443525
	speed: 0.0764s/iter; left time: 1672.1266s
	iters: 200, epoch: 2 | loss: 0.1273726
	speed: 0.0413s/iter; left time: 898.8461s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.41s
Steps: 222 | Train Loss: 0.1594456 Vali Loss: 0.1297770 Test Loss: 0.1556951
Validation loss decreased (0.230991 --> 0.129777).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1201734
	speed: 0.0771s/iter; left time: 1669.4693s
	iters: 200, epoch: 3 | loss: 0.1219832
	speed: 0.0413s/iter; left time: 890.7050s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1194605 Vali Loss: 0.1255238 Test Loss: 0.1545679
Validation loss decreased (0.129777 --> 0.125524).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1181283
	speed: 0.0761s/iter; left time: 1632.1475s
	iters: 200, epoch: 4 | loss: 0.1108795
	speed: 0.0413s/iter; left time: 881.0762s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1145101 Vali Loss: 0.1246590 Test Loss: 0.1540057
Validation loss decreased (0.125524 --> 0.124659).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1092665
	speed: 0.0760s/iter; left time: 1612.9568s
	iters: 200, epoch: 5 | loss: 0.1132531
	speed: 0.0412s/iter; left time: 870.4696s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1123378 Vali Loss: 0.1265095 Test Loss: 0.1549340
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1059428
	speed: 0.0755s/iter; left time: 1584.5224s
	iters: 200, epoch: 6 | loss: 0.1128200
	speed: 0.0412s/iter; left time: 859.8366s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1113528 Vali Loss: 0.1253730 Test Loss: 0.1533087
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1118887
	speed: 0.0756s/iter; left time: 1569.2793s
	iters: 200, epoch: 7 | loss: 0.1120432
	speed: 0.0412s/iter; left time: 852.2228s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1100923 Vali Loss: 0.1250416 Test Loss: 0.1485461
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1090592
	speed: 0.0747s/iter; left time: 1534.7930s
	iters: 200, epoch: 8 | loss: 0.1068995
	speed: 0.0414s/iter; left time: 847.4071s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1091959 Vali Loss: 0.1256379 Test Loss: 0.1487788
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1106925
	speed: 0.0754s/iter; left time: 1531.5013s
	iters: 200, epoch: 9 | loss: 0.1068321
	speed: 0.0414s/iter; left time: 836.8368s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1085150 Vali Loss: 0.1243162 Test Loss: 0.1471283
Validation loss decreased (0.124659 --> 0.124316).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1067732
	speed: 0.0772s/iter; left time: 1552.5604s
	iters: 200, epoch: 10 | loss: 0.1087037
	speed: 0.0412s/iter; left time: 824.1117s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1080044 Vali Loss: 0.1248898 Test Loss: 0.1474849
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1124478
	speed: 0.0755s/iter; left time: 1501.3308s
	iters: 200, epoch: 11 | loss: 0.1083871
	speed: 0.0413s/iter; left time: 816.0520s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1076199 Vali Loss: 0.1253187 Test Loss: 0.1480367
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1098340
	speed: 0.0750s/iter; left time: 1473.6767s
	iters: 200, epoch: 12 | loss: 0.1065531
	speed: 0.0413s/iter; left time: 807.0006s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1070364 Vali Loss: 0.1242883 Test Loss: 0.1481413
Validation loss decreased (0.124316 --> 0.124288).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1028681
	speed: 0.0763s/iter; left time: 1482.8800s
	iters: 200, epoch: 13 | loss: 0.1073965
	speed: 0.0413s/iter; left time: 798.2009s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.38s
Steps: 222 | Train Loss: 0.1067161 Vali Loss: 0.1250881 Test Loss: 0.1485085
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1018266
	speed: 0.0753s/iter; left time: 1447.5265s
	iters: 200, epoch: 14 | loss: 0.1055653
	speed: 0.0416s/iter; left time: 796.0262s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.39s
Steps: 222 | Train Loss: 0.1065856 Vali Loss: 0.1251107 Test Loss: 0.1492371
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1073245
	speed: 0.0753s/iter; left time: 1430.5092s
	iters: 200, epoch: 15 | loss: 0.1032797
	speed: 0.0413s/iter; left time: 780.7333s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1062499 Vali Loss: 0.1251109 Test Loss: 0.1481002
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1035097
	speed: 0.0758s/iter; left time: 1423.5704s
	iters: 200, epoch: 16 | loss: 0.1055012
	speed: 0.0413s/iter; left time: 771.4486s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1059731 Vali Loss: 0.1256487 Test Loss: 0.1495054
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1115270
	speed: 0.0757s/iter; left time: 1404.3685s
	iters: 200, epoch: 17 | loss: 0.1086517
	speed: 0.0413s/iter; left time: 761.1687s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1058377 Vali Loss: 0.1241639 Test Loss: 0.1486776
Validation loss decreased (0.124288 --> 0.124164).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1087099
	speed: 0.0764s/iter; left time: 1400.1928s
	iters: 200, epoch: 18 | loss: 0.1050047
	speed: 0.0412s/iter; left time: 751.5690s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1054555 Vali Loss: 0.1247823 Test Loss: 0.1497302
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1028927
	speed: 0.0755s/iter; left time: 1366.3546s
	iters: 200, epoch: 19 | loss: 0.1060708
	speed: 0.0414s/iter; left time: 745.0348s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.44s
Steps: 222 | Train Loss: 0.1052858 Vali Loss: 0.1249171 Test Loss: 0.1500403
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1049049
	speed: 0.0759s/iter; left time: 1358.1418s
	iters: 200, epoch: 20 | loss: 0.1012393
	speed: 0.0412s/iter; left time: 733.2661s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1053540 Vali Loss: 0.1261377 Test Loss: 0.1504158
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1063648
	speed: 0.0754s/iter; left time: 1331.4070s
	iters: 200, epoch: 21 | loss: 0.1047757
	speed: 0.0413s/iter; left time: 725.4736s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1052722 Vali Loss: 0.1249897 Test Loss: 0.1501012
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1041152
	speed: 0.0755s/iter; left time: 1315.8241s
	iters: 200, epoch: 22 | loss: 0.1084766
	speed: 0.0413s/iter; left time: 716.1872s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1049150 Vali Loss: 0.1259064 Test Loss: 0.1513341
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1038138
	speed: 0.0753s/iter; left time: 1295.6782s
	iters: 200, epoch: 23 | loss: 0.1041932
	speed: 0.0412s/iter; left time: 706.0158s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1048258 Vali Loss: 0.1255358 Test Loss: 0.1509897
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1022567
	speed: 0.0755s/iter; left time: 1282.2932s
	iters: 200, epoch: 24 | loss: 0.1052244
	speed: 0.0412s/iter; left time: 696.8547s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1046484 Vali Loss: 0.1249385 Test Loss: 0.1507090
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1076378
	speed: 0.0756s/iter; left time: 1267.7721s
	iters: 200, epoch: 25 | loss: 0.1043807
	speed: 0.0411s/iter; left time: 684.6567s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1046707 Vali Loss: 0.1248684 Test Loss: 0.1510690
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1014151
	speed: 0.0754s/iter; left time: 1248.1725s
	iters: 200, epoch: 26 | loss: 0.1049445
	speed: 0.0410s/iter; left time: 675.0621s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.30s
Steps: 222 | Train Loss: 0.1045685 Vali Loss: 0.1245818 Test Loss: 0.1509740
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1041414
	speed: 0.0753s/iter; left time: 1229.0372s
	iters: 200, epoch: 27 | loss: 0.1036496
	speed: 0.0412s/iter; left time: 668.2746s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1043760 Vali Loss: 0.1253036 Test Loss: 0.1515556
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04521861672401428, rmse:0.2126466929912567, mae:0.14867757260799408, rse:0.7372766137123108
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2812609
	speed: 0.0430s/iter; left time: 950.3421s
	iters: 200, epoch: 1 | loss: 0.2743198
	speed: 0.0411s/iter; left time: 903.9549s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.2822524 Vali Loss: 0.2363064 Test Loss: 0.2515047
Validation loss decreased (inf --> 0.236306).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1393131
	speed: 0.0779s/iter; left time: 1704.9258s
	iters: 200, epoch: 2 | loss: 0.1262606
	speed: 0.0410s/iter; left time: 893.8442s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1575504 Vali Loss: 0.1273091 Test Loss: 0.1528630
Validation loss decreased (0.236306 --> 0.127309).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1138505
	speed: 0.0777s/iter; left time: 1682.9884s
	iters: 200, epoch: 3 | loss: 0.1161965
	speed: 0.0412s/iter; left time: 887.5861s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1181751 Vali Loss: 0.1289422 Test Loss: 0.1709879
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1163539
	speed: 0.0759s/iter; left time: 1626.9556s
	iters: 200, epoch: 4 | loss: 0.1155107
	speed: 0.0410s/iter; left time: 874.7208s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1139019 Vali Loss: 0.1297381 Test Loss: 0.1703210
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1137907
	speed: 0.0755s/iter; left time: 1602.5071s
	iters: 200, epoch: 5 | loss: 0.1132444
	speed: 0.0412s/iter; left time: 868.9374s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1125670 Vali Loss: 0.1281471 Test Loss: 0.1688897
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1104800
	speed: 0.0765s/iter; left time: 1606.2500s
	iters: 200, epoch: 6 | loss: 0.1097190
	speed: 0.0410s/iter; left time: 857.2504s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1108655 Vali Loss: 0.1258683 Test Loss: 0.1585473
Validation loss decreased (0.127309 --> 0.125868).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1140727
	speed: 0.0764s/iter; left time: 1587.1705s
	iters: 200, epoch: 7 | loss: 0.1073268
	speed: 0.0410s/iter; left time: 847.6236s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.35s
Steps: 222 | Train Loss: 0.1100208 Vali Loss: 0.1245751 Test Loss: 0.1522525
Validation loss decreased (0.125868 --> 0.124575).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1089322
	speed: 0.0769s/iter; left time: 1579.9834s
	iters: 200, epoch: 8 | loss: 0.1053236
	speed: 0.0411s/iter; left time: 841.1997s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.37s
Steps: 222 | Train Loss: 0.1093476 Vali Loss: 0.1262100 Test Loss: 0.1514145
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1051588
	speed: 0.0755s/iter; left time: 1534.4033s
	iters: 200, epoch: 9 | loss: 0.1080333
	speed: 0.0410s/iter; left time: 828.7605s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.32s
Steps: 222 | Train Loss: 0.1085658 Vali Loss: 0.1274492 Test Loss: 0.1521188
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1053995
	speed: 0.0756s/iter; left time: 1519.5446s
	iters: 200, epoch: 10 | loss: 0.1076154
	speed: 0.0412s/iter; left time: 823.4252s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1079732 Vali Loss: 0.1264845 Test Loss: 0.1513946
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1071782
	speed: 0.0760s/iter; left time: 1510.1994s
	iters: 200, epoch: 11 | loss: 0.1097906
	speed: 0.0410s/iter; left time: 810.3533s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.34s
Steps: 222 | Train Loss: 0.1073974 Vali Loss: 0.1266323 Test Loss: 0.1527154
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1083495
	speed: 0.0760s/iter; left time: 1494.2791s
	iters: 200, epoch: 12 | loss: 0.1082444
	speed: 0.0410s/iter; left time: 802.4627s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1070229 Vali Loss: 0.1274204 Test Loss: 0.1519750
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1112958
	speed: 0.0756s/iter; left time: 1470.2463s
	iters: 200, epoch: 13 | loss: 0.1051681
	speed: 0.0411s/iter; left time: 794.1927s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.31s
Steps: 222 | Train Loss: 0.1067402 Vali Loss: 0.1246966 Test Loss: 0.1504878
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1047404
	speed: 0.0759s/iter; left time: 1458.2581s
	iters: 200, epoch: 14 | loss: 0.1110080
	speed: 0.0411s/iter; left time: 785.2555s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.36s
Steps: 222 | Train Loss: 0.1063147 Vali Loss: 0.1260417 Test Loss: 0.1516709
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1065945
	speed: 0.0759s/iter; left time: 1441.5429s
	iters: 200, epoch: 15 | loss: 0.1034605
	speed: 0.0410s/iter; left time: 775.0385s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1061472 Vali Loss: 0.1259253 Test Loss: 0.1521753
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1045114
	speed: 0.0758s/iter; left time: 1423.7237s
	iters: 200, epoch: 16 | loss: 0.1061935
	speed: 0.0410s/iter; left time: 766.4260s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1057498 Vali Loss: 0.1266438 Test Loss: 0.1531464
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1039447
	speed: 0.0756s/iter; left time: 1402.3167s
	iters: 200, epoch: 17 | loss: 0.1046212
	speed: 0.0410s/iter; left time: 756.7049s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.33s
Steps: 222 | Train Loss: 0.1054660 Vali Loss: 0.1257910 Test Loss: 0.1528551
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.05040593817830086, rmse:0.22451266646385193, mae:0.1522524505853653, rse:0.7784176468849182
Intermediate time for GB and pred_len 168: 00h:08m:49.69sIntermediate time for GB: 00h:34m:42.33s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2708257
	speed: 0.0412s/iter; left time: 919.6909s
	iters: 200, epoch: 1 | loss: 0.2622724
	speed: 0.0173s/iter; left time: 382.9868s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.2779982 Vali Loss: 0.2074505 Test Loss: 0.2332473
Validation loss decreased (inf --> 0.207451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1510847
	speed: 0.0382s/iter; left time: 843.2884s
	iters: 200, epoch: 2 | loss: 0.1117425
	speed: 0.0192s/iter; left time: 422.6661s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.1574519 Vali Loss: 0.0915035 Test Loss: 0.0991069
Validation loss decreased (0.207451 --> 0.091504).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1003834
	speed: 0.0364s/iter; left time: 794.6604s
	iters: 200, epoch: 3 | loss: 0.0931744
	speed: 0.0172s/iter; left time: 374.5618s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.1002942 Vali Loss: 0.0830410 Test Loss: 0.0912976
Validation loss decreased (0.091504 --> 0.083041).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0863603
	speed: 0.0357s/iter; left time: 771.4233s
	iters: 200, epoch: 4 | loss: 0.0836940
	speed: 0.0176s/iter; left time: 378.6460s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0864073 Vali Loss: 0.0718561 Test Loss: 0.0806061
Validation loss decreased (0.083041 --> 0.071856).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0736417
	speed: 0.0358s/iter; left time: 766.0545s
	iters: 200, epoch: 5 | loss: 0.0762774
	speed: 0.0175s/iter; left time: 372.8296s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0774616 Vali Loss: 0.0680598 Test Loss: 0.0780765
Validation loss decreased (0.071856 --> 0.068060).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0711824
	speed: 0.0359s/iter; left time: 761.4207s
	iters: 200, epoch: 6 | loss: 0.0742073
	speed: 0.0172s/iter; left time: 363.5269s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0727056 Vali Loss: 0.0657509 Test Loss: 0.0764956
Validation loss decreased (0.068060 --> 0.065751).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0758830
	speed: 0.0357s/iter; left time: 748.3752s
	iters: 200, epoch: 7 | loss: 0.0721870
	speed: 0.0172s/iter; left time: 358.2126s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0708751 Vali Loss: 0.0660416 Test Loss: 0.0778710
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0714698
	speed: 0.0356s/iter; left time: 737.0937s
	iters: 200, epoch: 8 | loss: 0.0658485
	speed: 0.0174s/iter; left time: 358.1808s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0689583 Vali Loss: 0.0642446 Test Loss: 0.0767666
Validation loss decreased (0.065751 --> 0.064245).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0694290
	speed: 0.0362s/iter; left time: 743.3197s
	iters: 200, epoch: 9 | loss: 0.0644000
	speed: 0.0175s/iter; left time: 356.2119s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0676455 Vali Loss: 0.0636601 Test Loss: 0.0770834
Validation loss decreased (0.064245 --> 0.063660).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0700247
	speed: 0.0376s/iter; left time: 761.9303s
	iters: 200, epoch: 10 | loss: 0.0655249
	speed: 0.0174s/iter; left time: 351.4206s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0667840 Vali Loss: 0.0626065 Test Loss: 0.0754004
Validation loss decreased (0.063660 --> 0.062607).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0672422
	speed: 0.0377s/iter; left time: 756.5545s
	iters: 200, epoch: 11 | loss: 0.0646161
	speed: 0.0173s/iter; left time: 345.6716s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0662278 Vali Loss: 0.0625945 Test Loss: 0.0761153
Validation loss decreased (0.062607 --> 0.062595).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0648139
	speed: 0.0356s/iter; left time: 707.1482s
	iters: 200, epoch: 12 | loss: 0.0664951
	speed: 0.0172s/iter; left time: 339.6006s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.04s
Steps: 224 | Train Loss: 0.0654111 Vali Loss: 0.0617924 Test Loss: 0.0757005
Validation loss decreased (0.062595 --> 0.061792).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0622444
	speed: 0.0356s/iter; left time: 698.7937s
	iters: 200, epoch: 13 | loss: 0.0599254
	speed: 0.0203s/iter; left time: 396.4701s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0647105 Vali Loss: 0.0609597 Test Loss: 0.0746203
Validation loss decreased (0.061792 --> 0.060960).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0647993
	speed: 0.0372s/iter; left time: 721.4152s
	iters: 200, epoch: 14 | loss: 0.0610652
	speed: 0.0174s/iter; left time: 336.5830s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0643186 Vali Loss: 0.0609952 Test Loss: 0.0744172
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0624425
	speed: 0.0353s/iter; left time: 676.6652s
	iters: 200, epoch: 15 | loss: 0.0644481
	speed: 0.0172s/iter; left time: 328.0971s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.04s
Steps: 224 | Train Loss: 0.0640143 Vali Loss: 0.0605438 Test Loss: 0.0741187
Validation loss decreased (0.060960 --> 0.060544).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0600056
	speed: 0.0354s/iter; left time: 670.0495s
	iters: 200, epoch: 16 | loss: 0.0635128
	speed: 0.0191s/iter; left time: 359.4531s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0634908 Vali Loss: 0.0608249 Test Loss: 0.0749933
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0606074
	speed: 0.0360s/iter; left time: 673.3462s
	iters: 200, epoch: 17 | loss: 0.0622914
	speed: 0.0176s/iter; left time: 327.2015s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0630818 Vali Loss: 0.0603432 Test Loss: 0.0748148
Validation loss decreased (0.060544 --> 0.060343).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0615552
	speed: 0.0364s/iter; left time: 673.3772s
	iters: 200, epoch: 18 | loss: 0.0634372
	speed: 0.0175s/iter; left time: 321.3329s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0628284 Vali Loss: 0.0602996 Test Loss: 0.0743554
Validation loss decreased (0.060343 --> 0.060300).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0640946
	speed: 0.0366s/iter; left time: 668.3454s
	iters: 200, epoch: 19 | loss: 0.0632057
	speed: 0.0173s/iter; left time: 314.2733s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0628115 Vali Loss: 0.0604891 Test Loss: 0.0746229
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0630374
	speed: 0.0354s/iter; left time: 639.4019s
	iters: 200, epoch: 20 | loss: 0.0633529
	speed: 0.0172s/iter; left time: 307.9695s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.04s
Steps: 224 | Train Loss: 0.0625326 Vali Loss: 0.0596575 Test Loss: 0.0737812
Validation loss decreased (0.060300 --> 0.059657).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0616223
	speed: 0.0395s/iter; left time: 703.1604s
	iters: 200, epoch: 21 | loss: 0.0649464
	speed: 0.0183s/iter; left time: 323.6225s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0621714 Vali Loss: 0.0597556 Test Loss: 0.0742557
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0627824
	speed: 0.0371s/iter; left time: 652.2355s
	iters: 200, epoch: 22 | loss: 0.0598262
	speed: 0.0174s/iter; left time: 303.8931s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0622700 Vali Loss: 0.0598124 Test Loss: 0.0740635
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0619051
	speed: 0.0357s/iter; left time: 620.7394s
	iters: 200, epoch: 23 | loss: 0.0605921
	speed: 0.0179s/iter; left time: 308.9577s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0617665 Vali Loss: 0.0594863 Test Loss: 0.0737347
Validation loss decreased (0.059657 --> 0.059486).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0607017
	speed: 0.0388s/iter; left time: 664.6397s
	iters: 200, epoch: 24 | loss: 0.0636367
	speed: 0.0174s/iter; left time: 297.2666s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0617854 Vali Loss: 0.0594426 Test Loss: 0.0740125
Validation loss decreased (0.059486 --> 0.059443).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0673195
	speed: 0.0362s/iter; left time: 612.4036s
	iters: 200, epoch: 25 | loss: 0.0601358
	speed: 0.0177s/iter; left time: 298.2107s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0616259 Vali Loss: 0.0594604 Test Loss: 0.0745333
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0618991
	speed: 0.0358s/iter; left time: 597.6044s
	iters: 200, epoch: 26 | loss: 0.0608135
	speed: 0.0174s/iter; left time: 289.5797s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0614542 Vali Loss: 0.0593405 Test Loss: 0.0739550
Validation loss decreased (0.059443 --> 0.059341).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0631193
	speed: 0.0369s/iter; left time: 607.5670s
	iters: 200, epoch: 27 | loss: 0.0657145
	speed: 0.0176s/iter; left time: 287.8296s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0616794 Vali Loss: 0.0594699 Test Loss: 0.0737223
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0565359
	speed: 0.0397s/iter; left time: 645.6885s
	iters: 200, epoch: 28 | loss: 0.0595181
	speed: 0.0173s/iter; left time: 279.4830s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0612757 Vali Loss: 0.0591323 Test Loss: 0.0734891
Validation loss decreased (0.059341 --> 0.059132).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0586638
	speed: 0.0367s/iter; left time: 587.9162s
	iters: 200, epoch: 29 | loss: 0.0608017
	speed: 0.0192s/iter; left time: 306.2643s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0612530 Vali Loss: 0.0590975 Test Loss: 0.0735919
Validation loss decreased (0.059132 --> 0.059097).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0592039
	speed: 0.0412s/iter; left time: 650.7961s
	iters: 200, epoch: 30 | loss: 0.0614624
	speed: 0.0184s/iter; left time: 288.4390s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0612326 Vali Loss: 0.0595413 Test Loss: 0.0739768
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0617800
	speed: 0.0358s/iter; left time: 557.7919s
	iters: 200, epoch: 31 | loss: 0.0633619
	speed: 0.0172s/iter; left time: 266.4169s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0611033 Vali Loss: 0.0588847 Test Loss: 0.0730694
Validation loss decreased (0.059097 --> 0.058885).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0632723
	speed: 0.0374s/iter; left time: 574.4131s
	iters: 200, epoch: 32 | loss: 0.0576704
	speed: 0.0175s/iter; left time: 266.7068s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0609722 Vali Loss: 0.0589661 Test Loss: 0.0733982
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0627338
	speed: 0.0354s/iter; left time: 535.9954s
	iters: 200, epoch: 33 | loss: 0.0608308
	speed: 0.0172s/iter; left time: 258.0349s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0609542 Vali Loss: 0.0587706 Test Loss: 0.0731882
Validation loss decreased (0.058885 --> 0.058771).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0627589
	speed: 0.0394s/iter; left time: 587.7688s
	iters: 200, epoch: 34 | loss: 0.0576832
	speed: 0.0176s/iter; left time: 260.0591s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.41s
Steps: 224 | Train Loss: 0.0610260 Vali Loss: 0.0588217 Test Loss: 0.0729814
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0592602
	speed: 0.0362s/iter; left time: 531.4638s
	iters: 200, epoch: 35 | loss: 0.0609397
	speed: 0.0172s/iter; left time: 250.3590s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0608695 Vali Loss: 0.0589980 Test Loss: 0.0734148
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0628913
	speed: 0.0357s/iter; left time: 516.5297s
	iters: 200, epoch: 36 | loss: 0.0595104
	speed: 0.0178s/iter; left time: 255.5919s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0607886 Vali Loss: 0.0588238 Test Loss: 0.0731824
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0592520
	speed: 0.0359s/iter; left time: 510.4757s
	iters: 200, epoch: 37 | loss: 0.0619801
	speed: 0.0173s/iter; left time: 243.9009s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0608522 Vali Loss: 0.0588781 Test Loss: 0.0733389
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0571876
	speed: 0.0355s/iter; left time: 496.8229s
	iters: 200, epoch: 38 | loss: 0.0626874
	speed: 0.0172s/iter; left time: 238.9903s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0609661 Vali Loss: 0.0588733 Test Loss: 0.0733372
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0603451
	speed: 0.0355s/iter; left time: 489.3631s
	iters: 200, epoch: 39 | loss: 0.0607890
	speed: 0.0173s/iter; left time: 236.7298s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0607698 Vali Loss: 0.0588193 Test Loss: 0.0732570
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0569031
	speed: 0.0356s/iter; left time: 482.7168s
	iters: 200, epoch: 40 | loss: 0.0604230
	speed: 0.0172s/iter; left time: 231.7892s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0607826 Vali Loss: 0.0588016 Test Loss: 0.0730469
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0587654
	speed: 0.0367s/iter; left time: 490.2749s
	iters: 200, epoch: 41 | loss: 0.0610591
	speed: 0.0172s/iter; left time: 228.1223s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0606978 Vali Loss: 0.0587396 Test Loss: 0.0732739
Validation loss decreased (0.058771 --> 0.058740).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0635448
	speed: 0.0367s/iter; left time: 481.0085s
	iters: 200, epoch: 42 | loss: 0.0613662
	speed: 0.0184s/iter; left time: 239.3394s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0607116 Vali Loss: 0.0586978 Test Loss: 0.0730936
Validation loss decreased (0.058740 --> 0.058698).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0577063
	speed: 0.0380s/iter; left time: 490.5650s
	iters: 200, epoch: 43 | loss: 0.0591121
	speed: 0.0179s/iter; left time: 228.5114s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0606261 Vali Loss: 0.0589224 Test Loss: 0.0736936
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0624545
	speed: 0.0374s/iter; left time: 473.3641s
	iters: 200, epoch: 44 | loss: 0.0616844
	speed: 0.0187s/iter; left time: 235.4084s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0611692 Vali Loss: 0.0586782 Test Loss: 0.0729012
Validation loss decreased (0.058698 --> 0.058678).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0593653
	speed: 0.0372s/iter; left time: 463.2030s
	iters: 200, epoch: 45 | loss: 0.0636859
	speed: 0.0177s/iter; left time: 218.9950s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0605644 Vali Loss: 0.0586519 Test Loss: 0.0729312
Validation loss decreased (0.058678 --> 0.058652).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0588403
	speed: 0.0369s/iter; left time: 450.9684s
	iters: 200, epoch: 46 | loss: 0.0612193
	speed: 0.0174s/iter; left time: 210.6585s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0606294 Vali Loss: 0.0587211 Test Loss: 0.0729838
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0612823
	speed: 0.0361s/iter; left time: 433.0083s
	iters: 200, epoch: 47 | loss: 0.0574999
	speed: 0.0180s/iter; left time: 213.6851s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0608826 Vali Loss: 0.0586566 Test Loss: 0.0730382
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0617604
	speed: 0.0386s/iter; left time: 454.8398s
	iters: 200, epoch: 48 | loss: 0.0574106
	speed: 0.0190s/iter; left time: 221.8804s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0606421 Vali Loss: 0.0585935 Test Loss: 0.0729641
Validation loss decreased (0.058652 --> 0.058594).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0595661
	speed: 0.0365s/iter; left time: 421.1314s
	iters: 200, epoch: 49 | loss: 0.0651810
	speed: 0.0174s/iter; left time: 198.8778s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0605826 Vali Loss: 0.0586438 Test Loss: 0.0729285
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0635316
	speed: 0.0359s/iter; left time: 406.5635s
	iters: 200, epoch: 50 | loss: 0.0610907
	speed: 0.0171s/iter; left time: 192.0331s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0609660 Vali Loss: 0.0588212 Test Loss: 0.0732808
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0592435
	speed: 0.0365s/iter; left time: 404.7395s
	iters: 200, epoch: 51 | loss: 0.0632765
	speed: 0.0175s/iter; left time: 192.2120s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0606898 Vali Loss: 0.0586598 Test Loss: 0.0730526
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0635184
	speed: 0.0361s/iter; left time: 392.6319s
	iters: 200, epoch: 52 | loss: 0.0610863
	speed: 0.0218s/iter; left time: 234.8409s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0605371 Vali Loss: 0.0588704 Test Loss: 0.0736128
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0603129
	speed: 0.0369s/iter; left time: 392.8355s
	iters: 200, epoch: 53 | loss: 0.0641348
	speed: 0.0172s/iter; left time: 181.4711s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.04s
Steps: 224 | Train Loss: 0.0606629 Vali Loss: 0.0587345 Test Loss: 0.0732306
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0610451
	speed: 0.0368s/iter; left time: 384.1182s
	iters: 200, epoch: 54 | loss: 0.0583071
	speed: 0.0192s/iter; left time: 197.9427s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0608471 Vali Loss: 0.0588552 Test Loss: 0.0735912
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0600205
	speed: 0.0374s/iter; left time: 381.5183s
	iters: 200, epoch: 55 | loss: 0.0605740
	speed: 0.0173s/iter; left time: 174.9431s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0605078 Vali Loss: 0.0587326 Test Loss: 0.0732537
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0583362
	speed: 0.0361s/iter; left time: 360.7633s
	iters: 200, epoch: 56 | loss: 0.0632899
	speed: 0.0174s/iter; left time: 171.6435s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0607032 Vali Loss: 0.0586046 Test Loss: 0.0729888
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0592648
	speed: 0.0367s/iter; left time: 357.6104s
	iters: 200, epoch: 57 | loss: 0.0603010
	speed: 0.0174s/iter; left time: 168.2237s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0605897 Vali Loss: 0.0587299 Test Loss: 0.0734092
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0576204
	speed: 0.0360s/iter; left time: 342.8372s
	iters: 200, epoch: 58 | loss: 0.0604421
	speed: 0.0174s/iter; left time: 164.2530s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0606295 Vali Loss: 0.0587746 Test Loss: 0.0731275
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.012697300873696804, rmse:0.1126822978258133, mae:0.07296409457921982, rse:0.33161038160324097
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2723186
	speed: 0.0221s/iter; left time: 492.7511s
	iters: 200, epoch: 1 | loss: 0.2594370
	speed: 0.0174s/iter; left time: 387.3062s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.41s
Steps: 224 | Train Loss: 0.2804108 Vali Loss: 0.2111473 Test Loss: 0.2331517
Validation loss decreased (inf --> 0.211147).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1487849
	speed: 0.0372s/iter; left time: 821.7814s
	iters: 200, epoch: 2 | loss: 0.1122121
	speed: 0.0175s/iter; left time: 385.5053s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.1569681 Vali Loss: 0.0871886 Test Loss: 0.0957581
Validation loss decreased (0.211147 --> 0.087189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0998303
	speed: 0.0360s/iter; left time: 787.4339s
	iters: 200, epoch: 3 | loss: 0.0900539
	speed: 0.0172s/iter; left time: 375.0520s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0995899 Vali Loss: 0.0780850 Test Loss: 0.0863740
Validation loss decreased (0.087189 --> 0.078085).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0908242
	speed: 0.0364s/iter; left time: 787.0179s
	iters: 200, epoch: 4 | loss: 0.0860295
	speed: 0.0176s/iter; left time: 379.2616s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0868707 Vali Loss: 0.0739030 Test Loss: 0.0811787
Validation loss decreased (0.078085 --> 0.073903).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0818111
	speed: 0.0375s/iter; left time: 802.0927s
	iters: 200, epoch: 5 | loss: 0.0754183
	speed: 0.0181s/iter; left time: 385.9164s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0790223 Vali Loss: 0.0694488 Test Loss: 0.0807753
Validation loss decreased (0.073903 --> 0.069449).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0741047
	speed: 0.0391s/iter; left time: 828.0456s
	iters: 200, epoch: 6 | loss: 0.0749590
	speed: 0.0216s/iter; left time: 454.3014s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0735093 Vali Loss: 0.0666800 Test Loss: 0.0808575
Validation loss decreased (0.069449 --> 0.066680).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0736243
	speed: 0.0380s/iter; left time: 795.4230s
	iters: 200, epoch: 7 | loss: 0.0661629
	speed: 0.0177s/iter; left time: 368.3417s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0714205 Vali Loss: 0.0655510 Test Loss: 0.0802032
Validation loss decreased (0.066680 --> 0.065551).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0729664
	speed: 0.0407s/iter; left time: 843.2198s
	iters: 200, epoch: 8 | loss: 0.0714460
	speed: 0.0209s/iter; left time: 431.1113s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0694222 Vali Loss: 0.0644655 Test Loss: 0.0811112
Validation loss decreased (0.065551 --> 0.064465).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0659208
	speed: 0.0369s/iter; left time: 756.4808s
	iters: 200, epoch: 9 | loss: 0.0711732
	speed: 0.0173s/iter; left time: 352.3263s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0683030 Vali Loss: 0.0633331 Test Loss: 0.0808911
Validation loss decreased (0.064465 --> 0.063333).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0658178
	speed: 0.0385s/iter; left time: 780.8806s
	iters: 200, epoch: 10 | loss: 0.0632657
	speed: 0.0206s/iter; left time: 416.7494s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0671876 Vali Loss: 0.0626942 Test Loss: 0.0810161
Validation loss decreased (0.063333 --> 0.062694).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0675375
	speed: 0.0420s/iter; left time: 842.6574s
	iters: 200, epoch: 11 | loss: 0.0656089
	speed: 0.0178s/iter; left time: 356.1314s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.69s
Steps: 224 | Train Loss: 0.0663821 Vali Loss: 0.0650089 Test Loss: 0.0835631
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0698378
	speed: 0.0374s/iter; left time: 742.3642s
	iters: 200, epoch: 12 | loss: 0.0709315
	speed: 0.0182s/iter; left time: 360.0192s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0658216 Vali Loss: 0.0622524 Test Loss: 0.0804868
Validation loss decreased (0.062694 --> 0.062252).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0702056
	speed: 0.0372s/iter; left time: 730.0678s
	iters: 200, epoch: 13 | loss: 0.0646744
	speed: 0.0179s/iter; left time: 348.8250s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0651245 Vali Loss: 0.0614892 Test Loss: 0.0798468
Validation loss decreased (0.062252 --> 0.061489).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0666263
	speed: 0.0383s/iter; left time: 742.3045s
	iters: 200, epoch: 14 | loss: 0.0637792
	speed: 0.0176s/iter; left time: 339.3310s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0645446 Vali Loss: 0.0609676 Test Loss: 0.0781604
Validation loss decreased (0.061489 --> 0.060968).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0713808
	speed: 0.0385s/iter; left time: 738.1148s
	iters: 200, epoch: 15 | loss: 0.0672789
	speed: 0.0220s/iter; left time: 420.2792s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0644304 Vali Loss: 0.0603074 Test Loss: 0.0764001
Validation loss decreased (0.060968 --> 0.060307).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0611395
	speed: 0.0366s/iter; left time: 693.5715s
	iters: 200, epoch: 16 | loss: 0.0639924
	speed: 0.0171s/iter; left time: 323.1050s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.03s
Steps: 224 | Train Loss: 0.0638584 Vali Loss: 0.0604877 Test Loss: 0.0751136
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0645290
	speed: 0.0381s/iter; left time: 713.7701s
	iters: 200, epoch: 17 | loss: 0.0622595
	speed: 0.0171s/iter; left time: 319.0665s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0634671 Vali Loss: 0.0599232 Test Loss: 0.0762809
Validation loss decreased (0.060307 --> 0.059923).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0624876
	speed: 0.0366s/iter; left time: 676.2772s
	iters: 200, epoch: 18 | loss: 0.0637171
	speed: 0.0175s/iter; left time: 321.1478s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0630357 Vali Loss: 0.0595618 Test Loss: 0.0750244
Validation loss decreased (0.059923 --> 0.059562).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0617419
	speed: 0.0385s/iter; left time: 704.1668s
	iters: 200, epoch: 19 | loss: 0.0608804
	speed: 0.0172s/iter; left time: 311.8009s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0629090 Vali Loss: 0.0596770 Test Loss: 0.0742886
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0633113
	speed: 0.0363s/iter; left time: 654.8177s
	iters: 200, epoch: 20 | loss: 0.0655701
	speed: 0.0173s/iter; left time: 310.7320s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0625126 Vali Loss: 0.0595197 Test Loss: 0.0756664
Validation loss decreased (0.059562 --> 0.059520).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0628558
	speed: 0.0366s/iter; left time: 653.0582s
	iters: 200, epoch: 21 | loss: 0.0602739
	speed: 0.0173s/iter; left time: 306.5217s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0623610 Vali Loss: 0.0591243 Test Loss: 0.0753350
Validation loss decreased (0.059520 --> 0.059124).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0651103
	speed: 0.0364s/iter; left time: 640.0614s
	iters: 200, epoch: 22 | loss: 0.0575442
	speed: 0.0174s/iter; left time: 304.0223s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0621670 Vali Loss: 0.0592054 Test Loss: 0.0741855
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0664264
	speed: 0.0367s/iter; left time: 638.1007s
	iters: 200, epoch: 23 | loss: 0.0587535
	speed: 0.0172s/iter; left time: 297.1399s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0620225 Vali Loss: 0.0589292 Test Loss: 0.0742925
Validation loss decreased (0.059124 --> 0.058929).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0641541
	speed: 0.0368s/iter; left time: 630.3895s
	iters: 200, epoch: 24 | loss: 0.0634813
	speed: 0.0174s/iter; left time: 297.2667s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0621247 Vali Loss: 0.0589253 Test Loss: 0.0734498
Validation loss decreased (0.058929 --> 0.058925).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0564462
	speed: 0.0369s/iter; left time: 624.3433s
	iters: 200, epoch: 25 | loss: 0.0637565
	speed: 0.0174s/iter; left time: 291.9264s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0617372 Vali Loss: 0.0589466 Test Loss: 0.0749519
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0636609
	speed: 0.0359s/iter; left time: 600.0659s
	iters: 200, epoch: 26 | loss: 0.0584842
	speed: 0.0172s/iter; left time: 285.1086s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0616560 Vali Loss: 0.0590757 Test Loss: 0.0742946
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0581466
	speed: 0.0357s/iter; left time: 588.6790s
	iters: 200, epoch: 27 | loss: 0.0603953
	speed: 0.0173s/iter; left time: 283.3239s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0616052 Vali Loss: 0.0585262 Test Loss: 0.0741448
Validation loss decreased (0.058925 --> 0.058526).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0577278
	speed: 0.0392s/iter; left time: 637.3915s
	iters: 200, epoch: 28 | loss: 0.0644682
	speed: 0.0181s/iter; left time: 291.6471s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0618389 Vali Loss: 0.0587341 Test Loss: 0.0739767
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0625474
	speed: 0.0360s/iter; left time: 576.4015s
	iters: 200, epoch: 29 | loss: 0.0580867
	speed: 0.0171s/iter; left time: 272.9740s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0613939 Vali Loss: 0.0586087 Test Loss: 0.0742347
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0590229
	speed: 0.0355s/iter; left time: 561.1628s
	iters: 200, epoch: 30 | loss: 0.0606227
	speed: 0.0173s/iter; left time: 272.2874s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0611694 Vali Loss: 0.0584188 Test Loss: 0.0739610
Validation loss decreased (0.058526 --> 0.058419).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0643775
	speed: 0.0367s/iter; left time: 571.0828s
	iters: 200, epoch: 31 | loss: 0.0578023
	speed: 0.0173s/iter; left time: 268.0644s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0611918 Vali Loss: 0.0583375 Test Loss: 0.0744160
Validation loss decreased (0.058419 --> 0.058337).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0579711
	speed: 0.0377s/iter; left time: 579.2495s
	iters: 200, epoch: 32 | loss: 0.0620027
	speed: 0.0179s/iter; left time: 273.6753s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0612068 Vali Loss: 0.0583986 Test Loss: 0.0742417
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0653523
	speed: 0.0403s/iter; left time: 609.4985s
	iters: 200, epoch: 33 | loss: 0.0614485
	speed: 0.0206s/iter; left time: 309.8559s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0611182 Vali Loss: 0.0582882 Test Loss: 0.0733675
Validation loss decreased (0.058337 --> 0.058288).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0647610
	speed: 0.0366s/iter; left time: 545.1474s
	iters: 200, epoch: 34 | loss: 0.0633823
	speed: 0.0175s/iter; left time: 259.5481s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0610971 Vali Loss: 0.0584576 Test Loss: 0.0729061
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0626284
	speed: 0.0390s/iter; left time: 573.3413s
	iters: 200, epoch: 35 | loss: 0.0601387
	speed: 0.0173s/iter; left time: 251.8198s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0610140 Vali Loss: 0.0582965 Test Loss: 0.0737146
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0639531
	speed: 0.0359s/iter; left time: 518.8844s
	iters: 200, epoch: 36 | loss: 0.0608174
	speed: 0.0178s/iter; left time: 256.3027s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0611647 Vali Loss: 0.0582508 Test Loss: 0.0736249
Validation loss decreased (0.058288 --> 0.058251).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0602419
	speed: 0.0366s/iter; left time: 521.4744s
	iters: 200, epoch: 37 | loss: 0.0581153
	speed: 0.0173s/iter; left time: 245.2309s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0610484 Vali Loss: 0.0583448 Test Loss: 0.0732000
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0600050
	speed: 0.0365s/iter; left time: 510.8782s
	iters: 200, epoch: 38 | loss: 0.0618239
	speed: 0.0172s/iter; left time: 239.4968s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0609829 Vali Loss: 0.0584209 Test Loss: 0.0728817
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0601002
	speed: 0.0355s/iter; left time: 488.8881s
	iters: 200, epoch: 39 | loss: 0.0637596
	speed: 0.0171s/iter; left time: 234.4297s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0608545 Vali Loss: 0.0582400 Test Loss: 0.0727859
Validation loss decreased (0.058251 --> 0.058240).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0579164
	speed: 0.0380s/iter; left time: 515.7594s
	iters: 200, epoch: 40 | loss: 0.0646479
	speed: 0.0177s/iter; left time: 238.6550s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0608278 Vali Loss: 0.0582177 Test Loss: 0.0733635
Validation loss decreased (0.058240 --> 0.058218).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0616952
	speed: 0.0405s/iter; left time: 540.6834s
	iters: 200, epoch: 41 | loss: 0.0571715
	speed: 0.0204s/iter; left time: 270.5375s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.89s
Steps: 224 | Train Loss: 0.0608960 Vali Loss: 0.0581996 Test Loss: 0.0732759
Validation loss decreased (0.058218 --> 0.058200).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0631871
	speed: 0.0375s/iter; left time: 491.4789s
	iters: 200, epoch: 42 | loss: 0.0568571
	speed: 0.0171s/iter; left time: 222.4476s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0608211 Vali Loss: 0.0580944 Test Loss: 0.0728690
Validation loss decreased (0.058200 --> 0.058094).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0618066
	speed: 0.0370s/iter; left time: 476.8264s
	iters: 200, epoch: 43 | loss: 0.0615122
	speed: 0.0174s/iter; left time: 222.1832s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0611374 Vali Loss: 0.0583234 Test Loss: 0.0724586
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0589104
	speed: 0.0392s/iter; left time: 497.1608s
	iters: 200, epoch: 44 | loss: 0.0627911
	speed: 0.0202s/iter; left time: 254.1602s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0609306 Vali Loss: 0.0582577 Test Loss: 0.0726218
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0628825
	speed: 0.0368s/iter; left time: 458.3033s
	iters: 200, epoch: 45 | loss: 0.0587390
	speed: 0.0174s/iter; left time: 214.2312s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0613185 Vali Loss: 0.0582871 Test Loss: 0.0725785
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0598876
	speed: 0.0410s/iter; left time: 500.8020s
	iters: 200, epoch: 46 | loss: 0.0615125
	speed: 0.0216s/iter; left time: 261.4763s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0608629 Vali Loss: 0.0581948 Test Loss: 0.0726809
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0631883
	speed: 0.0369s/iter; left time: 442.5629s
	iters: 200, epoch: 47 | loss: 0.0606678
	speed: 0.0181s/iter; left time: 214.8732s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0607024 Vali Loss: 0.0582297 Test Loss: 0.0723210
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0599459
	speed: 0.0377s/iter; left time: 443.6570s
	iters: 200, epoch: 48 | loss: 0.0553894
	speed: 0.0172s/iter; left time: 201.3162s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0608386 Vali Loss: 0.0579962 Test Loss: 0.0727201
Validation loss decreased (0.058094 --> 0.057996).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0578657
	speed: 0.0380s/iter; left time: 439.3892s
	iters: 200, epoch: 49 | loss: 0.0608033
	speed: 0.0180s/iter; left time: 206.3923s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0609807 Vali Loss: 0.0581391 Test Loss: 0.0725509
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0621150
	speed: 0.0358s/iter; left time: 405.6554s
	iters: 200, epoch: 50 | loss: 0.0631911
	speed: 0.0177s/iter; left time: 198.4797s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0607364 Vali Loss: 0.0581990 Test Loss: 0.0728008
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0609419
	speed: 0.0358s/iter; left time: 397.3895s
	iters: 200, epoch: 51 | loss: 0.0609045
	speed: 0.0175s/iter; left time: 192.8414s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0605976 Vali Loss: 0.0580235 Test Loss: 0.0729227
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0613372
	speed: 0.0376s/iter; left time: 409.0928s
	iters: 200, epoch: 52 | loss: 0.0578110
	speed: 0.0173s/iter; left time: 186.7250s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0606016 Vali Loss: 0.0580805 Test Loss: 0.0728458
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0597081
	speed: 0.0362s/iter; left time: 385.8459s
	iters: 200, epoch: 53 | loss: 0.0599167
	speed: 0.0173s/iter; left time: 182.7097s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0606716 Vali Loss: 0.0581069 Test Loss: 0.0723052
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0602916
	speed: 0.0362s/iter; left time: 377.1772s
	iters: 200, epoch: 54 | loss: 0.0620375
	speed: 0.0173s/iter; left time: 178.2611s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0607120 Vali Loss: 0.0583016 Test Loss: 0.0727637
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0623368
	speed: 0.0360s/iter; left time: 367.1473s
	iters: 200, epoch: 55 | loss: 0.0654304
	speed: 0.0178s/iter; left time: 180.3104s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0606441 Vali Loss: 0.0581952 Test Loss: 0.0731348
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0625696
	speed: 0.0356s/iter; left time: 355.0182s
	iters: 200, epoch: 56 | loss: 0.0563569
	speed: 0.0172s/iter; left time: 169.6229s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0607840 Vali Loss: 0.0580681 Test Loss: 0.0729142
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0616411
	speed: 0.0359s/iter; left time: 349.8216s
	iters: 200, epoch: 57 | loss: 0.0601746
	speed: 0.0174s/iter; left time: 167.9794s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0605397 Vali Loss: 0.0581108 Test Loss: 0.0730427
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0618836
	speed: 0.0369s/iter; left time: 351.6512s
	iters: 200, epoch: 58 | loss: 0.0594452
	speed: 0.0171s/iter; left time: 161.2825s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0606900 Vali Loss: 0.0581163 Test Loss: 0.0726102
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01282523199915886, rmse:0.1132485419511795, mae:0.07272014766931534, rse:0.33327677845954895
Intermediate time for ES and pred_len 24: 00h:10m:47.64s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2699923
	speed: 0.0421s/iter; left time: 937.9746s
	iters: 200, epoch: 1 | loss: 0.2550710
	speed: 0.0180s/iter; left time: 398.6121s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.2779176 Vali Loss: 0.2090562 Test Loss: 0.2344670
Validation loss decreased (inf --> 0.209056).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1451056
	speed: 0.0375s/iter; left time: 827.5422s
	iters: 200, epoch: 2 | loss: 0.1162974
	speed: 0.0176s/iter; left time: 387.2759s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.1551280 Vali Loss: 0.1042353 Test Loss: 0.1172750
Validation loss decreased (0.209056 --> 0.104235).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1089795
	speed: 0.0373s/iter; left time: 815.6770s
	iters: 200, epoch: 3 | loss: 0.1037570
	speed: 0.0174s/iter; left time: 378.3567s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.1090032 Vali Loss: 0.0926297 Test Loss: 0.1092328
Validation loss decreased (0.104235 --> 0.092630).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0931839
	speed: 0.0362s/iter; left time: 783.5263s
	iters: 200, epoch: 4 | loss: 0.0921412
	speed: 0.0174s/iter; left time: 374.9304s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0958092 Vali Loss: 0.0869654 Test Loss: 0.1052669
Validation loss decreased (0.092630 --> 0.086965).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0885624
	speed: 0.0370s/iter; left time: 792.7775s
	iters: 200, epoch: 5 | loss: 0.0861385
	speed: 0.0174s/iter; left time: 370.4124s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0911318 Vali Loss: 0.0844819 Test Loss: 0.1059624
Validation loss decreased (0.086965 --> 0.084482).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0869646
	speed: 0.0375s/iter; left time: 793.3715s
	iters: 200, epoch: 6 | loss: 0.0883404
	speed: 0.0177s/iter; left time: 372.3880s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0878641 Vali Loss: 0.0837793 Test Loss: 0.1088766
Validation loss decreased (0.084482 --> 0.083779).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0886907
	speed: 0.0388s/iter; left time: 813.2618s
	iters: 200, epoch: 7 | loss: 0.0817665
	speed: 0.0182s/iter; left time: 380.4135s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0862188 Vali Loss: 0.0827717 Test Loss: 0.1055454
Validation loss decreased (0.083779 --> 0.082772).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0847801
	speed: 0.0373s/iter; left time: 773.0924s
	iters: 200, epoch: 8 | loss: 0.0820215
	speed: 0.0175s/iter; left time: 361.3767s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0846143 Vali Loss: 0.0810567 Test Loss: 0.1060755
Validation loss decreased (0.082772 --> 0.081057).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0844776
	speed: 0.0386s/iter; left time: 792.4186s
	iters: 200, epoch: 9 | loss: 0.0794606
	speed: 0.0195s/iter; left time: 397.7606s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0838625 Vali Loss: 0.0811782 Test Loss: 0.1076061
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0855363
	speed: 0.0381s/iter; left time: 772.8100s
	iters: 200, epoch: 10 | loss: 0.0853410
	speed: 0.0223s/iter; left time: 449.1969s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0832864 Vali Loss: 0.0808300 Test Loss: 0.1084978
Validation loss decreased (0.081057 --> 0.080830).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0816533
	speed: 0.0376s/iter; left time: 755.2453s
	iters: 200, epoch: 11 | loss: 0.0852584
	speed: 0.0174s/iter; left time: 347.4976s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0824372 Vali Loss: 0.0800179 Test Loss: 0.1059387
Validation loss decreased (0.080830 --> 0.080018).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0845546
	speed: 0.0394s/iter; left time: 781.4903s
	iters: 200, epoch: 12 | loss: 0.0818359
	speed: 0.0176s/iter; left time: 346.5890s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0820708 Vali Loss: 0.0797471 Test Loss: 0.1046065
Validation loss decreased (0.080018 --> 0.079747).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0820495
	speed: 0.0378s/iter; left time: 741.1513s
	iters: 200, epoch: 13 | loss: 0.0821259
	speed: 0.0174s/iter; left time: 339.8218s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0817390 Vali Loss: 0.0797309 Test Loss: 0.1047793
Validation loss decreased (0.079747 --> 0.079731).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0771034
	speed: 0.0374s/iter; left time: 725.9512s
	iters: 200, epoch: 14 | loss: 0.0803334
	speed: 0.0177s/iter; left time: 341.0476s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0816818 Vali Loss: 0.0795235 Test Loss: 0.1054109
Validation loss decreased (0.079731 --> 0.079524).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0790244
	speed: 0.0374s/iter; left time: 716.8276s
	iters: 200, epoch: 15 | loss: 0.0830677
	speed: 0.0176s/iter; left time: 336.2045s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0809772 Vali Loss: 0.0793998 Test Loss: 0.1049986
Validation loss decreased (0.079524 --> 0.079400).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0790241
	speed: 0.0372s/iter; left time: 703.7488s
	iters: 200, epoch: 16 | loss: 0.0845467
	speed: 0.0177s/iter; left time: 333.2458s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0810577 Vali Loss: 0.0812501 Test Loss: 0.1041506
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0794203
	speed: 0.0369s/iter; left time: 689.9567s
	iters: 200, epoch: 17 | loss: 0.0831470
	speed: 0.0177s/iter; left time: 329.4307s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0806764 Vali Loss: 0.0792494 Test Loss: 0.1062545
Validation loss decreased (0.079400 --> 0.079249).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0804426
	speed: 0.0377s/iter; left time: 698.1049s
	iters: 200, epoch: 18 | loss: 0.0796953
	speed: 0.0175s/iter; left time: 321.4670s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0806038 Vali Loss: 0.0788590 Test Loss: 0.1040276
Validation loss decreased (0.079249 --> 0.078859).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0802150
	speed: 0.0374s/iter; left time: 682.7215s
	iters: 200, epoch: 19 | loss: 0.0840697
	speed: 0.0176s/iter; left time: 319.4835s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0800741 Vali Loss: 0.0789752 Test Loss: 0.1047164
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0799749
	speed: 0.0369s/iter; left time: 665.0032s
	iters: 200, epoch: 20 | loss: 0.0796723
	speed: 0.0177s/iter; left time: 317.7852s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0799620 Vali Loss: 0.0787971 Test Loss: 0.1043757
Validation loss decreased (0.078859 --> 0.078797).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814895
	speed: 0.0377s/iter; left time: 671.1743s
	iters: 200, epoch: 21 | loss: 0.0775726
	speed: 0.0176s/iter; left time: 311.3711s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0799304 Vali Loss: 0.0786215 Test Loss: 0.1053541
Validation loss decreased (0.078797 --> 0.078622).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0822030
	speed: 0.0388s/iter; left time: 682.6459s
	iters: 200, epoch: 22 | loss: 0.0822271
	speed: 0.0194s/iter; left time: 339.6049s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0797733 Vali Loss: 0.0788172 Test Loss: 0.1050946
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0782094
	speed: 0.0368s/iter; left time: 639.5816s
	iters: 200, epoch: 23 | loss: 0.0817364
	speed: 0.0174s/iter; left time: 299.9704s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0796080 Vali Loss: 0.0783708 Test Loss: 0.1048175
Validation loss decreased (0.078622 --> 0.078371).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0782946
	speed: 0.0389s/iter; left time: 667.6350s
	iters: 200, epoch: 24 | loss: 0.0759547
	speed: 0.0193s/iter; left time: 329.0638s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.0795476 Vali Loss: 0.0784284 Test Loss: 0.1046700
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0781184
	speed: 0.0385s/iter; left time: 651.9828s
	iters: 200, epoch: 25 | loss: 0.0811927
	speed: 0.0177s/iter; left time: 297.6154s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0799517 Vali Loss: 0.0786431 Test Loss: 0.1045798
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0762303
	speed: 0.0370s/iter; left time: 618.4891s
	iters: 200, epoch: 26 | loss: 0.0799544
	speed: 0.0181s/iter; left time: 300.6664s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0793796 Vali Loss: 0.0786190 Test Loss: 0.1051480
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0789374
	speed: 0.0370s/iter; left time: 609.6431s
	iters: 200, epoch: 27 | loss: 0.0780281
	speed: 0.0176s/iter; left time: 288.6519s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0792773 Vali Loss: 0.0784299 Test Loss: 0.1052233
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0814020
	speed: 0.0395s/iter; left time: 641.9937s
	iters: 200, epoch: 28 | loss: 0.0798138
	speed: 0.0186s/iter; left time: 299.8377s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0791199 Vali Loss: 0.0783501 Test Loss: 0.1047811
Validation loss decreased (0.078371 --> 0.078350).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0820562
	speed: 0.0370s/iter; left time: 593.4710s
	iters: 200, epoch: 29 | loss: 0.0808358
	speed: 0.0189s/iter; left time: 300.3078s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0791596 Vali Loss: 0.0785035 Test Loss: 0.1055300
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0763969
	speed: 0.0379s/iter; left time: 599.3888s
	iters: 200, epoch: 30 | loss: 0.0771363
	speed: 0.0176s/iter; left time: 276.2735s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0791952 Vali Loss: 0.0784093 Test Loss: 0.1051583
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0785842
	speed: 0.0374s/iter; left time: 582.5881s
	iters: 200, epoch: 31 | loss: 0.0813041
	speed: 0.0188s/iter; left time: 290.5109s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0790166 Vali Loss: 0.0783721 Test Loss: 0.1051348
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0805069
	speed: 0.0370s/iter; left time: 568.1873s
	iters: 200, epoch: 32 | loss: 0.0800453
	speed: 0.0185s/iter; left time: 281.9049s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0790431 Vali Loss: 0.0783341 Test Loss: 0.1047582
Validation loss decreased (0.078350 --> 0.078334).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0781617
	speed: 0.0379s/iter; left time: 572.8596s
	iters: 200, epoch: 33 | loss: 0.0795569
	speed: 0.0176s/iter; left time: 265.0821s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0790344 Vali Loss: 0.0783522 Test Loss: 0.1054242
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0754284
	speed: 0.0397s/iter; left time: 592.1762s
	iters: 200, epoch: 34 | loss: 0.0840273
	speed: 0.0201s/iter; left time: 296.9944s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0790746 Vali Loss: 0.0782857 Test Loss: 0.1051250
Validation loss decreased (0.078334 --> 0.078286).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0800861
	speed: 0.0390s/iter; left time: 573.1407s
	iters: 200, epoch: 35 | loss: 0.0839135
	speed: 0.0176s/iter; left time: 256.8560s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0789047 Vali Loss: 0.0782892 Test Loss: 0.1051449
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0803963
	speed: 0.0379s/iter; left time: 548.4311s
	iters: 200, epoch: 36 | loss: 0.0774545
	speed: 0.0175s/iter; left time: 251.6576s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0788350 Vali Loss: 0.0783046 Test Loss: 0.1055788
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0808286
	speed: 0.0373s/iter; left time: 530.5222s
	iters: 200, epoch: 37 | loss: 0.0770837
	speed: 0.0211s/iter; left time: 298.5353s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0788810 Vali Loss: 0.0783464 Test Loss: 0.1056055
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0771653
	speed: 0.0376s/iter; left time: 527.5544s
	iters: 200, epoch: 38 | loss: 0.0761486
	speed: 0.0175s/iter; left time: 243.8085s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0791125 Vali Loss: 0.0782723 Test Loss: 0.1056459
Validation loss decreased (0.078286 --> 0.078272).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0771597
	speed: 0.0392s/iter; left time: 540.5652s
	iters: 200, epoch: 39 | loss: 0.0795766
	speed: 0.0211s/iter; left time: 288.2684s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0789243 Vali Loss: 0.0781249 Test Loss: 0.1045209
Validation loss decreased (0.078272 --> 0.078125).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0800514
	speed: 0.0379s/iter; left time: 513.7359s
	iters: 200, epoch: 40 | loss: 0.0769166
	speed: 0.0174s/iter; left time: 233.9362s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0787367 Vali Loss: 0.0781777 Test Loss: 0.1055735
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0788939
	speed: 0.0380s/iter; left time: 506.7403s
	iters: 200, epoch: 41 | loss: 0.0796120
	speed: 0.0194s/iter; left time: 256.9042s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0787654 Vali Loss: 0.0783776 Test Loss: 0.1058984
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0801310
	speed: 0.0377s/iter; left time: 494.3213s
	iters: 200, epoch: 42 | loss: 0.0760927
	speed: 0.0175s/iter; left time: 228.4381s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0787919 Vali Loss: 0.0782467 Test Loss: 0.1052588
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0780973
	speed: 0.0375s/iter; left time: 483.0579s
	iters: 200, epoch: 43 | loss: 0.0798386
	speed: 0.0174s/iter; left time: 222.5702s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0787492 Vali Loss: 0.0781928 Test Loss: 0.1050963
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0823438
	speed: 0.0373s/iter; left time: 472.6711s
	iters: 200, epoch: 44 | loss: 0.0814990
	speed: 0.0176s/iter; left time: 220.6385s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0787495 Vali Loss: 0.0783943 Test Loss: 0.1058547
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0747283
	speed: 0.0373s/iter; left time: 463.7394s
	iters: 200, epoch: 45 | loss: 0.0808855
	speed: 0.0189s/iter; left time: 233.2129s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0786864 Vali Loss: 0.0781960 Test Loss: 0.1050198
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0759459
	speed: 0.0419s/iter; left time: 512.0966s
	iters: 200, epoch: 46 | loss: 0.0787885
	speed: 0.0174s/iter; left time: 210.5500s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0786618 Vali Loss: 0.0782442 Test Loss: 0.1055460
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0770903
	speed: 0.0374s/iter; left time: 448.5779s
	iters: 200, epoch: 47 | loss: 0.0741980
	speed: 0.0176s/iter; left time: 209.1131s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0786734 Vali Loss: 0.0782155 Test Loss: 0.1053684
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0808809
	speed: 0.0399s/iter; left time: 470.2276s
	iters: 200, epoch: 48 | loss: 0.0765063
	speed: 0.0204s/iter; left time: 238.4312s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0787458 Vali Loss: 0.0782955 Test Loss: 0.1055569
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0781761
	speed: 0.0370s/iter; left time: 427.0267s
	iters: 200, epoch: 49 | loss: 0.0780755
	speed: 0.0174s/iter; left time: 198.7852s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0785175 Vali Loss: 0.0782023 Test Loss: 0.1054485
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02427673526108265, rmse:0.1558099389076233, mae:0.10452089458703995, rse:0.4577226936817169
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2807732
	speed: 0.0241s/iter; left time: 538.3053s
	iters: 200, epoch: 1 | loss: 0.2653032
	speed: 0.0210s/iter; left time: 466.2831s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.2841145 Vali Loss: 0.2130373 Test Loss: 0.2379890
Validation loss decreased (inf --> 0.213037).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1392819
	speed: 0.0391s/iter; left time: 862.9989s
	iters: 200, epoch: 2 | loss: 0.1165387
	speed: 0.0176s/iter; left time: 387.6422s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.1551139 Vali Loss: 0.1124424 Test Loss: 0.1264123
Validation loss decreased (0.213037 --> 0.112442).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1126997
	speed: 0.0389s/iter; left time: 850.2621s
	iters: 200, epoch: 3 | loss: 0.1035556
	speed: 0.0174s/iter; left time: 378.4012s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.1085227 Vali Loss: 0.0961990 Test Loss: 0.1101242
Validation loss decreased (0.112442 --> 0.096199).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0962838
	speed: 0.0387s/iter; left time: 837.5867s
	iters: 200, epoch: 4 | loss: 0.0969591
	speed: 0.0175s/iter; left time: 377.3183s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0975332 Vali Loss: 0.0874930 Test Loss: 0.1175036
Validation loss decreased (0.096199 --> 0.087493).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0933458
	speed: 0.0409s/iter; left time: 874.7736s
	iters: 200, epoch: 5 | loss: 0.0946651
	speed: 0.0175s/iter; left time: 372.6396s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0918568 Vali Loss: 0.0853591 Test Loss: 0.1164506
Validation loss decreased (0.087493 --> 0.085359).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0905998
	speed: 0.0410s/iter; left time: 868.6588s
	iters: 200, epoch: 6 | loss: 0.0834064
	speed: 0.0186s/iter; left time: 392.4644s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.61s
Steps: 224 | Train Loss: 0.0886637 Vali Loss: 0.0833173 Test Loss: 0.1190308
Validation loss decreased (0.085359 --> 0.083317).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0859550
	speed: 0.0387s/iter; left time: 810.8632s
	iters: 200, epoch: 7 | loss: 0.0857930
	speed: 0.0174s/iter; left time: 361.8929s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0870941 Vali Loss: 0.0824725 Test Loss: 0.1289645
Validation loss decreased (0.083317 --> 0.082472).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0835487
	speed: 0.0394s/iter; left time: 816.0628s
	iters: 200, epoch: 8 | loss: 0.0800077
	speed: 0.0202s/iter; left time: 417.1473s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0859448 Vali Loss: 0.0809953 Test Loss: 0.1246080
Validation loss decreased (0.082472 --> 0.080995).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0829436
	speed: 0.0376s/iter; left time: 771.6681s
	iters: 200, epoch: 9 | loss: 0.0795209
	speed: 0.0174s/iter; left time: 354.5120s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0850060 Vali Loss: 0.0815726 Test Loss: 0.1122439
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0820003
	speed: 0.0370s/iter; left time: 750.4537s
	iters: 200, epoch: 10 | loss: 0.0848408
	speed: 0.0174s/iter; left time: 350.5234s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0839826 Vali Loss: 0.0810251 Test Loss: 0.1215878
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0819815
	speed: 0.0400s/iter; left time: 802.8165s
	iters: 200, epoch: 11 | loss: 0.0843423
	speed: 0.0194s/iter; left time: 387.0046s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0837573 Vali Loss: 0.0803522 Test Loss: 0.1226014
Validation loss decreased (0.080995 --> 0.080352).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0821579
	speed: 0.0382s/iter; left time: 758.6621s
	iters: 200, epoch: 12 | loss: 0.0825495
	speed: 0.0173s/iter; left time: 342.3495s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0829496 Vali Loss: 0.0797525 Test Loss: 0.1239641
Validation loss decreased (0.080352 --> 0.079753).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0780287
	speed: 0.0373s/iter; left time: 731.3173s
	iters: 200, epoch: 13 | loss: 0.0800011
	speed: 0.0175s/iter; left time: 341.9818s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0824018 Vali Loss: 0.0796889 Test Loss: 0.1207599
Validation loss decreased (0.079753 --> 0.079689).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0824617
	speed: 0.0383s/iter; left time: 743.4180s
	iters: 200, epoch: 14 | loss: 0.0812564
	speed: 0.0174s/iter; left time: 334.7822s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0819560 Vali Loss: 0.0796502 Test Loss: 0.1245411
Validation loss decreased (0.079689 --> 0.079650).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0830183
	speed: 0.0380s/iter; left time: 728.2025s
	iters: 200, epoch: 15 | loss: 0.0822272
	speed: 0.0175s/iter; left time: 333.7254s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0817088 Vali Loss: 0.0795031 Test Loss: 0.1285043
Validation loss decreased (0.079650 --> 0.079503).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0823791
	speed: 0.0382s/iter; left time: 723.6515s
	iters: 200, epoch: 16 | loss: 0.0843695
	speed: 0.0176s/iter; left time: 330.7992s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0813237 Vali Loss: 0.0790901 Test Loss: 0.1307180
Validation loss decreased (0.079503 --> 0.079090).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0792187
	speed: 0.0383s/iter; left time: 716.8989s
	iters: 200, epoch: 17 | loss: 0.0829362
	speed: 0.0174s/iter; left time: 323.9987s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0812568 Vali Loss: 0.0794295 Test Loss: 0.1282273
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0772294
	speed: 0.0401s/iter; left time: 741.0517s
	iters: 200, epoch: 18 | loss: 0.0806995
	speed: 0.0202s/iter; left time: 371.5650s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.67s
Steps: 224 | Train Loss: 0.0811110 Vali Loss: 0.0793635 Test Loss: 0.1272759
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0784017
	speed: 0.0379s/iter; left time: 692.2446s
	iters: 200, epoch: 19 | loss: 0.0811006
	speed: 0.0176s/iter; left time: 319.2630s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0807204 Vali Loss: 0.0791787 Test Loss: 0.1262407
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0806236
	speed: 0.0376s/iter; left time: 678.5568s
	iters: 200, epoch: 20 | loss: 0.0801287
	speed: 0.0174s/iter; left time: 312.4612s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0805928 Vali Loss: 0.0788154 Test Loss: 0.1241784
Validation loss decreased (0.079090 --> 0.078815).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814793
	speed: 0.0379s/iter; left time: 674.7187s
	iters: 200, epoch: 21 | loss: 0.0794477
	speed: 0.0174s/iter; left time: 308.1207s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0805322 Vali Loss: 0.0791230 Test Loss: 0.1281666
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0802228
	speed: 0.0371s/iter; left time: 652.9956s
	iters: 200, epoch: 22 | loss: 0.0822596
	speed: 0.0199s/iter; left time: 347.3298s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0803095 Vali Loss: 0.0789785 Test Loss: 0.1211020
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0813869
	speed: 0.0410s/iter; left time: 712.1590s
	iters: 200, epoch: 23 | loss: 0.0802233
	speed: 0.0176s/iter; left time: 304.7889s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0803901 Vali Loss: 0.0790809 Test Loss: 0.1202924
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0823530
	speed: 0.0375s/iter; left time: 643.7499s
	iters: 200, epoch: 24 | loss: 0.0754244
	speed: 0.0175s/iter; left time: 298.4231s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0799929 Vali Loss: 0.0786709 Test Loss: 0.1282071
Validation loss decreased (0.078815 --> 0.078671).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0769625
	speed: 0.0384s/iter; left time: 649.5076s
	iters: 200, epoch: 25 | loss: 0.0787524
	speed: 0.0177s/iter; left time: 297.2726s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0799626 Vali Loss: 0.0787696 Test Loss: 0.1272044
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0821803
	speed: 0.0377s/iter; left time: 629.2086s
	iters: 200, epoch: 26 | loss: 0.0780077
	speed: 0.0181s/iter; left time: 300.5271s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0799785 Vali Loss: 0.0786442 Test Loss: 0.1239915
Validation loss decreased (0.078671 --> 0.078644).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0795876
	speed: 0.0400s/iter; left time: 659.8528s
	iters: 200, epoch: 27 | loss: 0.0790085
	speed: 0.0204s/iter; left time: 334.6971s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.67s
Steps: 224 | Train Loss: 0.0797704 Vali Loss: 0.0786359 Test Loss: 0.1259093
Validation loss decreased (0.078644 --> 0.078636).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0818633
	speed: 0.0381s/iter; left time: 619.7570s
	iters: 200, epoch: 28 | loss: 0.0793344
	speed: 0.0174s/iter; left time: 280.7484s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0797060 Vali Loss: 0.0784768 Test Loss: 0.1269663
Validation loss decreased (0.078636 --> 0.078477).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0812629
	speed: 0.0433s/iter; left time: 694.5047s
	iters: 200, epoch: 29 | loss: 0.0797160
	speed: 0.0183s/iter; left time: 291.8144s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0796613 Vali Loss: 0.0785777 Test Loss: 0.1275836
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0785135
	speed: 0.0379s/iter; left time: 599.4292s
	iters: 200, epoch: 30 | loss: 0.0747149
	speed: 0.0176s/iter; left time: 276.6621s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0795775 Vali Loss: 0.0786406 Test Loss: 0.1256996
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0790730
	speed: 0.0373s/iter; left time: 581.5883s
	iters: 200, epoch: 31 | loss: 0.0801010
	speed: 0.0184s/iter; left time: 285.2870s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0794757 Vali Loss: 0.0785512 Test Loss: 0.1254068
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0801477
	speed: 0.0377s/iter; left time: 578.5869s
	iters: 200, epoch: 32 | loss: 0.0805202
	speed: 0.0183s/iter; left time: 279.9482s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0794999 Vali Loss: 0.0785085 Test Loss: 0.1251069
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0760565
	speed: 0.0374s/iter; left time: 566.3457s
	iters: 200, epoch: 33 | loss: 0.0793328
	speed: 0.0176s/iter; left time: 264.0922s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0795171 Vali Loss: 0.0785686 Test Loss: 0.1274197
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0773843
	speed: 0.0380s/iter; left time: 566.1015s
	iters: 200, epoch: 34 | loss: 0.0792592
	speed: 0.0175s/iter; left time: 259.2083s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0794413 Vali Loss: 0.0782065 Test Loss: 0.1235717
Validation loss decreased (0.078477 --> 0.078206).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0784409
	speed: 0.0379s/iter; left time: 556.2497s
	iters: 200, epoch: 35 | loss: 0.0783178
	speed: 0.0173s/iter; left time: 252.6660s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0795024 Vali Loss: 0.0784416 Test Loss: 0.1234996
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0821839
	speed: 0.0375s/iter; left time: 542.2428s
	iters: 200, epoch: 36 | loss: 0.0777974
	speed: 0.0202s/iter; left time: 290.0184s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0793642 Vali Loss: 0.0781588 Test Loss: 0.1211270
Validation loss decreased (0.078206 --> 0.078159).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0747080
	speed: 0.0436s/iter; left time: 621.1374s
	iters: 200, epoch: 37 | loss: 0.0795331
	speed: 0.0195s/iter; left time: 275.7286s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0792608 Vali Loss: 0.0784312 Test Loss: 0.1257160
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0776572
	speed: 0.0381s/iter; left time: 534.0900s
	iters: 200, epoch: 38 | loss: 0.0762254
	speed: 0.0176s/iter; left time: 244.4825s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0794165 Vali Loss: 0.0782640 Test Loss: 0.1224292
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0813769
	speed: 0.0422s/iter; left time: 581.9967s
	iters: 200, epoch: 39 | loss: 0.0792352
	speed: 0.0209s/iter; left time: 285.5187s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.94s
Steps: 224 | Train Loss: 0.0793261 Vali Loss: 0.0783679 Test Loss: 0.1225942
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0799571
	speed: 0.0374s/iter; left time: 507.9205s
	iters: 200, epoch: 40 | loss: 0.0804243
	speed: 0.0174s/iter; left time: 233.8304s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0792455 Vali Loss: 0.0784150 Test Loss: 0.1252133
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0813761
	speed: 0.0372s/iter; left time: 495.7526s
	iters: 200, epoch: 41 | loss: 0.0816666
	speed: 0.0174s/iter; left time: 230.6579s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0792573 Vali Loss: 0.0782532 Test Loss: 0.1225800
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0778905
	speed: 0.0373s/iter; left time: 489.1493s
	iters: 200, epoch: 42 | loss: 0.0788236
	speed: 0.0176s/iter; left time: 229.0740s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0792435 Vali Loss: 0.0781906 Test Loss: 0.1238133
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0783627
	speed: 0.0393s/iter; left time: 506.2812s
	iters: 200, epoch: 43 | loss: 0.0787241
	speed: 0.0207s/iter; left time: 264.9269s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0793239 Vali Loss: 0.0781083 Test Loss: 0.1231488
Validation loss decreased (0.078159 --> 0.078108).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0763025
	speed: 0.0416s/iter; left time: 526.6662s
	iters: 200, epoch: 44 | loss: 0.0738823
	speed: 0.0199s/iter; left time: 249.6092s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0792564 Vali Loss: 0.0784912 Test Loss: 0.1267495
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0757882
	speed: 0.0410s/iter; left time: 509.6752s
	iters: 200, epoch: 45 | loss: 0.0789459
	speed: 0.0174s/iter; left time: 214.4809s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0793981 Vali Loss: 0.0783084 Test Loss: 0.1237282
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0772759
	speed: 0.0376s/iter; left time: 459.7951s
	iters: 200, epoch: 46 | loss: 0.0767787
	speed: 0.0177s/iter; left time: 214.2455s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0790786 Vali Loss: 0.0783964 Test Loss: 0.1239477
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0750165
	speed: 0.0380s/iter; left time: 456.1696s
	iters: 200, epoch: 47 | loss: 0.0791191
	speed: 0.0177s/iter; left time: 210.7319s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0791732 Vali Loss: 0.0784350 Test Loss: 0.1260129
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0822771
	speed: 0.0387s/iter; left time: 455.5598s
	iters: 200, epoch: 48 | loss: 0.0833114
	speed: 0.0200s/iter; left time: 233.0707s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0792517 Vali Loss: 0.0783070 Test Loss: 0.1245301
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0782012
	speed: 0.0379s/iter; left time: 437.8831s
	iters: 200, epoch: 49 | loss: 0.0790513
	speed: 0.0182s/iter; left time: 208.1462s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0790816 Vali Loss: 0.0784223 Test Loss: 0.1252991
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0769528
	speed: 0.0378s/iter; left time: 428.5405s
	iters: 200, epoch: 50 | loss: 0.0796110
	speed: 0.0183s/iter; left time: 205.1430s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0792062 Vali Loss: 0.0781806 Test Loss: 0.1240269
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0821458
	speed: 0.0405s/iter; left time: 449.8227s
	iters: 200, epoch: 51 | loss: 0.0748606
	speed: 0.0208s/iter; left time: 229.2027s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0791860 Vali Loss: 0.0783969 Test Loss: 0.1252220
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0788861
	speed: 0.0389s/iter; left time: 423.1191s
	iters: 200, epoch: 52 | loss: 0.0744792
	speed: 0.0175s/iter; left time: 188.3081s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0791129 Vali Loss: 0.0783578 Test Loss: 0.1260209
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0779445
	speed: 0.0373s/iter; left time: 397.8023s
	iters: 200, epoch: 53 | loss: 0.0807185
	speed: 0.0175s/iter; left time: 184.8857s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0790737 Vali Loss: 0.0782593 Test Loss: 0.1245420
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04175650700926781, rmse:0.20434409379959106, mae:0.1231488287448883, rse:0.6003013849258423
Intermediate time for ES and pred_len 96: 00h:09m:48.56s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2749318
	speed: 0.0415s/iter; left time: 920.3683s
	iters: 200, epoch: 1 | loss: 0.2637250
	speed: 0.0177s/iter; left time: 390.5023s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.43s
Steps: 223 | Train Loss: 0.2789764 Vali Loss: 0.2100756 Test Loss: 0.2343825
Validation loss decreased (inf --> 0.210076).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1421229
	speed: 0.0373s/iter; left time: 819.5815s
	iters: 200, epoch: 2 | loss: 0.1207080
	speed: 0.0177s/iter; left time: 388.2478s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.1543833 Vali Loss: 0.1086527 Test Loss: 0.1232387
Validation loss decreased (0.210076 --> 0.108653).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1143583
	speed: 0.0381s/iter; left time: 829.6279s
	iters: 200, epoch: 3 | loss: 0.1035095
	speed: 0.0180s/iter; left time: 390.2745s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.1096992 Vali Loss: 0.0961292 Test Loss: 0.1119838
Validation loss decreased (0.108653 --> 0.096129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0991537
	speed: 0.0379s/iter; left time: 817.1208s
	iters: 200, epoch: 4 | loss: 0.0941834
	speed: 0.0179s/iter; left time: 383.5921s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0979566 Vali Loss: 0.0913458 Test Loss: 0.1117256
Validation loss decreased (0.096129 --> 0.091346).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0948883
	speed: 0.0376s/iter; left time: 801.8857s
	iters: 200, epoch: 5 | loss: 0.0904951
	speed: 0.0181s/iter; left time: 383.7397s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0934428 Vali Loss: 0.0899405 Test Loss: 0.1138975
Validation loss decreased (0.091346 --> 0.089940).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0889967
	speed: 0.0388s/iter; left time: 817.4538s
	iters: 200, epoch: 6 | loss: 0.0896095
	speed: 0.0178s/iter; left time: 373.9967s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0908615 Vali Loss: 0.0874881 Test Loss: 0.1135529
Validation loss decreased (0.089940 --> 0.087488).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0891786
	speed: 0.0377s/iter; left time: 786.8146s
	iters: 200, epoch: 7 | loss: 0.0887473
	speed: 0.0177s/iter; left time: 368.1984s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.15s
Steps: 223 | Train Loss: 0.0893473 Vali Loss: 0.0867286 Test Loss: 0.1134460
Validation loss decreased (0.087488 --> 0.086729).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0847037
	speed: 0.0387s/iter; left time: 798.8800s
	iters: 200, epoch: 8 | loss: 0.0879599
	speed: 0.0177s/iter; left time: 363.1379s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0882717 Vali Loss: 0.0867410 Test Loss: 0.1150925
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0870168
	speed: 0.0381s/iter; left time: 777.2110s
	iters: 200, epoch: 9 | loss: 0.0849715
	speed: 0.0178s/iter; left time: 361.2851s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0878216 Vali Loss: 0.0872022 Test Loss: 0.1176080
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0875702
	speed: 0.0378s/iter; left time: 762.7947s
	iters: 200, epoch: 10 | loss: 0.0899240
	speed: 0.0181s/iter; left time: 364.0099s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0869609 Vali Loss: 0.0860930 Test Loss: 0.1131297
Validation loss decreased (0.086729 --> 0.086093).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0882442
	speed: 0.0385s/iter; left time: 769.2968s
	iters: 200, epoch: 11 | loss: 0.0836711
	speed: 0.0179s/iter; left time: 355.0595s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0865654 Vali Loss: 0.0859699 Test Loss: 0.1132639
Validation loss decreased (0.086093 --> 0.085970).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0827679
	speed: 0.0383s/iter; left time: 755.5015s
	iters: 200, epoch: 12 | loss: 0.0866363
	speed: 0.0177s/iter; left time: 347.7449s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0860623 Vali Loss: 0.0858304 Test Loss: 0.1128382
Validation loss decreased (0.085970 --> 0.085830).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0829732
	speed: 0.0378s/iter; left time: 738.1925s
	iters: 200, epoch: 13 | loss: 0.0850765
	speed: 0.0177s/iter; left time: 343.7003s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.14s
Steps: 223 | Train Loss: 0.0856914 Vali Loss: 0.0856651 Test Loss: 0.1135978
Validation loss decreased (0.085830 --> 0.085665).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0841183
	speed: 0.0396s/iter; left time: 763.7380s
	iters: 200, epoch: 14 | loss: 0.0859597
	speed: 0.0177s/iter; left time: 340.1685s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0852342 Vali Loss: 0.0856685 Test Loss: 0.1136733
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0842968
	speed: 0.0382s/iter; left time: 729.1758s
	iters: 200, epoch: 15 | loss: 0.0909677
	speed: 0.0178s/iter; left time: 337.9328s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0852555 Vali Loss: 0.0855243 Test Loss: 0.1138341
Validation loss decreased (0.085665 --> 0.085524).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0852345
	speed: 0.0382s/iter; left time: 720.0223s
	iters: 200, epoch: 16 | loss: 0.0851248
	speed: 0.0203s/iter; left time: 380.5213s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.47s
Steps: 223 | Train Loss: 0.0847901 Vali Loss: 0.0851691 Test Loss: 0.1139723
Validation loss decreased (0.085524 --> 0.085169).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0839362
	speed: 0.0385s/iter; left time: 717.8357s
	iters: 200, epoch: 17 | loss: 0.0833548
	speed: 0.0177s/iter; left time: 328.2312s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0845173 Vali Loss: 0.0850614 Test Loss: 0.1140275
Validation loss decreased (0.085169 --> 0.085061).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0813416
	speed: 0.0377s/iter; left time: 693.3347s
	iters: 200, epoch: 18 | loss: 0.0866940
	speed: 0.0192s/iter; left time: 351.3236s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0843307 Vali Loss: 0.0847981 Test Loss: 0.1144203
Validation loss decreased (0.085061 --> 0.084798).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0843313
	speed: 0.0381s/iter; left time: 693.2385s
	iters: 200, epoch: 19 | loss: 0.0832647
	speed: 0.0180s/iter; left time: 325.1047s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0842799 Vali Loss: 0.0846771 Test Loss: 0.1141960
Validation loss decreased (0.084798 --> 0.084677).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0862335
	speed: 0.0379s/iter; left time: 681.4529s
	iters: 200, epoch: 20 | loss: 0.0817612
	speed: 0.0178s/iter; left time: 318.8287s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0838804 Vali Loss: 0.0843563 Test Loss: 0.1145415
Validation loss decreased (0.084677 --> 0.084356).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0837195
	speed: 0.0404s/iter; left time: 716.5821s
	iters: 200, epoch: 21 | loss: 0.1031141
	speed: 0.0202s/iter; left time: 356.7964s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.67s
Steps: 223 | Train Loss: 0.0839049 Vali Loss: 0.0849667 Test Loss: 0.1150237
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0836587
	speed: 0.0377s/iter; left time: 660.8575s
	iters: 200, epoch: 22 | loss: 0.0852197
	speed: 0.0179s/iter; left time: 311.8687s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0837684 Vali Loss: 0.0846416 Test Loss: 0.1158141
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0795333
	speed: 0.0383s/iter; left time: 663.0939s
	iters: 200, epoch: 23 | loss: 0.0865810
	speed: 0.0178s/iter; left time: 306.6030s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0835962 Vali Loss: 0.0847980 Test Loss: 0.1160617
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0831024
	speed: 0.0373s/iter; left time: 637.2761s
	iters: 200, epoch: 24 | loss: 0.0805572
	speed: 0.0177s/iter; left time: 299.6318s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0839736 Vali Loss: 0.0847975 Test Loss: 0.1165650
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0849554
	speed: 0.0380s/iter; left time: 639.8876s
	iters: 200, epoch: 25 | loss: 0.0840587
	speed: 0.0189s/iter; left time: 316.4384s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0834544 Vali Loss: 0.0845328 Test Loss: 0.1162506
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0892217
	speed: 0.0375s/iter; left time: 623.1592s
	iters: 200, epoch: 26 | loss: 0.0807220
	speed: 0.0183s/iter; left time: 302.4514s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0833992 Vali Loss: 0.0846728 Test Loss: 0.1164240
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0810502
	speed: 0.0385s/iter; left time: 630.8216s
	iters: 200, epoch: 27 | loss: 0.0854318
	speed: 0.0178s/iter; left time: 291.0075s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0833067 Vali Loss: 0.0845248 Test Loss: 0.1158283
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0797867
	speed: 0.0403s/iter; left time: 651.9570s
	iters: 200, epoch: 28 | loss: 0.0819262
	speed: 0.0194s/iter; left time: 312.4984s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0833002 Vali Loss: 0.0843592 Test Loss: 0.1163825
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0846014
	speed: 0.0374s/iter; left time: 597.1936s
	iters: 200, epoch: 29 | loss: 0.0876969
	speed: 0.0177s/iter; left time: 280.5650s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0833116 Vali Loss: 0.0845298 Test Loss: 0.1166252
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0819796
	speed: 0.0395s/iter; left time: 621.2215s
	iters: 200, epoch: 30 | loss: 0.0857283
	speed: 0.0219s/iter; left time: 342.2011s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.89s
Steps: 223 | Train Loss: 0.0831343 Vali Loss: 0.0845026 Test Loss: 0.1163839
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0290948748588562, rmse:0.1705721914768219, mae:0.11454156041145325, rse:0.5011257529258728
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2807395
	speed: 0.0197s/iter; left time: 437.4888s
	iters: 200, epoch: 1 | loss: 0.2651633
	speed: 0.0177s/iter; left time: 391.4783s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.2830992 Vali Loss: 0.2142654 Test Loss: 0.2370222
Validation loss decreased (inf --> 0.214265).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1453094
	speed: 0.0382s/iter; left time: 840.0588s
	iters: 200, epoch: 2 | loss: 0.1242578
	speed: 0.0180s/iter; left time: 393.8545s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.1572299 Vali Loss: 0.1083790 Test Loss: 0.1231012
Validation loss decreased (0.214265 --> 0.108379).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1133961
	speed: 0.0428s/iter; left time: 932.0011s
	iters: 200, epoch: 3 | loss: 0.0982893
	speed: 0.0208s/iter; left time: 451.4715s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.98s
Steps: 223 | Train Loss: 0.1100277 Vali Loss: 0.0972046 Test Loss: 0.1224924
Validation loss decreased (0.108379 --> 0.097205).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0974868
	speed: 0.0402s/iter; left time: 864.6889s
	iters: 200, epoch: 4 | loss: 0.0972847
	speed: 0.0178s/iter; left time: 382.2048s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0984315 Vali Loss: 0.0914870 Test Loss: 0.1193569
Validation loss decreased (0.097205 --> 0.091487).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0947529
	speed: 0.0390s/iter; left time: 831.2727s
	iters: 200, epoch: 5 | loss: 0.0937127
	speed: 0.0188s/iter; left time: 399.5083s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0946569 Vali Loss: 0.0894347 Test Loss: 0.1191490
Validation loss decreased (0.091487 --> 0.089435).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0918505
	speed: 0.0394s/iter; left time: 831.3602s
	iters: 200, epoch: 6 | loss: 0.0901247
	speed: 0.0179s/iter; left time: 375.6055s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0917058 Vali Loss: 0.0881212 Test Loss: 0.1236080
Validation loss decreased (0.089435 --> 0.088121).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0917704
	speed: 0.0382s/iter; left time: 797.0048s
	iters: 200, epoch: 7 | loss: 0.0922219
	speed: 0.0178s/iter; left time: 370.0706s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0899804 Vali Loss: 0.0864551 Test Loss: 0.1166708
Validation loss decreased (0.088121 --> 0.086455).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0917562
	speed: 0.0390s/iter; left time: 805.6186s
	iters: 200, epoch: 8 | loss: 0.0877953
	speed: 0.0177s/iter; left time: 363.4176s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0890128 Vali Loss: 0.0861659 Test Loss: 0.1123231
Validation loss decreased (0.086455 --> 0.086166).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0919937
	speed: 0.0386s/iter; left time: 787.5926s
	iters: 200, epoch: 9 | loss: 0.0899467
	speed: 0.0178s/iter; left time: 362.6346s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0910410 Vali Loss: 0.0899233 Test Loss: 0.1119124
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0895764
	speed: 0.0380s/iter; left time: 767.0532s
	iters: 200, epoch: 10 | loss: 0.0906453
	speed: 0.0177s/iter; left time: 355.0612s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0887168 Vali Loss: 0.0859634 Test Loss: 0.1185711
Validation loss decreased (0.086166 --> 0.085963).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0892631
	speed: 0.0378s/iter; left time: 754.8397s
	iters: 200, epoch: 11 | loss: 0.0895315
	speed: 0.0177s/iter; left time: 351.0145s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0871117 Vali Loss: 0.0853329 Test Loss: 0.1164193
Validation loss decreased (0.085963 --> 0.085333).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0869905
	speed: 0.0381s/iter; left time: 752.4551s
	iters: 200, epoch: 12 | loss: 0.0848289
	speed: 0.0178s/iter; left time: 349.7580s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0865530 Vali Loss: 0.0852942 Test Loss: 0.1179176
Validation loss decreased (0.085333 --> 0.085294).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0864150
	speed: 0.0386s/iter; left time: 752.7703s
	iters: 200, epoch: 13 | loss: 0.0838847
	speed: 0.0177s/iter; left time: 343.7851s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0862789 Vali Loss: 0.0850571 Test Loss: 0.1164684
Validation loss decreased (0.085294 --> 0.085057).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0867992
	speed: 0.0388s/iter; left time: 748.5236s
	iters: 200, epoch: 14 | loss: 0.0845527
	speed: 0.0177s/iter; left time: 338.9496s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0858124 Vali Loss: 0.0850595 Test Loss: 0.1153065
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0845146
	speed: 0.0378s/iter; left time: 721.2674s
	iters: 200, epoch: 15 | loss: 0.0846549
	speed: 0.0182s/iter; left time: 344.7128s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0856219 Vali Loss: 0.0849426 Test Loss: 0.1166757
Validation loss decreased (0.085057 --> 0.084943).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0845102
	speed: 0.0407s/iter; left time: 766.9892s
	iters: 200, epoch: 16 | loss: 0.0888782
	speed: 0.0199s/iter; left time: 373.8315s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.62s
Steps: 223 | Train Loss: 0.0858942 Vali Loss: 0.0853336 Test Loss: 0.1119651
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0912922
	speed: 0.0378s/iter; left time: 703.8816s
	iters: 200, epoch: 17 | loss: 0.0889382
	speed: 0.0177s/iter; left time: 327.3777s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0856840 Vali Loss: 0.0851839 Test Loss: 0.1192388
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0845657
	speed: 0.0402s/iter; left time: 739.8128s
	iters: 200, epoch: 18 | loss: 0.0815924
	speed: 0.0180s/iter; left time: 329.8848s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.46s
Steps: 223 | Train Loss: 0.0849107 Vali Loss: 0.0853217 Test Loss: 0.1206380
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0849029
	speed: 0.0380s/iter; left time: 690.7471s
	iters: 200, epoch: 19 | loss: 0.0853960
	speed: 0.0179s/iter; left time: 323.5752s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0848261 Vali Loss: 0.0846747 Test Loss: 0.1192671
Validation loss decreased (0.084943 --> 0.084675).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0811674
	speed: 0.0386s/iter; left time: 693.0126s
	iters: 200, epoch: 20 | loss: 0.0817534
	speed: 0.0178s/iter; left time: 318.6812s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0845942 Vali Loss: 0.0847365 Test Loss: 0.1183660
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0826207
	speed: 0.0375s/iter; left time: 665.2076s
	iters: 200, epoch: 21 | loss: 0.0816803
	speed: 0.0177s/iter; left time: 312.7151s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0843873 Vali Loss: 0.0846548 Test Loss: 0.1183502
Validation loss decreased (0.084675 --> 0.084655).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0834691
	speed: 0.0381s/iter; left time: 667.4153s
	iters: 200, epoch: 22 | loss: 0.0883418
	speed: 0.0185s/iter; left time: 322.6009s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0843994 Vali Loss: 0.0845420 Test Loss: 0.1178532
Validation loss decreased (0.084655 --> 0.084542).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0847441
	speed: 0.0384s/iter; left time: 663.9202s
	iters: 200, epoch: 23 | loss: 0.0805724
	speed: 0.0178s/iter; left time: 305.8888s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0841674 Vali Loss: 0.0844933 Test Loss: 0.1170921
Validation loss decreased (0.084542 --> 0.084493).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0839649
	speed: 0.0392s/iter; left time: 668.4869s
	iters: 200, epoch: 24 | loss: 0.0834868
	speed: 0.0178s/iter; left time: 301.9828s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0841976 Vali Loss: 0.0846161 Test Loss: 0.1172125
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0881067
	speed: 0.0398s/iter; left time: 670.4357s
	iters: 200, epoch: 25 | loss: 0.0828818
	speed: 0.0194s/iter; left time: 324.6453s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.55s
Steps: 223 | Train Loss: 0.0841515 Vali Loss: 0.0843772 Test Loss: 0.1175339
Validation loss decreased (0.084493 --> 0.084377).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0825793
	speed: 0.0410s/iter; left time: 682.0217s
	iters: 200, epoch: 26 | loss: 0.0856509
	speed: 0.0181s/iter; left time: 298.8593s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.46s
Steps: 223 | Train Loss: 0.0842238 Vali Loss: 0.0844084 Test Loss: 0.1173107
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0819396
	speed: 0.0404s/iter; left time: 662.8102s
	iters: 200, epoch: 27 | loss: 0.0869512
	speed: 0.0195s/iter; left time: 317.6365s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.56s
Steps: 223 | Train Loss: 0.0840297 Vali Loss: 0.0846008 Test Loss: 0.1175796
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0859564
	speed: 0.0386s/iter; left time: 624.9775s
	iters: 200, epoch: 28 | loss: 0.0873584
	speed: 0.0180s/iter; left time: 289.1979s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0837992 Vali Loss: 0.0845674 Test Loss: 0.1199782
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0821546
	speed: 0.0382s/iter; left time: 610.2197s
	iters: 200, epoch: 29 | loss: 0.0846214
	speed: 0.0178s/iter; left time: 282.3562s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0837742 Vali Loss: 0.0844055 Test Loss: 0.1191112
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0844201
	speed: 0.0412s/iter; left time: 647.6364s
	iters: 200, epoch: 30 | loss: 0.0841895
	speed: 0.0222s/iter; left time: 346.9473s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0837221 Vali Loss: 0.0842772 Test Loss: 0.1190496
Validation loss decreased (0.084377 --> 0.084277).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0870948
	speed: 0.0393s/iter; left time: 609.4403s
	iters: 200, epoch: 31 | loss: 0.0821873
	speed: 0.0177s/iter; left time: 273.4505s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0836353 Vali Loss: 0.0842929 Test Loss: 0.1206920
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0848337
	speed: 0.0377s/iter; left time: 576.4363s
	iters: 200, epoch: 32 | loss: 0.0830336
	speed: 0.0177s/iter; left time: 268.6926s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0837642 Vali Loss: 0.0842275 Test Loss: 0.1182323
Validation loss decreased (0.084277 --> 0.084228).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0846711
	speed: 0.0395s/iter; left time: 594.5822s
	iters: 200, epoch: 33 | loss: 0.0801985
	speed: 0.0180s/iter; left time: 269.5565s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0836584 Vali Loss: 0.0844522 Test Loss: 0.1194240
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0836901
	speed: 0.0381s/iter; left time: 565.8463s
	iters: 200, epoch: 34 | loss: 0.0838794
	speed: 0.0177s/iter; left time: 260.3890s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0836737 Vali Loss: 0.0843503 Test Loss: 0.1194371
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0843293
	speed: 0.0396s/iter; left time: 578.5798s
	iters: 200, epoch: 35 | loss: 0.0848211
	speed: 0.0179s/iter; left time: 259.1964s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0835618 Vali Loss: 0.0844821 Test Loss: 0.1200642
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0810826
	speed: 0.0387s/iter; left time: 556.7249s
	iters: 200, epoch: 36 | loss: 0.0852567
	speed: 0.0177s/iter; left time: 253.2049s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0838000 Vali Loss: 0.0845061 Test Loss: 0.1194763
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0803306
	speed: 0.0410s/iter; left time: 581.3790s
	iters: 200, epoch: 37 | loss: 0.0833322
	speed: 0.0182s/iter; left time: 255.9273s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.52s
Steps: 223 | Train Loss: 0.0835411 Vali Loss: 0.0843955 Test Loss: 0.1186716
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0823816
	speed: 0.0381s/iter; left time: 531.2084s
	iters: 200, epoch: 38 | loss: 0.0843670
	speed: 0.0181s/iter; left time: 250.9705s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0834298 Vali Loss: 0.0843624 Test Loss: 0.1192587
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0864377
	speed: 0.0393s/iter; left time: 539.8572s
	iters: 200, epoch: 39 | loss: 0.0857570
	speed: 0.0178s/iter; left time: 242.5847s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0836104 Vali Loss: 0.0843764 Test Loss: 0.1198429
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0814850
	speed: 0.0378s/iter; left time: 510.7382s
	iters: 200, epoch: 40 | loss: 0.0841378
	speed: 0.0178s/iter; left time: 238.2325s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0839965 Vali Loss: 0.0844893 Test Loss: 0.1194120
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0799215
	speed: 0.0376s/iter; left time: 499.8096s
	iters: 200, epoch: 41 | loss: 0.0783022
	speed: 0.0179s/iter; left time: 235.6896s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0834080 Vali Loss: 0.0841839 Test Loss: 0.1189149
Validation loss decreased (0.084228 --> 0.084184).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0835249
	speed: 0.0388s/iter; left time: 506.5320s
	iters: 200, epoch: 42 | loss: 0.0811903
	speed: 0.0178s/iter; left time: 230.5595s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0834037 Vali Loss: 0.0844404 Test Loss: 0.1207593
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0831517
	speed: 0.0379s/iter; left time: 486.5615s
	iters: 200, epoch: 43 | loss: 0.0815078
	speed: 0.0177s/iter; left time: 225.4865s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0834141 Vali Loss: 0.0845041 Test Loss: 0.1203174
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0865642
	speed: 0.0378s/iter; left time: 477.0652s
	iters: 200, epoch: 44 | loss: 0.0847886
	speed: 0.0182s/iter; left time: 227.6107s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0835477 Vali Loss: 0.0844085 Test Loss: 0.1198660
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0788437
	speed: 0.0417s/iter; left time: 516.0462s
	iters: 200, epoch: 45 | loss: 0.0816742
	speed: 0.0179s/iter; left time: 220.3732s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0834426 Vali Loss: 0.0842027 Test Loss: 0.1195737
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0830794
	speed: 0.0397s/iter; left time: 482.8533s
	iters: 200, epoch: 46 | loss: 0.0839437
	speed: 0.0186s/iter; left time: 224.5317s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.45s
Steps: 223 | Train Loss: 0.0833704 Vali Loss: 0.0842480 Test Loss: 0.1193747
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0823590
	speed: 0.0385s/iter; left time: 459.4566s
	iters: 200, epoch: 47 | loss: 0.0856680
	speed: 0.0177s/iter; left time: 209.2620s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0832862 Vali Loss: 0.0841228 Test Loss: 0.1197550
Validation loss decreased (0.084184 --> 0.084123).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0883429
	speed: 0.0387s/iter; left time: 453.8099s
	iters: 200, epoch: 48 | loss: 0.0826623
	speed: 0.0177s/iter; left time: 205.3933s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0833737 Vali Loss: 0.0842797 Test Loss: 0.1200274
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0815217
	speed: 0.0387s/iter; left time: 444.5435s
	iters: 200, epoch: 49 | loss: 0.0848437
	speed: 0.0184s/iter; left time: 209.4425s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0833760 Vali Loss: 0.0841590 Test Loss: 0.1200445
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0827644
	speed: 0.0379s/iter; left time: 427.7059s
	iters: 200, epoch: 50 | loss: 0.0767582
	speed: 0.0177s/iter; left time: 197.5258s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0832877 Vali Loss: 0.0839660 Test Loss: 0.1184397
Validation loss decreased (0.084123 --> 0.083966).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0835075
	speed: 0.0384s/iter; left time: 424.8004s
	iters: 200, epoch: 51 | loss: 0.0817596
	speed: 0.0177s/iter; left time: 193.5049s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0832505 Vali Loss: 0.0842132 Test Loss: 0.1197245
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0808008
	speed: 0.0377s/iter; left time: 408.7473s
	iters: 200, epoch: 52 | loss: 0.0849158
	speed: 0.0181s/iter; left time: 194.0784s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0834962 Vali Loss: 0.0841127 Test Loss: 0.1192776
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0800299
	speed: 0.0407s/iter; left time: 431.5793s
	iters: 200, epoch: 53 | loss: 0.0820698
	speed: 0.0179s/iter; left time: 188.3099s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.50s
Steps: 223 | Train Loss: 0.0832694 Vali Loss: 0.0842121 Test Loss: 0.1194684
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0802618
	speed: 0.0379s/iter; left time: 393.3319s
	iters: 200, epoch: 54 | loss: 0.0827059
	speed: 0.0178s/iter; left time: 183.0317s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0833176 Vali Loss: 0.0842278 Test Loss: 0.1203044
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0861164
	speed: 0.0401s/iter; left time: 407.5977s
	iters: 200, epoch: 55 | loss: 0.0852268
	speed: 0.0187s/iter; left time: 187.8602s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.55s
Steps: 223 | Train Loss: 0.0833072 Vali Loss: 0.0842820 Test Loss: 0.1206407
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0806998
	speed: 0.0387s/iter; left time: 384.6696s
	iters: 200, epoch: 56 | loss: 0.0823214
	speed: 0.0178s/iter; left time: 174.6927s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0834395 Vali Loss: 0.0842447 Test Loss: 0.1202066
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0837483
	speed: 0.0387s/iter; left time: 376.3452s
	iters: 200, epoch: 57 | loss: 0.0801571
	speed: 0.0197s/iter; left time: 189.8171s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.49s
Steps: 223 | Train Loss: 0.0833268 Vali Loss: 0.0842674 Test Loss: 0.1203132
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0821808
	speed: 0.0419s/iter; left time: 397.5706s
	iters: 200, epoch: 58 | loss: 0.0829196
	speed: 0.0200s/iter; left time: 187.7119s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.76s
Steps: 223 | Train Loss: 0.0832269 Vali Loss: 0.0843088 Test Loss: 0.1198582
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0822175
	speed: 0.0380s/iter; left time: 352.3228s
	iters: 200, epoch: 59 | loss: 0.0831296
	speed: 0.0177s/iter; left time: 162.2464s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0833064 Vali Loss: 0.0840443 Test Loss: 0.1194816
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0843803
	speed: 0.0383s/iter; left time: 346.6295s
	iters: 200, epoch: 60 | loss: 0.0825238
	speed: 0.0177s/iter; left time: 158.2245s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.17s
Steps: 223 | Train Loss: 0.0836524 Vali Loss: 0.0842534 Test Loss: 0.1202688
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03208500146865845, rmse:0.17912286520004272, mae:0.1184396892786026, rse:0.5262468457221985
Intermediate time for ES and pred_len 168: 00h:08m:43.78sIntermediate time for ES: 00h:29m:19.98s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2387870
	speed: 0.0372s/iter; left time: 836.6014s
	iters: 200, epoch: 1 | loss: 0.2139293
	speed: 0.0166s/iter; left time: 371.3060s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.71s
Steps: 226 | Train Loss: 0.2391190 Vali Loss: 0.1718954 Test Loss: 0.1789114
Validation loss decreased (inf --> 0.171895).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1444989
	speed: 0.0290s/iter; left time: 646.5466s
	iters: 200, epoch: 2 | loss: 0.1030055
	speed: 0.0164s/iter; left time: 364.2849s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.74s
Steps: 226 | Train Loss: 0.1399414 Vali Loss: 0.0846169 Test Loss: 0.0930004
Validation loss decreased (0.171895 --> 0.084617).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0855119
	speed: 0.0387s/iter; left time: 853.1069s
	iters: 200, epoch: 3 | loss: 0.0796396
	speed: 0.0195s/iter; left time: 428.7899s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.80s
Steps: 226 | Train Loss: 0.0862447 Vali Loss: 0.0776337 Test Loss: 0.0803794
Validation loss decreased (0.084617 --> 0.077634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0774116
	speed: 0.0269s/iter; left time: 587.9104s
	iters: 200, epoch: 4 | loss: 0.0713846
	speed: 0.0107s/iter; left time: 232.0666s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:02.62s
Steps: 226 | Train Loss: 0.0744315 Vali Loss: 0.0723683 Test Loss: 0.0729725
Validation loss decreased (0.077634 --> 0.072368).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0675851
	speed: 0.0273s/iter; left time: 589.1216s
	iters: 200, epoch: 5 | loss: 0.0648144
	speed: 0.0164s/iter; left time: 353.4620s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.51s
Steps: 226 | Train Loss: 0.0683895 Vali Loss: 0.0677736 Test Loss: 0.0678707
Validation loss decreased (0.072368 --> 0.067774).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0625560
	speed: 0.0329s/iter; left time: 702.1603s
	iters: 200, epoch: 6 | loss: 0.0605061
	speed: 0.0172s/iter; left time: 365.5317s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0641057 Vali Loss: 0.0669710 Test Loss: 0.0681956
Validation loss decreased (0.067774 --> 0.066971).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0640559
	speed: 0.0319s/iter; left time: 674.4038s
	iters: 200, epoch: 7 | loss: 0.0622133
	speed: 0.0175s/iter; left time: 368.6755s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0617407 Vali Loss: 0.0671168 Test Loss: 0.0687033
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0596539
	speed: 0.0319s/iter; left time: 667.6760s
	iters: 200, epoch: 8 | loss: 0.0568511
	speed: 0.0163s/iter; left time: 338.9214s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.91s
Steps: 226 | Train Loss: 0.0595213 Vali Loss: 0.0637386 Test Loss: 0.0658388
Validation loss decreased (0.066971 --> 0.063739).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0613193
	speed: 0.0376s/iter; left time: 778.7144s
	iters: 200, epoch: 9 | loss: 0.0555061
	speed: 0.0194s/iter; left time: 399.3243s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0582117 Vali Loss: 0.0640913 Test Loss: 0.0660351
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0564618
	speed: 0.0343s/iter; left time: 701.3254s
	iters: 200, epoch: 10 | loss: 0.0569139
	speed: 0.0157s/iter; left time: 319.6689s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0570274 Vali Loss: 0.0628751 Test Loss: 0.0648090
Validation loss decreased (0.063739 --> 0.062875).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0547675
	speed: 0.0329s/iter; left time: 665.4400s
	iters: 200, epoch: 11 | loss: 0.0522877
	speed: 0.0181s/iter; left time: 364.4495s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.24s
Steps: 226 | Train Loss: 0.0563346 Vali Loss: 0.0616423 Test Loss: 0.0636703
Validation loss decreased (0.062875 --> 0.061642).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0635433
	speed: 0.0306s/iter; left time: 612.2893s
	iters: 200, epoch: 12 | loss: 0.0654986
	speed: 0.0203s/iter; left time: 403.5458s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.18s
Steps: 226 | Train Loss: 0.0555374 Vali Loss: 0.0614510 Test Loss: 0.0635653
Validation loss decreased (0.061642 --> 0.061451).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0531383
	speed: 0.0375s/iter; left time: 742.8981s
	iters: 200, epoch: 13 | loss: 0.0553830
	speed: 0.0205s/iter; left time: 404.0895s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.93s
Steps: 226 | Train Loss: 0.0548404 Vali Loss: 0.0604893 Test Loss: 0.0627076
Validation loss decreased (0.061451 --> 0.060489).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0534457
	speed: 0.0387s/iter; left time: 757.3095s
	iters: 200, epoch: 14 | loss: 0.0527696
	speed: 0.0148s/iter; left time: 288.4390s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0542413 Vali Loss: 0.0604573 Test Loss: 0.0628189
Validation loss decreased (0.060489 --> 0.060457).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0518984
	speed: 0.0321s/iter; left time: 621.0095s
	iters: 200, epoch: 15 | loss: 0.0516676
	speed: 0.0169s/iter; left time: 324.2943s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.06s
Steps: 226 | Train Loss: 0.0537804 Vali Loss: 0.0600585 Test Loss: 0.0623806
Validation loss decreased (0.060457 --> 0.060059).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0550333
	speed: 0.0327s/iter; left time: 625.8643s
	iters: 200, epoch: 16 | loss: 0.0510157
	speed: 0.0168s/iter; left time: 318.7440s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.86s
Steps: 226 | Train Loss: 0.0535094 Vali Loss: 0.0602220 Test Loss: 0.0625936
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0523797
	speed: 0.0357s/iter; left time: 674.3092s
	iters: 200, epoch: 17 | loss: 0.0531689
	speed: 0.0221s/iter; left time: 414.3207s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.14s
Steps: 226 | Train Loss: 0.0532145 Vali Loss: 0.0605116 Test Loss: 0.0627661
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0516262
	speed: 0.0306s/iter; left time: 570.1852s
	iters: 200, epoch: 18 | loss: 0.0522057
	speed: 0.0132s/iter; left time: 245.0238s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.25s
Steps: 226 | Train Loss: 0.0530755 Vali Loss: 0.0596637 Test Loss: 0.0620338
Validation loss decreased (0.060059 --> 0.059664).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0540840
	speed: 0.0358s/iter; left time: 660.1307s
	iters: 200, epoch: 19 | loss: 0.0570081
	speed: 0.0213s/iter; left time: 390.4862s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0527678 Vali Loss: 0.0602670 Test Loss: 0.0627092
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0530464
	speed: 0.0343s/iter; left time: 625.0790s
	iters: 200, epoch: 20 | loss: 0.0567837
	speed: 0.0123s/iter; left time: 222.9978s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.42s
Steps: 226 | Train Loss: 0.0526713 Vali Loss: 0.0596454 Test Loss: 0.0620650
Validation loss decreased (0.059664 --> 0.059645).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0499494
	speed: 0.0331s/iter; left time: 595.3982s
	iters: 200, epoch: 21 | loss: 0.0520596
	speed: 0.0243s/iter; left time: 434.1204s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.08s
Steps: 226 | Train Loss: 0.0523840 Vali Loss: 0.0598361 Test Loss: 0.0620769
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0509677
	speed: 0.0362s/iter; left time: 642.1720s
	iters: 200, epoch: 22 | loss: 0.0528032
	speed: 0.0182s/iter; left time: 321.4773s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0524401 Vali Loss: 0.0595239 Test Loss: 0.0619001
Validation loss decreased (0.059645 --> 0.059524).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0528261
	speed: 0.0317s/iter; left time: 555.8472s
	iters: 200, epoch: 23 | loss: 0.0492108
	speed: 0.0165s/iter; left time: 288.0443s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.07s
Steps: 226 | Train Loss: 0.0522637 Vali Loss: 0.0590840 Test Loss: 0.0614077
Validation loss decreased (0.059524 --> 0.059084).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0518252
	speed: 0.0338s/iter; left time: 585.2626s
	iters: 200, epoch: 24 | loss: 0.0523993
	speed: 0.0167s/iter; left time: 286.6116s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0520737 Vali Loss: 0.0589433 Test Loss: 0.0612480
Validation loss decreased (0.059084 --> 0.058943).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0526683
	speed: 0.0354s/iter; left time: 605.1103s
	iters: 200, epoch: 25 | loss: 0.0541010
	speed: 0.0204s/iter; left time: 347.0423s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.81s
Steps: 226 | Train Loss: 0.0521598 Vali Loss: 0.0588813 Test Loss: 0.0613570
Validation loss decreased (0.058943 --> 0.058881).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0520070
	speed: 0.0275s/iter; left time: 463.4306s
	iters: 200, epoch: 26 | loss: 0.0532121
	speed: 0.0095s/iter; left time: 159.4862s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:02.47s
Steps: 226 | Train Loss: 0.0518301 Vali Loss: 0.0587287 Test Loss: 0.0611357
Validation loss decreased (0.058881 --> 0.058729).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0526764
	speed: 0.0315s/iter; left time: 523.8758s
	iters: 200, epoch: 27 | loss: 0.0514687
	speed: 0.0152s/iter; left time: 250.7870s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0517552 Vali Loss: 0.0590239 Test Loss: 0.0614569
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0513778
	speed: 0.0345s/iter; left time: 566.2563s
	iters: 200, epoch: 28 | loss: 0.0509993
	speed: 0.0164s/iter; left time: 267.4967s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.18s
Steps: 226 | Train Loss: 0.0516570 Vali Loss: 0.0591060 Test Loss: 0.0615547
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0525079
	speed: 0.0268s/iter; left time: 433.5700s
	iters: 200, epoch: 29 | loss: 0.0533223
	speed: 0.0183s/iter; left time: 294.8776s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0516441 Vali Loss: 0.0588266 Test Loss: 0.0614746
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0481990
	speed: 0.0345s/iter; left time: 549.9548s
	iters: 200, epoch: 30 | loss: 0.0526182
	speed: 0.0192s/iter; left time: 304.5449s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.43s
Steps: 226 | Train Loss: 0.0515156 Vali Loss: 0.0585467 Test Loss: 0.0610625
Validation loss decreased (0.058729 --> 0.058547).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0509937
	speed: 0.0321s/iter; left time: 504.5547s
	iters: 200, epoch: 31 | loss: 0.0554018
	speed: 0.0141s/iter; left time: 220.0221s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.51s
Steps: 226 | Train Loss: 0.0514165 Vali Loss: 0.0584982 Test Loss: 0.0609978
Validation loss decreased (0.058547 --> 0.058498).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0521961
	speed: 0.0336s/iter; left time: 520.0480s
	iters: 200, epoch: 32 | loss: 0.0502925
	speed: 0.0181s/iter; left time: 279.3863s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0514829 Vali Loss: 0.0585121 Test Loss: 0.0609906
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0542395
	speed: 0.0322s/iter; left time: 491.2185s
	iters: 200, epoch: 33 | loss: 0.0552315
	speed: 0.0162s/iter; left time: 246.0203s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0513255 Vali Loss: 0.0585441 Test Loss: 0.0610287
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0502087
	speed: 0.0259s/iter; left time: 389.3056s
	iters: 200, epoch: 34 | loss: 0.0526543
	speed: 0.0109s/iter; left time: 163.4999s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:02.65s
Steps: 226 | Train Loss: 0.0512074 Vali Loss: 0.0585198 Test Loss: 0.0610669
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0515986
	speed: 0.0253s/iter; left time: 374.6177s
	iters: 200, epoch: 35 | loss: 0.0516961
	speed: 0.0111s/iter; left time: 163.1161s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:02.71s
Steps: 226 | Train Loss: 0.0512349 Vali Loss: 0.0588582 Test Loss: 0.0614055
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0545352
	speed: 0.0325s/iter; left time: 474.5437s
	iters: 200, epoch: 36 | loss: 0.0521886
	speed: 0.0149s/iter; left time: 215.6857s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.89s
Steps: 226 | Train Loss: 0.0511284 Vali Loss: 0.0586213 Test Loss: 0.0610915
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0492245
	speed: 0.0320s/iter; left time: 460.3118s
	iters: 200, epoch: 37 | loss: 0.0546065
	speed: 0.0187s/iter; left time: 266.2676s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0512189 Vali Loss: 0.0586420 Test Loss: 0.0611143
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0489465
	speed: 0.0339s/iter; left time: 479.8878s
	iters: 200, epoch: 38 | loss: 0.0510282
	speed: 0.0204s/iter; left time: 286.3833s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.52s
Steps: 226 | Train Loss: 0.0512186 Vali Loss: 0.0585996 Test Loss: 0.0611576
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0521461
	speed: 0.0336s/iter; left time: 467.2052s
	iters: 200, epoch: 39 | loss: 0.0486002
	speed: 0.0170s/iter; left time: 234.5433s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0512181 Vali Loss: 0.0583023 Test Loss: 0.0607115
Validation loss decreased (0.058498 --> 0.058302).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0483637
	speed: 0.0304s/iter; left time: 415.9153s
	iters: 200, epoch: 40 | loss: 0.0534848
	speed: 0.0139s/iter; left time: 189.5062s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.32s
Steps: 226 | Train Loss: 0.0511078 Vali Loss: 0.0584909 Test Loss: 0.0609967
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0510957
	speed: 0.0267s/iter; left time: 359.9818s
	iters: 200, epoch: 41 | loss: 0.0504879
	speed: 0.0123s/iter; left time: 164.7209s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:02.94s
Steps: 226 | Train Loss: 0.0512328 Vali Loss: 0.0588054 Test Loss: 0.0613718
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0496044
	speed: 0.0273s/iter; left time: 360.8408s
	iters: 200, epoch: 42 | loss: 0.0513230
	speed: 0.0137s/iter; left time: 180.0347s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.23s
Steps: 226 | Train Loss: 0.0509708 Vali Loss: 0.0584022 Test Loss: 0.0609477
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0525000
	speed: 0.0279s/iter; left time: 362.9609s
	iters: 200, epoch: 43 | loss: 0.0508434
	speed: 0.0125s/iter; left time: 161.1673s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.36s
Steps: 226 | Train Loss: 0.0512291 Vali Loss: 0.0583417 Test Loss: 0.0607665
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0548755
	speed: 0.0337s/iter; left time: 430.8043s
	iters: 200, epoch: 44 | loss: 0.0522109
	speed: 0.0174s/iter; left time: 221.2122s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0510478 Vali Loss: 0.0582927 Test Loss: 0.0607605
Validation loss decreased (0.058302 --> 0.058293).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0506126
	speed: 0.0325s/iter; left time: 407.9411s
	iters: 200, epoch: 45 | loss: 0.0528465
	speed: 0.0181s/iter; left time: 226.0655s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.38s
Steps: 226 | Train Loss: 0.0512065 Vali Loss: 0.0584716 Test Loss: 0.0607955
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0543340
	speed: 0.0289s/iter; left time: 356.3160s
	iters: 200, epoch: 46 | loss: 0.0472873
	speed: 0.0111s/iter; left time: 135.3325s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:02.82s
Steps: 226 | Train Loss: 0.0511917 Vali Loss: 0.0584659 Test Loss: 0.0609901
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0537727
	speed: 0.0357s/iter; left time: 432.1095s
	iters: 200, epoch: 47 | loss: 0.0553661
	speed: 0.0211s/iter; left time: 252.9778s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0511310 Vali Loss: 0.0588045 Test Loss: 0.0614261
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0514362
	speed: 0.0390s/iter; left time: 463.5479s
	iters: 200, epoch: 48 | loss: 0.0472045
	speed: 0.0208s/iter; left time: 244.8104s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.99s
Steps: 226 | Train Loss: 0.0510057 Vali Loss: 0.0584156 Test Loss: 0.0608528
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0496042
	speed: 0.0378s/iter; left time: 440.3898s
	iters: 200, epoch: 49 | loss: 0.0499088
	speed: 0.0191s/iter; left time: 220.2751s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.71s
Steps: 226 | Train Loss: 0.0511481 Vali Loss: 0.0587064 Test Loss: 0.0612833
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0537619
	speed: 0.0347s/iter; left time: 396.2178s
	iters: 200, epoch: 50 | loss: 0.0525173
	speed: 0.0178s/iter; left time: 202.0372s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.33s
Steps: 226 | Train Loss: 0.0510573 Vali Loss: 0.0584213 Test Loss: 0.0609016
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0498492
	speed: 0.0336s/iter; left time: 375.9466s
	iters: 200, epoch: 51 | loss: 0.0518584
	speed: 0.0176s/iter; left time: 195.3822s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.17s
Steps: 226 | Train Loss: 0.0510924 Vali Loss: 0.0582117 Test Loss: 0.0606907
Validation loss decreased (0.058293 --> 0.058212).  Saving model ...
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0508633
	speed: 0.0335s/iter; left time: 367.6509s
	iters: 200, epoch: 52 | loss: 0.0550103
	speed: 0.0153s/iter; left time: 166.6187s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0509129 Vali Loss: 0.0581993 Test Loss: 0.0607614
Validation loss decreased (0.058212 --> 0.058199).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0480261
	speed: 0.0354s/iter; left time: 380.1742s
	iters: 200, epoch: 53 | loss: 0.0512180
	speed: 0.0135s/iter; left time: 143.6080s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.91s
Steps: 226 | Train Loss: 0.0509997 Vali Loss: 0.0583812 Test Loss: 0.0609259
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0531948
	speed: 0.0275s/iter; left time: 289.6032s
	iters: 200, epoch: 54 | loss: 0.0474615
	speed: 0.0152s/iter; left time: 158.6137s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.32s
Steps: 226 | Train Loss: 0.0509769 Vali Loss: 0.0583499 Test Loss: 0.0608505
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0507050
	speed: 0.0330s/iter; left time: 339.8780s
	iters: 200, epoch: 55 | loss: 0.0514766
	speed: 0.0191s/iter; left time: 194.6330s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.39s
Steps: 226 | Train Loss: 0.0510671 Vali Loss: 0.0582356 Test Loss: 0.0607276
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0516714
	speed: 0.0325s/iter; left time: 327.3084s
	iters: 200, epoch: 56 | loss: 0.0518651
	speed: 0.0148s/iter; left time: 147.1997s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:03.70s
Steps: 226 | Train Loss: 0.0510166 Vali Loss: 0.0582356 Test Loss: 0.0607591
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0489705
	speed: 0.0337s/iter; left time: 331.6164s
	iters: 200, epoch: 57 | loss: 0.0528853
	speed: 0.0169s/iter; left time: 164.8098s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0509707 Vali Loss: 0.0582195 Test Loss: 0.0607423
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0502746
	speed: 0.0344s/iter; left time: 330.6800s
	iters: 200, epoch: 58 | loss: 0.0522595
	speed: 0.0161s/iter; left time: 152.8633s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0511142 Vali Loss: 0.0584232 Test Loss: 0.0608961
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0509823
	speed: 0.0321s/iter; left time: 301.4973s
	iters: 200, epoch: 59 | loss: 0.0486975
	speed: 0.0173s/iter; left time: 160.6202s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.09s
Steps: 226 | Train Loss: 0.0508444 Vali Loss: 0.0588405 Test Loss: 0.0614654
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0516023
	speed: 0.0349s/iter; left time: 319.4895s
	iters: 200, epoch: 60 | loss: 0.0504437
	speed: 0.0185s/iter; left time: 167.3402s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.51s
Steps: 226 | Train Loss: 0.0511295 Vali Loss: 0.0581398 Test Loss: 0.0605930
Validation loss decreased (0.058199 --> 0.058140).  Saving model ...
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0520362
	speed: 0.0321s/iter; left time: 287.2443s
	iters: 200, epoch: 61 | loss: 0.0556048
	speed: 0.0149s/iter; left time: 132.1537s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:03.60s
Steps: 226 | Train Loss: 0.0510963 Vali Loss: 0.0583216 Test Loss: 0.0608756
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0489466
	speed: 0.0308s/iter; left time: 268.6907s
	iters: 200, epoch: 62 | loss: 0.0509101
	speed: 0.0167s/iter; left time: 143.5892s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:03.90s
Steps: 226 | Train Loss: 0.0509727 Vali Loss: 0.0582650 Test Loss: 0.0607129
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0520241
	speed: 0.0300s/iter; left time: 254.4145s
	iters: 200, epoch: 63 | loss: 0.0503084
	speed: 0.0165s/iter; left time: 138.0674s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0510012 Vali Loss: 0.0585479 Test Loss: 0.0611012
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0499376
	speed: 0.0364s/iter; left time: 301.1208s
	iters: 200, epoch: 64 | loss: 0.0512204
	speed: 0.0198s/iter; left time: 161.5001s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.78s
Steps: 226 | Train Loss: 0.0509128 Vali Loss: 0.0585969 Test Loss: 0.0610523
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0492525
	speed: 0.0351s/iter; left time: 281.9243s
	iters: 200, epoch: 65 | loss: 0.0499918
	speed: 0.0154s/iter; left time: 122.4497s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0509866 Vali Loss: 0.0582172 Test Loss: 0.0607015
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0500380
	speed: 0.0343s/iter; left time: 267.8132s
	iters: 200, epoch: 66 | loss: 0.0492308
	speed: 0.0129s/iter; left time: 99.2709s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:03.58s
Steps: 226 | Train Loss: 0.0509230 Vali Loss: 0.0582179 Test Loss: 0.0606962
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0567633
	speed: 0.0309s/iter; left time: 234.0709s
	iters: 200, epoch: 67 | loss: 0.0497529
	speed: 0.0165s/iter; left time: 123.5086s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0509263 Vali Loss: 0.0583092 Test Loss: 0.0607846
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0494144
	speed: 0.0312s/iter; left time: 229.9635s
	iters: 200, epoch: 68 | loss: 0.0522436
	speed: 0.0165s/iter; left time: 119.6559s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0509374 Vali Loss: 0.0584095 Test Loss: 0.0608217
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0530711
	speed: 0.0322s/iter; left time: 229.7920s
	iters: 200, epoch: 69 | loss: 0.0486707
	speed: 0.0140s/iter; left time: 98.2286s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:03.60s
Steps: 226 | Train Loss: 0.0508935 Vali Loss: 0.0582418 Test Loss: 0.0607684
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0478494
	speed: 0.0312s/iter; left time: 215.1662s
	iters: 200, epoch: 70 | loss: 0.0519286
	speed: 0.0173s/iter; left time: 117.4388s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0509530 Vali Loss: 0.0583988 Test Loss: 0.0609481
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011059106327593327, rmse:0.10516228526830673, mae:0.06059299036860466, rse:0.40571320056915283
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2416628
	speed: 0.0195s/iter; left time: 439.8132s
	iters: 200, epoch: 1 | loss: 0.2118645
	speed: 0.0191s/iter; left time: 426.9475s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.2365767 Vali Loss: 0.1752155 Test Loss: 0.1818404
Validation loss decreased (inf --> 0.175215).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1395827
	speed: 0.0319s/iter; left time: 710.5907s
	iters: 200, epoch: 2 | loss: 0.1041168
	speed: 0.0176s/iter; left time: 389.7896s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.01s
Steps: 226 | Train Loss: 0.1377829 Vali Loss: 0.0912523 Test Loss: 0.0981285
Validation loss decreased (0.175215 --> 0.091252).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0868506
	speed: 0.0353s/iter; left time: 777.5708s
	iters: 200, epoch: 3 | loss: 0.0817878
	speed: 0.0188s/iter; left time: 411.9475s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.41s
Steps: 226 | Train Loss: 0.0857371 Vali Loss: 0.0796753 Test Loss: 0.0823581
Validation loss decreased (0.091252 --> 0.079675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0767839
	speed: 0.0342s/iter; left time: 747.3954s
	iters: 200, epoch: 4 | loss: 0.0726637
	speed: 0.0171s/iter; left time: 371.6067s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.13s
Steps: 226 | Train Loss: 0.0733852 Vali Loss: 0.0716293 Test Loss: 0.0714761
Validation loss decreased (0.079675 --> 0.071629).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0654529
	speed: 0.0325s/iter; left time: 701.3059s
	iters: 200, epoch: 5 | loss: 0.0700655
	speed: 0.0152s/iter; left time: 325.7432s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.65s
Steps: 226 | Train Loss: 0.0672182 Vali Loss: 0.0680346 Test Loss: 0.0680098
Validation loss decreased (0.071629 --> 0.068035).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0712112
	speed: 0.0335s/iter; left time: 716.6855s
	iters: 200, epoch: 6 | loss: 0.0635504
	speed: 0.0185s/iter; left time: 394.1273s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0631633 Vali Loss: 0.0652654 Test Loss: 0.0669694
Validation loss decreased (0.068035 --> 0.065265).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0623794
	speed: 0.0332s/iter; left time: 702.2844s
	iters: 200, epoch: 7 | loss: 0.0575420
	speed: 0.0150s/iter; left time: 315.7085s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0606888 Vali Loss: 0.0636692 Test Loss: 0.0657486
Validation loss decreased (0.065265 --> 0.063669).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0561675
	speed: 0.0312s/iter; left time: 652.1613s
	iters: 200, epoch: 8 | loss: 0.0559797
	speed: 0.0140s/iter; left time: 292.2053s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.53s
Steps: 226 | Train Loss: 0.0587371 Vali Loss: 0.0633773 Test Loss: 0.0654466
Validation loss decreased (0.063669 --> 0.063377).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0564218
	speed: 0.0360s/iter; left time: 745.4763s
	iters: 200, epoch: 9 | loss: 0.0600520
	speed: 0.0162s/iter; left time: 332.6574s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.24s
Steps: 226 | Train Loss: 0.0578731 Vali Loss: 0.0627705 Test Loss: 0.0648424
Validation loss decreased (0.063377 --> 0.062771).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0573411
	speed: 0.0265s/iter; left time: 541.8748s
	iters: 200, epoch: 10 | loss: 0.0585905
	speed: 0.0125s/iter; left time: 255.5771s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.03s
Steps: 226 | Train Loss: 0.0567742 Vali Loss: 0.0621514 Test Loss: 0.0644379
Validation loss decreased (0.062771 --> 0.062151).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0559383
	speed: 0.0366s/iter; left time: 741.4936s
	iters: 200, epoch: 11 | loss: 0.0565468
	speed: 0.0157s/iter; left time: 316.0475s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.15s
Steps: 226 | Train Loss: 0.0557982 Vali Loss: 0.0619139 Test Loss: 0.0639982
Validation loss decreased (0.062151 --> 0.061914).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0525815
	speed: 0.0317s/iter; left time: 635.3405s
	iters: 200, epoch: 12 | loss: 0.0535919
	speed: 0.0132s/iter; left time: 263.1438s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.40s
Steps: 226 | Train Loss: 0.0552507 Vali Loss: 0.0611877 Test Loss: 0.0635318
Validation loss decreased (0.061914 --> 0.061188).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0581328
	speed: 0.0310s/iter; left time: 613.7022s
	iters: 200, epoch: 13 | loss: 0.0549002
	speed: 0.0152s/iter; left time: 299.6868s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.84s
Steps: 226 | Train Loss: 0.0547234 Vali Loss: 0.0615271 Test Loss: 0.0636993
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0568595
	speed: 0.0320s/iter; left time: 625.4121s
	iters: 200, epoch: 14 | loss: 0.0548544
	speed: 0.0149s/iter; left time: 289.9866s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0543082 Vali Loss: 0.0612200 Test Loss: 0.0635789
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0548684
	speed: 0.0330s/iter; left time: 637.8120s
	iters: 200, epoch: 15 | loss: 0.0530043
	speed: 0.0170s/iter; left time: 326.7457s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0537783 Vali Loss: 0.0612516 Test Loss: 0.0636767
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0521529
	speed: 0.0320s/iter; left time: 611.2286s
	iters: 200, epoch: 16 | loss: 0.0506460
	speed: 0.0168s/iter; left time: 320.1469s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.90s
Steps: 226 | Train Loss: 0.0537510 Vali Loss: 0.0605211 Test Loss: 0.0629692
Validation loss decreased (0.061188 --> 0.060521).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0543273
	speed: 0.0339s/iter; left time: 640.3099s
	iters: 200, epoch: 17 | loss: 0.0502027
	speed: 0.0179s/iter; left time: 335.7044s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0531656 Vali Loss: 0.0603622 Test Loss: 0.0628506
Validation loss decreased (0.060521 --> 0.060362).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0546218
	speed: 0.0347s/iter; left time: 647.7130s
	iters: 200, epoch: 18 | loss: 0.0563045
	speed: 0.0210s/iter; left time: 389.2235s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.56s
Steps: 226 | Train Loss: 0.0531353 Vali Loss: 0.0597555 Test Loss: 0.0621679
Validation loss decreased (0.060362 --> 0.059756).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0578719
	speed: 0.0311s/iter; left time: 573.5929s
	iters: 200, epoch: 19 | loss: 0.0559273
	speed: 0.0153s/iter; left time: 279.5991s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.65s
Steps: 226 | Train Loss: 0.0529508 Vali Loss: 0.0597700 Test Loss: 0.0623024
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0500620
	speed: 0.0334s/iter; left time: 607.8282s
	iters: 200, epoch: 20 | loss: 0.0510834
	speed: 0.0164s/iter; left time: 297.0421s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.00s
Steps: 226 | Train Loss: 0.0527228 Vali Loss: 0.0598549 Test Loss: 0.0622901
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0518224
	speed: 0.0326s/iter; left time: 585.3250s
	iters: 200, epoch: 21 | loss: 0.0519954
	speed: 0.0174s/iter; left time: 310.3797s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.17s
Steps: 226 | Train Loss: 0.0524627 Vali Loss: 0.0598198 Test Loss: 0.0622270
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0520502
	speed: 0.0311s/iter; left time: 552.6466s
	iters: 200, epoch: 22 | loss: 0.0541251
	speed: 0.0203s/iter; left time: 357.6050s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0524199 Vali Loss: 0.0601374 Test Loss: 0.0625613
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0513092
	speed: 0.0337s/iter; left time: 589.8545s
	iters: 200, epoch: 23 | loss: 0.0516593
	speed: 0.0156s/iter; left time: 271.5375s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.86s
Steps: 226 | Train Loss: 0.0523227 Vali Loss: 0.0598450 Test Loss: 0.0623014
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0510257
	speed: 0.0322s/iter; left time: 557.2097s
	iters: 200, epoch: 24 | loss: 0.0487331
	speed: 0.0170s/iter; left time: 291.6933s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.07s
Steps: 226 | Train Loss: 0.0521394 Vali Loss: 0.0594246 Test Loss: 0.0619224
Validation loss decreased (0.059756 --> 0.059425).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0467195
	speed: 0.0362s/iter; left time: 617.9581s
	iters: 200, epoch: 25 | loss: 0.0519570
	speed: 0.0179s/iter; left time: 304.5729s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.33s
Steps: 226 | Train Loss: 0.0519435 Vali Loss: 0.0593750 Test Loss: 0.0619810
Validation loss decreased (0.059425 --> 0.059375).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0524631
	speed: 0.0318s/iter; left time: 535.6440s
	iters: 200, epoch: 26 | loss: 0.0534046
	speed: 0.0149s/iter; left time: 249.9460s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.59s
Steps: 226 | Train Loss: 0.0518191 Vali Loss: 0.0591756 Test Loss: 0.0617106
Validation loss decreased (0.059375 --> 0.059176).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0542041
	speed: 0.0343s/iter; left time: 569.7595s
	iters: 200, epoch: 27 | loss: 0.0519935
	speed: 0.0195s/iter; left time: 321.6117s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.48s
Steps: 226 | Train Loss: 0.0519694 Vali Loss: 0.0597937 Test Loss: 0.0622555
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0515420
	speed: 0.0366s/iter; left time: 600.8277s
	iters: 200, epoch: 28 | loss: 0.0502045
	speed: 0.0205s/iter; left time: 334.1975s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0521151 Vali Loss: 0.0595430 Test Loss: 0.0620863
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0641427
	speed: 0.0351s/iter; left time: 568.1361s
	iters: 200, epoch: 29 | loss: 0.0514867
	speed: 0.0184s/iter; left time: 296.3259s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0518454 Vali Loss: 0.0592493 Test Loss: 0.0618645
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0513309
	speed: 0.0326s/iter; left time: 520.3928s
	iters: 200, epoch: 30 | loss: 0.0528735
	speed: 0.0147s/iter; left time: 232.6318s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.78s
Steps: 226 | Train Loss: 0.0516423 Vali Loss: 0.0591638 Test Loss: 0.0616811
Validation loss decreased (0.059176 --> 0.059164).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0508543
	speed: 0.0327s/iter; left time: 513.8776s
	iters: 200, epoch: 31 | loss: 0.0532794
	speed: 0.0143s/iter; left time: 224.1262s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.60s
Steps: 226 | Train Loss: 0.0515427 Vali Loss: 0.0593265 Test Loss: 0.0617769
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0535211
	speed: 0.0310s/iter; left time: 480.6860s
	iters: 200, epoch: 32 | loss: 0.0515713
	speed: 0.0134s/iter; left time: 206.3787s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0515884 Vali Loss: 0.0592297 Test Loss: 0.0616450
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0506216
	speed: 0.0376s/iter; left time: 574.4233s
	iters: 200, epoch: 33 | loss: 0.0552973
	speed: 0.0179s/iter; left time: 270.9593s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.45s
Steps: 226 | Train Loss: 0.0514787 Vali Loss: 0.0593651 Test Loss: 0.0618762
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0500266
	speed: 0.0367s/iter; left time: 551.4485s
	iters: 200, epoch: 34 | loss: 0.0525294
	speed: 0.0170s/iter; left time: 254.1015s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0515054 Vali Loss: 0.0591138 Test Loss: 0.0617489
Validation loss decreased (0.059164 --> 0.059114).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0515080
	speed: 0.0322s/iter; left time: 477.3783s
	iters: 200, epoch: 35 | loss: 0.0520318
	speed: 0.0152s/iter; left time: 223.7932s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0514527 Vali Loss: 0.0590694 Test Loss: 0.0616565
Validation loss decreased (0.059114 --> 0.059069).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0530447
	speed: 0.0350s/iter; left time: 511.2124s
	iters: 200, epoch: 36 | loss: 0.0504718
	speed: 0.0111s/iter; left time: 161.0108s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.69s
Steps: 226 | Train Loss: 0.0514593 Vali Loss: 0.0591461 Test Loss: 0.0618174
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0502356
	speed: 0.0359s/iter; left time: 516.0171s
	iters: 200, epoch: 37 | loss: 0.0500012
	speed: 0.0125s/iter; left time: 177.7776s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.67s
Steps: 226 | Train Loss: 0.0514596 Vali Loss: 0.0598087 Test Loss: 0.0623762
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0530377
	speed: 0.0318s/iter; left time: 449.4951s
	iters: 200, epoch: 38 | loss: 0.0490269
	speed: 0.0173s/iter; left time: 242.5055s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0513402 Vali Loss: 0.0593734 Test Loss: 0.0619947
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0510635
	speed: 0.0339s/iter; left time: 471.4628s
	iters: 200, epoch: 39 | loss: 0.0519244
	speed: 0.0181s/iter; left time: 249.9198s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.14s
Steps: 226 | Train Loss: 0.0514132 Vali Loss: 0.0592859 Test Loss: 0.0618880
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0479976
	speed: 0.0329s/iter; left time: 449.6407s
	iters: 200, epoch: 40 | loss: 0.0587389
	speed: 0.0200s/iter; left time: 272.2341s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.57s
Steps: 226 | Train Loss: 0.0512591 Vali Loss: 0.0589257 Test Loss: 0.0614904
Validation loss decreased (0.059069 --> 0.058926).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0499182
	speed: 0.0371s/iter; left time: 499.5009s
	iters: 200, epoch: 41 | loss: 0.0517714
	speed: 0.0175s/iter; left time: 233.3392s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.43s
Steps: 226 | Train Loss: 0.0513970 Vali Loss: 0.0589165 Test Loss: 0.0615032
Validation loss decreased (0.058926 --> 0.058916).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0555581
	speed: 0.0379s/iter; left time: 501.0847s
	iters: 200, epoch: 42 | loss: 0.0493980
	speed: 0.0197s/iter; left time: 259.3494s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.74s
Steps: 226 | Train Loss: 0.0512042 Vali Loss: 0.0592286 Test Loss: 0.0617734
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0499269
	speed: 0.0348s/iter; left time: 453.0064s
	iters: 200, epoch: 43 | loss: 0.0529789
	speed: 0.0143s/iter; left time: 184.0217s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.0513263 Vali Loss: 0.0591241 Test Loss: 0.0616876
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0506182
	speed: 0.0327s/iter; left time: 417.5317s
	iters: 200, epoch: 44 | loss: 0.0491669
	speed: 0.0166s/iter; left time: 210.6603s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.06s
Steps: 226 | Train Loss: 0.0512939 Vali Loss: 0.0588932 Test Loss: 0.0614789
Validation loss decreased (0.058916 --> 0.058893).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0504569
	speed: 0.0394s/iter; left time: 494.2587s
	iters: 200, epoch: 45 | loss: 0.0495079
	speed: 0.0163s/iter; left time: 202.4550s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0511449 Vali Loss: 0.0590043 Test Loss: 0.0615300
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0504148
	speed: 0.0348s/iter; left time: 428.8185s
	iters: 200, epoch: 46 | loss: 0.0546191
	speed: 0.0190s/iter; left time: 232.3433s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.44s
Steps: 226 | Train Loss: 0.0512323 Vali Loss: 0.0593695 Test Loss: 0.0620349
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0528963
	speed: 0.0329s/iter; left time: 397.7923s
	iters: 200, epoch: 47 | loss: 0.0509227
	speed: 0.0156s/iter; left time: 186.7503s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.84s
Steps: 226 | Train Loss: 0.0512757 Vali Loss: 0.0589895 Test Loss: 0.0616225
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0522054
	speed: 0.0310s/iter; left time: 368.2862s
	iters: 200, epoch: 48 | loss: 0.0484653
	speed: 0.0159s/iter; left time: 187.2899s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0512539 Vali Loss: 0.0591156 Test Loss: 0.0617639
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0526090
	speed: 0.0317s/iter; left time: 369.9610s
	iters: 200, epoch: 49 | loss: 0.0553374
	speed: 0.0110s/iter; left time: 126.8650s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.04s
Steps: 226 | Train Loss: 0.0513467 Vali Loss: 0.0589459 Test Loss: 0.0614353
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0502638
	speed: 0.0254s/iter; left time: 290.2524s
	iters: 200, epoch: 50 | loss: 0.0521959
	speed: 0.0111s/iter; left time: 125.3675s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:02.69s
Steps: 226 | Train Loss: 0.0512335 Vali Loss: 0.0592556 Test Loss: 0.0619066
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0534625
	speed: 0.0319s/iter; left time: 356.9499s
	iters: 200, epoch: 51 | loss: 0.0522593
	speed: 0.0171s/iter; left time: 189.6773s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.14s
Steps: 226 | Train Loss: 0.0512247 Vali Loss: 0.0590859 Test Loss: 0.0617177
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0478016
	speed: 0.0334s/iter; left time: 366.3536s
	iters: 200, epoch: 52 | loss: 0.0518351
	speed: 0.0172s/iter; left time: 186.9469s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0513318 Vali Loss: 0.0587435 Test Loss: 0.0613683
Validation loss decreased (0.058893 --> 0.058744).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0524634
	speed: 0.0329s/iter; left time: 353.8793s
	iters: 200, epoch: 53 | loss: 0.0528184
	speed: 0.0142s/iter; left time: 151.0979s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.55s
Steps: 226 | Train Loss: 0.0511697 Vali Loss: 0.0595583 Test Loss: 0.0622298
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0493532
	speed: 0.0340s/iter; left time: 358.2648s
	iters: 200, epoch: 54 | loss: 0.0491158
	speed: 0.0198s/iter; left time: 206.5691s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.58s
Steps: 226 | Train Loss: 0.0512054 Vali Loss: 0.0594513 Test Loss: 0.0620704
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0534966
	speed: 0.0317s/iter; left time: 326.8456s
	iters: 200, epoch: 55 | loss: 0.0487425
	speed: 0.0178s/iter; left time: 181.8711s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:03.96s
Steps: 226 | Train Loss: 0.0513194 Vali Loss: 0.0591265 Test Loss: 0.0616807
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0520311
	speed: 0.0340s/iter; left time: 342.6129s
	iters: 200, epoch: 56 | loss: 0.0511009
	speed: 0.0151s/iter; left time: 150.8292s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0512252 Vali Loss: 0.0588257 Test Loss: 0.0613912
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0501452
	speed: 0.0321s/iter; left time: 316.0024s
	iters: 200, epoch: 57 | loss: 0.0561148
	speed: 0.0171s/iter; left time: 166.5062s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.07s
Steps: 226 | Train Loss: 0.0511195 Vali Loss: 0.0592716 Test Loss: 0.0618494
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0495522
	speed: 0.0329s/iter; left time: 316.4605s
	iters: 200, epoch: 58 | loss: 0.0490600
	speed: 0.0147s/iter; left time: 139.5894s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0510768 Vali Loss: 0.0589688 Test Loss: 0.0614992
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0488771
	speed: 0.0363s/iter; left time: 341.0892s
	iters: 200, epoch: 59 | loss: 0.0531398
	speed: 0.0169s/iter; left time: 157.4804s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0511723 Vali Loss: 0.0590542 Test Loss: 0.0616732
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0536283
	speed: 0.0322s/iter; left time: 295.1166s
	iters: 200, epoch: 60 | loss: 0.0513347
	speed: 0.0142s/iter; left time: 128.3680s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:03.73s
Steps: 226 | Train Loss: 0.0510745 Vali Loss: 0.0591924 Test Loss: 0.0618312
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0511971
	speed: 0.0244s/iter; left time: 218.4595s
	iters: 200, epoch: 61 | loss: 0.0507888
	speed: 0.0096s/iter; left time: 85.1691s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:02.45s
Steps: 226 | Train Loss: 0.0512314 Vali Loss: 0.0591397 Test Loss: 0.0617536
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0488633
	speed: 0.0312s/iter; left time: 272.1085s
	iters: 200, epoch: 62 | loss: 0.0498987
	speed: 0.0168s/iter; left time: 144.4493s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.02s
Steps: 226 | Train Loss: 0.0511543 Vali Loss: 0.0593258 Test Loss: 0.0620149
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01122244168072939, rmse:0.10593602806329727, mae:0.061368297785520554, rse:0.40869826078414917
Intermediate time for FR and pred_len 24: 00h:11m:00.98s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2399536
	speed: 0.0363s/iter; left time: 812.0937s
	iters: 200, epoch: 1 | loss: 0.2218693
	speed: 0.0145s/iter; left time: 323.0161s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.42s
Steps: 225 | Train Loss: 0.2435918 Vali Loss: 0.1775215 Test Loss: 0.1869208
Validation loss decreased (inf --> 0.177521).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1348915
	speed: 0.0315s/iter; left time: 699.4382s
	iters: 200, epoch: 2 | loss: 0.0999899
	speed: 0.0145s/iter; left time: 320.9065s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.1339489 Vali Loss: 0.0989685 Test Loss: 0.1108424
Validation loss decreased (0.177521 --> 0.098968).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0897997
	speed: 0.0331s/iter; left time: 726.4421s
	iters: 200, epoch: 3 | loss: 0.0906458
	speed: 0.0156s/iter; left time: 341.5702s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0907362 Vali Loss: 0.0915546 Test Loss: 0.0976730
Validation loss decreased (0.098968 --> 0.091555).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0803316
	speed: 0.0305s/iter; left time: 663.1096s
	iters: 200, epoch: 4 | loss: 0.0824087
	speed: 0.0145s/iter; left time: 313.0065s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0827918 Vali Loss: 0.0843838 Test Loss: 0.0914720
Validation loss decreased (0.091555 --> 0.084384).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0784377
	speed: 0.0277s/iter; left time: 596.2867s
	iters: 200, epoch: 5 | loss: 0.0759989
	speed: 0.0113s/iter; left time: 242.4197s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:02.79s
Steps: 225 | Train Loss: 0.0780586 Vali Loss: 0.0813468 Test Loss: 0.0897788
Validation loss decreased (0.084384 --> 0.081347).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0739028
	speed: 0.0331s/iter; left time: 703.1759s
	iters: 200, epoch: 6 | loss: 0.0733849
	speed: 0.0156s/iter; left time: 330.5681s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0752780 Vali Loss: 0.0799889 Test Loss: 0.0886891
Validation loss decreased (0.081347 --> 0.079989).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0700873
	speed: 0.0344s/iter; left time: 723.1578s
	iters: 200, epoch: 7 | loss: 0.0707081
	speed: 0.0152s/iter; left time: 319.4689s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.0736288 Vali Loss: 0.0790577 Test Loss: 0.0879290
Validation loss decreased (0.079989 --> 0.079058).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0762281
	speed: 0.0336s/iter; left time: 700.4877s
	iters: 200, epoch: 8 | loss: 0.0738689
	speed: 0.0157s/iter; left time: 324.8281s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0722952 Vali Loss: 0.0787441 Test Loss: 0.0879052
Validation loss decreased (0.079058 --> 0.078744).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0683771
	speed: 0.0326s/iter; left time: 671.2067s
	iters: 200, epoch: 9 | loss: 0.0747857
	speed: 0.0157s/iter; left time: 322.4174s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.0715896 Vali Loss: 0.0774867 Test Loss: 0.0866617
Validation loss decreased (0.078744 --> 0.077487).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0698917
	speed: 0.0368s/iter; left time: 750.1355s
	iters: 200, epoch: 10 | loss: 0.0716846
	speed: 0.0151s/iter; left time: 306.5377s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.0704057 Vali Loss: 0.0769684 Test Loss: 0.0858415
Validation loss decreased (0.077487 --> 0.076968).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0699004
	speed: 0.0326s/iter; left time: 655.9198s
	iters: 200, epoch: 11 | loss: 0.0707201
	speed: 0.0156s/iter; left time: 313.3697s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.0697867 Vali Loss: 0.0764495 Test Loss: 0.0853819
Validation loss decreased (0.076968 --> 0.076450).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0698846
	speed: 0.0332s/iter; left time: 661.8796s
	iters: 200, epoch: 12 | loss: 0.0716245
	speed: 0.0157s/iter; left time: 311.3879s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0691675 Vali Loss: 0.0769113 Test Loss: 0.0856977
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0649242
	speed: 0.0312s/iter; left time: 614.6777s
	iters: 200, epoch: 13 | loss: 0.0703803
	speed: 0.0150s/iter; left time: 293.7334s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.60s
Steps: 225 | Train Loss: 0.0685956 Vali Loss: 0.0758379 Test Loss: 0.0847957
Validation loss decreased (0.076450 --> 0.075838).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0711271
	speed: 0.0341s/iter; left time: 664.7411s
	iters: 200, epoch: 14 | loss: 0.0694447
	speed: 0.0170s/iter; left time: 330.1845s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.07s
Steps: 225 | Train Loss: 0.0680487 Vali Loss: 0.0758935 Test Loss: 0.0846345
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0656746
	speed: 0.0288s/iter; left time: 553.5301s
	iters: 200, epoch: 15 | loss: 0.0668071
	speed: 0.0112s/iter; left time: 214.9501s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:02.85s
Steps: 225 | Train Loss: 0.0678959 Vali Loss: 0.0754225 Test Loss: 0.0840952
Validation loss decreased (0.075838 --> 0.075422).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0693426
	speed: 0.0274s/iter; left time: 520.9245s
	iters: 200, epoch: 16 | loss: 0.0683042
	speed: 0.0113s/iter; left time: 213.9319s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:02.78s
Steps: 225 | Train Loss: 0.0676131 Vali Loss: 0.0754790 Test Loss: 0.0842982
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0665731
	speed: 0.0284s/iter; left time: 533.9705s
	iters: 200, epoch: 17 | loss: 0.0692905
	speed: 0.0128s/iter; left time: 239.3142s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.23s
Steps: 225 | Train Loss: 0.0672391 Vali Loss: 0.0753235 Test Loss: 0.0840408
Validation loss decreased (0.075422 --> 0.075323).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0675017
	speed: 0.0319s/iter; left time: 593.3823s
	iters: 200, epoch: 18 | loss: 0.0680042
	speed: 0.0183s/iter; left time: 337.7477s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.05s
Steps: 225 | Train Loss: 0.0671991 Vali Loss: 0.0752749 Test Loss: 0.0838677
Validation loss decreased (0.075323 --> 0.075275).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0657052
	speed: 0.0343s/iter; left time: 629.8836s
	iters: 200, epoch: 19 | loss: 0.0674223
	speed: 0.0151s/iter; left time: 276.1363s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0668679 Vali Loss: 0.0751044 Test Loss: 0.0839776
Validation loss decreased (0.075275 --> 0.075104).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0669044
	speed: 0.0360s/iter; left time: 653.0866s
	iters: 200, epoch: 20 | loss: 0.0678561
	speed: 0.0193s/iter; left time: 348.3795s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.59s
Steps: 225 | Train Loss: 0.0666958 Vali Loss: 0.0752382 Test Loss: 0.0841614
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0627363
	speed: 0.0349s/iter; left time: 625.5673s
	iters: 200, epoch: 21 | loss: 0.0638758
	speed: 0.0166s/iter; left time: 295.2491s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.14s
Steps: 225 | Train Loss: 0.0664966 Vali Loss: 0.0751106 Test Loss: 0.0842004
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0678066
	speed: 0.0367s/iter; left time: 648.0246s
	iters: 200, epoch: 22 | loss: 0.0707027
	speed: 0.0195s/iter; left time: 342.1192s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0663971 Vali Loss: 0.0750149 Test Loss: 0.0839074
Validation loss decreased (0.075104 --> 0.075015).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0725942
	speed: 0.0332s/iter; left time: 578.7540s
	iters: 200, epoch: 23 | loss: 0.0631115
	speed: 0.0172s/iter; left time: 298.2789s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0662704 Vali Loss: 0.0749497 Test Loss: 0.0838586
Validation loss decreased (0.075015 --> 0.074950).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0666017
	speed: 0.0345s/iter; left time: 593.5369s
	iters: 200, epoch: 24 | loss: 0.0659782
	speed: 0.0193s/iter; left time: 330.6768s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0662504 Vali Loss: 0.0748828 Test Loss: 0.0839017
Validation loss decreased (0.074950 --> 0.074883).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0667289
	speed: 0.0323s/iter; left time: 549.5887s
	iters: 200, epoch: 25 | loss: 0.0662316
	speed: 0.0168s/iter; left time: 283.4324s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0660893 Vali Loss: 0.0747243 Test Loss: 0.0837082
Validation loss decreased (0.074883 --> 0.074724).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0672820
	speed: 0.0301s/iter; left time: 505.6858s
	iters: 200, epoch: 26 | loss: 0.0641873
	speed: 0.0159s/iter; left time: 265.1804s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.54s
Steps: 225 | Train Loss: 0.0661890 Vali Loss: 0.0747570 Test Loss: 0.0837986
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0659174
	speed: 0.0306s/iter; left time: 505.9188s
	iters: 200, epoch: 27 | loss: 0.0678228
	speed: 0.0152s/iter; left time: 250.8148s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0660290 Vali Loss: 0.0749338 Test Loss: 0.0840740
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0658934
	speed: 0.0307s/iter; left time: 501.1573s
	iters: 200, epoch: 28 | loss: 0.0669217
	speed: 0.0159s/iter; left time: 257.6608s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.72s
Steps: 225 | Train Loss: 0.0660034 Vali Loss: 0.0746343 Test Loss: 0.0837211
Validation loss decreased (0.074724 --> 0.074634).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0645059
	speed: 0.0373s/iter; left time: 601.0624s
	iters: 200, epoch: 29 | loss: 0.0661160
	speed: 0.0174s/iter; left time: 278.6871s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0660438 Vali Loss: 0.0746923 Test Loss: 0.0838302
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0647524
	speed: 0.0299s/iter; left time: 474.0192s
	iters: 200, epoch: 30 | loss: 0.0642171
	speed: 0.0097s/iter; left time: 153.5135s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:02.75s
Steps: 225 | Train Loss: 0.0659379 Vali Loss: 0.0747332 Test Loss: 0.0839173
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0647936
	speed: 0.0290s/iter; left time: 454.6078s
	iters: 200, epoch: 31 | loss: 0.0682318
	speed: 0.0148s/iter; left time: 229.9928s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0657921 Vali Loss: 0.0746830 Test Loss: 0.0837747
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0651756
	speed: 0.0287s/iter; left time: 442.2085s
	iters: 200, epoch: 32 | loss: 0.0618787
	speed: 0.0108s/iter; left time: 165.9499s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:02.88s
Steps: 225 | Train Loss: 0.0658708 Vali Loss: 0.0746024 Test Loss: 0.0837288
Validation loss decreased (0.074634 --> 0.074602).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0668168
	speed: 0.0338s/iter; left time: 513.6581s
	iters: 200, epoch: 33 | loss: 0.0633686
	speed: 0.0165s/iter; left time: 249.3568s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0658372 Vali Loss: 0.0745602 Test Loss: 0.0835967
Validation loss decreased (0.074602 --> 0.074560).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0647600
	speed: 0.0316s/iter; left time: 473.0027s
	iters: 200, epoch: 34 | loss: 0.0629268
	speed: 0.0146s/iter; left time: 217.4344s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.60s
Steps: 225 | Train Loss: 0.0657470 Vali Loss: 0.0746374 Test Loss: 0.0837197
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0641729
	speed: 0.0345s/iter; left time: 508.2503s
	iters: 200, epoch: 35 | loss: 0.0617976
	speed: 0.0177s/iter; left time: 259.3231s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0657178 Vali Loss: 0.0746599 Test Loss: 0.0838663
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0682861
	speed: 0.0345s/iter; left time: 501.5188s
	iters: 200, epoch: 36 | loss: 0.0719490
	speed: 0.0200s/iter; left time: 288.2498s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0656840 Vali Loss: 0.0747683 Test Loss: 0.0839771
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0674170
	speed: 0.0365s/iter; left time: 522.0842s
	iters: 200, epoch: 37 | loss: 0.0645799
	speed: 0.0177s/iter; left time: 251.6572s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0657696 Vali Loss: 0.0745763 Test Loss: 0.0837600
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0679446
	speed: 0.0361s/iter; left time: 507.7489s
	iters: 200, epoch: 38 | loss: 0.0619880
	speed: 0.0196s/iter; left time: 273.9043s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0656903 Vali Loss: 0.0745828 Test Loss: 0.0835773
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0635080
	speed: 0.0329s/iter; left time: 456.3189s
	iters: 200, epoch: 39 | loss: 0.0654072
	speed: 0.0167s/iter; left time: 229.4408s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.94s
Steps: 225 | Train Loss: 0.0656889 Vali Loss: 0.0746122 Test Loss: 0.0837281
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0648413
	speed: 0.0350s/iter; left time: 476.7628s
	iters: 200, epoch: 40 | loss: 0.0636021
	speed: 0.0196s/iter; left time: 264.8335s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.54s
Steps: 225 | Train Loss: 0.0654821 Vali Loss: 0.0746146 Test Loss: 0.0837951
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0624976
	speed: 0.0360s/iter; left time: 482.8451s
	iters: 200, epoch: 41 | loss: 0.0613499
	speed: 0.0168s/iter; left time: 224.0651s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.20s
Steps: 225 | Train Loss: 0.0655606 Vali Loss: 0.0745522 Test Loss: 0.0837003
Validation loss decreased (0.074560 --> 0.074552).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0655213
	speed: 0.0311s/iter; left time: 409.8903s
	iters: 200, epoch: 42 | loss: 0.0619614
	speed: 0.0156s/iter; left time: 204.0940s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0655404 Vali Loss: 0.0746655 Test Loss: 0.0837635
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0676364
	speed: 0.0353s/iter; left time: 457.7237s
	iters: 200, epoch: 43 | loss: 0.0665837
	speed: 0.0173s/iter; left time: 222.4355s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0656253 Vali Loss: 0.0745803 Test Loss: 0.0836900
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0677450
	speed: 0.0371s/iter; left time: 472.1259s
	iters: 200, epoch: 44 | loss: 0.0624176
	speed: 0.0208s/iter; left time: 263.1703s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.74s
Steps: 225 | Train Loss: 0.0656435 Vali Loss: 0.0746780 Test Loss: 0.0839206
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0664974
	speed: 0.0377s/iter; left time: 471.5338s
	iters: 200, epoch: 45 | loss: 0.0629244
	speed: 0.0173s/iter; left time: 214.9845s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0655669 Vali Loss: 0.0746178 Test Loss: 0.0837615
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0656827
	speed: 0.0325s/iter; left time: 399.4772s
	iters: 200, epoch: 46 | loss: 0.0656918
	speed: 0.0151s/iter; left time: 184.0868s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.0656163 Vali Loss: 0.0747212 Test Loss: 0.0839002
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0688594
	speed: 0.0355s/iter; left time: 427.6679s
	iters: 200, epoch: 47 | loss: 0.0655751
	speed: 0.0183s/iter; left time: 218.5309s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.0654692 Vali Loss: 0.0745072 Test Loss: 0.0836411
Validation loss decreased (0.074552 --> 0.074507).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0682336
	speed: 0.0370s/iter; left time: 437.2951s
	iters: 200, epoch: 48 | loss: 0.0633480
	speed: 0.0195s/iter; left time: 228.7024s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0656726 Vali Loss: 0.0745180 Test Loss: 0.0836578
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0704546
	speed: 0.0334s/iter; left time: 387.4953s
	iters: 200, epoch: 49 | loss: 0.0642681
	speed: 0.0160s/iter; left time: 184.0881s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0654801 Vali Loss: 0.0745601 Test Loss: 0.0837021
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0658883
	speed: 0.0335s/iter; left time: 381.5052s
	iters: 200, epoch: 50 | loss: 0.0619239
	speed: 0.0176s/iter; left time: 198.9926s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.0655309 Vali Loss: 0.0745200 Test Loss: 0.0836687
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0675842
	speed: 0.0347s/iter; left time: 386.5840s
	iters: 200, epoch: 51 | loss: 0.0630216
	speed: 0.0211s/iter; left time: 233.3742s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.0655235 Vali Loss: 0.0747122 Test Loss: 0.0838947
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0621631
	speed: 0.0323s/iter; left time: 352.7972s
	iters: 200, epoch: 52 | loss: 0.0661019
	speed: 0.0182s/iter; left time: 196.9440s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.11s
Steps: 225 | Train Loss: 0.0655488 Vali Loss: 0.0745604 Test Loss: 0.0837188
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0655467
	speed: 0.0321s/iter; left time: 343.7845s
	iters: 200, epoch: 53 | loss: 0.0644962
	speed: 0.0178s/iter; left time: 188.1939s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0655646 Vali Loss: 0.0746658 Test Loss: 0.0838256
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0677637
	speed: 0.0368s/iter; left time: 385.3133s
	iters: 200, epoch: 54 | loss: 0.0620990
	speed: 0.0190s/iter; left time: 196.7842s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0654664 Vali Loss: 0.0746213 Test Loss: 0.0837417
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0688697
	speed: 0.0337s/iter; left time: 345.6830s
	iters: 200, epoch: 55 | loss: 0.0613465
	speed: 0.0171s/iter; left time: 173.5259s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.0655057 Vali Loss: 0.0746580 Test Loss: 0.0838546
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0621942
	speed: 0.0317s/iter; left time: 317.6353s
	iters: 200, epoch: 56 | loss: 0.0620328
	speed: 0.0152s/iter; left time: 150.7049s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0658393 Vali Loss: 0.0746421 Test Loss: 0.0838695
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0651978
	speed: 0.0325s/iter; left time: 318.5446s
	iters: 200, epoch: 57 | loss: 0.0681412
	speed: 0.0153s/iter; left time: 148.2241s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0654082 Vali Loss: 0.0745729 Test Loss: 0.0837556
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020481519401073456, rmse:0.1431136578321457, mae:0.08364105224609375, rse:0.5536016821861267
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2388178
	speed: 0.0246s/iter; left time: 552.0856s
	iters: 200, epoch: 1 | loss: 0.2182519
	speed: 0.0164s/iter; left time: 365.1656s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.2399724 Vali Loss: 0.1777182 Test Loss: 0.1867836
Validation loss decreased (inf --> 0.177718).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1273558
	speed: 0.0352s/iter; left time: 781.4662s
	iters: 200, epoch: 2 | loss: 0.1026327
	speed: 0.0152s/iter; left time: 336.6227s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.07s
Steps: 225 | Train Loss: 0.1317914 Vali Loss: 0.0993074 Test Loss: 0.1113348
Validation loss decreased (0.177718 --> 0.099307).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0890958
	speed: 0.0372s/iter; left time: 817.6551s
	iters: 200, epoch: 3 | loss: 0.0865826
	speed: 0.0198s/iter; left time: 432.9223s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.67s
Steps: 225 | Train Loss: 0.0907453 Vali Loss: 0.0894003 Test Loss: 0.0954325
Validation loss decreased (0.099307 --> 0.089400).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0838012
	speed: 0.0337s/iter; left time: 732.2815s
	iters: 200, epoch: 4 | loss: 0.0784943
	speed: 0.0180s/iter; left time: 390.0139s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.11s
Steps: 225 | Train Loss: 0.0831156 Vali Loss: 0.0839630 Test Loss: 0.0908817
Validation loss decreased (0.089400 --> 0.083963).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0758482
	speed: 0.0332s/iter; left time: 713.0166s
	iters: 200, epoch: 5 | loss: 0.0736847
	speed: 0.0169s/iter; left time: 361.0933s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0785101 Vali Loss: 0.0816287 Test Loss: 0.0896576
Validation loss decreased (0.083963 --> 0.081629).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0728346
	speed: 0.0359s/iter; left time: 763.0707s
	iters: 200, epoch: 6 | loss: 0.0717377
	speed: 0.0176s/iter; left time: 373.2426s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0757676 Vali Loss: 0.0806589 Test Loss: 0.0891806
Validation loss decreased (0.081629 --> 0.080659).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0755224
	speed: 0.0345s/iter; left time: 727.0654s
	iters: 200, epoch: 7 | loss: 0.0664887
	speed: 0.0150s/iter; left time: 314.8004s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0739093 Vali Loss: 0.0794674 Test Loss: 0.0877857
Validation loss decreased (0.080659 --> 0.079467).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0753219
	speed: 0.0318s/iter; left time: 662.5818s
	iters: 200, epoch: 8 | loss: 0.0710723
	speed: 0.0151s/iter; left time: 312.8399s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.60s
Steps: 225 | Train Loss: 0.0723964 Vali Loss: 0.0791210 Test Loss: 0.0877187
Validation loss decreased (0.079467 --> 0.079121).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0728624
	speed: 0.0377s/iter; left time: 777.1781s
	iters: 200, epoch: 9 | loss: 0.0668347
	speed: 0.0174s/iter; left time: 357.3355s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0715036 Vali Loss: 0.0779304 Test Loss: 0.0869970
Validation loss decreased (0.079121 --> 0.077930).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0699616
	speed: 0.0313s/iter; left time: 637.4537s
	iters: 200, epoch: 10 | loss: 0.0692299
	speed: 0.0143s/iter; left time: 290.7689s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0704371 Vali Loss: 0.0773976 Test Loss: 0.0863333
Validation loss decreased (0.077930 --> 0.077398).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0701377
	speed: 0.0336s/iter; left time: 676.2188s
	iters: 200, epoch: 11 | loss: 0.0711334
	speed: 0.0182s/iter; left time: 364.1332s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.0697987 Vali Loss: 0.0768846 Test Loss: 0.0858211
Validation loss decreased (0.077398 --> 0.076885).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0698014
	speed: 0.0354s/iter; left time: 704.8776s
	iters: 200, epoch: 12 | loss: 0.0695472
	speed: 0.0178s/iter; left time: 352.8105s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0694048 Vali Loss: 0.0766271 Test Loss: 0.0852364
Validation loss decreased (0.076885 --> 0.076627).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0675972
	speed: 0.0365s/iter; left time: 719.3901s
	iters: 200, epoch: 13 | loss: 0.0714289
	speed: 0.0181s/iter; left time: 355.2345s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.0688381 Vali Loss: 0.0768167 Test Loss: 0.0856031
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0700926
	speed: 0.0359s/iter; left time: 698.5357s
	iters: 200, epoch: 14 | loss: 0.0705423
	speed: 0.0179s/iter; left time: 346.5655s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0685697 Vali Loss: 0.0757709 Test Loss: 0.0846112
Validation loss decreased (0.076627 --> 0.075771).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0666968
	speed: 0.0378s/iter; left time: 728.3466s
	iters: 200, epoch: 15 | loss: 0.0667904
	speed: 0.0160s/iter; left time: 306.9164s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0678830 Vali Loss: 0.0756376 Test Loss: 0.0844000
Validation loss decreased (0.075771 --> 0.075638).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0671397
	speed: 0.0373s/iter; left time: 710.1456s
	iters: 200, epoch: 16 | loss: 0.0691180
	speed: 0.0186s/iter; left time: 351.9403s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.0677403 Vali Loss: 0.0755905 Test Loss: 0.0843625
Validation loss decreased (0.075638 --> 0.075590).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0662527
	speed: 0.0380s/iter; left time: 713.6629s
	iters: 200, epoch: 17 | loss: 0.0610230
	speed: 0.0201s/iter; left time: 375.7934s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.76s
Steps: 225 | Train Loss: 0.0675268 Vali Loss: 0.0756874 Test Loss: 0.0843866
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0695783
	speed: 0.0383s/iter; left time: 711.1710s
	iters: 200, epoch: 18 | loss: 0.0691342
	speed: 0.0167s/iter; left time: 309.0759s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0673784 Vali Loss: 0.0758241 Test Loss: 0.0845734
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0719842
	speed: 0.0371s/iter; left time: 681.1131s
	iters: 200, epoch: 19 | loss: 0.0653379
	speed: 0.0168s/iter; left time: 306.2336s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0671919 Vali Loss: 0.0753380 Test Loss: 0.0841991
Validation loss decreased (0.075590 --> 0.075338).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0687822
	speed: 0.0333s/iter; left time: 604.0065s
	iters: 200, epoch: 20 | loss: 0.0619461
	speed: 0.0160s/iter; left time: 287.9467s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0670129 Vali Loss: 0.0753580 Test Loss: 0.0842329
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0677746
	speed: 0.0330s/iter; left time: 591.4132s
	iters: 200, epoch: 21 | loss: 0.0670879
	speed: 0.0152s/iter; left time: 271.2192s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.0669365 Vali Loss: 0.0755064 Test Loss: 0.0842856
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0670374
	speed: 0.0318s/iter; left time: 562.2980s
	iters: 200, epoch: 22 | loss: 0.0655113
	speed: 0.0153s/iter; left time: 269.2998s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0667176 Vali Loss: 0.0750331 Test Loss: 0.0839804
Validation loss decreased (0.075338 --> 0.075033).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0668420
	speed: 0.0343s/iter; left time: 597.7805s
	iters: 200, epoch: 23 | loss: 0.0658703
	speed: 0.0165s/iter; left time: 285.9812s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.07s
Steps: 225 | Train Loss: 0.0665682 Vali Loss: 0.0750212 Test Loss: 0.0839592
Validation loss decreased (0.075033 --> 0.075021).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0648703
	speed: 0.0328s/iter; left time: 564.8329s
	iters: 200, epoch: 24 | loss: 0.0706152
	speed: 0.0151s/iter; left time: 259.0972s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.0663835 Vali Loss: 0.0749902 Test Loss: 0.0838656
Validation loss decreased (0.075021 --> 0.074990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0653138
	speed: 0.0386s/iter; left time: 656.1101s
	iters: 200, epoch: 25 | loss: 0.0695039
	speed: 0.0175s/iter; left time: 296.0069s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0663624 Vali Loss: 0.0749484 Test Loss: 0.0837926
Validation loss decreased (0.074990 --> 0.074948).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0691248
	speed: 0.0335s/iter; left time: 561.4209s
	iters: 200, epoch: 26 | loss: 0.0618585
	speed: 0.0147s/iter; left time: 245.4379s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0662928 Vali Loss: 0.0749143 Test Loss: 0.0837867
Validation loss decreased (0.074948 --> 0.074914).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0626284
	speed: 0.0319s/iter; left time: 528.5842s
	iters: 200, epoch: 27 | loss: 0.0687371
	speed: 0.0149s/iter; left time: 244.4720s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.58s
Steps: 225 | Train Loss: 0.0661510 Vali Loss: 0.0748319 Test Loss: 0.0835857
Validation loss decreased (0.074914 --> 0.074832).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0651349
	speed: 0.0311s/iter; left time: 508.4941s
	iters: 200, epoch: 28 | loss: 0.0707700
	speed: 0.0159s/iter; left time: 257.7610s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.67s
Steps: 225 | Train Loss: 0.0660908 Vali Loss: 0.0748184 Test Loss: 0.0835905
Validation loss decreased (0.074832 --> 0.074818).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0658929
	speed: 0.0322s/iter; left time: 517.8244s
	iters: 200, epoch: 29 | loss: 0.0664856
	speed: 0.0160s/iter; left time: 255.2640s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.0661918 Vali Loss: 0.0748716 Test Loss: 0.0837305
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0693522
	speed: 0.0319s/iter; left time: 506.3924s
	iters: 200, epoch: 30 | loss: 0.0671649
	speed: 0.0145s/iter; left time: 229.4532s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.0660417 Vali Loss: 0.0748484 Test Loss: 0.0838063
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0664139
	speed: 0.0318s/iter; left time: 498.3755s
	iters: 200, epoch: 31 | loss: 0.0674991
	speed: 0.0153s/iter; left time: 237.4995s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.66s
Steps: 225 | Train Loss: 0.0660052 Vali Loss: 0.0748098 Test Loss: 0.0836985
Validation loss decreased (0.074818 --> 0.074810).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0629480
	speed: 0.0354s/iter; left time: 546.7001s
	iters: 200, epoch: 32 | loss: 0.0679041
	speed: 0.0172s/iter; left time: 264.1311s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.17s
Steps: 225 | Train Loss: 0.0659681 Vali Loss: 0.0747911 Test Loss: 0.0836148
Validation loss decreased (0.074810 --> 0.074791).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0672479
	speed: 0.0295s/iter; left time: 448.1865s
	iters: 200, epoch: 33 | loss: 0.0727934
	speed: 0.0118s/iter; left time: 177.7643s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.03s
Steps: 225 | Train Loss: 0.0660251 Vali Loss: 0.0747474 Test Loss: 0.0836668
Validation loss decreased (0.074791 --> 0.074747).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0706449
	speed: 0.0341s/iter; left time: 511.2375s
	iters: 200, epoch: 34 | loss: 0.0624950
	speed: 0.0171s/iter; left time: 254.9002s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0658645 Vali Loss: 0.0747966 Test Loss: 0.0837391
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0653407
	speed: 0.0336s/iter; left time: 495.1802s
	iters: 200, epoch: 35 | loss: 0.0693895
	speed: 0.0156s/iter; left time: 228.3747s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0658733 Vali Loss: 0.0747852 Test Loss: 0.0836694
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0682885
	speed: 0.0341s/iter; left time: 495.5976s
	iters: 200, epoch: 36 | loss: 0.0668036
	speed: 0.0166s/iter; left time: 239.1863s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.24s
Steps: 225 | Train Loss: 0.0657792 Vali Loss: 0.0747351 Test Loss: 0.0836585
Validation loss decreased (0.074747 --> 0.074735).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0690809
	speed: 0.0356s/iter; left time: 509.2706s
	iters: 200, epoch: 37 | loss: 0.0640136
	speed: 0.0171s/iter; left time: 243.2608s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.0658756 Vali Loss: 0.0747907 Test Loss: 0.0836819
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0670546
	speed: 0.0327s/iter; left time: 460.9193s
	iters: 200, epoch: 38 | loss: 0.0665384
	speed: 0.0145s/iter; left time: 202.7471s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.66s
Steps: 225 | Train Loss: 0.0657899 Vali Loss: 0.0747696 Test Loss: 0.0836834
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0626673
	speed: 0.0326s/iter; left time: 451.1311s
	iters: 200, epoch: 39 | loss: 0.0650180
	speed: 0.0169s/iter; left time: 231.9260s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.0656801 Vali Loss: 0.0748786 Test Loss: 0.0839305
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0671039
	speed: 0.0330s/iter; left time: 449.0905s
	iters: 200, epoch: 40 | loss: 0.0674989
	speed: 0.0149s/iter; left time: 201.3616s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.72s
Steps: 225 | Train Loss: 0.0657427 Vali Loss: 0.0747225 Test Loss: 0.0836363
Validation loss decreased (0.074735 --> 0.074723).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0650668
	speed: 0.0314s/iter; left time: 420.7551s
	iters: 200, epoch: 41 | loss: 0.0672973
	speed: 0.0152s/iter; left time: 202.0632s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0656366 Vali Loss: 0.0747689 Test Loss: 0.0837518
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0697005
	speed: 0.0316s/iter; left time: 416.5228s
	iters: 200, epoch: 42 | loss: 0.0656713
	speed: 0.0152s/iter; left time: 199.0378s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.0657307 Vali Loss: 0.0747003 Test Loss: 0.0836473
Validation loss decreased (0.074723 --> 0.074700).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0646323
	speed: 0.0336s/iter; left time: 435.3986s
	iters: 200, epoch: 43 | loss: 0.0638158
	speed: 0.0159s/iter; left time: 204.0537s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.83s
Steps: 225 | Train Loss: 0.0656570 Vali Loss: 0.0747236 Test Loss: 0.0836677
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0654169
	speed: 0.0317s/iter; left time: 403.1378s
	iters: 200, epoch: 44 | loss: 0.0667009
	speed: 0.0154s/iter; left time: 194.0540s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.0655989 Vali Loss: 0.0746637 Test Loss: 0.0835448
Validation loss decreased (0.074700 --> 0.074664).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0653667
	speed: 0.0354s/iter; left time: 442.5793s
	iters: 200, epoch: 45 | loss: 0.0623195
	speed: 0.0162s/iter; left time: 201.4616s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0655927 Vali Loss: 0.0746361 Test Loss: 0.0835031
Validation loss decreased (0.074664 --> 0.074636).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0648136
	speed: 0.0325s/iter; left time: 398.9867s
	iters: 200, epoch: 46 | loss: 0.0634316
	speed: 0.0154s/iter; left time: 187.9239s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0656873 Vali Loss: 0.0746974 Test Loss: 0.0835906
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0644567
	speed: 0.0322s/iter; left time: 387.8203s
	iters: 200, epoch: 47 | loss: 0.0674649
	speed: 0.0149s/iter; left time: 177.9582s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.68s
Steps: 225 | Train Loss: 0.0656318 Vali Loss: 0.0747004 Test Loss: 0.0835359
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0638885
	speed: 0.0267s/iter; left time: 315.3132s
	iters: 200, epoch: 48 | loss: 0.0633170
	speed: 0.0127s/iter; left time: 149.3234s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.02s
Steps: 225 | Train Loss: 0.0656023 Vali Loss: 0.0748286 Test Loss: 0.0838135
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0663939
	speed: 0.0377s/iter; left time: 437.6171s
	iters: 200, epoch: 49 | loss: 0.0685082
	speed: 0.0179s/iter; left time: 205.9690s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0656506 Vali Loss: 0.0747889 Test Loss: 0.0837646
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0632886
	speed: 0.0352s/iter; left time: 400.1008s
	iters: 200, epoch: 50 | loss: 0.0671445
	speed: 0.0173s/iter; left time: 195.4277s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.0655780 Vali Loss: 0.0747806 Test Loss: 0.0835741
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0623374
	speed: 0.0347s/iter; left time: 387.3919s
	iters: 200, epoch: 51 | loss: 0.0643868
	speed: 0.0178s/iter; left time: 197.1802s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0655646 Vali Loss: 0.0747436 Test Loss: 0.0837317
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0636110
	speed: 0.0348s/iter; left time: 380.2505s
	iters: 200, epoch: 52 | loss: 0.0663075
	speed: 0.0176s/iter; left time: 190.5632s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0656421 Vali Loss: 0.0746701 Test Loss: 0.0835855
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0626311
	speed: 0.0334s/iter; left time: 357.6473s
	iters: 200, epoch: 53 | loss: 0.0688870
	speed: 0.0157s/iter; left time: 166.6019s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.83s
Steps: 225 | Train Loss: 0.0655239 Vali Loss: 0.0746517 Test Loss: 0.0835584
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0718522
	speed: 0.0316s/iter; left time: 330.8418s
	iters: 200, epoch: 54 | loss: 0.0653040
	speed: 0.0152s/iter; left time: 157.8334s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.64s
Steps: 225 | Train Loss: 0.0656512 Vali Loss: 0.0746795 Test Loss: 0.0836077
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0699099
	speed: 0.0331s/iter; left time: 339.6789s
	iters: 200, epoch: 55 | loss: 0.0656586
	speed: 0.0128s/iter; left time: 129.5628s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0656060 Vali Loss: 0.0746935 Test Loss: 0.0836827
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020380981266498566, rmse:0.1427619755268097, mae:0.0835031047463417, rse:0.5522412657737732
Intermediate time for FR and pred_len 96: 00h:09m:28.97s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2457695
	speed: 0.0362s/iter; left time: 811.3178s
	iters: 200, epoch: 1 | loss: 0.2214903
	speed: 0.0132s/iter; left time: 294.9859s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.52s
Steps: 225 | Train Loss: 0.2463344 Vali Loss: 0.1826521 Test Loss: 0.1912599
Validation loss decreased (inf --> 0.182652).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1277386
	speed: 0.0361s/iter; left time: 800.4511s
	iters: 200, epoch: 2 | loss: 0.1018808
	speed: 0.0181s/iter; left time: 400.5990s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.1313877 Vali Loss: 0.1018746 Test Loss: 0.1139771
Validation loss decreased (0.182652 --> 0.101875).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0908557
	speed: 0.0314s/iter; left time: 688.6626s
	iters: 200, epoch: 3 | loss: 0.0855185
	speed: 0.0100s/iter; left time: 217.5301s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:02.78s
Steps: 225 | Train Loss: 0.0930013 Vali Loss: 0.0921000 Test Loss: 0.0991172
Validation loss decreased (0.101875 --> 0.092100).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0891004
	speed: 0.0319s/iter; left time: 693.6035s
	iters: 200, epoch: 4 | loss: 0.0825887
	speed: 0.0181s/iter; left time: 390.8772s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0853147 Vali Loss: 0.0864257 Test Loss: 0.0946696
Validation loss decreased (0.092100 --> 0.086426).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0822017
	speed: 0.0361s/iter; left time: 775.1247s
	iters: 200, epoch: 5 | loss: 0.0771825
	speed: 0.0189s/iter; left time: 404.4532s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0809365 Vali Loss: 0.0845859 Test Loss: 0.0936776
Validation loss decreased (0.086426 --> 0.084586).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0798835
	speed: 0.0316s/iter; left time: 672.2007s
	iters: 200, epoch: 6 | loss: 0.0827646
	speed: 0.0153s/iter; left time: 323.3170s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.63s
Steps: 225 | Train Loss: 0.0789175 Vali Loss: 0.0837064 Test Loss: 0.0930236
Validation loss decreased (0.084586 --> 0.083706).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0752266
	speed: 0.0335s/iter; left time: 705.7749s
	iters: 200, epoch: 7 | loss: 0.0747587
	speed: 0.0159s/iter; left time: 333.1100s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0769645 Vali Loss: 0.0841499 Test Loss: 0.0934944
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0705568
	speed: 0.0361s/iter; left time: 752.7324s
	iters: 200, epoch: 8 | loss: 0.0763874
	speed: 0.0183s/iter; left time: 378.9892s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0758539 Vali Loss: 0.0830533 Test Loss: 0.0929134
Validation loss decreased (0.083706 --> 0.083053).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0757157
	speed: 0.0329s/iter; left time: 677.7953s
	iters: 200, epoch: 9 | loss: 0.0759397
	speed: 0.0170s/iter; left time: 348.0883s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0749634 Vali Loss: 0.0820992 Test Loss: 0.0920538
Validation loss decreased (0.083053 --> 0.082099).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0745221
	speed: 0.0341s/iter; left time: 693.9088s
	iters: 200, epoch: 10 | loss: 0.0719350
	speed: 0.0156s/iter; left time: 315.4247s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.0741297 Vali Loss: 0.0814455 Test Loss: 0.0910367
Validation loss decreased (0.082099 --> 0.081445).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0764837
	speed: 0.0330s/iter; left time: 664.7576s
	iters: 200, epoch: 11 | loss: 0.0695029
	speed: 0.0167s/iter; left time: 334.9443s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.0739676 Vali Loss: 0.0803295 Test Loss: 0.0898504
Validation loss decreased (0.081445 --> 0.080330).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0716958
	speed: 0.0339s/iter; left time: 676.3389s
	iters: 200, epoch: 12 | loss: 0.0746069
	speed: 0.0154s/iter; left time: 305.2041s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.68s
Steps: 225 | Train Loss: 0.0731553 Vali Loss: 0.0803021 Test Loss: 0.0901671
Validation loss decreased (0.080330 --> 0.080302).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0708047
	speed: 0.0332s/iter; left time: 654.9965s
	iters: 200, epoch: 13 | loss: 0.0687040
	speed: 0.0154s/iter; left time: 301.5855s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.0726615 Vali Loss: 0.0803218 Test Loss: 0.0901097
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0758782
	speed: 0.0353s/iter; left time: 688.2904s
	iters: 200, epoch: 14 | loss: 0.0756663
	speed: 0.0168s/iter; left time: 325.5612s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0721283 Vali Loss: 0.0797881 Test Loss: 0.0894258
Validation loss decreased (0.080302 --> 0.079788).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0686727
	speed: 0.0352s/iter; left time: 676.9565s
	iters: 200, epoch: 15 | loss: 0.0697988
	speed: 0.0183s/iter; left time: 351.3483s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0717592 Vali Loss: 0.0802344 Test Loss: 0.0899736
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0721867
	speed: 0.0338s/iter; left time: 642.7947s
	iters: 200, epoch: 16 | loss: 0.0747293
	speed: 0.0156s/iter; left time: 295.3021s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0713627 Vali Loss: 0.0796205 Test Loss: 0.0895057
Validation loss decreased (0.079788 --> 0.079620).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0694145
	speed: 0.0326s/iter; left time: 612.9694s
	iters: 200, epoch: 17 | loss: 0.0718711
	speed: 0.0153s/iter; left time: 286.9771s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.83s
Steps: 225 | Train Loss: 0.0710901 Vali Loss: 0.0796221 Test Loss: 0.0895598
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0694964
	speed: 0.0318s/iter; left time: 590.3239s
	iters: 200, epoch: 18 | loss: 0.0708955
	speed: 0.0156s/iter; left time: 287.7132s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.72s
Steps: 225 | Train Loss: 0.0709736 Vali Loss: 0.0796491 Test Loss: 0.0896595
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0705740
	speed: 0.0345s/iter; left time: 632.2647s
	iters: 200, epoch: 19 | loss: 0.0759989
	speed: 0.0203s/iter; left time: 370.7390s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.0706302 Vali Loss: 0.0795927 Test Loss: 0.0897387
Validation loss decreased (0.079620 --> 0.079593).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0687659
	speed: 0.0360s/iter; left time: 652.8019s
	iters: 200, epoch: 20 | loss: 0.0704639
	speed: 0.0188s/iter; left time: 338.2485s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0705626 Vali Loss: 0.0795450 Test Loss: 0.0897743
Validation loss decreased (0.079593 --> 0.079545).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0697231
	speed: 0.0375s/iter; left time: 671.0817s
	iters: 200, epoch: 21 | loss: 0.0732484
	speed: 0.0179s/iter; left time: 319.0506s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0702737 Vali Loss: 0.0794629 Test Loss: 0.0898503
Validation loss decreased (0.079545 --> 0.079463).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0725980
	speed: 0.0336s/iter; left time: 594.0949s
	iters: 200, epoch: 22 | loss: 0.0697240
	speed: 0.0156s/iter; left time: 273.6543s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0701744 Vali Loss: 0.0795757 Test Loss: 0.0897552
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0662951
	speed: 0.0346s/iter; left time: 603.3260s
	iters: 200, epoch: 23 | loss: 0.0705444
	speed: 0.0172s/iter; left time: 298.1401s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.24s
Steps: 225 | Train Loss: 0.0700460 Vali Loss: 0.0793628 Test Loss: 0.0896879
Validation loss decreased (0.079463 --> 0.079363).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0696745
	speed: 0.0333s/iter; left time: 573.1230s
	iters: 200, epoch: 24 | loss: 0.0661158
	speed: 0.0164s/iter; left time: 280.0508s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0700054 Vali Loss: 0.0795738 Test Loss: 0.0900811
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0697619
	speed: 0.0321s/iter; left time: 546.4155s
	iters: 200, epoch: 25 | loss: 0.0687341
	speed: 0.0151s/iter; left time: 255.4571s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.0697976 Vali Loss: 0.0793890 Test Loss: 0.0897973
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0694301
	speed: 0.0310s/iter; left time: 520.3398s
	iters: 200, epoch: 26 | loss: 0.0664604
	speed: 0.0178s/iter; left time: 296.7458s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0697441 Vali Loss: 0.0797010 Test Loss: 0.0899496
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0656098
	speed: 0.0327s/iter; left time: 541.5560s
	iters: 200, epoch: 27 | loss: 0.0713333
	speed: 0.0185s/iter; left time: 304.0791s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0696657 Vali Loss: 0.0794763 Test Loss: 0.0897405
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0722426
	speed: 0.0318s/iter; left time: 519.4311s
	iters: 200, epoch: 28 | loss: 0.0686098
	speed: 0.0154s/iter; left time: 250.1012s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.64s
Steps: 225 | Train Loss: 0.0695880 Vali Loss: 0.0795084 Test Loss: 0.0898208
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0712926
	speed: 0.0325s/iter; left time: 522.9468s
	iters: 200, epoch: 29 | loss: 0.0702594
	speed: 0.0189s/iter; left time: 302.6665s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0695667 Vali Loss: 0.0794929 Test Loss: 0.0898527
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0701126
	speed: 0.0347s/iter; left time: 550.8938s
	iters: 200, epoch: 30 | loss: 0.0691674
	speed: 0.0191s/iter; left time: 300.5433s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0696097 Vali Loss: 0.0795344 Test Loss: 0.0901617
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0710925
	speed: 0.0371s/iter; left time: 580.9741s
	iters: 200, epoch: 31 | loss: 0.0686123
	speed: 0.0172s/iter; left time: 267.7653s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0694451 Vali Loss: 0.0796398 Test Loss: 0.0897871
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0677457
	speed: 0.0316s/iter; left time: 486.7493s
	iters: 200, epoch: 32 | loss: 0.0712155
	speed: 0.0198s/iter; left time: 303.3999s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0694937 Vali Loss: 0.0794603 Test Loss: 0.0898027
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0665110
	speed: 0.0325s/iter; left time: 494.0400s
	iters: 200, epoch: 33 | loss: 0.0714712
	speed: 0.0172s/iter; left time: 260.0770s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0694073 Vali Loss: 0.0795294 Test Loss: 0.0898771
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.022908687591552734, rmse:0.15135616064071655, mae:0.08968787640333176, rse:0.5862167477607727
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2475315
	speed: 0.0211s/iter; left time: 472.8780s
	iters: 200, epoch: 1 | loss: 0.2264819
	speed: 0.0162s/iter; left time: 361.9248s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.17s
Steps: 225 | Train Loss: 0.2456049 Vali Loss: 0.1833336 Test Loss: 0.1914726
Validation loss decreased (inf --> 0.183334).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1228585
	speed: 0.0353s/iter; left time: 783.0027s
	iters: 200, epoch: 2 | loss: 0.0990242
	speed: 0.0189s/iter; left time: 417.5302s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.1301335 Vali Loss: 0.1014620 Test Loss: 0.1144908
Validation loss decreased (0.183334 --> 0.101462).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0894346
	speed: 0.0352s/iter; left time: 772.6325s
	iters: 200, epoch: 3 | loss: 0.0878249
	speed: 0.0197s/iter; left time: 429.6286s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0933888 Vali Loss: 0.0927016 Test Loss: 0.0995768
Validation loss decreased (0.101462 --> 0.092702).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0936179
	speed: 0.0346s/iter; left time: 752.6978s
	iters: 200, epoch: 4 | loss: 0.0834910
	speed: 0.0178s/iter; left time: 385.7731s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0856615 Vali Loss: 0.0868466 Test Loss: 0.0954649
Validation loss decreased (0.092702 --> 0.086847).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0841565
	speed: 0.0376s/iter; left time: 809.3174s
	iters: 200, epoch: 5 | loss: 0.0807808
	speed: 0.0184s/iter; left time: 393.9126s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.0812586 Vali Loss: 0.0858457 Test Loss: 0.0945108
Validation loss decreased (0.086847 --> 0.085846).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0802644
	speed: 0.0372s/iter; left time: 791.6161s
	iters: 200, epoch: 6 | loss: 0.0779895
	speed: 0.0174s/iter; left time: 368.4587s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.0787631 Vali Loss: 0.0846770 Test Loss: 0.0937102
Validation loss decreased (0.085846 --> 0.084677).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0776361
	speed: 0.0333s/iter; left time: 700.2247s
	iters: 200, epoch: 7 | loss: 0.0771536
	speed: 0.0167s/iter; left time: 350.7077s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.0769995 Vali Loss: 0.0834739 Test Loss: 0.0923947
Validation loss decreased (0.084677 --> 0.083474).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0780043
	speed: 0.0334s/iter; left time: 695.5313s
	iters: 200, epoch: 8 | loss: 0.0787861
	speed: 0.0170s/iter; left time: 353.2850s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0756832 Vali Loss: 0.0826148 Test Loss: 0.0918682
Validation loss decreased (0.083474 --> 0.082615).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0705152
	speed: 0.0353s/iter; left time: 727.6348s
	iters: 200, epoch: 9 | loss: 0.0718096
	speed: 0.0205s/iter; left time: 420.5341s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0750352 Vali Loss: 0.0820301 Test Loss: 0.0913356
Validation loss decreased (0.082615 --> 0.082030).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0738082
	speed: 0.0365s/iter; left time: 743.6972s
	iters: 200, epoch: 10 | loss: 0.0705996
	speed: 0.0186s/iter; left time: 376.6756s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0740733 Vali Loss: 0.0816444 Test Loss: 0.0911710
Validation loss decreased (0.082030 --> 0.081644).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0694988
	speed: 0.0346s/iter; left time: 696.7456s
	iters: 200, epoch: 11 | loss: 0.0711344
	speed: 0.0170s/iter; left time: 341.0570s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0734706 Vali Loss: 0.0814154 Test Loss: 0.0910744
Validation loss decreased (0.081644 --> 0.081415).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0716891
	speed: 0.0351s/iter; left time: 698.6890s
	iters: 200, epoch: 12 | loss: 0.0729579
	speed: 0.0163s/iter; left time: 323.3373s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.05s
Steps: 225 | Train Loss: 0.0728471 Vali Loss: 0.0812354 Test Loss: 0.0910280
Validation loss decreased (0.081415 --> 0.081235).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0727554
	speed: 0.0331s/iter; left time: 652.7930s
	iters: 200, epoch: 13 | loss: 0.0719812
	speed: 0.0114s/iter; left time: 223.3755s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.16s
Steps: 225 | Train Loss: 0.0725295 Vali Loss: 0.0807067 Test Loss: 0.0906308
Validation loss decreased (0.081235 --> 0.080707).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0737901
	speed: 0.0315s/iter; left time: 612.5244s
	iters: 200, epoch: 14 | loss: 0.0761006
	speed: 0.0156s/iter; left time: 302.2384s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0721327 Vali Loss: 0.0807022 Test Loss: 0.0907606
Validation loss decreased (0.080707 --> 0.080702).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0736133
	speed: 0.0322s/iter; left time: 620.4389s
	iters: 200, epoch: 15 | loss: 0.0723154
	speed: 0.0168s/iter; left time: 322.4221s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0717245 Vali Loss: 0.0804117 Test Loss: 0.0902714
Validation loss decreased (0.080702 --> 0.080412).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0687496
	speed: 0.0375s/iter; left time: 714.1060s
	iters: 200, epoch: 16 | loss: 0.0708548
	speed: 0.0199s/iter; left time: 377.5447s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.0714129 Vali Loss: 0.0799183 Test Loss: 0.0899097
Validation loss decreased (0.080412 --> 0.079918).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0679504
	speed: 0.0348s/iter; left time: 653.8244s
	iters: 200, epoch: 17 | loss: 0.0778753
	speed: 0.0178s/iter; left time: 332.9803s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.0711230 Vali Loss: 0.0798044 Test Loss: 0.0900320
Validation loss decreased (0.079918 --> 0.079804).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0694376
	speed: 0.0442s/iter; left time: 821.7637s
	iters: 200, epoch: 18 | loss: 0.0710280
	speed: 0.0174s/iter; left time: 321.6000s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0709428 Vali Loss: 0.0797784 Test Loss: 0.0898284
Validation loss decreased (0.079804 --> 0.079778).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0688043
	speed: 0.0359s/iter; left time: 659.1749s
	iters: 200, epoch: 19 | loss: 0.0711079
	speed: 0.0189s/iter; left time: 344.3902s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0708623 Vali Loss: 0.0799950 Test Loss: 0.0903919
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0645109
	speed: 0.0345s/iter; left time: 625.4423s
	iters: 200, epoch: 20 | loss: 0.0717572
	speed: 0.0182s/iter; left time: 327.9978s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0705810 Vali Loss: 0.0797130 Test Loss: 0.0902688
Validation loss decreased (0.079778 --> 0.079713).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0678085
	speed: 0.0359s/iter; left time: 642.0294s
	iters: 200, epoch: 21 | loss: 0.0693727
	speed: 0.0182s/iter; left time: 324.8444s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.25s
Steps: 225 | Train Loss: 0.0704802 Vali Loss: 0.0796383 Test Loss: 0.0902148
Validation loss decreased (0.079713 --> 0.079638).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0698550
	speed: 0.0306s/iter; left time: 541.3396s
	iters: 200, epoch: 22 | loss: 0.0697957
	speed: 0.0222s/iter; left time: 391.0625s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0704161 Vali Loss: 0.0797148 Test Loss: 0.0903682
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0724288
	speed: 0.0367s/iter; left time: 641.2787s
	iters: 200, epoch: 23 | loss: 0.0695834
	speed: 0.0150s/iter; left time: 259.9841s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0703086 Vali Loss: 0.0799217 Test Loss: 0.0903951
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0704532
	speed: 0.0369s/iter; left time: 636.2909s
	iters: 200, epoch: 24 | loss: 0.0708161
	speed: 0.0190s/iter; left time: 325.2965s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.66s
Steps: 225 | Train Loss: 0.0701037 Vali Loss: 0.0799287 Test Loss: 0.0905475
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0711049
	speed: 0.0368s/iter; left time: 625.1959s
	iters: 200, epoch: 25 | loss: 0.0708909
	speed: 0.0184s/iter; left time: 310.9371s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0701468 Vali Loss: 0.0800464 Test Loss: 0.0906366
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0692690
	speed: 0.0340s/iter; left time: 570.0768s
	iters: 200, epoch: 26 | loss: 0.0730075
	speed: 0.0186s/iter; left time: 309.3823s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0701595 Vali Loss: 0.0801362 Test Loss: 0.0907676
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0722371
	speed: 0.0326s/iter; left time: 539.2172s
	iters: 200, epoch: 27 | loss: 0.0678109
	speed: 0.0173s/iter; left time: 284.0466s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0699988 Vali Loss: 0.0799063 Test Loss: 0.0905414
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0755869
	speed: 0.0320s/iter; left time: 522.5504s
	iters: 200, epoch: 28 | loss: 0.0650524
	speed: 0.0176s/iter; left time: 284.9140s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.94s
Steps: 225 | Train Loss: 0.0699465 Vali Loss: 0.0796831 Test Loss: 0.0902116
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0678778
	speed: 0.0347s/iter; left time: 558.5371s
	iters: 200, epoch: 29 | loss: 0.0683460
	speed: 0.0173s/iter; left time: 277.4141s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.19s
Steps: 225 | Train Loss: 0.0698914 Vali Loss: 0.0797773 Test Loss: 0.0904671
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0732322
	speed: 0.0356s/iter; left time: 564.5030s
	iters: 200, epoch: 30 | loss: 0.0698619
	speed: 0.0184s/iter; left time: 290.1244s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0697509 Vali Loss: 0.0798239 Test Loss: 0.0905032
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0718747
	speed: 0.0356s/iter; left time: 556.8336s
	iters: 200, epoch: 31 | loss: 0.0708746
	speed: 0.0168s/iter; left time: 261.3923s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0699904 Vali Loss: 0.0794514 Test Loss: 0.0901573
Validation loss decreased (0.079638 --> 0.079451).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0675547
	speed: 0.0356s/iter; left time: 549.8464s
	iters: 200, epoch: 32 | loss: 0.0683894
	speed: 0.0164s/iter; left time: 251.8167s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0696626 Vali Loss: 0.0796696 Test Loss: 0.0903575
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0685225
	speed: 0.0323s/iter; left time: 490.9030s
	iters: 200, epoch: 33 | loss: 0.0686906
	speed: 0.0171s/iter; left time: 258.1393s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0696908 Vali Loss: 0.0795452 Test Loss: 0.0901167
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0667701
	speed: 0.0349s/iter; left time: 523.2245s
	iters: 200, epoch: 34 | loss: 0.0682344
	speed: 0.0177s/iter; left time: 263.3715s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.19s
Steps: 225 | Train Loss: 0.0698480 Vali Loss: 0.0795390 Test Loss: 0.0901924
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0728837
	speed: 0.0344s/iter; left time: 507.6933s
	iters: 200, epoch: 35 | loss: 0.0682282
	speed: 0.0192s/iter; left time: 281.5317s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.23s
Steps: 225 | Train Loss: 0.0697524 Vali Loss: 0.0795052 Test Loss: 0.0902432
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0698334
	speed: 0.0327s/iter; left time: 474.3197s
	iters: 200, epoch: 36 | loss: 0.0653570
	speed: 0.0146s/iter; left time: 210.8943s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.0696060 Vali Loss: 0.0797219 Test Loss: 0.0904662
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0688643
	speed: 0.0350s/iter; left time: 500.3553s
	iters: 200, epoch: 37 | loss: 0.0726332
	speed: 0.0161s/iter; left time: 229.1044s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0695769 Vali Loss: 0.0801196 Test Loss: 0.0909049
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0683476
	speed: 0.0369s/iter; left time: 520.0695s
	iters: 200, epoch: 38 | loss: 0.0744995
	speed: 0.0161s/iter; left time: 224.6159s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0696177 Vali Loss: 0.0794538 Test Loss: 0.0900954
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0695931
	speed: 0.0325s/iter; left time: 450.4762s
	iters: 200, epoch: 39 | loss: 0.0729357
	speed: 0.0155s/iter; left time: 213.3891s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0694720 Vali Loss: 0.0795424 Test Loss: 0.0902805
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0661439
	speed: 0.0314s/iter; left time: 427.9428s
	iters: 200, epoch: 40 | loss: 0.0719939
	speed: 0.0140s/iter; left time: 189.5093s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0695547 Vali Loss: 0.0796985 Test Loss: 0.0904467
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0714126
	speed: 0.0338s/iter; left time: 453.0411s
	iters: 200, epoch: 41 | loss: 0.0713710
	speed: 0.0164s/iter; left time: 218.1374s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0694798 Vali Loss: 0.0796473 Test Loss: 0.0904636
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023290717974305153, rmse:0.15261296927928925, mae:0.09015733748674393, rse:0.5910844802856445
Intermediate time for FR and pred_len 168: 00h:06m:33.01sIntermediate time for FR: 00h:27m:02.97s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2748396
	speed: 0.0417s/iter; left time: 937.2237s
	iters: 200, epoch: 1 | loss: 0.2437673
	speed: 0.0146s/iter; left time: 326.7799s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.2755289 Vali Loss: 0.1856256 Test Loss: 0.1920305
Validation loss decreased (inf --> 0.185626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1493361
	speed: 0.0294s/iter; left time: 655.6071s
	iters: 200, epoch: 2 | loss: 0.1137058
	speed: 0.0130s/iter; left time: 288.3639s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.29s
Steps: 226 | Train Loss: 0.1543205 Vali Loss: 0.0913810 Test Loss: 0.0918437
Validation loss decreased (0.185626 --> 0.091381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1026489
	speed: 0.0302s/iter; left time: 665.1519s
	iters: 200, epoch: 3 | loss: 0.0962690
	speed: 0.0150s/iter; left time: 329.6966s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.1004594 Vali Loss: 0.0835395 Test Loss: 0.0854951
Validation loss decreased (0.091381 --> 0.083539).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0915175
	speed: 0.0310s/iter; left time: 677.2316s
	iters: 200, epoch: 4 | loss: 0.0810010
	speed: 0.0156s/iter; left time: 338.4602s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.71s
Steps: 226 | Train Loss: 0.0900728 Vali Loss: 0.0788191 Test Loss: 0.0802079
Validation loss decreased (0.083539 --> 0.078819).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0855739
	speed: 0.0296s/iter; left time: 640.1663s
	iters: 200, epoch: 5 | loss: 0.0812334
	speed: 0.0155s/iter; left time: 333.0344s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.61s
Steps: 226 | Train Loss: 0.0840692 Vali Loss: 0.0760780 Test Loss: 0.0758319
Validation loss decreased (0.078819 --> 0.076078).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0776363
	speed: 0.0298s/iter; left time: 637.7694s
	iters: 200, epoch: 6 | loss: 0.0761937
	speed: 0.0147s/iter; left time: 312.6973s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.54s
Steps: 226 | Train Loss: 0.0797316 Vali Loss: 0.0726597 Test Loss: 0.0717476
Validation loss decreased (0.076078 --> 0.072660).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0815444
	speed: 0.0330s/iter; left time: 697.0667s
	iters: 200, epoch: 7 | loss: 0.0786124
	speed: 0.0155s/iter; left time: 325.8145s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.0767705 Vali Loss: 0.0700167 Test Loss: 0.0696374
Validation loss decreased (0.072660 --> 0.070017).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0715965
	speed: 0.0356s/iter; left time: 744.7882s
	iters: 200, epoch: 8 | loss: 0.0738217
	speed: 0.0206s/iter; left time: 427.8663s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.78s
Steps: 226 | Train Loss: 0.0745824 Vali Loss: 0.0685167 Test Loss: 0.0687677
Validation loss decreased (0.070017 --> 0.068517).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0756384
	speed: 0.0333s/iter; left time: 689.5123s
	iters: 200, epoch: 9 | loss: 0.0742270
	speed: 0.0147s/iter; left time: 302.7312s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.78s
Steps: 226 | Train Loss: 0.0727980 Vali Loss: 0.0671877 Test Loss: 0.0674993
Validation loss decreased (0.068517 --> 0.067188).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0706152
	speed: 0.0369s/iter; left time: 756.1406s
	iters: 200, epoch: 10 | loss: 0.0760004
	speed: 0.0217s/iter; left time: 441.8764s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.69s
Steps: 226 | Train Loss: 0.0716838 Vali Loss: 0.0665030 Test Loss: 0.0669898
Validation loss decreased (0.067188 --> 0.066503).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0702347
	speed: 0.0318s/iter; left time: 643.2816s
	iters: 200, epoch: 11 | loss: 0.0718995
	speed: 0.0172s/iter; left time: 346.3118s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0707948 Vali Loss: 0.0666187 Test Loss: 0.0674490
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0734934
	speed: 0.0328s/iter; left time: 655.5600s
	iters: 200, epoch: 12 | loss: 0.0709180
	speed: 0.0171s/iter; left time: 341.2346s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0698628 Vali Loss: 0.0650645 Test Loss: 0.0659001
Validation loss decreased (0.066503 --> 0.065064).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0696956
	speed: 0.0353s/iter; left time: 698.2108s
	iters: 200, epoch: 13 | loss: 0.0614012
	speed: 0.0181s/iter; left time: 356.4350s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.0692104 Vali Loss: 0.0647886 Test Loss: 0.0656072
Validation loss decreased (0.065064 --> 0.064789).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0693385
	speed: 0.0355s/iter; left time: 693.9144s
	iters: 200, epoch: 14 | loss: 0.0682732
	speed: 0.0167s/iter; left time: 324.4456s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0685786 Vali Loss: 0.0644128 Test Loss: 0.0652005
Validation loss decreased (0.064789 --> 0.064413).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0638366
	speed: 0.0251s/iter; left time: 486.1250s
	iters: 200, epoch: 15 | loss: 0.0725680
	speed: 0.0097s/iter; left time: 185.7303s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:02.36s
Steps: 226 | Train Loss: 0.0681003 Vali Loss: 0.0639429 Test Loss: 0.0648437
Validation loss decreased (0.064413 --> 0.063943).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0701464
	speed: 0.0319s/iter; left time: 609.2977s
	iters: 200, epoch: 16 | loss: 0.0647896
	speed: 0.0155s/iter; left time: 294.7602s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0675665 Vali Loss: 0.0636157 Test Loss: 0.0646268
Validation loss decreased (0.063943 --> 0.063616).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0655411
	speed: 0.0309s/iter; left time: 582.7417s
	iters: 200, epoch: 17 | loss: 0.0670703
	speed: 0.0163s/iter; left time: 305.4474s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0669401 Vali Loss: 0.0634104 Test Loss: 0.0643599
Validation loss decreased (0.063616 --> 0.063410).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0698583
	speed: 0.0316s/iter; left time: 590.3265s
	iters: 200, epoch: 18 | loss: 0.0653305
	speed: 0.0101s/iter; left time: 187.0687s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.08s
Steps: 226 | Train Loss: 0.0667295 Vali Loss: 0.0626011 Test Loss: 0.0639532
Validation loss decreased (0.063410 --> 0.062601).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0661613
	speed: 0.0295s/iter; left time: 544.4511s
	iters: 200, epoch: 19 | loss: 0.0649737
	speed: 0.0164s/iter; left time: 300.8725s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0663652 Vali Loss: 0.0619979 Test Loss: 0.0636087
Validation loss decreased (0.062601 --> 0.061998).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0649312
	speed: 0.0353s/iter; left time: 643.0561s
	iters: 200, epoch: 20 | loss: 0.0673294
	speed: 0.0185s/iter; left time: 334.7478s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.0662496 Vali Loss: 0.0621928 Test Loss: 0.0636217
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0673968
	speed: 0.0336s/iter; left time: 604.5872s
	iters: 200, epoch: 21 | loss: 0.0683301
	speed: 0.0198s/iter; left time: 353.5881s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.41s
Steps: 226 | Train Loss: 0.0660445 Vali Loss: 0.0619915 Test Loss: 0.0636112
Validation loss decreased (0.061998 --> 0.061992).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0616098
	speed: 0.0332s/iter; left time: 588.6153s
	iters: 200, epoch: 22 | loss: 0.0679803
	speed: 0.0150s/iter; left time: 265.3712s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.0657187 Vali Loss: 0.0618104 Test Loss: 0.0633237
Validation loss decreased (0.061992 --> 0.061810).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0601932
	speed: 0.0353s/iter; left time: 619.6269s
	iters: 200, epoch: 23 | loss: 0.0639134
	speed: 0.0197s/iter; left time: 342.9178s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.52s
Steps: 226 | Train Loss: 0.0654844 Vali Loss: 0.0615780 Test Loss: 0.0632567
Validation loss decreased (0.061810 --> 0.061578).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0621948
	speed: 0.0365s/iter; left time: 632.3301s
	iters: 200, epoch: 24 | loss: 0.0668994
	speed: 0.0198s/iter; left time: 341.0743s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.66s
Steps: 226 | Train Loss: 0.0654431 Vali Loss: 0.0612439 Test Loss: 0.0631715
Validation loss decreased (0.061578 --> 0.061244).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0627289
	speed: 0.0318s/iter; left time: 542.2627s
	iters: 200, epoch: 25 | loss: 0.0677464
	speed: 0.0147s/iter; left time: 248.9377s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.53s
Steps: 226 | Train Loss: 0.0652054 Vali Loss: 0.0613669 Test Loss: 0.0629946
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0604987
	speed: 0.0315s/iter; left time: 530.1911s
	iters: 200, epoch: 26 | loss: 0.0686064
	speed: 0.0169s/iter; left time: 283.6809s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0650758 Vali Loss: 0.0612290 Test Loss: 0.0629992
Validation loss decreased (0.061244 --> 0.061229).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0660665
	speed: 0.0351s/iter; left time: 583.3352s
	iters: 200, epoch: 27 | loss: 0.0662128
	speed: 0.0195s/iter; left time: 322.0848s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.59s
Steps: 226 | Train Loss: 0.0649722 Vali Loss: 0.0614886 Test Loss: 0.0630154
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0650454
	speed: 0.0333s/iter; left time: 546.8758s
	iters: 200, epoch: 28 | loss: 0.0631211
	speed: 0.0158s/iter; left time: 257.3863s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0649112 Vali Loss: 0.0611055 Test Loss: 0.0628059
Validation loss decreased (0.061229 --> 0.061105).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0670574
	speed: 0.0305s/iter; left time: 493.6834s
	iters: 200, epoch: 29 | loss: 0.0646305
	speed: 0.0146s/iter; left time: 235.4256s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.65s
Steps: 226 | Train Loss: 0.0650379 Vali Loss: 0.0611235 Test Loss: 0.0630979
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0619116
	speed: 0.0338s/iter; left time: 538.7668s
	iters: 200, epoch: 30 | loss: 0.0688088
	speed: 0.0150s/iter; left time: 238.3126s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.90s
Steps: 226 | Train Loss: 0.0646989 Vali Loss: 0.0609421 Test Loss: 0.0627098
Validation loss decreased (0.061105 --> 0.060942).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0645512
	speed: 0.0343s/iter; left time: 538.8844s
	iters: 200, epoch: 31 | loss: 0.0659291
	speed: 0.0169s/iter; left time: 264.6613s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0646035 Vali Loss: 0.0611472 Test Loss: 0.0629095
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0626861
	speed: 0.0310s/iter; left time: 480.4085s
	iters: 200, epoch: 32 | loss: 0.0652184
	speed: 0.0148s/iter; left time: 228.2659s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0646430 Vali Loss: 0.0610199 Test Loss: 0.0626497
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0652788
	speed: 0.0337s/iter; left time: 515.2608s
	iters: 200, epoch: 33 | loss: 0.0659325
	speed: 0.0170s/iter; left time: 258.5736s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0645845 Vali Loss: 0.0608501 Test Loss: 0.0625451
Validation loss decreased (0.060942 --> 0.060850).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0590962
	speed: 0.0343s/iter; left time: 516.5190s
	iters: 200, epoch: 34 | loss: 0.0679324
	speed: 0.0169s/iter; left time: 252.1092s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0644537 Vali Loss: 0.0607062 Test Loss: 0.0626173
Validation loss decreased (0.060850 --> 0.060706).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0630025
	speed: 0.0310s/iter; left time: 459.5427s
	iters: 200, epoch: 35 | loss: 0.0656969
	speed: 0.0151s/iter; left time: 222.7457s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.64s
Steps: 226 | Train Loss: 0.0646521 Vali Loss: 0.0611565 Test Loss: 0.0627958
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0650596
	speed: 0.0318s/iter; left time: 464.0778s
	iters: 200, epoch: 36 | loss: 0.0631918
	speed: 0.0149s/iter; left time: 215.4710s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.70s
Steps: 226 | Train Loss: 0.0644221 Vali Loss: 0.0606643 Test Loss: 0.0624270
Validation loss decreased (0.060706 --> 0.060664).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0654559
	speed: 0.0299s/iter; left time: 428.9926s
	iters: 200, epoch: 37 | loss: 0.0641655
	speed: 0.0167s/iter; left time: 238.1439s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0645150 Vali Loss: 0.0606552 Test Loss: 0.0625015
Validation loss decreased (0.060664 --> 0.060655).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0633260
	speed: 0.0335s/iter; left time: 474.2394s
	iters: 200, epoch: 38 | loss: 0.0695505
	speed: 0.0184s/iter; left time: 258.8482s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.0642804 Vali Loss: 0.0609270 Test Loss: 0.0626896
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0642076
	speed: 0.0321s/iter; left time: 446.0454s
	iters: 200, epoch: 39 | loss: 0.0640506
	speed: 0.0174s/iter; left time: 240.2730s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.02s
Steps: 226 | Train Loss: 0.0643265 Vali Loss: 0.0606977 Test Loss: 0.0624603
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0686188
	speed: 0.0296s/iter; left time: 405.5487s
	iters: 200, epoch: 40 | loss: 0.0625081
	speed: 0.0149s/iter; left time: 202.1994s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.52s
Steps: 226 | Train Loss: 0.0643408 Vali Loss: 0.0604858 Test Loss: 0.0624120
Validation loss decreased (0.060655 --> 0.060486).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0631014
	speed: 0.0331s/iter; left time: 445.7334s
	iters: 200, epoch: 41 | loss: 0.0699809
	speed: 0.0178s/iter; left time: 238.1735s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0642466 Vali Loss: 0.0605204 Test Loss: 0.0623931
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0619243
	speed: 0.0333s/iter; left time: 440.4574s
	iters: 200, epoch: 42 | loss: 0.0649035
	speed: 0.0179s/iter; left time: 235.0878s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0641566 Vali Loss: 0.0607848 Test Loss: 0.0625766
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0657198
	speed: 0.0302s/iter; left time: 392.5188s
	iters: 200, epoch: 43 | loss: 0.0621232
	speed: 0.0179s/iter; left time: 231.0402s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0642341 Vali Loss: 0.0605430 Test Loss: 0.0624739
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0633814
	speed: 0.0295s/iter; left time: 376.8730s
	iters: 200, epoch: 44 | loss: 0.0651713
	speed: 0.0123s/iter; left time: 155.8425s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.20s
Steps: 226 | Train Loss: 0.0641601 Vali Loss: 0.0609071 Test Loss: 0.0626294
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0628465
	speed: 0.0325s/iter; left time: 408.2180s
	iters: 200, epoch: 45 | loss: 0.0660572
	speed: 0.0155s/iter; left time: 193.5537s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.89s
Steps: 226 | Train Loss: 0.0642404 Vali Loss: 0.0605895 Test Loss: 0.0625237
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0685697
	speed: 0.0339s/iter; left time: 417.8552s
	iters: 200, epoch: 46 | loss: 0.0621873
	speed: 0.0200s/iter; left time: 244.8965s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.63s
Steps: 226 | Train Loss: 0.0642729 Vali Loss: 0.0607251 Test Loss: 0.0624833
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0646147
	speed: 0.0326s/iter; left time: 394.6524s
	iters: 200, epoch: 47 | loss: 0.0673378
	speed: 0.0150s/iter; left time: 180.5121s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.64s
Steps: 226 | Train Loss: 0.0641940 Vali Loss: 0.0605492 Test Loss: 0.0623635
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0633266
	speed: 0.0336s/iter; left time: 398.8785s
	iters: 200, epoch: 48 | loss: 0.0628880
	speed: 0.0198s/iter; left time: 233.4596s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0640995 Vali Loss: 0.0604947 Test Loss: 0.0624149
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0641017
	speed: 0.0326s/iter; left time: 380.2014s
	iters: 200, epoch: 49 | loss: 0.0668483
	speed: 0.0159s/iter; left time: 184.2079s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.89s
Steps: 226 | Train Loss: 0.0640413 Vali Loss: 0.0605283 Test Loss: 0.0623423
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0645802
	speed: 0.0312s/iter; left time: 356.0131s
	iters: 200, epoch: 50 | loss: 0.0681049
	speed: 0.0168s/iter; left time: 190.5582s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0640587 Vali Loss: 0.0605727 Test Loss: 0.0623666
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010827051475644112, rmse:0.10405311733484268, mae:0.06241200491786003, rse:0.3931654989719391
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2683806
	speed: 0.0178s/iter; left time: 400.4553s
	iters: 200, epoch: 1 | loss: 0.2500031
	speed: 0.0164s/iter; left time: 367.3896s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.2719273 Vali Loss: 0.1840928 Test Loss: 0.1898444
Validation loss decreased (inf --> 0.184093).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1473255
	speed: 0.0356s/iter; left time: 792.3217s
	iters: 200, epoch: 2 | loss: 0.1141868
	speed: 0.0174s/iter; left time: 384.8068s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.32s
Steps: 226 | Train Loss: 0.1519194 Vali Loss: 0.0927569 Test Loss: 0.0932253
Validation loss decreased (0.184093 --> 0.092757).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1015654
	speed: 0.0336s/iter; left time: 740.5653s
	iters: 200, epoch: 3 | loss: 0.0946531
	speed: 0.0158s/iter; left time: 346.9910s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.01s
Steps: 226 | Train Loss: 0.1000551 Vali Loss: 0.0842878 Test Loss: 0.0861395
Validation loss decreased (0.092757 --> 0.084288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0961696
	speed: 0.0309s/iter; left time: 674.1843s
	iters: 200, epoch: 4 | loss: 0.0867536
	speed: 0.0171s/iter; left time: 370.9738s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.80s
Steps: 226 | Train Loss: 0.0895216 Vali Loss: 0.0783139 Test Loss: 0.0783058
Validation loss decreased (0.084288 --> 0.078314).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0827323
	speed: 0.0310s/iter; left time: 668.8156s
	iters: 200, epoch: 5 | loss: 0.0823020
	speed: 0.0154s/iter; left time: 331.3727s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.67s
Steps: 226 | Train Loss: 0.0828466 Vali Loss: 0.0737580 Test Loss: 0.0737559
Validation loss decreased (0.078314 --> 0.073758).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0794151
	speed: 0.0367s/iter; left time: 784.5256s
	iters: 200, epoch: 6 | loss: 0.0737667
	speed: 0.0182s/iter; left time: 387.3200s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0783047 Vali Loss: 0.0704807 Test Loss: 0.0705242
Validation loss decreased (0.073758 --> 0.070481).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0736217
	speed: 0.0343s/iter; left time: 724.3221s
	iters: 200, epoch: 7 | loss: 0.0697554
	speed: 0.0153s/iter; left time: 322.6356s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0753732 Vali Loss: 0.0690016 Test Loss: 0.0695043
Validation loss decreased (0.070481 --> 0.069002).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0740855
	speed: 0.0339s/iter; left time: 709.4961s
	iters: 200, epoch: 8 | loss: 0.0729932
	speed: 0.0167s/iter; left time: 346.6540s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.09s
Steps: 226 | Train Loss: 0.0735638 Vali Loss: 0.0673765 Test Loss: 0.0681725
Validation loss decreased (0.069002 --> 0.067376).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0741466
	speed: 0.0252s/iter; left time: 521.6940s
	iters: 200, epoch: 9 | loss: 0.0699058
	speed: 0.0153s/iter; left time: 315.8517s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.24s
Steps: 226 | Train Loss: 0.0719995 Vali Loss: 0.0672796 Test Loss: 0.0680970
Validation loss decreased (0.067376 --> 0.067280).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0702154
	speed: 0.0325s/iter; left time: 666.1266s
	iters: 200, epoch: 10 | loss: 0.0715199
	speed: 0.0154s/iter; left time: 313.5602s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.73s
Steps: 226 | Train Loss: 0.0706106 Vali Loss: 0.0660015 Test Loss: 0.0670486
Validation loss decreased (0.067280 --> 0.066002).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0648683
	speed: 0.0315s/iter; left time: 638.2128s
	iters: 200, epoch: 11 | loss: 0.0669258
	speed: 0.0169s/iter; left time: 340.9636s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.91s
Steps: 226 | Train Loss: 0.0697243 Vali Loss: 0.0652760 Test Loss: 0.0661902
Validation loss decreased (0.066002 --> 0.065276).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0712571
	speed: 0.0314s/iter; left time: 628.3819s
	iters: 200, epoch: 12 | loss: 0.0662717
	speed: 0.0174s/iter; left time: 347.1460s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0687956 Vali Loss: 0.0644891 Test Loss: 0.0659832
Validation loss decreased (0.065276 --> 0.064489).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0688350
	speed: 0.0304s/iter; left time: 600.7452s
	iters: 200, epoch: 13 | loss: 0.0723955
	speed: 0.0167s/iter; left time: 328.7659s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0682971 Vali Loss: 0.0655814 Test Loss: 0.0672650
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0626216
	speed: 0.0333s/iter; left time: 652.0142s
	iters: 200, epoch: 14 | loss: 0.0653330
	speed: 0.0181s/iter; left time: 352.5416s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0676314 Vali Loss: 0.0636220 Test Loss: 0.0650536
Validation loss decreased (0.064489 --> 0.063622).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0657042
	speed: 0.0338s/iter; left time: 653.5294s
	iters: 200, epoch: 15 | loss: 0.0669574
	speed: 0.0179s/iter; left time: 344.2830s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0668961 Vali Loss: 0.0634391 Test Loss: 0.0649784
Validation loss decreased (0.063622 --> 0.063439).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0697312
	speed: 0.0331s/iter; left time: 632.9849s
	iters: 200, epoch: 16 | loss: 0.0630022
	speed: 0.0177s/iter; left time: 336.7774s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.13s
Steps: 226 | Train Loss: 0.0664600 Vali Loss: 0.0630070 Test Loss: 0.0646449
Validation loss decreased (0.063439 --> 0.063007).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0637233
	speed: 0.0476s/iter; left time: 898.0290s
	iters: 200, epoch: 17 | loss: 0.0637252
	speed: 0.0154s/iter; left time: 288.8108s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.76s
Steps: 226 | Train Loss: 0.0659325 Vali Loss: 0.0624811 Test Loss: 0.0643669
Validation loss decreased (0.063007 --> 0.062481).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0649766
	speed: 0.0334s/iter; left time: 623.6352s
	iters: 200, epoch: 18 | loss: 0.0627688
	speed: 0.0136s/iter; left time: 252.3591s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0658954 Vali Loss: 0.0630394 Test Loss: 0.0648154
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0659889
	speed: 0.0314s/iter; left time: 578.7307s
	iters: 200, epoch: 19 | loss: 0.0662282
	speed: 0.0148s/iter; left time: 270.8145s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.79s
Steps: 226 | Train Loss: 0.0656105 Vali Loss: 0.0625913 Test Loss: 0.0644748
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0655865
	speed: 0.0341s/iter; left time: 620.8576s
	iters: 200, epoch: 20 | loss: 0.0657419
	speed: 0.0164s/iter; left time: 297.5118s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.05s
Steps: 226 | Train Loss: 0.0654036 Vali Loss: 0.0621260 Test Loss: 0.0637845
Validation loss decreased (0.062481 --> 0.062126).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0695874
	speed: 0.0327s/iter; left time: 588.7165s
	iters: 200, epoch: 21 | loss: 0.0634244
	speed: 0.0166s/iter; left time: 297.4133s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.78s
Steps: 226 | Train Loss: 0.0651018 Vali Loss: 0.0619380 Test Loss: 0.0638644
Validation loss decreased (0.062126 --> 0.061938).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0650325
	speed: 0.0307s/iter; left time: 544.6062s
	iters: 200, epoch: 22 | loss: 0.0630519
	speed: 0.0155s/iter; left time: 273.4876s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.67s
Steps: 226 | Train Loss: 0.0649287 Vali Loss: 0.0616359 Test Loss: 0.0637903
Validation loss decreased (0.061938 --> 0.061636).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0641462
	speed: 0.0308s/iter; left time: 540.1850s
	iters: 200, epoch: 23 | loss: 0.0719948
	speed: 0.0153s/iter; left time: 267.2303s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.70s
Steps: 226 | Train Loss: 0.0647936 Vali Loss: 0.0615581 Test Loss: 0.0639146
Validation loss decreased (0.061636 --> 0.061558).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0681741
	speed: 0.0327s/iter; left time: 565.9736s
	iters: 200, epoch: 24 | loss: 0.0643590
	speed: 0.0150s/iter; left time: 258.3262s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0646900 Vali Loss: 0.0612422 Test Loss: 0.0634298
Validation loss decreased (0.061558 --> 0.061242).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0616931
	speed: 0.0308s/iter; left time: 526.0258s
	iters: 200, epoch: 25 | loss: 0.0661258
	speed: 0.0150s/iter; left time: 254.9348s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.63s
Steps: 226 | Train Loss: 0.0644749 Vali Loss: 0.0617726 Test Loss: 0.0638768
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0671707
	speed: 0.0298s/iter; left time: 502.4363s
	iters: 200, epoch: 26 | loss: 0.0633176
	speed: 0.0190s/iter; left time: 317.6319s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0642615 Vali Loss: 0.0610944 Test Loss: 0.0634198
Validation loss decreased (0.061242 --> 0.061094).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0674960
	speed: 0.0355s/iter; left time: 589.5168s
	iters: 200, epoch: 27 | loss: 0.0583401
	speed: 0.0184s/iter; left time: 303.9895s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.33s
Steps: 226 | Train Loss: 0.0641232 Vali Loss: 0.0611686 Test Loss: 0.0632927
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0650903
	speed: 0.0305s/iter; left time: 500.4951s
	iters: 200, epoch: 28 | loss: 0.0644257
	speed: 0.0156s/iter; left time: 254.9065s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.71s
Steps: 226 | Train Loss: 0.0643254 Vali Loss: 0.0615976 Test Loss: 0.0636764
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0650363
	speed: 0.0327s/iter; left time: 528.5208s
	iters: 200, epoch: 29 | loss: 0.0612404
	speed: 0.0150s/iter; left time: 241.8649s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.64s
Steps: 226 | Train Loss: 0.0641005 Vali Loss: 0.0610079 Test Loss: 0.0633634
Validation loss decreased (0.061094 --> 0.061008).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0642853
	speed: 0.0309s/iter; left time: 492.7942s
	iters: 200, epoch: 30 | loss: 0.0671432
	speed: 0.0152s/iter; left time: 241.6337s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0640129 Vali Loss: 0.0607666 Test Loss: 0.0629210
Validation loss decreased (0.061008 --> 0.060767).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0637396
	speed: 0.0329s/iter; left time: 516.9158s
	iters: 200, epoch: 31 | loss: 0.0668434
	speed: 0.0153s/iter; left time: 238.7852s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0639195 Vali Loss: 0.0608141 Test Loss: 0.0631239
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0630049
	speed: 0.0327s/iter; left time: 507.3852s
	iters: 200, epoch: 32 | loss: 0.0637505
	speed: 0.0148s/iter; left time: 227.1868s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.84s
Steps: 226 | Train Loss: 0.0638752 Vali Loss: 0.0608141 Test Loss: 0.0631300
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0624260
	speed: 0.0329s/iter; left time: 503.0974s
	iters: 200, epoch: 33 | loss: 0.0629199
	speed: 0.0171s/iter; left time: 259.8773s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.15s
Steps: 226 | Train Loss: 0.0637798 Vali Loss: 0.0608580 Test Loss: 0.0632233
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0678928
	speed: 0.0304s/iter; left time: 457.5547s
	iters: 200, epoch: 34 | loss: 0.0654967
	speed: 0.0183s/iter; left time: 273.0672s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0635867 Vali Loss: 0.0606437 Test Loss: 0.0629190
Validation loss decreased (0.060767 --> 0.060644).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0626763
	speed: 0.0327s/iter; left time: 484.0725s
	iters: 200, epoch: 35 | loss: 0.0595072
	speed: 0.0097s/iter; left time: 142.8096s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0636496 Vali Loss: 0.0607713 Test Loss: 0.0630210
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0632355
	speed: 0.0310s/iter; left time: 452.4127s
	iters: 200, epoch: 36 | loss: 0.0626784
	speed: 0.0165s/iter; left time: 239.2671s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0635934 Vali Loss: 0.0607727 Test Loss: 0.0631237
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0646072
	speed: 0.0299s/iter; left time: 429.9258s
	iters: 200, epoch: 37 | loss: 0.0619449
	speed: 0.0146s/iter; left time: 208.4793s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.0637344 Vali Loss: 0.0604826 Test Loss: 0.0628754
Validation loss decreased (0.060644 --> 0.060483).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0628808
	speed: 0.0353s/iter; left time: 498.5920s
	iters: 200, epoch: 38 | loss: 0.0625452
	speed: 0.0173s/iter; left time: 243.1245s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0635299 Vali Loss: 0.0607594 Test Loss: 0.0630251
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0618605
	speed: 0.0328s/iter; left time: 456.1279s
	iters: 200, epoch: 39 | loss: 0.0630019
	speed: 0.0151s/iter; left time: 209.1916s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0635054 Vali Loss: 0.0604440 Test Loss: 0.0628059
Validation loss decreased (0.060483 --> 0.060444).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0633831
	speed: 0.0341s/iter; left time: 467.0752s
	iters: 200, epoch: 40 | loss: 0.0619897
	speed: 0.0166s/iter; left time: 226.1921s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0633871 Vali Loss: 0.0604068 Test Loss: 0.0627636
Validation loss decreased (0.060444 --> 0.060407).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0637393
	speed: 0.0338s/iter; left time: 455.1581s
	iters: 200, epoch: 41 | loss: 0.0667270
	speed: 0.0151s/iter; left time: 202.2399s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:03.83s
Steps: 226 | Train Loss: 0.0634874 Vali Loss: 0.0605568 Test Loss: 0.0628070
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0642112
	speed: 0.0318s/iter; left time: 421.1110s
	iters: 200, epoch: 42 | loss: 0.0642818
	speed: 0.0169s/iter; left time: 221.9380s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0634600 Vali Loss: 0.0604853 Test Loss: 0.0628637
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0662356
	speed: 0.0292s/iter; left time: 380.4633s
	iters: 200, epoch: 43 | loss: 0.0618695
	speed: 0.0121s/iter; left time: 155.9720s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.08s
Steps: 226 | Train Loss: 0.0635914 Vali Loss: 0.0605979 Test Loss: 0.0628928
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0643022
	speed: 0.0287s/iter; left time: 366.8359s
	iters: 200, epoch: 44 | loss: 0.0604591
	speed: 0.0145s/iter; left time: 183.5275s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.51s
Steps: 226 | Train Loss: 0.0634527 Vali Loss: 0.0604677 Test Loss: 0.0628158
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0598588
	speed: 0.0316s/iter; left time: 397.3438s
	iters: 200, epoch: 45 | loss: 0.0621295
	speed: 0.0166s/iter; left time: 206.4994s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.96s
Steps: 226 | Train Loss: 0.0632411 Vali Loss: 0.0605021 Test Loss: 0.0628431
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0609445
	speed: 0.0321s/iter; left time: 395.3985s
	iters: 200, epoch: 46 | loss: 0.0611818
	speed: 0.0165s/iter; left time: 202.0675s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.97s
Steps: 226 | Train Loss: 0.0634811 Vali Loss: 0.0604158 Test Loss: 0.0629384
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0620083
	speed: 0.0314s/iter; left time: 380.1078s
	iters: 200, epoch: 47 | loss: 0.0650088
	speed: 0.0151s/iter; left time: 180.8231s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.62s
Steps: 226 | Train Loss: 0.0632877 Vali Loss: 0.0604093 Test Loss: 0.0628394
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0626589
	speed: 0.0335s/iter; left time: 397.7635s
	iters: 200, epoch: 48 | loss: 0.0617674
	speed: 0.0155s/iter; left time: 182.0722s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.0634256 Vali Loss: 0.0605984 Test Loss: 0.0629385
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0801785
	speed: 0.0339s/iter; left time: 395.3750s
	iters: 200, epoch: 49 | loss: 0.0644043
	speed: 0.0182s/iter; left time: 210.3114s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.36s
Steps: 226 | Train Loss: 0.0633992 Vali Loss: 0.0605179 Test Loss: 0.0629123
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0656605
	speed: 0.0339s/iter; left time: 387.2193s
	iters: 200, epoch: 50 | loss: 0.0648636
	speed: 0.0154s/iter; left time: 174.7385s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.0633635 Vali Loss: 0.0603140 Test Loss: 0.0628248
Validation loss decreased (0.060407 --> 0.060314).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0649489
	speed: 0.0326s/iter; left time: 365.2338s
	iters: 200, epoch: 51 | loss: 0.0648584
	speed: 0.0186s/iter; left time: 206.0547s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0633087 Vali Loss: 0.0604656 Test Loss: 0.0627679
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0614670
	speed: 0.0305s/iter; left time: 334.5138s
	iters: 200, epoch: 52 | loss: 0.0604024
	speed: 0.0191s/iter; left time: 208.1896s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0634348 Vali Loss: 0.0603848 Test Loss: 0.0627892
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0597789
	speed: 0.0318s/iter; left time: 342.0200s
	iters: 200, epoch: 53 | loss: 0.0624102
	speed: 0.0164s/iter; left time: 175.0338s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.96s
Steps: 226 | Train Loss: 0.0632580 Vali Loss: 0.0603975 Test Loss: 0.0627268
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0661077
	speed: 0.0301s/iter; left time: 316.5067s
	iters: 200, epoch: 54 | loss: 0.0639733
	speed: 0.0164s/iter; left time: 171.1500s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.0633711 Vali Loss: 0.0603307 Test Loss: 0.0627780
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0634417
	speed: 0.0326s/iter; left time: 335.6777s
	iters: 200, epoch: 55 | loss: 0.0628030
	speed: 0.0150s/iter; left time: 153.2811s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0632948 Vali Loss: 0.0603213 Test Loss: 0.0627216
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0656375
	speed: 0.0335s/iter; left time: 337.8010s
	iters: 200, epoch: 56 | loss: 0.0626009
	speed: 0.0169s/iter; left time: 168.4996s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0632629 Vali Loss: 0.0602907 Test Loss: 0.0627626
Validation loss decreased (0.060314 --> 0.060291).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0606608
	speed: 0.0341s/iter; left time: 335.6841s
	iters: 200, epoch: 57 | loss: 0.0667918
	speed: 0.0169s/iter; left time: 164.2175s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.09s
Steps: 226 | Train Loss: 0.0632846 Vali Loss: 0.0604346 Test Loss: 0.0628324
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0614186
	speed: 0.0319s/iter; left time: 306.5196s
	iters: 200, epoch: 58 | loss: 0.0616034
	speed: 0.0177s/iter; left time: 168.5387s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0632635 Vali Loss: 0.0603961 Test Loss: 0.0627379
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0648625
	speed: 0.0300s/iter; left time: 281.9206s
	iters: 200, epoch: 59 | loss: 0.0606599
	speed: 0.0150s/iter; left time: 139.3519s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:03.53s
Steps: 226 | Train Loss: 0.0632889 Vali Loss: 0.0604271 Test Loss: 0.0627835
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0595693
	speed: 0.0356s/iter; left time: 325.9394s
	iters: 200, epoch: 60 | loss: 0.0608444
	speed: 0.0207s/iter; left time: 187.7066s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.90s
Steps: 226 | Train Loss: 0.0632423 Vali Loss: 0.0604059 Test Loss: 0.0627771
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0611959
	speed: 0.0372s/iter; left time: 332.8292s
	iters: 200, epoch: 61 | loss: 0.0614771
	speed: 0.0206s/iter; left time: 182.0880s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.71s
Steps: 226 | Train Loss: 0.0633894 Vali Loss: 0.0603203 Test Loss: 0.0627730
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0627258
	speed: 0.0374s/iter; left time: 325.8472s
	iters: 200, epoch: 62 | loss: 0.0658270
	speed: 0.0177s/iter; left time: 152.7197s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.72s
Steps: 226 | Train Loss: 0.0631786 Vali Loss: 0.0603669 Test Loss: 0.0628356
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0643718
	speed: 0.0334s/iter; left time: 283.9527s
	iters: 200, epoch: 63 | loss: 0.0651433
	speed: 0.0153s/iter; left time: 128.7398s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0633000 Vali Loss: 0.0603122 Test Loss: 0.0626970
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0600079
	speed: 0.0272s/iter; left time: 224.9807s
	iters: 200, epoch: 64 | loss: 0.0663806
	speed: 0.0208s/iter; left time: 169.6586s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0631326 Vali Loss: 0.0603702 Test Loss: 0.0627292
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0659940
	speed: 0.0382s/iter; left time: 306.6183s
	iters: 200, epoch: 65 | loss: 0.0599802
	speed: 0.0227s/iter; left time: 180.2711s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:05.17s
Steps: 226 | Train Loss: 0.0632878 Vali Loss: 0.0603091 Test Loss: 0.0626982
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0627154
	speed: 0.0364s/iter; left time: 284.1278s
	iters: 200, epoch: 66 | loss: 0.0643168
	speed: 0.0162s/iter; left time: 124.9778s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:04.09s
Steps: 226 | Train Loss: 0.0632404 Vali Loss: 0.0603718 Test Loss: 0.0627312
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010896671563386917, rmse:0.10438712686300278, mae:0.06276259571313858, rse:0.3944275379180908
Intermediate time for IT and pred_len 24: 00h:09m:39.47s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2777186
	speed: 0.0429s/iter; left time: 961.0489s
	iters: 200, epoch: 1 | loss: 0.2569139
	speed: 0.0150s/iter; left time: 335.2937s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.07s
Steps: 225 | Train Loss: 0.2819139 Vali Loss: 0.1959135 Test Loss: 0.2025781
Validation loss decreased (inf --> 0.195914).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1503462
	speed: 0.0330s/iter; left time: 731.6456s
	iters: 200, epoch: 2 | loss: 0.1258866
	speed: 0.0166s/iter; left time: 367.2011s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.1587552 Vali Loss: 0.1118642 Test Loss: 0.1198275
Validation loss decreased (0.195914 --> 0.111864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1137129
	speed: 0.0332s/iter; left time: 729.7910s
	iters: 200, epoch: 3 | loss: 0.1097044
	speed: 0.0152s/iter; left time: 331.1760s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.75s
Steps: 225 | Train Loss: 0.1154826 Vali Loss: 0.1006880 Test Loss: 0.1063467
Validation loss decreased (0.111864 --> 0.100688).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1010056
	speed: 0.0342s/iter; left time: 742.1826s
	iters: 200, epoch: 4 | loss: 0.1015733
	speed: 0.0171s/iter; left time: 368.8469s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.1046104 Vali Loss: 0.0929637 Test Loss: 0.0947932
Validation loss decreased (0.100688 --> 0.092964).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0931383
	speed: 0.0321s/iter; left time: 690.8377s
	iters: 200, epoch: 5 | loss: 0.0927026
	speed: 0.0128s/iter; left time: 274.1652s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.45s
Steps: 225 | Train Loss: 0.0980567 Vali Loss: 0.0881273 Test Loss: 0.0907078
Validation loss decreased (0.092964 --> 0.088127).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0922307
	speed: 0.0324s/iter; left time: 688.9151s
	iters: 200, epoch: 6 | loss: 0.0929584
	speed: 0.0150s/iter; left time: 318.6271s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.63s
Steps: 225 | Train Loss: 0.0937415 Vali Loss: 0.0870895 Test Loss: 0.0893921
Validation loss decreased (0.088127 --> 0.087090).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0876376
	speed: 0.0304s/iter; left time: 640.8364s
	iters: 200, epoch: 7 | loss: 0.0913200
	speed: 0.0152s/iter; left time: 319.4856s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.58s
Steps: 225 | Train Loss: 0.0917897 Vali Loss: 0.0873184 Test Loss: 0.0884443
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0914330
	speed: 0.0311s/iter; left time: 647.4304s
	iters: 200, epoch: 8 | loss: 0.0905815
	speed: 0.0135s/iter; left time: 280.3413s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.43s
Steps: 225 | Train Loss: 0.0901037 Vali Loss: 0.0847947 Test Loss: 0.0869199
Validation loss decreased (0.087090 --> 0.084795).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0856609
	speed: 0.0312s/iter; left time: 642.2962s
	iters: 200, epoch: 9 | loss: 0.0856232
	speed: 0.0148s/iter; left time: 304.3502s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.58s
Steps: 225 | Train Loss: 0.0886598 Vali Loss: 0.0832606 Test Loss: 0.0864825
Validation loss decreased (0.084795 --> 0.083261).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0846817
	speed: 0.0336s/iter; left time: 684.0704s
	iters: 200, epoch: 10 | loss: 0.0886836
	speed: 0.0174s/iter; left time: 353.2343s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0876424 Vali Loss: 0.0821826 Test Loss: 0.0856964
Validation loss decreased (0.083261 --> 0.082183).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0854393
	speed: 0.0325s/iter; left time: 653.9121s
	iters: 200, epoch: 11 | loss: 0.0864105
	speed: 0.0167s/iter; left time: 333.8589s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0867340 Vali Loss: 0.0822964 Test Loss: 0.0857694
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0855199
	speed: 0.0344s/iter; left time: 685.3361s
	iters: 200, epoch: 12 | loss: 0.0839509
	speed: 0.0159s/iter; left time: 314.3120s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0861404 Vali Loss: 0.0814085 Test Loss: 0.0855265
Validation loss decreased (0.082183 --> 0.081408).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0868975
	speed: 0.0349s/iter; left time: 688.2557s
	iters: 200, epoch: 13 | loss: 0.0869677
	speed: 0.0173s/iter; left time: 338.8974s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.25s
Steps: 225 | Train Loss: 0.0854552 Vali Loss: 0.0811413 Test Loss: 0.0852011
Validation loss decreased (0.081408 --> 0.081141).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0895584
	speed: 0.0358s/iter; left time: 697.4273s
	iters: 200, epoch: 14 | loss: 0.0863725
	speed: 0.0185s/iter; left time: 358.6055s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0850139 Vali Loss: 0.0810665 Test Loss: 0.0850852
Validation loss decreased (0.081141 --> 0.081066).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0829848
	speed: 0.0370s/iter; left time: 711.9327s
	iters: 200, epoch: 15 | loss: 0.0862410
	speed: 0.0177s/iter; left time: 339.0894s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0848629 Vali Loss: 0.0807258 Test Loss: 0.0846477
Validation loss decreased (0.081066 --> 0.080726).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0863633
	speed: 0.0348s/iter; left time: 661.3818s
	iters: 200, epoch: 16 | loss: 0.0844380
	speed: 0.0158s/iter; left time: 299.7772s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0842551 Vali Loss: 0.0807420 Test Loss: 0.0847929
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0799475
	speed: 0.0352s/iter; left time: 661.7758s
	iters: 200, epoch: 17 | loss: 0.0838205
	speed: 0.0180s/iter; left time: 337.4556s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0838634 Vali Loss: 0.0803780 Test Loss: 0.0846857
Validation loss decreased (0.080726 --> 0.080378).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0869446
	speed: 0.0341s/iter; left time: 633.0774s
	iters: 200, epoch: 18 | loss: 0.0812265
	speed: 0.0150s/iter; left time: 276.6820s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0837593 Vali Loss: 0.0805071 Test Loss: 0.0846009
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0842634
	speed: 0.0311s/iter; left time: 570.3352s
	iters: 200, epoch: 19 | loss: 0.0814005
	speed: 0.0149s/iter; left time: 272.7924s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0835424 Vali Loss: 0.0801593 Test Loss: 0.0845342
Validation loss decreased (0.080378 --> 0.080159).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0785947
	speed: 0.0302s/iter; left time: 546.5463s
	iters: 200, epoch: 20 | loss: 0.0831343
	speed: 0.0098s/iter; left time: 176.4160s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:02.93s
Steps: 225 | Train Loss: 0.0830553 Vali Loss: 0.0797146 Test Loss: 0.0843138
Validation loss decreased (0.080159 --> 0.079715).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0833767
	speed: 0.0305s/iter; left time: 545.3059s
	iters: 200, epoch: 21 | loss: 0.0770623
	speed: 0.0164s/iter; left time: 291.6880s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.72s
Steps: 225 | Train Loss: 0.0830372 Vali Loss: 0.0799927 Test Loss: 0.0844230
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0853504
	speed: 0.0342s/iter; left time: 605.1978s
	iters: 200, epoch: 22 | loss: 0.0816715
	speed: 0.0197s/iter; left time: 345.5864s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0829589 Vali Loss: 0.0797679 Test Loss: 0.0844153
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0850140
	speed: 0.0351s/iter; left time: 612.2322s
	iters: 200, epoch: 23 | loss: 0.0841234
	speed: 0.0171s/iter; left time: 296.0620s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.25s
Steps: 225 | Train Loss: 0.0828476 Vali Loss: 0.0798274 Test Loss: 0.0842461
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0811909
	speed: 0.0340s/iter; left time: 586.3451s
	iters: 200, epoch: 24 | loss: 0.0802586
	speed: 0.0180s/iter; left time: 307.6494s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.0826429 Vali Loss: 0.0795573 Test Loss: 0.0841798
Validation loss decreased (0.079715 --> 0.079557).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0818036
	speed: 0.0345s/iter; left time: 587.3012s
	iters: 200, epoch: 25 | loss: 0.0837724
	speed: 0.0170s/iter; left time: 286.9996s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.0825855 Vali Loss: 0.0795854 Test Loss: 0.0841127
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0862241
	speed: 0.0333s/iter; left time: 558.4197s
	iters: 200, epoch: 26 | loss: 0.0794363
	speed: 0.0175s/iter; left time: 291.1472s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.10s
Steps: 225 | Train Loss: 0.0824944 Vali Loss: 0.0795109 Test Loss: 0.0841575
Validation loss decreased (0.079557 --> 0.079511).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0837308
	speed: 0.0366s/iter; left time: 606.5219s
	iters: 200, epoch: 27 | loss: 0.0837827
	speed: 0.0166s/iter; left time: 272.6125s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.23s
Steps: 225 | Train Loss: 0.0824191 Vali Loss: 0.0793480 Test Loss: 0.0840780
Validation loss decreased (0.079511 --> 0.079348).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0826852
	speed: 0.0324s/iter; left time: 529.1745s
	iters: 200, epoch: 28 | loss: 0.0801488
	speed: 0.0174s/iter; left time: 282.3352s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0824533 Vali Loss: 0.0794025 Test Loss: 0.0841289
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0853649
	speed: 0.0334s/iter; left time: 538.3358s
	iters: 200, epoch: 29 | loss: 0.0783699
	speed: 0.0182s/iter; left time: 290.4769s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0823509 Vali Loss: 0.0792908 Test Loss: 0.0840861
Validation loss decreased (0.079348 --> 0.079291).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0823211
	speed: 0.0327s/iter; left time: 519.9043s
	iters: 200, epoch: 30 | loss: 0.0827666
	speed: 0.0176s/iter; left time: 277.8531s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.0822907 Vali Loss: 0.0792715 Test Loss: 0.0839312
Validation loss decreased (0.079291 --> 0.079272).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0808998
	speed: 0.0325s/iter; left time: 509.1454s
	iters: 200, epoch: 31 | loss: 0.0807928
	speed: 0.0192s/iter; left time: 298.8753s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0821265 Vali Loss: 0.0792237 Test Loss: 0.0839969
Validation loss decreased (0.079272 --> 0.079224).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0815765
	speed: 0.0357s/iter; left time: 550.7602s
	iters: 200, epoch: 32 | loss: 0.0843080
	speed: 0.0174s/iter; left time: 266.2159s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0820431 Vali Loss: 0.0791623 Test Loss: 0.0839657
Validation loss decreased (0.079224 --> 0.079162).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0847938
	speed: 0.0354s/iter; left time: 537.3809s
	iters: 200, epoch: 33 | loss: 0.0855501
	speed: 0.0203s/iter; left time: 307.0463s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.0820090 Vali Loss: 0.0793583 Test Loss: 0.0840243
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0875249
	speed: 0.0349s/iter; left time: 522.5661s
	iters: 200, epoch: 34 | loss: 0.0807978
	speed: 0.0174s/iter; left time: 258.6481s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0820447 Vali Loss: 0.0791663 Test Loss: 0.0839047
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0820323
	speed: 0.0336s/iter; left time: 496.1109s
	iters: 200, epoch: 35 | loss: 0.0817046
	speed: 0.0170s/iter; left time: 248.7298s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.20s
Steps: 225 | Train Loss: 0.0820172 Vali Loss: 0.0792771 Test Loss: 0.0839085
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0853832
	speed: 0.0383s/iter; left time: 555.7814s
	iters: 200, epoch: 36 | loss: 0.0840510
	speed: 0.0205s/iter; left time: 295.2685s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.81s
Steps: 225 | Train Loss: 0.0818907 Vali Loss: 0.0792983 Test Loss: 0.0839392
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0841038
	speed: 0.0337s/iter; left time: 481.5279s
	iters: 200, epoch: 37 | loss: 0.0768642
	speed: 0.0155s/iter; left time: 220.8194s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0818594 Vali Loss: 0.0791648 Test Loss: 0.0838817
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0840093
	speed: 0.0330s/iter; left time: 464.6572s
	iters: 200, epoch: 38 | loss: 0.0796729
	speed: 0.0155s/iter; left time: 217.0989s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0819101 Vali Loss: 0.0791788 Test Loss: 0.0838323
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0785457
	speed: 0.0331s/iter; left time: 458.1444s
	iters: 200, epoch: 39 | loss: 0.0818148
	speed: 0.0174s/iter; left time: 238.7875s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0817813 Vali Loss: 0.0791711 Test Loss: 0.0839773
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0786763
	speed: 0.0342s/iter; left time: 465.5255s
	iters: 200, epoch: 40 | loss: 0.0864732
	speed: 0.0170s/iter; left time: 229.6591s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.0818996 Vali Loss: 0.0791738 Test Loss: 0.0838895
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0772040
	speed: 0.0364s/iter; left time: 487.5658s
	iters: 200, epoch: 41 | loss: 0.0768942
	speed: 0.0187s/iter; left time: 248.9795s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0819151 Vali Loss: 0.0793107 Test Loss: 0.0837918
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0828241
	speed: 0.0319s/iter; left time: 420.5608s
	iters: 200, epoch: 42 | loss: 0.0808430
	speed: 0.0152s/iter; left time: 199.3043s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0817570 Vali Loss: 0.0792095 Test Loss: 0.0838636
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01884772628545761, rmse:0.13728702068328857, mae:0.08396567404270172, rse:0.5190970301628113
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2806228
	speed: 0.0206s/iter; left time: 461.4312s
	iters: 200, epoch: 1 | loss: 0.2607370
	speed: 0.0164s/iter; left time: 364.9300s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.2831202 Vali Loss: 0.1983966 Test Loss: 0.2050680
Validation loss decreased (inf --> 0.198397).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1462103
	speed: 0.0340s/iter; left time: 753.8183s
	iters: 200, epoch: 2 | loss: 0.1279159
	speed: 0.0181s/iter; left time: 398.7578s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.1583383 Vali Loss: 0.1096080 Test Loss: 0.1172922
Validation loss decreased (0.198397 --> 0.109608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1173452
	speed: 0.0341s/iter; left time: 749.0793s
	iters: 200, epoch: 3 | loss: 0.1107076
	speed: 0.0160s/iter; left time: 348.6146s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.1156612 Vali Loss: 0.0991728 Test Loss: 0.1039855
Validation loss decreased (0.109608 --> 0.099173).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1042874
	speed: 0.0383s/iter; left time: 831.3813s
	iters: 200, epoch: 4 | loss: 0.1006773
	speed: 0.0155s/iter; left time: 334.3438s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.1042152 Vali Loss: 0.0926457 Test Loss: 0.0946814
Validation loss decreased (0.099173 --> 0.092646).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0966639
	speed: 0.0351s/iter; left time: 755.6407s
	iters: 200, epoch: 5 | loss: 0.0967009
	speed: 0.0197s/iter; left time: 422.0090s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.0973508 Vali Loss: 0.0883805 Test Loss: 0.0907344
Validation loss decreased (0.092646 --> 0.088380).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0990865
	speed: 0.0327s/iter; left time: 695.9985s
	iters: 200, epoch: 6 | loss: 0.0904820
	speed: 0.0158s/iter; left time: 333.7299s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0936973 Vali Loss: 0.0869135 Test Loss: 0.0890371
Validation loss decreased (0.088380 --> 0.086913).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0910847
	speed: 0.0330s/iter; left time: 694.2954s
	iters: 200, epoch: 7 | loss: 0.0939122
	speed: 0.0163s/iter; left time: 341.1729s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0915057 Vali Loss: 0.0855780 Test Loss: 0.0873110
Validation loss decreased (0.086913 --> 0.085578).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0887241
	speed: 0.0327s/iter; left time: 681.5565s
	iters: 200, epoch: 8 | loss: 0.0864781
	speed: 0.0175s/iter; left time: 362.9362s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.0897954 Vali Loss: 0.0844579 Test Loss: 0.0867044
Validation loss decreased (0.085578 --> 0.084458).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0920255
	speed: 0.0335s/iter; left time: 691.0493s
	iters: 200, epoch: 9 | loss: 0.0843511
	speed: 0.0175s/iter; left time: 358.8526s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.0883764 Vali Loss: 0.0829569 Test Loss: 0.0858086
Validation loss decreased (0.084458 --> 0.082957).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0842601
	speed: 0.0332s/iter; left time: 675.9181s
	iters: 200, epoch: 10 | loss: 0.0844496
	speed: 0.0149s/iter; left time: 302.8900s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.56s
Steps: 225 | Train Loss: 0.0878313 Vali Loss: 0.0819504 Test Loss: 0.0851816
Validation loss decreased (0.082957 --> 0.081950).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0903435
	speed: 0.0331s/iter; left time: 667.1771s
	iters: 200, epoch: 11 | loss: 0.0884159
	speed: 0.0129s/iter; left time: 258.5066s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0869585 Vali Loss: 0.0821840 Test Loss: 0.0849077
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0880806
	speed: 0.0311s/iter; left time: 618.9819s
	iters: 200, epoch: 12 | loss: 0.0892761
	speed: 0.0169s/iter; left time: 335.8036s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0861288 Vali Loss: 0.0821766 Test Loss: 0.0846017
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0847698
	speed: 0.0335s/iter; left time: 659.6273s
	iters: 200, epoch: 13 | loss: 0.0886499
	speed: 0.0155s/iter; left time: 303.6435s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0856551 Vali Loss: 0.0813699 Test Loss: 0.0850033
Validation loss decreased (0.081950 --> 0.081370).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0837286
	speed: 0.0344s/iter; left time: 669.7197s
	iters: 200, epoch: 14 | loss: 0.0861768
	speed: 0.0163s/iter; left time: 315.9275s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.0849992 Vali Loss: 0.0807958 Test Loss: 0.0844888
Validation loss decreased (0.081370 --> 0.080796).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0842981
	speed: 0.0323s/iter; left time: 620.8995s
	iters: 200, epoch: 15 | loss: 0.0860519
	speed: 0.0152s/iter; left time: 290.3877s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.0846049 Vali Loss: 0.0808427 Test Loss: 0.0845398
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0834388
	speed: 0.0315s/iter; left time: 599.4554s
	iters: 200, epoch: 16 | loss: 0.0891821
	speed: 0.0158s/iter; left time: 299.3982s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0842148 Vali Loss: 0.0807076 Test Loss: 0.0839392
Validation loss decreased (0.080796 --> 0.080708).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0813520
	speed: 0.0341s/iter; left time: 640.7734s
	iters: 200, epoch: 17 | loss: 0.0820236
	speed: 0.0158s/iter; left time: 295.8973s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0841889 Vali Loss: 0.0807928 Test Loss: 0.0843021
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0794783
	speed: 0.0315s/iter; left time: 584.3165s
	iters: 200, epoch: 18 | loss: 0.0819564
	speed: 0.0150s/iter; left time: 277.6659s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.65s
Steps: 225 | Train Loss: 0.0837958 Vali Loss: 0.0800502 Test Loss: 0.0839954
Validation loss decreased (0.080708 --> 0.080050).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0825035
	speed: 0.0330s/iter; left time: 604.9470s
	iters: 200, epoch: 19 | loss: 0.0834793
	speed: 0.0156s/iter; left time: 284.6553s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0833411 Vali Loss: 0.0804612 Test Loss: 0.0840887
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0849448
	speed: 0.0320s/iter; left time: 580.4257s
	iters: 200, epoch: 20 | loss: 0.0859698
	speed: 0.0160s/iter; left time: 289.2167s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.80s
Steps: 225 | Train Loss: 0.0833001 Vali Loss: 0.0801358 Test Loss: 0.0839652
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0786478
	speed: 0.0340s/iter; left time: 609.4255s
	iters: 200, epoch: 21 | loss: 0.0870727
	speed: 0.0189s/iter; left time: 336.6549s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.0831646 Vali Loss: 0.0799826 Test Loss: 0.0838264
Validation loss decreased (0.080050 --> 0.079983).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0886545
	speed: 0.0376s/iter; left time: 665.4101s
	iters: 200, epoch: 22 | loss: 0.0784292
	speed: 0.0182s/iter; left time: 319.6706s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0830313 Vali Loss: 0.0801070 Test Loss: 0.0838581
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0820926
	speed: 0.0332s/iter; left time: 578.8328s
	iters: 200, epoch: 23 | loss: 0.0841963
	speed: 0.0163s/iter; left time: 282.6336s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.82s
Steps: 225 | Train Loss: 0.0829299 Vali Loss: 0.0797106 Test Loss: 0.0837441
Validation loss decreased (0.079983 --> 0.079711).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0813720
	speed: 0.0337s/iter; left time: 580.5527s
	iters: 200, epoch: 24 | loss: 0.0823814
	speed: 0.0178s/iter; left time: 304.4126s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0825387 Vali Loss: 0.0800385 Test Loss: 0.0841180
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0840227
	speed: 0.0329s/iter; left time: 559.7043s
	iters: 200, epoch: 25 | loss: 0.0792319
	speed: 0.0180s/iter; left time: 304.6460s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0825908 Vali Loss: 0.0795311 Test Loss: 0.0836701
Validation loss decreased (0.079711 --> 0.079531).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0843800
	speed: 0.0321s/iter; left time: 538.7035s
	iters: 200, epoch: 26 | loss: 0.0830451
	speed: 0.0152s/iter; left time: 253.3296s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.0825504 Vali Loss: 0.0797684 Test Loss: 0.0835431
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0853239
	speed: 0.0337s/iter; left time: 557.7382s
	iters: 200, epoch: 27 | loss: 0.0819135
	speed: 0.0178s/iter; left time: 292.9642s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.0823064 Vali Loss: 0.0796968 Test Loss: 0.0834956
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0836991
	speed: 0.0340s/iter; left time: 554.6246s
	iters: 200, epoch: 28 | loss: 0.0823716
	speed: 0.0173s/iter; left time: 281.3805s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.0823479 Vali Loss: 0.0795949 Test Loss: 0.0834777
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0901566
	speed: 0.0337s/iter; left time: 542.6435s
	iters: 200, epoch: 29 | loss: 0.0815871
	speed: 0.0180s/iter; left time: 287.2806s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.0822618 Vali Loss: 0.0793890 Test Loss: 0.0835268
Validation loss decreased (0.079531 --> 0.079389).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0797134
	speed: 0.0345s/iter; left time: 548.2422s
	iters: 200, epoch: 30 | loss: 0.0839581
	speed: 0.0160s/iter; left time: 252.8854s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0822651 Vali Loss: 0.0798529 Test Loss: 0.0836726
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0784735
	speed: 0.0332s/iter; left time: 520.2067s
	iters: 200, epoch: 31 | loss: 0.0858933
	speed: 0.0160s/iter; left time: 248.0802s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0821580 Vali Loss: 0.0797668 Test Loss: 0.0835013
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0843875
	speed: 0.0352s/iter; left time: 543.4274s
	iters: 200, epoch: 32 | loss: 0.0813760
	speed: 0.0199s/iter; left time: 304.9069s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.0820451 Vali Loss: 0.0796548 Test Loss: 0.0835479
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0811357
	speed: 0.0326s/iter; left time: 495.2098s
	iters: 200, epoch: 33 | loss: 0.0862090
	speed: 0.0151s/iter; left time: 228.7651s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.67s
Steps: 225 | Train Loss: 0.0819303 Vali Loss: 0.0795747 Test Loss: 0.0835437
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0850448
	speed: 0.0318s/iter; left time: 476.1474s
	iters: 200, epoch: 34 | loss: 0.0820336
	speed: 0.0162s/iter; left time: 240.9205s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0819054 Vali Loss: 0.0796066 Test Loss: 0.0836889
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0863909
	speed: 0.0340s/iter; left time: 501.8651s
	iters: 200, epoch: 35 | loss: 0.0772811
	speed: 0.0188s/iter; left time: 275.7436s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0818685 Vali Loss: 0.0795604 Test Loss: 0.0834159
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0811598
	speed: 0.0343s/iter; left time: 497.7105s
	iters: 200, epoch: 36 | loss: 0.0852249
	speed: 0.0159s/iter; left time: 229.8855s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0818304 Vali Loss: 0.0795000 Test Loss: 0.0835749
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0823470
	speed: 0.0330s/iter; left time: 471.3904s
	iters: 200, epoch: 37 | loss: 0.0786397
	speed: 0.0129s/iter; left time: 182.7688s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0818090 Vali Loss: 0.0792918 Test Loss: 0.0834800
Validation loss decreased (0.079389 --> 0.079292).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0813787
	speed: 0.0305s/iter; left time: 429.1995s
	iters: 200, epoch: 38 | loss: 0.0800484
	speed: 0.0155s/iter; left time: 217.1797s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.0817770 Vali Loss: 0.0793174 Test Loss: 0.0834549
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0846778
	speed: 0.0314s/iter; left time: 434.5278s
	iters: 200, epoch: 39 | loss: 0.0876444
	speed: 0.0143s/iter; left time: 197.0363s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.50s
Steps: 225 | Train Loss: 0.0818475 Vali Loss: 0.0794521 Test Loss: 0.0833526
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0840096
	speed: 0.0312s/iter; left time: 425.0502s
	iters: 200, epoch: 40 | loss: 0.0797139
	speed: 0.0138s/iter; left time: 186.2737s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.47s
Steps: 225 | Train Loss: 0.0818729 Vali Loss: 0.0792610 Test Loss: 0.0834639
Validation loss decreased (0.079292 --> 0.079261).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0809445
	speed: 0.0320s/iter; left time: 429.4419s
	iters: 200, epoch: 41 | loss: 0.0835953
	speed: 0.0162s/iter; left time: 215.7696s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.0817603 Vali Loss: 0.0793753 Test Loss: 0.0834233
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0818785
	speed: 0.0299s/iter; left time: 394.2577s
	iters: 200, epoch: 42 | loss: 0.0793468
	speed: 0.0134s/iter; left time: 175.2373s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.27s
Steps: 225 | Train Loss: 0.0819900 Vali Loss: 0.0794616 Test Loss: 0.0834463
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.1099899
	speed: 0.0310s/iter; left time: 400.9493s
	iters: 200, epoch: 43 | loss: 0.0863156
	speed: 0.0151s/iter; left time: 193.7663s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.65s
Steps: 225 | Train Loss: 0.0818719 Vali Loss: 0.0794408 Test Loss: 0.0834186
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0830130
	speed: 0.0323s/iter; left time: 411.4115s
	iters: 200, epoch: 44 | loss: 0.0839347
	speed: 0.0165s/iter; left time: 208.6284s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0817068 Vali Loss: 0.0794648 Test Loss: 0.0834181
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0816569
	speed: 0.0345s/iter; left time: 431.1847s
	iters: 200, epoch: 45 | loss: 0.0795054
	speed: 0.0202s/iter; left time: 250.7269s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0817080 Vali Loss: 0.0793059 Test Loss: 0.0834380
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0873833
	speed: 0.0390s/iter; left time: 479.1947s
	iters: 200, epoch: 46 | loss: 0.0815155
	speed: 0.0204s/iter; left time: 247.8165s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0816783 Vali Loss: 0.0794770 Test Loss: 0.0834538
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0832890
	speed: 0.0357s/iter; left time: 429.6640s
	iters: 200, epoch: 47 | loss: 0.0856036
	speed: 0.0253s/iter; left time: 302.3401s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.21s
Steps: 225 | Train Loss: 0.0817624 Vali Loss: 0.0793323 Test Loss: 0.0834635
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0817167
	speed: 0.0403s/iter; left time: 476.9329s
	iters: 200, epoch: 48 | loss: 0.0815217
	speed: 0.0191s/iter; left time: 223.7603s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0818865 Vali Loss: 0.0792611 Test Loss: 0.0835811
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0825997
	speed: 0.0336s/iter; left time: 389.4293s
	iters: 200, epoch: 49 | loss: 0.0801011
	speed: 0.0181s/iter; left time: 208.5030s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0816532 Vali Loss: 0.0792115 Test Loss: 0.0833805
Validation loss decreased (0.079261 --> 0.079212).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0815825
	speed: 0.0373s/iter; left time: 424.2101s
	iters: 200, epoch: 50 | loss: 0.0805301
	speed: 0.0222s/iter; left time: 250.2353s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.06s
Steps: 225 | Train Loss: 0.0819056 Vali Loss: 0.0794098 Test Loss: 0.0833791
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0823547
	speed: 0.0388s/iter; left time: 432.2377s
	iters: 200, epoch: 51 | loss: 0.0836692
	speed: 0.0183s/iter; left time: 202.7276s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0818337 Vali Loss: 0.0793652 Test Loss: 0.0833687
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0836443
	speed: 0.0391s/iter; left time: 426.8916s
	iters: 200, epoch: 52 | loss: 0.0822562
	speed: 0.0214s/iter; left time: 232.0221s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.82s
Steps: 225 | Train Loss: 0.0817083 Vali Loss: 0.0794672 Test Loss: 0.0835472
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0861320
	speed: 0.0332s/iter; left time: 355.3428s
	iters: 200, epoch: 53 | loss: 0.0794507
	speed: 0.0209s/iter; left time: 221.4396s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0817173 Vali Loss: 0.0793203 Test Loss: 0.0834329
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0831790
	speed: 0.0318s/iter; left time: 333.2922s
	iters: 200, epoch: 54 | loss: 0.0841627
	speed: 0.0167s/iter; left time: 173.5933s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0816611 Vali Loss: 0.0792993 Test Loss: 0.0834191
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0849556
	speed: 0.0365s/iter; left time: 373.7607s
	iters: 200, epoch: 55 | loss: 0.0824604
	speed: 0.0200s/iter; left time: 203.3368s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.78s
Steps: 225 | Train Loss: 0.0817934 Vali Loss: 0.0794798 Test Loss: 0.0834827
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0812058
	speed: 0.0373s/iter; left time: 373.7917s
	iters: 200, epoch: 56 | loss: 0.0791957
	speed: 0.0189s/iter; left time: 187.5394s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0818979 Vali Loss: 0.0792933 Test Loss: 0.0833512
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0799724
	speed: 0.0389s/iter; left time: 380.9441s
	iters: 200, epoch: 57 | loss: 0.0825712
	speed: 0.0207s/iter; left time: 200.6459s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0815750 Vali Loss: 0.0792557 Test Loss: 0.0833730
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0836057
	speed: 0.0392s/iter; left time: 375.7318s
	iters: 200, epoch: 58 | loss: 0.0862104
	speed: 0.0203s/iter; left time: 192.6586s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.85s
Steps: 225 | Train Loss: 0.0816147 Vali Loss: 0.0792267 Test Loss: 0.0833841
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0843756
	speed: 0.0412s/iter; left time: 384.9438s
	iters: 200, epoch: 59 | loss: 0.0816607
	speed: 0.0220s/iter; left time: 203.9079s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.26s
Steps: 225 | Train Loss: 0.0815761 Vali Loss: 0.0794703 Test Loss: 0.0834059
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01843404211103916, rmse:0.13577201962471008, mae:0.08338046818971634, rse:0.5133686661720276
Intermediate time for IT and pred_len 96: 00h:08m:46.77s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2871464
	speed: 0.0350s/iter; left time: 784.8044s
	iters: 200, epoch: 1 | loss: 0.2552790
	speed: 0.0118s/iter; left time: 262.0464s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.21s
Steps: 225 | Train Loss: 0.2854011 Vali Loss: 0.1998132 Test Loss: 0.2056278
Validation loss decreased (inf --> 0.199813).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1431440
	speed: 0.0294s/iter; left time: 651.6778s
	iters: 200, epoch: 2 | loss: 0.1307513
	speed: 0.0150s/iter; left time: 330.5901s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.30s
Steps: 225 | Train Loss: 0.1579776 Vali Loss: 0.1133125 Test Loss: 0.1184016
Validation loss decreased (0.199813 --> 0.113313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1170752
	speed: 0.0313s/iter; left time: 687.0419s
	iters: 200, epoch: 3 | loss: 0.1130971
	speed: 0.0157s/iter; left time: 343.8582s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.1175846 Vali Loss: 0.1013606 Test Loss: 0.1047844
Validation loss decreased (0.113313 --> 0.101361).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1119373
	speed: 0.0353s/iter; left time: 767.0267s
	iters: 200, epoch: 4 | loss: 0.1014683
	speed: 0.0170s/iter; left time: 367.8797s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.1058096 Vali Loss: 0.0938735 Test Loss: 0.0943376
Validation loss decreased (0.101361 --> 0.093873).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0974286
	speed: 0.0337s/iter; left time: 724.7678s
	iters: 200, epoch: 5 | loss: 0.0965309
	speed: 0.0170s/iter; left time: 362.9570s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.1000301 Vali Loss: 0.0928358 Test Loss: 0.0944088
Validation loss decreased (0.093873 --> 0.092836).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0954938
	speed: 0.0337s/iter; left time: 716.1494s
	iters: 200, epoch: 6 | loss: 0.0964621
	speed: 0.0158s/iter; left time: 335.6181s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.80s
Steps: 225 | Train Loss: 0.0964602 Vali Loss: 0.0884258 Test Loss: 0.0906295
Validation loss decreased (0.092836 --> 0.088426).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0978478
	speed: 0.0326s/iter; left time: 686.2370s
	iters: 200, epoch: 7 | loss: 0.0921040
	speed: 0.0202s/iter; left time: 424.2358s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0944398 Vali Loss: 0.0873658 Test Loss: 0.0898157
Validation loss decreased (0.088426 --> 0.087366).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0869991
	speed: 0.0334s/iter; left time: 695.3612s
	iters: 200, epoch: 8 | loss: 0.0936323
	speed: 0.0181s/iter; left time: 375.0768s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.05s
Steps: 225 | Train Loss: 0.0931402 Vali Loss: 0.0878391 Test Loss: 0.0891272
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0928500
	speed: 0.0331s/iter; left time: 682.1536s
	iters: 200, epoch: 9 | loss: 0.0924792
	speed: 0.0163s/iter; left time: 334.8110s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0919907 Vali Loss: 0.0864041 Test Loss: 0.0892081
Validation loss decreased (0.087366 --> 0.086404).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0924637
	speed: 0.0359s/iter; left time: 730.5564s
	iters: 200, epoch: 10 | loss: 0.0947547
	speed: 0.0194s/iter; left time: 393.5467s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.0911751 Vali Loss: 0.0859731 Test Loss: 0.0885750
Validation loss decreased (0.086404 --> 0.085973).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0918101
	speed: 0.0373s/iter; left time: 752.2057s
	iters: 200, epoch: 11 | loss: 0.0909410
	speed: 0.0191s/iter; left time: 383.2827s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0903794 Vali Loss: 0.0853820 Test Loss: 0.0884126
Validation loss decreased (0.085973 --> 0.085382).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0880149
	speed: 0.0341s/iter; left time: 678.9690s
	iters: 200, epoch: 12 | loss: 0.0892051
	speed: 0.0177s/iter; left time: 351.1211s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.0897380 Vali Loss: 0.0853620 Test Loss: 0.0886176
Validation loss decreased (0.085382 --> 0.085362).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0866742
	speed: 0.0351s/iter; left time: 692.4664s
	iters: 200, epoch: 13 | loss: 0.0866411
	speed: 0.0166s/iter; left time: 326.0934s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.06s
Steps: 225 | Train Loss: 0.0890611 Vali Loss: 0.0852427 Test Loss: 0.0886245
Validation loss decreased (0.085362 --> 0.085243).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0873050
	speed: 0.0367s/iter; left time: 715.3164s
	iters: 200, epoch: 14 | loss: 0.0878594
	speed: 0.0190s/iter; left time: 367.8571s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.0886383 Vali Loss: 0.0850008 Test Loss: 0.0882895
Validation loss decreased (0.085243 --> 0.085001).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0871279
	speed: 0.0381s/iter; left time: 733.5587s
	iters: 200, epoch: 15 | loss: 0.0854510
	speed: 0.0187s/iter; left time: 358.7479s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.0881073 Vali Loss: 0.0858327 Test Loss: 0.0889315
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0884793
	speed: 0.0378s/iter; left time: 719.8521s
	iters: 200, epoch: 16 | loss: 0.0910140
	speed: 0.0169s/iter; left time: 319.6816s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0878829 Vali Loss: 0.0851838 Test Loss: 0.0881989
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0851787
	speed: 0.0331s/iter; left time: 622.0127s
	iters: 200, epoch: 17 | loss: 0.0884906
	speed: 0.0160s/iter; left time: 299.6306s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0876183 Vali Loss: 0.0851970 Test Loss: 0.0888068
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0861608
	speed: 0.0361s/iter; left time: 669.8588s
	iters: 200, epoch: 18 | loss: 0.0879488
	speed: 0.0199s/iter; left time: 368.1378s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.63s
Steps: 225 | Train Loss: 0.0872039 Vali Loss: 0.0847646 Test Loss: 0.0885455
Validation loss decreased (0.085001 --> 0.084765).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0841821
	speed: 0.0339s/iter; left time: 622.7458s
	iters: 200, epoch: 19 | loss: 0.0927313
	speed: 0.0162s/iter; left time: 295.9263s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0871038 Vali Loss: 0.0841301 Test Loss: 0.0879659
Validation loss decreased (0.084765 --> 0.084130).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0864908
	speed: 0.0349s/iter; left time: 632.3668s
	iters: 200, epoch: 20 | loss: 0.0873407
	speed: 0.0190s/iter; left time: 342.2039s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0869607 Vali Loss: 0.0842529 Test Loss: 0.0880568
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0866177
	speed: 0.0381s/iter; left time: 682.5803s
	iters: 200, epoch: 21 | loss: 0.0867517
	speed: 0.0203s/iter; left time: 360.5142s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.77s
Steps: 225 | Train Loss: 0.0868113 Vali Loss: 0.0843626 Test Loss: 0.0878616
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0879350
	speed: 0.0384s/iter; left time: 679.3041s
	iters: 200, epoch: 22 | loss: 0.0870513
	speed: 0.0211s/iter; left time: 369.9890s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0864764 Vali Loss: 0.0842002 Test Loss: 0.0879332
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0858359
	speed: 0.0348s/iter; left time: 606.6333s
	iters: 200, epoch: 23 | loss: 0.0851808
	speed: 0.0181s/iter; left time: 314.3908s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0864841 Vali Loss: 0.0842316 Test Loss: 0.0881075
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0861321
	speed: 0.0339s/iter; left time: 583.2187s
	iters: 200, epoch: 24 | loss: 0.0962015
	speed: 0.0183s/iter; left time: 313.5735s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0864967 Vali Loss: 0.0848464 Test Loss: 0.0883762
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0878875
	speed: 0.0339s/iter; left time: 576.0413s
	iters: 200, epoch: 25 | loss: 0.0865147
	speed: 0.0215s/iter; left time: 362.9221s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0863466 Vali Loss: 0.0841036 Test Loss: 0.0880151
Validation loss decreased (0.084130 --> 0.084104).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0824846
	speed: 0.0333s/iter; left time: 559.0410s
	iters: 200, epoch: 26 | loss: 0.0877685
	speed: 0.0165s/iter; left time: 274.5133s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0861868 Vali Loss: 0.0843329 Test Loss: 0.0881836
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0860167
	speed: 0.0338s/iter; left time: 559.1916s
	iters: 200, epoch: 27 | loss: 0.0872357
	speed: 0.0185s/iter; left time: 304.3126s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0861339 Vali Loss: 0.0842179 Test Loss: 0.0879376
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0890730
	speed: 0.0349s/iter; left time: 569.0543s
	iters: 200, epoch: 28 | loss: 0.0879922
	speed: 0.0209s/iter; left time: 339.7017s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.54s
Steps: 225 | Train Loss: 0.0859794 Vali Loss: 0.0840635 Test Loss: 0.0877377
Validation loss decreased (0.084104 --> 0.084064).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0911478
	speed: 0.0341s/iter; left time: 548.3408s
	iters: 200, epoch: 29 | loss: 0.0832314
	speed: 0.0181s/iter; left time: 290.2558s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.14s
Steps: 225 | Train Loss: 0.0859579 Vali Loss: 0.0840073 Test Loss: 0.0878611
Validation loss decreased (0.084064 --> 0.084007).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0865786
	speed: 0.0390s/iter; left time: 619.8198s
	iters: 200, epoch: 30 | loss: 0.0882897
	speed: 0.0203s/iter; left time: 320.1559s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0859757 Vali Loss: 0.0840215 Test Loss: 0.0875936
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0837739
	speed: 0.0378s/iter; left time: 591.3445s
	iters: 200, epoch: 31 | loss: 0.0823950
	speed: 0.0160s/iter; left time: 248.3043s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0860808 Vali Loss: 0.0840814 Test Loss: 0.0878295
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0830447
	speed: 0.0393s/iter; left time: 605.8139s
	iters: 200, epoch: 32 | loss: 0.0859739
	speed: 0.0205s/iter; left time: 314.8236s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0863978 Vali Loss: 0.0840468 Test Loss: 0.0878614
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0895207
	speed: 0.0366s/iter; left time: 556.4685s
	iters: 200, epoch: 33 | loss: 0.0877355
	speed: 0.0185s/iter; left time: 278.7051s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0858421 Vali Loss: 0.0839666 Test Loss: 0.0877551
Validation loss decreased (0.084007 --> 0.083967).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0866324
	speed: 0.0325s/iter; left time: 486.0566s
	iters: 200, epoch: 34 | loss: 0.0839846
	speed: 0.0154s/iter; left time: 229.1691s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0857940 Vali Loss: 0.0839135 Test Loss: 0.0877007
Validation loss decreased (0.083967 --> 0.083914).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0840788
	speed: 0.0379s/iter; left time: 559.0763s
	iters: 200, epoch: 35 | loss: 0.0875866
	speed: 0.0195s/iter; left time: 286.3167s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0858123 Vali Loss: 0.0842424 Test Loss: 0.0877640
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0867140
	speed: 0.0369s/iter; left time: 536.6394s
	iters: 200, epoch: 36 | loss: 0.0856331
	speed: 0.0191s/iter; left time: 275.7532s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.65s
Steps: 225 | Train Loss: 0.0859275 Vali Loss: 0.0840178 Test Loss: 0.0876656
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0900123
	speed: 0.0394s/iter; left time: 563.3746s
	iters: 200, epoch: 37 | loss: 0.0830691
	speed: 0.0182s/iter; left time: 258.8487s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0857823 Vali Loss: 0.0838440 Test Loss: 0.0878202
Validation loss decreased (0.083914 --> 0.083844).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0872962
	speed: 0.0318s/iter; left time: 447.0716s
	iters: 200, epoch: 38 | loss: 0.0843079
	speed: 0.0169s/iter; left time: 236.0514s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.77s
Steps: 225 | Train Loss: 0.0856478 Vali Loss: 0.0842055 Test Loss: 0.0877056
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0836912
	speed: 0.0380s/iter; left time: 526.5336s
	iters: 200, epoch: 39 | loss: 0.0842630
	speed: 0.0218s/iter; left time: 299.1031s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.0857615 Vali Loss: 0.0839735 Test Loss: 0.0878095
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0847262
	speed: 0.0333s/iter; left time: 453.3733s
	iters: 200, epoch: 40 | loss: 0.0846217
	speed: 0.0164s/iter; left time: 221.3080s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.0855740 Vali Loss: 0.0839487 Test Loss: 0.0876373
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0832063
	speed: 0.0370s/iter; left time: 495.7891s
	iters: 200, epoch: 41 | loss: 0.0881097
	speed: 0.0198s/iter; left time: 263.5479s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.76s
Steps: 225 | Train Loss: 0.0855960 Vali Loss: 0.0839609 Test Loss: 0.0877863
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0827914
	speed: 0.0354s/iter; left time: 466.6708s
	iters: 200, epoch: 42 | loss: 0.0866479
	speed: 0.0176s/iter; left time: 230.1542s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0856862 Vali Loss: 0.0838571 Test Loss: 0.0877914
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0855684
	speed: 0.0334s/iter; left time: 432.9205s
	iters: 200, epoch: 43 | loss: 0.0898735
	speed: 0.0217s/iter; left time: 278.4628s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.0857198 Vali Loss: 0.0840194 Test Loss: 0.0876936
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0840490
	speed: 0.0348s/iter; left time: 443.0039s
	iters: 200, epoch: 44 | loss: 0.0835335
	speed: 0.0163s/iter; left time: 205.6175s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0856540 Vali Loss: 0.0838441 Test Loss: 0.0877947
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0838612
	speed: 0.0331s/iter; left time: 413.8472s
	iters: 200, epoch: 45 | loss: 0.0866728
	speed: 0.0170s/iter; left time: 210.6046s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0855881 Vali Loss: 0.0840154 Test Loss: 0.0877012
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0848497
	speed: 0.0335s/iter; left time: 411.6408s
	iters: 200, epoch: 46 | loss: 0.0840844
	speed: 0.0165s/iter; left time: 200.6123s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.0857706 Vali Loss: 0.0837818 Test Loss: 0.0878212
Validation loss decreased (0.083844 --> 0.083782).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0809108
	speed: 0.0323s/iter; left time: 389.2313s
	iters: 200, epoch: 47 | loss: 0.0876100
	speed: 0.0213s/iter; left time: 254.1294s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0855649 Vali Loss: 0.0838934 Test Loss: 0.0876507
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0854100
	speed: 0.0345s/iter; left time: 408.0850s
	iters: 200, epoch: 48 | loss: 0.0830703
	speed: 0.0165s/iter; left time: 193.9145s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0854888 Vali Loss: 0.0837947 Test Loss: 0.0877474
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0881180
	speed: 0.0329s/iter; left time: 381.6648s
	iters: 200, epoch: 49 | loss: 0.0825081
	speed: 0.0162s/iter; left time: 186.6418s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0855913 Vali Loss: 0.0839997 Test Loss: 0.0876720
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0842309
	speed: 0.0336s/iter; left time: 382.2480s
	iters: 200, epoch: 50 | loss: 0.0896637
	speed: 0.0170s/iter; left time: 191.4956s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.0855575 Vali Loss: 0.0836746 Test Loss: 0.0876439
Validation loss decreased (0.083782 --> 0.083675).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0803221
	speed: 0.0328s/iter; left time: 365.8281s
	iters: 200, epoch: 51 | loss: 0.0852165
	speed: 0.0166s/iter; left time: 183.4293s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0857192 Vali Loss: 0.0838952 Test Loss: 0.0876832
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0891636
	speed: 0.0323s/iter; left time: 352.7288s
	iters: 200, epoch: 52 | loss: 0.0858402
	speed: 0.0155s/iter; left time: 168.0515s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0855586 Vali Loss: 0.0839647 Test Loss: 0.0877191
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0857720
	speed: 0.0358s/iter; left time: 382.6640s
	iters: 200, epoch: 53 | loss: 0.0827048
	speed: 0.0196s/iter; left time: 207.5261s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0854881 Vali Loss: 0.0838258 Test Loss: 0.0876724
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0894596
	speed: 0.0329s/iter; left time: 344.6078s
	iters: 200, epoch: 54 | loss: 0.0887103
	speed: 0.0158s/iter; left time: 163.4961s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0856003 Vali Loss: 0.0839257 Test Loss: 0.0877173
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0881316
	speed: 0.0338s/iter; left time: 346.4570s
	iters: 200, epoch: 55 | loss: 0.0862180
	speed: 0.0159s/iter; left time: 161.5126s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0855120 Vali Loss: 0.0838650 Test Loss: 0.0877261
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0841388
	speed: 0.0334s/iter; left time: 334.6769s
	iters: 200, epoch: 56 | loss: 0.0869091
	speed: 0.0181s/iter; left time: 179.4659s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0856856 Vali Loss: 0.0836929 Test Loss: 0.0878890
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0832032
	speed: 0.0355s/iter; left time: 348.0622s
	iters: 200, epoch: 57 | loss: 0.0826762
	speed: 0.0178s/iter; left time: 173.1376s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0856178 Vali Loss: 0.0839305 Test Loss: 0.0877205
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0862195
	speed: 0.0341s/iter; left time: 326.8623s
	iters: 200, epoch: 58 | loss: 0.0849153
	speed: 0.0173s/iter; left time: 163.7465s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.05s
Steps: 225 | Train Loss: 0.0855426 Vali Loss: 0.0836311 Test Loss: 0.0877388
Validation loss decreased (0.083675 --> 0.083631).  Saving model ...
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0874458
	speed: 0.0337s/iter; left time: 315.5775s
	iters: 200, epoch: 59 | loss: 0.0856677
	speed: 0.0152s/iter; left time: 140.8290s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0854076 Vali Loss: 0.0837660 Test Loss: 0.0877864
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0862853
	speed: 0.0383s/iter; left time: 349.1669s
	iters: 200, epoch: 60 | loss: 0.0846376
	speed: 0.0202s/iter; left time: 182.4430s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.84s
Steps: 225 | Train Loss: 0.0855039 Vali Loss: 0.0839287 Test Loss: 0.0877160
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0831357
	speed: 0.0380s/iter; left time: 338.5553s
	iters: 200, epoch: 61 | loss: 0.0843221
	speed: 0.0216s/iter; left time: 189.9404s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0854917 Vali Loss: 0.0837465 Test Loss: 0.0877291
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0863590
	speed: 0.0384s/iter; left time: 332.7523s
	iters: 200, epoch: 62 | loss: 0.0844525
	speed: 0.0200s/iter; left time: 171.8936s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0855115 Vali Loss: 0.0839486 Test Loss: 0.0877433
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0835522
	speed: 0.0345s/iter; left time: 291.3142s
	iters: 200, epoch: 63 | loss: 0.0858202
	speed: 0.0175s/iter; left time: 146.2665s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0854575 Vali Loss: 0.0838609 Test Loss: 0.0876994
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0863423
	speed: 0.0367s/iter; left time: 301.7965s
	iters: 200, epoch: 64 | loss: 0.0882498
	speed: 0.0192s/iter; left time: 155.7262s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.54s
Steps: 225 | Train Loss: 0.0853901 Vali Loss: 0.0837660 Test Loss: 0.0876815
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0795603
	speed: 0.0342s/iter; left time: 273.4767s
	iters: 200, epoch: 65 | loss: 0.0861610
	speed: 0.0159s/iter; left time: 125.6800s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0854072 Vali Loss: 0.0837482 Test Loss: 0.0877235
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0849181
	speed: 0.0373s/iter; left time: 290.0356s
	iters: 200, epoch: 66 | loss: 0.0865337
	speed: 0.0176s/iter; left time: 135.3886s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:04.65s
Steps: 225 | Train Loss: 0.0855410 Vali Loss: 0.0837984 Test Loss: 0.0877984
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0806636
	speed: 0.0382s/iter; left time: 288.8172s
	iters: 200, epoch: 67 | loss: 0.0847101
	speed: 0.0201s/iter; left time: 149.9409s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0854205 Vali Loss: 0.0839564 Test Loss: 0.0877346
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0891916
	speed: 0.0342s/iter; left time: 250.2153s
	iters: 200, epoch: 68 | loss: 0.0856488
	speed: 0.0191s/iter; left time: 138.1306s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0855271 Vali Loss: 0.0839384 Test Loss: 0.0878300
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01985144428908825, rmse:0.14089515805244446, mae:0.08773878216743469, rse:0.5332347750663757
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2811901
	speed: 0.0192s/iter; left time: 430.7573s
	iters: 200, epoch: 1 | loss: 0.2555557
	speed: 0.0160s/iter; left time: 355.7013s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.2855597 Vali Loss: 0.2034866 Test Loss: 0.2095738
Validation loss decreased (inf --> 0.203487).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1407049
	speed: 0.0329s/iter; left time: 730.2627s
	iters: 200, epoch: 2 | loss: 0.1255486
	speed: 0.0098s/iter; left time: 217.3034s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.06s
Steps: 225 | Train Loss: 0.1563358 Vali Loss: 0.1131076 Test Loss: 0.1202545
Validation loss decreased (0.203487 --> 0.113108).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1179366
	speed: 0.0346s/iter; left time: 759.7440s
	iters: 200, epoch: 3 | loss: 0.1155250
	speed: 0.0149s/iter; left time: 325.6192s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.1178324 Vali Loss: 0.1009700 Test Loss: 0.1035364
Validation loss decreased (0.113108 --> 0.100970).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1069622
	speed: 0.0381s/iter; left time: 826.9655s
	iters: 200, epoch: 4 | loss: 0.1056391
	speed: 0.0190s/iter; left time: 410.1421s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.1062726 Vali Loss: 0.0952413 Test Loss: 0.0965261
Validation loss decreased (0.100970 --> 0.095241).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0975991
	speed: 0.0334s/iter; left time: 717.6973s
	iters: 200, epoch: 5 | loss: 0.1003618
	speed: 0.0152s/iter; left time: 324.4944s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.82s
Steps: 225 | Train Loss: 0.1005352 Vali Loss: 0.0913371 Test Loss: 0.0940908
Validation loss decreased (0.095241 --> 0.091337).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0990696
	speed: 0.0373s/iter; left time: 793.5207s
	iters: 200, epoch: 6 | loss: 0.1006796
	speed: 0.0189s/iter; left time: 399.8170s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0975591 Vali Loss: 0.0896493 Test Loss: 0.0929677
Validation loss decreased (0.091337 --> 0.089649).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0946059
	speed: 0.0359s/iter; left time: 756.2554s
	iters: 200, epoch: 7 | loss: 0.0987749
	speed: 0.0175s/iter; left time: 366.6375s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0952434 Vali Loss: 0.0885789 Test Loss: 0.0906260
Validation loss decreased (0.089649 --> 0.088579).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0912916
	speed: 0.0315s/iter; left time: 654.9935s
	iters: 200, epoch: 8 | loss: 0.0941708
	speed: 0.0135s/iter; left time: 279.5577s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.30s
Steps: 225 | Train Loss: 0.0937680 Vali Loss: 0.0880198 Test Loss: 0.0900427
Validation loss decreased (0.088579 --> 0.088020).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0892983
	speed: 0.0314s/iter; left time: 647.8609s
	iters: 200, epoch: 9 | loss: 0.0933996
	speed: 0.0128s/iter; left time: 262.9067s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.27s
Steps: 225 | Train Loss: 0.0926713 Vali Loss: 0.0868229 Test Loss: 0.0900808
Validation loss decreased (0.088020 --> 0.086823).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0906593
	speed: 0.0340s/iter; left time: 693.3928s
	iters: 200, epoch: 10 | loss: 0.0939311
	speed: 0.0168s/iter; left time: 339.9877s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0914059 Vali Loss: 0.0864519 Test Loss: 0.0892728
Validation loss decreased (0.086823 --> 0.086452).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0897200
	speed: 0.0346s/iter; left time: 696.5937s
	iters: 200, epoch: 11 | loss: 0.0882291
	speed: 0.0163s/iter; left time: 326.2275s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0904506 Vali Loss: 0.0862451 Test Loss: 0.0891356
Validation loss decreased (0.086452 --> 0.086245).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0927711
	speed: 0.0286s/iter; left time: 569.8227s
	iters: 200, epoch: 12 | loss: 0.0938112
	speed: 0.0172s/iter; left time: 341.3968s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.56s
Steps: 225 | Train Loss: 0.0897738 Vali Loss: 0.0862953 Test Loss: 0.0888204
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0893305
	speed: 0.0340s/iter; left time: 669.1768s
	iters: 200, epoch: 13 | loss: 0.0923870
	speed: 0.0182s/iter; left time: 357.6593s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.0891380 Vali Loss: 0.0859750 Test Loss: 0.0888117
Validation loss decreased (0.086245 --> 0.085975).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0903896
	speed: 0.0324s/iter; left time: 631.5628s
	iters: 200, epoch: 14 | loss: 0.0873978
	speed: 0.0175s/iter; left time: 338.3399s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0887752 Vali Loss: 0.0853476 Test Loss: 0.0883505
Validation loss decreased (0.085975 --> 0.085348).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0904353
	speed: 0.0340s/iter; left time: 654.3193s
	iters: 200, epoch: 15 | loss: 0.0884306
	speed: 0.0133s/iter; left time: 254.5272s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.43s
Steps: 225 | Train Loss: 0.0883704 Vali Loss: 0.0849287 Test Loss: 0.0884772
Validation loss decreased (0.085348 --> 0.084929).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0865225
	speed: 0.0329s/iter; left time: 626.6952s
	iters: 200, epoch: 16 | loss: 0.0862006
	speed: 0.0143s/iter; left time: 271.1906s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.72s
Steps: 225 | Train Loss: 0.0879999 Vali Loss: 0.0850746 Test Loss: 0.0880633
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0891528
	speed: 0.0344s/iter; left time: 646.5989s
	iters: 200, epoch: 17 | loss: 0.0878572
	speed: 0.0145s/iter; left time: 270.6813s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0878672 Vali Loss: 0.0847102 Test Loss: 0.0881083
Validation loss decreased (0.084929 --> 0.084710).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0881433
	speed: 0.0347s/iter; left time: 643.9944s
	iters: 200, epoch: 18 | loss: 0.0901565
	speed: 0.0159s/iter; left time: 294.3343s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.77s
Steps: 225 | Train Loss: 0.0874882 Vali Loss: 0.0848959 Test Loss: 0.0880535
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0862640
	speed: 0.0297s/iter; left time: 545.4961s
	iters: 200, epoch: 19 | loss: 0.0926718
	speed: 0.0173s/iter; left time: 316.0817s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.0874914 Vali Loss: 0.0846168 Test Loss: 0.0882703
Validation loss decreased (0.084710 --> 0.084617).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0858740
	speed: 0.0378s/iter; left time: 685.6659s
	iters: 200, epoch: 20 | loss: 0.0878472
	speed: 0.0158s/iter; left time: 284.8453s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0871674 Vali Loss: 0.0845910 Test Loss: 0.0877174
Validation loss decreased (0.084617 --> 0.084591).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0822908
	speed: 0.0355s/iter; left time: 634.8406s
	iters: 200, epoch: 21 | loss: 0.0888437
	speed: 0.0179s/iter; left time: 318.0568s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.0869461 Vali Loss: 0.0846306 Test Loss: 0.0877483
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0889016
	speed: 0.0346s/iter; left time: 611.6671s
	iters: 200, epoch: 22 | loss: 0.0853360
	speed: 0.0163s/iter; left time: 286.6338s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.0868771 Vali Loss: 0.0845347 Test Loss: 0.0878567
Validation loss decreased (0.084591 --> 0.084535).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0878374
	speed: 0.0355s/iter; left time: 620.3362s
	iters: 200, epoch: 23 | loss: 0.0857313
	speed: 0.0186s/iter; left time: 323.4378s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0867781 Vali Loss: 0.0845471 Test Loss: 0.0879436
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0893482
	speed: 0.0302s/iter; left time: 519.4805s
	iters: 200, epoch: 24 | loss: 0.0847237
	speed: 0.0102s/iter; left time: 174.2902s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.00s
Steps: 225 | Train Loss: 0.0868089 Vali Loss: 0.0843728 Test Loss: 0.0877755
Validation loss decreased (0.084535 --> 0.084373).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0856335
	speed: 0.0328s/iter; left time: 558.1006s
	iters: 200, epoch: 25 | loss: 0.0884197
	speed: 0.0144s/iter; left time: 243.7999s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.52s
Steps: 225 | Train Loss: 0.0866318 Vali Loss: 0.0844467 Test Loss: 0.0877618
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0915473
	speed: 0.0340s/iter; left time: 570.9848s
	iters: 200, epoch: 26 | loss: 0.0861925
	speed: 0.0156s/iter; left time: 259.8701s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.0864816 Vali Loss: 0.0843100 Test Loss: 0.0880293
Validation loss decreased (0.084373 --> 0.084310).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0888533
	speed: 0.0332s/iter; left time: 548.8214s
	iters: 200, epoch: 27 | loss: 0.0828652
	speed: 0.0159s/iter; left time: 261.2533s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0864010 Vali Loss: 0.0840675 Test Loss: 0.0878859
Validation loss decreased (0.084310 --> 0.084068).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0866069
	speed: 0.0335s/iter; left time: 546.6210s
	iters: 200, epoch: 28 | loss: 0.0846799
	speed: 0.0151s/iter; left time: 245.8093s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.0863566 Vali Loss: 0.0841139 Test Loss: 0.0878939
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0864667
	speed: 0.0320s/iter; left time: 515.8490s
	iters: 200, epoch: 29 | loss: 0.0849992
	speed: 0.0153s/iter; left time: 244.6983s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.59s
Steps: 225 | Train Loss: 0.0861578 Vali Loss: 0.0842914 Test Loss: 0.0877159
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0887233
	speed: 0.0317s/iter; left time: 502.5355s
	iters: 200, epoch: 30 | loss: 0.0850501
	speed: 0.0174s/iter; left time: 274.3911s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.0861103 Vali Loss: 0.0840877 Test Loss: 0.0877250
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0850813
	speed: 0.0367s/iter; left time: 574.6106s
	iters: 200, epoch: 31 | loss: 0.0864127
	speed: 0.0118s/iter; left time: 183.3329s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.64s
Steps: 225 | Train Loss: 0.0861136 Vali Loss: 0.0841656 Test Loss: 0.0876141
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0869038
	speed: 0.0286s/iter; left time: 440.7895s
	iters: 200, epoch: 32 | loss: 0.0882633
	speed: 0.0111s/iter; left time: 169.6003s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:02.87s
Steps: 225 | Train Loss: 0.0860620 Vali Loss: 0.0840440 Test Loss: 0.0875890
Validation loss decreased (0.084068 --> 0.084044).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0830199
	speed: 0.0288s/iter; left time: 437.8174s
	iters: 200, epoch: 33 | loss: 0.0820900
	speed: 0.0125s/iter; left time: 189.3045s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:02.86s
Steps: 225 | Train Loss: 0.0860683 Vali Loss: 0.0840771 Test Loss: 0.0877418
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0851234
	speed: 0.0361s/iter; left time: 540.5820s
	iters: 200, epoch: 34 | loss: 0.0869063
	speed: 0.0162s/iter; left time: 241.0766s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0860582 Vali Loss: 0.0841589 Test Loss: 0.0876531
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0853247
	speed: 0.0328s/iter; left time: 484.3153s
	iters: 200, epoch: 35 | loss: 0.0821250
	speed: 0.0189s/iter; left time: 277.2306s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.10s
Steps: 225 | Train Loss: 0.0859170 Vali Loss: 0.0837935 Test Loss: 0.0877555
Validation loss decreased (0.084044 --> 0.083794).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0848440
	speed: 0.0339s/iter; left time: 492.5746s
	iters: 200, epoch: 36 | loss: 0.0825796
	speed: 0.0155s/iter; left time: 224.2212s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.75s
Steps: 225 | Train Loss: 0.0859620 Vali Loss: 0.0839452 Test Loss: 0.0875413
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0834437
	speed: 0.0362s/iter; left time: 517.5947s
	iters: 200, epoch: 37 | loss: 0.0914393
	speed: 0.0175s/iter; left time: 249.1939s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0858014 Vali Loss: 0.0838901 Test Loss: 0.0875761
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0870592
	speed: 0.0320s/iter; left time: 450.5334s
	iters: 200, epoch: 38 | loss: 0.0849523
	speed: 0.0171s/iter; left time: 238.8589s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.0857765 Vali Loss: 0.0838603 Test Loss: 0.0876727
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0813147
	speed: 0.0289s/iter; left time: 400.1122s
	iters: 200, epoch: 39 | loss: 0.0890005
	speed: 0.0157s/iter; left time: 216.0689s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0859399 Vali Loss: 0.0838971 Test Loss: 0.0876239
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0830819
	speed: 0.0314s/iter; left time: 427.4216s
	iters: 200, epoch: 40 | loss: 0.0856972
	speed: 0.0138s/iter; left time: 186.1187s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.46s
Steps: 225 | Train Loss: 0.0860559 Vali Loss: 0.0839531 Test Loss: 0.0874863
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0860740
	speed: 0.0336s/iter; left time: 450.3678s
	iters: 200, epoch: 41 | loss: 0.0863928
	speed: 0.0162s/iter; left time: 215.8339s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.0858800 Vali Loss: 0.0839168 Test Loss: 0.0875721
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0892703
	speed: 0.0320s/iter; left time: 422.1587s
	iters: 200, epoch: 42 | loss: 0.0883598
	speed: 0.0166s/iter; left time: 217.4510s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.0857964 Vali Loss: 0.0837697 Test Loss: 0.0875823
Validation loss decreased (0.083794 --> 0.083770).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0879114
	speed: 0.0348s/iter; left time: 450.2445s
	iters: 200, epoch: 43 | loss: 0.0877481
	speed: 0.0163s/iter; left time: 208.9116s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0858649 Vali Loss: 0.0837876 Test Loss: 0.0874805
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0840065
	speed: 0.0318s/iter; left time: 405.0638s
	iters: 200, epoch: 44 | loss: 0.0844992
	speed: 0.0149s/iter; left time: 187.8384s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0858228 Vali Loss: 0.0838888 Test Loss: 0.0876042
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0876887
	speed: 0.0343s/iter; left time: 428.3675s
	iters: 200, epoch: 45 | loss: 0.0862209
	speed: 0.0160s/iter; left time: 198.5637s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.94s
Steps: 225 | Train Loss: 0.0858926 Vali Loss: 0.0838959 Test Loss: 0.0875133
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0850273
	speed: 0.0324s/iter; left time: 398.2815s
	iters: 200, epoch: 46 | loss: 0.0850483
	speed: 0.0154s/iter; left time: 186.9141s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.0857520 Vali Loss: 0.0840085 Test Loss: 0.0876112
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0873501
	speed: 0.0315s/iter; left time: 379.6881s
	iters: 200, epoch: 47 | loss: 0.0857628
	speed: 0.0156s/iter; left time: 186.6653s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.0856933 Vali Loss: 0.0840146 Test Loss: 0.0875916
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0866789
	speed: 0.0323s/iter; left time: 381.4637s
	iters: 200, epoch: 48 | loss: 0.0857183
	speed: 0.0136s/iter; left time: 159.4248s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.43s
Steps: 225 | Train Loss: 0.0858344 Vali Loss: 0.0838272 Test Loss: 0.0874924
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0856871
	speed: 0.0306s/iter; left time: 355.1994s
	iters: 200, epoch: 49 | loss: 0.0848251
	speed: 0.0133s/iter; left time: 152.5324s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.20s
Steps: 225 | Train Loss: 0.0857752 Vali Loss: 0.0838986 Test Loss: 0.0874747
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0884241
	speed: 0.0319s/iter; left time: 362.6406s
	iters: 200, epoch: 50 | loss: 0.0847695
	speed: 0.0155s/iter; left time: 174.9079s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:03.82s
Steps: 225 | Train Loss: 0.0856900 Vali Loss: 0.0837343 Test Loss: 0.0876015
Validation loss decreased (0.083770 --> 0.083734).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0916913
	speed: 0.0304s/iter; left time: 339.0639s
	iters: 200, epoch: 51 | loss: 0.0854367
	speed: 0.0138s/iter; left time: 152.2391s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:03.23s
Steps: 225 | Train Loss: 0.0857145 Vali Loss: 0.0839531 Test Loss: 0.0874348
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0813114
	speed: 0.0313s/iter; left time: 341.4976s
	iters: 200, epoch: 52 | loss: 0.0878581
	speed: 0.0141s/iter; left time: 152.9219s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.35s
Steps: 225 | Train Loss: 0.0857817 Vali Loss: 0.0840421 Test Loss: 0.0875262
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0855496
	speed: 0.0313s/iter; left time: 335.2605s
	iters: 200, epoch: 53 | loss: 0.0854577
	speed: 0.0156s/iter; left time: 165.3331s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0858797 Vali Loss: 0.0838894 Test Loss: 0.0875471
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0848776
	speed: 0.0323s/iter; left time: 338.4287s
	iters: 200, epoch: 54 | loss: 0.0854730
	speed: 0.0152s/iter; left time: 158.1405s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0855863 Vali Loss: 0.0837929 Test Loss: 0.0875680
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0851004
	speed: 0.0324s/iter; left time: 332.6410s
	iters: 200, epoch: 55 | loss: 0.0866423
	speed: 0.0160s/iter; left time: 162.0317s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0856860 Vali Loss: 0.0839773 Test Loss: 0.0875212
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0851850
	speed: 0.0322s/iter; left time: 322.8402s
	iters: 200, epoch: 56 | loss: 0.0869962
	speed: 0.0128s/iter; left time: 126.7313s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0857411 Vali Loss: 0.0838174 Test Loss: 0.0875457
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0855275
	speed: 0.0323s/iter; left time: 316.3555s
	iters: 200, epoch: 57 | loss: 0.0821422
	speed: 0.0155s/iter; left time: 150.0504s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0857449 Vali Loss: 0.0836694 Test Loss: 0.0876946
Validation loss decreased (0.083734 --> 0.083669).  Saving model ...
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0852302
	speed: 0.0313s/iter; left time: 300.1953s
	iters: 200, epoch: 58 | loss: 0.0813387
	speed: 0.0141s/iter; left time: 133.5898s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:03.34s
Steps: 225 | Train Loss: 0.0856328 Vali Loss: 0.0838333 Test Loss: 0.0876395
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0865474
	speed: 0.0319s/iter; left time: 297.9664s
	iters: 200, epoch: 59 | loss: 0.0864555
	speed: 0.0181s/iter; left time: 167.7657s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0857513 Vali Loss: 0.0838587 Test Loss: 0.0875407
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0815425
	speed: 0.0336s/iter; left time: 306.1960s
	iters: 200, epoch: 60 | loss: 0.0846148
	speed: 0.0132s/iter; left time: 119.3043s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:03.39s
Steps: 225 | Train Loss: 0.0856650 Vali Loss: 0.0838523 Test Loss: 0.0875463
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0817179
	speed: 0.0349s/iter; left time: 310.3364s
	iters: 200, epoch: 61 | loss: 0.0882797
	speed: 0.0169s/iter; left time: 148.5799s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0857247 Vali Loss: 0.0837791 Test Loss: 0.0875305
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0847188
	speed: 0.0304s/iter; left time: 263.4557s
	iters: 200, epoch: 62 | loss: 0.0864886
	speed: 0.0172s/iter; left time: 147.6845s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:03.65s
Steps: 225 | Train Loss: 0.0856562 Vali Loss: 0.0837275 Test Loss: 0.0875718
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0876755
	speed: 0.0329s/iter; left time: 277.9308s
	iters: 200, epoch: 63 | loss: 0.0876397
	speed: 0.0154s/iter; left time: 128.7094s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:03.59s
Steps: 225 | Train Loss: 0.0856394 Vali Loss: 0.0837758 Test Loss: 0.0876276
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0870029
	speed: 0.0323s/iter; left time: 265.3085s
	iters: 200, epoch: 64 | loss: 0.0860020
	speed: 0.0155s/iter; left time: 126.1215s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0856961 Vali Loss: 0.0837211 Test Loss: 0.0875373
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0852330
	speed: 0.0336s/iter; left time: 269.0732s
	iters: 200, epoch: 65 | loss: 0.0844138
	speed: 0.0179s/iter; left time: 141.7803s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0855918 Vali Loss: 0.0838730 Test Loss: 0.0874921
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0866955
	speed: 0.0336s/iter; left time: 261.4932s
	iters: 200, epoch: 66 | loss: 0.0854436
	speed: 0.0164s/iter; left time: 125.8727s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.0858716 Vali Loss: 0.0839868 Test Loss: 0.0875049
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0849778
	speed: 0.0344s/iter; left time: 259.7289s
	iters: 200, epoch: 67 | loss: 0.0866626
	speed: 0.0166s/iter; left time: 123.8160s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.0856807 Vali Loss: 0.0837630 Test Loss: 0.0875618
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019952882081270218, rmse:0.14125467836856842, mae:0.08769454061985016, rse:0.5345954895019531
Intermediate time for IT and pred_len 168: 00h:11m:37.36sIntermediate time for IT: 00h:30m:03.60sTotal time: 02h:39m:39.71s