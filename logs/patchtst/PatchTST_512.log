
=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1332144
	speed: 0.0739s/iter; left time: 1641.4667s
	iters: 200, epoch: 1 | loss: 0.1229960
	speed: 0.0557s/iter; left time: 1231.3188s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.88s
Steps: 223 | Train Loss: 0.1358273 Vali Loss: 0.1260563 Test Loss: 0.1311544
Validation loss decreased (inf --> 0.126056).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0868122
	speed: 0.0981s/iter; left time: 2155.1823s
	iters: 200, epoch: 2 | loss: 0.0820302
	speed: 0.0557s/iter; left time: 1218.1033s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0882056 Vali Loss: 0.0927888 Test Loss: 0.0949692
Validation loss decreased (0.126056 --> 0.092789).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0753110
	speed: 0.0970s/iter; left time: 2110.9623s
	iters: 200, epoch: 3 | loss: 0.0757236
	speed: 0.0557s/iter; left time: 1205.5759s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0788444 Vali Loss: 0.0894453 Test Loss: 0.0920496
Validation loss decreased (0.092789 --> 0.089445).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0791433
	speed: 0.0980s/iter; left time: 2109.3909s
	iters: 200, epoch: 4 | loss: 0.0825152
	speed: 0.0560s/iter; left time: 1199.9200s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0767609 Vali Loss: 0.0887320 Test Loss: 0.0910566
Validation loss decreased (0.089445 --> 0.088732).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0760196
	speed: 0.1003s/iter; left time: 2136.6525s
	iters: 200, epoch: 5 | loss: 0.0715352
	speed: 0.0557s/iter; left time: 1180.6805s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0754450 Vali Loss: 0.0889264 Test Loss: 0.0909010
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0798182
	speed: 0.0978s/iter; left time: 2061.9008s
	iters: 200, epoch: 6 | loss: 0.0760352
	speed: 0.0559s/iter; left time: 1172.6379s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.70s
Steps: 223 | Train Loss: 0.0743708 Vali Loss: 0.0882881 Test Loss: 0.0898762
Validation loss decreased (0.088732 --> 0.088288).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0732908
	speed: 0.0976s/iter; left time: 2036.5197s
	iters: 200, epoch: 7 | loss: 0.0716462
	speed: 0.0558s/iter; left time: 1157.7902s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0736464 Vali Loss: 0.0883676 Test Loss: 0.0901687
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0711929
	speed: 0.0975s/iter; left time: 2012.4290s
	iters: 200, epoch: 8 | loss: 0.0738796
	speed: 0.0557s/iter; left time: 1144.0460s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0730284 Vali Loss: 0.0872638 Test Loss: 0.0893016
Validation loss decreased (0.088288 --> 0.087264).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0718604
	speed: 0.0974s/iter; left time: 1989.0109s
	iters: 200, epoch: 9 | loss: 0.0724918
	speed: 0.0557s/iter; left time: 1131.3802s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0724477 Vali Loss: 0.0873610 Test Loss: 0.0892784
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0735393
	speed: 0.0977s/iter; left time: 1973.5957s
	iters: 200, epoch: 10 | loss: 0.0687648
	speed: 0.0557s/iter; left time: 1119.3063s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0722126 Vali Loss: 0.0868895 Test Loss: 0.0890840
Validation loss decreased (0.087264 --> 0.086889).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0741503
	speed: 0.0977s/iter; left time: 1950.5542s
	iters: 200, epoch: 11 | loss: 0.0751265
	speed: 0.0556s/iter; left time: 1105.0477s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0719460 Vali Loss: 0.0867828 Test Loss: 0.0886687
Validation loss decreased (0.086889 --> 0.086783).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0688678
	speed: 0.0969s/iter; left time: 1913.2028s
	iters: 200, epoch: 12 | loss: 0.0754033
	speed: 0.0558s/iter; left time: 1095.6798s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0716845 Vali Loss: 0.0863442 Test Loss: 0.0887282
Validation loss decreased (0.086783 --> 0.086344).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0660991
	speed: 0.0971s/iter; left time: 1896.2582s
	iters: 200, epoch: 13 | loss: 0.0696966
	speed: 0.0557s/iter; left time: 1082.7238s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0713887 Vali Loss: 0.0863370 Test Loss: 0.0882716
Validation loss decreased (0.086344 --> 0.086337).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0725164
	speed: 0.0976s/iter; left time: 1884.3073s
	iters: 200, epoch: 14 | loss: 0.0659105
	speed: 0.0556s/iter; left time: 1068.5438s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0712591 Vali Loss: 0.0863522 Test Loss: 0.0883677
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0713117
	speed: 0.0970s/iter; left time: 1851.5268s
	iters: 200, epoch: 15 | loss: 0.0666008
	speed: 0.0558s/iter; left time: 1058.2339s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0710470 Vali Loss: 0.0864777 Test Loss: 0.0887146
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0738203
	speed: 0.0974s/iter; left time: 1836.1377s
	iters: 200, epoch: 16 | loss: 0.0769220
	speed: 0.0557s/iter; left time: 1045.5837s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.70s
Steps: 223 | Train Loss: 0.0708745 Vali Loss: 0.0861809 Test Loss: 0.0884529
Validation loss decreased (0.086337 --> 0.086181).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0708035
	speed: 0.0988s/iter; left time: 1841.3885s
	iters: 200, epoch: 17 | loss: 0.0764474
	speed: 0.0557s/iter; left time: 1032.8805s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0707748 Vali Loss: 0.0861680 Test Loss: 0.0882925
Validation loss decreased (0.086181 --> 0.086168).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0686066
	speed: 0.0977s/iter; left time: 1797.7864s
	iters: 200, epoch: 18 | loss: 0.0637440
	speed: 0.0557s/iter; left time: 1019.6229s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0705734 Vali Loss: 0.0859288 Test Loss: 0.0882091
Validation loss decreased (0.086168 --> 0.085929).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0716321
	speed: 0.0975s/iter; left time: 1773.7313s
	iters: 200, epoch: 19 | loss: 0.0779866
	speed: 0.0557s/iter; left time: 1007.5155s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.59s
Steps: 223 | Train Loss: 0.0705458 Vali Loss: 0.0859715 Test Loss: 0.0881990
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0711506
	speed: 0.1971s/iter; left time: 3541.5114s
	iters: 200, epoch: 20 | loss: 0.0688243
	speed: 0.0586s/iter; left time: 1046.2319s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:13.06s
Steps: 223 | Train Loss: 0.0704459 Vali Loss: 0.0860364 Test Loss: 0.0881711
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0696923
	speed: 0.1037s/iter; left time: 1839.7463s
	iters: 200, epoch: 21 | loss: 0.0741142
	speed: 0.1406s/iter; left time: 2479.6375s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:23.64s
Steps: 223 | Train Loss: 0.0703798 Vali Loss: 0.0858786 Test Loss: 0.0881454
Validation loss decreased (0.085929 --> 0.085879).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0712104
	speed: 0.2403s/iter; left time: 4209.2540s
	iters: 200, epoch: 22 | loss: 0.0711397
	speed: 0.0558s/iter; left time: 971.1984s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:13.05s
Steps: 223 | Train Loss: 0.0702365 Vali Loss: 0.0858019 Test Loss: 0.0882561
Validation loss decreased (0.085879 --> 0.085802).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0722965
	speed: 0.0973s/iter; left time: 1682.5152s
	iters: 200, epoch: 23 | loss: 0.0714301
	speed: 0.0556s/iter; left time: 956.5425s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0702496 Vali Loss: 0.0856940 Test Loss: 0.0880869
Validation loss decreased (0.085802 --> 0.085694).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0729966
	speed: 0.0972s/iter; left time: 1659.1227s
	iters: 200, epoch: 24 | loss: 0.0680063
	speed: 0.0557s/iter; left time: 945.1181s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0700992 Vali Loss: 0.0857747 Test Loss: 0.0881663
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0697086
	speed: 0.0964s/iter; left time: 1623.6354s
	iters: 200, epoch: 25 | loss: 0.0660151
	speed: 0.0556s/iter; left time: 932.0602s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0700257 Vali Loss: 0.0856531 Test Loss: 0.0879749
Validation loss decreased (0.085694 --> 0.085653).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0688517
	speed: 0.0974s/iter; left time: 1619.7967s
	iters: 200, epoch: 26 | loss: 0.0606614
	speed: 0.0557s/iter; left time: 920.6828s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0699975 Vali Loss: 0.0857388 Test Loss: 0.0880380
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0686153
	speed: 0.0961s/iter; left time: 1576.8762s
	iters: 200, epoch: 27 | loss: 0.0720461
	speed: 0.0557s/iter; left time: 907.9097s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0699892 Vali Loss: 0.0856320 Test Loss: 0.0880470
Validation loss decreased (0.085653 --> 0.085632).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0720013
	speed: 0.0964s/iter; left time: 1560.2263s
	iters: 200, epoch: 28 | loss: 0.0707490
	speed: 0.0557s/iter; left time: 895.0595s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0699229 Vali Loss: 0.0855001 Test Loss: 0.0879894
Validation loss decreased (0.085632 --> 0.085500).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0708807
	speed: 0.0973s/iter; left time: 1552.7180s
	iters: 200, epoch: 29 | loss: 0.0707058
	speed: 0.0557s/iter; left time: 882.5779s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0699270 Vali Loss: 0.0854612 Test Loss: 0.0880216
Validation loss decreased (0.085500 --> 0.085461).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0710514
	speed: 0.0971s/iter; left time: 1528.0552s
	iters: 200, epoch: 30 | loss: 0.0662546
	speed: 0.0557s/iter; left time: 870.4095s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0698292 Vali Loss: 0.0856229 Test Loss: 0.0880136
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0734654
	speed: 0.0966s/iter; left time: 1497.6724s
	iters: 200, epoch: 31 | loss: 0.0677515
	speed: 0.0598s/iter; left time: 921.4418s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:12.98s
Steps: 223 | Train Loss: 0.0698069 Vali Loss: 0.0854874 Test Loss: 0.0878906
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0712474
	speed: 0.1011s/iter; left time: 1545.5408s
	iters: 200, epoch: 32 | loss: 0.0654372
	speed: 0.0557s/iter; left time: 846.0904s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:12.65s
Steps: 223 | Train Loss: 0.0697557 Vali Loss: 0.0854843 Test Loss: 0.0879423
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0690423
	speed: 0.0965s/iter; left time: 1453.1797s
	iters: 200, epoch: 33 | loss: 0.0679753
	speed: 0.0557s/iter; left time: 833.5912s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0696973 Vali Loss: 0.0855460 Test Loss: 0.0879180
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0715394
	speed: 0.0974s/iter; left time: 1445.0831s
	iters: 200, epoch: 34 | loss: 0.0750787
	speed: 0.0557s/iter; left time: 820.6518s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0697239 Vali Loss: 0.0854108 Test Loss: 0.0879490
Validation loss decreased (0.085461 --> 0.085411).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0690634
	speed: 0.0970s/iter; left time: 1417.6459s
	iters: 200, epoch: 35 | loss: 0.0721469
	speed: 0.0556s/iter; left time: 807.8901s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0696829 Vali Loss: 0.0855239 Test Loss: 0.0879045
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0645434
	speed: 0.0963s/iter; left time: 1386.0281s
	iters: 200, epoch: 36 | loss: 0.0615992
	speed: 0.0557s/iter; left time: 795.6057s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0697068 Vali Loss: 0.0854764 Test Loss: 0.0879015
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0672771
	speed: 0.0961s/iter; left time: 1361.8382s
	iters: 200, epoch: 37 | loss: 0.0621125
	speed: 0.0557s/iter; left time: 783.7067s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0696620 Vali Loss: 0.0854599 Test Loss: 0.0879198
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0677729
	speed: 0.0970s/iter; left time: 1353.8420s
	iters: 200, epoch: 38 | loss: 0.0694276
	speed: 0.0557s/iter; left time: 770.9666s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0696719 Vali Loss: 0.0854918 Test Loss: 0.0879481
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0696932
	speed: 0.0971s/iter; left time: 1333.2887s
	iters: 200, epoch: 39 | loss: 0.0687645
	speed: 0.0557s/iter; left time: 758.4212s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0696647 Vali Loss: 0.0855289 Test Loss: 0.0879689
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0642762
	speed: 0.0973s/iter; left time: 1314.1102s
	iters: 200, epoch: 40 | loss: 0.0678461
	speed: 0.0557s/iter; left time: 746.1651s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0696252 Vali Loss: 0.0854736 Test Loss: 0.0878735
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0698427
	speed: 0.0987s/iter; left time: 1311.2121s
	iters: 200, epoch: 41 | loss: 0.0653338
	speed: 0.0557s/iter; left time: 734.1025s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:12.78s
Steps: 223 | Train Loss: 0.0696694 Vali Loss: 0.0853362 Test Loss: 0.0879158
Validation loss decreased (0.085411 --> 0.085336).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0717271
	speed: 0.1739s/iter; left time: 2271.2466s
	iters: 200, epoch: 42 | loss: 0.0678519
	speed: 0.0590s/iter; left time: 764.9730s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:20.30s
Steps: 223 | Train Loss: 0.0696300 Vali Loss: 0.0855636 Test Loss: 0.0878947
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0661314
	speed: 0.0969s/iter; left time: 1243.8776s
	iters: 200, epoch: 43 | loss: 0.0704750
	speed: 0.0556s/iter; left time: 708.0327s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0695907 Vali Loss: 0.0854893 Test Loss: 0.0878903
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0704460
	speed: 0.0958s/iter; left time: 1208.1613s
	iters: 200, epoch: 44 | loss: 0.0706366
	speed: 0.0556s/iter; left time: 695.9864s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0696234 Vali Loss: 0.0853781 Test Loss: 0.0879172
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0717367
	speed: 0.0991s/iter; left time: 1227.6265s
	iters: 200, epoch: 45 | loss: 0.0698064
	speed: 0.0566s/iter; left time: 695.8984s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:12.92s
Steps: 223 | Train Loss: 0.0695847 Vali Loss: 0.0853864 Test Loss: 0.0879186
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0661803
	speed: 0.3822s/iter; left time: 4649.6345s
	iters: 200, epoch: 46 | loss: 0.0637130
	speed: 0.1979s/iter; left time: 2387.6172s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:45.79s
Steps: 223 | Train Loss: 0.0695895 Vali Loss: 0.0854397 Test Loss: 0.0879578
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0707999
	speed: 0.4448s/iter; left time: 5312.2584s
	iters: 200, epoch: 47 | loss: 0.0674502
	speed: 0.2049s/iter; left time: 2426.6455s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:44.92s
Steps: 223 | Train Loss: 0.0695607 Vali Loss: 0.0854818 Test Loss: 0.0879332
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0653478
	speed: 0.4403s/iter; left time: 5159.8858s
	iters: 200, epoch: 48 | loss: 0.0760485
	speed: 0.1901s/iter; left time: 2208.7546s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:44.05s
Steps: 223 | Train Loss: 0.0695990 Vali Loss: 0.0855168 Test Loss: 0.0878915
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0666074
	speed: 0.4195s/iter; left time: 4822.5781s
	iters: 200, epoch: 49 | loss: 0.0666795
	speed: 0.0937s/iter; left time: 1068.2118s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:30.52s
Steps: 223 | Train Loss: 0.0695911 Vali Loss: 0.0854137 Test Loss: 0.0878726
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0674558
	speed: 0.1339s/iter; left time: 1509.6432s
	iters: 200, epoch: 50 | loss: 0.0675304
	speed: 0.0566s/iter; left time: 632.1500s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:13.17s
Steps: 223 | Train Loss: 0.0695212 Vali Loss: 0.0853814 Test Loss: 0.0879392
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0730881
	speed: 0.1021s/iter; left time: 1128.5975s
	iters: 200, epoch: 51 | loss: 0.0706381
	speed: 0.0564s/iter; left time: 617.7231s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:12.85s
Steps: 223 | Train Loss: 0.0695619 Vali Loss: 0.0853749 Test Loss: 0.0879278
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02084571123123169, rmse:0.14438043534755707, mae:0.08791576325893402, rse:0.5095385909080505
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1321949
	speed: 0.0585s/iter; left time: 1297.8655s
	iters: 200, epoch: 1 | loss: 0.1195247
	speed: 0.0563s/iter; left time: 1244.9639s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.82s
Steps: 223 | Train Loss: 0.1355204 Vali Loss: 0.1248920 Test Loss: 0.1302046
Validation loss decreased (inf --> 0.124892).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0869159
	speed: 0.1001s/iter; left time: 2200.7431s
	iters: 200, epoch: 2 | loss: 0.0792214
	speed: 0.0562s/iter; left time: 1230.0611s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.76s
Steps: 223 | Train Loss: 0.0882127 Vali Loss: 0.0918631 Test Loss: 0.0943182
Validation loss decreased (0.124892 --> 0.091863).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0820515
	speed: 0.1003s/iter; left time: 2181.7006s
	iters: 200, epoch: 3 | loss: 0.0794274
	speed: 0.0562s/iter; left time: 1216.6989s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.75s
Steps: 223 | Train Loss: 0.0791551 Vali Loss: 0.0898517 Test Loss: 0.0931835
Validation loss decreased (0.091863 --> 0.089852).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0748319
	speed: 0.1004s/iter; left time: 2161.6282s
	iters: 200, epoch: 4 | loss: 0.0758545
	speed: 0.0562s/iter; left time: 1203.7651s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.75s
Steps: 223 | Train Loss: 0.0770344 Vali Loss: 0.0888502 Test Loss: 0.0912462
Validation loss decreased (0.089852 --> 0.088850).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0794775
	speed: 0.0996s/iter; left time: 2121.9133s
	iters: 200, epoch: 5 | loss: 0.0783038
	speed: 0.0561s/iter; left time: 1189.6976s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.74s
Steps: 223 | Train Loss: 0.0755707 Vali Loss: 0.0883333 Test Loss: 0.0905530
Validation loss decreased (0.088850 --> 0.088333).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0737492
	speed: 0.0998s/iter; left time: 2104.7996s
	iters: 200, epoch: 6 | loss: 0.0699851
	speed: 0.0560s/iter; left time: 1175.9304s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.71s
Steps: 223 | Train Loss: 0.0745040 Vali Loss: 0.0882450 Test Loss: 0.0902655
Validation loss decreased (0.088333 --> 0.088245).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0761966
	speed: 0.0986s/iter; left time: 2056.8633s
	iters: 200, epoch: 7 | loss: 0.0732298
	speed: 0.0559s/iter; left time: 1161.4006s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.66s
Steps: 223 | Train Loss: 0.0737765 Vali Loss: 0.0872415 Test Loss: 0.0893371
Validation loss decreased (0.088245 --> 0.087241).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0738960
	speed: 0.0981s/iter; left time: 2025.0048s
	iters: 200, epoch: 8 | loss: 0.0792185
	speed: 0.0559s/iter; left time: 1148.3755s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.66s
Steps: 223 | Train Loss: 0.0730418 Vali Loss: 0.0870644 Test Loss: 0.0889776
Validation loss decreased (0.087241 --> 0.087064).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0699037
	speed: 0.0981s/iter; left time: 2003.0031s
	iters: 200, epoch: 9 | loss: 0.0689672
	speed: 0.0560s/iter; left time: 1137.1824s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.67s
Steps: 223 | Train Loss: 0.0725071 Vali Loss: 0.0869053 Test Loss: 0.0892861
Validation loss decreased (0.087064 --> 0.086905).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0692783
	speed: 0.0987s/iter; left time: 1993.4443s
	iters: 200, epoch: 10 | loss: 0.0771821
	speed: 0.0560s/iter; left time: 1125.2491s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.69s
Steps: 223 | Train Loss: 0.0722507 Vali Loss: 0.0868102 Test Loss: 0.0888723
Validation loss decreased (0.086905 --> 0.086810).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0732150
	speed: 0.0988s/iter; left time: 1973.0183s
	iters: 200, epoch: 11 | loss: 0.0711397
	speed: 0.0560s/iter; left time: 1112.2736s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.68s
Steps: 223 | Train Loss: 0.0718777 Vali Loss: 0.0862361 Test Loss: 0.0886134
Validation loss decreased (0.086810 --> 0.086236).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0752613
	speed: 0.0996s/iter; left time: 1965.9867s
	iters: 200, epoch: 12 | loss: 0.0696609
	speed: 0.0560s/iter; left time: 1099.6293s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.72s
Steps: 223 | Train Loss: 0.0715555 Vali Loss: 0.0862368 Test Loss: 0.0885744
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0696154
	speed: 0.0978s/iter; left time: 1910.4225s
	iters: 200, epoch: 13 | loss: 0.0712538
	speed: 0.0559s/iter; left time: 1086.2713s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.66s
Steps: 223 | Train Loss: 0.0713454 Vali Loss: 0.0865776 Test Loss: 0.0886776
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0710302
	speed: 0.0976s/iter; left time: 1883.5708s
	iters: 200, epoch: 14 | loss: 0.0697807
	speed: 0.0560s/iter; left time: 1075.9990s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.69s
Steps: 223 | Train Loss: 0.0710154 Vali Loss: 0.0861612 Test Loss: 0.0887227
Validation loss decreased (0.086236 --> 0.086161).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0721809
	speed: 0.0984s/iter; left time: 1876.4410s
	iters: 200, epoch: 15 | loss: 0.0740700
	speed: 0.0560s/iter; left time: 1062.8882s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.68s
Steps: 223 | Train Loss: 0.0708765 Vali Loss: 0.0859608 Test Loss: 0.0887293
Validation loss decreased (0.086161 --> 0.085961).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0704648
	speed: 0.0982s/iter; left time: 1852.1776s
	iters: 200, epoch: 16 | loss: 0.0707092
	speed: 0.0560s/iter; left time: 1050.2270s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.68s
Steps: 223 | Train Loss: 0.0707461 Vali Loss: 0.0859768 Test Loss: 0.0884334
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0682754
	speed: 0.0983s/iter; left time: 1831.9460s
	iters: 200, epoch: 17 | loss: 0.0726420
	speed: 0.0558s/iter; left time: 1033.9239s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.67s
Steps: 223 | Train Loss: 0.0705416 Vali Loss: 0.0860883 Test Loss: 0.0883619
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0666464
	speed: 0.0985s/iter; left time: 1814.0579s
	iters: 200, epoch: 18 | loss: 0.0721241
	speed: 0.0560s/iter; left time: 1024.4903s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.70s
Steps: 223 | Train Loss: 0.0704308 Vali Loss: 0.0858410 Test Loss: 0.0884350
Validation loss decreased (0.085961 --> 0.085841).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0720225
	speed: 0.0998s/iter; left time: 1814.5629s
	iters: 200, epoch: 19 | loss: 0.0684079
	speed: 0.0559s/iter; left time: 1011.8238s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:12.66s
Steps: 223 | Train Loss: 0.0703177 Vali Loss: 0.0862782 Test Loss: 0.0886609
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0747698
	speed: 0.0981s/iter; left time: 1762.9499s
	iters: 200, epoch: 20 | loss: 0.0740259
	speed: 0.0557s/iter; left time: 995.5033s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.66s
Steps: 223 | Train Loss: 0.0702077 Vali Loss: 0.0857407 Test Loss: 0.0881165
Validation loss decreased (0.085841 --> 0.085741).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0676428
	speed: 0.0986s/iter; left time: 1749.5794s
	iters: 200, epoch: 21 | loss: 0.0731598
	speed: 0.0557s/iter; left time: 982.5841s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:12.65s
Steps: 223 | Train Loss: 0.0700955 Vali Loss: 0.0856354 Test Loss: 0.0884902
Validation loss decreased (0.085741 --> 0.085635).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0673825
	speed: 0.0981s/iter; left time: 1718.5668s
	iters: 200, epoch: 22 | loss: 0.0733292
	speed: 0.0559s/iter; left time: 972.9081s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:12.68s
Steps: 223 | Train Loss: 0.0700543 Vali Loss: 0.0858868 Test Loss: 0.0882234
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0761369
	speed: 0.0983s/iter; left time: 1699.9604s
	iters: 200, epoch: 23 | loss: 0.0708756
	speed: 0.0558s/iter; left time: 959.5232s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:12.72s
Steps: 223 | Train Loss: 0.0699498 Vali Loss: 0.0855788 Test Loss: 0.0882074
Validation loss decreased (0.085635 --> 0.085579).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0689597
	speed: 0.0981s/iter; left time: 1674.3440s
	iters: 200, epoch: 24 | loss: 0.0710519
	speed: 0.0556s/iter; left time: 944.4829s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0698366 Vali Loss: 0.0856740 Test Loss: 0.0882654
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0673283
	speed: 0.0978s/iter; left time: 1647.4443s
	iters: 200, epoch: 25 | loss: 0.0701892
	speed: 0.0556s/iter; left time: 930.9707s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0698020 Vali Loss: 0.0855684 Test Loss: 0.0883306
Validation loss decreased (0.085579 --> 0.085568).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0654884
	speed: 0.0986s/iter; left time: 1639.9428s
	iters: 200, epoch: 26 | loss: 0.0740729
	speed: 0.0556s/iter; left time: 918.6945s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0697329 Vali Loss: 0.0856214 Test Loss: 0.0882084
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0697414
	speed: 0.0977s/iter; left time: 1603.2724s
	iters: 200, epoch: 27 | loss: 0.0663603
	speed: 0.0556s/iter; left time: 906.6200s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0697158 Vali Loss: 0.0856465 Test Loss: 0.0883860
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0733333
	speed: 0.0978s/iter; left time: 1581.8238s
	iters: 200, epoch: 28 | loss: 0.0680581
	speed: 0.0557s/iter; left time: 894.8676s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0696312 Vali Loss: 0.0855474 Test Loss: 0.0882996
Validation loss decreased (0.085568 --> 0.085547).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0695887
	speed: 0.0984s/iter; left time: 1570.6086s
	iters: 200, epoch: 29 | loss: 0.0727355
	speed: 0.0556s/iter; left time: 881.4968s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0695944 Vali Loss: 0.0855103 Test Loss: 0.0882742
Validation loss decreased (0.085547 --> 0.085510).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0654744
	speed: 0.0980s/iter; left time: 1541.6680s
	iters: 200, epoch: 30 | loss: 0.0713100
	speed: 0.0556s/iter; left time: 869.8397s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0695733 Vali Loss: 0.0854913 Test Loss: 0.0881864
Validation loss decreased (0.085510 --> 0.085491).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0699294
	speed: 0.0995s/iter; left time: 1543.0130s
	iters: 200, epoch: 31 | loss: 0.0719529
	speed: 0.0556s/iter; left time: 856.7209s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0694808 Vali Loss: 0.0855194 Test Loss: 0.0882467
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0717089
	speed: 0.0982s/iter; left time: 1501.4923s
	iters: 200, epoch: 32 | loss: 0.0716076
	speed: 0.0556s/iter; left time: 843.8282s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0695085 Vali Loss: 0.0855041 Test Loss: 0.0881491
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0678412
	speed: 0.0976s/iter; left time: 1469.7178s
	iters: 200, epoch: 33 | loss: 0.0721972
	speed: 0.0558s/iter; left time: 834.5498s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0694701 Vali Loss: 0.0854765 Test Loss: 0.0881829
Validation loss decreased (0.085491 --> 0.085477).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0687791
	speed: 0.0981s/iter; left time: 1455.8451s
	iters: 200, epoch: 34 | loss: 0.0698830
	speed: 0.0557s/iter; left time: 820.4724s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0694615 Vali Loss: 0.0854668 Test Loss: 0.0881900
Validation loss decreased (0.085477 --> 0.085467).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0780406
	speed: 0.0988s/iter; left time: 1444.6798s
	iters: 200, epoch: 35 | loss: 0.0692534
	speed: 0.0557s/iter; left time: 808.2832s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:12.70s
Steps: 223 | Train Loss: 0.0694168 Vali Loss: 0.0854433 Test Loss: 0.0881925
Validation loss decreased (0.085467 --> 0.085443).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0702760
	speed: 0.0983s/iter; left time: 1414.6276s
	iters: 200, epoch: 36 | loss: 0.0728263
	speed: 0.0558s/iter; left time: 797.5185s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0694150 Vali Loss: 0.0854202 Test Loss: 0.0882087
Validation loss decreased (0.085443 --> 0.085420).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0724953
	speed: 0.0993s/iter; left time: 1406.7536s
	iters: 200, epoch: 37 | loss: 0.0703829
	speed: 0.0557s/iter; left time: 783.8713s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0694151 Vali Loss: 0.0854038 Test Loss: 0.0881835
Validation loss decreased (0.085420 --> 0.085404).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0660174
	speed: 0.0988s/iter; left time: 1378.2318s
	iters: 200, epoch: 38 | loss: 0.0667294
	speed: 0.0557s/iter; left time: 771.2624s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0693594 Vali Loss: 0.0854219 Test Loss: 0.0882360
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0672446
	speed: 0.0980s/iter; left time: 1344.5821s
	iters: 200, epoch: 39 | loss: 0.0719632
	speed: 0.0556s/iter; left time: 757.3801s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:12.65s
Steps: 223 | Train Loss: 0.0694173 Vali Loss: 0.0854895 Test Loss: 0.0882136
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0677967
	speed: 0.0974s/iter; left time: 1315.8969s
	iters: 200, epoch: 40 | loss: 0.0689068
	speed: 0.0556s/iter; left time: 744.7477s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0693307 Vali Loss: 0.0854681 Test Loss: 0.0881989
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0681659
	speed: 0.0972s/iter; left time: 1291.0549s
	iters: 200, epoch: 41 | loss: 0.0671629
	speed: 0.0555s/iter; left time: 731.7693s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0692700 Vali Loss: 0.0854146 Test Loss: 0.0881918
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0682741
	speed: 0.0978s/iter; left time: 1277.6139s
	iters: 200, epoch: 42 | loss: 0.0739376
	speed: 0.0556s/iter; left time: 719.8429s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0692600 Vali Loss: 0.0854725 Test Loss: 0.0882275
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0713579
	speed: 0.0973s/iter; left time: 1249.4545s
	iters: 200, epoch: 43 | loss: 0.0718290
	speed: 0.0556s/iter; left time: 708.1053s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0693000 Vali Loss: 0.0854612 Test Loss: 0.0882292
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0687260
	speed: 0.0981s/iter; left time: 1237.7862s
	iters: 200, epoch: 44 | loss: 0.0746944
	speed: 0.0555s/iter; left time: 695.0289s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0693090 Vali Loss: 0.0854083 Test Loss: 0.0882302
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0692354
	speed: 0.0980s/iter; left time: 1214.4327s
	iters: 200, epoch: 45 | loss: 0.0661913
	speed: 0.0557s/iter; left time: 684.6969s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0692688 Vali Loss: 0.0854105 Test Loss: 0.0882326
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0687669
	speed: 0.0977s/iter; left time: 1188.5401s
	iters: 200, epoch: 46 | loss: 0.0675251
	speed: 0.0557s/iter; left time: 672.2034s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0692543 Vali Loss: 0.0854415 Test Loss: 0.0882191
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0708708
	speed: 0.0972s/iter; left time: 1160.2913s
	iters: 200, epoch: 47 | loss: 0.0699173
	speed: 0.0556s/iter; left time: 658.2055s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0692846 Vali Loss: 0.0854284 Test Loss: 0.0882030
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_DE_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02115781232714653, rmse:0.14545725286006927, mae:0.08818355202674866, rse:0.5133388042449951
Intermediate time for DE and pred_len 24: 00h:29m:00.29s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1386770
	speed: 0.0732s/iter; left time: 1617.9581s
	iters: 200, epoch: 1 | loss: 0.1275029
	speed: 0.0561s/iter; left time: 1234.7759s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.84s
Steps: 222 | Train Loss: 0.1436589 Vali Loss: 0.1367227 Test Loss: 0.1443707
Validation loss decreased (inf --> 0.136723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1119815
	speed: 0.0975s/iter; left time: 2133.7373s
	iters: 200, epoch: 2 | loss: 0.1102261
	speed: 0.0560s/iter; left time: 1219.8538s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.58s
Steps: 222 | Train Loss: 0.1122268 Vali Loss: 0.1208071 Test Loss: 0.1275149
Validation loss decreased (0.136723 --> 0.120807).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1020786
	speed: 0.1001s/iter; left time: 2168.2093s
	iters: 200, epoch: 3 | loss: 0.1071238
	speed: 0.0560s/iter; left time: 1207.0401s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.57s
Steps: 222 | Train Loss: 0.1050913 Vali Loss: 0.1187858 Test Loss: 0.1260760
Validation loss decreased (0.120807 --> 0.118786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0993240
	speed: 0.0982s/iter; left time: 2104.2546s
	iters: 200, epoch: 4 | loss: 0.1062713
	speed: 0.0559s/iter; left time: 1192.9190s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.55s
Steps: 222 | Train Loss: 0.1032697 Vali Loss: 0.1184309 Test Loss: 0.1263589
Validation loss decreased (0.118786 --> 0.118431).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1071941
	speed: 0.0989s/iter; left time: 2097.1131s
	iters: 200, epoch: 5 | loss: 0.1011960
	speed: 0.0561s/iter; left time: 1183.5208s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1018686 Vali Loss: 0.1174367 Test Loss: 0.1259556
Validation loss decreased (0.118431 --> 0.117437).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0985333
	speed: 0.0983s/iter; left time: 2062.7188s
	iters: 200, epoch: 6 | loss: 0.0995864
	speed: 0.0561s/iter; left time: 1171.1833s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.1008020 Vali Loss: 0.1173732 Test Loss: 0.1252204
Validation loss decreased (0.117437 --> 0.117373).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0983450
	speed: 0.0993s/iter; left time: 2062.8763s
	iters: 200, epoch: 7 | loss: 0.1028825
	speed: 0.0561s/iter; left time: 1158.9341s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.0997352 Vali Loss: 0.1163223 Test Loss: 0.1250026
Validation loss decreased (0.117373 --> 0.116322).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0966778
	speed: 0.1006s/iter; left time: 2067.5907s
	iters: 200, epoch: 8 | loss: 0.0981909
	speed: 0.0561s/iter; left time: 1146.1325s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.0990780 Vali Loss: 0.1164870 Test Loss: 0.1249006
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0970541
	speed: 0.0981s/iter; left time: 1994.2145s
	iters: 200, epoch: 9 | loss: 0.0927569
	speed: 0.0562s/iter; left time: 1136.1653s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0982853 Vali Loss: 0.1163101 Test Loss: 0.1247123
Validation loss decreased (0.116322 --> 0.116310).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1004419
	speed: 0.0987s/iter; left time: 1984.2426s
	iters: 200, epoch: 10 | loss: 0.1027958
	speed: 0.0561s/iter; left time: 1122.2273s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.63s
Steps: 222 | Train Loss: 0.0977100 Vali Loss: 0.1168362 Test Loss: 0.1261414
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0973103
	speed: 0.0985s/iter; left time: 1957.3190s
	iters: 200, epoch: 11 | loss: 0.0973775
	speed: 0.0561s/iter; left time: 1109.8529s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.63s
Steps: 222 | Train Loss: 0.0972067 Vali Loss: 0.1165401 Test Loss: 0.1248463
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0943016
	speed: 0.0979s/iter; left time: 1925.0397s
	iters: 200, epoch: 12 | loss: 0.0890948
	speed: 0.0559s/iter; left time: 1094.2387s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.55s
Steps: 222 | Train Loss: 0.0967826 Vali Loss: 0.1167771 Test Loss: 0.1255921
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0919507
	speed: 0.0975s/iter; left time: 1894.2783s
	iters: 200, epoch: 13 | loss: 0.0924439
	speed: 0.0561s/iter; left time: 1084.4459s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0964317 Vali Loss: 0.1169391 Test Loss: 0.1255141
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0920366
	speed: 0.0979s/iter; left time: 1881.9140s
	iters: 200, epoch: 14 | loss: 0.0965247
	speed: 0.0560s/iter; left time: 1071.3235s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0958845 Vali Loss: 0.1169356 Test Loss: 0.1257542
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0993237
	speed: 0.0979s/iter; left time: 1858.6467s
	iters: 200, epoch: 15 | loss: 0.0994493
	speed: 0.0560s/iter; left time: 1058.3738s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0956289 Vali Loss: 0.1167035 Test Loss: 0.1253432
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1000477
	speed: 0.0982s/iter; left time: 1843.9902s
	iters: 200, epoch: 16 | loss: 0.0847670
	speed: 0.0560s/iter; left time: 1046.3701s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0952643 Vali Loss: 0.1171782 Test Loss: 0.1261246
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0950092
	speed: 0.0981s/iter; left time: 1818.7499s
	iters: 200, epoch: 17 | loss: 0.0940945
	speed: 0.0561s/iter; left time: 1034.4269s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0950014 Vali Loss: 0.1169843 Test Loss: 0.1258609
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0952450
	speed: 0.0970s/iter; left time: 1776.8518s
	iters: 200, epoch: 18 | loss: 0.0911217
	speed: 0.0561s/iter; left time: 1022.6449s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.57s
Steps: 222 | Train Loss: 0.0946936 Vali Loss: 0.1172174 Test Loss: 0.1259473
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0924156
	speed: 0.0960s/iter; left time: 1737.5872s
	iters: 200, epoch: 19 | loss: 0.0927952
	speed: 0.0560s/iter; left time: 1008.3210s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:12.56s
Steps: 222 | Train Loss: 0.0944330 Vali Loss: 0.1170902 Test Loss: 0.1258976
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0357123464345932, rmse:0.18897710740566254, mae:0.12471231073141098, rse:0.6692061424255371
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1400153
	speed: 0.0607s/iter; left time: 1340.4608s
	iters: 200, epoch: 1 | loss: 0.1283204
	speed: 0.0560s/iter; left time: 1231.0113s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.93s
Steps: 222 | Train Loss: 0.1451430 Vali Loss: 0.1368039 Test Loss: 0.1443701
Validation loss decreased (inf --> 0.136804).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1105237
	speed: 0.0977s/iter; left time: 2136.7989s
	iters: 200, epoch: 2 | loss: 0.1087797
	speed: 0.0560s/iter; left time: 1219.8764s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.1123487 Vali Loss: 0.1206258 Test Loss: 0.1276149
Validation loss decreased (0.136804 --> 0.120626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1059384
	speed: 0.0978s/iter; left time: 2118.7439s
	iters: 200, epoch: 3 | loss: 0.1022027
	speed: 0.0562s/iter; left time: 1211.4749s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.63s
Steps: 222 | Train Loss: 0.1053810 Vali Loss: 0.1195757 Test Loss: 0.1275250
Validation loss decreased (0.120626 --> 0.119576).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1005405
	speed: 0.1000s/iter; left time: 2143.8992s
	iters: 200, epoch: 4 | loss: 0.1009716
	speed: 0.0560s/iter; left time: 1194.2722s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.1036713 Vali Loss: 0.1178414 Test Loss: 0.1258538
Validation loss decreased (0.119576 --> 0.117841).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1006262
	speed: 0.0984s/iter; left time: 2086.4697s
	iters: 200, epoch: 5 | loss: 0.1009720
	speed: 0.0560s/iter; left time: 1182.2610s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.1022844 Vali Loss: 0.1183373 Test Loss: 0.1259439
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1044686
	speed: 0.0985s/iter; left time: 2066.9535s
	iters: 200, epoch: 6 | loss: 0.1039320
	speed: 0.0561s/iter; left time: 1172.1466s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1011754 Vali Loss: 0.1172123 Test Loss: 0.1262177
Validation loss decreased (0.117841 --> 0.117212).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0983822
	speed: 0.0985s/iter; left time: 2046.7621s
	iters: 200, epoch: 7 | loss: 0.0999982
	speed: 0.0560s/iter; left time: 1156.6070s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.1001580 Vali Loss: 0.1167087 Test Loss: 0.1267239
Validation loss decreased (0.117212 --> 0.116709).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0978371
	speed: 0.0986s/iter; left time: 2026.7079s
	iters: 200, epoch: 8 | loss: 0.0960991
	speed: 0.0560s/iter; left time: 1144.9732s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0993198 Vali Loss: 0.1167437 Test Loss: 0.1256996
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1030914
	speed: 0.0971s/iter; left time: 1972.8331s
	iters: 200, epoch: 9 | loss: 0.1060393
	speed: 0.0562s/iter; left time: 1136.1245s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.0985208 Vali Loss: 0.1168993 Test Loss: 0.1262533
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0944255
	speed: 0.0968s/iter; left time: 1945.8575s
	iters: 200, epoch: 10 | loss: 0.1005896
	speed: 0.0560s/iter; left time: 1120.0564s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.58s
Steps: 222 | Train Loss: 0.0978726 Vali Loss: 0.1164778 Test Loss: 0.1254682
Validation loss decreased (0.116709 --> 0.116478).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0977786
	speed: 0.0978s/iter; left time: 1944.9826s
	iters: 200, epoch: 11 | loss: 0.1001371
	speed: 0.0560s/iter; left time: 1107.3383s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.0972471 Vali Loss: 0.1168976 Test Loss: 0.1259428
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0953204
	speed: 0.0989s/iter; left time: 1944.8913s
	iters: 200, epoch: 12 | loss: 0.0940205
	speed: 0.0561s/iter; left time: 1096.4561s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.68s
Steps: 222 | Train Loss: 0.0966455 Vali Loss: 0.1169655 Test Loss: 0.1269953
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0961258
	speed: 0.0975s/iter; left time: 1895.6554s
	iters: 200, epoch: 13 | loss: 0.0972280
	speed: 0.0560s/iter; left time: 1083.5621s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.60s
Steps: 222 | Train Loss: 0.0962103 Vali Loss: 0.1170050 Test Loss: 0.1266064
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0952882
	speed: 0.0973s/iter; left time: 1870.4021s
	iters: 200, epoch: 14 | loss: 0.0944683
	speed: 0.0560s/iter; left time: 1070.0426s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.0957853 Vali Loss: 0.1175132 Test Loss: 0.1264056
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0908371
	speed: 0.0974s/iter; left time: 1849.2390s
	iters: 200, epoch: 15 | loss: 0.0950360
	speed: 0.0560s/iter; left time: 1058.3031s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0954513 Vali Loss: 0.1173833 Test Loss: 0.1263880
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0962350
	speed: 0.0972s/iter; left time: 1824.7716s
	iters: 200, epoch: 16 | loss: 0.0930480
	speed: 0.0560s/iter; left time: 1045.1307s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.57s
Steps: 222 | Train Loss: 0.0950452 Vali Loss: 0.1174323 Test Loss: 0.1273650
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0914153
	speed: 0.0971s/iter; left time: 1801.1286s
	iters: 200, epoch: 17 | loss: 0.0968439
	speed: 0.0560s/iter; left time: 1033.5842s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.0946228 Vali Loss: 0.1173784 Test Loss: 0.1264199
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0973026
	speed: 0.0983s/iter; left time: 1801.6330s
	iters: 200, epoch: 18 | loss: 0.0956572
	speed: 0.0560s/iter; left time: 1020.2855s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0943172 Vali Loss: 0.1177413 Test Loss: 0.1269055
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0978792
	speed: 0.0969s/iter; left time: 1754.5040s
	iters: 200, epoch: 19 | loss: 0.0975742
	speed: 0.0560s/iter; left time: 1008.2377s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:12.59s
Steps: 222 | Train Loss: 0.0940416 Vali Loss: 0.1174546 Test Loss: 0.1267941
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0935509
	speed: 0.0974s/iter; left time: 1741.2340s
	iters: 200, epoch: 20 | loss: 0.0917177
	speed: 0.0560s/iter; left time: 996.1899s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0937595 Vali Loss: 0.1178303 Test Loss: 0.1271784
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03607788681983948, rmse:0.18994179368019104, mae:0.1254681944847107, rse:0.6726222634315491
Intermediate time for DE and pred_len 96: 00h:10m:12.61s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1399002
	speed: 0.0736s/iter; left time: 1627.4941s
	iters: 200, epoch: 1 | loss: 0.1310720
	speed: 0.0563s/iter; left time: 1239.4012s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.93s
Steps: 222 | Train Loss: 0.1455335 Vali Loss: 0.1382271 Test Loss: 0.1469403
Validation loss decreased (inf --> 0.138227).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1117309
	speed: 0.1001s/iter; left time: 2189.3365s
	iters: 200, epoch: 2 | loss: 0.1123937
	speed: 0.0562s/iter; left time: 1224.9201s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1173331 Vali Loss: 0.1245262 Test Loss: 0.1328125
Validation loss decreased (0.138227 --> 0.124526).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1142129
	speed: 0.0987s/iter; left time: 2136.9183s
	iters: 200, epoch: 3 | loss: 0.1112960
	speed: 0.0562s/iter; left time: 1212.2055s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.68s
Steps: 222 | Train Loss: 0.1107632 Vali Loss: 0.1232793 Test Loss: 0.1330868
Validation loss decreased (0.124526 --> 0.123279).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1128851
	speed: 0.0990s/iter; left time: 2121.5691s
	iters: 200, epoch: 4 | loss: 0.1049208
	speed: 0.0564s/iter; left time: 1202.5734s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.67s
Steps: 222 | Train Loss: 0.1088794 Vali Loss: 0.1225181 Test Loss: 0.1325915
Validation loss decreased (0.123279 --> 0.122518).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1046247
	speed: 0.0995s/iter; left time: 2111.0974s
	iters: 200, epoch: 5 | loss: 0.1109414
	speed: 0.0563s/iter; left time: 1187.6292s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1072736 Vali Loss: 0.1221427 Test Loss: 0.1330497
Validation loss decreased (0.122518 --> 0.122143).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1038896
	speed: 0.1006s/iter; left time: 2112.5653s
	iters: 200, epoch: 6 | loss: 0.1055614
	speed: 0.0562s/iter; left time: 1174.6867s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.1058474 Vali Loss: 0.1215778 Test Loss: 0.1318558
Validation loss decreased (0.122143 --> 0.121578).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1041685
	speed: 0.0989s/iter; left time: 2054.7160s
	iters: 200, epoch: 7 | loss: 0.1039714
	speed: 0.0564s/iter; left time: 1165.1144s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1048099 Vali Loss: 0.1214240 Test Loss: 0.1309484
Validation loss decreased (0.121578 --> 0.121424).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1028266
	speed: 0.1006s/iter; left time: 2067.7900s
	iters: 200, epoch: 8 | loss: 0.1051091
	speed: 0.0563s/iter; left time: 1150.7676s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.68s
Steps: 222 | Train Loss: 0.1038182 Vali Loss: 0.1214119 Test Loss: 0.1320169
Validation loss decreased (0.121424 --> 0.121412).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1042578
	speed: 0.0996s/iter; left time: 2025.2615s
	iters: 200, epoch: 9 | loss: 0.1050219
	speed: 0.0565s/iter; left time: 1143.3706s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.77s
Steps: 222 | Train Loss: 0.1030263 Vali Loss: 0.1220749 Test Loss: 0.1315216
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0999491
	speed: 0.0985s/iter; left time: 1980.2510s
	iters: 200, epoch: 10 | loss: 0.1035637
	speed: 0.0565s/iter; left time: 1131.0577s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.74s
Steps: 222 | Train Loss: 0.1022463 Vali Loss: 0.1222583 Test Loss: 0.1317445
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1062949
	speed: 0.0994s/iter; left time: 1976.7728s
	iters: 200, epoch: 11 | loss: 0.1018711
	speed: 0.0564s/iter; left time: 1116.5007s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.74s
Steps: 222 | Train Loss: 0.1015389 Vali Loss: 0.1223068 Test Loss: 0.1325487
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1043713
	speed: 0.0972s/iter; left time: 1910.6977s
	iters: 200, epoch: 12 | loss: 0.1038010
	speed: 0.0563s/iter; left time: 1100.6418s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.1009183 Vali Loss: 0.1225692 Test Loss: 0.1322718
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0969497
	speed: 0.0987s/iter; left time: 1919.2575s
	iters: 200, epoch: 13 | loss: 0.1017084
	speed: 0.0565s/iter; left time: 1093.1834s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.74s
Steps: 222 | Train Loss: 0.1002693 Vali Loss: 0.1229654 Test Loss: 0.1329298
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0960272
	speed: 0.0974s/iter; left time: 1871.2541s
	iters: 200, epoch: 14 | loss: 0.0956312
	speed: 0.0563s/iter; left time: 1075.4648s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0997279 Vali Loss: 0.1232132 Test Loss: 0.1330129
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0969483
	speed: 0.0976s/iter; left time: 1854.4657s
	iters: 200, epoch: 15 | loss: 0.0989557
	speed: 0.0563s/iter; left time: 1063.6766s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0992188 Vali Loss: 0.1234317 Test Loss: 0.1328251
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0992143
	speed: 0.0978s/iter; left time: 1836.5780s
	iters: 200, epoch: 16 | loss: 0.1004101
	speed: 0.0562s/iter; left time: 1050.1986s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.68s
Steps: 222 | Train Loss: 0.0986988 Vali Loss: 0.1237274 Test Loss: 0.1332834
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0983965
	speed: 0.0975s/iter; left time: 1809.4157s
	iters: 200, epoch: 17 | loss: 0.1016725
	speed: 0.0563s/iter; left time: 1039.1633s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.0982776 Vali Loss: 0.1234311 Test Loss: 0.1342439
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1021305
	speed: 0.0978s/iter; left time: 1791.5198s
	iters: 200, epoch: 18 | loss: 0.1000237
	speed: 0.0563s/iter; left time: 1026.3745s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.68s
Steps: 222 | Train Loss: 0.0979285 Vali Loss: 0.1238799 Test Loss: 0.1341607
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.038425009697675705, rmse:0.19602298736572266, mae:0.13201698660850525, rse:0.6943292021751404
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1515820
	speed: 0.0581s/iter; left time: 1284.1425s
	iters: 200, epoch: 1 | loss: 0.1351595
	speed: 0.0562s/iter; left time: 1236.3262s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.71s
Steps: 222 | Train Loss: 0.1459106 Vali Loss: 0.1384471 Test Loss: 0.1474545
Validation loss decreased (inf --> 0.138447).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1206223
	speed: 0.1032s/iter; left time: 2258.6045s
	iters: 200, epoch: 2 | loss: 0.1142049
	speed: 0.0564s/iter; left time: 1227.9976s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.75s
Steps: 222 | Train Loss: 0.1174732 Vali Loss: 0.1245720 Test Loss: 0.1331472
Validation loss decreased (0.138447 --> 0.124572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1117440
	speed: 0.1027s/iter; left time: 2223.2753s
	iters: 200, epoch: 3 | loss: 0.1069415
	speed: 0.0563s/iter; left time: 1213.3641s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1109596 Vali Loss: 0.1228000 Test Loss: 0.1327924
Validation loss decreased (0.124572 --> 0.122800).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1147476
	speed: 0.1018s/iter; left time: 2182.9928s
	iters: 200, epoch: 4 | loss: 0.1086724
	speed: 0.0565s/iter; left time: 1205.4072s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.74s
Steps: 222 | Train Loss: 0.1091430 Vali Loss: 0.1222963 Test Loss: 0.1323178
Validation loss decreased (0.122800 --> 0.122296).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1032344
	speed: 0.0997s/iter; left time: 2114.5639s
	iters: 200, epoch: 5 | loss: 0.1114992
	speed: 0.0565s/iter; left time: 1192.8346s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.74s
Steps: 222 | Train Loss: 0.1075674 Vali Loss: 0.1216319 Test Loss: 0.1328520
Validation loss decreased (0.122296 --> 0.121632).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1055237
	speed: 0.1015s/iter; left time: 2130.5685s
	iters: 200, epoch: 6 | loss: 0.1056632
	speed: 0.0565s/iter; left time: 1180.0359s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.77s
Steps: 222 | Train Loss: 0.1062136 Vali Loss: 0.1215922 Test Loss: 0.1327853
Validation loss decreased (0.121632 --> 0.121592).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1061727
	speed: 0.1000s/iter; left time: 2076.2507s
	iters: 200, epoch: 7 | loss: 0.1068689
	speed: 0.0566s/iter; left time: 1169.6534s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.78s
Steps: 222 | Train Loss: 0.1049340 Vali Loss: 0.1212201 Test Loss: 0.1333899
Validation loss decreased (0.121592 --> 0.121220).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1025914
	speed: 0.1011s/iter; left time: 2077.9060s
	iters: 200, epoch: 8 | loss: 0.1054732
	speed: 0.0566s/iter; left time: 1157.6957s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.79s
Steps: 222 | Train Loss: 0.1037226 Vali Loss: 0.1214384 Test Loss: 0.1324994
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1038579
	speed: 0.0990s/iter; left time: 2011.6868s
	iters: 200, epoch: 9 | loss: 0.0974196
	speed: 0.0563s/iter; left time: 1139.1982s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1026216 Vali Loss: 0.1224918 Test Loss: 0.1345142
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0996268
	speed: 0.0987s/iter; left time: 1984.3095s
	iters: 200, epoch: 10 | loss: 0.1027106
	speed: 0.0564s/iter; left time: 1128.9756s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.72s
Steps: 222 | Train Loss: 0.1015664 Vali Loss: 0.1220061 Test Loss: 0.1339394
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0993154
	speed: 0.0985s/iter; left time: 1958.2135s
	iters: 200, epoch: 11 | loss: 0.1040305
	speed: 0.0564s/iter; left time: 1114.9837s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1006644 Vali Loss: 0.1220355 Test Loss: 0.1343870
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1000718
	speed: 0.0978s/iter; left time: 1923.4137s
	iters: 200, epoch: 12 | loss: 0.1012884
	speed: 0.0562s/iter; left time: 1099.4035s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.0998381 Vali Loss: 0.1228722 Test Loss: 0.1341205
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1016827
	speed: 0.0980s/iter; left time: 1904.5476s
	iters: 200, epoch: 13 | loss: 0.0976272
	speed: 0.0562s/iter; left time: 1086.7566s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.0991605 Vali Loss: 0.1230029 Test Loss: 0.1345378
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1022788
	speed: 0.0974s/iter; left time: 1870.8376s
	iters: 200, epoch: 14 | loss: 0.0998285
	speed: 0.0562s/iter; left time: 1074.5084s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.67s
Steps: 222 | Train Loss: 0.0985090 Vali Loss: 0.1234400 Test Loss: 0.1346146
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0985817
	speed: 0.0994s/iter; left time: 1888.7617s
	iters: 200, epoch: 15 | loss: 0.0989988
	speed: 0.0564s/iter; left time: 1065.8385s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.76s
Steps: 222 | Train Loss: 0.0979335 Vali Loss: 0.1231191 Test Loss: 0.1347603
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0990492
	speed: 0.0994s/iter; left time: 1866.4312s
	iters: 200, epoch: 16 | loss: 0.0982786
	speed: 0.0566s/iter; left time: 1057.3441s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.78s
Steps: 222 | Train Loss: 0.0974306 Vali Loss: 0.1235838 Test Loss: 0.1353326
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0952108
	speed: 0.0994s/iter; left time: 1844.3263s
	iters: 200, epoch: 17 | loss: 0.0949799
	speed: 0.0562s/iter; left time: 1037.2817s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.69s
Steps: 222 | Train Loss: 0.0968703 Vali Loss: 0.1237597 Test Loss: 0.1353569
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03871931508183479, rmse:0.1967722475528717, mae:0.1333899199962616, rse:0.6969830989837646
Intermediate time for DE and pred_len 168: 00h:09m:17.71s
Intermediate time for DE: 00h:48m:30.61s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1190656
	speed: 0.0736s/iter; left time: 1634.9689s
	iters: 200, epoch: 1 | loss: 0.1161422
	speed: 0.0558s/iter; left time: 1233.7460s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.91s
Steps: 223 | Train Loss: 0.1253484 Vali Loss: 0.1194087 Test Loss: 0.1384515
Validation loss decreased (inf --> 0.119409).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0870098
	speed: 0.0978s/iter; left time: 2148.4085s
	iters: 200, epoch: 2 | loss: 0.0820863
	speed: 0.0558s/iter; left time: 1220.0881s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0858498 Vali Loss: 0.0922656 Test Loss: 0.1037217
Validation loss decreased (0.119409 --> 0.092266).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0805822
	speed: 0.0972s/iter; left time: 2115.0916s
	iters: 200, epoch: 3 | loss: 0.0783289
	speed: 0.0558s/iter; left time: 1207.7735s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0789233 Vali Loss: 0.0894624 Test Loss: 0.1028290
Validation loss decreased (0.092266 --> 0.089462).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0815623
	speed: 0.0970s/iter; left time: 2089.5757s
	iters: 200, epoch: 4 | loss: 0.0827173
	speed: 0.0558s/iter; left time: 1196.4097s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0773275 Vali Loss: 0.0896265 Test Loss: 0.1026914
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0726509
	speed: 0.0965s/iter; left time: 2056.0343s
	iters: 200, epoch: 5 | loss: 0.0737885
	speed: 0.0557s/iter; left time: 1182.1783s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0762504 Vali Loss: 0.0890852 Test Loss: 0.1016043
Validation loss decreased (0.089462 --> 0.089085).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0734069
	speed: 0.0971s/iter; left time: 2046.4637s
	iters: 200, epoch: 6 | loss: 0.0775540
	speed: 0.0558s/iter; left time: 1170.8743s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0755329 Vali Loss: 0.0884747 Test Loss: 0.1004770
Validation loss decreased (0.089085 --> 0.088475).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0754288
	speed: 0.0979s/iter; left time: 2043.1717s
	iters: 200, epoch: 7 | loss: 0.0744961
	speed: 0.0558s/iter; left time: 1157.9899s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0749985 Vali Loss: 0.0885333 Test Loss: 0.1013064
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0774653
	speed: 0.0970s/iter; left time: 2001.8117s
	iters: 200, epoch: 8 | loss: 0.0739258
	speed: 0.0557s/iter; left time: 1144.0606s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0745286 Vali Loss: 0.0878436 Test Loss: 0.1005928
Validation loss decreased (0.088475 --> 0.087844).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0736594
	speed: 0.0970s/iter; left time: 1980.6955s
	iters: 200, epoch: 9 | loss: 0.0707307
	speed: 0.0558s/iter; left time: 1133.0339s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0740644 Vali Loss: 0.0879482 Test Loss: 0.0996325
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0720190
	speed: 0.0973s/iter; left time: 1964.6439s
	iters: 200, epoch: 10 | loss: 0.0767412
	speed: 0.0558s/iter; left time: 1121.4060s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0736389 Vali Loss: 0.0878936 Test Loss: 0.1004490
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0787126
	speed: 0.0964s/iter; left time: 1925.3029s
	iters: 200, epoch: 11 | loss: 0.0735841
	speed: 0.0557s/iter; left time: 1107.2953s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0733615 Vali Loss: 0.0875434 Test Loss: 0.1004866
Validation loss decreased (0.087844 --> 0.087543).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0650659
	speed: 0.0968s/iter; left time: 1910.8100s
	iters: 200, epoch: 12 | loss: 0.0782444
	speed: 0.0556s/iter; left time: 1092.1723s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0731628 Vali Loss: 0.0876492 Test Loss: 0.0996653
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0720514
	speed: 0.0967s/iter; left time: 1887.9786s
	iters: 200, epoch: 13 | loss: 0.0745456
	speed: 0.0558s/iter; left time: 1084.3613s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0729101 Vali Loss: 0.0874964 Test Loss: 0.0996864
Validation loss decreased (0.087543 --> 0.087496).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0719180
	speed: 0.0982s/iter; left time: 1895.3045s
	iters: 200, epoch: 14 | loss: 0.0725956
	speed: 0.0558s/iter; left time: 1071.4137s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0727339 Vali Loss: 0.0876334 Test Loss: 0.0996331
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0718653
	speed: 0.0971s/iter; left time: 1852.5220s
	iters: 200, epoch: 15 | loss: 0.0711401
	speed: 0.0556s/iter; left time: 1054.7613s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0725731 Vali Loss: 0.0873525 Test Loss: 0.0995370
Validation loss decreased (0.087496 --> 0.087353).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0709502
	speed: 0.0977s/iter; left time: 1843.0721s
	iters: 200, epoch: 16 | loss: 0.0688956
	speed: 0.0556s/iter; left time: 1042.3863s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0724521 Vali Loss: 0.0873687 Test Loss: 0.0992573
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0763475
	speed: 0.0968s/iter; left time: 1803.3515s
	iters: 200, epoch: 17 | loss: 0.0740564
	speed: 0.0556s/iter; left time: 1031.0965s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0722744 Vali Loss: 0.0872078 Test Loss: 0.0993596
Validation loss decreased (0.087353 --> 0.087208).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0710246
	speed: 0.0976s/iter; left time: 1797.2363s
	iters: 200, epoch: 18 | loss: 0.0711855
	speed: 0.0558s/iter; left time: 1020.7825s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0721521 Vali Loss: 0.0872633 Test Loss: 0.0994425
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0733631
	speed: 0.0969s/iter; left time: 1761.6434s
	iters: 200, epoch: 19 | loss: 0.0770690
	speed: 0.0558s/iter; left time: 1008.8538s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0720333 Vali Loss: 0.0873004 Test Loss: 0.0993044
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0704630
	speed: 0.0972s/iter; left time: 1746.3209s
	iters: 200, epoch: 20 | loss: 0.0651565
	speed: 0.0558s/iter; left time: 996.5069s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.65s
Steps: 223 | Train Loss: 0.0719302 Vali Loss: 0.0872917 Test Loss: 0.0991583
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0689208
	speed: 0.0968s/iter; left time: 1717.5031s
	iters: 200, epoch: 21 | loss: 0.0757201
	speed: 0.0557s/iter; left time: 983.1619s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0718589 Vali Loss: 0.0872711 Test Loss: 0.0992796
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0733921
	speed: 0.0967s/iter; left time: 1694.3010s
	iters: 200, epoch: 22 | loss: 0.0708673
	speed: 0.0558s/iter; left time: 972.3428s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0717552 Vali Loss: 0.0871347 Test Loss: 0.0991715
Validation loss decreased (0.087208 --> 0.087135).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0760645
	speed: 0.0974s/iter; left time: 1684.4248s
	iters: 200, epoch: 23 | loss: 0.0667015
	speed: 0.0557s/iter; left time: 958.3182s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0717327 Vali Loss: 0.0870459 Test Loss: 0.0991245
Validation loss decreased (0.087135 --> 0.087046).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0735871
	speed: 0.0970s/iter; left time: 1655.6581s
	iters: 200, epoch: 24 | loss: 0.0728756
	speed: 0.0558s/iter; left time: 946.9060s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0716163 Vali Loss: 0.0871637 Test Loss: 0.0992907
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0732243
	speed: 0.0970s/iter; left time: 1633.7305s
	iters: 200, epoch: 25 | loss: 0.0709287
	speed: 0.0558s/iter; left time: 934.9185s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.64s
Steps: 223 | Train Loss: 0.0716102 Vali Loss: 0.0873323 Test Loss: 0.0991644
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0683563
	speed: 0.0967s/iter; left time: 1608.1505s
	iters: 200, epoch: 26 | loss: 0.0677319
	speed: 0.0558s/iter; left time: 921.3944s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0715926 Vali Loss: 0.0872675 Test Loss: 0.0991061
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0738787
	speed: 0.0969s/iter; left time: 1589.7199s
	iters: 200, epoch: 27 | loss: 0.0742473
	speed: 0.0558s/iter; left time: 910.0601s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:12.62s
Steps: 223 | Train Loss: 0.0714851 Vali Loss: 0.0870536 Test Loss: 0.0990238
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0666653
	speed: 0.1012s/iter; left time: 1637.0762s
	iters: 200, epoch: 28 | loss: 0.0767145
	speed: 0.0584s/iter; left time: 938.5994s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:14.00s
Steps: 223 | Train Loss: 0.0714313 Vali Loss: 0.0872936 Test Loss: 0.0991399
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0739312
	speed: 0.2538s/iter; left time: 4050.4375s
	iters: 200, epoch: 29 | loss: 0.0702690
	speed: 0.1388s/iter; left time: 2201.0813s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:31.52s
Steps: 223 | Train Loss: 0.0714035 Vali Loss: 0.0871968 Test Loss: 0.0991477
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0746630
	speed: 0.2824s/iter; left time: 4442.6480s
	iters: 200, epoch: 30 | loss: 0.0762597
	speed: 0.1269s/iter; left time: 1984.1953s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:28.20s
Steps: 223 | Train Loss: 0.0713885 Vali Loss: 0.0873346 Test Loss: 0.0991395
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0695903
	speed: 0.2994s/iter; left time: 4644.7499s
	iters: 200, epoch: 31 | loss: 0.0737659
	speed: 0.1662s/iter; left time: 2561.6537s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:31.84s
Steps: 223 | Train Loss: 0.0713434 Vali Loss: 0.0871035 Test Loss: 0.0991213
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0750624
	speed: 0.2879s/iter; left time: 4401.4034s
	iters: 200, epoch: 32 | loss: 0.0747816
	speed: 0.0944s/iter; left time: 1433.1875s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:24.59s
Steps: 223 | Train Loss: 0.0713147 Vali Loss: 0.0871615 Test Loss: 0.0991062
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0709687
	speed: 0.3957s/iter; left time: 5960.8588s
	iters: 200, epoch: 33 | loss: 0.0697152
	speed: 0.1926s/iter; left time: 2882.6352s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:45.51s
Steps: 223 | Train Loss: 0.0712944 Vali Loss: 0.0871505 Test Loss: 0.0990493
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.024570560082793236, rmse:0.15674999356269836, mae:0.09912451356649399, rse:0.5407430529594421
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1245341
	speed: 0.2228s/iter; left time: 4946.5063s
	iters: 200, epoch: 1 | loss: 0.1095097
	speed: 0.2037s/iter; left time: 4501.4440s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.94s
Steps: 223 | Train Loss: 0.1254445 Vali Loss: 0.1200309 Test Loss: 0.1391877
Validation loss decreased (inf --> 0.120031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0840376
	speed: 0.3435s/iter; left time: 7550.2616s
	iters: 200, epoch: 2 | loss: 0.0810726
	speed: 0.0788s/iter; left time: 1723.3569s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:19.44s
Steps: 223 | Train Loss: 0.0858071 Vali Loss: 0.0911559 Test Loss: 0.1027333
Validation loss decreased (0.120031 --> 0.091156).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0800171
	speed: 0.1037s/iter; left time: 2255.2973s
	iters: 200, epoch: 3 | loss: 0.0812158
	speed: 0.0565s/iter; left time: 1222.5530s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.88s
Steps: 223 | Train Loss: 0.0790698 Vali Loss: 0.0896118 Test Loss: 0.1031010
Validation loss decreased (0.091156 --> 0.089612).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818189
	speed: 0.1006s/iter; left time: 2165.9190s
	iters: 200, epoch: 4 | loss: 0.0696711
	speed: 0.0557s/iter; left time: 1193.7008s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.69s
Steps: 223 | Train Loss: 0.0774647 Vali Loss: 0.0894184 Test Loss: 0.1019324
Validation loss decreased (0.089612 --> 0.089418).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0843827
	speed: 0.0983s/iter; left time: 2094.6637s
	iters: 200, epoch: 5 | loss: 0.0805781
	speed: 0.0557s/iter; left time: 1180.4183s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.61s
Steps: 223 | Train Loss: 0.0764215 Vali Loss: 0.0892403 Test Loss: 0.1013356
Validation loss decreased (0.089418 --> 0.089240).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0738009
	speed: 0.0976s/iter; left time: 2057.9585s
	iters: 200, epoch: 6 | loss: 0.0750279
	speed: 0.0555s/iter; left time: 1165.7407s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0756854 Vali Loss: 0.0886191 Test Loss: 0.1014508
Validation loss decreased (0.089240 --> 0.088619).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0818800
	speed: 0.0975s/iter; left time: 2034.9174s
	iters: 200, epoch: 7 | loss: 0.0787578
	speed: 0.0556s/iter; left time: 1154.2961s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0751229 Vali Loss: 0.0883886 Test Loss: 0.1005039
Validation loss decreased (0.088619 --> 0.088389).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0751207
	speed: 0.0968s/iter; left time: 1998.4805s
	iters: 200, epoch: 8 | loss: 0.0725476
	speed: 0.0556s/iter; left time: 1141.1997s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0746188 Vali Loss: 0.0880025 Test Loss: 0.1003955
Validation loss decreased (0.088389 --> 0.088002).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0723632
	speed: 0.0971s/iter; left time: 1982.6216s
	iters: 200, epoch: 9 | loss: 0.0748586
	speed: 0.0556s/iter; left time: 1130.1861s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0741620 Vali Loss: 0.0884281 Test Loss: 0.1003440
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0684523
	speed: 0.0966s/iter; left time: 1950.1821s
	iters: 200, epoch: 10 | loss: 0.0759455
	speed: 0.0556s/iter; left time: 1117.2650s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0738323 Vali Loss: 0.0877718 Test Loss: 0.0998402
Validation loss decreased (0.088002 --> 0.087772).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0773028
	speed: 0.0974s/iter; left time: 1945.8627s
	iters: 200, epoch: 11 | loss: 0.0717021
	speed: 0.0557s/iter; left time: 1106.7068s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0735408 Vali Loss: 0.0878956 Test Loss: 0.0997441
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0727853
	speed: 0.0970s/iter; left time: 1914.7258s
	iters: 200, epoch: 12 | loss: 0.0768436
	speed: 0.0556s/iter; left time: 1092.6681s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0732213 Vali Loss: 0.0874504 Test Loss: 0.0993545
Validation loss decreased (0.087772 --> 0.087450).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0748568
	speed: 0.0980s/iter; left time: 1914.2375s
	iters: 200, epoch: 13 | loss: 0.0693408
	speed: 0.0556s/iter; left time: 1080.4664s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0729368 Vali Loss: 0.0872005 Test Loss: 0.0996057
Validation loss decreased (0.087450 --> 0.087201).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0723982
	speed: 0.0974s/iter; left time: 1880.8414s
	iters: 200, epoch: 14 | loss: 0.0762133
	speed: 0.0556s/iter; left time: 1067.5296s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0728184 Vali Loss: 0.0872517 Test Loss: 0.0992832
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0731171
	speed: 0.0971s/iter; left time: 1853.1380s
	iters: 200, epoch: 15 | loss: 0.0741022
	speed: 0.0555s/iter; left time: 1053.6092s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0726241 Vali Loss: 0.0870855 Test Loss: 0.0991462
Validation loss decreased (0.087201 --> 0.087085).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0750456
	speed: 0.0963s/iter; left time: 1816.6623s
	iters: 200, epoch: 16 | loss: 0.0713072
	speed: 0.0555s/iter; left time: 1040.9073s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0724411 Vali Loss: 0.0871672 Test Loss: 0.0994019
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0668869
	speed: 0.0966s/iter; left time: 1800.4650s
	iters: 200, epoch: 17 | loss: 0.0713389
	speed: 0.0555s/iter; left time: 1029.1182s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0723312 Vali Loss: 0.0871781 Test Loss: 0.0993513
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0706983
	speed: 0.0959s/iter; left time: 1766.2521s
	iters: 200, epoch: 18 | loss: 0.0748784
	speed: 0.0555s/iter; left time: 1016.2035s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0721220 Vali Loss: 0.0872997 Test Loss: 0.0990167
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0700274
	speed: 0.0962s/iter; left time: 1750.2997s
	iters: 200, epoch: 19 | loss: 0.0744739
	speed: 0.0554s/iter; left time: 1002.7139s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0720195 Vali Loss: 0.0869263 Test Loss: 0.0991538
Validation loss decreased (0.087085 --> 0.086926).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0791809
	speed: 0.0968s/iter; left time: 1739.6417s
	iters: 200, epoch: 20 | loss: 0.0694202
	speed: 0.0555s/iter; left time: 991.8110s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0719323 Vali Loss: 0.0870747 Test Loss: 0.0990399
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0741944
	speed: 0.0967s/iter; left time: 1715.2873s
	iters: 200, epoch: 21 | loss: 0.0745496
	speed: 0.0555s/iter; left time: 979.4937s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0719164 Vali Loss: 0.0870800 Test Loss: 0.0990365
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0724013
	speed: 0.0970s/iter; left time: 1699.3488s
	iters: 200, epoch: 22 | loss: 0.0665953
	speed: 0.0555s/iter; left time: 967.2978s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:12.58s
Steps: 223 | Train Loss: 0.0718348 Vali Loss: 0.0870564 Test Loss: 0.0989102
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0713616
	speed: 0.0960s/iter; left time: 1660.6828s
	iters: 200, epoch: 23 | loss: 0.0664531
	speed: 0.0555s/iter; left time: 954.7985s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0717544 Vali Loss: 0.0869851 Test Loss: 0.0988903
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0733751
	speed: 0.0972s/iter; left time: 1659.7551s
	iters: 200, epoch: 24 | loss: 0.0768953
	speed: 0.0555s/iter; left time: 942.4096s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0716118 Vali Loss: 0.0870040 Test Loss: 0.0988361
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0696853
	speed: 0.0961s/iter; left time: 1618.8960s
	iters: 200, epoch: 25 | loss: 0.0754574
	speed: 0.0556s/iter; left time: 930.4471s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0715513 Vali Loss: 0.0869943 Test Loss: 0.0989808
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0709983
	speed: 0.0962s/iter; left time: 1599.8028s
	iters: 200, epoch: 26 | loss: 0.0676465
	speed: 0.0555s/iter; left time: 917.5568s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0714881 Vali Loss: 0.0869537 Test Loss: 0.0987807
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0693488
	speed: 0.0959s/iter; left time: 1573.5555s
	iters: 200, epoch: 27 | loss: 0.0711039
	speed: 0.0555s/iter; left time: 904.1389s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:12.54s
Steps: 223 | Train Loss: 0.0713989 Vali Loss: 0.0868826 Test Loss: 0.0987545
Validation loss decreased (0.086926 --> 0.086883).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0756186
	speed: 0.0977s/iter; left time: 1580.8555s
	iters: 200, epoch: 28 | loss: 0.0743463
	speed: 0.0557s/iter; left time: 895.3048s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:12.63s
Steps: 223 | Train Loss: 0.0714247 Vali Loss: 0.0867862 Test Loss: 0.0988359
Validation loss decreased (0.086883 --> 0.086786).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0710060
	speed: 0.0968s/iter; left time: 1544.3542s
	iters: 200, epoch: 29 | loss: 0.0695662
	speed: 0.0556s/iter; left time: 882.0745s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0714264 Vali Loss: 0.0868562 Test Loss: 0.0987503
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0701287
	speed: 0.0963s/iter; left time: 1515.0535s
	iters: 200, epoch: 30 | loss: 0.0757296
	speed: 0.0555s/iter; left time: 867.4458s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0713372 Vali Loss: 0.0867431 Test Loss: 0.0987461
Validation loss decreased (0.086786 --> 0.086743).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0701553
	speed: 0.0968s/iter; left time: 1502.2116s
	iters: 200, epoch: 31 | loss: 0.0727991
	speed: 0.0557s/iter; left time: 858.2125s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:12.60s
Steps: 223 | Train Loss: 0.0712994 Vali Loss: 0.0868837 Test Loss: 0.0987813
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0733458
	speed: 0.0965s/iter; left time: 1474.7947s
	iters: 200, epoch: 32 | loss: 0.0694019
	speed: 0.0556s/iter; left time: 844.4662s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:12.59s
Steps: 223 | Train Loss: 0.0713098 Vali Loss: 0.0868881 Test Loss: 0.0988373
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0712834
	speed: 0.0961s/iter; left time: 1448.3921s
	iters: 200, epoch: 33 | loss: 0.0688486
	speed: 0.0555s/iter; left time: 830.7653s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0712188 Vali Loss: 0.0868297 Test Loss: 0.0987804
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0690468
	speed: 0.0959s/iter; left time: 1422.8061s
	iters: 200, epoch: 34 | loss: 0.0661724
	speed: 0.0555s/iter; left time: 818.4626s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:12.55s
Steps: 223 | Train Loss: 0.0712138 Vali Loss: 0.0868261 Test Loss: 0.0987904
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0734023
	speed: 0.0965s/iter; left time: 1410.8276s
	iters: 200, epoch: 35 | loss: 0.0691267
	speed: 0.0554s/iter; left time: 805.0715s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0711909 Vali Loss: 0.0868607 Test Loss: 0.0987801
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0676273
	speed: 0.0962s/iter; left time: 1384.2812s
	iters: 200, epoch: 36 | loss: 0.0762189
	speed: 0.0555s/iter; left time: 794.1158s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0712222 Vali Loss: 0.0868300 Test Loss: 0.0987861
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0705356
	speed: 0.0967s/iter; left time: 1370.1689s
	iters: 200, epoch: 37 | loss: 0.0708427
	speed: 0.0555s/iter; left time: 781.1515s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0711363 Vali Loss: 0.0867921 Test Loss: 0.0988260
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0765347
	speed: 0.0962s/iter; left time: 1341.3558s
	iters: 200, epoch: 38 | loss: 0.0721635
	speed: 0.0555s/iter; left time: 768.9875s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:12.56s
Steps: 223 | Train Loss: 0.0711380 Vali Loss: 0.0868325 Test Loss: 0.0988323
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0716699
	speed: 0.0969s/iter; left time: 1330.4072s
	iters: 200, epoch: 39 | loss: 0.0682490
	speed: 0.0556s/iter; left time: 757.6486s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:12.57s
Steps: 223 | Train Loss: 0.0710949 Vali Loss: 0.0868223 Test Loss: 0.0987682
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0706478
	speed: 0.0961s/iter; left time: 1298.0829s
	iters: 200, epoch: 40 | loss: 0.0696950
	speed: 0.0555s/iter; left time: 743.4521s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:12.53s
Steps: 223 | Train Loss: 0.0711050 Vali Loss: 0.0869668 Test Loss: 0.0987652
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02454490214586258, rmse:0.15666812658309937, mae:0.09874614328145981, rse:0.5404606461524963
Intermediate time for GB and pred_len 24: 00h:22m:41.57s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1306827
	speed: 0.0737s/iter; left time: 1627.9731s
	iters: 200, epoch: 1 | loss: 0.1177318
	speed: 0.0562s/iter; left time: 1236.2160s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.93s
Steps: 222 | Train Loss: 0.1310412 Vali Loss: 0.1288174 Test Loss: 0.1522436
Validation loss decreased (inf --> 0.128817).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1066177
	speed: 0.0998s/iter; left time: 2183.2131s
	iters: 200, epoch: 2 | loss: 0.1095714
	speed: 0.0562s/iter; left time: 1224.7523s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1078968 Vali Loss: 0.1167912 Test Loss: 0.1385723
Validation loss decreased (0.128817 --> 0.116791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1022676
	speed: 0.0989s/iter; left time: 2141.9155s
	iters: 200, epoch: 3 | loss: 0.1059308
	speed: 0.0562s/iter; left time: 1211.5213s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.1029695 Vali Loss: 0.1158236 Test Loss: 0.1393959
Validation loss decreased (0.116791 --> 0.115824).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0960328
	speed: 0.0999s/iter; left time: 2141.3581s
	iters: 200, epoch: 4 | loss: 0.1025381
	speed: 0.0560s/iter; left time: 1194.6158s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1014715 Vali Loss: 0.1154466 Test Loss: 0.1393613
Validation loss decreased (0.115824 --> 0.115447).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1026418
	speed: 0.0990s/iter; left time: 2099.4794s
	iters: 200, epoch: 5 | loss: 0.1024776
	speed: 0.0560s/iter; left time: 1181.6511s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.1004793 Vali Loss: 0.1146312 Test Loss: 0.1378396
Validation loss decreased (0.115447 --> 0.114631).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0979286
	speed: 0.0992s/iter; left time: 2081.7530s
	iters: 200, epoch: 6 | loss: 0.0994375
	speed: 0.0561s/iter; left time: 1172.4374s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.68s
Steps: 222 | Train Loss: 0.0995605 Vali Loss: 0.1148999 Test Loss: 0.1380830
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0970419
	speed: 0.0987s/iter; left time: 2049.6012s
	iters: 200, epoch: 7 | loss: 0.0962363
	speed: 0.0560s/iter; left time: 1157.6529s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0987005 Vali Loss: 0.1152062 Test Loss: 0.1379218
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0996104
	speed: 0.0982s/iter; left time: 2017.8896s
	iters: 200, epoch: 8 | loss: 0.0979448
	speed: 0.0559s/iter; left time: 1142.7453s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.58s
Steps: 222 | Train Loss: 0.0980342 Vali Loss: 0.1154223 Test Loss: 0.1376054
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0958485
	speed: 0.0991s/iter; left time: 2014.7033s
	iters: 200, epoch: 9 | loss: 0.0965145
	speed: 0.0615s/iter; left time: 1244.4988s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:16.21s
Steps: 222 | Train Loss: 0.0972717 Vali Loss: 0.1154799 Test Loss: 0.1370620
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0954895
	speed: 0.6275s/iter; left time: 12615.0912s
	iters: 200, epoch: 10 | loss: 0.0944765
	speed: 0.1997s/iter; left time: 3994.5402s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:44.62s
Steps: 222 | Train Loss: 0.0966941 Vali Loss: 0.1156659 Test Loss: 0.1384369
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0955338
	speed: 0.1835s/iter; left time: 3648.6977s
	iters: 200, epoch: 11 | loss: 0.0942479
	speed: 0.0563s/iter; left time: 1112.7131s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.83s
Steps: 222 | Train Loss: 0.0960870 Vali Loss: 0.1158695 Test Loss: 0.1388598
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0913796
	speed: 0.0982s/iter; left time: 1930.1414s
	iters: 200, epoch: 12 | loss: 0.0934490
	speed: 0.0567s/iter; left time: 1109.2816s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.0955488 Vali Loss: 0.1158540 Test Loss: 0.1386886
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0921230
	speed: 0.0977s/iter; left time: 1899.7747s
	iters: 200, epoch: 13 | loss: 0.0977281
	speed: 0.0560s/iter; left time: 1083.0740s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.61s
Steps: 222 | Train Loss: 0.0950370 Vali Loss: 0.1160690 Test Loss: 0.1403026
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0938734
	speed: 0.0981s/iter; left time: 1885.5387s
	iters: 200, epoch: 14 | loss: 0.0945882
	speed: 0.0561s/iter; left time: 1071.6347s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0945816 Vali Loss: 0.1165808 Test Loss: 0.1402343
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0991733
	speed: 0.0988s/iter; left time: 1877.2304s
	iters: 200, epoch: 15 | loss: 0.0967700
	speed: 0.0561s/iter; left time: 1059.8997s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.0940588 Vali Loss: 0.1163656 Test Loss: 0.1410571
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04015038162469864, rmse:0.20037560164928436, mae:0.13783958554267883, rse:0.6929267048835754
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1303071
	speed: 0.0615s/iter; left time: 1358.7608s
	iters: 200, epoch: 1 | loss: 0.1283034
	speed: 0.0562s/iter; left time: 1236.5509s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.05s
Steps: 222 | Train Loss: 0.1310060 Vali Loss: 0.1287630 Test Loss: 0.1517619
Validation loss decreased (inf --> 0.128763).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1048923
	speed: 0.0999s/iter; left time: 2185.0535s
	iters: 200, epoch: 2 | loss: 0.1013105
	speed: 0.0560s/iter; left time: 1220.0212s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.1080856 Vali Loss: 0.1171368 Test Loss: 0.1385304
Validation loss decreased (0.128763 --> 0.117137).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1040064
	speed: 0.0983s/iter; left time: 2128.0664s
	iters: 200, epoch: 3 | loss: 0.0998071
	speed: 0.0560s/iter; left time: 1208.1917s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.84s
Steps: 222 | Train Loss: 0.1030684 Vali Loss: 0.1154471 Test Loss: 0.1375951
Validation loss decreased (0.117137 --> 0.115447).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1053156
	speed: 0.3820s/iter; left time: 8187.8691s
	iters: 200, epoch: 4 | loss: 0.1008415
	speed: 0.0589s/iter; left time: 1257.0076s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:23.97s
Steps: 222 | Train Loss: 0.1016380 Vali Loss: 0.1151421 Test Loss: 0.1379311
Validation loss decreased (0.115447 --> 0.115142).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0987126
	speed: 0.0994s/iter; left time: 2107.6234s
	iters: 200, epoch: 5 | loss: 0.0972618
	speed: 0.0691s/iter; left time: 1458.8311s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:16.43s
Steps: 222 | Train Loss: 0.1004928 Vali Loss: 0.1147536 Test Loss: 0.1380800
Validation loss decreased (0.115142 --> 0.114754).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1012318
	speed: 0.6444s/iter; left time: 13526.0305s
	iters: 200, epoch: 6 | loss: 0.0969684
	speed: 0.1934s/iter; left time: 4040.7021s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.55s
Steps: 222 | Train Loss: 0.0993943 Vali Loss: 0.1148224 Test Loss: 0.1386869
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0970156
	speed: 0.1453s/iter; left time: 3018.6714s
	iters: 200, epoch: 7 | loss: 0.0988887
	speed: 0.0560s/iter; left time: 1158.4328s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.82s
Steps: 222 | Train Loss: 0.0985187 Vali Loss: 0.1149543 Test Loss: 0.1399635
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0929216
	speed: 0.0985s/iter; left time: 2023.5995s
	iters: 200, epoch: 8 | loss: 0.0935230
	speed: 0.0568s/iter; left time: 1162.4110s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.76s
Steps: 222 | Train Loss: 0.0974779 Vali Loss: 0.1147359 Test Loss: 0.1398059
Validation loss decreased (0.114754 --> 0.114736).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0948713
	speed: 0.1010s/iter; left time: 2053.3036s
	iters: 200, epoch: 9 | loss: 0.0958109
	speed: 0.0566s/iter; left time: 1144.7942s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.80s
Steps: 222 | Train Loss: 0.0966486 Vali Loss: 0.1154781 Test Loss: 0.1414918
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0992346
	speed: 0.0998s/iter; left time: 2005.2822s
	iters: 200, epoch: 10 | loss: 0.0941390
	speed: 0.0561s/iter; left time: 1121.2855s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.0958207 Vali Loss: 0.1155172 Test Loss: 0.1409567
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0913739
	speed: 0.0985s/iter; left time: 1958.4105s
	iters: 200, epoch: 11 | loss: 0.0964964
	speed: 0.0562s/iter; left time: 1110.7194s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0951955 Vali Loss: 0.1160658 Test Loss: 0.1419416
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0966781
	speed: 0.0999s/iter; left time: 1963.4582s
	iters: 200, epoch: 12 | loss: 0.0935920
	speed: 0.0560s/iter; left time: 1095.2430s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.72s
Steps: 222 | Train Loss: 0.0943973 Vali Loss: 0.1160687 Test Loss: 0.1421239
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0959323
	speed: 0.0984s/iter; left time: 1912.5597s
	iters: 200, epoch: 13 | loss: 0.0973188
	speed: 0.0562s/iter; left time: 1086.1156s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.69s
Steps: 222 | Train Loss: 0.0938334 Vali Loss: 0.1156196 Test Loss: 0.1408184
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0913993
	speed: 0.1000s/iter; left time: 1921.0940s
	iters: 200, epoch: 14 | loss: 0.0937971
	speed: 0.0560s/iter; left time: 1070.9051s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:13.05s
Steps: 222 | Train Loss: 0.0932455 Vali Loss: 0.1158227 Test Loss: 0.1420476
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0968988
	speed: 0.3754s/iter; left time: 7129.8569s
	iters: 200, epoch: 15 | loss: 0.0916217
	speed: 0.0633s/iter; left time: 1195.5744s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.16s
Steps: 222 | Train Loss: 0.0927197 Vali Loss: 0.1161066 Test Loss: 0.1418097
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0897948
	speed: 0.1000s/iter; left time: 1876.2781s
	iters: 200, epoch: 16 | loss: 0.0920113
	speed: 0.0822s/iter; left time: 1534.9956s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:19.04s
Steps: 222 | Train Loss: 0.0922969 Vali Loss: 0.1167289 Test Loss: 0.1427078
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0914260
	speed: 0.6881s/iter; left time: 12762.8375s
	iters: 200, epoch: 17 | loss: 0.0921046
	speed: 0.1896s/iter; left time: 3498.6136s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:44.62s
Steps: 222 | Train Loss: 0.0918778 Vali Loss: 0.1167830 Test Loss: 0.1428674
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0878626
	speed: 0.5708s/iter; left time: 10461.8958s
	iters: 200, epoch: 18 | loss: 0.0943621
	speed: 0.0735s/iter; left time: 1339.0674s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:23.58s
Steps: 222 | Train Loss: 0.0915997 Vali Loss: 0.1168165 Test Loss: 0.1414241
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041960179805755615, rmse:0.20484183728694916, mae:0.1398058831691742, rse:0.708371639251709
Intermediate time for GB and pred_len 96: 00h:14m:16.93s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1260773
	speed: 0.0773s/iter; left time: 1709.3037s
	iters: 200, epoch: 1 | loss: 0.1229722
	speed: 0.0571s/iter; left time: 1255.4312s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.22s
Steps: 222 | Train Loss: 0.1327026 Vali Loss: 0.1309201 Test Loss: 0.1548616
Validation loss decreased (inf --> 0.130920).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1093555
	speed: 0.1009s/iter; left time: 2206.9556s
	iters: 200, epoch: 2 | loss: 0.1087653
	speed: 0.0565s/iter; left time: 1230.2010s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.77s
Steps: 222 | Train Loss: 0.1121223 Vali Loss: 0.1213975 Test Loss: 0.1448217
Validation loss decreased (0.130920 --> 0.121397).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1089418
	speed: 0.1006s/iter; left time: 2179.0419s
	iters: 200, epoch: 3 | loss: 0.1108851
	speed: 0.0563s/iter; left time: 1214.4761s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1075883 Vali Loss: 0.1200373 Test Loss: 0.1443896
Validation loss decreased (0.121397 --> 0.120037).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1100808
	speed: 0.0998s/iter; left time: 2139.3352s
	iters: 200, epoch: 4 | loss: 0.1029688
	speed: 0.0567s/iter; left time: 1208.8238s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.74s
Steps: 222 | Train Loss: 0.1060422 Vali Loss: 0.1198486 Test Loss: 0.1441484
Validation loss decreased (0.120037 --> 0.119849).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1044006
	speed: 0.0993s/iter; left time: 2105.7861s
	iters: 200, epoch: 5 | loss: 0.1066292
	speed: 0.0564s/iter; left time: 1190.6719s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.70s
Steps: 222 | Train Loss: 0.1046534 Vali Loss: 0.1206437 Test Loss: 0.1449600
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0995353
	speed: 0.0979s/iter; left time: 2054.9923s
	iters: 200, epoch: 6 | loss: 0.1040475
	speed: 0.0563s/iter; left time: 1176.3104s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1034120 Vali Loss: 0.1211787 Test Loss: 0.1452242
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1019453
	speed: 0.0970s/iter; left time: 2014.0747s
	iters: 200, epoch: 7 | loss: 0.1026548
	speed: 0.0563s/iter; left time: 1162.6447s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.63s
Steps: 222 | Train Loss: 0.1023776 Vali Loss: 0.1218576 Test Loss: 0.1468516
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0994126
	speed: 0.0974s/iter; left time: 2000.8456s
	iters: 200, epoch: 8 | loss: 0.0971872
	speed: 0.0562s/iter; left time: 1148.9516s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.1013684 Vali Loss: 0.1218202 Test Loss: 0.1467308
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1008324
	speed: 0.0978s/iter; left time: 1987.1658s
	iters: 200, epoch: 9 | loss: 0.1001003
	speed: 0.0561s/iter; left time: 1135.5802s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.1004547 Vali Loss: 0.1227126 Test Loss: 0.1460044
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0981952
	speed: 0.0970s/iter; left time: 1950.1614s
	iters: 200, epoch: 10 | loss: 0.1011151
	speed: 0.0562s/iter; left time: 1124.2371s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.0996076 Vali Loss: 0.1219485 Test Loss: 0.1458998
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1022985
	speed: 0.0968s/iter; left time: 1924.1642s
	iters: 200, epoch: 11 | loss: 0.0971800
	speed: 0.0562s/iter; left time: 1112.3330s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.63s
Steps: 222 | Train Loss: 0.0987144 Vali Loss: 0.1226570 Test Loss: 0.1463754
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1019033
	speed: 0.0973s/iter; left time: 1912.4186s
	iters: 200, epoch: 12 | loss: 0.0964095
	speed: 0.0562s/iter; left time: 1100.0027s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.0978685 Vali Loss: 0.1225567 Test Loss: 0.1457474
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0953344
	speed: 0.0966s/iter; left time: 1878.4410s
	iters: 200, epoch: 13 | loss: 0.0992721
	speed: 0.0562s/iter; left time: 1087.0679s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.0971082 Vali Loss: 0.1227023 Test Loss: 0.1472565
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0926120
	speed: 0.0967s/iter; left time: 1858.5787s
	iters: 200, epoch: 14 | loss: 0.0951313
	speed: 0.0562s/iter; left time: 1074.8672s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.62s
Steps: 222 | Train Loss: 0.0964137 Vali Loss: 0.1233526 Test Loss: 0.1470043
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.042849574238061905, rmse:0.20700138807296753, mae:0.14414843916893005, rse:0.7177035808563232
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1354991
	speed: 0.0578s/iter; left time: 1278.1000s
	iters: 200, epoch: 1 | loss: 0.1270298
	speed: 0.0562s/iter; left time: 1235.9068s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.67s
Steps: 222 | Train Loss: 0.1335611 Vali Loss: 0.1309445 Test Loss: 0.1545844
Validation loss decreased (inf --> 0.130944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1133388
	speed: 0.0999s/iter; left time: 2186.3013s
	iters: 200, epoch: 2 | loss: 0.1125569
	speed: 0.0562s/iter; left time: 1224.1564s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.1122486 Vali Loss: 0.1214251 Test Loss: 0.1446685
Validation loss decreased (0.130944 --> 0.121425).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1068718
	speed: 0.0986s/iter; left time: 2135.8821s
	iters: 200, epoch: 3 | loss: 0.1110569
	speed: 0.0562s/iter; left time: 1211.9162s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.1077239 Vali Loss: 0.1201799 Test Loss: 0.1456124
Validation loss decreased (0.121425 --> 0.120180).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1068212
	speed: 0.0992s/iter; left time: 2126.1356s
	iters: 200, epoch: 4 | loss: 0.1060848
	speed: 0.0562s/iter; left time: 1199.0556s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.67s
Steps: 222 | Train Loss: 0.1062277 Vali Loss: 0.1203073 Test Loss: 0.1457645
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1072107
	speed: 0.0976s/iter; left time: 2071.3545s
	iters: 200, epoch: 5 | loss: 0.1050748
	speed: 0.0562s/iter; left time: 1187.0943s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1048063 Vali Loss: 0.1204287 Test Loss: 0.1452082
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1055551
	speed: 0.0977s/iter; left time: 2050.0902s
	iters: 200, epoch: 6 | loss: 0.1049092
	speed: 0.0562s/iter; left time: 1174.0853s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.1034492 Vali Loss: 0.1209216 Test Loss: 0.1464381
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1012986
	speed: 0.0978s/iter; left time: 2031.0061s
	iters: 200, epoch: 7 | loss: 0.0988212
	speed: 0.0562s/iter; left time: 1161.6740s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.1020838 Vali Loss: 0.1218336 Test Loss: 0.1478448
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1025517
	speed: 0.0974s/iter; left time: 2001.2240s
	iters: 200, epoch: 8 | loss: 0.1005487
	speed: 0.0562s/iter; left time: 1148.8461s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.64s
Steps: 222 | Train Loss: 0.1008029 Vali Loss: 0.1223594 Test Loss: 0.1472702
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0975043
	speed: 0.0974s/iter; left time: 1979.6024s
	iters: 200, epoch: 9 | loss: 0.0961284
	speed: 0.0562s/iter; left time: 1137.3700s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.0996357 Vali Loss: 0.1229091 Test Loss: 0.1470626
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0974637
	speed: 0.0974s/iter; left time: 1957.4357s
	iters: 200, epoch: 10 | loss: 0.0978937
	speed: 0.0562s/iter; left time: 1124.2371s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.0983070 Vali Loss: 0.1235878 Test Loss: 0.1470104
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0942716
	speed: 0.0973s/iter; left time: 1935.1333s
	iters: 200, epoch: 11 | loss: 0.0986272
	speed: 0.0562s/iter; left time: 1112.6325s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.0972591 Vali Loss: 0.1241986 Test Loss: 0.1483821
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0955178
	speed: 0.0972s/iter; left time: 1911.0378s
	iters: 200, epoch: 12 | loss: 0.1003032
	speed: 0.0562s/iter; left time: 1100.1288s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.65s
Steps: 222 | Train Loss: 0.0963243 Vali Loss: 0.1242227 Test Loss: 0.1486393
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0958638
	speed: 0.0974s/iter; left time: 1894.0650s
	iters: 200, epoch: 13 | loss: 0.0918685
	speed: 0.0563s/iter; left time: 1087.8440s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.66s
Steps: 222 | Train Loss: 0.0954410 Vali Loss: 0.1246279 Test Loss: 0.1481834
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04403311014175415, rmse:0.20984068512916565, mae:0.145612433552742, rse:0.7275477647781372
Intermediate time for GB and pred_len 168: 00h:07m:10.11s
Intermediate time for GB: 00h:44m:08.61s

=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_512_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1175637
	speed: 0.0539s/iter; left time: 1197.6987s
	iters: 200, epoch: 1 | loss: 0.1060088
	speed: 0.0349s/iter; left time: 770.7338s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.22s
Steps: 223 | Train Loss: 0.1258741 Vali Loss: 0.0934121 Test Loss: 0.1067465
Validation loss decreased (inf --> 0.093412).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0715940
	speed: 0.0640s/iter; left time: 1405.7288s
	iters: 200, epoch: 2 | loss: 0.0685092
	speed: 0.0349s/iter; left time: 762.8681s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0747378 Vali Loss: 0.0624876 Test Loss: 0.0695573
Validation loss decreased (0.093412 --> 0.062488).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0635684
	speed: 0.0649s/iter; left time: 1412.1529s
	iters: 200, epoch: 3 | loss: 0.0621238
	speed: 0.0349s/iter; left time: 754.8788s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0643560 Vali Loss: 0.0598924 Test Loss: 0.0667066
Validation loss decreased (0.062488 --> 0.059892).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0643697
	speed: 0.0639s/iter; left time: 1376.3862s
	iters: 200, epoch: 4 | loss: 0.0598484
	speed: 0.0349s/iter; left time: 747.2498s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0616906 Vali Loss: 0.0581373 Test Loss: 0.0651106
Validation loss decreased (0.059892 --> 0.058137).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0595916
	speed: 0.0639s/iter; left time: 1361.1248s
	iters: 200, epoch: 5 | loss: 0.0612903
	speed: 0.0349s/iter; left time: 740.3808s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0598992 Vali Loss: 0.0570621 Test Loss: 0.0634679
Validation loss decreased (0.058137 --> 0.057062).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0566540
	speed: 0.0640s/iter; left time: 1350.0472s
	iters: 200, epoch: 6 | loss: 0.0576317
	speed: 0.0348s/iter; left time: 730.5448s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0587601 Vali Loss: 0.0561196 Test Loss: 0.0627356
Validation loss decreased (0.057062 --> 0.056120).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0537630
	speed: 0.0642s/iter; left time: 1338.9650s
	iters: 200, epoch: 7 | loss: 0.0569170
	speed: 0.0348s/iter; left time: 722.6297s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0579201 Vali Loss: 0.0557699 Test Loss: 0.0623582
Validation loss decreased (0.056120 --> 0.055770).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0542791
	speed: 0.0642s/iter; left time: 1325.0179s
	iters: 200, epoch: 8 | loss: 0.0535772
	speed: 0.0348s/iter; left time: 715.4395s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0571417 Vali Loss: 0.0554661 Test Loss: 0.0623493
Validation loss decreased (0.055770 --> 0.055466).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0552964
	speed: 0.0636s/iter; left time: 1297.8393s
	iters: 200, epoch: 9 | loss: 0.0563664
	speed: 0.0348s/iter; left time: 707.5805s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0565837 Vali Loss: 0.0556016 Test Loss: 0.0629203
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0570711
	speed: 0.0634s/iter; left time: 1280.1725s
	iters: 200, epoch: 10 | loss: 0.0551535
	speed: 0.0348s/iter; left time: 699.6796s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0560324 Vali Loss: 0.0548921 Test Loss: 0.0620095
Validation loss decreased (0.055466 --> 0.054892).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0551980
	speed: 0.0639s/iter; left time: 1276.4136s
	iters: 200, epoch: 11 | loss: 0.0572951
	speed: 0.0348s/iter; left time: 692.4571s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0556399 Vali Loss: 0.0546968 Test Loss: 0.0617010
Validation loss decreased (0.054892 --> 0.054697).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0568327
	speed: 0.0644s/iter; left time: 1270.9269s
	iters: 200, epoch: 12 | loss: 0.0558428
	speed: 0.0349s/iter; left time: 685.0346s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0552164 Vali Loss: 0.0544590 Test Loss: 0.0614751
Validation loss decreased (0.054697 --> 0.054459).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0542535
	speed: 0.0641s/iter; left time: 1251.9684s
	iters: 200, epoch: 13 | loss: 0.0545616
	speed: 0.0348s/iter; left time: 676.6490s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0549488 Vali Loss: 0.0545881 Test Loss: 0.0614434
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0523805
	speed: 0.0629s/iter; left time: 1213.4130s
	iters: 200, epoch: 14 | loss: 0.0542101
	speed: 0.0349s/iter; left time: 669.5907s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0546171 Vali Loss: 0.0541874 Test Loss: 0.0611198
Validation loss decreased (0.054459 --> 0.054187).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0497755
	speed: 0.0640s/iter; left time: 1220.7282s
	iters: 200, epoch: 15 | loss: 0.0600670
	speed: 0.0349s/iter; left time: 662.4437s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0543438 Vali Loss: 0.0538917 Test Loss: 0.0610247
Validation loss decreased (0.054187 --> 0.053892).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0559755
	speed: 0.0640s/iter; left time: 1206.6236s
	iters: 200, epoch: 16 | loss: 0.0507899
	speed: 0.0348s/iter; left time: 653.3455s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0541344 Vali Loss: 0.0536988 Test Loss: 0.0605547
Validation loss decreased (0.053892 --> 0.053699).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0569965
	speed: 0.0658s/iter; left time: 1226.5335s
	iters: 200, epoch: 17 | loss: 0.0506428
	speed: 0.0348s/iter; left time: 644.0921s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0539298 Vali Loss: 0.0534636 Test Loss: 0.0604280
Validation loss decreased (0.053699 --> 0.053464).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0565841
	speed: 0.0639s/iter; left time: 1176.2585s
	iters: 200, epoch: 18 | loss: 0.0540568
	speed: 0.0348s/iter; left time: 636.8385s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0537874 Vali Loss: 0.0535432 Test Loss: 0.0605775
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0548989
	speed: 0.0634s/iter; left time: 1153.7619s
	iters: 200, epoch: 19 | loss: 0.0527071
	speed: 0.0347s/iter; left time: 628.4186s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0535218 Vali Loss: 0.0535281 Test Loss: 0.0603313
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0550305
	speed: 0.0634s/iter; left time: 1138.6081s
	iters: 200, epoch: 20 | loss: 0.0543642
	speed: 0.0347s/iter; left time: 620.3167s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0534504 Vali Loss: 0.0532689 Test Loss: 0.0604245
Validation loss decreased (0.053464 --> 0.053269).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0523972
	speed: 0.0642s/iter; left time: 1139.5554s
	iters: 200, epoch: 21 | loss: 0.0529216
	speed: 0.0348s/iter; left time: 614.1849s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0532740 Vali Loss: 0.0531319 Test Loss: 0.0601385
Validation loss decreased (0.053269 --> 0.053132).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0521433
	speed: 0.0634s/iter; left time: 1110.0221s
	iters: 200, epoch: 22 | loss: 0.0547027
	speed: 0.0348s/iter; left time: 605.8963s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0532038 Vali Loss: 0.0531704 Test Loss: 0.0603939
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0536981
	speed: 0.0627s/iter; left time: 1084.6706s
	iters: 200, epoch: 23 | loss: 0.0563880
	speed: 0.0348s/iter; left time: 598.6580s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0531312 Vali Loss: 0.0531458 Test Loss: 0.0602351
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0546271
	speed: 0.0633s/iter; left time: 1080.1650s
	iters: 200, epoch: 24 | loss: 0.0504135
	speed: 0.0348s/iter; left time: 590.3791s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0529921 Vali Loss: 0.0530581 Test Loss: 0.0600498
Validation loss decreased (0.053132 --> 0.053058).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0553383
	speed: 0.0641s/iter; left time: 1080.2681s
	iters: 200, epoch: 25 | loss: 0.0518673
	speed: 0.0348s/iter; left time: 582.3145s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0528590 Vali Loss: 0.0530624 Test Loss: 0.0601539
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0514446
	speed: 0.0636s/iter; left time: 1057.3343s
	iters: 200, epoch: 26 | loss: 0.0503461
	speed: 0.0348s/iter; left time: 574.6602s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0528106 Vali Loss: 0.0528923 Test Loss: 0.0600861
Validation loss decreased (0.053058 --> 0.052892).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0517057
	speed: 0.0634s/iter; left time: 1039.4872s
	iters: 200, epoch: 27 | loss: 0.0537945
	speed: 0.0348s/iter; left time: 566.8902s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0528068 Vali Loss: 0.0531387 Test Loss: 0.0601630
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0525555
	speed: 0.0632s/iter; left time: 1022.5375s
	iters: 200, epoch: 28 | loss: 0.0549811
	speed: 0.0348s/iter; left time: 559.5760s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0526904 Vali Loss: 0.0528783 Test Loss: 0.0598450
Validation loss decreased (0.052892 --> 0.052878).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0500230
	speed: 0.0638s/iter; left time: 1018.3266s
	iters: 200, epoch: 29 | loss: 0.0551892
	speed: 0.0348s/iter; left time: 552.4548s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0526697 Vali Loss: 0.0527954 Test Loss: 0.0598333
Validation loss decreased (0.052878 --> 0.052795).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0544261
	speed: 0.0637s/iter; left time: 1001.4913s
	iters: 200, epoch: 30 | loss: 0.0517382
	speed: 0.0348s/iter; left time: 543.4853s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0526079 Vali Loss: 0.0527942 Test Loss: 0.0599940
Validation loss decreased (0.052795 --> 0.052794).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0509290
	speed: 0.0648s/iter; left time: 1005.2482s
	iters: 200, epoch: 31 | loss: 0.0522115
	speed: 0.0347s/iter; left time: 535.2823s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0525354 Vali Loss: 0.0528468 Test Loss: 0.0600238
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0518514
	speed: 0.0632s/iter; left time: 966.6202s
	iters: 200, epoch: 32 | loss: 0.0561669
	speed: 0.0348s/iter; left time: 528.1828s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0525267 Vali Loss: 0.0528122 Test Loss: 0.0600026
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0549385
	speed: 0.0635s/iter; left time: 956.5434s
	iters: 200, epoch: 33 | loss: 0.0550187
	speed: 0.0347s/iter; left time: 519.9973s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0524861 Vali Loss: 0.0527625 Test Loss: 0.0598903
Validation loss decreased (0.052794 --> 0.052763).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0545956
	speed: 0.0640s/iter; left time: 950.3746s
	iters: 200, epoch: 34 | loss: 0.0507859
	speed: 0.0347s/iter; left time: 512.1322s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0524479 Vali Loss: 0.0527562 Test Loss: 0.0599022
Validation loss decreased (0.052763 --> 0.052756).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0541387
	speed: 0.0636s/iter; left time: 929.6086s
	iters: 200, epoch: 35 | loss: 0.0549738
	speed: 0.0348s/iter; left time: 505.4555s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0524044 Vali Loss: 0.0526615 Test Loss: 0.0598362
Validation loss decreased (0.052756 --> 0.052662).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0545615
	speed: 0.0638s/iter; left time: 917.7742s
	iters: 200, epoch: 36 | loss: 0.0542032
	speed: 0.0348s/iter; left time: 497.1925s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0523493 Vali Loss: 0.0526948 Test Loss: 0.0597999
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0499858
	speed: 0.0633s/iter; left time: 897.6538s
	iters: 200, epoch: 37 | loss: 0.0523338
	speed: 0.0348s/iter; left time: 489.2833s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0523323 Vali Loss: 0.0526763 Test Loss: 0.0599144
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0525568
	speed: 0.0631s/iter; left time: 879.5964s
	iters: 200, epoch: 38 | loss: 0.0531557
	speed: 0.0348s/iter; left time: 481.9311s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0523191 Vali Loss: 0.0528053 Test Loss: 0.0598900
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0517309
	speed: 0.0632s/iter; left time: 867.8943s
	iters: 200, epoch: 39 | loss: 0.0516564
	speed: 0.0348s/iter; left time: 474.0992s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0522917 Vali Loss: 0.0527077 Test Loss: 0.0598312
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0536129
	speed: 0.0633s/iter; left time: 855.3285s
	iters: 200, epoch: 40 | loss: 0.0507274
	speed: 0.0347s/iter; left time: 465.4097s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0523048 Vali Loss: 0.0527075 Test Loss: 0.0598177
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0530339
	speed: 0.0636s/iter; left time: 844.5963s
	iters: 200, epoch: 41 | loss: 0.0536149
	speed: 0.0347s/iter; left time: 457.7128s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0523129 Vali Loss: 0.0526658 Test Loss: 0.0599047
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0494002
	speed: 0.0631s/iter; left time: 824.4909s
	iters: 200, epoch: 42 | loss: 0.0515069
	speed: 0.0347s/iter; left time: 449.7631s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0522722 Vali Loss: 0.0526509 Test Loss: 0.0598522
Validation loss decreased (0.052662 --> 0.052651).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0539627
	speed: 0.0652s/iter; left time: 837.1283s
	iters: 200, epoch: 43 | loss: 0.0533281
	speed: 0.0348s/iter; left time: 442.5861s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0523110 Vali Loss: 0.0525890 Test Loss: 0.0597770
Validation loss decreased (0.052651 --> 0.052589).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0521373
	speed: 0.0636s/iter; left time: 802.5087s
	iters: 200, epoch: 44 | loss: 0.0501604
	speed: 0.0348s/iter; left time: 435.2877s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522199 Vali Loss: 0.0526631 Test Loss: 0.0598244
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0566270
	speed: 0.0637s/iter; left time: 789.3379s
	iters: 200, epoch: 45 | loss: 0.0523463
	speed: 0.0348s/iter; left time: 427.1123s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522631 Vali Loss: 0.0527159 Test Loss: 0.0598033
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0528714
	speed: 0.0631s/iter; left time: 767.5373s
	iters: 200, epoch: 46 | loss: 0.0532004
	speed: 0.0348s/iter; left time: 419.3684s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522354 Vali Loss: 0.0526221 Test Loss: 0.0598067
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0528335
	speed: 0.0632s/iter; left time: 755.1653s
	iters: 200, epoch: 47 | loss: 0.0564661
	speed: 0.0347s/iter; left time: 411.5256s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0523151 Vali Loss: 0.0526697 Test Loss: 0.0597932
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0519690
	speed: 0.0634s/iter; left time: 743.0612s
	iters: 200, epoch: 48 | loss: 0.0549003
	speed: 0.0348s/iter; left time: 404.2951s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522235 Vali Loss: 0.0526347 Test Loss: 0.0597990
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0543164
	speed: 0.0631s/iter; left time: 725.7057s
	iters: 200, epoch: 49 | loss: 0.0473209
	speed: 0.0347s/iter; left time: 395.9021s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522493 Vali Loss: 0.0526192 Test Loss: 0.0598093
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0499371
	speed: 0.0632s/iter; left time: 712.6842s
	iters: 200, epoch: 50 | loss: 0.0519783
	speed: 0.0348s/iter; left time: 388.8344s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0522329 Vali Loss: 0.0526891 Test Loss: 0.0598834
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0568660
	speed: 0.0631s/iter; left time: 696.8242s
	iters: 200, epoch: 51 | loss: 0.0513868
	speed: 0.0347s/iter; left time: 380.4279s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0522060 Vali Loss: 0.0526809 Test Loss: 0.0598164
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0506357
	speed: 0.0632s/iter; left time: 684.8435s
	iters: 200, epoch: 52 | loss: 0.0513345
	speed: 0.0348s/iter; left time: 373.1569s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0521876 Vali Loss: 0.0526349 Test Loss: 0.0598106
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0541688
	speed: 0.0632s/iter; left time: 669.7787s
	iters: 200, epoch: 53 | loss: 0.0502305
	speed: 0.0348s/iter; left time: 365.2347s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0521811 Vali Loss: 0.0526638 Test Loss: 0.0598178
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009866542182862759, rmse:0.09933046996593475, mae:0.05977698788046837, rse:0.29231756925582886
Use GPU: cuda:0
>>>>>>>start training : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1220326
	speed: 0.0364s/iter; left time: 808.0457s
	iters: 200, epoch: 1 | loss: 0.1029346
	speed: 0.0348s/iter; left time: 769.1123s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.1259346 Vali Loss: 0.0930124 Test Loss: 0.1065052
Validation loss decreased (inf --> 0.093012).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0726846
	speed: 0.0640s/iter; left time: 1406.5569s
	iters: 200, epoch: 2 | loss: 0.0688826
	speed: 0.0348s/iter; left time: 760.8858s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0747757 Vali Loss: 0.0630129 Test Loss: 0.0701470
Validation loss decreased (0.093012 --> 0.063013).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0630229
	speed: 0.0638s/iter; left time: 1388.3226s
	iters: 200, epoch: 3 | loss: 0.0606441
	speed: 0.0348s/iter; left time: 752.8131s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0643692 Vali Loss: 0.0595219 Test Loss: 0.0660069
Validation loss decreased (0.063013 --> 0.059522).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0577680
	speed: 0.0636s/iter; left time: 1369.1470s
	iters: 200, epoch: 4 | loss: 0.0634644
	speed: 0.0348s/iter; left time: 746.0911s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0615642 Vali Loss: 0.0584180 Test Loss: 0.0651230
Validation loss decreased (0.059522 --> 0.058418).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0608671
	speed: 0.0634s/iter; left time: 1350.4796s
	iters: 200, epoch: 5 | loss: 0.0647859
	speed: 0.0348s/iter; left time: 738.8029s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0598110 Vali Loss: 0.0573382 Test Loss: 0.0638470
Validation loss decreased (0.058418 --> 0.057338).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0577245
	speed: 0.0637s/iter; left time: 1343.0667s
	iters: 200, epoch: 6 | loss: 0.0596926
	speed: 0.0348s/iter; left time: 730.8049s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0586960 Vali Loss: 0.0561589 Test Loss: 0.0628494
Validation loss decreased (0.057338 --> 0.056159).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0554998
	speed: 0.0630s/iter; left time: 1315.0874s
	iters: 200, epoch: 7 | loss: 0.0615113
	speed: 0.0347s/iter; left time: 721.1713s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0577603 Vali Loss: 0.0560129 Test Loss: 0.0629468
Validation loss decreased (0.056159 --> 0.056013).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0617084
	speed: 0.0634s/iter; left time: 1308.8752s
	iters: 200, epoch: 8 | loss: 0.0562230
	speed: 0.0348s/iter; left time: 715.3334s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0571237 Vali Loss: 0.0552313 Test Loss: 0.0622659
Validation loss decreased (0.056013 --> 0.055231).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0549473
	speed: 0.0634s/iter; left time: 1294.6717s
	iters: 200, epoch: 9 | loss: 0.0565709
	speed: 0.0348s/iter; left time: 706.5157s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0564831 Vali Loss: 0.0553474 Test Loss: 0.0621103
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0554801
	speed: 0.0627s/iter; left time: 1266.8730s
	iters: 200, epoch: 10 | loss: 0.0555981
	speed: 0.0348s/iter; left time: 698.7287s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0559145 Vali Loss: 0.0549688 Test Loss: 0.0617780
Validation loss decreased (0.055231 --> 0.054969).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0557911
	speed: 0.0641s/iter; left time: 1279.4897s
	iters: 200, epoch: 11 | loss: 0.0561363
	speed: 0.0348s/iter; left time: 691.9977s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0555488 Vali Loss: 0.0545749 Test Loss: 0.0615567
Validation loss decreased (0.054969 --> 0.054575).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0546582
	speed: 0.0646s/iter; left time: 1276.6914s
	iters: 200, epoch: 12 | loss: 0.0536586
	speed: 0.0348s/iter; left time: 683.7345s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0551339 Vali Loss: 0.0539980 Test Loss: 0.0610293
Validation loss decreased (0.054575 --> 0.053998).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0567421
	speed: 0.0655s/iter; left time: 1279.7422s
	iters: 200, epoch: 13 | loss: 0.0555143
	speed: 0.0348s/iter; left time: 675.8562s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0547809 Vali Loss: 0.0539634 Test Loss: 0.0609647
Validation loss decreased (0.053998 --> 0.053963).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0559703
	speed: 0.0635s/iter; left time: 1226.2728s
	iters: 200, epoch: 14 | loss: 0.0540294
	speed: 0.0348s/iter; left time: 667.6737s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0545201 Vali Loss: 0.0537920 Test Loss: 0.0607807
Validation loss decreased (0.053963 --> 0.053792).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0571534
	speed: 0.0633s/iter; left time: 1206.8337s
	iters: 200, epoch: 15 | loss: 0.0574851
	speed: 0.0348s/iter; left time: 659.5465s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0542520 Vali Loss: 0.0537604 Test Loss: 0.0608433
Validation loss decreased (0.053792 --> 0.053760).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0579594
	speed: 0.0634s/iter; left time: 1195.8435s
	iters: 200, epoch: 16 | loss: 0.0538236
	speed: 0.0348s/iter; left time: 652.0229s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0540514 Vali Loss: 0.0534855 Test Loss: 0.0605299
Validation loss decreased (0.053760 --> 0.053486).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0563427
	speed: 0.0634s/iter; left time: 1182.1512s
	iters: 200, epoch: 17 | loss: 0.0530981
	speed: 0.0348s/iter; left time: 644.1604s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0538100 Vali Loss: 0.0537486 Test Loss: 0.0609309
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0554305
	speed: 0.0628s/iter; left time: 1156.8952s
	iters: 200, epoch: 18 | loss: 0.0560160
	speed: 0.0348s/iter; left time: 636.5147s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0536474 Vali Loss: 0.0534000 Test Loss: 0.0606266
Validation loss decreased (0.053486 --> 0.053400).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0525237
	speed: 0.0636s/iter; left time: 1155.9690s
	iters: 200, epoch: 19 | loss: 0.0536887
	speed: 0.0348s/iter; left time: 629.7454s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0534839 Vali Loss: 0.0532571 Test Loss: 0.0605488
Validation loss decreased (0.053400 --> 0.053257).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0549485
	speed: 0.0635s/iter; left time: 1141.0508s
	iters: 200, epoch: 20 | loss: 0.0514710
	speed: 0.0348s/iter; left time: 621.6286s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0533952 Vali Loss: 0.0533304 Test Loss: 0.0602945
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0535472
	speed: 0.0630s/iter; left time: 1117.8355s
	iters: 200, epoch: 21 | loss: 0.0519489
	speed: 0.0348s/iter; left time: 613.6213s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0532001 Vali Loss: 0.0531706 Test Loss: 0.0604976
Validation loss decreased (0.053257 --> 0.053171).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0557677
	speed: 0.0635s/iter; left time: 1112.5365s
	iters: 200, epoch: 22 | loss: 0.0539617
	speed: 0.0348s/iter; left time: 605.5028s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0531452 Vali Loss: 0.0529666 Test Loss: 0.0602932
Validation loss decreased (0.053171 --> 0.052967).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0514711
	speed: 0.0632s/iter; left time: 1093.1251s
	iters: 200, epoch: 23 | loss: 0.0566470
	speed: 0.0348s/iter; left time: 599.1830s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0530440 Vali Loss: 0.0530361 Test Loss: 0.0602941
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0492075
	speed: 0.0631s/iter; left time: 1077.1810s
	iters: 200, epoch: 24 | loss: 0.0510157
	speed: 0.0348s/iter; left time: 590.3857s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0529677 Vali Loss: 0.0528758 Test Loss: 0.0600719
Validation loss decreased (0.052967 --> 0.052876).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0576330
	speed: 0.0633s/iter; left time: 1067.3515s
	iters: 200, epoch: 25 | loss: 0.0552283
	speed: 0.0348s/iter; left time: 582.0906s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0528415 Vali Loss: 0.0529786 Test Loss: 0.0600655
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0512867
	speed: 0.0628s/iter; left time: 1044.1945s
	iters: 200, epoch: 26 | loss: 0.0496288
	speed: 0.0348s/iter; left time: 574.3514s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0527987 Vali Loss: 0.0530332 Test Loss: 0.0601122
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0509674
	speed: 0.0627s/iter; left time: 1028.3703s
	iters: 200, epoch: 27 | loss: 0.0484194
	speed: 0.0348s/iter; left time: 566.8930s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0527392 Vali Loss: 0.0528903 Test Loss: 0.0600539
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0530106
	speed: 0.0628s/iter; left time: 1016.4508s
	iters: 200, epoch: 28 | loss: 0.0531000
	speed: 0.0348s/iter; left time: 558.9825s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0527272 Vali Loss: 0.0529470 Test Loss: 0.0600106
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0491770
	speed: 0.0630s/iter; left time: 1005.7877s
	iters: 200, epoch: 29 | loss: 0.0452469
	speed: 0.0348s/iter; left time: 552.0778s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0526793 Vali Loss: 0.0528311 Test Loss: 0.0599793
Validation loss decreased (0.052876 --> 0.052831).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0550407
	speed: 0.0633s/iter; left time: 996.5060s
	iters: 200, epoch: 30 | loss: 0.0518973
	speed: 0.0348s/iter; left time: 543.9115s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0526110 Vali Loss: 0.0528266 Test Loss: 0.0600462
Validation loss decreased (0.052831 --> 0.052827).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0542863
	speed: 0.0635s/iter; left time: 985.3027s
	iters: 200, epoch: 31 | loss: 0.0546150
	speed: 0.0348s/iter; left time: 535.7107s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0525636 Vali Loss: 0.0527613 Test Loss: 0.0599322
Validation loss decreased (0.052827 --> 0.052761).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0539835
	speed: 0.0635s/iter; left time: 970.0583s
	iters: 200, epoch: 32 | loss: 0.0490118
	speed: 0.0348s/iter; left time: 528.4247s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0524810 Vali Loss: 0.0527825 Test Loss: 0.0599976
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0549474
	speed: 0.0631s/iter; left time: 950.4359s
	iters: 200, epoch: 33 | loss: 0.0535856
	speed: 0.0348s/iter; left time: 520.8791s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0525075 Vali Loss: 0.0527115 Test Loss: 0.0599608
Validation loss decreased (0.052761 --> 0.052712).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0556550
	speed: 0.0647s/iter; left time: 960.1710s
	iters: 200, epoch: 34 | loss: 0.0515874
	speed: 0.0348s/iter; left time: 513.2604s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0524111 Vali Loss: 0.0526704 Test Loss: 0.0598688
Validation loss decreased (0.052712 --> 0.052670).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0557314
	speed: 0.0633s/iter; left time: 926.0640s
	iters: 200, epoch: 35 | loss: 0.0507834
	speed: 0.0348s/iter; left time: 505.4590s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0523630 Vali Loss: 0.0527240 Test Loss: 0.0598827
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0512614
	speed: 0.0629s/iter; left time: 905.4383s
	iters: 200, epoch: 36 | loss: 0.0518102
	speed: 0.0348s/iter; left time: 497.7128s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0524054 Vali Loss: 0.0526994 Test Loss: 0.0598760
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0523046
	speed: 0.0630s/iter; left time: 893.0770s
	iters: 200, epoch: 37 | loss: 0.0508446
	speed: 0.0348s/iter; left time: 489.4237s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0523582 Vali Loss: 0.0527033 Test Loss: 0.0599662
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0494673
	speed: 0.0630s/iter; left time: 878.4601s
	iters: 200, epoch: 38 | loss: 0.0530426
	speed: 0.0348s/iter; left time: 481.6451s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0523731 Vali Loss: 0.0527296 Test Loss: 0.0598084
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0518862
	speed: 0.0631s/iter; left time: 866.3405s
	iters: 200, epoch: 39 | loss: 0.0517699
	speed: 0.0348s/iter; left time: 474.4619s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0523550 Vali Loss: 0.0526709 Test Loss: 0.0597897
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0523804
	speed: 0.0629s/iter; left time: 849.3857s
	iters: 200, epoch: 40 | loss: 0.0547245
	speed: 0.0348s/iter; left time: 466.3571s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522779 Vali Loss: 0.0526520 Test Loss: 0.0598167
Validation loss decreased (0.052670 --> 0.052652).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0520796
	speed: 0.0645s/iter; left time: 857.0303s
	iters: 200, epoch: 41 | loss: 0.0510751
	speed: 0.0363s/iter; left time: 477.8366s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0522868 Vali Loss: 0.0526246 Test Loss: 0.0597722
Validation loss decreased (0.052652 --> 0.052625).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0512310
	speed: 0.0635s/iter; left time: 829.0423s
	iters: 200, epoch: 42 | loss: 0.0529866
	speed: 0.0348s/iter; left time: 451.5412s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0522490 Vali Loss: 0.0525609 Test Loss: 0.0597641
Validation loss decreased (0.052625 --> 0.052561).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0510413
	speed: 0.0632s/iter; left time: 811.6630s
	iters: 200, epoch: 43 | loss: 0.0491077
	speed: 0.0348s/iter; left time: 443.1111s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522282 Vali Loss: 0.0525843 Test Loss: 0.0597606
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0520502
	speed: 0.0629s/iter; left time: 793.6619s
	iters: 200, epoch: 44 | loss: 0.0531535
	speed: 0.0349s/iter; left time: 436.1468s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0522566 Vali Loss: 0.0526180 Test Loss: 0.0597909
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0503224
	speed: 0.0635s/iter; left time: 786.1438s
	iters: 200, epoch: 45 | loss: 0.0540412
	speed: 0.0349s/iter; left time: 429.1579s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0522631 Vali Loss: 0.0525658 Test Loss: 0.0597489
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0557683
	speed: 0.0634s/iter; left time: 771.0397s
	iters: 200, epoch: 46 | loss: 0.0500644
	speed: 0.0349s/iter; left time: 420.8156s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0522589 Vali Loss: 0.0525750 Test Loss: 0.0597478
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0505572
	speed: 0.0631s/iter; left time: 753.5801s
	iters: 200, epoch: 47 | loss: 0.0517297
	speed: 0.0348s/iter; left time: 412.6393s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522229 Vali Loss: 0.0525794 Test Loss: 0.0597371
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0519887
	speed: 0.0631s/iter; left time: 740.0177s
	iters: 200, epoch: 48 | loss: 0.0505121
	speed: 0.0348s/iter; left time: 404.2768s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0522587 Vali Loss: 0.0525739 Test Loss: 0.0597563
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0551468
	speed: 0.0633s/iter; left time: 727.5549s
	iters: 200, epoch: 49 | loss: 0.0543535
	speed: 0.0349s/iter; left time: 397.9484s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0522053 Vali Loss: 0.0526640 Test Loss: 0.0597686
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0530866
	speed: 0.0860s/iter; left time: 969.2238s
	iters: 200, epoch: 50 | loss: 0.0546758
	speed: 0.1936s/iter; left time: 2162.7876s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:29.79s
Steps: 223 | Train Loss: 0.0521773 Vali Loss: 0.0525721 Test Loss: 0.0597589
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0559117
	speed: 0.2853s/iter; left time: 3152.6291s
	iters: 200, epoch: 51 | loss: 0.0528672
	speed: 0.0355s/iter; left time: 389.2384s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:10.15s
Steps: 223 | Train Loss: 0.0521526 Vali Loss: 0.0525845 Test Loss: 0.0597217
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0560968
	speed: 0.0648s/iter; left time: 701.4242s
	iters: 200, epoch: 52 | loss: 0.0540408
	speed: 0.0347s/iter; left time: 371.8941s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0521717 Vali Loss: 0.0525350 Test Loss: 0.0597281
Validation loss decreased (0.052561 --> 0.052535).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0529655
	speed: 0.0641s/iter; left time: 679.3497s
	iters: 200, epoch: 53 | loss: 0.0516334
	speed: 0.0347s/iter; left time: 364.5613s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0522050 Vali Loss: 0.0525881 Test Loss: 0.0597237
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0511335
	speed: 0.0633s/iter; left time: 657.0816s
	iters: 200, epoch: 54 | loss: 0.0495469
	speed: 0.0347s/iter; left time: 356.3038s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0522098 Vali Loss: 0.0525827 Test Loss: 0.0597430
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0499042
	speed: 0.0638s/iter; left time: 647.9299s
	iters: 200, epoch: 55 | loss: 0.0543089
	speed: 0.0347s/iter; left time: 348.8174s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0521472 Vali Loss: 0.0525706 Test Loss: 0.0597533
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0549883
	speed: 0.0634s/iter; left time: 629.8835s
	iters: 200, epoch: 56 | loss: 0.0486927
	speed: 0.0347s/iter; left time: 341.6221s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0521627 Vali Loss: 0.0525882 Test Loss: 0.0597260
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0517346
	speed: 0.0640s/iter; left time: 621.6329s
	iters: 200, epoch: 57 | loss: 0.0517503
	speed: 0.0349s/iter; left time: 335.4256s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0521682 Vali Loss: 0.0525590 Test Loss: 0.0597397
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0523834
	speed: 0.0632s/iter; left time: 600.0961s
	iters: 200, epoch: 58 | loss: 0.0494293
	speed: 0.0346s/iter; left time: 325.1599s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0521432 Vali Loss: 0.0524969 Test Loss: 0.0597336
Validation loss decreased (0.052535 --> 0.052497).  Saving model ...
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0492647
	speed: 0.0634s/iter; left time: 587.0846s
	iters: 200, epoch: 59 | loss: 0.0519503
	speed: 0.0346s/iter; left time: 317.5933s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0522087 Vali Loss: 0.0525812 Test Loss: 0.0597525
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0497367
	speed: 0.0630s/iter; left time: 570.0427s
	iters: 200, epoch: 60 | loss: 0.0495885
	speed: 0.0347s/iter; left time: 310.1272s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0521029 Vali Loss: 0.0525469 Test Loss: 0.0597159
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0560998
	speed: 0.0628s/iter; left time: 553.6345s
	iters: 200, epoch: 61 | loss: 0.0487670
	speed: 0.0346s/iter; left time: 301.9371s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0521652 Vali Loss: 0.0525439 Test Loss: 0.0597304
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0514731
	speed: 0.0631s/iter; left time: 542.5550s
	iters: 200, epoch: 62 | loss: 0.0511709
	speed: 0.0347s/iter; left time: 294.8354s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0521105 Vali Loss: 0.0525647 Test Loss: 0.0597182
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0521433
	speed: 0.0628s/iter; left time: 526.2233s
	iters: 200, epoch: 63 | loss: 0.0503324
	speed: 0.0346s/iter; left time: 286.2273s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:07.90s
Steps: 223 | Train Loss: 0.0521071 Vali Loss: 0.0525776 Test Loss: 0.0597103
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0540591
	speed: 0.0628s/iter; left time: 512.1828s
	iters: 200, epoch: 64 | loss: 0.0516116
	speed: 0.0346s/iter; left time: 278.9412s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0522032 Vali Loss: 0.0525546 Test Loss: 0.0596993
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0474531
	speed: 0.0630s/iter; left time: 499.7513s
	iters: 200, epoch: 65 | loss: 0.0538364
	speed: 0.0346s/iter; left time: 270.9767s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0521677 Vali Loss: 0.0525728 Test Loss: 0.0597150
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0497643
	speed: 0.0629s/iter; left time: 484.6543s
	iters: 200, epoch: 66 | loss: 0.0538237
	speed: 0.0347s/iter; left time: 263.5515s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0521412 Vali Loss: 0.0525373 Test Loss: 0.0597279
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0499914
	speed: 0.0629s/iter; left time: 470.8134s
	iters: 200, epoch: 67 | loss: 0.0554513
	speed: 0.0346s/iter; left time: 255.7259s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0521308 Vali Loss: 0.0525533 Test Loss: 0.0597116
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0493037
	speed: 0.0634s/iter; left time: 460.3703s
	iters: 200, epoch: 68 | loss: 0.0565311
	speed: 0.0347s/iter; left time: 248.2236s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0521564 Vali Loss: 0.0525395 Test Loss: 0.0596687
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_24_ES_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009866722859442234, rmse:0.09933137893676758, mae:0.05973363667726517, rse:0.29232025146484375
Intermediate time for ES and pred_len 24: 00h:20m:40.05s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_512_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1260398
	speed: 0.0530s/iter; left time: 1172.3117s
	iters: 200, epoch: 1 | loss: 0.1094058
	speed: 0.0350s/iter; left time: 770.4190s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.25s
Steps: 222 | Train Loss: 0.1312395 Vali Loss: 0.1025643 Test Loss: 0.1179704
Validation loss decreased (inf --> 0.102564).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0910940
	speed: 0.0670s/iter; left time: 1466.3118s
	iters: 200, epoch: 2 | loss: 0.0862823
	speed: 0.0351s/iter; left time: 764.1153s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.99s
Steps: 222 | Train Loss: 0.0916984 Vali Loss: 0.0828621 Test Loss: 0.0948578
Validation loss decreased (0.102564 --> 0.082862).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0830963
	speed: 0.0658s/iter; left time: 1425.5313s
	iters: 200, epoch: 3 | loss: 0.0800575
	speed: 0.0351s/iter; left time: 757.2695s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.01s
Steps: 222 | Train Loss: 0.0835440 Vali Loss: 0.0801127 Test Loss: 0.0918577
Validation loss decreased (0.082862 --> 0.080113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0827469
	speed: 0.0655s/iter; left time: 1402.9393s
	iters: 200, epoch: 4 | loss: 0.0801315
	speed: 0.0351s/iter; left time: 749.0111s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.96s
Steps: 222 | Train Loss: 0.0810485 Vali Loss: 0.0794556 Test Loss: 0.0912822
Validation loss decreased (0.080113 --> 0.079456).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0791584
	speed: 0.0670s/iter; left time: 1421.3492s
	iters: 200, epoch: 5 | loss: 0.0771858
	speed: 0.0352s/iter; left time: 743.6316s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.02s
Steps: 222 | Train Loss: 0.0794836 Vali Loss: 0.0775880 Test Loss: 0.0889750
Validation loss decreased (0.079456 --> 0.077588).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0784760
	speed: 0.0650s/iter; left time: 1364.3395s
	iters: 200, epoch: 6 | loss: 0.0783841
	speed: 0.0350s/iter; left time: 732.2061s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.95s
Steps: 222 | Train Loss: 0.0781405 Vali Loss: 0.0771143 Test Loss: 0.0890088
Validation loss decreased (0.077588 --> 0.077114).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0748558
	speed: 0.0646s/iter; left time: 1340.6576s
	iters: 200, epoch: 7 | loss: 0.0760703
	speed: 0.0351s/iter; left time: 725.8126s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.98s
Steps: 222 | Train Loss: 0.0771091 Vali Loss: 0.0769558 Test Loss: 0.0889577
Validation loss decreased (0.077114 --> 0.076956).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0765331
	speed: 0.0650s/iter; left time: 1335.3036s
	iters: 200, epoch: 8 | loss: 0.0739735
	speed: 0.0351s/iter; left time: 717.8247s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.97s
Steps: 222 | Train Loss: 0.0762211 Vali Loss: 0.0766279 Test Loss: 0.0881195
Validation loss decreased (0.076956 --> 0.076628).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0740731
	speed: 0.0655s/iter; left time: 1331.3336s
	iters: 200, epoch: 9 | loss: 0.0760542
	speed: 0.0351s/iter; left time: 710.4608s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.96s
Steps: 222 | Train Loss: 0.0754744 Vali Loss: 0.0768604 Test Loss: 0.0877999
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0748701
	speed: 0.0639s/iter; left time: 1284.6550s
	iters: 200, epoch: 10 | loss: 0.0732583
	speed: 0.0351s/iter; left time: 701.2110s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.96s
Steps: 222 | Train Loss: 0.0747732 Vali Loss: 0.0759283 Test Loss: 0.0877505
Validation loss decreased (0.076628 --> 0.075928).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0744002
	speed: 0.0644s/iter; left time: 1280.6382s
	iters: 200, epoch: 11 | loss: 0.0738547
	speed: 0.0351s/iter; left time: 695.1592s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.98s
Steps: 222 | Train Loss: 0.0742015 Vali Loss: 0.0763542 Test Loss: 0.0879077
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0763251
	speed: 0.0638s/iter; left time: 1253.8331s
	iters: 200, epoch: 12 | loss: 0.0744755
	speed: 0.0350s/iter; left time: 685.4543s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.95s
Steps: 222 | Train Loss: 0.0737041 Vali Loss: 0.0765918 Test Loss: 0.0877662
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0757539
	speed: 0.0648s/iter; left time: 1258.6087s
	iters: 200, epoch: 13 | loss: 0.0730051
	speed: 0.0352s/iter; left time: 680.5964s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.02s
Steps: 222 | Train Loss: 0.0732794 Vali Loss: 0.0768405 Test Loss: 0.0879112
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0759228
	speed: 0.0649s/iter; left time: 1246.7385s
	iters: 200, epoch: 14 | loss: 0.0697216
	speed: 0.0351s/iter; left time: 670.2600s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0729788 Vali Loss: 0.0768946 Test Loss: 0.0879021
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0712653
	speed: 0.0642s/iter; left time: 1218.9842s
	iters: 200, epoch: 15 | loss: 0.0766184
	speed: 0.0350s/iter; left time: 661.4098s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.93s
Steps: 222 | Train Loss: 0.0726127 Vali Loss: 0.0770157 Test Loss: 0.0880994
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0742202
	speed: 0.0650s/iter; left time: 1220.9232s
	iters: 200, epoch: 16 | loss: 0.0683738
	speed: 0.0352s/iter; left time: 657.0488s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0722651 Vali Loss: 0.0772379 Test Loss: 0.0881794
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0698431
	speed: 0.0646s/iter; left time: 1198.5947s
	iters: 200, epoch: 17 | loss: 0.0702294
	speed: 0.0352s/iter; left time: 650.2468s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0719513 Vali Loss: 0.0765780 Test Loss: 0.0879023
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0715836
	speed: 0.0643s/iter; left time: 1178.7720s
	iters: 200, epoch: 18 | loss: 0.0724372
	speed: 0.0353s/iter; left time: 643.0671s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.00s
Steps: 222 | Train Loss: 0.0717396 Vali Loss: 0.0768387 Test Loss: 0.0879140
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0737238
	speed: 0.0642s/iter; left time: 1163.0566s
	iters: 200, epoch: 19 | loss: 0.0690236
	speed: 0.0351s/iter; left time: 631.2690s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.94s
Steps: 222 | Train Loss: 0.0714695 Vali Loss: 0.0772368 Test Loss: 0.0880769
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0733092
	speed: 0.0641s/iter; left time: 1146.9008s
	iters: 200, epoch: 20 | loss: 0.0739523
	speed: 0.0351s/iter; left time: 623.7209s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.98s
Steps: 222 | Train Loss: 0.0713218 Vali Loss: 0.0768432 Test Loss: 0.0879300
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018871869891881943, rmse:0.13737492263317108, mae:0.08775053173303604, rse:0.4035661816596985
Use GPU: cuda:0
>>>>>>>start training : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1251608
	speed: 0.0369s/iter; left time: 815.6401s
	iters: 200, epoch: 1 | loss: 0.1145597
	speed: 0.0351s/iter; left time: 772.2059s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.00s
Steps: 222 | Train Loss: 0.1341426 Vali Loss: 0.1022528 Test Loss: 0.1178219
Validation loss decreased (inf --> 0.102253).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0918480
	speed: 0.0673s/iter; left time: 1471.8311s
	iters: 200, epoch: 2 | loss: 0.0841864
	speed: 0.0351s/iter; left time: 765.0743s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.97s
Steps: 222 | Train Loss: 0.0917143 Vali Loss: 0.0827933 Test Loss: 0.0951420
Validation loss decreased (0.102253 --> 0.082793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0802328
	speed: 0.0659s/iter; left time: 1427.4664s
	iters: 200, epoch: 3 | loss: 0.0848325
	speed: 0.0351s/iter; left time: 756.9069s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.99s
Steps: 222 | Train Loss: 0.0834263 Vali Loss: 0.0801661 Test Loss: 0.0913073
Validation loss decreased (0.082793 --> 0.080166).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818230
	speed: 0.0643s/iter; left time: 1379.0318s
	iters: 200, epoch: 4 | loss: 0.0802361
	speed: 0.0351s/iter; left time: 748.4733s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.97s
Steps: 222 | Train Loss: 0.0809871 Vali Loss: 0.0786778 Test Loss: 0.0897193
Validation loss decreased (0.080166 --> 0.078678).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0772564
	speed: 0.0652s/iter; left time: 1383.8049s
	iters: 200, epoch: 5 | loss: 0.0814229
	speed: 0.0359s/iter; left time: 757.2473s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0792988 Vali Loss: 0.0778066 Test Loss: 0.0885959
Validation loss decreased (0.078678 --> 0.077807).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0764081
	speed: 0.2176s/iter; left time: 4566.7076s
	iters: 200, epoch: 6 | loss: 0.0773624
	speed: 0.1878s/iter; left time: 3923.8099s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.55s
Steps: 222 | Train Loss: 0.0779447 Vali Loss: 0.0773780 Test Loss: 0.0886872
Validation loss decreased (0.077807 --> 0.077378).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0811512
	speed: 0.1895s/iter; left time: 3936.2038s
	iters: 200, epoch: 7 | loss: 0.0761342
	speed: 0.0351s/iter; left time: 724.5042s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0769921 Vali Loss: 0.0766341 Test Loss: 0.0885049
Validation loss decreased (0.077378 --> 0.076634).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0770397
	speed: 0.0646s/iter; left time: 1328.0639s
	iters: 200, epoch: 8 | loss: 0.0767725
	speed: 0.0351s/iter; left time: 717.1475s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.96s
Steps: 222 | Train Loss: 0.0761878 Vali Loss: 0.0762908 Test Loss: 0.0881954
Validation loss decreased (0.076634 --> 0.076291).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0769685
	speed: 0.0649s/iter; left time: 1319.4390s
	iters: 200, epoch: 9 | loss: 0.0753919
	speed: 0.0356s/iter; left time: 720.5525s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.01s
Steps: 222 | Train Loss: 0.0754454 Vali Loss: 0.0759398 Test Loss: 0.0880421
Validation loss decreased (0.076291 --> 0.075940).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0743246
	speed: 0.0665s/iter; left time: 1337.4520s
	iters: 200, epoch: 10 | loss: 0.0720993
	speed: 0.0353s/iter; left time: 705.4292s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0748660 Vali Loss: 0.0759301 Test Loss: 0.0884588
Validation loss decreased (0.075940 --> 0.075930).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0720741
	speed: 0.0656s/iter; left time: 1304.3697s
	iters: 200, epoch: 11 | loss: 0.0748360
	speed: 0.0351s/iter; left time: 695.1580s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.99s
Steps: 222 | Train Loss: 0.0743284 Vali Loss: 0.0763421 Test Loss: 0.0880268
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0726227
	speed: 0.0646s/iter; left time: 1269.5504s
	iters: 200, epoch: 12 | loss: 0.0748167
	speed: 0.0352s/iter; left time: 688.9847s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.00s
Steps: 222 | Train Loss: 0.0738782 Vali Loss: 0.0759847 Test Loss: 0.0881390
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0721753
	speed: 0.0648s/iter; left time: 1258.6577s
	iters: 200, epoch: 13 | loss: 0.0772060
	speed: 0.0352s/iter; left time: 679.7931s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.98s
Steps: 222 | Train Loss: 0.0734766 Vali Loss: 0.0758512 Test Loss: 0.0878312
Validation loss decreased (0.075930 --> 0.075851).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0715857
	speed: 0.0655s/iter; left time: 1258.5466s
	iters: 200, epoch: 14 | loss: 0.0760631
	speed: 0.0356s/iter; left time: 680.4708s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0731019 Vali Loss: 0.0763125 Test Loss: 0.0881449
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0728902
	speed: 0.0664s/iter; left time: 1261.9057s
	iters: 200, epoch: 15 | loss: 0.0735835
	speed: 0.0351s/iter; left time: 662.6150s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0727445 Vali Loss: 0.0761350 Test Loss: 0.0879413
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0705711
	speed: 0.0645s/iter; left time: 1210.8984s
	iters: 200, epoch: 16 | loss: 0.0673693
	speed: 0.0351s/iter; left time: 656.2019s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.99s
Steps: 222 | Train Loss: 0.0725134 Vali Loss: 0.0764219 Test Loss: 0.0875670
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0732625
	speed: 0.0653s/iter; left time: 1210.4970s
	iters: 200, epoch: 17 | loss: 0.0735754
	speed: 0.0352s/iter; left time: 649.9066s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 222 | Train Loss: 0.0722842 Vali Loss: 0.0762213 Test Loss: 0.0875859
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0754683
	speed: 0.0651s/iter; left time: 1193.8060s
	iters: 200, epoch: 18 | loss: 0.0736159
	speed: 0.0352s/iter; left time: 642.1557s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0720724 Vali Loss: 0.0760946 Test Loss: 0.0880375
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0718110
	speed: 0.0659s/iter; left time: 1192.2314s
	iters: 200, epoch: 19 | loss: 0.0741730
	speed: 0.0352s/iter; left time: 633.5115s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0717672 Vali Loss: 0.0764167 Test Loss: 0.0877499
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0699607
	speed: 0.0677s/iter; left time: 1211.3845s
	iters: 200, epoch: 20 | loss: 0.0741154
	speed: 0.1638s/iter; left time: 2913.2284s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:22.93s
Steps: 222 | Train Loss: 0.0715612 Vali Loss: 0.0762464 Test Loss: 0.0878026
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0707614
	speed: 0.0929s/iter; left time: 1639.8626s
	iters: 200, epoch: 21 | loss: 0.0679704
	speed: 0.0365s/iter; left time: 640.3222s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0714182 Vali Loss: 0.0766377 Test Loss: 0.0876773
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0744809
	speed: 0.3808s/iter; left time: 6639.9250s
	iters: 200, epoch: 22 | loss: 0.0662124
	speed: 0.0354s/iter; left time: 614.3958s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.30s
Steps: 222 | Train Loss: 0.0713353 Vali Loss: 0.0763942 Test Loss: 0.0876612
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0721484
	speed: 0.0647s/iter; left time: 1113.8564s
	iters: 200, epoch: 23 | loss: 0.0740722
	speed: 0.0352s/iter; left time: 601.6680s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.00s
Steps: 222 | Train Loss: 0.0712046 Vali Loss: 0.0763761 Test Loss: 0.0877781
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_96_ES_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019007287919521332, rmse:0.13786691427230835, mae:0.08783120661973953, rse:0.40501153469085693
Intermediate time for ES and pred_len 96: 00h:08m:51.89s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_512_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1248044
	speed: 0.0530s/iter; left time: 1170.7224s
	iters: 200, epoch: 1 | loss: 0.1121375
	speed: 0.0354s/iter; left time: 777.9887s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.36s
Steps: 222 | Train Loss: 0.1329905 Vali Loss: 0.1052874 Test Loss: 0.1202584
Validation loss decreased (inf --> 0.105287).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0913955
	speed: 0.0676s/iter; left time: 1479.3802s
	iters: 200, epoch: 2 | loss: 0.0897939
	speed: 0.0354s/iter; left time: 770.0586s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0956577 Vali Loss: 0.0880194 Test Loss: 0.1003802
Validation loss decreased (0.105287 --> 0.088019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0912098
	speed: 0.0658s/iter; left time: 1424.0831s
	iters: 200, epoch: 3 | loss: 0.0903715
	speed: 0.0354s/iter; left time: 762.7936s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0882833 Vali Loss: 0.0853559 Test Loss: 0.0969999
Validation loss decreased (0.088019 --> 0.085356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0885219
	speed: 0.0659s/iter; left time: 1412.1189s
	iters: 200, epoch: 4 | loss: 0.0829042
	speed: 0.0354s/iter; left time: 754.7217s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.03s
Steps: 222 | Train Loss: 0.0855933 Vali Loss: 0.0840832 Test Loss: 0.0959689
Validation loss decreased (0.085356 --> 0.084083).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0806795
	speed: 0.0687s/iter; left time: 1457.9011s
	iters: 200, epoch: 5 | loss: 0.0851555
	speed: 0.0354s/iter; left time: 747.2190s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0837458 Vali Loss: 0.0834666 Test Loss: 0.0952264
Validation loss decreased (0.084083 --> 0.083467).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0795757
	speed: 0.0661s/iter; left time: 1386.5759s
	iters: 200, epoch: 6 | loss: 0.0825070
	speed: 0.0354s/iter; left time: 738.7010s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0821476 Vali Loss: 0.0832355 Test Loss: 0.0942999
Validation loss decreased (0.083467 --> 0.083235).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0832260
	speed: 0.0666s/iter; left time: 1383.7755s
	iters: 200, epoch: 7 | loss: 0.0815057
	speed: 0.0353s/iter; left time: 730.1618s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0809988 Vali Loss: 0.0836252 Test Loss: 0.0949094
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0845280
	speed: 0.0648s/iter; left time: 1330.4769s
	iters: 200, epoch: 8 | loss: 0.0820176
	speed: 0.0354s/iter; left time: 723.4412s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.03s
Steps: 222 | Train Loss: 0.0800716 Vali Loss: 0.0830692 Test Loss: 0.0949128
Validation loss decreased (0.083235 --> 0.083069).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0779482
	speed: 0.0692s/iter; left time: 1407.4368s
	iters: 200, epoch: 9 | loss: 0.0817634
	speed: 0.1056s/iter; left time: 2136.1635s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.46s
Steps: 222 | Train Loss: 0.0792837 Vali Loss: 0.0832909 Test Loss: 0.0947785
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0796368
	speed: 0.0675s/iter; left time: 1356.3240s
	iters: 200, epoch: 10 | loss: 0.0779853
	speed: 0.0526s/iter; left time: 1052.9581s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:13.45s
Steps: 222 | Train Loss: 0.0786656 Vali Loss: 0.0832510 Test Loss: 0.0946252
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0785343
	speed: 0.6281s/iter; left time: 12486.9896s
	iters: 200, epoch: 11 | loss: 0.0724108
	speed: 0.1509s/iter; left time: 2984.1067s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:36.38s
Steps: 222 | Train Loss: 0.0780590 Vali Loss: 0.0837434 Test Loss: 0.0947317
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0778789
	speed: 0.0767s/iter; left time: 1508.4605s
	iters: 200, epoch: 12 | loss: 0.0793115
	speed: 0.0354s/iter; left time: 692.7958s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.23s
Steps: 222 | Train Loss: 0.0776558 Vali Loss: 0.0835496 Test Loss: 0.0946513
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0768540
	speed: 0.0645s/iter; left time: 1253.1599s
	iters: 200, epoch: 13 | loss: 0.0758939
	speed: 0.0353s/iter; left time: 683.4484s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.01s
Steps: 222 | Train Loss: 0.0771729 Vali Loss: 0.0840376 Test Loss: 0.0947968
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0770758
	speed: 0.0646s/iter; left time: 1240.6503s
	iters: 200, epoch: 14 | loss: 0.0722814
	speed: 0.0353s/iter; left time: 674.9198s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.00s
Steps: 222 | Train Loss: 0.0767453 Vali Loss: 0.0838487 Test Loss: 0.0948405
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0768786
	speed: 0.0642s/iter; left time: 1220.2160s
	iters: 200, epoch: 15 | loss: 0.0742398
	speed: 0.0353s/iter; left time: 667.3881s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.02s
Steps: 222 | Train Loss: 0.0764734 Vali Loss: 0.0840944 Test Loss: 0.0948674
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0763122
	speed: 0.0648s/iter; left time: 1216.8669s
	iters: 200, epoch: 16 | loss: 0.0735435
	speed: 0.0354s/iter; left time: 660.5833s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0761429 Vali Loss: 0.0840424 Test Loss: 0.0947928
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0758866
	speed: 0.0647s/iter; left time: 1199.2048s
	iters: 200, epoch: 17 | loss: 0.0786234
	speed: 0.0354s/iter; left time: 652.7139s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0758693 Vali Loss: 0.0847151 Test Loss: 0.0951496
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0750566
	speed: 0.0647s/iter; left time: 1186.6675s
	iters: 200, epoch: 18 | loss: 0.0735079
	speed: 0.0354s/iter; left time: 645.2376s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.01s
Steps: 222 | Train Loss: 0.0756012 Vali Loss: 0.0840558 Test Loss: 0.0955794
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021398372948169708, rmse:0.14628182351589203, mae:0.0949128046631813, rse:0.4297628402709961
Use GPU: cuda:0
>>>>>>>start training : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1262133
	speed: 0.0370s/iter; left time: 818.7084s
	iters: 200, epoch: 1 | loss: 0.1155465
	speed: 0.0354s/iter; left time: 778.6365s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.1330362 Vali Loss: 0.1057256 Test Loss: 0.1209119
Validation loss decreased (inf --> 0.105726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0969276
	speed: 0.0782s/iter; left time: 1711.8345s
	iters: 200, epoch: 2 | loss: 0.0930786
	speed: 0.0354s/iter; left time: 769.8881s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0959136 Vali Loss: 0.0881749 Test Loss: 0.1012242
Validation loss decreased (0.105726 --> 0.088175).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0903248
	speed: 0.0657s/iter; left time: 1422.9299s
	iters: 200, epoch: 3 | loss: 0.0888213
	speed: 0.0353s/iter; left time: 761.8707s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0886226 Vali Loss: 0.0859347 Test Loss: 0.0981556
Validation loss decreased (0.088175 --> 0.085935).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0835429
	speed: 0.0693s/iter; left time: 1484.7536s
	iters: 200, epoch: 4 | loss: 0.0864875
	speed: 0.0354s/iter; left time: 754.2379s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0859898 Vali Loss: 0.0845382 Test Loss: 0.0961444
Validation loss decreased (0.085935 --> 0.084538).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0793198
	speed: 0.0675s/iter; left time: 1432.3049s
	iters: 200, epoch: 5 | loss: 0.0833651
	speed: 0.0390s/iter; left time: 824.1668s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.58s
Steps: 222 | Train Loss: 0.0841185 Vali Loss: 0.0830565 Test Loss: 0.0956405
Validation loss decreased (0.084538 --> 0.083056).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0843879
	speed: 0.2041s/iter; left time: 4283.3636s
	iters: 200, epoch: 6 | loss: 0.0821313
	speed: 0.0360s/iter; left time: 751.1506s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0827344 Vali Loss: 0.0830209 Test Loss: 0.0961275
Validation loss decreased (0.083056 --> 0.083021).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0815268
	speed: 0.4162s/iter; left time: 8645.0667s
	iters: 200, epoch: 7 | loss: 0.0820298
	speed: 0.1791s/iter; left time: 3701.5586s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.03s
Steps: 222 | Train Loss: 0.0815136 Vali Loss: 0.0829712 Test Loss: 0.0942766
Validation loss decreased (0.083021 --> 0.082971).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0826096
	speed: 0.2969s/iter; left time: 6100.9579s
	iters: 200, epoch: 8 | loss: 0.0799328
	speed: 0.0360s/iter; left time: 736.9547s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.40s
Steps: 222 | Train Loss: 0.0804369 Vali Loss: 0.0834113 Test Loss: 0.0943891
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0811863
	speed: 0.0661s/iter; left time: 1343.7931s
	iters: 200, epoch: 9 | loss: 0.0789521
	speed: 0.0355s/iter; left time: 718.8979s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0796194 Vali Loss: 0.0833020 Test Loss: 0.0946176
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0792897
	speed: 0.0654s/iter; left time: 1314.4616s
	iters: 200, epoch: 10 | loss: 0.0795097
	speed: 0.0354s/iter; left time: 708.7475s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0788510 Vali Loss: 0.0848339 Test Loss: 0.0951783
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0800021
	speed: 0.0655s/iter; left time: 1302.6337s
	iters: 200, epoch: 11 | loss: 0.0780762
	speed: 0.0354s/iter; left time: 700.5604s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0782232 Vali Loss: 0.0836270 Test Loss: 0.0940536
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0789887
	speed: 0.0661s/iter; left time: 1300.0125s
	iters: 200, epoch: 12 | loss: 0.0775751
	speed: 0.0357s/iter; left time: 698.7727s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.19s
Steps: 222 | Train Loss: 0.0777460 Vali Loss: 0.0836621 Test Loss: 0.0943825
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0776807
	speed: 0.0648s/iter; left time: 1260.3107s
	iters: 200, epoch: 13 | loss: 0.0753892
	speed: 0.0354s/iter; left time: 684.9484s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0772821 Vali Loss: 0.0838019 Test Loss: 0.0949747
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0766929
	speed: 0.0649s/iter; left time: 1246.8134s
	iters: 200, epoch: 14 | loss: 0.0776243
	speed: 0.0354s/iter; left time: 677.4522s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0768859 Vali Loss: 0.0844462 Test Loss: 0.0948179
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0752913
	speed: 0.0650s/iter; left time: 1233.6634s
	iters: 200, epoch: 15 | loss: 0.0740202
	speed: 0.0354s/iter; left time: 668.5688s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.02s
Steps: 222 | Train Loss: 0.0764546 Vali Loss: 0.0840741 Test Loss: 0.0945859
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0780877
	speed: 0.0654s/iter; left time: 1226.7383s
	iters: 200, epoch: 16 | loss: 0.0740172
	speed: 0.0354s/iter; left time: 660.3927s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.03s
Steps: 222 | Train Loss: 0.0760855 Vali Loss: 0.0843399 Test Loss: 0.0947543
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0761232
	speed: 0.0647s/iter; left time: 1200.3612s
	iters: 200, epoch: 17 | loss: 0.0759137
	speed: 0.0354s/iter; left time: 652.3628s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.04s
Steps: 222 | Train Loss: 0.0757693 Vali Loss: 0.0838592 Test Loss: 0.0947815
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_512_168_ES_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02121954783797264, rmse:0.14566931128501892, mae:0.09427657723426819, rse:0.4279633164405823
Intermediate time for ES and pred_len 168: 00h:08m:50.20s
Intermediate time for ES: 00h:38m:22.14s

=== Starting experiments for country: FR ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_512_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0836576
	speed: 0.0553s/iter; left time: 1228.5774s
	iters: 200, epoch: 1 | loss: 0.0827788
	speed: 0.0347s/iter; left time: 767.9613s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.19s
Steps: 223 | Train Loss: 0.0929252 Vali Loss: 0.0809843 Test Loss: 0.0874676
Validation loss decreased (inf --> 0.080984).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0541820
	speed: 0.0640s/iter; left time: 1405.6421s
	iters: 200, epoch: 2 | loss: 0.0536694
	speed: 0.0755s/iter; left time: 1651.8446s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.29s
Steps: 223 | Train Loss: 0.0554993 Vali Loss: 0.0584362 Test Loss: 0.0612443
Validation loss decreased (0.080984 --> 0.058436).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0479808
	speed: 0.1419s/iter; left time: 3086.3528s
	iters: 200, epoch: 3 | loss: 0.0469247
	speed: 0.0348s/iter; left time: 754.3085s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0488807 Vali Loss: 0.0559211 Test Loss: 0.0599450
Validation loss decreased (0.058436 --> 0.055921).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0495132
	speed: 0.1465s/iter; left time: 3155.4757s
	iters: 200, epoch: 4 | loss: 0.0486777
	speed: 0.1460s/iter; left time: 3128.0486s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.75s
Steps: 223 | Train Loss: 0.0471245 Vali Loss: 0.0549650 Test Loss: 0.0586658
Validation loss decreased (0.055921 --> 0.054965).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0461087
	speed: 0.3328s/iter; left time: 7091.7118s
	iters: 200, epoch: 5 | loss: 0.0431552
	speed: 0.1444s/iter; left time: 3063.2244s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:32.69s
Steps: 223 | Train Loss: 0.0459224 Vali Loss: 0.0544292 Test Loss: 0.0579801
Validation loss decreased (0.054965 --> 0.054429).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0429516
	speed: 0.1242s/iter; left time: 2619.4910s
	iters: 200, epoch: 6 | loss: 0.0450441
	speed: 0.0351s/iter; left time: 737.1692s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.28s
Steps: 223 | Train Loss: 0.0450753 Vali Loss: 0.0534364 Test Loss: 0.0574893
Validation loss decreased (0.054429 --> 0.053436).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0427252
	speed: 0.0642s/iter; left time: 1340.3451s
	iters: 200, epoch: 7 | loss: 0.0438986
	speed: 0.0348s/iter; left time: 722.7895s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0443351 Vali Loss: 0.0531485 Test Loss: 0.0569254
Validation loss decreased (0.053436 --> 0.053148).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0460687
	speed: 0.0638s/iter; left time: 1316.1113s
	iters: 200, epoch: 8 | loss: 0.0425774
	speed: 0.0348s/iter; left time: 714.6933s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0439071 Vali Loss: 0.0528703 Test Loss: 0.0569165
Validation loss decreased (0.053148 --> 0.052870).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0421830
	speed: 0.0641s/iter; left time: 1308.4582s
	iters: 200, epoch: 9 | loss: 0.0437702
	speed: 0.0348s/iter; left time: 706.6307s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0434690 Vali Loss: 0.0526643 Test Loss: 0.0562686
Validation loss decreased (0.052870 --> 0.052664).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0450998
	speed: 0.0646s/iter; left time: 1304.3270s
	iters: 200, epoch: 10 | loss: 0.0410023
	speed: 0.0349s/iter; left time: 700.3842s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0431665 Vali Loss: 0.0526991 Test Loss: 0.0567075
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0446551
	speed: 0.0643s/iter; left time: 1283.4945s
	iters: 200, epoch: 11 | loss: 0.0440647
	speed: 0.0348s/iter; left time: 690.7190s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0428013 Vali Loss: 0.0522881 Test Loss: 0.0562465
Validation loss decreased (0.052664 --> 0.052288).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0446330
	speed: 0.0638s/iter; left time: 1260.3358s
	iters: 200, epoch: 12 | loss: 0.0441936
	speed: 0.0347s/iter; left time: 682.0391s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0425423 Vali Loss: 0.0518824 Test Loss: 0.0558948
Validation loss decreased (0.052288 --> 0.051882).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0426764
	speed: 0.0636s/iter; left time: 1241.3250s
	iters: 200, epoch: 13 | loss: 0.0411832
	speed: 0.0347s/iter; left time: 674.4093s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0423290 Vali Loss: 0.0518348 Test Loss: 0.0561304
Validation loss decreased (0.051882 --> 0.051835).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0393404
	speed: 0.0663s/iter; left time: 1280.1072s
	iters: 200, epoch: 14 | loss: 0.0417510
	speed: 0.0347s/iter; left time: 666.4404s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0421292 Vali Loss: 0.0518482 Test Loss: 0.0560844
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0428903
	speed: 0.0640s/iter; left time: 1220.6665s
	iters: 200, epoch: 15 | loss: 0.0426096
	speed: 0.0348s/iter; left time: 659.6620s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0419744 Vali Loss: 0.0517020 Test Loss: 0.0557122
Validation loss decreased (0.051835 --> 0.051702).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0406196
	speed: 0.0650s/iter; left time: 1224.7883s
	iters: 200, epoch: 16 | loss: 0.0429875
	speed: 0.0348s/iter; left time: 652.0029s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0418102 Vali Loss: 0.0516462 Test Loss: 0.0557060
Validation loss decreased (0.051702 --> 0.051646).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0435691
	speed: 0.0640s/iter; left time: 1192.3540s
	iters: 200, epoch: 17 | loss: 0.0413735
	speed: 0.0349s/iter; left time: 647.6471s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0416812 Vali Loss: 0.0513440 Test Loss: 0.0555808
Validation loss decreased (0.051646 --> 0.051344).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0442521
	speed: 0.0658s/iter; left time: 1210.8082s
	iters: 200, epoch: 18 | loss: 0.0423577
	speed: 0.0642s/iter; left time: 1175.3032s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:12.90s
Steps: 223 | Train Loss: 0.0415006 Vali Loss: 0.0514995 Test Loss: 0.0556802
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0410317
	speed: 0.1585s/iter; left time: 2882.1213s
	iters: 200, epoch: 19 | loss: 0.0432977
	speed: 0.0363s/iter; left time: 656.0531s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.19s
Steps: 223 | Train Loss: 0.0414593 Vali Loss: 0.0512872 Test Loss: 0.0555878
Validation loss decreased (0.051344 --> 0.051287).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0433293
	speed: 0.0672s/iter; left time: 1207.6452s
	iters: 200, epoch: 20 | loss: 0.0413895
	speed: 0.0352s/iter; left time: 629.1399s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.0413562 Vali Loss: 0.0513565 Test Loss: 0.0554658
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0414682
	speed: 0.0639s/iter; left time: 1134.4744s
	iters: 200, epoch: 21 | loss: 0.0405680
	speed: 0.0352s/iter; left time: 620.1628s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0412301 Vali Loss: 0.0511387 Test Loss: 0.0554350
Validation loss decreased (0.051287 --> 0.051139).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0410880
	speed: 0.0652s/iter; left time: 1141.9281s
	iters: 200, epoch: 22 | loss: 0.0437249
	speed: 0.0351s/iter; left time: 611.8609s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0411701 Vali Loss: 0.0511831 Test Loss: 0.0554506
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0435361
	speed: 0.0643s/iter; left time: 1112.1037s
	iters: 200, epoch: 23 | loss: 0.0397593
	speed: 0.0349s/iter; left time: 599.6260s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0410498 Vali Loss: 0.0511003 Test Loss: 0.0554148
Validation loss decreased (0.051139 --> 0.051100).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0421156
	speed: 0.0640s/iter; left time: 1093.1930s
	iters: 200, epoch: 24 | loss: 0.0424190
	speed: 0.0351s/iter; left time: 596.4287s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0409924 Vali Loss: 0.0511058 Test Loss: 0.0553837
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0414506
	speed: 0.0634s/iter; left time: 1068.7081s
	iters: 200, epoch: 25 | loss: 0.0393909
	speed: 0.0352s/iter; left time: 589.1167s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0409429 Vali Loss: 0.0511639 Test Loss: 0.0554420
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0408931
	speed: 0.0639s/iter; left time: 1062.6643s
	iters: 200, epoch: 26 | loss: 0.0393896
	speed: 0.0353s/iter; left time: 583.0086s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0409068 Vali Loss: 0.0509211 Test Loss: 0.0554087
Validation loss decreased (0.051100 --> 0.050921).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0420896
	speed: 0.0656s/iter; left time: 1075.2783s
	iters: 200, epoch: 27 | loss: 0.0398492
	speed: 0.0352s/iter; left time: 574.5474s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0408039 Vali Loss: 0.0509325 Test Loss: 0.0554289
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0403437
	speed: 0.0642s/iter; left time: 1038.8252s
	iters: 200, epoch: 28 | loss: 0.0404508
	speed: 0.0353s/iter; left time: 567.0769s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0407987 Vali Loss: 0.0510672 Test Loss: 0.0553461
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0401933
	speed: 0.0633s/iter; left time: 1010.2558s
	iters: 200, epoch: 29 | loss: 0.0441964
	speed: 0.0352s/iter; left time: 558.4673s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0407347 Vali Loss: 0.0510270 Test Loss: 0.0553932
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0433453
	speed: 0.0641s/iter; left time: 1008.9971s
	iters: 200, epoch: 30 | loss: 0.0377617
	speed: 0.0353s/iter; left time: 552.0634s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0407489 Vali Loss: 0.0510796 Test Loss: 0.0552628
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0389959
	speed: 0.0642s/iter; left time: 995.9266s
	iters: 200, epoch: 31 | loss: 0.0391954
	speed: 0.0351s/iter; left time: 541.6240s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0406471 Vali Loss: 0.0509092 Test Loss: 0.0552722
Validation loss decreased (0.050921 --> 0.050909).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0397254
	speed: 0.0641s/iter; left time: 980.3520s
	iters: 200, epoch: 32 | loss: 0.0423798
	speed: 0.0352s/iter; left time: 535.1591s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0406437 Vali Loss: 0.0510015 Test Loss: 0.0552981
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0381529
	speed: 0.0641s/iter; left time: 965.1537s
	iters: 200, epoch: 33 | loss: 0.0393681
	speed: 0.0351s/iter; left time: 525.0032s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0405906 Vali Loss: 0.0508919 Test Loss: 0.0552640
Validation loss decreased (0.050909 --> 0.050892).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0391373
	speed: 0.0637s/iter; left time: 944.8045s
	iters: 200, epoch: 34 | loss: 0.0429796
	speed: 0.0351s/iter; left time: 517.2298s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0406271 Vali Loss: 0.0509401 Test Loss: 0.0552789
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0393175
	speed: 0.0638s/iter; left time: 932.6291s
	iters: 200, epoch: 35 | loss: 0.0452444
	speed: 0.0351s/iter; left time: 509.5387s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0405727 Vali Loss: 0.0509840 Test Loss: 0.0553096
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0396500
	speed: 0.0640s/iter; left time: 921.9813s
	iters: 200, epoch: 36 | loss: 0.0374432
	speed: 0.0347s/iter; left time: 496.5646s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0405686 Vali Loss: 0.0508993 Test Loss: 0.0552813
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0382940
	speed: 0.0635s/iter; left time: 899.3899s
	iters: 200, epoch: 37 | loss: 0.0385352
	speed: 0.0351s/iter; left time: 494.2759s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0405605 Vali Loss: 0.0508825 Test Loss: 0.0552457
Validation loss decreased (0.050892 --> 0.050883).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0443772
	speed: 0.0645s/iter; left time: 900.2980s
	iters: 200, epoch: 38 | loss: 0.0408431
	speed: 0.0351s/iter; left time: 486.4860s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0405323 Vali Loss: 0.0508869 Test Loss: 0.0552040
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0415697
	speed: 0.0640s/iter; left time: 878.8649s
	iters: 200, epoch: 39 | loss: 0.0401583
	speed: 0.0352s/iter; left time: 479.0653s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0405325 Vali Loss: 0.0508903 Test Loss: 0.0552433
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0401176
	speed: 0.0641s/iter; left time: 865.6091s
	iters: 200, epoch: 40 | loss: 0.0379751
	speed: 0.0351s/iter; left time: 471.0771s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0405105 Vali Loss: 0.0509022 Test Loss: 0.0552413
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0416584
	speed: 0.0644s/iter; left time: 855.7865s
	iters: 200, epoch: 41 | loss: 0.0421260
	speed: 0.0351s/iter; left time: 463.2635s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0404700 Vali Loss: 0.0508691 Test Loss: 0.0552322
Validation loss decreased (0.050883 --> 0.050869).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0404644
	speed: 0.0649s/iter; left time: 847.9688s
	iters: 200, epoch: 42 | loss: 0.0408125
	speed: 0.0352s/iter; left time: 456.5434s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0404701 Vali Loss: 0.0508088 Test Loss: 0.0552237
Validation loss decreased (0.050869 --> 0.050809).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0419943
	speed: 0.0644s/iter; left time: 826.1812s
	iters: 200, epoch: 43 | loss: 0.0436137
	speed: 0.0352s/iter; left time: 448.4810s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0404592 Vali Loss: 0.0509347 Test Loss: 0.0552353
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0376701
	speed: 0.0633s/iter; left time: 798.2065s
	iters: 200, epoch: 44 | loss: 0.0406414
	speed: 0.0351s/iter; left time: 439.3890s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0404487 Vali Loss: 0.0508428 Test Loss: 0.0552090
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0393764
	speed: 0.0640s/iter; left time: 792.5910s
	iters: 200, epoch: 45 | loss: 0.0365028
	speed: 0.0352s/iter; left time: 432.4115s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0404632 Vali Loss: 0.0508255 Test Loss: 0.0552031
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0385800
	speed: 0.0635s/iter; left time: 772.3172s
	iters: 200, epoch: 46 | loss: 0.0384708
	speed: 0.0351s/iter; left time: 423.7544s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0404808 Vali Loss: 0.0508547 Test Loss: 0.0552096
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0380203
	speed: 0.0649s/iter; left time: 775.6657s
	iters: 200, epoch: 47 | loss: 0.0389383
	speed: 0.0352s/iter; left time: 417.3652s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0404394 Vali Loss: 0.0508684 Test Loss: 0.0552029
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0392998
	speed: 0.0636s/iter; left time: 745.6993s
	iters: 200, epoch: 48 | loss: 0.0419598
	speed: 0.0352s/iter; left time: 408.7315s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0404412 Vali Loss: 0.0508178 Test Loss: 0.0552285
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0428239
	speed: 0.0651s/iter; left time: 748.3714s
	iters: 200, epoch: 49 | loss: 0.0397411
	speed: 0.0352s/iter; left time: 401.4446s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0404602 Vali Loss: 0.0508335 Test Loss: 0.0552242
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0395791
	speed: 0.0641s/iter; left time: 723.0227s
	iters: 200, epoch: 50 | loss: 0.0381157
	speed: 0.0351s/iter; left time: 392.5562s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0404383 Vali Loss: 0.0508597 Test Loss: 0.0552245
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0440048
	speed: 0.0636s/iter; left time: 703.3596s
	iters: 200, epoch: 51 | loss: 0.0397665
	speed: 0.0352s/iter; left time: 385.5230s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0404183 Vali Loss: 0.0508182 Test Loss: 0.0552197
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0443854
	speed: 0.0631s/iter; left time: 683.4818s
	iters: 200, epoch: 52 | loss: 0.0379273
	speed: 0.0352s/iter; left time: 377.3576s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0404342 Vali Loss: 0.0508417 Test Loss: 0.0552029
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010042295791208744, rmse:0.1002112552523613, mae:0.0552237294614315, rse:0.38661226630210876
Use GPU: cuda:0
>>>>>>>start training : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0905331
	speed: 0.0367s/iter; left time: 815.7851s
	iters: 200, epoch: 1 | loss: 0.0790937
	speed: 0.0351s/iter; left time: 776.6248s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0933416 Vali Loss: 0.0811227 Test Loss: 0.0884504
Validation loss decreased (inf --> 0.081123).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0556278
	speed: 0.0653s/iter; left time: 1435.0369s
	iters: 200, epoch: 2 | loss: 0.0504415
	speed: 0.0352s/iter; left time: 769.6834s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0557345 Vali Loss: 0.0583004 Test Loss: 0.0612372
Validation loss decreased (0.081123 --> 0.058300).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0461911
	speed: 0.0646s/iter; left time: 1404.6647s
	iters: 200, epoch: 3 | loss: 0.0472828
	speed: 0.0347s/iter; left time: 752.4354s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0487746 Vali Loss: 0.0558743 Test Loss: 0.0592142
Validation loss decreased (0.058300 --> 0.055874).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0482211
	speed: 0.0657s/iter; left time: 1414.7441s
	iters: 200, epoch: 4 | loss: 0.0449718
	speed: 0.0351s/iter; left time: 751.8464s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0470474 Vali Loss: 0.0544716 Test Loss: 0.0583089
Validation loss decreased (0.055874 --> 0.054472).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0449317
	speed: 0.0647s/iter; left time: 1379.2122s
	iters: 200, epoch: 5 | loss: 0.0439852
	speed: 0.0351s/iter; left time: 744.1151s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0458716 Vali Loss: 0.0539440 Test Loss: 0.0576853
Validation loss decreased (0.054472 --> 0.053944).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0437656
	speed: 0.0671s/iter; left time: 1415.3703s
	iters: 200, epoch: 6 | loss: 0.0466216
	speed: 0.0351s/iter; left time: 736.1274s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0449662 Vali Loss: 0.0534553 Test Loss: 0.0572674
Validation loss decreased (0.053944 --> 0.053455).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0432135
	speed: 0.0636s/iter; left time: 1326.0862s
	iters: 200, epoch: 7 | loss: 0.0448062
	speed: 0.0349s/iter; left time: 725.1061s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0443374 Vali Loss: 0.0534272 Test Loss: 0.0571053
Validation loss decreased (0.053455 --> 0.053427).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0409291
	speed: 0.0637s/iter; left time: 1315.3355s
	iters: 200, epoch: 8 | loss: 0.0430096
	speed: 0.0351s/iter; left time: 720.6558s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0437858 Vali Loss: 0.0525818 Test Loss: 0.0564486
Validation loss decreased (0.053427 --> 0.052582).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0434833
	speed: 0.0640s/iter; left time: 1307.3049s
	iters: 200, epoch: 9 | loss: 0.0431426
	speed: 0.0347s/iter; left time: 705.8230s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0433379 Vali Loss: 0.0527517 Test Loss: 0.0565157
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0436005
	speed: 0.0650s/iter; left time: 1312.1588s
	iters: 200, epoch: 10 | loss: 0.0441317
	speed: 0.0351s/iter; left time: 704.7937s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0429824 Vali Loss: 0.0525102 Test Loss: 0.0561908
Validation loss decreased (0.052582 --> 0.052510).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0441469
	speed: 0.0643s/iter; left time: 1283.2634s
	iters: 200, epoch: 11 | loss: 0.0429173
	speed: 0.0351s/iter; left time: 697.7963s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0427291 Vali Loss: 0.0522521 Test Loss: 0.0560558
Validation loss decreased (0.052510 --> 0.052252).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0414824
	speed: 0.0648s/iter; left time: 1280.0183s
	iters: 200, epoch: 12 | loss: 0.0416152
	speed: 0.0351s/iter; left time: 689.1716s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0424671 Vali Loss: 0.0520982 Test Loss: 0.0563322
Validation loss decreased (0.052252 --> 0.052098).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0391976
	speed: 0.0643s/iter; left time: 1256.3365s
	iters: 200, epoch: 13 | loss: 0.0431828
	speed: 0.0351s/iter; left time: 682.4788s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0422042 Vali Loss: 0.0521203 Test Loss: 0.0560514
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0414172
	speed: 0.0635s/iter; left time: 1226.3180s
	iters: 200, epoch: 14 | loss: 0.0436923
	speed: 0.0351s/iter; left time: 674.5539s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0420351 Vali Loss: 0.0519225 Test Loss: 0.0560759
Validation loss decreased (0.052098 --> 0.051923).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0435061
	speed: 0.0638s/iter; left time: 1216.5322s
	iters: 200, epoch: 15 | loss: 0.0421386
	speed: 0.0351s/iter; left time: 665.9012s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0418336 Vali Loss: 0.0516601 Test Loss: 0.0557258
Validation loss decreased (0.051923 --> 0.051660).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0417260
	speed: 0.0641s/iter; left time: 1208.7892s
	iters: 200, epoch: 16 | loss: 0.0413655
	speed: 0.0350s/iter; left time: 656.7397s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0416313 Vali Loss: 0.0515719 Test Loss: 0.0557763
Validation loss decreased (0.051660 --> 0.051572).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0441681
	speed: 0.0641s/iter; left time: 1195.2433s
	iters: 200, epoch: 17 | loss: 0.0442261
	speed: 0.0348s/iter; left time: 644.4656s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0415218 Vali Loss: 0.0514898 Test Loss: 0.0556714
Validation loss decreased (0.051572 --> 0.051490).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0444827
	speed: 0.0640s/iter; left time: 1178.9398s
	iters: 200, epoch: 18 | loss: 0.0387237
	speed: 0.0352s/iter; left time: 643.6995s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0414431 Vali Loss: 0.0514083 Test Loss: 0.0557639
Validation loss decreased (0.051490 --> 0.051408).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0441746
	speed: 0.0645s/iter; left time: 1173.3143s
	iters: 200, epoch: 19 | loss: 0.0418730
	speed: 0.0352s/iter; left time: 637.5505s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0412976 Vali Loss: 0.0512842 Test Loss: 0.0555965
Validation loss decreased (0.051408 --> 0.051284).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0414115
	speed: 0.0639s/iter; left time: 1147.5876s
	iters: 200, epoch: 20 | loss: 0.0421314
	speed: 0.0351s/iter; left time: 626.7732s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0411188 Vali Loss: 0.0511608 Test Loss: 0.0555696
Validation loss decreased (0.051284 --> 0.051161).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0425900
	speed: 0.0650s/iter; left time: 1153.4993s
	iters: 200, epoch: 21 | loss: 0.0420930
	speed: 0.0351s/iter; left time: 619.1400s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0410380 Vali Loss: 0.0512272 Test Loss: 0.0553351
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0425151
	speed: 0.0645s/iter; left time: 1130.6564s
	iters: 200, epoch: 22 | loss: 0.0404247
	speed: 0.0348s/iter; left time: 607.0011s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0409953 Vali Loss: 0.0513290 Test Loss: 0.0555016
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0388141
	speed: 0.0642s/iter; left time: 1111.1592s
	iters: 200, epoch: 23 | loss: 0.0456665
	speed: 0.0351s/iter; left time: 603.2395s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0409120 Vali Loss: 0.0512186 Test Loss: 0.0554686
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0415782
	speed: 0.0635s/iter; left time: 1084.5977s
	iters: 200, epoch: 24 | loss: 0.0400148
	speed: 0.0351s/iter; left time: 595.8842s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0408801 Vali Loss: 0.0510632 Test Loss: 0.0552173
Validation loss decreased (0.051161 --> 0.051063).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0390060
	speed: 0.0642s/iter; left time: 1081.8480s
	iters: 200, epoch: 25 | loss: 0.0404676
	speed: 0.0351s/iter; left time: 587.4356s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0407820 Vali Loss: 0.0510935 Test Loss: 0.0554337
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0458288
	speed: 0.0646s/iter; left time: 1074.6319s
	iters: 200, epoch: 26 | loss: 0.0387769
	speed: 0.0348s/iter; left time: 574.9532s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0407251 Vali Loss: 0.0509819 Test Loss: 0.0554200
Validation loss decreased (0.051063 --> 0.050982).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0404320
	speed: 0.0658s/iter; left time: 1078.9898s
	iters: 200, epoch: 27 | loss: 0.0413531
	speed: 0.0350s/iter; left time: 569.8413s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0407241 Vali Loss: 0.0510599 Test Loss: 0.0553351
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0404339
	speed: 0.0638s/iter; left time: 1032.9770s
	iters: 200, epoch: 28 | loss: 0.0420386
	speed: 0.0351s/iter; left time: 564.1532s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0406286 Vali Loss: 0.0510436 Test Loss: 0.0554185
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0406484
	speed: 0.0636s/iter; left time: 1015.1565s
	iters: 200, epoch: 29 | loss: 0.0422703
	speed: 0.0351s/iter; left time: 557.1565s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0405925 Vali Loss: 0.0509693 Test Loss: 0.0553177
Validation loss decreased (0.050982 --> 0.050969).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0401751
	speed: 0.0644s/iter; left time: 1013.3650s
	iters: 200, epoch: 30 | loss: 0.0380990
	speed: 0.0351s/iter; left time: 548.6465s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0405841 Vali Loss: 0.0510028 Test Loss: 0.0553068
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0398719
	speed: 0.0637s/iter; left time: 988.3468s
	iters: 200, epoch: 31 | loss: 0.0389703
	speed: 0.0351s/iter; left time: 540.3896s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0405483 Vali Loss: 0.0509729 Test Loss: 0.0552955
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0416216
	speed: 0.0632s/iter; left time: 965.4634s
	iters: 200, epoch: 32 | loss: 0.0408665
	speed: 0.0351s/iter; left time: 532.8663s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0404781 Vali Loss: 0.0509606 Test Loss: 0.0552734
Validation loss decreased (0.050969 --> 0.050961).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0401581
	speed: 0.0639s/iter; left time: 963.0300s
	iters: 200, epoch: 33 | loss: 0.0444146
	speed: 0.0351s/iter; left time: 524.9096s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0405358 Vali Loss: 0.0509348 Test Loss: 0.0552480
Validation loss decreased (0.050961 --> 0.050935).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0434580
	speed: 0.0652s/iter; left time: 967.3864s
	iters: 200, epoch: 34 | loss: 0.0450271
	speed: 0.0351s/iter; left time: 517.0633s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0404639 Vali Loss: 0.0508491 Test Loss: 0.0552922
Validation loss decreased (0.050935 --> 0.050849).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0404810
	speed: 0.0640s/iter; left time: 935.7007s
	iters: 200, epoch: 35 | loss: 0.0394439
	speed: 0.0351s/iter; left time: 509.8953s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0404808 Vali Loss: 0.0508755 Test Loss: 0.0551853
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0409779
	speed: 0.0635s/iter; left time: 914.0628s
	iters: 200, epoch: 36 | loss: 0.0380761
	speed: 0.0351s/iter; left time: 501.5655s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0404602 Vali Loss: 0.0508840 Test Loss: 0.0552284
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0408223
	speed: 0.0637s/iter; left time: 903.0386s
	iters: 200, epoch: 37 | loss: 0.0389406
	speed: 0.0351s/iter; left time: 494.1215s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0403593 Vali Loss: 0.0509414 Test Loss: 0.0552473
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0373138
	speed: 0.0636s/iter; left time: 886.9634s
	iters: 200, epoch: 38 | loss: 0.0389028
	speed: 0.0351s/iter; left time: 485.7198s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0403862 Vali Loss: 0.0509620 Test Loss: 0.0551982
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0404616
	speed: 0.0632s/iter; left time: 867.3303s
	iters: 200, epoch: 39 | loss: 0.0412011
	speed: 0.0351s/iter; left time: 478.4572s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0403805 Vali Loss: 0.0509299 Test Loss: 0.0552320
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0420976
	speed: 0.0632s/iter; left time: 853.8060s
	iters: 200, epoch: 40 | loss: 0.0417795
	speed: 0.0351s/iter; left time: 470.2884s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0403735 Vali Loss: 0.0509674 Test Loss: 0.0552053
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0420395
	speed: 0.0635s/iter; left time: 843.0458s
	iters: 200, epoch: 41 | loss: 0.0419803
	speed: 0.0351s/iter; left time: 462.7475s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0403411 Vali Loss: 0.0508990 Test Loss: 0.0551867
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0386650
	speed: 0.0631s/iter; left time: 823.5859s
	iters: 200, epoch: 42 | loss: 0.0394861
	speed: 0.0351s/iter; left time: 454.5272s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0403213 Vali Loss: 0.0509176 Test Loss: 0.0551957
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0385314
	speed: 0.0635s/iter; left time: 814.5643s
	iters: 200, epoch: 43 | loss: 0.0429035
	speed: 0.0351s/iter; left time: 447.3084s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0403033 Vali Loss: 0.0508787 Test Loss: 0.0552006
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0395700
	speed: 0.0635s/iter; left time: 800.6240s
	iters: 200, epoch: 44 | loss: 0.0420449
	speed: 0.0351s/iter; left time: 438.9876s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0403666 Vali Loss: 0.0508539 Test Loss: 0.0551681
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_24_FR_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010036074556410313, rmse:0.10018020868301392, mae:0.05529222637414932, rse:0.38649246096611023
Intermediate time for FR and pred_len 24: 00h:17m:30.88s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_512_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0945510
	speed: 0.0573s/iter; left time: 1265.8507s
	iters: 200, epoch: 1 | loss: 0.0804860
	speed: 0.0351s/iter; left time: 772.1751s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.28s
Steps: 222 | Train Loss: 0.0976736 Vali Loss: 0.0885169 Test Loss: 0.0971670
Validation loss decreased (inf --> 0.088517).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0725761
	speed: 0.0659s/iter; left time: 1440.8780s
	iters: 200, epoch: 2 | loss: 0.0638014
	speed: 0.0349s/iter; left time: 760.2592s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.95s
Steps: 222 | Train Loss: 0.0691180 Vali Loss: 0.0740624 Test Loss: 0.0824161
Validation loss decreased (0.088517 --> 0.074062).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0630231
	speed: 0.0673s/iter; left time: 1457.6326s
	iters: 200, epoch: 3 | loss: 0.0608463
	speed: 0.0349s/iter; left time: 753.0825s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.00s
Steps: 222 | Train Loss: 0.0631260 Vali Loss: 0.0725156 Test Loss: 0.0812358
Validation loss decreased (0.074062 --> 0.072516).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0594296
	speed: 0.0667s/iter; left time: 1428.9581s
	iters: 200, epoch: 4 | loss: 0.0622745
	speed: 0.0355s/iter; left time: 757.6527s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.14s
Steps: 222 | Train Loss: 0.0616088 Vali Loss: 0.0718310 Test Loss: 0.0810862
Validation loss decreased (0.072516 --> 0.071831).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0637568
	speed: 0.0682s/iter; left time: 1446.7270s
	iters: 200, epoch: 5 | loss: 0.0579425
	speed: 0.0355s/iter; left time: 748.7837s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.11s
Steps: 222 | Train Loss: 0.0605200 Vali Loss: 0.0706862 Test Loss: 0.0809231
Validation loss decreased (0.071831 --> 0.070686).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0610347
	speed: 0.0665s/iter; left time: 1395.1944s
	iters: 200, epoch: 6 | loss: 0.0598491
	speed: 0.0354s/iter; left time: 740.1274s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0597658 Vali Loss: 0.0708580 Test Loss: 0.0803957
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0572771
	speed: 0.0661s/iter; left time: 1372.9512s
	iters: 200, epoch: 7 | loss: 0.0592725
	speed: 0.0355s/iter; left time: 733.6464s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0592040 Vali Loss: 0.0703460 Test Loss: 0.0810018
Validation loss decreased (0.070686 --> 0.070346).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0603465
	speed: 0.0671s/iter; left time: 1378.0604s
	iters: 200, epoch: 8 | loss: 0.0571824
	speed: 0.0354s/iter; left time: 723.8397s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0587333 Vali Loss: 0.0699967 Test Loss: 0.0808316
Validation loss decreased (0.070346 --> 0.069997).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0587291
	speed: 0.0694s/iter; left time: 1411.4907s
	iters: 200, epoch: 9 | loss: 0.0578059
	speed: 0.0355s/iter; left time: 717.4820s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0582413 Vali Loss: 0.0700071 Test Loss: 0.0808572
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0635774
	speed: 0.0658s/iter; left time: 1322.8441s
	iters: 200, epoch: 10 | loss: 0.0593283
	speed: 0.0354s/iter; left time: 708.5351s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0578581 Vali Loss: 0.0697521 Test Loss: 0.0807573
Validation loss decreased (0.069997 --> 0.069752).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0564659
	speed: 0.0678s/iter; left time: 1348.2090s
	iters: 200, epoch: 11 | loss: 0.0573542
	speed: 0.0354s/iter; left time: 699.7048s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0575417 Vali Loss: 0.0696464 Test Loss: 0.0805303
Validation loss decreased (0.069752 --> 0.069646).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0535343
	speed: 0.0672s/iter; left time: 1321.5389s
	iters: 200, epoch: 12 | loss: 0.0554652
	speed: 0.0353s/iter; left time: 690.9524s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0572956 Vali Loss: 0.0695640 Test Loss: 0.0808186
Validation loss decreased (0.069646 --> 0.069564).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0570938
	speed: 0.0678s/iter; left time: 1317.5560s
	iters: 200, epoch: 13 | loss: 0.0562633
	speed: 0.0355s/iter; left time: 686.1084s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0569312 Vali Loss: 0.0693360 Test Loss: 0.0807541
Validation loss decreased (0.069564 --> 0.069336).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0537705
	speed: 0.0687s/iter; left time: 1320.1573s
	iters: 200, epoch: 14 | loss: 0.0578052
	speed: 0.0354s/iter; left time: 676.2771s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0566256 Vali Loss: 0.0694911 Test Loss: 0.0805661
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0587510
	speed: 0.0652s/iter; left time: 1237.5370s
	iters: 200, epoch: 15 | loss: 0.0568240
	speed: 0.0354s/iter; left time: 668.3999s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0564097 Vali Loss: 0.0691684 Test Loss: 0.0807191
Validation loss decreased (0.069336 --> 0.069168).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0599924
	speed: 0.0680s/iter; left time: 1275.8116s
	iters: 200, epoch: 16 | loss: 0.0536479
	speed: 0.0354s/iter; left time: 660.6491s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0561433 Vali Loss: 0.0693624 Test Loss: 0.0812679
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0548374
	speed: 0.0655s/iter; left time: 1214.5475s
	iters: 200, epoch: 17 | loss: 0.0567769
	speed: 0.0354s/iter; left time: 653.3286s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0559172 Vali Loss: 0.0695743 Test Loss: 0.0812910
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0608710
	speed: 0.0658s/iter; left time: 1205.4118s
	iters: 200, epoch: 18 | loss: 0.0556681
	speed: 0.0354s/iter; left time: 645.6050s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0557394 Vali Loss: 0.0695313 Test Loss: 0.0813298
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0558614
	speed: 0.0657s/iter; left time: 1189.2892s
	iters: 200, epoch: 19 | loss: 0.0570341
	speed: 0.0354s/iter; left time: 637.6695s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0555549 Vali Loss: 0.0694608 Test Loss: 0.0812635
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0582343
	speed: 0.0663s/iter; left time: 1186.0984s
	iters: 200, epoch: 20 | loss: 0.0527344
	speed: 0.0354s/iter; left time: 630.0420s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0553880 Vali Loss: 0.0695730 Test Loss: 0.0817058
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0549253
	speed: 0.0655s/iter; left time: 1156.4616s
	iters: 200, epoch: 21 | loss: 0.0572006
	speed: 0.0355s/iter; left time: 623.0103s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0552723 Vali Loss: 0.0695640 Test Loss: 0.0813932
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0524042
	speed: 0.0661s/iter; left time: 1152.6042s
	iters: 200, epoch: 22 | loss: 0.0539139
	speed: 0.0355s/iter; left time: 615.7872s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0551118 Vali Loss: 0.0697175 Test Loss: 0.0816214
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0565736
	speed: 0.0654s/iter; left time: 1125.5020s
	iters: 200, epoch: 23 | loss: 0.0502564
	speed: 0.0355s/iter; left time: 607.7470s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0549755 Vali Loss: 0.0695328 Test Loss: 0.0816044
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0571896
	speed: 0.0655s/iter; left time: 1113.1195s
	iters: 200, epoch: 24 | loss: 0.0563414
	speed: 0.0355s/iter; left time: 599.9551s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.11s
Steps: 222 | Train Loss: 0.0548804 Vali Loss: 0.0693878 Test Loss: 0.0821570
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0534910
	speed: 0.0660s/iter; left time: 1106.5047s
	iters: 200, epoch: 25 | loss: 0.0567336
	speed: 0.0354s/iter; left time: 590.1328s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.14s
Steps: 222 | Train Loss: 0.0548006 Vali Loss: 0.0694751 Test Loss: 0.0820147
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01948266476392746, rmse:0.13958030939102173, mae:0.08071916550397873, rse:0.5399338006973267
Use GPU: cuda:0
>>>>>>>start training : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0952632
	speed: 0.0373s/iter; left time: 824.5705s
	iters: 200, epoch: 1 | loss: 0.0882251
	speed: 0.0354s/iter; left time: 778.4107s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0984777 Vali Loss: 0.0887115 Test Loss: 0.0972712
Validation loss decreased (inf --> 0.088711).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0684055
	speed: 0.0682s/iter; left time: 1491.7078s
	iters: 200, epoch: 2 | loss: 0.0648619
	speed: 0.0353s/iter; left time: 769.8453s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0695240 Vali Loss: 0.0743351 Test Loss: 0.0826704
Validation loss decreased (0.088711 --> 0.074335).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0636595
	speed: 0.0668s/iter; left time: 1447.5879s
	iters: 200, epoch: 3 | loss: 0.0675047
	speed: 0.0354s/iter; left time: 762.8363s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0633260 Vali Loss: 0.0723846 Test Loss: 0.0817243
Validation loss decreased (0.074335 --> 0.072385).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0609815
	speed: 0.0665s/iter; left time: 1426.3549s
	iters: 200, epoch: 4 | loss: 0.0616805
	speed: 0.0351s/iter; left time: 748.8498s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.02s
Steps: 222 | Train Loss: 0.0616337 Vali Loss: 0.0714362 Test Loss: 0.0802713
Validation loss decreased (0.072385 --> 0.071436).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0625119
	speed: 0.0682s/iter; left time: 1447.5042s
	iters: 200, epoch: 5 | loss: 0.0612546
	speed: 0.0354s/iter; left time: 746.8153s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.10s
Steps: 222 | Train Loss: 0.0605159 Vali Loss: 0.0711307 Test Loss: 0.0806584
Validation loss decreased (0.071436 --> 0.071131).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0579954
	speed: 0.0666s/iter; left time: 1397.2714s
	iters: 200, epoch: 6 | loss: 0.0607083
	speed: 0.0354s/iter; left time: 739.7753s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0598531 Vali Loss: 0.0707090 Test Loss: 0.0807273
Validation loss decreased (0.071131 --> 0.070709).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0563586
	speed: 0.0660s/iter; left time: 1371.2620s
	iters: 200, epoch: 7 | loss: 0.0581983
	speed: 0.0354s/iter; left time: 730.9472s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0591799 Vali Loss: 0.0702574 Test Loss: 0.0805652
Validation loss decreased (0.070709 --> 0.070257).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0548895
	speed: 0.0676s/iter; left time: 1389.8110s
	iters: 200, epoch: 8 | loss: 0.0588075
	speed: 0.0354s/iter; left time: 723.1319s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0587707 Vali Loss: 0.0706747 Test Loss: 0.0802811
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0568464
	speed: 0.0654s/iter; left time: 1329.5698s
	iters: 200, epoch: 9 | loss: 0.0626500
	speed: 0.0351s/iter; left time: 709.1836s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.03s
Steps: 222 | Train Loss: 0.0583234 Vali Loss: 0.0702878 Test Loss: 0.0808060
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0558727
	speed: 0.0660s/iter; left time: 1325.8540s
	iters: 200, epoch: 10 | loss: 0.0567011
	speed: 0.0350s/iter; left time: 700.9823s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.01s
Steps: 222 | Train Loss: 0.0579293 Vali Loss: 0.0699047 Test Loss: 0.0802349
Validation loss decreased (0.070257 --> 0.069905).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0550953
	speed: 0.0667s/iter; left time: 1325.3956s
	iters: 200, epoch: 11 | loss: 0.0569662
	speed: 0.0354s/iter; left time: 699.9633s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0576132 Vali Loss: 0.0698486 Test Loss: 0.0809873
Validation loss decreased (0.069905 --> 0.069849).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0587837
	speed: 0.0693s/iter; left time: 1362.3569s
	iters: 200, epoch: 12 | loss: 0.0571281
	speed: 0.0354s/iter; left time: 692.2805s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0572527 Vali Loss: 0.0696938 Test Loss: 0.0804241
Validation loss decreased (0.069849 --> 0.069694).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0594783
	speed: 0.0664s/iter; left time: 1290.7610s
	iters: 200, epoch: 13 | loss: 0.0590962
	speed: 0.0354s/iter; left time: 684.0991s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0569948 Vali Loss: 0.0695417 Test Loss: 0.0802769
Validation loss decreased (0.069694 --> 0.069542).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0586970
	speed: 0.0691s/iter; left time: 1328.1501s
	iters: 200, epoch: 14 | loss: 0.0570726
	speed: 0.0353s/iter; left time: 674.5903s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0567403 Vali Loss: 0.0694959 Test Loss: 0.0799488
Validation loss decreased (0.069542 --> 0.069496).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0508721
	speed: 0.0674s/iter; left time: 1279.5230s
	iters: 200, epoch: 15 | loss: 0.0571368
	speed: 0.0354s/iter; left time: 669.2222s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.10s
Steps: 222 | Train Loss: 0.0564738 Vali Loss: 0.0696391 Test Loss: 0.0806447
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0578979
	speed: 0.0655s/iter; left time: 1229.7151s
	iters: 200, epoch: 16 | loss: 0.0557072
	speed: 0.0354s/iter; left time: 661.1340s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0562549 Vali Loss: 0.0693150 Test Loss: 0.0804174
Validation loss decreased (0.069496 --> 0.069315).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0562159
	speed: 0.0687s/iter; left time: 1274.4518s
	iters: 200, epoch: 17 | loss: 0.0547446
	speed: 0.0354s/iter; left time: 653.9031s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.10s
Steps: 222 | Train Loss: 0.0560603 Vali Loss: 0.0694241 Test Loss: 0.0808445
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0540287
	speed: 0.0656s/iter; left time: 1202.6489s
	iters: 200, epoch: 18 | loss: 0.0579191
	speed: 0.0354s/iter; left time: 644.7447s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0558207 Vali Loss: 0.0693042 Test Loss: 0.0811839
Validation loss decreased (0.069315 --> 0.069304).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0564311
	speed: 0.0667s/iter; left time: 1207.6176s
	iters: 200, epoch: 19 | loss: 0.0542815
	speed: 0.0354s/iter; left time: 637.6073s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0556295 Vali Loss: 0.0692249 Test Loss: 0.0809378
Validation loss decreased (0.069304 --> 0.069225).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0543697
	speed: 0.0662s/iter; left time: 1184.5198s
	iters: 200, epoch: 20 | loss: 0.0536799
	speed: 0.0355s/iter; left time: 630.5172s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.10s
Steps: 222 | Train Loss: 0.0554733 Vali Loss: 0.0693348 Test Loss: 0.0810664
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0560020
	speed: 0.0663s/iter; left time: 1170.3878s
	iters: 200, epoch: 21 | loss: 0.0537978
	speed: 0.0355s/iter; left time: 624.1564s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0553447 Vali Loss: 0.0692935 Test Loss: 0.0814518
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0574112
	speed: 0.0664s/iter; left time: 1157.2201s
	iters: 200, epoch: 22 | loss: 0.0532606
	speed: 0.0354s/iter; left time: 613.9636s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0551855 Vali Loss: 0.0692805 Test Loss: 0.0813622
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0513187
	speed: 0.0653s/iter; left time: 1124.6813s
	iters: 200, epoch: 23 | loss: 0.0571556
	speed: 0.0354s/iter; left time: 605.1963s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0550499 Vali Loss: 0.0693083 Test Loss: 0.0811403
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0542284
	speed: 0.0653s/iter; left time: 1109.8194s
	iters: 200, epoch: 24 | loss: 0.0524075
	speed: 0.0354s/iter; left time: 597.9371s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0549588 Vali Loss: 0.0693526 Test Loss: 0.0811186
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0529980
	speed: 0.0654s/iter; left time: 1096.4720s
	iters: 200, epoch: 25 | loss: 0.0608104
	speed: 0.0352s/iter; left time: 587.1956s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.05s
Steps: 222 | Train Loss: 0.0548511 Vali Loss: 0.0693528 Test Loss: 0.0813975
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0549603
	speed: 0.0659s/iter; left time: 1090.3294s
	iters: 200, epoch: 26 | loss: 0.0546359
	speed: 0.0350s/iter; left time: 575.4963s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.98s
Steps: 222 | Train Loss: 0.0547515 Vali Loss: 0.0693082 Test Loss: 0.0813971
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0566669
	speed: 0.0657s/iter; left time: 1072.5640s
	iters: 200, epoch: 27 | loss: 0.0536185
	speed: 0.0354s/iter; left time: 574.7899s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0546388 Vali Loss: 0.0692286 Test Loss: 0.0812176
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0581224
	speed: 0.0652s/iter; left time: 1050.6461s
	iters: 200, epoch: 28 | loss: 0.0531175
	speed: 0.0354s/iter; left time: 566.3134s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.06s
Steps: 222 | Train Loss: 0.0545494 Vali Loss: 0.0692481 Test Loss: 0.0811681
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0550669
	speed: 0.0660s/iter; left time: 1048.3709s
	iters: 200, epoch: 29 | loss: 0.0559058
	speed: 0.0353s/iter; left time: 557.9128s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0545274 Vali Loss: 0.0692898 Test Loss: 0.0814695
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_96_FR_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019968293607234955, rmse:0.1413092166185379, mae:0.08093781024217606, rse:0.546621561050415
Intermediate time for FR and pred_len 96: 00h:09m:21.87s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_512_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0937559
	speed: 0.0561s/iter; left time: 1239.1318s
	iters: 200, epoch: 1 | loss: 0.0854991
	speed: 0.0355s/iter; left time: 779.9372s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.28s
Steps: 222 | Train Loss: 0.0996557 Vali Loss: 0.0909250 Test Loss: 0.0982337
Validation loss decreased (inf --> 0.090925).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0671461
	speed: 0.0656s/iter; left time: 1434.8695s
	iters: 200, epoch: 2 | loss: 0.0668403
	speed: 0.0355s/iter; left time: 772.1089s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0727891 Vali Loss: 0.0776555 Test Loss: 0.0865498
Validation loss decreased (0.090925 --> 0.077656).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0663325
	speed: 0.0668s/iter; left time: 1446.0545s
	iters: 200, epoch: 3 | loss: 0.0676556
	speed: 0.0356s/iter; left time: 766.5671s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0669277 Vali Loss: 0.0760982 Test Loss: 0.0855469
Validation loss decreased (0.077656 --> 0.076098).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0676006
	speed: 0.0666s/iter; left time: 1428.5333s
	iters: 200, epoch: 4 | loss: 0.0629337
	speed: 0.0357s/iter; left time: 760.8529s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0653958 Vali Loss: 0.0748803 Test Loss: 0.0857829
Validation loss decreased (0.076098 --> 0.074880).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0611826
	speed: 0.0730s/iter; left time: 1548.7207s
	iters: 200, epoch: 5 | loss: 0.0664870
	speed: 0.0356s/iter; left time: 751.6205s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0643448 Vali Loss: 0.0745668 Test Loss: 0.0858744
Validation loss decreased (0.074880 --> 0.074567).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0614737
	speed: 0.0655s/iter; left time: 1375.5068s
	iters: 200, epoch: 6 | loss: 0.0662357
	speed: 0.0356s/iter; left time: 743.2996s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.08s
Steps: 222 | Train Loss: 0.0634906 Vali Loss: 0.0741564 Test Loss: 0.0861201
Validation loss decreased (0.074567 --> 0.074156).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0638003
	speed: 0.0705s/iter; left time: 1464.1748s
	iters: 200, epoch: 7 | loss: 0.0668866
	speed: 0.0356s/iter; left time: 735.0401s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.17s
Steps: 222 | Train Loss: 0.0628535 Vali Loss: 0.0738947 Test Loss: 0.0862584
Validation loss decreased (0.074156 --> 0.073895).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0640526
	speed: 0.0671s/iter; left time: 1378.5933s
	iters: 200, epoch: 8 | loss: 0.0602180
	speed: 0.0356s/iter; left time: 727.6014s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0623205 Vali Loss: 0.0736341 Test Loss: 0.0873836
Validation loss decreased (0.073895 --> 0.073634).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0597319
	speed: 0.0677s/iter; left time: 1375.0568s
	iters: 200, epoch: 9 | loss: 0.0623516
	speed: 0.0356s/iter; left time: 719.8003s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0617649 Vali Loss: 0.0733476 Test Loss: 0.0872618
Validation loss decreased (0.073634 --> 0.073348).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0592745
	speed: 0.0667s/iter; left time: 1340.9773s
	iters: 200, epoch: 10 | loss: 0.0611175
	speed: 0.0356s/iter; left time: 711.2114s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0613298 Vali Loss: 0.0734085 Test Loss: 0.0880000
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0628366
	speed: 0.0668s/iter; left time: 1327.6390s
	iters: 200, epoch: 11 | loss: 0.0590079
	speed: 0.0357s/iter; left time: 705.2565s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.17s
Steps: 222 | Train Loss: 0.0608626 Vali Loss: 0.0732229 Test Loss: 0.0884979
Validation loss decreased (0.073348 --> 0.073223).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0631045
	speed: 0.0685s/iter; left time: 1346.3562s
	iters: 200, epoch: 12 | loss: 0.0598766
	speed: 0.0356s/iter; left time: 696.9095s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.18s
Steps: 222 | Train Loss: 0.0604511 Vali Loss: 0.0730404 Test Loss: 0.0892168
Validation loss decreased (0.073223 --> 0.073040).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0589007
	speed: 0.0709s/iter; left time: 1377.8861s
	iters: 200, epoch: 13 | loss: 0.0626884
	speed: 0.0356s/iter; left time: 688.0990s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.17s
Steps: 222 | Train Loss: 0.0600724 Vali Loss: 0.0733249 Test Loss: 0.0880689
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0554329
	speed: 0.0646s/iter; left time: 1241.6465s
	iters: 200, epoch: 14 | loss: 0.0609844
	speed: 0.0356s/iter; left time: 680.8251s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.11s
Steps: 222 | Train Loss: 0.0597418 Vali Loss: 0.0732096 Test Loss: 0.0892474
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0584123
	speed: 0.0669s/iter; left time: 1270.9218s
	iters: 200, epoch: 15 | loss: 0.0562647
	speed: 0.0356s/iter; left time: 672.1741s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.17s
Steps: 222 | Train Loss: 0.0594256 Vali Loss: 0.0731097 Test Loss: 0.0883574
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0595126
	speed: 0.0652s/iter; left time: 1223.3511s
	iters: 200, epoch: 16 | loss: 0.0591843
	speed: 0.0356s/iter; left time: 664.5009s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0590443 Vali Loss: 0.0733004 Test Loss: 0.0884439
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0588591
	speed: 0.0654s/iter; left time: 1213.0199s
	iters: 200, epoch: 17 | loss: 0.0619928
	speed: 0.0356s/iter; left time: 656.7177s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.07s
Steps: 222 | Train Loss: 0.0588040 Vali Loss: 0.0732601 Test Loss: 0.0887275
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0623288
	speed: 0.0658s/iter; left time: 1206.2240s
	iters: 200, epoch: 18 | loss: 0.0596518
	speed: 0.0356s/iter; left time: 647.9818s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.11s
Steps: 222 | Train Loss: 0.0585427 Vali Loss: 0.0734186 Test Loss: 0.0887857
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0578743
	speed: 0.0652s/iter; left time: 1180.0319s
	iters: 200, epoch: 19 | loss: 0.0603924
	speed: 0.0356s/iter; left time: 640.3916s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.10s
Steps: 222 | Train Loss: 0.0582407 Vali Loss: 0.0731707 Test Loss: 0.0886741
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0583632
	speed: 0.0652s/iter; left time: 1166.5112s
	iters: 200, epoch: 20 | loss: 0.0561615
	speed: 0.0356s/iter; left time: 632.5779s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0580611 Vali Loss: 0.0733136 Test Loss: 0.0878214
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0573657
	speed: 0.0665s/iter; left time: 1174.8416s
	iters: 200, epoch: 21 | loss: 0.0576622
	speed: 0.0356s/iter; left time: 625.5452s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0579166 Vali Loss: 0.0733115 Test Loss: 0.0880976
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0600090
	speed: 0.0652s/iter; left time: 1137.6887s
	iters: 200, epoch: 22 | loss: 0.0580474
	speed: 0.0356s/iter; left time: 617.8492s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.09s
Steps: 222 | Train Loss: 0.0577131 Vali Loss: 0.0735373 Test Loss: 0.0889308
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.022798532620072365, rmse:0.15099182724952698, mae:0.08921678364276886, rse:0.5848056674003601
Use GPU: cuda:0
>>>>>>>start training : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0909746
	speed: 0.0377s/iter; left time: 833.2248s
	iters: 200, epoch: 1 | loss: 0.0863153
	speed: 0.0356s/iter; left time: 783.0251s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.1003204 Vali Loss: 0.0907418 Test Loss: 0.0980454
Validation loss decreased (inf --> 0.090742).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0734469
	speed: 0.0719s/iter; left time: 1572.7107s
	iters: 200, epoch: 2 | loss: 0.0706323
	speed: 0.0356s/iter; left time: 775.5673s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.14s
Steps: 222 | Train Loss: 0.0730947 Vali Loss: 0.0781138 Test Loss: 0.0861697
Validation loss decreased (0.090742 --> 0.078114).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0670260
	speed: 0.0673s/iter; left time: 1457.4871s
	iters: 200, epoch: 3 | loss: 0.0672487
	speed: 0.0356s/iter; left time: 768.4886s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0671942 Vali Loss: 0.0764739 Test Loss: 0.0861640
Validation loss decreased (0.078114 --> 0.076474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0642420
	speed: 0.0680s/iter; left time: 1458.2017s
	iters: 200, epoch: 4 | loss: 0.0681193
	speed: 0.0356s/iter; left time: 760.4954s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0656319 Vali Loss: 0.0756089 Test Loss: 0.0862310
Validation loss decreased (0.076474 --> 0.075609).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0662459
	speed: 0.0670s/iter; left time: 1420.6034s
	iters: 200, epoch: 5 | loss: 0.0619034
	speed: 0.0356s/iter; left time: 751.5106s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.14s
Steps: 222 | Train Loss: 0.0644669 Vali Loss: 0.0750021 Test Loss: 0.0863676
Validation loss decreased (0.075609 --> 0.075002).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0615688
	speed: 0.0688s/iter; left time: 1443.4137s
	iters: 200, epoch: 6 | loss: 0.0642635
	speed: 0.0356s/iter; left time: 743.5662s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0636490 Vali Loss: 0.0744124 Test Loss: 0.0862947
Validation loss decreased (0.075002 --> 0.074412).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0634491
	speed: 0.0675s/iter; left time: 1401.9660s
	iters: 200, epoch: 7 | loss: 0.0646780
	speed: 0.0356s/iter; left time: 736.2142s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0630115 Vali Loss: 0.0743968 Test Loss: 0.0861245
Validation loss decreased (0.074412 --> 0.074397).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0609125
	speed: 0.0680s/iter; left time: 1396.7771s
	iters: 200, epoch: 8 | loss: 0.0609732
	speed: 0.0356s/iter; left time: 728.8784s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0624589 Vali Loss: 0.0742223 Test Loss: 0.0872146
Validation loss decreased (0.074397 --> 0.074222).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0626477
	speed: 0.0745s/iter; left time: 1515.2203s
	iters: 200, epoch: 9 | loss: 0.0611828
	speed: 0.0355s/iter; left time: 718.5685s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0619476 Vali Loss: 0.0739779 Test Loss: 0.0874620
Validation loss decreased (0.074222 --> 0.073978).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0587265
	speed: 0.0668s/iter; left time: 1342.0950s
	iters: 200, epoch: 10 | loss: 0.0634449
	speed: 0.0357s/iter; left time: 714.7850s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0615030 Vali Loss: 0.0735479 Test Loss: 0.0874568
Validation loss decreased (0.073978 --> 0.073548).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0611382
	speed: 0.0682s/iter; left time: 1356.1429s
	iters: 200, epoch: 11 | loss: 0.0599037
	speed: 0.0356s/iter; left time: 704.3189s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0609948 Vali Loss: 0.0734347 Test Loss: 0.0872699
Validation loss decreased (0.073548 --> 0.073435).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0662991
	speed: 0.0685s/iter; left time: 1346.9227s
	iters: 200, epoch: 12 | loss: 0.0608686
	speed: 0.0357s/iter; left time: 699.0114s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.18s
Steps: 222 | Train Loss: 0.0606455 Vali Loss: 0.0734493 Test Loss: 0.0879909
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0596966
	speed: 0.0657s/iter; left time: 1276.2439s
	iters: 200, epoch: 13 | loss: 0.0599534
	speed: 0.0355s/iter; left time: 686.1990s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.11s
Steps: 222 | Train Loss: 0.0601907 Vali Loss: 0.0735516 Test Loss: 0.0877190
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0608951
	speed: 0.0657s/iter; left time: 1262.0944s
	iters: 200, epoch: 14 | loss: 0.0583582
	speed: 0.0355s/iter; left time: 678.5774s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0598597 Vali Loss: 0.0735693 Test Loss: 0.0877809
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0589544
	speed: 0.0659s/iter; left time: 1251.5029s
	iters: 200, epoch: 15 | loss: 0.0602499
	speed: 0.0356s/iter; left time: 672.9140s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0595246 Vali Loss: 0.0736768 Test Loss: 0.0872724
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0602101
	speed: 0.0656s/iter; left time: 1230.9355s
	iters: 200, epoch: 16 | loss: 0.0599441
	speed: 0.0356s/iter; left time: 664.0895s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.11s
Steps: 222 | Train Loss: 0.0592592 Vali Loss: 0.0735794 Test Loss: 0.0879726
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0604870
	speed: 0.0660s/iter; left time: 1223.9008s
	iters: 200, epoch: 17 | loss: 0.0608909
	speed: 0.0356s/iter; left time: 656.3216s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.12s
Steps: 222 | Train Loss: 0.0590200 Vali Loss: 0.0737601 Test Loss: 0.0877102
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0599590
	speed: 0.0662s/iter; left time: 1212.8331s
	iters: 200, epoch: 18 | loss: 0.0562896
	speed: 0.0356s/iter; left time: 648.8714s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.15s
Steps: 222 | Train Loss: 0.0587453 Vali Loss: 0.0735990 Test Loss: 0.0877120
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0577539
	speed: 0.0667s/iter; left time: 1207.1130s
	iters: 200, epoch: 19 | loss: 0.0615933
	speed: 0.0358s/iter; left time: 644.0271s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.18s
Steps: 222 | Train Loss: 0.0585088 Vali Loss: 0.0736174 Test Loss: 0.0875808
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0613166
	speed: 0.0662s/iter; left time: 1184.7246s
	iters: 200, epoch: 20 | loss: 0.0565838
	speed: 0.0358s/iter; left time: 636.1478s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.16s
Steps: 222 | Train Loss: 0.0583672 Vali Loss: 0.0737815 Test Loss: 0.0879796
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0569845
	speed: 0.0658s/iter; left time: 1161.7737s
	iters: 200, epoch: 21 | loss: 0.0580906
	speed: 0.0356s/iter; left time: 625.7927s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.13s
Steps: 222 | Train Loss: 0.0581812 Vali Loss: 0.0738442 Test Loss: 0.0877143
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_512_168_FR_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02144342102110386, rmse:0.1464357227087021, mae:0.08726988732814789, rse:0.5671594142913818
Intermediate time for FR and pred_len 168: 00h:07m:33.54s
Intermediate time for FR: 00h:34m:26.29s

=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1215151
	speed: 0.0584s/iter; left time: 1295.5311s
	iters: 200, epoch: 1 | loss: 0.1118875
	speed: 0.0348s/iter; left time: 769.0270s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.18s
Steps: 223 | Train Loss: 0.1326542 Vali Loss: 0.0942807 Test Loss: 0.0955525
Validation loss decreased (inf --> 0.094281).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0692392
	speed: 0.0640s/iter; left time: 1406.0753s
	iters: 200, epoch: 2 | loss: 0.0668463
	speed: 0.0348s/iter; left time: 762.1024s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0759663 Vali Loss: 0.0627304 Test Loss: 0.0655534
Validation loss decreased (0.094281 --> 0.062730).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0653248
	speed: 0.0646s/iter; left time: 1406.0183s
	iters: 200, epoch: 3 | loss: 0.0658268
	speed: 0.0348s/iter; left time: 753.7266s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0649989 Vali Loss: 0.0598344 Test Loss: 0.0623941
Validation loss decreased (0.062730 --> 0.059834).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0612408
	speed: 0.0640s/iter; left time: 1378.4370s
	iters: 200, epoch: 4 | loss: 0.0641704
	speed: 0.0348s/iter; left time: 745.5568s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0622214 Vali Loss: 0.0590931 Test Loss: 0.0612764
Validation loss decreased (0.059834 --> 0.059093).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0578229
	speed: 0.0643s/iter; left time: 1371.0302s
	iters: 200, epoch: 5 | loss: 0.0619481
	speed: 0.0348s/iter; left time: 737.6335s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0607123 Vali Loss: 0.0585121 Test Loss: 0.0608895
Validation loss decreased (0.059093 --> 0.058512).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0601596
	speed: 0.0650s/iter; left time: 1370.2385s
	iters: 200, epoch: 6 | loss: 0.0582513
	speed: 0.0348s/iter; left time: 729.2786s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.92s
Steps: 223 | Train Loss: 0.0596344 Vali Loss: 0.0577123 Test Loss: 0.0601836
Validation loss decreased (0.058512 --> 0.057712).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0607782
	speed: 0.0649s/iter; left time: 1354.3299s
	iters: 200, epoch: 7 | loss: 0.0582576
	speed: 0.0348s/iter; left time: 721.7461s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0587942 Vali Loss: 0.0578430 Test Loss: 0.0603699
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0568957
	speed: 0.0643s/iter; left time: 1327.7018s
	iters: 200, epoch: 8 | loss: 0.0612838
	speed: 0.0352s/iter; left time: 723.0010s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0581849 Vali Loss: 0.0571036 Test Loss: 0.0594110
Validation loss decreased (0.057712 --> 0.057104).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0551574
	speed: 0.0660s/iter; left time: 1348.0732s
	iters: 200, epoch: 9 | loss: 0.0544234
	speed: 0.0351s/iter; left time: 713.2597s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0575606 Vali Loss: 0.0566828 Test Loss: 0.0591373
Validation loss decreased (0.057104 --> 0.056683).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0561724
	speed: 0.0651s/iter; left time: 1315.1278s
	iters: 200, epoch: 10 | loss: 0.0550264
	speed: 0.0348s/iter; left time: 698.7869s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0571180 Vali Loss: 0.0566658 Test Loss: 0.0590203
Validation loss decreased (0.056683 --> 0.056666).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0558567
	speed: 0.0644s/iter; left time: 1286.5022s
	iters: 200, epoch: 11 | loss: 0.0551412
	speed: 0.0348s/iter; left time: 691.5830s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0566924 Vali Loss: 0.0562612 Test Loss: 0.0588131
Validation loss decreased (0.056666 --> 0.056261).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0582320
	speed: 0.0649s/iter; left time: 1281.9793s
	iters: 200, epoch: 12 | loss: 0.0552496
	speed: 0.0348s/iter; left time: 683.0005s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0563733 Vali Loss: 0.0559708 Test Loss: 0.0585530
Validation loss decreased (0.056261 --> 0.055971).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0537563
	speed: 0.0642s/iter; left time: 1253.5717s
	iters: 200, epoch: 13 | loss: 0.0591910
	speed: 0.0351s/iter; left time: 681.2254s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0560258 Vali Loss: 0.0559113 Test Loss: 0.0584941
Validation loss decreased (0.055971 --> 0.055911).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0578019
	speed: 0.0661s/iter; left time: 1276.2238s
	iters: 200, epoch: 14 | loss: 0.0537843
	speed: 0.0352s/iter; left time: 675.4033s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.0557317 Vali Loss: 0.0559744 Test Loss: 0.0587135
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0582544
	speed: 0.0650s/iter; left time: 1239.8983s
	iters: 200, epoch: 15 | loss: 0.0575671
	speed: 0.0351s/iter; left time: 666.0778s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0555913 Vali Loss: 0.0556698 Test Loss: 0.0585108
Validation loss decreased (0.055911 --> 0.055670).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0573789
	speed: 0.0660s/iter; left time: 1244.6433s
	iters: 200, epoch: 16 | loss: 0.0597599
	speed: 0.0350s/iter; left time: 656.5658s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0553490 Vali Loss: 0.0555906 Test Loss: 0.0583118
Validation loss decreased (0.055670 --> 0.055591).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0530117
	speed: 0.0641s/iter; left time: 1193.9584s
	iters: 200, epoch: 17 | loss: 0.0540745
	speed: 0.0348s/iter; left time: 645.4656s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0551468 Vali Loss: 0.0554781 Test Loss: 0.0580857
Validation loss decreased (0.055591 --> 0.055478).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0579623
	speed: 0.0633s/iter; left time: 1164.9885s
	iters: 200, epoch: 18 | loss: 0.0557412
	speed: 0.0348s/iter; left time: 636.3688s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0549865 Vali Loss: 0.0554452 Test Loss: 0.0580464
Validation loss decreased (0.055478 --> 0.055445).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0522057
	speed: 0.0661s/iter; left time: 1202.7089s
	iters: 200, epoch: 19 | loss: 0.0545580
	speed: 0.0351s/iter; left time: 635.1107s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0548027 Vali Loss: 0.0552358 Test Loss: 0.0578113
Validation loss decreased (0.055445 --> 0.055236).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0529114
	speed: 0.0657s/iter; left time: 1179.4980s
	iters: 200, epoch: 20 | loss: 0.0570487
	speed: 0.0351s/iter; left time: 626.4004s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0545887 Vali Loss: 0.0552181 Test Loss: 0.0577855
Validation loss decreased (0.055236 --> 0.055218).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0552240
	speed: 0.0650s/iter; left time: 1153.0202s
	iters: 200, epoch: 21 | loss: 0.0546114
	speed: 0.0348s/iter; left time: 613.6776s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0544541 Vali Loss: 0.0550816 Test Loss: 0.0578460
Validation loss decreased (0.055218 --> 0.055082).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0533617
	speed: 0.0654s/iter; left time: 1144.9189s
	iters: 200, epoch: 22 | loss: 0.0563828
	speed: 0.0351s/iter; left time: 611.0490s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0543534 Vali Loss: 0.0550777 Test Loss: 0.0576476
Validation loss decreased (0.055082 --> 0.055078).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0511991
	speed: 0.0668s/iter; left time: 1155.7207s
	iters: 200, epoch: 23 | loss: 0.0566833
	speed: 0.0349s/iter; left time: 600.2897s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0543686 Vali Loss: 0.0550093 Test Loss: 0.0577616
Validation loss decreased (0.055078 --> 0.055009).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0561067
	speed: 0.0661s/iter; left time: 1127.7561s
	iters: 200, epoch: 24 | loss: 0.0524344
	speed: 0.0349s/iter; left time: 592.3339s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0541953 Vali Loss: 0.0550054 Test Loss: 0.0576725
Validation loss decreased (0.055009 --> 0.055005).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0548554
	speed: 0.0659s/iter; left time: 1110.4297s
	iters: 200, epoch: 25 | loss: 0.0545839
	speed: 0.0352s/iter; left time: 589.4171s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0541028 Vali Loss: 0.0548294 Test Loss: 0.0576062
Validation loss decreased (0.055005 --> 0.054829).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0537943
	speed: 0.0659s/iter; left time: 1095.5692s
	iters: 200, epoch: 26 | loss: 0.0544039
	speed: 0.0352s/iter; left time: 580.9742s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0540807 Vali Loss: 0.0549287 Test Loss: 0.0575237
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0516824
	speed: 0.0648s/iter; left time: 1062.6808s
	iters: 200, epoch: 27 | loss: 0.0538087
	speed: 0.0350s/iter; left time: 571.1328s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0540239 Vali Loss: 0.0549428 Test Loss: 0.0576405
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0550418
	speed: 0.0649s/iter; left time: 1049.2804s
	iters: 200, epoch: 28 | loss: 0.0557069
	speed: 0.0352s/iter; left time: 565.4626s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0539656 Vali Loss: 0.0549259 Test Loss: 0.0575492
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0525850
	speed: 0.0658s/iter; left time: 1050.3386s
	iters: 200, epoch: 29 | loss: 0.0557783
	speed: 0.0351s/iter; left time: 556.9219s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.0538052 Vali Loss: 0.0548689 Test Loss: 0.0575678
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0511998
	speed: 0.0653s/iter; left time: 1027.5420s
	iters: 200, epoch: 30 | loss: 0.0484094
	speed: 0.0351s/iter; left time: 548.4659s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0538262 Vali Loss: 0.0548523 Test Loss: 0.0574607
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0547087
	speed: 0.0654s/iter; left time: 1014.9761s
	iters: 200, epoch: 31 | loss: 0.0517584
	speed: 0.0351s/iter; left time: 541.0095s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0537514 Vali Loss: 0.0547773 Test Loss: 0.0574989
Validation loss decreased (0.054829 --> 0.054777).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0566123
	speed: 0.0666s/iter; left time: 1018.2078s
	iters: 200, epoch: 32 | loss: 0.0561727
	speed: 0.0351s/iter; left time: 532.7224s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0537302 Vali Loss: 0.0546972 Test Loss: 0.0574458
Validation loss decreased (0.054777 --> 0.054697).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0504116
	speed: 0.0664s/iter; left time: 999.7059s
	iters: 200, epoch: 33 | loss: 0.0543427
	speed: 0.0351s/iter; left time: 524.7735s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0537074 Vali Loss: 0.0547021 Test Loss: 0.0574178
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0528668
	speed: 0.0650s/iter; left time: 965.4444s
	iters: 200, epoch: 34 | loss: 0.0530927
	speed: 0.0352s/iter; left time: 518.6036s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0536574 Vali Loss: 0.0547484 Test Loss: 0.0575011
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0500943
	speed: 0.0648s/iter; left time: 947.6750s
	iters: 200, epoch: 35 | loss: 0.0544246
	speed: 0.0351s/iter; left time: 509.7995s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0536428 Vali Loss: 0.0547106 Test Loss: 0.0574473
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0533398
	speed: 0.0647s/iter; left time: 930.9460s
	iters: 200, epoch: 36 | loss: 0.0516305
	speed: 0.0351s/iter; left time: 502.2065s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0535983 Vali Loss: 0.0547135 Test Loss: 0.0573656
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0511870
	speed: 0.0644s/iter; left time: 912.4765s
	iters: 200, epoch: 37 | loss: 0.0523624
	speed: 0.0352s/iter; left time: 494.9946s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0535729 Vali Loss: 0.0547284 Test Loss: 0.0574137
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0543733
	speed: 0.0647s/iter; left time: 902.9269s
	iters: 200, epoch: 38 | loss: 0.0522128
	speed: 0.0351s/iter; left time: 486.0404s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0535330 Vali Loss: 0.0547177 Test Loss: 0.0574156
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0500885
	speed: 0.0655s/iter; left time: 899.1704s
	iters: 200, epoch: 39 | loss: 0.0544045
	speed: 0.0351s/iter; left time: 478.4573s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0535079 Vali Loss: 0.0546792 Test Loss: 0.0574100
Validation loss decreased (0.054697 --> 0.054679).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0556632
	speed: 0.0670s/iter; left time: 905.3214s
	iters: 200, epoch: 40 | loss: 0.0608936
	speed: 0.0350s/iter; left time: 468.5972s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0534729 Vali Loss: 0.0546630 Test Loss: 0.0573546
Validation loss decreased (0.054679 --> 0.054663).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0530188
	speed: 0.0659s/iter; left time: 875.4849s
	iters: 200, epoch: 41 | loss: 0.0543008
	speed: 0.0348s/iter; left time: 458.9693s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0534663 Vali Loss: 0.0546640 Test Loss: 0.0574067
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0527376
	speed: 0.0639s/iter; left time: 834.7783s
	iters: 200, epoch: 42 | loss: 0.0504257
	speed: 0.0349s/iter; left time: 452.1200s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0535045 Vali Loss: 0.0546867 Test Loss: 0.0574020
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0528321
	speed: 0.0641s/iter; left time: 823.0251s
	iters: 200, epoch: 43 | loss: 0.0554217
	speed: 0.0348s/iter; left time: 442.6665s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0534852 Vali Loss: 0.0545953 Test Loss: 0.0573738
Validation loss decreased (0.054663 --> 0.054595).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0516735
	speed: 0.0659s/iter; left time: 830.8775s
	iters: 200, epoch: 44 | loss: 0.0480767
	speed: 0.0353s/iter; left time: 442.2049s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0534319 Vali Loss: 0.0546308 Test Loss: 0.0573753
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0563546
	speed: 0.0649s/iter; left time: 803.6160s
	iters: 200, epoch: 45 | loss: 0.0553964
	speed: 0.0351s/iter; left time: 431.1377s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0534774 Vali Loss: 0.0546294 Test Loss: 0.0573575
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0543456
	speed: 0.0647s/iter; left time: 787.1173s
	iters: 200, epoch: 46 | loss: 0.0519089
	speed: 0.0351s/iter; left time: 423.3499s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0534381 Vali Loss: 0.0546489 Test Loss: 0.0573632
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0561337
	speed: 0.0652s/iter; left time: 778.7757s
	iters: 200, epoch: 47 | loss: 0.0566098
	speed: 0.0351s/iter; left time: 415.3954s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0534364 Vali Loss: 0.0546397 Test Loss: 0.0573571
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0528050
	speed: 0.0650s/iter; left time: 762.2341s
	iters: 200, epoch: 48 | loss: 0.0533476
	speed: 0.0351s/iter; left time: 408.1999s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0533972 Vali Loss: 0.0546512 Test Loss: 0.0573457
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0541846
	speed: 0.0641s/iter; left time: 737.5301s
	iters: 200, epoch: 49 | loss: 0.0543380
	speed: 0.0352s/iter; left time: 401.2934s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0534589 Vali Loss: 0.0546227 Test Loss: 0.0573440
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0543175
	speed: 0.0655s/iter; left time: 738.5563s
	iters: 200, epoch: 50 | loss: 0.0555421
	speed: 0.0351s/iter; left time: 392.6373s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533554 Vali Loss: 0.0546184 Test Loss: 0.0573636
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0542763
	speed: 0.0648s/iter; left time: 716.4132s
	iters: 200, epoch: 51 | loss: 0.0507013
	speed: 0.0352s/iter; left time: 385.6910s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0534446 Vali Loss: 0.0546714 Test Loss: 0.0573693
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0516548
	speed: 0.0655s/iter; left time: 709.0504s
	iters: 200, epoch: 52 | loss: 0.0511236
	speed: 0.0347s/iter; left time: 372.3737s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0534571 Vali Loss: 0.0545920 Test Loss: 0.0573518
Validation loss decreased (0.054595 --> 0.054592).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0531069
	speed: 0.0663s/iter; left time: 703.3966s
	iters: 200, epoch: 53 | loss: 0.0519074
	speed: 0.0352s/iter; left time: 369.6296s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533825 Vali Loss: 0.0546071 Test Loss: 0.0573369
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0534862
	speed: 0.0651s/iter; left time: 676.2541s
	iters: 200, epoch: 54 | loss: 0.0492625
	speed: 0.0351s/iter; left time: 361.0340s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533829 Vali Loss: 0.0546410 Test Loss: 0.0573390
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0580978
	speed: 0.0652s/iter; left time: 661.9629s
	iters: 200, epoch: 55 | loss: 0.0531033
	speed: 0.0351s/iter; left time: 353.1081s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533624 Vali Loss: 0.0546159 Test Loss: 0.0573383
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0576224
	speed: 0.0651s/iter; left time: 647.1622s
	iters: 200, epoch: 56 | loss: 0.0542574
	speed: 0.0352s/iter; left time: 346.2737s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0534060 Vali Loss: 0.0545954 Test Loss: 0.0573395
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0483128
	speed: 0.0654s/iter; left time: 635.4040s
	iters: 200, epoch: 57 | loss: 0.0510019
	speed: 0.0352s/iter; left time: 338.4549s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0534189 Vali Loss: 0.0545630 Test Loss: 0.0573416
Validation loss decreased (0.054592 --> 0.054563).  Saving model ...
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0566853
	speed: 0.0660s/iter; left time: 626.3256s
	iters: 200, epoch: 58 | loss: 0.0580699
	speed: 0.0351s/iter; left time: 329.7990s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533494 Vali Loss: 0.0546348 Test Loss: 0.0573394
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0527851
	speed: 0.0652s/iter; left time: 604.6087s
	iters: 200, epoch: 59 | loss: 0.0541783
	speed: 0.0352s/iter; left time: 322.7887s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0533600 Vali Loss: 0.0546001 Test Loss: 0.0573527
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0554900
	speed: 0.0650s/iter; left time: 587.4264s
	iters: 200, epoch: 60 | loss: 0.0530581
	speed: 0.0353s/iter; left time: 315.3222s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0533252 Vali Loss: 0.0545773 Test Loss: 0.0573337
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0569755
	speed: 0.0648s/iter; left time: 571.7519s
	iters: 200, epoch: 61 | loss: 0.0525112
	speed: 0.0351s/iter; left time: 306.2058s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0533005 Vali Loss: 0.0545922 Test Loss: 0.0573551
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0562148
	speed: 0.0655s/iter; left time: 563.0432s
	iters: 200, epoch: 62 | loss: 0.0510816
	speed: 0.0353s/iter; left time: 299.6897s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0533370 Vali Loss: 0.0546487 Test Loss: 0.0573723
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0574854
	speed: 0.0650s/iter; left time: 544.0078s
	iters: 200, epoch: 63 | loss: 0.0529368
	speed: 0.0351s/iter; left time: 290.4616s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0533335 Vali Loss: 0.0545922 Test Loss: 0.0573501
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0557035
	speed: 0.0655s/iter; left time: 534.1520s
	iters: 200, epoch: 64 | loss: 0.0525432
	speed: 0.0351s/iter; left time: 282.6569s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0533528 Vali Loss: 0.0545735 Test Loss: 0.0573364
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0546455
	speed: 0.0654s/iter; left time: 518.4721s
	iters: 200, epoch: 65 | loss: 0.0553183
	speed: 0.0353s/iter; left time: 276.0343s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0533852 Vali Loss: 0.0546433 Test Loss: 0.0573452
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0561917
	speed: 0.0655s/iter; left time: 504.8543s
	iters: 200, epoch: 66 | loss: 0.0568168
	speed: 0.0352s/iter; left time: 268.0854s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0533577 Vali Loss: 0.0545441 Test Loss: 0.0573378
Validation loss decreased (0.054563 --> 0.054544).  Saving model ...
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0525508
	speed: 0.0675s/iter; left time: 505.2784s
	iters: 200, epoch: 67 | loss: 0.0557896
	speed: 0.0351s/iter; left time: 259.4303s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0533420 Vali Loss: 0.0545776 Test Loss: 0.0573440
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0541739
	speed: 0.0664s/iter; left time: 481.9078s
	iters: 200, epoch: 68 | loss: 0.0537945
	speed: 0.0351s/iter; left time: 251.3756s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0534072 Vali Loss: 0.0545726 Test Loss: 0.0573432
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0530109
	speed: 0.0647s/iter; left time: 455.3412s
	iters: 200, epoch: 69 | loss: 0.0540929
	speed: 0.0351s/iter; left time: 243.4502s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0533449 Vali Loss: 0.0545826 Test Loss: 0.0573481
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0518707
	speed: 0.0642s/iter; left time: 437.7741s
	iters: 200, epoch: 70 | loss: 0.0542034
	speed: 0.0351s/iter; left time: 235.6245s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0533946 Vali Loss: 0.0546405 Test Loss: 0.0573622
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.595044557171442e-08
	iters: 100, epoch: 71 | loss: 0.0554011
	speed: 0.0645s/iter; left time: 425.0080s
	iters: 200, epoch: 71 | loss: 0.0511646
	speed: 0.0348s/iter; left time: 225.7336s
-------------------------------------------------------------------------------------
Epoch: 71
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0533162 Vali Loss: 0.0545336 Test Loss: 0.0573344
Validation loss decreased (0.054544 --> 0.054534).  Saving model ...
Updating learning rate to 7.735540101454298e-08
	iters: 100, epoch: 72 | loss: 0.0530440
	speed: 0.0666s/iter; left time: 423.8380s
	iters: 200, epoch: 72 | loss: 0.0569498
	speed: 0.0352s/iter; left time: 220.4036s
-------------------------------------------------------------------------------------
Epoch: 72
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0533984 Vali Loss: 0.0546323 Test Loss: 0.0573371
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.961986091308869e-08
	iters: 100, epoch: 73 | loss: 0.0569372
	speed: 0.0652s/iter; left time: 400.6707s
	iters: 200, epoch: 73 | loss: 0.0584623
	speed: 0.0353s/iter; left time: 213.6070s
-------------------------------------------------------------------------------------
Epoch: 73
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533600 Vali Loss: 0.0546291 Test Loss: 0.0573471
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.265787482177981e-08
	iters: 100, epoch: 74 | loss: 0.0547817
	speed: 0.0651s/iter; left time: 385.7203s
	iters: 200, epoch: 74 | loss: 0.0493505
	speed: 0.0351s/iter; left time: 204.2869s
-------------------------------------------------------------------------------------
Epoch: 74
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0533033 Vali Loss: 0.0546224 Test Loss: 0.0573429
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.639208733960184e-08
	iters: 100, epoch: 75 | loss: 0.0493547
	speed: 0.0652s/iter; left time: 371.6734s
	iters: 200, epoch: 75 | loss: 0.0555176
	speed: 0.0351s/iter; left time: 196.4331s
-------------------------------------------------------------------------------------
Epoch: 75
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533029 Vali Loss: 0.0546485 Test Loss: 0.0573412
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.075287860564165e-08
	iters: 100, epoch: 76 | loss: 0.0529091
	speed: 0.0652s/iter; left time: 356.8269s
	iters: 200, epoch: 76 | loss: 0.0509300
	speed: 0.0351s/iter; left time: 188.5033s
-------------------------------------------------------------------------------------
Epoch: 76
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0533624 Vali Loss: 0.0545650 Test Loss: 0.0573443
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.567759074507749e-08
	iters: 100, epoch: 77 | loss: 0.0607637
	speed: 0.0649s/iter; left time: 340.9881s
	iters: 200, epoch: 77 | loss: 0.0514726
	speed: 0.0348s/iter; left time: 179.0782s
-------------------------------------------------------------------------------------
Epoch: 77
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0534102 Vali Loss: 0.0546305 Test Loss: 0.0573268
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.1109831670569744e-08
	iters: 100, epoch: 78 | loss: 0.0570907
	speed: 0.0650s/iter; left time: 327.1195s
	iters: 200, epoch: 78 | loss: 0.0551430
	speed: 0.0348s/iter; left time: 171.3208s
-------------------------------------------------------------------------------------
Epoch: 78
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0533672 Vali Loss: 0.0546221 Test Loss: 0.0573372
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.6998848503512764e-08
	iters: 100, epoch: 79 | loss: 0.0489359
	speed: 0.0640s/iter; left time: 307.8709s
	iters: 200, epoch: 79 | loss: 0.0488577
	speed: 0.0351s/iter; left time: 165.0276s
-------------------------------------------------------------------------------------
Epoch: 79
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0533639 Vali Loss: 0.0546596 Test Loss: 0.0573285
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.3298963653161496e-08
	iters: 100, epoch: 80 | loss: 0.0496042
	speed: 0.0650s/iter; left time: 298.0569s
	iters: 200, epoch: 80 | loss: 0.0566325
	speed: 0.0352s/iter; left time: 157.9521s
-------------------------------------------------------------------------------------
Epoch: 80
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0533528 Vali Loss: 0.0546019 Test Loss: 0.0573275
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.996906728784534e-08
	iters: 100, epoch: 81 | loss: 0.0518748
	speed: 0.0649s/iter; left time: 282.9662s
	iters: 200, epoch: 81 | loss: 0.0521037
	speed: 0.0351s/iter; left time: 149.5322s
-------------------------------------------------------------------------------------
Epoch: 81
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0533605 Vali Loss: 0.0546087 Test Loss: 0.0573167
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010125267319381237, rmse:0.10062438994646072, mae:0.05733437091112137, rse:0.3802099823951721
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1236653
	speed: 0.0376s/iter; left time: 834.0754s
	iters: 200, epoch: 1 | loss: 0.1085836
	speed: 0.0351s/iter; left time: 775.6518s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.1340056 Vali Loss: 0.0942551 Test Loss: 0.0959092
Validation loss decreased (inf --> 0.094255).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0773130
	speed: 0.0653s/iter; left time: 1434.5734s
	iters: 200, epoch: 2 | loss: 0.0673379
	speed: 0.0353s/iter; left time: 771.3940s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0760516 Vali Loss: 0.0626796 Test Loss: 0.0656753
Validation loss decreased (0.094255 --> 0.062680).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0674818
	speed: 0.0682s/iter; left time: 1484.1721s
	iters: 200, epoch: 3 | loss: 0.0624525
	speed: 0.0353s/iter; left time: 764.3250s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.0652883 Vali Loss: 0.0601960 Test Loss: 0.0628172
Validation loss decreased (0.062680 --> 0.060196).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0614427
	speed: 0.0671s/iter; left time: 1445.3883s
	iters: 200, epoch: 4 | loss: 0.0611415
	speed: 0.0350s/iter; left time: 749.2455s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0625278 Vali Loss: 0.0590170 Test Loss: 0.0610467
Validation loss decreased (0.060196 --> 0.059017).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0621039
	speed: 0.0661s/iter; left time: 1409.5724s
	iters: 200, epoch: 5 | loss: 0.0640478
	speed: 0.0352s/iter; left time: 746.5340s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0608943 Vali Loss: 0.0580759 Test Loss: 0.0605287
Validation loss decreased (0.059017 --> 0.058076).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0599137
	speed: 0.0658s/iter; left time: 1387.6109s
	iters: 200, epoch: 6 | loss: 0.0580266
	speed: 0.0351s/iter; left time: 735.6432s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0598067 Vali Loss: 0.0580089 Test Loss: 0.0606433
Validation loss decreased (0.058076 --> 0.058009).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590672
	speed: 0.0658s/iter; left time: 1372.6480s
	iters: 200, epoch: 7 | loss: 0.0552828
	speed: 0.0347s/iter; left time: 719.7498s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0587435 Vali Loss: 0.0578174 Test Loss: 0.0599102
Validation loss decreased (0.058009 --> 0.057817).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0599756
	speed: 0.0685s/iter; left time: 1414.0659s
	iters: 200, epoch: 8 | loss: 0.0566922
	speed: 0.0351s/iter; left time: 720.6395s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0582020 Vali Loss: 0.0570890 Test Loss: 0.0592180
Validation loss decreased (0.057817 --> 0.057089).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0565534
	speed: 0.0684s/iter; left time: 1397.4800s
	iters: 200, epoch: 9 | loss: 0.0553257
	speed: 0.0513s/iter; left time: 1041.2939s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.21s
Steps: 223 | Train Loss: 0.0576028 Vali Loss: 0.0568853 Test Loss: 0.0593272
Validation loss decreased (0.057089 --> 0.056885).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0572889
	speed: 0.1087s/iter; left time: 2194.5938s
	iters: 200, epoch: 10 | loss: 0.0606292
	speed: 0.0475s/iter; left time: 954.1469s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.99s
Steps: 223 | Train Loss: 0.0571892 Vali Loss: 0.0565961 Test Loss: 0.0590728
Validation loss decreased (0.056885 --> 0.056596).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0582079
	speed: 0.0726s/iter; left time: 1450.6256s
	iters: 200, epoch: 11 | loss: 0.0550425
	speed: 0.0347s/iter; left time: 689.4622s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0567719 Vali Loss: 0.0565161 Test Loss: 0.0591691
Validation loss decreased (0.056596 --> 0.056516).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0565605
	speed: 0.0672s/iter; left time: 1326.7966s
	iters: 200, epoch: 12 | loss: 0.0558233
	speed: 0.0427s/iter; left time: 838.2186s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.80s
Steps: 223 | Train Loss: 0.0563979 Vali Loss: 0.0561776 Test Loss: 0.0585629
Validation loss decreased (0.056516 --> 0.056178).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0540284
	speed: 0.0687s/iter; left time: 1341.6880s
	iters: 200, epoch: 13 | loss: 0.0555557
	speed: 0.0356s/iter; left time: 691.5903s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.0560746 Vali Loss: 0.0561454 Test Loss: 0.0584856
Validation loss decreased (0.056178 --> 0.056145).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0542161
	speed: 0.0706s/iter; left time: 1363.3169s
	iters: 200, epoch: 14 | loss: 0.0567283
	speed: 0.0349s/iter; left time: 670.6036s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0558765 Vali Loss: 0.0556245 Test Loss: 0.0582671
Validation loss decreased (0.056145 --> 0.055624).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0516504
	speed: 0.0770s/iter; left time: 1468.6501s
	iters: 200, epoch: 15 | loss: 0.0539961
	speed: 0.0351s/iter; left time: 665.5575s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.93s
Steps: 223 | Train Loss: 0.0555634 Vali Loss: 0.0556393 Test Loss: 0.0580658
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0541912
	speed: 0.0656s/iter; left time: 1236.3415s
	iters: 200, epoch: 16 | loss: 0.0579656
	speed: 0.0348s/iter; left time: 651.8585s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0554230 Vali Loss: 0.0556770 Test Loss: 0.0582363
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0512342
	speed: 0.0647s/iter; left time: 1206.3463s
	iters: 200, epoch: 17 | loss: 0.0564994
	speed: 0.0347s/iter; left time: 642.4061s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0551551 Vali Loss: 0.0556197 Test Loss: 0.0580029
Validation loss decreased (0.055624 --> 0.055620).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0525832
	speed: 0.0646s/iter; left time: 1188.7275s
	iters: 200, epoch: 18 | loss: 0.0526098
	speed: 0.0347s/iter; left time: 634.8945s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0549796 Vali Loss: 0.0554065 Test Loss: 0.0579263
Validation loss decreased (0.055620 --> 0.055407).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0523012
	speed: 0.0648s/iter; left time: 1178.7482s
	iters: 200, epoch: 19 | loss: 0.0539355
	speed: 0.0347s/iter; left time: 627.3474s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0548759 Vali Loss: 0.0553395 Test Loss: 0.0578735
Validation loss decreased (0.055407 --> 0.055340).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0545199
	speed: 0.0663s/iter; left time: 1191.7170s
	iters: 200, epoch: 20 | loss: 0.0550749
	speed: 0.0347s/iter; left time: 620.1812s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0546577 Vali Loss: 0.0552465 Test Loss: 0.0578412
Validation loss decreased (0.055340 --> 0.055246).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0550329
	speed: 0.0666s/iter; left time: 1181.2350s
	iters: 200, epoch: 21 | loss: 0.0578060
	speed: 0.0353s/iter; left time: 622.1719s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0545746 Vali Loss: 0.0553627 Test Loss: 0.0578596
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0537746
	speed: 0.0686s/iter; left time: 1202.3220s
	iters: 200, epoch: 22 | loss: 0.0538387
	speed: 0.0360s/iter; left time: 627.2196s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0545020 Vali Loss: 0.0551188 Test Loss: 0.0577297
Validation loss decreased (0.055246 --> 0.055119).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0544303
	speed: 0.1279s/iter; left time: 2211.8278s
	iters: 200, epoch: 23 | loss: 0.0528518
	speed: 0.0740s/iter; left time: 1271.7706s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:15.95s
Steps: 223 | Train Loss: 0.0543437 Vali Loss: 0.0548906 Test Loss: 0.0576726
Validation loss decreased (0.055119 --> 0.054891).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0523297
	speed: 0.1661s/iter; left time: 2835.7849s
	iters: 200, epoch: 24 | loss: 0.0491816
	speed: 0.0741s/iter; left time: 1257.3326s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:16.93s
Steps: 223 | Train Loss: 0.0542616 Vali Loss: 0.0550434 Test Loss: 0.0577392
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0573380
	speed: 0.1635s/iter; left time: 2755.0971s
	iters: 200, epoch: 25 | loss: 0.0550361
	speed: 0.0731s/iter; left time: 1224.8128s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:16.70s
Steps: 223 | Train Loss: 0.0541424 Vali Loss: 0.0550252 Test Loss: 0.0575210
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0571581
	speed: 0.1663s/iter; left time: 2765.1225s
	iters: 200, epoch: 26 | loss: 0.0503851
	speed: 0.0724s/iter; left time: 1196.6718s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:16.71s
Steps: 223 | Train Loss: 0.0541551 Vali Loss: 0.0548709 Test Loss: 0.0574785
Validation loss decreased (0.054891 --> 0.054871).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0507494
	speed: 0.1703s/iter; left time: 2793.6248s
	iters: 200, epoch: 27 | loss: 0.0532626
	speed: 0.0744s/iter; left time: 1212.7089s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:17.05s
Steps: 223 | Train Loss: 0.0539924 Vali Loss: 0.0549234 Test Loss: 0.0575042
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0542392
	speed: 0.1879s/iter; left time: 3039.4868s
	iters: 200, epoch: 28 | loss: 0.0539691
	speed: 0.0783s/iter; left time: 1258.3340s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:18.64s
Steps: 223 | Train Loss: 0.0539487 Vali Loss: 0.0548774 Test Loss: 0.0575267
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0521044
	speed: 0.3136s/iter; left time: 5004.0189s
	iters: 200, epoch: 29 | loss: 0.0509934
	speed: 0.1754s/iter; left time: 2781.9099s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:42.57s
Steps: 223 | Train Loss: 0.0539058 Vali Loss: 0.0548742 Test Loss: 0.0573750
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0580714
	speed: 0.2264s/iter; left time: 3561.8815s
	iters: 200, epoch: 30 | loss: 0.0515862
	speed: 0.0814s/iter; left time: 1273.2636s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:18.93s
Steps: 223 | Train Loss: 0.0539120 Vali Loss: 0.0547454 Test Loss: 0.0574369
Validation loss decreased (0.054871 --> 0.054745).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0573174
	speed: 0.1904s/iter; left time: 2953.3819s
	iters: 200, epoch: 31 | loss: 0.0589227
	speed: 0.0822s/iter; left time: 1266.2932s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:18.89s
Steps: 223 | Train Loss: 0.0538397 Vali Loss: 0.0547085 Test Loss: 0.0573836
Validation loss decreased (0.054745 --> 0.054708).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0572007
	speed: 0.1876s/iter; left time: 2867.8048s
	iters: 200, epoch: 32 | loss: 0.0529349
	speed: 0.0807s/iter; left time: 1225.5455s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:18.60s
Steps: 223 | Train Loss: 0.0537666 Vali Loss: 0.0548522 Test Loss: 0.0574574
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0535290
	speed: 0.2115s/iter; left time: 3185.5163s
	iters: 200, epoch: 33 | loss: 0.0521026
	speed: 0.1249s/iter; left time: 1869.4477s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:26.58s
Steps: 223 | Train Loss: 0.0538062 Vali Loss: 0.0548358 Test Loss: 0.0574031
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0542147
	speed: 0.2777s/iter; left time: 4121.8149s
	iters: 200, epoch: 34 | loss: 0.0529351
	speed: 0.1283s/iter; left time: 1891.2732s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:28.99s
Steps: 223 | Train Loss: 0.0536756 Vali Loss: 0.0547746 Test Loss: 0.0574166
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0524224
	speed: 0.3269s/iter; left time: 4779.3293s
	iters: 200, epoch: 35 | loss: 0.0521868
	speed: 0.1556s/iter; left time: 2258.5955s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:34.61s
Steps: 223 | Train Loss: 0.0537168 Vali Loss: 0.0546867 Test Loss: 0.0573712
Validation loss decreased (0.054708 --> 0.054687).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0547390
	speed: 0.3498s/iter; left time: 5035.1722s
	iters: 200, epoch: 36 | loss: 0.0513252
	speed: 0.1773s/iter; left time: 2534.7806s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:38.84s
Steps: 223 | Train Loss: 0.0536649 Vali Loss: 0.0548329 Test Loss: 0.0573338
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0526233
	speed: 0.4131s/iter; left time: 5855.0527s
	iters: 200, epoch: 37 | loss: 0.0532994
	speed: 0.1768s/iter; left time: 2488.2374s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:42.40s
Steps: 223 | Train Loss: 0.0536699 Vali Loss: 0.0547430 Test Loss: 0.0573483
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0552216
	speed: 0.4277s/iter; left time: 5966.7552s
	iters: 200, epoch: 38 | loss: 0.0542184
	speed: 0.1920s/iter; left time: 2659.2649s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:42.05s
Steps: 223 | Train Loss: 0.0536600 Vali Loss: 0.0546434 Test Loss: 0.0573275
Validation loss decreased (0.054687 --> 0.054643).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0544269
	speed: 0.4247s/iter; left time: 5829.1753s
	iters: 200, epoch: 39 | loss: 0.0550644
	speed: 0.2114s/iter; left time: 2880.3472s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:46.62s
Steps: 223 | Train Loss: 0.0536410 Vali Loss: 0.0547653 Test Loss: 0.0573865
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0523039
	speed: 0.4798s/iter; left time: 6478.7783s
	iters: 200, epoch: 40 | loss: 0.0555325
	speed: 0.2019s/iter; left time: 2706.1862s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:48.55s
Steps: 223 | Train Loss: 0.0535535 Vali Loss: 0.0547170 Test Loss: 0.0573768
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0485696
	speed: 0.4853s/iter; left time: 6445.8641s
	iters: 200, epoch: 41 | loss: 0.0521793
	speed: 0.1909s/iter; left time: 2515.8236s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:47.15s
Steps: 223 | Train Loss: 0.0535917 Vali Loss: 0.0547144 Test Loss: 0.0573494
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0557823
	speed: 0.4580s/iter; left time: 5981.1233s
	iters: 200, epoch: 42 | loss: 0.0514218
	speed: 0.2059s/iter; left time: 2667.9186s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:45.00s
Steps: 223 | Train Loss: 0.0535651 Vali Loss: 0.0547100 Test Loss: 0.0573217
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0536297
	speed: 0.4410s/iter; left time: 5660.0517s
	iters: 200, epoch: 43 | loss: 0.0508653
	speed: 0.1746s/iter; left time: 2223.6951s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:41.75s
Steps: 223 | Train Loss: 0.0535408 Vali Loss: 0.0545471 Test Loss: 0.0573033
Validation loss decreased (0.054643 --> 0.054547).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0537778
	speed: 0.4515s/iter; left time: 5693.6991s
	iters: 200, epoch: 44 | loss: 0.0539068
	speed: 0.1859s/iter; left time: 2325.6176s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:42.09s
Steps: 223 | Train Loss: 0.0535216 Vali Loss: 0.0546545 Test Loss: 0.0572622
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0526309
	speed: 0.4266s/iter; left time: 5285.0607s
	iters: 200, epoch: 45 | loss: 0.0578126
	speed: 0.1870s/iter; left time: 2298.5368s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:44.35s
Steps: 223 | Train Loss: 0.0534860 Vali Loss: 0.0545956 Test Loss: 0.0573146
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0516833
	speed: 0.4951s/iter; left time: 6023.1268s
	iters: 200, epoch: 46 | loss: 0.0523372
	speed: 0.2050s/iter; left time: 2473.6918s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:47.70s
Steps: 223 | Train Loss: 0.0535217 Vali Loss: 0.0546559 Test Loss: 0.0573144
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0530197
	speed: 0.4584s/iter; left time: 5474.1490s
	iters: 200, epoch: 47 | loss: 0.0499367
	speed: 0.2057s/iter; left time: 2436.2534s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:46.26s
Steps: 223 | Train Loss: 0.0534722 Vali Loss: 0.0547245 Test Loss: 0.0573141
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0524021
	speed: 0.4370s/iter; left time: 5121.5473s
	iters: 200, epoch: 48 | loss: 0.0547925
	speed: 0.2086s/iter; left time: 2423.9890s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:45.47s
Steps: 223 | Train Loss: 0.0535118 Vali Loss: 0.0547139 Test Loss: 0.0573085
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0580956
	speed: 0.4509s/iter; left time: 5184.5046s
	iters: 200, epoch: 49 | loss: 0.0481888
	speed: 0.2091s/iter; left time: 2382.8875s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:46.02s
Steps: 223 | Train Loss: 0.0534437 Vali Loss: 0.0546712 Test Loss: 0.0573046
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0534444
	speed: 0.3882s/iter; left time: 4376.7753s
	iters: 200, epoch: 50 | loss: 0.0551254
	speed: 0.1342s/iter; left time: 1499.5021s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:32.72s
Steps: 223 | Train Loss: 0.0535029 Vali Loss: 0.0545804 Test Loss: 0.0572849
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0532080
	speed: 0.2621s/iter; left time: 2896.1256s
	iters: 200, epoch: 51 | loss: 0.0547003
	speed: 0.0959s/iter; left time: 1050.7193s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:23.39s
Steps: 223 | Train Loss: 0.0535040 Vali Loss: 0.0546792 Test Loss: 0.0572739
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0539353
	speed: 0.2211s/iter; left time: 2394.0653s
	iters: 200, epoch: 52 | loss: 0.0537760
	speed: 0.0919s/iter; left time: 986.2709s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:21.63s
Steps: 223 | Train Loss: 0.0534933 Vali Loss: 0.0546623 Test Loss: 0.0572583
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0524189
	speed: 0.2059s/iter; left time: 2183.1426s
	iters: 200, epoch: 53 | loss: 0.0573189
	speed: 0.0870s/iter; left time: 913.9394s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:19.95s
Steps: 223 | Train Loss: 0.0534749 Vali Loss: 0.0546200 Test Loss: 0.0572883
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_IT_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010080976411700249, rmse:0.10040406882762909, mae:0.057303305715322495, rse:0.3793775141239166
Intermediate time for IT and pred_len 24: 00h:41m:49.06s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1311399
	speed: 0.1691s/iter; left time: 3738.3040s
	iters: 200, epoch: 1 | loss: 0.1141715
	speed: 0.1285s/iter; left time: 2827.6116s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.20s
Steps: 222 | Train Loss: 0.1386955 Vali Loss: 0.1032611 Test Loss: 0.1052448
Validation loss decreased (inf --> 0.103261).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0856372
	speed: 0.3564s/iter; left time: 7798.5274s
	iters: 200, epoch: 2 | loss: 0.0825728
	speed: 0.1042s/iter; left time: 2269.2966s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:23.83s
Steps: 222 | Train Loss: 0.0933017 Vali Loss: 0.0821070 Test Loss: 0.0853990
Validation loss decreased (0.103261 --> 0.082107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0840829
	speed: 0.3542s/iter; left time: 7671.4029s
	iters: 200, epoch: 3 | loss: 0.0774338
	speed: 0.0991s/iter; left time: 2136.2047s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.08s
Steps: 222 | Train Loss: 0.0836652 Vali Loss: 0.0801823 Test Loss: 0.0839848
Validation loss decreased (0.082107 --> 0.080182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0777906
	speed: 0.3823s/iter; left time: 8194.1118s
	iters: 200, epoch: 4 | loss: 0.0808969
	speed: 0.1163s/iter; left time: 2482.3249s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.82s
Steps: 222 | Train Loss: 0.0810691 Vali Loss: 0.0786099 Test Loss: 0.0832172
Validation loss decreased (0.080182 --> 0.078610).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0820504
	speed: 0.3402s/iter; left time: 7217.5537s
	iters: 200, epoch: 5 | loss: 0.0778563
	speed: 0.1159s/iter; left time: 2446.4149s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.97s
Steps: 222 | Train Loss: 0.0794057 Vali Loss: 0.0787720 Test Loss: 0.0831368
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0778250
	speed: 0.3327s/iter; left time: 6983.2994s
	iters: 200, epoch: 6 | loss: 0.0792012
	speed: 0.1144s/iter; left time: 2390.6639s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.02s
Steps: 222 | Train Loss: 0.0783560 Vali Loss: 0.0787365 Test Loss: 0.0827528
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0766344
	speed: 0.3451s/iter; left time: 7168.1667s
	iters: 200, epoch: 7 | loss: 0.0771671
	speed: 0.1036s/iter; left time: 2140.6562s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:23.97s
Steps: 222 | Train Loss: 0.0773313 Vali Loss: 0.0777745 Test Loss: 0.0821120
Validation loss decreased (0.078610 --> 0.077775).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0767398
	speed: 0.3375s/iter; left time: 6935.1741s
	iters: 200, epoch: 8 | loss: 0.0759662
	speed: 0.1116s/iter; left time: 2281.0374s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.24s
Steps: 222 | Train Loss: 0.0764446 Vali Loss: 0.0786228 Test Loss: 0.0820677
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0730551
	speed: 0.3426s/iter; left time: 6963.6799s
	iters: 200, epoch: 9 | loss: 0.0752378
	speed: 0.1105s/iter; left time: 2234.0419s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.50s
Steps: 222 | Train Loss: 0.0758786 Vali Loss: 0.0777612 Test Loss: 0.0823828
Validation loss decreased (0.077775 --> 0.077761).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0798666
	speed: 0.3382s/iter; left time: 6799.1711s
	iters: 200, epoch: 10 | loss: 0.0749843
	speed: 0.1098s/iter; left time: 2195.7129s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:24.35s
Steps: 222 | Train Loss: 0.0752808 Vali Loss: 0.0778954 Test Loss: 0.0823552
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0764299
	speed: 0.3560s/iter; left time: 7076.8356s
	iters: 200, epoch: 11 | loss: 0.0740857
	speed: 0.1054s/iter; left time: 2084.1819s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:24.96s
Steps: 222 | Train Loss: 0.0748124 Vali Loss: 0.0778898 Test Loss: 0.0825079
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0724045
	speed: 0.3405s/iter; left time: 6694.3039s
	iters: 200, epoch: 12 | loss: 0.0746246
	speed: 0.1063s/iter; left time: 2078.9870s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:24.41s
Steps: 222 | Train Loss: 0.0744042 Vali Loss: 0.0778334 Test Loss: 0.0823106
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0746598
	speed: 0.3462s/iter; left time: 6729.1110s
	iters: 200, epoch: 13 | loss: 0.0782185
	speed: 0.1074s/iter; left time: 2076.7404s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:24.66s
Steps: 222 | Train Loss: 0.0740403 Vali Loss: 0.0775864 Test Loss: 0.0823642
Validation loss decreased (0.077761 --> 0.077586).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0693135
	speed: 0.3455s/iter; left time: 6638.4685s
	iters: 200, epoch: 14 | loss: 0.0716517
	speed: 0.1053s/iter; left time: 2012.1388s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:24.51s
Steps: 222 | Train Loss: 0.0736158 Vali Loss: 0.0778610 Test Loss: 0.0827634
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0719399
	speed: 0.3487s/iter; left time: 6622.2708s
	iters: 200, epoch: 15 | loss: 0.0678389
	speed: 0.1075s/iter; left time: 2030.3125s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:24.64s
Steps: 222 | Train Loss: 0.0732489 Vali Loss: 0.0777737 Test Loss: 0.0830149
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0743510
	speed: 0.3548s/iter; left time: 6659.0880s
	iters: 200, epoch: 16 | loss: 0.0752960
	speed: 0.1010s/iter; left time: 1886.1930s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:24.92s
Steps: 222 | Train Loss: 0.0729326 Vali Loss: 0.0778201 Test Loss: 0.0826653
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0726962
	speed: 0.3047s/iter; left time: 5651.1722s
	iters: 200, epoch: 17 | loss: 0.0722981
	speed: 0.0992s/iter; left time: 1830.7885s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.80s
Steps: 222 | Train Loss: 0.0726651 Vali Loss: 0.0779380 Test Loss: 0.0830403
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0729924
	speed: 0.3398s/iter; left time: 6227.3028s
	iters: 200, epoch: 18 | loss: 0.0750807
	speed: 0.1095s/iter; left time: 1996.7298s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:26.56s
Steps: 222 | Train Loss: 0.0725138 Vali Loss: 0.0775092 Test Loss: 0.0824644
Validation loss decreased (0.077586 --> 0.077509).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0725602
	speed: 0.3671s/iter; left time: 6646.6417s
	iters: 200, epoch: 19 | loss: 0.0742136
	speed: 0.1126s/iter; left time: 2026.8736s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:25.90s
Steps: 222 | Train Loss: 0.0722610 Vali Loss: 0.0777993 Test Loss: 0.0827277
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0709395
	speed: 0.3372s/iter; left time: 6029.4661s
	iters: 200, epoch: 20 | loss: 0.0712768
	speed: 0.1099s/iter; left time: 1954.4980s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:25.37s
Steps: 222 | Train Loss: 0.0720304 Vali Loss: 0.0776217 Test Loss: 0.0830709
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0749833
	speed: 0.3386s/iter; left time: 5979.6552s
	iters: 200, epoch: 21 | loss: 0.0723694
	speed: 0.1125s/iter; left time: 1975.4946s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:25.08s
Steps: 222 | Train Loss: 0.0718289 Vali Loss: 0.0777689 Test Loss: 0.0829489
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0728807
	speed: 0.3430s/iter; left time: 5981.2282s
	iters: 200, epoch: 22 | loss: 0.0715724
	speed: 0.1138s/iter; left time: 1972.5922s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:25.81s
Steps: 222 | Train Loss: 0.0716578 Vali Loss: 0.0775245 Test Loss: 0.0829920
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0736327
	speed: 0.3422s/iter; left time: 5891.1664s
	iters: 200, epoch: 23 | loss: 0.0700886
	speed: 0.1078s/iter; left time: 1845.0305s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:25.05s
Steps: 222 | Train Loss: 0.0715372 Vali Loss: 0.0774438 Test Loss: 0.0829975
Validation loss decreased (0.077509 --> 0.077444).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0732769
	speed: 0.3416s/iter; left time: 5806.1703s
	iters: 200, epoch: 24 | loss: 0.0709394
	speed: 0.1102s/iter; left time: 1861.1250s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:24.53s
Steps: 222 | Train Loss: 0.0713622 Vali Loss: 0.0777394 Test Loss: 0.0830288
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0692430
	speed: 0.3341s/iter; left time: 5604.0832s
	iters: 200, epoch: 25 | loss: 0.0746632
	speed: 0.1088s/iter; left time: 1813.3631s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:24.67s
Steps: 222 | Train Loss: 0.0712769 Vali Loss: 0.0775630 Test Loss: 0.0829923
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0727863
	speed: 0.3352s/iter; left time: 5547.7592s
	iters: 200, epoch: 26 | loss: 0.0689155
	speed: 0.1044s/iter; left time: 1718.0180s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:24.46s
Steps: 222 | Train Loss: 0.0711172 Vali Loss: 0.0776434 Test Loss: 0.0832030
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0752033
	speed: 0.3557s/iter; left time: 5808.5386s
	iters: 200, epoch: 27 | loss: 0.0673548
	speed: 0.1038s/iter; left time: 1683.7629s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:24.32s
Steps: 222 | Train Loss: 0.0710334 Vali Loss: 0.0776247 Test Loss: 0.0831966
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0734832
	speed: 0.3505s/iter; left time: 5644.7200s
	iters: 200, epoch: 28 | loss: 0.0692218
	speed: 0.1076s/iter; left time: 1723.1227s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:24.30s
Steps: 222 | Train Loss: 0.0709934 Vali Loss: 0.0776521 Test Loss: 0.0830424
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0723570
	speed: 0.3472s/iter; left time: 5515.3677s
	iters: 200, epoch: 29 | loss: 0.0728116
	speed: 0.1085s/iter; left time: 1712.1444s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:24.95s
Steps: 222 | Train Loss: 0.0708610 Vali Loss: 0.0775053 Test Loss: 0.0831043
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0713507
	speed: 0.3366s/iter; left time: 5271.5541s
	iters: 200, epoch: 30 | loss: 0.0729116
	speed: 0.1111s/iter; left time: 1728.6501s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:25.57s
Steps: 222 | Train Loss: 0.0708525 Vali Loss: 0.0777053 Test Loss: 0.0831629
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0749389
	speed: 0.3201s/iter; left time: 4942.7000s
	iters: 200, epoch: 31 | loss: 0.0724649
	speed: 0.0976s/iter; left time: 1496.7263s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:22.19s
Steps: 222 | Train Loss: 0.0707049 Vali Loss: 0.0778409 Test Loss: 0.0833423
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0705555
	speed: 0.2971s/iter; left time: 4521.7761s
	iters: 200, epoch: 32 | loss: 0.0722894
	speed: 0.1003s/iter; left time: 1515.9907s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:22.77s
Steps: 222 | Train Loss: 0.0705979 Vali Loss: 0.0777341 Test Loss: 0.0832765
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0708174
	speed: 0.3026s/iter; left time: 4537.4618s
	iters: 200, epoch: 33 | loss: 0.0716869
	speed: 0.0999s/iter; left time: 1487.6257s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:22.27s
Steps: 222 | Train Loss: 0.0705853 Vali Loss: 0.0774142 Test Loss: 0.0832275
Validation loss decreased (0.077444 --> 0.077414).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0687195
	speed: 0.3042s/iter; left time: 4495.0039s
	iters: 200, epoch: 34 | loss: 0.0715097
	speed: 0.0980s/iter; left time: 1437.9201s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:22.59s
Steps: 222 | Train Loss: 0.0705578 Vali Loss: 0.0776007 Test Loss: 0.0832708
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0726959
	speed: 0.2997s/iter; left time: 4361.7562s
	iters: 200, epoch: 35 | loss: 0.0734263
	speed: 0.0991s/iter; left time: 1432.5473s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:22.58s
Steps: 222 | Train Loss: 0.0705173 Vali Loss: 0.0776994 Test Loss: 0.0832131
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0730397
	speed: 0.3074s/iter; left time: 4404.8692s
	iters: 200, epoch: 36 | loss: 0.0701893
	speed: 0.0976s/iter; left time: 1389.2550s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:22.56s
Steps: 222 | Train Loss: 0.0704305 Vali Loss: 0.0776818 Test Loss: 0.0833117
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0684488
	speed: 0.2998s/iter; left time: 4230.0076s
	iters: 200, epoch: 37 | loss: 0.0706373
	speed: 0.0987s/iter; left time: 1382.9966s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:22.83s
Steps: 222 | Train Loss: 0.0704381 Vali Loss: 0.0776246 Test Loss: 0.0833702
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0681006
	speed: 0.2962s/iter; left time: 4112.8413s
	iters: 200, epoch: 38 | loss: 0.0723561
	speed: 0.0998s/iter; left time: 1376.1686s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:22.69s
Steps: 222 | Train Loss: 0.0703652 Vali Loss: 0.0777585 Test Loss: 0.0832768
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0716680
	speed: 0.2981s/iter; left time: 4073.8396s
	iters: 200, epoch: 39 | loss: 0.0727969
	speed: 0.0982s/iter; left time: 1332.5444s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:22.47s
Steps: 222 | Train Loss: 0.0703907 Vali Loss: 0.0776063 Test Loss: 0.0832168
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0663224
	speed: 0.3013s/iter; left time: 4050.4021s
	iters: 200, epoch: 40 | loss: 0.0692386
	speed: 0.0990s/iter; left time: 1320.8990s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:22.61s
Steps: 222 | Train Loss: 0.0703427 Vali Loss: 0.0775947 Test Loss: 0.0833248
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0682518
	speed: 0.2965s/iter; left time: 3919.5222s
	iters: 200, epoch: 41 | loss: 0.0704335
	speed: 0.0948s/iter; left time: 1243.2475s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:21.63s
Steps: 222 | Train Loss: 0.0702792 Vali Loss: 0.0776268 Test Loss: 0.0833209
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0765378
	speed: 0.2978s/iter; left time: 3871.5576s
	iters: 200, epoch: 42 | loss: 0.0654985
	speed: 0.0942s/iter; left time: 1214.4709s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:21.71s
Steps: 222 | Train Loss: 0.0702523 Vali Loss: 0.0776762 Test Loss: 0.0832865
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0718094
	speed: 0.2963s/iter; left time: 3785.2200s
	iters: 200, epoch: 43 | loss: 0.0723811
	speed: 0.0982s/iter; left time: 1244.7009s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:22.50s
Steps: 222 | Train Loss: 0.0702900 Vali Loss: 0.0777120 Test Loss: 0.0833350
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019661061465740204, rmse:0.14021790027618408, mae:0.08322744071483612, rse:0.5301790237426758
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1307814
	speed: 0.1003s/iter; left time: 2217.2914s
	iters: 200, epoch: 1 | loss: 0.1171321
	speed: 0.0956s/iter; left time: 2103.6088s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:21.85s
Steps: 222 | Train Loss: 0.1395332 Vali Loss: 0.1032470 Test Loss: 0.1049860
Validation loss decreased (inf --> 0.103247).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0916372
	speed: 0.2953s/iter; left time: 6461.9022s
	iters: 200, epoch: 2 | loss: 0.0823959
	speed: 0.0953s/iter; left time: 2075.1291s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:21.83s
Steps: 222 | Train Loss: 0.0933076 Vali Loss: 0.0824281 Test Loss: 0.0858068
Validation loss decreased (0.103247 --> 0.082428).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0872041
	speed: 0.2911s/iter; left time: 6304.3783s
	iters: 200, epoch: 3 | loss: 0.0788812
	speed: 0.0976s/iter; left time: 2102.9357s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.08s
Steps: 222 | Train Loss: 0.0836500 Vali Loss: 0.0802880 Test Loss: 0.0839654
Validation loss decreased (0.082428 --> 0.080288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0820672
	speed: 0.2980s/iter; left time: 6386.7419s
	iters: 200, epoch: 4 | loss: 0.0818864
	speed: 0.0960s/iter; left time: 2047.8672s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:21.85s
Steps: 222 | Train Loss: 0.0810862 Vali Loss: 0.0789895 Test Loss: 0.0830211
Validation loss decreased (0.080288 --> 0.078989).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0760076
	speed: 0.2990s/iter; left time: 6343.6648s
	iters: 200, epoch: 5 | loss: 0.0797620
	speed: 0.0976s/iter; left time: 2060.0964s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.10s
Steps: 222 | Train Loss: 0.0795027 Vali Loss: 0.0782971 Test Loss: 0.0827075
Validation loss decreased (0.078989 --> 0.078297).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0779532
	speed: 0.2913s/iter; left time: 6114.8252s
	iters: 200, epoch: 6 | loss: 0.0816109
	speed: 0.0953s/iter; left time: 1991.4572s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:21.93s
Steps: 222 | Train Loss: 0.0784048 Vali Loss: 0.0775458 Test Loss: 0.0820731
Validation loss decreased (0.078297 --> 0.077546).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0748276
	speed: 0.2925s/iter; left time: 6075.6091s
	iters: 200, epoch: 7 | loss: 0.0819100
	speed: 0.0936s/iter; left time: 1934.1303s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:21.68s
Steps: 222 | Train Loss: 0.0774822 Vali Loss: 0.0781644 Test Loss: 0.0823445
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0749587
	speed: 0.2956s/iter; left time: 6073.0907s
	iters: 200, epoch: 8 | loss: 0.0749932
	speed: 0.0982s/iter; left time: 2007.0407s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.20s
Steps: 222 | Train Loss: 0.0766891 Vali Loss: 0.0772725 Test Loss: 0.0819850
Validation loss decreased (0.077546 --> 0.077272).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0743355
	speed: 0.2922s/iter; left time: 5938.0465s
	iters: 200, epoch: 9 | loss: 0.0758577
	speed: 0.0967s/iter; left time: 1955.3807s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.03s
Steps: 222 | Train Loss: 0.0760432 Vali Loss: 0.0781481 Test Loss: 0.0822719
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0754635
	speed: 0.2888s/iter; left time: 5805.8640s
	iters: 200, epoch: 10 | loss: 0.0753185
	speed: 0.0995s/iter; left time: 1990.9896s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.40s
Steps: 222 | Train Loss: 0.0755703 Vali Loss: 0.0779481 Test Loss: 0.0822187
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0784725
	speed: 0.2976s/iter; left time: 5915.8656s
	iters: 200, epoch: 11 | loss: 0.0744855
	speed: 0.0964s/iter; left time: 1907.7959s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.03s
Steps: 222 | Train Loss: 0.0750095 Vali Loss: 0.0778305 Test Loss: 0.0819077
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0705007
	speed: 0.2777s/iter; left time: 5459.0270s
	iters: 200, epoch: 12 | loss: 0.0720747
	speed: 0.0974s/iter; left time: 1904.9933s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.06s
Steps: 222 | Train Loss: 0.0745374 Vali Loss: 0.0780981 Test Loss: 0.0819330
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0698386
	speed: 0.2974s/iter; left time: 5780.9542s
	iters: 200, epoch: 13 | loss: 0.0727388
	speed: 0.0962s/iter; left time: 1860.2269s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:22.22s
Steps: 222 | Train Loss: 0.0741739 Vali Loss: 0.0778864 Test Loss: 0.0820878
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0789689
	speed: 0.2803s/iter; left time: 5386.2076s
	iters: 200, epoch: 14 | loss: 0.0682087
	speed: 0.0977s/iter; left time: 1867.6835s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:22.58s
Steps: 222 | Train Loss: 0.0737458 Vali Loss: 0.0776178 Test Loss: 0.0820219
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0734283
	speed: 0.2920s/iter; left time: 5545.9914s
	iters: 200, epoch: 15 | loss: 0.0718359
	speed: 0.0999s/iter; left time: 1887.1905s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:22.90s
Steps: 222 | Train Loss: 0.0733381 Vali Loss: 0.0776815 Test Loss: 0.0821751
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0711537
	speed: 0.2979s/iter; left time: 5592.2039s
	iters: 200, epoch: 16 | loss: 0.0715080
	speed: 0.1002s/iter; left time: 1870.9200s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:22.81s
Steps: 222 | Train Loss: 0.0731208 Vali Loss: 0.0775902 Test Loss: 0.0822790
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0744190
	speed: 0.2809s/iter; left time: 5210.4807s
	iters: 200, epoch: 17 | loss: 0.0702729
	speed: 0.0994s/iter; left time: 1834.0923s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:22.53s
Steps: 222 | Train Loss: 0.0727643 Vali Loss: 0.0776203 Test Loss: 0.0821167
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0710593
	speed: 0.2910s/iter; left time: 5332.4292s
	iters: 200, epoch: 18 | loss: 0.0704435
	speed: 0.0999s/iter; left time: 1820.3431s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:22.56s
Steps: 222 | Train Loss: 0.0725734 Vali Loss: 0.0780306 Test Loss: 0.0821137
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_IT_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01830422878265381, rmse:0.1352931261062622, mae:0.08198496699333191, rse:0.5115578770637512
Intermediate time for IT and pred_len 96: 00h:43m:23.82s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1295985
	speed: 0.1465s/iter; left time: 3237.6315s
	iters: 200, epoch: 1 | loss: 0.1180896
	speed: 0.0983s/iter; left time: 2162.3534s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.69s
Steps: 222 | Train Loss: 0.1401323 Vali Loss: 0.1051054 Test Loss: 0.1060525
Validation loss decreased (inf --> 0.105105).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0924811
	speed: 0.3124s/iter; left time: 6835.2263s
	iters: 200, epoch: 2 | loss: 0.0879458
	speed: 0.1004s/iter; left time: 2186.3794s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.81s
Steps: 222 | Train Loss: 0.0966438 Vali Loss: 0.0867667 Test Loss: 0.0893334
Validation loss decreased (0.105105 --> 0.086767).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0903072
	speed: 0.3075s/iter; left time: 6659.6450s
	iters: 200, epoch: 3 | loss: 0.0883525
	speed: 0.1024s/iter; left time: 2206.4874s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.80s
Steps: 222 | Train Loss: 0.0874388 Vali Loss: 0.0843132 Test Loss: 0.0879837
Validation loss decreased (0.086767 --> 0.084313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0860730
	speed: 0.3110s/iter; left time: 6666.9633s
	iters: 200, epoch: 4 | loss: 0.0831108
	speed: 0.1014s/iter; left time: 2162.6540s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.78s
Steps: 222 | Train Loss: 0.0847376 Vali Loss: 0.0837539 Test Loss: 0.0880465
Validation loss decreased (0.084313 --> 0.083754).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0837407
	speed: 0.3030s/iter; left time: 6427.6945s
	iters: 200, epoch: 5 | loss: 0.0845941
	speed: 0.0998s/iter; left time: 2106.0811s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.83s
Steps: 222 | Train Loss: 0.0829249 Vali Loss: 0.0836297 Test Loss: 0.0880610
Validation loss decreased (0.083754 --> 0.083630).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0783244
	speed: 0.3130s/iter; left time: 6569.6838s
	iters: 200, epoch: 6 | loss: 0.0828781
	speed: 0.1010s/iter; left time: 2109.5735s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:23.23s
Steps: 222 | Train Loss: 0.0816438 Vali Loss: 0.0839534 Test Loss: 0.0884101
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0834960
	speed: 0.3080s/iter; left time: 6397.0898s
	iters: 200, epoch: 7 | loss: 0.0834978
	speed: 0.1022s/iter; left time: 2113.2426s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:23.22s
Steps: 222 | Train Loss: 0.0806016 Vali Loss: 0.0844958 Test Loss: 0.0885445
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0818839
	speed: 0.3093s/iter; left time: 6354.7046s
	iters: 200, epoch: 8 | loss: 0.0781465
	speed: 0.1028s/iter; left time: 2101.1304s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:23.02s
Steps: 222 | Train Loss: 0.0798453 Vali Loss: 0.0841923 Test Loss: 0.0884497
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0763105
	speed: 0.3110s/iter; left time: 6320.6427s
	iters: 200, epoch: 9 | loss: 0.0815194
	speed: 0.1017s/iter; left time: 2057.3773s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:23.26s
Steps: 222 | Train Loss: 0.0790506 Vali Loss: 0.0838278 Test Loss: 0.0882513
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0768552
	speed: 0.3190s/iter; left time: 6412.4627s
	iters: 200, epoch: 10 | loss: 0.0751613
	speed: 0.1010s/iter; left time: 2020.4968s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:23.15s
Steps: 222 | Train Loss: 0.0785731 Vali Loss: 0.0852505 Test Loss: 0.0894450
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0779051
	speed: 0.3096s/iter; left time: 6156.0761s
	iters: 200, epoch: 11 | loss: 0.0783429
	speed: 0.1012s/iter; left time: 2002.5800s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:23.22s
Steps: 222 | Train Loss: 0.0779830 Vali Loss: 0.0841723 Test Loss: 0.0893404
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0793392
	speed: 0.3183s/iter; left time: 6256.6462s
	iters: 200, epoch: 12 | loss: 0.0783407
	speed: 0.1063s/iter; left time: 2079.2707s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:23.95s
Steps: 222 | Train Loss: 0.0775615 Vali Loss: 0.0845753 Test Loss: 0.0896497
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0717627
	speed: 0.3200s/iter; left time: 6220.8047s
	iters: 200, epoch: 13 | loss: 0.0760427
	speed: 0.1052s/iter; left time: 2035.1138s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:24.00s
Steps: 222 | Train Loss: 0.0771428 Vali Loss: 0.0849008 Test Loss: 0.0896374
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0738550
	speed: 0.3131s/iter; left time: 6015.4938s
	iters: 200, epoch: 14 | loss: 0.0723396
	speed: 0.1023s/iter; left time: 1955.9302s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:23.37s
Steps: 222 | Train Loss: 0.0767282 Vali Loss: 0.0847574 Test Loss: 0.0897097
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0740597
	speed: 0.3176s/iter; left time: 6031.7120s
	iters: 200, epoch: 15 | loss: 0.0726431
	speed: 0.1038s/iter; left time: 1960.9592s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:23.49s
Steps: 222 | Train Loss: 0.0763989 Vali Loss: 0.0849585 Test Loss: 0.0900345
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01999608241021633, rmse:0.14140750467777252, mae:0.08806101232767105, rse:0.5351738333702087
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1304552
	speed: 0.1111s/iter; left time: 2456.3137s
	iters: 200, epoch: 1 | loss: 0.1230357
	speed: 0.1008s/iter; left time: 2216.8471s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:23.68s
Steps: 222 | Train Loss: 0.1400045 Vali Loss: 0.1050060 Test Loss: 0.1058844
Validation loss decreased (inf --> 0.105006).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0944798
	speed: 0.3307s/iter; left time: 7234.8804s
	iters: 200, epoch: 2 | loss: 0.0940326
	speed: 0.1042s/iter; left time: 2269.2110s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:23.80s
Steps: 222 | Train Loss: 0.0967777 Vali Loss: 0.0866084 Test Loss: 0.0891818
Validation loss decreased (0.105006 --> 0.086608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0894913
	speed: 0.3224s/iter; left time: 6982.8506s
	iters: 200, epoch: 3 | loss: 0.0858088
	speed: 0.1092s/iter; left time: 2353.6217s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.36s
Steps: 222 | Train Loss: 0.0879031 Vali Loss: 0.0848397 Test Loss: 0.0882691
Validation loss decreased (0.086608 --> 0.084840).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0866619
	speed: 0.3221s/iter; left time: 6903.3660s
	iters: 200, epoch: 4 | loss: 0.0828001
	speed: 0.1054s/iter; left time: 2248.0083s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.07s
Steps: 222 | Train Loss: 0.0851090 Vali Loss: 0.0837484 Test Loss: 0.0878012
Validation loss decreased (0.084840 --> 0.083748).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0861621
	speed: 0.3200s/iter; left time: 6788.4171s
	iters: 200, epoch: 5 | loss: 0.0821062
	speed: 0.1052s/iter; left time: 2220.8765s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:23.97s
Steps: 222 | Train Loss: 0.0834075 Vali Loss: 0.0829306 Test Loss: 0.0874454
Validation loss decreased (0.083748 --> 0.082931).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0808549
	speed: 0.3190s/iter; left time: 6697.1051s
	iters: 200, epoch: 6 | loss: 0.0820382
	speed: 0.1059s/iter; left time: 2213.2111s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:23.85s
Steps: 222 | Train Loss: 0.0819533 Vali Loss: 0.0829529 Test Loss: 0.0878453
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0796450
	speed: 0.3250s/iter; left time: 6749.3430s
	iters: 200, epoch: 7 | loss: 0.0832715
	speed: 0.1009s/iter; left time: 2085.1283s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:23.29s
Steps: 222 | Train Loss: 0.0809442 Vali Loss: 0.0825301 Test Loss: 0.0880153
Validation loss decreased (0.082931 --> 0.082530).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0775254
	speed: 0.3193s/iter; left time: 6560.8919s
	iters: 200, epoch: 8 | loss: 0.0788324
	speed: 0.1018s/iter; left time: 2081.3377s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:23.35s
Steps: 222 | Train Loss: 0.0800502 Vali Loss: 0.0832425 Test Loss: 0.0887176
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0806981
	speed: 0.3034s/iter; left time: 6167.0507s
	iters: 200, epoch: 9 | loss: 0.0805786
	speed: 0.1017s/iter; left time: 2056.2923s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:23.17s
Steps: 222 | Train Loss: 0.0792796 Vali Loss: 0.0830872 Test Loss: 0.0887377
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0775588
	speed: 0.3140s/iter; left time: 6313.2120s
	iters: 200, epoch: 10 | loss: 0.0809518
	speed: 0.1087s/iter; left time: 2174.7747s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:24.03s
Steps: 222 | Train Loss: 0.0786215 Vali Loss: 0.0832103 Test Loss: 0.0886014
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0769939
	speed: 0.3092s/iter; left time: 6147.3395s
	iters: 200, epoch: 11 | loss: 0.0785858
	speed: 0.1026s/iter; left time: 2029.0895s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:23.44s
Steps: 222 | Train Loss: 0.0780797 Vali Loss: 0.0831849 Test Loss: 0.0888413
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0780162
	speed: 0.3202s/iter; left time: 6294.6527s
	iters: 200, epoch: 12 | loss: 0.0788598
	speed: 0.1017s/iter; left time: 1989.9683s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:23.42s
Steps: 222 | Train Loss: 0.0775825 Vali Loss: 0.0833615 Test Loss: 0.0889409
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0782921
	speed: 0.3117s/iter; left time: 6058.5961s
	iters: 200, epoch: 13 | loss: 0.0769778
	speed: 0.1051s/iter; left time: 2033.1434s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:23.88s
Steps: 222 | Train Loss: 0.0772040 Vali Loss: 0.0830693 Test Loss: 0.0891442
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0791389
	speed: 0.3194s/iter; left time: 6136.8757s
	iters: 200, epoch: 14 | loss: 0.0789384
	speed: 0.1032s/iter; left time: 1973.3562s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:23.63s
Steps: 222 | Train Loss: 0.0767473 Vali Loss: 0.0832471 Test Loss: 0.0888520
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0770241
	speed: 0.3009s/iter; left time: 5715.4488s
	iters: 200, epoch: 15 | loss: 0.0787771
	speed: 0.1036s/iter; left time: 1957.5154s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:23.66s
Steps: 222 | Train Loss: 0.0764810 Vali Loss: 0.0833797 Test Loss: 0.0892758
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0778514
	speed: 0.3028s/iter; left time: 5684.6335s
	iters: 200, epoch: 16 | loss: 0.0740805
	speed: 0.1048s/iter; left time: 1955.8194s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:23.80s
Steps: 222 | Train Loss: 0.0761760 Vali Loss: 0.0830844 Test Loss: 0.0889327
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0792995
	speed: 0.3109s/iter; left time: 5765.9951s
	iters: 200, epoch: 17 | loss: 0.0781442
	speed: 0.1039s/iter; left time: 1917.0640s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:23.78s
Steps: 222 | Train Loss: 0.0758439 Vali Loss: 0.0834271 Test Loss: 0.0892882
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_IT_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02077891305088997, rmse:0.14414893090724945, mae:0.08801530301570892, rse:0.5455491542816162
Intermediate time for IT and pred_len 168: 00h:22m:46.48s
Intermediate time for IT: 01h:47m:59.37s
Total time: 04h:33m:27.02s
