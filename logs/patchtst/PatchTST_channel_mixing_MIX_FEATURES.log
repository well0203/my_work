
=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1112533
	speed: 0.1215s/iter; left time: 2710.1233s
	iters: 200, epoch: 1 | loss: 0.0947237
	speed: 0.0984s/iter; left time: 2185.6218s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.1155480 Vali Loss: 0.1083674 Test Loss: 0.1112919
Validation loss decreased (inf --> 0.108367).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0854550
	speed: 0.1687s/iter; left time: 3724.6090s
	iters: 200, epoch: 2 | loss: 0.0782319
	speed: 0.0985s/iter; left time: 2165.5639s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.22s
Steps: 224 | Train Loss: 0.0869274 Vali Loss: 0.0998944 Test Loss: 0.1056200
Validation loss decreased (0.108367 --> 0.099894).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0739933
	speed: 0.1687s/iter; left time: 3686.0232s
	iters: 200, epoch: 3 | loss: 0.0765578
	speed: 0.0992s/iter; left time: 2157.7526s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.31s
Steps: 224 | Train Loss: 0.0778407 Vali Loss: 0.0991285 Test Loss: 0.1069202
Validation loss decreased (0.099894 --> 0.099128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0697385
	speed: 0.1687s/iter; left time: 3649.3880s
	iters: 200, epoch: 4 | loss: 0.0638608
	speed: 0.0996s/iter; left time: 2143.9499s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0693531 Vali Loss: 0.1024066 Test Loss: 0.1129898
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582502
	speed: 0.1638s/iter; left time: 3505.2673s
	iters: 200, epoch: 5 | loss: 0.0585040
	speed: 0.0997s/iter; left time: 2123.8684s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0609865 Vali Loss: 0.1040621 Test Loss: 0.1140443
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0572859
	speed: 0.1646s/iter; left time: 3485.3806s
	iters: 200, epoch: 6 | loss: 0.0524833
	speed: 0.0999s/iter; left time: 2105.9010s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.49s
Steps: 224 | Train Loss: 0.0544637 Vali Loss: 0.1054772 Test Loss: 0.1150894
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0504480
	speed: 0.1644s/iter; left time: 3444.7885s
	iters: 200, epoch: 7 | loss: 0.0498273
	speed: 0.0995s/iter; left time: 2075.6365s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.44s
Steps: 224 | Train Loss: 0.0495332 Vali Loss: 0.1044851 Test Loss: 0.1146997
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0444115
	speed: 0.1645s/iter; left time: 3410.4840s
	iters: 200, epoch: 8 | loss: 0.0440660
	speed: 0.0994s/iter; left time: 2051.5093s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.45s
Steps: 224 | Train Loss: 0.0461323 Vali Loss: 0.1038223 Test Loss: 0.1127458
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0430763
	speed: 0.1635s/iter; left time: 3353.9704s
	iters: 200, epoch: 9 | loss: 0.0425591
	speed: 0.0994s/iter; left time: 2028.3943s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.39s
Steps: 224 | Train Loss: 0.0430833 Vali Loss: 0.1051498 Test Loss: 0.1131369
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0384030
	speed: 0.1639s/iter; left time: 3324.9030s
	iters: 200, epoch: 10 | loss: 0.0380151
	speed: 0.0993s/iter; left time: 2003.7088s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.39s
Steps: 224 | Train Loss: 0.0405867 Vali Loss: 0.1042476 Test Loss: 0.1118535
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0366854
	speed: 0.1640s/iter; left time: 3290.7687s
	iters: 200, epoch: 11 | loss: 0.0389781
	speed: 0.0994s/iter; left time: 1983.2903s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.41s
Steps: 224 | Train Loss: 0.0386601 Vali Loss: 0.1039293 Test Loss: 0.1120706
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0360011
	speed: 0.1641s/iter; left time: 3255.6167s
	iters: 200, epoch: 12 | loss: 0.0358986
	speed: 0.0996s/iter; left time: 1965.6408s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.41s
Steps: 224 | Train Loss: 0.0366836 Vali Loss: 0.1034238 Test Loss: 0.1116644
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0363298
	speed: 0.1642s/iter; left time: 3221.2653s
	iters: 200, epoch: 13 | loss: 0.0352150
	speed: 0.0995s/iter; left time: 1941.6533s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:22.41s
Steps: 224 | Train Loss: 0.0354312 Vali Loss: 0.1032293 Test Loss: 0.1111846
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.027056831866502762, rmse:0.16448961198329926, mae:0.10692021995782852, rse:0.5805065631866455
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1104277
	speed: 0.1002s/iter; left time: 2235.1869s
	iters: 200, epoch: 1 | loss: 0.0958888
	speed: 0.0989s/iter; left time: 2196.5421s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:22.33s
Steps: 224 | Train Loss: 0.1144290 Vali Loss: 0.1079746 Test Loss: 0.1105221
Validation loss decreased (inf --> 0.107975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0823085
	speed: 0.1704s/iter; left time: 3762.7204s
	iters: 200, epoch: 2 | loss: 0.0799549
	speed: 0.0990s/iter; left time: 2175.1155s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:22.36s
Steps: 224 | Train Loss: 0.0861994 Vali Loss: 0.1006127 Test Loss: 0.1039980
Validation loss decreased (0.107975 --> 0.100613).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0805682
	speed: 0.1691s/iter; left time: 3696.2135s
	iters: 200, epoch: 3 | loss: 0.0741031
	speed: 0.0991s/iter; left time: 2154.6858s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:22.36s
Steps: 224 | Train Loss: 0.0781434 Vali Loss: 0.1008413 Test Loss: 0.1066661
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0722199
	speed: 0.1644s/iter; left time: 3555.3378s
	iters: 200, epoch: 4 | loss: 0.0663662
	speed: 0.0989s/iter; left time: 2129.1192s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:22.37s
Steps: 224 | Train Loss: 0.0701794 Vali Loss: 0.1043894 Test Loss: 0.1115258
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0600862
	speed: 0.1644s/iter; left time: 3518.2718s
	iters: 200, epoch: 5 | loss: 0.0605440
	speed: 0.0990s/iter; left time: 2109.2170s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:22.34s
Steps: 224 | Train Loss: 0.0612372 Vali Loss: 0.1049034 Test Loss: 0.1115060
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0573480
	speed: 0.1645s/iter; left time: 3483.2610s
	iters: 200, epoch: 6 | loss: 0.0534590
	speed: 0.0990s/iter; left time: 2087.0157s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:22.35s
Steps: 224 | Train Loss: 0.0543473 Vali Loss: 0.1030101 Test Loss: 0.1130545
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0521577
	speed: 0.1641s/iter; left time: 3439.9903s
	iters: 200, epoch: 7 | loss: 0.0499089
	speed: 0.0990s/iter; left time: 2064.7921s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:22.37s
Steps: 224 | Train Loss: 0.0494745 Vali Loss: 0.1061422 Test Loss: 0.1134916
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0478449
	speed: 0.1641s/iter; left time: 3403.0264s
	iters: 200, epoch: 8 | loss: 0.0461110
	speed: 0.0989s/iter; left time: 2041.5428s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:22.32s
Steps: 224 | Train Loss: 0.0460226 Vali Loss: 0.1054480 Test Loss: 0.1134600
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0442130
	speed: 0.1641s/iter; left time: 3366.3600s
	iters: 200, epoch: 9 | loss: 0.0409993
	speed: 0.0991s/iter; left time: 2023.1403s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:22.36s
Steps: 224 | Train Loss: 0.0430741 Vali Loss: 0.1049370 Test Loss: 0.1139135
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0401310
	speed: 0.1642s/iter; left time: 3330.8852s
	iters: 200, epoch: 10 | loss: 0.0397451
	speed: 0.0991s/iter; left time: 1999.7277s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:22.34s
Steps: 224 | Train Loss: 0.0407757 Vali Loss: 0.1058690 Test Loss: 0.1138797
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0401663
	speed: 0.1652s/iter; left time: 3314.4039s
	iters: 200, epoch: 11 | loss: 0.0379177
	speed: 0.0990s/iter; left time: 1976.6000s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:22.37s
Steps: 224 | Train Loss: 0.0388926 Vali Loss: 0.1049644 Test Loss: 0.1126991
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0368711
	speed: 0.1645s/iter; left time: 3263.3165s
	iters: 200, epoch: 12 | loss: 0.0373080
	speed: 0.0990s/iter; left time: 1953.7016s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:22.35s
Steps: 224 | Train Loss: 0.0372816 Vali Loss: 0.1046643 Test Loss: 0.1133890
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025797396898269653, rmse:0.1606156826019287, mae:0.10399806499481201, rse:0.5668349862098694
Intermediate time for DE and pred_len 24: 00h:11m:15.49s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1199460
	speed: 0.1706s/iter; left time: 3770.5849s
	iters: 200, epoch: 1 | loss: 0.1113267
	speed: 0.1481s/iter; left time: 3257.9823s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.23s
Steps: 222 | Train Loss: 0.1272915 Vali Loss: 0.1290986 Test Loss: 0.1373214
Validation loss decreased (inf --> 0.129099).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1091684
	speed: 0.2489s/iter; left time: 5446.2166s
	iters: 200, epoch: 2 | loss: 0.0915942
	speed: 0.1485s/iter; left time: 3233.6947s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.16s
Steps: 222 | Train Loss: 0.1054749 Vali Loss: 0.1424523 Test Loss: 0.1628874
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0788054
	speed: 0.2411s/iter; left time: 5221.8003s
	iters: 200, epoch: 3 | loss: 0.0683856
	speed: 0.1488s/iter; left time: 3207.1939s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.15s
Steps: 222 | Train Loss: 0.0784179 Vali Loss: 0.1421706 Test Loss: 0.1652780
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0669743
	speed: 0.2414s/iter; left time: 5175.3927s
	iters: 200, epoch: 4 | loss: 0.0566403
	speed: 0.1487s/iter; left time: 3171.5880s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.19s
Steps: 222 | Train Loss: 0.0643372 Vali Loss: 0.1353048 Test Loss: 0.1630280
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0544861
	speed: 0.2410s/iter; left time: 5111.5417s
	iters: 200, epoch: 5 | loss: 0.0477081
	speed: 0.1486s/iter; left time: 3138.0078s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.16s
Steps: 222 | Train Loss: 0.0542426 Vali Loss: 0.1287874 Test Loss: 0.1526119
Validation loss decreased (0.129099 --> 0.128787).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0481118
	speed: 0.2496s/iter; left time: 5238.5334s
	iters: 200, epoch: 6 | loss: 0.0445629
	speed: 0.1486s/iter; left time: 3104.5582s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.0478975 Vali Loss: 0.1291162 Test Loss: 0.1512698
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0442690
	speed: 0.2399s/iter; left time: 4983.1949s
	iters: 200, epoch: 7 | loss: 0.0418023
	speed: 0.1486s/iter; left time: 3071.1295s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0444496 Vali Loss: 0.1290427 Test Loss: 0.1494315
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0381568
	speed: 0.2398s/iter; left time: 4927.7797s
	iters: 200, epoch: 8 | loss: 0.0381538
	speed: 0.1487s/iter; left time: 3039.7818s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.15s
Steps: 222 | Train Loss: 0.0398942 Vali Loss: 0.1280147 Test Loss: 0.1482985
Validation loss decreased (0.128787 --> 0.128015).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0367382
	speed: 0.2511s/iter; left time: 5104.1193s
	iters: 200, epoch: 9 | loss: 0.0369905
	speed: 0.1485s/iter; left time: 3004.1379s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0380115 Vali Loss: 0.1280958 Test Loss: 0.1485303
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0362219
	speed: 0.2409s/iter; left time: 4843.5749s
	iters: 200, epoch: 10 | loss: 0.0364316
	speed: 0.1487s/iter; left time: 2974.0284s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.0375805 Vali Loss: 0.1276526 Test Loss: 0.1468800
Validation loss decreased (0.128015 --> 0.127653).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0349723
	speed: 0.2495s/iter; left time: 4959.8083s
	iters: 200, epoch: 11 | loss: 0.0343733
	speed: 0.1487s/iter; left time: 2942.3398s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.20s
Steps: 222 | Train Loss: 0.0353968 Vali Loss: 0.1276304 Test Loss: 0.1476174
Validation loss decreased (0.127653 --> 0.127630).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0336972
	speed: 0.2498s/iter; left time: 4910.8589s
	iters: 200, epoch: 12 | loss: 0.0338921
	speed: 0.1486s/iter; left time: 2906.9654s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.0342828 Vali Loss: 0.1274732 Test Loss: 0.1466569
Validation loss decreased (0.127630 --> 0.127473).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0325756
	speed: 0.2476s/iter; left time: 4811.6583s
	iters: 200, epoch: 13 | loss: 0.0344771
	speed: 0.1485s/iter; left time: 2871.7150s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.0325816 Vali Loss: 0.1273889 Test Loss: 0.1462912
Validation loss decreased (0.127473 --> 0.127389).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0314464
	speed: 0.2481s/iter; left time: 4766.9823s
	iters: 200, epoch: 14 | loss: 0.0323382
	speed: 0.1485s/iter; left time: 2839.4100s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0316831 Vali Loss: 0.1273957 Test Loss: 0.1460509
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0305206
	speed: 0.2409s/iter; left time: 4574.4696s
	iters: 200, epoch: 15 | loss: 0.0319275
	speed: 0.1485s/iter; left time: 2805.3609s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0311711 Vali Loss: 0.1275493 Test Loss: 0.1461240
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0311466
	speed: 0.2404s/iter; left time: 4512.4425s
	iters: 200, epoch: 16 | loss: 0.0288618
	speed: 0.1485s/iter; left time: 2771.8993s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0310947 Vali Loss: 0.1274729 Test Loss: 0.1458088
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0292869
	speed: 0.2408s/iter; left time: 4467.3677s
	iters: 200, epoch: 17 | loss: 0.0307109
	speed: 0.1485s/iter; left time: 2739.9914s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0307580 Vali Loss: 0.1278000 Test Loss: 0.1461541
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0294343
	speed: 0.2411s/iter; left time: 4417.9552s
	iters: 200, epoch: 18 | loss: 0.0306529
	speed: 0.1486s/iter; left time: 2708.6672s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.0299903 Vali Loss: 0.1274430 Test Loss: 0.1458380
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0281599
	speed: 0.2402s/iter; left time: 4348.1183s
	iters: 200, epoch: 19 | loss: 0.0294794
	speed: 0.1487s/iter; left time: 2677.3859s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0291256 Vali Loss: 0.1273923 Test Loss: 0.1452989
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0308509
	speed: 0.2406s/iter; left time: 4302.3774s
	iters: 200, epoch: 20 | loss: 0.0299245
	speed: 0.1485s/iter; left time: 2640.8114s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0286714 Vali Loss: 0.1273286 Test Loss: 0.1449489
Validation loss decreased (0.127389 --> 0.127329).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0277228
	speed: 0.2486s/iter; left time: 4390.5890s
	iters: 200, epoch: 21 | loss: 0.0268247
	speed: 0.1486s/iter; left time: 2609.7081s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0284656 Vali Loss: 0.1274110 Test Loss: 0.1454506
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0294362
	speed: 0.2397s/iter; left time: 4180.7121s
	iters: 200, epoch: 22 | loss: 0.0274074
	speed: 0.1485s/iter; left time: 2575.2114s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0280676 Vali Loss: 0.1274281 Test Loss: 0.1451197
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0273963
	speed: 0.2393s/iter; left time: 4120.3581s
	iters: 200, epoch: 23 | loss: 0.0269143
	speed: 0.1486s/iter; left time: 2542.7721s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0277223 Vali Loss: 0.1275057 Test Loss: 0.1451241
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0271149
	speed: 0.2398s/iter; left time: 4074.8493s
	iters: 200, epoch: 24 | loss: 0.0267840
	speed: 0.1485s/iter; left time: 2509.6329s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0276102 Vali Loss: 0.1274463 Test Loss: 0.1447747
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0295763
	speed: 0.2399s/iter; left time: 4023.8559s
	iters: 200, epoch: 25 | loss: 0.0294020
	speed: 0.1486s/iter; left time: 2477.3294s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0272771 Vali Loss: 0.1274024 Test Loss: 0.1446266
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0267902
	speed: 0.2391s/iter; left time: 3957.4372s
	iters: 200, epoch: 26 | loss: 0.0267483
	speed: 0.1483s/iter; left time: 2439.2027s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:33.07s
Steps: 222 | Train Loss: 0.0270031 Vali Loss: 0.1274097 Test Loss: 0.1446937
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0266842
	speed: 0.2407s/iter; left time: 3930.5471s
	iters: 200, epoch: 27 | loss: 0.0258371
	speed: 0.1485s/iter; left time: 2410.5127s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0266768 Vali Loss: 0.1273998 Test Loss: 0.1449769
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0283277
	speed: 0.2402s/iter; left time: 3868.6476s
	iters: 200, epoch: 28 | loss: 0.0253145
	speed: 0.1484s/iter; left time: 2375.6722s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0267419 Vali Loss: 0.1275813 Test Loss: 0.1449047
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0256906
	speed: 0.2393s/iter; left time: 3800.7529s
	iters: 200, epoch: 29 | loss: 0.0255245
	speed: 0.1487s/iter; left time: 2347.9840s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0263942 Vali Loss: 0.1275553 Test Loss: 0.1450164
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0268758
	speed: 0.2393s/iter; left time: 3748.3142s
	iters: 200, epoch: 30 | loss: 0.0246162
	speed: 0.1485s/iter; left time: 2310.8061s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0262704 Vali Loss: 0.1275702 Test Loss: 0.1446492
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0451541543006897, rmse:0.21249507367610931, mae:0.144948810338974, rse:0.7524879574775696
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1205509
	speed: 0.1499s/iter; left time: 3312.5171s
	iters: 200, epoch: 1 | loss: 0.1198511
	speed: 0.1485s/iter; left time: 3266.0907s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.1277498 Vali Loss: 0.1293309 Test Loss: 0.1372827
Validation loss decreased (inf --> 0.129331).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1071269
	speed: 0.2859s/iter; left time: 6255.3683s
	iters: 200, epoch: 2 | loss: 0.0917259
	speed: 0.1484s/iter; left time: 3232.6079s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.1041855 Vali Loss: 0.1409393 Test Loss: 0.1708482
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0755418
	speed: 0.2433s/iter; left time: 5269.3687s
	iters: 200, epoch: 3 | loss: 0.0710160
	speed: 0.1483s/iter; left time: 3196.7762s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.19s
Steps: 222 | Train Loss: 0.0781006 Vali Loss: 0.1379286 Test Loss: 0.1611965
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0602861
	speed: 0.2414s/iter; left time: 5173.8011s
	iters: 200, epoch: 4 | loss: 0.0585016
	speed: 0.1482s/iter; left time: 3162.7325s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.08s
Steps: 222 | Train Loss: 0.0627467 Vali Loss: 0.1310828 Test Loss: 0.1546799
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0494528
	speed: 0.2413s/iter; left time: 5118.0701s
	iters: 200, epoch: 5 | loss: 0.0487285
	speed: 0.1482s/iter; left time: 3129.0157s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.10s
Steps: 222 | Train Loss: 0.0528450 Vali Loss: 0.1308739 Test Loss: 0.1511838
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0477548
	speed: 0.2407s/iter; left time: 5053.5056s
	iters: 200, epoch: 6 | loss: 0.0550409
	speed: 0.1486s/iter; left time: 3104.1890s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.19s
Steps: 222 | Train Loss: 0.0476709 Vali Loss: 0.1295642 Test Loss: 0.1504481
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0466351
	speed: 0.2419s/iter; left time: 5023.4854s
	iters: 200, epoch: 7 | loss: 0.0430377
	speed: 0.1486s/iter; left time: 3071.7585s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.19s
Steps: 222 | Train Loss: 0.0442525 Vali Loss: 0.1282709 Test Loss: 0.1451385
Validation loss decreased (0.129331 --> 0.128271).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0378001
	speed: 0.2608s/iter; left time: 5359.5734s
	iters: 200, epoch: 8 | loss: 0.0427828
	speed: 0.1485s/iter; left time: 3036.3465s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.18s
Steps: 222 | Train Loss: 0.0414039 Vali Loss: 0.1279676 Test Loss: 0.1452553
Validation loss decreased (0.128271 --> 0.127968).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0377505
	speed: 0.2768s/iter; left time: 5626.6228s
	iters: 200, epoch: 9 | loss: 0.0381534
	speed: 0.1482s/iter; left time: 2997.1831s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0388416 Vali Loss: 0.1294323 Test Loss: 0.1480028
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0431395
	speed: 0.2406s/iter; left time: 4836.5579s
	iters: 200, epoch: 10 | loss: 0.0365926
	speed: 0.1482s/iter; left time: 2963.9318s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.06s
Steps: 222 | Train Loss: 0.0393901 Vali Loss: 0.1284162 Test Loss: 0.1454666
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0380726
	speed: 0.2421s/iter; left time: 4813.1621s
	iters: 200, epoch: 11 | loss: 0.0329815
	speed: 0.1482s/iter; left time: 2932.1554s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0357566 Vali Loss: 0.1277553 Test Loss: 0.1453606
Validation loss decreased (0.127968 --> 0.127755).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0340886
	speed: 0.2741s/iter; left time: 5388.7711s
	iters: 200, epoch: 12 | loss: 0.0363329
	speed: 0.1484s/iter; left time: 2902.4453s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0342296 Vali Loss: 0.1268818 Test Loss: 0.1444277
Validation loss decreased (0.127755 --> 0.126882).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0336514
	speed: 0.2508s/iter; left time: 4874.5599s
	iters: 200, epoch: 13 | loss: 0.0323204
	speed: 0.1488s/iter; left time: 2877.2970s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:33.25s
Steps: 222 | Train Loss: 0.0334973 Vali Loss: 0.1273822 Test Loss: 0.1448403
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0326754
	speed: 0.2419s/iter; left time: 4648.2552s
	iters: 200, epoch: 14 | loss: 0.0318628
	speed: 0.1484s/iter; left time: 2836.9744s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:33.16s
Steps: 222 | Train Loss: 0.0332789 Vali Loss: 0.1276094 Test Loss: 0.1438571
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0331777
	speed: 0.2414s/iter; left time: 4584.0819s
	iters: 200, epoch: 15 | loss: 0.0299141
	speed: 0.1481s/iter; left time: 2798.7826s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:33.09s
Steps: 222 | Train Loss: 0.0320058 Vali Loss: 0.1269343 Test Loss: 0.1438403
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0324096
	speed: 0.2409s/iter; left time: 4522.3323s
	iters: 200, epoch: 16 | loss: 0.0292913
	speed: 0.1484s/iter; left time: 2770.8690s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0318890 Vali Loss: 0.1272244 Test Loss: 0.1448164
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0309272
	speed: 0.2417s/iter; left time: 4483.3153s
	iters: 200, epoch: 17 | loss: 0.0299695
	speed: 0.1484s/iter; left time: 2737.2604s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0324424 Vali Loss: 0.1272588 Test Loss: 0.1437404
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0309223
	speed: 0.2410s/iter; left time: 4416.1513s
	iters: 200, epoch: 18 | loss: 0.0285867
	speed: 0.1484s/iter; left time: 2704.5589s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0306312 Vali Loss: 0.1272983 Test Loss: 0.1435756
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0300717
	speed: 0.2414s/iter; left time: 4369.6943s
	iters: 200, epoch: 19 | loss: 0.0286214
	speed: 0.1485s/iter; left time: 2673.2508s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0298672 Vali Loss: 0.1271704 Test Loss: 0.1433482
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0288214
	speed: 0.2427s/iter; left time: 4339.5772s
	iters: 200, epoch: 20 | loss: 0.0284909
	speed: 0.1485s/iter; left time: 2640.5212s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:33.16s
Steps: 222 | Train Loss: 0.0294590 Vali Loss: 0.1269746 Test Loss: 0.1434907
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0286967
	speed: 0.2417s/iter; left time: 4268.3098s
	iters: 200, epoch: 21 | loss: 0.0284764
	speed: 0.1486s/iter; left time: 2609.3656s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:33.16s
Steps: 222 | Train Loss: 0.0292838 Vali Loss: 0.1270818 Test Loss: 0.1432376
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0280084
	speed: 0.2417s/iter; left time: 4214.2493s
	iters: 200, epoch: 22 | loss: 0.0289711
	speed: 0.1486s/iter; left time: 2576.9157s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:33.18s
Steps: 222 | Train Loss: 0.0287827 Vali Loss: 0.1270127 Test Loss: 0.1427781
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04446395859122276, rmse:0.21086478233337402, mae:0.14442767202854156, rse:0.7467148303985596
Intermediate time for DE and pred_len 96: 00h:34m:23.08s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1288348
	speed: 0.1760s/iter; left time: 3888.7520s
	iters: 200, epoch: 1 | loss: 0.1174094
	speed: 0.1506s/iter; left time: 3313.1381s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.85s
Steps: 222 | Train Loss: 0.1305640 Vali Loss: 0.1312314 Test Loss: 0.1414792
Validation loss decreased (inf --> 0.131231).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1076914
	speed: 0.2540s/iter; left time: 5557.6455s
	iters: 200, epoch: 2 | loss: 0.0910843
	speed: 0.1508s/iter; left time: 3284.1530s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.1049388 Vali Loss: 0.1429177 Test Loss: 0.1698473
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0731601
	speed: 0.2437s/iter; left time: 5278.6050s
	iters: 200, epoch: 3 | loss: 0.0696300
	speed: 0.1509s/iter; left time: 3253.8093s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.65s
Steps: 222 | Train Loss: 0.0764824 Vali Loss: 0.1369442 Test Loss: 0.1602100
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615088
	speed: 0.2442s/iter; left time: 5234.5329s
	iters: 200, epoch: 4 | loss: 0.0554535
	speed: 0.1509s/iter; left time: 3219.4774s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0620349 Vali Loss: 0.1350323 Test Loss: 0.1514106
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0579259
	speed: 0.2448s/iter; left time: 5192.0608s
	iters: 200, epoch: 5 | loss: 0.0486382
	speed: 0.1509s/iter; left time: 3185.4335s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.70s
Steps: 222 | Train Loss: 0.0531456 Vali Loss: 0.1327034 Test Loss: 0.1623276
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0489950
	speed: 0.2434s/iter; left time: 5108.4093s
	iters: 200, epoch: 6 | loss: 0.0476412
	speed: 0.1509s/iter; left time: 3151.9696s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.67s
Steps: 222 | Train Loss: 0.0503039 Vali Loss: 0.1323044 Test Loss: 0.1490553
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0417729
	speed: 0.2449s/iter; left time: 5086.4106s
	iters: 200, epoch: 7 | loss: 0.0438373
	speed: 0.1508s/iter; left time: 3117.7414s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0441722 Vali Loss: 0.1319793 Test Loss: 0.1485482
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0418575
	speed: 0.2439s/iter; left time: 5012.2792s
	iters: 200, epoch: 8 | loss: 0.0451170
	speed: 0.1509s/iter; left time: 3085.9589s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0431175 Vali Loss: 0.1302474 Test Loss: 0.1472465
Validation loss decreased (0.131231 --> 0.130247).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0399210
	speed: 0.3619s/iter; left time: 7355.3100s
	iters: 200, epoch: 9 | loss: 0.0380895
	speed: 0.1509s/iter; left time: 3051.8581s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0398416 Vali Loss: 0.1316051 Test Loss: 0.1472638
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0386800
	speed: 0.2431s/iter; left time: 4886.4163s
	iters: 200, epoch: 10 | loss: 0.0344716
	speed: 0.1509s/iter; left time: 3018.7058s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.65s
Steps: 222 | Train Loss: 0.0379387 Vali Loss: 0.1303532 Test Loss: 0.1457916
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0353222
	speed: 0.2439s/iter; left time: 4849.4131s
	iters: 200, epoch: 11 | loss: 0.0372498
	speed: 0.1510s/iter; left time: 2986.0395s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0368926 Vali Loss: 0.1302532 Test Loss: 0.1458937
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0341858
	speed: 0.2434s/iter; left time: 4785.6402s
	iters: 200, epoch: 12 | loss: 0.0336339
	speed: 0.1512s/iter; left time: 2958.1655s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:33.69s
Steps: 222 | Train Loss: 0.0353329 Vali Loss: 0.1303022 Test Loss: 0.1467022
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0377141
	speed: 0.2429s/iter; left time: 4721.8770s
	iters: 200, epoch: 13 | loss: 0.0327437
	speed: 0.1510s/iter; left time: 2920.4951s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:33.65s
Steps: 222 | Train Loss: 0.0343570 Vali Loss: 0.1304975 Test Loss: 0.1463192
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0342746
	speed: 0.2428s/iter; left time: 4666.1737s
	iters: 200, epoch: 14 | loss: 0.0314875
	speed: 0.1510s/iter; left time: 2885.4242s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0333609 Vali Loss: 0.1304372 Test Loss: 0.1466610
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0317349
	speed: 0.2442s/iter; left time: 4637.7605s
	iters: 200, epoch: 15 | loss: 0.0324815
	speed: 0.1510s/iter; left time: 2852.7649s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:33.70s
Steps: 222 | Train Loss: 0.0328630 Vali Loss: 0.1294812 Test Loss: 0.1460295
Validation loss decreased (0.130247 --> 0.129481).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0308250
	speed: 0.2640s/iter; left time: 4955.2156s
	iters: 200, epoch: 16 | loss: 0.0302874
	speed: 0.1511s/iter; left time: 2820.6491s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:33.67s
Steps: 222 | Train Loss: 0.0317885 Vali Loss: 0.1296840 Test Loss: 0.1447311
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0297310
	speed: 0.2440s/iter; left time: 4525.4326s
	iters: 200, epoch: 17 | loss: 0.0337897
	speed: 0.1509s/iter; left time: 2784.6488s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:33.69s
Steps: 222 | Train Loss: 0.0324924 Vali Loss: 0.1298650 Test Loss: 0.1439802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0327406
	speed: 0.2444s/iter; left time: 4478.6303s
	iters: 200, epoch: 18 | loss: 0.0304531
	speed: 0.1510s/iter; left time: 2751.7101s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:33.71s
Steps: 222 | Train Loss: 0.0310170 Vali Loss: 0.1298609 Test Loss: 0.1448158
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0305154
	speed: 0.2431s/iter; left time: 4400.5977s
	iters: 200, epoch: 19 | loss: 0.0303293
	speed: 0.1510s/iter; left time: 2717.8713s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0306258 Vali Loss: 0.1298080 Test Loss: 0.1449693
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0289942
	speed: 0.2438s/iter; left time: 4359.0464s
	iters: 200, epoch: 20 | loss: 0.0332942
	speed: 0.1509s/iter; left time: 2683.5194s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0306169 Vali Loss: 0.1298764 Test Loss: 0.1456302
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0306508
	speed: 0.2438s/iter; left time: 4306.6143s
	iters: 200, epoch: 21 | loss: 0.0334221
	speed: 0.1511s/iter; left time: 2652.8672s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:33.70s
Steps: 222 | Train Loss: 0.0297043 Vali Loss: 0.1299852 Test Loss: 0.1448298
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0314585
	speed: 0.2448s/iter; left time: 4269.4483s
	iters: 200, epoch: 22 | loss: 0.0287072
	speed: 0.1510s/iter; left time: 2617.4695s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:33.69s
Steps: 222 | Train Loss: 0.0293034 Vali Loss: 0.1293367 Test Loss: 0.1445761
Validation loss decreased (0.129481 --> 0.129337).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0282228
	speed: 0.3287s/iter; left time: 5658.7714s
	iters: 200, epoch: 23 | loss: 0.0291260
	speed: 0.1506s/iter; left time: 2577.3763s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0288821 Vali Loss: 0.1297692 Test Loss: 0.1447298
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0286928
	speed: 0.2435s/iter; left time: 4138.5050s
	iters: 200, epoch: 24 | loss: 0.0293555
	speed: 0.1514s/iter; left time: 2558.4112s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:33.69s
Steps: 222 | Train Loss: 0.0289181 Vali Loss: 0.1300133 Test Loss: 0.1445748
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0285964
	speed: 0.2444s/iter; left time: 4099.9724s
	iters: 200, epoch: 25 | loss: 0.0279387
	speed: 0.1511s/iter; left time: 2519.3771s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:33.72s
Steps: 222 | Train Loss: 0.0286038 Vali Loss: 0.1295658 Test Loss: 0.1451767
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0290114
	speed: 0.2437s/iter; left time: 4033.5660s
	iters: 200, epoch: 26 | loss: 0.0282501
	speed: 0.1510s/iter; left time: 2483.9712s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0284651 Vali Loss: 0.1295565 Test Loss: 0.1446520
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0291831
	speed: 0.2432s/iter; left time: 3970.6742s
	iters: 200, epoch: 27 | loss: 0.0270527
	speed: 0.1509s/iter; left time: 2449.6845s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:33.65s
Steps: 222 | Train Loss: 0.0279841 Vali Loss: 0.1293568 Test Loss: 0.1445612
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0275898
	speed: 0.2437s/iter; left time: 3924.5071s
	iters: 200, epoch: 28 | loss: 0.0274742
	speed: 0.1509s/iter; left time: 2415.4232s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:33.67s
Steps: 222 | Train Loss: 0.0277384 Vali Loss: 0.1295084 Test Loss: 0.1444299
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0283001
	speed: 0.2438s/iter; left time: 3872.2725s
	iters: 200, epoch: 29 | loss: 0.0266832
	speed: 0.1510s/iter; left time: 2383.0819s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:33.72s
Steps: 222 | Train Loss: 0.0276323 Vali Loss: 0.1294243 Test Loss: 0.1440056
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0271965
	speed: 0.2446s/iter; left time: 3830.8932s
	iters: 200, epoch: 30 | loss: 0.0269686
	speed: 0.1511s/iter; left time: 2350.9719s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:33.75s
Steps: 222 | Train Loss: 0.0274051 Vali Loss: 0.1295248 Test Loss: 0.1444430
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0282283
	speed: 0.2439s/iter; left time: 3765.5565s
	iters: 200, epoch: 31 | loss: 0.0264869
	speed: 0.1509s/iter; left time: 2314.4732s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:33.65s
Steps: 222 | Train Loss: 0.0272959 Vali Loss: 0.1294084 Test Loss: 0.1442886
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0277842
	speed: 0.2448s/iter; left time: 3726.2919s
	iters: 200, epoch: 32 | loss: 0.0270867
	speed: 0.1508s/iter; left time: 2280.6482s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0272582 Vali Loss: 0.1295411 Test Loss: 0.1444459
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04476502165198326, rmse:0.21157746016979218, mae:0.14457610249519348, rse:0.7494243383407593
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1277713
	speed: 0.1524s/iter; left time: 3367.7168s
	iters: 200, epoch: 1 | loss: 0.1222116
	speed: 0.1512s/iter; left time: 3325.8607s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.72s
Steps: 222 | Train Loss: 0.1310827 Vali Loss: 0.1314986 Test Loss: 0.1413838
Validation loss decreased (inf --> 0.131499).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1123134
	speed: 0.2589s/iter; left time: 5664.1654s
	iters: 200, epoch: 2 | loss: 0.0895690
	speed: 0.1507s/iter; left time: 3281.9701s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.1053310 Vali Loss: 0.1424822 Test Loss: 0.1728299
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0764562
	speed: 0.2455s/iter; left time: 5316.9600s
	iters: 200, epoch: 3 | loss: 0.0666420
	speed: 0.1507s/iter; left time: 3248.0331s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0760686 Vali Loss: 0.1351395 Test Loss: 0.1546024
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0613773
	speed: 0.2445s/iter; left time: 5241.9204s
	iters: 200, epoch: 4 | loss: 0.0563712
	speed: 0.1508s/iter; left time: 3217.3011s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0621595 Vali Loss: 0.1321138 Test Loss: 0.1512521
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0496892
	speed: 0.2445s/iter; left time: 5185.6871s
	iters: 200, epoch: 5 | loss: 0.0562206
	speed: 0.1506s/iter; left time: 3179.9044s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0526680 Vali Loss: 0.1322253 Test Loss: 0.1493326
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0492004
	speed: 0.2438s/iter; left time: 5117.1731s
	iters: 200, epoch: 6 | loss: 0.0477382
	speed: 0.1508s/iter; left time: 3150.7250s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0475868 Vali Loss: 0.1312828 Test Loss: 0.1490040
Validation loss decreased (0.131499 --> 0.131283).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0419366
	speed: 0.3224s/iter; left time: 6695.0744s
	iters: 200, epoch: 7 | loss: 0.0420361
	speed: 0.1507s/iter; left time: 3115.0225s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0442438 Vali Loss: 0.1307410 Test Loss: 0.1472384
Validation loss decreased (0.131283 --> 0.130741).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0391519
	speed: 0.2830s/iter; left time: 5815.5785s
	iters: 200, epoch: 8 | loss: 0.0431754
	speed: 0.1505s/iter; left time: 3076.7774s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.62s
Steps: 222 | Train Loss: 0.0422115 Vali Loss: 0.1305794 Test Loss: 0.1458655
Validation loss decreased (0.130741 --> 0.130579).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0437125
	speed: 0.3324s/iter; left time: 6755.6541s
	iters: 200, epoch: 9 | loss: 0.0385695
	speed: 0.1505s/iter; left time: 3042.8917s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.59s
Steps: 222 | Train Loss: 0.0403145 Vali Loss: 0.1303221 Test Loss: 0.1465409
Validation loss decreased (0.130579 --> 0.130322).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0377361
	speed: 0.2736s/iter; left time: 5499.2319s
	iters: 200, epoch: 10 | loss: 0.0380812
	speed: 0.1505s/iter; left time: 3010.1065s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.63s
Steps: 222 | Train Loss: 0.0373698 Vali Loss: 0.1308521 Test Loss: 0.1461814
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0337272
	speed: 0.2454s/iter; left time: 4878.0365s
	iters: 200, epoch: 11 | loss: 0.0343018
	speed: 0.1511s/iter; left time: 2988.2622s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.75s
Steps: 222 | Train Loss: 0.0358551 Vali Loss: 0.1304143 Test Loss: 0.1449118
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0373693
	speed: 0.2448s/iter; left time: 4812.0522s
	iters: 200, epoch: 12 | loss: 0.0341097
	speed: 0.1507s/iter; left time: 2946.6906s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:33.62s
Steps: 222 | Train Loss: 0.0360539 Vali Loss: 0.1305379 Test Loss: 0.1451299
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0337989
	speed: 0.2454s/iter; left time: 4769.8260s
	iters: 200, epoch: 13 | loss: 0.0329861
	speed: 0.1507s/iter; left time: 2914.1039s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:33.65s
Steps: 222 | Train Loss: 0.0341197 Vali Loss: 0.1302531 Test Loss: 0.1441819
Validation loss decreased (0.130322 --> 0.130253).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0325644
	speed: 0.2666s/iter; left time: 5121.9451s
	iters: 200, epoch: 14 | loss: 0.0336830
	speed: 0.1508s/iter; left time: 2881.8349s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:33.70s
Steps: 222 | Train Loss: 0.0332364 Vali Loss: 0.1302444 Test Loss: 0.1441851
Validation loss decreased (0.130253 --> 0.130244).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0308316
	speed: 0.3142s/iter; left time: 5968.2313s
	iters: 200, epoch: 15 | loss: 0.0316279
	speed: 0.1507s/iter; left time: 2847.4780s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:33.69s
Steps: 222 | Train Loss: 0.0318058 Vali Loss: 0.1297835 Test Loss: 0.1440799
Validation loss decreased (0.130244 --> 0.129784).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0322279
	speed: 0.2682s/iter; left time: 5034.2289s
	iters: 200, epoch: 16 | loss: 0.0310773
	speed: 0.1508s/iter; left time: 2816.0390s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0321499 Vali Loss: 0.1293126 Test Loss: 0.1436306
Validation loss decreased (0.129784 --> 0.129313).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0315645
	speed: 0.2628s/iter; left time: 4874.0473s
	iters: 200, epoch: 17 | loss: 0.0302387
	speed: 0.1507s/iter; left time: 2780.4126s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:33.71s
Steps: 222 | Train Loss: 0.0309401 Vali Loss: 0.1297637 Test Loss: 0.1440657
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0309997
	speed: 0.2440s/iter; left time: 4472.3623s
	iters: 200, epoch: 18 | loss: 0.0296499
	speed: 0.1512s/iter; left time: 2755.5900s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:33.72s
Steps: 222 | Train Loss: 0.0302985 Vali Loss: 0.1294017 Test Loss: 0.1443210
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0324319
	speed: 0.2445s/iter; left time: 4426.1961s
	iters: 200, epoch: 19 | loss: 0.0312855
	speed: 0.1507s/iter; left time: 2712.5049s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0302120 Vali Loss: 0.1297466 Test Loss: 0.1438735
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0312613
	speed: 0.2444s/iter; left time: 4369.9418s
	iters: 200, epoch: 20 | loss: 0.0282501
	speed: 0.1509s/iter; left time: 2684.0854s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0294356 Vali Loss: 0.1294662 Test Loss: 0.1434128
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0291080
	speed: 0.2446s/iter; left time: 4320.5200s
	iters: 200, epoch: 21 | loss: 0.0285228
	speed: 0.1506s/iter; left time: 2645.2138s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:33.67s
Steps: 222 | Train Loss: 0.0290826 Vali Loss: 0.1297365 Test Loss: 0.1434334
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0304701
	speed: 0.2450s/iter; left time: 4272.4908s
	iters: 200, epoch: 22 | loss: 0.0283012
	speed: 0.1505s/iter; left time: 2609.8814s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:33.62s
Steps: 222 | Train Loss: 0.0289869 Vali Loss: 0.1294800 Test Loss: 0.1432113
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0297979
	speed: 0.2456s/iter; left time: 4228.0077s
	iters: 200, epoch: 23 | loss: 0.0284745
	speed: 0.1507s/iter; left time: 2580.2112s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:33.74s
Steps: 222 | Train Loss: 0.0284959 Vali Loss: 0.1296514 Test Loss: 0.1431438
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0271147
	speed: 0.2453s/iter; left time: 4169.5458s
	iters: 200, epoch: 24 | loss: 0.0292228
	speed: 0.1508s/iter; left time: 2547.2131s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:33.63s
Steps: 222 | Train Loss: 0.0284145 Vali Loss: 0.1296944 Test Loss: 0.1434468
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0272436
	speed: 0.2451s/iter; left time: 4110.6383s
	iters: 200, epoch: 25 | loss: 0.0278408
	speed: 0.1506s/iter; left time: 2510.4573s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:33.60s
Steps: 222 | Train Loss: 0.0280318 Vali Loss: 0.1295018 Test Loss: 0.1427727
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0268847
	speed: 0.2463s/iter; left time: 4076.7502s
	iters: 200, epoch: 26 | loss: 0.0273354
	speed: 0.1511s/iter; left time: 2485.5133s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:33.75s
Steps: 222 | Train Loss: 0.0278296 Vali Loss: 0.1295717 Test Loss: 0.1434145
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04377174749970436, rmse:0.20921698212623596, mae:0.14363059401512146, rse:0.7410634160041809
Intermediate time for DE and pred_len 168: 00h:39m:34.11s
Intermediate time for DE: 01h:25m:12.68s

=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1051457
	speed: 0.1703s/iter; left time: 3781.7709s
	iters: 200, epoch: 1 | loss: 0.0932204
	speed: 0.1458s/iter; left time: 3221.5621s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:32.93s
Steps: 223 | Train Loss: 0.1071621 Vali Loss: 0.1028725 Test Loss: 0.1150246
Validation loss decreased (inf --> 0.102873).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0896473
	speed: 0.2421s/iter; left time: 5320.6976s
	iters: 200, epoch: 2 | loss: 0.0852750
	speed: 0.1465s/iter; left time: 3204.1615s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:32.74s
Steps: 223 | Train Loss: 0.0888812 Vali Loss: 0.1054194 Test Loss: 0.1180188
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0801186
	speed: 0.2385s/iter; left time: 5189.3113s
	iters: 200, epoch: 3 | loss: 0.0752198
	speed: 0.1471s/iter; left time: 3185.6468s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.95s
Steps: 223 | Train Loss: 0.0808936 Vali Loss: 0.1088918 Test Loss: 0.1218244
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0764754
	speed: 0.2386s/iter; left time: 5136.7827s
	iters: 200, epoch: 4 | loss: 0.0668249
	speed: 0.1475s/iter; left time: 3162.1212s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:32.97s
Steps: 223 | Train Loss: 0.0712032 Vali Loss: 0.1164811 Test Loss: 0.1314963
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0584339
	speed: 0.2388s/iter; left time: 5087.6700s
	iters: 200, epoch: 5 | loss: 0.0615544
	speed: 0.1467s/iter; left time: 3111.0655s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:32.85s
Steps: 223 | Train Loss: 0.0614232 Vali Loss: 0.1146671 Test Loss: 0.1260481
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0533759
	speed: 0.2367s/iter; left time: 4990.1201s
	iters: 200, epoch: 6 | loss: 0.0495681
	speed: 0.1466s/iter; left time: 3077.0692s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:32.82s
Steps: 223 | Train Loss: 0.0537273 Vali Loss: 0.1115397 Test Loss: 0.1244299
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0473040
	speed: 0.2379s/iter; left time: 4962.2669s
	iters: 200, epoch: 7 | loss: 0.0490480
	speed: 0.1467s/iter; left time: 3046.3001s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:32.84s
Steps: 223 | Train Loss: 0.0485017 Vali Loss: 0.1118774 Test Loss: 0.1266170
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0428582
	speed: 0.2373s/iter; left time: 4897.0955s
	iters: 200, epoch: 8 | loss: 0.0423327
	speed: 0.1464s/iter; left time: 3006.2327s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:32.77s
Steps: 223 | Train Loss: 0.0436265 Vali Loss: 0.1113263 Test Loss: 0.1248961
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0409019
	speed: 0.2371s/iter; left time: 4841.5272s
	iters: 200, epoch: 9 | loss: 0.0388029
	speed: 0.1463s/iter; left time: 2971.7896s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:32.73s
Steps: 223 | Train Loss: 0.0416113 Vali Loss: 0.1129987 Test Loss: 0.1294562
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0386123
	speed: 0.2363s/iter; left time: 4771.1943s
	iters: 200, epoch: 10 | loss: 0.0380670
	speed: 0.1463s/iter; left time: 2940.1304s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:32.74s
Steps: 223 | Train Loss: 0.0399942 Vali Loss: 0.1123616 Test Loss: 0.1261321
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0382017
	speed: 0.2373s/iter; left time: 4739.1549s
	iters: 200, epoch: 11 | loss: 0.0367740
	speed: 0.1463s/iter; left time: 2906.8815s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:32.74s
Steps: 223 | Train Loss: 0.0381936 Vali Loss: 0.1106567 Test Loss: 0.1257289
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.028743868693709373, rmse:0.1695401668548584, mae:0.11502459645271301, rse:0.5848655104637146
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1056844
	speed: 0.1474s/iter; left time: 3273.2981s
	iters: 200, epoch: 1 | loss: 0.0887723
	speed: 0.1462s/iter; left time: 3231.8296s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:32.79s
Steps: 223 | Train Loss: 0.1076930 Vali Loss: 0.1034200 Test Loss: 0.1157358
Validation loss decreased (inf --> 0.103420).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0871905
	speed: 0.2427s/iter; left time: 5333.6320s
	iters: 200, epoch: 2 | loss: 0.0820583
	speed: 0.1465s/iter; left time: 3205.9718s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:32.78s
Steps: 223 | Train Loss: 0.0888926 Vali Loss: 0.1046297 Test Loss: 0.1171767
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0843876
	speed: 0.2379s/iter; left time: 5175.5638s
	iters: 200, epoch: 3 | loss: 0.0818222
	speed: 0.1464s/iter; left time: 3169.5225s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.81s
Steps: 223 | Train Loss: 0.0815588 Vali Loss: 0.1086011 Test Loss: 0.1196759
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0724633
	speed: 0.2380s/iter; left time: 5125.0562s
	iters: 200, epoch: 4 | loss: 0.0665326
	speed: 0.1466s/iter; left time: 3142.6231s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:32.82s
Steps: 223 | Train Loss: 0.0715411 Vali Loss: 0.1171121 Test Loss: 0.1247998
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0588575
	speed: 0.2378s/iter; left time: 5066.5772s
	iters: 200, epoch: 5 | loss: 0.0584292
	speed: 0.1465s/iter; left time: 3107.7364s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:32.80s
Steps: 223 | Train Loss: 0.0616918 Vali Loss: 0.1111074 Test Loss: 0.1225118
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0505120
	speed: 0.2374s/iter; left time: 5005.2128s
	iters: 200, epoch: 6 | loss: 0.0511305
	speed: 0.1461s/iter; left time: 3066.8633s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:32.74s
Steps: 223 | Train Loss: 0.0532696 Vali Loss: 0.1103224 Test Loss: 0.1216622
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0483326
	speed: 0.2370s/iter; left time: 4944.9578s
	iters: 200, epoch: 7 | loss: 0.0455461
	speed: 0.1462s/iter; left time: 3035.8085s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:32.74s
Steps: 223 | Train Loss: 0.0479013 Vali Loss: 0.1107165 Test Loss: 0.1228329
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0439964
	speed: 0.2375s/iter; left time: 4902.2376s
	iters: 200, epoch: 8 | loss: 0.0449820
	speed: 0.1463s/iter; left time: 3004.8574s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:32.75s
Steps: 223 | Train Loss: 0.0444204 Vali Loss: 0.1109379 Test Loss: 0.1237228
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0418664
	speed: 0.2376s/iter; left time: 4851.4845s
	iters: 200, epoch: 9 | loss: 0.0413343
	speed: 0.1464s/iter; left time: 2974.5677s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:32.80s
Steps: 223 | Train Loss: 0.0413205 Vali Loss: 0.1107434 Test Loss: 0.1236369
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0371369
	speed: 0.2377s/iter; left time: 4800.6975s
	iters: 200, epoch: 10 | loss: 0.0389452
	speed: 0.1463s/iter; left time: 2938.9695s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:32.78s
Steps: 223 | Train Loss: 0.0396608 Vali Loss: 0.1118143 Test Loss: 0.1250867
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0370215
	speed: 0.2380s/iter; left time: 4752.2605s
	iters: 200, epoch: 11 | loss: 0.0395964
	speed: 0.1465s/iter; left time: 2910.3170s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:32.80s
Steps: 223 | Train Loss: 0.0381358 Vali Loss: 0.1105671 Test Loss: 0.1246427
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.029005983844399452, rmse:0.17031143605709076, mae:0.11573578417301178, rse:0.5875261425971985
Intermediate time for GB and pred_len 24: 00h:14m:21.02s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1156728
	speed: 0.1709s/iter; left time: 3777.5477s
	iters: 200, epoch: 1 | loss: 0.1047598
	speed: 0.1498s/iter; left time: 3295.9343s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.44s
Steps: 222 | Train Loss: 0.1199832 Vali Loss: 0.1229378 Test Loss: 0.1452433
Validation loss decreased (inf --> 0.122938).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1146321
	speed: 0.2501s/iter; left time: 5472.0933s
	iters: 200, epoch: 2 | loss: 0.0956471
	speed: 0.1487s/iter; left time: 3238.5382s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.31s
Steps: 222 | Train Loss: 0.1067851 Vali Loss: 0.1402225 Test Loss: 0.1606241
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0768545
	speed: 0.2397s/iter; left time: 5190.7345s
	iters: 200, epoch: 3 | loss: 0.0670673
	speed: 0.1484s/iter; left time: 3198.8019s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.08s
Steps: 222 | Train Loss: 0.0784635 Vali Loss: 0.1549436 Test Loss: 0.1626762
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615202
	speed: 0.2398s/iter; left time: 5139.7258s
	iters: 200, epoch: 4 | loss: 0.0553973
	speed: 0.1484s/iter; left time: 3166.4134s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0621905 Vali Loss: 0.1486871 Test Loss: 0.1585362
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0881757
	speed: 0.2398s/iter; left time: 5086.7055s
	iters: 200, epoch: 5 | loss: 0.0501511
	speed: 0.1487s/iter; left time: 3139.5891s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.12s
Steps: 222 | Train Loss: 0.0527247 Vali Loss: 0.1394723 Test Loss: 0.1576203
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0477496
	speed: 0.2399s/iter; left time: 5035.0269s
	iters: 200, epoch: 6 | loss: 0.0474090
	speed: 0.1484s/iter; left time: 3101.0034s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.11s
Steps: 222 | Train Loss: 0.0484712 Vali Loss: 0.1370355 Test Loss: 0.1556998
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0412586
	speed: 0.2400s/iter; left time: 4983.5867s
	iters: 200, epoch: 7 | loss: 0.0407524
	speed: 0.1485s/iter; left time: 3069.0243s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.15s
Steps: 222 | Train Loss: 0.0431573 Vali Loss: 0.1348506 Test Loss: 0.1544424
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0423980
	speed: 0.2402s/iter; left time: 4935.6244s
	iters: 200, epoch: 8 | loss: 0.0422410
	speed: 0.1487s/iter; left time: 3039.8471s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0418209 Vali Loss: 0.1379111 Test Loss: 0.1536960
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0395810
	speed: 0.2392s/iter; left time: 4861.3254s
	iters: 200, epoch: 9 | loss: 0.0401174
	speed: 0.1485s/iter; left time: 3003.8338s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.08s
Steps: 222 | Train Loss: 0.0393178 Vali Loss: 0.1330695 Test Loss: 0.1526520
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0376254
	speed: 0.2403s/iter; left time: 4830.8311s
	iters: 200, epoch: 10 | loss: 0.0342666
	speed: 0.1487s/iter; left time: 2974.0619s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.20s
Steps: 222 | Train Loss: 0.0370651 Vali Loss: 0.1324363 Test Loss: 0.1522708
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0352456
	speed: 0.2408s/iter; left time: 4787.1133s
	iters: 200, epoch: 11 | loss: 0.0371032
	speed: 0.1487s/iter; left time: 2940.5256s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.19s
Steps: 222 | Train Loss: 0.0362890 Vali Loss: 0.1320634 Test Loss: 0.1527143
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04341920092701912, rmse:0.20837274193763733, mae:0.1452433168888092, rse:0.7205820083618164
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1165444
	speed: 0.1494s/iter; left time: 3302.5688s
	iters: 200, epoch: 1 | loss: 0.1111383
	speed: 0.1485s/iter; left time: 3267.8121s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.1201055 Vali Loss: 0.1230098 Test Loss: 0.1451796
Validation loss decreased (inf --> 0.123010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1108082
	speed: 0.2554s/iter; left time: 5588.7955s
	iters: 200, epoch: 2 | loss: 0.0935105
	speed: 0.1486s/iter; left time: 3235.8232s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.24s
Steps: 222 | Train Loss: 0.1068995 Vali Loss: 0.1398159 Test Loss: 0.1669322
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0784802
	speed: 0.2413s/iter; left time: 5226.1157s
	iters: 200, epoch: 3 | loss: 0.0735279
	speed: 0.1487s/iter; left time: 3206.0612s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.20s
Steps: 222 | Train Loss: 0.0795587 Vali Loss: 0.1421815 Test Loss: 0.1656734
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0637211
	speed: 0.2420s/iter; left time: 5186.7990s
	iters: 200, epoch: 4 | loss: 0.0617426
	speed: 0.1487s/iter; left time: 3171.8615s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.15s
Steps: 222 | Train Loss: 0.0648935 Vali Loss: 0.1376564 Test Loss: 0.1604086
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0552284
	speed: 0.2417s/iter; left time: 5127.4756s
	iters: 200, epoch: 5 | loss: 0.0531027
	speed: 0.1486s/iter; left time: 3137.1055s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.17s
Steps: 222 | Train Loss: 0.0553986 Vali Loss: 0.1340457 Test Loss: 0.1575819
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0478428
	speed: 0.2412s/iter; left time: 5063.8890s
	iters: 200, epoch: 6 | loss: 0.0523911
	speed: 0.1486s/iter; left time: 3103.9163s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0490555 Vali Loss: 0.1340929 Test Loss: 0.1550300
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0459050
	speed: 0.2413s/iter; left time: 5011.3346s
	iters: 200, epoch: 7 | loss: 0.0428679
	speed: 0.1485s/iter; left time: 3069.9799s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0447298 Vali Loss: 0.1341426 Test Loss: 0.1539580
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0405288
	speed: 0.2414s/iter; left time: 4960.5656s
	iters: 200, epoch: 8 | loss: 0.0405174
	speed: 0.1482s/iter; left time: 3030.8315s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0419976 Vali Loss: 0.1378684 Test Loss: 0.1581065
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0382658
	speed: 0.2406s/iter; left time: 4891.0947s
	iters: 200, epoch: 9 | loss: 0.0395453
	speed: 0.1486s/iter; left time: 3005.1565s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.14s
Steps: 222 | Train Loss: 0.0404064 Vali Loss: 0.1317059 Test Loss: 0.1522986
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0378837
	speed: 0.2412s/iter; left time: 4848.7059s
	iters: 200, epoch: 10 | loss: 0.0369272
	speed: 0.1485s/iter; left time: 2970.4434s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.13s
Steps: 222 | Train Loss: 0.0381774 Vali Loss: 0.1314865 Test Loss: 0.1513584
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0358450
	speed: 0.2409s/iter; left time: 4789.2445s
	iters: 200, epoch: 11 | loss: 0.0374405
	speed: 0.1488s/iter; left time: 2943.8718s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.15s
Steps: 222 | Train Loss: 0.0363881 Vali Loss: 0.1307979 Test Loss: 0.1516058
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04355882108211517, rmse:0.20870749652385712, mae:0.1451796293258667, rse:0.7217395901679993
Intermediate time for GB and pred_len 96: 00h:14m:36.03s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1177407
	speed: 0.1745s/iter; left time: 3857.2506s
	iters: 200, epoch: 1 | loss: 0.1147017
	speed: 0.1503s/iter; left time: 3306.9125s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.78s
Steps: 222 | Train Loss: 0.1225829 Vali Loss: 0.1266081 Test Loss: 0.1497908
Validation loss decreased (inf --> 0.126608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1123300
	speed: 0.2887s/iter; left time: 6315.4126s
	iters: 200, epoch: 2 | loss: 0.0922024
	speed: 0.1506s/iter; left time: 3280.8772s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.60s
Steps: 222 | Train Loss: 0.1073465 Vali Loss: 0.1534391 Test Loss: 0.1633927
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0715112
	speed: 0.2422s/iter; left time: 5244.5989s
	iters: 200, epoch: 3 | loss: 0.0678034
	speed: 0.1507s/iter; left time: 3249.4771s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.0751841 Vali Loss: 0.1467895 Test Loss: 0.1613366
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0583339
	speed: 0.2417s/iter; left time: 5180.5349s
	iters: 200, epoch: 4 | loss: 0.0547504
	speed: 0.1506s/iter; left time: 3213.8292s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.62s
Steps: 222 | Train Loss: 0.0591856 Vali Loss: 0.1385507 Test Loss: 0.1562234
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0566366
	speed: 0.2418s/iter; left time: 5129.7138s
	iters: 200, epoch: 5 | loss: 0.0517352
	speed: 0.1507s/iter; left time: 3182.7699s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.61s
Steps: 222 | Train Loss: 0.0521256 Vali Loss: 0.1398461 Test Loss: 0.1579931
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0485455
	speed: 0.2414s/iter; left time: 5066.7254s
	iters: 200, epoch: 6 | loss: 0.0483025
	speed: 0.1508s/iter; left time: 3149.5819s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.60s
Steps: 222 | Train Loss: 0.0479918 Vali Loss: 0.1388285 Test Loss: 0.1559225
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0412977
	speed: 0.2417s/iter; left time: 5019.4109s
	iters: 200, epoch: 7 | loss: 0.0430455
	speed: 0.1509s/iter; left time: 3118.0825s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.60s
Steps: 222 | Train Loss: 0.0437611 Vali Loss: 0.1360448 Test Loss: 0.1562288
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0412615
	speed: 0.2412s/iter; left time: 4956.3507s
	iters: 200, epoch: 8 | loss: 0.0435497
	speed: 0.1508s/iter; left time: 3084.3684s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.60s
Steps: 222 | Train Loss: 0.0422933 Vali Loss: 0.1364408 Test Loss: 0.1566917
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0399560
	speed: 0.2421s/iter; left time: 4920.5603s
	iters: 200, epoch: 9 | loss: 0.0365216
	speed: 0.1508s/iter; left time: 3049.0123s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.62s
Steps: 222 | Train Loss: 0.0392865 Vali Loss: 0.1353271 Test Loss: 0.1550491
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0372904
	speed: 0.2423s/iter; left time: 4869.9806s
	iters: 200, epoch: 10 | loss: 0.0402687
	speed: 0.1511s/iter; left time: 3022.6342s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.69s
Steps: 222 | Train Loss: 0.0405217 Vali Loss: 0.1355167 Test Loss: 0.1553616
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0355937
	speed: 0.2413s/iter; left time: 4797.8155s
	iters: 200, epoch: 11 | loss: 0.0380037
	speed: 0.1509s/iter; left time: 2984.6356s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.60s
Steps: 222 | Train Loss: 0.0374547 Vali Loss: 0.1346184 Test Loss: 0.1547808
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.045506544411182404, rmse:0.21332262456417084, mae:0.14979074895381927, rse:0.7396202087402344
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1164795
	speed: 0.1520s/iter; left time: 3360.0338s
	iters: 200, epoch: 1 | loss: 0.1178308
	speed: 0.1507s/iter; left time: 3315.2727s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.64s
Steps: 222 | Train Loss: 0.1227937 Vali Loss: 0.1269568 Test Loss: 0.1500853
Validation loss decreased (inf --> 0.126957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1080633
	speed: 0.2832s/iter; left time: 6196.1052s
	iters: 200, epoch: 2 | loss: 0.0911027
	speed: 0.1506s/iter; left time: 3279.7866s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.63s
Steps: 222 | Train Loss: 0.1069387 Vali Loss: 0.1472872 Test Loss: 0.1704258
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0766009
	speed: 0.2439s/iter; left time: 5282.7984s
	iters: 200, epoch: 3 | loss: 0.0693914
	speed: 0.1509s/iter; left time: 3253.0212s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.70s
Steps: 222 | Train Loss: 0.0753113 Vali Loss: 0.1423926 Test Loss: 0.1651071
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0579466
	speed: 0.2448s/iter; left time: 5246.9351s
	iters: 200, epoch: 4 | loss: 0.0602810
	speed: 0.1509s/iter; left time: 3220.0626s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0602860 Vali Loss: 0.1388860 Test Loss: 0.1613450
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0529091
	speed: 0.2440s/iter; left time: 5175.5351s
	iters: 200, epoch: 5 | loss: 0.0478933
	speed: 0.1510s/iter; left time: 3188.4299s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0532050 Vali Loss: 0.1397931 Test Loss: 0.1621394
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0488900
	speed: 0.2441s/iter; left time: 5124.3289s
	iters: 200, epoch: 6 | loss: 0.0479902
	speed: 0.1508s/iter; left time: 3151.2421s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0490049 Vali Loss: 0.1387042 Test Loss: 0.1603853
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0458506
	speed: 0.2432s/iter; left time: 5051.5493s
	iters: 200, epoch: 7 | loss: 0.0413319
	speed: 0.1508s/iter; left time: 3117.2317s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.67s
Steps: 222 | Train Loss: 0.0447227 Vali Loss: 0.1376807 Test Loss: 0.1579818
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0406756
	speed: 0.2439s/iter; left time: 5010.5233s
	iters: 200, epoch: 8 | loss: 0.0401300
	speed: 0.1510s/iter; left time: 3086.5883s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0428238 Vali Loss: 0.1362697 Test Loss: 0.1593084
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0425120
	speed: 0.2438s/iter; left time: 4955.0447s
	iters: 200, epoch: 9 | loss: 0.0428176
	speed: 0.1510s/iter; left time: 3053.1021s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.67s
Steps: 222 | Train Loss: 0.0406100 Vali Loss: 0.1351584 Test Loss: 0.1575931
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0391058
	speed: 0.2447s/iter; left time: 4919.7646s
	iters: 200, epoch: 10 | loss: 0.0359502
	speed: 0.1509s/iter; left time: 3018.1160s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.66s
Steps: 222 | Train Loss: 0.0388262 Vali Loss: 0.1357430 Test Loss: 0.1580252
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0361103
	speed: 0.2442s/iter; left time: 4854.2990s
	iters: 200, epoch: 11 | loss: 0.0373988
	speed: 0.1510s/iter; left time: 2987.8669s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.68s
Steps: 222 | Train Loss: 0.0368991 Vali Loss: 0.1348735 Test Loss: 0.1577474
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.045674242079257965, rmse:0.2137153297662735, mae:0.15008527040481567, rse:0.7409817576408386
Intermediate time for GB and pred_len 168: 00h:14m:55.51sIntermediate time for GB: 00h:43m:52.56s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1083394
	speed: 0.0573s/iter; left time: 1277.9257s
	iters: 200, epoch: 1 | loss: 0.0949330
	speed: 0.0326s/iter; left time: 723.3954s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.1146521 Vali Loss: 0.0854233 Test Loss: 0.0978887
Validation loss decreased (inf --> 0.085423).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0694569
	speed: 0.0622s/iter; left time: 1372.0866s
	iters: 200, epoch: 2 | loss: 0.0682702
	speed: 0.0326s/iter; left time: 715.5298s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0716935 Vali Loss: 0.0656114 Test Loss: 0.0731752
Validation loss decreased (0.085423 --> 0.065611).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0638887
	speed: 0.0622s/iter; left time: 1358.9573s
	iters: 200, epoch: 3 | loss: 0.0625745
	speed: 0.0326s/iter; left time: 709.3744s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0642866 Vali Loss: 0.0630241 Test Loss: 0.0710565
Validation loss decreased (0.065611 --> 0.063024).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0611238
	speed: 0.0620s/iter; left time: 1340.0211s
	iters: 200, epoch: 4 | loss: 0.0643910
	speed: 0.0325s/iter; left time: 699.0201s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0619596 Vali Loss: 0.0643963 Test Loss: 0.0716253
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0614629
	speed: 0.0593s/iter; left time: 1268.8093s
	iters: 200, epoch: 5 | loss: 0.0591143
	speed: 0.0325s/iter; left time: 692.8271s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.45s
Steps: 224 | Train Loss: 0.0598301 Vali Loss: 0.0612322 Test Loss: 0.0694189
Validation loss decreased (0.063024 --> 0.061232).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0568408
	speed: 0.0610s/iter; left time: 1292.2982s
	iters: 200, epoch: 6 | loss: 0.0567278
	speed: 0.0325s/iter; left time: 685.4597s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0577446 Vali Loss: 0.0609693 Test Loss: 0.0682407
Validation loss decreased (0.061232 --> 0.060969).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0562621
	speed: 0.0612s/iter; left time: 1282.4153s
	iters: 200, epoch: 7 | loss: 0.0554868
	speed: 0.0325s/iter; left time: 678.5637s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0561681 Vali Loss: 0.0597783 Test Loss: 0.0675127
Validation loss decreased (0.060969 --> 0.059778).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0569908
	speed: 0.0611s/iter; left time: 1266.2956s
	iters: 200, epoch: 8 | loss: 0.0577169
	speed: 0.0325s/iter; left time: 671.4704s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0544420 Vali Loss: 0.0602443 Test Loss: 0.0683316
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0521781
	speed: 0.0602s/iter; left time: 1235.5452s
	iters: 200, epoch: 9 | loss: 0.0503141
	speed: 0.0327s/iter; left time: 667.1567s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0526811 Vali Loss: 0.0609316 Test Loss: 0.0681847
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0519583
	speed: 0.0596s/iter; left time: 1208.3835s
	iters: 200, epoch: 10 | loss: 0.0487051
	speed: 0.0329s/iter; left time: 664.1026s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0512578 Vali Loss: 0.0613501 Test Loss: 0.0695660
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0517822
	speed: 0.0598s/iter; left time: 1200.4242s
	iters: 200, epoch: 11 | loss: 0.0482223
	speed: 0.0327s/iter; left time: 652.0808s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0498223 Vali Loss: 0.0620379 Test Loss: 0.0702392
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0494305
	speed: 0.0599s/iter; left time: 1188.9516s
	iters: 200, epoch: 12 | loss: 0.0481998
	speed: 0.0327s/iter; left time: 645.6828s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0483653 Vali Loss: 0.0612045 Test Loss: 0.0701841
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0462038
	speed: 0.0607s/iter; left time: 1190.1800s
	iters: 200, epoch: 13 | loss: 0.0461890
	speed: 0.0328s/iter; left time: 639.9237s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.0470476 Vali Loss: 0.0618377 Test Loss: 0.0701277
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0474969
	speed: 0.0600s/iter; left time: 1164.1216s
	iters: 200, epoch: 14 | loss: 0.0462358
	speed: 0.0327s/iter; left time: 631.0103s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0460021 Vali Loss: 0.0619138 Test Loss: 0.0706668
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0441642
	speed: 0.0601s/iter; left time: 1152.4789s
	iters: 200, epoch: 15 | loss: 0.0437523
	speed: 0.0327s/iter; left time: 623.8509s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.52s
Steps: 224 | Train Loss: 0.0449358 Vali Loss: 0.0615214 Test Loss: 0.0704811
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0440189
	speed: 0.0606s/iter; left time: 1146.9950s
	iters: 200, epoch: 16 | loss: 0.0432764
	speed: 0.0328s/iter; left time: 618.5290s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0439870 Vali Loss: 0.0616211 Test Loss: 0.0707664
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0423084
	speed: 0.0598s/iter; left time: 1118.4282s
	iters: 200, epoch: 17 | loss: 0.0415025
	speed: 0.0328s/iter; left time: 610.5798s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0431494 Vali Loss: 0.0620262 Test Loss: 0.0715410
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01133799646049738, rmse:0.10648002475500107, mae:0.06751272827386856, rse:0.3133578300476074
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1059176
	speed: 0.0346s/iter; left time: 772.7058s
	iters: 200, epoch: 1 | loss: 0.0954594
	speed: 0.0327s/iter; left time: 726.2629s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.1132807 Vali Loss: 0.0858611 Test Loss: 0.0978220
Validation loss decreased (inf --> 0.085861).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0672946
	speed: 0.0635s/iter; left time: 1401.7909s
	iters: 200, epoch: 2 | loss: 0.0662497
	speed: 0.0326s/iter; left time: 715.6569s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0716624 Vali Loss: 0.0645302 Test Loss: 0.0728868
Validation loss decreased (0.085861 --> 0.064530).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0636461
	speed: 0.0619s/iter; left time: 1352.4904s
	iters: 200, epoch: 3 | loss: 0.0644167
	speed: 0.0328s/iter; left time: 712.8898s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0639991 Vali Loss: 0.0630432 Test Loss: 0.0709006
Validation loss decreased (0.064530 --> 0.063043).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0621769
	speed: 0.0621s/iter; left time: 1342.1702s
	iters: 200, epoch: 4 | loss: 0.0600844
	speed: 0.0326s/iter; left time: 701.0833s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0615069 Vali Loss: 0.0610647 Test Loss: 0.0695123
Validation loss decreased (0.063043 --> 0.061065).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0606961
	speed: 0.0630s/iter; left time: 1348.5926s
	iters: 200, epoch: 5 | loss: 0.0597096
	speed: 0.0327s/iter; left time: 696.7172s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0594661 Vali Loss: 0.0604619 Test Loss: 0.0694347
Validation loss decreased (0.061065 --> 0.060462).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0590119
	speed: 0.0623s/iter; left time: 1319.7344s
	iters: 200, epoch: 6 | loss: 0.0569254
	speed: 0.0327s/iter; left time: 690.2356s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0579130 Vali Loss: 0.0610369 Test Loss: 0.0684163
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0548901
	speed: 0.0603s/iter; left time: 1263.4103s
	iters: 200, epoch: 7 | loss: 0.0539524
	speed: 0.0327s/iter; left time: 680.9987s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0559329 Vali Loss: 0.0594218 Test Loss: 0.0678336
Validation loss decreased (0.060462 --> 0.059422).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0538018
	speed: 0.0648s/iter; left time: 1344.4634s
	iters: 200, epoch: 8 | loss: 0.0530818
	speed: 0.0325s/iter; left time: 671.3128s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0542583 Vali Loss: 0.0599612 Test Loss: 0.0689581
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0552536
	speed: 0.0601s/iter; left time: 1232.8386s
	iters: 200, epoch: 9 | loss: 0.0516640
	speed: 0.0325s/iter; left time: 663.1668s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0527426 Vali Loss: 0.0591997 Test Loss: 0.0679362
Validation loss decreased (0.059422 --> 0.059200).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0536080
	speed: 0.0617s/iter; left time: 1251.9853s
	iters: 200, epoch: 10 | loss: 0.0499571
	speed: 0.0325s/iter; left time: 656.0193s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0512842 Vali Loss: 0.0599653 Test Loss: 0.0687808
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0517187
	speed: 0.0604s/iter; left time: 1210.6819s
	iters: 200, epoch: 11 | loss: 0.0499973
	speed: 0.0326s/iter; left time: 651.0087s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0497935 Vali Loss: 0.0604572 Test Loss: 0.0696274
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0468627
	speed: 0.0595s/iter; left time: 1181.2420s
	iters: 200, epoch: 12 | loss: 0.0489540
	speed: 0.0328s/iter; left time: 648.2592s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0483913 Vali Loss: 0.0602030 Test Loss: 0.0697745
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0496078
	speed: 0.0598s/iter; left time: 1172.5827s
	iters: 200, epoch: 13 | loss: 0.0476634
	speed: 0.0323s/iter; left time: 630.7452s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0473625 Vali Loss: 0.0604081 Test Loss: 0.0700828
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0464205
	speed: 0.0594s/iter; left time: 1152.2500s
	iters: 200, epoch: 14 | loss: 0.0435993
	speed: 0.0323s/iter; left time: 623.7475s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0461338 Vali Loss: 0.0605141 Test Loss: 0.0701649
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0460268
	speed: 0.0599s/iter; left time: 1147.0383s
	iters: 200, epoch: 15 | loss: 0.0453027
	speed: 0.0323s/iter; left time: 616.6830s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0451875 Vali Loss: 0.0609419 Test Loss: 0.0697475
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0459039
	speed: 0.0604s/iter; left time: 1143.9558s
	iters: 200, epoch: 16 | loss: 0.0434766
	speed: 0.0326s/iter; left time: 614.5761s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0443061 Vali Loss: 0.0615374 Test Loss: 0.0706668
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0443573
	speed: 0.0599s/iter; left time: 1122.0651s
	iters: 200, epoch: 17 | loss: 0.0425250
	speed: 0.0324s/iter; left time: 603.5718s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0435606 Vali Loss: 0.0604851 Test Loss: 0.0707585
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0413324
	speed: 0.0602s/iter; left time: 1113.7053s
	iters: 200, epoch: 18 | loss: 0.0445203
	speed: 0.0325s/iter; left time: 598.5775s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0428060 Vali Loss: 0.0611732 Test Loss: 0.0707645
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0436631
	speed: 0.0596s/iter; left time: 1088.8430s
	iters: 200, epoch: 19 | loss: 0.0429139
	speed: 0.0325s/iter; left time: 591.3432s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0421968 Vali Loss: 0.0612346 Test Loss: 0.0706914
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011598608456552029, rmse:0.10769683867692947, mae:0.06793618202209473, rse:0.31693875789642334
Intermediate time for ES and pred_len 24: 00h:05m:48.87s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1167209
	speed: 0.0581s/iter; left time: 1296.1155s
	iters: 200, epoch: 1 | loss: 0.1056875
	speed: 0.0331s/iter; left time: 735.3584s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.1227398 Vali Loss: 0.0988195 Test Loss: 0.1124716
Validation loss decreased (inf --> 0.098819).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0888136
	speed: 0.0650s/iter; left time: 1434.6344s
	iters: 200, epoch: 2 | loss: 0.0841860
	speed: 0.0332s/iter; left time: 730.6599s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0888445 Vali Loss: 0.0866662 Test Loss: 0.0969930
Validation loss decreased (0.098819 --> 0.086666).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0807913
	speed: 0.0628s/iter; left time: 1372.0226s
	iters: 200, epoch: 3 | loss: 0.0785247
	speed: 0.0331s/iter; left time: 720.1775s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0809936 Vali Loss: 0.0850435 Test Loss: 0.0962780
Validation loss decreased (0.086666 --> 0.085044).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0752124
	speed: 0.0652s/iter; left time: 1409.4935s
	iters: 200, epoch: 4 | loss: 0.0712232
	speed: 0.0332s/iter; left time: 714.8987s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0751077 Vali Loss: 0.0873182 Test Loss: 0.0995040
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0689497
	speed: 0.0621s/iter; left time: 1328.1937s
	iters: 200, epoch: 5 | loss: 0.0683093
	speed: 0.0332s/iter; left time: 707.3728s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.71s
Steps: 224 | Train Loss: 0.0684474 Vali Loss: 0.0864051 Test Loss: 0.1003118
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0626845
	speed: 0.0614s/iter; left time: 1300.7891s
	iters: 200, epoch: 6 | loss: 0.0603980
	speed: 0.0331s/iter; left time: 698.5555s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0631113 Vali Loss: 0.0877236 Test Loss: 0.1011920
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590933
	speed: 0.0609s/iter; left time: 1275.9670s
	iters: 200, epoch: 7 | loss: 0.0597084
	speed: 0.0331s/iter; left time: 690.9389s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0589081 Vali Loss: 0.0872310 Test Loss: 0.1004953
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0552450
	speed: 0.0611s/iter; left time: 1265.8009s
	iters: 200, epoch: 8 | loss: 0.0551953
	speed: 0.0331s/iter; left time: 683.5963s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0555059 Vali Loss: 0.0881087 Test Loss: 0.1008888
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0524991
	speed: 0.0613s/iter; left time: 1257.9821s
	iters: 200, epoch: 9 | loss: 0.0530768
	speed: 0.0332s/iter; left time: 677.0410s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0527471 Vali Loss: 0.0886423 Test Loss: 0.1020612
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0515361
	speed: 0.0615s/iter; left time: 1248.0465s
	iters: 200, epoch: 10 | loss: 0.0495522
	speed: 0.0333s/iter; left time: 672.0863s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0506641 Vali Loss: 0.0878667 Test Loss: 0.1018857
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0495449
	speed: 0.0622s/iter; left time: 1247.0062s
	iters: 200, epoch: 11 | loss: 0.0484085
	speed: 0.0335s/iter; left time: 668.6750s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0487303 Vali Loss: 0.0874963 Test Loss: 0.1018826
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0460823
	speed: 0.0613s/iter; left time: 1215.3686s
	iters: 200, epoch: 12 | loss: 0.0487627
	speed: 0.0331s/iter; left time: 653.6800s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0472277 Vali Loss: 0.0875905 Test Loss: 0.1023017
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0471489
	speed: 0.0612s/iter; left time: 1201.1524s
	iters: 200, epoch: 13 | loss: 0.0454935
	speed: 0.0331s/iter; left time: 645.9965s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0459133 Vali Loss: 0.0874007 Test Loss: 0.1019594
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021271303296089172, rmse:0.14584684371948242, mae:0.09627804905176163, rse:0.4284541606903076
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1204117
	speed: 0.0347s/iter; left time: 773.2841s
	iters: 200, epoch: 1 | loss: 0.1046546
	speed: 0.0330s/iter; left time: 733.2609s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.1222082 Vali Loss: 0.0986339 Test Loss: 0.1127096
Validation loss decreased (inf --> 0.098634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0892475
	speed: 0.0637s/iter; left time: 1405.5402s
	iters: 200, epoch: 2 | loss: 0.0875973
	speed: 0.0331s/iter; left time: 727.3245s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0889160 Vali Loss: 0.0860521 Test Loss: 0.0965959
Validation loss decreased (0.098634 --> 0.086052).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0820314
	speed: 0.0746s/iter; left time: 1629.4846s
	iters: 200, epoch: 3 | loss: 0.0766245
	speed: 0.0331s/iter; left time: 720.1125s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0810734 Vali Loss: 0.0846253 Test Loss: 0.0976963
Validation loss decreased (0.086052 --> 0.084625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0731675
	speed: 0.0660s/iter; left time: 1426.5197s
	iters: 200, epoch: 4 | loss: 0.0741658
	speed: 0.0335s/iter; left time: 721.5715s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.68s
Steps: 224 | Train Loss: 0.0754243 Vali Loss: 0.0878123 Test Loss: 0.1005267
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0716164
	speed: 0.0616s/iter; left time: 1317.6022s
	iters: 200, epoch: 5 | loss: 0.0671426
	speed: 0.0331s/iter; left time: 705.6265s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0690027 Vali Loss: 0.0878285 Test Loss: 0.1006422
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0641997
	speed: 0.0612s/iter; left time: 1295.4053s
	iters: 200, epoch: 6 | loss: 0.0674796
	speed: 0.0331s/iter; left time: 697.8527s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0635019 Vali Loss: 0.0878592 Test Loss: 0.1024417
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0591606
	speed: 0.0615s/iter; left time: 1288.8847s
	iters: 200, epoch: 7 | loss: 0.0583029
	speed: 0.0331s/iter; left time: 691.1609s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0588996 Vali Loss: 0.0877868 Test Loss: 0.1020480
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0553827
	speed: 0.0614s/iter; left time: 1272.8050s
	iters: 200, epoch: 8 | loss: 0.0554482
	speed: 0.0332s/iter; left time: 684.7937s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0554791 Vali Loss: 0.0881074 Test Loss: 0.1035934
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0541625
	speed: 0.0616s/iter; left time: 1263.4282s
	iters: 200, epoch: 9 | loss: 0.0502246
	speed: 0.0332s/iter; left time: 676.8140s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0527017 Vali Loss: 0.0881722 Test Loss: 0.1024241
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0498284
	speed: 0.0612s/iter; left time: 1240.7351s
	iters: 200, epoch: 10 | loss: 0.0489367
	speed: 0.0331s/iter; left time: 668.2251s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0506088 Vali Loss: 0.0888529 Test Loss: 0.1031139
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0476753
	speed: 0.0623s/iter; left time: 1249.1649s
	iters: 200, epoch: 11 | loss: 0.0481353
	speed: 0.0331s/iter; left time: 660.8999s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0486823 Vali Loss: 0.0881064 Test Loss: 0.1029631
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0461587
	speed: 0.0609s/iter; left time: 1208.6124s
	iters: 200, epoch: 12 | loss: 0.0474565
	speed: 0.0330s/iter; left time: 650.9760s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0471709 Vali Loss: 0.0887941 Test Loss: 0.1031620
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0465209
	speed: 0.0616s/iter; left time: 1207.6783s
	iters: 200, epoch: 13 | loss: 0.0457823
	speed: 0.0332s/iter; left time: 647.9063s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0457775 Vali Loss: 0.0880506 Test Loss: 0.1036356
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021871840581297874, rmse:0.1478913128376007, mae:0.09769626706838608, rse:0.4344601631164551
Intermediate time for ES and pred_len 96: 00h:04m:21.86s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1163252
	speed: 0.0624s/iter; left time: 1385.7644s
	iters: 200, epoch: 1 | loss: 0.1111509
	speed: 0.0337s/iter; left time: 745.5653s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.1248032 Vali Loss: 0.1023557 Test Loss: 0.1157608
Validation loss decreased (inf --> 0.102356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0920324
	speed: 0.0733s/iter; left time: 1611.7066s
	iters: 200, epoch: 2 | loss: 0.0905396
	speed: 0.0337s/iter; left time: 738.0070s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0927347 Vali Loss: 0.0911596 Test Loss: 0.1026373
Validation loss decreased (0.102356 --> 0.091160).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0813993
	speed: 0.0775s/iter; left time: 1685.0918s
	iters: 200, epoch: 3 | loss: 0.0804934
	speed: 0.0338s/iter; left time: 732.9091s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.76s
Steps: 223 | Train Loss: 0.0837477 Vali Loss: 0.0901361 Test Loss: 0.1034494
Validation loss decreased (0.091160 --> 0.090136).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0745005
	speed: 0.0755s/iter; left time: 1625.6449s
	iters: 200, epoch: 4 | loss: 0.0743757
	speed: 0.0338s/iter; left time: 723.6099s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.74s
Steps: 223 | Train Loss: 0.0773343 Vali Loss: 0.0920163 Test Loss: 0.1045371
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0717543
	speed: 0.0623s/iter; left time: 1327.8117s
	iters: 200, epoch: 5 | loss: 0.0683926
	speed: 0.0339s/iter; left time: 717.9659s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0706961 Vali Loss: 0.0927095 Test Loss: 0.1056051
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0635267
	speed: 0.0626s/iter; left time: 1319.7380s
	iters: 200, epoch: 6 | loss: 0.0626201
	speed: 0.0338s/iter; left time: 709.7059s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0648583 Vali Loss: 0.0928507 Test Loss: 0.1066073
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0594731
	speed: 0.0620s/iter; left time: 1292.7169s
	iters: 200, epoch: 7 | loss: 0.0574201
	speed: 0.0340s/iter; left time: 705.1607s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.77s
Steps: 223 | Train Loss: 0.0604445 Vali Loss: 0.0937179 Test Loss: 0.1071184
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0578186
	speed: 0.0640s/iter; left time: 1321.4657s
	iters: 200, epoch: 8 | loss: 0.0562383
	speed: 0.0338s/iter; left time: 694.4083s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0571987 Vali Loss: 0.0920181 Test Loss: 0.1071269
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0552342
	speed: 0.0626s/iter; left time: 1277.5305s
	iters: 200, epoch: 9 | loss: 0.0548123
	speed: 0.0339s/iter; left time: 687.9366s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0545950 Vali Loss: 0.0930666 Test Loss: 0.1075234
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0529762
	speed: 0.0622s/iter; left time: 1255.6336s
	iters: 200, epoch: 10 | loss: 0.0518859
	speed: 0.0339s/iter; left time: 681.9684s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.76s
Steps: 223 | Train Loss: 0.0524777 Vali Loss: 0.0920488 Test Loss: 0.1072294
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0511605
	speed: 0.0620s/iter; left time: 1237.8479s
	iters: 200, epoch: 11 | loss: 0.0511627
	speed: 0.0339s/iter; left time: 674.3273s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0506818 Vali Loss: 0.0927317 Test Loss: 0.1083499
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0496722
	speed: 0.0624s/iter; left time: 1232.3483s
	iters: 200, epoch: 12 | loss: 0.0484021
	speed: 0.0339s/iter; left time: 666.2024s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0491604 Vali Loss: 0.0922555 Test Loss: 0.1075642
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0480842
	speed: 0.0623s/iter; left time: 1215.7753s
	iters: 200, epoch: 13 | loss: 0.0480131
	speed: 0.0340s/iter; left time: 659.9457s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0478748 Vali Loss: 0.0920726 Test Loss: 0.1082650
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0238569937646389, rmse:0.15445709228515625, mae:0.10344940423965454, rse:0.45378103852272034
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1175357
	speed: 0.0360s/iter; left time: 799.3014s
	iters: 200, epoch: 1 | loss: 0.1085309
	speed: 0.0339s/iter; left time: 749.2484s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.85s
Steps: 223 | Train Loss: 0.1244877 Vali Loss: 0.1024658 Test Loss: 0.1162681
Validation loss decreased (inf --> 0.102466).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0892978
	speed: 0.0724s/iter; left time: 1591.8888s
	iters: 200, epoch: 2 | loss: 0.0858404
	speed: 0.0339s/iter; left time: 742.3876s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.83s
Steps: 223 | Train Loss: 0.0925368 Vali Loss: 0.0931649 Test Loss: 0.1041178
Validation loss decreased (0.102466 --> 0.093165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0832203
	speed: 0.0679s/iter; left time: 1477.8758s
	iters: 200, epoch: 3 | loss: 0.0824200
	speed: 0.0339s/iter; left time: 733.1185s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.83s
Steps: 223 | Train Loss: 0.0840002 Vali Loss: 0.0918773 Test Loss: 0.1027539
Validation loss decreased (0.093165 --> 0.091877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0755718
	speed: 0.0684s/iter; left time: 1473.3897s
	iters: 200, epoch: 4 | loss: 0.0789680
	speed: 0.0340s/iter; left time: 728.5792s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.91s
Steps: 223 | Train Loss: 0.0778846 Vali Loss: 0.0915824 Test Loss: 0.1033742
Validation loss decreased (0.091877 --> 0.091582).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0740893
	speed: 0.0689s/iter; left time: 1468.1146s
	iters: 200, epoch: 5 | loss: 0.0704942
	speed: 0.0339s/iter; left time: 718.0989s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0719597 Vali Loss: 0.0934459 Test Loss: 0.1050283
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0674252
	speed: 0.0634s/iter; left time: 1336.3706s
	iters: 200, epoch: 6 | loss: 0.0634718
	speed: 0.0340s/iter; left time: 713.3638s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.76s
Steps: 223 | Train Loss: 0.0659032 Vali Loss: 0.0927102 Test Loss: 0.1051720
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0629653
	speed: 0.0642s/iter; left time: 1338.9348s
	iters: 200, epoch: 7 | loss: 0.0605651
	speed: 0.0342s/iter; left time: 709.2852s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.81s
Steps: 223 | Train Loss: 0.0613759 Vali Loss: 0.0924244 Test Loss: 0.1051302
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0563948
	speed: 0.0629s/iter; left time: 1297.6812s
	iters: 200, epoch: 8 | loss: 0.0562144
	speed: 0.0339s/iter; left time: 696.6521s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.81s
Steps: 223 | Train Loss: 0.0577199 Vali Loss: 0.0931844 Test Loss: 0.1064090
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0559244
	speed: 0.0636s/iter; left time: 1298.2004s
	iters: 200, epoch: 9 | loss: 0.0532067
	speed: 0.0339s/iter; left time: 689.7418s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.86s
Steps: 223 | Train Loss: 0.0549016 Vali Loss: 0.0936035 Test Loss: 0.1066466
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0514232
	speed: 0.0628s/iter; left time: 1268.0533s
	iters: 200, epoch: 10 | loss: 0.0512180
	speed: 0.0338s/iter; left time: 680.0949s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.76s
Steps: 223 | Train Loss: 0.0526190 Vali Loss: 0.0929514 Test Loss: 0.1060959
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0514014
	speed: 0.0625s/iter; left time: 1248.3156s
	iters: 200, epoch: 11 | loss: 0.0494085
	speed: 0.0340s/iter; left time: 675.2157s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.78s
Steps: 223 | Train Loss: 0.0508202 Vali Loss: 0.0938980 Test Loss: 0.1071277
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0495044
	speed: 0.0643s/iter; left time: 1270.2817s
	iters: 200, epoch: 12 | loss: 0.0483764
	speed: 0.0339s/iter; left time: 666.4918s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.87s
Steps: 223 | Train Loss: 0.0491536 Vali Loss: 0.0933724 Test Loss: 0.1070942
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0487324
	speed: 0.0627s/iter; left time: 1224.8408s
	iters: 200, epoch: 13 | loss: 0.0466656
	speed: 0.0339s/iter; left time: 658.3644s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0478594 Vali Loss: 0.0935658 Test Loss: 0.1077204
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0470098
	speed: 0.0633s/iter; left time: 1221.3799s
	iters: 200, epoch: 14 | loss: 0.0454411
	speed: 0.0340s/iter; left time: 652.9709s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.80s
Steps: 223 | Train Loss: 0.0467149 Vali Loss: 0.0932253 Test Loss: 0.1074122
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023433756083250046, rmse:0.15308088064193726, mae:0.10337422043085098, rse:0.44973787665367126
Intermediate time for ES and pred_len 168: 00h:04m:41.40sIntermediate time for ES: 00h:14m:52.14s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0825739
	speed: 0.0440s/iter; left time: 989.1272s
	iters: 200, epoch: 1 | loss: 0.0720544
	speed: 0.0179s/iter; left time: 400.4240s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.56s
Steps: 226 | Train Loss: 0.0892576 Vali Loss: 0.0763335 Test Loss: 0.0833760
Validation loss decreased (inf --> 0.076333).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0519041
	speed: 0.0395s/iter; left time: 879.1817s
	iters: 200, epoch: 2 | loss: 0.0478711
	speed: 0.0180s/iter; left time: 399.4832s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0525726 Vali Loss: 0.0569420 Test Loss: 0.0612847
Validation loss decreased (0.076333 --> 0.056942).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0440858
	speed: 0.0394s/iter; left time: 868.8589s
	iters: 200, epoch: 3 | loss: 0.0461644
	speed: 0.0181s/iter; left time: 397.5345s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.32s
Steps: 226 | Train Loss: 0.0464609 Vali Loss: 0.0550702 Test Loss: 0.0593229
Validation loss decreased (0.056942 --> 0.055070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0446937
	speed: 0.0383s/iter; left time: 834.9939s
	iters: 200, epoch: 4 | loss: 0.0430271
	speed: 0.0185s/iter; left time: 402.7208s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0446763 Vali Loss: 0.0546017 Test Loss: 0.0593835
Validation loss decreased (0.055070 --> 0.054602).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0449143
	speed: 0.0391s/iter; left time: 845.1750s
	iters: 200, epoch: 5 | loss: 0.0423666
	speed: 0.0179s/iter; left time: 384.3641s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.24s
Steps: 226 | Train Loss: 0.0431179 Vali Loss: 0.0536028 Test Loss: 0.0577287
Validation loss decreased (0.054602 --> 0.053603).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0447902
	speed: 0.0414s/iter; left time: 884.3643s
	iters: 200, epoch: 6 | loss: 0.0402884
	speed: 0.0179s/iter; left time: 380.7906s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.52s
Steps: 226 | Train Loss: 0.0419177 Vali Loss: 0.0532793 Test Loss: 0.0576561
Validation loss decreased (0.053603 --> 0.053279).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0400641
	speed: 0.0380s/iter; left time: 803.0530s
	iters: 200, epoch: 7 | loss: 0.0413724
	speed: 0.0180s/iter; left time: 377.8032s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0406169 Vali Loss: 0.0529187 Test Loss: 0.0586069
Validation loss decreased (0.053279 --> 0.052919).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0422125
	speed: 0.0385s/iter; left time: 804.8030s
	iters: 200, epoch: 8 | loss: 0.0390262
	speed: 0.0177s/iter; left time: 368.7307s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0396278 Vali Loss: 0.0532204 Test Loss: 0.0586753
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0396171
	speed: 0.0362s/iter; left time: 749.2150s
	iters: 200, epoch: 9 | loss: 0.0392884
	speed: 0.0178s/iter; left time: 365.5394s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0383368 Vali Loss: 0.0533056 Test Loss: 0.0592961
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0352243
	speed: 0.0365s/iter; left time: 746.7584s
	iters: 200, epoch: 10 | loss: 0.0382171
	speed: 0.0178s/iter; left time: 361.7251s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0371329 Vali Loss: 0.0542546 Test Loss: 0.0600371
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0372575
	speed: 0.0366s/iter; left time: 741.1142s
	iters: 200, epoch: 11 | loss: 0.0357848
	speed: 0.0179s/iter; left time: 359.9821s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.24s
Steps: 226 | Train Loss: 0.0361327 Vali Loss: 0.0540272 Test Loss: 0.0606850
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0339495
	speed: 0.0370s/iter; left time: 740.6702s
	iters: 200, epoch: 12 | loss: 0.0343725
	speed: 0.0178s/iter; left time: 355.3778s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0351717 Vali Loss: 0.0541665 Test Loss: 0.0607401
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0350991
	speed: 0.0367s/iter; left time: 725.8432s
	iters: 200, epoch: 13 | loss: 0.0356509
	speed: 0.0182s/iter; left time: 358.3373s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0342767 Vali Loss: 0.0543875 Test Loss: 0.0612607
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0323812
	speed: 0.0368s/iter; left time: 719.6369s
	iters: 200, epoch: 14 | loss: 0.0324937
	speed: 0.0178s/iter; left time: 347.1468s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0336061 Vali Loss: 0.0549471 Test Loss: 0.0617569
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0328720
	speed: 0.0369s/iter; left time: 712.8441s
	iters: 200, epoch: 15 | loss: 0.0327561
	speed: 0.0177s/iter; left time: 341.1970s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0329703 Vali Loss: 0.0550517 Test Loss: 0.0612711
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0303529
	speed: 0.0369s/iter; left time: 705.4486s
	iters: 200, epoch: 16 | loss: 0.0308379
	speed: 0.0179s/iter; left time: 340.9309s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0323310 Vali Loss: 0.0550910 Test Loss: 0.0609389
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0322276
	speed: 0.0368s/iter; left time: 694.5076s
	iters: 200, epoch: 17 | loss: 0.0307707
	speed: 0.0177s/iter; left time: 333.4214s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0318553 Vali Loss: 0.0549174 Test Loss: 0.0618004
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.0108979232609272, rmse:0.1043931171298027, mae:0.05860685557126999, rse:0.4027457535266876
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0808246
	speed: 0.0211s/iter; left time: 474.1064s
	iters: 200, epoch: 1 | loss: 0.0777871
	speed: 0.0188s/iter; left time: 420.6441s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.49s
Steps: 226 | Train Loss: 0.0886302 Vali Loss: 0.0765412 Test Loss: 0.0835635
Validation loss decreased (inf --> 0.076541).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0512616
	speed: 0.0396s/iter; left time: 882.4648s
	iters: 200, epoch: 2 | loss: 0.0489905
	speed: 0.0178s/iter; left time: 394.5675s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0525013 Vali Loss: 0.0562015 Test Loss: 0.0609805
Validation loss decreased (0.076541 --> 0.056202).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0472980
	speed: 0.0394s/iter; left time: 867.7970s
	iters: 200, epoch: 3 | loss: 0.0457077
	speed: 0.0178s/iter; left time: 391.5989s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0466549 Vali Loss: 0.0544775 Test Loss: 0.0589031
Validation loss decreased (0.056202 --> 0.054478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0453555
	speed: 0.0389s/iter; left time: 849.9809s
	iters: 200, epoch: 4 | loss: 0.0427258
	speed: 0.0181s/iter; left time: 392.5974s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.32s
Steps: 226 | Train Loss: 0.0447521 Vali Loss: 0.0536225 Test Loss: 0.0581660
Validation loss decreased (0.054478 --> 0.053622).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0439419
	speed: 0.0387s/iter; left time: 836.7352s
	iters: 200, epoch: 5 | loss: 0.0437575
	speed: 0.0177s/iter; left time: 381.3332s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0432652 Vali Loss: 0.0528611 Test Loss: 0.0578288
Validation loss decreased (0.053622 --> 0.052861).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0424836
	speed: 0.0397s/iter; left time: 849.0424s
	iters: 200, epoch: 6 | loss: 0.0434853
	speed: 0.0178s/iter; left time: 378.7619s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0422494 Vali Loss: 0.0533285 Test Loss: 0.0580732
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0412046
	speed: 0.0369s/iter; left time: 781.2850s
	iters: 200, epoch: 7 | loss: 0.0417114
	speed: 0.0178s/iter; left time: 373.9462s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0411409 Vali Loss: 0.0528526 Test Loss: 0.0578768
Validation loss decreased (0.052861 --> 0.052853).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0405956
	speed: 0.0383s/iter; left time: 801.0011s
	iters: 200, epoch: 8 | loss: 0.0414334
	speed: 0.0178s/iter; left time: 370.1795s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0399912 Vali Loss: 0.0526390 Test Loss: 0.0583228
Validation loss decreased (0.052853 --> 0.052639).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0392249
	speed: 0.0396s/iter; left time: 819.5750s
	iters: 200, epoch: 9 | loss: 0.0397011
	speed: 0.0177s/iter; left time: 364.7420s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0390025 Vali Loss: 0.0525965 Test Loss: 0.0577715
Validation loss decreased (0.052639 --> 0.052597).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0352390
	speed: 0.0403s/iter; left time: 825.6378s
	iters: 200, epoch: 10 | loss: 0.0390021
	speed: 0.0204s/iter; left time: 414.6287s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.69s
Steps: 226 | Train Loss: 0.0378733 Vali Loss: 0.0526242 Test Loss: 0.0583718
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0355981
	speed: 0.0372s/iter; left time: 752.0537s
	iters: 200, epoch: 11 | loss: 0.0361680
	speed: 0.0180s/iter; left time: 362.7102s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0368099 Vali Loss: 0.0531015 Test Loss: 0.0590410
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0343426
	speed: 0.0373s/iter; left time: 745.7549s
	iters: 200, epoch: 12 | loss: 0.0386787
	speed: 0.0177s/iter; left time: 352.9660s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0359604 Vali Loss: 0.0532657 Test Loss: 0.0590416
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0358210
	speed: 0.0370s/iter; left time: 732.6723s
	iters: 200, epoch: 13 | loss: 0.0385372
	speed: 0.0185s/iter; left time: 364.7739s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.39s
Steps: 226 | Train Loss: 0.0351373 Vali Loss: 0.0539517 Test Loss: 0.0593859
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0342100
	speed: 0.0372s/iter; left time: 728.1848s
	iters: 200, epoch: 14 | loss: 0.0354560
	speed: 0.0180s/iter; left time: 349.6016s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.24s
Steps: 226 | Train Loss: 0.0343315 Vali Loss: 0.0538370 Test Loss: 0.0604549
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0339227
	speed: 0.0368s/iter; left time: 712.4510s
	iters: 200, epoch: 15 | loss: 0.0324195
	speed: 0.0177s/iter; left time: 341.1165s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0336581 Vali Loss: 0.0539099 Test Loss: 0.0599087
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0363340
	speed: 0.0375s/iter; left time: 716.4222s
	iters: 200, epoch: 16 | loss: 0.0296580
	speed: 0.0178s/iter; left time: 338.4630s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.0331135 Vali Loss: 0.0539095 Test Loss: 0.0599806
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0320749
	speed: 0.0379s/iter; left time: 714.9103s
	iters: 200, epoch: 17 | loss: 0.0329088
	speed: 0.0178s/iter; left time: 334.8886s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.33s
Steps: 226 | Train Loss: 0.0326186 Vali Loss: 0.0540928 Test Loss: 0.0603553
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0313287
	speed: 0.0379s/iter; left time: 706.8323s
	iters: 200, epoch: 18 | loss: 0.0325896
	speed: 0.0179s/iter; left time: 331.6527s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0321234 Vali Loss: 0.0542886 Test Loss: 0.0603496
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0324607
	speed: 0.0366s/iter; left time: 674.4744s
	iters: 200, epoch: 19 | loss: 0.0300568
	speed: 0.0179s/iter; left time: 327.5346s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0317324 Vali Loss: 0.0542460 Test Loss: 0.0601043
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010704690590500832, rmse:0.10346347838640213, mae:0.0577714666724205, rse:0.39915919303894043
Intermediate time for FR and pred_len 24: 00h:03m:33.41s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0949994
	speed: 0.0456s/iter; left time: 1022.1274s
	iters: 200, epoch: 1 | loss: 0.0818396
	speed: 0.0181s/iter; left time: 404.4964s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0984444 Vali Loss: 0.0880076 Test Loss: 0.0994513
Validation loss decreased (inf --> 0.088008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0642481
	speed: 0.0411s/iter; left time: 910.9899s
	iters: 200, epoch: 2 | loss: 0.0622116
	speed: 0.0182s/iter; left time: 400.9970s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0677669 Vali Loss: 0.0737542 Test Loss: 0.0843380
Validation loss decreased (0.088008 --> 0.073754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0635156
	speed: 0.0402s/iter; left time: 883.3367s
	iters: 200, epoch: 3 | loss: 0.0583343
	speed: 0.0187s/iter; left time: 407.8178s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0608415 Vali Loss: 0.0740786 Test Loss: 0.0821252
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0573911
	speed: 0.0384s/iter; left time: 834.2952s
	iters: 200, epoch: 4 | loss: 0.0538883
	speed: 0.0183s/iter; left time: 396.5637s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0571251 Vali Loss: 0.0752631 Test Loss: 0.0843270
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0542980
	speed: 0.0377s/iter; left time: 811.0578s
	iters: 200, epoch: 5 | loss: 0.0494459
	speed: 0.0181s/iter; left time: 386.6309s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0532236 Vali Loss: 0.0759761 Test Loss: 0.0854147
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0505165
	speed: 0.0371s/iter; left time: 790.0507s
	iters: 200, epoch: 6 | loss: 0.0506002
	speed: 0.0183s/iter; left time: 387.8944s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0501787 Vali Loss: 0.0768308 Test Loss: 0.0852290
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0480088
	speed: 0.0382s/iter; left time: 804.1262s
	iters: 200, epoch: 7 | loss: 0.0443931
	speed: 0.0185s/iter; left time: 387.2987s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0476712 Vali Loss: 0.0764843 Test Loss: 0.0855211
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0477575
	speed: 0.0380s/iter; left time: 790.6320s
	iters: 200, epoch: 8 | loss: 0.0449111
	speed: 0.0180s/iter; left time: 373.4726s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0455909 Vali Loss: 0.0765070 Test Loss: 0.0847537
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0444669
	speed: 0.0380s/iter; left time: 782.3708s
	iters: 200, epoch: 9 | loss: 0.0466012
	speed: 0.0186s/iter; left time: 381.1939s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0438265 Vali Loss: 0.0768355 Test Loss: 0.0856286
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0435193
	speed: 0.0379s/iter; left time: 772.4439s
	iters: 200, epoch: 10 | loss: 0.0399701
	speed: 0.0182s/iter; left time: 368.5660s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0423801 Vali Loss: 0.0769819 Test Loss: 0.0855340
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0414985
	speed: 0.0377s/iter; left time: 759.6218s
	iters: 200, epoch: 11 | loss: 0.0408975
	speed: 0.0181s/iter; left time: 363.7800s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.28s
Steps: 225 | Train Loss: 0.0411706 Vali Loss: 0.0774362 Test Loss: 0.0854421
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0397998
	speed: 0.0381s/iter; left time: 759.1696s
	iters: 200, epoch: 12 | loss: 0.0391970
	speed: 0.0181s/iter; left time: 358.7041s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.28s
Steps: 225 | Train Loss: 0.0401057 Vali Loss: 0.0769203 Test Loss: 0.0855711
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020127102732658386, rmse:0.14187002182006836, mae:0.08433804661035538, rse:0.5487909913063049
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0942150
	speed: 0.0202s/iter; left time: 453.1591s
	iters: 200, epoch: 1 | loss: 0.0819090
	speed: 0.0180s/iter; left time: 402.2137s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0978670 Vali Loss: 0.0881797 Test Loss: 0.0994574
Validation loss decreased (inf --> 0.088180).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0664974
	speed: 0.0413s/iter; left time: 916.2054s
	iters: 200, epoch: 2 | loss: 0.0632625
	speed: 0.0185s/iter; left time: 408.0923s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0679474 Vali Loss: 0.0738612 Test Loss: 0.0836209
Validation loss decreased (0.088180 --> 0.073861).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0601718
	speed: 0.0442s/iter; left time: 969.4626s
	iters: 200, epoch: 3 | loss: 0.0622078
	speed: 0.0184s/iter; left time: 401.7673s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0612250 Vali Loss: 0.0731753 Test Loss: 0.0819078
Validation loss decreased (0.073861 --> 0.073175).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0579952
	speed: 0.0398s/iter; left time: 865.2752s
	iters: 200, epoch: 4 | loss: 0.0564419
	speed: 0.0181s/iter; left time: 392.3836s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0574971 Vali Loss: 0.0752813 Test Loss: 0.0844468
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0572532
	speed: 0.0377s/iter; left time: 810.4702s
	iters: 200, epoch: 5 | loss: 0.0534076
	speed: 0.0181s/iter; left time: 387.7646s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0539225 Vali Loss: 0.0754249 Test Loss: 0.0834574
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0501882
	speed: 0.0380s/iter; left time: 808.8260s
	iters: 200, epoch: 6 | loss: 0.0494513
	speed: 0.0181s/iter; left time: 384.2060s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0507724 Vali Loss: 0.0762898 Test Loss: 0.0839536
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0474354
	speed: 0.0397s/iter; left time: 835.1748s
	iters: 200, epoch: 7 | loss: 0.0489970
	speed: 0.0190s/iter; left time: 397.3916s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0482603 Vali Loss: 0.0765327 Test Loss: 0.0842737
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0459890
	speed: 0.0381s/iter; left time: 793.1110s
	iters: 200, epoch: 8 | loss: 0.0453775
	speed: 0.0185s/iter; left time: 382.9001s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.0462406 Vali Loss: 0.0767720 Test Loss: 0.0844933
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0424829
	speed: 0.0380s/iter; left time: 782.5921s
	iters: 200, epoch: 9 | loss: 0.0439030
	speed: 0.0182s/iter; left time: 372.4860s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0444618 Vali Loss: 0.0772027 Test Loss: 0.0855004
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0433870
	speed: 0.0380s/iter; left time: 773.6652s
	iters: 200, epoch: 10 | loss: 0.0414537
	speed: 0.0183s/iter; left time: 370.9051s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0430081 Vali Loss: 0.0774466 Test Loss: 0.0858750
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0424098
	speed: 0.0394s/iter; left time: 794.0385s
	iters: 200, epoch: 11 | loss: 0.0408237
	speed: 0.0181s/iter; left time: 362.3216s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0417295 Vali Loss: 0.0773811 Test Loss: 0.0860263
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0397430
	speed: 0.0383s/iter; left time: 763.8141s
	iters: 200, epoch: 12 | loss: 0.0397619
	speed: 0.0187s/iter; left time: 371.7107s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0406975 Vali Loss: 0.0766426 Test Loss: 0.0861305
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0392018
	speed: 0.0395s/iter; left time: 777.6916s
	iters: 200, epoch: 13 | loss: 0.0406257
	speed: 0.0182s/iter; left time: 356.3085s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.0398008 Vali Loss: 0.0765993 Test Loss: 0.0865211
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018997935578227043, rmse:0.13783299922943115, mae:0.08190777897834778, rse:0.5331746935844421
Intermediate time for FR and pred_len 96: 00h:02m:35.62s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0908656
	speed: 0.0445s/iter; left time: 996.9496s
	iters: 200, epoch: 1 | loss: 0.0891940
	speed: 0.0186s/iter; left time: 415.1150s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.1014871 Vali Loss: 0.0917853 Test Loss: 0.1026675
Validation loss decreased (inf --> 0.091785).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0684629
	speed: 0.0409s/iter; left time: 906.4908s
	iters: 200, epoch: 2 | loss: 0.0672442
	speed: 0.0185s/iter; left time: 407.5558s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0723063 Vali Loss: 0.0782374 Test Loss: 0.0879902
Validation loss decreased (0.091785 --> 0.078237).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0619121
	speed: 0.0438s/iter; left time: 961.5666s
	iters: 200, epoch: 3 | loss: 0.0598689
	speed: 0.0185s/iter; left time: 404.7339s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0647034 Vali Loss: 0.0780730 Test Loss: 0.0865445
Validation loss decreased (0.078237 --> 0.078073).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0606524
	speed: 0.0486s/iter; left time: 1056.8225s
	iters: 200, epoch: 4 | loss: 0.0594136
	speed: 0.0188s/iter; left time: 407.3998s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0603122 Vali Loss: 0.0804714 Test Loss: 0.0876513
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0565531
	speed: 0.0382s/iter; left time: 822.2550s
	iters: 200, epoch: 5 | loss: 0.0558551
	speed: 0.0184s/iter; left time: 394.3217s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0566340 Vali Loss: 0.0817166 Test Loss: 0.0889156
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0553974
	speed: 0.0387s/iter; left time: 823.8927s
	iters: 200, epoch: 6 | loss: 0.0514911
	speed: 0.0193s/iter; left time: 407.8428s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0532845 Vali Loss: 0.0825787 Test Loss: 0.0885907
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0522775
	speed: 0.0385s/iter; left time: 810.6988s
	iters: 200, epoch: 7 | loss: 0.0490751
	speed: 0.0184s/iter; left time: 385.8677s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.0506605 Vali Loss: 0.0819513 Test Loss: 0.0896498
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0481883
	speed: 0.0389s/iter; left time: 811.1528s
	iters: 200, epoch: 8 | loss: 0.0474817
	speed: 0.0192s/iter; left time: 397.3238s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.0484786 Vali Loss: 0.0840234 Test Loss: 0.0901825
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0470933
	speed: 0.0400s/iter; left time: 824.1000s
	iters: 200, epoch: 9 | loss: 0.0446422
	speed: 0.0185s/iter; left time: 378.5686s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0467293 Vali Loss: 0.0832497 Test Loss: 0.0904056
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0455585
	speed: 0.0399s/iter; left time: 811.9973s
	iters: 200, epoch: 10 | loss: 0.0460681
	speed: 0.0197s/iter; left time: 398.6808s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.82s
Steps: 225 | Train Loss: 0.0453248 Vali Loss: 0.0837281 Test Loss: 0.0903833
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0434859
	speed: 0.0419s/iter; left time: 845.1868s
	iters: 200, epoch: 11 | loss: 0.0438852
	speed: 0.0185s/iter; left time: 369.9803s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0440360 Vali Loss: 0.0829143 Test Loss: 0.0909697
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0423885
	speed: 0.0382s/iter; left time: 760.2230s
	iters: 200, epoch: 12 | loss: 0.0401541
	speed: 0.0184s/iter; left time: 365.4141s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0429602 Vali Loss: 0.0840859 Test Loss: 0.0908408
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0415776
	speed: 0.0390s/iter; left time: 768.8135s
	iters: 200, epoch: 13 | loss: 0.0405993
	speed: 0.0192s/iter; left time: 377.0095s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0420540 Vali Loss: 0.0836687 Test Loss: 0.0909934
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020075254142284393, rmse:0.14168716967105865, mae:0.08654448390007019, rse:0.5487678050994873
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0945257
	speed: 0.0207s/iter; left time: 463.0542s
	iters: 200, epoch: 1 | loss: 0.0830759
	speed: 0.0186s/iter; left time: 414.1154s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.1009076 Vali Loss: 0.0917944 Test Loss: 0.1025656
Validation loss decreased (inf --> 0.091794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0700706
	speed: 0.0414s/iter; left time: 918.4545s
	iters: 200, epoch: 2 | loss: 0.0660276
	speed: 0.0185s/iter; left time: 408.3399s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.0723461 Vali Loss: 0.0790639 Test Loss: 0.0894321
Validation loss decreased (0.091794 --> 0.079064).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0639853
	speed: 0.0431s/iter; left time: 945.4431s
	iters: 200, epoch: 3 | loss: 0.0622231
	speed: 0.0191s/iter; left time: 416.4922s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0647785 Vali Loss: 0.0787261 Test Loss: 0.0880830
Validation loss decreased (0.079064 --> 0.078726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0630164
	speed: 0.0558s/iter; left time: 1212.8221s
	iters: 200, epoch: 4 | loss: 0.0602266
	speed: 0.0184s/iter; left time: 397.8483s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0603927 Vali Loss: 0.0806556 Test Loss: 0.0891107
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0562662
	speed: 0.0392s/iter; left time: 842.6537s
	iters: 200, epoch: 5 | loss: 0.0541140
	speed: 0.0185s/iter; left time: 395.2849s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0563509 Vali Loss: 0.0811103 Test Loss: 0.0888919
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0523157
	speed: 0.0392s/iter; left time: 833.0026s
	iters: 200, epoch: 6 | loss: 0.0513288
	speed: 0.0185s/iter; left time: 391.4289s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.0530924 Vali Loss: 0.0807032 Test Loss: 0.0897623
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0500884
	speed: 0.0394s/iter; left time: 829.3137s
	iters: 200, epoch: 7 | loss: 0.0500115
	speed: 0.0184s/iter; left time: 385.4375s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0504590 Vali Loss: 0.0820986 Test Loss: 0.0894578
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0479878
	speed: 0.0385s/iter; left time: 801.4588s
	iters: 200, epoch: 8 | loss: 0.0484171
	speed: 0.0185s/iter; left time: 383.4373s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0482995 Vali Loss: 0.0821091 Test Loss: 0.0903916
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0458567
	speed: 0.0394s/iter; left time: 810.6843s
	iters: 200, epoch: 9 | loss: 0.0477157
	speed: 0.0187s/iter; left time: 382.5386s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0466534 Vali Loss: 0.0833053 Test Loss: 0.0899950
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0471632
	speed: 0.0392s/iter; left time: 799.0429s
	iters: 200, epoch: 10 | loss: 0.0469389
	speed: 0.0185s/iter; left time: 374.3877s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0452414 Vali Loss: 0.0830634 Test Loss: 0.0917294
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0441526
	speed: 0.0392s/iter; left time: 789.5945s
	iters: 200, epoch: 11 | loss: 0.0439629
	speed: 0.0190s/iter; left time: 380.1435s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0440587 Vali Loss: 0.0837354 Test Loss: 0.0909154
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0436273
	speed: 0.0405s/iter; left time: 806.6968s
	iters: 200, epoch: 12 | loss: 0.0430317
	speed: 0.0185s/iter; left time: 366.3883s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.44s
Steps: 225 | Train Loss: 0.0430000 Vali Loss: 0.0836592 Test Loss: 0.0912588
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0423120
	speed: 0.0397s/iter; left time: 782.0449s
	iters: 200, epoch: 13 | loss: 0.0426837
	speed: 0.0190s/iter; left time: 371.5052s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0421225 Vali Loss: 0.0831803 Test Loss: 0.0908114
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020790696144104004, rmse:0.14418978989124298, mae:0.08808299899101257, rse:0.5584607124328613
Intermediate time for FR and pred_len 168: 00h:02m:47.11sIntermediate time for FR: 00h:08m:56.14s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1186669
	speed: 0.0437s/iter; left time: 982.3349s
	iters: 200, epoch: 1 | loss: 0.1038871
	speed: 0.0177s/iter; left time: 396.2217s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.58s
Steps: 226 | Train Loss: 0.1271104 Vali Loss: 0.0885935 Test Loss: 0.0908134
Validation loss decreased (inf --> 0.088594).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0683111
	speed: 0.0396s/iter; left time: 881.0199s
	iters: 200, epoch: 2 | loss: 0.0647918
	speed: 0.0177s/iter; left time: 392.1878s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0725847 Vali Loss: 0.0627410 Test Loss: 0.0653730
Validation loss decreased (0.088594 --> 0.062741).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0620086
	speed: 0.0401s/iter; left time: 883.9944s
	iters: 200, epoch: 3 | loss: 0.0679798
	speed: 0.0178s/iter; left time: 391.6820s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0636721 Vali Loss: 0.0587901 Test Loss: 0.0619358
Validation loss decreased (0.062741 --> 0.058790).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0620091
	speed: 0.0391s/iter; left time: 853.6076s
	iters: 200, epoch: 4 | loss: 0.0562509
	speed: 0.0180s/iter; left time: 390.7383s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.32s
Steps: 226 | Train Loss: 0.0611027 Vali Loss: 0.0581652 Test Loss: 0.0608983
Validation loss decreased (0.058790 --> 0.058165).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0612355
	speed: 0.0396s/iter; left time: 854.9812s
	iters: 200, epoch: 5 | loss: 0.0565420
	speed: 0.0177s/iter; left time: 380.9496s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0594019 Vali Loss: 0.0568237 Test Loss: 0.0601146
Validation loss decreased (0.058165 --> 0.056824).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0579325
	speed: 0.0383s/iter; left time: 818.7290s
	iters: 200, epoch: 6 | loss: 0.0553782
	speed: 0.0180s/iter; left time: 382.6175s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0578790 Vali Loss: 0.0563135 Test Loss: 0.0592824
Validation loss decreased (0.056824 --> 0.056313).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590282
	speed: 0.0389s/iter; left time: 823.2705s
	iters: 200, epoch: 7 | loss: 0.0608191
	speed: 0.0177s/iter; left time: 372.5048s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0567683 Vali Loss: 0.0565626 Test Loss: 0.0589534
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0570408
	speed: 0.0363s/iter; left time: 758.6925s
	iters: 200, epoch: 8 | loss: 0.0567258
	speed: 0.0178s/iter; left time: 369.8145s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0555047 Vali Loss: 0.0565501 Test Loss: 0.0589465
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0539403
	speed: 0.0378s/iter; left time: 783.1071s
	iters: 200, epoch: 9 | loss: 0.0558067
	speed: 0.0177s/iter; left time: 364.0247s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0543611 Vali Loss: 0.0559711 Test Loss: 0.0584920
Validation loss decreased (0.056313 --> 0.055971).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0480541
	speed: 0.0391s/iter; left time: 799.4237s
	iters: 200, epoch: 10 | loss: 0.0515454
	speed: 0.0177s/iter; left time: 361.0255s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0533515 Vali Loss: 0.0562107 Test Loss: 0.0589197
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0505390
	speed: 0.0366s/iter; left time: 740.7503s
	iters: 200, epoch: 11 | loss: 0.0505183
	speed: 0.0177s/iter; left time: 356.9921s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0523736 Vali Loss: 0.0565854 Test Loss: 0.0583816
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0493615
	speed: 0.0362s/iter; left time: 725.0631s
	iters: 200, epoch: 12 | loss: 0.0513223
	speed: 0.0176s/iter; left time: 351.3373s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.18s
Steps: 226 | Train Loss: 0.0513761 Vali Loss: 0.0566836 Test Loss: 0.0582515
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0495898
	speed: 0.0363s/iter; left time: 717.7518s
	iters: 200, epoch: 13 | loss: 0.0460916
	speed: 0.0177s/iter; left time: 348.7666s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0502435 Vali Loss: 0.0569636 Test Loss: 0.0586153
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0491502
	speed: 0.0368s/iter; left time: 720.7901s
	iters: 200, epoch: 14 | loss: 0.0497240
	speed: 0.0177s/iter; left time: 343.6461s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0493753 Vali Loss: 0.0566386 Test Loss: 0.0585247
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0487527
	speed: 0.0360s/iter; left time: 695.8543s
	iters: 200, epoch: 15 | loss: 0.0464090
	speed: 0.0177s/iter; left time: 340.1844s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0485031 Vali Loss: 0.0565502 Test Loss: 0.0588691
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0486492
	speed: 0.0370s/iter; left time: 706.4464s
	iters: 200, epoch: 16 | loss: 0.0468850
	speed: 0.0176s/iter; left time: 335.2313s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0476619 Vali Loss: 0.0570641 Test Loss: 0.0588286
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0484204
	speed: 0.0361s/iter; left time: 681.3553s
	iters: 200, epoch: 17 | loss: 0.0457373
	speed: 0.0177s/iter; left time: 332.1292s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0469115 Vali Loss: 0.0571258 Test Loss: 0.0593243
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0459390
	speed: 0.0377s/iter; left time: 704.2634s
	iters: 200, epoch: 18 | loss: 0.0463988
	speed: 0.0177s/iter; left time: 328.5050s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0463835 Vali Loss: 0.0574036 Test Loss: 0.0591414
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0449952
	speed: 0.0376s/iter; left time: 693.2720s
	iters: 200, epoch: 19 | loss: 0.0478959
	speed: 0.0178s/iter; left time: 326.1238s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0457615 Vali Loss: 0.0572451 Test Loss: 0.0597154
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010480063036084175, rmse:0.1023721769452095, mae:0.058492016047239304, rse:0.38681402802467346
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1183293
	speed: 0.0199s/iter; left time: 446.9918s
	iters: 200, epoch: 1 | loss: 0.1023478
	speed: 0.0182s/iter; left time: 408.5378s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.1252369 Vali Loss: 0.0887429 Test Loss: 0.0913487
Validation loss decreased (inf --> 0.088743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0721573
	speed: 0.0391s/iter; left time: 870.0501s
	iters: 200, epoch: 2 | loss: 0.0695804
	speed: 0.0188s/iter; left time: 417.3505s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0725251 Vali Loss: 0.0620892 Test Loss: 0.0651353
Validation loss decreased (0.088743 --> 0.062089).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0637120
	speed: 0.0395s/iter; left time: 870.4122s
	iters: 200, epoch: 3 | loss: 0.0642457
	speed: 0.0177s/iter; left time: 387.5393s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0637578 Vali Loss: 0.0588995 Test Loss: 0.0622270
Validation loss decreased (0.062089 --> 0.058899).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0622228
	speed: 0.0378s/iter; left time: 825.3745s
	iters: 200, epoch: 4 | loss: 0.0597051
	speed: 0.0177s/iter; left time: 383.6522s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0611976 Vali Loss: 0.0583031 Test Loss: 0.0612591
Validation loss decreased (0.058899 --> 0.058303).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0569705
	speed: 0.0424s/iter; left time: 915.5773s
	iters: 200, epoch: 5 | loss: 0.0624648
	speed: 0.0178s/iter; left time: 381.8751s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.41s
Steps: 226 | Train Loss: 0.0594146 Vali Loss: 0.0572613 Test Loss: 0.0605500
Validation loss decreased (0.058303 --> 0.057261).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0574250
	speed: 0.0397s/iter; left time: 848.6427s
	iters: 200, epoch: 6 | loss: 0.0574117
	speed: 0.0176s/iter; left time: 374.8681s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0580177 Vali Loss: 0.0570326 Test Loss: 0.0598851
Validation loss decreased (0.057261 --> 0.057033).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0562002
	speed: 0.0383s/iter; left time: 809.9356s
	iters: 200, epoch: 7 | loss: 0.0591149
	speed: 0.0184s/iter; left time: 387.6689s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0568774 Vali Loss: 0.0560135 Test Loss: 0.0586588
Validation loss decreased (0.057033 --> 0.056013).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0573453
	speed: 0.0382s/iter; left time: 798.0599s
	iters: 200, epoch: 8 | loss: 0.0589271
	speed: 0.0178s/iter; left time: 371.0624s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0557198 Vali Loss: 0.0562147 Test Loss: 0.0584597
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0532231
	speed: 0.0377s/iter; left time: 781.0276s
	iters: 200, epoch: 9 | loss: 0.0533374
	speed: 0.0180s/iter; left time: 369.8380s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0546067 Vali Loss: 0.0557521 Test Loss: 0.0584721
Validation loss decreased (0.056013 --> 0.055752).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0554328
	speed: 0.0385s/iter; left time: 787.5572s
	iters: 200, epoch: 10 | loss: 0.0529305
	speed: 0.0177s/iter; left time: 359.6853s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0534864 Vali Loss: 0.0556840 Test Loss: 0.0580632
Validation loss decreased (0.055752 --> 0.055684).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0490568
	speed: 0.0381s/iter; left time: 772.0579s
	iters: 200, epoch: 11 | loss: 0.0579109
	speed: 0.0181s/iter; left time: 364.4441s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0524901 Vali Loss: 0.0556808 Test Loss: 0.0582837
Validation loss decreased (0.055684 --> 0.055681).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0545119
	speed: 0.0384s/iter; left time: 769.3993s
	iters: 200, epoch: 12 | loss: 0.0526492
	speed: 0.0177s/iter; left time: 351.6869s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0515282 Vali Loss: 0.0556845 Test Loss: 0.0587237
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0512061
	speed: 0.0370s/iter; left time: 731.6856s
	iters: 200, epoch: 13 | loss: 0.0485435
	speed: 0.0177s/iter; left time: 348.3773s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0505559 Vali Loss: 0.0561550 Test Loss: 0.0583473
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0505487
	speed: 0.0368s/iter; left time: 719.7775s
	iters: 200, epoch: 14 | loss: 0.0488571
	speed: 0.0179s/iter; left time: 349.1453s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0496760 Vali Loss: 0.0567544 Test Loss: 0.0589902
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0486834
	speed: 0.0374s/iter; left time: 722.9436s
	iters: 200, epoch: 15 | loss: 0.0485694
	speed: 0.0177s/iter; left time: 340.2375s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0489163 Vali Loss: 0.0564030 Test Loss: 0.0587402
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0472454
	speed: 0.0367s/iter; left time: 700.4890s
	iters: 200, epoch: 16 | loss: 0.0488778
	speed: 0.0177s/iter; left time: 336.0587s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0480489 Vali Loss: 0.0567949 Test Loss: 0.0590802
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0461510
	speed: 0.0385s/iter; left time: 727.4193s
	iters: 200, epoch: 17 | loss: 0.0470704
	speed: 0.0194s/iter; left time: 364.4540s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.57s
Steps: 226 | Train Loss: 0.0474308 Vali Loss: 0.0565297 Test Loss: 0.0589807
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0475236
	speed: 0.0371s/iter; left time: 692.2523s
	iters: 200, epoch: 18 | loss: 0.0432625
	speed: 0.0176s/iter; left time: 327.2023s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0467678 Vali Loss: 0.0568878 Test Loss: 0.0593559
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0432556
	speed: 0.0365s/iter; left time: 673.2113s
	iters: 200, epoch: 19 | loss: 0.0448248
	speed: 0.0179s/iter; left time: 328.7537s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0461628 Vali Loss: 0.0567260 Test Loss: 0.0594797
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0493075
	speed: 0.0376s/iter; left time: 684.2777s
	iters: 200, epoch: 20 | loss: 0.0476661
	speed: 0.0177s/iter; left time: 319.8866s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0458511 Vali Loss: 0.0567330 Test Loss: 0.0594195
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0462077
	speed: 0.0365s/iter; left time: 656.7331s
	iters: 200, epoch: 21 | loss: 0.0431399
	speed: 0.0177s/iter; left time: 316.6965s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0453313 Vali Loss: 0.0569593 Test Loss: 0.0592954
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010335121303796768, rmse:0.1016618013381958, mae:0.058283690363168716, rse:0.3841298818588257
Intermediate time for IT and pred_len 24: 00h:03m:54.81s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1310730
	speed: 0.0441s/iter; left time: 988.4177s
	iters: 200, epoch: 1 | loss: 0.1159046
	speed: 0.0181s/iter; left time: 402.9903s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.1386889 Vali Loss: 0.1017228 Test Loss: 0.1046455
Validation loss decreased (inf --> 0.101723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0922018
	speed: 0.0404s/iter; left time: 895.4513s
	iters: 200, epoch: 2 | loss: 0.0875287
	speed: 0.0180s/iter; left time: 398.0836s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0913242 Vali Loss: 0.0810804 Test Loss: 0.0859926
Validation loss decreased (0.101723 --> 0.081080).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0851930
	speed: 0.0403s/iter; left time: 884.8194s
	iters: 200, epoch: 3 | loss: 0.0848009
	speed: 0.0181s/iter; left time: 396.1145s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0831508 Vali Loss: 0.0784393 Test Loss: 0.0841096
Validation loss decreased (0.081080 --> 0.078439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0810510
	speed: 0.0400s/iter; left time: 868.2449s
	iters: 200, epoch: 4 | loss: 0.0782053
	speed: 0.0180s/iter; left time: 389.9135s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0795676 Vali Loss: 0.0784156 Test Loss: 0.0839126
Validation loss decreased (0.078439 --> 0.078416).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0816101
	speed: 0.0390s/iter; left time: 839.4009s
	iters: 200, epoch: 5 | loss: 0.0721341
	speed: 0.0180s/iter; left time: 385.0344s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.23s
Steps: 225 | Train Loss: 0.0762387 Vali Loss: 0.0790260 Test Loss: 0.0830072
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0740837
	speed: 0.0371s/iter; left time: 789.8721s
	iters: 200, epoch: 6 | loss: 0.0762524
	speed: 0.0187s/iter; left time: 395.1880s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0728276 Vali Loss: 0.0801343 Test Loss: 0.0841383
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0702368
	speed: 0.0367s/iter; left time: 773.1533s
	iters: 200, epoch: 7 | loss: 0.0654386
	speed: 0.0181s/iter; left time: 378.4053s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.24s
Steps: 225 | Train Loss: 0.0698180 Vali Loss: 0.0802404 Test Loss: 0.0828267
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0711698
	speed: 0.0373s/iter; left time: 776.2859s
	iters: 200, epoch: 8 | loss: 0.0639507
	speed: 0.0180s/iter; left time: 374.0221s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.28s
Steps: 225 | Train Loss: 0.0670037 Vali Loss: 0.0815448 Test Loss: 0.0840982
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0627414
	speed: 0.0377s/iter; left time: 776.9450s
	iters: 200, epoch: 9 | loss: 0.0609370
	speed: 0.0181s/iter; left time: 370.0913s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0644941 Vali Loss: 0.0811407 Test Loss: 0.0839700
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0619954
	speed: 0.0373s/iter; left time: 760.0455s
	iters: 200, epoch: 10 | loss: 0.0627662
	speed: 0.0182s/iter; left time: 369.9898s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0622920 Vali Loss: 0.0826805 Test Loss: 0.0853803
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0642111
	speed: 0.0370s/iter; left time: 745.9526s
	iters: 200, epoch: 11 | loss: 0.0608653
	speed: 0.0181s/iter; left time: 363.4407s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0603079 Vali Loss: 0.0826404 Test Loss: 0.0851099
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0570892
	speed: 0.0370s/iter; left time: 737.3791s
	iters: 200, epoch: 12 | loss: 0.0618150
	speed: 0.0180s/iter; left time: 357.4730s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0586184 Vali Loss: 0.0831143 Test Loss: 0.0854465
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0575813
	speed: 0.0384s/iter; left time: 756.6247s
	iters: 200, epoch: 13 | loss: 0.0571408
	speed: 0.0191s/iter; left time: 374.3883s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0572359 Vali Loss: 0.0832216 Test Loss: 0.0854676
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0556617
	speed: 0.0372s/iter; left time: 723.8908s
	iters: 200, epoch: 14 | loss: 0.0540459
	speed: 0.0182s/iter; left time: 353.0339s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0558948 Vali Loss: 0.0837388 Test Loss: 0.0862194
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01954498514533043, rmse:0.13980337977409363, mae:0.08391264081001282, rse:0.5286116600036621
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1263471
	speed: 0.0199s/iter; left time: 444.9298s
	iters: 200, epoch: 1 | loss: 0.1159365
	speed: 0.0182s/iter; left time: 404.7903s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.1380923 Vali Loss: 0.1020415 Test Loss: 0.1047741
Validation loss decreased (inf --> 0.102042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0909317
	speed: 0.0410s/iter; left time: 908.6552s
	iters: 200, epoch: 2 | loss: 0.0883571
	speed: 0.0184s/iter; left time: 407.2738s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0914261 Vali Loss: 0.0803037 Test Loss: 0.0852146
Validation loss decreased (0.102042 --> 0.080304).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0859512
	speed: 0.0417s/iter; left time: 914.5156s
	iters: 200, epoch: 3 | loss: 0.0811047
	speed: 0.0181s/iter; left time: 395.5671s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0831277 Vali Loss: 0.0784896 Test Loss: 0.0827625
Validation loss decreased (0.080304 --> 0.078490).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0767060
	speed: 0.0399s/iter; left time: 867.1353s
	iters: 200, epoch: 4 | loss: 0.0806868
	speed: 0.0180s/iter; left time: 389.6694s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0796888 Vali Loss: 0.0783908 Test Loss: 0.0829460
Validation loss decreased (0.078490 --> 0.078391).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0777936
	speed: 0.0400s/iter; left time: 859.3647s
	iters: 200, epoch: 5 | loss: 0.0772324
	speed: 0.0180s/iter; left time: 385.5814s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0760393 Vali Loss: 0.0800801 Test Loss: 0.0835676
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0714719
	speed: 0.0381s/iter; left time: 809.8240s
	iters: 200, epoch: 6 | loss: 0.0720436
	speed: 0.0184s/iter; left time: 390.4538s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.0725466 Vali Loss: 0.0804555 Test Loss: 0.0829974
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0696251
	speed: 0.0378s/iter; left time: 794.7793s
	iters: 200, epoch: 7 | loss: 0.0676035
	speed: 0.0182s/iter; left time: 381.2569s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0692073 Vali Loss: 0.0817006 Test Loss: 0.0846338
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0691494
	speed: 0.0382s/iter; left time: 796.2091s
	iters: 200, epoch: 8 | loss: 0.0647662
	speed: 0.0180s/iter; left time: 373.8621s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.28s
Steps: 225 | Train Loss: 0.0662966 Vali Loss: 0.0818667 Test Loss: 0.0849675
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0623415
	speed: 0.0374s/iter; left time: 770.5469s
	iters: 200, epoch: 9 | loss: 0.0608835
	speed: 0.0181s/iter; left time: 372.0792s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0637759 Vali Loss: 0.0822691 Test Loss: 0.0853241
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0635078
	speed: 0.0382s/iter; left time: 778.6474s
	iters: 200, epoch: 10 | loss: 0.0581507
	speed: 0.0181s/iter; left time: 366.2177s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.28s
Steps: 225 | Train Loss: 0.0615833 Vali Loss: 0.0827696 Test Loss: 0.0859685
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0572104
	speed: 0.0378s/iter; left time: 761.9479s
	iters: 200, epoch: 11 | loss: 0.0578615
	speed: 0.0183s/iter; left time: 367.3211s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0598117 Vali Loss: 0.0834219 Test Loss: 0.0876955
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0567229
	speed: 0.0373s/iter; left time: 743.5879s
	iters: 200, epoch: 12 | loss: 0.0560101
	speed: 0.0181s/iter; left time: 358.4102s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0581680 Vali Loss: 0.0832148 Test Loss: 0.0870609
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0569095
	speed: 0.0401s/iter; left time: 790.2327s
	iters: 200, epoch: 13 | loss: 0.0528492
	speed: 0.0182s/iter; left time: 356.4160s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.54s
Steps: 225 | Train Loss: 0.0568319 Vali Loss: 0.0832953 Test Loss: 0.0874218
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0592510
	speed: 0.0389s/iter; left time: 757.8687s
	iters: 200, epoch: 14 | loss: 0.0547856
	speed: 0.0185s/iter; left time: 358.7852s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0558380 Vali Loss: 0.0831213 Test Loss: 0.0874076
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01917097717523575, rmse:0.13845929503440857, mae:0.08294600993394852, rse:0.5235295295715332
Intermediate time for IT and pred_len 96: 00h:02m:50.83s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1275234
	speed: 0.0489s/iter; left time: 1095.7558s
	iters: 200, epoch: 1 | loss: 0.1189954
	speed: 0.0184s/iter; left time: 410.1009s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.1412950 Vali Loss: 0.1040635 Test Loss: 0.1070162
Validation loss decreased (inf --> 0.104064).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0964050
	speed: 0.0446s/iter; left time: 988.6547s
	iters: 200, epoch: 2 | loss: 0.0886111
	speed: 0.0186s/iter; left time: 411.2500s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0955518 Vali Loss: 0.0854652 Test Loss: 0.0895273
Validation loss decreased (0.104064 --> 0.085465).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0866833
	speed: 0.0403s/iter; left time: 884.2453s
	iters: 200, epoch: 3 | loss: 0.0814698
	speed: 0.0184s/iter; left time: 401.6677s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0871050 Vali Loss: 0.0848689 Test Loss: 0.0877781
Validation loss decreased (0.085465 --> 0.084869).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0808554
	speed: 0.0399s/iter; left time: 867.7698s
	iters: 200, epoch: 4 | loss: 0.0826341
	speed: 0.0184s/iter; left time: 398.9754s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0828756 Vali Loss: 0.0852374 Test Loss: 0.0874300
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0791364
	speed: 0.0395s/iter; left time: 849.4162s
	iters: 200, epoch: 5 | loss: 0.0785064
	speed: 0.0188s/iter; left time: 402.0365s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0790885 Vali Loss: 0.0861373 Test Loss: 0.0885819
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0774719
	speed: 0.0388s/iter; left time: 826.0458s
	iters: 200, epoch: 6 | loss: 0.0751552
	speed: 0.0185s/iter; left time: 391.8285s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.0760913 Vali Loss: 0.0866237 Test Loss: 0.0889733
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0741134
	speed: 0.0385s/iter; left time: 811.0575s
	iters: 200, epoch: 7 | loss: 0.0721804
	speed: 0.0184s/iter; left time: 385.9033s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0732284 Vali Loss: 0.0865928 Test Loss: 0.0902340
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0724975
	speed: 0.0382s/iter; left time: 795.6113s
	iters: 200, epoch: 8 | loss: 0.0668545
	speed: 0.0187s/iter; left time: 388.2034s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0703631 Vali Loss: 0.0864248 Test Loss: 0.0899004
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0685533
	speed: 0.0388s/iter; left time: 799.9027s
	iters: 200, epoch: 9 | loss: 0.0653959
	speed: 0.0185s/iter; left time: 378.2960s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0678736 Vali Loss: 0.0872525 Test Loss: 0.0919391
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0666165
	speed: 0.0386s/iter; left time: 787.0395s
	iters: 200, epoch: 10 | loss: 0.0637973
	speed: 0.0184s/iter; left time: 372.3653s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0657089 Vali Loss: 0.0874528 Test Loss: 0.0922164
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0632579
	speed: 0.0385s/iter; left time: 775.3910s
	iters: 200, epoch: 11 | loss: 0.0619213
	speed: 0.0184s/iter; left time: 369.5624s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0639057 Vali Loss: 0.0867941 Test Loss: 0.0914731
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0624109
	speed: 0.0389s/iter; left time: 774.8493s
	iters: 200, epoch: 12 | loss: 0.0628552
	speed: 0.0188s/iter; left time: 372.6506s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0624616 Vali Loss: 0.0871244 Test Loss: 0.0930709
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0590759
	speed: 0.0386s/iter; left time: 760.5655s
	iters: 200, epoch: 13 | loss: 0.0594228
	speed: 0.0184s/iter; left time: 360.4445s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0609735 Vali Loss: 0.0873015 Test Loss: 0.0925411
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02027822844684124, rmse:0.14240165054798126, mae:0.0877780169248581, rse:0.5389363169670105
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1299536
	speed: 0.0203s/iter; left time: 454.0323s
	iters: 200, epoch: 1 | loss: 0.1161951
	speed: 0.0184s/iter; left time: 410.8560s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.1414682 Vali Loss: 0.1044085 Test Loss: 0.1074294
Validation loss decreased (inf --> 0.104409).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0972994
	speed: 0.0414s/iter; left time: 918.8161s
	iters: 200, epoch: 2 | loss: 0.0901106
	speed: 0.0184s/iter; left time: 406.2840s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0957896 Vali Loss: 0.0854568 Test Loss: 0.0893396
Validation loss decreased (0.104409 --> 0.085457).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0885999
	speed: 0.0417s/iter; left time: 915.1863s
	iters: 200, epoch: 3 | loss: 0.0868260
	speed: 0.0189s/iter; left time: 414.0367s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0873431 Vali Loss: 0.0845915 Test Loss: 0.0883179
Validation loss decreased (0.085457 --> 0.084591).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0882138
	speed: 0.0415s/iter; left time: 901.0840s
	iters: 200, epoch: 4 | loss: 0.0833410
	speed: 0.0188s/iter; left time: 406.2762s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.0834392 Vali Loss: 0.0851915 Test Loss: 0.0894194
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0792511
	speed: 0.0394s/iter; left time: 846.8447s
	iters: 200, epoch: 5 | loss: 0.0755284
	speed: 0.0187s/iter; left time: 400.5799s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.0796267 Vali Loss: 0.0848287 Test Loss: 0.0895064
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0772265
	speed: 0.0386s/iter; left time: 820.3110s
	iters: 200, epoch: 6 | loss: 0.0731446
	speed: 0.0184s/iter; left time: 389.2075s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0765081 Vali Loss: 0.0859261 Test Loss: 0.0894576
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0733916
	speed: 0.0391s/iter; left time: 822.9563s
	iters: 200, epoch: 7 | loss: 0.0741833
	speed: 0.0184s/iter; left time: 386.3229s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0736420 Vali Loss: 0.0860845 Test Loss: 0.0922697
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0725332
	speed: 0.0392s/iter; left time: 815.8906s
	iters: 200, epoch: 8 | loss: 0.0704023
	speed: 0.0184s/iter; left time: 380.7749s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0709409 Vali Loss: 0.0858436 Test Loss: 0.0913357
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0673422
	speed: 0.0397s/iter; left time: 817.1669s
	iters: 200, epoch: 9 | loss: 0.0649461
	speed: 0.0186s/iter; left time: 381.4714s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0682619 Vali Loss: 0.0864067 Test Loss: 0.0929804
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0666464
	speed: 0.0399s/iter; left time: 812.7487s
	iters: 200, epoch: 10 | loss: 0.0675855
	speed: 0.0185s/iter; left time: 374.4364s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0661923 Vali Loss: 0.0862028 Test Loss: 0.0925525
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0661159
	speed: 0.0393s/iter; left time: 792.4639s
	iters: 200, epoch: 11 | loss: 0.0636477
	speed: 0.0185s/iter; left time: 371.8596s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0644045 Vali Loss: 0.0867072 Test Loss: 0.0929461
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0620243
	speed: 0.0391s/iter; left time: 779.0745s
	iters: 200, epoch: 12 | loss: 0.0625289
	speed: 0.0184s/iter; left time: 363.8933s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0629564 Vali Loss: 0.0861273 Test Loss: 0.0923139
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0624796
	speed: 0.0387s/iter; left time: 762.3120s
	iters: 200, epoch: 13 | loss: 0.0605377
	speed: 0.0184s/iter; left time: 360.5589s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0615932 Vali Loss: 0.0867980 Test Loss: 0.0913889
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020756619051098824, rmse:0.1440715789794922, mae:0.08831792324781418, rse:0.5452563762664795
Intermediate time for IT and pred_len 168: 00h:02m:43.78sIntermediate time for IT: 00h:09m:29.43sTotal time: 01h:17m:10.27s