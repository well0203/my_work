
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1109489
	speed: 0.2633s/iter; left time: 5871.2787s
	iters: 200, epoch: 1 | loss: 0.0952382
	speed: 0.2383s/iter; left time: 5289.4022s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:54.83s
Steps: 224 | Train Loss: 0.1155067 Vali Loss: 0.1083518 Test Loss: 0.1112044
Validation loss decreased (inf --> 0.108352).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0853695
	speed: 0.4068s/iter; left time: 8981.1805s
	iters: 200, epoch: 2 | loss: 0.0768452
	speed: 0.2391s/iter; left time: 5254.7897s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:54.75s
Steps: 224 | Train Loss: 0.0867889 Vali Loss: 0.0997595 Test Loss: 0.1057357
Validation loss decreased (0.108352 --> 0.099760).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0717825
	speed: 0.4018s/iter; left time: 8780.3716s
	iters: 200, epoch: 3 | loss: 0.0752096
	speed: 0.2395s/iter; left time: 5209.2877s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:54.77s
Steps: 224 | Train Loss: 0.0778349 Vali Loss: 0.0996045 Test Loss: 0.1075717
Validation loss decreased (0.099760 --> 0.099605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0689414
	speed: 0.4003s/iter; left time: 8658.1574s
	iters: 200, epoch: 4 | loss: 0.0641905
	speed: 0.2405s/iter; left time: 5178.6549s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:54.79s
Steps: 224 | Train Loss: 0.0692325 Vali Loss: 0.1009384 Test Loss: 0.1114677
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0602262
	speed: 0.3959s/iter; left time: 8473.4672s
	iters: 200, epoch: 5 | loss: 0.0583288
	speed: 0.2404s/iter; left time: 5122.4174s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:54.82s
Steps: 224 | Train Loss: 0.0610049 Vali Loss: 0.1073610 Test Loss: 0.1140358
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0558130
	speed: 0.3960s/iter; left time: 8386.9148s
	iters: 200, epoch: 6 | loss: 0.0532776
	speed: 0.2406s/iter; left time: 5071.1537s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:54.80s
Steps: 224 | Train Loss: 0.0542289 Vali Loss: 0.1066051 Test Loss: 0.1141970
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0510769
	speed: 0.3962s/iter; left time: 8303.1168s
	iters: 200, epoch: 7 | loss: 0.0494076
	speed: 0.2406s/iter; left time: 5017.7542s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:54.83s
Steps: 224 | Train Loss: 0.0494761 Vali Loss: 0.1053507 Test Loss: 0.1131080
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0453761
	speed: 0.3953s/iter; left time: 8195.4985s
	iters: 200, epoch: 8 | loss: 0.0449939
	speed: 0.2396s/iter; left time: 4944.5879s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:54.72s
Steps: 224 | Train Loss: 0.0461576 Vali Loss: 0.1035232 Test Loss: 0.1117558
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0433610
	speed: 0.3961s/iter; left time: 8123.5186s
	iters: 200, epoch: 9 | loss: 0.0424259
	speed: 0.2408s/iter; left time: 4914.7361s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:54.89s
Steps: 224 | Train Loss: 0.0429519 Vali Loss: 0.1046586 Test Loss: 0.1130992
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0394825
	speed: 0.3966s/iter; left time: 8044.1733s
	iters: 200, epoch: 10 | loss: 0.0376842
	speed: 0.2174s/iter; left time: 4388.6260s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:52.51s
Steps: 224 | Train Loss: 0.0405697 Vali Loss: 0.1041840 Test Loss: 0.1121538
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0374314
	speed: 0.3964s/iter; left time: 7952.1349s
	iters: 200, epoch: 11 | loss: 0.0387215
	speed: 0.2260s/iter; left time: 4511.3871s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:53.38s
Steps: 224 | Train Loss: 0.0385892 Vali Loss: 0.1037510 Test Loss: 0.1121893
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0355178
	speed: 0.3971s/iter; left time: 7877.7225s
	iters: 200, epoch: 12 | loss: 0.0356695
	speed: 0.2298s/iter; left time: 4536.1446s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:53.84s
Steps: 224 | Train Loss: 0.0365500 Vali Loss: 0.1027543 Test Loss: 0.1116476
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0348221
	speed: 0.3963s/iter; left time: 7772.1812s
	iters: 200, epoch: 13 | loss: 0.0348689
	speed: 0.2392s/iter; left time: 4668.0738s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:54.72s
Steps: 224 | Train Loss: 0.0352979 Vali Loss: 0.1035189 Test Loss: 0.1112353
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.0275073554366827, rmse:0.16585341095924377, mae:0.10757164657115936, rse:0.5853196382522583
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1103482
	speed: 0.2486s/iter; left time: 5544.4599s
	iters: 200, epoch: 1 | loss: 0.0958276
	speed: 0.2398s/iter; left time: 5322.8170s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:54.82s
Steps: 224 | Train Loss: 0.1143746 Vali Loss: 0.1078708 Test Loss: 0.1104359
Validation loss decreased (inf --> 0.107871).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0828053
	speed: 0.4057s/iter; left time: 8956.1024s
	iters: 200, epoch: 2 | loss: 0.0800873
	speed: 0.2397s/iter; left time: 5267.8589s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:54.77s
Steps: 224 | Train Loss: 0.0861842 Vali Loss: 0.1001816 Test Loss: 0.1040925
Validation loss decreased (0.107871 --> 0.100182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0819630
	speed: 0.4070s/iter; left time: 8895.2147s
	iters: 200, epoch: 3 | loss: 0.0753070
	speed: 0.2393s/iter; left time: 5204.9938s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:54.72s
Steps: 224 | Train Loss: 0.0780263 Vali Loss: 0.1002141 Test Loss: 0.1067050
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0725230
	speed: 0.3962s/iter; left time: 8569.7919s
	iters: 200, epoch: 4 | loss: 0.0661550
	speed: 0.2401s/iter; left time: 5168.9487s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:54.78s
Steps: 224 | Train Loss: 0.0703752 Vali Loss: 0.1014087 Test Loss: 0.1105709
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0602602
	speed: 0.3957s/iter; left time: 8469.1353s
	iters: 200, epoch: 5 | loss: 0.0624111
	speed: 0.2393s/iter; left time: 5099.0745s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:54.70s
Steps: 224 | Train Loss: 0.0614053 Vali Loss: 0.1037445 Test Loss: 0.1116164
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0572918
	speed: 0.3971s/iter; left time: 8409.9491s
	iters: 200, epoch: 6 | loss: 0.0532473
	speed: 0.2398s/iter; left time: 5054.3051s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:54.78s
Steps: 224 | Train Loss: 0.0547826 Vali Loss: 0.1042659 Test Loss: 0.1143843
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0531275
	speed: 0.3967s/iter; left time: 8312.9179s
	iters: 200, epoch: 7 | loss: 0.0507528
	speed: 0.2399s/iter; left time: 5002.9992s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:54.79s
Steps: 224 | Train Loss: 0.0500892 Vali Loss: 0.1024727 Test Loss: 0.1148830
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0478937
	speed: 0.3961s/iter; left time: 8211.8661s
	iters: 200, epoch: 8 | loss: 0.0443542
	speed: 0.2399s/iter; left time: 4950.4058s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:54.77s
Steps: 224 | Train Loss: 0.0462275 Vali Loss: 0.1038521 Test Loss: 0.1139562
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0451974
	speed: 0.3970s/iter; left time: 8141.0942s
	iters: 200, epoch: 9 | loss: 0.0405368
	speed: 0.1811s/iter; left time: 3695.9169s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:45.71s
Steps: 224 | Train Loss: 0.0432047 Vali Loss: 0.1037602 Test Loss: 0.1140405
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0410385
	speed: 0.1845s/iter; left time: 3741.9901s
	iters: 200, epoch: 10 | loss: 0.0407696
	speed: 0.1126s/iter; left time: 2273.3070s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.37s
Steps: 224 | Train Loss: 0.0409397 Vali Loss: 0.1032428 Test Loss: 0.1141326
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0393265
	speed: 0.1850s/iter; left time: 3710.9428s
	iters: 200, epoch: 11 | loss: 0.0388284
	speed: 0.1126s/iter; left time: 2247.5483s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.38s
Steps: 224 | Train Loss: 0.0389891 Vali Loss: 0.1033076 Test Loss: 0.1146451
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0387249
	speed: 0.1844s/iter; left time: 3658.0804s
	iters: 200, epoch: 12 | loss: 0.0375599
	speed: 0.1126s/iter; left time: 2223.2327s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:25.39s
Steps: 224 | Train Loss: 0.0374552 Vali Loss: 0.1029910 Test Loss: 0.1138492
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025840627029538155, rmse:0.16075019538402557, mae:0.1040925458073616, rse:0.5673097372055054
Intermediate time for DE and pred_len 24: 00h:24m:49.79s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1226150
	speed: 0.1333s/iter; left time: 2972.5434s
	iters: 200, epoch: 1 | loss: 0.1182531
	speed: 0.1142s/iter; left time: 2534.7362s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.91s
Steps: 224 | Train Loss: 0.1299229 Vali Loss: 0.1308512 Test Loss: 0.1396754
Validation loss decreased (inf --> 0.130851).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1022758
	speed: 0.1997s/iter; left time: 4409.4030s
	iters: 200, epoch: 2 | loss: 0.0897320
	speed: 0.1143s/iter; left time: 2512.0722s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.1034280 Vali Loss: 0.1353325 Test Loss: 0.1447077
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0811744
	speed: 0.1879s/iter; left time: 4105.2959s
	iters: 200, epoch: 3 | loss: 0.0724340
	speed: 0.1142s/iter; left time: 2484.4332s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.72s
Steps: 224 | Train Loss: 0.0802302 Vali Loss: 0.1391014 Test Loss: 0.1532953
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0681699
	speed: 0.1881s/iter; left time: 4067.7171s
	iters: 200, epoch: 4 | loss: 0.0632240
	speed: 0.1145s/iter; left time: 2464.5933s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.78s
Steps: 224 | Train Loss: 0.0666149 Vali Loss: 0.1344487 Test Loss: 0.1470639
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0579004
	speed: 0.1874s/iter; left time: 4010.9178s
	iters: 200, epoch: 5 | loss: 0.0540619
	speed: 0.1142s/iter; left time: 2432.4329s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.71s
Steps: 224 | Train Loss: 0.0576659 Vali Loss: 0.1338723 Test Loss: 0.1470882
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0505061
	speed: 0.1877s/iter; left time: 3976.6799s
	iters: 200, epoch: 6 | loss: 0.0490749
	speed: 0.1142s/iter; left time: 2406.8402s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:25.74s
Steps: 224 | Train Loss: 0.0512682 Vali Loss: 0.1295775 Test Loss: 0.1448737
Validation loss decreased (0.130851 --> 0.129577).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0489329
	speed: 0.1928s/iter; left time: 4041.1192s
	iters: 200, epoch: 7 | loss: 0.0460904
	speed: 0.1141s/iter; left time: 2380.8042s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.71s
Steps: 224 | Train Loss: 0.0463595 Vali Loss: 0.1293865 Test Loss: 0.1424503
Validation loss decreased (0.129577 --> 0.129387).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0409309
	speed: 0.1951s/iter; left time: 4044.5735s
	iters: 200, epoch: 8 | loss: 0.0417876
	speed: 0.1141s/iter; left time: 2354.0085s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.73s
Steps: 224 | Train Loss: 0.0436217 Vali Loss: 0.1270242 Test Loss: 0.1427297
Validation loss decreased (0.129387 --> 0.127024).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0413485
	speed: 0.1932s/iter; left time: 3962.6213s
	iters: 200, epoch: 9 | loss: 0.0388139
	speed: 0.1142s/iter; left time: 2331.0409s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.75s
Steps: 224 | Train Loss: 0.0404196 Vali Loss: 0.1273684 Test Loss: 0.1415675
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0391424
	speed: 0.1872s/iter; left time: 3797.7988s
	iters: 200, epoch: 10 | loss: 0.0371639
	speed: 0.1142s/iter; left time: 2305.7252s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.72s
Steps: 224 | Train Loss: 0.0388704 Vali Loss: 0.1267510 Test Loss: 0.1414519
Validation loss decreased (0.127024 --> 0.126751).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0386532
	speed: 0.1950s/iter; left time: 3912.6665s
	iters: 200, epoch: 11 | loss: 0.0372836
	speed: 0.1144s/iter; left time: 2283.2838s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0378412 Vali Loss: 0.1265672 Test Loss: 0.1417294
Validation loss decreased (0.126751 --> 0.126567).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0378600
	speed: 0.1968s/iter; left time: 3903.2021s
	iters: 200, epoch: 12 | loss: 0.0357786
	speed: 0.1143s/iter; left time: 2256.2022s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0368903 Vali Loss: 0.1256146 Test Loss: 0.1405469
Validation loss decreased (0.126567 --> 0.125615).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0345110
	speed: 0.1943s/iter; left time: 3811.4037s
	iters: 200, epoch: 13 | loss: 0.0357965
	speed: 0.1144s/iter; left time: 2231.4975s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0356778 Vali Loss: 0.1252002 Test Loss: 0.1406935
Validation loss decreased (0.125615 --> 0.125200).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0323855
	speed: 0.1972s/iter; left time: 3823.5383s
	iters: 200, epoch: 14 | loss: 0.0329009
	speed: 0.1142s/iter; left time: 2203.6244s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0343202 Vali Loss: 0.1253324 Test Loss: 0.1405168
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0323505
	speed: 0.1878s/iter; left time: 3599.2296s
	iters: 200, epoch: 15 | loss: 0.0322434
	speed: 0.1144s/iter; left time: 2181.7019s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:25.76s
Steps: 224 | Train Loss: 0.0335095 Vali Loss: 0.1251202 Test Loss: 0.1402850
Validation loss decreased (0.125200 --> 0.125120).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0327380
	speed: 0.1958s/iter; left time: 3709.4016s
	iters: 200, epoch: 16 | loss: 0.0324922
	speed: 0.1142s/iter; left time: 2152.0034s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:25.74s
Steps: 224 | Train Loss: 0.0330375 Vali Loss: 0.1249309 Test Loss: 0.1400101
Validation loss decreased (0.125120 --> 0.124931).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0340246
	speed: 0.1940s/iter; left time: 3630.2774s
	iters: 200, epoch: 17 | loss: 0.0319108
	speed: 0.1143s/iter; left time: 2127.6390s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:25.75s
Steps: 224 | Train Loss: 0.0323174 Vali Loss: 0.1251980 Test Loss: 0.1406527
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0310867
	speed: 0.1880s/iter; left time: 3476.9953s
	iters: 200, epoch: 18 | loss: 0.0329175
	speed: 0.1144s/iter; left time: 2103.3772s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:25.83s
Steps: 224 | Train Loss: 0.0319874 Vali Loss: 0.1249680 Test Loss: 0.1406658
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0300979
	speed: 0.1881s/iter; left time: 3436.6852s
	iters: 200, epoch: 19 | loss: 0.0297576
	speed: 0.1144s/iter; left time: 2077.8339s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0317443 Vali Loss: 0.1254847 Test Loss: 0.1416140
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0323375
	speed: 0.1877s/iter; left time: 3387.6358s
	iters: 200, epoch: 20 | loss: 0.0298289
	speed: 0.1145s/iter; left time: 2054.3848s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0311367 Vali Loss: 0.1243955 Test Loss: 0.1405652
Validation loss decreased (0.124931 --> 0.124395).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0301552
	speed: 0.1955s/iter; left time: 3483.4265s
	iters: 200, epoch: 21 | loss: 0.0301162
	speed: 0.1143s/iter; left time: 2025.5960s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:25.76s
Steps: 224 | Train Loss: 0.0305248 Vali Loss: 0.1245641 Test Loss: 0.1400240
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0301168
	speed: 0.1880s/iter; left time: 3308.7081s
	iters: 200, epoch: 22 | loss: 0.0298903
	speed: 0.1146s/iter; left time: 2004.5054s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0302466 Vali Loss: 0.1249774 Test Loss: 0.1402576
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0299915
	speed: 0.1881s/iter; left time: 3267.4823s
	iters: 200, epoch: 23 | loss: 0.0301717
	speed: 0.1146s/iter; left time: 1978.8253s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0298998 Vali Loss: 0.1245975 Test Loss: 0.1403042
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0326951
	speed: 0.1893s/iter; left time: 3245.6559s
	iters: 200, epoch: 24 | loss: 0.0306370
	speed: 0.1144s/iter; left time: 1950.6380s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0297374 Vali Loss: 0.1246434 Test Loss: 0.1400393
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0289368
	speed: 0.1877s/iter; left time: 3177.1295s
	iters: 200, epoch: 25 | loss: 0.0295004
	speed: 0.1144s/iter; left time: 1924.9846s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:25.75s
Steps: 224 | Train Loss: 0.0294177 Vali Loss: 0.1245420 Test Loss: 0.1403362
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0315776
	speed: 0.1887s/iter; left time: 3151.7808s
	iters: 200, epoch: 26 | loss: 0.0291449
	speed: 0.1145s/iter; left time: 1900.8581s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0294326 Vali Loss: 0.1244376 Test Loss: 0.1400561
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0297491
	speed: 0.1886s/iter; left time: 3107.8881s
	iters: 200, epoch: 27 | loss: 0.0287653
	speed: 0.1146s/iter; left time: 1876.9489s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.0290371 Vali Loss: 0.1247046 Test Loss: 0.1401896
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0296221
	speed: 0.1889s/iter; left time: 3070.6005s
	iters: 200, epoch: 28 | loss: 0.0283981
	speed: 0.1145s/iter; left time: 1848.7718s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0288454 Vali Loss: 0.1244726 Test Loss: 0.1396665
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0297810
	speed: 0.1883s/iter; left time: 3018.2595s
	iters: 200, epoch: 29 | loss: 0.0279334
	speed: 0.1146s/iter; left time: 1825.1856s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:25.85s
Steps: 224 | Train Loss: 0.0286309 Vali Loss: 0.1243125 Test Loss: 0.1399195
Validation loss decreased (0.124395 --> 0.124313).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0276876
	speed: 0.1959s/iter; left time: 3096.7602s
	iters: 200, epoch: 30 | loss: 0.0292118
	speed: 0.1145s/iter; left time: 1798.5835s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0284383 Vali Loss: 0.1242117 Test Loss: 0.1396751
Validation loss decreased (0.124313 --> 0.124212).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0275146
	speed: 0.1989s/iter; left time: 3098.6512s
	iters: 200, epoch: 31 | loss: 0.0284093
	speed: 0.1144s/iter; left time: 1770.9660s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0284287 Vali Loss: 0.1244920 Test Loss: 0.1398601
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0275073
	speed: 0.1881s/iter; left time: 2888.2442s
	iters: 200, epoch: 32 | loss: 0.0284042
	speed: 0.1144s/iter; left time: 1745.1254s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0283188 Vali Loss: 0.1244311 Test Loss: 0.1398446
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0277961
	speed: 0.1888s/iter; left time: 2857.3351s
	iters: 200, epoch: 33 | loss: 0.0292866
	speed: 0.1144s/iter; left time: 1720.4853s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:25.81s
Steps: 224 | Train Loss: 0.0282729 Vali Loss: 0.1244384 Test Loss: 0.1401647
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0281859
	speed: 0.1885s/iter; left time: 2810.3185s
	iters: 200, epoch: 34 | loss: 0.0277095
	speed: 0.1144s/iter; left time: 1694.7845s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0280967 Vali Loss: 0.1243316 Test Loss: 0.1399554
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0278826
	speed: 0.1878s/iter; left time: 2758.0752s
	iters: 200, epoch: 35 | loss: 0.0281151
	speed: 0.1146s/iter; left time: 1670.8748s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:25.83s
Steps: 224 | Train Loss: 0.0279987 Vali Loss: 0.1243879 Test Loss: 0.1400920
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0276429
	speed: 0.1879s/iter; left time: 2717.0255s
	iters: 200, epoch: 36 | loss: 0.0288605
	speed: 0.1145s/iter; left time: 1645.0410s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:25.81s
Steps: 224 | Train Loss: 0.0279446 Vali Loss: 0.1244602 Test Loss: 0.1399991
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0279505
	speed: 0.1890s/iter; left time: 2691.4850s
	iters: 200, epoch: 37 | loss: 0.0284561
	speed: 0.1146s/iter; left time: 1619.4282s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0278080 Vali Loss: 0.1243969 Test Loss: 0.1400524
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0272906
	speed: 0.1894s/iter; left time: 2653.3995s
	iters: 200, epoch: 38 | loss: 0.0278811
	speed: 0.1144s/iter; left time: 1591.9350s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0278492 Vali Loss: 0.1244442 Test Loss: 0.1399940
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0280490
	speed: 0.1883s/iter; left time: 2596.7091s
	iters: 200, epoch: 39 | loss: 0.0281945
	speed: 0.1145s/iter; left time: 1567.6553s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:25.81s
Steps: 224 | Train Loss: 0.0277998 Vali Loss: 0.1243664 Test Loss: 0.1398119
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0293185
	speed: 0.1886s/iter; left time: 2558.4422s
	iters: 200, epoch: 40 | loss: 0.0270738
	speed: 0.1144s/iter; left time: 1540.5107s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.0276241 Vali Loss: 0.1245612 Test Loss: 0.1400561
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04147864505648613, rmse:0.20366306602954865, mae:0.1396750956773758, rse:0.7212120890617371
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1288839
	speed: 0.1164s/iter; left time: 2595.3624s
	iters: 200, epoch: 1 | loss: 0.1137839
	speed: 0.1144s/iter; left time: 2539.0555s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.1299195 Vali Loss: 0.1310028 Test Loss: 0.1397200
Validation loss decreased (inf --> 0.131003).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1073349
	speed: 0.1966s/iter; left time: 4339.5262s
	iters: 200, epoch: 2 | loss: 0.0950987
	speed: 0.1144s/iter; left time: 2514.8093s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.83s
Steps: 224 | Train Loss: 0.1030417 Vali Loss: 0.1388999 Test Loss: 0.1517902
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0791117
	speed: 0.1894s/iter; left time: 4139.5796s
	iters: 200, epoch: 3 | loss: 0.0722794
	speed: 0.1143s/iter; left time: 2486.3581s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0785826 Vali Loss: 0.1416415 Test Loss: 0.1542835
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0637004
	speed: 0.1889s/iter; left time: 4085.9351s
	iters: 200, epoch: 4 | loss: 0.0619431
	speed: 0.1145s/iter; left time: 2464.1087s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.84s
Steps: 224 | Train Loss: 0.0649998 Vali Loss: 0.1352613 Test Loss: 0.1529066
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0580005
	speed: 0.1892s/iter; left time: 4049.2779s
	iters: 200, epoch: 5 | loss: 0.0524179
	speed: 0.1145s/iter; left time: 2438.7270s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0563477 Vali Loss: 0.1337936 Test Loss: 0.1512942
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0498987
	speed: 0.1895s/iter; left time: 4014.1278s
	iters: 200, epoch: 6 | loss: 0.0472281
	speed: 0.1146s/iter; left time: 2414.8472s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:25.89s
Steps: 224 | Train Loss: 0.0502743 Vali Loss: 0.1306086 Test Loss: 0.1476092
Validation loss decreased (0.131003 --> 0.130609).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0455996
	speed: 0.1954s/iter; left time: 4095.9106s
	iters: 200, epoch: 7 | loss: 0.0417493
	speed: 0.1145s/iter; left time: 2387.6070s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.0459799 Vali Loss: 0.1294520 Test Loss: 0.1479440
Validation loss decreased (0.130609 --> 0.129452).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0416085
	speed: 0.1944s/iter; left time: 4029.9720s
	iters: 200, epoch: 8 | loss: 0.0418107
	speed: 0.1144s/iter; left time: 2359.7286s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0428698 Vali Loss: 0.1286364 Test Loss: 0.1458811
Validation loss decreased (0.129452 --> 0.128636).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0399102
	speed: 0.1944s/iter; left time: 3987.3517s
	iters: 200, epoch: 9 | loss: 0.0432618
	speed: 0.1142s/iter; left time: 2331.2336s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.78s
Steps: 224 | Train Loss: 0.0405217 Vali Loss: 0.1281808 Test Loss: 0.1446299
Validation loss decreased (0.128636 --> 0.128181).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0396652
	speed: 0.1964s/iter; left time: 3984.3325s
	iters: 200, epoch: 10 | loss: 0.0407590
	speed: 0.1142s/iter; left time: 2305.1144s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0388593 Vali Loss: 0.1282909 Test Loss: 0.1457209
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0362043
	speed: 0.1887s/iter; left time: 3786.0224s
	iters: 200, epoch: 11 | loss: 0.0408427
	speed: 0.1142s/iter; left time: 2279.6893s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0369468 Vali Loss: 0.1277130 Test Loss: 0.1453613
Validation loss decreased (0.128181 --> 0.127713).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0358752
	speed: 0.1974s/iter; left time: 3915.8744s
	iters: 200, epoch: 12 | loss: 0.0375533
	speed: 0.1142s/iter; left time: 2254.7330s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0358894 Vali Loss: 0.1274495 Test Loss: 0.1443967
Validation loss decreased (0.127713 --> 0.127449).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0337306
	speed: 0.1948s/iter; left time: 3820.1644s
	iters: 200, epoch: 13 | loss: 0.0346294
	speed: 0.1143s/iter; left time: 2231.0023s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:25.79s
Steps: 224 | Train Loss: 0.0346799 Vali Loss: 0.1268722 Test Loss: 0.1438521
Validation loss decreased (0.127449 --> 0.126872).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0329260
	speed: 0.1969s/iter; left time: 3817.2072s
	iters: 200, epoch: 14 | loss: 0.0329342
	speed: 0.1142s/iter; left time: 2202.1846s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:25.78s
Steps: 224 | Train Loss: 0.0338324 Vali Loss: 0.1270568 Test Loss: 0.1446147
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0336705
	speed: 0.1890s/iter; left time: 3622.2042s
	iters: 200, epoch: 15 | loss: 0.0308707
	speed: 0.1143s/iter; left time: 2178.3891s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0328480 Vali Loss: 0.1267032 Test Loss: 0.1442307
Validation loss decreased (0.126872 --> 0.126703).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0330756
	speed: 0.1941s/iter; left time: 3675.8683s
	iters: 200, epoch: 16 | loss: 0.0350973
	speed: 0.1142s/iter; left time: 2152.5254s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0324840 Vali Loss: 0.1267505 Test Loss: 0.1443616
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0308495
	speed: 0.1883s/iter; left time: 3524.9961s
	iters: 200, epoch: 17 | loss: 0.0313479
	speed: 0.1143s/iter; left time: 2127.7930s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0318300 Vali Loss: 0.1265211 Test Loss: 0.1433214
Validation loss decreased (0.126703 --> 0.126521).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0302210
	speed: 0.1964s/iter; left time: 3631.5241s
	iters: 200, epoch: 18 | loss: 0.0319196
	speed: 0.1142s/iter; left time: 2099.5973s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:25.74s
Steps: 224 | Train Loss: 0.0310570 Vali Loss: 0.1262559 Test Loss: 0.1434726
Validation loss decreased (0.126521 --> 0.126256).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0306709
	speed: 0.1951s/iter; left time: 3564.3628s
	iters: 200, epoch: 19 | loss: 0.0429818
	speed: 0.1144s/iter; left time: 2078.2827s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0305440 Vali Loss: 0.1263299 Test Loss: 0.1435005
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0284527
	speed: 0.1888s/iter; left time: 3406.3202s
	iters: 200, epoch: 20 | loss: 0.0292517
	speed: 0.1144s/iter; left time: 2052.5898s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:25.84s
Steps: 224 | Train Loss: 0.0301323 Vali Loss: 0.1261895 Test Loss: 0.1430096
Validation loss decreased (0.126256 --> 0.126189).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0291956
	speed: 0.1949s/iter; left time: 3472.7480s
	iters: 200, epoch: 21 | loss: 0.0301225
	speed: 0.1142s/iter; left time: 2024.0806s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:25.78s
Steps: 224 | Train Loss: 0.0297195 Vali Loss: 0.1257560 Test Loss: 0.1427963
Validation loss decreased (0.126189 --> 0.125756).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0284279
	speed: 0.1957s/iter; left time: 3443.1853s
	iters: 200, epoch: 22 | loss: 0.0300122
	speed: 0.1142s/iter; left time: 1998.8226s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0296042 Vali Loss: 0.1264805 Test Loss: 0.1437082
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0303170
	speed: 0.1885s/iter; left time: 3274.3494s
	iters: 200, epoch: 23 | loss: 0.0321218
	speed: 0.1143s/iter; left time: 1974.3722s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0292882 Vali Loss: 0.1261976 Test Loss: 0.1430466
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0287582
	speed: 0.1879s/iter; left time: 3222.4815s
	iters: 200, epoch: 24 | loss: 0.0310818
	speed: 0.1142s/iter; left time: 1947.6944s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:25.75s
Steps: 224 | Train Loss: 0.0289555 Vali Loss: 0.1263883 Test Loss: 0.1430530
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0295406
	speed: 0.1887s/iter; left time: 3194.2838s
	iters: 200, epoch: 25 | loss: 0.0289943
	speed: 0.1146s/iter; left time: 1927.3162s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:25.85s
Steps: 224 | Train Loss: 0.0291624 Vali Loss: 0.1264053 Test Loss: 0.1433336
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0282236
	speed: 0.1882s/iter; left time: 3142.7508s
	iters: 200, epoch: 26 | loss: 0.0285622
	speed: 0.1145s/iter; left time: 1900.7993s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:25.84s
Steps: 224 | Train Loss: 0.0284755 Vali Loss: 0.1259232 Test Loss: 0.1431038
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0278381
	speed: 0.1884s/iter; left time: 3104.1523s
	iters: 200, epoch: 27 | loss: 0.0279267
	speed: 0.1146s/iter; left time: 1876.6860s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0282007 Vali Loss: 0.1258608 Test Loss: 0.1431603
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0278067
	speed: 0.1888s/iter; left time: 3067.9779s
	iters: 200, epoch: 28 | loss: 0.0281676
	speed: 0.1145s/iter; left time: 1848.8148s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:25.81s
Steps: 224 | Train Loss: 0.0283202 Vali Loss: 0.1260465 Test Loss: 0.1431694
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0275961
	speed: 0.1889s/iter; left time: 3028.5706s
	iters: 200, epoch: 29 | loss: 0.0280197
	speed: 0.1146s/iter; left time: 1825.1245s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0280489 Vali Loss: 0.1260042 Test Loss: 0.1430768
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0291647
	speed: 0.1881s/iter; left time: 2973.4132s
	iters: 200, epoch: 30 | loss: 0.0269338
	speed: 0.1146s/iter; left time: 1799.1768s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:25.83s
Steps: 224 | Train Loss: 0.0278302 Vali Loss: 0.1262518 Test Loss: 0.1430750
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0283949
	speed: 0.1895s/iter; left time: 2952.9874s
	iters: 200, epoch: 31 | loss: 0.0273185
	speed: 0.1146s/iter; left time: 1774.6344s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:25.89s
Steps: 224 | Train Loss: 0.0275926 Vali Loss: 0.1261168 Test Loss: 0.1430802
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04293755069375038, rmse:0.20721377432346344, mae:0.14279627799987793, rse:0.73378586769104
Intermediate time for DE and pred_len 96: 00h:36m:23.18s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1259508
	speed: 0.1364s/iter; left time: 3029.1099s
	iters: 200, epoch: 1 | loss: 0.1191675
	speed: 0.1164s/iter; left time: 2571.7715s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.1338917 Vali Loss: 0.1335166 Test Loss: 0.1439767
Validation loss decreased (inf --> 0.133517).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1045370
	speed: 0.1969s/iter; left time: 4327.4955s
	iters: 200, epoch: 2 | loss: 0.0937445
	speed: 0.1166s/iter; left time: 2550.3693s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:26.16s
Steps: 223 | Train Loss: 0.1053240 Vali Loss: 0.1384441 Test Loss: 0.1588684
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0795369
	speed: 0.1891s/iter; left time: 4113.2914s
	iters: 200, epoch: 3 | loss: 0.0731504
	speed: 0.1167s/iter; left time: 2527.4524s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:26.19s
Steps: 223 | Train Loss: 0.0802317 Vali Loss: 0.1370745 Test Loss: 0.1528045
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0679922
	speed: 0.1891s/iter; left time: 4071.8160s
	iters: 200, epoch: 4 | loss: 0.0634485
	speed: 0.1168s/iter; left time: 2504.1471s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.15s
Steps: 223 | Train Loss: 0.0670191 Vali Loss: 0.1354217 Test Loss: 0.1523125
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0573535
	speed: 0.1894s/iter; left time: 4036.3796s
	iters: 200, epoch: 5 | loss: 0.0544073
	speed: 0.1171s/iter; left time: 2482.6042s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:26.21s
Steps: 223 | Train Loss: 0.0583285 Vali Loss: 0.1337000 Test Loss: 0.1513691
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0512740
	speed: 0.1906s/iter; left time: 4018.7843s
	iters: 200, epoch: 6 | loss: 0.0484167
	speed: 0.1171s/iter; left time: 2457.1437s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.22s
Steps: 223 | Train Loss: 0.0513432 Vali Loss: 0.1331491 Test Loss: 0.1504783
Validation loss decreased (0.133517 --> 0.133149).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0456368
	speed: 0.1970s/iter; left time: 4110.5342s
	iters: 200, epoch: 7 | loss: 0.0481442
	speed: 0.1170s/iter; left time: 2430.1169s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:26.21s
Steps: 223 | Train Loss: 0.0473240 Vali Loss: 0.1322103 Test Loss: 0.1490826
Validation loss decreased (0.133149 --> 0.132210).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0407034
	speed: 0.1963s/iter; left time: 4050.7383s
	iters: 200, epoch: 8 | loss: 0.0427346
	speed: 0.1169s/iter; left time: 2401.8700s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:26.19s
Steps: 223 | Train Loss: 0.0438069 Vali Loss: 0.1313763 Test Loss: 0.1468178
Validation loss decreased (0.132210 --> 0.131376).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0411708
	speed: 0.1999s/iter; left time: 4081.5355s
	iters: 200, epoch: 9 | loss: 0.0409511
	speed: 0.1169s/iter; left time: 2375.4999s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:26.17s
Steps: 223 | Train Loss: 0.0418449 Vali Loss: 0.1308280 Test Loss: 0.1464002
Validation loss decreased (0.131376 --> 0.130828).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0402771
	speed: 0.1970s/iter; left time: 3978.6563s
	iters: 200, epoch: 10 | loss: 0.0397172
	speed: 0.1169s/iter; left time: 2349.3901s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:26.22s
Steps: 223 | Train Loss: 0.0400650 Vali Loss: 0.1305335 Test Loss: 0.1481147
Validation loss decreased (0.130828 --> 0.130533).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0378958
	speed: 0.1962s/iter; left time: 3918.7732s
	iters: 200, epoch: 11 | loss: 0.0394332
	speed: 0.1169s/iter; left time: 2322.9459s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:26.19s
Steps: 223 | Train Loss: 0.0388011 Vali Loss: 0.1302036 Test Loss: 0.1464835
Validation loss decreased (0.130533 --> 0.130204).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0354162
	speed: 0.1970s/iter; left time: 3890.3935s
	iters: 200, epoch: 12 | loss: 0.0372836
	speed: 0.1169s/iter; left time: 2296.4125s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:26.17s
Steps: 223 | Train Loss: 0.0368473 Vali Loss: 0.1303177 Test Loss: 0.1463701
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0350061
	speed: 0.1906s/iter; left time: 3721.2968s
	iters: 200, epoch: 13 | loss: 0.0355238
	speed: 0.1169s/iter; left time: 2271.1318s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:26.22s
Steps: 223 | Train Loss: 0.0355788 Vali Loss: 0.1308105 Test Loss: 0.1472457
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0354247
	speed: 0.1902s/iter; left time: 3671.3494s
	iters: 200, epoch: 14 | loss: 0.0358873
	speed: 0.1171s/iter; left time: 2247.9982s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0348459 Vali Loss: 0.1301919 Test Loss: 0.1465304
Validation loss decreased (0.130204 --> 0.130192).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0333780
	speed: 0.1980s/iter; left time: 3777.9308s
	iters: 200, epoch: 15 | loss: 0.0320167
	speed: 0.1170s/iter; left time: 2219.7508s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0341728 Vali Loss: 0.1293186 Test Loss: 0.1462120
Validation loss decreased (0.130192 --> 0.129319).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0348681
	speed: 0.2005s/iter; left time: 3780.8898s
	iters: 200, epoch: 16 | loss: 0.0322450
	speed: 0.1171s/iter; left time: 2196.7051s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0334051 Vali Loss: 0.1298977 Test Loss: 0.1456783
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0329997
	speed: 0.1904s/iter; left time: 3548.0099s
	iters: 200, epoch: 17 | loss: 0.0309017
	speed: 0.1171s/iter; left time: 2169.9639s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0326999 Vali Loss: 0.1294487 Test Loss: 0.1458690
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0319840
	speed: 0.1907s/iter; left time: 3510.2274s
	iters: 200, epoch: 18 | loss: 0.0307835
	speed: 0.1170s/iter; left time: 2142.2568s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0320643 Vali Loss: 0.1293023 Test Loss: 0.1457102
Validation loss decreased (0.129319 --> 0.129302).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0320113
	speed: 0.2047s/iter; left time: 3722.5503s
	iters: 200, epoch: 19 | loss: 0.0307094
	speed: 0.1171s/iter; left time: 2117.4609s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0317509 Vali Loss: 0.1291535 Test Loss: 0.1458965
Validation loss decreased (0.129302 --> 0.129154).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0318130
	speed: 0.1989s/iter; left time: 3573.4630s
	iters: 200, epoch: 20 | loss: 0.0308567
	speed: 0.1170s/iter; left time: 2090.5950s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0314974 Vali Loss: 0.1291133 Test Loss: 0.1451403
Validation loss decreased (0.129154 --> 0.129113).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0300951
	speed: 0.1979s/iter; left time: 3511.5690s
	iters: 200, epoch: 21 | loss: 0.0303690
	speed: 0.1170s/iter; left time: 2064.6719s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:26.30s
Steps: 223 | Train Loss: 0.0308049 Vali Loss: 0.1292280 Test Loss: 0.1452276
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0322454
	speed: 0.1904s/iter; left time: 3335.7879s
	iters: 200, epoch: 22 | loss: 0.0302031
	speed: 0.1171s/iter; left time: 2040.1494s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0304760 Vali Loss: 0.1292229 Test Loss: 0.1453684
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0293337
	speed: 0.1911s/iter; left time: 3304.9133s
	iters: 200, epoch: 23 | loss: 0.0299285
	speed: 0.1171s/iter; left time: 2012.9674s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0301500 Vali Loss: 0.1292696 Test Loss: 0.1456520
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0295419
	speed: 0.1909s/iter; left time: 3259.7087s
	iters: 200, epoch: 24 | loss: 0.0297825
	speed: 0.1171s/iter; left time: 1987.1486s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0300165 Vali Loss: 0.1292682 Test Loss: 0.1455397
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0299591
	speed: 0.1901s/iter; left time: 3202.8096s
	iters: 200, epoch: 25 | loss: 0.0295222
	speed: 0.1172s/iter; left time: 1962.2437s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0296270 Vali Loss: 0.1293446 Test Loss: 0.1451683
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0306046
	speed: 0.1901s/iter; left time: 3160.4149s
	iters: 200, epoch: 26 | loss: 0.0295282
	speed: 0.1172s/iter; left time: 1936.3410s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0293737 Vali Loss: 0.1291889 Test Loss: 0.1448202
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0303261
	speed: 0.1913s/iter; left time: 3138.3144s
	iters: 200, epoch: 27 | loss: 0.0283582
	speed: 0.1170s/iter; left time: 1907.9463s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0292490 Vali Loss: 0.1292095 Test Loss: 0.1451797
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0302450
	speed: 0.1901s/iter; left time: 3076.4632s
	iters: 200, epoch: 28 | loss: 0.0287697
	speed: 0.1171s/iter; left time: 1882.1901s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0293548 Vali Loss: 0.1291838 Test Loss: 0.1449611
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0282113
	speed: 0.1906s/iter; left time: 3041.0956s
	iters: 200, epoch: 29 | loss: 0.0293350
	speed: 0.1169s/iter; left time: 1853.9182s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:26.24s
Steps: 223 | Train Loss: 0.0290777 Vali Loss: 0.1292106 Test Loss: 0.1445967
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0295787
	speed: 0.1910s/iter; left time: 3005.3109s
	iters: 200, epoch: 30 | loss: 0.0277456
	speed: 0.1169s/iter; left time: 1827.7769s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:26.24s
Steps: 223 | Train Loss: 0.0288225 Vali Loss: 0.1289469 Test Loss: 0.1450666
Validation loss decreased (0.129113 --> 0.128947).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0301890
	speed: 0.1985s/iter; left time: 3078.5638s
	iters: 200, epoch: 31 | loss: 0.0291125
	speed: 0.1168s/iter; left time: 1800.1544s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0286989 Vali Loss: 0.1289192 Test Loss: 0.1446767
Validation loss decreased (0.128947 --> 0.128919).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0284423
	speed: 0.1987s/iter; left time: 3038.4632s
	iters: 200, epoch: 32 | loss: 0.0280180
	speed: 0.1168s/iter; left time: 1774.4589s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:26.23s
Steps: 223 | Train Loss: 0.0285254 Vali Loss: 0.1291523 Test Loss: 0.1447995
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0285629
	speed: 0.1900s/iter; left time: 2862.3065s
	iters: 200, epoch: 33 | loss: 0.0277171
	speed: 0.1169s/iter; left time: 1749.1050s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:26.23s
Steps: 223 | Train Loss: 0.0284774 Vali Loss: 0.1290738 Test Loss: 0.1448900
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0276616
	speed: 0.1911s/iter; left time: 2836.9297s
	iters: 200, epoch: 34 | loss: 0.0283545
	speed: 0.1169s/iter; left time: 1723.4642s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0283382 Vali Loss: 0.1291374 Test Loss: 0.1448321
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0273929
	speed: 0.1903s/iter; left time: 2782.5634s
	iters: 200, epoch: 35 | loss: 0.0278200
	speed: 0.1170s/iter; left time: 1698.5492s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:26.24s
Steps: 223 | Train Loss: 0.0282820 Vali Loss: 0.1293448 Test Loss: 0.1448247
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0283576
	speed: 0.1905s/iter; left time: 2743.0874s
	iters: 200, epoch: 36 | loss: 0.0276336
	speed: 0.1170s/iter; left time: 1672.3819s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0281641 Vali Loss: 0.1290798 Test Loss: 0.1450340
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0276468
	speed: 0.1907s/iter; left time: 2702.6771s
	iters: 200, epoch: 37 | loss: 0.0266907
	speed: 0.1170s/iter; left time: 1646.0001s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:26.23s
Steps: 223 | Train Loss: 0.0281276 Vali Loss: 0.1292016 Test Loss: 0.1450702
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0283411
	speed: 0.1909s/iter; left time: 2663.0621s
	iters: 200, epoch: 38 | loss: 0.0281926
	speed: 0.1170s/iter; left time: 1620.1042s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0280319 Vali Loss: 0.1292742 Test Loss: 0.1450309
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0287064
	speed: 0.1899s/iter; left time: 2606.1666s
	iters: 200, epoch: 39 | loss: 0.0275350
	speed: 0.1169s/iter; left time: 1592.7542s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:26.21s
Steps: 223 | Train Loss: 0.0279438 Vali Loss: 0.1291579 Test Loss: 0.1448100
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0282374
	speed: 0.1909s/iter; left time: 2577.5133s
	iters: 200, epoch: 40 | loss: 0.0281288
	speed: 0.1169s/iter; left time: 1566.6854s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0279037 Vali Loss: 0.1292915 Test Loss: 0.1451328
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0276808
	speed: 0.1894s/iter; left time: 2515.9985s
	iters: 200, epoch: 41 | loss: 0.0275428
	speed: 0.1169s/iter; left time: 1541.1792s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:26.21s
Steps: 223 | Train Loss: 0.0278420 Vali Loss: 0.1290838 Test Loss: 0.1446809
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04459270462393761, rmse:0.21116985380649567, mae:0.14467673003673553, rse:0.7479805946350098
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1340840
	speed: 0.1183s/iter; left time: 2626.6804s
	iters: 200, epoch: 1 | loss: 0.1213893
	speed: 0.1170s/iter; left time: 2584.8992s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.1337071 Vali Loss: 0.1338458 Test Loss: 0.1442053
Validation loss decreased (inf --> 0.133846).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1048518
	speed: 0.1996s/iter; left time: 4387.7493s
	iters: 200, epoch: 2 | loss: 0.0917789
	speed: 0.1171s/iter; left time: 2560.8687s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.1056649 Vali Loss: 0.1390647 Test Loss: 0.1558741
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0811353
	speed: 0.1916s/iter; left time: 4168.5512s
	iters: 200, epoch: 3 | loss: 0.0740620
	speed: 0.1170s/iter; left time: 2534.6429s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0792181 Vali Loss: 0.1356649 Test Loss: 0.1499200
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0676399
	speed: 0.1920s/iter; left time: 4133.2791s
	iters: 200, epoch: 4 | loss: 0.0622984
	speed: 0.1169s/iter; left time: 2506.1797s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0657749 Vali Loss: 0.1355707 Test Loss: 0.1537291
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0562074
	speed: 0.1918s/iter; left time: 4086.2046s
	iters: 200, epoch: 5 | loss: 0.0543710
	speed: 0.1170s/iter; left time: 2482.3806s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:26.30s
Steps: 223 | Train Loss: 0.0571749 Vali Loss: 0.1332155 Test Loss: 0.1460087
Validation loss decreased (0.133846 --> 0.133215).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0486048
	speed: 0.2007s/iter; left time: 4232.6466s
	iters: 200, epoch: 6 | loss: 0.0462921
	speed: 0.1170s/iter; left time: 2454.3776s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.33s
Steps: 223 | Train Loss: 0.0504946 Vali Loss: 0.1317422 Test Loss: 0.1442406
Validation loss decreased (0.133215 --> 0.131742).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0479924
	speed: 0.1979s/iter; left time: 4129.0110s
	iters: 200, epoch: 7 | loss: 0.0442015
	speed: 0.1169s/iter; left time: 2427.7173s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0459121 Vali Loss: 0.1309992 Test Loss: 0.1428496
Validation loss decreased (0.131742 --> 0.130999).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0496622
	speed: 0.2050s/iter; left time: 4230.6687s
	iters: 200, epoch: 8 | loss: 0.0430491
	speed: 0.1170s/iter; left time: 2402.9106s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0439734 Vali Loss: 0.1313564 Test Loss: 0.1427028
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0437206
	speed: 0.1918s/iter; left time: 3915.0238s
	iters: 200, epoch: 9 | loss: 0.0392708
	speed: 0.1171s/iter; left time: 2379.0002s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0411550 Vali Loss: 0.1308634 Test Loss: 0.1417311
Validation loss decreased (0.130999 --> 0.130863).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0364934
	speed: 0.2023s/iter; left time: 4085.3839s
	iters: 200, epoch: 10 | loss: 0.0397321
	speed: 0.1171s/iter; left time: 2352.2382s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0395649 Vali Loss: 0.1306815 Test Loss: 0.1424750
Validation loss decreased (0.130863 --> 0.130681).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0363469
	speed: 0.1982s/iter; left time: 3958.2434s
	iters: 200, epoch: 11 | loss: 0.0377914
	speed: 0.1169s/iter; left time: 2323.4507s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0380682 Vali Loss: 0.1303222 Test Loss: 0.1420896
Validation loss decreased (0.130681 --> 0.130322).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0352490
	speed: 0.1998s/iter; left time: 3946.4918s
	iters: 200, epoch: 12 | loss: 0.0367432
	speed: 0.1170s/iter; left time: 2297.9532s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0363727 Vali Loss: 0.1300572 Test Loss: 0.1409103
Validation loss decreased (0.130322 --> 0.130057).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0346726
	speed: 0.1981s/iter; left time: 3866.9831s
	iters: 200, epoch: 13 | loss: 0.0387667
	speed: 0.1170s/iter; left time: 2272.4953s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0362056 Vali Loss: 0.1299351 Test Loss: 0.1409579
Validation loss decreased (0.130057 --> 0.129935).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0338219
	speed: 0.1994s/iter; left time: 3849.7412s
	iters: 200, epoch: 14 | loss: 0.0339704
	speed: 0.1170s/iter; left time: 2247.4400s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0348341 Vali Loss: 0.1300103 Test Loss: 0.1415872
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0342423
	speed: 0.1919s/iter; left time: 3661.6247s
	iters: 200, epoch: 15 | loss: 0.0326140
	speed: 0.1170s/iter; left time: 2221.0064s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0338825 Vali Loss: 0.1300498 Test Loss: 0.1417184
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0320650
	speed: 0.1919s/iter; left time: 3619.0332s
	iters: 200, epoch: 16 | loss: 0.0337393
	speed: 0.1171s/iter; left time: 2196.7565s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0331472 Vali Loss: 0.1296469 Test Loss: 0.1409243
Validation loss decreased (0.129935 --> 0.129647).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0332346
	speed: 0.2018s/iter; left time: 3760.5662s
	iters: 200, epoch: 17 | loss: 0.0329086
	speed: 0.1171s/iter; left time: 2169.9251s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:26.33s
Steps: 223 | Train Loss: 0.0327700 Vali Loss: 0.1293281 Test Loss: 0.1415955
Validation loss decreased (0.129647 --> 0.129328).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0318580
	speed: 0.2005s/iter; left time: 3690.9040s
	iters: 200, epoch: 18 | loss: 0.0322147
	speed: 0.1170s/iter; left time: 2141.6085s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0321012 Vali Loss: 0.1295939 Test Loss: 0.1408955
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0334742
	speed: 0.1915s/iter; left time: 3483.5956s
	iters: 200, epoch: 19 | loss: 0.0314395
	speed: 0.1169s/iter; left time: 2115.2596s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0318530 Vali Loss: 0.1296194 Test Loss: 0.1405804
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0314384
	speed: 0.1907s/iter; left time: 3426.5233s
	iters: 200, epoch: 20 | loss: 0.0330955
	speed: 0.1171s/iter; left time: 2092.3260s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0314030 Vali Loss: 0.1294407 Test Loss: 0.1412431
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0305864
	speed: 0.1922s/iter; left time: 3410.2000s
	iters: 200, epoch: 21 | loss: 0.0316548
	speed: 0.1170s/iter; left time: 2064.2054s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:26.30s
Steps: 223 | Train Loss: 0.0311420 Vali Loss: 0.1290952 Test Loss: 0.1409870
Validation loss decreased (0.129328 --> 0.129095).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0302365
	speed: 0.1995s/iter; left time: 3494.6990s
	iters: 200, epoch: 22 | loss: 0.0304590
	speed: 0.1169s/iter; left time: 2035.5256s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0306210 Vali Loss: 0.1292551 Test Loss: 0.1412280
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0299850
	speed: 0.1903s/iter; left time: 3291.6147s
	iters: 200, epoch: 23 | loss: 0.0302024
	speed: 0.1168s/iter; left time: 2009.1890s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:26.23s
Steps: 223 | Train Loss: 0.0302456 Vali Loss: 0.1290937 Test Loss: 0.1409839
Validation loss decreased (0.129095 --> 0.129094).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0303322
	speed: 0.2023s/iter; left time: 3453.8747s
	iters: 200, epoch: 24 | loss: 0.0323132
	speed: 0.1169s/iter; left time: 1984.6812s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0299410 Vali Loss: 0.1291528 Test Loss: 0.1410292
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0289265
	speed: 0.1914s/iter; left time: 3225.2285s
	iters: 200, epoch: 25 | loss: 0.0290138
	speed: 0.1170s/iter; left time: 1958.8100s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0298381 Vali Loss: 0.1292860 Test Loss: 0.1413039
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0293423
	speed: 0.1912s/iter; left time: 3178.2837s
	iters: 200, epoch: 26 | loss: 0.0288278
	speed: 0.1170s/iter; left time: 1932.8745s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0295350 Vali Loss: 0.1295010 Test Loss: 0.1412846
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0309911
	speed: 0.1904s/iter; left time: 3122.8553s
	iters: 200, epoch: 27 | loss: 0.0286059
	speed: 0.1170s/iter; left time: 1907.7546s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0295832 Vali Loss: 0.1290496 Test Loss: 0.1409436
Validation loss decreased (0.129094 --> 0.129050).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0301412
	speed: 0.2075s/iter; left time: 3357.2566s
	iters: 200, epoch: 28 | loss: 0.0283205
	speed: 0.1171s/iter; left time: 1882.3099s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0292435 Vali Loss: 0.1290750 Test Loss: 0.1410658
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0296284
	speed: 0.1911s/iter; left time: 3048.9499s
	iters: 200, epoch: 29 | loss: 0.0286823
	speed: 0.1172s/iter; left time: 1857.9582s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:26.30s
Steps: 223 | Train Loss: 0.0290475 Vali Loss: 0.1291477 Test Loss: 0.1413629
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0291360
	speed: 0.1917s/iter; left time: 3015.6167s
	iters: 200, epoch: 30 | loss: 0.0290582
	speed: 0.1171s/iter; left time: 1831.2570s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:26.33s
Steps: 223 | Train Loss: 0.0289179 Vali Loss: 0.1293034 Test Loss: 0.1410805
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0292971
	speed: 0.1907s/iter; left time: 2958.2299s
	iters: 200, epoch: 31 | loss: 0.0286676
	speed: 0.1171s/iter; left time: 1803.9426s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0287791 Vali Loss: 0.1291960 Test Loss: 0.1409972
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0290142
	speed: 0.1906s/iter; left time: 2913.2191s
	iters: 200, epoch: 32 | loss: 0.0287768
	speed: 0.1170s/iter; left time: 1776.7443s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0286813 Vali Loss: 0.1290937 Test Loss: 0.1410803
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0290197
	speed: 0.1909s/iter; left time: 2875.7027s
	iters: 200, epoch: 33 | loss: 0.0297447
	speed: 0.1170s/iter; left time: 1750.8625s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0285680 Vali Loss: 0.1290340 Test Loss: 0.1406220
Validation loss decreased (0.129050 --> 0.129034).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0290092
	speed: 0.1990s/iter; left time: 2953.8605s
	iters: 200, epoch: 34 | loss: 0.0274093
	speed: 0.1170s/iter; left time: 1724.1649s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0284409 Vali Loss: 0.1291619 Test Loss: 0.1410851
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0280505
	speed: 0.1925s/iter; left time: 2813.8719s
	iters: 200, epoch: 35 | loss: 0.0290129
	speed: 0.1170s/iter; left time: 1699.0993s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:26.35s
Steps: 223 | Train Loss: 0.0284191 Vali Loss: 0.1290827 Test Loss: 0.1410841
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0280916
	speed: 0.1916s/iter; left time: 2758.3983s
	iters: 200, epoch: 36 | loss: 0.0282499
	speed: 0.1171s/iter; left time: 1673.4313s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0284358 Vali Loss: 0.1289055 Test Loss: 0.1406983
Validation loss decreased (0.129034 --> 0.128905).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0286913
	speed: 0.1983s/iter; left time: 2810.8702s
	iters: 200, epoch: 37 | loss: 0.0281303
	speed: 0.1170s/iter; left time: 1646.9993s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0282896 Vali Loss: 0.1289858 Test Loss: 0.1409457
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0275336
	speed: 0.1913s/iter; left time: 2669.2192s
	iters: 200, epoch: 38 | loss: 0.0282862
	speed: 0.1171s/iter; left time: 1621.7281s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0281750 Vali Loss: 0.1290008 Test Loss: 0.1410223
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0291343
	speed: 0.1912s/iter; left time: 2624.6006s
	iters: 200, epoch: 39 | loss: 0.0281639
	speed: 0.1170s/iter; left time: 1594.9437s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0280979 Vali Loss: 0.1289591 Test Loss: 0.1407019
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0274045
	speed: 0.1917s/iter; left time: 2588.3533s
	iters: 200, epoch: 40 | loss: 0.0278367
	speed: 0.1171s/iter; left time: 1569.5256s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0280322 Vali Loss: 0.1288711 Test Loss: 0.1408064
Validation loss decreased (0.128905 --> 0.128871).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0272471
	speed: 0.1982s/iter; left time: 2632.7206s
	iters: 200, epoch: 41 | loss: 0.0277230
	speed: 0.1170s/iter; left time: 1541.8379s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0280583 Vali Loss: 0.1291680 Test Loss: 0.1410560
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0280742
	speed: 0.1909s/iter; left time: 2492.8435s
	iters: 200, epoch: 42 | loss: 0.0283227
	speed: 0.1170s/iter; left time: 1516.5317s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0279669 Vali Loss: 0.1290713 Test Loss: 0.1410219
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0272742
	speed: 0.1912s/iter; left time: 2454.3260s
	iters: 200, epoch: 43 | loss: 0.0282322
	speed: 0.1170s/iter; left time: 1489.9648s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0279167 Vali Loss: 0.1289234 Test Loss: 0.1407277
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0269077
	speed: 0.1911s/iter; left time: 2410.6279s
	iters: 200, epoch: 44 | loss: 0.0263353
	speed: 0.1170s/iter; left time: 1463.2873s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0278599 Vali Loss: 0.1290306 Test Loss: 0.1408691
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0266038
	speed: 0.1911s/iter; left time: 2367.8694s
	iters: 200, epoch: 45 | loss: 0.0272216
	speed: 0.1169s/iter; left time: 1436.6521s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0278708 Vali Loss: 0.1290945 Test Loss: 0.1411061
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0272674
	speed: 0.1903s/iter; left time: 2314.9862s
	iters: 200, epoch: 46 | loss: 0.0270879
	speed: 0.1169s/iter; left time: 1411.0914s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0279628 Vali Loss: 0.1289861 Test Loss: 0.1409313
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0277215
	speed: 0.1916s/iter; left time: 2288.0508s
	iters: 200, epoch: 47 | loss: 0.0273832
	speed: 0.1169s/iter; left time: 1384.7583s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0278877 Vali Loss: 0.1292935 Test Loss: 0.1411907
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0274272
	speed: 0.1911s/iter; left time: 2239.2059s
	iters: 200, epoch: 48 | loss: 0.0283858
	speed: 0.1169s/iter; left time: 1358.3738s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0277513 Vali Loss: 0.1289520 Test Loss: 0.1408062
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0274827
	speed: 0.1916s/iter; left time: 2203.2613s
	iters: 200, epoch: 49 | loss: 0.0274828
	speed: 0.1171s/iter; left time: 1334.0522s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0277123 Vali Loss: 0.1290283 Test Loss: 0.1409316
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0268127
	speed: 0.1918s/iter; left time: 2162.2259s
	iters: 200, epoch: 50 | loss: 0.0269176
	speed: 0.1169s/iter; left time: 1306.2381s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0276684 Vali Loss: 0.1289308 Test Loss: 0.1408145
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04183303937315941, rmse:0.20453126728534698, mae:0.14080646634101868, rse:0.7244662046432495
Intermediate time for DE and pred_len 168: 00h:47m:24.10sIntermediate time for DE: 01h:48m:37.07s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0996474
	speed: 0.1323s/iter; left time: 2951.1036s
	iters: 200, epoch: 1 | loss: 0.0885067
	speed: 0.1121s/iter; left time: 2488.7118s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.46s
Steps: 224 | Train Loss: 0.1080878 Vali Loss: 0.1031007 Test Loss: 0.1151716
Validation loss decreased (inf --> 0.103101).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0845637
	speed: 0.1893s/iter; left time: 4179.9270s
	iters: 200, epoch: 2 | loss: 0.0811433
	speed: 0.1126s/iter; left time: 2475.1525s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.42s
Steps: 224 | Train Loss: 0.0857139 Vali Loss: 0.0979866 Test Loss: 0.1119893
Validation loss decreased (0.103101 --> 0.097987).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0742779
	speed: 0.1899s/iter; left time: 4150.1560s
	iters: 200, epoch: 3 | loss: 0.0767512
	speed: 0.1128s/iter; left time: 2453.0265s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.43s
Steps: 224 | Train Loss: 0.0785473 Vali Loss: 0.1039718 Test Loss: 0.1164266
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0714062
	speed: 0.1840s/iter; left time: 3979.9965s
	iters: 200, epoch: 4 | loss: 0.0674478
	speed: 0.1128s/iter; left time: 2427.6149s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.37s
Steps: 224 | Train Loss: 0.0706126 Vali Loss: 0.1086608 Test Loss: 0.1172597
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0628561
	speed: 0.1846s/iter; left time: 3951.9464s
	iters: 200, epoch: 5 | loss: 0.0638449
	speed: 0.1129s/iter; left time: 2406.0098s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.45s
Steps: 224 | Train Loss: 0.0620327 Vali Loss: 0.1105718 Test Loss: 0.1197981
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0537707
	speed: 0.1843s/iter; left time: 3903.2296s
	iters: 200, epoch: 6 | loss: 0.0541462
	speed: 0.1128s/iter; left time: 2377.1166s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:25.37s
Steps: 224 | Train Loss: 0.0554664 Vali Loss: 0.1122719 Test Loss: 0.1199083
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0506876
	speed: 0.1840s/iter; left time: 3855.5211s
	iters: 200, epoch: 7 | loss: 0.0502909
	speed: 0.1127s/iter; left time: 2350.0224s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.37s
Steps: 224 | Train Loss: 0.0506868 Vali Loss: 0.1121729 Test Loss: 0.1219515
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0463618
	speed: 0.1852s/iter; left time: 3838.8842s
	iters: 200, epoch: 8 | loss: 0.0486447
	speed: 0.1127s/iter; left time: 2326.1387s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.41s
Steps: 224 | Train Loss: 0.0470564 Vali Loss: 0.1114214 Test Loss: 0.1209129
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0440129
	speed: 0.1842s/iter; left time: 3778.5540s
	iters: 200, epoch: 9 | loss: 0.0429198
	speed: 0.1128s/iter; left time: 2302.7119s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.38s
Steps: 224 | Train Loss: 0.0440249 Vali Loss: 0.1098484 Test Loss: 0.1208263
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0407308
	speed: 0.1863s/iter; left time: 3778.4384s
	iters: 200, epoch: 10 | loss: 0.0430059
	speed: 0.1128s/iter; left time: 2276.6502s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.51s
Steps: 224 | Train Loss: 0.0415755 Vali Loss: 0.1087849 Test Loss: 0.1201738
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0395910
	speed: 0.1857s/iter; left time: 3725.2145s
	iters: 200, epoch: 11 | loss: 0.0412112
	speed: 0.1128s/iter; left time: 2251.8183s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.40s
Steps: 224 | Train Loss: 0.0398932 Vali Loss: 0.1080372 Test Loss: 0.1204233
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0387737
	speed: 0.1864s/iter; left time: 3697.0581s
	iters: 200, epoch: 12 | loss: 0.0353130
	speed: 0.1128s/iter; left time: 2225.7463s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:25.47s
Steps: 224 | Train Loss: 0.0380123 Vali Loss: 0.1082294 Test Loss: 0.1207427
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.028945984318852425, rmse:0.17013520002365112, mae:0.11198926717042923, rse:0.5869181752204895
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1038223
	speed: 0.1139s/iter; left time: 2540.4770s
	iters: 200, epoch: 1 | loss: 0.0939093
	speed: 0.1127s/iter; left time: 2502.0733s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.40s
Steps: 224 | Train Loss: 0.1088107 Vali Loss: 0.1033104 Test Loss: 0.1157897
Validation loss decreased (inf --> 0.103310).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0781031
	speed: 0.1902s/iter; left time: 4200.0938s
	iters: 200, epoch: 2 | loss: 0.0780346
	speed: 0.1127s/iter; left time: 2476.2127s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.41s
Steps: 224 | Train Loss: 0.0856511 Vali Loss: 0.0977164 Test Loss: 0.1109629
Validation loss decreased (0.103310 --> 0.097716).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0757042
	speed: 0.1914s/iter; left time: 4181.9349s
	iters: 200, epoch: 3 | loss: 0.0781804
	speed: 0.1127s/iter; left time: 2451.9073s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.44s
Steps: 224 | Train Loss: 0.0786595 Vali Loss: 0.0986926 Test Loss: 0.1099743
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0722331
	speed: 0.1871s/iter; left time: 4046.0732s
	iters: 200, epoch: 4 | loss: 0.0727600
	speed: 0.1128s/iter; left time: 2428.7613s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.43s
Steps: 224 | Train Loss: 0.0718734 Vali Loss: 0.1056999 Test Loss: 0.1182914
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0644002
	speed: 0.1853s/iter; left time: 3965.9279s
	iters: 200, epoch: 5 | loss: 0.0597832
	speed: 0.1128s/iter; left time: 2403.0647s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.40s
Steps: 224 | Train Loss: 0.0631952 Vali Loss: 0.1108619 Test Loss: 0.1202724
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0536502
	speed: 0.1847s/iter; left time: 3911.2462s
	iters: 200, epoch: 6 | loss: 0.0540099
	speed: 0.1127s/iter; left time: 2374.8984s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:25.39s
Steps: 224 | Train Loss: 0.0562072 Vali Loss: 0.1099740 Test Loss: 0.1225244
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0556885
	speed: 0.1848s/iter; left time: 3873.7578s
	iters: 200, epoch: 7 | loss: 0.0481438
	speed: 0.1126s/iter; left time: 2349.3633s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.37s
Steps: 224 | Train Loss: 0.0510341 Vali Loss: 0.1112476 Test Loss: 0.1218242
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0476165
	speed: 0.1844s/iter; left time: 3823.2790s
	iters: 200, epoch: 8 | loss: 0.0471848
	speed: 0.1126s/iter; left time: 2323.6058s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.37s
Steps: 224 | Train Loss: 0.0474234 Vali Loss: 0.1105226 Test Loss: 0.1213627
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0440495
	speed: 0.1844s/iter; left time: 3782.6626s
	iters: 200, epoch: 9 | loss: 0.0436973
	speed: 0.1127s/iter; left time: 2299.6664s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.38s
Steps: 224 | Train Loss: 0.0441579 Vali Loss: 0.1079858 Test Loss: 0.1214518
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0423448
	speed: 0.1846s/iter; left time: 3745.1403s
	iters: 200, epoch: 10 | loss: 0.0415402
	speed: 0.1125s/iter; left time: 2271.7529s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.34s
Steps: 224 | Train Loss: 0.0418186 Vali Loss: 0.1086789 Test Loss: 0.1216368
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0392826
	speed: 0.1846s/iter; left time: 3703.2593s
	iters: 200, epoch: 11 | loss: 0.0391347
	speed: 0.1126s/iter; left time: 2248.0058s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.39s
Steps: 224 | Train Loss: 0.0398686 Vali Loss: 0.1080947 Test Loss: 0.1218725
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0370686
	speed: 0.1849s/iter; left time: 3667.8158s
	iters: 200, epoch: 12 | loss: 0.0377204
	speed: 0.1126s/iter; left time: 2222.3660s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:25.39s
Steps: 224 | Train Loss: 0.0382783 Vali Loss: 0.1067556 Test Loss: 0.1222031
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02829352393746376, rmse:0.16820679605007172, mae:0.1109628975391388, rse:0.5802657604217529
Intermediate time for GB and pred_len 24: 00h:12m:10.14s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1214345
	speed: 0.1343s/iter; left time: 2994.3444s
	iters: 200, epoch: 1 | loss: 0.1109005
	speed: 0.1142s/iter; left time: 2535.2057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.91s
Steps: 224 | Train Loss: 0.1222321 Vali Loss: 0.1246036 Test Loss: 0.1466960
Validation loss decreased (inf --> 0.124604).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1039825
	speed: 0.1926s/iter; left time: 4251.1491s
	iters: 200, epoch: 2 | loss: 0.0927135
	speed: 0.1143s/iter; left time: 2511.2068s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.74s
Steps: 224 | Train Loss: 0.1059589 Vali Loss: 0.1314324 Test Loss: 0.1477521
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0807762
	speed: 0.1864s/iter; left time: 4072.4866s
	iters: 200, epoch: 3 | loss: 0.0739932
	speed: 0.1142s/iter; left time: 2484.3672s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.68s
Steps: 224 | Train Loss: 0.0830423 Vali Loss: 0.1441195 Test Loss: 0.1524977
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0687685
	speed: 0.1875s/iter; left time: 4056.0346s
	iters: 200, epoch: 4 | loss: 0.0650203
	speed: 0.1142s/iter; left time: 2459.1629s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.70s
Steps: 224 | Train Loss: 0.0678950 Vali Loss: 0.1423673 Test Loss: 0.1549263
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0607354
	speed: 0.1867s/iter; left time: 3996.5056s
	iters: 200, epoch: 5 | loss: 0.0557042
	speed: 0.1143s/iter; left time: 2435.4722s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.72s
Steps: 224 | Train Loss: 0.0591521 Vali Loss: 0.1403450 Test Loss: 0.1569088
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0532675
	speed: 0.1871s/iter; left time: 3963.3296s
	iters: 200, epoch: 6 | loss: 0.0502299
	speed: 0.1144s/iter; left time: 2411.2761s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:25.77s
Steps: 224 | Train Loss: 0.0533821 Vali Loss: 0.1420407 Test Loss: 0.1549798
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0497055
	speed: 0.1900s/iter; left time: 3981.7444s
	iters: 200, epoch: 7 | loss: 0.0482795
	speed: 0.1145s/iter; left time: 2388.5310s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.89s
Steps: 224 | Train Loss: 0.0487758 Vali Loss: 0.1400132 Test Loss: 0.1522583
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0436128
	speed: 0.1878s/iter; left time: 3894.6050s
	iters: 200, epoch: 8 | loss: 0.0445100
	speed: 0.1144s/iter; left time: 2360.1013s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.72s
Steps: 224 | Train Loss: 0.0452689 Vali Loss: 0.1362888 Test Loss: 0.1527812
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0423614
	speed: 0.1871s/iter; left time: 3837.2617s
	iters: 200, epoch: 9 | loss: 0.0413284
	speed: 0.1145s/iter; left time: 2336.5363s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.80s
Steps: 224 | Train Loss: 0.0427765 Vali Loss: 0.1350611 Test Loss: 0.1524318
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0408506
	speed: 0.1884s/iter; left time: 3821.7562s
	iters: 200, epoch: 10 | loss: 0.0402587
	speed: 0.1147s/iter; left time: 2315.6567s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.90s
Steps: 224 | Train Loss: 0.0406760 Vali Loss: 0.1352997 Test Loss: 0.1525808
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0382222
	speed: 0.1883s/iter; left time: 3777.6870s
	iters: 200, epoch: 11 | loss: 0.0384334
	speed: 0.1148s/iter; left time: 2291.3193s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.0388696 Vali Loss: 0.1333321 Test Loss: 0.1523354
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.044652123004198074, rmse:0.2113104909658432, mae:0.1466960459947586, rse:0.7307411432266235
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1185203
	speed: 0.1158s/iter; left time: 2583.3776s
	iters: 200, epoch: 1 | loss: 0.1122112
	speed: 0.1144s/iter; left time: 2539.1118s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.81s
Steps: 224 | Train Loss: 0.1220173 Vali Loss: 0.1247150 Test Loss: 0.1465789
Validation loss decreased (inf --> 0.124715).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1064523
	speed: 0.1978s/iter; left time: 4366.6942s
	iters: 200, epoch: 2 | loss: 0.0905334
	speed: 0.1145s/iter; left time: 2515.2769s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.1043579 Vali Loss: 0.1307942 Test Loss: 0.1532457
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0794482
	speed: 0.1887s/iter; left time: 4124.1550s
	iters: 200, epoch: 3 | loss: 0.0721256
	speed: 0.1146s/iter; left time: 2493.2041s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.82s
Steps: 224 | Train Loss: 0.0795467 Vali Loss: 0.1351968 Test Loss: 0.1627516
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0648567
	speed: 0.1883s/iter; left time: 4073.2990s
	iters: 200, epoch: 4 | loss: 0.0618430
	speed: 0.1146s/iter; left time: 2466.4602s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.81s
Steps: 224 | Train Loss: 0.0656789 Vali Loss: 0.1326059 Test Loss: 0.1552809
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0569754
	speed: 0.1888s/iter; left time: 4040.6479s
	iters: 200, epoch: 5 | loss: 0.0554169
	speed: 0.1148s/iter; left time: 2445.1940s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.0567060 Vali Loss: 0.1299331 Test Loss: 0.1558344
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0532668
	speed: 0.1883s/iter; left time: 3987.9809s
	iters: 200, epoch: 6 | loss: 0.0473617
	speed: 0.1147s/iter; left time: 2417.2902s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:25.83s
Steps: 224 | Train Loss: 0.0504539 Vali Loss: 0.1304709 Test Loss: 0.1563821
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0475080
	speed: 0.1884s/iter; left time: 3948.3872s
	iters: 200, epoch: 7 | loss: 0.0447909
	speed: 0.1148s/iter; left time: 2393.6038s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.86s
Steps: 224 | Train Loss: 0.0462936 Vali Loss: 0.1285875 Test Loss: 0.1546221
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0433644
	speed: 0.1894s/iter; left time: 3927.0456s
	iters: 200, epoch: 8 | loss: 0.0436983
	speed: 0.1147s/iter; left time: 2367.3665s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.95s
Steps: 224 | Train Loss: 0.0436898 Vali Loss: 0.1298740 Test Loss: 0.1545593
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0418442
	speed: 0.1891s/iter; left time: 3879.0679s
	iters: 200, epoch: 9 | loss: 0.0387380
	speed: 0.1147s/iter; left time: 2341.8554s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:25.90s
Steps: 224 | Train Loss: 0.0416659 Vali Loss: 0.1272144 Test Loss: 0.1538585
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0390729
	speed: 0.1891s/iter; left time: 3835.9297s
	iters: 200, epoch: 10 | loss: 0.0392295
	speed: 0.1146s/iter; left time: 2313.7347s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:25.88s
Steps: 224 | Train Loss: 0.0398399 Vali Loss: 0.1276970 Test Loss: 0.1537576
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0407491
	speed: 0.1897s/iter; left time: 3805.4462s
	iters: 200, epoch: 11 | loss: 0.0371504
	speed: 0.1149s/iter; left time: 2293.5895s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:25.95s
Steps: 224 | Train Loss: 0.0383269 Vali Loss: 0.1275315 Test Loss: 0.1543522
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04468880221247673, rmse:0.21139726042747498, mae:0.1465788334608078, rse:0.7310411930084229
Intermediate time for GB and pred_len 96: 00h:11m:22.09s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1213006
	speed: 0.1362s/iter; left time: 3023.2200s
	iters: 200, epoch: 1 | loss: 0.1139537
	speed: 0.1163s/iter; left time: 2569.8088s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.1252113 Vali Loss: 0.1282271 Test Loss: 0.1520274
Validation loss decreased (inf --> 0.128227).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1075744
	speed: 0.1985s/iter; left time: 4362.5667s
	iters: 200, epoch: 2 | loss: 0.0992019
	speed: 0.1165s/iter; left time: 2549.8108s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:26.22s
Steps: 223 | Train Loss: 0.1077617 Vali Loss: 0.1340815 Test Loss: 0.1555199
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0825657
	speed: 0.1900s/iter; left time: 4133.8577s
	iters: 200, epoch: 3 | loss: 0.0742178
	speed: 0.1170s/iter; left time: 2532.7994s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:26.22s
Steps: 223 | Train Loss: 0.0811356 Vali Loss: 0.1394288 Test Loss: 0.1591612
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0661609
	speed: 0.1905s/iter; left time: 4101.8730s
	iters: 200, epoch: 4 | loss: 0.0621787
	speed: 0.1171s/iter; left time: 2509.1792s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0661998 Vali Loss: 0.1389509 Test Loss: 0.1624240
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0548375
	speed: 0.1908s/iter; left time: 4065.0556s
	iters: 200, epoch: 5 | loss: 0.0543805
	speed: 0.1171s/iter; left time: 2483.4459s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0570664 Vali Loss: 0.1399919 Test Loss: 0.1613696
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0494762
	speed: 0.1904s/iter; left time: 4015.0451s
	iters: 200, epoch: 6 | loss: 0.0493287
	speed: 0.1171s/iter; left time: 2458.3887s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0513288 Vali Loss: 0.1331794 Test Loss: 0.1609289
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0475152
	speed: 0.1916s/iter; left time: 3996.6039s
	iters: 200, epoch: 7 | loss: 0.0470923
	speed: 0.1171s/iter; left time: 2432.3123s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0469865 Vali Loss: 0.1329572 Test Loss: 0.1585834
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0418320
	speed: 0.1903s/iter; left time: 3928.1841s
	iters: 200, epoch: 8 | loss: 0.0427166
	speed: 0.1172s/iter; left time: 2406.5584s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0448766 Vali Loss: 0.1340279 Test Loss: 0.1586640
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0438957
	speed: 0.1899s/iter; left time: 3877.0170s
	iters: 200, epoch: 9 | loss: 0.0416118
	speed: 0.1173s/iter; left time: 2382.2040s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0429007 Vali Loss: 0.1330776 Test Loss: 0.1580974
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0416665
	speed: 0.1907s/iter; left time: 3850.9587s
	iters: 200, epoch: 10 | loss: 0.0383650
	speed: 0.1172s/iter; left time: 2355.4869s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:26.28s
Steps: 223 | Train Loss: 0.0404986 Vali Loss: 0.1329710 Test Loss: 0.1571328
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0392364
	speed: 0.1892s/iter; left time: 3778.0406s
	iters: 200, epoch: 11 | loss: 0.0397092
	speed: 0.1173s/iter; left time: 2330.2707s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:26.27s
Steps: 223 | Train Loss: 0.0391700 Vali Loss: 0.1330590 Test Loss: 0.1586824
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04713153839111328, rmse:0.21709799766540527, mae:0.15202735364437103, rse:0.7527099251747131
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1249676
	speed: 0.1220s/iter; left time: 2709.4750s
	iters: 200, epoch: 1 | loss: 0.1191898
	speed: 0.1171s/iter; left time: 2587.9965s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:26.66s
Steps: 223 | Train Loss: 0.1251245 Vali Loss: 0.1285412 Test Loss: 0.1520619
Validation loss decreased (inf --> 0.128541).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1072930
	speed: 0.2036s/iter; left time: 4474.8406s
	iters: 200, epoch: 2 | loss: 0.0972473
	speed: 0.1171s/iter; left time: 2561.7086s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:26.35s
Steps: 223 | Train Loss: 0.1063078 Vali Loss: 0.1371799 Test Loss: 0.1572057
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804210
	speed: 0.1922s/iter; left time: 4181.6213s
	iters: 200, epoch: 3 | loss: 0.0721306
	speed: 0.1171s/iter; left time: 2536.1314s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:26.33s
Steps: 223 | Train Loss: 0.0794166 Vali Loss: 0.1401581 Test Loss: 0.1566686
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0653253
	speed: 0.1931s/iter; left time: 4157.0411s
	iters: 200, epoch: 4 | loss: 0.0629462
	speed: 0.1172s/iter; left time: 2510.8759s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:26.34s
Steps: 223 | Train Loss: 0.0659725 Vali Loss: 0.1434046 Test Loss: 0.1587328
EarlyStopping counter: 3 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0574204
	speed: 0.1916s/iter; left time: 4083.4303s
	iters: 200, epoch: 5 | loss: 0.0536511
	speed: 0.1172s/iter; left time: 2486.4843s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:26.32s
Steps: 223 | Train Loss: 0.0571032 Vali Loss: 0.1366622 Test Loss: 0.1577192
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0508827
	speed: 0.1919s/iter; left time: 4046.3372s
	iters: 200, epoch: 6 | loss: 0.0494704
	speed: 0.1172s/iter; left time: 2458.6464s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.30s
Steps: 223 | Train Loss: 0.0507726 Vali Loss: 0.1342619 Test Loss: 0.1572464
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0472662
	speed: 0.1920s/iter; left time: 4004.9215s
	iters: 200, epoch: 7 | loss: 0.0473239
	speed: 0.1171s/iter; left time: 2431.7803s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:26.31s
Steps: 223 | Train Loss: 0.0472498 Vali Loss: 0.1346726 Test Loss: 0.1563109
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0446389
	speed: 0.1916s/iter; left time: 3955.6359s
	iters: 200, epoch: 8 | loss: 0.0445184
	speed: 0.1171s/iter; left time: 2404.7962s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:26.29s
Steps: 223 | Train Loss: 0.0437907 Vali Loss: 0.1372551 Test Loss: 0.1582832
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0415325
	speed: 0.1912s/iter; left time: 3903.5763s
	iters: 200, epoch: 9 | loss: 0.0411061
	speed: 0.1171s/iter; left time: 2378.9250s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:26.26s
Steps: 223 | Train Loss: 0.0421845 Vali Loss: 0.1376449 Test Loss: 0.1585127
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0384176
	speed: 0.1913s/iter; left time: 3863.9872s
	iters: 200, epoch: 10 | loss: 0.0389975
	speed: 0.1170s/iter; left time: 2350.6687s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:26.25s
Steps: 223 | Train Loss: 0.0403059 Vali Loss: 0.1350223 Test Loss: 0.1571528
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0383898
	speed: 0.1924s/iter; left time: 3843.1433s
	iters: 200, epoch: 11 | loss: 0.0382284
	speed: 0.1171s/iter; left time: 2327.1395s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:26.33s
Steps: 223 | Train Loss: 0.0384813 Vali Loss: 0.1328183 Test Loss: 0.1572170
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04727013409137726, rmse:0.21741695702075958, mae:0.15206195414066315, rse:0.7538158297538757
Intermediate time for GB and pred_len 168: 00h:11m:35.68sIntermediate time for GB: 00h:35m:07.91s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1088210
	speed: 0.0587s/iter; left time: 1308.6299s
	iters: 200, epoch: 1 | loss: 0.0963963
	speed: 0.0358s/iter; left time: 795.7953s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.1146473 Vali Loss: 0.0854801 Test Loss: 0.0979164
Validation loss decreased (inf --> 0.085480).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0685913
	speed: 0.0672s/iter; left time: 1482.5344s
	iters: 200, epoch: 2 | loss: 0.0686793
	speed: 0.0358s/iter; left time: 786.3541s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0717669 Vali Loss: 0.0658320 Test Loss: 0.0734401
Validation loss decreased (0.085480 --> 0.065832).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0632323
	speed: 0.0677s/iter; left time: 1479.3184s
	iters: 200, epoch: 3 | loss: 0.0623284
	speed: 0.0359s/iter; left time: 780.4932s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0640745 Vali Loss: 0.0626725 Test Loss: 0.0704889
Validation loss decreased (0.065832 --> 0.062673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615526
	speed: 0.0681s/iter; left time: 1473.5855s
	iters: 200, epoch: 4 | loss: 0.0645030
	speed: 0.0359s/iter; left time: 773.5214s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0618264 Vali Loss: 0.0631634 Test Loss: 0.0702970
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0620415
	speed: 0.0646s/iter; left time: 1382.6835s
	iters: 200, epoch: 5 | loss: 0.0574935
	speed: 0.0359s/iter; left time: 765.7594s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0597803 Vali Loss: 0.0608134 Test Loss: 0.0684814
Validation loss decreased (0.062673 --> 0.060813).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0582404
	speed: 0.0667s/iter; left time: 1412.0462s
	iters: 200, epoch: 6 | loss: 0.0576614
	speed: 0.0360s/iter; left time: 758.6413s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0577604 Vali Loss: 0.0605095 Test Loss: 0.0676368
Validation loss decreased (0.060813 --> 0.060509).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0545284
	speed: 0.0670s/iter; left time: 1403.2805s
	iters: 200, epoch: 7 | loss: 0.0548448
	speed: 0.0360s/iter; left time: 750.7082s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.0561516 Vali Loss: 0.0602401 Test Loss: 0.0681869
Validation loss decreased (0.060509 --> 0.060240).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0573284
	speed: 0.0674s/iter; left time: 1397.8279s
	iters: 200, epoch: 8 | loss: 0.0563518
	speed: 0.0361s/iter; left time: 745.2536s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.31s
Steps: 224 | Train Loss: 0.0543732 Vali Loss: 0.0602492 Test Loss: 0.0685865
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0528393
	speed: 0.0669s/iter; left time: 1371.7214s
	iters: 200, epoch: 9 | loss: 0.0504267
	speed: 0.0362s/iter; left time: 738.1212s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.42s
Steps: 224 | Train Loss: 0.0528005 Vali Loss: 0.0607081 Test Loss: 0.0681808
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0503138
	speed: 0.0660s/iter; left time: 1339.2611s
	iters: 200, epoch: 10 | loss: 0.0497333
	speed: 0.0360s/iter; left time: 726.9689s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0512173 Vali Loss: 0.0612565 Test Loss: 0.0693862
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0523711
	speed: 0.0651s/iter; left time: 1305.8432s
	iters: 200, epoch: 11 | loss: 0.0475909
	speed: 0.0360s/iter; left time: 717.7660s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0497977 Vali Loss: 0.0621678 Test Loss: 0.0701040
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0483036
	speed: 0.0660s/iter; left time: 1308.3619s
	iters: 200, epoch: 12 | loss: 0.0482843
	speed: 0.0360s/iter; left time: 710.5707s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.32s
Steps: 224 | Train Loss: 0.0484065 Vali Loss: 0.0611945 Test Loss: 0.0702203
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0465698
	speed: 0.0648s/iter; left time: 1270.9761s
	iters: 200, epoch: 13 | loss: 0.0466141
	speed: 0.0360s/iter; left time: 702.5747s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0471895 Vali Loss: 0.0616367 Test Loss: 0.0707505
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0464203
	speed: 0.0659s/iter; left time: 1278.5773s
	iters: 200, epoch: 14 | loss: 0.0461390
	speed: 0.0360s/iter; left time: 694.8475s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0459160 Vali Loss: 0.0617813 Test Loss: 0.0710437
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0442983
	speed: 0.0647s/iter; left time: 1240.8376s
	iters: 200, epoch: 15 | loss: 0.0437293
	speed: 0.0360s/iter; left time: 686.1631s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.22s
Steps: 224 | Train Loss: 0.0449073 Vali Loss: 0.0609372 Test Loss: 0.0705282
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0448585
	speed: 0.0653s/iter; left time: 1235.9252s
	iters: 200, epoch: 16 | loss: 0.0426422
	speed: 0.0360s/iter; left time: 678.4557s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0441182 Vali Loss: 0.0612480 Test Loss: 0.0712006
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0426409
	speed: 0.0647s/iter; left time: 1211.3396s
	iters: 200, epoch: 17 | loss: 0.0427846
	speed: 0.0360s/iter; left time: 670.8485s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0431469 Vali Loss: 0.0615707 Test Loss: 0.0713551
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011505546048283577, rmse:0.10726390779018402, mae:0.0681869238615036, rse:0.31566470861434937
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1066941
	speed: 0.0377s/iter; left time: 840.9328s
	iters: 200, epoch: 1 | loss: 0.0964661
	speed: 0.0360s/iter; left time: 798.3423s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.1132517 Vali Loss: 0.0858548 Test Loss: 0.0978245
Validation loss decreased (inf --> 0.085855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0682312
	speed: 0.0661s/iter; left time: 1460.1928s
	iters: 200, epoch: 2 | loss: 0.0663072
	speed: 0.0360s/iter; left time: 791.1601s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0718071 Vali Loss: 0.0642378 Test Loss: 0.0721341
Validation loss decreased (0.085855 --> 0.064238).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0636944
	speed: 0.0696s/iter; left time: 1520.9741s
	iters: 200, epoch: 3 | loss: 0.0638895
	speed: 0.0360s/iter; left time: 782.9214s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.59s
Steps: 224 | Train Loss: 0.0639633 Vali Loss: 0.0630266 Test Loss: 0.0709389
Validation loss decreased (0.064238 --> 0.063027).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0614183
	speed: 0.0672s/iter; left time: 1454.2549s
	iters: 200, epoch: 4 | loss: 0.0616766
	speed: 0.0360s/iter; left time: 775.2838s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0617239 Vali Loss: 0.0610861 Test Loss: 0.0694283
Validation loss decreased (0.063027 --> 0.061086).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0619293
	speed: 0.0664s/iter; left time: 1422.1978s
	iters: 200, epoch: 5 | loss: 0.0589632
	speed: 0.0360s/iter; left time: 766.8436s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0595165 Vali Loss: 0.0606603 Test Loss: 0.0695403
Validation loss decreased (0.061086 --> 0.060660).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0572887
	speed: 0.0684s/iter; left time: 1447.9291s
	iters: 200, epoch: 6 | loss: 0.0562919
	speed: 0.0360s/iter; left time: 758.3907s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0577082 Vali Loss: 0.0601579 Test Loss: 0.0679241
Validation loss decreased (0.060660 --> 0.060158).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0551631
	speed: 0.0666s/iter; left time: 1394.8381s
	iters: 200, epoch: 7 | loss: 0.0535807
	speed: 0.0360s/iter; left time: 750.9231s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0559452 Vali Loss: 0.0594939 Test Loss: 0.0677244
Validation loss decreased (0.060158 --> 0.059494).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0532103
	speed: 0.0666s/iter; left time: 1380.9205s
	iters: 200, epoch: 8 | loss: 0.0538197
	speed: 0.0360s/iter; left time: 742.0608s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0544118 Vali Loss: 0.0596248 Test Loss: 0.0683465
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0545968
	speed: 0.0647s/iter; left time: 1327.8773s
	iters: 200, epoch: 9 | loss: 0.0509293
	speed: 0.0361s/iter; left time: 736.6365s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0527727 Vali Loss: 0.0595725 Test Loss: 0.0681538
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0532143
	speed: 0.0646s/iter; left time: 1309.4420s
	iters: 200, epoch: 10 | loss: 0.0519799
	speed: 0.0359s/iter; left time: 725.3952s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0514341 Vali Loss: 0.0601142 Test Loss: 0.0688306
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0510013
	speed: 0.0645s/iter; left time: 1293.9745s
	iters: 200, epoch: 11 | loss: 0.0505944
	speed: 0.0361s/iter; left time: 720.4181s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0499152 Vali Loss: 0.0598926 Test Loss: 0.0687869
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0476057
	speed: 0.0649s/iter; left time: 1286.8901s
	iters: 200, epoch: 12 | loss: 0.0493300
	speed: 0.0360s/iter; left time: 710.5436s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0484903 Vali Loss: 0.0600029 Test Loss: 0.0693005
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0514970
	speed: 0.0657s/iter; left time: 1288.3930s
	iters: 200, epoch: 13 | loss: 0.0470514
	speed: 0.0361s/iter; left time: 704.7487s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.35s
Steps: 224 | Train Loss: 0.0473323 Vali Loss: 0.0595374 Test Loss: 0.0688765
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0453721
	speed: 0.0649s/iter; left time: 1257.5120s
	iters: 200, epoch: 14 | loss: 0.0445011
	speed: 0.0360s/iter; left time: 693.7687s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0462104 Vali Loss: 0.0604253 Test Loss: 0.0697221
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0447567
	speed: 0.0644s/iter; left time: 1234.6130s
	iters: 200, epoch: 15 | loss: 0.0442911
	speed: 0.0360s/iter; left time: 686.4982s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0451865 Vali Loss: 0.0606731 Test Loss: 0.0697236
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0449529
	speed: 0.0645s/iter; left time: 1220.9451s
	iters: 200, epoch: 16 | loss: 0.0443960
	speed: 0.0360s/iter; left time: 678.1104s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0442437 Vali Loss: 0.0617826 Test Loss: 0.0705581
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0423817
	speed: 0.0647s/iter; left time: 1210.7290s
	iters: 200, epoch: 17 | loss: 0.0433824
	speed: 0.0360s/iter; left time: 670.2022s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0434775 Vali Loss: 0.0606505 Test Loss: 0.0697082
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011477137915790081, rmse:0.10713140666484833, mae:0.06772443652153015, rse:0.31527477502822876
Intermediate time for ES and pred_len 24: 00h:05m:57.13s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1164807
	speed: 0.0590s/iter; left time: 1316.6506s
	iters: 200, epoch: 1 | loss: 0.1057478
	speed: 0.0367s/iter; left time: 814.3087s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.68s
Steps: 224 | Train Loss: 0.1227104 Vali Loss: 0.0987805 Test Loss: 0.1124473
Validation loss decreased (inf --> 0.098781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0881546
	speed: 0.0692s/iter; left time: 1528.5135s
	iters: 200, epoch: 2 | loss: 0.0839041
	speed: 0.0366s/iter; left time: 804.5257s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.39s
Steps: 224 | Train Loss: 0.0888334 Vali Loss: 0.0863683 Test Loss: 0.0966257
Validation loss decreased (0.098781 --> 0.086368).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0810653
	speed: 0.0693s/iter; left time: 1514.1551s
	iters: 200, epoch: 3 | loss: 0.0780108
	speed: 0.0370s/iter; left time: 804.8375s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.56s
Steps: 224 | Train Loss: 0.0809483 Vali Loss: 0.0846691 Test Loss: 0.0963576
Validation loss decreased (0.086368 --> 0.084669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0755394
	speed: 0.0714s/iter; left time: 1543.7505s
	iters: 200, epoch: 4 | loss: 0.0710929
	speed: 0.0370s/iter; left time: 795.5126s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.60s
Steps: 224 | Train Loss: 0.0750709 Vali Loss: 0.0870775 Test Loss: 0.0994482
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0697136
	speed: 0.0681s/iter; left time: 1457.9331s
	iters: 200, epoch: 5 | loss: 0.0676897
	speed: 0.0369s/iter; left time: 786.8813s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0685628 Vali Loss: 0.0867065 Test Loss: 0.1005789
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0629834
	speed: 0.0679s/iter; left time: 1438.6277s
	iters: 200, epoch: 6 | loss: 0.0596543
	speed: 0.0370s/iter; left time: 779.0762s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.54s
Steps: 224 | Train Loss: 0.0631487 Vali Loss: 0.0876915 Test Loss: 0.1025325
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0583849
	speed: 0.0672s/iter; left time: 1408.6435s
	iters: 200, epoch: 7 | loss: 0.0602651
	speed: 0.0369s/iter; left time: 770.5576s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.48s
Steps: 224 | Train Loss: 0.0587093 Vali Loss: 0.0874375 Test Loss: 0.1018588
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0549119
	speed: 0.0675s/iter; left time: 1399.9950s
	iters: 200, epoch: 8 | loss: 0.0560786
	speed: 0.0370s/iter; left time: 763.8909s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.49s
Steps: 224 | Train Loss: 0.0553651 Vali Loss: 0.0881740 Test Loss: 0.1028083
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0521584
	speed: 0.0684s/iter; left time: 1403.1006s
	iters: 200, epoch: 9 | loss: 0.0536830
	speed: 0.0370s/iter; left time: 755.9786s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.51s
Steps: 224 | Train Loss: 0.0525659 Vali Loss: 0.0878278 Test Loss: 0.1036235
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0515497
	speed: 0.0697s/iter; left time: 1413.2877s
	iters: 200, epoch: 10 | loss: 0.0492939
	speed: 0.0370s/iter; left time: 747.1959s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.58s
Steps: 224 | Train Loss: 0.0503577 Vali Loss: 0.0873417 Test Loss: 0.1032716
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0490592
	speed: 0.0688s/iter; left time: 1381.1839s
	iters: 200, epoch: 11 | loss: 0.0483333
	speed: 0.0370s/iter; left time: 738.6871s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.56s
Steps: 224 | Train Loss: 0.0485498 Vali Loss: 0.0882791 Test Loss: 0.1041150
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0460475
	speed: 0.0689s/iter; left time: 1365.9209s
	iters: 200, epoch: 12 | loss: 0.0477318
	speed: 0.0370s/iter; left time: 730.9086s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.56s
Steps: 224 | Train Loss: 0.0470603 Vali Loss: 0.0882449 Test Loss: 0.1041703
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0464633
	speed: 0.0677s/iter; left time: 1328.7574s
	iters: 200, epoch: 13 | loss: 0.0447985
	speed: 0.0370s/iter; left time: 722.7024s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0457518 Vali Loss: 0.0879227 Test Loss: 0.1038360
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02128760516643524, rmse:0.14590272307395935, mae:0.09635764360427856, rse:0.42861831188201904
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1206920
	speed: 0.0390s/iter; left time: 870.7061s
	iters: 200, epoch: 1 | loss: 0.1044605
	speed: 0.0370s/iter; left time: 821.5127s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.1222095 Vali Loss: 0.0986643 Test Loss: 0.1127094
Validation loss decreased (inf --> 0.098664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0893477
	speed: 0.0706s/iter; left time: 1557.8984s
	iters: 200, epoch: 2 | loss: 0.0875691
	speed: 0.0370s/iter; left time: 812.3152s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.58s
Steps: 224 | Train Loss: 0.0888743 Vali Loss: 0.0859260 Test Loss: 0.0964946
Validation loss decreased (0.098664 --> 0.085926).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0825720
	speed: 0.0716s/iter; left time: 1564.7329s
	iters: 200, epoch: 3 | loss: 0.0776157
	speed: 0.0370s/iter; left time: 805.1212s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.58s
Steps: 224 | Train Loss: 0.0810978 Vali Loss: 0.0847863 Test Loss: 0.0970592
Validation loss decreased (0.085926 --> 0.084786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0736418
	speed: 0.0768s/iter; left time: 1660.7273s
	iters: 200, epoch: 4 | loss: 0.0746953
	speed: 0.0370s/iter; left time: 797.4933s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0756272 Vali Loss: 0.0876070 Test Loss: 0.0990943
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0709275
	speed: 0.0681s/iter; left time: 1457.6491s
	iters: 200, epoch: 5 | loss: 0.0688175
	speed: 0.0370s/iter; left time: 789.3435s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.0692754 Vali Loss: 0.0867718 Test Loss: 0.0993254
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0638534
	speed: 0.0675s/iter; left time: 1428.6799s
	iters: 200, epoch: 6 | loss: 0.0671972
	speed: 0.0371s/iter; left time: 781.3315s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.50s
Steps: 224 | Train Loss: 0.0637489 Vali Loss: 0.0890523 Test Loss: 0.1025759
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0594457
	speed: 0.0678s/iter; left time: 1421.1158s
	iters: 200, epoch: 7 | loss: 0.0576379
	speed: 0.0370s/iter; left time: 772.4269s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.54s
Steps: 224 | Train Loss: 0.0592008 Vali Loss: 0.0879823 Test Loss: 0.1020943
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0562947
	speed: 0.0678s/iter; left time: 1405.8360s
	iters: 200, epoch: 8 | loss: 0.0547949
	speed: 0.0370s/iter; left time: 763.5901s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.50s
Steps: 224 | Train Loss: 0.0555912 Vali Loss: 0.0874268 Test Loss: 0.1031761
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0536254
	speed: 0.0679s/iter; left time: 1393.2478s
	iters: 200, epoch: 9 | loss: 0.0511189
	speed: 0.0371s/iter; left time: 756.7342s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.54s
Steps: 224 | Train Loss: 0.0529678 Vali Loss: 0.0874318 Test Loss: 0.1027701
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0497992
	speed: 0.0680s/iter; left time: 1379.3132s
	iters: 200, epoch: 10 | loss: 0.0493689
	speed: 0.0371s/iter; left time: 748.2618s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.51s
Steps: 224 | Train Loss: 0.0507073 Vali Loss: 0.0876610 Test Loss: 0.1036280
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0484998
	speed: 0.0674s/iter; left time: 1352.5075s
	iters: 200, epoch: 11 | loss: 0.0478942
	speed: 0.0371s/iter; left time: 740.7091s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.0488367 Vali Loss: 0.0878983 Test Loss: 0.1036045
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0474226
	speed: 0.0677s/iter; left time: 1342.4226s
	iters: 200, epoch: 12 | loss: 0.0470230
	speed: 0.0370s/iter; left time: 730.2702s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0473769 Vali Loss: 0.0875008 Test Loss: 0.1031331
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0461315
	speed: 0.0679s/iter; left time: 1331.0627s
	iters: 200, epoch: 13 | loss: 0.0463021
	speed: 0.0371s/iter; left time: 723.2079s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.54s
Steps: 224 | Train Loss: 0.0459807 Vali Loss: 0.0874761 Test Loss: 0.1040362
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021523119881749153, rmse:0.14670759439468384, mae:0.09705924242734909, rse:0.430982768535614
Intermediate time for ES and pred_len 96: 00h:04m:46.05s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1163816
	speed: 0.0585s/iter; left time: 1298.8950s
	iters: 200, epoch: 1 | loss: 0.1108902
	speed: 0.0374s/iter; left time: 827.3087s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.74s
Steps: 223 | Train Loss: 0.1248022 Vali Loss: 0.1023977 Test Loss: 0.1158304
Validation loss decreased (inf --> 0.102398).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0921254
	speed: 0.0699s/iter; left time: 1537.0120s
	iters: 200, epoch: 2 | loss: 0.0908399
	speed: 0.0375s/iter; left time: 819.8032s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.56s
Steps: 223 | Train Loss: 0.0927227 Vali Loss: 0.0910081 Test Loss: 0.1025558
Validation loss decreased (0.102398 --> 0.091008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0819762
	speed: 0.0701s/iter; left time: 1524.1095s
	iters: 200, epoch: 3 | loss: 0.0822960
	speed: 0.0374s/iter; left time: 810.7123s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0837439 Vali Loss: 0.0907571 Test Loss: 0.1040672
Validation loss decreased (0.091008 --> 0.090757).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0749336
	speed: 0.0712s/iter; left time: 1533.2983s
	iters: 200, epoch: 4 | loss: 0.0747790
	speed: 0.0376s/iter; left time: 805.5098s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0775862 Vali Loss: 0.0917176 Test Loss: 0.1050464
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0705137
	speed: 0.0688s/iter; left time: 1466.2105s
	iters: 200, epoch: 5 | loss: 0.0680194
	speed: 0.0375s/iter; left time: 796.0690s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0709393 Vali Loss: 0.0919134 Test Loss: 0.1066828
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0646395
	speed: 0.0686s/iter; left time: 1445.4853s
	iters: 200, epoch: 6 | loss: 0.0624322
	speed: 0.0376s/iter; left time: 789.1517s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0652455 Vali Loss: 0.0927043 Test Loss: 0.1078849
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0588738
	speed: 0.0688s/iter; left time: 1435.3707s
	iters: 200, epoch: 7 | loss: 0.0584069
	speed: 0.0377s/iter; left time: 783.1926s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0607387 Vali Loss: 0.0924278 Test Loss: 0.1086021
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0583652
	speed: 0.0695s/iter; left time: 1434.9701s
	iters: 200, epoch: 8 | loss: 0.0561348
	speed: 0.0376s/iter; left time: 771.6879s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0573261 Vali Loss: 0.0913498 Test Loss: 0.1081561
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0559756
	speed: 0.0681s/iter; left time: 1390.4772s
	iters: 200, epoch: 9 | loss: 0.0540135
	speed: 0.0377s/iter; left time: 766.0340s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.59s
Steps: 223 | Train Loss: 0.0546794 Vali Loss: 0.0918480 Test Loss: 0.1092605
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0533090
	speed: 0.0700s/iter; left time: 1413.4773s
	iters: 200, epoch: 10 | loss: 0.0517176
	speed: 0.0376s/iter; left time: 756.0057s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.69s
Steps: 223 | Train Loss: 0.0524969 Vali Loss: 0.0911655 Test Loss: 0.1090398
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0501861
	speed: 0.0677s/iter; left time: 1352.7914s
	iters: 200, epoch: 11 | loss: 0.0512036
	speed: 0.0376s/iter; left time: 746.9927s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.61s
Steps: 223 | Train Loss: 0.0506564 Vali Loss: 0.0918502 Test Loss: 0.1101467
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0500589
	speed: 0.0687s/iter; left time: 1356.9551s
	iters: 200, epoch: 12 | loss: 0.0484598
	speed: 0.0376s/iter; left time: 739.2005s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0491260 Vali Loss: 0.0912417 Test Loss: 0.1085836
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0483878
	speed: 0.0674s/iter; left time: 1316.5723s
	iters: 200, epoch: 13 | loss: 0.0477217
	speed: 0.0376s/iter; left time: 730.5262s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0478048 Vali Loss: 0.0914497 Test Loss: 0.1093521
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023976393043994904, rmse:0.15484312176704407, mae:0.10406717658042908, rse:0.4549151659011841
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1175349
	speed: 0.0401s/iter; left time: 890.9419s
	iters: 200, epoch: 1 | loss: 0.1084700
	speed: 0.0376s/iter; left time: 830.8312s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.68s
Steps: 223 | Train Loss: 0.1244959 Vali Loss: 0.1024463 Test Loss: 0.1162472
Validation loss decreased (inf --> 0.102446).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0898947
	speed: 0.0714s/iter; left time: 1569.1116s
	iters: 200, epoch: 2 | loss: 0.0856463
	speed: 0.0377s/iter; left time: 825.1813s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.61s
Steps: 223 | Train Loss: 0.0925987 Vali Loss: 0.0932978 Test Loss: 0.1043351
Validation loss decreased (0.102446 --> 0.093298).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0827350
	speed: 0.0753s/iter; left time: 1637.6930s
	iters: 200, epoch: 3 | loss: 0.0816012
	speed: 0.0375s/iter; left time: 812.3076s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.05s
Steps: 223 | Train Loss: 0.0838777 Vali Loss: 0.0910307 Test Loss: 0.1022983
Validation loss decreased (0.093298 --> 0.091031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0757990
	speed: 0.0719s/iter; left time: 1549.0775s
	iters: 200, epoch: 4 | loss: 0.0789220
	speed: 0.0376s/iter; left time: 806.5424s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0777218 Vali Loss: 0.0916803 Test Loss: 0.1046190
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0728510
	speed: 0.0699s/iter; left time: 1488.6623s
	iters: 200, epoch: 5 | loss: 0.0691467
	speed: 0.0377s/iter; left time: 800.3650s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.70s
Steps: 223 | Train Loss: 0.0711922 Vali Loss: 0.0919240 Test Loss: 0.1052900
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0661750
	speed: 0.0689s/iter; left time: 1452.8997s
	iters: 200, epoch: 6 | loss: 0.0624056
	speed: 0.0377s/iter; left time: 791.0340s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0652811 Vali Loss: 0.0909325 Test Loss: 0.1052974
Validation loss decreased (0.091031 --> 0.090932).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0621013
	speed: 0.0715s/iter; left time: 1491.6876s
	iters: 200, epoch: 7 | loss: 0.0599107
	speed: 0.0378s/iter; left time: 784.6162s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0607668 Vali Loss: 0.0911602 Test Loss: 0.1063243
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0563518
	speed: 0.0696s/iter; left time: 1435.7269s
	iters: 200, epoch: 8 | loss: 0.0559218
	speed: 0.0377s/iter; left time: 774.1943s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0572916 Vali Loss: 0.0914432 Test Loss: 0.1076376
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0556821
	speed: 0.0697s/iter; left time: 1422.5821s
	iters: 200, epoch: 9 | loss: 0.0533361
	speed: 0.0377s/iter; left time: 765.2208s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.66s
Steps: 223 | Train Loss: 0.0544894 Vali Loss: 0.0921520 Test Loss: 0.1084078
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0515115
	speed: 0.0685s/iter; left time: 1383.3871s
	iters: 200, epoch: 10 | loss: 0.0515059
	speed: 0.0376s/iter; left time: 756.5207s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0523292 Vali Loss: 0.0909728 Test Loss: 0.1077595
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0513776
	speed: 0.0683s/iter; left time: 1364.3640s
	iters: 200, epoch: 11 | loss: 0.0483040
	speed: 0.0376s/iter; left time: 747.3891s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0504351 Vali Loss: 0.0909625 Test Loss: 0.1067574
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0499751
	speed: 0.0675s/iter; left time: 1332.8062s
	iters: 200, epoch: 12 | loss: 0.0477291
	speed: 0.0376s/iter; left time: 738.4474s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0489242 Vali Loss: 0.0909591 Test Loss: 0.1077092
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0485553
	speed: 0.0677s/iter; left time: 1322.8143s
	iters: 200, epoch: 13 | loss: 0.0470616
	speed: 0.0376s/iter; left time: 730.9655s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0475774 Vali Loss: 0.0906586 Test Loss: 0.1076076
Validation loss decreased (0.090932 --> 0.090659).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0466673
	speed: 0.0753s/iter; left time: 1453.6630s
	iters: 200, epoch: 14 | loss: 0.0455214
	speed: 0.0376s/iter; left time: 722.7113s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0464102 Vali Loss: 0.0908629 Test Loss: 0.1077477
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0446002
	speed: 0.0694s/iter; left time: 1324.4627s
	iters: 200, epoch: 15 | loss: 0.0453247
	speed: 0.0376s/iter; left time: 714.0358s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0454602 Vali Loss: 0.0911885 Test Loss: 0.1074364
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0447956
	speed: 0.0688s/iter; left time: 1297.8278s
	iters: 200, epoch: 16 | loss: 0.0437892
	speed: 0.0376s/iter; left time: 706.1368s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0445231 Vali Loss: 0.0909298 Test Loss: 0.1071214
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0458059
	speed: 0.0685s/iter; left time: 1275.4667s
	iters: 200, epoch: 17 | loss: 0.0438020
	speed: 0.0376s/iter; left time: 697.2707s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0437574 Vali Loss: 0.0910544 Test Loss: 0.1082112
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0424549
	speed: 0.0684s/iter; left time: 1259.9335s
	iters: 200, epoch: 18 | loss: 0.0423657
	speed: 0.0376s/iter; left time: 688.9200s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0430429 Vali Loss: 0.0909749 Test Loss: 0.1070633
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0420527
	speed: 0.0680s/iter; left time: 1236.8707s
	iters: 200, epoch: 19 | loss: 0.0418293
	speed: 0.0377s/iter; left time: 680.9808s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.61s
Steps: 223 | Train Loss: 0.0424932 Vali Loss: 0.0912879 Test Loss: 0.1072865
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0413832
	speed: 0.0682s/iter; left time: 1225.9302s
	iters: 200, epoch: 20 | loss: 0.0422145
	speed: 0.0378s/iter; left time: 674.5036s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0419328 Vali Loss: 0.0910424 Test Loss: 0.1075408
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0422132
	speed: 0.0694s/iter; left time: 1231.2145s
	iters: 200, epoch: 21 | loss: 0.0414470
	speed: 0.0376s/iter; left time: 663.6032s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0414209 Vali Loss: 0.0908888 Test Loss: 0.1070007
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0411897
	speed: 0.0691s/iter; left time: 1210.0980s
	iters: 200, epoch: 22 | loss: 0.0404827
	speed: 0.0376s/iter; left time: 654.8093s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0410036 Vali Loss: 0.0908771 Test Loss: 0.1070293
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0403958
	speed: 0.0685s/iter; left time: 1185.1543s
	iters: 200, epoch: 23 | loss: 0.0401826
	speed: 0.0378s/iter; left time: 650.5426s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0405974 Vali Loss: 0.0909427 Test Loss: 0.1070570
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.025794485583901405, rmse:0.16060662269592285, mae:0.1076076328754425, rse:0.471847802400589
Intermediate time for ES and pred_len 168: 00h:06m:36.93sIntermediate time for ES: 00h:17m:20.12s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0774302
	speed: 0.0584s/iter; left time: 1301.8417s
	iters: 200, epoch: 1 | loss: 0.0691184
	speed: 0.0359s/iter; left time: 796.2786s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.50s
Steps: 224 | Train Loss: 0.0842083 Vali Loss: 0.0746542 Test Loss: 0.0815250
Validation loss decreased (inf --> 0.074654).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0522541
	speed: 0.0670s/iter; left time: 1479.6405s
	iters: 200, epoch: 2 | loss: 0.0525554
	speed: 0.0359s/iter; left time: 788.2902s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.22s
Steps: 224 | Train Loss: 0.0527889 Vali Loss: 0.0590143 Test Loss: 0.0636809
Validation loss decreased (0.074654 --> 0.059014).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0472350
	speed: 0.0677s/iter; left time: 1478.6143s
	iters: 200, epoch: 3 | loss: 0.0451831
	speed: 0.0359s/iter; left time: 781.6770s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.33s
Steps: 224 | Train Loss: 0.0474066 Vali Loss: 0.0579574 Test Loss: 0.0632910
Validation loss decreased (0.059014 --> 0.057957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0454761
	speed: 0.0671s/iter; left time: 1450.8155s
	iters: 200, epoch: 4 | loss: 0.0480653
	speed: 0.0361s/iter; left time: 777.6023s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.0454726 Vali Loss: 0.0577225 Test Loss: 0.0624718
Validation loss decreased (0.057957 --> 0.057722).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0472443
	speed: 0.0674s/iter; left time: 1442.7406s
	iters: 200, epoch: 5 | loss: 0.0437535
	speed: 0.0360s/iter; left time: 766.1403s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0437581 Vali Loss: 0.0551825 Test Loss: 0.0619157
Validation loss decreased (0.057722 --> 0.055183).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0418511
	speed: 0.0669s/iter; left time: 1417.6291s
	iters: 200, epoch: 6 | loss: 0.0393778
	speed: 0.0360s/iter; left time: 759.4447s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0419216 Vali Loss: 0.0558044 Test Loss: 0.0628493
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0389298
	speed: 0.0652s/iter; left time: 1365.5210s
	iters: 200, epoch: 7 | loss: 0.0402346
	speed: 0.0360s/iter; left time: 751.0607s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0402008 Vali Loss: 0.0557559 Test Loss: 0.0631887
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0377631
	speed: 0.0656s/iter; left time: 1360.0001s
	iters: 200, epoch: 8 | loss: 0.0382363
	speed: 0.0360s/iter; left time: 743.3375s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0384846 Vali Loss: 0.0566652 Test Loss: 0.0640289
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0366412
	speed: 0.0655s/iter; left time: 1343.6514s
	iters: 200, epoch: 9 | loss: 0.0389959
	speed: 0.0360s/iter; left time: 734.9481s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0369631 Vali Loss: 0.0566219 Test Loss: 0.0651589
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0370429
	speed: 0.0650s/iter; left time: 1319.3845s
	iters: 200, epoch: 10 | loss: 0.0350592
	speed: 0.0362s/iter; left time: 730.9376s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.29s
Steps: 224 | Train Loss: 0.0355432 Vali Loss: 0.0567655 Test Loss: 0.0655837
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0350809
	speed: 0.0655s/iter; left time: 1314.9285s
	iters: 200, epoch: 11 | loss: 0.0351882
	speed: 0.0361s/iter; left time: 720.1979s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.34s
Steps: 224 | Train Loss: 0.0342154 Vali Loss: 0.0566351 Test Loss: 0.0655822
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0336182
	speed: 0.0658s/iter; left time: 1305.5530s
	iters: 200, epoch: 12 | loss: 0.0324513
	speed: 0.0361s/iter; left time: 713.4133s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.32s
Steps: 224 | Train Loss: 0.0332261 Vali Loss: 0.0570448 Test Loss: 0.0658584
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0336329
	speed: 0.0659s/iter; left time: 1291.8071s
	iters: 200, epoch: 13 | loss: 0.0322168
	speed: 0.0362s/iter; left time: 706.9660s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.32s
Steps: 224 | Train Loss: 0.0321168 Vali Loss: 0.0571951 Test Loss: 0.0664647
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0325922
	speed: 0.0661s/iter; left time: 1281.8064s
	iters: 200, epoch: 14 | loss: 0.0305025
	speed: 0.0360s/iter; left time: 694.5337s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0312447 Vali Loss: 0.0574833 Test Loss: 0.0668741
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0291438
	speed: 0.0646s/iter; left time: 1237.4552s
	iters: 200, epoch: 15 | loss: 0.0309491
	speed: 0.0360s/iter; left time: 686.3196s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0305640 Vali Loss: 0.0578454 Test Loss: 0.0666672
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011583272367715836, rmse:0.10762561112642288, mae:0.061915747821331024, rse:0.4152166247367859
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0763866
	speed: 0.0380s/iter; left time: 847.7846s
	iters: 200, epoch: 1 | loss: 0.0717330
	speed: 0.0360s/iter; left time: 799.0391s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.29s
Steps: 224 | Train Loss: 0.0848022 Vali Loss: 0.0749543 Test Loss: 0.0822586
Validation loss decreased (inf --> 0.074954).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0516082
	speed: 0.0667s/iter; left time: 1472.7678s
	iters: 200, epoch: 2 | loss: 0.0509567
	speed: 0.0361s/iter; left time: 793.7855s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.31s
Steps: 224 | Train Loss: 0.0526143 Vali Loss: 0.0587893 Test Loss: 0.0635817
Validation loss decreased (0.074954 --> 0.058789).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0448147
	speed: 0.0669s/iter; left time: 1462.0936s
	iters: 200, epoch: 3 | loss: 0.0475710
	speed: 0.0359s/iter; left time: 781.5981s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0473608 Vali Loss: 0.0573914 Test Loss: 0.0624544
Validation loss decreased (0.058789 --> 0.057391).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0475547
	speed: 0.0672s/iter; left time: 1454.0197s
	iters: 200, epoch: 4 | loss: 0.0427494
	speed: 0.0362s/iter; left time: 779.2439s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.33s
Steps: 224 | Train Loss: 0.0456805 Vali Loss: 0.0562400 Test Loss: 0.0615929
Validation loss decreased (0.057391 --> 0.056240).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0447639
	speed: 0.0681s/iter; left time: 1456.8295s
	iters: 200, epoch: 5 | loss: 0.0447122
	speed: 0.0359s/iter; left time: 765.3235s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.34s
Steps: 224 | Train Loss: 0.0440722 Vali Loss: 0.0558105 Test Loss: 0.0613816
Validation loss decreased (0.056240 --> 0.055810).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0423625
	speed: 0.0670s/iter; left time: 1418.9331s
	iters: 200, epoch: 6 | loss: 0.0418996
	speed: 0.0360s/iter; left time: 758.4855s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0424775 Vali Loss: 0.0562341 Test Loss: 0.0626750
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0399484
	speed: 0.0646s/iter; left time: 1354.0227s
	iters: 200, epoch: 7 | loss: 0.0413925
	speed: 0.0359s/iter; left time: 749.5953s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0408583 Vali Loss: 0.0557796 Test Loss: 0.0624677
Validation loss decreased (0.055810 --> 0.055780).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0420623
	speed: 0.0675s/iter; left time: 1400.4510s
	iters: 200, epoch: 8 | loss: 0.0397080
	speed: 0.0359s/iter; left time: 741.3129s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.29s
Steps: 224 | Train Loss: 0.0392455 Vali Loss: 0.0554279 Test Loss: 0.0629354
Validation loss decreased (0.055780 --> 0.055428).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0364948
	speed: 0.0670s/iter; left time: 1374.0509s
	iters: 200, epoch: 9 | loss: 0.0365153
	speed: 0.0360s/iter; left time: 733.8487s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0377488 Vali Loss: 0.0563709 Test Loss: 0.0649341
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0375719
	speed: 0.0650s/iter; left time: 1318.2630s
	iters: 200, epoch: 10 | loss: 0.0349937
	speed: 0.0360s/iter; left time: 725.6696s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0364158 Vali Loss: 0.0557732 Test Loss: 0.0642876
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0358386
	speed: 0.0648s/iter; left time: 1300.1510s
	iters: 200, epoch: 11 | loss: 0.0343064
	speed: 0.0360s/iter; left time: 718.9569s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0350151 Vali Loss: 0.0565198 Test Loss: 0.0641924
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0336658
	speed: 0.0655s/iter; left time: 1299.3286s
	iters: 200, epoch: 12 | loss: 0.0339401
	speed: 0.0362s/iter; left time: 714.5530s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.35s
Steps: 224 | Train Loss: 0.0339947 Vali Loss: 0.0572392 Test Loss: 0.0655326
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0316792
	speed: 0.0665s/iter; left time: 1303.6734s
	iters: 200, epoch: 13 | loss: 0.0327186
	speed: 0.0361s/iter; left time: 703.5446s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.33s
Steps: 224 | Train Loss: 0.0329463 Vali Loss: 0.0573169 Test Loss: 0.0657720
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0334601
	speed: 0.0654s/iter; left time: 1267.5418s
	iters: 200, epoch: 14 | loss: 0.0324468
	speed: 0.0360s/iter; left time: 694.0182s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.31s
Steps: 224 | Train Loss: 0.0320966 Vali Loss: 0.0571392 Test Loss: 0.0652342
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0312930
	speed: 0.0652s/iter; left time: 1249.0592s
	iters: 200, epoch: 15 | loss: 0.0323260
	speed: 0.0361s/iter; left time: 688.4011s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0312056 Vali Loss: 0.0569882 Test Loss: 0.0657398
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0319848
	speed: 0.0655s/iter; left time: 1240.3820s
	iters: 200, epoch: 16 | loss: 0.0302301
	speed: 0.0360s/iter; left time: 677.5099s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0306099 Vali Loss: 0.0572523 Test Loss: 0.0661637
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0300939
	speed: 0.0648s/iter; left time: 1212.8351s
	iters: 200, epoch: 17 | loss: 0.0302816
	speed: 0.0360s/iter; left time: 669.4987s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0299626 Vali Loss: 0.0572787 Test Loss: 0.0662979
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0283338
	speed: 0.0646s/iter; left time: 1194.1855s
	iters: 200, epoch: 18 | loss: 0.0278673
	speed: 0.0359s/iter; left time: 660.7108s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0294758 Vali Loss: 0.0572763 Test Loss: 0.0662424
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.012298212386667728, rmse:0.11089730262756348, mae:0.06293540447950363, rse:0.4278387129306793
Intermediate time for FR and pred_len 24: 00h:05m:47.68s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0860135
	speed: 0.0581s/iter; left time: 1296.3763s
	iters: 200, epoch: 1 | loss: 0.0791082
	speed: 0.0366s/iter; left time: 811.6700s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.68s
Steps: 224 | Train Loss: 0.0918037 Vali Loss: 0.0848544 Test Loss: 0.0949326
Validation loss decreased (inf --> 0.084854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0647720
	speed: 0.0682s/iter; left time: 1506.3325s
	iters: 200, epoch: 2 | loss: 0.0631175
	speed: 0.0365s/iter; left time: 803.0220s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.37s
Steps: 224 | Train Loss: 0.0664535 Vali Loss: 0.0777003 Test Loss: 0.0864990
Validation loss decreased (0.084854 --> 0.077700).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0600775
	speed: 0.0680s/iter; left time: 1485.5513s
	iters: 200, epoch: 3 | loss: 0.0543064
	speed: 0.0366s/iter; left time: 796.0416s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.39s
Steps: 224 | Train Loss: 0.0585568 Vali Loss: 0.0771889 Test Loss: 0.0906936
Validation loss decreased (0.077700 --> 0.077189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0532778
	speed: 0.0693s/iter; left time: 1498.6843s
	iters: 200, epoch: 4 | loss: 0.0523184
	speed: 0.0368s/iter; left time: 791.2253s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.44s
Steps: 224 | Train Loss: 0.0523362 Vali Loss: 0.0781176 Test Loss: 0.0930787
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0462666
	speed: 0.0676s/iter; left time: 1447.9507s
	iters: 200, epoch: 5 | loss: 0.0443901
	speed: 0.0366s/iter; left time: 779.2974s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.40s
Steps: 224 | Train Loss: 0.0474826 Vali Loss: 0.0785965 Test Loss: 0.0931458
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0457473
	speed: 0.0670s/iter; left time: 1419.3463s
	iters: 200, epoch: 6 | loss: 0.0426339
	speed: 0.0366s/iter; left time: 771.8081s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.41s
Steps: 224 | Train Loss: 0.0435624 Vali Loss: 0.0789405 Test Loss: 0.0945561
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0414819
	speed: 0.0659s/iter; left time: 1380.5983s
	iters: 200, epoch: 7 | loss: 0.0412325
	speed: 0.0366s/iter; left time: 763.2119s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.38s
Steps: 224 | Train Loss: 0.0408934 Vali Loss: 0.0788888 Test Loss: 0.0940956
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0400504
	speed: 0.0673s/iter; left time: 1395.7495s
	iters: 200, epoch: 8 | loss: 0.0365259
	speed: 0.0366s/iter; left time: 754.8101s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.45s
Steps: 224 | Train Loss: 0.0385648 Vali Loss: 0.0781065 Test Loss: 0.0945006
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0368542
	speed: 0.0677s/iter; left time: 1388.0684s
	iters: 200, epoch: 9 | loss: 0.0359097
	speed: 0.0370s/iter; left time: 756.1342s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.54s
Steps: 224 | Train Loss: 0.0367134 Vali Loss: 0.0783626 Test Loss: 0.0951715
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0350496
	speed: 0.0696s/iter; left time: 1411.5361s
	iters: 200, epoch: 10 | loss: 0.0354598
	speed: 0.0368s/iter; left time: 742.2687s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.51s
Steps: 224 | Train Loss: 0.0352285 Vali Loss: 0.0784737 Test Loss: 0.0949505
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0329985
	speed: 0.0674s/iter; left time: 1352.5520s
	iters: 200, epoch: 11 | loss: 0.0322747
	speed: 0.0368s/iter; left time: 735.0182s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.48s
Steps: 224 | Train Loss: 0.0338981 Vali Loss: 0.0785637 Test Loss: 0.0955573
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0327553
	speed: 0.0689s/iter; left time: 1366.3716s
	iters: 200, epoch: 12 | loss: 0.0318506
	speed: 0.0370s/iter; left time: 731.0941s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0328542 Vali Loss: 0.0780471 Test Loss: 0.0950538
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0317077
	speed: 0.0687s/iter; left time: 1348.2496s
	iters: 200, epoch: 13 | loss: 0.0317535
	speed: 0.0371s/iter; left time: 723.4959s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.0319272 Vali Loss: 0.0787877 Test Loss: 0.0954137
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.023921409621834755, rmse:0.15466547012329102, mae:0.0906936526298523, rse:0.5982871651649475
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0892614
	speed: 0.0391s/iter; left time: 872.7693s
	iters: 200, epoch: 1 | loss: 0.0792313
	speed: 0.0371s/iter; left time: 824.2028s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.56s
Steps: 224 | Train Loss: 0.0912959 Vali Loss: 0.0848657 Test Loss: 0.0948307
Validation loss decreased (inf --> 0.084866).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0630361
	speed: 0.0713s/iter; left time: 1573.9863s
	iters: 200, epoch: 2 | loss: 0.0624525
	speed: 0.0372s/iter; left time: 816.9007s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.61s
Steps: 224 | Train Loss: 0.0666660 Vali Loss: 0.0763014 Test Loss: 0.0868436
Validation loss decreased (0.084866 --> 0.076301).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0607722
	speed: 0.0703s/iter; left time: 1535.7542s
	iters: 200, epoch: 3 | loss: 0.0552398
	speed: 0.0371s/iter; left time: 807.4850s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0590313 Vali Loss: 0.0774201 Test Loss: 0.0879567
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0524543
	speed: 0.0712s/iter; left time: 1540.8796s
	iters: 200, epoch: 4 | loss: 0.0516233
	speed: 0.0372s/iter; left time: 799.8162s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.51s
Steps: 224 | Train Loss: 0.0526230 Vali Loss: 0.0778189 Test Loss: 0.0899232
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0471181
	speed: 0.0678s/iter; left time: 1450.3795s
	iters: 200, epoch: 5 | loss: 0.0472201
	speed: 0.0371s/iter; left time: 791.4755s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0474742 Vali Loss: 0.0786534 Test Loss: 0.0924569
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0455989
	speed: 0.0677s/iter; left time: 1434.8956s
	iters: 200, epoch: 6 | loss: 0.0428772
	speed: 0.0372s/iter; left time: 783.7801s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0437755 Vali Loss: 0.0781509 Test Loss: 0.0938569
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0407744
	speed: 0.0690s/iter; left time: 1447.0521s
	iters: 200, epoch: 7 | loss: 0.0398927
	speed: 0.0372s/iter; left time: 776.1772s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.59s
Steps: 224 | Train Loss: 0.0406491 Vali Loss: 0.0786640 Test Loss: 0.0946826
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0398411
	speed: 0.0681s/iter; left time: 1411.5595s
	iters: 200, epoch: 8 | loss: 0.0376575
	speed: 0.0372s/iter; left time: 768.2007s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0384393 Vali Loss: 0.0794971 Test Loss: 0.0951159
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0364580
	speed: 0.0686s/iter; left time: 1407.0917s
	iters: 200, epoch: 9 | loss: 0.0347289
	speed: 0.0372s/iter; left time: 758.5350s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.58s
Steps: 224 | Train Loss: 0.0365944 Vali Loss: 0.0790102 Test Loss: 0.0942951
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0350851
	speed: 0.0685s/iter; left time: 1389.7791s
	iters: 200, epoch: 10 | loss: 0.0345143
	speed: 0.0372s/iter; left time: 751.6500s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.57s
Steps: 224 | Train Loss: 0.0351331 Vali Loss: 0.0787471 Test Loss: 0.0944254
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0336423
	speed: 0.0674s/iter; left time: 1352.4076s
	iters: 200, epoch: 11 | loss: 0.0334111
	speed: 0.0372s/iter; left time: 742.5435s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0337289 Vali Loss: 0.0789621 Test Loss: 0.0946286
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0325420
	speed: 0.0676s/iter; left time: 1341.5194s
	iters: 200, epoch: 12 | loss: 0.0328804
	speed: 0.0372s/iter; left time: 733.5584s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.0327242 Vali Loss: 0.0786662 Test Loss: 0.0941599
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02186344750225544, rmse:0.14786294102668762, mae:0.08684352785348892, rse:0.5719731450080872
Intermediate time for FR and pred_len 96: 00h:04m:34.02s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0883397
	speed: 0.0596s/iter; left time: 1323.2753s
	iters: 200, epoch: 1 | loss: 0.0807897
	speed: 0.0374s/iter; left time: 827.4043s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.78s
Steps: 223 | Train Loss: 0.0938396 Vali Loss: 0.0877527 Test Loss: 0.0973073
Validation loss decreased (inf --> 0.087753).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0648315
	speed: 0.0703s/iter; left time: 1544.9264s
	iters: 200, epoch: 2 | loss: 0.0676119
	speed: 0.0375s/iter; left time: 821.2929s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.55s
Steps: 223 | Train Loss: 0.0701231 Vali Loss: 0.0811533 Test Loss: 0.0923171
Validation loss decreased (0.087753 --> 0.081153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0627404
	speed: 0.0705s/iter; left time: 1533.8485s
	iters: 200, epoch: 3 | loss: 0.0562843
	speed: 0.0378s/iter; left time: 817.9265s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0606758 Vali Loss: 0.0817043 Test Loss: 0.0944474
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0539884
	speed: 0.0690s/iter; left time: 1485.9598s
	iters: 200, epoch: 4 | loss: 0.0514295
	speed: 0.0378s/iter; left time: 809.9309s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0535666 Vali Loss: 0.0845713 Test Loss: 0.0969523
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0494446
	speed: 0.0691s/iter; left time: 1472.4938s
	iters: 200, epoch: 5 | loss: 0.0456112
	speed: 0.0378s/iter; left time: 800.6791s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0481148 Vali Loss: 0.0831654 Test Loss: 0.0966976
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0445635
	speed: 0.0695s/iter; left time: 1464.4574s
	iters: 200, epoch: 6 | loss: 0.0426843
	speed: 0.0378s/iter; left time: 792.5714s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.66s
Steps: 223 | Train Loss: 0.0442609 Vali Loss: 0.0830506 Test Loss: 0.0972017
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0401295
	speed: 0.0689s/iter; left time: 1437.1616s
	iters: 200, epoch: 7 | loss: 0.0399213
	speed: 0.0378s/iter; left time: 783.8380s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.66s
Steps: 223 | Train Loss: 0.0413844 Vali Loss: 0.0826850 Test Loss: 0.0963310
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0401763
	speed: 0.0682s/iter; left time: 1407.6185s
	iters: 200, epoch: 8 | loss: 0.0390191
	speed: 0.0378s/iter; left time: 775.9992s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0390773 Vali Loss: 0.0822153 Test Loss: 0.0954231
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0366204
	speed: 0.0681s/iter; left time: 1390.9938s
	iters: 200, epoch: 9 | loss: 0.0369136
	speed: 0.0378s/iter; left time: 768.2337s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0373037 Vali Loss: 0.0819071 Test Loss: 0.0958485
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0363914
	speed: 0.0679s/iter; left time: 1372.0451s
	iters: 200, epoch: 10 | loss: 0.0344929
	speed: 0.0378s/iter; left time: 759.1628s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0358272 Vali Loss: 0.0823803 Test Loss: 0.0960998
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0340534
	speed: 0.0682s/iter; left time: 1362.5500s
	iters: 200, epoch: 11 | loss: 0.0343421
	speed: 0.0378s/iter; left time: 751.3912s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0345782 Vali Loss: 0.0821481 Test Loss: 0.0962892
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0330758
	speed: 0.0700s/iter; left time: 1381.7208s
	iters: 200, epoch: 12 | loss: 0.0326439
	speed: 0.0378s/iter; left time: 743.4216s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.71s
Steps: 223 | Train Loss: 0.0334936 Vali Loss: 0.0821610 Test Loss: 0.0961578
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.022720007225871086, rmse:0.15073157846927643, mae:0.0923171192407608, rse:0.5837976336479187
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0897532
	speed: 0.0404s/iter; left time: 896.5065s
	iters: 200, epoch: 1 | loss: 0.0819243
	speed: 0.0379s/iter; left time: 837.1086s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.74s
Steps: 223 | Train Loss: 0.0932191 Vali Loss: 0.0877909 Test Loss: 0.0973528
Validation loss decreased (inf --> 0.087791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0683162
	speed: 0.0741s/iter; left time: 1629.3761s
	iters: 200, epoch: 2 | loss: 0.0642989
	speed: 0.0379s/iter; left time: 829.6581s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.75s
Steps: 223 | Train Loss: 0.0702327 Vali Loss: 0.0801821 Test Loss: 0.0913817
Validation loss decreased (0.087791 --> 0.080182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0632260
	speed: 0.0726s/iter; left time: 1579.4298s
	iters: 200, epoch: 3 | loss: 0.0561919
	speed: 0.0379s/iter; left time: 820.4718s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.71s
Steps: 223 | Train Loss: 0.0612732 Vali Loss: 0.0803469 Test Loss: 0.0932560
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0544689
	speed: 0.0692s/iter; left time: 1489.9065s
	iters: 200, epoch: 4 | loss: 0.0534421
	speed: 0.0379s/iter; left time: 811.6000s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0544669 Vali Loss: 0.0810882 Test Loss: 0.0964467
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0478039
	speed: 0.0744s/iter; left time: 1585.9444s
	iters: 200, epoch: 5 | loss: 0.0485504
	speed: 0.0378s/iter; left time: 801.6693s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.69s
Steps: 223 | Train Loss: 0.0490413 Vali Loss: 0.0816116 Test Loss: 0.0969762
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0454839
	speed: 0.0689s/iter; left time: 1453.0714s
	iters: 200, epoch: 6 | loss: 0.0450175
	speed: 0.0376s/iter; left time: 789.4664s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0452311 Vali Loss: 0.0826290 Test Loss: 0.0975412
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0421670
	speed: 0.0691s/iter; left time: 1442.6384s
	iters: 200, epoch: 7 | loss: 0.0424665
	speed: 0.0378s/iter; left time: 785.8423s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0422952 Vali Loss: 0.0828618 Test Loss: 0.0975944
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0397950
	speed: 0.0688s/iter; left time: 1419.7963s
	iters: 200, epoch: 8 | loss: 0.0401185
	speed: 0.0379s/iter; left time: 778.9209s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.69s
Steps: 223 | Train Loss: 0.0399941 Vali Loss: 0.0826661 Test Loss: 0.0966273
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0374754
	speed: 0.0691s/iter; left time: 1410.3517s
	iters: 200, epoch: 9 | loss: 0.0380377
	speed: 0.0379s/iter; left time: 769.4799s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.70s
Steps: 223 | Train Loss: 0.0381471 Vali Loss: 0.0828688 Test Loss: 0.0973295
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0369976
	speed: 0.0689s/iter; left time: 1391.2095s
	iters: 200, epoch: 10 | loss: 0.0359709
	speed: 0.0379s/iter; left time: 760.8216s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.69s
Steps: 223 | Train Loss: 0.0366557 Vali Loss: 0.0829653 Test Loss: 0.0973227
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0356732
	speed: 0.0690s/iter; left time: 1378.4307s
	iters: 200, epoch: 11 | loss: 0.0353341
	speed: 0.0379s/iter; left time: 752.9473s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0352881 Vali Loss: 0.0830438 Test Loss: 0.0961625
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0348982
	speed: 0.0682s/iter; left time: 1346.6581s
	iters: 200, epoch: 12 | loss: 0.0341980
	speed: 0.0378s/iter; left time: 743.3140s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.66s
Steps: 223 | Train Loss: 0.0342304 Vali Loss: 0.0829399 Test Loss: 0.0967070
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.022772712633013725, rmse:0.15090630948543549, mae:0.09138165414333344, rse:0.5844743847846985
Intermediate time for FR and pred_len 168: 00h:04m:29.27sIntermediate time for FR: 00h:14m:50.97s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1056879
	speed: 0.0571s/iter; left time: 1272.6735s
	iters: 200, epoch: 1 | loss: 0.1004864
	speed: 0.0358s/iter; left time: 794.3698s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.1187621 Vali Loss: 0.0861204 Test Loss: 0.0891535
Validation loss decreased (inf --> 0.086120).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0673742
	speed: 0.0672s/iter; left time: 1482.7213s
	iters: 200, epoch: 2 | loss: 0.0652927
	speed: 0.0359s/iter; left time: 788.7313s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0720626 Vali Loss: 0.0648640 Test Loss: 0.0678524
Validation loss decreased (0.086120 --> 0.064864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0663056
	speed: 0.0669s/iter; left time: 1461.0216s
	iters: 200, epoch: 3 | loss: 0.0649150
	speed: 0.0359s/iter; left time: 781.9248s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0644170 Vali Loss: 0.0627249 Test Loss: 0.0654090
Validation loss decreased (0.064864 --> 0.062725).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0619008
	speed: 0.0662s/iter; left time: 1430.8692s
	iters: 200, epoch: 4 | loss: 0.0656530
	speed: 0.0360s/iter; left time: 774.2619s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0623186 Vali Loss: 0.0617503 Test Loss: 0.0651260
Validation loss decreased (0.062725 --> 0.061750).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0610019
	speed: 0.0661s/iter; left time: 1414.4312s
	iters: 200, epoch: 5 | loss: 0.0608520
	speed: 0.0360s/iter; left time: 766.3307s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0606811 Vali Loss: 0.0619459 Test Loss: 0.0650296
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0581172
	speed: 0.0648s/iter; left time: 1373.3466s
	iters: 200, epoch: 6 | loss: 0.0623301
	speed: 0.0360s/iter; left time: 758.8006s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.0585274 Vali Loss: 0.0604726 Test Loss: 0.0640318
Validation loss decreased (0.061750 --> 0.060473).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0529019
	speed: 0.0681s/iter; left time: 1426.3619s
	iters: 200, epoch: 7 | loss: 0.0547423
	speed: 0.0360s/iter; left time: 751.0647s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0568058 Vali Loss: 0.0595173 Test Loss: 0.0625137
Validation loss decreased (0.060473 --> 0.059517).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0547101
	speed: 0.0671s/iter; left time: 1391.3075s
	iters: 200, epoch: 8 | loss: 0.0547506
	speed: 0.0360s/iter; left time: 742.6113s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0549294 Vali Loss: 0.0606638 Test Loss: 0.0635295
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0549952
	speed: 0.0644s/iter; left time: 1321.4190s
	iters: 200, epoch: 9 | loss: 0.0505096
	speed: 0.0360s/iter; left time: 734.4739s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0532076 Vali Loss: 0.0604032 Test Loss: 0.0640752
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0519652
	speed: 0.0648s/iter; left time: 1314.8352s
	iters: 200, epoch: 10 | loss: 0.0473846
	speed: 0.0360s/iter; left time: 726.7814s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0515198 Vali Loss: 0.0606285 Test Loss: 0.0647748
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0507708
	speed: 0.0646s/iter; left time: 1295.4840s
	iters: 200, epoch: 11 | loss: 0.0481363
	speed: 0.0360s/iter; left time: 718.9295s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0498876 Vali Loss: 0.0607902 Test Loss: 0.0653810
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0482018
	speed: 0.0654s/iter; left time: 1298.1194s
	iters: 200, epoch: 12 | loss: 0.0509464
	speed: 0.0360s/iter; left time: 710.3352s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0485899 Vali Loss: 0.0613865 Test Loss: 0.0655188
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0480028
	speed: 0.0656s/iter; left time: 1286.3257s
	iters: 200, epoch: 13 | loss: 0.0468602
	speed: 0.0362s/iter; left time: 705.6283s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.0471925 Vali Loss: 0.0614365 Test Loss: 0.0660389
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0478710
	speed: 0.0663s/iter; left time: 1285.8524s
	iters: 200, epoch: 14 | loss: 0.0459304
	speed: 0.0361s/iter; left time: 696.7004s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.34s
Steps: 224 | Train Loss: 0.0459213 Vali Loss: 0.0614026 Test Loss: 0.0659929
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0430049
	speed: 0.0672s/iter; left time: 1287.2223s
	iters: 200, epoch: 15 | loss: 0.0439616
	speed: 0.0361s/iter; left time: 688.0583s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.34s
Steps: 224 | Train Loss: 0.0447048 Vali Loss: 0.0619571 Test Loss: 0.0661547
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0433775
	speed: 0.0658s/iter; left time: 1245.6320s
	iters: 200, epoch: 16 | loss: 0.0447654
	speed: 0.0360s/iter; left time: 677.7542s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0437796 Vali Loss: 0.0618690 Test Loss: 0.0665378
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0434429
	speed: 0.0640s/iter; left time: 1198.7614s
	iters: 200, epoch: 17 | loss: 0.0444005
	speed: 0.0360s/iter; left time: 669.3331s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.22s
Steps: 224 | Train Loss: 0.0429974 Vali Loss: 0.0622559 Test Loss: 0.0668088
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.0111303785815835, rmse:0.10550060868263245, mae:0.06251367181539536, rse:0.39863482117652893
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1148802
	speed: 0.0378s/iter; left time: 843.8195s
	iters: 200, epoch: 1 | loss: 0.0958483
	speed: 0.0359s/iter; left time: 797.4936s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.1176615 Vali Loss: 0.0858646 Test Loss: 0.0892221
Validation loss decreased (inf --> 0.085865).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0707289
	speed: 0.0660s/iter; left time: 1457.5739s
	iters: 200, epoch: 2 | loss: 0.0692499
	speed: 0.0359s/iter; left time: 788.9389s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0719129 Vali Loss: 0.0640210 Test Loss: 0.0672519
Validation loss decreased (0.085865 --> 0.064021).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0672626
	speed: 0.0703s/iter; left time: 1536.9086s
	iters: 200, epoch: 3 | loss: 0.0609695
	speed: 0.0359s/iter; left time: 781.0728s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0646186 Vali Loss: 0.0627149 Test Loss: 0.0651882
Validation loss decreased (0.064021 --> 0.062715).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0651551
	speed: 0.0659s/iter; left time: 1425.3909s
	iters: 200, epoch: 4 | loss: 0.0647966
	speed: 0.0359s/iter; left time: 773.0421s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0622879 Vali Loss: 0.0616199 Test Loss: 0.0644832
Validation loss decreased (0.062715 --> 0.061620).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0573382
	speed: 0.0658s/iter; left time: 1408.7840s
	iters: 200, epoch: 5 | loss: 0.0579615
	speed: 0.0359s/iter; left time: 765.4103s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0601250 Vali Loss: 0.0607971 Test Loss: 0.0638502
Validation loss decreased (0.061620 --> 0.060797).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0577319
	speed: 0.0663s/iter; left time: 1405.1749s
	iters: 200, epoch: 6 | loss: 0.0562989
	speed: 0.0359s/iter; left time: 756.5304s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0581003 Vali Loss: 0.0598439 Test Loss: 0.0635718
Validation loss decreased (0.060797 --> 0.059844).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0567943
	speed: 0.0660s/iter; left time: 1382.7318s
	iters: 200, epoch: 7 | loss: 0.0545281
	speed: 0.0359s/iter; left time: 749.4279s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0563246 Vali Loss: 0.0601866 Test Loss: 0.0634204
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0573324
	speed: 0.0644s/iter; left time: 1334.4915s
	iters: 200, epoch: 8 | loss: 0.0542931
	speed: 0.0359s/iter; left time: 741.6323s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0545511 Vali Loss: 0.0605804 Test Loss: 0.0646508
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0521086
	speed: 0.0646s/iter; left time: 1323.9217s
	iters: 200, epoch: 9 | loss: 0.0508420
	speed: 0.0359s/iter; left time: 733.0494s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0530538 Vali Loss: 0.0602055 Test Loss: 0.0638645
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0514139
	speed: 0.0642s/iter; left time: 1301.5575s
	iters: 200, epoch: 10 | loss: 0.0504355
	speed: 0.0359s/iter; left time: 725.1773s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.22s
Steps: 224 | Train Loss: 0.0514094 Vali Loss: 0.0600902 Test Loss: 0.0641634
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0514829
	speed: 0.0643s/iter; left time: 1289.4950s
	iters: 200, epoch: 11 | loss: 0.0480038
	speed: 0.0359s/iter; left time: 717.0131s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0495689 Vali Loss: 0.0604795 Test Loss: 0.0646242
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0494873
	speed: 0.0651s/iter; left time: 1290.5970s
	iters: 200, epoch: 12 | loss: 0.0522452
	speed: 0.0359s/iter; left time: 709.3950s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.0482981 Vali Loss: 0.0608416 Test Loss: 0.0649896
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0501180
	speed: 0.0645s/iter; left time: 1264.9690s
	iters: 200, epoch: 13 | loss: 0.0464822
	speed: 0.0359s/iter; left time: 701.1774s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0469154 Vali Loss: 0.0613119 Test Loss: 0.0653895
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0440466
	speed: 0.0642s/iter; left time: 1244.1057s
	iters: 200, epoch: 14 | loss: 0.0459969
	speed: 0.0359s/iter; left time: 693.4248s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0455683 Vali Loss: 0.0622065 Test Loss: 0.0663249
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0447986
	speed: 0.0646s/iter; left time: 1238.0414s
	iters: 200, epoch: 15 | loss: 0.0417129
	speed: 0.0359s/iter; left time: 685.2435s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0446090 Vali Loss: 0.0615087 Test Loss: 0.0653190
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0440386
	speed: 0.0641s/iter; left time: 1214.3930s
	iters: 200, epoch: 16 | loss: 0.0434168
	speed: 0.0360s/iter; left time: 677.6892s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0435668 Vali Loss: 0.0621748 Test Loss: 0.0657939
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01129954494535923, rmse:0.10629931837320328, mae:0.06357182562351227, rse:0.4016527831554413
Intermediate time for IT and pred_len 24: 00h:05m:45.78s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1180818
	speed: 0.0574s/iter; left time: 1279.1221s
	iters: 200, epoch: 1 | loss: 0.1103663
	speed: 0.0366s/iter; left time: 813.0116s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.63s
Steps: 224 | Train Loss: 0.1280480 Vali Loss: 0.0972716 Test Loss: 0.1011714
Validation loss decreased (inf --> 0.097272).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0873727
	speed: 0.0686s/iter; left time: 1513.8874s
	iters: 200, epoch: 2 | loss: 0.0857097
	speed: 0.0368s/iter; left time: 808.0435s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.44s
Steps: 224 | Train Loss: 0.0902903 Vali Loss: 0.0831149 Test Loss: 0.0876688
Validation loss decreased (0.097272 --> 0.083115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0794181
	speed: 0.0690s/iter; left time: 1508.7720s
	iters: 200, epoch: 3 | loss: 0.0756380
	speed: 0.0368s/iter; left time: 800.1827s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.42s
Steps: 224 | Train Loss: 0.0821665 Vali Loss: 0.0847550 Test Loss: 0.0883440
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0750209
	speed: 0.0669s/iter; left time: 1446.3270s
	iters: 200, epoch: 4 | loss: 0.0730249
	speed: 0.0368s/iter; left time: 792.0964s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.43s
Steps: 224 | Train Loss: 0.0758937 Vali Loss: 0.0868088 Test Loss: 0.0904191
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0682618
	speed: 0.0668s/iter; left time: 1429.8817s
	iters: 200, epoch: 5 | loss: 0.0680185
	speed: 0.0368s/iter; left time: 784.8763s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.44s
Steps: 224 | Train Loss: 0.0687020 Vali Loss: 0.0903399 Test Loss: 0.0927367
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0656408
	speed: 0.0665s/iter; left time: 1409.1179s
	iters: 200, epoch: 6 | loss: 0.0614780
	speed: 0.0368s/iter; left time: 776.3396s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.40s
Steps: 224 | Train Loss: 0.0629035 Vali Loss: 0.0901030 Test Loss: 0.0921895
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0559919
	speed: 0.0661s/iter; left time: 1384.9427s
	iters: 200, epoch: 7 | loss: 0.0587413
	speed: 0.0369s/iter; left time: 768.8951s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.43s
Steps: 224 | Train Loss: 0.0583780 Vali Loss: 0.0886692 Test Loss: 0.0924162
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0570454
	speed: 0.0679s/iter; left time: 1408.4526s
	iters: 200, epoch: 8 | loss: 0.0539678
	speed: 0.0370s/iter; left time: 763.0209s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.54s
Steps: 224 | Train Loss: 0.0551240 Vali Loss: 0.0894667 Test Loss: 0.0931255
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0505419
	speed: 0.0674s/iter; left time: 1381.8556s
	iters: 200, epoch: 9 | loss: 0.0520071
	speed: 0.0369s/iter; left time: 753.4777s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.48s
Steps: 224 | Train Loss: 0.0524755 Vali Loss: 0.0903278 Test Loss: 0.0944549
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0505687
	speed: 0.0671s/iter; left time: 1360.8335s
	iters: 200, epoch: 10 | loss: 0.0517546
	speed: 0.0371s/iter; left time: 748.0968s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.0504133 Vali Loss: 0.0902070 Test Loss: 0.0934657
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0463304
	speed: 0.0685s/iter; left time: 1373.5471s
	iters: 200, epoch: 11 | loss: 0.0481750
	speed: 0.0370s/iter; left time: 738.3868s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0486717 Vali Loss: 0.0904993 Test Loss: 0.0939637
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0463774
	speed: 0.0675s/iter; left time: 1339.3722s
	iters: 200, epoch: 12 | loss: 0.0474607
	speed: 0.0369s/iter; left time: 728.9518s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.46s
Steps: 224 | Train Loss: 0.0471252 Vali Loss: 0.0910608 Test Loss: 0.0948617
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020131800323724747, rmse:0.14188657701015472, mae:0.08766880631446838, rse:0.53648841381073
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1256463
	speed: 0.0384s/iter; left time: 856.6831s
	iters: 200, epoch: 1 | loss: 0.1052881
	speed: 0.0367s/iter; left time: 815.7107s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.43s
Steps: 224 | Train Loss: 0.1278716 Vali Loss: 0.0975274 Test Loss: 0.1013855
Validation loss decreased (inf --> 0.097527).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0898776
	speed: 0.0688s/iter; left time: 1518.3128s
	iters: 200, epoch: 2 | loss: 0.0846708
	speed: 0.0368s/iter; left time: 808.8363s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.45s
Steps: 224 | Train Loss: 0.0900765 Vali Loss: 0.0827733 Test Loss: 0.0864819
Validation loss decreased (0.097527 --> 0.082773).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0843418
	speed: 0.0687s/iter; left time: 1500.7753s
	iters: 200, epoch: 3 | loss: 0.0823889
	speed: 0.0368s/iter; left time: 800.1019s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.45s
Steps: 224 | Train Loss: 0.0828755 Vali Loss: 0.0834564 Test Loss: 0.0877200
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0777797
	speed: 0.0705s/iter; left time: 1523.9760s
	iters: 200, epoch: 4 | loss: 0.0706501
	speed: 0.0370s/iter; left time: 797.4297s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.85s
Steps: 224 | Train Loss: 0.0768709 Vali Loss: 0.0868739 Test Loss: 0.0906810
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0708093
	speed: 0.0681s/iter; left time: 1457.8353s
	iters: 200, epoch: 5 | loss: 0.0678538
	speed: 0.0371s/iter; left time: 790.8826s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0697969 Vali Loss: 0.0891545 Test Loss: 0.0919410
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0616411
	speed: 0.0677s/iter; left time: 1433.3052s
	iters: 200, epoch: 6 | loss: 0.0629382
	speed: 0.0369s/iter; left time: 778.3467s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0640313 Vali Loss: 0.0906997 Test Loss: 0.0921890
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0580571
	speed: 0.0665s/iter; left time: 1393.7763s
	iters: 200, epoch: 7 | loss: 0.0605519
	speed: 0.0367s/iter; left time: 766.1146s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.42s
Steps: 224 | Train Loss: 0.0597989 Vali Loss: 0.0896356 Test Loss: 0.0937857
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0582008
	speed: 0.0670s/iter; left time: 1388.7700s
	iters: 200, epoch: 8 | loss: 0.0563849
	speed: 0.0367s/iter; left time: 758.2309s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.46s
Steps: 224 | Train Loss: 0.0561315 Vali Loss: 0.0901993 Test Loss: 0.0946557
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0535370
	speed: 0.0660s/iter; left time: 1353.2858s
	iters: 200, epoch: 9 | loss: 0.0558761
	speed: 0.0368s/iter; left time: 750.5002s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.42s
Steps: 224 | Train Loss: 0.0534820 Vali Loss: 0.0897326 Test Loss: 0.0943380
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0533520
	speed: 0.0667s/iter; left time: 1353.6920s
	iters: 200, epoch: 10 | loss: 0.0482991
	speed: 0.0368s/iter; left time: 742.1136s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.44s
Steps: 224 | Train Loss: 0.0512064 Vali Loss: 0.0903656 Test Loss: 0.0944686
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0491817
	speed: 0.0659s/iter; left time: 1322.5663s
	iters: 200, epoch: 11 | loss: 0.0494152
	speed: 0.0368s/iter; left time: 733.5859s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.42s
Steps: 224 | Train Loss: 0.0494320 Vali Loss: 0.0907154 Test Loss: 0.0947970
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0473580
	speed: 0.0662s/iter; left time: 1312.3910s
	iters: 200, epoch: 12 | loss: 0.0446241
	speed: 0.0367s/iter; left time: 724.8991s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.43s
Steps: 224 | Train Loss: 0.0478293 Vali Loss: 0.0906139 Test Loss: 0.0938908
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019403032958507538, rmse:0.13929477334022522, mae:0.08648182451725006, rse:0.5266885161399841
Intermediate time for IT and pred_len 96: 00h:04m:20.90s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1194943
	speed: 0.0591s/iter; left time: 1312.5208s
	iters: 200, epoch: 1 | loss: 0.1117269
	speed: 0.0374s/iter; left time: 826.8094s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.77s
Steps: 223 | Train Loss: 0.1296815 Vali Loss: 0.0999045 Test Loss: 0.1030561
Validation loss decreased (inf --> 0.099905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0903515
	speed: 0.0725s/iter; left time: 1592.8490s
	iters: 200, epoch: 2 | loss: 0.0901290
	speed: 0.0375s/iter; left time: 821.5142s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.56s
Steps: 223 | Train Loss: 0.0942760 Vali Loss: 0.0888767 Test Loss: 0.0914357
Validation loss decreased (0.099905 --> 0.088877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0851904
	speed: 0.0699s/iter; left time: 1520.2680s
	iters: 200, epoch: 3 | loss: 0.0789675
	speed: 0.0377s/iter; left time: 816.0897s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.59s
Steps: 223 | Train Loss: 0.0846264 Vali Loss: 0.0911815 Test Loss: 0.0936738
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0756078
	speed: 0.0678s/iter; left time: 1460.1277s
	iters: 200, epoch: 4 | loss: 0.0741057
	speed: 0.0378s/iter; left time: 809.2052s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.60s
Steps: 223 | Train Loss: 0.0768600 Vali Loss: 0.0927026 Test Loss: 0.0952354
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0693325
	speed: 0.0688s/iter; left time: 1465.3695s
	iters: 200, epoch: 5 | loss: 0.0642226
	speed: 0.0377s/iter; left time: 798.5992s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0700902 Vali Loss: 0.0943972 Test Loss: 0.0954034
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0647392
	speed: 0.0683s/iter; left time: 1439.3160s
	iters: 200, epoch: 6 | loss: 0.0619985
	speed: 0.0376s/iter; left time: 789.7055s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.58s
Steps: 223 | Train Loss: 0.0644706 Vali Loss: 0.0946743 Test Loss: 0.0993786
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0612475
	speed: 0.0680s/iter; left time: 1419.1106s
	iters: 200, epoch: 7 | loss: 0.0580873
	speed: 0.0378s/iter; left time: 784.6603s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0603169 Vali Loss: 0.0946172 Test Loss: 0.0987493
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0569166
	speed: 0.0672s/iter; left time: 1388.0249s
	iters: 200, epoch: 8 | loss: 0.0577472
	speed: 0.0377s/iter; left time: 773.7043s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.57s
Steps: 223 | Train Loss: 0.0569918 Vali Loss: 0.0945304 Test Loss: 0.0982869
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0544524
	speed: 0.0673s/iter; left time: 1374.1607s
	iters: 200, epoch: 9 | loss: 0.0511045
	speed: 0.0376s/iter; left time: 764.1016s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.57s
Steps: 223 | Train Loss: 0.0542767 Vali Loss: 0.0959251 Test Loss: 0.0986907
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0505346
	speed: 0.0673s/iter; left time: 1358.4389s
	iters: 200, epoch: 10 | loss: 0.0545269
	speed: 0.0376s/iter; left time: 756.1483s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.56s
Steps: 223 | Train Loss: 0.0521160 Vali Loss: 0.0945153 Test Loss: 0.0979298
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0515054
	speed: 0.0684s/iter; left time: 1366.0656s
	iters: 200, epoch: 11 | loss: 0.0512905
	speed: 0.0379s/iter; left time: 752.6030s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0502686 Vali Loss: 0.0958216 Test Loss: 0.0990741
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0487818
	speed: 0.0681s/iter; left time: 1344.4586s
	iters: 200, epoch: 12 | loss: 0.0481955
	speed: 0.0376s/iter; left time: 737.9726s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0488070 Vali Loss: 0.0953556 Test Loss: 0.0978972
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021009646356105804, rmse:0.14494705200195312, mae:0.09143570065498352, rse:0.5485696792602539
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1242554
	speed: 0.0393s/iter; left time: 873.1691s
	iters: 200, epoch: 1 | loss: 0.1166426
	speed: 0.0376s/iter; left time: 831.0677s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.59s
Steps: 223 | Train Loss: 0.1287281 Vali Loss: 0.0999767 Test Loss: 0.1031075
Validation loss decreased (inf --> 0.099977).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0887699
	speed: 0.0706s/iter; left time: 1551.6125s
	iters: 200, epoch: 2 | loss: 0.0912798
	speed: 0.0375s/iter; left time: 820.0015s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.56s
Steps: 223 | Train Loss: 0.0941755 Vali Loss: 0.0887487 Test Loss: 0.0909008
Validation loss decreased (0.099977 --> 0.088749).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878219
	speed: 0.0741s/iter; left time: 1611.6168s
	iters: 200, epoch: 3 | loss: 0.0840283
	speed: 0.0375s/iter; left time: 812.5734s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.57s
Steps: 223 | Train Loss: 0.0852428 Vali Loss: 0.0924736 Test Loss: 0.0937890
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0784609
	speed: 0.0711s/iter; left time: 1530.5008s
	iters: 200, epoch: 4 | loss: 0.0734981
	speed: 0.0375s/iter; left time: 803.6750s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.88s
Steps: 223 | Train Loss: 0.0778732 Vali Loss: 0.0912675 Test Loss: 0.0966484
EarlyStopping counter: 2 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0702654
	speed: 0.0677s/iter; left time: 1443.0349s
	iters: 200, epoch: 5 | loss: 0.0668117
	speed: 0.0375s/iter; left time: 795.2266s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.54s
Steps: 223 | Train Loss: 0.0706343 Vali Loss: 0.0925609 Test Loss: 0.0974314
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0637424
	speed: 0.0683s/iter; left time: 1440.3680s
	iters: 200, epoch: 6 | loss: 0.0635362
	speed: 0.0379s/iter; left time: 794.3639s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0650790 Vali Loss: 0.0931937 Test Loss: 0.1003401
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0608488
	speed: 0.0693s/iter; left time: 1445.1502s
	iters: 200, epoch: 7 | loss: 0.0590325
	speed: 0.0376s/iter; left time: 781.4713s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.66s
Steps: 223 | Train Loss: 0.0608084 Vali Loss: 0.0933182 Test Loss: 0.1011916
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0578291
	speed: 0.0687s/iter; left time: 1418.9253s
	iters: 200, epoch: 8 | loss: 0.0552961
	speed: 0.0378s/iter; left time: 776.8093s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0574506 Vali Loss: 0.0933886 Test Loss: 0.0999434
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0538509
	speed: 0.0691s/iter; left time: 1410.0640s
	iters: 200, epoch: 9 | loss: 0.0548630
	speed: 0.0377s/iter; left time: 766.4531s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0547139 Vali Loss: 0.0922454 Test Loss: 0.0997348
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0525551
	speed: 0.0686s/iter; left time: 1385.9889s
	iters: 200, epoch: 10 | loss: 0.0524008
	speed: 0.0377s/iter; left time: 757.5124s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.64s
Steps: 223 | Train Loss: 0.0524853 Vali Loss: 0.0936656 Test Loss: 0.0998396
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0513927
	speed: 0.0690s/iter; left time: 1378.4566s
	iters: 200, epoch: 11 | loss: 0.0487567
	speed: 0.0377s/iter; left time: 750.1254s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.63s
Steps: 223 | Train Loss: 0.0506239 Vali Loss: 0.0929566 Test Loss: 0.0990574
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0499611
	speed: 0.0688s/iter; left time: 1358.6525s
	iters: 200, epoch: 12 | loss: 0.0484135
	speed: 0.0377s/iter; left time: 740.4441s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0490678 Vali Loss: 0.0927358 Test Loss: 0.0978173
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020765271037817, rmse:0.1441016048192978, mae:0.09090081602334976, rse:0.5453699827194214
Intermediate time for IT and pred_len 168: 00h:04m:27.46sIntermediate time for IT: 00h:14m:34.15sTotal time: 03h:10m:30.21s