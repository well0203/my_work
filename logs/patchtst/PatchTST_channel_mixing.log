
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1288347
	speed: 0.0621s/iter; left time: 271.8497s
	iters: 200, epoch: 1 | loss: 0.1153558
	speed: 0.0434s/iter; left time: 185.6252s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.19s
Steps: 224 | Train Loss: 0.1386400 Vali Loss: 0.1264737 Test Loss: 0.1306201
Validation loss decreased (inf --> 0.126474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0790193
	speed: 0.0814s/iter; left time: 338.4901s
	iters: 200, epoch: 2 | loss: 0.0790826
	speed: 0.0434s/iter; left time: 176.1489s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0848311 Vali Loss: 0.0908782 Test Loss: 0.0928910
Validation loss decreased (0.126474 --> 0.090878).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0733861
	speed: 0.0806s/iter; left time: 317.1256s
	iters: 200, epoch: 3 | loss: 0.0763236
	speed: 0.0433s/iter; left time: 166.1340s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0745720 Vali Loss: 0.0889853 Test Loss: 0.0914121
Validation loss decreased (0.090878 --> 0.088985).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0697485
	speed: 0.0788s/iter; left time: 292.3043s
	iters: 200, epoch: 4 | loss: 0.0646489
	speed: 0.0434s/iter; left time: 156.7062s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0712106 Vali Loss: 0.0887275 Test Loss: 0.0919944
Validation loss decreased (0.088985 --> 0.088728).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0703026
	speed: 0.0788s/iter; left time: 274.5695s
	iters: 200, epoch: 5 | loss: 0.0676346
	speed: 0.0435s/iter; left time: 147.3651s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0672696 Vali Loss: 0.0913164 Test Loss: 0.0948952
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0655603
	speed: 0.0766s/iter; left time: 249.7891s
	iters: 200, epoch: 6 | loss: 0.0588298
	speed: 0.0435s/iter; left time: 137.4521s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0624329 Vali Loss: 0.0931622 Test Loss: 0.0983253
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0566716
	speed: 0.0771s/iter; left time: 234.2919s
	iters: 200, epoch: 7 | loss: 0.0535484
	speed: 0.0436s/iter; left time: 127.9451s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0572146 Vali Loss: 0.0963221 Test Loss: 0.1005249
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0505644
	speed: 0.0771s/iter; left time: 216.7448s
	iters: 200, epoch: 8 | loss: 0.0515958
	speed: 0.0436s/iter; left time: 118.1570s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0530652 Vali Loss: 0.0984603 Test Loss: 0.1033134
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0509193
	speed: 0.0771s/iter; left time: 199.6553s
	iters: 200, epoch: 9 | loss: 0.0492906
	speed: 0.0436s/iter; left time: 108.5508s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0496132 Vali Loss: 0.0986490 Test Loss: 0.1038890
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021372228860855103, rmse:0.14619243144989014, mae:0.09199438244104385, rse:0.5159333348274231
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1415286
	speed: 0.0455s/iter; left time: 199.4477s
	iters: 200, epoch: 1 | loss: 0.1177186
	speed: 0.0435s/iter; left time: 186.1703s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.1398765 Vali Loss: 0.1292176 Test Loss: 0.1340619
Validation loss decreased (inf --> 0.129218).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0836441
	speed: 0.0835s/iter; left time: 347.2026s
	iters: 200, epoch: 2 | loss: 0.0809262
	speed: 0.0435s/iter; left time: 176.6243s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.46s
Steps: 224 | Train Loss: 0.0844209 Vali Loss: 0.0905276 Test Loss: 0.0925714
Validation loss decreased (0.129218 --> 0.090528).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0768631
	speed: 0.0790s/iter; left time: 310.6964s
	iters: 200, epoch: 3 | loss: 0.0733880
	speed: 0.0436s/iter; left time: 167.2196s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0744031 Vali Loss: 0.0889989 Test Loss: 0.0919095
Validation loss decreased (0.090528 --> 0.088999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0692604
	speed: 0.0788s/iter; left time: 292.2920s
	iters: 200, epoch: 4 | loss: 0.0709451
	speed: 0.0436s/iter; left time: 157.3043s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0706481 Vali Loss: 0.0892855 Test Loss: 0.0918443
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0620473
	speed: 0.0770s/iter; left time: 268.2856s
	iters: 200, epoch: 5 | loss: 0.0703997
	speed: 0.0436s/iter; left time: 147.6873s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0662776 Vali Loss: 0.0921095 Test Loss: 0.0963930
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0618102
	speed: 0.0768s/iter; left time: 250.5855s
	iters: 200, epoch: 6 | loss: 0.0612112
	speed: 0.0435s/iter; left time: 137.4300s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0609258 Vali Loss: 0.0947462 Test Loss: 0.0991559
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0528752
	speed: 0.0777s/iter; left time: 236.0680s
	iters: 200, epoch: 7 | loss: 0.0571331
	speed: 0.0435s/iter; left time: 127.8819s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0557489 Vali Loss: 0.0972916 Test Loss: 0.1027085
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0492335
	speed: 0.0782s/iter; left time: 219.8889s
	iters: 200, epoch: 8 | loss: 0.0513884
	speed: 0.0436s/iter; left time: 118.3938s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.01s
Steps: 224 | Train Loss: 0.0512173 Vali Loss: 0.0977964 Test Loss: 0.1046530
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02161523513495922, rmse:0.14702120423316956, mae:0.0919095128774643, rse:0.5188581943511963
Intermediate time for DE and pred_len 24: 00h:03m:37.99s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1431927
	speed: 0.0619s/iter; left time: 271.3939s
	iters: 200, epoch: 1 | loss: 0.1289140
	speed: 0.0437s/iter; left time: 186.9391s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.24s
Steps: 224 | Train Loss: 0.1487396 Vali Loss: 0.1405490 Test Loss: 0.1488965
Validation loss decreased (inf --> 0.140549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1077801
	speed: 0.0797s/iter; left time: 331.2474s
	iters: 200, epoch: 2 | loss: 0.0963636
	speed: 0.0437s/iter; left time: 177.2322s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.1068755 Vali Loss: 0.1224208 Test Loss: 0.1325869
Validation loss decreased (0.140549 --> 0.122421).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0926780
	speed: 0.0803s/iter; left time: 315.7715s
	iters: 200, epoch: 3 | loss: 0.0843681
	speed: 0.0437s/iter; left time: 167.6494s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.02s
Steps: 224 | Train Loss: 0.0893946 Vali Loss: 0.1247966 Test Loss: 0.1377297
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0736906
	speed: 0.0782s/iter; left time: 289.9745s
	iters: 200, epoch: 4 | loss: 0.0699906
	speed: 0.0438s/iter; left time: 157.9067s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.02s
Steps: 224 | Train Loss: 0.0746758 Vali Loss: 0.1276431 Test Loss: 0.1399731
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0639692
	speed: 0.0775s/iter; left time: 270.0486s
	iters: 200, epoch: 5 | loss: 0.0590412
	speed: 0.0438s/iter; left time: 148.2406s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0646408 Vali Loss: 0.1299467 Test Loss: 0.1427322
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0569997
	speed: 0.0782s/iter; left time: 255.0126s
	iters: 200, epoch: 6 | loss: 0.0539131
	speed: 0.0439s/iter; left time: 138.7934s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0580533 Vali Loss: 0.1302402 Test Loss: 0.1435865
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0529144
	speed: 0.0785s/iter; left time: 238.5008s
	iters: 200, epoch: 7 | loss: 0.0503044
	speed: 0.0440s/iter; left time: 129.0835s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.06s
Steps: 224 | Train Loss: 0.0534348 Vali Loss: 0.1301299 Test Loss: 0.1424773
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04040202498435974, rmse:0.2010025531053543, mae:0.13258694112300873, rse:0.7117906808853149
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1446730
	speed: 0.0495s/iter; left time: 216.8344s
	iters: 200, epoch: 1 | loss: 0.1379150
	speed: 0.0437s/iter; left time: 187.1147s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.41s
Steps: 224 | Train Loss: 0.1482707 Vali Loss: 0.1405652 Test Loss: 0.1491016
Validation loss decreased (inf --> 0.140565).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1060695
	speed: 0.0804s/iter; left time: 334.4022s
	iters: 200, epoch: 2 | loss: 0.0933992
	speed: 0.0439s/iter; left time: 178.1298s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.1067035 Vali Loss: 0.1217589 Test Loss: 0.1363821
Validation loss decreased (0.140565 --> 0.121759).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0944410
	speed: 0.0800s/iter; left time: 314.5728s
	iters: 200, epoch: 3 | loss: 0.0786479
	speed: 0.0437s/iter; left time: 167.6827s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.01s
Steps: 224 | Train Loss: 0.0873720 Vali Loss: 0.1261233 Test Loss: 0.1370733
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0743208
	speed: 0.0786s/iter; left time: 291.3874s
	iters: 200, epoch: 4 | loss: 0.0682476
	speed: 0.0438s/iter; left time: 157.9232s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.02s
Steps: 224 | Train Loss: 0.0722580 Vali Loss: 0.1309307 Test Loss: 0.1429823
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0630023
	speed: 0.0780s/iter; left time: 271.8135s
	iters: 200, epoch: 5 | loss: 0.0619667
	speed: 0.0437s/iter; left time: 147.8217s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0632695 Vali Loss: 0.1294827 Test Loss: 0.1430689
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0583094
	speed: 0.0784s/iter; left time: 255.6968s
	iters: 200, epoch: 6 | loss: 0.0569461
	speed: 0.0437s/iter; left time: 138.1916s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0574156 Vali Loss: 0.1289199 Test Loss: 0.1438109
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0540976
	speed: 0.0786s/iter; left time: 238.7198s
	iters: 200, epoch: 7 | loss: 0.0510037
	speed: 0.0437s/iter; left time: 128.2366s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.00s
Steps: 224 | Train Loss: 0.0531317 Vali Loss: 0.1288909 Test Loss: 0.1443605
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.043257858604192734, rmse:0.20798523724079132, mae:0.1363820880651474, rse:0.7365177869796753
Intermediate time for DE and pred_len 96: 00h:03m:02.45s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1518797
	speed: 0.0609s/iter; left time: 265.7029s
	iters: 200, epoch: 1 | loss: 0.1341218
	speed: 0.0438s/iter; left time: 186.6036s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.20s
Steps: 223 | Train Loss: 0.1515815 Vali Loss: 0.1431780 Test Loss: 0.1525715
Validation loss decreased (inf --> 0.143178).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1105171
	speed: 0.0810s/iter; left time: 335.2319s
	iters: 200, epoch: 2 | loss: 0.1020385
	speed: 0.0439s/iter; left time: 177.4592s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.04s
Steps: 223 | Train Loss: 0.1109439 Vali Loss: 0.1256638 Test Loss: 0.1443070
Validation loss decreased (0.143178 --> 0.125664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0909588
	speed: 0.0809s/iter; left time: 316.8799s
	iters: 200, epoch: 3 | loss: 0.0823636
	speed: 0.0439s/iter; left time: 167.6564s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.03s
Steps: 223 | Train Loss: 0.0895617 Vali Loss: 0.1273583 Test Loss: 0.1470855
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0744034
	speed: 0.0785s/iter; left time: 289.7581s
	iters: 200, epoch: 4 | loss: 0.0707802
	speed: 0.0440s/iter; left time: 157.8830s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.03s
Steps: 223 | Train Loss: 0.0744996 Vali Loss: 0.1302383 Test Loss: 0.1442910
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0646706
	speed: 0.0779s/iter; left time: 270.2656s
	iters: 200, epoch: 5 | loss: 0.0608316
	speed: 0.0441s/iter; left time: 148.4205s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.98s
Steps: 223 | Train Loss: 0.0651669 Vali Loss: 0.1310407 Test Loss: 0.1438465
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0574107
	speed: 0.0790s/iter; left time: 256.3127s
	iters: 200, epoch: 6 | loss: 0.0584476
	speed: 0.0440s/iter; left time: 138.2686s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.04s
Steps: 223 | Train Loss: 0.0592617 Vali Loss: 0.1324312 Test Loss: 0.1442218
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0558157
	speed: 0.0785s/iter; left time: 237.2210s
	iters: 200, epoch: 7 | loss: 0.0557166
	speed: 0.0440s/iter; left time: 128.6178s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.08s
Steps: 223 | Train Loss: 0.0549841 Vali Loss: 0.1323213 Test Loss: 0.1434522
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04741961508989334, rmse:0.21776045858860016, mae:0.14430703222751617, rse:0.7713250517845154
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1513522
	speed: 0.0464s/iter; left time: 202.2887s
	iters: 200, epoch: 1 | loss: 0.1385211
	speed: 0.0439s/iter; left time: 187.1144s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.08s
Steps: 223 | Train Loss: 0.1521855 Vali Loss: 0.1438601 Test Loss: 0.1531233
Validation loss decreased (inf --> 0.143860).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1064229
	speed: 0.0815s/iter; left time: 337.4412s
	iters: 200, epoch: 2 | loss: 0.1020931
	speed: 0.0440s/iter; left time: 177.7232s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.06s
Steps: 223 | Train Loss: 0.1112131 Vali Loss: 0.1247842 Test Loss: 0.1412956
Validation loss decreased (0.143860 --> 0.124784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0937691
	speed: 0.0820s/iter; left time: 321.1670s
	iters: 200, epoch: 3 | loss: 0.0833023
	speed: 0.0439s/iter; left time: 167.6558s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.06s
Steps: 223 | Train Loss: 0.0891496 Vali Loss: 0.1302273 Test Loss: 0.1467150
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0755298
	speed: 0.0787s/iter; left time: 290.5388s
	iters: 200, epoch: 4 | loss: 0.0678074
	speed: 0.0440s/iter; left time: 158.0234s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.00s
Steps: 223 | Train Loss: 0.0731834 Vali Loss: 0.1329896 Test Loss: 0.1487310
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0666101
	speed: 0.0788s/iter; left time: 273.4192s
	iters: 200, epoch: 5 | loss: 0.0610430
	speed: 0.0440s/iter; left time: 148.1712s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.04s
Steps: 223 | Train Loss: 0.0643469 Vali Loss: 0.1333733 Test Loss: 0.1499041
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0585870
	speed: 0.0789s/iter; left time: 256.0959s
	iters: 200, epoch: 6 | loss: 0.0568665
	speed: 0.0440s/iter; left time: 138.2920s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.01s
Steps: 223 | Train Loss: 0.0583537 Vali Loss: 0.1314956 Test Loss: 0.1464267
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0525444
	speed: 0.0790s/iter; left time: 238.9590s
	iters: 200, epoch: 7 | loss: 0.0518316
	speed: 0.0439s/iter; left time: 128.4102s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.00s
Steps: 223 | Train Loss: 0.0540509 Vali Loss: 0.1317015 Test Loss: 0.1481518
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04486357793211937, rmse:0.21181024610996246, mae:0.14129573106765747, rse:0.7502489686012268
Intermediate time for DE and pred_len 168: 00h:03m:04.36sIntermediate time for DE: 00h:09m:44.80s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1249031
	speed: 0.0601s/iter; left time: 263.2734s
	iters: 200, epoch: 1 | loss: 0.1127680
	speed: 0.0432s/iter; left time: 184.7438s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.1274041 Vali Loss: 0.1188559 Test Loss: 0.1365499
Validation loss decreased (inf --> 0.118856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0752068
	speed: 0.0804s/iter; left time: 334.0770s
	iters: 200, epoch: 2 | loss: 0.0756959
	speed: 0.0433s/iter; left time: 175.6379s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.0829447 Vali Loss: 0.0909307 Test Loss: 0.1030746
Validation loss decreased (0.118856 --> 0.090931).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0754961
	speed: 0.0784s/iter; left time: 308.3153s
	iters: 200, epoch: 3 | loss: 0.0801942
	speed: 0.0433s/iter; left time: 166.1181s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0758008 Vali Loss: 0.0894891 Test Loss: 0.1017765
Validation loss decreased (0.090931 --> 0.089489).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0749308
	speed: 0.0787s/iter; left time: 291.7423s
	iters: 200, epoch: 4 | loss: 0.0664703
	speed: 0.0433s/iter; left time: 156.4066s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0732703 Vali Loss: 0.0913262 Test Loss: 0.1023002
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0723235
	speed: 0.0758s/iter; left time: 264.2858s
	iters: 200, epoch: 5 | loss: 0.0701183
	speed: 0.0433s/iter; left time: 146.7170s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.87s
Steps: 224 | Train Loss: 0.0703901 Vali Loss: 0.0899382 Test Loss: 0.1038470
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0694546
	speed: 0.0756s/iter; left time: 246.6922s
	iters: 200, epoch: 6 | loss: 0.0659585
	speed: 0.0433s/iter; left time: 136.9890s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.86s
Steps: 224 | Train Loss: 0.0664127 Vali Loss: 0.0935771 Test Loss: 0.1056621
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0577669
	speed: 0.0760s/iter; left time: 230.8019s
	iters: 200, epoch: 7 | loss: 0.0580327
	speed: 0.0434s/iter; left time: 127.3561s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.87s
Steps: 224 | Train Loss: 0.0617652 Vali Loss: 0.0964528 Test Loss: 0.1120393
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0580244
	speed: 0.0781s/iter; left time: 219.7505s
	iters: 200, epoch: 8 | loss: 0.0549745
	speed: 0.0434s/iter; left time: 117.6108s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.02s
Steps: 224 | Train Loss: 0.0575566 Vali Loss: 0.0996388 Test Loss: 0.1158492
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025332890450954437, rmse:0.15916308760643005, mae:0.10177655518054962, rse:0.5490675568580627
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1193750
	speed: 0.0450s/iter; left time: 197.2874s
	iters: 200, epoch: 1 | loss: 0.1060155
	speed: 0.0434s/iter; left time: 185.6362s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.1250374 Vali Loss: 0.1174057 Test Loss: 0.1348697
Validation loss decreased (inf --> 0.117406).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0799368
	speed: 0.0782s/iter; left time: 325.0579s
	iters: 200, epoch: 2 | loss: 0.0795878
	speed: 0.0434s/iter; left time: 176.0104s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0825805 Vali Loss: 0.0911475 Test Loss: 0.1029994
Validation loss decreased (0.117406 --> 0.091147).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0756929
	speed: 0.0784s/iter; left time: 308.3488s
	iters: 200, epoch: 3 | loss: 0.0774784
	speed: 0.0434s/iter; left time: 166.2460s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0757685 Vali Loss: 0.0891861 Test Loss: 0.1012558
Validation loss decreased (0.091147 --> 0.089186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0707852
	speed: 0.0825s/iter; left time: 306.1245s
	iters: 200, epoch: 4 | loss: 0.0715328
	speed: 0.0434s/iter; left time: 156.7667s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0732520 Vali Loss: 0.0898914 Test Loss: 0.1021442
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0689220
	speed: 0.0771s/iter; left time: 268.8159s
	iters: 200, epoch: 5 | loss: 0.0702394
	speed: 0.0435s/iter; left time: 147.3373s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0703283 Vali Loss: 0.0914296 Test Loss: 0.1033106
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0662516
	speed: 0.0764s/iter; left time: 249.0542s
	iters: 200, epoch: 6 | loss: 0.0679668
	speed: 0.0434s/iter; left time: 137.2747s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.0663290 Vali Loss: 0.0943815 Test Loss: 0.1062462
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0596283
	speed: 0.0761s/iter; left time: 231.1431s
	iters: 200, epoch: 7 | loss: 0.0606526
	speed: 0.0434s/iter; left time: 127.5465s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.0616254 Vali Loss: 0.0968927 Test Loss: 0.1100579
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0565274
	speed: 0.0763s/iter; left time: 214.5441s
	iters: 200, epoch: 8 | loss: 0.0578602
	speed: 0.0434s/iter; left time: 117.8077s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.0571208 Vali Loss: 0.1001299 Test Loss: 0.1126765
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02496434934437275, rmse:0.158001109957695, mae:0.10125575959682465, rse:0.5450590252876282
Intermediate time for GB and pred_len 24: 00h:03m:23.45s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1300309
	speed: 0.0619s/iter; left time: 271.1114s
	iters: 200, epoch: 1 | loss: 0.1175259
	speed: 0.0437s/iter; left time: 187.1140s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.26s
Steps: 224 | Train Loss: 0.1356121 Vali Loss: 0.1320696 Test Loss: 0.1547136
Validation loss decreased (inf --> 0.132070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1107192
	speed: 0.0793s/iter; left time: 329.5753s
	iters: 200, epoch: 2 | loss: 0.0974107
	speed: 0.0437s/iter; left time: 177.3589s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.1059472 Vali Loss: 0.1207289 Test Loss: 0.1423227
Validation loss decreased (0.132070 --> 0.120729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0921785
	speed: 0.0789s/iter; left time: 310.4888s
	iters: 200, epoch: 3 | loss: 0.0906572
	speed: 0.0436s/iter; left time: 167.2451s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0932772 Vali Loss: 0.1250454 Test Loss: 0.1396944
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0780643
	speed: 0.0772s/iter; left time: 286.1969s
	iters: 200, epoch: 4 | loss: 0.0736055
	speed: 0.0436s/iter; left time: 157.3211s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0790285 Vali Loss: 0.1302246 Test Loss: 0.1424275
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0678155
	speed: 0.0771s/iter; left time: 268.8162s
	iters: 200, epoch: 5 | loss: 0.0652552
	speed: 0.0435s/iter; left time: 147.3382s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.0684898 Vali Loss: 0.1330113 Test Loss: 0.1475625
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0595127
	speed: 0.0765s/iter; left time: 249.4589s
	iters: 200, epoch: 6 | loss: 0.0599183
	speed: 0.0436s/iter; left time: 137.7668s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0620094 Vali Loss: 0.1328093 Test Loss: 0.1456130
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590672
	speed: 0.0760s/iter; left time: 230.7722s
	iters: 200, epoch: 7 | loss: 0.0578840
	speed: 0.0436s/iter; left time: 128.0159s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.0574334 Vali Loss: 0.1333681 Test Loss: 0.1477004
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04291878640651703, rmse:0.20716850459575653, mae:0.14232265949249268, rse:0.7164175510406494
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1369909
	speed: 0.0452s/iter; left time: 198.1251s
	iters: 200, epoch: 1 | loss: 0.1235660
	speed: 0.0436s/iter; left time: 186.5363s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.1355126 Vali Loss: 0.1321635 Test Loss: 0.1548172
Validation loss decreased (inf --> 0.132164).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1024315
	speed: 0.0822s/iter; left time: 341.8837s
	iters: 200, epoch: 2 | loss: 0.0971463
	speed: 0.0436s/iter; left time: 176.7127s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.1058134 Vali Loss: 0.1206499 Test Loss: 0.1399352
Validation loss decreased (0.132164 --> 0.120650).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0939326
	speed: 0.0953s/iter; left time: 374.8068s
	iters: 200, epoch: 3 | loss: 0.0851375
	speed: 0.0436s/iter; left time: 166.9955s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0934879 Vali Loss: 0.1276292 Test Loss: 0.1426655
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0788433
	speed: 0.0770s/iter; left time: 285.4099s
	iters: 200, epoch: 4 | loss: 0.0714974
	speed: 0.0435s/iter; left time: 157.1195s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0783464 Vali Loss: 0.1301064 Test Loss: 0.1484889
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0670597
	speed: 0.0768s/iter; left time: 267.4897s
	iters: 200, epoch: 5 | loss: 0.0632937
	speed: 0.1556s/iter; left time: 526.6978s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:21.12s
Steps: 224 | Train Loss: 0.0674435 Vali Loss: 0.1301742 Test Loss: 0.1560793
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0597854
	speed: 0.0763s/iter; left time: 248.9769s
	iters: 200, epoch: 6 | loss: 0.0592995
	speed: 0.0435s/iter; left time: 137.4173s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.90s
Steps: 224 | Train Loss: 0.0609915 Vali Loss: 0.1312574 Test Loss: 0.1548149
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0571895
	speed: 0.0767s/iter; left time: 233.0420s
	iters: 200, epoch: 7 | loss: 0.0534755
	speed: 0.0437s/iter; left time: 128.4914s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0563500 Vali Loss: 0.1323618 Test Loss: 0.1562927
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.042682863771915436, rmse:0.20659831166267395, mae:0.1399351954460144, rse:0.7144457697868347
Intermediate time for GB and pred_len 96: 00h:03m:13.08s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1341277
	speed: 0.0614s/iter; left time: 267.8026s
	iters: 200, epoch: 1 | loss: 0.1240424
	speed: 0.0436s/iter; left time: 185.8316s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.22s
Steps: 223 | Train Loss: 0.1377349 Vali Loss: 0.1347460 Test Loss: 0.1585737
Validation loss decreased (inf --> 0.134746).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1115550
	speed: 0.0794s/iter; left time: 328.6687s
	iters: 200, epoch: 2 | loss: 0.1019396
	speed: 0.0439s/iter; left time: 177.0813s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.96s
Steps: 223 | Train Loss: 0.1095999 Vali Loss: 0.1251576 Test Loss: 0.1528900
Validation loss decreased (0.134746 --> 0.125158).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0949040
	speed: 0.0798s/iter; left time: 312.4155s
	iters: 200, epoch: 3 | loss: 0.0896047
	speed: 0.0439s/iter; left time: 167.4243s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.98s
Steps: 223 | Train Loss: 0.0943391 Vali Loss: 0.1325155 Test Loss: 0.1532334
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0794888
	speed: 0.0785s/iter; left time: 289.9586s
	iters: 200, epoch: 4 | loss: 0.0751732
	speed: 0.0439s/iter; left time: 157.7071s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.97s
Steps: 223 | Train Loss: 0.0793516 Vali Loss: 0.1352002 Test Loss: 0.1513123
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0718923
	speed: 0.0780s/iter; left time: 270.5778s
	iters: 200, epoch: 5 | loss: 0.0654820
	speed: 0.0440s/iter; left time: 148.1064s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.99s
Steps: 223 | Train Loss: 0.0696418 Vali Loss: 0.1345929 Test Loss: 0.1558284
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0637268
	speed: 0.0777s/iter; left time: 252.2374s
	iters: 200, epoch: 6 | loss: 0.0619536
	speed: 0.0440s/iter; left time: 138.4949s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.98s
Steps: 223 | Train Loss: 0.0636521 Vali Loss: 0.1361301 Test Loss: 0.1573202
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0584776
	speed: 0.0777s/iter; left time: 234.7740s
	iters: 200, epoch: 7 | loss: 0.0590519
	speed: 0.0440s/iter; left time: 128.6523s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.00s
Steps: 223 | Train Loss: 0.0592529 Vali Loss: 0.1356159 Test Loss: 0.1559382
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.052469152957201004, rmse:0.22906145453453064, mae:0.15288984775543213, rse:0.7941889762878418
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1340767
	speed: 0.0507s/iter; left time: 221.1755s
	iters: 200, epoch: 1 | loss: 0.1268893
	speed: 0.0439s/iter; left time: 187.0287s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.52s
Steps: 223 | Train Loss: 0.1382299 Vali Loss: 0.1351098 Test Loss: 0.1589990
Validation loss decreased (inf --> 0.135110).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1089100
	speed: 0.0820s/iter; left time: 339.4382s
	iters: 200, epoch: 2 | loss: 0.1047608
	speed: 0.0439s/iter; left time: 177.4687s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.06s
Steps: 223 | Train Loss: 0.1098012 Vali Loss: 0.1272498 Test Loss: 0.1492751
Validation loss decreased (0.135110 --> 0.127250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0957372
	speed: 0.0820s/iter; left time: 321.1154s
	iters: 200, epoch: 3 | loss: 0.0877633
	speed: 0.0440s/iter; left time: 167.8560s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.05s
Steps: 223 | Train Loss: 0.0951678 Vali Loss: 0.1317861 Test Loss: 0.1500311
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0815844
	speed: 0.0793s/iter; left time: 292.7075s
	iters: 200, epoch: 4 | loss: 0.0720776
	speed: 0.0440s/iter; left time: 157.9639s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.05s
Steps: 223 | Train Loss: 0.0793402 Vali Loss: 0.1376163 Test Loss: 0.1564661
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0674153
	speed: 0.0795s/iter; left time: 275.6132s
	iters: 200, epoch: 5 | loss: 0.0677345
	speed: 0.0440s/iter; left time: 148.2083s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.07s
Steps: 223 | Train Loss: 0.0688048 Vali Loss: 0.1402889 Test Loss: 0.1571947
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0602527
	speed: 0.0797s/iter; left time: 258.7197s
	iters: 200, epoch: 6 | loss: 0.0598245
	speed: 0.0441s/iter; left time: 138.6358s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.06s
Steps: 223 | Train Loss: 0.0624292 Vali Loss: 0.1399303 Test Loss: 0.1577230
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0568240
	speed: 0.0793s/iter; left time: 239.7509s
	iters: 200, epoch: 7 | loss: 0.0553108
	speed: 0.0441s/iter; left time: 128.8550s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.07s
Steps: 223 | Train Loss: 0.0579504 Vali Loss: 0.1376240 Test Loss: 0.1562205
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.047632455825805664, rmse:0.21824860572814941, mae:0.1492750644683838, rse:0.75669926404953
Intermediate time for GB and pred_len 168: 00h:03m:05.15sIntermediate time for GB: 00h:09m:41.67s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1197053
	speed: 0.0389s/iter; left time: 170.4659s
	iters: 200, epoch: 1 | loss: 0.1074361
	speed: 0.0220s/iter; left time: 94.1392s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.40s
Steps: 224 | Train Loss: 0.1288011 Vali Loss: 0.0958644 Test Loss: 0.1084929
Validation loss decreased (inf --> 0.095864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0743673
	speed: 0.0438s/iter; left time: 181.9416s
	iters: 200, epoch: 2 | loss: 0.0671951
	speed: 0.0220s/iter; left time: 89.3475s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0732195 Vali Loss: 0.0619111 Test Loss: 0.0689737
Validation loss decreased (0.095864 --> 0.061911).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0636132
	speed: 0.0443s/iter; left time: 174.4196s
	iters: 200, epoch: 3 | loss: 0.0605463
	speed: 0.0220s/iter; left time: 84.3799s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0620891 Vali Loss: 0.0585566 Test Loss: 0.0651297
Validation loss decreased (0.061911 --> 0.058557).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0559345
	speed: 0.0444s/iter; left time: 164.5139s
	iters: 200, epoch: 4 | loss: 0.0574044
	speed: 0.0220s/iter; left time: 79.4318s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0591701 Vali Loss: 0.0568301 Test Loss: 0.0641761
Validation loss decreased (0.058557 --> 0.056830).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0585900
	speed: 0.0441s/iter; left time: 153.7485s
	iters: 200, epoch: 5 | loss: 0.0586798
	speed: 0.0220s/iter; left time: 74.5159s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0574670 Vali Loss: 0.0560226 Test Loss: 0.0631666
Validation loss decreased (0.056830 --> 0.056023).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0571813
	speed: 0.0442s/iter; left time: 143.9950s
	iters: 200, epoch: 6 | loss: 0.0582810
	speed: 0.0220s/iter; left time: 69.6702s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0561205 Vali Loss: 0.0555882 Test Loss: 0.0626708
Validation loss decreased (0.056023 --> 0.055588).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0552973
	speed: 0.0447s/iter; left time: 135.8377s
	iters: 200, epoch: 7 | loss: 0.0541853
	speed: 0.0221s/iter; left time: 64.7821s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0551273 Vali Loss: 0.0547986 Test Loss: 0.0620969
Validation loss decreased (0.055588 --> 0.054799).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0540874
	speed: 0.0443s/iter; left time: 124.6580s
	iters: 200, epoch: 8 | loss: 0.0545249
	speed: 0.0221s/iter; left time: 59.8506s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0540969 Vali Loss: 0.0546852 Test Loss: 0.0622704
Validation loss decreased (0.054799 --> 0.054685).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0535808
	speed: 0.0438s/iter; left time: 113.4066s
	iters: 200, epoch: 9 | loss: 0.0510668
	speed: 0.0220s/iter; left time: 54.8654s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0533764 Vali Loss: 0.0539643 Test Loss: 0.0610771
Validation loss decreased (0.054685 --> 0.053964).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0544953
	speed: 0.0444s/iter; left time: 105.0310s
	iters: 200, epoch: 10 | loss: 0.0548255
	speed: 0.0220s/iter; left time: 49.8875s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0525270 Vali Loss: 0.0542821 Test Loss: 0.0614841
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0498544
	speed: 0.0431s/iter; left time: 92.3523s
	iters: 200, epoch: 11 | loss: 0.0507155
	speed: 0.0220s/iter; left time: 44.9447s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0518580 Vali Loss: 0.0541489 Test Loss: 0.0618145
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0490863
	speed: 0.0439s/iter; left time: 84.2093s
	iters: 200, epoch: 12 | loss: 0.0500919
	speed: 0.0221s/iter; left time: 40.1086s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0512090 Vali Loss: 0.0545745 Test Loss: 0.0619080
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0565618
	speed: 0.0441s/iter; left time: 74.6360s
	iters: 200, epoch: 13 | loss: 0.0477618
	speed: 0.0221s/iter; left time: 35.1439s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0505550 Vali Loss: 0.0545160 Test Loss: 0.0619966
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0485411
	speed: 0.0446s/iter; left time: 65.5215s
	iters: 200, epoch: 14 | loss: 0.0494428
	speed: 0.0221s/iter; left time: 30.2196s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0499811 Vali Loss: 0.0538818 Test Loss: 0.0613545
Validation loss decreased (0.053964 --> 0.053882).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0486182
	speed: 0.0441s/iter; left time: 54.9210s
	iters: 200, epoch: 15 | loss: 0.0522056
	speed: 0.0220s/iter; left time: 25.2280s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0493475 Vali Loss: 0.0540712 Test Loss: 0.0617006
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0517759
	speed: 0.0428s/iter; left time: 43.6968s
	iters: 200, epoch: 16 | loss: 0.0503656
	speed: 0.0220s/iter; left time: 20.2887s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0488575 Vali Loss: 0.0544644 Test Loss: 0.0622188
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0497399
	speed: 0.0442s/iter; left time: 35.2565s
	iters: 200, epoch: 17 | loss: 0.0500861
	speed: 0.0221s/iter; left time: 15.3767s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0484129 Vali Loss: 0.0545549 Test Loss: 0.0625807
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0462332
	speed: 0.0443s/iter; left time: 25.4011s
	iters: 200, epoch: 18 | loss: 0.0489886
	speed: 0.0221s/iter; left time: 10.4513s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0480003 Vali Loss: 0.0545118 Test Loss: 0.0624015
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0488784
	speed: 0.0429s/iter; left time: 14.9608s
	iters: 200, epoch: 19 | loss: 0.0505258
	speed: 0.0220s/iter; left time: 5.4845s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0475646 Vali Loss: 0.0548550 Test Loss: 0.0625891
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.00992313027381897, rmse:0.09961491078138351, mae:0.06135452166199684, rse:0.29315462708473206
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1214782
	speed: 0.0264s/iter; left time: 115.7879s
	iters: 200, epoch: 1 | loss: 0.1079467
	speed: 0.0220s/iter; left time: 94.2519s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.1318527 Vali Loss: 0.0977142 Test Loss: 0.1096083
Validation loss decreased (inf --> 0.097714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0695145
	speed: 0.0431s/iter; left time: 179.1939s
	iters: 200, epoch: 2 | loss: 0.0641104
	speed: 0.0221s/iter; left time: 89.4813s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0732974 Vali Loss: 0.0619658 Test Loss: 0.0686749
Validation loss decreased (0.097714 --> 0.061966).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0587519
	speed: 0.0433s/iter; left time: 170.3049s
	iters: 200, epoch: 3 | loss: 0.0618919
	speed: 0.0220s/iter; left time: 84.4202s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0621301 Vali Loss: 0.0587658 Test Loss: 0.0654708
Validation loss decreased (0.061966 --> 0.058766).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0594057
	speed: 0.0432s/iter; left time: 160.3581s
	iters: 200, epoch: 4 | loss: 0.0569952
	speed: 0.0220s/iter; left time: 79.5211s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0592448 Vali Loss: 0.0570653 Test Loss: 0.0638682
Validation loss decreased (0.058766 --> 0.057065).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0583459
	speed: 0.0432s/iter; left time: 150.4146s
	iters: 200, epoch: 5 | loss: 0.0606583
	speed: 0.0220s/iter; left time: 74.4017s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0573962 Vali Loss: 0.0562197 Test Loss: 0.0633890
Validation loss decreased (0.057065 --> 0.056220).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0551197
	speed: 0.0432s/iter; left time: 140.8077s
	iters: 200, epoch: 6 | loss: 0.0542481
	speed: 0.0221s/iter; left time: 69.7244s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0560827 Vali Loss: 0.0551677 Test Loss: 0.0620240
Validation loss decreased (0.056220 --> 0.055168).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0546338
	speed: 0.0433s/iter; left time: 131.3840s
	iters: 200, epoch: 7 | loss: 0.0557244
	speed: 0.0220s/iter; left time: 64.6994s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0550370 Vali Loss: 0.0549158 Test Loss: 0.0618460
Validation loss decreased (0.055168 --> 0.054916).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0533591
	speed: 0.0432s/iter; left time: 121.5712s
	iters: 200, epoch: 8 | loss: 0.0514893
	speed: 0.0221s/iter; left time: 59.8454s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0541582 Vali Loss: 0.0542985 Test Loss: 0.0613999
Validation loss decreased (0.054916 --> 0.054299).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0519505
	speed: 0.0448s/iter; left time: 116.0249s
	iters: 200, epoch: 9 | loss: 0.0505060
	speed: 0.0221s/iter; left time: 54.9988s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0532708 Vali Loss: 0.0543194 Test Loss: 0.0613890
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0501624
	speed: 0.0442s/iter; left time: 104.6277s
	iters: 200, epoch: 10 | loss: 0.0489627
	speed: 0.0220s/iter; left time: 49.9245s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0524889 Vali Loss: 0.0542982 Test Loss: 0.0611642
Validation loss decreased (0.054299 --> 0.054298).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0491599
	speed: 0.0436s/iter; left time: 93.2524s
	iters: 200, epoch: 11 | loss: 0.0504890
	speed: 0.0220s/iter; left time: 44.9858s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0518310 Vali Loss: 0.0544719 Test Loss: 0.0615248
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0504733
	speed: 0.0420s/iter; left time: 80.4454s
	iters: 200, epoch: 12 | loss: 0.0517810
	speed: 0.0220s/iter; left time: 39.9925s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0511032 Vali Loss: 0.0544304 Test Loss: 0.0618145
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0491990
	speed: 0.0424s/iter; left time: 71.7644s
	iters: 200, epoch: 13 | loss: 0.0494348
	speed: 0.0221s/iter; left time: 35.1302s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0505439 Vali Loss: 0.0546408 Test Loss: 0.0613864
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0487825
	speed: 0.0423s/iter; left time: 62.0977s
	iters: 200, epoch: 14 | loss: 0.0486977
	speed: 0.0220s/iter; left time: 30.1287s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0499626 Vali Loss: 0.0548986 Test Loss: 0.0617785
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0492183
	speed: 0.0421s/iter; left time: 52.4408s
	iters: 200, epoch: 15 | loss: 0.0466172
	speed: 0.0221s/iter; left time: 25.2651s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0494497 Vali Loss: 0.0548974 Test Loss: 0.0618186
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009944847784936428, rmse:0.09972386062145233, mae:0.061164192855358124, rse:0.29347527027130127
Intermediate time for ES and pred_len 24: 00h:03m:51.96s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1327750
	speed: 0.0392s/iter; left time: 171.5321s
	iters: 200, epoch: 1 | loss: 0.1151738
	speed: 0.0222s/iter; left time: 94.9131s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.42s
Steps: 224 | Train Loss: 0.1380184 Vali Loss: 0.1075002 Test Loss: 0.1211424
Validation loss decreased (inf --> 0.107500).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0898748
	speed: 0.0455s/iter; left time: 189.0479s
	iters: 200, epoch: 2 | loss: 0.0794849
	speed: 0.0221s/iter; left time: 89.6602s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0905244 Vali Loss: 0.0823172 Test Loss: 0.0928391
Validation loss decreased (0.107500 --> 0.082317).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804560
	speed: 0.0464s/iter; left time: 182.6691s
	iters: 200, epoch: 3 | loss: 0.0776050
	speed: 0.0222s/iter; left time: 85.0640s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0808929 Vali Loss: 0.0794616 Test Loss: 0.0906161
Validation loss decreased (0.082317 --> 0.079462).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0755306
	speed: 0.0460s/iter; left time: 170.4463s
	iters: 200, epoch: 4 | loss: 0.0755394
	speed: 0.0222s/iter; left time: 80.1607s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0769380 Vali Loss: 0.0798931 Test Loss: 0.0919429
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0722298
	speed: 0.0439s/iter; left time: 153.0381s
	iters: 200, epoch: 5 | loss: 0.0743159
	speed: 0.0222s/iter; left time: 75.2787s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0732500 Vali Loss: 0.0803050 Test Loss: 0.0922237
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0681314
	speed: 0.0445s/iter; left time: 145.0482s
	iters: 200, epoch: 6 | loss: 0.0714724
	speed: 0.0222s/iter; left time: 70.1803s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0696609 Vali Loss: 0.0804545 Test Loss: 0.0929369
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0662445
	speed: 0.0446s/iter; left time: 135.3941s
	iters: 200, epoch: 7 | loss: 0.0645176
	speed: 0.0222s/iter; left time: 65.3211s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0663182 Vali Loss: 0.0819036 Test Loss: 0.0936721
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0646453
	speed: 0.0446s/iter; left time: 125.4376s
	iters: 200, epoch: 8 | loss: 0.0620963
	speed: 0.0222s/iter; left time: 60.1617s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0630618 Vali Loss: 0.0830514 Test Loss: 0.0945923
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019271597266197205, rmse:0.13882218301296234, mae:0.09061609208583832, rse:0.4078177809715271
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1359011
	speed: 0.0239s/iter; left time: 104.8345s
	iters: 200, epoch: 1 | loss: 0.1179544
	speed: 0.0222s/iter; left time: 95.1545s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.1384543 Vali Loss: 0.1076759 Test Loss: 0.1211382
Validation loss decreased (inf --> 0.107676).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0889097
	speed: 0.0449s/iter; left time: 186.7324s
	iters: 200, epoch: 2 | loss: 0.0868934
	speed: 0.0222s/iter; left time: 90.2563s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0903999 Vali Loss: 0.0819206 Test Loss: 0.0922778
Validation loss decreased (0.107676 --> 0.081921).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0819837
	speed: 0.0461s/iter; left time: 181.4797s
	iters: 200, epoch: 3 | loss: 0.0790465
	speed: 0.0222s/iter; left time: 85.1549s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0806006 Vali Loss: 0.0789759 Test Loss: 0.0910454
Validation loss decreased (0.081921 --> 0.078976).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0802818
	speed: 0.0450s/iter; left time: 167.0762s
	iters: 200, epoch: 4 | loss: 0.0744955
	speed: 0.0223s/iter; left time: 80.4399s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0764292 Vali Loss: 0.0790067 Test Loss: 0.0904807
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0730120
	speed: 0.0473s/iter; left time: 164.8390s
	iters: 200, epoch: 5 | loss: 0.0737626
	speed: 0.0223s/iter; left time: 75.4142s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0720678 Vali Loss: 0.0799713 Test Loss: 0.0924472
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0680700
	speed: 0.0442s/iter; left time: 144.1804s
	iters: 200, epoch: 6 | loss: 0.0682947
	speed: 0.0223s/iter; left time: 70.3853s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0677571 Vali Loss: 0.0811187 Test Loss: 0.0937446
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0656267
	speed: 0.0441s/iter; left time: 134.0765s
	iters: 200, epoch: 7 | loss: 0.0630400
	speed: 0.0223s/iter; left time: 65.5494s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0640458 Vali Loss: 0.0827304 Test Loss: 0.0952476
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0612878
	speed: 0.0439s/iter; left time: 123.4383s
	iters: 200, epoch: 8 | loss: 0.0583994
	speed: 0.0223s/iter; left time: 60.4557s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0610601 Vali Loss: 0.0839228 Test Loss: 0.0960289
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019083218649029732, rmse:0.13814201951026917, mae:0.09104538708925247, rse:0.40581971406936646
Intermediate time for ES and pred_len 96: 00h:01m:56.88s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1385189
	speed: 0.0407s/iter; left time: 177.6641s
	iters: 200, epoch: 1 | loss: 0.1222085
	speed: 0.0226s/iter; left time: 96.4847s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.51s
Steps: 223 | Train Loss: 0.1415203 Vali Loss: 0.1107488 Test Loss: 0.1235423
Validation loss decreased (inf --> 0.110749).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0943981
	speed: 0.0462s/iter; left time: 191.3232s
	iters: 200, epoch: 2 | loss: 0.0923413
	speed: 0.0226s/iter; left time: 91.2606s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.27s
Steps: 223 | Train Loss: 0.0948072 Vali Loss: 0.0882457 Test Loss: 0.0986240
Validation loss decreased (0.110749 --> 0.088246).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0849652
	speed: 0.0468s/iter; left time: 183.2532s
	iters: 200, epoch: 3 | loss: 0.0840910
	speed: 0.0226s/iter; left time: 86.0284s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.27s
Steps: 223 | Train Loss: 0.0844714 Vali Loss: 0.0858070 Test Loss: 0.0971049
Validation loss decreased (0.088246 --> 0.085807).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0787158
	speed: 0.0466s/iter; left time: 171.8860s
	iters: 200, epoch: 4 | loss: 0.0773474
	speed: 0.0226s/iter; left time: 81.0493s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.31s
Steps: 223 | Train Loss: 0.0792804 Vali Loss: 0.0866306 Test Loss: 0.0979837
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0746874
	speed: 0.0449s/iter; left time: 155.7042s
	iters: 200, epoch: 5 | loss: 0.0745576
	speed: 0.0224s/iter; left time: 75.3864s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0749708 Vali Loss: 0.0876147 Test Loss: 0.0982907
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0734099
	speed: 0.0442s/iter; left time: 143.3839s
	iters: 200, epoch: 6 | loss: 0.0726197
	speed: 0.0224s/iter; left time: 70.4080s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0713834 Vali Loss: 0.0886993 Test Loss: 0.0983842
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0680743
	speed: 0.0443s/iter; left time: 133.8580s
	iters: 200, epoch: 7 | loss: 0.0658535
	speed: 0.0223s/iter; left time: 65.2824s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0679162 Vali Loss: 0.0891556 Test Loss: 0.0995721
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0637082
	speed: 0.0452s/iter; left time: 126.6094s
	iters: 200, epoch: 8 | loss: 0.0638428
	speed: 0.0223s/iter; left time: 60.1778s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0645114 Vali Loss: 0.0891259 Test Loss: 0.1003027
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02172878384590149, rmse:0.14740686118602753, mae:0.09710493683815002, rse:0.4330681264400482
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1338054
	speed: 0.0246s/iter; left time: 107.0937s
	iters: 200, epoch: 1 | loss: 0.1172974
	speed: 0.0226s/iter; left time: 96.2575s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.26s
Steps: 223 | Train Loss: 0.1397129 Vali Loss: 0.1100905 Test Loss: 0.1230639
Validation loss decreased (inf --> 0.110091).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0909255
	speed: 0.0458s/iter; left time: 189.6162s
	iters: 200, epoch: 2 | loss: 0.0843903
	speed: 0.0224s/iter; left time: 90.3887s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0946380 Vali Loss: 0.0877320 Test Loss: 0.0977113
Validation loss decreased (0.110091 --> 0.087732).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0839579
	speed: 0.0458s/iter; left time: 179.1708s
	iters: 200, epoch: 3 | loss: 0.0794685
	speed: 0.0223s/iter; left time: 85.2236s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0840396 Vali Loss: 0.0863901 Test Loss: 0.0984656
Validation loss decreased (0.087732 --> 0.086390).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0788893
	speed: 0.0458s/iter; left time: 169.1486s
	iters: 200, epoch: 4 | loss: 0.0761613
	speed: 0.0224s/iter; left time: 80.5832s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0789190 Vali Loss: 0.0869178 Test Loss: 0.0986370
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0742886
	speed: 0.0478s/iter; left time: 165.6836s
	iters: 200, epoch: 5 | loss: 0.0743236
	speed: 0.0223s/iter; left time: 75.0649s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0746482 Vali Loss: 0.0868706 Test Loss: 0.0991525
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0722558
	speed: 0.0442s/iter; left time: 143.5750s
	iters: 200, epoch: 6 | loss: 0.0707610
	speed: 0.0223s/iter; left time: 70.2806s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0706094 Vali Loss: 0.0871155 Test Loss: 0.1002640
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0670408
	speed: 0.0439s/iter; left time: 132.6848s
	iters: 200, epoch: 7 | loss: 0.0647997
	speed: 0.0224s/iter; left time: 65.4284s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0668925 Vali Loss: 0.0879370 Test Loss: 0.1000142
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0650123
	speed: 0.0447s/iter; left time: 125.0898s
	iters: 200, epoch: 8 | loss: 0.0613846
	speed: 0.0224s/iter; left time: 60.5054s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0635497 Vali Loss: 0.0889210 Test Loss: 0.1020326
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021894296631217003, rmse:0.14796721935272217, mae:0.09846556931734085, rse:0.43471434712409973
Intermediate time for ES and pred_len 168: 00h:01m:58.41sIntermediate time for ES: 00h:07m:47.25s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0911608
	speed: 0.0395s/iter; left time: 173.2211s
	iters: 200, epoch: 1 | loss: 0.0807561
	speed: 0.0220s/iter; left time: 93.9694s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.40s
Steps: 224 | Train Loss: 0.0953799 Vali Loss: 0.0820948 Test Loss: 0.0894879
Validation loss decreased (inf --> 0.082095).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0561930
	speed: 0.0444s/iter; left time: 184.7348s
	iters: 200, epoch: 2 | loss: 0.0492035
	speed: 0.0220s/iter; left time: 89.2163s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0542452 Vali Loss: 0.0557568 Test Loss: 0.0594116
Validation loss decreased (0.082095 --> 0.055757).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0486324
	speed: 0.0473s/iter; left time: 185.8351s
	iters: 200, epoch: 3 | loss: 0.0475799
	speed: 0.0220s/iter; left time: 84.3679s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0461456 Vali Loss: 0.0538717 Test Loss: 0.0575684
Validation loss decreased (0.055757 --> 0.053872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0437132
	speed: 0.0439s/iter; left time: 162.6741s
	iters: 200, epoch: 4 | loss: 0.0451161
	speed: 0.0220s/iter; left time: 79.4364s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0440538 Vali Loss: 0.0533928 Test Loss: 0.0573033
Validation loss decreased (0.053872 --> 0.053393).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0390914
	speed: 0.0439s/iter; left time: 152.9549s
	iters: 200, epoch: 5 | loss: 0.0422770
	speed: 0.0220s/iter; left time: 74.5831s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0426606 Vali Loss: 0.0522712 Test Loss: 0.0566506
Validation loss decreased (0.053393 --> 0.052271).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0419594
	speed: 0.0464s/iter; left time: 151.1885s
	iters: 200, epoch: 6 | loss: 0.0421335
	speed: 0.0220s/iter; left time: 69.6026s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0415427 Vali Loss: 0.0521313 Test Loss: 0.0565895
Validation loss decreased (0.052271 --> 0.052131).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0394318
	speed: 0.0437s/iter; left time: 132.7002s
	iters: 200, epoch: 7 | loss: 0.0366648
	speed: 0.0220s/iter; left time: 64.6926s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0405039 Vali Loss: 0.0522789 Test Loss: 0.0569994
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0414733
	speed: 0.0435s/iter; left time: 122.3514s
	iters: 200, epoch: 8 | loss: 0.0397425
	speed: 0.0220s/iter; left time: 59.7665s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0396449 Vali Loss: 0.0521628 Test Loss: 0.0571179
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0387222
	speed: 0.0429s/iter; left time: 111.0310s
	iters: 200, epoch: 9 | loss: 0.0377659
	speed: 0.0220s/iter; left time: 54.7764s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0387779 Vali Loss: 0.0524518 Test Loss: 0.0580054
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0399559
	speed: 0.0440s/iter; left time: 103.9845s
	iters: 200, epoch: 10 | loss: 0.0383337
	speed: 0.0221s/iter; left time: 50.0940s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0379001 Vali Loss: 0.0528825 Test Loss: 0.0582209
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0369181
	speed: 0.0455s/iter; left time: 97.4036s
	iters: 200, epoch: 11 | loss: 0.0370933
	speed: 0.0222s/iter; left time: 45.3939s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0371930 Vali Loss: 0.0523042 Test Loss: 0.0584522
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01019241288304329, rmse:0.1009574830532074, mae:0.056589506566524506, rse:0.38949114084243774
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0983568
	speed: 0.0247s/iter; left time: 108.3098s
	iters: 200, epoch: 1 | loss: 0.0811648
	speed: 0.0220s/iter; left time: 94.3844s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0986384 Vali Loss: 0.0830617 Test Loss: 0.0900622
Validation loss decreased (inf --> 0.083062).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0534172
	speed: 0.0459s/iter; left time: 190.8347s
	iters: 200, epoch: 2 | loss: 0.0459291
	speed: 0.0220s/iter; left time: 89.4148s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0541714 Vali Loss: 0.0558285 Test Loss: 0.0595404
Validation loss decreased (0.083062 --> 0.055828).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0488589
	speed: 0.0455s/iter; left time: 179.1443s
	iters: 200, epoch: 3 | loss: 0.0440432
	speed: 0.0220s/iter; left time: 84.2449s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0462337 Vali Loss: 0.0534941 Test Loss: 0.0573518
Validation loss decreased (0.055828 --> 0.053494).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0463716
	speed: 0.0472s/iter; left time: 175.1546s
	iters: 200, epoch: 4 | loss: 0.0456805
	speed: 0.0220s/iter; left time: 79.4920s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0441008 Vali Loss: 0.0527866 Test Loss: 0.0569766
Validation loss decreased (0.053494 --> 0.052787).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0462096
	speed: 0.0456s/iter; left time: 158.7527s
	iters: 200, epoch: 5 | loss: 0.0410608
	speed: 0.0220s/iter; left time: 74.5178s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0427795 Vali Loss: 0.0525542 Test Loss: 0.0569405
Validation loss decreased (0.052787 --> 0.052554).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0407355
	speed: 0.0498s/iter; left time: 162.4428s
	iters: 200, epoch: 6 | loss: 0.0419847
	speed: 0.0221s/iter; left time: 70.0070s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0416694 Vali Loss: 0.0518883 Test Loss: 0.0565364
Validation loss decreased (0.052554 --> 0.051888).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0414056
	speed: 0.0486s/iter; left time: 147.6256s
	iters: 200, epoch: 7 | loss: 0.0415133
	speed: 0.0221s/iter; left time: 64.8389s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0407206 Vali Loss: 0.0519327 Test Loss: 0.0568358
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0397163
	speed: 0.0451s/iter; left time: 126.8378s
	iters: 200, epoch: 8 | loss: 0.0388439
	speed: 0.0221s/iter; left time: 60.0393s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0398980 Vali Loss: 0.0518868 Test Loss: 0.0571416
Validation loss decreased (0.051888 --> 0.051887).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0371764
	speed: 0.0451s/iter; left time: 116.6879s
	iters: 200, epoch: 9 | loss: 0.0366343
	speed: 0.0220s/iter; left time: 54.8135s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0390674 Vali Loss: 0.0520276 Test Loss: 0.0576413
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0378093
	speed: 0.0440s/iter; left time: 103.9488s
	iters: 200, epoch: 10 | loss: 0.0378744
	speed: 0.0220s/iter; left time: 49.8707s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0382958 Vali Loss: 0.0521671 Test Loss: 0.0580638
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0378447
	speed: 0.0425s/iter; left time: 90.9655s
	iters: 200, epoch: 11 | loss: 0.0375221
	speed: 0.0220s/iter; left time: 44.9680s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0375433 Vali Loss: 0.0524383 Test Loss: 0.0580152
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0369047
	speed: 0.0426s/iter; left time: 81.6378s
	iters: 200, epoch: 12 | loss: 0.0374718
	speed: 0.0220s/iter; left time: 40.0212s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0368759 Vali Loss: 0.0522108 Test Loss: 0.0584778
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0371997
	speed: 0.0426s/iter; left time: 72.0876s
	iters: 200, epoch: 13 | loss: 0.0384833
	speed: 0.0220s/iter; left time: 35.0443s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0362783 Vali Loss: 0.0522735 Test Loss: 0.0587735
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010431569069623947, rmse:0.1021350547671318, mae:0.057141587138175964, rse:0.394034206867218
Intermediate time for FR and pred_len 24: 00h:02m:50.16s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1006848
	speed: 0.0397s/iter; left time: 174.0005s
	iters: 200, epoch: 1 | loss: 0.0841898
	speed: 0.0221s/iter; left time: 94.7290s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.1028407 Vali Loss: 0.0909074 Test Loss: 0.1000355
Validation loss decreased (inf --> 0.090907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0667737
	speed: 0.0449s/iter; left time: 186.6393s
	iters: 200, epoch: 2 | loss: 0.0597491
	speed: 0.0222s/iter; left time: 90.1540s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0683883 Vali Loss: 0.0734551 Test Loss: 0.0820000
Validation loss decreased (0.090907 --> 0.073455).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0597644
	speed: 0.0536s/iter; left time: 210.6612s
	iters: 200, epoch: 3 | loss: 0.0573469
	speed: 0.0222s/iter; left time: 85.1685s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0604713 Vali Loss: 0.0728116 Test Loss: 0.0829389
Validation loss decreased (0.073455 --> 0.072812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0543406
	speed: 0.0467s/iter; left time: 173.1935s
	iters: 200, epoch: 4 | loss: 0.0559489
	speed: 0.0222s/iter; left time: 80.1385s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0555894 Vali Loss: 0.0726943 Test Loss: 0.0856126
Validation loss decreased (0.072812 --> 0.072694).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0521473
	speed: 0.0458s/iter; left time: 159.5019s
	iters: 200, epoch: 5 | loss: 0.0497508
	speed: 0.0222s/iter; left time: 75.2614s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0508938 Vali Loss: 0.0734280 Test Loss: 0.0868193
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0467287
	speed: 0.0453s/iter; left time: 147.8227s
	iters: 200, epoch: 6 | loss: 0.0474530
	speed: 0.0222s/iter; left time: 70.2187s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0473731 Vali Loss: 0.0740491 Test Loss: 0.0903171
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0445259
	speed: 0.0460s/iter; left time: 139.7311s
	iters: 200, epoch: 7 | loss: 0.0429022
	speed: 0.0222s/iter; left time: 65.0619s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.0449064 Vali Loss: 0.0749877 Test Loss: 0.0900412
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0447864
	speed: 0.0459s/iter; left time: 129.0161s
	iters: 200, epoch: 8 | loss: 0.0412697
	speed: 0.0223s/iter; left time: 60.5712s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0427259 Vali Loss: 0.0744871 Test Loss: 0.0900806
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0412090
	speed: 0.0458s/iter; left time: 118.6480s
	iters: 200, epoch: 9 | loss: 0.0411860
	speed: 0.0225s/iter; left time: 55.9844s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0410810 Vali Loss: 0.0739628 Test Loss: 0.0906877
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.022053049877285957, rmse:0.14850269258022308, mae:0.08561256527900696, rse:0.5744478702545166
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1005642
	speed: 0.0244s/iter; left time: 106.7894s
	iters: 200, epoch: 1 | loss: 0.0917427
	speed: 0.0221s/iter; left time: 94.7198s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.1031050 Vali Loss: 0.0911626 Test Loss: 0.1002582
Validation loss decreased (inf --> 0.091163).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0699997
	speed: 0.0464s/iter; left time: 192.8545s
	iters: 200, epoch: 2 | loss: 0.0637312
	speed: 0.0222s/iter; left time: 90.1859s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0683236 Vali Loss: 0.0735162 Test Loss: 0.0822804
Validation loss decreased (0.091163 --> 0.073516).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0605401
	speed: 0.0471s/iter; left time: 185.0752s
	iters: 200, epoch: 3 | loss: 0.0607821
	speed: 0.0223s/iter; left time: 85.4301s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0604257 Vali Loss: 0.0721129 Test Loss: 0.0824257
Validation loss decreased (0.073516 --> 0.072113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0555506
	speed: 0.0492s/iter; left time: 182.4720s
	iters: 200, epoch: 4 | loss: 0.0568947
	speed: 0.0222s/iter; left time: 80.2771s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0552945 Vali Loss: 0.0730396 Test Loss: 0.0871446
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0492285
	speed: 0.0458s/iter; left time: 159.7724s
	iters: 200, epoch: 5 | loss: 0.0476777
	speed: 0.0223s/iter; left time: 75.4708s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0505104 Vali Loss: 0.0731663 Test Loss: 0.0874221
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0488765
	speed: 0.0447s/iter; left time: 145.7902s
	iters: 200, epoch: 6 | loss: 0.0477134
	speed: 0.0222s/iter; left time: 70.0617s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0469335 Vali Loss: 0.0743040 Test Loss: 0.0891248
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0456722
	speed: 0.0447s/iter; left time: 135.6284s
	iters: 200, epoch: 7 | loss: 0.0439361
	speed: 0.0224s/iter; left time: 65.7936s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0442663 Vali Loss: 0.0741631 Test Loss: 0.0898651
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0420532
	speed: 0.0447s/iter; left time: 125.8808s
	iters: 200, epoch: 8 | loss: 0.0395115
	speed: 0.0224s/iter; left time: 60.7868s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0422339 Vali Loss: 0.0745660 Test Loss: 0.0915339
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019726678729057312, rmse:0.14045169949531555, mae:0.08242567628622055, rse:0.543304443359375
Intermediate time for FR and pred_len 96: 00h:02m:06.23s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1056457
	speed: 0.0398s/iter; left time: 173.6812s
	iters: 200, epoch: 1 | loss: 0.0920094
	speed: 0.0224s/iter; left time: 95.5007s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.48s
Steps: 223 | Train Loss: 0.1057240 Vali Loss: 0.0936650 Test Loss: 0.1019153
Validation loss decreased (inf --> 0.093665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0718475
	speed: 0.0447s/iter; left time: 185.1133s
	iters: 200, epoch: 2 | loss: 0.0731005
	speed: 0.0224s/iter; left time: 90.4609s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0723086 Vali Loss: 0.0779335 Test Loss: 0.0873305
Validation loss decreased (0.093665 --> 0.077934).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0632716
	speed: 0.0459s/iter; left time: 179.8549s
	iters: 200, epoch: 3 | loss: 0.0641079
	speed: 0.0224s/iter; left time: 85.5754s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0631816 Vali Loss: 0.0758860 Test Loss: 0.0896951
Validation loss decreased (0.077934 --> 0.075886).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0551088
	speed: 0.0459s/iter; left time: 169.5448s
	iters: 200, epoch: 4 | loss: 0.0547754
	speed: 0.0225s/iter; left time: 80.7396s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0568533 Vali Loss: 0.0776557 Test Loss: 0.0928236
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0526990
	speed: 0.0449s/iter; left time: 155.9181s
	iters: 200, epoch: 5 | loss: 0.0493257
	speed: 0.0224s/iter; left time: 75.5719s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0520216 Vali Loss: 0.0776104 Test Loss: 0.0933026
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0494825
	speed: 0.0439s/iter; left time: 142.5911s
	iters: 200, epoch: 6 | loss: 0.0487090
	speed: 0.0225s/iter; left time: 70.6925s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0485547 Vali Loss: 0.0779353 Test Loss: 0.0935854
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0466170
	speed: 0.0443s/iter; left time: 133.9005s
	iters: 200, epoch: 7 | loss: 0.0462868
	speed: 0.0224s/iter; left time: 65.4560s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0459587 Vali Loss: 0.0782540 Test Loss: 0.0941730
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0445945
	speed: 0.0442s/iter; left time: 123.8177s
	iters: 200, epoch: 8 | loss: 0.0431015
	speed: 0.0225s/iter; left time: 60.7504s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0438796 Vali Loss: 0.0789876 Test Loss: 0.0948573
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021620899438858032, rmse:0.1470404714345932, mae:0.08969511091709137, rse:0.5695016980171204
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0991714
	speed: 0.0242s/iter; left time: 105.4279s
	iters: 200, epoch: 1 | loss: 0.0885712
	speed: 0.0224s/iter; left time: 95.4951s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.1043165 Vali Loss: 0.0933984 Test Loss: 0.1014372
Validation loss decreased (inf --> 0.093398).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0710609
	speed: 0.0452s/iter; left time: 187.1805s
	iters: 200, epoch: 2 | loss: 0.0618889
	speed: 0.0225s/iter; left time: 90.6977s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0721745 Vali Loss: 0.0774508 Test Loss: 0.0867138
Validation loss decreased (0.093398 --> 0.077451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0610502
	speed: 0.0455s/iter; left time: 178.2605s
	iters: 200, epoch: 3 | loss: 0.0590557
	speed: 0.0225s/iter; left time: 85.7997s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0635017 Vali Loss: 0.0759463 Test Loss: 0.0875126
Validation loss decreased (0.077451 --> 0.075946).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0575557
	speed: 0.0448s/iter; left time: 165.3782s
	iters: 200, epoch: 4 | loss: 0.0550404
	speed: 0.0224s/iter; left time: 80.4820s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0579271 Vali Loss: 0.0790097 Test Loss: 0.0919720
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0552282
	speed: 0.0460s/iter; left time: 159.5844s
	iters: 200, epoch: 5 | loss: 0.0517130
	speed: 0.0225s/iter; left time: 75.8489s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0529827 Vali Loss: 0.0791752 Test Loss: 0.0956786
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0491072
	speed: 0.0445s/iter; left time: 144.5271s
	iters: 200, epoch: 6 | loss: 0.0490277
	speed: 0.0225s/iter; left time: 70.7079s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0493609 Vali Loss: 0.0793608 Test Loss: 0.0970479
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0464880
	speed: 0.0440s/iter; left time: 132.9713s
	iters: 200, epoch: 7 | loss: 0.0456919
	speed: 0.0224s/iter; left time: 65.5195s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0465144 Vali Loss: 0.0802678 Test Loss: 0.0969906
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0447792
	speed: 0.0438s/iter; left time: 122.5531s
	iters: 200, epoch: 8 | loss: 0.0422901
	speed: 0.0225s/iter; left time: 60.7378s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0443371 Vali Loss: 0.0795111 Test Loss: 0.0977988
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02099021151661873, rmse:0.1448799967765808, mae:0.08751260489225388, rse:0.5611339211463928
Intermediate time for FR and pred_len 168: 00h:01m:56.97sIntermediate time for FR: 00h:06m:53.36s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1278432
	speed: 0.0403s/iter; left time: 176.4808s
	iters: 200, epoch: 1 | loss: 0.1199756
	speed: 0.0221s/iter; left time: 94.6191s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.45s
Steps: 224 | Train Loss: 0.1362877 Vali Loss: 0.0958211 Test Loss: 0.0981545
Validation loss decreased (inf --> 0.095821).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0730210
	speed: 0.0448s/iter; left time: 186.1073s
	iters: 200, epoch: 2 | loss: 0.0685680
	speed: 0.0221s/iter; left time: 89.8356s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0737874 Vali Loss: 0.0606424 Test Loss: 0.0634204
Validation loss decreased (0.095821 --> 0.060642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0679964
	speed: 0.0455s/iter; left time: 179.1425s
	iters: 200, epoch: 3 | loss: 0.0627244
	speed: 0.0221s/iter; left time: 84.5310s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0626436 Vali Loss: 0.0585590 Test Loss: 0.0609500
Validation loss decreased (0.060642 --> 0.058559).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0576157
	speed: 0.0441s/iter; left time: 163.6331s
	iters: 200, epoch: 4 | loss: 0.0638441
	speed: 0.0221s/iter; left time: 79.7639s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0600721 Vali Loss: 0.0572869 Test Loss: 0.0595370
Validation loss decreased (0.058559 --> 0.057287).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0601263
	speed: 0.0447s/iter; left time: 155.6338s
	iters: 200, epoch: 5 | loss: 0.0590720
	speed: 0.0222s/iter; left time: 75.0241s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0583885 Vali Loss: 0.0561951 Test Loss: 0.0586180
Validation loss decreased (0.057287 --> 0.056195).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0568630
	speed: 0.0444s/iter; left time: 144.7807s
	iters: 200, epoch: 6 | loss: 0.0588873
	speed: 0.0221s/iter; left time: 69.9577s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0571105 Vali Loss: 0.0560492 Test Loss: 0.0585387
Validation loss decreased (0.056195 --> 0.056049).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0534128
	speed: 0.0449s/iter; left time: 136.3684s
	iters: 200, epoch: 7 | loss: 0.0566401
	speed: 0.0221s/iter; left time: 65.0176s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0559917 Vali Loss: 0.0559686 Test Loss: 0.0586595
Validation loss decreased (0.056049 --> 0.055969).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0540253
	speed: 0.0445s/iter; left time: 125.2643s
	iters: 200, epoch: 8 | loss: 0.0523734
	speed: 0.0221s/iter; left time: 59.8498s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0550626 Vali Loss: 0.0557020 Test Loss: 0.0581373
Validation loss decreased (0.055969 --> 0.055702).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0549227
	speed: 0.0441s/iter; left time: 114.2035s
	iters: 200, epoch: 9 | loss: 0.0555563
	speed: 0.0220s/iter; left time: 54.8628s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0541545 Vali Loss: 0.0554387 Test Loss: 0.0579014
Validation loss decreased (0.055702 --> 0.055439).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0573516
	speed: 0.0443s/iter; left time: 104.8230s
	iters: 200, epoch: 10 | loss: 0.0533080
	speed: 0.0223s/iter; left time: 50.6226s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0534064 Vali Loss: 0.0554795 Test Loss: 0.0580060
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0537935
	speed: 0.0433s/iter; left time: 92.7225s
	iters: 200, epoch: 11 | loss: 0.0519395
	speed: 0.0221s/iter; left time: 45.1442s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0526716 Vali Loss: 0.0553332 Test Loss: 0.0582383
Validation loss decreased (0.055439 --> 0.055333).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0494004
	speed: 0.0442s/iter; left time: 84.6628s
	iters: 200, epoch: 12 | loss: 0.0503696
	speed: 0.0222s/iter; left time: 40.3168s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0519590 Vali Loss: 0.0552357 Test Loss: 0.0584522
Validation loss decreased (0.055333 --> 0.055236).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0522351
	speed: 0.0446s/iter; left time: 75.5378s
	iters: 200, epoch: 13 | loss: 0.0554844
	speed: 0.0221s/iter; left time: 35.2577s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0512310 Vali Loss: 0.0556980 Test Loss: 0.0582841
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0527922
	speed: 0.0441s/iter; left time: 64.7681s
	iters: 200, epoch: 14 | loss: 0.0496648
	speed: 0.0221s/iter; left time: 30.2930s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0505910 Vali Loss: 0.0554339 Test Loss: 0.0585908
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0505742
	speed: 0.0428s/iter; left time: 53.3226s
	iters: 200, epoch: 15 | loss: 0.0552145
	speed: 0.0221s/iter; left time: 25.3408s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0499754 Vali Loss: 0.0557357 Test Loss: 0.0589469
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0501169
	speed: 0.0435s/iter; left time: 44.3919s
	iters: 200, epoch: 16 | loss: 0.0476602
	speed: 0.0223s/iter; left time: 20.5843s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.0494236 Vali Loss: 0.0556930 Test Loss: 0.0588406
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0540575
	speed: 0.0434s/iter; left time: 34.5807s
	iters: 200, epoch: 17 | loss: 0.0460231
	speed: 0.0221s/iter; left time: 15.4351s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0488599 Vali Loss: 0.0560844 Test Loss: 0.0593362
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010351636447012424, rmse:0.10174299031496048, mae:0.05845222249627113, rse:0.3844366669654846
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1312290
	speed: 0.0239s/iter; left time: 104.5800s
	iters: 200, epoch: 1 | loss: 0.1132838
	speed: 0.0221s/iter; left time: 94.6417s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.1434084 Vali Loss: 0.0982049 Test Loss: 0.1005447
Validation loss decreased (inf --> 0.098205).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0674736
	speed: 0.0449s/iter; left time: 186.7286s
	iters: 200, epoch: 2 | loss: 0.0681145
	speed: 0.0221s/iter; left time: 89.7622s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0744928 Vali Loss: 0.0611276 Test Loss: 0.0633811
Validation loss decreased (0.098205 --> 0.061128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0622577
	speed: 0.0485s/iter; left time: 190.7232s
	iters: 200, epoch: 3 | loss: 0.0642815
	speed: 0.0221s/iter; left time: 84.6926s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0627514 Vali Loss: 0.0584585 Test Loss: 0.0605055
Validation loss decreased (0.061128 --> 0.058458).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0570491
	speed: 0.0435s/iter; left time: 161.3850s
	iters: 200, epoch: 4 | loss: 0.0608197
	speed: 0.0221s/iter; left time: 79.7839s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0602316 Vali Loss: 0.0581894 Test Loss: 0.0604754
Validation loss decreased (0.058458 --> 0.058189).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0571427
	speed: 0.0434s/iter; left time: 151.1813s
	iters: 200, epoch: 5 | loss: 0.0591655
	speed: 0.0221s/iter; left time: 74.7114s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0585666 Vali Loss: 0.0570316 Test Loss: 0.0593375
Validation loss decreased (0.058189 --> 0.057032).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0569229
	speed: 0.0446s/iter; left time: 145.4980s
	iters: 200, epoch: 6 | loss: 0.0601685
	speed: 0.0221s/iter; left time: 69.9418s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0572205 Vali Loss: 0.0561985 Test Loss: 0.0586197
Validation loss decreased (0.057032 --> 0.056198).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0528390
	speed: 0.0443s/iter; left time: 134.6254s
	iters: 200, epoch: 7 | loss: 0.0560399
	speed: 0.0220s/iter; left time: 64.6326s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0561812 Vali Loss: 0.0559815 Test Loss: 0.0584007
Validation loss decreased (0.056198 --> 0.055982).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0566561
	speed: 0.0432s/iter; left time: 121.5715s
	iters: 200, epoch: 8 | loss: 0.0531043
	speed: 0.0220s/iter; left time: 59.6308s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0552645 Vali Loss: 0.0561232 Test Loss: 0.0582675
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0574572
	speed: 0.0422s/iter; left time: 109.1267s
	iters: 200, epoch: 9 | loss: 0.0525047
	speed: 0.0221s/iter; left time: 55.0661s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0542702 Vali Loss: 0.0558798 Test Loss: 0.0580742
Validation loss decreased (0.055982 --> 0.055880).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0514821
	speed: 0.0442s/iter; left time: 104.4473s
	iters: 200, epoch: 10 | loss: 0.0550405
	speed: 0.0222s/iter; left time: 50.3422s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0534769 Vali Loss: 0.0561165 Test Loss: 0.0583153
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0494045
	speed: 0.0429s/iter; left time: 91.7487s
	iters: 200, epoch: 11 | loss: 0.0544998
	speed: 0.0222s/iter; left time: 45.3403s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0527047 Vali Loss: 0.0559758 Test Loss: 0.0582508
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0558888
	speed: 0.0430s/iter; left time: 82.4352s
	iters: 200, epoch: 12 | loss: 0.0501107
	speed: 0.0223s/iter; left time: 40.5813s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0519439 Vali Loss: 0.0558040 Test Loss: 0.0584697
Validation loss decreased (0.055880 --> 0.055804).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0464681
	speed: 0.0440s/iter; left time: 74.4818s
	iters: 200, epoch: 13 | loss: 0.0487312
	speed: 0.0221s/iter; left time: 35.2217s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0512102 Vali Loss: 0.0558723 Test Loss: 0.0584111
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0515612
	speed: 0.0426s/iter; left time: 62.5964s
	iters: 200, epoch: 14 | loss: 0.0508993
	speed: 0.0221s/iter; left time: 30.3189s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0505620 Vali Loss: 0.0561245 Test Loss: 0.0586363
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0493988
	speed: 0.0426s/iter; left time: 53.0185s
	iters: 200, epoch: 15 | loss: 0.0481921
	speed: 0.0222s/iter; left time: 25.3640s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0499058 Vali Loss: 0.0561699 Test Loss: 0.0588772
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0517682
	speed: 0.0428s/iter; left time: 43.7099s
	iters: 200, epoch: 16 | loss: 0.0486397
	speed: 0.0223s/iter; left time: 20.5641s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0493334 Vali Loss: 0.0565590 Test Loss: 0.0592585
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0502274
	speed: 0.0428s/iter; left time: 34.1402s
	iters: 200, epoch: 17 | loss: 0.0491273
	speed: 0.0221s/iter; left time: 15.4122s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0487718 Vali Loss: 0.0566396 Test Loss: 0.0595277
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010335784405469894, rmse:0.10166505724191666, mae:0.05846967175602913, rse:0.3841421902179718
Intermediate time for IT and pred_len 24: 00h:03m:53.46s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1406602
	speed: 0.0396s/iter; left time: 173.4839s
	iters: 200, epoch: 1 | loss: 0.1232709
	speed: 0.0222s/iter; left time: 95.2344s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.49s
Steps: 224 | Train Loss: 0.1463149 Vali Loss: 0.1063972 Test Loss: 0.1096973
Validation loss decreased (inf --> 0.106397).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0882624
	speed: 0.0446s/iter; left time: 185.3561s
	iters: 200, epoch: 2 | loss: 0.0824391
	speed: 0.0223s/iter; left time: 90.2859s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0918562 Vali Loss: 0.0795108 Test Loss: 0.0841194
Validation loss decreased (0.106397 --> 0.079511).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0812526
	speed: 0.0456s/iter; left time: 179.2393s
	iters: 200, epoch: 3 | loss: 0.0784772
	speed: 0.0222s/iter; left time: 85.1000s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0820270 Vali Loss: 0.0783789 Test Loss: 0.0819392
Validation loss decreased (0.079511 --> 0.078379).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0744383
	speed: 0.0454s/iter; left time: 168.5465s
	iters: 200, epoch: 4 | loss: 0.0777021
	speed: 0.0223s/iter; left time: 80.3642s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0783910 Vali Loss: 0.0788257 Test Loss: 0.0830169
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0753594
	speed: 0.0442s/iter; left time: 153.9169s
	iters: 200, epoch: 5 | loss: 0.0750151
	speed: 0.0223s/iter; left time: 75.4471s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0734081 Vali Loss: 0.0819957 Test Loss: 0.0856044
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0659106
	speed: 0.0441s/iter; left time: 143.8063s
	iters: 200, epoch: 6 | loss: 0.0659576
	speed: 0.0222s/iter; left time: 70.1749s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0686825 Vali Loss: 0.0842883 Test Loss: 0.0852429
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0648111
	speed: 0.0444s/iter; left time: 134.8696s
	iters: 200, epoch: 7 | loss: 0.0614157
	speed: 0.0222s/iter; left time: 65.2844s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0650621 Vali Loss: 0.0839392 Test Loss: 0.0866236
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0651447
	speed: 0.0440s/iter; left time: 123.8320s
	iters: 200, epoch: 8 | loss: 0.0613163
	speed: 0.0222s/iter; left time: 60.2727s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0623451 Vali Loss: 0.0845894 Test Loss: 0.0871178
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018120603635907173, rmse:0.1346127986907959, mae:0.08193915337324142, rse:0.5089855194091797
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1431607
	speed: 0.0244s/iter; left time: 106.7205s
	iters: 200, epoch: 1 | loss: 0.1226398
	speed: 0.0223s/iter; left time: 95.3092s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.23s
Steps: 224 | Train Loss: 0.1465745 Vali Loss: 0.1063707 Test Loss: 0.1097031
Validation loss decreased (inf --> 0.106371).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0898145
	speed: 0.0452s/iter; left time: 188.1016s
	iters: 200, epoch: 2 | loss: 0.0898023
	speed: 0.0223s/iter; left time: 90.6002s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0918464 Vali Loss: 0.0796784 Test Loss: 0.0837768
Validation loss decreased (0.106371 --> 0.079678).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0820685
	speed: 0.0451s/iter; left time: 177.2884s
	iters: 200, epoch: 3 | loss: 0.0804370
	speed: 0.0223s/iter; left time: 85.3903s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0818808 Vali Loss: 0.0782289 Test Loss: 0.0822492
Validation loss decreased (0.079678 --> 0.078229).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0801883
	speed: 0.0466s/iter; left time: 172.7831s
	iters: 200, epoch: 4 | loss: 0.0770322
	speed: 0.0222s/iter; left time: 80.2333s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0781260 Vali Loss: 0.0790618 Test Loss: 0.0833921
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0714568
	speed: 0.0439s/iter; left time: 152.9201s
	iters: 200, epoch: 5 | loss: 0.0724024
	speed: 0.0222s/iter; left time: 75.2498s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0734421 Vali Loss: 0.0818351 Test Loss: 0.0865005
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0687422
	speed: 0.0441s/iter; left time: 143.6745s
	iters: 200, epoch: 6 | loss: 0.0683053
	speed: 0.0223s/iter; left time: 70.4044s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0687262 Vali Loss: 0.0829564 Test Loss: 0.0874128
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0646902
	speed: 0.0443s/iter; left time: 134.5349s
	iters: 200, epoch: 7 | loss: 0.0637687
	speed: 0.0223s/iter; left time: 65.5254s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0650412 Vali Loss: 0.0835494 Test Loss: 0.0889566
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0622228
	speed: 0.0437s/iter; left time: 123.0097s
	iters: 200, epoch: 8 | loss: 0.0603192
	speed: 0.0223s/iter; left time: 60.3999s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0619382 Vali Loss: 0.0838071 Test Loss: 0.0882461
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01840209774672985, rmse:0.13565433025360107, mae:0.08224920183420181, rse:0.5129236578941345
Intermediate time for IT and pred_len 96: 00h:01m:55.98s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1423591
	speed: 0.0387s/iter; left time: 168.9553s
	iters: 200, epoch: 1 | loss: 0.1247035
	speed: 0.0224s/iter; left time: 95.4303s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.44s
Steps: 223 | Train Loss: 0.1496753 Vali Loss: 0.1086939 Test Loss: 0.1115384
Validation loss decreased (inf --> 0.108694).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0945189
	speed: 0.0450s/iter; left time: 186.0453s
	iters: 200, epoch: 2 | loss: 0.0915999
	speed: 0.0224s/iter; left time: 90.3478s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0958328 Vali Loss: 0.0841946 Test Loss: 0.0881004
Validation loss decreased (0.108694 --> 0.084195).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0892303
	speed: 0.0455s/iter; left time: 178.0036s
	iters: 200, epoch: 3 | loss: 0.0885527
	speed: 0.0224s/iter; left time: 85.4416s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0856628 Vali Loss: 0.0844716 Test Loss: 0.0865444
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0801477
	speed: 0.0441s/iter; left time: 162.6857s
	iters: 200, epoch: 4 | loss: 0.0779318
	speed: 0.0224s/iter; left time: 80.4699s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0803572 Vali Loss: 0.0860760 Test Loss: 0.0882949
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0737198
	speed: 0.0444s/iter; left time: 153.9110s
	iters: 200, epoch: 5 | loss: 0.0765113
	speed: 0.0225s/iter; left time: 75.6871s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0744970 Vali Loss: 0.0889429 Test Loss: 0.0900481
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0701593
	speed: 0.0447s/iter; left time: 145.1644s
	iters: 200, epoch: 6 | loss: 0.0692381
	speed: 0.0224s/iter; left time: 70.6155s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0699709 Vali Loss: 0.0898496 Test Loss: 0.0908735
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0679185
	speed: 0.0456s/iter; left time: 137.7382s
	iters: 200, epoch: 7 | loss: 0.0630262
	speed: 0.0225s/iter; left time: 65.7380s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0663681 Vali Loss: 0.0885903 Test Loss: 0.0913930
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019992955029010773, rmse:0.1413964480161667, mae:0.08810041099786758, rse:0.5351320505142212
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1404880
	speed: 0.0284s/iter; left time: 123.7550s
	iters: 200, epoch: 1 | loss: 0.1218658
	speed: 0.0225s/iter; left time: 95.6780s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.64s
Steps: 223 | Train Loss: 0.1495159 Vali Loss: 0.1086430 Test Loss: 0.1113816
Validation loss decreased (inf --> 0.108643).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0947164
	speed: 0.0464s/iter; left time: 191.8074s
	iters: 200, epoch: 2 | loss: 0.0872592
	speed: 0.0224s/iter; left time: 90.3992s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0958824 Vali Loss: 0.0842354 Test Loss: 0.0879539
Validation loss decreased (0.108643 --> 0.084235).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0828680
	speed: 0.0454s/iter; left time: 177.6948s
	iters: 200, epoch: 3 | loss: 0.0856310
	speed: 0.0225s/iter; left time: 85.6719s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0855720 Vali Loss: 0.0846827 Test Loss: 0.0879662
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0820475
	speed: 0.0441s/iter; left time: 162.7253s
	iters: 200, epoch: 4 | loss: 0.0760696
	speed: 0.0224s/iter; left time: 80.5821s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0801973 Vali Loss: 0.0866909 Test Loss: 0.0899356
EarlyStopping counter: 2 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0758944
	speed: 0.0441s/iter; left time: 152.8667s
	iters: 200, epoch: 5 | loss: 0.0725707
	speed: 0.0225s/iter; left time: 75.7098s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0741449 Vali Loss: 0.0878185 Test Loss: 0.0923809
EarlyStopping counter: 3 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0708352
	speed: 0.0441s/iter; left time: 143.0451s
	iters: 200, epoch: 6 | loss: 0.0676354
	speed: 0.0225s/iter; left time: 70.7800s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0694595 Vali Loss: 0.0874840 Test Loss: 0.0934459
EarlyStopping counter: 4 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0662269
	speed: 0.0439s/iter; left time: 132.7135s
	iters: 200, epoch: 7 | loss: 0.0632087
	speed: 0.0225s/iter; left time: 65.7967s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0656503 Vali Loss: 0.0889737 Test Loss: 0.0943873
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019958944991230965, rmse:0.14127613604068756, mae:0.08795391023159027, rse:0.5346766710281372
Intermediate time for IT and pred_len 168: 00h:01m:43.60s
Intermediate time for IT: 00h:07m:33.05s
Total time: 00h:41m:40.27s