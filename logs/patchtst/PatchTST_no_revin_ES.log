
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='channel_mixing_ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : channel_mixing_ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1235685
	speed: 0.0584s/iter; left time: 1302.9294s
	iters: 200, epoch: 1 | loss: 0.1166312
	speed: 0.0319s/iter; left time: 708.7286s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.1306442 Vali Loss: 0.0743393 Test Loss: 0.0910288
Validation loss decreased (inf --> 0.074339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0414139
	speed: 0.0626s/iter; left time: 1382.7111s
	iters: 200, epoch: 2 | loss: 0.0266411
	speed: 0.0322s/iter; left time: 707.9793s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0490632 Vali Loss: 0.0170418 Test Loss: 0.0199101
Validation loss decreased (0.074339 --> 0.017042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0221347
	speed: 0.0719s/iter; left time: 1572.0768s
	iters: 200, epoch: 3 | loss: 0.0209304
	speed: 0.0346s/iter; left time: 753.1321s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0225532 Vali Loss: 0.0141340 Test Loss: 0.0165208
Validation loss decreased (0.017042 --> 0.014134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0175069
	speed: 0.0636s/iter; left time: 1375.9035s
	iters: 200, epoch: 4 | loss: 0.0180933
	speed: 0.0337s/iter; left time: 724.5114s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0189549 Vali Loss: 0.0126682 Test Loss: 0.0149519
Validation loss decreased (0.014134 --> 0.012668).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0158055
	speed: 0.0694s/iter; left time: 1484.5818s
	iters: 200, epoch: 5 | loss: 0.0164286
	speed: 0.0373s/iter; left time: 794.2028s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0169486 Vali Loss: 0.0124042 Test Loss: 0.0145784
Validation loss decreased (0.012668 --> 0.012404).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0160598
	speed: 0.0675s/iter; left time: 1428.8947s
	iters: 200, epoch: 6 | loss: 0.0156461
	speed: 0.0376s/iter; left time: 792.6010s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0154126 Vali Loss: 0.0123237 Test Loss: 0.0142485
Validation loss decreased (0.012404 --> 0.012324).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0163689
	speed: 0.0701s/iter; left time: 1469.7544s
	iters: 200, epoch: 7 | loss: 0.0149154
	speed: 0.0338s/iter; left time: 704.0336s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0142636 Vali Loss: 0.0114231 Test Loss: 0.0135450
Validation loss decreased (0.012324 --> 0.011423).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0132940
	speed: 0.0650s/iter; left time: 1348.1211s
	iters: 200, epoch: 8 | loss: 0.0116993
	speed: 0.0328s/iter; left time: 677.3795s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0130814 Vali Loss: 0.0109222 Test Loss: 0.0140578
Validation loss decreased (0.011423 --> 0.010922).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0113352
	speed: 0.0674s/iter; left time: 1382.6011s
	iters: 200, epoch: 9 | loss: 0.0105395
	speed: 0.0345s/iter; left time: 703.4444s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0120762 Vali Loss: 0.0108338 Test Loss: 0.0172134
Validation loss decreased (0.010922 --> 0.010834).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0116649
	speed: 0.0723s/iter; left time: 1466.7255s
	iters: 200, epoch: 10 | loss: 0.0099158
	speed: 0.0350s/iter; left time: 705.7269s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.0114562 Vali Loss: 0.0104998 Test Loss: 0.0165373
Validation loss decreased (0.010834 --> 0.010500).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0113771
	speed: 0.0633s/iter; left time: 1268.8919s
	iters: 200, epoch: 11 | loss: 0.0114219
	speed: 0.0352s/iter; left time: 701.8794s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0110821 Vali Loss: 0.0103820 Test Loss: 0.0219415
Validation loss decreased (0.010500 --> 0.010382).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0108638
	speed: 0.0689s/iter; left time: 1366.1695s
	iters: 200, epoch: 12 | loss: 0.0102516
	speed: 0.0319s/iter; left time: 628.7570s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0106935 Vali Loss: 0.0100026 Test Loss: 0.0214718
Validation loss decreased (0.010382 --> 0.010003).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0098957
	speed: 0.0612s/iter; left time: 1199.4222s
	iters: 200, epoch: 13 | loss: 0.0092505
	speed: 0.0290s/iter; left time: 565.3401s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.74s
Steps: 224 | Train Loss: 0.0104717 Vali Loss: 0.0099261 Test Loss: 0.0182114
Validation loss decreased (0.010003 --> 0.009926).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0108826
	speed: 0.0637s/iter; left time: 1235.8885s
	iters: 200, epoch: 14 | loss: 0.0088690
	speed: 0.0344s/iter; left time: 663.1042s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.27s
Steps: 224 | Train Loss: 0.0102703 Vali Loss: 0.0098426 Test Loss: 0.0177606
Validation loss decreased (0.009926 --> 0.009843).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0105166
	speed: 0.0559s/iter; left time: 1071.3337s
	iters: 200, epoch: 15 | loss: 0.0097342
	speed: 0.0227s/iter; left time: 432.4013s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.87s
Steps: 224 | Train Loss: 0.0101483 Vali Loss: 0.0098085 Test Loss: 0.0205569
Validation loss decreased (0.009843 --> 0.009809).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0087296
	speed: 0.0424s/iter; left time: 802.4277s
	iters: 200, epoch: 16 | loss: 0.0096730
	speed: 0.0295s/iter; left time: 555.0353s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.09s
Steps: 224 | Train Loss: 0.0101333 Vali Loss: 0.0097114 Test Loss: 0.0196735
Validation loss decreased (0.009809 --> 0.009711).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0108441
	speed: 0.0656s/iter; left time: 1227.4040s
	iters: 200, epoch: 17 | loss: 0.0097255
	speed: 0.0332s/iter; left time: 617.2192s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0099599 Vali Loss: 0.0095411 Test Loss: 0.0179444
Validation loss decreased (0.009711 --> 0.009541).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0088029
	speed: 0.0672s/iter; left time: 1242.0426s
	iters: 200, epoch: 18 | loss: 0.0095050
	speed: 0.0319s/iter; left time: 586.4735s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.69s
Steps: 224 | Train Loss: 0.0098107 Vali Loss: 0.0095047 Test Loss: 0.0188733
Validation loss decreased (0.009541 --> 0.009505).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0096069
	speed: 0.0691s/iter; left time: 1261.7855s
	iters: 200, epoch: 19 | loss: 0.0100707
	speed: 0.0318s/iter; left time: 577.2990s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0097356 Vali Loss: 0.0095299 Test Loss: 0.0189880
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0096012
	speed: 0.0662s/iter; left time: 1195.0160s
	iters: 200, epoch: 20 | loss: 0.0103081
	speed: 0.0336s/iter; left time: 603.6716s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0096700 Vali Loss: 0.0094713 Test Loss: 0.0193751
Validation loss decreased (0.009505 --> 0.009471).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0099798
	speed: 0.0752s/iter; left time: 1339.4890s
	iters: 200, epoch: 21 | loss: 0.0106904
	speed: 0.0350s/iter; left time: 619.6264s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.34s
Steps: 224 | Train Loss: 0.0096355 Vali Loss: 0.0094038 Test Loss: 0.0190703
Validation loss decreased (0.009471 --> 0.009404).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0098239
	speed: 0.0695s/iter; left time: 1223.3233s
	iters: 200, epoch: 22 | loss: 0.0093015
	speed: 0.0336s/iter; left time: 587.0746s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0095963 Vali Loss: 0.0094222 Test Loss: 0.0179196
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0091338
	speed: 0.0636s/iter; left time: 1104.8615s
	iters: 200, epoch: 23 | loss: 0.0098065
	speed: 0.0339s/iter; left time: 586.0158s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0095129 Vali Loss: 0.0092669 Test Loss: 0.0183864
Validation loss decreased (0.009404 --> 0.009267).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0093905
	speed: 0.0680s/iter; left time: 1165.5587s
	iters: 200, epoch: 24 | loss: 0.0102782
	speed: 0.0327s/iter; left time: 557.6188s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0095316 Vali Loss: 0.0093195 Test Loss: 0.0209839
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0104343
	speed: 0.0698s/iter; left time: 1181.4679s
	iters: 200, epoch: 25 | loss: 0.0088957
	speed: 0.0328s/iter; left time: 551.1008s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0094462 Vali Loss: 0.0092798 Test Loss: 0.0181019
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0092811
	speed: 0.0680s/iter; left time: 1135.6562s
	iters: 200, epoch: 26 | loss: 0.0094501
	speed: 0.0323s/iter; left time: 535.7183s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0096182 Vali Loss: 0.0094344 Test Loss: 0.0172716
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0091324
	speed: 0.0743s/iter; left time: 1225.0588s
	iters: 200, epoch: 27 | loss: 0.0106261
	speed: 0.0327s/iter; left time: 535.7578s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.35s
Steps: 224 | Train Loss: 0.0094139 Vali Loss: 0.0092859 Test Loss: 0.0192018
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0077775
	speed: 0.0668s/iter; left time: 1086.3652s
	iters: 200, epoch: 28 | loss: 0.0089043
	speed: 0.0331s/iter; left time: 535.0280s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0093605 Vali Loss: 0.0092553 Test Loss: 0.0188021
Validation loss decreased (0.009267 --> 0.009255).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0087630
	speed: 0.0673s/iter; left time: 1078.4406s
	iters: 200, epoch: 29 | loss: 0.0096931
	speed: 0.0372s/iter; left time: 591.9534s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.31s
Steps: 224 | Train Loss: 0.0093333 Vali Loss: 0.0091649 Test Loss: 0.0186937
Validation loss decreased (0.009255 --> 0.009165).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0092893
	speed: 0.0757s/iter; left time: 1197.1580s
	iters: 200, epoch: 30 | loss: 0.0085216
	speed: 0.0339s/iter; left time: 531.9662s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0094238 Vali Loss: 0.0093011 Test Loss: 0.0215952
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0095737
	speed: 0.0633s/iter; left time: 986.7050s
	iters: 200, epoch: 31 | loss: 0.0114639
	speed: 0.0306s/iter; left time: 473.8219s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.34s
Steps: 224 | Train Loss: 0.0093481 Vali Loss: 0.0091937 Test Loss: 0.0199297
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0099808
	speed: 0.0578s/iter; left time: 887.4318s
	iters: 200, epoch: 32 | loss: 0.0079586
	speed: 0.0379s/iter; left time: 578.5559s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0092504 Vali Loss: 0.0091131 Test Loss: 0.0179925
Validation loss decreased (0.009165 --> 0.009113).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0097558
	speed: 0.0618s/iter; left time: 935.4649s
	iters: 200, epoch: 33 | loss: 0.0094637
	speed: 0.0325s/iter; left time: 488.2426s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.20s
Steps: 224 | Train Loss: 0.0092967 Vali Loss: 0.0091046 Test Loss: 0.0196414
Validation loss decreased (0.009113 --> 0.009105).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0093406
	speed: 0.0670s/iter; left time: 999.1567s
	iters: 200, epoch: 34 | loss: 0.0088018
	speed: 0.0323s/iter; left time: 478.3532s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0092845 Vali Loss: 0.0091666 Test Loss: 0.0193905
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0092743
	speed: 0.0635s/iter; left time: 932.3974s
	iters: 200, epoch: 35 | loss: 0.0083632
	speed: 0.0345s/iter; left time: 503.7828s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0092069 Vali Loss: 0.0090927 Test Loss: 0.0179031
Validation loss decreased (0.009105 --> 0.009093).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0098525
	speed: 0.0695s/iter; left time: 1005.0829s
	iters: 200, epoch: 36 | loss: 0.0083036
	speed: 0.0339s/iter; left time: 487.2637s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0092492 Vali Loss: 0.0090937 Test Loss: 0.0208244
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0083163
	speed: 0.0720s/iter; left time: 1024.9486s
	iters: 200, epoch: 37 | loss: 0.0091936
	speed: 0.0335s/iter; left time: 473.0187s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0092016 Vali Loss: 0.0090485 Test Loss: 0.0183503
Validation loss decreased (0.009093 --> 0.009049).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0080988
	speed: 0.0705s/iter; left time: 987.3785s
	iters: 200, epoch: 38 | loss: 0.0095375
	speed: 0.0332s/iter; left time: 461.6985s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0092376 Vali Loss: 0.0091220 Test Loss: 0.0189542
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0091136
	speed: 0.0646s/iter; left time: 890.5798s
	iters: 200, epoch: 39 | loss: 0.0088850
	speed: 0.0349s/iter; left time: 477.3490s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0092021 Vali Loss: 0.0090822 Test Loss: 0.0201605
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0085782
	speed: 0.0775s/iter; left time: 1051.5229s
	iters: 200, epoch: 40 | loss: 0.0086339
	speed: 0.0446s/iter; left time: 600.1926s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0091749 Vali Loss: 0.0090968 Test Loss: 0.0189611
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0097929
	speed: 0.0632s/iter; left time: 843.7170s
	iters: 200, epoch: 41 | loss: 0.0088069
	speed: 0.0323s/iter; left time: 427.0714s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.66s
Steps: 224 | Train Loss: 0.0091887 Vali Loss: 0.0091413 Test Loss: 0.0185922
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0104537
	speed: 0.0650s/iter; left time: 853.0560s
	iters: 200, epoch: 42 | loss: 0.0085751
	speed: 0.0342s/iter; left time: 445.7137s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0092292 Vali Loss: 0.0091321 Test Loss: 0.0179263
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0089744
	speed: 0.0676s/iter; left time: 871.6863s
	iters: 200, epoch: 43 | loss: 0.0091920
	speed: 0.0321s/iter; left time: 410.3368s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0092599 Vali Loss: 0.0091090 Test Loss: 0.0174770
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0096402
	speed: 0.0692s/iter; left time: 876.0870s
	iters: 200, epoch: 44 | loss: 0.0095632
	speed: 0.0363s/iter; left time: 456.3408s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.57s
Steps: 224 | Train Loss: 0.0092053 Vali Loss: 0.0091317 Test Loss: 0.0196726
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0099961
	speed: 0.0657s/iter; left time: 817.2273s
	iters: 200, epoch: 45 | loss: 0.0104771
	speed: 0.0326s/iter; left time: 402.8310s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0092551 Vali Loss: 0.0091076 Test Loss: 0.0179130
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0084438
	speed: 0.0664s/iter; left time: 811.0736s
	iters: 200, epoch: 46 | loss: 0.0094436
	speed: 0.0341s/iter; left time: 413.1245s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0091619 Vali Loss: 0.0090871 Test Loss: 0.0172821
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0097950
	speed: 0.0704s/iter; left time: 844.3442s
	iters: 200, epoch: 47 | loss: 0.0084180
	speed: 0.0341s/iter; left time: 405.7638s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0091385 Vali Loss: 0.0091280 Test Loss: 0.0175781
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : channel_mixing_ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01835033856332302, rmse:0.1354634165763855, mae:0.08412059396505356, rse:0.39865246415138245
Intermediate time for ES and pred_len 24: 00h:08m:02.77s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='channel_mixing_ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : channel_mixing_ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1243099
	speed: 0.0617s/iter; left time: 1376.4784s
	iters: 200, epoch: 1 | loss: 0.1112777
	speed: 0.0306s/iter; left time: 678.3505s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.1304680 Vali Loss: 0.0749759 Test Loss: 0.0934199
Validation loss decreased (inf --> 0.074976).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0422750
	speed: 0.0576s/iter; left time: 1272.0179s
	iters: 200, epoch: 2 | loss: 0.0295403
	speed: 0.0248s/iter; left time: 544.0051s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.99s
Steps: 224 | Train Loss: 0.0484345 Vali Loss: 0.0234643 Test Loss: 0.0291021
Validation loss decreased (0.074976 --> 0.023464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0261098
	speed: 0.0704s/iter; left time: 1539.3126s
	iters: 200, epoch: 3 | loss: 0.0251757
	speed: 0.0340s/iter; left time: 739.0874s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.38s
Steps: 224 | Train Loss: 0.0267445 Vali Loss: 0.0204402 Test Loss: 0.0251841
Validation loss decreased (0.023464 --> 0.020440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0220553
	speed: 0.0651s/iter; left time: 1408.6487s
	iters: 200, epoch: 4 | loss: 0.0216708
	speed: 0.0346s/iter; left time: 744.4531s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0230021 Vali Loss: 0.0190462 Test Loss: 0.0245052
Validation loss decreased (0.020440 --> 0.019046).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0207762
	speed: 0.0680s/iter; left time: 1454.7322s
	iters: 200, epoch: 5 | loss: 0.0181857
	speed: 0.0349s/iter; left time: 743.8005s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0199932 Vali Loss: 0.0178145 Test Loss: 0.0349214
Validation loss decreased (0.019046 --> 0.017814).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0178383
	speed: 0.0641s/iter; left time: 1357.7454s
	iters: 200, epoch: 6 | loss: 0.0184396
	speed: 0.0329s/iter; left time: 693.7278s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0179342 Vali Loss: 0.0170949 Test Loss: 0.0270423
Validation loss decreased (0.017814 --> 0.017095).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0178106
	speed: 0.0806s/iter; left time: 1688.4535s
	iters: 200, epoch: 7 | loss: 0.0158232
	speed: 0.0333s/iter; left time: 694.3862s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.43s
Steps: 224 | Train Loss: 0.0169621 Vali Loss: 0.0164534 Test Loss: 0.0254716
Validation loss decreased (0.017095 --> 0.016453).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0172422
	speed: 0.0673s/iter; left time: 1394.3534s
	iters: 200, epoch: 8 | loss: 0.0163265
	speed: 0.0345s/iter; left time: 710.9013s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0164334 Vali Loss: 0.0159479 Test Loss: 0.0251510
Validation loss decreased (0.016453 --> 0.015948).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0159623
	speed: 0.0715s/iter; left time: 1465.8270s
	iters: 200, epoch: 9 | loss: 0.0149368
	speed: 0.0379s/iter; left time: 773.4056s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.73s
Steps: 224 | Train Loss: 0.0161261 Vali Loss: 0.0157977 Test Loss: 0.0278607
Validation loss decreased (0.015948 --> 0.015798).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0162833
	speed: 0.0751s/iter; left time: 1523.3336s
	iters: 200, epoch: 10 | loss: 0.0167888
	speed: 0.0335s/iter; left time: 676.5176s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.72s
Steps: 224 | Train Loss: 0.0157125 Vali Loss: 0.0157265 Test Loss: 0.0291120
Validation loss decreased (0.015798 --> 0.015727).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0157385
	speed: 0.0772s/iter; left time: 1548.8039s
	iters: 200, epoch: 11 | loss: 0.0161697
	speed: 0.0338s/iter; left time: 674.0981s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.38s
Steps: 224 | Train Loss: 0.0155772 Vali Loss: 0.0154291 Test Loss: 0.0283270
Validation loss decreased (0.015727 --> 0.015429).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0157377
	speed: 0.0716s/iter; left time: 1420.7511s
	iters: 200, epoch: 12 | loss: 0.0161220
	speed: 0.0327s/iter; left time: 645.4541s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0153947 Vali Loss: 0.0155128 Test Loss: 0.0267294
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0145680
	speed: 0.0649s/iter; left time: 1273.7174s
	iters: 200, epoch: 13 | loss: 0.0151161
	speed: 0.0331s/iter; left time: 645.8575s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0152482 Vali Loss: 0.0152456 Test Loss: 0.0313342
Validation loss decreased (0.015429 --> 0.015246).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0144295
	speed: 0.0710s/iter; left time: 1376.2148s
	iters: 200, epoch: 14 | loss: 0.0149595
	speed: 0.0381s/iter; left time: 733.9659s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.44s
Steps: 224 | Train Loss: 0.0156610 Vali Loss: 0.0153661 Test Loss: 0.0282838
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0138063
	speed: 0.0618s/iter; left time: 1184.8536s
	iters: 200, epoch: 15 | loss: 0.0160840
	speed: 0.0373s/iter; left time: 710.2193s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0153227 Vali Loss: 0.0163661 Test Loss: 0.0256972
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0147027
	speed: 0.0673s/iter; left time: 1275.5846s
	iters: 200, epoch: 16 | loss: 0.0159377
	speed: 0.0329s/iter; left time: 620.3771s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0152654 Vali Loss: 0.0152266 Test Loss: 0.0313957
Validation loss decreased (0.015246 --> 0.015227).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0147857
	speed: 0.0651s/iter; left time: 1218.6164s
	iters: 200, epoch: 17 | loss: 0.0158567
	speed: 0.0314s/iter; left time: 584.5487s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0149680 Vali Loss: 0.0152546 Test Loss: 0.0288141
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0150313
	speed: 0.0594s/iter; left time: 1098.0424s
	iters: 200, epoch: 18 | loss: 0.0153670
	speed: 0.0377s/iter; left time: 693.5811s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0148922 Vali Loss: 0.0151359 Test Loss: 0.0352062
Validation loss decreased (0.015227 --> 0.015136).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0152953
	speed: 0.0583s/iter; left time: 1064.8301s
	iters: 200, epoch: 19 | loss: 0.0164243
	speed: 0.0279s/iter; left time: 506.4266s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.53s
Steps: 224 | Train Loss: 0.0154202 Vali Loss: 0.0154077 Test Loss: 0.0260406
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0139980
	speed: 0.0666s/iter; left time: 1201.3364s
	iters: 200, epoch: 20 | loss: 0.0153673
	speed: 0.0342s/iter; left time: 613.0738s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0148775 Vali Loss: 0.0150819 Test Loss: 0.0291436
Validation loss decreased (0.015136 --> 0.015082).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0152630
	speed: 0.0658s/iter; left time: 1171.8346s
	iters: 200, epoch: 21 | loss: 0.0139147
	speed: 0.0346s/iter; left time: 613.3407s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0147524 Vali Loss: 0.0150175 Test Loss: 0.0302568
Validation loss decreased (0.015082 --> 0.015018).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0152948
	speed: 0.0649s/iter; left time: 1141.3071s
	iters: 200, epoch: 22 | loss: 0.0151246
	speed: 0.0345s/iter; left time: 604.4906s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.68s
Steps: 224 | Train Loss: 0.0147291 Vali Loss: 0.0150637 Test Loss: 0.0294112
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0138211
	speed: 0.0703s/iter; left time: 1221.1014s
	iters: 200, epoch: 23 | loss: 0.0160007
	speed: 0.0366s/iter; left time: 633.0278s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.35s
Steps: 224 | Train Loss: 0.0146824 Vali Loss: 0.0149438 Test Loss: 0.0299825
Validation loss decreased (0.015018 --> 0.014944).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0137403
	speed: 0.0699s/iter; left time: 1198.5750s
	iters: 200, epoch: 24 | loss: 0.0137934
	speed: 0.0359s/iter; left time: 612.2421s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.29s
Steps: 224 | Train Loss: 0.0146960 Vali Loss: 0.0149939 Test Loss: 0.0284647
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0147044
	speed: 0.0729s/iter; left time: 1233.2951s
	iters: 200, epoch: 25 | loss: 0.0162568
	speed: 0.0346s/iter; left time: 582.9099s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.64s
Steps: 224 | Train Loss: 0.0146439 Vali Loss: 0.0149701 Test Loss: 0.0297256
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0135267
	speed: 0.0725s/iter; left time: 1209.9924s
	iters: 200, epoch: 26 | loss: 0.0140600
	speed: 0.0356s/iter; left time: 591.5465s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.57s
Steps: 224 | Train Loss: 0.0146344 Vali Loss: 0.0149647 Test Loss: 0.0292373
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0148893
	speed: 0.0694s/iter; left time: 1144.0827s
	iters: 200, epoch: 27 | loss: 0.0141754
	speed: 0.0340s/iter; left time: 557.4435s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.0145488 Vali Loss: 0.0149350 Test Loss: 0.0312378
Validation loss decreased (0.014944 --> 0.014935).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0155144
	speed: 0.0688s/iter; left time: 1117.6884s
	iters: 200, epoch: 28 | loss: 0.0170834
	speed: 0.0334s/iter; left time: 539.8284s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0145691 Vali Loss: 0.0149834 Test Loss: 0.0311552
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0156587
	speed: 0.0659s/iter; left time: 1056.4232s
	iters: 200, epoch: 29 | loss: 0.0152508
	speed: 0.0438s/iter; left time: 696.9015s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.28s
Steps: 224 | Train Loss: 0.0145267 Vali Loss: 0.0149104 Test Loss: 0.0324814
Validation loss decreased (0.014935 --> 0.014910).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0140890
	speed: 0.0734s/iter; left time: 1159.7660s
	iters: 200, epoch: 30 | loss: 0.0135267
	speed: 0.0397s/iter; left time: 623.1687s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.72s
Steps: 224 | Train Loss: 0.0145276 Vali Loss: 0.0149391 Test Loss: 0.0319644
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0140089
	speed: 0.0611s/iter; left time: 951.2772s
	iters: 200, epoch: 31 | loss: 0.0148899
	speed: 0.0384s/iter; left time: 595.0901s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0144888 Vali Loss: 0.0148844 Test Loss: 0.0310164
Validation loss decreased (0.014910 --> 0.014884).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0149111
	speed: 0.0664s/iter; left time: 1020.1068s
	iters: 200, epoch: 32 | loss: 0.0149692
	speed: 0.0335s/iter; left time: 511.1251s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0145123 Vali Loss: 0.0149362 Test Loss: 0.0324887
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0149417
	speed: 0.0648s/iter; left time: 981.0322s
	iters: 200, epoch: 33 | loss: 0.0151715
	speed: 0.0322s/iter; left time: 483.9088s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.72s
Steps: 224 | Train Loss: 0.0145124 Vali Loss: 0.0149080 Test Loss: 0.0316317
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0130034
	speed: 0.0741s/iter; left time: 1105.2367s
	iters: 200, epoch: 34 | loss: 0.0153687
	speed: 0.0297s/iter; left time: 439.3788s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0144306 Vali Loss: 0.0149091 Test Loss: 0.0325113
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0147780
	speed: 0.0594s/iter; left time: 872.5483s
	iters: 200, epoch: 35 | loss: 0.0155870
	speed: 0.0294s/iter; left time: 428.2292s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.95s
Steps: 224 | Train Loss: 0.0145847 Vali Loss: 0.0149064 Test Loss: 0.0315548
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0142555
	speed: 0.0678s/iter; left time: 980.2007s
	iters: 200, epoch: 36 | loss: 0.0138206
	speed: 0.0335s/iter; left time: 481.3036s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0145906 Vali Loss: 0.0149479 Test Loss: 0.0295329
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0151577
	speed: 0.0731s/iter; left time: 1040.8403s
	iters: 200, epoch: 37 | loss: 0.0137488
	speed: 0.0372s/iter; left time: 526.5308s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.14s
Steps: 224 | Train Loss: 0.0144642 Vali Loss: 0.0148912 Test Loss: 0.0300454
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0134963
	speed: 0.0706s/iter; left time: 989.7093s
	iters: 200, epoch: 38 | loss: 0.0137275
	speed: 0.0372s/iter; left time: 518.0299s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.61s
Steps: 224 | Train Loss: 0.0147023 Vali Loss: 0.0149361 Test Loss: 0.0297693
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0135200
	speed: 0.0643s/iter; left time: 886.5110s
	iters: 200, epoch: 39 | loss: 0.0149992
	speed: 0.0327s/iter; left time: 446.9630s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0145202 Vali Loss: 0.0149646 Test Loss: 0.0300370
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0150121
	speed: 0.0616s/iter; left time: 835.7713s
	iters: 200, epoch: 40 | loss: 0.0140267
	speed: 0.0396s/iter; left time: 532.9583s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.0145302 Vali Loss: 0.0149335 Test Loss: 0.0295037
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0145172
	speed: 0.0695s/iter; left time: 927.5189s
	iters: 200, epoch: 41 | loss: 0.0145294
	speed: 0.0360s/iter; left time: 476.2811s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.33s
Steps: 224 | Train Loss: 0.0144130 Vali Loss: 0.0149308 Test Loss: 0.0298137
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : channel_mixing_ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.031016401946544647, rmse:0.1761147379875183, mae:0.11428863555192947, rse:0.5173721313476562
Intermediate time for ES and pred_len 96: 00h:07m:10.46s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='channel_mixing_ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=0, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : channel_mixing_ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1284169
	speed: 0.0630s/iter; left time: 1399.5427s
	iters: 200, epoch: 1 | loss: 0.1172287
	speed: 0.0333s/iter; left time: 735.3522s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.1315195 Vali Loss: 0.0755308 Test Loss: 0.0935711
Validation loss decreased (inf --> 0.075531).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0394520
	speed: 0.0683s/iter; left time: 1501.9118s
	iters: 200, epoch: 2 | loss: 0.0300034
	speed: 0.0342s/iter; left time: 749.0825s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.18s
Steps: 223 | Train Loss: 0.0483511 Vali Loss: 0.0254592 Test Loss: 0.0312638
Validation loss decreased (0.075531 --> 0.025459).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0298315
	speed: 0.0702s/iter; left time: 1527.2272s
	iters: 200, epoch: 3 | loss: 0.0257679
	speed: 0.0334s/iter; left time: 723.0111s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0275876 Vali Loss: 0.0222081 Test Loss: 0.0273541
Validation loss decreased (0.025459 --> 0.022208).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0234629
	speed: 0.0692s/iter; left time: 1489.9470s
	iters: 200, epoch: 4 | loss: 0.0214712
	speed: 0.0341s/iter; left time: 731.5178s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.78s
Steps: 223 | Train Loss: 0.0232781 Vali Loss: 0.0205097 Test Loss: 0.0334549
Validation loss decreased (0.022208 --> 0.020510).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0214271
	speed: 0.0745s/iter; left time: 1588.2192s
	iters: 200, epoch: 5 | loss: 0.0183603
	speed: 0.0337s/iter; left time: 714.4726s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.65s
Steps: 223 | Train Loss: 0.0199682 Vali Loss: 0.0189914 Test Loss: 0.0321025
Validation loss decreased (0.020510 --> 0.018991).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0175757
	speed: 0.0692s/iter; left time: 1459.1214s
	iters: 200, epoch: 6 | loss: 0.0184193
	speed: 0.0323s/iter; left time: 678.7248s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0184786 Vali Loss: 0.0183154 Test Loss: 0.0325361
Validation loss decreased (0.018991 --> 0.018315).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0176433
	speed: 0.0775s/iter; left time: 1616.3857s
	iters: 200, epoch: 7 | loss: 0.0172115
	speed: 0.0415s/iter; left time: 862.6001s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.13s
Steps: 223 | Train Loss: 0.0178102 Vali Loss: 0.0178938 Test Loss: 0.0310357
Validation loss decreased (0.018315 --> 0.017894).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0161289
	speed: 0.0718s/iter; left time: 1481.0796s
	iters: 200, epoch: 8 | loss: 0.0173672
	speed: 0.0288s/iter; left time: 591.4928s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.57s
Steps: 223 | Train Loss: 0.0174180 Vali Loss: 0.0177719 Test Loss: 0.0310839
Validation loss decreased (0.017894 --> 0.017772).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0172031
	speed: 0.0690s/iter; left time: 1409.4120s
	iters: 200, epoch: 9 | loss: 0.0161021
	speed: 0.0389s/iter; left time: 790.4316s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.40s
Steps: 223 | Train Loss: 0.0170769 Vali Loss: 0.0179210 Test Loss: 0.0304198
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0170793
	speed: 0.0620s/iter; left time: 1251.1784s
	iters: 200, epoch: 10 | loss: 0.0183556
	speed: 0.0327s/iter; left time: 657.5804s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.41s
Steps: 223 | Train Loss: 0.0170377 Vali Loss: 0.0174098 Test Loss: 0.0347562
Validation loss decreased (0.017772 --> 0.017410).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0170728
	speed: 0.0485s/iter; left time: 968.3480s
	iters: 200, epoch: 11 | loss: 0.0171281
	speed: 0.0201s/iter; left time: 399.0089s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.79s
Steps: 223 | Train Loss: 0.0183533 Vali Loss: 0.0177499 Test Loss: 0.0281153
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0142452
	speed: 0.0703s/iter; left time: 1389.1458s
	iters: 200, epoch: 12 | loss: 0.0168665
	speed: 0.0360s/iter; left time: 707.7703s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.15s
Steps: 223 | Train Loss: 0.0166846 Vali Loss: 0.0173330 Test Loss: 0.0298354
Validation loss decreased (0.017410 --> 0.017333).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0161570
	speed: 0.0699s/iter; left time: 1365.5925s
	iters: 200, epoch: 13 | loss: 0.0165948
	speed: 0.0424s/iter; left time: 824.4303s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.68s
Steps: 223 | Train Loss: 0.0166812 Vali Loss: 0.0173812 Test Loss: 0.0305343
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0160646
	speed: 0.0774s/iter; left time: 1493.8002s
	iters: 200, epoch: 14 | loss: 0.0174675
	speed: 0.0330s/iter; left time: 634.2622s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.72s
Steps: 223 | Train Loss: 0.0164507 Vali Loss: 0.0174721 Test Loss: 0.0310623
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0159258
	speed: 0.0688s/iter; left time: 1311.7023s
	iters: 200, epoch: 15 | loss: 0.0180293
	speed: 0.0328s/iter; left time: 622.8340s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0163814 Vali Loss: 0.0171970 Test Loss: 0.0328074
Validation loss decreased (0.017333 --> 0.017197).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0171973
	speed: 0.0649s/iter; left time: 1223.1667s
	iters: 200, epoch: 16 | loss: 0.0169949
	speed: 0.0351s/iter; left time: 658.2256s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.76s
Steps: 223 | Train Loss: 0.0166250 Vali Loss: 0.0173631 Test Loss: 0.0302975
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0154431
	speed: 0.0701s/iter; left time: 1306.1770s
	iters: 200, epoch: 17 | loss: 0.0158963
	speed: 0.0330s/iter; left time: 611.2275s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.79s
Steps: 223 | Train Loss: 0.0163361 Vali Loss: 0.0173100 Test Loss: 0.0320395
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0158747
	speed: 0.0671s/iter; left time: 1235.7812s
	iters: 200, epoch: 18 | loss: 0.0172246
	speed: 0.0344s/iter; left time: 630.3189s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0162627 Vali Loss: 0.0172289 Test Loss: 0.0336265
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0153920
	speed: 0.0760s/iter; left time: 1381.9362s
	iters: 200, epoch: 19 | loss: 0.0159192
	speed: 0.0335s/iter; left time: 605.1782s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.18s
Steps: 223 | Train Loss: 0.0161746 Vali Loss: 0.0171079 Test Loss: 0.0315786
Validation loss decreased (0.017197 --> 0.017108).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0172178
	speed: 0.0737s/iter; left time: 1323.1303s
	iters: 200, epoch: 20 | loss: 0.0154738
	speed: 0.0392s/iter; left time: 699.7429s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.10s
Steps: 223 | Train Loss: 0.0162445 Vali Loss: 0.0171308 Test Loss: 0.0327551
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0156633
	speed: 0.0701s/iter; left time: 1243.7205s
	iters: 200, epoch: 21 | loss: 0.0158444
	speed: 0.0344s/iter; left time: 606.4581s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0161826 Vali Loss: 0.0171602 Test Loss: 0.0327335
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0160388
	speed: 0.0645s/iter; left time: 1129.8200s
	iters: 200, epoch: 22 | loss: 0.0170065
	speed: 0.0346s/iter; left time: 603.4638s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.81s
Steps: 223 | Train Loss: 0.0160776 Vali Loss: 0.0170937 Test Loss: 0.0331659
Validation loss decreased (0.017108 --> 0.017094).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0147220
	speed: 0.0676s/iter; left time: 1168.7368s
	iters: 200, epoch: 23 | loss: 0.0174204
	speed: 0.0379s/iter; left time: 651.7976s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.37s
Steps: 223 | Train Loss: 0.0160284 Vali Loss: 0.0170745 Test Loss: 0.0332947
Validation loss decreased (0.017094 --> 0.017074).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0157670
	speed: 0.0682s/iter; left time: 1164.6693s
	iters: 200, epoch: 24 | loss: 0.0147003
	speed: 0.0381s/iter; left time: 647.1778s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.43s
Steps: 223 | Train Loss: 0.0159721 Vali Loss: 0.0169896 Test Loss: 0.0325431
Validation loss decreased (0.017074 --> 0.016990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0167779
	speed: 0.0828s/iter; left time: 1395.6360s
	iters: 200, epoch: 25 | loss: 0.0158870
	speed: 0.0308s/iter; left time: 515.5034s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.06s
Steps: 223 | Train Loss: 0.0160009 Vali Loss: 0.0169696 Test Loss: 0.0342427
Validation loss decreased (0.016990 --> 0.016970).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0182935
	speed: 0.0615s/iter; left time: 1023.0348s
	iters: 200, epoch: 26 | loss: 0.0152293
	speed: 0.0282s/iter; left time: 465.4038s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.79s
Steps: 223 | Train Loss: 0.0159626 Vali Loss: 0.0170733 Test Loss: 0.0365577
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0150043
	speed: 0.0706s/iter; left time: 1158.2097s
	iters: 200, epoch: 27 | loss: 0.0167594
	speed: 0.0295s/iter; left time: 481.4555s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.15s
Steps: 223 | Train Loss: 0.0158955 Vali Loss: 0.0169665 Test Loss: 0.0339735
Validation loss decreased (0.016970 --> 0.016967).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0150428
	speed: 0.0704s/iter; left time: 1139.8537s
	iters: 200, epoch: 28 | loss: 0.0171211
	speed: 0.0347s/iter; left time: 558.4060s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.58s
Steps: 223 | Train Loss: 0.0160956 Vali Loss: 0.0170350 Test Loss: 0.0318645
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0164731
	speed: 0.0665s/iter; left time: 1061.1743s
	iters: 200, epoch: 29 | loss: 0.0175466
	speed: 0.0325s/iter; left time: 516.1357s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.75s
Steps: 223 | Train Loss: 0.0159007 Vali Loss: 0.0170863 Test Loss: 0.0330290
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0160695
	speed: 0.0689s/iter; left time: 1084.2139s
	iters: 200, epoch: 30 | loss: 0.0164711
	speed: 0.0357s/iter; left time: 557.3875s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.21s
Steps: 223 | Train Loss: 0.0158933 Vali Loss: 0.0171437 Test Loss: 0.0331343
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0156804
	speed: 0.0673s/iter; left time: 1044.1861s
	iters: 200, epoch: 31 | loss: 0.0155068
	speed: 0.0339s/iter; left time: 523.1168s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.21s
Steps: 223 | Train Loss: 0.0158197 Vali Loss: 0.0170106 Test Loss: 0.0339011
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0151057
	speed: 0.0735s/iter; left time: 1122.9904s
	iters: 200, epoch: 32 | loss: 0.0165237
	speed: 0.0378s/iter; left time: 574.1693s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.56s
Steps: 223 | Train Loss: 0.0159418 Vali Loss: 0.0170865 Test Loss: 0.0326944
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0154904
	speed: 0.0659s/iter; left time: 992.6843s
	iters: 200, epoch: 33 | loss: 0.0160965
	speed: 0.0360s/iter; left time: 538.3158s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0159461 Vali Loss: 0.0170641 Test Loss: 0.0318416
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0153600
	speed: 0.0694s/iter; left time: 1030.3840s
	iters: 200, epoch: 34 | loss: 0.0170636
	speed: 0.0399s/iter; left time: 588.4978s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.85s
Steps: 223 | Train Loss: 0.0158354 Vali Loss: 0.0170254 Test Loss: 0.0326165
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0164788
	speed: 0.0662s/iter; left time: 968.0300s
	iters: 200, epoch: 35 | loss: 0.0158054
	speed: 0.0336s/iter; left time: 487.2108s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.67s
Steps: 223 | Train Loss: 0.0158333 Vali Loss: 0.0169850 Test Loss: 0.0334912
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0153885
	speed: 0.0706s/iter; left time: 1015.8118s
	iters: 200, epoch: 36 | loss: 0.0159685
	speed: 0.0355s/iter; left time: 507.7441s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.75s
Steps: 223 | Train Loss: 0.0157919 Vali Loss: 0.0170162 Test Loss: 0.0343361
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0170595
	speed: 0.0731s/iter; left time: 1035.9503s
	iters: 200, epoch: 37 | loss: 0.0156103
	speed: 0.0357s/iter; left time: 502.7961s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.25s
Steps: 223 | Train Loss: 0.0157774 Vali Loss: 0.0169519 Test Loss: 0.0330856
Validation loss decreased (0.016967 --> 0.016952).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0175597
	speed: 0.0783s/iter; left time: 1091.6219s
	iters: 200, epoch: 38 | loss: 0.0155797
	speed: 0.0409s/iter; left time: 565.7756s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.92s
Steps: 223 | Train Loss: 0.0158271 Vali Loss: 0.0170436 Test Loss: 0.0333813
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0153492
	speed: 0.0702s/iter; left time: 964.0592s
	iters: 200, epoch: 39 | loss: 0.0160599
	speed: 0.0322s/iter; left time: 438.9489s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.95s
Steps: 223 | Train Loss: 0.0157613 Vali Loss: 0.0169965 Test Loss: 0.0336042
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0156489
	speed: 0.0723s/iter; left time: 976.8041s
	iters: 200, epoch: 40 | loss: 0.0156041
	speed: 0.0354s/iter; left time: 474.4302s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.72s
Steps: 223 | Train Loss: 0.0159860 Vali Loss: 0.0170430 Test Loss: 0.0325757
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0168099
	speed: 0.0730s/iter; left time: 970.1701s
	iters: 200, epoch: 41 | loss: 0.0156008
	speed: 0.0353s/iter; left time: 465.9219s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.92s
Steps: 223 | Train Loss: 0.0157786 Vali Loss: 0.0170154 Test Loss: 0.0328521
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0149853
	speed: 0.0661s/iter; left time: 863.7247s
	iters: 200, epoch: 42 | loss: 0.0156122
	speed: 0.0290s/iter; left time: 376.1919s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.31s
Steps: 223 | Train Loss: 0.0157521 Vali Loss: 0.0169720 Test Loss: 0.0328154
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0155255
	speed: 0.0742s/iter; left time: 952.0099s
	iters: 200, epoch: 43 | loss: 0.0152470
	speed: 0.0302s/iter; left time: 384.9422s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0157695 Vali Loss: 0.0169560 Test Loss: 0.0332695
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0151010
	speed: 0.0588s/iter; left time: 741.7916s
	iters: 200, epoch: 44 | loss: 0.0157190
	speed: 0.0386s/iter; left time: 483.1504s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0158228 Vali Loss: 0.0170257 Test Loss: 0.0328763
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0156760
	speed: 0.0703s/iter; left time: 870.7125s
	iters: 200, epoch: 45 | loss: 0.0156764
	speed: 0.0348s/iter; left time: 427.2998s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0157282 Vali Loss: 0.0169368 Test Loss: 0.0327699
Validation loss decreased (0.016952 --> 0.016937).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0161030
	speed: 0.0820s/iter; left time: 997.5157s
	iters: 200, epoch: 46 | loss: 0.0172997
	speed: 0.0354s/iter; left time: 427.3866s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0157710 Vali Loss: 0.0169600 Test Loss: 0.0329193
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0147430
	speed: 0.0737s/iter; left time: 880.4968s
	iters: 200, epoch: 47 | loss: 0.0161302
	speed: 0.0344s/iter; left time: 407.6810s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.47s
Steps: 223 | Train Loss: 0.0157679 Vali Loss: 0.0169480 Test Loss: 0.0331634
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0164486
	speed: 0.0698s/iter; left time: 818.3514s
	iters: 200, epoch: 48 | loss: 0.0148175
	speed: 0.0421s/iter; left time: 488.8318s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0157819 Vali Loss: 0.0169770 Test Loss: 0.0333828
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0163971
	speed: 0.0709s/iter; left time: 815.3033s
	iters: 200, epoch: 49 | loss: 0.0148533
	speed: 0.0361s/iter; left time: 411.0656s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.0157606 Vali Loss: 0.0168984 Test Loss: 0.0325417
Validation loss decreased (0.016937 --> 0.016898).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0165030
	speed: 0.0754s/iter; left time: 850.1677s
	iters: 200, epoch: 50 | loss: 0.0154998
	speed: 0.0404s/iter; left time: 450.8843s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.23s
Steps: 223 | Train Loss: 0.0157381 Vali Loss: 0.0169541 Test Loss: 0.0337758
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0161881
	speed: 0.0684s/iter; left time: 756.2690s
	iters: 200, epoch: 51 | loss: 0.0148654
	speed: 0.0344s/iter; left time: 376.4242s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.83s
Steps: 223 | Train Loss: 0.0157762 Vali Loss: 0.0169161 Test Loss: 0.0328058
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0165587
	speed: 0.0710s/iter; left time: 768.9931s
	iters: 200, epoch: 52 | loss: 0.0159679
	speed: 0.0345s/iter; left time: 370.4315s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:08.43s
Steps: 223 | Train Loss: 0.0157141 Vali Loss: 0.0169452 Test Loss: 0.0326098
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0154703
	speed: 0.0693s/iter; left time: 735.1127s
	iters: 200, epoch: 53 | loss: 0.0147402
	speed: 0.0390s/iter; left time: 410.0605s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:08.54s
Steps: 223 | Train Loss: 0.0157296 Vali Loss: 0.0169105 Test Loss: 0.0328408
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0152968
	speed: 0.0686s/iter; left time: 712.0448s
	iters: 200, epoch: 54 | loss: 0.0161895
	speed: 0.0345s/iter; left time: 355.1490s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:08.25s
Steps: 223 | Train Loss: 0.0157269 Vali Loss: 0.0169528 Test Loss: 0.0334324
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0161664
	speed: 0.0803s/iter; left time: 815.8882s
	iters: 200, epoch: 55 | loss: 0.0158240
	speed: 0.0360s/iter; left time: 361.9046s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:08.75s
Steps: 223 | Train Loss: 0.0157380 Vali Loss: 0.0169289 Test Loss: 0.0334821
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0162431
	speed: 0.0733s/iter; left time: 728.1013s
	iters: 200, epoch: 56 | loss: 0.0165172
	speed: 0.0352s/iter; left time: 346.0959s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0157867 Vali Loss: 0.0168710 Test Loss: 0.0329189
Validation loss decreased (0.016898 --> 0.016871).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0147179
	speed: 0.0909s/iter; left time: 883.1859s
	iters: 200, epoch: 57 | loss: 0.0167741
	speed: 0.0287s/iter; left time: 275.4427s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:08.83s
Steps: 223 | Train Loss: 0.0158918 Vali Loss: 0.0170040 Test Loss: 0.0338830
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0151420
	speed: 0.0704s/iter; left time: 668.3588s
	iters: 200, epoch: 58 | loss: 0.0155338
	speed: 0.0384s/iter; left time: 360.4754s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:08.67s
Steps: 223 | Train Loss: 0.0157274 Vali Loss: 0.0169733 Test Loss: 0.0335529
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0157903
	speed: 0.2107s/iter; left time: 1952.4927s
	iters: 200, epoch: 59 | loss: 0.0146947
	speed: 0.0352s/iter; left time: 322.4601s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:14.70s
Steps: 223 | Train Loss: 0.0157228 Vali Loss: 0.0170033 Test Loss: 0.0348816
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0163458
	speed: 0.3186s/iter; left time: 2881.3651s
	iters: 200, epoch: 60 | loss: 0.0159373
	speed: 0.1375s/iter; left time: 1230.1096s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:30.30s
Steps: 223 | Train Loss: 0.0157675 Vali Loss: 0.0168795 Test Loss: 0.0327201
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0158163
	speed: 0.0713s/iter; left time: 628.9268s
	iters: 200, epoch: 61 | loss: 0.0149162
	speed: 0.0465s/iter; left time: 405.5445s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:09.82s
Steps: 223 | Train Loss: 0.0157603 Vali Loss: 0.0169108 Test Loss: 0.0329584
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0162279
	speed: 0.0682s/iter; left time: 586.4561s
	iters: 200, epoch: 62 | loss: 0.0151691
	speed: 0.0337s/iter; left time: 286.5542s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:07.90s
Steps: 223 | Train Loss: 0.0157876 Vali Loss: 0.0169134 Test Loss: 0.0335492
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0156255
	speed: 0.0708s/iter; left time: 592.9511s
	iters: 200, epoch: 63 | loss: 0.0155422
	speed: 0.0362s/iter; left time: 299.2992s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:08.74s
Steps: 223 | Train Loss: 0.0157253 Vali Loss: 0.0169123 Test Loss: 0.0329814
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0164308
	speed: 0.0720s/iter; left time: 586.8696s
	iters: 200, epoch: 64 | loss: 0.0141026
	speed: 0.0332s/iter; left time: 267.2577s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0157296 Vali Loss: 0.0169038 Test Loss: 0.0327831
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0158460
	speed: 0.0657s/iter; left time: 520.8375s
	iters: 200, epoch: 65 | loss: 0.0152336
	speed: 0.0415s/iter; left time: 324.7403s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:08.77s
Steps: 223 | Train Loss: 0.0157248 Vali Loss: 0.0169858 Test Loss: 0.0333585
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0160218
	speed: 0.0774s/iter; left time: 596.1768s
	iters: 200, epoch: 66 | loss: 0.0162508
	speed: 0.0327s/iter; left time: 248.5706s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:08.78s
Steps: 223 | Train Loss: 0.0157725 Vali Loss: 0.0169603 Test Loss: 0.0329206
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : channel_mixing_ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03291890770196915, rmse:0.181435689330101, mae:0.12120398133993149, rse:0.5330417156219482
Intermediate time for ES and pred_len 168: 00h:12m:38.60sIntermediate time for ES: 00h:27m:51.83sTotal time: 00h:27m:51.84s