
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_96_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_96_24_ES_PatchTST_custom_ftM_sl96_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0267922
	speed: 0.0439s/iter; left time: 987.8115s
	iters: 200, epoch: 1 | loss: 0.0195768
	speed: 0.0163s/iter; left time: 364.5006s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.59s
Steps: 226 | Train Loss: 0.0295997 Vali Loss: 0.0166912 Test Loss: 0.0213410
Validation loss decreased (inf --> 0.016691).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0122195
	speed: 0.0459s/iter; left time: 1023.3861s
	iters: 200, epoch: 2 | loss: 0.0109789
	speed: 0.0194s/iter; left time: 430.6559s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.63s
Steps: 226 | Train Loss: 0.0117965 Vali Loss: 0.0094065 Test Loss: 0.0123087
Validation loss decreased (0.016691 --> 0.009406).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0093296
	speed: 0.0429s/iter; left time: 946.4987s
	iters: 200, epoch: 3 | loss: 0.0094486
	speed: 0.0200s/iter; left time: 439.9887s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.65s
Steps: 226 | Train Loss: 0.0094586 Vali Loss: 0.0088756 Test Loss: 0.0117917
Validation loss decreased (0.009406 --> 0.008876).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0093523
	speed: 0.0430s/iter; left time: 937.8723s
	iters: 200, epoch: 4 | loss: 0.0088712
	speed: 0.0234s/iter; left time: 508.1298s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.63s
Steps: 226 | Train Loss: 0.0088098 Vali Loss: 0.0086944 Test Loss: 0.0116282
Validation loss decreased (0.008876 --> 0.008694).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0086567
	speed: 0.0417s/iter; left time: 900.3805s
	iters: 200, epoch: 5 | loss: 0.0069733
	speed: 0.0227s/iter; left time: 486.9472s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.51s
Steps: 226 | Train Loss: 0.0083599 Vali Loss: 0.0086526 Test Loss: 0.0115494
Validation loss decreased (0.008694 --> 0.008653).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0081536
	speed: 0.0370s/iter; left time: 790.9505s
	iters: 200, epoch: 6 | loss: 0.0069282
	speed: 0.0229s/iter; left time: 487.4311s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.51s
Steps: 226 | Train Loss: 0.0080306 Vali Loss: 0.0084352 Test Loss: 0.0112584
Validation loss decreased (0.008653 --> 0.008435).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0076914
	speed: 0.0388s/iter; left time: 819.5598s
	iters: 200, epoch: 7 | loss: 0.0077376
	speed: 0.0221s/iter; left time: 466.1116s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0077208 Vali Loss: 0.0084026 Test Loss: 0.0113544
Validation loss decreased (0.008435 --> 0.008403).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0075021
	speed: 0.0387s/iter; left time: 808.9591s
	iters: 200, epoch: 8 | loss: 0.0080163
	speed: 0.0236s/iter; left time: 491.3997s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.62s
Steps: 226 | Train Loss: 0.0074480 Vali Loss: 0.0085301 Test Loss: 0.0116779
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0070147
	speed: 0.0357s/iter; left time: 738.4469s
	iters: 200, epoch: 9 | loss: 0.0072123
	speed: 0.0222s/iter; left time: 456.5276s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.48s
Steps: 226 | Train Loss: 0.0071865 Vali Loss: 0.0083577 Test Loss: 0.0115945
Validation loss decreased (0.008403 --> 0.008358).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0069964
	speed: 0.0389s/iter; left time: 796.8201s
	iters: 200, epoch: 10 | loss: 0.0068249
	speed: 0.0227s/iter; left time: 462.1933s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.62s
Steps: 226 | Train Loss: 0.0069206 Vali Loss: 0.0087676 Test Loss: 0.0121050
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0071934
	speed: 0.0353s/iter; left time: 714.0918s
	iters: 200, epoch: 11 | loss: 0.0065778
	speed: 0.0245s/iter; left time: 493.0897s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.67s
Steps: 226 | Train Loss: 0.0066644 Vali Loss: 0.0085964 Test Loss: 0.0120603
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0072954
	speed: 0.0358s/iter; left time: 717.4733s
	iters: 200, epoch: 12 | loss: 0.0067187
	speed: 0.0238s/iter; left time: 473.7325s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.69s
Steps: 226 | Train Loss: 0.0064917 Vali Loss: 0.0086457 Test Loss: 0.0120428
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0058575
	speed: 0.0363s/iter; left time: 717.7930s
	iters: 200, epoch: 13 | loss: 0.0061792
	speed: 0.0240s/iter; left time: 473.4328s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.75s
Steps: 226 | Train Loss: 0.0062382 Vali Loss: 0.0085987 Test Loss: 0.0123390
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0060048
	speed: 0.0364s/iter; left time: 712.2198s
	iters: 200, epoch: 14 | loss: 0.0065187
	speed: 0.0227s/iter; left time: 441.4586s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.61s
Steps: 226 | Train Loss: 0.0060652 Vali Loss: 0.0087850 Test Loss: 0.0122426
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0059778
	speed: 0.0344s/iter; left time: 666.0888s
	iters: 200, epoch: 15 | loss: 0.0059392
	speed: 0.0227s/iter; left time: 435.9288s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.52s
Steps: 226 | Train Loss: 0.0058822 Vali Loss: 0.0089802 Test Loss: 0.0124355
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0056377
	speed: 0.0376s/iter; left time: 718.4307s
	iters: 200, epoch: 16 | loss: 0.0053625
	speed: 0.0203s/iter; left time: 385.9553s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.74s
Steps: 226 | Train Loss: 0.0057311 Vali Loss: 0.0089195 Test Loss: 0.0126711
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0050651
	speed: 0.0386s/iter; left time: 729.7615s
	iters: 200, epoch: 17 | loss: 0.0050484
	speed: 0.0187s/iter; left time: 351.8201s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.40s
Steps: 226 | Train Loss: 0.0055950 Vali Loss: 0.0089465 Test Loss: 0.0125136
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0048361
	speed: 0.0381s/iter; left time: 711.0792s
	iters: 200, epoch: 18 | loss: 0.0054747
	speed: 0.0163s/iter; left time: 302.5829s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.17s
Steps: 226 | Train Loss: 0.0054673 Vali Loss: 0.0090529 Test Loss: 0.0126415
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0062222
	speed: 0.0500s/iter; left time: 921.1105s
	iters: 200, epoch: 19 | loss: 0.0052610
	speed: 0.0245s/iter; left time: 448.9730s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.83s
Steps: 226 | Train Loss: 0.0053649 Vali Loss: 0.0089901 Test Loss: 0.0127423
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_96_24_ES_PatchTST_custom_ftM_sl96_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011594521813094616, rmse:0.10767786204814911, mae:0.06868013739585876, rse:0.3168829381465912
Intermediate time for ES and pred_len 24: 00h:02m:06.00s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_96_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_96_96_ES_PatchTST_custom_ftM_sl96_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0343245
	speed: 0.0541s/iter; left time: 1218.3482s
	iters: 200, epoch: 1 | loss: 0.0278460
	speed: 0.0238s/iter; left time: 532.3629s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.05s
Steps: 226 | Train Loss: 0.0365318 Vali Loss: 0.0239262 Test Loss: 0.0309951
Validation loss decreased (inf --> 0.023926).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0185223
	speed: 0.0487s/iter; left time: 1085.7438s
	iters: 200, epoch: 2 | loss: 0.0166251
	speed: 0.0245s/iter; left time: 542.2201s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.91s
Steps: 226 | Train Loss: 0.0192041 Vali Loss: 0.0168355 Test Loss: 0.0217300
Validation loss decreased (0.023926 --> 0.016835).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0160262
	speed: 0.0466s/iter; left time: 1028.2645s
	iters: 200, epoch: 3 | loss: 0.0156437
	speed: 0.0268s/iter; left time: 588.3309s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.31s
Steps: 226 | Train Loss: 0.0163757 Vali Loss: 0.0161367 Test Loss: 0.0212674
Validation loss decreased (0.016835 --> 0.016137).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0143373
	speed: 0.0502s/iter; left time: 1095.8093s
	iters: 200, epoch: 4 | loss: 0.0144804
	speed: 0.0275s/iter; left time: 596.7106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.09s
Steps: 226 | Train Loss: 0.0152966 Vali Loss: 0.0164544 Test Loss: 0.0214458
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0147964
	speed: 0.0493s/iter; left time: 1065.0733s
	iters: 200, epoch: 5 | loss: 0.0139811
	speed: 0.0281s/iter; left time: 604.9082s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.31s
Steps: 226 | Train Loss: 0.0141186 Vali Loss: 0.0169926 Test Loss: 0.0220698
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0130579
	speed: 0.0502s/iter; left time: 1071.9956s
	iters: 200, epoch: 6 | loss: 0.0136196
	speed: 0.0255s/iter; left time: 541.5579s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0131513 Vali Loss: 0.0174595 Test Loss: 0.0227895
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0127381
	speed: 0.0504s/iter; left time: 1065.9463s
	iters: 200, epoch: 7 | loss: 0.0121172
	speed: 0.0274s/iter; left time: 577.3366s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.60s
Steps: 226 | Train Loss: 0.0122806 Vali Loss: 0.0182827 Test Loss: 0.0238469
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0118271
	speed: 0.0505s/iter; left time: 1057.4361s
	iters: 200, epoch: 8 | loss: 0.0116580
	speed: 0.0279s/iter; left time: 580.2713s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.30s
Steps: 226 | Train Loss: 0.0115656 Vali Loss: 0.0178909 Test Loss: 0.0232985
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0110704
	speed: 0.0488s/iter; left time: 1010.4045s
	iters: 200, epoch: 9 | loss: 0.0109119
	speed: 0.0255s/iter; left time: 524.4640s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.38s
Steps: 226 | Train Loss: 0.0109450 Vali Loss: 0.0181275 Test Loss: 0.0236892
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0099459
	speed: 0.0482s/iter; left time: 985.9528s
	iters: 200, epoch: 10 | loss: 0.0107087
	speed: 0.0228s/iter; left time: 465.0159s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.83s
Steps: 226 | Train Loss: 0.0104373 Vali Loss: 0.0185834 Test Loss: 0.0238976
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0096758
	speed: 0.0480s/iter; left time: 971.7841s
	iters: 200, epoch: 11 | loss: 0.0101523
	speed: 0.0268s/iter; left time: 540.6212s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.18s
Steps: 226 | Train Loss: 0.0100447 Vali Loss: 0.0185717 Test Loss: 0.0243262
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0096044
	speed: 0.0490s/iter; left time: 981.5633s
	iters: 200, epoch: 12 | loss: 0.0093817
	speed: 0.0264s/iter; left time: 524.7612s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.16s
Steps: 226 | Train Loss: 0.0096178 Vali Loss: 0.0189246 Test Loss: 0.0249068
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0095338
	speed: 0.0471s/iter; left time: 932.7408s
	iters: 200, epoch: 13 | loss: 0.0096964
	speed: 0.0236s/iter; left time: 465.1052s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.77s
Steps: 226 | Train Loss: 0.0093259 Vali Loss: 0.0187492 Test Loss: 0.0248805
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_96_96_ES_PatchTST_custom_ftM_sl96_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.02126738242805004, rmse:0.14583340287208557, mae:0.09827333688735962, rse:0.4284146726131439
Intermediate time for ES and pred_len 96: 00h:01m:48.87s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_96_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=1, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_96_168_ES_PatchTST_custom_ftM_sl96_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0353431
	speed: 0.0452s/iter; left time: 1013.0117s
	iters: 200, epoch: 1 | loss: 0.0268961
	speed: 0.0226s/iter; left time: 504.3959s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.0376616 Vali Loss: 0.0256392 Test Loss: 0.0331292
Validation loss decreased (inf --> 0.025639).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0218692
	speed: 0.0434s/iter; left time: 963.5274s
	iters: 200, epoch: 2 | loss: 0.0194052
	speed: 0.0259s/iter; left time: 571.7841s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.80s
Steps: 225 | Train Loss: 0.0208068 Vali Loss: 0.0188844 Test Loss: 0.0242439
Validation loss decreased (0.025639 --> 0.018884).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0169687
	speed: 0.0490s/iter; left time: 1076.1243s
	iters: 200, epoch: 3 | loss: 0.0190523
	speed: 0.0219s/iter; left time: 479.3272s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.46s
Steps: 225 | Train Loss: 0.0179892 Vali Loss: 0.0185537 Test Loss: 0.0235893
Validation loss decreased (0.018884 --> 0.018554).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0169186
	speed: 0.0498s/iter; left time: 1082.8328s
	iters: 200, epoch: 4 | loss: 0.0175947
	speed: 0.0211s/iter; left time: 455.6899s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.48s
Steps: 225 | Train Loss: 0.0167937 Vali Loss: 0.0184703 Test Loss: 0.0235688
Validation loss decreased (0.018554 --> 0.018470).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0160075
	speed: 0.0458s/iter; left time: 984.4546s
	iters: 200, epoch: 5 | loss: 0.0160217
	speed: 0.0264s/iter; left time: 564.3883s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.76s
Steps: 225 | Train Loss: 0.0157294 Vali Loss: 0.0188542 Test Loss: 0.0238975
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0145555
	speed: 0.0511s/iter; left time: 1086.5256s
	iters: 200, epoch: 6 | loss: 0.0143680
	speed: 0.0217s/iter; left time: 458.8588s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.58s
Steps: 225 | Train Loss: 0.0147236 Vali Loss: 0.0194211 Test Loss: 0.0247843
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0145234
	speed: 0.0481s/iter; left time: 1011.5290s
	iters: 200, epoch: 7 | loss: 0.0138711
	speed: 0.0291s/iter; left time: 609.5635s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.57s
Steps: 225 | Train Loss: 0.0138673 Vali Loss: 0.0195423 Test Loss: 0.0247844
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0137212
	speed: 0.0466s/iter; left time: 971.0173s
	iters: 200, epoch: 8 | loss: 0.0138608
	speed: 0.0252s/iter; left time: 521.6015s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.65s
Steps: 225 | Train Loss: 0.0131192 Vali Loss: 0.0199592 Test Loss: 0.0254863
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0122447
	speed: 0.0462s/iter; left time: 951.0470s
	iters: 200, epoch: 9 | loss: 0.0126505
	speed: 0.0252s/iter; left time: 516.4415s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.00s
Steps: 225 | Train Loss: 0.0124965 Vali Loss: 0.0200359 Test Loss: 0.0256357
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0119075
	speed: 0.0474s/iter; left time: 966.0763s
	iters: 200, epoch: 10 | loss: 0.0112254
	speed: 0.0265s/iter; left time: 537.4212s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.94s
Steps: 225 | Train Loss: 0.0119626 Vali Loss: 0.0205519 Test Loss: 0.0257522
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0117490
	speed: 0.0452s/iter; left time: 910.8598s
	iters: 200, epoch: 11 | loss: 0.0122202
	speed: 0.0285s/iter; left time: 571.8669s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.42s
Steps: 225 | Train Loss: 0.0114586 Vali Loss: 0.0203659 Test Loss: 0.0264138
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0113394
	speed: 0.0491s/iter; left time: 977.8944s
	iters: 200, epoch: 12 | loss: 0.0116394
	speed: 0.0282s/iter; left time: 558.4294s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.42s
Steps: 225 | Train Loss: 0.0110902 Vali Loss: 0.0204172 Test Loss: 0.0262498
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0106933
	speed: 0.0504s/iter; left time: 993.6019s
	iters: 200, epoch: 13 | loss: 0.0108677
	speed: 0.0267s/iter; left time: 523.3469s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.36s
Steps: 225 | Train Loss: 0.0107315 Vali Loss: 0.0206860 Test Loss: 0.0266960
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0113744
	speed: 0.0525s/iter; left time: 1023.3682s
	iters: 200, epoch: 14 | loss: 0.0098004
	speed: 0.0235s/iter; left time: 455.5247s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.11s
Steps: 225 | Train Loss: 0.0104362 Vali Loss: 0.0206958 Test Loss: 0.0264268
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_96_168_ES_PatchTST_custom_ftM_sl96_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023568790405988693, rmse:0.15352129936218262, mae:0.10385473817586899, rse:0.45103174448013306
Intermediate time for ES and pred_len 168: 00h:01m:53.63sIntermediate time for ES: 00h:05m:48.49sTotal time: 00h:05m:48.50s