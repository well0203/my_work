
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_168_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_168_24_DE_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0383199
	speed: 0.0538s/iter; left time: 1210.6422s
	iters: 200, epoch: 1 | loss: 0.0312549
	speed: 0.0263s/iter; left time: 590.0308s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.19s
Steps: 226 | Train Loss: 0.0377966 Vali Loss: 0.0340360 Test Loss: 0.0390400
Validation loss decreased (inf --> 0.034036).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0153823
	speed: 0.0444s/iter; left time: 988.6494s
	iters: 200, epoch: 2 | loss: 0.0156625
	speed: 0.0235s/iter; left time: 521.2420s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.16s
Steps: 226 | Train Loss: 0.0177919 Vali Loss: 0.0212845 Test Loss: 0.0229115
Validation loss decreased (0.034036 --> 0.021285).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0143448
	speed: 0.0464s/iter; left time: 1022.2165s
	iters: 200, epoch: 3 | loss: 0.0157216
	speed: 0.0227s/iter; left time: 499.3058s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.64s
Steps: 226 | Train Loss: 0.0150513 Vali Loss: 0.0200835 Test Loss: 0.0220109
Validation loss decreased (0.021285 --> 0.020084).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0155801
	speed: 0.0444s/iter; left time: 968.1773s
	iters: 200, epoch: 4 | loss: 0.0138919
	speed: 0.0219s/iter; left time: 475.6993s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.24s
Steps: 226 | Train Loss: 0.0143696 Vali Loss: 0.0197017 Test Loss: 0.0216145
Validation loss decreased (0.020084 --> 0.019702).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0155787
	speed: 0.0520s/iter; left time: 1123.7833s
	iters: 200, epoch: 5 | loss: 0.0120253
	speed: 0.0255s/iter; left time: 547.2439s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.04s
Steps: 226 | Train Loss: 0.0140176 Vali Loss: 0.0197954 Test Loss: 0.0217132
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0116973
	speed: 0.0473s/iter; left time: 1010.2116s
	iters: 200, epoch: 6 | loss: 0.0129933
	speed: 0.0275s/iter; left time: 584.2606s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.13s
Steps: 226 | Train Loss: 0.0137816 Vali Loss: 0.0194198 Test Loss: 0.0212227
Validation loss decreased (0.019702 --> 0.019420).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0148134
	speed: 0.0510s/iter; left time: 1077.4099s
	iters: 200, epoch: 7 | loss: 0.0137267
	speed: 0.0265s/iter; left time: 558.1370s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0136141 Vali Loss: 0.0193366 Test Loss: 0.0213316
Validation loss decreased (0.019420 --> 0.019337).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0116126
	speed: 0.0460s/iter; left time: 961.8929s
	iters: 200, epoch: 8 | loss: 0.0123869
	speed: 0.0185s/iter; left time: 385.2594s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0135009 Vali Loss: 0.0191222 Test Loss: 0.0213271
Validation loss decreased (0.019337 --> 0.019122).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0126129
	speed: 0.0480s/iter; left time: 994.0540s
	iters: 200, epoch: 9 | loss: 0.0113241
	speed: 0.0280s/iter; left time: 575.9233s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.50s
Steps: 226 | Train Loss: 0.0133891 Vali Loss: 0.0191334 Test Loss: 0.0211914
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0143735
	speed: 0.0497s/iter; left time: 1017.7869s
	iters: 200, epoch: 10 | loss: 0.0132874
	speed: 0.0210s/iter; left time: 427.3026s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.39s
Steps: 226 | Train Loss: 0.0132893 Vali Loss: 0.0191786 Test Loss: 0.0212638
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0139704
	speed: 0.0473s/iter; left time: 957.6863s
	iters: 200, epoch: 11 | loss: 0.0125956
	speed: 0.0253s/iter; left time: 509.4556s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.07s
Steps: 226 | Train Loss: 0.0132077 Vali Loss: 0.0191151 Test Loss: 0.0212688
Validation loss decreased (0.019122 --> 0.019115).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0130513
	speed: 0.0502s/iter; left time: 1004.8599s
	iters: 200, epoch: 12 | loss: 0.0148896
	speed: 0.0255s/iter; left time: 508.3369s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.10s
Steps: 226 | Train Loss: 0.0131658 Vali Loss: 0.0190011 Test Loss: 0.0211472
Validation loss decreased (0.019115 --> 0.019001).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0128899
	speed: 0.0478s/iter; left time: 946.5364s
	iters: 200, epoch: 13 | loss: 0.0118731
	speed: 0.0253s/iter; left time: 498.1929s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.02s
Steps: 226 | Train Loss: 0.0131046 Vali Loss: 0.0189218 Test Loss: 0.0210358
Validation loss decreased (0.019001 --> 0.018922).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0133532
	speed: 0.0469s/iter; left time: 917.2947s
	iters: 200, epoch: 14 | loss: 0.0144624
	speed: 0.0254s/iter; left time: 494.8066s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.74s
Steps: 226 | Train Loss: 0.0130366 Vali Loss: 0.0189040 Test Loss: 0.0210546
Validation loss decreased (0.018922 --> 0.018904).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0130911
	speed: 0.0488s/iter; left time: 943.7265s
	iters: 200, epoch: 15 | loss: 0.0122813
	speed: 0.0263s/iter; left time: 506.8760s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.16s
Steps: 226 | Train Loss: 0.0129929 Vali Loss: 0.0188822 Test Loss: 0.0209941
Validation loss decreased (0.018904 --> 0.018882).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0127345
	speed: 0.0504s/iter; left time: 963.2289s
	iters: 200, epoch: 16 | loss: 0.0142818
	speed: 0.0271s/iter; left time: 514.6393s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.42s
Steps: 226 | Train Loss: 0.0129400 Vali Loss: 0.0188522 Test Loss: 0.0209537
Validation loss decreased (0.018882 --> 0.018852).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0127672
	speed: 0.0469s/iter; left time: 886.4343s
	iters: 200, epoch: 17 | loss: 0.0128871
	speed: 0.0204s/iter; left time: 382.6192s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.95s
Steps: 226 | Train Loss: 0.0129139 Vali Loss: 0.0188519 Test Loss: 0.0210161
Validation loss decreased (0.018852 --> 0.018852).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0121936
	speed: 0.0476s/iter; left time: 887.5064s
	iters: 200, epoch: 18 | loss: 0.0122830
	speed: 0.0253s/iter; left time: 469.2159s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.08s
Steps: 226 | Train Loss: 0.0128742 Vali Loss: 0.0188405 Test Loss: 0.0209885
Validation loss decreased (0.018852 --> 0.018841).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0152183
	speed: 0.0461s/iter; left time: 848.9115s
	iters: 200, epoch: 19 | loss: 0.0130465
	speed: 0.0257s/iter; left time: 470.2621s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.74s
Steps: 226 | Train Loss: 0.0128390 Vali Loss: 0.0188048 Test Loss: 0.0209550
Validation loss decreased (0.018841 --> 0.018805).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0138098
	speed: 0.0483s/iter; left time: 879.3514s
	iters: 200, epoch: 20 | loss: 0.0152119
	speed: 0.0266s/iter; left time: 480.9686s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.14s
Steps: 226 | Train Loss: 0.0128229 Vali Loss: 0.0186983 Test Loss: 0.0209512
Validation loss decreased (0.018805 --> 0.018698).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0121355
	speed: 0.0476s/iter; left time: 855.5641s
	iters: 200, epoch: 21 | loss: 0.0112943
	speed: 0.0263s/iter; left time: 470.2271s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.00s
Steps: 226 | Train Loss: 0.0127835 Vali Loss: 0.0188119 Test Loss: 0.0209863
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0121620
	speed: 0.0465s/iter; left time: 826.2803s
	iters: 200, epoch: 22 | loss: 0.0122019
	speed: 0.0278s/iter; left time: 490.1601s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.13s
Steps: 226 | Train Loss: 0.0127699 Vali Loss: 0.0188123 Test Loss: 0.0210200
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0129834
	speed: 0.0496s/iter; left time: 869.7931s
	iters: 200, epoch: 23 | loss: 0.0121842
	speed: 0.0200s/iter; left time: 348.6718s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.32s
Steps: 226 | Train Loss: 0.0127693 Vali Loss: 0.0187909 Test Loss: 0.0210002
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0110590
	speed: 0.0414s/iter; left time: 717.1757s
	iters: 200, epoch: 24 | loss: 0.0139926
	speed: 0.0188s/iter; left time: 324.1019s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.58s
Steps: 226 | Train Loss: 0.0127507 Vali Loss: 0.0187344 Test Loss: 0.0209447
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0128071
	speed: 0.0464s/iter; left time: 791.6337s
	iters: 200, epoch: 25 | loss: 0.0132529
	speed: 0.0251s/iter; left time: 426.4795s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.00s
Steps: 226 | Train Loss: 0.0127247 Vali Loss: 0.0188031 Test Loss: 0.0209953
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0114409
	speed: 0.0433s/iter; left time: 729.4194s
	iters: 200, epoch: 26 | loss: 0.0129284
	speed: 0.0234s/iter; left time: 392.6331s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.34s
Steps: 226 | Train Loss: 0.0127187 Vali Loss: 0.0188277 Test Loss: 0.0209686
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0145785
	speed: 0.0469s/iter; left time: 780.0009s
	iters: 200, epoch: 27 | loss: 0.0137299
	speed: 0.0258s/iter; left time: 426.4586s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.92s
Steps: 226 | Train Loss: 0.0127071 Vali Loss: 0.0187976 Test Loss: 0.0209546
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0120018
	speed: 0.0482s/iter; left time: 791.0466s
	iters: 200, epoch: 28 | loss: 0.0117700
	speed: 0.0273s/iter; left time: 445.3811s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0126744 Vali Loss: 0.0187394 Test Loss: 0.0209601
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0133241
	speed: 0.0510s/iter; left time: 824.5815s
	iters: 200, epoch: 29 | loss: 0.0133722
	speed: 0.0264s/iter; left time: 424.8904s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0126740 Vali Loss: 0.0187694 Test Loss: 0.0209734
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0131072
	speed: 0.0468s/iter; left time: 746.9519s
	iters: 200, epoch: 30 | loss: 0.0118285
	speed: 0.0256s/iter; left time: 405.8730s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.89s
Steps: 226 | Train Loss: 0.0126849 Vali Loss: 0.0186991 Test Loss: 0.0209547
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_24_DE_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.020951194688677788, rmse:0.14474527537822723, mae:0.09142162650823593, rse:0.5108261108398438
Intermediate time for DE and pred_len 24: 00h:03m:48.69s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_168_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_168_96_DE_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0411841
	speed: 0.0479s/iter; left time: 1072.1390s
	iters: 200, epoch: 1 | loss: 0.0347563
	speed: 0.0200s/iter; left time: 445.6445s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.26s
Steps: 225 | Train Loss: 0.0428926 Vali Loss: 0.0408700 Test Loss: 0.0488379
Validation loss decreased (inf --> 0.040870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0280918
	speed: 0.0529s/iter; left time: 1172.3212s
	iters: 200, epoch: 2 | loss: 0.0259415
	speed: 0.0274s/iter; left time: 604.1406s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.42s
Steps: 225 | Train Loss: 0.0278961 Vali Loss: 0.0323799 Test Loss: 0.0383353
Validation loss decreased (0.040870 --> 0.032380).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0256202
	speed: 0.0543s/iter; left time: 1191.7391s
	iters: 200, epoch: 3 | loss: 0.0249472
	speed: 0.0268s/iter; left time: 586.5331s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.40s
Steps: 225 | Train Loss: 0.0248436 Vali Loss: 0.0313352 Test Loss: 0.0374697
Validation loss decreased (0.032380 --> 0.031335).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0231897
	speed: 0.0543s/iter; left time: 1179.5102s
	iters: 200, epoch: 4 | loss: 0.0219180
	speed: 0.0273s/iter; left time: 590.1255s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.49s
Steps: 225 | Train Loss: 0.0240810 Vali Loss: 0.0309673 Test Loss: 0.0371241
Validation loss decreased (0.031335 --> 0.030967).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0224635
	speed: 0.0535s/iter; left time: 1150.8540s
	iters: 200, epoch: 5 | loss: 0.0248532
	speed: 0.0252s/iter; left time: 539.9441s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.19s
Steps: 225 | Train Loss: 0.0236383 Vali Loss: 0.0312279 Test Loss: 0.0370489
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0259781
	speed: 0.0527s/iter; left time: 1120.8972s
	iters: 200, epoch: 6 | loss: 0.0241365
	speed: 0.0239s/iter; left time: 505.9149s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.25s
Steps: 225 | Train Loss: 0.0232959 Vali Loss: 0.0309534 Test Loss: 0.0370188
Validation loss decreased (0.030967 --> 0.030953).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0221646
	speed: 0.0525s/iter; left time: 1105.9718s
	iters: 200, epoch: 7 | loss: 0.0239294
	speed: 0.0302s/iter; left time: 632.4346s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.49s
Steps: 225 | Train Loss: 0.0231015 Vali Loss: 0.0309000 Test Loss: 0.0367180
Validation loss decreased (0.030953 --> 0.030900).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0237838
	speed: 0.0575s/iter; left time: 1197.4413s
	iters: 200, epoch: 8 | loss: 0.0253054
	speed: 0.0306s/iter; left time: 633.5904s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.11s
Steps: 225 | Train Loss: 0.0229007 Vali Loss: 0.0309551 Test Loss: 0.0369570
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0234542
	speed: 0.0540s/iter; left time: 1112.7232s
	iters: 200, epoch: 9 | loss: 0.0214983
	speed: 0.0306s/iter; left time: 626.9084s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.89s
Steps: 225 | Train Loss: 0.0227605 Vali Loss: 0.0308411 Test Loss: 0.0365352
Validation loss decreased (0.030900 --> 0.030841).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0219778
	speed: 0.0546s/iter; left time: 1113.0700s
	iters: 200, epoch: 10 | loss: 0.0220064
	speed: 0.0286s/iter; left time: 578.9570s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.68s
Steps: 225 | Train Loss: 0.0225765 Vali Loss: 0.0307082 Test Loss: 0.0365368
Validation loss decreased (0.030841 --> 0.030708).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0229735
	speed: 0.0555s/iter; left time: 1118.1702s
	iters: 200, epoch: 11 | loss: 0.0225767
	speed: 0.0293s/iter; left time: 586.9332s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.75s
Steps: 225 | Train Loss: 0.0224487 Vali Loss: 0.0306180 Test Loss: 0.0365732
Validation loss decreased (0.030708 --> 0.030618).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0217478
	speed: 0.0521s/iter; left time: 1038.9132s
	iters: 200, epoch: 12 | loss: 0.0245087
	speed: 0.0237s/iter; left time: 470.6473s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.71s
Steps: 225 | Train Loss: 0.0223362 Vali Loss: 0.0307271 Test Loss: 0.0367705
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0234131
	speed: 0.0498s/iter; left time: 980.9358s
	iters: 200, epoch: 13 | loss: 0.0227327
	speed: 0.0203s/iter; left time: 396.9530s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.28s
Steps: 225 | Train Loss: 0.0222529 Vali Loss: 0.0309070 Test Loss: 0.0368769
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0223071
	speed: 0.0502s/iter; left time: 978.3189s
	iters: 200, epoch: 14 | loss: 0.0235474
	speed: 0.0263s/iter; left time: 509.9303s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.34s
Steps: 225 | Train Loss: 0.0221733 Vali Loss: 0.0307393 Test Loss: 0.0366288
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0220968
	speed: 0.0534s/iter; left time: 1027.1092s
	iters: 200, epoch: 15 | loss: 0.0209606
	speed: 0.0284s/iter; left time: 544.7682s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.57s
Steps: 225 | Train Loss: 0.0221032 Vali Loss: 0.0307878 Test Loss: 0.0366282
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0221824
	speed: 0.0531s/iter; left time: 1011.0572s
	iters: 200, epoch: 16 | loss: 0.0217833
	speed: 0.0269s/iter; left time: 509.2177s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.37s
Steps: 225 | Train Loss: 0.0220159 Vali Loss: 0.0307263 Test Loss: 0.0364834
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0211384
	speed: 0.0488s/iter; left time: 918.3960s
	iters: 200, epoch: 17 | loss: 0.0233507
	speed: 0.0268s/iter; left time: 501.8258s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.89s
Steps: 225 | Train Loss: 0.0219597 Vali Loss: 0.0307062 Test Loss: 0.0367133
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0248679
	speed: 0.0519s/iter; left time: 963.8943s
	iters: 200, epoch: 18 | loss: 0.0207510
	speed: 0.0271s/iter; left time: 500.7151s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0218721 Vali Loss: 0.0306500 Test Loss: 0.0365560
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0224404
	speed: 0.0491s/iter; left time: 900.1339s
	iters: 200, epoch: 19 | loss: 0.0215610
	speed: 0.0243s/iter; left time: 444.1266s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.54s
Steps: 225 | Train Loss: 0.0218504 Vali Loss: 0.0308245 Test Loss: 0.0366136
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0218998
	speed: 0.0529s/iter; left time: 958.2390s
	iters: 200, epoch: 20 | loss: 0.0231873
	speed: 0.0268s/iter; left time: 483.1225s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.25s
Steps: 225 | Train Loss: 0.0218139 Vali Loss: 0.0308543 Test Loss: 0.0368732
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0215853
	speed: 0.0448s/iter; left time: 801.9054s
	iters: 200, epoch: 21 | loss: 0.0210817
	speed: 0.0195s/iter; left time: 346.5337s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.66s
Steps: 225 | Train Loss: 0.0217619 Vali Loss: 0.0308317 Test Loss: 0.0368701
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_96_DE_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.036573249846696854, rmse:0.1912413388490677, mae:0.12977558374404907, rse:0.6772242784500122
Intermediate time for DE and pred_len 96: 00h:02m:56.07s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_168_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_168_168_DE_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0447109
	speed: 0.0359s/iter; left time: 803.6922s
	iters: 200, epoch: 1 | loss: 0.0350626
	speed: 0.0223s/iter; left time: 497.7267s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.42s
Steps: 225 | Train Loss: 0.0450947 Vali Loss: 0.0424763 Test Loss: 0.0511885
Validation loss decreased (inf --> 0.042476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0322759
	speed: 0.0457s/iter; left time: 1013.7407s
	iters: 200, epoch: 2 | loss: 0.0286798
	speed: 0.0212s/iter; left time: 468.1730s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0307300 Vali Loss: 0.0340023 Test Loss: 0.0414040
Validation loss decreased (0.042476 --> 0.034002).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0276802
	speed: 0.0483s/iter; left time: 1060.7960s
	iters: 200, epoch: 3 | loss: 0.0266256
	speed: 0.0213s/iter; left time: 465.3776s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.07s
Steps: 225 | Train Loss: 0.0274781 Vali Loss: 0.0334509 Test Loss: 0.0405938
Validation loss decreased (0.034002 --> 0.033451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0282453
	speed: 0.0470s/iter; left time: 1020.1148s
	iters: 200, epoch: 4 | loss: 0.0259354
	speed: 0.0198s/iter; left time: 427.5512s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.74s
Steps: 225 | Train Loss: 0.0266396 Vali Loss: 0.0331835 Test Loss: 0.0402118
Validation loss decreased (0.033451 --> 0.033183).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0275930
	speed: 0.0499s/iter; left time: 1073.3855s
	iters: 200, epoch: 5 | loss: 0.0242258
	speed: 0.0199s/iter; left time: 425.6363s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.84s
Steps: 225 | Train Loss: 0.0261759 Vali Loss: 0.0331400 Test Loss: 0.0401583
Validation loss decreased (0.033183 --> 0.033140).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0249907
	speed: 0.0462s/iter; left time: 982.1340s
	iters: 200, epoch: 6 | loss: 0.0265714
	speed: 0.0209s/iter; left time: 442.0510s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0258694 Vali Loss: 0.0327760 Test Loss: 0.0400483
Validation loss decreased (0.033140 --> 0.032776).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0262237
	speed: 0.0496s/iter; left time: 1044.8968s
	iters: 200, epoch: 7 | loss: 0.0241183
	speed: 0.0195s/iter; left time: 409.0684s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.82s
Steps: 225 | Train Loss: 0.0256120 Vali Loss: 0.0329920 Test Loss: 0.0398653
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0235487
	speed: 0.0476s/iter; left time: 990.3748s
	iters: 200, epoch: 8 | loss: 0.0245051
	speed: 0.0235s/iter; left time: 486.1281s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.27s
Steps: 225 | Train Loss: 0.0254211 Vali Loss: 0.0331922 Test Loss: 0.0402371
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0269264
	speed: 0.0531s/iter; left time: 1094.1857s
	iters: 200, epoch: 9 | loss: 0.0250130
	speed: 0.0251s/iter; left time: 514.2615s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.72s
Steps: 225 | Train Loss: 0.0252059 Vali Loss: 0.0330678 Test Loss: 0.0398848
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0238565
	speed: 0.0691s/iter; left time: 1408.9169s
	iters: 200, epoch: 10 | loss: 0.0237731
	speed: 0.0285s/iter; left time: 577.4320s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.59s
Steps: 225 | Train Loss: 0.0250347 Vali Loss: 0.0327603 Test Loss: 0.0400813
Validation loss decreased (0.032776 --> 0.032760).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0244635
	speed: 0.0768s/iter; left time: 1547.0035s
	iters: 200, epoch: 11 | loss: 0.0232718
	speed: 0.0270s/iter; left time: 541.0004s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.68s
Steps: 225 | Train Loss: 0.0248838 Vali Loss: 0.0326611 Test Loss: 0.0401495
Validation loss decreased (0.032760 --> 0.032661).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0247994
	speed: 0.0771s/iter; left time: 1536.4119s
	iters: 200, epoch: 12 | loss: 0.0246821
	speed: 0.0276s/iter; left time: 546.5131s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.01s
Steps: 225 | Train Loss: 0.0247419 Vali Loss: 0.0327078 Test Loss: 0.0401618
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0239694
	speed: 0.0842s/iter; left time: 1659.3024s
	iters: 200, epoch: 13 | loss: 0.0218429
	speed: 0.0284s/iter; left time: 557.6432s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.93s
Steps: 225 | Train Loss: 0.0246602 Vali Loss: 0.0327330 Test Loss: 0.0401319
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0255009
	speed: 0.0678s/iter; left time: 1319.6675s
	iters: 200, epoch: 14 | loss: 0.0252126
	speed: 0.0275s/iter; left time: 533.3919s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.39s
Steps: 225 | Train Loss: 0.0245515 Vali Loss: 0.0327835 Test Loss: 0.0401811
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0236850
	speed: 0.0792s/iter; left time: 1525.1057s
	iters: 200, epoch: 15 | loss: 0.0246431
	speed: 0.0250s/iter; left time: 478.4968s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.20s
Steps: 225 | Train Loss: 0.0244478 Vali Loss: 0.0326965 Test Loss: 0.0404440
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0271170
	speed: 0.0718s/iter; left time: 1366.7172s
	iters: 200, epoch: 16 | loss: 0.0265224
	speed: 0.0339s/iter; left time: 640.7791s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.61s
Steps: 225 | Train Loss: 0.0243604 Vali Loss: 0.0327115 Test Loss: 0.0401209
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0254853
	speed: 0.0750s/iter; left time: 1410.3246s
	iters: 200, epoch: 17 | loss: 0.0264738
	speed: 0.0269s/iter; left time: 503.3991s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.28s
Steps: 225 | Train Loss: 0.0242914 Vali Loss: 0.0326806 Test Loss: 0.0404772
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0232780
	speed: 0.0693s/iter; left time: 1287.6609s
	iters: 200, epoch: 18 | loss: 0.0237292
	speed: 0.0306s/iter; left time: 564.5865s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.06s
Steps: 225 | Train Loss: 0.0242091 Vali Loss: 0.0327785 Test Loss: 0.0405320
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0236547
	speed: 0.0724s/iter; left time: 1328.5391s
	iters: 200, epoch: 19 | loss: 0.0253258
	speed: 0.0304s/iter; left time: 554.3087s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.01s
Steps: 225 | Train Loss: 0.0241632 Vali Loss: 0.0326887 Test Loss: 0.0406219
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0250084
	speed: 0.0884s/iter; left time: 1602.4261s
	iters: 200, epoch: 20 | loss: 0.0265045
	speed: 0.0322s/iter; left time: 581.2436s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.94s
Steps: 225 | Train Loss: 0.0241166 Vali Loss: 0.0326053 Test Loss: 0.0405097
Validation loss decreased (0.032661 --> 0.032605).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0238479
	speed: 0.0786s/iter; left time: 1406.8111s
	iters: 200, epoch: 21 | loss: 0.0227442
	speed: 0.0281s/iter; left time: 499.5196s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.94s
Steps: 225 | Train Loss: 0.0240373 Vali Loss: 0.0325985 Test Loss: 0.0406184
Validation loss decreased (0.032605 --> 0.032598).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0242475
	speed: 0.0833s/iter; left time: 1473.0018s
	iters: 200, epoch: 22 | loss: 0.0240004
	speed: 0.0474s/iter; left time: 833.9684s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.32s
Steps: 225 | Train Loss: 0.0240255 Vali Loss: 0.0326136 Test Loss: 0.0406383
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0233491
	speed: 0.1110s/iter; left time: 1937.1116s
	iters: 200, epoch: 23 | loss: 0.0215407
	speed: 0.0453s/iter; left time: 786.4895s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.40s
Steps: 225 | Train Loss: 0.0239283 Vali Loss: 0.0326419 Test Loss: 0.0406990
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0229299
	speed: 0.1253s/iter; left time: 2158.4732s
	iters: 200, epoch: 24 | loss: 0.0237968
	speed: 0.0419s/iter; left time: 718.1554s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.65s
Steps: 225 | Train Loss: 0.0239189 Vali Loss: 0.0327209 Test Loss: 0.0407308
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0228200
	speed: 0.1314s/iter; left time: 2233.7386s
	iters: 200, epoch: 25 | loss: 0.0248429
	speed: 0.0401s/iter; left time: 678.0096s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.18s
Steps: 225 | Train Loss: 0.0238833 Vali Loss: 0.0326425 Test Loss: 0.0406959
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0235288
	speed: 0.1557s/iter; left time: 2612.2294s
	iters: 200, epoch: 26 | loss: 0.0227188
	speed: 0.0514s/iter; left time: 857.3906s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:13.29s
Steps: 225 | Train Loss: 0.0238446 Vali Loss: 0.0327189 Test Loss: 0.0407183
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0231323
	speed: 0.1150s/iter; left time: 1903.1002s
	iters: 200, epoch: 27 | loss: 0.0251811
	speed: 0.0458s/iter; left time: 753.6024s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.71s
Steps: 225 | Train Loss: 0.0238494 Vali Loss: 0.0326425 Test Loss: 0.0406725
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0233792
	speed: 0.1166s/iter; left time: 1903.0459s
	iters: 200, epoch: 28 | loss: 0.0243124
	speed: 0.0429s/iter; left time: 696.4843s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.82s
Steps: 225 | Train Loss: 0.0238004 Vali Loss: 0.0327135 Test Loss: 0.0407996
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0253402
	speed: 0.1110s/iter; left time: 1786.6988s
	iters: 200, epoch: 29 | loss: 0.0235787
	speed: 0.0437s/iter; left time: 698.7407s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.97s
Steps: 225 | Train Loss: 0.0237641 Vali Loss: 0.0326271 Test Loss: 0.0408671
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0221469
	speed: 0.1325s/iter; left time: 2103.2824s
	iters: 200, epoch: 30 | loss: 0.0262810
	speed: 0.0643s/iter; left time: 1013.9191s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:14.16s
Steps: 225 | Train Loss: 0.0237545 Vali Loss: 0.0326350 Test Loss: 0.0408822
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0240579
	speed: 0.1174s/iter; left time: 1838.1702s
	iters: 200, epoch: 31 | loss: 0.0251211
	speed: 0.0414s/iter; left time: 643.1440s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.38s
Steps: 225 | Train Loss: 0.0237316 Vali Loss: 0.0327280 Test Loss: 0.0408680
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_168_DE_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0406184159219265, rmse:0.20154011249542236, mae:0.13821378350257874, rse:0.7138713002204895
Intermediate time for DE and pred_len 168: 00h:06m:06.96sIntermediate time for DE: 00h:12m:51.73s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_168_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_168_24_GB_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0306815
	speed: 0.0681s/iter; left time: 1532.5494s
	iters: 200, epoch: 1 | loss: 0.0266523
	speed: 0.0423s/iter; left time: 946.7330s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.07s
Steps: 226 | Train Loss: 0.0323873 Vali Loss: 0.0310920 Test Loss: 0.0430876
Validation loss decreased (inf --> 0.031092).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0153087
	speed: 0.1056s/iter; left time: 2352.3071s
	iters: 200, epoch: 2 | loss: 0.0142865
	speed: 0.0512s/iter; left time: 1135.3933s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.83s
Steps: 226 | Train Loss: 0.0165819 Vali Loss: 0.0204234 Test Loss: 0.0264011
Validation loss decreased (0.031092 --> 0.020423).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0170686
	speed: 0.1340s/iter; left time: 2954.9373s
	iters: 200, epoch: 3 | loss: 0.0158198
	speed: 0.0500s/iter; left time: 1098.2466s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.71s
Steps: 226 | Train Loss: 0.0145620 Vali Loss: 0.0201542 Test Loss: 0.0261200
Validation loss decreased (0.020423 --> 0.020154).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0144440
	speed: 0.1015s/iter; left time: 2214.5517s
	iters: 200, epoch: 4 | loss: 0.0145676
	speed: 0.0391s/iter; left time: 849.9930s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.73s
Steps: 226 | Train Loss: 0.0141880 Vali Loss: 0.0201375 Test Loss: 0.0256896
Validation loss decreased (0.020154 --> 0.020138).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0139161
	speed: 0.1047s/iter; left time: 2260.4077s
	iters: 200, epoch: 5 | loss: 0.0156245
	speed: 0.0447s/iter; left time: 960.8914s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.77s
Steps: 226 | Train Loss: 0.0139841 Vali Loss: 0.0199274 Test Loss: 0.0255548
Validation loss decreased (0.020138 --> 0.019927).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0134839
	speed: 0.0952s/iter; left time: 2034.9297s
	iters: 200, epoch: 6 | loss: 0.0130852
	speed: 0.0457s/iter; left time: 971.8614s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.29s
Steps: 226 | Train Loss: 0.0138393 Vali Loss: 0.0195793 Test Loss: 0.0252798
Validation loss decreased (0.019927 --> 0.019579).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0130190
	speed: 0.1178s/iter; left time: 2491.4614s
	iters: 200, epoch: 7 | loss: 0.0126406
	speed: 0.0563s/iter; left time: 1184.9396s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.02s
Steps: 226 | Train Loss: 0.0137379 Vali Loss: 0.0195426 Test Loss: 0.0252673
Validation loss decreased (0.019579 --> 0.019543).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0126214
	speed: 0.1138s/iter; left time: 2380.7048s
	iters: 200, epoch: 8 | loss: 0.0131759
	speed: 0.0461s/iter; left time: 960.7264s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.29s
Steps: 226 | Train Loss: 0.0136468 Vali Loss: 0.0195262 Test Loss: 0.0252110
Validation loss decreased (0.019543 --> 0.019526).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0142638
	speed: 0.0991s/iter; left time: 2050.6731s
	iters: 200, epoch: 9 | loss: 0.0131716
	speed: 0.0427s/iter; left time: 879.0659s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.23s
Steps: 226 | Train Loss: 0.0135563 Vali Loss: 0.0193729 Test Loss: 0.0252877
Validation loss decreased (0.019526 --> 0.019373).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0127078
	speed: 0.0971s/iter; left time: 1986.3346s
	iters: 200, epoch: 10 | loss: 0.0139840
	speed: 0.0447s/iter; left time: 910.7431s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.41s
Steps: 226 | Train Loss: 0.0134777 Vali Loss: 0.0194025 Test Loss: 0.0252130
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0161274
	speed: 0.0958s/iter; left time: 1938.3375s
	iters: 200, epoch: 11 | loss: 0.0138039
	speed: 0.0550s/iter; left time: 1107.6860s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.81s
Steps: 226 | Train Loss: 0.0134166 Vali Loss: 0.0192794 Test Loss: 0.0250856
Validation loss decreased (0.019373 --> 0.019279).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0121306
	speed: 0.1345s/iter; left time: 2691.7819s
	iters: 200, epoch: 12 | loss: 0.0160302
	speed: 0.0399s/iter; left time: 794.6016s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.08s
Steps: 226 | Train Loss: 0.0133569 Vali Loss: 0.0192511 Test Loss: 0.0251192
Validation loss decreased (0.019279 --> 0.019251).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0113891
	speed: 0.1013s/iter; left time: 2005.0537s
	iters: 200, epoch: 13 | loss: 0.0132807
	speed: 0.0383s/iter; left time: 753.6980s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.07s
Steps: 226 | Train Loss: 0.0133088 Vali Loss: 0.0192478 Test Loss: 0.0251219
Validation loss decreased (0.019251 --> 0.019248).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0134227
	speed: 0.0917s/iter; left time: 1793.1355s
	iters: 200, epoch: 14 | loss: 0.0130552
	speed: 0.0476s/iter; left time: 927.2188s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.11s
Steps: 226 | Train Loss: 0.0132481 Vali Loss: 0.0193488 Test Loss: 0.0250907
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0139046
	speed: 0.1020s/iter; left time: 1971.9664s
	iters: 200, epoch: 15 | loss: 0.0139125
	speed: 0.0410s/iter; left time: 789.0880s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.09s
Steps: 226 | Train Loss: 0.0132269 Vali Loss: 0.0191523 Test Loss: 0.0251043
Validation loss decreased (0.019248 --> 0.019152).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0133044
	speed: 0.1234s/iter; left time: 2357.4765s
	iters: 200, epoch: 16 | loss: 0.0134255
	speed: 0.0614s/iter; left time: 1167.6348s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:13.21s
Steps: 226 | Train Loss: 0.0131907 Vali Loss: 0.0191569 Test Loss: 0.0251692
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0126479
	speed: 0.0948s/iter; left time: 1789.6101s
	iters: 200, epoch: 17 | loss: 0.0132790
	speed: 0.0392s/iter; left time: 737.2248s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.07s
Steps: 226 | Train Loss: 0.0131559 Vali Loss: 0.0192524 Test Loss: 0.0252377
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0124893
	speed: 0.0968s/iter; left time: 1805.6232s
	iters: 200, epoch: 18 | loss: 0.0135506
	speed: 0.0469s/iter; left time: 870.9445s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.91s
Steps: 226 | Train Loss: 0.0131313 Vali Loss: 0.0191961 Test Loss: 0.0251142
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0135661
	speed: 0.0941s/iter; left time: 1734.4131s
	iters: 200, epoch: 19 | loss: 0.0137399
	speed: 0.0438s/iter; left time: 803.4638s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.09s
Steps: 226 | Train Loss: 0.0130996 Vali Loss: 0.0191331 Test Loss: 0.0251709
Validation loss decreased (0.019152 --> 0.019133).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0151006
	speed: 0.1026s/iter; left time: 1867.9672s
	iters: 200, epoch: 20 | loss: 0.0137961
	speed: 0.0575s/iter; left time: 1041.7981s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.65s
Steps: 226 | Train Loss: 0.0130854 Vali Loss: 0.0191960 Test Loss: 0.0250267
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0132778
	speed: 0.1176s/iter; left time: 2114.1918s
	iters: 200, epoch: 21 | loss: 0.0140660
	speed: 0.0434s/iter; left time: 776.0602s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.46s
Steps: 226 | Train Loss: 0.0130569 Vali Loss: 0.0192014 Test Loss: 0.0251986
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0109714
	speed: 0.0987s/iter; left time: 1753.1350s
	iters: 200, epoch: 22 | loss: 0.0144550
	speed: 0.0396s/iter; left time: 698.5400s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.71s
Steps: 226 | Train Loss: 0.0130485 Vali Loss: 0.0191108 Test Loss: 0.0251565
Validation loss decreased (0.019133 --> 0.019111).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0115084
	speed: 0.1004s/iter; left time: 1760.5756s
	iters: 200, epoch: 23 | loss: 0.0116755
	speed: 0.0515s/iter; left time: 898.2234s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.12s
Steps: 226 | Train Loss: 0.0129933 Vali Loss: 0.0190995 Test Loss: 0.0251609
Validation loss decreased (0.019111 --> 0.019099).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0130449
	speed: 0.0924s/iter; left time: 1599.3736s
	iters: 200, epoch: 24 | loss: 0.0129596
	speed: 0.0521s/iter; left time: 896.8435s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.54s
Steps: 226 | Train Loss: 0.0129977 Vali Loss: 0.0191031 Test Loss: 0.0252141
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0124596
	speed: 0.1359s/iter; left time: 2321.4060s
	iters: 200, epoch: 25 | loss: 0.0103465
	speed: 0.0510s/iter; left time: 865.7878s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.36s
Steps: 226 | Train Loss: 0.0129898 Vali Loss: 0.0190852 Test Loss: 0.0251680
Validation loss decreased (0.019099 --> 0.019085).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0146096
	speed: 0.0786s/iter; left time: 1325.1361s
	iters: 200, epoch: 26 | loss: 0.0114260
	speed: 0.0303s/iter; left time: 507.8375s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.61s
Steps: 226 | Train Loss: 0.0129762 Vali Loss: 0.0191453 Test Loss: 0.0251956
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0148471
	speed: 0.0625s/iter; left time: 1039.4186s
	iters: 200, epoch: 27 | loss: 0.0142760
	speed: 0.0299s/iter; left time: 494.3536s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.75s
Steps: 226 | Train Loss: 0.0129704 Vali Loss: 0.0190854 Test Loss: 0.0251721
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0120537
	speed: 0.0607s/iter; left time: 995.3985s
	iters: 200, epoch: 28 | loss: 0.0137661
	speed: 0.0343s/iter; left time: 559.7215s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.12s
Steps: 226 | Train Loss: 0.0129575 Vali Loss: 0.0190943 Test Loss: 0.0251400
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0132743
	speed: 0.0585s/iter; left time: 946.4002s
	iters: 200, epoch: 29 | loss: 0.0129417
	speed: 0.0220s/iter; left time: 353.7564s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.06s
Steps: 226 | Train Loss: 0.0129509 Vali Loss: 0.0191139 Test Loss: 0.0251515
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0116974
	speed: 0.0734s/iter; left time: 1170.7012s
	iters: 200, epoch: 30 | loss: 0.0134378
	speed: 0.0296s/iter; left time: 469.1240s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.86s
Steps: 226 | Train Loss: 0.0129296 Vali Loss: 0.0191253 Test Loss: 0.0252005
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0125019
	speed: 0.0731s/iter; left time: 1149.3511s
	iters: 200, epoch: 31 | loss: 0.0145108
	speed: 0.0440s/iter; left time: 687.9966s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.96s
Steps: 226 | Train Loss: 0.0129281 Vali Loss: 0.0191124 Test Loss: 0.0251992
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0113440
	speed: 0.0676s/iter; left time: 1048.1478s
	iters: 200, epoch: 32 | loss: 0.0121925
	speed: 0.0273s/iter; left time: 420.5292s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.53s
Steps: 226 | Train Loss: 0.0129249 Vali Loss: 0.0191041 Test Loss: 0.0251873
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0128363
	speed: 0.0857s/iter; left time: 1309.2490s
	iters: 200, epoch: 33 | loss: 0.0128919
	speed: 0.0379s/iter; left time: 574.7631s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.43s
Steps: 226 | Train Loss: 0.0129289 Vali Loss: 0.0190764 Test Loss: 0.0251854
Validation loss decreased (0.019085 --> 0.019076).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0115401
	speed: 0.0747s/iter; left time: 1123.5613s
	iters: 200, epoch: 34 | loss: 0.0133728
	speed: 0.0289s/iter; left time: 432.2049s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.05s
Steps: 226 | Train Loss: 0.0129210 Vali Loss: 0.0190594 Test Loss: 0.0251820
Validation loss decreased (0.019076 --> 0.019059).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0132487
	speed: 0.0829s/iter; left time: 1227.9971s
	iters: 200, epoch: 35 | loss: 0.0136201
	speed: 0.0287s/iter; left time: 421.8932s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.57s
Steps: 226 | Train Loss: 0.0129160 Vali Loss: 0.0190945 Test Loss: 0.0251921
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0129037
	speed: 0.0651s/iter; left time: 949.3845s
	iters: 200, epoch: 36 | loss: 0.0127028
	speed: 0.0250s/iter; left time: 362.7945s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.90s
Steps: 226 | Train Loss: 0.0129073 Vali Loss: 0.0190527 Test Loss: 0.0252187
Validation loss decreased (0.019059 --> 0.019053).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0122460
	speed: 0.0930s/iter; left time: 1335.6076s
	iters: 200, epoch: 37 | loss: 0.0127358
	speed: 0.0276s/iter; left time: 393.1703s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.31s
Steps: 226 | Train Loss: 0.0128986 Vali Loss: 0.0190852 Test Loss: 0.0251907
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0129839
	speed: 0.0619s/iter; left time: 875.1020s
	iters: 200, epoch: 38 | loss: 0.0129735
	speed: 0.0255s/iter; left time: 358.6629s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.07s
Steps: 226 | Train Loss: 0.0128992 Vali Loss: 0.0190683 Test Loss: 0.0251875
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0111598
	speed: 0.0940s/iter; left time: 1307.5915s
	iters: 200, epoch: 39 | loss: 0.0126943
	speed: 0.0273s/iter; left time: 377.1097s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.86s
Steps: 226 | Train Loss: 0.0128922 Vali Loss: 0.0191263 Test Loss: 0.0252117
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0118141
	speed: 0.0635s/iter; left time: 869.0862s
	iters: 200, epoch: 40 | loss: 0.0135553
	speed: 0.0310s/iter; left time: 421.7236s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.20s
Steps: 226 | Train Loss: 0.0128836 Vali Loss: 0.0190870 Test Loss: 0.0252051
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0121245
	speed: 0.0895s/iter; left time: 1204.1751s
	iters: 200, epoch: 41 | loss: 0.0123877
	speed: 0.0282s/iter; left time: 377.3275s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.50s
Steps: 226 | Train Loss: 0.0128702 Vali Loss: 0.0190757 Test Loss: 0.0252135
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0133441
	speed: 0.0663s/iter; left time: 877.9292s
	iters: 200, epoch: 42 | loss: 0.0115185
	speed: 0.0244s/iter; left time: 320.9594s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.08s
Steps: 226 | Train Loss: 0.0128975 Vali Loss: 0.0190773 Test Loss: 0.0251964
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0139865
	speed: 0.0925s/iter; left time: 1203.5689s
	iters: 200, epoch: 43 | loss: 0.0128980
	speed: 0.0291s/iter; left time: 375.6127s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.90s
Steps: 226 | Train Loss: 0.0128922 Vali Loss: 0.0190738 Test Loss: 0.0251991
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0123033
	speed: 0.0670s/iter; left time: 856.5725s
	iters: 200, epoch: 44 | loss: 0.0136023
	speed: 0.0352s/iter; left time: 446.0972s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.87s
Steps: 226 | Train Loss: 0.0128689 Vali Loss: 0.0191055 Test Loss: 0.0252051
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0129680
	speed: 0.0867s/iter; left time: 1089.1394s
	iters: 200, epoch: 45 | loss: 0.0121593
	speed: 0.0256s/iter; left time: 318.6889s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.39s
Steps: 226 | Train Loss: 0.0128768 Vali Loss: 0.0191128 Test Loss: 0.0252108
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0136561
	speed: 0.0652s/iter; left time: 804.3159s
	iters: 200, epoch: 46 | loss: 0.0120851
	speed: 0.0356s/iter; left time: 436.0138s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.82s
Steps: 226 | Train Loss: 0.0128930 Vali Loss: 0.0190865 Test Loss: 0.0252188
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_24_GB_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02521873079240322, rmse:0.1588040590286255, mae:0.10287422686815262, rse:0.5478290319442749
Intermediate time for GB and pred_len 24: 00h:10m:12.15s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_168_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_168_96_GB_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0354775
	speed: 0.0686s/iter; left time: 1537.7750s
	iters: 200, epoch: 1 | loss: 0.0330818
	speed: 0.0267s/iter; left time: 595.9722s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.83s
Steps: 225 | Train Loss: 0.0363572 Vali Loss: 0.0369944 Test Loss: 0.0533514
Validation loss decreased (inf --> 0.036994).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0240189
	speed: 0.0687s/iter; left time: 1522.9947s
	iters: 200, epoch: 2 | loss: 0.0249086
	speed: 0.0230s/iter; left time: 507.3656s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.83s
Steps: 225 | Train Loss: 0.0249381 Vali Loss: 0.0303441 Test Loss: 0.0435347
Validation loss decreased (0.036994 --> 0.030344).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0232706
	speed: 0.0965s/iter; left time: 2118.9901s
	iters: 200, epoch: 3 | loss: 0.0220721
	speed: 0.0259s/iter; left time: 566.2517s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.48s
Steps: 225 | Train Loss: 0.0230414 Vali Loss: 0.0300716 Test Loss: 0.0431415
Validation loss decreased (0.030344 --> 0.030072).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0217916
	speed: 0.0679s/iter; left time: 1475.3727s
	iters: 200, epoch: 4 | loss: 0.0222335
	speed: 0.0246s/iter; left time: 531.0174s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.16s
Steps: 225 | Train Loss: 0.0226242 Vali Loss: 0.0299814 Test Loss: 0.0439132
Validation loss decreased (0.030072 --> 0.029981).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0231342
	speed: 0.0942s/iter; left time: 2026.1295s
	iters: 200, epoch: 5 | loss: 0.0215362
	speed: 0.0238s/iter; left time: 508.9080s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.90s
Steps: 225 | Train Loss: 0.0223468 Vali Loss: 0.0297319 Test Loss: 0.0439771
Validation loss decreased (0.029981 --> 0.029732).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0237017
	speed: 0.0668s/iter; left time: 1421.6003s
	iters: 200, epoch: 6 | loss: 0.0222148
	speed: 0.0246s/iter; left time: 521.7184s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.04s
Steps: 225 | Train Loss: 0.0221197 Vali Loss: 0.0296820 Test Loss: 0.0441826
Validation loss decreased (0.029732 --> 0.029682).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0203015
	speed: 0.0928s/iter; left time: 1954.4820s
	iters: 200, epoch: 7 | loss: 0.0225045
	speed: 0.0318s/iter; left time: 665.6530s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.28s
Steps: 225 | Train Loss: 0.0219527 Vali Loss: 0.0296131 Test Loss: 0.0441187
Validation loss decreased (0.029682 --> 0.029613).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0205286
	speed: 0.0717s/iter; left time: 1492.2687s
	iters: 200, epoch: 8 | loss: 0.0234542
	speed: 0.0284s/iter; left time: 588.1607s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.40s
Steps: 225 | Train Loss: 0.0218284 Vali Loss: 0.0296417 Test Loss: 0.0449920
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0223067
	speed: 0.0972s/iter; left time: 2002.5576s
	iters: 200, epoch: 9 | loss: 0.0220027
	speed: 0.0262s/iter; left time: 536.1908s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.84s
Steps: 225 | Train Loss: 0.0217147 Vali Loss: 0.0295708 Test Loss: 0.0446208
Validation loss decreased (0.029613 --> 0.029571).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0218705
	speed: 0.0752s/iter; left time: 1532.2417s
	iters: 200, epoch: 10 | loss: 0.0221990
	speed: 0.0290s/iter; left time: 587.0119s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0215910 Vali Loss: 0.0298560 Test Loss: 0.0454434
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0200138
	speed: 0.0936s/iter; left time: 1886.5657s
	iters: 200, epoch: 11 | loss: 0.0235559
	speed: 0.0270s/iter; left time: 542.0653s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.48s
Steps: 225 | Train Loss: 0.0214932 Vali Loss: 0.0295766 Test Loss: 0.0446929
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0203710
	speed: 0.0709s/iter; left time: 1412.6928s
	iters: 200, epoch: 12 | loss: 0.0218972
	speed: 0.0219s/iter; left time: 433.9851s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.04s
Steps: 225 | Train Loss: 0.0214143 Vali Loss: 0.0297747 Test Loss: 0.0450747
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0206936
	speed: 0.0502s/iter; left time: 989.9310s
	iters: 200, epoch: 13 | loss: 0.0215404
	speed: 0.0265s/iter; left time: 520.3283s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.07s
Steps: 225 | Train Loss: 0.0213293 Vali Loss: 0.0299438 Test Loss: 0.0450182
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0214430
	speed: 0.0658s/iter; left time: 1281.0194s
	iters: 200, epoch: 14 | loss: 0.0220037
	speed: 0.0329s/iter; left time: 637.8399s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.40s
Steps: 225 | Train Loss: 0.0212775 Vali Loss: 0.0300351 Test Loss: 0.0455550
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0208235
	speed: 0.1150s/iter; left time: 2214.7338s
	iters: 200, epoch: 15 | loss: 0.0200474
	speed: 0.0219s/iter; left time: 419.5546s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.59s
Steps: 225 | Train Loss: 0.0211910 Vali Loss: 0.0299286 Test Loss: 0.0452272
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0191070
	speed: 0.0546s/iter; left time: 1039.2616s
	iters: 200, epoch: 16 | loss: 0.0219055
	speed: 0.0220s/iter; left time: 416.4554s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0211475 Vali Loss: 0.0298784 Test Loss: 0.0450351
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0200941
	speed: 0.0658s/iter; left time: 1237.6131s
	iters: 200, epoch: 17 | loss: 0.0211507
	speed: 0.0361s/iter; left time: 675.0819s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.91s
Steps: 225 | Train Loss: 0.0210881 Vali Loss: 0.0300969 Test Loss: 0.0456566
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0223482
	speed: 0.0953s/iter; left time: 1770.0382s
	iters: 200, epoch: 18 | loss: 0.0198237
	speed: 0.0341s/iter; left time: 629.4172s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.99s
Steps: 225 | Train Loss: 0.0210304 Vali Loss: 0.0299435 Test Loss: 0.0452439
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0211381
	speed: 0.0916s/iter; left time: 1681.6391s
	iters: 200, epoch: 19 | loss: 0.0200907
	speed: 0.0294s/iter; left time: 535.7005s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.15s
Steps: 225 | Train Loss: 0.0209759 Vali Loss: 0.0300613 Test Loss: 0.0456903
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_96_GB_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0446208193898201, rmse:0.2112364023923874, mae:0.14619070291519165, rse:0.7304849028587341
Intermediate time for GB and pred_len 96: 00h:03m:38.99s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_168_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_168_168_GB_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0390243
	speed: 0.0472s/iter; left time: 1057.3378s
	iters: 200, epoch: 1 | loss: 0.0298407
	speed: 0.0390s/iter; left time: 870.4603s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.15s
Steps: 225 | Train Loss: 0.0378106 Vali Loss: 0.0389916 Test Loss: 0.0558763
Validation loss decreased (inf --> 0.038992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0256391
	speed: 0.1145s/iter; left time: 2540.2143s
	iters: 200, epoch: 2 | loss: 0.0244381
	speed: 0.0264s/iter; left time: 583.3081s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.73s
Steps: 225 | Train Loss: 0.0269063 Vali Loss: 0.0326266 Test Loss: 0.0464468
Validation loss decreased (0.038992 --> 0.032627).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0238225
	speed: 0.0938s/iter; left time: 2058.0264s
	iters: 200, epoch: 3 | loss: 0.0257555
	speed: 0.0484s/iter; left time: 1056.7327s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.17s
Steps: 225 | Train Loss: 0.0248508 Vali Loss: 0.0326770 Test Loss: 0.0472591
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0263294
	speed: 0.0825s/iter; left time: 1792.8509s
	iters: 200, epoch: 4 | loss: 0.0246007
	speed: 0.0388s/iter; left time: 838.5596s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.92s
Steps: 225 | Train Loss: 0.0244757 Vali Loss: 0.0326091 Test Loss: 0.0475681
Validation loss decreased (0.032627 --> 0.032609).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0237154
	speed: 0.0802s/iter; left time: 1723.6471s
	iters: 200, epoch: 5 | loss: 0.0240872
	speed: 0.0502s/iter; left time: 1073.5185s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.67s
Steps: 225 | Train Loss: 0.0241992 Vali Loss: 0.0324431 Test Loss: 0.0476243
Validation loss decreased (0.032609 --> 0.032443).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0234693
	speed: 0.0744s/iter; left time: 1582.3650s
	iters: 200, epoch: 6 | loss: 0.0254878
	speed: 0.0304s/iter; left time: 643.9315s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.37s
Steps: 225 | Train Loss: 0.0239851 Vali Loss: 0.0322094 Test Loss: 0.0475896
Validation loss decreased (0.032443 --> 0.032209).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0246653
	speed: 0.1300s/iter; left time: 2736.5306s
	iters: 200, epoch: 7 | loss: 0.0230549
	speed: 0.0268s/iter; left time: 560.8158s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.66s
Steps: 225 | Train Loss: 0.0238235 Vali Loss: 0.0325111 Test Loss: 0.0482226
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0213825
	speed: 0.0816s/iter; left time: 1699.7433s
	iters: 200, epoch: 8 | loss: 0.0244884
	speed: 0.0459s/iter; left time: 952.1830s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.24s
Steps: 225 | Train Loss: 0.0236538 Vali Loss: 0.0322481 Test Loss: 0.0477532
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0229579
	speed: 0.0895s/iter; left time: 1844.4827s
	iters: 200, epoch: 9 | loss: 0.0238026
	speed: 0.0478s/iter; left time: 980.1436s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.78s
Steps: 225 | Train Loss: 0.0235430 Vali Loss: 0.0323157 Test Loss: 0.0479474
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0232745
	speed: 0.0847s/iter; left time: 1725.6330s
	iters: 200, epoch: 10 | loss: 0.0231921
	speed: 0.0435s/iter; left time: 881.2897s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.18s
Steps: 225 | Train Loss: 0.0234294 Vali Loss: 0.0321824 Test Loss: 0.0477643
Validation loss decreased (0.032209 --> 0.032182).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0238903
	speed: 0.0957s/iter; left time: 1927.6426s
	iters: 200, epoch: 11 | loss: 0.0227449
	speed: 0.0348s/iter; left time: 697.2737s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.91s
Steps: 225 | Train Loss: 0.0233082 Vali Loss: 0.0324118 Test Loss: 0.0482034
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0227333
	speed: 0.1300s/iter; left time: 2589.4023s
	iters: 200, epoch: 12 | loss: 0.0233488
	speed: 0.0328s/iter; left time: 649.5956s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.45s
Steps: 225 | Train Loss: 0.0232158 Vali Loss: 0.0323680 Test Loss: 0.0480370
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0221179
	speed: 0.0814s/iter; left time: 1604.5093s
	iters: 200, epoch: 13 | loss: 0.0217740
	speed: 0.0567s/iter; left time: 1110.6467s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.17s
Steps: 225 | Train Loss: 0.0231166 Vali Loss: 0.0324860 Test Loss: 0.0483295
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0239112
	speed: 0.0686s/iter; left time: 1336.9318s
	iters: 200, epoch: 14 | loss: 0.0226446
	speed: 0.0337s/iter; left time: 652.8516s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.72s
Steps: 225 | Train Loss: 0.0230206 Vali Loss: 0.0327152 Test Loss: 0.0488690
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0224236
	speed: 0.0834s/iter; left time: 1604.9443s
	iters: 200, epoch: 15 | loss: 0.0222827
	speed: 0.0227s/iter; left time: 434.2060s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.02s
Steps: 225 | Train Loss: 0.0229603 Vali Loss: 0.0326154 Test Loss: 0.0486470
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0238628
	speed: 0.0495s/iter; left time: 942.7203s
	iters: 200, epoch: 16 | loss: 0.0237833
	speed: 0.0212s/iter; left time: 400.9043s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.42s
Steps: 225 | Train Loss: 0.0228710 Vali Loss: 0.0326586 Test Loss: 0.0487534
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0247075
	speed: 0.0836s/iter; left time: 1570.8369s
	iters: 200, epoch: 17 | loss: 0.0234942
	speed: 0.0478s/iter; left time: 893.5717s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.22s
Steps: 225 | Train Loss: 0.0228217 Vali Loss: 0.0326492 Test Loss: 0.0486032
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0229605
	speed: 0.1296s/iter; left time: 2407.8405s
	iters: 200, epoch: 18 | loss: 0.0239278
	speed: 0.0473s/iter; left time: 873.8104s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.47s
Steps: 225 | Train Loss: 0.0227531 Vali Loss: 0.0326073 Test Loss: 0.0483531
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0222851
	speed: 0.1721s/iter; left time: 3158.0260s
	iters: 200, epoch: 19 | loss: 0.0235539
	speed: 0.0485s/iter; left time: 886.0591s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.88s
Steps: 225 | Train Loss: 0.0227298 Vali Loss: 0.0328842 Test Loss: 0.0493051
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0239972
	speed: 0.1419s/iter; left time: 2572.1804s
	iters: 200, epoch: 20 | loss: 0.0237402
	speed: 0.0644s/iter; left time: 1160.7873s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.44s
Steps: 225 | Train Loss: 0.0226613 Vali Loss: 0.0329440 Test Loss: 0.0493550
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_168_GB_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04776432737708092, rmse:0.21855051815509796, mae:0.1530516892671585, rse:0.7577460408210754
Intermediate time for GB and pred_len 168: 00h:04m:48.85sIntermediate time for GB: 00h:18m:39.98s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_168_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_168_24_ES_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0344858
	speed: 0.0586s/iter; left time: 1317.9860s
	iters: 200, epoch: 1 | loss: 0.0248702
	speed: 0.0331s/iter; left time: 742.0129s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.54s
Steps: 226 | Train Loss: 0.0371519 Vali Loss: 0.0223229 Test Loss: 0.0300770
Validation loss decreased (inf --> 0.022323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0126206
	speed: 0.0825s/iter; left time: 1837.7030s
	iters: 200, epoch: 2 | loss: 0.0100498
	speed: 0.0363s/iter; left time: 805.0051s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.25s
Steps: 226 | Train Loss: 0.0132151 Vali Loss: 0.0098500 Test Loss: 0.0125102
Validation loss decreased (0.022323 --> 0.009850).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0103429
	speed: 0.1038s/iter; left time: 2288.8369s
	iters: 200, epoch: 3 | loss: 0.0100795
	speed: 0.0363s/iter; left time: 796.5311s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.20s
Steps: 226 | Train Loss: 0.0103717 Vali Loss: 0.0093203 Test Loss: 0.0118425
Validation loss decreased (0.009850 --> 0.009320).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0096413
	speed: 0.0780s/iter; left time: 1702.4721s
	iters: 200, epoch: 4 | loss: 0.0083005
	speed: 0.0362s/iter; left time: 787.0372s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.80s
Steps: 226 | Train Loss: 0.0097180 Vali Loss: 0.0089005 Test Loss: 0.0113179
Validation loss decreased (0.009320 --> 0.008900).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0097897
	speed: 0.1184s/iter; left time: 2556.5842s
	iters: 200, epoch: 5 | loss: 0.0100584
	speed: 0.0438s/iter; left time: 942.4198s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.74s
Steps: 226 | Train Loss: 0.0092799 Vali Loss: 0.0086677 Test Loss: 0.0109406
Validation loss decreased (0.008900 --> 0.008668).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0089060
	speed: 0.0910s/iter; left time: 1944.6028s
	iters: 200, epoch: 6 | loss: 0.0081647
	speed: 0.0494s/iter; left time: 1050.5381s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.89s
Steps: 226 | Train Loss: 0.0089618 Vali Loss: 0.0084586 Test Loss: 0.0106541
Validation loss decreased (0.008668 --> 0.008459).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0075015
	speed: 0.0816s/iter; left time: 1724.9503s
	iters: 200, epoch: 7 | loss: 0.0088196
	speed: 0.0356s/iter; left time: 749.9036s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.21s
Steps: 226 | Train Loss: 0.0087471 Vali Loss: 0.0083825 Test Loss: 0.0105173
Validation loss decreased (0.008459 --> 0.008382).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0080909
	speed: 0.0974s/iter; left time: 2036.4737s
	iters: 200, epoch: 8 | loss: 0.0087270
	speed: 0.0367s/iter; left time: 764.9337s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.05s
Steps: 226 | Train Loss: 0.0085740 Vali Loss: 0.0082854 Test Loss: 0.0104146
Validation loss decreased (0.008382 --> 0.008285).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0079280
	speed: 0.0860s/iter; left time: 1778.7867s
	iters: 200, epoch: 9 | loss: 0.0090820
	speed: 0.0367s/iter; left time: 755.8939s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.18s
Steps: 226 | Train Loss: 0.0084567 Vali Loss: 0.0082317 Test Loss: 0.0103206
Validation loss decreased (0.008285 --> 0.008232).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0085438
	speed: 0.0975s/iter; left time: 1995.1632s
	iters: 200, epoch: 10 | loss: 0.0085556
	speed: 0.0371s/iter; left time: 756.1211s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.44s
Steps: 226 | Train Loss: 0.0083482 Vali Loss: 0.0081226 Test Loss: 0.0101976
Validation loss decreased (0.008232 --> 0.008123).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0075712
	speed: 0.1200s/iter; left time: 2428.1962s
	iters: 200, epoch: 11 | loss: 0.0083323
	speed: 0.0532s/iter; left time: 1071.0822s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.94s
Steps: 226 | Train Loss: 0.0082553 Vali Loss: 0.0080851 Test Loss: 0.0101538
Validation loss decreased (0.008123 --> 0.008085).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0083999
	speed: 0.0765s/iter; left time: 1531.4764s
	iters: 200, epoch: 12 | loss: 0.0088925
	speed: 0.0375s/iter; left time: 747.2862s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.31s
Steps: 226 | Train Loss: 0.0081682 Vali Loss: 0.0080263 Test Loss: 0.0100752
Validation loss decreased (0.008085 --> 0.008026).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0076128
	speed: 0.1027s/iter; left time: 2031.5328s
	iters: 200, epoch: 13 | loss: 0.0087484
	speed: 0.0342s/iter; left time: 672.8203s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.51s
Steps: 226 | Train Loss: 0.0080892 Vali Loss: 0.0079926 Test Loss: 0.0100276
Validation loss decreased (0.008026 --> 0.007993).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0075470
	speed: 0.0834s/iter; left time: 1632.1813s
	iters: 200, epoch: 14 | loss: 0.0081287
	speed: 0.0356s/iter; left time: 692.3757s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.18s
Steps: 226 | Train Loss: 0.0080240 Vali Loss: 0.0079453 Test Loss: 0.0099897
Validation loss decreased (0.007993 --> 0.007945).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0072469
	speed: 0.1014s/iter; left time: 1961.2359s
	iters: 200, epoch: 15 | loss: 0.0084926
	speed: 0.0315s/iter; left time: 605.9885s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.83s
Steps: 226 | Train Loss: 0.0079678 Vali Loss: 0.0079108 Test Loss: 0.0099600
Validation loss decreased (0.007945 --> 0.007911).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0075845
	speed: 0.0880s/iter; left time: 1682.6505s
	iters: 200, epoch: 16 | loss: 0.0070598
	speed: 0.0599s/iter; left time: 1137.8521s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.37s
Steps: 226 | Train Loss: 0.0079283 Vali Loss: 0.0079144 Test Loss: 0.0099446
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0067384
	speed: 0.1023s/iter; left time: 1932.4217s
	iters: 200, epoch: 17 | loss: 0.0072390
	speed: 0.0337s/iter; left time: 632.5663s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 226 | Train Loss: 0.0078908 Vali Loss: 0.0078561 Test Loss: 0.0099173
Validation loss decreased (0.007911 --> 0.007856).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0073018
	speed: 0.0968s/iter; left time: 1806.9276s
	iters: 200, epoch: 18 | loss: 0.0074447
	speed: 0.0376s/iter; left time: 698.1296s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.40s
Steps: 226 | Train Loss: 0.0078563 Vali Loss: 0.0078118 Test Loss: 0.0098345
Validation loss decreased (0.007856 --> 0.007812).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0085467
	speed: 0.0538s/iter; left time: 990.9492s
	iters: 200, epoch: 19 | loss: 0.0077147
	speed: 0.0182s/iter; left time: 333.3859s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.57s
Steps: 226 | Train Loss: 0.0078181 Vali Loss: 0.0077873 Test Loss: 0.0098552
Validation loss decreased (0.007812 --> 0.007787).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0075294
	speed: 0.0468s/iter; left time: 851.3470s
	iters: 200, epoch: 20 | loss: 0.0082452
	speed: 0.0281s/iter; left time: 508.9106s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.86s
Steps: 226 | Train Loss: 0.0078004 Vali Loss: 0.0077559 Test Loss: 0.0098293
Validation loss decreased (0.007787 --> 0.007756).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0079917
	speed: 0.0842s/iter; left time: 1513.5368s
	iters: 200, epoch: 21 | loss: 0.0068666
	speed: 0.0323s/iter; left time: 576.8380s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.05s
Steps: 226 | Train Loss: 0.0077771 Vali Loss: 0.0078368 Test Loss: 0.0098692
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0077353
	speed: 0.0889s/iter; left time: 1577.8287s
	iters: 200, epoch: 22 | loss: 0.0068657
	speed: 0.0471s/iter; left time: 831.0285s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.17s
Steps: 226 | Train Loss: 0.0077436 Vali Loss: 0.0077783 Test Loss: 0.0098262
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0081617
	speed: 0.1120s/iter; left time: 1962.9438s
	iters: 200, epoch: 23 | loss: 0.0074716
	speed: 0.0316s/iter; left time: 550.7875s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.12s
Steps: 226 | Train Loss: 0.0077267 Vali Loss: 0.0078055 Test Loss: 0.0098338
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0069516
	speed: 0.0802s/iter; left time: 1387.4038s
	iters: 200, epoch: 24 | loss: 0.0089964
	speed: 0.0335s/iter; left time: 576.6403s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.16s
Steps: 226 | Train Loss: 0.0077165 Vali Loss: 0.0077400 Test Loss: 0.0097997
Validation loss decreased (0.007756 --> 0.007740).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0072426
	speed: 0.0914s/iter; left time: 1560.7434s
	iters: 200, epoch: 25 | loss: 0.0081069
	speed: 0.0356s/iter; left time: 605.0396s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.11s
Steps: 226 | Train Loss: 0.0076998 Vali Loss: 0.0077898 Test Loss: 0.0098343
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0074234
	speed: 0.0812s/iter; left time: 1367.8907s
	iters: 200, epoch: 26 | loss: 0.0075612
	speed: 0.0378s/iter; left time: 633.6596s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.70s
Steps: 226 | Train Loss: 0.0076881 Vali Loss: 0.0077471 Test Loss: 0.0097822
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0090928
	speed: 0.0893s/iter; left time: 1483.8526s
	iters: 200, epoch: 27 | loss: 0.0066571
	speed: 0.0363s/iter; left time: 599.9501s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.69s
Steps: 226 | Train Loss: 0.0076465 Vali Loss: 0.0077481 Test Loss: 0.0098086
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0076121
	speed: 0.0916s/iter; left time: 1502.1085s
	iters: 200, epoch: 28 | loss: 0.0068969
	speed: 0.0433s/iter; left time: 705.7046s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.38s
Steps: 226 | Train Loss: 0.0076703 Vali Loss: 0.0077220 Test Loss: 0.0097674
Validation loss decreased (0.007740 --> 0.007722).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0082714
	speed: 0.0915s/iter; left time: 1480.2814s
	iters: 200, epoch: 29 | loss: 0.0075957
	speed: 0.0354s/iter; left time: 568.5146s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.94s
Steps: 226 | Train Loss: 0.0076475 Vali Loss: 0.0077353 Test Loss: 0.0097849
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0068515
	speed: 0.0765s/iter; left time: 1220.2614s
	iters: 200, epoch: 30 | loss: 0.0069599
	speed: 0.0322s/iter; left time: 510.8528s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.49s
Steps: 226 | Train Loss: 0.0076292 Vali Loss: 0.0077237 Test Loss: 0.0097906
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0075222
	speed: 0.0819s/iter; left time: 1287.5022s
	iters: 200, epoch: 31 | loss: 0.0075825
	speed: 0.0348s/iter; left time: 543.7270s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.12s
Steps: 226 | Train Loss: 0.0076272 Vali Loss: 0.0077313 Test Loss: 0.0097910
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0078725
	speed: 0.0743s/iter; left time: 1150.6650s
	iters: 200, epoch: 32 | loss: 0.0086332
	speed: 0.0293s/iter; left time: 450.9699s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.28s
Steps: 226 | Train Loss: 0.0076108 Vali Loss: 0.0077107 Test Loss: 0.0097691
Validation loss decreased (0.007722 --> 0.007711).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0079413
	speed: 0.0801s/iter; left time: 1223.1830s
	iters: 200, epoch: 33 | loss: 0.0084611
	speed: 0.0341s/iter; left time: 517.1612s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.25s
Steps: 226 | Train Loss: 0.0076104 Vali Loss: 0.0077472 Test Loss: 0.0097762
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0080443
	speed: 0.0894s/iter; left time: 1344.5777s
	iters: 200, epoch: 34 | loss: 0.0076971
	speed: 0.0405s/iter; left time: 605.0621s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.29s
Steps: 226 | Train Loss: 0.0076043 Vali Loss: 0.0077256 Test Loss: 0.0097612
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0085065
	speed: 0.0728s/iter; left time: 1078.0853s
	iters: 200, epoch: 35 | loss: 0.0081995
	speed: 0.0331s/iter; left time: 487.7798s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.27s
Steps: 226 | Train Loss: 0.0075912 Vali Loss: 0.0077143 Test Loss: 0.0097552
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0068593
	speed: 0.0725s/iter; left time: 1057.8870s
	iters: 200, epoch: 36 | loss: 0.0077889
	speed: 0.0355s/iter; left time: 514.4121s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.55s
Steps: 226 | Train Loss: 0.0075942 Vali Loss: 0.0077039 Test Loss: 0.0097492
Validation loss decreased (0.007711 --> 0.007704).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0083970
	speed: 0.0668s/iter; left time: 960.0787s
	iters: 200, epoch: 37 | loss: 0.0081276
	speed: 0.0272s/iter; left time: 387.4390s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.36s
Steps: 226 | Train Loss: 0.0075800 Vali Loss: 0.0077205 Test Loss: 0.0097417
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0066566
	speed: 0.0689s/iter; left time: 973.6672s
	iters: 200, epoch: 38 | loss: 0.0076736
	speed: 0.0346s/iter; left time: 485.8614s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.67s
Steps: 226 | Train Loss: 0.0075843 Vali Loss: 0.0077153 Test Loss: 0.0097522
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0073878
	speed: 0.0648s/iter; left time: 900.9520s
	iters: 200, epoch: 39 | loss: 0.0068948
	speed: 0.0268s/iter; left time: 370.4303s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.64s
Steps: 226 | Train Loss: 0.0075843 Vali Loss: 0.0077071 Test Loss: 0.0097395
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0067716
	speed: 0.0828s/iter; left time: 1132.7915s
	iters: 200, epoch: 40 | loss: 0.0069292
	speed: 0.0422s/iter; left time: 572.9846s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.99s
Steps: 226 | Train Loss: 0.0075804 Vali Loss: 0.0077128 Test Loss: 0.0097463
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0087412
	speed: 0.0829s/iter; left time: 1116.0052s
	iters: 200, epoch: 41 | loss: 0.0085838
	speed: 0.0267s/iter; left time: 356.7318s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.42s
Steps: 226 | Train Loss: 0.0075678 Vali Loss: 0.0076696 Test Loss: 0.0097519
Validation loss decreased (0.007704 --> 0.007670).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0066021
	speed: 0.0680s/iter; left time: 899.8087s
	iters: 200, epoch: 42 | loss: 0.0081806
	speed: 0.0253s/iter; left time: 331.9343s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.38s
Steps: 226 | Train Loss: 0.0075720 Vali Loss: 0.0076917 Test Loss: 0.0097417
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0064914
	speed: 0.0693s/iter; left time: 901.4095s
	iters: 200, epoch: 43 | loss: 0.0077684
	speed: 0.0323s/iter; left time: 417.3040s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.41s
Steps: 226 | Train Loss: 0.0075833 Vali Loss: 0.0077075 Test Loss: 0.0097418
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0076977
	speed: 0.0715s/iter; left time: 914.5500s
	iters: 200, epoch: 44 | loss: 0.0064298
	speed: 0.0252s/iter; left time: 319.6574s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.26s
Steps: 226 | Train Loss: 0.0075701 Vali Loss: 0.0076917 Test Loss: 0.0097360
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0082549
	speed: 0.0646s/iter; left time: 811.6309s
	iters: 200, epoch: 45 | loss: 0.0081084
	speed: 0.0309s/iter; left time: 385.3936s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.11s
Steps: 226 | Train Loss: 0.0075637 Vali Loss: 0.0077136 Test Loss: 0.0097361
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0077726
	speed: 0.0839s/iter; left time: 1034.6099s
	iters: 200, epoch: 46 | loss: 0.0061236
	speed: 0.0348s/iter; left time: 425.2131s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.18s
Steps: 226 | Train Loss: 0.0075685 Vali Loss: 0.0076890 Test Loss: 0.0097379
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0080226
	speed: 0.0846s/iter; left time: 1024.1546s
	iters: 200, epoch: 47 | loss: 0.0073111
	speed: 0.0332s/iter; left time: 398.0284s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.09s
Steps: 226 | Train Loss: 0.0075626 Vali Loss: 0.0076897 Test Loss: 0.0097352
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0077425
	speed: 0.0723s/iter; left time: 858.9998s
	iters: 200, epoch: 48 | loss: 0.0077390
	speed: 0.0303s/iter; left time: 356.9544s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.13s
Steps: 226 | Train Loss: 0.0075654 Vali Loss: 0.0077054 Test Loss: 0.0097400
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0079935
	speed: 0.0697s/iter; left time: 812.1396s
	iters: 200, epoch: 49 | loss: 0.0078852
	speed: 0.0286s/iter; left time: 330.9500s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.99s
Steps: 226 | Train Loss: 0.0075531 Vali Loss: 0.0077219 Test Loss: 0.0097373
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0076052
	speed: 0.0638s/iter; left time: 729.0553s
	iters: 200, epoch: 50 | loss: 0.0080884
	speed: 0.0307s/iter; left time: 347.2256s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.90s
Steps: 226 | Train Loss: 0.0075651 Vali Loss: 0.0077060 Test Loss: 0.0097415
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0076148
	speed: 0.0749s/iter; left time: 838.4543s
	iters: 200, epoch: 51 | loss: 0.0078435
	speed: 0.0270s/iter; left time: 299.3974s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.89s
Steps: 226 | Train Loss: 0.0075558 Vali Loss: 0.0077239 Test Loss: 0.0097382
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_24_ES_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009751889854669571, rmse:0.09875165671110153, mae:0.06079358235001564, rse:0.29061415791511536
Intermediate time for ES and pred_len 24: 00h:10m:14.78s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_168_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_168_96_ES_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0385214
	speed: 0.0833s/iter; left time: 1866.7780s
	iters: 200, epoch: 1 | loss: 0.0321006
	speed: 0.0363s/iter; left time: 809.1241s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.77s
Steps: 225 | Train Loss: 0.0402985 Vali Loss: 0.0268622 Test Loss: 0.0364986
Validation loss decreased (inf --> 0.026862).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0202941
	speed: 0.0986s/iter; left time: 2186.6123s
	iters: 200, epoch: 2 | loss: 0.0176809
	speed: 0.0383s/iter; left time: 846.5764s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.80s
Steps: 225 | Train Loss: 0.0199497 Vali Loss: 0.0171759 Test Loss: 0.0222667
Validation loss decreased (0.026862 --> 0.017176).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0164886
	speed: 0.0988s/iter; left time: 2169.5566s
	iters: 200, epoch: 3 | loss: 0.0159799
	speed: 0.0399s/iter; left time: 870.8837s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.00s
Steps: 225 | Train Loss: 0.0171304 Vali Loss: 0.0158539 Test Loss: 0.0206034
Validation loss decreased (0.017176 --> 0.015854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0139721
	speed: 0.0899s/iter; left time: 1952.2639s
	iters: 200, epoch: 4 | loss: 0.0155888
	speed: 0.0408s/iter; left time: 882.6002s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.26s
Steps: 225 | Train Loss: 0.0162038 Vali Loss: 0.0155706 Test Loss: 0.0199895
Validation loss decreased (0.015854 --> 0.015571).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0160721
	speed: 0.1031s/iter; left time: 2215.6828s
	iters: 200, epoch: 5 | loss: 0.0148397
	speed: 0.0516s/iter; left time: 1104.7086s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.61s
Steps: 225 | Train Loss: 0.0157221 Vali Loss: 0.0152692 Test Loss: 0.0195936
Validation loss decreased (0.015571 --> 0.015269).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0146115
	speed: 0.1357s/iter; left time: 2888.1024s
	iters: 200, epoch: 6 | loss: 0.0144678
	speed: 0.0323s/iter; left time: 683.7279s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.32s
Steps: 225 | Train Loss: 0.0153876 Vali Loss: 0.0152303 Test Loss: 0.0194437
Validation loss decreased (0.015269 --> 0.015230).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0142163
	speed: 0.0478s/iter; left time: 1005.6234s
	iters: 200, epoch: 7 | loss: 0.0141031
	speed: 0.0247s/iter; left time: 517.0438s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.14s
Steps: 225 | Train Loss: 0.0151415 Vali Loss: 0.0150768 Test Loss: 0.0191790
Validation loss decreased (0.015230 --> 0.015077).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0140387
	speed: 0.0919s/iter; left time: 1913.4497s
	iters: 200, epoch: 8 | loss: 0.0141506
	speed: 0.0341s/iter; left time: 706.4841s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.76s
Steps: 225 | Train Loss: 0.0149555 Vali Loss: 0.0150878 Test Loss: 0.0191487
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0142673
	speed: 0.1078s/iter; left time: 2221.1984s
	iters: 200, epoch: 9 | loss: 0.0143092
	speed: 0.0485s/iter; left time: 994.0081s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.68s
Steps: 225 | Train Loss: 0.0148236 Vali Loss: 0.0148663 Test Loss: 0.0189639
Validation loss decreased (0.015077 --> 0.014866).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0139251
	speed: 0.0873s/iter; left time: 1779.8181s
	iters: 200, epoch: 10 | loss: 0.0166310
	speed: 0.0547s/iter; left time: 1109.0509s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.05s
Steps: 225 | Train Loss: 0.0146813 Vali Loss: 0.0150752 Test Loss: 0.0190709
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0141909
	speed: 0.1272s/iter; left time: 2563.4074s
	iters: 200, epoch: 11 | loss: 0.0153536
	speed: 0.0197s/iter; left time: 394.5142s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.99s
Steps: 225 | Train Loss: 0.0145726 Vali Loss: 0.0148738 Test Loss: 0.0189073
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0141518
	speed: 0.0453s/iter; left time: 902.9086s
	iters: 200, epoch: 12 | loss: 0.0146643
	speed: 0.0243s/iter; left time: 482.5459s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.22s
Steps: 225 | Train Loss: 0.0144563 Vali Loss: 0.0147936 Test Loss: 0.0188262
Validation loss decreased (0.014866 --> 0.014794).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0127954
	speed: 0.0488s/iter; left time: 961.9703s
	iters: 200, epoch: 13 | loss: 0.0135295
	speed: 0.0303s/iter; left time: 593.0234s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.31s
Steps: 225 | Train Loss: 0.0143845 Vali Loss: 0.0148190 Test Loss: 0.0189337
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0153766
	speed: 0.0791s/iter; left time: 1541.4361s
	iters: 200, epoch: 14 | loss: 0.0150153
	speed: 0.0212s/iter; left time: 409.8173s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.33s
Steps: 225 | Train Loss: 0.0143134 Vali Loss: 0.0149541 Test Loss: 0.0189741
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0134031
	speed: 0.0456s/iter; left time: 877.1835s
	iters: 200, epoch: 15 | loss: 0.0160063
	speed: 0.0202s/iter; left time: 387.6431s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.0142359 Vali Loss: 0.0148774 Test Loss: 0.0189182
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0137937
	speed: 0.1028s/iter; left time: 1954.9851s
	iters: 200, epoch: 16 | loss: 0.0153615
	speed: 0.0205s/iter; left time: 388.5795s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.50s
Steps: 225 | Train Loss: 0.0141616 Vali Loss: 0.0148836 Test Loss: 0.0189698
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0141673
	speed: 0.0435s/iter; left time: 817.5058s
	iters: 200, epoch: 17 | loss: 0.0134428
	speed: 0.0214s/iter; left time: 399.2837s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.0140956 Vali Loss: 0.0147340 Test Loss: 0.0188355
Validation loss decreased (0.014794 --> 0.014734).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0139518
	speed: 0.0526s/iter; left time: 978.0026s
	iters: 200, epoch: 18 | loss: 0.0137749
	speed: 0.0361s/iter; left time: 666.3086s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.38s
Steps: 225 | Train Loss: 0.0140458 Vali Loss: 0.0148421 Test Loss: 0.0189237
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0140153
	speed: 0.0714s/iter; left time: 1309.4177s
	iters: 200, epoch: 19 | loss: 0.0141719
	speed: 0.0222s/iter; left time: 404.2952s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.29s
Steps: 225 | Train Loss: 0.0139988 Vali Loss: 0.0146938 Test Loss: 0.0188097
Validation loss decreased (0.014734 --> 0.014694).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0145078
	speed: 0.0592s/iter; left time: 1072.6189s
	iters: 200, epoch: 20 | loss: 0.0140767
	speed: 0.0204s/iter; left time: 367.0104s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.93s
Steps: 225 | Train Loss: 0.0139585 Vali Loss: 0.0147689 Test Loss: 0.0188606
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0134230
	speed: 0.0571s/iter; left time: 1021.9898s
	iters: 200, epoch: 21 | loss: 0.0123201
	speed: 0.0291s/iter; left time: 517.6158s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.58s
Steps: 225 | Train Loss: 0.0139100 Vali Loss: 0.0148057 Test Loss: 0.0188332
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0146732
	speed: 0.0608s/iter; left time: 1075.5546s
	iters: 200, epoch: 22 | loss: 0.0162446
	speed: 0.0191s/iter; left time: 336.5628s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.53s
Steps: 225 | Train Loss: 0.0138737 Vali Loss: 0.0148652 Test Loss: 0.0188741
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0149700
	speed: 0.0469s/iter; left time: 818.4077s
	iters: 200, epoch: 23 | loss: 0.0135929
	speed: 0.0218s/iter; left time: 378.8562s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.67s
Steps: 225 | Train Loss: 0.0138603 Vali Loss: 0.0147573 Test Loss: 0.0188534
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0130955
	speed: 0.1010s/iter; left time: 1740.1626s
	iters: 200, epoch: 24 | loss: 0.0129737
	speed: 0.0196s/iter; left time: 334.8176s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.13s
Steps: 225 | Train Loss: 0.0138433 Vali Loss: 0.0147270 Test Loss: 0.0188300
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0143310
	speed: 0.0431s/iter; left time: 733.4137s
	iters: 200, epoch: 25 | loss: 0.0139837
	speed: 0.0193s/iter; left time: 327.0212s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0137946 Vali Loss: 0.0148280 Test Loss: 0.0188872
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0130300
	speed: 0.0537s/iter; left time: 901.2312s
	iters: 200, epoch: 26 | loss: 0.0136986
	speed: 0.0490s/iter; left time: 817.6382s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.94s
Steps: 225 | Train Loss: 0.0137725 Vali Loss: 0.0147710 Test Loss: 0.0188353
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0146367
	speed: 0.0541s/iter; left time: 895.3023s
	iters: 200, epoch: 27 | loss: 0.0136573
	speed: 0.0217s/iter; left time: 357.0046s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.83s
Steps: 225 | Train Loss: 0.0137646 Vali Loss: 0.0147977 Test Loss: 0.0189136
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0146420
	speed: 0.0509s/iter; left time: 830.3653s
	iters: 200, epoch: 28 | loss: 0.0124258
	speed: 0.0311s/iter; left time: 503.9161s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.29s
Steps: 225 | Train Loss: 0.0137562 Vali Loss: 0.0147614 Test Loss: 0.0188549
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0153049
	speed: 0.0791s/iter; left time: 1273.9197s
	iters: 200, epoch: 29 | loss: 0.0134878
	speed: 0.0185s/iter; left time: 296.3427s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.19s
Steps: 225 | Train Loss: 0.0137445 Vali Loss: 0.0147277 Test Loss: 0.0188331
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_96_ES_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018809732049703598, rmse:0.13714857399463654, mae:0.08826389908790588, rse:0.40290123224258423
Intermediate time for ES and pred_len 96: 00h:05m:14.75s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_168_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_168_168_ES_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0418318
	speed: 0.0686s/iter; left time: 1535.7814s
	iters: 200, epoch: 1 | loss: 0.0310877
	speed: 0.0289s/iter; left time: 645.2031s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.70s
Steps: 225 | Train Loss: 0.0424433 Vali Loss: 0.0290079 Test Loss: 0.0391881
Validation loss decreased (inf --> 0.029008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0218836
	speed: 0.0559s/iter; left time: 1240.2360s
	iters: 200, epoch: 2 | loss: 0.0210375
	speed: 0.0226s/iter; left time: 499.5937s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.87s
Steps: 225 | Train Loss: 0.0218081 Vali Loss: 0.0196624 Test Loss: 0.0247310
Validation loss decreased (0.029008 --> 0.019662).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0185089
	speed: 0.1102s/iter; left time: 2418.0889s
	iters: 200, epoch: 3 | loss: 0.0187048
	speed: 0.0242s/iter; left time: 529.7523s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.12s
Steps: 225 | Train Loss: 0.0190434 Vali Loss: 0.0182646 Test Loss: 0.0228481
Validation loss decreased (0.019662 --> 0.018265).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0182760
	speed: 0.0615s/iter; left time: 1335.8476s
	iters: 200, epoch: 4 | loss: 0.0178577
	speed: 0.0228s/iter; left time: 493.3402s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.48s
Steps: 225 | Train Loss: 0.0180016 Vali Loss: 0.0176468 Test Loss: 0.0218411
Validation loss decreased (0.018265 --> 0.017647).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0167117
	speed: 0.1185s/iter; left time: 2547.2858s
	iters: 200, epoch: 5 | loss: 0.0163538
	speed: 0.0213s/iter; left time: 455.9758s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.10s
Steps: 225 | Train Loss: 0.0174683 Vali Loss: 0.0175372 Test Loss: 0.0215410
Validation loss decreased (0.017647 --> 0.017537).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0154899
	speed: 0.0576s/iter; left time: 1226.5511s
	iters: 200, epoch: 6 | loss: 0.0176745
	speed: 0.0259s/iter; left time: 547.5189s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0171330 Vali Loss: 0.0173297 Test Loss: 0.0213197
Validation loss decreased (0.017537 --> 0.017330).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0173982
	speed: 0.1044s/iter; left time: 2197.5805s
	iters: 200, epoch: 7 | loss: 0.0163391
	speed: 0.0251s/iter; left time: 525.8038s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.43s
Steps: 225 | Train Loss: 0.0168822 Vali Loss: 0.0172685 Test Loss: 0.0212768
Validation loss decreased (0.017330 --> 0.017269).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0175235
	speed: 0.0601s/iter; left time: 1251.3915s
	iters: 200, epoch: 8 | loss: 0.0173391
	speed: 0.0359s/iter; left time: 744.8956s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.12s
Steps: 225 | Train Loss: 0.0166973 Vali Loss: 0.0172033 Test Loss: 0.0212305
Validation loss decreased (0.017269 --> 0.017203).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0174077
	speed: 0.0742s/iter; left time: 1528.0674s
	iters: 200, epoch: 9 | loss: 0.0177108
	speed: 0.0291s/iter; left time: 596.6557s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.81s
Steps: 225 | Train Loss: 0.0165517 Vali Loss: 0.0170777 Test Loss: 0.0211148
Validation loss decreased (0.017203 --> 0.017078).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0160374
	speed: 0.0759s/iter; left time: 1546.4363s
	iters: 200, epoch: 10 | loss: 0.0152154
	speed: 0.0259s/iter; left time: 524.8310s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.48s
Steps: 225 | Train Loss: 0.0164015 Vali Loss: 0.0172799 Test Loss: 0.0212429
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0165146
	speed: 0.0697s/iter; left time: 1404.6440s
	iters: 200, epoch: 11 | loss: 0.0169340
	speed: 0.0366s/iter; left time: 733.3366s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.95s
Steps: 225 | Train Loss: 0.0162799 Vali Loss: 0.0170245 Test Loss: 0.0211387
Validation loss decreased (0.017078 --> 0.017025).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0174235
	speed: 0.0649s/iter; left time: 1292.3864s
	iters: 200, epoch: 12 | loss: 0.0168405
	speed: 0.0163s/iter; left time: 322.4914s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0161901 Vali Loss: 0.0170253 Test Loss: 0.0209918
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0157391
	speed: 0.0381s/iter; left time: 750.4034s
	iters: 200, epoch: 13 | loss: 0.0155118
	speed: 0.0171s/iter; left time: 335.4348s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0160766 Vali Loss: 0.0171959 Test Loss: 0.0210651
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0160115
	speed: 0.0866s/iter; left time: 1687.1148s
	iters: 200, epoch: 14 | loss: 0.0140521
	speed: 0.0268s/iter; left time: 518.8363s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.66s
Steps: 225 | Train Loss: 0.0159977 Vali Loss: 0.0171280 Test Loss: 0.0211238
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0158797
	speed: 0.0711s/iter; left time: 1369.6018s
	iters: 200, epoch: 15 | loss: 0.0149746
	speed: 0.0553s/iter; left time: 1059.9531s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.05s
Steps: 225 | Train Loss: 0.0159293 Vali Loss: 0.0171289 Test Loss: 0.0210804
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0157262
	speed: 0.0535s/iter; left time: 1018.3351s
	iters: 200, epoch: 16 | loss: 0.0152471
	speed: 0.0257s/iter; left time: 486.7917s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.85s
Steps: 225 | Train Loss: 0.0158684 Vali Loss: 0.0171377 Test Loss: 0.0211543
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0158248
	speed: 0.0782s/iter; left time: 1469.9721s
	iters: 200, epoch: 17 | loss: 0.0167456
	speed: 0.0431s/iter; left time: 805.9284s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.15s
Steps: 225 | Train Loss: 0.0157851 Vali Loss: 0.0171424 Test Loss: 0.0211536
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0142377
	speed: 0.0663s/iter; left time: 1231.6919s
	iters: 200, epoch: 18 | loss: 0.0154455
	speed: 0.0357s/iter; left time: 659.3945s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.75s
Steps: 225 | Train Loss: 0.0157332 Vali Loss: 0.0171524 Test Loss: 0.0210933
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0156443
	speed: 0.0726s/iter; left time: 1332.6308s
	iters: 200, epoch: 19 | loss: 0.0168023
	speed: 0.0464s/iter; left time: 846.2397s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.91s
Steps: 225 | Train Loss: 0.0156895 Vali Loss: 0.0171591 Test Loss: 0.0211719
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0153335
	speed: 0.0819s/iter; left time: 1483.7848s
	iters: 200, epoch: 20 | loss: 0.0163019
	speed: 0.0254s/iter; left time: 458.3233s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.93s
Steps: 225 | Train Loss: 0.0156480 Vali Loss: 0.0171658 Test Loss: 0.0211469
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0144234
	speed: 0.0640s/iter; left time: 1145.1888s
	iters: 200, epoch: 21 | loss: 0.0156189
	speed: 0.0545s/iter; left time: 970.2857s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.12s
Steps: 225 | Train Loss: 0.0156178 Vali Loss: 0.0171672 Test Loss: 0.0212086
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_168_ES_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021138742566108704, rmse:0.14539168775081635, mae:0.0951080247759819, rse:0.42714768648147583
Intermediate time for ES and pred_len 168: 00h:03m:52.53sIntermediate time for ES: 00h:19m:22.06s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0214014
	speed: 0.0465s/iter; left time: 1045.5679s
	iters: 200, epoch: 1 | loss: 0.0145572
	speed: 0.0183s/iter; left time: 410.2439s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.07s
Steps: 226 | Train Loss: 0.0225206 Vali Loss: 0.0184396 Test Loss: 0.0229489
Validation loss decreased (inf --> 0.018440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0084885
	speed: 0.0521s/iter; left time: 1161.2013s
	iters: 200, epoch: 2 | loss: 0.0069146
	speed: 0.0274s/iter; left time: 607.0213s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.11s
Steps: 226 | Train Loss: 0.0085904 Vali Loss: 0.0098390 Test Loss: 0.0112448
Validation loss decreased (0.018440 --> 0.009839).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0067327
	speed: 0.0826s/iter; left time: 1820.3676s
	iters: 200, epoch: 3 | loss: 0.0059661
	speed: 0.0283s/iter; left time: 620.1351s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.34s
Steps: 226 | Train Loss: 0.0070147 Vali Loss: 0.0093701 Test Loss: 0.0107432
Validation loss decreased (0.009839 --> 0.009370).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0073707
	speed: 0.0612s/iter; left time: 1336.4966s
	iters: 200, epoch: 4 | loss: 0.0069606
	speed: 0.0306s/iter; left time: 663.6817s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.98s
Steps: 226 | Train Loss: 0.0066252 Vali Loss: 0.0089922 Test Loss: 0.0105075
Validation loss decreased (0.009370 --> 0.008992).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0059994
	speed: 0.0626s/iter; left time: 1352.6284s
	iters: 200, epoch: 5 | loss: 0.0052356
	speed: 0.0334s/iter; left time: 718.8642s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.27s
Steps: 226 | Train Loss: 0.0063918 Vali Loss: 0.0088446 Test Loss: 0.0103435
Validation loss decreased (0.008992 --> 0.008845).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0059743
	speed: 0.0718s/iter; left time: 1534.6728s
	iters: 200, epoch: 6 | loss: 0.0054268
	speed: 0.0243s/iter; left time: 516.0893s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.41s
Steps: 226 | Train Loss: 0.0062265 Vali Loss: 0.0086468 Test Loss: 0.0102027
Validation loss decreased (0.008845 --> 0.008647).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0064023
	speed: 0.0604s/iter; left time: 1277.7380s
	iters: 200, epoch: 7 | loss: 0.0064050
	speed: 0.0283s/iter; left time: 595.7747s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.02s
Steps: 226 | Train Loss: 0.0061115 Vali Loss: 0.0086640 Test Loss: 0.0102161
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0059183
	speed: 0.0922s/iter; left time: 1928.2814s
	iters: 200, epoch: 8 | loss: 0.0059890
	speed: 0.0218s/iter; left time: 453.4298s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.35s
Steps: 226 | Train Loss: 0.0060151 Vali Loss: 0.0086641 Test Loss: 0.0103460
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0052437
	speed: 0.0549s/iter; left time: 1135.2678s
	iters: 200, epoch: 9 | loss: 0.0057425
	speed: 0.0302s/iter; left time: 621.5328s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.59s
Steps: 226 | Train Loss: 0.0059436 Vali Loss: 0.0084395 Test Loss: 0.0101464
Validation loss decreased (0.008647 --> 0.008440).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0057585
	speed: 0.0763s/iter; left time: 1562.2544s
	iters: 200, epoch: 10 | loss: 0.0061389
	speed: 0.0331s/iter; left time: 674.5683s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.64s
Steps: 226 | Train Loss: 0.0058756 Vali Loss: 0.0084618 Test Loss: 0.0100039
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0055120
	speed: 0.0616s/iter; left time: 1247.4301s
	iters: 200, epoch: 11 | loss: 0.0054122
	speed: 0.0354s/iter; left time: 713.9236s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.03s
Steps: 226 | Train Loss: 0.0058268 Vali Loss: 0.0084441 Test Loss: 0.0100350
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0066425
	speed: 0.0534s/iter; left time: 1068.2266s
	iters: 200, epoch: 12 | loss: 0.0056953
	speed: 0.0302s/iter; left time: 601.3445s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.39s
Steps: 226 | Train Loss: 0.0057755 Vali Loss: 0.0083846 Test Loss: 0.0100768
Validation loss decreased (0.008440 --> 0.008385).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0049884
	speed: 0.0771s/iter; left time: 1526.0992s
	iters: 200, epoch: 13 | loss: 0.0064530
	speed: 0.0241s/iter; left time: 474.2926s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.66s
Steps: 226 | Train Loss: 0.0057345 Vali Loss: 0.0083272 Test Loss: 0.0099970
Validation loss decreased (0.008385 --> 0.008327).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0061710
	speed: 0.0577s/iter; left time: 1128.0379s
	iters: 200, epoch: 14 | loss: 0.0062265
	speed: 0.0245s/iter; left time: 476.2506s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.11s
Steps: 226 | Train Loss: 0.0056927 Vali Loss: 0.0083816 Test Loss: 0.0100558
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0053974
	speed: 0.1023s/iter; left time: 1977.2106s
	iters: 200, epoch: 15 | loss: 0.0045167
	speed: 0.0249s/iter; left time: 478.5829s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.93s
Steps: 226 | Train Loss: 0.0056677 Vali Loss: 0.0083361 Test Loss: 0.0100202
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0060043
	speed: 0.0570s/iter; left time: 1089.8463s
	iters: 200, epoch: 16 | loss: 0.0055771
	speed: 0.0272s/iter; left time: 516.3875s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.25s
Steps: 226 | Train Loss: 0.0056243 Vali Loss: 0.0083715 Test Loss: 0.0099776
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0055168
	speed: 0.0740s/iter; left time: 1397.7394s
	iters: 200, epoch: 17 | loss: 0.0054286
	speed: 0.0322s/iter; left time: 604.7882s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.32s
Steps: 226 | Train Loss: 0.0056142 Vali Loss: 0.0083595 Test Loss: 0.0100348
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0055352
	speed: 0.0597s/iter; left time: 1114.3097s
	iters: 200, epoch: 18 | loss: 0.0051048
	speed: 0.0298s/iter; left time: 552.6135s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.65s
Steps: 226 | Train Loss: 0.0055779 Vali Loss: 0.0083256 Test Loss: 0.0100114
Validation loss decreased (0.008327 --> 0.008326).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0057776
	speed: 0.0624s/iter; left time: 1151.0329s
	iters: 200, epoch: 19 | loss: 0.0059579
	speed: 0.0235s/iter; left time: 431.1075s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.75s
Steps: 226 | Train Loss: 0.0055696 Vali Loss: 0.0082678 Test Loss: 0.0099987
Validation loss decreased (0.008326 --> 0.008268).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0063669
	speed: 0.0811s/iter; left time: 1476.2399s
	iters: 200, epoch: 20 | loss: 0.0077393
	speed: 0.0331s/iter; left time: 599.5057s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.51s
Steps: 226 | Train Loss: 0.0055387 Vali Loss: 0.0082505 Test Loss: 0.0099721
Validation loss decreased (0.008268 --> 0.008250).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0056185
	speed: 0.0568s/iter; left time: 1021.5923s
	iters: 200, epoch: 21 | loss: 0.0054805
	speed: 0.0220s/iter; left time: 392.9766s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.26s
Steps: 226 | Train Loss: 0.0055185 Vali Loss: 0.0083284 Test Loss: 0.0100105
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0052375
	speed: 0.0749s/iter; left time: 1329.5299s
	iters: 200, epoch: 22 | loss: 0.0058114
	speed: 0.0356s/iter; left time: 628.6617s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.65s
Steps: 226 | Train Loss: 0.0055146 Vali Loss: 0.0082659 Test Loss: 0.0099952
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0055529
	speed: 0.0495s/iter; left time: 868.3212s
	iters: 200, epoch: 23 | loss: 0.0053774
	speed: 0.0188s/iter; left time: 328.2097s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.61s
Steps: 226 | Train Loss: 0.0055039 Vali Loss: 0.0082733 Test Loss: 0.0099869
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0058973
	speed: 0.0514s/iter; left time: 889.0240s
	iters: 200, epoch: 24 | loss: 0.0055044
	speed: 0.0266s/iter; left time: 458.3838s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.92s
Steps: 226 | Train Loss: 0.0054934 Vali Loss: 0.0082724 Test Loss: 0.0099753
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0055101
	speed: 0.0631s/iter; left time: 1078.0938s
	iters: 200, epoch: 25 | loss: 0.0062767
	speed: 0.0336s/iter; left time: 571.0552s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.07s
Steps: 226 | Train Loss: 0.0054823 Vali Loss: 0.0082438 Test Loss: 0.0099522
Validation loss decreased (0.008250 --> 0.008244).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0058566
	speed: 0.0744s/iter; left time: 1254.3010s
	iters: 200, epoch: 26 | loss: 0.0056711
	speed: 0.0246s/iter; left time: 412.1057s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.08s
Steps: 226 | Train Loss: 0.0054782 Vali Loss: 0.0082551 Test Loss: 0.0099774
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0063704
	speed: 0.0658s/iter; left time: 1094.6314s
	iters: 200, epoch: 27 | loss: 0.0056807
	speed: 0.0357s/iter; left time: 590.3216s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.35s
Steps: 226 | Train Loss: 0.0054562 Vali Loss: 0.0082273 Test Loss: 0.0099577
Validation loss decreased (0.008244 --> 0.008227).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0051593
	speed: 0.0674s/iter; left time: 1104.8162s
	iters: 200, epoch: 28 | loss: 0.0049602
	speed: 0.0292s/iter; left time: 475.7376s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.13s
Steps: 226 | Train Loss: 0.0054514 Vali Loss: 0.0082629 Test Loss: 0.0099501
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0059183
	speed: 0.0806s/iter; left time: 1302.7991s
	iters: 200, epoch: 29 | loss: 0.0055221
	speed: 0.0282s/iter; left time: 453.7541s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.77s
Steps: 226 | Train Loss: 0.0054394 Vali Loss: 0.0082124 Test Loss: 0.0099311
Validation loss decreased (0.008227 --> 0.008212).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0048695
	speed: 0.0679s/iter; left time: 1082.1081s
	iters: 200, epoch: 30 | loss: 0.0057108
	speed: 0.0248s/iter; left time: 392.3202s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.34s
Steps: 226 | Train Loss: 0.0054387 Vali Loss: 0.0082322 Test Loss: 0.0099606
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0055624
	speed: 0.0740s/iter; left time: 1163.9512s
	iters: 200, epoch: 31 | loss: 0.0064698
	speed: 0.0255s/iter; left time: 397.9365s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.72s
Steps: 226 | Train Loss: 0.0054343 Vali Loss: 0.0082022 Test Loss: 0.0099584
Validation loss decreased (0.008212 --> 0.008202).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0054912
	speed: 0.0617s/iter; left time: 955.7692s
	iters: 200, epoch: 32 | loss: 0.0051729
	speed: 0.0339s/iter; left time: 521.8560s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.45s
Steps: 226 | Train Loss: 0.0054356 Vali Loss: 0.0082200 Test Loss: 0.0099480
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0066934
	speed: 0.0711s/iter; left time: 1084.9728s
	iters: 200, epoch: 33 | loss: 0.0061226
	speed: 0.0178s/iter; left time: 269.5879s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.07s
Steps: 226 | Train Loss: 0.0054288 Vali Loss: 0.0082018 Test Loss: 0.0099535
Validation loss decreased (0.008202 --> 0.008202).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0048274
	speed: 0.0417s/iter; left time: 627.2623s
	iters: 200, epoch: 34 | loss: 0.0058461
	speed: 0.0167s/iter; left time: 250.1951s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.24s
Steps: 226 | Train Loss: 0.0054293 Vali Loss: 0.0082111 Test Loss: 0.0099458
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0048740
	speed: 0.0500s/iter; left time: 740.2860s
	iters: 200, epoch: 35 | loss: 0.0052270
	speed: 0.0274s/iter; left time: 402.8505s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.50s
Steps: 226 | Train Loss: 0.0054257 Vali Loss: 0.0082203 Test Loss: 0.0099352
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0060480
	speed: 0.0671s/iter; left time: 978.6669s
	iters: 200, epoch: 36 | loss: 0.0057200
	speed: 0.0268s/iter; left time: 388.6075s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.56s
Steps: 226 | Train Loss: 0.0054139 Vali Loss: 0.0082122 Test Loss: 0.0099516
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0050441
	speed: 0.0637s/iter; left time: 914.9044s
	iters: 200, epoch: 37 | loss: 0.0059495
	speed: 0.0318s/iter; left time: 453.1156s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.19s
Steps: 226 | Train Loss: 0.0054095 Vali Loss: 0.0082246 Test Loss: 0.0099409
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0051967
	speed: 0.0659s/iter; left time: 932.4604s
	iters: 200, epoch: 38 | loss: 0.0059897
	speed: 0.0320s/iter; left time: 448.6926s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.11s
Steps: 226 | Train Loss: 0.0053976 Vali Loss: 0.0082012 Test Loss: 0.0099508
Validation loss decreased (0.008202 --> 0.008201).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0052787
	speed: 0.0695s/iter; left time: 966.4156s
	iters: 200, epoch: 39 | loss: 0.0047258
	speed: 0.0318s/iter; left time: 439.5298s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.13s
Steps: 226 | Train Loss: 0.0054121 Vali Loss: 0.0082163 Test Loss: 0.0099372
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0047600
	speed: 0.0667s/iter; left time: 913.5721s
	iters: 200, epoch: 40 | loss: 0.0060419
	speed: 0.0279s/iter; left time: 379.6164s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.92s
Steps: 226 | Train Loss: 0.0054035 Vali Loss: 0.0082144 Test Loss: 0.0099391
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0053946
	speed: 0.0674s/iter; left time: 907.4149s
	iters: 200, epoch: 41 | loss: 0.0048580
	speed: 0.0308s/iter; left time: 411.4795s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.40s
Steps: 226 | Train Loss: 0.0054028 Vali Loss: 0.0082137 Test Loss: 0.0099513
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0053619
	speed: 0.0728s/iter; left time: 963.1081s
	iters: 200, epoch: 42 | loss: 0.0055491
	speed: 0.0300s/iter; left time: 394.1669s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.10s
Steps: 226 | Train Loss: 0.0054027 Vali Loss: 0.0081900 Test Loss: 0.0099411
Validation loss decreased (0.008201 --> 0.008190).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0055729
	speed: 0.0746s/iter; left time: 971.0289s
	iters: 200, epoch: 43 | loss: 0.0051776
	speed: 0.0278s/iter; left time: 359.0035s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.88s
Steps: 226 | Train Loss: 0.0054087 Vali Loss: 0.0082251 Test Loss: 0.0099428
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0065977
	speed: 0.0757s/iter; left time: 967.1938s
	iters: 200, epoch: 44 | loss: 0.0057450
	speed: 0.0321s/iter; left time: 406.8943s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.64s
Steps: 226 | Train Loss: 0.0053970 Vali Loss: 0.0082129 Test Loss: 0.0099601
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0049890
	speed: 0.0751s/iter; left time: 942.9276s
	iters: 200, epoch: 45 | loss: 0.0063225
	speed: 0.0308s/iter; left time: 383.7337s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.52s
Steps: 226 | Train Loss: 0.0053993 Vali Loss: 0.0082445 Test Loss: 0.0099413
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0051483
	speed: 0.0765s/iter; left time: 942.8198s
	iters: 200, epoch: 46 | loss: 0.0049865
	speed: 0.0303s/iter; left time: 370.8887s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.26s
Steps: 226 | Train Loss: 0.0053943 Vali Loss: 0.0082098 Test Loss: 0.0099457
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0052320
	speed: 0.0796s/iter; left time: 964.0414s
	iters: 200, epoch: 47 | loss: 0.0059659
	speed: 0.0293s/iter; left time: 351.7331s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.27s
Steps: 226 | Train Loss: 0.0053895 Vali Loss: 0.0081924 Test Loss: 0.0099481
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0055492
	speed: 0.0707s/iter; left time: 839.5113s
	iters: 200, epoch: 48 | loss: 0.0043556
	speed: 0.0293s/iter; left time: 345.1927s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.18s
Steps: 226 | Train Loss: 0.0053922 Vali Loss: 0.0082154 Test Loss: 0.0099448
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0051179
	speed: 0.0767s/iter; left time: 893.7971s
	iters: 200, epoch: 49 | loss: 0.0056693
	speed: 0.0318s/iter; left time: 366.8317s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.01s
Steps: 226 | Train Loss: 0.0053863 Vali Loss: 0.0081961 Test Loss: 0.0099444
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0054214
	speed: 0.0731s/iter; left time: 835.1078s
	iters: 200, epoch: 50 | loss: 0.0059862
	speed: 0.0274s/iter; left time: 309.9842s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.86s
Steps: 226 | Train Loss: 0.0053821 Vali Loss: 0.0082106 Test Loss: 0.0099440
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0053560
	speed: 0.0720s/iter; left time: 806.7189s
	iters: 200, epoch: 51 | loss: 0.0060457
	speed: 0.0293s/iter; left time: 325.0421s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.42s
Steps: 226 | Train Loss: 0.0053953 Vali Loss: 0.0082016 Test Loss: 0.0099440
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0059672
	speed: 0.0650s/iter; left time: 712.8809s
	iters: 200, epoch: 52 | loss: 0.0054211
	speed: 0.0311s/iter; left time: 338.3667s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.28s
Steps: 226 | Train Loss: 0.0053981 Vali Loss: 0.0081929 Test Loss: 0.0099474
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009941143915057182, rmse:0.0997052863240242, mae:0.056643787771463394, rse:0.3846602439880371
Intermediate time for FR and pred_len 24: 00h:08m:31.16s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0242119
	speed: 0.0675s/iter; left time: 1512.1852s
	iters: 200, epoch: 1 | loss: 0.0189905
	speed: 0.0330s/iter; left time: 736.1255s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.49s
Steps: 225 | Train Loss: 0.0249051 Vali Loss: 0.0217590 Test Loss: 0.0277699
Validation loss decreased (inf --> 0.021759).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0133864
	speed: 0.0747s/iter; left time: 1657.5674s
	iters: 200, epoch: 2 | loss: 0.0129357
	speed: 0.0305s/iter; left time: 674.0878s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.10s
Steps: 225 | Train Loss: 0.0133166 Vali Loss: 0.0155336 Test Loss: 0.0199100
Validation loss decreased (0.021759 --> 0.015534).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0114889
	speed: 0.0740s/iter; left time: 1624.7860s
	iters: 200, epoch: 3 | loss: 0.0128945
	speed: 0.0365s/iter; left time: 797.5956s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.28s
Steps: 225 | Train Loss: 0.0115833 Vali Loss: 0.0146534 Test Loss: 0.0191689
Validation loss decreased (0.015534 --> 0.014653).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0096506
	speed: 0.0867s/iter; left time: 1883.9506s
	iters: 200, epoch: 4 | loss: 0.0106959
	speed: 0.0409s/iter; left time: 884.5815s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.76s
Steps: 225 | Train Loss: 0.0110096 Vali Loss: 0.0143571 Test Loss: 0.0189645
Validation loss decreased (0.014653 --> 0.014357).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0110854
	speed: 0.0926s/iter; left time: 1990.0259s
	iters: 200, epoch: 5 | loss: 0.0108944
	speed: 0.0498s/iter; left time: 1066.5335s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.40s
Steps: 225 | Train Loss: 0.0107397 Vali Loss: 0.0141109 Test Loss: 0.0188817
Validation loss decreased (0.014357 --> 0.014111).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0105365
	speed: 0.0972s/iter; left time: 2067.5188s
	iters: 200, epoch: 6 | loss: 0.0099358
	speed: 0.0439s/iter; left time: 929.1238s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.19s
Steps: 225 | Train Loss: 0.0105499 Vali Loss: 0.0140572 Test Loss: 0.0187163
Validation loss decreased (0.014111 --> 0.014057).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0089927
	speed: 0.0978s/iter; left time: 2057.8290s
	iters: 200, epoch: 7 | loss: 0.0099737
	speed: 0.0451s/iter; left time: 945.7169s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.91s
Steps: 225 | Train Loss: 0.0103798 Vali Loss: 0.0140918 Test Loss: 0.0186790
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0118735
	speed: 0.0945s/iter; left time: 1969.0095s
	iters: 200, epoch: 8 | loss: 0.0107587
	speed: 0.0449s/iter; left time: 930.4285s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.89s
Steps: 225 | Train Loss: 0.0102556 Vali Loss: 0.0141602 Test Loss: 0.0188255
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0094852
	speed: 0.1207s/iter; left time: 2487.4936s
	iters: 200, epoch: 9 | loss: 0.0104117
	speed: 0.0472s/iter; left time: 967.2519s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.35s
Steps: 225 | Train Loss: 0.0101461 Vali Loss: 0.0141134 Test Loss: 0.0188376
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0100241
	speed: 0.0948s/iter; left time: 1931.4085s
	iters: 200, epoch: 10 | loss: 0.0114260
	speed: 0.0498s/iter; left time: 1010.1916s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.84s
Steps: 225 | Train Loss: 0.0100464 Vali Loss: 0.0139718 Test Loss: 0.0186181
Validation loss decreased (0.014057 --> 0.013972).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0092512
	speed: 0.0860s/iter; left time: 1732.0959s
	iters: 200, epoch: 11 | loss: 0.0105780
	speed: 0.0528s/iter; left time: 1057.8352s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.76s
Steps: 225 | Train Loss: 0.0099659 Vali Loss: 0.0140622 Test Loss: 0.0185865
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0095099
	speed: 0.0871s/iter; left time: 1734.6307s
	iters: 200, epoch: 12 | loss: 0.0113929
	speed: 0.0470s/iter; left time: 932.1768s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.36s
Steps: 225 | Train Loss: 0.0098971 Vali Loss: 0.0139690 Test Loss: 0.0185923
Validation loss decreased (0.013972 --> 0.013969).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0089053
	speed: 0.1034s/iter; left time: 2036.4028s
	iters: 200, epoch: 13 | loss: 0.0110970
	speed: 0.0519s/iter; left time: 1017.3723s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.17s
Steps: 225 | Train Loss: 0.0098009 Vali Loss: 0.0139987 Test Loss: 0.0186758
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0104156
	speed: 0.0910s/iter; left time: 1772.4151s
	iters: 200, epoch: 14 | loss: 0.0107352
	speed: 0.0482s/iter; left time: 933.1722s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.87s
Steps: 225 | Train Loss: 0.0097639 Vali Loss: 0.0139314 Test Loss: 0.0185757
Validation loss decreased (0.013969 --> 0.013931).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0100680
	speed: 0.0957s/iter; left time: 1842.1949s
	iters: 200, epoch: 15 | loss: 0.0093769
	speed: 0.0449s/iter; left time: 860.6688s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.49s
Steps: 225 | Train Loss: 0.0097022 Vali Loss: 0.0140342 Test Loss: 0.0185551
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0094552
	speed: 0.1083s/iter; left time: 2060.6460s
	iters: 200, epoch: 16 | loss: 0.0097943
	speed: 0.0413s/iter; left time: 780.7715s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.21s
Steps: 225 | Train Loss: 0.0096613 Vali Loss: 0.0140575 Test Loss: 0.0186617
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0094170
	speed: 0.0985s/iter; left time: 1851.9953s
	iters: 200, epoch: 17 | loss: 0.0103829
	speed: 0.0526s/iter; left time: 984.5678s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.97s
Steps: 225 | Train Loss: 0.0096146 Vali Loss: 0.0140356 Test Loss: 0.0187498
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0102264
	speed: 0.0952s/iter; left time: 1767.6326s
	iters: 200, epoch: 18 | loss: 0.0095341
	speed: 0.0508s/iter; left time: 939.2880s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.05s
Steps: 225 | Train Loss: 0.0095707 Vali Loss: 0.0140555 Test Loss: 0.0185867
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0091605
	speed: 0.0927s/iter; left time: 1700.7312s
	iters: 200, epoch: 19 | loss: 0.0093767
	speed: 0.0475s/iter; left time: 867.7873s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.77s
Steps: 225 | Train Loss: 0.0095344 Vali Loss: 0.0140573 Test Loss: 0.0187457
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0095285
	speed: 0.0843s/iter; left time: 1528.6786s
	iters: 200, epoch: 20 | loss: 0.0106554
	speed: 0.0426s/iter; left time: 767.4184s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.57s
Steps: 225 | Train Loss: 0.0095132 Vali Loss: 0.0140521 Test Loss: 0.0187558
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0086229
	speed: 0.0999s/iter; left time: 1787.7186s
	iters: 200, epoch: 21 | loss: 0.0081618
	speed: 0.0500s/iter; left time: 890.9304s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.98s
Steps: 225 | Train Loss: 0.0094732 Vali Loss: 0.0140823 Test Loss: 0.0186404
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0094810
	speed: 0.1088s/iter; left time: 1923.6633s
	iters: 200, epoch: 22 | loss: 0.0104590
	speed: 0.0426s/iter; left time: 748.5200s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.10s
Steps: 225 | Train Loss: 0.0094494 Vali Loss: 0.0140780 Test Loss: 0.0187164
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0111367
	speed: 0.0701s/iter; left time: 1222.5957s
	iters: 200, epoch: 23 | loss: 0.0086470
	speed: 0.0457s/iter; left time: 792.4132s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.88s
Steps: 225 | Train Loss: 0.0094175 Vali Loss: 0.0141186 Test Loss: 0.0186971
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0093648
	speed: 0.0528s/iter; left time: 909.8051s
	iters: 200, epoch: 24 | loss: 0.0095880
	speed: 0.0164s/iter; left time: 281.6998s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.0093960 Vali Loss: 0.0141392 Test Loss: 0.0187757
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018575744703412056, rmse:0.13629285991191864, mae:0.08204299211502075, rse:0.5272170305252075
Intermediate time for FR and pred_len 96: 00h:05m:32.63s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0265635
	speed: 0.0575s/iter; left time: 1288.6036s
	iters: 200, epoch: 1 | loss: 0.0194377
	speed: 0.0637s/iter; left time: 1421.3725s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:12.25s
Steps: 225 | Train Loss: 0.0264126 Vali Loss: 0.0232208 Test Loss: 0.0288062
Validation loss decreased (inf --> 0.023221).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0166239
	speed: 0.1232s/iter; left time: 2731.1538s
	iters: 200, epoch: 2 | loss: 0.0140248
	speed: 0.0609s/iter; left time: 1344.3090s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.62s
Steps: 225 | Train Loss: 0.0148250 Vali Loss: 0.0169483 Test Loss: 0.0215553
Validation loss decreased (0.023221 --> 0.016948).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0114372
	speed: 0.0983s/iter; left time: 2157.7028s
	iters: 200, epoch: 3 | loss: 0.0119995
	speed: 0.0625s/iter; left time: 1366.1036s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.62s
Steps: 225 | Train Loss: 0.0129030 Vali Loss: 0.0159594 Test Loss: 0.0209190
Validation loss decreased (0.016948 --> 0.015959).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0142003
	speed: 0.0995s/iter; left time: 2161.5971s
	iters: 200, epoch: 4 | loss: 0.0132558
	speed: 0.0528s/iter; left time: 1141.5349s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.91s
Steps: 225 | Train Loss: 0.0122763 Vali Loss: 0.0157880 Test Loss: 0.0208853
Validation loss decreased (0.015959 --> 0.015788).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0120211
	speed: 0.0914s/iter; left time: 1964.7984s
	iters: 200, epoch: 5 | loss: 0.0105536
	speed: 0.0267s/iter; left time: 570.9060s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.96s
Steps: 225 | Train Loss: 0.0119905 Vali Loss: 0.0156816 Test Loss: 0.0204916
Validation loss decreased (0.015788 --> 0.015682).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0112292
	speed: 0.0656s/iter; left time: 1395.6634s
	iters: 200, epoch: 6 | loss: 0.0134623
	speed: 0.0334s/iter; left time: 706.2847s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.35s
Steps: 225 | Train Loss: 0.0117887 Vali Loss: 0.0155945 Test Loss: 0.0205650
Validation loss decreased (0.015682 --> 0.015595).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0112592
	speed: 0.1344s/iter; left time: 2828.9337s
	iters: 200, epoch: 7 | loss: 0.0118189
	speed: 0.0585s/iter; left time: 1224.9963s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.37s
Steps: 225 | Train Loss: 0.0116513 Vali Loss: 0.0155949 Test Loss: 0.0205162
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0098861
	speed: 0.1293s/iter; left time: 2692.5948s
	iters: 200, epoch: 8 | loss: 0.0110440
	speed: 0.0488s/iter; left time: 1012.2551s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.72s
Steps: 225 | Train Loss: 0.0115205 Vali Loss: 0.0155843 Test Loss: 0.0205340
Validation loss decreased (0.015595 --> 0.015584).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0120436
	speed: 0.1436s/iter; left time: 2958.4088s
	iters: 200, epoch: 9 | loss: 0.0117982
	speed: 0.0414s/iter; left time: 848.9145s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.97s
Steps: 225 | Train Loss: 0.0114065 Vali Loss: 0.0155008 Test Loss: 0.0203243
Validation loss decreased (0.015584 --> 0.015501).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0118167
	speed: 0.1751s/iter; left time: 3568.7616s
	iters: 200, epoch: 10 | loss: 0.0113397
	speed: 0.0390s/iter; left time: 789.7745s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.05s
Steps: 225 | Train Loss: 0.0113024 Vali Loss: 0.0155792 Test Loss: 0.0203798
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0119269
	speed: 0.1243s/iter; left time: 2505.1871s
	iters: 200, epoch: 11 | loss: 0.0098879
	speed: 0.0551s/iter; left time: 1104.6570s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.76s
Steps: 225 | Train Loss: 0.0112100 Vali Loss: 0.0155863 Test Loss: 0.0206468
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0109906
	speed: 0.1021s/iter; left time: 2034.0708s
	iters: 200, epoch: 12 | loss: 0.0112945
	speed: 0.0530s/iter; left time: 1050.7848s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.11s
Steps: 225 | Train Loss: 0.0111068 Vali Loss: 0.0156394 Test Loss: 0.0207387
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0111686
	speed: 0.1442s/iter; left time: 2841.0370s
	iters: 200, epoch: 13 | loss: 0.0104042
	speed: 0.0527s/iter; left time: 1033.8337s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.92s
Steps: 225 | Train Loss: 0.0110203 Vali Loss: 0.0156567 Test Loss: 0.0205409
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0118282
	speed: 0.1576s/iter; left time: 3070.3153s
	iters: 200, epoch: 14 | loss: 0.0114619
	speed: 0.0391s/iter; left time: 757.8374s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.10s
Steps: 225 | Train Loss: 0.0109452 Vali Loss: 0.0157138 Test Loss: 0.0208073
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0103363
	speed: 0.1424s/iter; left time: 2741.6020s
	iters: 200, epoch: 15 | loss: 0.0099776
	speed: 0.0421s/iter; left time: 805.9097s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.17s
Steps: 225 | Train Loss: 0.0108966 Vali Loss: 0.0157213 Test Loss: 0.0208918
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0109692
	speed: 0.1228s/iter; left time: 2336.9919s
	iters: 200, epoch: 16 | loss: 0.0112045
	speed: 0.0531s/iter; left time: 1004.0711s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.34s
Steps: 225 | Train Loss: 0.0108314 Vali Loss: 0.0157334 Test Loss: 0.0208079
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0108547
	speed: 0.1590s/iter; left time: 2989.3833s
	iters: 200, epoch: 17 | loss: 0.0111214
	speed: 0.0454s/iter; left time: 849.6576s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.91s
Steps: 225 | Train Loss: 0.0107619 Vali Loss: 0.0157618 Test Loss: 0.0209842
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0103792
	speed: 0.1284s/iter; left time: 2385.9108s
	iters: 200, epoch: 18 | loss: 0.0104057
	speed: 0.0278s/iter; left time: 513.1756s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.71s
Steps: 225 | Train Loss: 0.0107229 Vali Loss: 0.0157928 Test Loss: 0.0209592
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0105714
	speed: 0.1042s/iter; left time: 1911.7321s
	iters: 200, epoch: 19 | loss: 0.0113793
	speed: 0.0387s/iter; left time: 706.2586s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.63s
Steps: 225 | Train Loss: 0.0106709 Vali Loss: 0.0158113 Test Loss: 0.0211378
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020324300974607468, rmse:0.1425633281469345, mae:0.08861789107322693, rse:0.5521612763404846
Intermediate time for FR and pred_len 168: 00h:05m:31.76sIntermediate time for FR: 00h:19m:35.55s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0427644
	speed: 0.0485s/iter; left time: 1090.3603s
	iters: 200, epoch: 1 | loss: 0.0291665
	speed: 0.0382s/iter; left time: 855.1709s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.16s
Steps: 226 | Train Loss: 0.0426089 Vali Loss: 0.0234300 Test Loss: 0.0253591
Validation loss decreased (inf --> 0.023430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0135666
	speed: 0.0784s/iter; left time: 1746.0179s
	iters: 200, epoch: 2 | loss: 0.0129317
	speed: 0.0320s/iter; left time: 709.6154s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.61s
Steps: 226 | Train Loss: 0.0153345 Vali Loss: 0.0111285 Test Loss: 0.0120855
Validation loss decreased (0.023430 --> 0.011128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0125586
	speed: 0.0749s/iter; left time: 1650.5465s
	iters: 200, epoch: 3 | loss: 0.0112898
	speed: 0.0305s/iter; left time: 669.8211s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.21s
Steps: 226 | Train Loss: 0.0119622 Vali Loss: 0.0103058 Test Loss: 0.0113176
Validation loss decreased (0.011128 --> 0.010306).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0107425
	speed: 0.0881s/iter; left time: 1922.8519s
	iters: 200, epoch: 4 | loss: 0.0094230
	speed: 0.0280s/iter; left time: 607.7616s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.48s
Steps: 226 | Train Loss: 0.0111439 Vali Loss: 0.0099383 Test Loss: 0.0109307
Validation loss decreased (0.010306 --> 0.009938).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0119819
	speed: 0.0759s/iter; left time: 1640.1053s
	iters: 200, epoch: 5 | loss: 0.0102829
	speed: 0.0475s/iter; left time: 1020.6552s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.57s
Steps: 226 | Train Loss: 0.0106644 Vali Loss: 0.0096654 Test Loss: 0.0106351
Validation loss decreased (0.009938 --> 0.009665).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0100474
	speed: 0.0543s/iter; left time: 1160.2392s
	iters: 200, epoch: 6 | loss: 0.0094613
	speed: 0.0169s/iter; left time: 360.1263s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.12s
Steps: 226 | Train Loss: 0.0103493 Vali Loss: 0.0094481 Test Loss: 0.0103848
Validation loss decreased (0.009665 --> 0.009448).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0118266
	speed: 0.0504s/iter; left time: 1064.8666s
	iters: 200, epoch: 7 | loss: 0.0097277
	speed: 0.0271s/iter; left time: 571.2305s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.87s
Steps: 226 | Train Loss: 0.0101450 Vali Loss: 0.0094589 Test Loss: 0.0103997
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0095389
	speed: 0.0705s/iter; left time: 1475.8192s
	iters: 200, epoch: 8 | loss: 0.0106729
	speed: 0.0472s/iter; left time: 982.7192s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.42s
Steps: 226 | Train Loss: 0.0100044 Vali Loss: 0.0093035 Test Loss: 0.0102250
Validation loss decreased (0.009448 --> 0.009303).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0097942
	speed: 0.0720s/iter; left time: 1490.8777s
	iters: 200, epoch: 9 | loss: 0.0097993
	speed: 0.0329s/iter; left time: 677.3811s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.84s
Steps: 226 | Train Loss: 0.0098369 Vali Loss: 0.0092346 Test Loss: 0.0102146
Validation loss decreased (0.009303 --> 0.009235).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0099564
	speed: 0.0960s/iter; left time: 1964.7149s
	iters: 200, epoch: 10 | loss: 0.0102991
	speed: 0.0246s/iter; left time: 501.4904s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.42s
Steps: 226 | Train Loss: 0.0097580 Vali Loss: 0.0091586 Test Loss: 0.0100977
Validation loss decreased (0.009235 --> 0.009159).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0086434
	speed: 0.0542s/iter; left time: 1098.0237s
	iters: 200, epoch: 11 | loss: 0.0096359
	speed: 0.0195s/iter; left time: 392.5545s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.58s
Steps: 226 | Train Loss: 0.0096705 Vali Loss: 0.0092086 Test Loss: 0.0101226
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0111360
	speed: 0.0692s/iter; left time: 1384.2870s
	iters: 200, epoch: 12 | loss: 0.0106724
	speed: 0.0313s/iter; left time: 623.2161s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.34s
Steps: 226 | Train Loss: 0.0096070 Vali Loss: 0.0090734 Test Loss: 0.0100747
Validation loss decreased (0.009159 --> 0.009073).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0089536
	speed: 0.0839s/iter; left time: 1661.1133s
	iters: 200, epoch: 13 | loss: 0.0075973
	speed: 0.0343s/iter; left time: 675.8967s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.39s
Steps: 226 | Train Loss: 0.0095315 Vali Loss: 0.0090904 Test Loss: 0.0100318
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0101849
	speed: 0.0684s/iter; left time: 1337.6736s
	iters: 200, epoch: 14 | loss: 0.0094804
	speed: 0.0323s/iter; left time: 628.8837s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.14s
Steps: 226 | Train Loss: 0.0094820 Vali Loss: 0.0090765 Test Loss: 0.0100181
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0085579
	speed: 0.0862s/iter; left time: 1666.6054s
	iters: 200, epoch: 15 | loss: 0.0107631
	speed: 0.0283s/iter; left time: 543.8782s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.36s
Steps: 226 | Train Loss: 0.0094281 Vali Loss: 0.0090492 Test Loss: 0.0100166
Validation loss decreased (0.009073 --> 0.009049).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0101539
	speed: 0.0720s/iter; left time: 1376.7790s
	iters: 200, epoch: 16 | loss: 0.0084199
	speed: 0.0500s/iter; left time: 950.5012s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.97s
Steps: 226 | Train Loss: 0.0093823 Vali Loss: 0.0091001 Test Loss: 0.0100515
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0090759
	speed: 0.0736s/iter; left time: 1389.6985s
	iters: 200, epoch: 17 | loss: 0.0091737
	speed: 0.0274s/iter; left time: 514.1774s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.03s
Steps: 226 | Train Loss: 0.0093435 Vali Loss: 0.0090378 Test Loss: 0.0099843
Validation loss decreased (0.009049 --> 0.009038).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0101232
	speed: 0.0948s/iter; left time: 1768.0497s
	iters: 200, epoch: 18 | loss: 0.0084545
	speed: 0.0276s/iter; left time: 512.0467s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.69s
Steps: 226 | Train Loss: 0.0093282 Vali Loss: 0.0090161 Test Loss: 0.0099726
Validation loss decreased (0.009038 --> 0.009016).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0101296
	speed: 0.0672s/iter; left time: 1237.9290s
	iters: 200, epoch: 19 | loss: 0.0081247
	speed: 0.0481s/iter; left time: 881.0214s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.28s
Steps: 226 | Train Loss: 0.0093000 Vali Loss: 0.0090169 Test Loss: 0.0099598
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0085207
	speed: 0.0729s/iter; left time: 1327.4617s
	iters: 200, epoch: 20 | loss: 0.0106575
	speed: 0.0293s/iter; left time: 530.2584s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.99s
Steps: 226 | Train Loss: 0.0092577 Vali Loss: 0.0090158 Test Loss: 0.0099629
Validation loss decreased (0.009016 --> 0.009016).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0096524
	speed: 0.0881s/iter; left time: 1583.2618s
	iters: 200, epoch: 21 | loss: 0.0096965
	speed: 0.0301s/iter; left time: 539.0862s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.19s
Steps: 226 | Train Loss: 0.0092286 Vali Loss: 0.0090278 Test Loss: 0.0099740
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0085044
	speed: 0.0778s/iter; left time: 1381.4710s
	iters: 200, epoch: 22 | loss: 0.0097745
	speed: 0.0318s/iter; left time: 560.9670s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.40s
Steps: 226 | Train Loss: 0.0092048 Vali Loss: 0.0090266 Test Loss: 0.0099292
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0081876
	speed: 0.0867s/iter; left time: 1518.9184s
	iters: 200, epoch: 23 | loss: 0.0080436
	speed: 0.0394s/iter; left time: 686.3334s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.37s
Steps: 226 | Train Loss: 0.0091790 Vali Loss: 0.0089924 Test Loss: 0.0099458
Validation loss decreased (0.009016 --> 0.008992).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0080196
	speed: 0.0745s/iter; left time: 1289.3025s
	iters: 200, epoch: 24 | loss: 0.0102902
	speed: 0.0409s/iter; left time: 703.0702s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.00s
Steps: 226 | Train Loss: 0.0091637 Vali Loss: 0.0089613 Test Loss: 0.0099342
Validation loss decreased (0.008992 --> 0.008961).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0088788
	speed: 0.0683s/iter; left time: 1166.8872s
	iters: 200, epoch: 25 | loss: 0.0095923
	speed: 0.0273s/iter; left time: 463.9541s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.60s
Steps: 226 | Train Loss: 0.0091597 Vali Loss: 0.0090058 Test Loss: 0.0099207
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0080711
	speed: 0.0949s/iter; left time: 1599.0179s
	iters: 200, epoch: 26 | loss: 0.0104032
	speed: 0.0285s/iter; left time: 476.6298s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.67s
Steps: 226 | Train Loss: 0.0091317 Vali Loss: 0.0089826 Test Loss: 0.0099222
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0088905
	speed: 0.0767s/iter; left time: 1274.4187s
	iters: 200, epoch: 27 | loss: 0.0105031
	speed: 0.0455s/iter; left time: 751.4591s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.64s
Steps: 226 | Train Loss: 0.0091199 Vali Loss: 0.0089627 Test Loss: 0.0099322
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0093362
	speed: 0.0723s/iter; left time: 1186.0515s
	iters: 200, epoch: 28 | loss: 0.0086763
	speed: 0.0279s/iter; left time: 455.4829s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.96s
Steps: 226 | Train Loss: 0.0091062 Vali Loss: 0.0089637 Test Loss: 0.0099520
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0090730
	speed: 0.0927s/iter; left time: 1498.8831s
	iters: 200, epoch: 29 | loss: 0.0088845
	speed: 0.0286s/iter; left time: 458.9106s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.94s
Steps: 226 | Train Loss: 0.0090892 Vali Loss: 0.0089406 Test Loss: 0.0098978
Validation loss decreased (0.008961 --> 0.008941).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0076724
	speed: 0.0758s/iter; left time: 1208.3972s
	iters: 200, epoch: 30 | loss: 0.0101498
	speed: 0.0227s/iter; left time: 359.1034s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0090841 Vali Loss: 0.0089625 Test Loss: 0.0099098
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0089099
	speed: 0.0460s/iter; left time: 723.2144s
	iters: 200, epoch: 31 | loss: 0.0098940
	speed: 0.0187s/iter; left time: 292.4243s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.65s
Steps: 226 | Train Loss: 0.0090745 Vali Loss: 0.0089565 Test Loss: 0.0099237
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0088118
	speed: 0.0736s/iter; left time: 1140.6685s
	iters: 200, epoch: 32 | loss: 0.0087904
	speed: 0.0433s/iter; left time: 667.2638s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.97s
Steps: 226 | Train Loss: 0.0090637 Vali Loss: 0.0089329 Test Loss: 0.0099249
Validation loss decreased (0.008941 --> 0.008933).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0092595
	speed: 0.0701s/iter; left time: 1069.9731s
	iters: 200, epoch: 33 | loss: 0.0082681
	speed: 0.0255s/iter; left time: 386.6213s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.37s
Steps: 226 | Train Loss: 0.0090772 Vali Loss: 0.0089731 Test Loss: 0.0099125
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0079741
	speed: 0.0814s/iter; left time: 1224.5307s
	iters: 200, epoch: 34 | loss: 0.0097403
	speed: 0.0221s/iter; left time: 330.0705s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.29s
Steps: 226 | Train Loss: 0.0090595 Vali Loss: 0.0089322 Test Loss: 0.0098990
Validation loss decreased (0.008933 --> 0.008932).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0085803
	speed: 0.0440s/iter; left time: 651.3799s
	iters: 200, epoch: 35 | loss: 0.0098124
	speed: 0.0167s/iter; left time: 246.1038s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0090542 Vali Loss: 0.0089748 Test Loss: 0.0099321
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0090371
	speed: 0.0579s/iter; left time: 844.3759s
	iters: 200, epoch: 36 | loss: 0.0094171
	speed: 0.0291s/iter; left time: 421.8049s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.60s
Steps: 226 | Train Loss: 0.0090484 Vali Loss: 0.0089509 Test Loss: 0.0099013
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0090749
	speed: 0.0663s/iter; left time: 952.4311s
	iters: 200, epoch: 37 | loss: 0.0093885
	speed: 0.0299s/iter; left time: 426.1332s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.01s
Steps: 226 | Train Loss: 0.0090552 Vali Loss: 0.0089714 Test Loss: 0.0099124
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0082394
	speed: 0.0646s/iter; left time: 913.2864s
	iters: 200, epoch: 38 | loss: 0.0093596
	speed: 0.0284s/iter; left time: 398.0774s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.40s
Steps: 226 | Train Loss: 0.0090332 Vali Loss: 0.0089565 Test Loss: 0.0099143
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0078252
	speed: 0.0658s/iter; left time: 915.5177s
	iters: 200, epoch: 39 | loss: 0.0088208
	speed: 0.0284s/iter; left time: 391.9578s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.34s
Steps: 226 | Train Loss: 0.0090471 Vali Loss: 0.0089371 Test Loss: 0.0099035
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0105462
	speed: 0.0692s/iter; left time: 946.7984s
	iters: 200, epoch: 40 | loss: 0.0090573
	speed: 0.0267s/iter; left time: 362.6619s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.60s
Steps: 226 | Train Loss: 0.0090234 Vali Loss: 0.0089457 Test Loss: 0.0099033
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0088055
	speed: 0.0689s/iter; left time: 927.3560s
	iters: 200, epoch: 41 | loss: 0.0104520
	speed: 0.0307s/iter; left time: 409.8555s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.36s
Steps: 226 | Train Loss: 0.0090427 Vali Loss: 0.0089316 Test Loss: 0.0098993
Validation loss decreased (0.008932 --> 0.008932).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0084742
	speed: 0.0626s/iter; left time: 828.2486s
	iters: 200, epoch: 42 | loss: 0.0093432
	speed: 0.0293s/iter; left time: 384.9107s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.92s
Steps: 226 | Train Loss: 0.0090335 Vali Loss: 0.0089267 Test Loss: 0.0098911
Validation loss decreased (0.008932 --> 0.008927).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0097170
	speed: 0.0640s/iter; left time: 832.3867s
	iters: 200, epoch: 43 | loss: 0.0076540
	speed: 0.0258s/iter; left time: 333.0699s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.24s
Steps: 226 | Train Loss: 0.0090321 Vali Loss: 0.0089353 Test Loss: 0.0099073
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0092617
	speed: 0.0661s/iter; left time: 844.9406s
	iters: 200, epoch: 44 | loss: 0.0087024
	speed: 0.0270s/iter; left time: 342.2599s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.33s
Steps: 226 | Train Loss: 0.0090337 Vali Loss: 0.0089408 Test Loss: 0.0098926
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0088285
	speed: 0.0683s/iter; left time: 857.2198s
	iters: 200, epoch: 45 | loss: 0.0092159
	speed: 0.0281s/iter; left time: 350.5602s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.61s
Steps: 226 | Train Loss: 0.0090323 Vali Loss: 0.0089285 Test Loss: 0.0098980
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0102098
	speed: 0.0723s/iter; left time: 892.0211s
	iters: 200, epoch: 46 | loss: 0.0079350
	speed: 0.0298s/iter; left time: 364.2793s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.33s
Steps: 226 | Train Loss: 0.0090227 Vali Loss: 0.0089318 Test Loss: 0.0099059
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0093856
	speed: 0.0618s/iter; left time: 747.8551s
	iters: 200, epoch: 47 | loss: 0.0095248
	speed: 0.0301s/iter; left time: 361.3959s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.60s
Steps: 226 | Train Loss: 0.0090159 Vali Loss: 0.0089450 Test Loss: 0.0099015
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0090503
	speed: 0.0618s/iter; left time: 733.6224s
	iters: 200, epoch: 48 | loss: 0.0091753
	speed: 0.0255s/iter; left time: 300.4921s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0090108 Vali Loss: 0.0089341 Test Loss: 0.0098960
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0083525
	speed: 0.0668s/iter; left time: 778.0072s
	iters: 200, epoch: 49 | loss: 0.0098274
	speed: 0.0252s/iter; left time: 290.9835s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.21s
Steps: 226 | Train Loss: 0.0090235 Vali Loss: 0.0089498 Test Loss: 0.0099027
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0091457
	speed: 0.0693s/iter; left time: 792.4603s
	iters: 200, epoch: 50 | loss: 0.0105588
	speed: 0.0300s/iter; left time: 339.4670s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.11s
Steps: 226 | Train Loss: 0.0090247 Vali Loss: 0.0089380 Test Loss: 0.0098937
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0099731
	speed: 0.0644s/iter; left time: 721.2085s
	iters: 200, epoch: 51 | loss: 0.0085722
	speed: 0.0298s/iter; left time: 331.1560s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.62s
Steps: 226 | Train Loss: 0.0090074 Vali Loss: 0.0089378 Test Loss: 0.0098993
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0085397
	speed: 0.0627s/iter; left time: 688.5853s
	iters: 200, epoch: 52 | loss: 0.0099546
	speed: 0.0294s/iter; left time: 319.2593s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.70s
Steps: 226 | Train Loss: 0.0090018 Vali Loss: 0.0089331 Test Loss: 0.0099019
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009891098365187645, rmse:0.09945400059223175, mae:0.05819772183895111, rse:0.3757877051830292
Intermediate time for IT and pred_len 24: 00h:08m:58.20s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0462537
	speed: 0.0689s/iter; left time: 1543.6157s
	iters: 200, epoch: 1 | loss: 0.0364715
	speed: 0.0280s/iter; left time: 625.0756s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.98s
Steps: 225 | Train Loss: 0.0460628 Vali Loss: 0.0273578 Test Loss: 0.0298426
Validation loss decreased (inf --> 0.027358).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0235899
	speed: 0.0676s/iter; left time: 1498.9230s
	iters: 200, epoch: 2 | loss: 0.0210041
	speed: 0.0362s/iter; left time: 798.1010s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.66s
Steps: 225 | Train Loss: 0.0232539 Vali Loss: 0.0176938 Test Loss: 0.0193522
Validation loss decreased (0.027358 --> 0.017694).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0189749
	speed: 0.0678s/iter; left time: 1488.1416s
	iters: 200, epoch: 3 | loss: 0.0182328
	speed: 0.0338s/iter; left time: 738.0705s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.32s
Steps: 225 | Train Loss: 0.0193855 Vali Loss: 0.0168231 Test Loss: 0.0184362
Validation loss decreased (0.017694 --> 0.016823).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0177972
	speed: 0.0729s/iter; left time: 1583.3243s
	iters: 200, epoch: 4 | loss: 0.0183742
	speed: 0.0332s/iter; left time: 718.3900s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.72s
Steps: 225 | Train Loss: 0.0185190 Vali Loss: 0.0164864 Test Loss: 0.0181530
Validation loss decreased (0.016823 --> 0.016486).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0168590
	speed: 0.0798s/iter; left time: 1714.9373s
	iters: 200, epoch: 5 | loss: 0.0164473
	speed: 0.0296s/iter; left time: 633.0589s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.50s
Steps: 225 | Train Loss: 0.0180803 Vali Loss: 0.0164282 Test Loss: 0.0180659
Validation loss decreased (0.016486 --> 0.016428).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0169709
	speed: 0.0739s/iter; left time: 1572.3145s
	iters: 200, epoch: 6 | loss: 0.0191333
	speed: 0.0322s/iter; left time: 682.7761s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.44s
Steps: 225 | Train Loss: 0.0177726 Vali Loss: 0.0161812 Test Loss: 0.0177180
Validation loss decreased (0.016428 --> 0.016181).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0158284
	speed: 0.0733s/iter; left time: 1542.2157s
	iters: 200, epoch: 7 | loss: 0.0175322
	speed: 0.0319s/iter; left time: 668.7348s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.48s
Steps: 225 | Train Loss: 0.0175136 Vali Loss: 0.0161265 Test Loss: 0.0176915
Validation loss decreased (0.016181 --> 0.016126).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0174552
	speed: 0.0818s/iter; left time: 1702.6980s
	iters: 200, epoch: 8 | loss: 0.0166485
	speed: 0.0306s/iter; left time: 635.0506s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.18s
Steps: 225 | Train Loss: 0.0173040 Vali Loss: 0.0160004 Test Loss: 0.0174142
Validation loss decreased (0.016126 --> 0.016000).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0163455
	speed: 0.0799s/iter; left time: 1646.4733s
	iters: 200, epoch: 9 | loss: 0.0154967
	speed: 0.0335s/iter; left time: 686.6061s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.01s
Steps: 225 | Train Loss: 0.0171474 Vali Loss: 0.0159577 Test Loss: 0.0173985
Validation loss decreased (0.016000 --> 0.015958).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0160120
	speed: 0.0664s/iter; left time: 1353.1241s
	iters: 200, epoch: 10 | loss: 0.0178833
	speed: 0.0409s/iter; left time: 829.5337s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.39s
Steps: 225 | Train Loss: 0.0170059 Vali Loss: 0.0159840 Test Loss: 0.0174097
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0159951
	speed: 0.0929s/iter; left time: 1871.6360s
	iters: 200, epoch: 11 | loss: 0.0157917
	speed: 0.0429s/iter; left time: 860.3901s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.43s
Steps: 225 | Train Loss: 0.0169099 Vali Loss: 0.0159336 Test Loss: 0.0172732
Validation loss decreased (0.015958 --> 0.015934).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0165329
	speed: 0.0664s/iter; left time: 1323.1145s
	iters: 200, epoch: 12 | loss: 0.0170412
	speed: 0.0182s/iter; left time: 360.5674s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0167639 Vali Loss: 0.0159042 Test Loss: 0.0173147
Validation loss decreased (0.015934 --> 0.015904).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0180271
	speed: 0.0814s/iter; left time: 1603.0954s
	iters: 200, epoch: 13 | loss: 0.0178022
	speed: 0.0400s/iter; left time: 783.6891s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.96s
Steps: 225 | Train Loss: 0.0166703 Vali Loss: 0.0158887 Test Loss: 0.0171973
Validation loss decreased (0.015904 --> 0.015889).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0176169
	speed: 0.1266s/iter; left time: 2465.5381s
	iters: 200, epoch: 14 | loss: 0.0166390
	speed: 0.0494s/iter; left time: 956.5359s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.86s
Steps: 225 | Train Loss: 0.0165915 Vali Loss: 0.0158640 Test Loss: 0.0172642
Validation loss decreased (0.015889 --> 0.015864).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0162922
	speed: 0.1073s/iter; left time: 2065.5748s
	iters: 200, epoch: 15 | loss: 0.0161882
	speed: 0.0380s/iter; left time: 727.0989s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.32s
Steps: 225 | Train Loss: 0.0165111 Vali Loss: 0.0159664 Test Loss: 0.0174457
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0164338
	speed: 0.0877s/iter; left time: 1668.2082s
	iters: 200, epoch: 16 | loss: 0.0168174
	speed: 0.0504s/iter; left time: 954.1934s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.16s
Steps: 225 | Train Loss: 0.0164226 Vali Loss: 0.0158663 Test Loss: 0.0172530
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0158943
	speed: 0.1024s/iter; left time: 1924.4480s
	iters: 200, epoch: 17 | loss: 0.0164825
	speed: 0.0454s/iter; left time: 849.4878s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.34s
Steps: 225 | Train Loss: 0.0163565 Vali Loss: 0.0159070 Test Loss: 0.0174244
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0174788
	speed: 0.0993s/iter; left time: 1844.1894s
	iters: 200, epoch: 18 | loss: 0.0145421
	speed: 0.0266s/iter; left time: 490.7336s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.04s
Steps: 225 | Train Loss: 0.0162801 Vali Loss: 0.0158426 Test Loss: 0.0172457
Validation loss decreased (0.015864 --> 0.015843).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0168303
	speed: 0.0720s/iter; left time: 1320.7256s
	iters: 200, epoch: 19 | loss: 0.0163630
	speed: 0.0431s/iter; left time: 785.8042s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.40s
Steps: 225 | Train Loss: 0.0162624 Vali Loss: 0.0157878 Test Loss: 0.0171725
Validation loss decreased (0.015843 --> 0.015788).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0152932
	speed: 0.1118s/iter; left time: 2026.0311s
	iters: 200, epoch: 20 | loss: 0.0158245
	speed: 0.0545s/iter; left time: 983.3168s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:12.25s
Steps: 225 | Train Loss: 0.0161951 Vali Loss: 0.0158540 Test Loss: 0.0172939
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0160206
	speed: 0.0957s/iter; left time: 1713.6502s
	iters: 200, epoch: 21 | loss: 0.0143377
	speed: 0.0489s/iter; left time: 870.4033s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.50s
Steps: 225 | Train Loss: 0.0161581 Vali Loss: 0.0158551 Test Loss: 0.0173828
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0173990
	speed: 0.1255s/iter; left time: 2218.2540s
	iters: 200, epoch: 22 | loss: 0.0164247
	speed: 0.0570s/iter; left time: 1002.0298s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:12.20s
Steps: 225 | Train Loss: 0.0161385 Vali Loss: 0.0158426 Test Loss: 0.0173311
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0165023
	speed: 0.1310s/iter; left time: 2286.8177s
	iters: 200, epoch: 23 | loss: 0.0158310
	speed: 0.0618s/iter; left time: 1071.5133s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:13.71s
Steps: 225 | Train Loss: 0.0160991 Vali Loss: 0.0158318 Test Loss: 0.0172664
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0162533
	speed: 0.1002s/iter; left time: 1726.0865s
	iters: 200, epoch: 24 | loss: 0.0154683
	speed: 0.0392s/iter; left time: 671.9594s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.55s
Steps: 225 | Train Loss: 0.0160415 Vali Loss: 0.0158316 Test Loss: 0.0173423
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0155253
	speed: 0.1592s/iter; left time: 2705.8815s
	iters: 200, epoch: 25 | loss: 0.0173770
	speed: 0.0411s/iter; left time: 694.2856s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.41s
Steps: 225 | Train Loss: 0.0160281 Vali Loss: 0.0158332 Test Loss: 0.0173701
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0182681
	speed: 0.1172s/iter; left time: 1966.5665s
	iters: 200, epoch: 26 | loss: 0.0169437
	speed: 0.0589s/iter; left time: 981.8063s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:13.76s
Steps: 225 | Train Loss: 0.0159760 Vali Loss: 0.0158007 Test Loss: 0.0172860
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0168032
	speed: 0.1253s/iter; left time: 2073.1897s
	iters: 200, epoch: 27 | loss: 0.0156003
	speed: 0.0590s/iter; left time: 970.2114s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:12.08s
Steps: 225 | Train Loss: 0.0159695 Vali Loss: 0.0158024 Test Loss: 0.0172899
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0167254
	speed: 0.1086s/iter; left time: 1772.7258s
	iters: 200, epoch: 28 | loss: 0.0156412
	speed: 0.0438s/iter; left time: 711.4205s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.18s
Steps: 225 | Train Loss: 0.0159519 Vali Loss: 0.0158223 Test Loss: 0.0174044
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0168503
	speed: 0.1492s/iter; left time: 2402.5702s
	iters: 200, epoch: 29 | loss: 0.0137340
	speed: 0.0462s/iter; left time: 739.4509s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.80s
Steps: 225 | Train Loss: 0.0159480 Vali Loss: 0.0157722 Test Loss: 0.0172937
Validation loss decreased (0.015788 --> 0.015772).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0163661
	speed: 0.1377s/iter; left time: 2186.5077s
	iters: 200, epoch: 30 | loss: 0.0171112
	speed: 0.0534s/iter; left time: 843.0461s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:12.46s
Steps: 225 | Train Loss: 0.0159193 Vali Loss: 0.0157847 Test Loss: 0.0173282
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0153719
	speed: 0.1280s/iter; left time: 2004.0865s
	iters: 200, epoch: 31 | loss: 0.0155335
	speed: 0.0505s/iter; left time: 785.3466s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.18s
Steps: 225 | Train Loss: 0.0159121 Vali Loss: 0.0157999 Test Loss: 0.0173632
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0156373
	speed: 0.1244s/iter; left time: 1918.2645s
	iters: 200, epoch: 32 | loss: 0.0162509
	speed: 0.0240s/iter; left time: 368.1725s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0158688 Vali Loss: 0.0157687 Test Loss: 0.0172948
Validation loss decreased (0.015772 --> 0.015769).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0183278
	speed: 0.0458s/iter; left time: 696.4836s
	iters: 200, epoch: 33 | loss: 0.0169869
	speed: 0.0160s/iter; left time: 242.0783s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.0158634 Vali Loss: 0.0157925 Test Loss: 0.0173219
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0172865
	speed: 0.0626s/iter; left time: 937.2979s
	iters: 200, epoch: 34 | loss: 0.0153092
	speed: 0.0428s/iter; left time: 636.7960s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.66s
Steps: 225 | Train Loss: 0.0158540 Vali Loss: 0.0158062 Test Loss: 0.0173842
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0161870
	speed: 0.1479s/iter; left time: 2182.1716s
	iters: 200, epoch: 35 | loss: 0.0151124
	speed: 0.0352s/iter; left time: 515.5297s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.73s
Steps: 225 | Train Loss: 0.0158580 Vali Loss: 0.0157895 Test Loss: 0.0173378
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0166946
	speed: 0.0992s/iter; left time: 1440.3194s
	iters: 200, epoch: 36 | loss: 0.0162752
	speed: 0.0550s/iter; left time: 793.6798s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:12.02s
Steps: 225 | Train Loss: 0.0158467 Vali Loss: 0.0157970 Test Loss: 0.0173953
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0172352
	speed: 0.1000s/iter; left time: 1429.5845s
	iters: 200, epoch: 37 | loss: 0.0143222
	speed: 0.0514s/iter; left time: 730.6271s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:10.01s
Steps: 225 | Train Loss: 0.0158265 Vali Loss: 0.0157891 Test Loss: 0.0173757
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0172777
	speed: 0.1148s/iter; left time: 1615.3501s
	iters: 200, epoch: 38 | loss: 0.0145041
	speed: 0.0608s/iter; left time: 850.3474s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:13.65s
Steps: 225 | Train Loss: 0.0158066 Vali Loss: 0.0157820 Test Loss: 0.0173516
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0138649
	speed: 0.1076s/iter; left time: 1489.7403s
	iters: 200, epoch: 39 | loss: 0.0156466
	speed: 0.0451s/iter; left time: 619.9543s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.55s
Steps: 225 | Train Loss: 0.0158153 Vali Loss: 0.0158029 Test Loss: 0.0173771
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0144005
	speed: 0.1295s/iter; left time: 1765.1740s
	iters: 200, epoch: 40 | loss: 0.0168604
	speed: 0.0376s/iter; left time: 508.2581s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.72s
Steps: 225 | Train Loss: 0.0158220 Vali Loss: 0.0157745 Test Loss: 0.0173589
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0143205
	speed: 0.1196s/iter; left time: 1602.9526s
	iters: 200, epoch: 41 | loss: 0.0147199
	speed: 0.0420s/iter; left time: 558.0596s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:11.58s
Steps: 225 | Train Loss: 0.0158101 Vali Loss: 0.0157864 Test Loss: 0.0173573
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0171100
	speed: 0.1009s/iter; left time: 1328.8184s
	iters: 200, epoch: 42 | loss: 0.0152776
	speed: 0.0591s/iter; left time: 773.2677s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:12.83s
Steps: 225 | Train Loss: 0.0158103 Vali Loss: 0.0158030 Test Loss: 0.0174064
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01729476824402809, rmse:0.13150957226753235, mae:0.07975035905838013, rse:0.49725186824798584
Intermediate time for IT and pred_len 96: 00h:10m:15.34s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0470817
	speed: 0.0776s/iter; left time: 1739.1330s
	iters: 200, epoch: 1 | loss: 0.0334309
	speed: 0.0264s/iter; left time: 589.4221s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.77s
Steps: 225 | Train Loss: 0.0477718 Vali Loss: 0.0284479 Test Loss: 0.0308728
Validation loss decreased (inf --> 0.028448).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0239116
	speed: 0.0542s/iter; left time: 1201.2453s
	iters: 200, epoch: 2 | loss: 0.0233685
	speed: 0.0288s/iter; left time: 636.7362s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.85s
Steps: 225 | Train Loss: 0.0249409 Vali Loss: 0.0192272 Test Loss: 0.0207638
Validation loss decreased (0.028448 --> 0.019227).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0201211
	speed: 0.0849s/iter; left time: 1863.3549s
	iters: 200, epoch: 3 | loss: 0.0224873
	speed: 0.0449s/iter; left time: 981.2784s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.92s
Steps: 225 | Train Loss: 0.0209690 Vali Loss: 0.0184162 Test Loss: 0.0194297
Validation loss decreased (0.019227 --> 0.018416).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0236589
	speed: 0.0881s/iter; left time: 1914.0939s
	iters: 200, epoch: 4 | loss: 0.0205874
	speed: 0.0464s/iter; left time: 1003.2668s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.03s
Steps: 225 | Train Loss: 0.0201329 Vali Loss: 0.0180921 Test Loss: 0.0192037
Validation loss decreased (0.018416 --> 0.018092).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0182775
	speed: 0.0935s/iter; left time: 2010.1367s
	iters: 200, epoch: 5 | loss: 0.0187295
	speed: 0.0447s/iter; left time: 957.0799s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.19s
Steps: 225 | Train Loss: 0.0197307 Vali Loss: 0.0178989 Test Loss: 0.0190696
Validation loss decreased (0.018092 --> 0.017899).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0189552
	speed: 0.0739s/iter; left time: 1571.8617s
	iters: 200, epoch: 6 | loss: 0.0199359
	speed: 0.0454s/iter; left time: 960.3956s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.44s
Steps: 225 | Train Loss: 0.0194634 Vali Loss: 0.0177294 Test Loss: 0.0189508
Validation loss decreased (0.017899 --> 0.017729).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0199815
	speed: 0.1056s/iter; left time: 2222.1892s
	iters: 200, epoch: 7 | loss: 0.0189001
	speed: 0.0324s/iter; left time: 679.7654s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.83s
Steps: 225 | Train Loss: 0.0192553 Vali Loss: 0.0177561 Test Loss: 0.0189389
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0165607
	speed: 0.1290s/iter; left time: 2685.6895s
	iters: 200, epoch: 8 | loss: 0.0194142
	speed: 0.0294s/iter; left time: 608.4771s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.23s
Steps: 225 | Train Loss: 0.0190906 Vali Loss: 0.0176011 Test Loss: 0.0187670
Validation loss decreased (0.017729 --> 0.017601).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0192651
	speed: 0.0936s/iter; left time: 1928.7353s
	iters: 200, epoch: 9 | loss: 0.0187292
	speed: 0.0274s/iter; left time: 560.8369s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.40s
Steps: 225 | Train Loss: 0.0189444 Vali Loss: 0.0175180 Test Loss: 0.0188351
Validation loss decreased (0.017601 --> 0.017518).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0185771
	speed: 0.0422s/iter; left time: 859.4170s
	iters: 200, epoch: 10 | loss: 0.0195553
	speed: 0.0207s/iter; left time: 418.9505s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.0188059 Vali Loss: 0.0176197 Test Loss: 0.0188907
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0188781
	speed: 0.0523s/iter; left time: 1054.8610s
	iters: 200, epoch: 11 | loss: 0.0185935
	speed: 0.0335s/iter; left time: 672.2974s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.36s
Steps: 225 | Train Loss: 0.0187199 Vali Loss: 0.0175749 Test Loss: 0.0188651
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0184689
	speed: 0.0752s/iter; left time: 1497.4903s
	iters: 200, epoch: 12 | loss: 0.0183612
	speed: 0.0443s/iter; left time: 878.7240s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.83s
Steps: 225 | Train Loss: 0.0186157 Vali Loss: 0.0175330 Test Loss: 0.0188398
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0175366
	speed: 0.0779s/iter; left time: 1533.9832s
	iters: 200, epoch: 13 | loss: 0.0188624
	speed: 0.0327s/iter; left time: 640.1132s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.95s
Steps: 225 | Train Loss: 0.0185028 Vali Loss: 0.0174663 Test Loss: 0.0187327
Validation loss decreased (0.017518 --> 0.017466).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0175015
	speed: 0.1002s/iter; left time: 1951.3282s
	iters: 200, epoch: 14 | loss: 0.0188210
	speed: 0.0325s/iter; left time: 629.0999s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.01s
Steps: 225 | Train Loss: 0.0184339 Vali Loss: 0.0175618 Test Loss: 0.0188765
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0180571
	speed: 0.0714s/iter; left time: 1375.3754s
	iters: 200, epoch: 15 | loss: 0.0174339
	speed: 0.0338s/iter; left time: 648.0443s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.55s
Steps: 225 | Train Loss: 0.0183563 Vali Loss: 0.0175691 Test Loss: 0.0188944
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0190036
	speed: 0.1002s/iter; left time: 1905.9641s
	iters: 200, epoch: 16 | loss: 0.0194198
	speed: 0.0333s/iter; left time: 630.2952s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.22s
Steps: 225 | Train Loss: 0.0182919 Vali Loss: 0.0174588 Test Loss: 0.0187264
Validation loss decreased (0.017466 --> 0.017459).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0162348
	speed: 0.0945s/iter; left time: 1777.4391s
	iters: 200, epoch: 17 | loss: 0.0178654
	speed: 0.0395s/iter; left time: 738.7342s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.35s
Steps: 225 | Train Loss: 0.0182279 Vali Loss: 0.0174852 Test Loss: 0.0188695
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0169097
	speed: 0.0727s/iter; left time: 1349.8465s
	iters: 200, epoch: 18 | loss: 0.0179845
	speed: 0.0362s/iter; left time: 669.0736s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.89s
Steps: 225 | Train Loss: 0.0181624 Vali Loss: 0.0174539 Test Loss: 0.0188264
Validation loss decreased (0.017459 --> 0.017454).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0169253
	speed: 0.0989s/iter; left time: 1815.3184s
	iters: 200, epoch: 19 | loss: 0.0200264
	speed: 0.0326s/iter; left time: 594.0972s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.26s
Steps: 225 | Train Loss: 0.0181152 Vali Loss: 0.0174486 Test Loss: 0.0187742
Validation loss decreased (0.017454 --> 0.017449).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0178235
	speed: 0.0966s/iter; left time: 1751.5849s
	iters: 200, epoch: 20 | loss: 0.0182496
	speed: 0.0385s/iter; left time: 694.1309s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.74s
Steps: 225 | Train Loss: 0.0180658 Vali Loss: 0.0174563 Test Loss: 0.0187698
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0182403
	speed: 0.0792s/iter; left time: 1416.8968s
	iters: 200, epoch: 21 | loss: 0.0182276
	speed: 0.0449s/iter; left time: 799.1169s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.93s
Steps: 225 | Train Loss: 0.0180051 Vali Loss: 0.0174450 Test Loss: 0.0188208
Validation loss decreased (0.017449 --> 0.017445).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0177208
	speed: 0.0821s/iter; left time: 1451.4964s
	iters: 200, epoch: 22 | loss: 0.0181698
	speed: 0.0391s/iter; left time: 686.5119s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.93s
Steps: 225 | Train Loss: 0.0179754 Vali Loss: 0.0174402 Test Loss: 0.0188235
Validation loss decreased (0.017445 --> 0.017440).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0174111
	speed: 0.1194s/iter; left time: 2083.9236s
	iters: 200, epoch: 23 | loss: 0.0177269
	speed: 0.0354s/iter; left time: 614.0233s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.74s
Steps: 225 | Train Loss: 0.0179590 Vali Loss: 0.0174663 Test Loss: 0.0188353
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0175101
	speed: 0.0957s/iter; left time: 1647.6924s
	iters: 200, epoch: 24 | loss: 0.0178409
	speed: 0.0388s/iter; left time: 665.2474s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.20s
Steps: 225 | Train Loss: 0.0179136 Vali Loss: 0.0174419 Test Loss: 0.0188890
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0191682
	speed: 0.0868s/iter; left time: 1475.4563s
	iters: 200, epoch: 25 | loss: 0.0188505
	speed: 0.0479s/iter; left time: 808.8288s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.00s
Steps: 225 | Train Loss: 0.0178740 Vali Loss: 0.0174738 Test Loss: 0.0188258
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0170615
	speed: 0.0955s/iter; left time: 1602.4787s
	iters: 200, epoch: 26 | loss: 0.0181179
	speed: 0.0327s/iter; left time: 544.6765s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.64s
Steps: 225 | Train Loss: 0.0178429 Vali Loss: 0.0174697 Test Loss: 0.0188988
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0179335
	speed: 0.1142s/iter; left time: 1890.3786s
	iters: 200, epoch: 27 | loss: 0.0182124
	speed: 0.0369s/iter; left time: 607.0715s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.58s
Steps: 225 | Train Loss: 0.0178122 Vali Loss: 0.0174661 Test Loss: 0.0188872
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0199118
	speed: 0.0933s/iter; left time: 1523.8650s
	iters: 200, epoch: 28 | loss: 0.0184817
	speed: 0.0355s/iter; left time: 576.1225s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.28s
Steps: 225 | Train Loss: 0.0177697 Vali Loss: 0.0174359 Test Loss: 0.0188458
Validation loss decreased (0.017440 --> 0.017436).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0185850
	speed: 0.0471s/iter; left time: 758.2170s
	iters: 200, epoch: 29 | loss: 0.0159490
	speed: 0.0194s/iter; left time: 309.7327s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0177890 Vali Loss: 0.0174572 Test Loss: 0.0188938
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0190641
	speed: 0.0504s/iter; left time: 800.5204s
	iters: 200, epoch: 30 | loss: 0.0184726
	speed: 0.0402s/iter; left time: 633.5199s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.74s
Steps: 225 | Train Loss: 0.0177593 Vali Loss: 0.0174437 Test Loss: 0.0188625
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0178892
	speed: 0.0846s/iter; left time: 1324.2394s
	iters: 200, epoch: 31 | loss: 0.0159046
	speed: 0.0338s/iter; left time: 525.3135s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.30s
Steps: 225 | Train Loss: 0.0177573 Vali Loss: 0.0174455 Test Loss: 0.0188721
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0162854
	speed: 0.0765s/iter; left time: 1180.2324s
	iters: 200, epoch: 32 | loss: 0.0192957
	speed: 0.0369s/iter; left time: 565.7178s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.38s
Steps: 225 | Train Loss: 0.0177434 Vali Loss: 0.0174310 Test Loss: 0.0188878
Validation loss decreased (0.017436 --> 0.017431).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0186600
	speed: 0.0809s/iter; left time: 1230.3704s
	iters: 200, epoch: 33 | loss: 0.0190157
	speed: 0.0298s/iter; left time: 449.8309s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.73s
Steps: 225 | Train Loss: 0.0177179 Vali Loss: 0.0174451 Test Loss: 0.0188824
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0177958
	speed: 0.0857s/iter; left time: 1284.1060s
	iters: 200, epoch: 34 | loss: 0.0167717
	speed: 0.0323s/iter; left time: 480.9991s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.15s
Steps: 225 | Train Loss: 0.0177123 Vali Loss: 0.0174233 Test Loss: 0.0188737
Validation loss decreased (0.017431 --> 0.017423).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0172185
	speed: 0.0882s/iter; left time: 1301.2977s
	iters: 200, epoch: 35 | loss: 0.0184308
	speed: 0.0374s/iter; left time: 547.2242s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.38s
Steps: 225 | Train Loss: 0.0176920 Vali Loss: 0.0174605 Test Loss: 0.0188986
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0180091
	speed: 0.0877s/iter; left time: 1273.2713s
	iters: 200, epoch: 36 | loss: 0.0181451
	speed: 0.0382s/iter; left time: 550.5720s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.85s
Steps: 225 | Train Loss: 0.0176895 Vali Loss: 0.0174417 Test Loss: 0.0189240
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0197505
	speed: 0.0734s/iter; left time: 1050.0201s
	iters: 200, epoch: 37 | loss: 0.0171026
	speed: 0.0372s/iter; left time: 528.1712s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.34s
Steps: 225 | Train Loss: 0.0176750 Vali Loss: 0.0174587 Test Loss: 0.0189393
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0182414
	speed: 0.0830s/iter; left time: 1168.1594s
	iters: 200, epoch: 38 | loss: 0.0174553
	speed: 0.0418s/iter; left time: 583.7188s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.44s
Steps: 225 | Train Loss: 0.0176732 Vali Loss: 0.0174202 Test Loss: 0.0189041
Validation loss decreased (0.017423 --> 0.017420).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0179154
	speed: 0.0932s/iter; left time: 1291.4824s
	iters: 200, epoch: 39 | loss: 0.0177326
	speed: 0.0364s/iter; left time: 500.9927s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.01s
Steps: 225 | Train Loss: 0.0176698 Vali Loss: 0.0174568 Test Loss: 0.0188915
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0167302
	speed: 0.0873s/iter; left time: 1189.7488s
	iters: 200, epoch: 40 | loss: 0.0172194
	speed: 0.0368s/iter; left time: 497.1109s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.69s
Steps: 225 | Train Loss: 0.0176391 Vali Loss: 0.0174383 Test Loss: 0.0188776
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0164773
	speed: 0.0867s/iter; left time: 1161.2019s
	iters: 200, epoch: 41 | loss: 0.0188107
	speed: 0.0380s/iter; left time: 506.1030s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.04s
Steps: 225 | Train Loss: 0.0176388 Vali Loss: 0.0174470 Test Loss: 0.0188990
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0169925
	speed: 0.0812s/iter; left time: 1069.6559s
	iters: 200, epoch: 42 | loss: 0.0179315
	speed: 0.0341s/iter; left time: 445.3259s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:08.30s
Steps: 225 | Train Loss: 0.0176362 Vali Loss: 0.0174358 Test Loss: 0.0189112
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0172228
	speed: 0.0771s/iter; left time: 998.7934s
	iters: 200, epoch: 43 | loss: 0.0194211
	speed: 0.0424s/iter; left time: 544.3037s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.66s
Steps: 225 | Train Loss: 0.0176347 Vali Loss: 0.0174557 Test Loss: 0.0189262
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0177851
	speed: 0.0768s/iter; left time: 977.8385s
	iters: 200, epoch: 44 | loss: 0.0175024
	speed: 0.0395s/iter; left time: 498.2766s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.14s
Steps: 225 | Train Loss: 0.0176328 Vali Loss: 0.0174426 Test Loss: 0.0189024
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0169976
	speed: 0.0783s/iter; left time: 979.4436s
	iters: 200, epoch: 45 | loss: 0.0195613
	speed: 0.0383s/iter; left time: 475.1258s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.68s
Steps: 225 | Train Loss: 0.0176215 Vali Loss: 0.0174558 Test Loss: 0.0189192
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0171266
	speed: 0.0895s/iter; left time: 1099.2866s
	iters: 200, epoch: 46 | loss: 0.0168313
	speed: 0.0383s/iter; left time: 466.0661s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.63s
Steps: 225 | Train Loss: 0.0176224 Vali Loss: 0.0174636 Test Loss: 0.0189049
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0155394
	speed: 0.0776s/iter; left time: 934.7370s
	iters: 200, epoch: 47 | loss: 0.0177897
	speed: 0.0368s/iter; left time: 439.8636s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.84s
Steps: 225 | Train Loss: 0.0176342 Vali Loss: 0.0174581 Test Loss: 0.0189175
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0182304
	speed: 0.0784s/iter; left time: 926.6719s
	iters: 200, epoch: 48 | loss: 0.0158067
	speed: 0.0322s/iter; left time: 377.2727s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.45s
Steps: 225 | Train Loss: 0.0176249 Vali Loss: 0.0174510 Test Loss: 0.0189265
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.018904151394963264, rmse:0.137492373585701, mae:0.08580073714256287, rse:0.5203565359115601
Intermediate time for IT and pred_len 168: 00h:09m:48.80sIntermediate time for IT: 00h:29m:02.33sTotal time: 01h:39m:31.65s