
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_168_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_168_24_DE_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1494096
	speed: 0.0331s/iter; left time: 744.9698s
	iters: 200, epoch: 1 | loss: 0.1323591
	speed: 0.0147s/iter; left time: 328.7932s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.79s
Steps: 226 | Train Loss: 0.1472841 Vali Loss: 0.1347737 Test Loss: 0.1428933
Validation loss decreased (inf --> 0.134774).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0845640
	speed: 0.0317s/iter; left time: 707.1836s
	iters: 200, epoch: 2 | loss: 0.0840180
	speed: 0.0150s/iter; left time: 332.6300s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.61s
Steps: 226 | Train Loss: 0.0913177 Vali Loss: 0.0952576 Test Loss: 0.0964126
Validation loss decreased (0.134774 --> 0.095258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0810556
	speed: 0.0328s/iter; left time: 722.6901s
	iters: 200, epoch: 3 | loss: 0.0814877
	speed: 0.0148s/iter; left time: 324.3270s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.61s
Steps: 226 | Train Loss: 0.0810284 Vali Loss: 0.0909402 Test Loss: 0.0929232
Validation loss decreased (0.095258 --> 0.090940).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0829395
	speed: 0.0319s/iter; left time: 695.7021s
	iters: 200, epoch: 4 | loss: 0.0787051
	speed: 0.0149s/iter; left time: 323.0115s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.56s
Steps: 226 | Train Loss: 0.0783240 Vali Loss: 0.0893383 Test Loss: 0.0917443
Validation loss decreased (0.090940 --> 0.089338).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0827021
	speed: 0.0338s/iter; left time: 729.2611s
	iters: 200, epoch: 5 | loss: 0.0717351
	speed: 0.0164s/iter; left time: 353.3226s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.0768973 Vali Loss: 0.0892281 Test Loss: 0.0911057
Validation loss decreased (0.089338 --> 0.089228).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0709572
	speed: 0.0362s/iter; left time: 772.7199s
	iters: 200, epoch: 6 | loss: 0.0760926
	speed: 0.0156s/iter; left time: 332.2332s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.93s
Steps: 226 | Train Loss: 0.0759201 Vali Loss: 0.0882277 Test Loss: 0.0904895
Validation loss decreased (0.089228 --> 0.088228).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0784024
	speed: 0.0324s/iter; left time: 684.1842s
	iters: 200, epoch: 7 | loss: 0.0754921
	speed: 0.0147s/iter; left time: 308.7148s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.0752275 Vali Loss: 0.0879289 Test Loss: 0.0902016
Validation loss decreased (0.088228 --> 0.087929).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0699481
	speed: 0.0351s/iter; left time: 734.4453s
	iters: 200, epoch: 8 | loss: 0.0718761
	speed: 0.0194s/iter; left time: 403.5384s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.55s
Steps: 226 | Train Loss: 0.0747946 Vali Loss: 0.0874789 Test Loss: 0.0901015
Validation loss decreased (0.087929 --> 0.087479).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0716389
	speed: 0.0366s/iter; left time: 756.9084s
	iters: 200, epoch: 9 | loss: 0.0681881
	speed: 0.0168s/iter; left time: 346.2655s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0742107 Vali Loss: 0.0872496 Test Loss: 0.0898178
Validation loss decreased (0.087479 --> 0.087250).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0767106
	speed: 0.0373s/iter; left time: 762.6762s
	iters: 200, epoch: 10 | loss: 0.0742374
	speed: 0.0165s/iter; left time: 335.3676s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.20s
Steps: 226 | Train Loss: 0.0739115 Vali Loss: 0.0874932 Test Loss: 0.0897692
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0768209
	speed: 0.0303s/iter; left time: 613.9543s
	iters: 200, epoch: 11 | loss: 0.0725960
	speed: 0.0147s/iter; left time: 296.5618s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.48s
Steps: 226 | Train Loss: 0.0735395 Vali Loss: 0.0871070 Test Loss: 0.0896325
Validation loss decreased (0.087250 --> 0.087107).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0729355
	speed: 0.0305s/iter; left time: 609.9880s
	iters: 200, epoch: 12 | loss: 0.0778641
	speed: 0.0168s/iter; left time: 334.5994s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0733159 Vali Loss: 0.0867546 Test Loss: 0.0893783
Validation loss decreased (0.087107 --> 0.086755).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0724195
	speed: 0.0381s/iter; left time: 754.7910s
	iters: 200, epoch: 13 | loss: 0.0691778
	speed: 0.0212s/iter; left time: 417.5995s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.95s
Steps: 226 | Train Loss: 0.0731571 Vali Loss: 0.0866443 Test Loss: 0.0890993
Validation loss decreased (0.086755 --> 0.086644).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0730425
	speed: 0.0346s/iter; left time: 677.1500s
	iters: 200, epoch: 14 | loss: 0.0773089
	speed: 0.0215s/iter; left time: 417.5668s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.48s
Steps: 226 | Train Loss: 0.0728669 Vali Loss: 0.0865124 Test Loss: 0.0889917
Validation loss decreased (0.086644 --> 0.086512).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0731445
	speed: 0.0332s/iter; left time: 642.2836s
	iters: 200, epoch: 15 | loss: 0.0727954
	speed: 0.0147s/iter; left time: 282.8112s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.48s
Steps: 226 | Train Loss: 0.0726974 Vali Loss: 0.0864326 Test Loss: 0.0889845
Validation loss decreased (0.086512 --> 0.086433).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0736746
	speed: 0.0366s/iter; left time: 698.8203s
	iters: 200, epoch: 16 | loss: 0.0759136
	speed: 0.0147s/iter; left time: 279.5533s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0725172 Vali Loss: 0.0862788 Test Loss: 0.0887207
Validation loss decreased (0.086433 --> 0.086279).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0719921
	speed: 0.0363s/iter; left time: 685.1361s
	iters: 200, epoch: 17 | loss: 0.0726950
	speed: 0.0223s/iter; left time: 418.8842s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0723900 Vali Loss: 0.0861436 Test Loss: 0.0887920
Validation loss decreased (0.086279 --> 0.086144).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0689621
	speed: 0.0343s/iter; left time: 639.8221s
	iters: 200, epoch: 18 | loss: 0.0707179
	speed: 0.0177s/iter; left time: 328.2012s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0722318 Vali Loss: 0.0861794 Test Loss: 0.0886752
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0785493
	speed: 0.0353s/iter; left time: 651.0269s
	iters: 200, epoch: 19 | loss: 0.0726154
	speed: 0.0188s/iter; left time: 343.7562s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.0721604 Vali Loss: 0.0861406 Test Loss: 0.0886920
Validation loss decreased (0.086144 --> 0.086141).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0758487
	speed: 0.0340s/iter; left time: 619.1498s
	iters: 200, epoch: 20 | loss: 0.0768337
	speed: 0.0183s/iter; left time: 330.6882s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.01s
Steps: 226 | Train Loss: 0.0720731 Vali Loss: 0.0858387 Test Loss: 0.0885592
Validation loss decreased (0.086141 --> 0.085839).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0714005
	speed: 0.0359s/iter; left time: 645.3804s
	iters: 200, epoch: 21 | loss: 0.0685546
	speed: 0.0177s/iter; left time: 315.6992s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0719999 Vali Loss: 0.0860083 Test Loss: 0.0886675
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0693834
	speed: 0.0356s/iter; left time: 632.1671s
	iters: 200, epoch: 22 | loss: 0.0721585
	speed: 0.0210s/iter; left time: 370.9165s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.69s
Steps: 226 | Train Loss: 0.0718582 Vali Loss: 0.0861149 Test Loss: 0.0887164
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0723435
	speed: 0.0356s/iter; left time: 623.4974s
	iters: 200, epoch: 23 | loss: 0.0708623
	speed: 0.0192s/iter; left time: 334.7798s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.40s
Steps: 226 | Train Loss: 0.0718138 Vali Loss: 0.0859426 Test Loss: 0.0885447
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0673030
	speed: 0.0337s/iter; left time: 583.4311s
	iters: 200, epoch: 24 | loss: 0.0738681
	speed: 0.0150s/iter; left time: 258.1804s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.69s
Steps: 226 | Train Loss: 0.0717829 Vali Loss: 0.0858032 Test Loss: 0.0884723
Validation loss decreased (0.085839 --> 0.085803).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0704683
	speed: 0.0400s/iter; left time: 683.7744s
	iters: 200, epoch: 25 | loss: 0.0714896
	speed: 0.0186s/iter; left time: 315.2632s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.64s
Steps: 226 | Train Loss: 0.0717126 Vali Loss: 0.0859911 Test Loss: 0.0884950
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0681589
	speed: 0.0359s/iter; left time: 604.9268s
	iters: 200, epoch: 26 | loss: 0.0726249
	speed: 0.0169s/iter; left time: 283.1921s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.0717103 Vali Loss: 0.0859508 Test Loss: 0.0884369
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0782910
	speed: 0.0368s/iter; left time: 611.0635s
	iters: 200, epoch: 27 | loss: 0.0724409
	speed: 0.0184s/iter; left time: 303.9761s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.39s
Steps: 226 | Train Loss: 0.0716138 Vali Loss: 0.0858983 Test Loss: 0.0884526
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0694560
	speed: 0.0310s/iter; left time: 508.5377s
	iters: 200, epoch: 28 | loss: 0.0677827
	speed: 0.0149s/iter; left time: 242.8831s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.76s
Steps: 226 | Train Loss: 0.0715209 Vali Loss: 0.0858228 Test Loss: 0.0884682
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0740452
	speed: 0.0342s/iter; left time: 553.5682s
	iters: 200, epoch: 29 | loss: 0.0732080
	speed: 0.0156s/iter; left time: 250.2284s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.69s
Steps: 226 | Train Loss: 0.0715645 Vali Loss: 0.0857859 Test Loss: 0.0884036
Validation loss decreased (0.085803 --> 0.085786).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0713792
	speed: 0.0326s/iter; left time: 519.2028s
	iters: 200, epoch: 30 | loss: 0.0688472
	speed: 0.0167s/iter; left time: 264.1598s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.0715175 Vali Loss: 0.0857581 Test Loss: 0.0884080
Validation loss decreased (0.085786 --> 0.085758).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0746582
	speed: 0.0346s/iter; left time: 544.3058s
	iters: 200, epoch: 31 | loss: 0.0794997
	speed: 0.0177s/iter; left time: 276.3740s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0715177 Vali Loss: 0.0857334 Test Loss: 0.0884154
Validation loss decreased (0.085758 --> 0.085733).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0719389
	speed: 0.0366s/iter; left time: 567.0978s
	iters: 200, epoch: 32 | loss: 0.0694298
	speed: 0.0176s/iter; left time: 270.8152s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.41s
Steps: 226 | Train Loss: 0.0714295 Vali Loss: 0.0856955 Test Loss: 0.0884091
Validation loss decreased (0.085733 --> 0.085696).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0731141
	speed: 0.0374s/iter; left time: 570.6708s
	iters: 200, epoch: 33 | loss: 0.0715551
	speed: 0.0174s/iter; left time: 263.3843s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0714486 Vali Loss: 0.0857436 Test Loss: 0.0884355
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0685063
	speed: 0.0328s/iter; left time: 492.9971s
	iters: 200, epoch: 34 | loss: 0.0719461
	speed: 0.0161s/iter; left time: 240.6085s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0714117 Vali Loss: 0.0857003 Test Loss: 0.0883715
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0678761
	speed: 0.0316s/iter; left time: 468.1568s
	iters: 200, epoch: 35 | loss: 0.0704411
	speed: 0.0148s/iter; left time: 217.1721s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.0714024 Vali Loss: 0.0857247 Test Loss: 0.0883413
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0765597
	speed: 0.0361s/iter; left time: 527.0034s
	iters: 200, epoch: 36 | loss: 0.0729911
	speed: 0.0206s/iter; left time: 299.1952s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.76s
Steps: 226 | Train Loss: 0.0713982 Vali Loss: 0.0857187 Test Loss: 0.0883920
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0711310
	speed: 0.0373s/iter; left time: 536.0037s
	iters: 200, epoch: 37 | loss: 0.0783857
	speed: 0.0174s/iter; left time: 247.8571s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0713893 Vali Loss: 0.0857170 Test Loss: 0.0883451
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0746590
	speed: 0.0377s/iter; left time: 533.1887s
	iters: 200, epoch: 38 | loss: 0.0706815
	speed: 0.0203s/iter; left time: 284.5018s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.76s
Steps: 226 | Train Loss: 0.0713295 Vali Loss: 0.0857492 Test Loss: 0.0883414
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0762485
	speed: 0.0415s/iter; left time: 578.0144s
	iters: 200, epoch: 39 | loss: 0.0727055
	speed: 0.0211s/iter; left time: 291.1379s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.23s
Steps: 226 | Train Loss: 0.0713518 Vali Loss: 0.0857587 Test Loss: 0.0883479
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0698914
	speed: 0.0356s/iter; left time: 487.4345s
	iters: 200, epoch: 40 | loss: 0.0677442
	speed: 0.0159s/iter; left time: 216.2101s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.89s
Steps: 226 | Train Loss: 0.0713394 Vali Loss: 0.0856901 Test Loss: 0.0883288
Validation loss decreased (0.085696 --> 0.085690).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0728084
	speed: 0.0330s/iter; left time: 444.6270s
	iters: 200, epoch: 41 | loss: 0.0761702
	speed: 0.0179s/iter; left time: 239.0887s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0713025 Vali Loss: 0.0855827 Test Loss: 0.0883383
Validation loss decreased (0.085690 --> 0.085583).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0713209
	speed: 0.0338s/iter; left time: 447.3594s
	iters: 200, epoch: 42 | loss: 0.0679729
	speed: 0.0182s/iter; left time: 238.8916s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.09s
Steps: 226 | Train Loss: 0.0712892 Vali Loss: 0.0856312 Test Loss: 0.0883043
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0712263
	speed: 0.0329s/iter; left time: 427.8249s
	iters: 200, epoch: 43 | loss: 0.0721410
	speed: 0.0149s/iter; left time: 192.3319s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.66s
Steps: 226 | Train Loss: 0.0713039 Vali Loss: 0.0856211 Test Loss: 0.0883403
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0702652
	speed: 0.0383s/iter; left time: 489.9326s
	iters: 200, epoch: 44 | loss: 0.0679031
	speed: 0.0174s/iter; left time: 221.2843s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.46s
Steps: 226 | Train Loss: 0.0712658 Vali Loss: 0.0857103 Test Loss: 0.0883354
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0719044
	speed: 0.0338s/iter; left time: 424.8848s
	iters: 200, epoch: 45 | loss: 0.0728759
	speed: 0.0153s/iter; left time: 190.5951s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0712951 Vali Loss: 0.0857546 Test Loss: 0.0883350
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0705679
	speed: 0.0340s/iter; left time: 419.5287s
	iters: 200, epoch: 46 | loss: 0.0715705
	speed: 0.0180s/iter; left time: 219.6176s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.06s
Steps: 226 | Train Loss: 0.0713185 Vali Loss: 0.0855664 Test Loss: 0.0883432
Validation loss decreased (0.085583 --> 0.085566).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0704627
	speed: 0.0324s/iter; left time: 392.7287s
	iters: 200, epoch: 47 | loss: 0.0729561
	speed: 0.0157s/iter; left time: 189.0318s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0712942 Vali Loss: 0.0856717 Test Loss: 0.0883280
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0682058
	speed: 0.0331s/iter; left time: 392.8261s
	iters: 200, epoch: 48 | loss: 0.0693166
	speed: 0.0148s/iter; left time: 174.7350s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.64s
Steps: 226 | Train Loss: 0.0713058 Vali Loss: 0.0856410 Test Loss: 0.0883086
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0660363
	speed: 0.0330s/iter; left time: 384.3493s
	iters: 200, epoch: 49 | loss: 0.0697123
	speed: 0.0171s/iter; left time: 197.6317s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.06s
Steps: 226 | Train Loss: 0.0712463 Vali Loss: 0.0855903 Test Loss: 0.0883189
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0686551
	speed: 0.0378s/iter; left time: 431.8369s
	iters: 200, epoch: 50 | loss: 0.0664038
	speed: 0.0197s/iter; left time: 222.5976s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.64s
Steps: 226 | Train Loss: 0.0712557 Vali Loss: 0.0855734 Test Loss: 0.0883155
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0744726
	speed: 0.0354s/iter; left time: 397.0690s
	iters: 200, epoch: 51 | loss: 0.0737909
	speed: 0.0161s/iter; left time: 178.3100s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.00s
Steps: 226 | Train Loss: 0.0712689 Vali Loss: 0.0856441 Test Loss: 0.0883205
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0756705
	speed: 0.0318s/iter; left time: 348.8220s
	iters: 200, epoch: 52 | loss: 0.0705133
	speed: 0.0175s/iter; left time: 189.9292s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.89s
Steps: 226 | Train Loss: 0.0712694 Vali Loss: 0.0855412 Test Loss: 0.0883130
Validation loss decreased (0.085566 --> 0.085541).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0720955
	speed: 0.0342s/iter; left time: 367.8885s
	iters: 200, epoch: 53 | loss: 0.0706849
	speed: 0.0180s/iter; left time: 191.8160s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.16s
Steps: 226 | Train Loss: 0.0712541 Vali Loss: 0.0856194 Test Loss: 0.0883148
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0678672
	speed: 0.0344s/iter; left time: 361.9226s
	iters: 200, epoch: 54 | loss: 0.0734708
	speed: 0.0161s/iter; left time: 167.7152s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.02s
Steps: 226 | Train Loss: 0.0712836 Vali Loss: 0.0856949 Test Loss: 0.0883241
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0711872
	speed: 0.0388s/iter; left time: 399.7837s
	iters: 200, epoch: 55 | loss: 0.0728162
	speed: 0.0148s/iter; left time: 150.7086s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0712821 Vali Loss: 0.0857205 Test Loss: 0.0883147
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0777686
	speed: 0.0349s/iter; left time: 351.9102s
	iters: 200, epoch: 56 | loss: 0.0725330
	speed: 0.0160s/iter; left time: 159.2144s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.02s
Steps: 226 | Train Loss: 0.0712508 Vali Loss: 0.0856761 Test Loss: 0.0883089
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0710412
	speed: 0.0361s/iter; left time: 355.3465s
	iters: 200, epoch: 57 | loss: 0.0677898
	speed: 0.0177s/iter; left time: 172.8456s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.36s
Steps: 226 | Train Loss: 0.0712242 Vali Loss: 0.0856294 Test Loss: 0.0883095
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0743255
	speed: 0.0362s/iter; left time: 348.6598s
	iters: 200, epoch: 58 | loss: 0.0715804
	speed: 0.0191s/iter; left time: 181.9256s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.60s
Steps: 226 | Train Loss: 0.0712374 Vali Loss: 0.0856550 Test Loss: 0.0883076
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0697248
	speed: 0.0340s/iter; left time: 319.7715s
	iters: 200, epoch: 59 | loss: 0.0690377
	speed: 0.0154s/iter; left time: 143.1414s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:03.84s
Steps: 226 | Train Loss: 0.0712509 Vali Loss: 0.0857698 Test Loss: 0.0883156
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0771950
	speed: 0.0342s/iter; left time: 313.7151s
	iters: 200, epoch: 60 | loss: 0.0674402
	speed: 0.0153s/iter; left time: 139.0892s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0712430 Vali Loss: 0.0856275 Test Loss: 0.0883090
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0728195
	speed: 0.0363s/iter; left time: 324.6634s
	iters: 200, epoch: 61 | loss: 0.0771895
	speed: 0.0157s/iter; left time: 138.4129s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.00s
Steps: 226 | Train Loss: 0.0712464 Vali Loss: 0.0856176 Test Loss: 0.0883221
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0706645
	speed: 0.0355s/iter; left time: 309.0578s
	iters: 200, epoch: 62 | loss: 0.0693574
	speed: 0.0176s/iter; left time: 151.3221s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.0712369 Vali Loss: 0.0855623 Test Loss: 0.0883131
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_24_DE_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021246246993541718, rmse:0.1457609236240387, mae:0.08831298351287842, rse:0.5144104957580566
Use GPU: cuda:0
>>>>>>>start training : DE_168_24_DE_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1518033
	speed: 0.0192s/iter; left time: 431.8547s
	iters: 200, epoch: 1 | loss: 0.1270512
	speed: 0.0201s/iter; left time: 449.3727s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.49s
Steps: 226 | Train Loss: 0.1498720 Vali Loss: 0.1357662 Test Loss: 0.1440873
Validation loss decreased (inf --> 0.135766).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0853987
	speed: 0.0352s/iter; left time: 784.5516s
	iters: 200, epoch: 2 | loss: 0.0901837
	speed: 0.0148s/iter; left time: 328.6011s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.69s
Steps: 226 | Train Loss: 0.0911641 Vali Loss: 0.0949860 Test Loss: 0.0961873
Validation loss decreased (0.135766 --> 0.094986).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0799221
	speed: 0.0335s/iter; left time: 737.8098s
	iters: 200, epoch: 3 | loss: 0.0794998
	speed: 0.0157s/iter; left time: 344.3603s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.65s
Steps: 226 | Train Loss: 0.0814267 Vali Loss: 0.0915384 Test Loss: 0.0932980
Validation loss decreased (0.094986 --> 0.091538).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0764318
	speed: 0.0368s/iter; left time: 802.1689s
	iters: 200, epoch: 4 | loss: 0.0785906
	speed: 0.0218s/iter; left time: 474.6044s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.98s
Steps: 226 | Train Loss: 0.0787459 Vali Loss: 0.0898482 Test Loss: 0.0917731
Validation loss decreased (0.091538 --> 0.089848).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0741054
	speed: 0.0383s/iter; left time: 826.3129s
	iters: 200, epoch: 5 | loss: 0.0753271
	speed: 0.0187s/iter; left time: 401.4241s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0770410 Vali Loss: 0.0887867 Test Loss: 0.0908344
Validation loss decreased (0.089848 --> 0.088787).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0765578
	speed: 0.0346s/iter; left time: 740.2349s
	iters: 200, epoch: 6 | loss: 0.0733192
	speed: 0.0162s/iter; left time: 344.4038s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0760022 Vali Loss: 0.0880748 Test Loss: 0.0903927
Validation loss decreased (0.088787 --> 0.088075).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0709637
	speed: 0.0361s/iter; left time: 763.8951s
	iters: 200, epoch: 7 | loss: 0.0734636
	speed: 0.0163s/iter; left time: 343.1719s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.14s
Steps: 226 | Train Loss: 0.0751434 Vali Loss: 0.0871895 Test Loss: 0.0901067
Validation loss decreased (0.088075 --> 0.087190).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0773387
	speed: 0.0366s/iter; left time: 764.6073s
	iters: 200, epoch: 8 | loss: 0.0676913
	speed: 0.0155s/iter; left time: 321.6741s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.01s
Steps: 226 | Train Loss: 0.0746788 Vali Loss: 0.0872169 Test Loss: 0.0898075
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0763129
	speed: 0.0374s/iter; left time: 774.4037s
	iters: 200, epoch: 9 | loss: 0.0725481
	speed: 0.0195s/iter; left time: 402.0391s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.64s
Steps: 226 | Train Loss: 0.0741238 Vali Loss: 0.0871174 Test Loss: 0.0893675
Validation loss decreased (0.087190 --> 0.087117).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0748332
	speed: 0.0366s/iter; left time: 750.1061s
	iters: 200, epoch: 10 | loss: 0.0738588
	speed: 0.0206s/iter; left time: 419.7334s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.69s
Steps: 226 | Train Loss: 0.0737441 Vali Loss: 0.0869346 Test Loss: 0.0891188
Validation loss decreased (0.087117 --> 0.086935).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0711018
	speed: 0.0379s/iter; left time: 767.1253s
	iters: 200, epoch: 11 | loss: 0.0700966
	speed: 0.0190s/iter; left time: 383.0755s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.44s
Steps: 226 | Train Loss: 0.0733540 Vali Loss: 0.0866789 Test Loss: 0.0892408
Validation loss decreased (0.086935 --> 0.086679).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0763421
	speed: 0.0405s/iter; left time: 811.2465s
	iters: 200, epoch: 12 | loss: 0.0745435
	speed: 0.0196s/iter; left time: 390.4372s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.74s
Steps: 226 | Train Loss: 0.0731190 Vali Loss: 0.0863019 Test Loss: 0.0886837
Validation loss decreased (0.086679 --> 0.086302).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0725760
	speed: 0.0373s/iter; left time: 738.0649s
	iters: 200, epoch: 13 | loss: 0.0694761
	speed: 0.0202s/iter; left time: 396.9208s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.68s
Steps: 226 | Train Loss: 0.0728449 Vali Loss: 0.0860798 Test Loss: 0.0886771
Validation loss decreased (0.086302 --> 0.086080).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0713402
	speed: 0.0395s/iter; left time: 772.6691s
	iters: 200, epoch: 14 | loss: 0.0717091
	speed: 0.0197s/iter; left time: 383.8976s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.67s
Steps: 226 | Train Loss: 0.0726764 Vali Loss: 0.0860854 Test Loss: 0.0887915
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0696020
	speed: 0.0379s/iter; left time: 732.7090s
	iters: 200, epoch: 15 | loss: 0.0707006
	speed: 0.0182s/iter; left time: 349.7996s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.41s
Steps: 226 | Train Loss: 0.0724796 Vali Loss: 0.0859697 Test Loss: 0.0885499
Validation loss decreased (0.086080 --> 0.085970).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0702264
	speed: 0.0326s/iter; left time: 623.5638s
	iters: 200, epoch: 16 | loss: 0.0770680
	speed: 0.0148s/iter; left time: 280.6002s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.52s
Steps: 226 | Train Loss: 0.0723478 Vali Loss: 0.0859928 Test Loss: 0.0885237
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0693218
	speed: 0.0366s/iter; left time: 690.8188s
	iters: 200, epoch: 17 | loss: 0.0685964
	speed: 0.0195s/iter; left time: 366.6107s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.52s
Steps: 226 | Train Loss: 0.0721852 Vali Loss: 0.0858721 Test Loss: 0.0885176
Validation loss decreased (0.085970 --> 0.085872).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0763035
	speed: 0.0348s/iter; left time: 649.1754s
	iters: 200, epoch: 18 | loss: 0.0726792
	speed: 0.0228s/iter; left time: 422.6733s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0720626 Vali Loss: 0.0858251 Test Loss: 0.0883971
Validation loss decreased (0.085872 --> 0.085825).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0737270
	speed: 0.0377s/iter; left time: 694.0765s
	iters: 200, epoch: 19 | loss: 0.0792900
	speed: 0.0209s/iter; left time: 382.4331s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.58s
Steps: 226 | Train Loss: 0.0719951 Vali Loss: 0.0858679 Test Loss: 0.0884198
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0684844
	speed: 0.0388s/iter; left time: 707.1272s
	iters: 200, epoch: 20 | loss: 0.0707226
	speed: 0.0201s/iter; left time: 363.9326s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.63s
Steps: 226 | Train Loss: 0.0718766 Vali Loss: 0.0856740 Test Loss: 0.0883149
Validation loss decreased (0.085825 --> 0.085674).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0758472
	speed: 0.0385s/iter; left time: 691.6377s
	iters: 200, epoch: 21 | loss: 0.0754508
	speed: 0.0201s/iter; left time: 358.6358s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.69s
Steps: 226 | Train Loss: 0.0717989 Vali Loss: 0.0857483 Test Loss: 0.0882967
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0715936
	speed: 0.0376s/iter; left time: 667.4035s
	iters: 200, epoch: 22 | loss: 0.0681770
	speed: 0.0188s/iter; left time: 332.0895s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.46s
Steps: 226 | Train Loss: 0.0716900 Vali Loss: 0.0857370 Test Loss: 0.0882843
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0729675
	speed: 0.0385s/iter; left time: 675.1515s
	iters: 200, epoch: 23 | loss: 0.0740432
	speed: 0.0212s/iter; left time: 369.5652s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.94s
Steps: 226 | Train Loss: 0.0716362 Vali Loss: 0.0854434 Test Loss: 0.0882942
Validation loss decreased (0.085674 --> 0.085443).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0722094
	speed: 0.0392s/iter; left time: 677.9869s
	iters: 200, epoch: 24 | loss: 0.0706832
	speed: 0.0174s/iter; left time: 300.1547s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.39s
Steps: 226 | Train Loss: 0.0715837 Vali Loss: 0.0857568 Test Loss: 0.0883134
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0648718
	speed: 0.0408s/iter; left time: 697.0089s
	iters: 200, epoch: 25 | loss: 0.0725351
	speed: 0.0172s/iter; left time: 292.1746s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.68s
Steps: 226 | Train Loss: 0.0714995 Vali Loss: 0.0852995 Test Loss: 0.0881621
Validation loss decreased (0.085443 --> 0.085299).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0812834
	speed: 0.0387s/iter; left time: 651.7739s
	iters: 200, epoch: 26 | loss: 0.0664594
	speed: 0.0191s/iter; left time: 319.1942s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.70s
Steps: 226 | Train Loss: 0.0714836 Vali Loss: 0.0853780 Test Loss: 0.0881366
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0742876
	speed: 0.0400s/iter; left time: 665.4394s
	iters: 200, epoch: 27 | loss: 0.0732438
	speed: 0.0220s/iter; left time: 363.4763s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.05s
Steps: 226 | Train Loss: 0.0714202 Vali Loss: 0.0854149 Test Loss: 0.0881234
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0714915
	speed: 0.0348s/iter; left time: 570.5468s
	iters: 200, epoch: 28 | loss: 0.0735736
	speed: 0.0179s/iter; left time: 291.1401s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0713732 Vali Loss: 0.0854846 Test Loss: 0.0881038
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0754490
	speed: 0.0375s/iter; left time: 606.1918s
	iters: 200, epoch: 29 | loss: 0.0688223
	speed: 0.0199s/iter; left time: 319.9783s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.63s
Steps: 226 | Train Loss: 0.0714346 Vali Loss: 0.0855115 Test Loss: 0.0881206
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0691710
	speed: 0.0383s/iter; left time: 610.5563s
	iters: 200, epoch: 30 | loss: 0.0732817
	speed: 0.0162s/iter; left time: 257.2781s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0713558 Vali Loss: 0.0852352 Test Loss: 0.0881770
Validation loss decreased (0.085299 --> 0.085235).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0723415
	speed: 0.0368s/iter; left time: 578.3818s
	iters: 200, epoch: 31 | loss: 0.0698793
	speed: 0.0148s/iter; left time: 230.8294s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0713109 Vali Loss: 0.0855413 Test Loss: 0.0881131
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0731405
	speed: 0.0358s/iter; left time: 555.4050s
	iters: 200, epoch: 32 | loss: 0.0700180
	speed: 0.0193s/iter; left time: 296.7149s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.0713076 Vali Loss: 0.0853621 Test Loss: 0.0880926
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0645976
	speed: 0.0334s/iter; left time: 510.1503s
	iters: 200, epoch: 33 | loss: 0.0736442
	speed: 0.0157s/iter; left time: 237.5000s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.80s
Steps: 226 | Train Loss: 0.0712606 Vali Loss: 0.0855004 Test Loss: 0.0881196
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0698599
	speed: 0.0326s/iter; left time: 490.4366s
	iters: 200, epoch: 34 | loss: 0.0672192
	speed: 0.0148s/iter; left time: 220.8067s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.53s
Steps: 226 | Train Loss: 0.0712565 Vali Loss: 0.0854266 Test Loss: 0.0881393
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0714119
	speed: 0.0380s/iter; left time: 562.3737s
	iters: 200, epoch: 35 | loss: 0.0745585
	speed: 0.0156s/iter; left time: 229.1507s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.28s
Steps: 226 | Train Loss: 0.0712457 Vali Loss: 0.0854704 Test Loss: 0.0881282
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0699492
	speed: 0.0375s/iter; left time: 547.7401s
	iters: 200, epoch: 36 | loss: 0.0743586
	speed: 0.0177s/iter; left time: 256.2708s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.35s
Steps: 226 | Train Loss: 0.0712100 Vali Loss: 0.0852717 Test Loss: 0.0881152
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0690385
	speed: 0.0323s/iter; left time: 463.5959s
	iters: 200, epoch: 37 | loss: 0.0691354
	speed: 0.0149s/iter; left time: 212.7023s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.56s
Steps: 226 | Train Loss: 0.0712000 Vali Loss: 0.0853180 Test Loss: 0.0880658
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0746413
	speed: 0.0389s/iter; left time: 549.4572s
	iters: 200, epoch: 38 | loss: 0.0729299
	speed: 0.0178s/iter; left time: 249.7368s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.57s
Steps: 226 | Train Loss: 0.0711829 Vali Loss: 0.0853320 Test Loss: 0.0880678
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0674538
	speed: 0.0330s/iter; left time: 459.7032s
	iters: 200, epoch: 39 | loss: 0.0696075
	speed: 0.0149s/iter; left time: 205.7853s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.60s
Steps: 226 | Train Loss: 0.0711302 Vali Loss: 0.0852830 Test Loss: 0.0880550
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0697548
	speed: 0.0374s/iter; left time: 511.2212s
	iters: 200, epoch: 40 | loss: 0.0723081
	speed: 0.0164s/iter; left time: 222.4540s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0711335 Vali Loss: 0.0852903 Test Loss: 0.0880491
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_24_DE_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02114878036081791, rmse:0.1454261988401413, mae:0.08817699551582336, rse:0.5132291913032532
Intermediate time for DE and pred_len 24: 00h:09m:10.87s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_168_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_168_96_DE_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1546121
	speed: 0.0416s/iter; left time: 932.4142s
	iters: 200, epoch: 1 | loss: 0.1400235
	speed: 0.0154s/iter; left time: 344.2735s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.00s
Steps: 225 | Train Loss: 0.1571345 Vali Loss: 0.1484944 Test Loss: 0.1616077
Validation loss decreased (inf --> 0.148494).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1196035
	speed: 0.0355s/iter; left time: 787.1608s
	iters: 200, epoch: 2 | loss: 0.1128855
	speed: 0.0196s/iter; left time: 433.6503s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.1181649 Vali Loss: 0.1238543 Test Loss: 0.1332652
Validation loss decreased (0.148494 --> 0.123854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1108415
	speed: 0.0346s/iter; left time: 759.2518s
	iters: 200, epoch: 3 | loss: 0.1081765
	speed: 0.0182s/iter; left time: 398.2246s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.1086654 Vali Loss: 0.1214263 Test Loss: 0.1309388
Validation loss decreased (0.123854 --> 0.121426).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1058460
	speed: 0.0362s/iter; left time: 787.2354s
	iters: 200, epoch: 4 | loss: 0.1017606
	speed: 0.0165s/iter; left time: 357.2158s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.91s
Steps: 225 | Train Loss: 0.1063051 Vali Loss: 0.1204320 Test Loss: 0.1294891
Validation loss decreased (0.121426 --> 0.120432).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1031780
	speed: 0.0335s/iter; left time: 720.3490s
	iters: 200, epoch: 5 | loss: 0.1077288
	speed: 0.0182s/iter; left time: 388.6569s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.1049562 Vali Loss: 0.1202408 Test Loss: 0.1285590
Validation loss decreased (0.120432 --> 0.120241).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1112841
	speed: 0.0347s/iter; left time: 737.7303s
	iters: 200, epoch: 6 | loss: 0.1057750
	speed: 0.0166s/iter; left time: 351.1800s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.1040261 Vali Loss: 0.1198119 Test Loss: 0.1283519
Validation loss decreased (0.120241 --> 0.119812).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1015058
	speed: 0.0369s/iter; left time: 777.0897s
	iters: 200, epoch: 7 | loss: 0.1056823
	speed: 0.0174s/iter; left time: 365.5885s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.1032991 Vali Loss: 0.1199166 Test Loss: 0.1284418
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1041890
	speed: 0.0343s/iter; left time: 714.1693s
	iters: 200, epoch: 8 | loss: 0.1076229
	speed: 0.0151s/iter; left time: 313.5159s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.68s
Steps: 225 | Train Loss: 0.1027025 Vali Loss: 0.1198784 Test Loss: 0.1279660
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1025044
	speed: 0.0346s/iter; left time: 712.8094s
	iters: 200, epoch: 9 | loss: 0.0994158
	speed: 0.0150s/iter; left time: 307.2104s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.56s
Steps: 225 | Train Loss: 0.1022336 Vali Loss: 0.1190886 Test Loss: 0.1272537
Validation loss decreased (0.119812 --> 0.119089).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1005756
	speed: 0.0383s/iter; left time: 781.2921s
	iters: 200, epoch: 10 | loss: 0.1013288
	speed: 0.0189s/iter; left time: 384.1164s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.1017910 Vali Loss: 0.1191306 Test Loss: 0.1268866
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1017002
	speed: 0.0400s/iter; left time: 805.5786s
	iters: 200, epoch: 11 | loss: 0.1038562
	speed: 0.0225s/iter; left time: 451.7893s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.12s
Steps: 225 | Train Loss: 0.1014321 Vali Loss: 0.1187267 Test Loss: 0.1270149
Validation loss decreased (0.119089 --> 0.118727).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0990154
	speed: 0.0380s/iter; left time: 756.3343s
	iters: 200, epoch: 12 | loss: 0.1071175
	speed: 0.0178s/iter; left time: 353.6886s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.1010969 Vali Loss: 0.1191120 Test Loss: 0.1271684
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1041970
	speed: 0.0338s/iter; left time: 666.3408s
	iters: 200, epoch: 13 | loss: 0.1016034
	speed: 0.0164s/iter; left time: 322.0665s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.82s
Steps: 225 | Train Loss: 0.1008338 Vali Loss: 0.1195352 Test Loss: 0.1274527
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1013781
	speed: 0.0362s/iter; left time: 705.5291s
	iters: 200, epoch: 14 | loss: 0.1037347
	speed: 0.0171s/iter; left time: 330.4930s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.20s
Steps: 225 | Train Loss: 0.1006502 Vali Loss: 0.1190295 Test Loss: 0.1268910
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0992426
	speed: 0.0345s/iter; left time: 664.9427s
	iters: 200, epoch: 15 | loss: 0.0969416
	speed: 0.0149s/iter; left time: 286.2667s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.1003572 Vali Loss: 0.1189620 Test Loss: 0.1268336
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1013089
	speed: 0.0349s/iter; left time: 664.2710s
	iters: 200, epoch: 16 | loss: 0.0990523
	speed: 0.0203s/iter; left time: 383.4438s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.1001020 Vali Loss: 0.1187779 Test Loss: 0.1264221
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0997604
	speed: 0.0361s/iter; left time: 678.8091s
	iters: 200, epoch: 17 | loss: 0.1042790
	speed: 0.0152s/iter; left time: 284.8627s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.1000534 Vali Loss: 0.1187418 Test Loss: 0.1266497
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1057856
	speed: 0.0356s/iter; left time: 661.7073s
	iters: 200, epoch: 18 | loss: 0.0973422
	speed: 0.0154s/iter; left time: 284.1577s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.67s
Steps: 225 | Train Loss: 0.0998120 Vali Loss: 0.1185887 Test Loss: 0.1265640
Validation loss decreased (0.118727 --> 0.118589).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0994233
	speed: 0.0348s/iter; left time: 639.0015s
	iters: 200, epoch: 19 | loss: 0.0999866
	speed: 0.0154s/iter; left time: 281.4536s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0997114 Vali Loss: 0.1188520 Test Loss: 0.1263896
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0996900
	speed: 0.0352s/iter; left time: 638.2583s
	iters: 200, epoch: 20 | loss: 0.1031228
	speed: 0.0178s/iter; left time: 320.2310s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.11s
Steps: 225 | Train Loss: 0.0995866 Vali Loss: 0.1189126 Test Loss: 0.1265392
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0999166
	speed: 0.0333s/iter; left time: 595.9401s
	iters: 200, epoch: 21 | loss: 0.0971584
	speed: 0.0166s/iter; left time: 296.2245s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0994200 Vali Loss: 0.1187942 Test Loss: 0.1265447
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0989321
	speed: 0.0332s/iter; left time: 587.4503s
	iters: 200, epoch: 22 | loss: 0.1030317
	speed: 0.0149s/iter; left time: 262.1059s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.52s
Steps: 225 | Train Loss: 0.0993532 Vali Loss: 0.1184512 Test Loss: 0.1264205
Validation loss decreased (0.118589 --> 0.118451).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1053485
	speed: 0.0363s/iter; left time: 633.2806s
	iters: 200, epoch: 23 | loss: 0.0915438
	speed: 0.0190s/iter; left time: 328.8867s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.0992047 Vali Loss: 0.1188719 Test Loss: 0.1264960
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1002571
	speed: 0.0362s/iter; left time: 623.0431s
	iters: 200, epoch: 24 | loss: 0.1038216
	speed: 0.0164s/iter; left time: 280.6363s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.0991893 Vali Loss: 0.1185893 Test Loss: 0.1262891
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0964289
	speed: 0.0358s/iter; left time: 609.1420s
	iters: 200, epoch: 25 | loss: 0.0961830
	speed: 0.0160s/iter; left time: 270.4123s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0990750 Vali Loss: 0.1187493 Test Loss: 0.1265117
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1029489
	speed: 0.0334s/iter; left time: 559.5250s
	iters: 200, epoch: 26 | loss: 0.0984642
	speed: 0.0149s/iter; left time: 249.1374s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0990308 Vali Loss: 0.1184566 Test Loss: 0.1263237
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0963094
	speed: 0.0343s/iter; left time: 568.2647s
	iters: 200, epoch: 27 | loss: 0.0988014
	speed: 0.0176s/iter; left time: 289.6134s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.17s
Steps: 225 | Train Loss: 0.0990124 Vali Loss: 0.1186175 Test Loss: 0.1265397
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0955154
	speed: 0.0352s/iter; left time: 575.1701s
	iters: 200, epoch: 28 | loss: 0.0994291
	speed: 0.0150s/iter; left time: 243.4683s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0988817 Vali Loss: 0.1186398 Test Loss: 0.1264903
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1008465
	speed: 0.0376s/iter; left time: 605.1781s
	iters: 200, epoch: 29 | loss: 0.0950760
	speed: 0.0151s/iter; left time: 241.1719s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.06s
Steps: 225 | Train Loss: 0.0988331 Vali Loss: 0.1185322 Test Loss: 0.1264422
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0931816
	speed: 0.0350s/iter; left time: 555.9447s
	iters: 200, epoch: 30 | loss: 0.1001480
	speed: 0.0149s/iter; left time: 234.9705s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0989152 Vali Loss: 0.1184158 Test Loss: 0.1263546
Validation loss decreased (0.118451 --> 0.118416).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0959047
	speed: 0.0365s/iter; left time: 570.9919s
	iters: 200, epoch: 31 | loss: 0.1010143
	speed: 0.0189s/iter; left time: 293.9927s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0988581 Vali Loss: 0.1183319 Test Loss: 0.1263200
Validation loss decreased (0.118416 --> 0.118332).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0970245
	speed: 0.0376s/iter; left time: 580.4557s
	iters: 200, epoch: 32 | loss: 0.0988358
	speed: 0.0166s/iter; left time: 254.0047s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.0988036 Vali Loss: 0.1183956 Test Loss: 0.1264224
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.1012524
	speed: 0.0394s/iter; left time: 599.4984s
	iters: 200, epoch: 33 | loss: 0.0987937
	speed: 0.0205s/iter; left time: 310.0751s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0987398 Vali Loss: 0.1182987 Test Loss: 0.1263141
Validation loss decreased (0.118332 --> 0.118299).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0985900
	speed: 0.0374s/iter; left time: 560.4650s
	iters: 200, epoch: 34 | loss: 0.0935382
	speed: 0.0157s/iter; left time: 234.1922s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.0987068 Vali Loss: 0.1183450 Test Loss: 0.1263458
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0970084
	speed: 0.0353s/iter; left time: 521.2234s
	iters: 200, epoch: 35 | loss: 0.0927501
	speed: 0.0208s/iter; left time: 304.0132s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.0986973 Vali Loss: 0.1186062 Test Loss: 0.1265274
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0998640
	speed: 0.0407s/iter; left time: 591.0085s
	iters: 200, epoch: 36 | loss: 0.1007608
	speed: 0.0220s/iter; left time: 317.8291s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.09s
Steps: 225 | Train Loss: 0.0986956 Vali Loss: 0.1184913 Test Loss: 0.1264177
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.1017523
	speed: 0.0404s/iter; left time: 577.5350s
	iters: 200, epoch: 37 | loss: 0.0997659
	speed: 0.0201s/iter; left time: 284.7902s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.68s
Steps: 225 | Train Loss: 0.0985954 Vali Loss: 0.1184251 Test Loss: 0.1263238
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0956129
	speed: 0.0353s/iter; left time: 497.2797s
	iters: 200, epoch: 38 | loss: 0.0992918
	speed: 0.0156s/iter; left time: 217.9580s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.71s
Steps: 225 | Train Loss: 0.0986035 Vali Loss: 0.1185189 Test Loss: 0.1264063
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0935376
	speed: 0.0381s/iter; left time: 527.6382s
	iters: 200, epoch: 39 | loss: 0.0947464
	speed: 0.0203s/iter; left time: 278.7095s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.0986035 Vali Loss: 0.1185026 Test Loss: 0.1264198
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0979223
	speed: 0.0352s/iter; left time: 479.1197s
	iters: 200, epoch: 40 | loss: 0.0945299
	speed: 0.0198s/iter; left time: 267.9891s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0986283 Vali Loss: 0.1184659 Test Loss: 0.1264053
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0983004
	speed: 0.0403s/iter; left time: 540.3695s
	iters: 200, epoch: 41 | loss: 0.0979814
	speed: 0.0201s/iter; left time: 267.0893s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.68s
Steps: 225 | Train Loss: 0.0985964 Vali Loss: 0.1184100 Test Loss: 0.1263391
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.1028368
	speed: 0.0382s/iter; left time: 502.9143s
	iters: 200, epoch: 42 | loss: 0.0956750
	speed: 0.0187s/iter; left time: 244.7393s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0985760 Vali Loss: 0.1185045 Test Loss: 0.1263552
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0966641
	speed: 0.0369s/iter; left time: 478.1689s
	iters: 200, epoch: 43 | loss: 0.0967524
	speed: 0.0153s/iter; left time: 197.1618s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.0985568 Vali Loss: 0.1185039 Test Loss: 0.1264004
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_96_DE_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03725607320666313, rmse:0.19301831722259521, mae:0.12631411850452423, rse:0.6835169196128845
Use GPU: cuda:0
>>>>>>>start training : DE_168_96_DE_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1594719
	speed: 0.0203s/iter; left time: 454.8996s
	iters: 200, epoch: 1 | loss: 0.1446275
	speed: 0.0205s/iter; left time: 456.7100s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.1578681 Vali Loss: 0.1489479 Test Loss: 0.1620588
Validation loss decreased (inf --> 0.148948).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1165081
	speed: 0.0368s/iter; left time: 815.4234s
	iters: 200, epoch: 2 | loss: 0.1102197
	speed: 0.0175s/iter; left time: 385.8120s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.1184436 Vali Loss: 0.1239039 Test Loss: 0.1334199
Validation loss decreased (0.148948 --> 0.123904).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1065054
	speed: 0.0375s/iter; left time: 822.0836s
	iters: 200, epoch: 3 | loss: 0.0987603
	speed: 0.0150s/iter; left time: 327.4486s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.1088305 Vali Loss: 0.1219295 Test Loss: 0.1310768
Validation loss decreased (0.123904 --> 0.121929).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1059293
	speed: 0.0430s/iter; left time: 934.3116s
	iters: 200, epoch: 4 | loss: 0.1097753
	speed: 0.0207s/iter; left time: 446.9178s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.20s
Steps: 225 | Train Loss: 0.1064283 Vali Loss: 0.1208800 Test Loss: 0.1299682
Validation loss decreased (0.121929 --> 0.120880).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1106490
	speed: 0.0440s/iter; left time: 945.2451s
	iters: 200, epoch: 5 | loss: 0.1115315
	speed: 0.0198s/iter; left time: 423.1782s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.1050829 Vali Loss: 0.1201282 Test Loss: 0.1288217
Validation loss decreased (0.120880 --> 0.120128).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1070387
	speed: 0.0368s/iter; left time: 783.4612s
	iters: 200, epoch: 6 | loss: 0.0977164
	speed: 0.0164s/iter; left time: 346.6749s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.1041735 Vali Loss: 0.1211485 Test Loss: 0.1292872
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1014085
	speed: 0.0330s/iter; left time: 695.6314s
	iters: 200, epoch: 7 | loss: 0.1047801
	speed: 0.0152s/iter; left time: 317.9219s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.1035143 Vali Loss: 0.1195752 Test Loss: 0.1277059
Validation loss decreased (0.120128 --> 0.119575).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1013614
	speed: 0.0390s/iter; left time: 811.3228s
	iters: 200, epoch: 8 | loss: 0.1080542
	speed: 0.0195s/iter; left time: 405.0982s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.69s
Steps: 225 | Train Loss: 0.1029324 Vali Loss: 0.1196418 Test Loss: 0.1277450
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1005211
	speed: 0.0362s/iter; left time: 745.8069s
	iters: 200, epoch: 9 | loss: 0.0996397
	speed: 0.0171s/iter; left time: 349.7013s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.1024450 Vali Loss: 0.1194940 Test Loss: 0.1271717
Validation loss decreased (0.119575 --> 0.119494).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1033988
	speed: 0.0405s/iter; left time: 825.6661s
	iters: 200, epoch: 10 | loss: 0.1075299
	speed: 0.0211s/iter; left time: 428.7822s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.1019535 Vali Loss: 0.1189011 Test Loss: 0.1265846
Validation loss decreased (0.119494 --> 0.118901).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1029874
	speed: 0.0421s/iter; left time: 849.3110s
	iters: 200, epoch: 11 | loss: 0.0994294
	speed: 0.0199s/iter; left time: 398.1656s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.1015970 Vali Loss: 0.1188431 Test Loss: 0.1266741
Validation loss decreased (0.118901 --> 0.118843).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1002504
	speed: 0.0386s/iter; left time: 769.3879s
	iters: 200, epoch: 12 | loss: 0.0984752
	speed: 0.0210s/iter; left time: 415.8730s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.66s
Steps: 225 | Train Loss: 0.1012771 Vali Loss: 0.1190146 Test Loss: 0.1266688
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0951208
	speed: 0.0397s/iter; left time: 781.4904s
	iters: 200, epoch: 13 | loss: 0.1013440
	speed: 0.0207s/iter; left time: 405.2801s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.1009379 Vali Loss: 0.1190206 Test Loss: 0.1263876
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1019207
	speed: 0.0394s/iter; left time: 767.8853s
	iters: 200, epoch: 14 | loss: 0.1002271
	speed: 0.0193s/iter; left time: 373.8824s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.1006495 Vali Loss: 0.1190553 Test Loss: 0.1264120
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0994094
	speed: 0.0393s/iter; left time: 756.3436s
	iters: 200, epoch: 15 | loss: 0.0971790
	speed: 0.0179s/iter; left time: 342.5074s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.1004595 Vali Loss: 0.1186343 Test Loss: 0.1265867
Validation loss decreased (0.118843 --> 0.118634).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1021780
	speed: 0.0393s/iter; left time: 747.8991s
	iters: 200, epoch: 16 | loss: 0.1010583
	speed: 0.0175s/iter; left time: 331.8440s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.1002135 Vali Loss: 0.1187289 Test Loss: 0.1263449
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0969147
	speed: 0.0383s/iter; left time: 720.5074s
	iters: 200, epoch: 17 | loss: 0.0948327
	speed: 0.0190s/iter; left time: 354.4017s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0999837 Vali Loss: 0.1188469 Test Loss: 0.1263028
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0999236
	speed: 0.0408s/iter; left time: 757.3810s
	iters: 200, epoch: 18 | loss: 0.1040796
	speed: 0.0207s/iter; left time: 382.9266s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0998135 Vali Loss: 0.1189184 Test Loss: 0.1264344
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1023207
	speed: 0.0381s/iter; left time: 700.0582s
	iters: 200, epoch: 19 | loss: 0.0959595
	speed: 0.0178s/iter; left time: 324.6220s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.37s
Steps: 225 | Train Loss: 0.0996949 Vali Loss: 0.1189701 Test Loss: 0.1262245
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1043485
	speed: 0.0417s/iter; left time: 756.0298s
	iters: 200, epoch: 20 | loss: 0.1012136
	speed: 0.0221s/iter; left time: 397.7390s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.08s
Steps: 225 | Train Loss: 0.0996269 Vali Loss: 0.1188949 Test Loss: 0.1261493
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1007755
	speed: 0.0402s/iter; left time: 719.6723s
	iters: 200, epoch: 21 | loss: 0.0938013
	speed: 0.0220s/iter; left time: 391.1181s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0994555 Vali Loss: 0.1189866 Test Loss: 0.1263751
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0992515
	speed: 0.0428s/iter; left time: 757.0956s
	iters: 200, epoch: 22 | loss: 0.0981303
	speed: 0.0226s/iter; left time: 396.7033s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.27s
Steps: 225 | Train Loss: 0.0994021 Vali Loss: 0.1189413 Test Loss: 0.1262374
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1014347
	speed: 0.0444s/iter; left time: 774.2949s
	iters: 200, epoch: 23 | loss: 0.0944737
	speed: 0.0205s/iter; left time: 355.8615s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.18s
Steps: 225 | Train Loss: 0.0993091 Vali Loss: 0.1188072 Test Loss: 0.1261979
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1021972
	speed: 0.0403s/iter; left time: 693.4551s
	iters: 200, epoch: 24 | loss: 0.0987332
	speed: 0.0200s/iter; left time: 341.7360s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0991928 Vali Loss: 0.1189013 Test Loss: 0.1264363
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1018750
	speed: 0.0399s/iter; left time: 677.8940s
	iters: 200, epoch: 25 | loss: 0.0972224
	speed: 0.0192s/iter; left time: 323.9625s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0991676 Vali Loss: 0.1189413 Test Loss: 0.1262479
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_96_DE_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03709335997700691, rmse:0.19259636104106903, mae:0.1265867054462433, rse:0.6820226311683655
Intermediate time for DE and pred_len 96: 00h:06m:29.88s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_168_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_168_168_DE_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1597681
	speed: 0.0421s/iter; left time: 943.7567s
	iters: 200, epoch: 1 | loss: 0.1394441
	speed: 0.0154s/iter; left time: 343.1852s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.1611064 Vali Loss: 0.1516039 Test Loss: 0.1655859
Validation loss decreased (inf --> 0.151604).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1293734
	speed: 0.0379s/iter; left time: 840.5527s
	iters: 200, epoch: 2 | loss: 0.1188756
	speed: 0.0184s/iter; left time: 406.4267s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.1250985 Vali Loss: 0.1289203 Test Loss: 0.1402800
Validation loss decreased (0.151604 --> 0.128920).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1157258
	speed: 0.0392s/iter; left time: 860.6975s
	iters: 200, epoch: 3 | loss: 0.1150265
	speed: 0.0159s/iter; left time: 347.2577s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.06s
Steps: 225 | Train Loss: 0.1154583 Vali Loss: 0.1264038 Test Loss: 0.1374858
Validation loss decreased (0.128920 --> 0.126404).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1165608
	speed: 0.0366s/iter; left time: 794.8849s
	iters: 200, epoch: 4 | loss: 0.1122621
	speed: 0.0181s/iter; left time: 390.8585s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.1130506 Vali Loss: 0.1259780 Test Loss: 0.1365361
Validation loss decreased (0.126404 --> 0.125978).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1151247
	speed: 0.0390s/iter; left time: 839.4699s
	iters: 200, epoch: 5 | loss: 0.1071975
	speed: 0.0179s/iter; left time: 382.5318s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.1116234 Vali Loss: 0.1258907 Test Loss: 0.1366494
Validation loss decreased (0.125978 --> 0.125891).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1089182
	speed: 0.0355s/iter; left time: 756.0827s
	iters: 200, epoch: 6 | loss: 0.1135221
	speed: 0.0168s/iter; left time: 356.0011s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.1107035 Vali Loss: 0.1255296 Test Loss: 0.1358035
Validation loss decreased (0.125891 --> 0.125530).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1117654
	speed: 0.0397s/iter; left time: 836.1848s
	iters: 200, epoch: 7 | loss: 0.1075306
	speed: 0.0192s/iter; left time: 402.6854s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.1099964 Vali Loss: 0.1253670 Test Loss: 0.1351608
Validation loss decreased (0.125530 --> 0.125367).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1033830
	speed: 0.0366s/iter; left time: 762.8314s
	iters: 200, epoch: 8 | loss: 0.1089234
	speed: 0.0152s/iter; left time: 314.4212s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.1094158 Vali Loss: 0.1254329 Test Loss: 0.1354677
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1109020
	speed: 0.0346s/iter; left time: 713.4664s
	iters: 200, epoch: 9 | loss: 0.1085580
	speed: 0.0153s/iter; left time: 314.4619s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.75s
Steps: 225 | Train Loss: 0.1089027 Vali Loss: 0.1248833 Test Loss: 0.1352038
Validation loss decreased (0.125367 --> 0.124883).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1067005
	speed: 0.0356s/iter; left time: 725.6138s
	iters: 200, epoch: 10 | loss: 0.1039695
	speed: 0.0151s/iter; left time: 307.0943s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.1085350 Vali Loss: 0.1246719 Test Loss: 0.1349904
Validation loss decreased (0.124883 --> 0.124672).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1060302
	speed: 0.0401s/iter; left time: 807.2325s
	iters: 200, epoch: 11 | loss: 0.1044329
	speed: 0.0174s/iter; left time: 348.1556s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.1080497 Vali Loss: 0.1248863 Test Loss: 0.1353544
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1098358
	speed: 0.0364s/iter; left time: 724.6957s
	iters: 200, epoch: 12 | loss: 0.1077055
	speed: 0.0151s/iter; left time: 300.0364s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.1078033 Vali Loss: 0.1247643 Test Loss: 0.1351484
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1063721
	speed: 0.0377s/iter; left time: 743.4401s
	iters: 200, epoch: 13 | loss: 0.1019878
	speed: 0.0190s/iter; left time: 372.2171s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.1074929 Vali Loss: 0.1244314 Test Loss: 0.1348955
Validation loss decreased (0.124672 --> 0.124431).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1112889
	speed: 0.0405s/iter; left time: 788.4218s
	iters: 200, epoch: 14 | loss: 0.1100490
	speed: 0.0160s/iter; left time: 309.2996s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.1072949 Vali Loss: 0.1246140 Test Loss: 0.1347168
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1048008
	speed: 0.0356s/iter; left time: 686.2853s
	iters: 200, epoch: 15 | loss: 0.1065564
	speed: 0.0168s/iter; left time: 321.9128s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.93s
Steps: 225 | Train Loss: 0.1069529 Vali Loss: 0.1243602 Test Loss: 0.1350712
Validation loss decreased (0.124431 --> 0.124360).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1137868
	speed: 0.0366s/iter; left time: 696.4361s
	iters: 200, epoch: 16 | loss: 0.1119398
	speed: 0.0190s/iter; left time: 358.7007s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.1068381 Vali Loss: 0.1244992 Test Loss: 0.1346245
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1088810
	speed: 0.0338s/iter; left time: 634.5856s
	iters: 200, epoch: 17 | loss: 0.1117870
	speed: 0.0153s/iter; left time: 286.1590s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.62s
Steps: 225 | Train Loss: 0.1066407 Vali Loss: 0.1241617 Test Loss: 0.1347925
Validation loss decreased (0.124360 --> 0.124162).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1037163
	speed: 0.0382s/iter; left time: 710.1916s
	iters: 200, epoch: 18 | loss: 0.1055945
	speed: 0.0151s/iter; left time: 279.1131s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.1065037 Vali Loss: 0.1244145 Test Loss: 0.1348231
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1053035
	speed: 0.0340s/iter; left time: 624.7087s
	iters: 200, epoch: 19 | loss: 0.1099117
	speed: 0.0151s/iter; left time: 275.6109s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.1063549 Vali Loss: 0.1242019 Test Loss: 0.1347113
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1073127
	speed: 0.0361s/iter; left time: 654.6316s
	iters: 200, epoch: 20 | loss: 0.1123709
	speed: 0.0172s/iter; left time: 309.5763s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.1063023 Vali Loss: 0.1241778 Test Loss: 0.1349964
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1037868
	speed: 0.0403s/iter; left time: 721.5322s
	iters: 200, epoch: 21 | loss: 0.1039041
	speed: 0.0181s/iter; left time: 323.0807s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.1061470 Vali Loss: 0.1238399 Test Loss: 0.1348939
Validation loss decreased (0.124162 --> 0.123840).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.1074208
	speed: 0.0352s/iter; left time: 622.4051s
	iters: 200, epoch: 22 | loss: 0.1065059
	speed: 0.0153s/iter; left time: 268.2264s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.64s
Steps: 225 | Train Loss: 0.1060402 Vali Loss: 0.1240012 Test Loss: 0.1350031
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.1067464
	speed: 0.0396s/iter; left time: 690.8393s
	iters: 200, epoch: 23 | loss: 0.0995105
	speed: 0.0173s/iter; left time: 300.5072s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.1059790 Vali Loss: 0.1240508 Test Loss: 0.1347556
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1051342
	speed: 0.0373s/iter; left time: 643.2248s
	iters: 200, epoch: 24 | loss: 0.1061060
	speed: 0.0180s/iter; left time: 307.8155s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.1058389 Vali Loss: 0.1241084 Test Loss: 0.1347512
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1040247
	speed: 0.0346s/iter; left time: 587.8989s
	iters: 200, epoch: 25 | loss: 0.1066597
	speed: 0.0158s/iter; left time: 267.4184s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.80s
Steps: 225 | Train Loss: 0.1057603 Vali Loss: 0.1238703 Test Loss: 0.1346270
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1043022
	speed: 0.0344s/iter; left time: 576.4309s
	iters: 200, epoch: 26 | loss: 0.1011586
	speed: 0.0165s/iter; left time: 275.7514s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.79s
Steps: 225 | Train Loss: 0.1057232 Vali Loss: 0.1242573 Test Loss: 0.1348052
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.1044532
	speed: 0.0364s/iter; left time: 602.3999s
	iters: 200, epoch: 27 | loss: 0.1077922
	speed: 0.0170s/iter; left time: 279.8439s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.1056584 Vali Loss: 0.1239977 Test Loss: 0.1347191
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.1062665
	speed: 0.0378s/iter; left time: 617.5555s
	iters: 200, epoch: 28 | loss: 0.1054133
	speed: 0.0202s/iter; left time: 327.7679s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.68s
Steps: 225 | Train Loss: 0.1055746 Vali Loss: 0.1241290 Test Loss: 0.1347836
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.1068603
	speed: 0.0393s/iter; left time: 633.2472s
	iters: 200, epoch: 29 | loss: 0.1053896
	speed: 0.0175s/iter; left time: 279.6740s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.1055822 Vali Loss: 0.1239924 Test Loss: 0.1348849
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.1037724
	speed: 0.0382s/iter; left time: 606.1204s
	iters: 200, epoch: 30 | loss: 0.1117676
	speed: 0.0187s/iter; left time: 294.8138s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.36s
Steps: 225 | Train Loss: 0.1054864 Vali Loss: 0.1239919 Test Loss: 0.1348824
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.1049670
	speed: 0.0378s/iter; left time: 591.6000s
	iters: 200, epoch: 31 | loss: 0.1072682
	speed: 0.0175s/iter; left time: 271.9761s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.1054962 Vali Loss: 0.1241026 Test Loss: 0.1347783
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_168_DE_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04131152108311653, rmse:0.20325236022472382, mae:0.13489389419555664, rse:0.719936192035675
Use GPU: cuda:0
>>>>>>>start training : DE_168_168_DE_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1629653
	speed: 0.0174s/iter; left time: 390.6402s
	iters: 200, epoch: 1 | loss: 0.1467177
	speed: 0.0153s/iter; left time: 341.7266s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.80s
Steps: 225 | Train Loss: 0.1603462 Vali Loss: 0.1508472 Test Loss: 0.1646355
Validation loss decreased (inf --> 0.150847).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1300881
	speed: 0.0398s/iter; left time: 881.5142s
	iters: 200, epoch: 2 | loss: 0.1143041
	speed: 0.0183s/iter; left time: 403.2012s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.1242376 Vali Loss: 0.1294085 Test Loss: 0.1407559
Validation loss decreased (0.150847 --> 0.129408).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1186319
	speed: 0.0381s/iter; left time: 836.7470s
	iters: 200, epoch: 3 | loss: 0.1203104
	speed: 0.0162s/iter; left time: 354.0128s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.07s
Steps: 225 | Train Loss: 0.1154474 Vali Loss: 0.1263371 Test Loss: 0.1371361
Validation loss decreased (0.129408 --> 0.126337).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1122255
	speed: 0.0392s/iter; left time: 850.7349s
	iters: 200, epoch: 4 | loss: 0.1088989
	speed: 0.0171s/iter; left time: 369.6566s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.1131376 Vali Loss: 0.1253243 Test Loss: 0.1361789
Validation loss decreased (0.126337 --> 0.125324).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1083760
	speed: 0.0381s/iter; left time: 819.0103s
	iters: 200, epoch: 5 | loss: 0.1178844
	speed: 0.0205s/iter; left time: 438.9740s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.1117257 Vali Loss: 0.1248998 Test Loss: 0.1352501
Validation loss decreased (0.125324 --> 0.124900).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1139530
	speed: 0.0383s/iter; left time: 813.9864s
	iters: 200, epoch: 6 | loss: 0.1064244
	speed: 0.0166s/iter; left time: 351.2821s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.1107475 Vali Loss: 0.1244106 Test Loss: 0.1347651
Validation loss decreased (0.124900 --> 0.124411).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1151732
	speed: 0.0393s/iter; left time: 826.2979s
	iters: 200, epoch: 7 | loss: 0.1072712
	speed: 0.0187s/iter; left time: 392.3780s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.1100969 Vali Loss: 0.1244932 Test Loss: 0.1351271
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1128722
	speed: 0.0398s/iter; left time: 829.2852s
	iters: 200, epoch: 8 | loss: 0.1057848
	speed: 0.0178s/iter; left time: 369.6245s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.1094682 Vali Loss: 0.1239749 Test Loss: 0.1349620
Validation loss decreased (0.124411 --> 0.123975).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1162132
	speed: 0.0348s/iter; left time: 717.1068s
	iters: 200, epoch: 9 | loss: 0.1069723
	speed: 0.0151s/iter; left time: 309.5633s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.1089953 Vali Loss: 0.1242746 Test Loss: 0.1343836
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1074245
	speed: 0.0359s/iter; left time: 730.6829s
	iters: 200, epoch: 10 | loss: 0.1146695
	speed: 0.0169s/iter; left time: 342.2095s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.1085315 Vali Loss: 0.1246715 Test Loss: 0.1342424
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1077108
	speed: 0.0390s/iter; left time: 785.0145s
	iters: 200, epoch: 11 | loss: 0.1067131
	speed: 0.0204s/iter; left time: 408.0537s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.64s
Steps: 225 | Train Loss: 0.1081504 Vali Loss: 0.1237239 Test Loss: 0.1338762
Validation loss decreased (0.123975 --> 0.123724).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1066032
	speed: 0.0405s/iter; left time: 806.9693s
	iters: 200, epoch: 12 | loss: 0.1069852
	speed: 0.0188s/iter; left time: 372.0942s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.54s
Steps: 225 | Train Loss: 0.1077525 Vali Loss: 0.1240567 Test Loss: 0.1340794
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1074472
	speed: 0.0397s/iter; left time: 781.6063s
	iters: 200, epoch: 13 | loss: 0.1039106
	speed: 0.0193s/iter; left time: 377.6317s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.1074885 Vali Loss: 0.1241955 Test Loss: 0.1341534
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1025117
	speed: 0.0398s/iter; left time: 774.9892s
	iters: 200, epoch: 14 | loss: 0.1067264
	speed: 0.0196s/iter; left time: 380.1419s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.1072166 Vali Loss: 0.1242939 Test Loss: 0.1342657
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1097217
	speed: 0.0397s/iter; left time: 765.1856s
	iters: 200, epoch: 15 | loss: 0.1035928
	speed: 0.0197s/iter; left time: 376.7291s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.1069498 Vali Loss: 0.1239720 Test Loss: 0.1343582
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1067876
	speed: 0.0413s/iter; left time: 786.6408s
	iters: 200, epoch: 16 | loss: 0.1109241
	speed: 0.0182s/iter; left time: 345.0859s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.1067773 Vali Loss: 0.1238592 Test Loss: 0.1337989
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1054149
	speed: 0.0402s/iter; left time: 756.4454s
	iters: 200, epoch: 17 | loss: 0.1046284
	speed: 0.0204s/iter; left time: 380.9792s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.1066017 Vali Loss: 0.1241902 Test Loss: 0.1340709
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1064189
	speed: 0.0413s/iter; left time: 766.7903s
	iters: 200, epoch: 18 | loss: 0.1059560
	speed: 0.0199s/iter; left time: 367.4204s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.1064438 Vali Loss: 0.1239474 Test Loss: 0.1339504
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1021350
	speed: 0.0418s/iter; left time: 766.4911s
	iters: 200, epoch: 19 | loss: 0.1146571
	speed: 0.0191s/iter; left time: 348.0170s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.1062876 Vali Loss: 0.1241477 Test Loss: 0.1338608
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1086384
	speed: 0.0393s/iter; left time: 712.8210s
	iters: 200, epoch: 20 | loss: 0.1046049
	speed: 0.0210s/iter; left time: 377.9705s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.59s
Steps: 225 | Train Loss: 0.1061432 Vali Loss: 0.1240658 Test Loss: 0.1340669
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.1032892
	speed: 0.0414s/iter; left time: 741.2086s
	iters: 200, epoch: 21 | loss: 0.1053182
	speed: 0.0173s/iter; left time: 308.1926s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.1060186 Vali Loss: 0.1244103 Test Loss: 0.1343777
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_168_168_DE_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04032425582408905, rmse:0.20080900192260742, mae:0.13387621939182281, rse:0.7112816572189331
Intermediate time for DE and pred_len 168: 00h:05m:01.35sIntermediate time for DE: 00h:20m:42.10s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_168_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_168_24_GB_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1348012
	speed: 0.0432s/iter; left time: 971.5674s
	iters: 200, epoch: 1 | loss: 0.1199800
	speed: 0.0147s/iter; left time: 330.1381s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.1358073 Vali Loss: 0.1256861 Test Loss: 0.1465730
Validation loss decreased (inf --> 0.125686).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0842726
	speed: 0.0326s/iter; left time: 725.8451s
	iters: 200, epoch: 2 | loss: 0.0801193
	speed: 0.0165s/iter; left time: 366.0726s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.76s
Steps: 226 | Train Loss: 0.0878881 Vali Loss: 0.0922427 Test Loss: 0.1037492
Validation loss decreased (0.125686 --> 0.092243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0849407
	speed: 0.0333s/iter; left time: 735.1307s
	iters: 200, epoch: 3 | loss: 0.0829507
	speed: 0.0208s/iter; left time: 455.8667s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0802817 Vali Loss: 0.0916280 Test Loss: 0.1027605
Validation loss decreased (0.092243 --> 0.091628).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0824983
	speed: 0.0341s/iter; left time: 744.3155s
	iters: 200, epoch: 4 | loss: 0.0778295
	speed: 0.0148s/iter; left time: 322.3088s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.63s
Steps: 226 | Train Loss: 0.0787315 Vali Loss: 0.0912857 Test Loss: 0.1020525
Validation loss decreased (0.091628 --> 0.091286).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0771139
	speed: 0.0323s/iter; left time: 696.5428s
	iters: 200, epoch: 5 | loss: 0.0828588
	speed: 0.0150s/iter; left time: 323.2207s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.59s
Steps: 226 | Train Loss: 0.0778978 Vali Loss: 0.0906263 Test Loss: 0.1016233
Validation loss decreased (0.091286 --> 0.090626).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0730026
	speed: 0.0334s/iter; left time: 714.6117s
	iters: 200, epoch: 6 | loss: 0.0768275
	speed: 0.0152s/iter; left time: 324.2262s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0771877 Vali Loss: 0.0897547 Test Loss: 0.1013267
Validation loss decreased (0.090626 --> 0.089755).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0764931
	speed: 0.0334s/iter; left time: 705.6211s
	iters: 200, epoch: 7 | loss: 0.0729029
	speed: 0.0151s/iter; left time: 317.9872s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.73s
Steps: 226 | Train Loss: 0.0767380 Vali Loss: 0.0894999 Test Loss: 0.1012439
Validation loss decreased (0.089755 --> 0.089500).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0740525
	speed: 0.0340s/iter; left time: 711.5861s
	iters: 200, epoch: 8 | loss: 0.0767735
	speed: 0.0153s/iter; left time: 319.2202s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.86s
Steps: 226 | Train Loss: 0.0764164 Vali Loss: 0.0896466 Test Loss: 0.1009590
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0774673
	speed: 0.0337s/iter; left time: 697.6230s
	iters: 200, epoch: 9 | loss: 0.0760660
	speed: 0.0161s/iter; left time: 330.7182s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.86s
Steps: 226 | Train Loss: 0.0760536 Vali Loss: 0.0890659 Test Loss: 0.1009193
Validation loss decreased (0.089500 --> 0.089066).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0732044
	speed: 0.0340s/iter; left time: 694.9415s
	iters: 200, epoch: 10 | loss: 0.0767341
	speed: 0.0172s/iter; left time: 349.4771s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0757877 Vali Loss: 0.0891886 Test Loss: 0.1009441
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0825395
	speed: 0.0343s/iter; left time: 694.4001s
	iters: 200, epoch: 11 | loss: 0.0761485
	speed: 0.0157s/iter; left time: 317.1140s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.80s
Steps: 226 | Train Loss: 0.0755504 Vali Loss: 0.0890318 Test Loss: 0.1007226
Validation loss decreased (0.089066 --> 0.089032).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0742803
	speed: 0.0315s/iter; left time: 629.9250s
	iters: 200, epoch: 12 | loss: 0.0833599
	speed: 0.0147s/iter; left time: 293.6146s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.51s
Steps: 226 | Train Loss: 0.0753169 Vali Loss: 0.0888209 Test Loss: 0.1007950
Validation loss decreased (0.089032 --> 0.088821).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0688437
	speed: 0.0332s/iter; left time: 656.0625s
	iters: 200, epoch: 13 | loss: 0.0757275
	speed: 0.0163s/iter; left time: 321.8695s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0752007 Vali Loss: 0.0886280 Test Loss: 0.1005576
Validation loss decreased (0.088821 --> 0.088628).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0754868
	speed: 0.0337s/iter; left time: 658.6997s
	iters: 200, epoch: 14 | loss: 0.0743996
	speed: 0.0151s/iter; left time: 293.4383s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.67s
Steps: 226 | Train Loss: 0.0750082 Vali Loss: 0.0888044 Test Loss: 0.1005008
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0776850
	speed: 0.0347s/iter; left time: 670.9982s
	iters: 200, epoch: 15 | loss: 0.0746924
	speed: 0.0162s/iter; left time: 310.7459s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.98s
Steps: 226 | Train Loss: 0.0748108 Vali Loss: 0.0884927 Test Loss: 0.1003191
Validation loss decreased (0.088628 --> 0.088493).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0747475
	speed: 0.0347s/iter; left time: 663.5982s
	iters: 200, epoch: 16 | loss: 0.0749063
	speed: 0.0154s/iter; left time: 292.9448s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.74s
Steps: 226 | Train Loss: 0.0747405 Vali Loss: 0.0885689 Test Loss: 0.1004213
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0733430
	speed: 0.0335s/iter; left time: 632.4483s
	iters: 200, epoch: 17 | loss: 0.0734850
	speed: 0.0151s/iter; left time: 284.3771s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.64s
Steps: 226 | Train Loss: 0.0746306 Vali Loss: 0.0886222 Test Loss: 0.1004618
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0729925
	speed: 0.0397s/iter; left time: 740.4525s
	iters: 200, epoch: 18 | loss: 0.0748200
	speed: 0.0215s/iter; left time: 398.5138s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.14s
Steps: 226 | Train Loss: 0.0745408 Vali Loss: 0.0885219 Test Loss: 0.1001322
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0740487
	speed: 0.0393s/iter; left time: 724.6756s
	iters: 200, epoch: 19 | loss: 0.0761470
	speed: 0.0199s/iter; left time: 364.9858s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.63s
Steps: 226 | Train Loss: 0.0743890 Vali Loss: 0.0884069 Test Loss: 0.1004253
Validation loss decreased (0.088493 --> 0.088407).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0804507
	speed: 0.0347s/iter; left time: 632.2010s
	iters: 200, epoch: 20 | loss: 0.0757066
	speed: 0.0176s/iter; left time: 318.5583s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0743674 Vali Loss: 0.0885054 Test Loss: 0.1000969
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0756700
	speed: 0.0364s/iter; left time: 654.9323s
	iters: 200, epoch: 21 | loss: 0.0785028
	speed: 0.0168s/iter; left time: 301.1972s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.02s
Steps: 226 | Train Loss: 0.0743069 Vali Loss: 0.0886169 Test Loss: 0.1004365
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0687134
	speed: 0.0375s/iter; left time: 665.8023s
	iters: 200, epoch: 22 | loss: 0.0773262
	speed: 0.0215s/iter; left time: 378.7144s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.93s
Steps: 226 | Train Loss: 0.0742749 Vali Loss: 0.0883453 Test Loss: 0.1002563
Validation loss decreased (0.088407 --> 0.088345).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0707392
	speed: 0.0365s/iter; left time: 639.1904s
	iters: 200, epoch: 23 | loss: 0.0712351
	speed: 0.0173s/iter; left time: 301.4605s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.06s
Steps: 226 | Train Loss: 0.0741822 Vali Loss: 0.0882935 Test Loss: 0.1002856
Validation loss decreased (0.088345 --> 0.088293).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0738477
	speed: 0.0387s/iter; left time: 668.9220s
	iters: 200, epoch: 24 | loss: 0.0728533
	speed: 0.0195s/iter; left time: 335.6749s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.70s
Steps: 226 | Train Loss: 0.0740945 Vali Loss: 0.0883293 Test Loss: 0.1002986
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0715703
	speed: 0.0371s/iter; left time: 633.0545s
	iters: 200, epoch: 25 | loss: 0.0675489
	speed: 0.0195s/iter; left time: 331.6603s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.46s
Steps: 226 | Train Loss: 0.0740816 Vali Loss: 0.0881852 Test Loss: 0.1001899
Validation loss decreased (0.088293 --> 0.088185).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0774840
	speed: 0.0330s/iter; left time: 555.7904s
	iters: 200, epoch: 26 | loss: 0.0691603
	speed: 0.0156s/iter; left time: 260.8354s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.71s
Steps: 226 | Train Loss: 0.0740570 Vali Loss: 0.0882801 Test Loss: 0.1002105
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0784263
	speed: 0.0337s/iter; left time: 560.2220s
	iters: 200, epoch: 27 | loss: 0.0770142
	speed: 0.0158s/iter; left time: 261.8958s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0740176 Vali Loss: 0.0882419 Test Loss: 0.1001402
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0708968
	speed: 0.0385s/iter; left time: 630.6580s
	iters: 200, epoch: 28 | loss: 0.0749423
	speed: 0.0202s/iter; left time: 329.0441s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.74s
Steps: 226 | Train Loss: 0.0739662 Vali Loss: 0.0882251 Test Loss: 0.1001193
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0744236
	speed: 0.0379s/iter; left time: 613.4823s
	iters: 200, epoch: 29 | loss: 0.0747024
	speed: 0.0193s/iter; left time: 309.5886s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.57s
Steps: 226 | Train Loss: 0.0739222 Vali Loss: 0.0881882 Test Loss: 0.1000275
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0714746
	speed: 0.0341s/iter; left time: 544.5706s
	iters: 200, epoch: 30 | loss: 0.0766074
	speed: 0.0169s/iter; left time: 268.2775s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.03s
Steps: 226 | Train Loss: 0.0739116 Vali Loss: 0.0882050 Test Loss: 0.1001214
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0727411
	speed: 0.0325s/iter; left time: 510.4227s
	iters: 200, epoch: 31 | loss: 0.0782608
	speed: 0.0148s/iter; left time: 231.0673s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.50s
Steps: 226 | Train Loss: 0.0738956 Vali Loss: 0.0881337 Test Loss: 0.1001574
Validation loss decreased (0.088185 --> 0.088134).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0693213
	speed: 0.0345s/iter; left time: 535.1526s
	iters: 200, epoch: 32 | loss: 0.0733726
	speed: 0.0147s/iter; left time: 227.0711s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.67s
Steps: 226 | Train Loss: 0.0739038 Vali Loss: 0.0881182 Test Loss: 0.1001412
Validation loss decreased (0.088134 --> 0.088118).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0727043
	speed: 0.0332s/iter; left time: 507.4772s
	iters: 200, epoch: 33 | loss: 0.0756064
	speed: 0.0149s/iter; left time: 226.2775s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.70s
Steps: 226 | Train Loss: 0.0738486 Vali Loss: 0.0881378 Test Loss: 0.1001345
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0697464
	speed: 0.0327s/iter; left time: 491.7849s
	iters: 200, epoch: 34 | loss: 0.0767846
	speed: 0.0152s/iter; left time: 227.8124s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.61s
Steps: 226 | Train Loss: 0.0738271 Vali Loss: 0.0880433 Test Loss: 0.1000919
Validation loss decreased (0.088118 --> 0.088043).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0740372
	speed: 0.0324s/iter; left time: 480.5610s
	iters: 200, epoch: 35 | loss: 0.0748931
	speed: 0.0150s/iter; left time: 221.2908s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.61s
Steps: 226 | Train Loss: 0.0737723 Vali Loss: 0.0881123 Test Loss: 0.1001010
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0736170
	speed: 0.0352s/iter; left time: 514.2756s
	iters: 200, epoch: 36 | loss: 0.0743167
	speed: 0.0152s/iter; left time: 220.4442s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0738238 Vali Loss: 0.0880142 Test Loss: 0.1001303
Validation loss decreased (0.088043 --> 0.088014).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0735850
	speed: 0.0364s/iter; left time: 522.8827s
	iters: 200, epoch: 37 | loss: 0.0743387
	speed: 0.0150s/iter; left time: 214.1146s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.72s
Steps: 226 | Train Loss: 0.0738114 Vali Loss: 0.0880951 Test Loss: 0.1000949
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0743272
	speed: 0.0326s/iter; left time: 460.5040s
	iters: 200, epoch: 38 | loss: 0.0732567
	speed: 0.0148s/iter; left time: 207.7039s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.0737474 Vali Loss: 0.0880771 Test Loss: 0.1000663
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0693054
	speed: 0.0360s/iter; left time: 500.4227s
	iters: 200, epoch: 39 | loss: 0.0733643
	speed: 0.0176s/iter; left time: 243.4836s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0738039 Vali Loss: 0.0882132 Test Loss: 0.1000884
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0703399
	speed: 0.0381s/iter; left time: 521.7610s
	iters: 200, epoch: 40 | loss: 0.0768747
	speed: 0.0187s/iter; left time: 254.5869s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.48s
Steps: 226 | Train Loss: 0.0737794 Vali Loss: 0.0880865 Test Loss: 0.1000977
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0724354
	speed: 0.0356s/iter; left time: 479.7915s
	iters: 200, epoch: 41 | loss: 0.0733097
	speed: 0.0160s/iter; left time: 213.7762s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0737165 Vali Loss: 0.0880635 Test Loss: 0.1001283
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0742350
	speed: 0.0364s/iter; left time: 481.8759s
	iters: 200, epoch: 42 | loss: 0.0694430
	speed: 0.0147s/iter; left time: 192.8972s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0737438 Vali Loss: 0.0880835 Test Loss: 0.1000885
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0779440
	speed: 0.0332s/iter; left time: 431.7426s
	iters: 200, epoch: 43 | loss: 0.0749396
	speed: 0.0147s/iter; left time: 189.6483s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.56s
Steps: 226 | Train Loss: 0.0737518 Vali Loss: 0.0880366 Test Loss: 0.1000987
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0714604
	speed: 0.0332s/iter; left time: 424.0469s
	iters: 200, epoch: 44 | loss: 0.0757622
	speed: 0.0148s/iter; left time: 188.2204s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.58s
Steps: 226 | Train Loss: 0.0737035 Vali Loss: 0.0881269 Test Loss: 0.1000961
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0767419
	speed: 0.0358s/iter; left time: 449.1202s
	iters: 200, epoch: 45 | loss: 0.0718795
	speed: 0.0192s/iter; left time: 239.1418s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0737914 Vali Loss: 0.0881576 Test Loss: 0.1000799
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0765565
	speed: 0.0342s/iter; left time: 422.1977s
	iters: 200, epoch: 46 | loss: 0.0712216
	speed: 0.0148s/iter; left time: 181.5739s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.59s
Steps: 226 | Train Loss: 0.0736830 Vali Loss: 0.0880687 Test Loss: 0.1001025
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_24_GB_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025458605960011482, rmse:0.1595575362443924, mae:0.1001303642988205, rse:0.5504282712936401
Use GPU: cuda:0
>>>>>>>start training : GB_168_24_GB_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1299379
	speed: 0.0211s/iter; left time: 475.0637s
	iters: 200, epoch: 1 | loss: 0.1275410
	speed: 0.0149s/iter; left time: 334.1089s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.16s
Steps: 226 | Train Loss: 0.1308100 Vali Loss: 0.1222478 Test Loss: 0.1417705
Validation loss decreased (inf --> 0.122248).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0886318
	speed: 0.0346s/iter; left time: 769.9040s
	iters: 200, epoch: 2 | loss: 0.0795489
	speed: 0.0147s/iter; left time: 326.9696s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.63s
Steps: 226 | Train Loss: 0.0874953 Vali Loss: 0.0923675 Test Loss: 0.1036771
Validation loss decreased (0.122248 --> 0.092367).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0793882
	speed: 0.0359s/iter; left time: 791.0130s
	iters: 200, epoch: 3 | loss: 0.0739622
	speed: 0.0155s/iter; left time: 341.2243s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.83s
Steps: 226 | Train Loss: 0.0803336 Vali Loss: 0.0912035 Test Loss: 0.1025618
Validation loss decreased (0.092367 --> 0.091204).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0770089
	speed: 0.0349s/iter; left time: 762.1679s
	iters: 200, epoch: 4 | loss: 0.0781828
	speed: 0.0168s/iter; left time: 365.5980s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0788796 Vali Loss: 0.0909087 Test Loss: 0.1021345
Validation loss decreased (0.091204 --> 0.090909).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0836506
	speed: 0.0358s/iter; left time: 772.5072s
	iters: 200, epoch: 5 | loss: 0.0713013
	speed: 0.0164s/iter; left time: 351.8181s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.95s
Steps: 226 | Train Loss: 0.0779398 Vali Loss: 0.0901915 Test Loss: 0.1018874
Validation loss decreased (0.090909 --> 0.090192).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0814649
	speed: 0.0365s/iter; left time: 779.4728s
	iters: 200, epoch: 6 | loss: 0.0717318
	speed: 0.0152s/iter; left time: 323.8941s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.03s
Steps: 226 | Train Loss: 0.0774009 Vali Loss: 0.0898792 Test Loss: 0.1014808
Validation loss decreased (0.090192 --> 0.089879).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0731443
	speed: 0.0381s/iter; left time: 806.6344s
	iters: 200, epoch: 7 | loss: 0.0849989
	speed: 0.0211s/iter; left time: 445.0830s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.70s
Steps: 226 | Train Loss: 0.0768103 Vali Loss: 0.0896169 Test Loss: 0.1012145
Validation loss decreased (0.089879 --> 0.089617).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0767947
	speed: 0.0367s/iter; left time: 766.7318s
	iters: 200, epoch: 8 | loss: 0.0805392
	speed: 0.0162s/iter; left time: 337.6272s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.16s
Steps: 226 | Train Loss: 0.0764402 Vali Loss: 0.0894719 Test Loss: 0.1012099
Validation loss decreased (0.089617 --> 0.089472).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0757468
	speed: 0.0379s/iter; left time: 783.9103s
	iters: 200, epoch: 9 | loss: 0.0773815
	speed: 0.0207s/iter; left time: 425.5844s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.60s
Steps: 226 | Train Loss: 0.0761080 Vali Loss: 0.0896265 Test Loss: 0.1009124
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0765713
	speed: 0.0390s/iter; left time: 798.4415s
	iters: 200, epoch: 10 | loss: 0.0686516
	speed: 0.0203s/iter; left time: 414.0983s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.72s
Steps: 226 | Train Loss: 0.0758771 Vali Loss: 0.0890902 Test Loss: 0.1008138
Validation loss decreased (0.089472 --> 0.089090).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0744935
	speed: 0.0357s/iter; left time: 722.1835s
	iters: 200, epoch: 11 | loss: 0.0698684
	speed: 0.0150s/iter; left time: 302.8401s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.66s
Steps: 226 | Train Loss: 0.0755856 Vali Loss: 0.0890289 Test Loss: 0.1007839
Validation loss decreased (0.089090 --> 0.089029).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0681625
	speed: 0.0353s/iter; left time: 705.6890s
	iters: 200, epoch: 12 | loss: 0.0767795
	speed: 0.0165s/iter; left time: 328.8685s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.07s
Steps: 226 | Train Loss: 0.0753697 Vali Loss: 0.0887901 Test Loss: 0.1009245
Validation loss decreased (0.089029 --> 0.088790).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0727203
	speed: 0.0346s/iter; left time: 685.5272s
	iters: 200, epoch: 13 | loss: 0.0751047
	speed: 0.0151s/iter; left time: 298.0573s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.62s
Steps: 226 | Train Loss: 0.0752134 Vali Loss: 0.0887878 Test Loss: 0.1005532
Validation loss decreased (0.088790 --> 0.088788).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0849499
	speed: 0.0327s/iter; left time: 640.0149s
	iters: 200, epoch: 14 | loss: 0.0722159
	speed: 0.0147s/iter; left time: 286.6854s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.54s
Steps: 226 | Train Loss: 0.0749800 Vali Loss: 0.0888784 Test Loss: 0.1003572
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0731766
	speed: 0.0316s/iter; left time: 611.8467s
	iters: 200, epoch: 15 | loss: 0.0795646
	speed: 0.0148s/iter; left time: 285.0878s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.54s
Steps: 226 | Train Loss: 0.0748853 Vali Loss: 0.0886995 Test Loss: 0.1003053
Validation loss decreased (0.088788 --> 0.088700).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0797883
	speed: 0.0378s/iter; left time: 722.9744s
	iters: 200, epoch: 16 | loss: 0.0785311
	speed: 0.0166s/iter; left time: 315.0898s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.0747140 Vali Loss: 0.0885486 Test Loss: 0.1003760
Validation loss decreased (0.088700 --> 0.088549).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0766100
	speed: 0.0390s/iter; left time: 735.8959s
	iters: 200, epoch: 17 | loss: 0.0713198
	speed: 0.0155s/iter; left time: 290.4874s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.37s
Steps: 226 | Train Loss: 0.0745887 Vali Loss: 0.0883946 Test Loss: 0.1003597
Validation loss decreased (0.088549 --> 0.088395).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0718078
	speed: 0.0355s/iter; left time: 661.6344s
	iters: 200, epoch: 18 | loss: 0.0747818
	speed: 0.0149s/iter; left time: 277.2560s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.68s
Steps: 226 | Train Loss: 0.0745034 Vali Loss: 0.0884246 Test Loss: 0.1004869
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0739261
	speed: 0.0328s/iter; left time: 604.6951s
	iters: 200, epoch: 19 | loss: 0.0768519
	speed: 0.0148s/iter; left time: 270.9492s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.55s
Steps: 226 | Train Loss: 0.0743887 Vali Loss: 0.0882176 Test Loss: 0.1004880
Validation loss decreased (0.088395 --> 0.088218).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0724575
	speed: 0.0351s/iter; left time: 639.6548s
	iters: 200, epoch: 20 | loss: 0.0703330
	speed: 0.0179s/iter; left time: 323.6623s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0742888 Vali Loss: 0.0882550 Test Loss: 0.1003058
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0749832
	speed: 0.0358s/iter; left time: 644.2972s
	iters: 200, epoch: 21 | loss: 0.0722545
	speed: 0.0168s/iter; left time: 300.4694s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.99s
Steps: 226 | Train Loss: 0.0742666 Vali Loss: 0.0883987 Test Loss: 0.1002589
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0743824
	speed: 0.0380s/iter; left time: 675.0969s
	iters: 200, epoch: 22 | loss: 0.0727077
	speed: 0.0164s/iter; left time: 288.8293s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0741849 Vali Loss: 0.0884717 Test Loss: 0.1003307
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0725270
	speed: 0.0364s/iter; left time: 638.3954s
	iters: 200, epoch: 23 | loss: 0.0761230
	speed: 0.0156s/iter; left time: 271.9287s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.03s
Steps: 226 | Train Loss: 0.0741284 Vali Loss: 0.0883142 Test Loss: 0.1002705
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0769574
	speed: 0.0338s/iter; left time: 585.1179s
	iters: 200, epoch: 24 | loss: 0.0711329
	speed: 0.0149s/iter; left time: 255.6183s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.71s
Steps: 226 | Train Loss: 0.0740526 Vali Loss: 0.0882026 Test Loss: 0.1002394
Validation loss decreased (0.088218 --> 0.088203).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0785076
	speed: 0.0363s/iter; left time: 619.5563s
	iters: 200, epoch: 25 | loss: 0.0712431
	speed: 0.0181s/iter; left time: 307.2590s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.36s
Steps: 226 | Train Loss: 0.0740483 Vali Loss: 0.0882465 Test Loss: 0.1003153
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0716059
	speed: 0.0335s/iter; left time: 564.3508s
	iters: 200, epoch: 26 | loss: 0.0759152
	speed: 0.0150s/iter; left time: 251.1072s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.0739681 Vali Loss: 0.0882726 Test Loss: 0.1000976
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0750724
	speed: 0.0315s/iter; left time: 524.4293s
	iters: 200, epoch: 27 | loss: 0.0754104
	speed: 0.0148s/iter; left time: 243.9696s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.53s
Steps: 226 | Train Loss: 0.0739455 Vali Loss: 0.0881110 Test Loss: 0.1002562
Validation loss decreased (0.088203 --> 0.088111).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0758224
	speed: 0.0345s/iter; left time: 565.3009s
	iters: 200, epoch: 28 | loss: 0.0766049
	speed: 0.0178s/iter; left time: 289.7150s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.10s
Steps: 226 | Train Loss: 0.0739173 Vali Loss: 0.0882354 Test Loss: 0.1001683
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0708620
	speed: 0.0402s/iter; left time: 649.9362s
	iters: 200, epoch: 29 | loss: 0.0762078
	speed: 0.0217s/iter; left time: 349.1907s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.10s
Steps: 226 | Train Loss: 0.0739167 Vali Loss: 0.0882121 Test Loss: 0.1001651
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0749271
	speed: 0.0420s/iter; left time: 670.2582s
	iters: 200, epoch: 30 | loss: 0.0734478
	speed: 0.0223s/iter; left time: 353.9452s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.13s
Steps: 226 | Train Loss: 0.0738925 Vali Loss: 0.0882489 Test Loss: 0.1001061
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0736174
	speed: 0.0342s/iter; left time: 537.5242s
	iters: 200, epoch: 31 | loss: 0.0758822
	speed: 0.0151s/iter; left time: 235.7530s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.63s
Steps: 226 | Train Loss: 0.0738126 Vali Loss: 0.0881726 Test Loss: 0.1001027
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0762339
	speed: 0.0348s/iter; left time: 539.2509s
	iters: 200, epoch: 32 | loss: 0.0719958
	speed: 0.0150s/iter; left time: 231.2703s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.79s
Steps: 226 | Train Loss: 0.0738045 Vali Loss: 0.0881914 Test Loss: 0.1000991
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0720251
	speed: 0.0324s/iter; left time: 494.9373s
	iters: 200, epoch: 33 | loss: 0.0768513
	speed: 0.0149s/iter; left time: 225.9949s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.57s
Steps: 226 | Train Loss: 0.0738133 Vali Loss: 0.0880187 Test Loss: 0.1001144
Validation loss decreased (0.088111 --> 0.088019).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0787433
	speed: 0.0383s/iter; left time: 576.7804s
	iters: 200, epoch: 34 | loss: 0.0745010
	speed: 0.0196s/iter; left time: 293.0425s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.68s
Steps: 226 | Train Loss: 0.0737879 Vali Loss: 0.0880583 Test Loss: 0.1001430
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0743883
	speed: 0.0329s/iter; left time: 488.0103s
	iters: 200, epoch: 35 | loss: 0.0735667
	speed: 0.0164s/iter; left time: 241.0911s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0737276 Vali Loss: 0.0881054 Test Loss: 0.1001485
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0694856
	speed: 0.0350s/iter; left time: 509.9782s
	iters: 200, epoch: 36 | loss: 0.0743685
	speed: 0.0155s/iter; left time: 224.3093s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.85s
Steps: 226 | Train Loss: 0.0737488 Vali Loss: 0.0881350 Test Loss: 0.1001791
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0712377
	speed: 0.0356s/iter; left time: 510.7199s
	iters: 200, epoch: 37 | loss: 0.0748500
	speed: 0.0184s/iter; left time: 262.6718s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.18s
Steps: 226 | Train Loss: 0.0737391 Vali Loss: 0.0880918 Test Loss: 0.1001669
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0725543
	speed: 0.0372s/iter; left time: 525.7316s
	iters: 200, epoch: 38 | loss: 0.0687990
	speed: 0.0157s/iter; left time: 220.1571s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.14s
Steps: 226 | Train Loss: 0.0737394 Vali Loss: 0.0881696 Test Loss: 0.1001650
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0725478
	speed: 0.0346s/iter; left time: 480.8865s
	iters: 200, epoch: 39 | loss: 0.0692375
	speed: 0.0193s/iter; left time: 266.6832s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.33s
Steps: 226 | Train Loss: 0.0736793 Vali Loss: 0.0880255 Test Loss: 0.1001555
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0699850
	speed: 0.0391s/iter; left time: 535.3959s
	iters: 200, epoch: 40 | loss: 0.0763473
	speed: 0.0185s/iter; left time: 251.8716s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0736832 Vali Loss: 0.0882237 Test Loss: 0.1001549
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0755943
	speed: 0.0406s/iter; left time: 546.5201s
	iters: 200, epoch: 41 | loss: 0.0742840
	speed: 0.0224s/iter; left time: 299.1233s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.33s
Steps: 226 | Train Loss: 0.0736210 Vali Loss: 0.0880303 Test Loss: 0.1001531
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0724656
	speed: 0.0352s/iter; left time: 466.5144s
	iters: 200, epoch: 42 | loss: 0.0697383
	speed: 0.0166s/iter; left time: 218.2411s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.90s
Steps: 226 | Train Loss: 0.0736599 Vali Loss: 0.0880839 Test Loss: 0.1001138
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0706227
	speed: 0.0346s/iter; left time: 450.6407s
	iters: 200, epoch: 43 | loss: 0.0782978
	speed: 0.0196s/iter; left time: 252.9548s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.48s
Steps: 226 | Train Loss: 0.0736657 Vali Loss: 0.0880406 Test Loss: 0.1001322
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_24_GB_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025257881730794907, rmse:0.1589272916316986, mae:0.10011441260576248, rse:0.5482540726661682
Intermediate time for GB and pred_len 24: 00h:07m:55.59s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_168_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_168_96_GB_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1432486
	speed: 0.0433s/iter; left time: 969.2891s
	iters: 200, epoch: 1 | loss: 0.1336714
	speed: 0.0149s/iter; left time: 332.6764s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.87s
Steps: 225 | Train Loss: 0.1440825 Vali Loss: 0.1380730 Test Loss: 0.1636122
Validation loss decreased (inf --> 0.138073).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1100838
	speed: 0.0342s/iter; left time: 757.4684s
	iters: 200, epoch: 2 | loss: 0.1123376
	speed: 0.0150s/iter; left time: 330.7857s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.1121373 Vali Loss: 0.1199572 Test Loss: 0.1431091
Validation loss decreased (0.138073 --> 0.119957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1075862
	speed: 0.0347s/iter; left time: 760.6842s
	iters: 200, epoch: 3 | loss: 0.1033198
	speed: 0.0152s/iter; left time: 331.1744s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.65s
Steps: 225 | Train Loss: 0.1063111 Vali Loss: 0.1183126 Test Loss: 0.1420789
Validation loss decreased (0.119957 --> 0.118313).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1024592
	speed: 0.0350s/iter; left time: 760.0231s
	iters: 200, epoch: 4 | loss: 0.1038170
	speed: 0.0190s/iter; left time: 410.6695s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.32s
Steps: 225 | Train Loss: 0.1047231 Vali Loss: 0.1184994 Test Loss: 0.1432469
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1062332
	speed: 0.0384s/iter; left time: 825.9961s
	iters: 200, epoch: 5 | loss: 0.1022250
	speed: 0.0228s/iter; left time: 488.7446s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.72s
Steps: 225 | Train Loss: 0.1038286 Vali Loss: 0.1181398 Test Loss: 0.1429648
Validation loss decreased (0.118313 --> 0.118140).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1065187
	speed: 0.0390s/iter; left time: 829.3336s
	iters: 200, epoch: 6 | loss: 0.1032488
	speed: 0.0190s/iter; left time: 402.3874s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.1031733 Vali Loss: 0.1179559 Test Loss: 0.1427092
Validation loss decreased (0.118140 --> 0.117956).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0992134
	speed: 0.0424s/iter; left time: 892.8995s
	iters: 200, epoch: 7 | loss: 0.1032226
	speed: 0.0194s/iter; left time: 406.8279s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.80s
Steps: 225 | Train Loss: 0.1026534 Vali Loss: 0.1179666 Test Loss: 0.1436215
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1001497
	speed: 0.0335s/iter; left time: 697.4606s
	iters: 200, epoch: 8 | loss: 0.1063705
	speed: 0.0153s/iter; left time: 316.9643s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.64s
Steps: 225 | Train Loss: 0.1021949 Vali Loss: 0.1178256 Test Loss: 0.1436705
Validation loss decreased (0.117956 --> 0.117826).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1031673
	speed: 0.0388s/iter; left time: 798.3675s
	iters: 200, epoch: 9 | loss: 0.1014487
	speed: 0.0200s/iter; left time: 409.6926s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.67s
Steps: 225 | Train Loss: 0.1017360 Vali Loss: 0.1180316 Test Loss: 0.1442261
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1037467
	speed: 0.0386s/iter; left time: 786.9086s
	iters: 200, epoch: 10 | loss: 0.1027923
	speed: 0.0177s/iter; left time: 358.7770s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.1014511 Vali Loss: 0.1187993 Test Loss: 0.1454186
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0971863
	speed: 0.0350s/iter; left time: 706.0033s
	iters: 200, epoch: 11 | loss: 0.1066962
	speed: 0.0170s/iter; left time: 341.7040s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.1011792 Vali Loss: 0.1179904 Test Loss: 0.1447006
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0974395
	speed: 0.0364s/iter; left time: 724.5687s
	iters: 200, epoch: 12 | loss: 0.1026871
	speed: 0.0169s/iter; left time: 335.6754s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.1009035 Vali Loss: 0.1181274 Test Loss: 0.1444180
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0988215
	speed: 0.0365s/iter; left time: 720.0462s
	iters: 200, epoch: 13 | loss: 0.0990030
	speed: 0.0156s/iter; left time: 304.9810s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.00s
Steps: 225 | Train Loss: 0.1006301 Vali Loss: 0.1185747 Test Loss: 0.1452403
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1004764
	speed: 0.0347s/iter; left time: 676.3641s
	iters: 200, epoch: 14 | loss: 0.1026148
	speed: 0.0189s/iter; left time: 365.7902s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.1004318 Vali Loss: 0.1184490 Test Loss: 0.1451024
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0977727
	speed: 0.0344s/iter; left time: 661.6612s
	iters: 200, epoch: 15 | loss: 0.0959741
	speed: 0.0161s/iter; left time: 308.3490s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.1002692 Vali Loss: 0.1184843 Test Loss: 0.1451076
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0966277
	speed: 0.0356s/iter; left time: 677.4609s
	iters: 200, epoch: 16 | loss: 0.1025084
	speed: 0.0174s/iter; left time: 328.6050s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.1000582 Vali Loss: 0.1184273 Test Loss: 0.1450801
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0983456
	speed: 0.0350s/iter; left time: 657.3731s
	iters: 200, epoch: 17 | loss: 0.0992725
	speed: 0.0163s/iter; left time: 305.4491s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0997954 Vali Loss: 0.1189902 Test Loss: 0.1460390
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1034021
	speed: 0.0345s/iter; left time: 641.1145s
	iters: 200, epoch: 18 | loss: 0.0961946
	speed: 0.0170s/iter; left time: 314.1375s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0996697 Vali Loss: 0.1185702 Test Loss: 0.1454241
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_96_GB_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04502221569418907, rmse:0.2121843844652176, mae:0.1436704397201538, rse:0.7337632179260254
Use GPU: cuda:0
>>>>>>>start training : GB_168_96_GB_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1483310
	speed: 0.0171s/iter; left time: 383.6728s
	iters: 200, epoch: 1 | loss: 0.1308554
	speed: 0.0152s/iter; left time: 339.2239s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.1445622 Vali Loss: 0.1381677 Test Loss: 0.1637920
Validation loss decreased (inf --> 0.138168).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1130186
	speed: 0.0359s/iter; left time: 795.3798s
	iters: 200, epoch: 2 | loss: 0.1083098
	speed: 0.0169s/iter; left time: 372.7533s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.1122220 Vali Loss: 0.1197145 Test Loss: 0.1430694
Validation loss decreased (0.138168 --> 0.119714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1004686
	speed: 0.0382s/iter; left time: 839.2659s
	iters: 200, epoch: 3 | loss: 0.1058460
	speed: 0.0174s/iter; left time: 381.1475s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.1065320 Vali Loss: 0.1191321 Test Loss: 0.1431164
Validation loss decreased (0.119714 --> 0.119132).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1067420
	speed: 0.0366s/iter; left time: 796.1413s
	iters: 200, epoch: 4 | loss: 0.1052855
	speed: 0.0173s/iter; left time: 373.1960s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.15s
Steps: 225 | Train Loss: 0.1051883 Vali Loss: 0.1185206 Test Loss: 0.1429021
Validation loss decreased (0.119132 --> 0.118521).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1020963
	speed: 0.0382s/iter; left time: 821.7015s
	iters: 200, epoch: 5 | loss: 0.1061885
	speed: 0.0175s/iter; left time: 373.8182s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.1042266 Vali Loss: 0.1179224 Test Loss: 0.1425153
Validation loss decreased (0.118521 --> 0.117922).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1019426
	speed: 0.0389s/iter; left time: 826.5984s
	iters: 200, epoch: 6 | loss: 0.0987578
	speed: 0.0173s/iter; left time: 365.7902s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.1034838 Vali Loss: 0.1178515 Test Loss: 0.1430858
Validation loss decreased (0.117922 --> 0.117851).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1048590
	speed: 0.0416s/iter; left time: 876.0780s
	iters: 200, epoch: 7 | loss: 0.1034662
	speed: 0.0181s/iter; left time: 379.6707s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.65s
Steps: 225 | Train Loss: 0.1028714 Vali Loss: 0.1178046 Test Loss: 0.1434703
Validation loss decreased (0.117851 --> 0.117805).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0960290
	speed: 0.0379s/iter; left time: 790.2719s
	iters: 200, epoch: 8 | loss: 0.0993760
	speed: 0.0191s/iter; left time: 395.6642s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.43s
Steps: 225 | Train Loss: 0.1023618 Vali Loss: 0.1179817 Test Loss: 0.1439923
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0982805
	speed: 0.0392s/iter; left time: 806.9582s
	iters: 200, epoch: 9 | loss: 0.1009188
	speed: 0.0190s/iter; left time: 390.4189s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.1019138 Vali Loss: 0.1181148 Test Loss: 0.1445342
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1027546
	speed: 0.0385s/iter; left time: 785.1390s
	iters: 200, epoch: 10 | loss: 0.0985924
	speed: 0.0171s/iter; left time: 345.8860s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.1015597 Vali Loss: 0.1182591 Test Loss: 0.1449339
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0938201
	speed: 0.0379s/iter; left time: 763.8042s
	iters: 200, epoch: 11 | loss: 0.1016373
	speed: 0.0160s/iter; left time: 321.7632s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.1012948 Vali Loss: 0.1179792 Test Loss: 0.1446447
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1054280
	speed: 0.0389s/iter; left time: 775.5564s
	iters: 200, epoch: 12 | loss: 0.0961260
	speed: 0.0179s/iter; left time: 355.6819s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.1010108 Vali Loss: 0.1181633 Test Loss: 0.1451541
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1007230
	speed: 0.0356s/iter; left time: 702.2664s
	iters: 200, epoch: 13 | loss: 0.1053447
	speed: 0.0166s/iter; left time: 325.2637s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.1008488 Vali Loss: 0.1179375 Test Loss: 0.1453492
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0957747
	speed: 0.0369s/iter; left time: 718.0869s
	iters: 200, epoch: 14 | loss: 0.1026282
	speed: 0.0170s/iter; left time: 329.2841s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.1005955 Vali Loss: 0.1181584 Test Loss: 0.1455183
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1030927
	speed: 0.0383s/iter; left time: 737.1703s
	iters: 200, epoch: 15 | loss: 0.1035435
	speed: 0.0158s/iter; left time: 303.2224s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.11s
Steps: 225 | Train Loss: 0.1004362 Vali Loss: 0.1177396 Test Loss: 0.1446944
Validation loss decreased (0.117805 --> 0.117740).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1024171
	speed: 0.0353s/iter; left time: 671.1995s
	iters: 200, epoch: 16 | loss: 0.1014723
	speed: 0.0152s/iter; left time: 287.4138s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.76s
Steps: 225 | Train Loss: 0.1002407 Vali Loss: 0.1181168 Test Loss: 0.1451479
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0950730
	speed: 0.0347s/iter; left time: 652.9884s
	iters: 200, epoch: 17 | loss: 0.1007550
	speed: 0.0180s/iter; left time: 337.5197s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.1001653 Vali Loss: 0.1176875 Test Loss: 0.1446122
Validation loss decreased (0.117740 --> 0.117687).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1016255
	speed: 0.0367s/iter; left time: 682.6580s
	iters: 200, epoch: 18 | loss: 0.1003857
	speed: 0.0153s/iter; left time: 281.9594s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0999799 Vali Loss: 0.1176812 Test Loss: 0.1449458
Validation loss decreased (0.117687 --> 0.117681).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0989775
	speed: 0.0395s/iter; left time: 725.5833s
	iters: 200, epoch: 19 | loss: 0.0949207
	speed: 0.0160s/iter; left time: 292.6276s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.24s
Steps: 225 | Train Loss: 0.0998343 Vali Loss: 0.1181190 Test Loss: 0.1450148
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1017841
	speed: 0.0383s/iter; left time: 694.4167s
	iters: 200, epoch: 20 | loss: 0.0993757
	speed: 0.0170s/iter; left time: 306.6744s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0997756 Vali Loss: 0.1178565 Test Loss: 0.1450385
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0974881
	speed: 0.0428s/iter; left time: 765.9095s
	iters: 200, epoch: 21 | loss: 0.1050698
	speed: 0.0217s/iter; left time: 386.1897s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0997030 Vali Loss: 0.1181531 Test Loss: 0.1456380
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0996484
	speed: 0.0409s/iter; left time: 722.2175s
	iters: 200, epoch: 22 | loss: 0.1009263
	speed: 0.0186s/iter; left time: 326.8560s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.0995709 Vali Loss: 0.1181348 Test Loss: 0.1454638
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0936366
	speed: 0.0403s/iter; left time: 703.4896s
	iters: 200, epoch: 23 | loss: 0.1032682
	speed: 0.0183s/iter; left time: 317.9539s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.53s
Steps: 225 | Train Loss: 0.0995458 Vali Loss: 0.1179884 Test Loss: 0.1451582
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0968743
	speed: 0.0390s/iter; left time: 671.3012s
	iters: 200, epoch: 24 | loss: 0.1019463
	speed: 0.0163s/iter; left time: 279.5855s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.0994681 Vali Loss: 0.1181457 Test Loss: 0.1455523
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.1061921
	speed: 0.0398s/iter; left time: 677.3985s
	iters: 200, epoch: 25 | loss: 0.0970668
	speed: 0.0199s/iter; left time: 336.2067s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.71s
Steps: 225 | Train Loss: 0.0994505 Vali Loss: 0.1180443 Test Loss: 0.1453885
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.1002892
	speed: 0.0412s/iter; left time: 691.8628s
	iters: 200, epoch: 26 | loss: 0.0993644
	speed: 0.0192s/iter; left time: 320.8476s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.70s
Steps: 225 | Train Loss: 0.0993534 Vali Loss: 0.1181938 Test Loss: 0.1455262
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0944799
	speed: 0.0407s/iter; left time: 673.0061s
	iters: 200, epoch: 27 | loss: 0.0981926
	speed: 0.0189s/iter; left time: 311.4854s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.57s
Steps: 225 | Train Loss: 0.0992863 Vali Loss: 0.1181367 Test Loss: 0.1452989
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0966076
	speed: 0.0408s/iter; left time: 665.8369s
	iters: 200, epoch: 28 | loss: 0.0948356
	speed: 0.0220s/iter; left time: 356.5191s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0992611 Vali Loss: 0.1181604 Test Loss: 0.1453564
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_96_GB_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04601024091243744, rmse:0.21449998021125793, mae:0.1449458748102188, rse:0.7417708039283752
Intermediate time for GB and pred_len 96: 00h:04m:25.96s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_168_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_168_168_GB_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1499535
	speed: 0.0401s/iter; left time: 897.4073s
	iters: 200, epoch: 1 | loss: 0.1275760
	speed: 0.0152s/iter; left time: 339.4661s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.1469418 Vali Loss: 0.1418786 Test Loss: 0.1676975
Validation loss decreased (inf --> 0.141879).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1141674
	speed: 0.0351s/iter; left time: 778.8829s
	iters: 200, epoch: 2 | loss: 0.1113455
	speed: 0.0186s/iter; left time: 409.5307s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.1173277 Vali Loss: 0.1255487 Test Loss: 0.1495915
Validation loss decreased (0.141879 --> 0.125549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1092727
	speed: 0.0367s/iter; left time: 805.8922s
	iters: 200, epoch: 3 | loss: 0.1134550
	speed: 0.0179s/iter; left time: 390.8818s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.1115658 Vali Loss: 0.1249689 Test Loss: 0.1503542
Validation loss decreased (0.125549 --> 0.124969).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1144803
	speed: 0.0372s/iter; left time: 807.4042s
	iters: 200, epoch: 4 | loss: 0.1094217
	speed: 0.0161s/iter; left time: 347.7464s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.1099271 Vali Loss: 0.1243636 Test Loss: 0.1502110
Validation loss decreased (0.124969 --> 0.124364).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1082388
	speed: 0.0361s/iter; left time: 776.3311s
	iters: 200, epoch: 5 | loss: 0.1077586
	speed: 0.0164s/iter; left time: 351.5746s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.1089903 Vali Loss: 0.1241797 Test Loss: 0.1502208
Validation loss decreased (0.124364 --> 0.124180).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1081436
	speed: 0.0350s/iter; left time: 744.8605s
	iters: 200, epoch: 6 | loss: 0.1119499
	speed: 0.0157s/iter; left time: 332.9786s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.1083248 Vali Loss: 0.1238742 Test Loss: 0.1504022
Validation loss decreased (0.124180 --> 0.123874).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1111545
	speed: 0.0391s/iter; left time: 822.6812s
	iters: 200, epoch: 7 | loss: 0.1063496
	speed: 0.0197s/iter; left time: 412.3867s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.50s
Steps: 225 | Train Loss: 0.1078107 Vali Loss: 0.1247523 Test Loss: 0.1519305
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1016383
	speed: 0.0358s/iter; left time: 746.1562s
	iters: 200, epoch: 8 | loss: 0.1076421
	speed: 0.0163s/iter; left time: 336.8992s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.1074174 Vali Loss: 0.1238740 Test Loss: 0.1508317
Validation loss decreased (0.123874 --> 0.123874).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1057409
	speed: 0.0407s/iter; left time: 839.0853s
	iters: 200, epoch: 9 | loss: 0.1076946
	speed: 0.0168s/iter; left time: 343.8315s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.1070738 Vali Loss: 0.1239253 Test Loss: 0.1512166
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1064644
	speed: 0.0368s/iter; left time: 750.1468s
	iters: 200, epoch: 10 | loss: 0.1061676
	speed: 0.0233s/iter; left time: 472.0747s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.1067472 Vali Loss: 0.1239237 Test Loss: 0.1517738
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1069961
	speed: 0.0412s/iter; left time: 830.6942s
	iters: 200, epoch: 11 | loss: 0.1058313
	speed: 0.0187s/iter; left time: 375.9255s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.66s
Steps: 225 | Train Loss: 0.1063631 Vali Loss: 0.1238796 Test Loss: 0.1516500
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1059460
	speed: 0.0358s/iter; left time: 713.4968s
	iters: 200, epoch: 12 | loss: 0.1064634
	speed: 0.0157s/iter; left time: 311.0609s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.69s
Steps: 225 | Train Loss: 0.1060945 Vali Loss: 0.1240394 Test Loss: 0.1517687
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1032645
	speed: 0.0358s/iter; left time: 704.3413s
	iters: 200, epoch: 13 | loss: 0.1023014
	speed: 0.0198s/iter; left time: 387.3759s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.1058933 Vali Loss: 0.1241398 Test Loss: 0.1517029
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1068519
	speed: 0.0363s/iter; left time: 706.8059s
	iters: 200, epoch: 14 | loss: 0.1030616
	speed: 0.0191s/iter; left time: 369.5819s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.34s
Steps: 225 | Train Loss: 0.1056087 Vali Loss: 0.1243978 Test Loss: 0.1522958
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1037581
	speed: 0.0354s/iter; left time: 680.9908s
	iters: 200, epoch: 15 | loss: 0.1031120
	speed: 0.0151s/iter; left time: 289.4574s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.60s
Steps: 225 | Train Loss: 0.1054437 Vali Loss: 0.1244598 Test Loss: 0.1526321
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1081312
	speed: 0.0348s/iter; left time: 661.3441s
	iters: 200, epoch: 16 | loss: 0.1071312
	speed: 0.0156s/iter; left time: 294.7698s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.75s
Steps: 225 | Train Loss: 0.1052283 Vali Loss: 0.1243807 Test Loss: 0.1525210
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1078316
	speed: 0.0349s/iter; left time: 656.4600s
	iters: 200, epoch: 17 | loss: 0.1053726
	speed: 0.0176s/iter; left time: 329.3581s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.16s
Steps: 225 | Train Loss: 0.1050940 Vali Loss: 0.1245384 Test Loss: 0.1528213
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1060644
	speed: 0.0423s/iter; left time: 786.3323s
	iters: 200, epoch: 18 | loss: 0.1060730
	speed: 0.0174s/iter; left time: 321.1733s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.1049388 Vali Loss: 0.1245682 Test Loss: 0.1526806
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_168_GB_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.048577629029750824, rmse:0.22040332853794098, mae:0.1508316695690155, rse:0.7641699910163879
Use GPU: cuda:0
>>>>>>>start training : GB_168_168_GB_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1486480
	speed: 0.0205s/iter; left time: 458.7998s
	iters: 200, epoch: 1 | loss: 0.1346984
	speed: 0.0177s/iter; left time: 394.6057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.1462936 Vali Loss: 0.1413484 Test Loss: 0.1671238
Validation loss decreased (inf --> 0.141348).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1223506
	speed: 0.0409s/iter; left time: 907.1932s
	iters: 200, epoch: 2 | loss: 0.1111667
	speed: 0.0190s/iter; left time: 419.1111s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.65s
Steps: 225 | Train Loss: 0.1173274 Vali Loss: 0.1256820 Test Loss: 0.1498371
Validation loss decreased (0.141348 --> 0.125682).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1108388
	speed: 0.0367s/iter; left time: 805.4347s
	iters: 200, epoch: 3 | loss: 0.1082366
	speed: 0.0165s/iter; left time: 361.4048s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.1116993 Vali Loss: 0.1249393 Test Loss: 0.1492249
Validation loss decreased (0.125682 --> 0.124939).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1090657
	speed: 0.0378s/iter; left time: 820.9635s
	iters: 200, epoch: 4 | loss: 0.1095768
	speed: 0.0192s/iter; left time: 415.6230s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.1101767 Vali Loss: 0.1239666 Test Loss: 0.1496069
Validation loss decreased (0.124939 --> 0.123967).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1122283
	speed: 0.0367s/iter; left time: 788.3670s
	iters: 200, epoch: 5 | loss: 0.1103199
	speed: 0.0160s/iter; left time: 343.1005s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.83s
Steps: 225 | Train Loss: 0.1091507 Vali Loss: 0.1240546 Test Loss: 0.1494649
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1116899
	speed: 0.0360s/iter; left time: 766.3005s
	iters: 200, epoch: 6 | loss: 0.1087078
	speed: 0.0194s/iter; left time: 410.3360s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.1084126 Vali Loss: 0.1242108 Test Loss: 0.1503803
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1052423
	speed: 0.0364s/iter; left time: 766.0071s
	iters: 200, epoch: 7 | loss: 0.1058420
	speed: 0.0151s/iter; left time: 316.1324s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.1078158 Vali Loss: 0.1241233 Test Loss: 0.1499704
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1088142
	speed: 0.0420s/iter; left time: 874.5691s
	iters: 200, epoch: 8 | loss: 0.1080927
	speed: 0.0239s/iter; left time: 494.6900s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.46s
Steps: 225 | Train Loss: 0.1073037 Vali Loss: 0.1240906 Test Loss: 0.1502237
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1084523
	speed: 0.0389s/iter; left time: 801.1094s
	iters: 200, epoch: 9 | loss: 0.1062123
	speed: 0.0177s/iter; left time: 363.2328s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.10s
Steps: 225 | Train Loss: 0.1069074 Vali Loss: 0.1238233 Test Loss: 0.1508131
Validation loss decreased (0.123967 --> 0.123823).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1033939
	speed: 0.0372s/iter; left time: 758.7269s
	iters: 200, epoch: 10 | loss: 0.1022663
	speed: 0.0152s/iter; left time: 307.6453s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.1065447 Vali Loss: 0.1237250 Test Loss: 0.1507618
Validation loss decreased (0.123823 --> 0.123725).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1049054
	speed: 0.0390s/iter; left time: 786.1605s
	iters: 200, epoch: 11 | loss: 0.1089206
	speed: 0.0157s/iter; left time: 314.7496s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.1062916 Vali Loss: 0.1240461 Test Loss: 0.1506609
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1051058
	speed: 0.0399s/iter; left time: 796.0054s
	iters: 200, epoch: 12 | loss: 0.1044658
	speed: 0.0183s/iter; left time: 362.8448s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.1060037 Vali Loss: 0.1238396 Test Loss: 0.1518371
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1060486
	speed: 0.0357s/iter; left time: 703.7851s
	iters: 200, epoch: 13 | loss: 0.1043409
	speed: 0.0164s/iter; left time: 320.5286s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.84s
Steps: 225 | Train Loss: 0.1057808 Vali Loss: 0.1241505 Test Loss: 0.1515134
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1095880
	speed: 0.0367s/iter; left time: 713.9725s
	iters: 200, epoch: 14 | loss: 0.1056166
	speed: 0.0157s/iter; left time: 303.9256s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.86s
Steps: 225 | Train Loss: 0.1055283 Vali Loss: 0.1239597 Test Loss: 0.1517490
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1075236
	speed: 0.0366s/iter; left time: 705.3965s
	iters: 200, epoch: 15 | loss: 0.1062559
	speed: 0.0166s/iter; left time: 318.1343s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.02s
Steps: 225 | Train Loss: 0.1053117 Vali Loss: 0.1241924 Test Loss: 0.1519936
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1069865
	speed: 0.0389s/iter; left time: 740.6799s
	iters: 200, epoch: 16 | loss: 0.1052222
	speed: 0.0201s/iter; left time: 380.6572s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.72s
Steps: 225 | Train Loss: 0.1051655 Vali Loss: 0.1241199 Test Loss: 0.1524266
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1054700
	speed: 0.0390s/iter; left time: 732.6092s
	iters: 200, epoch: 17 | loss: 0.1039295
	speed: 0.0177s/iter; left time: 330.9364s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.1049739 Vali Loss: 0.1241205 Test Loss: 0.1521003
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1029889
	speed: 0.0363s/iter; left time: 673.9203s
	iters: 200, epoch: 18 | loss: 0.1077079
	speed: 0.0168s/iter; left time: 309.5799s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.1048550 Vali Loss: 0.1240906 Test Loss: 0.1522658
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1090901
	speed: 0.0406s/iter; left time: 744.7466s
	iters: 200, epoch: 19 | loss: 0.1001188
	speed: 0.0177s/iter; left time: 323.4291s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.1047448 Vali Loss: 0.1239998 Test Loss: 0.1522070
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1083529
	speed: 0.0390s/iter; left time: 706.6121s
	iters: 200, epoch: 20 | loss: 0.1003313
	speed: 0.0151s/iter; left time: 272.4803s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.1046049 Vali Loss: 0.1242627 Test Loss: 0.1523417
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_168_168_GB_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0486115999519825, rmse:0.22048038244247437, mae:0.15076184272766113, rse:0.7644371390342712
Intermediate time for GB and pred_len 168: 00h:03m:41.15sIntermediate time for GB: 00h:16m:02.70s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_168_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_168_24_ES_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1451550
	speed: 0.0395s/iter; left time: 888.7457s
	iters: 200, epoch: 1 | loss: 0.1177439
	speed: 0.0135s/iter; left time: 301.3651s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.37s
Steps: 226 | Train Loss: 0.1467837 Vali Loss: 0.1082984 Test Loss: 0.1226880
Validation loss decreased (inf --> 0.108298).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0765975
	speed: 0.0305s/iter; left time: 680.4632s
	iters: 200, epoch: 2 | loss: 0.0669800
	speed: 0.0169s/iter; left time: 373.9560s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.91s
Steps: 226 | Train Loss: 0.0798699 Vali Loss: 0.0656852 Test Loss: 0.0723652
Validation loss decreased (0.108298 --> 0.065685).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0679572
	speed: 0.0377s/iter; left time: 830.4263s
	iters: 200, epoch: 3 | loss: 0.0667502
	speed: 0.0229s/iter; left time: 502.0259s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.02s
Steps: 226 | Train Loss: 0.0679510 Vali Loss: 0.0617661 Test Loss: 0.0682334
Validation loss decreased (0.065685 --> 0.061766).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0635966
	speed: 0.0350s/iter; left time: 763.2318s
	iters: 200, epoch: 4 | loss: 0.0613056
	speed: 0.0183s/iter; left time: 397.5726s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.43s
Steps: 226 | Train Loss: 0.0647878 Vali Loss: 0.0594496 Test Loss: 0.0655302
Validation loss decreased (0.061766 --> 0.059450).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0638050
	speed: 0.0370s/iter; left time: 798.5349s
	iters: 200, epoch: 5 | loss: 0.0621530
	speed: 0.0200s/iter; left time: 429.1061s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.57s
Steps: 226 | Train Loss: 0.0625533 Vali Loss: 0.0581501 Test Loss: 0.0642101
Validation loss decreased (0.059450 --> 0.058150).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0599403
	speed: 0.0373s/iter; left time: 797.2017s
	iters: 200, epoch: 6 | loss: 0.0587380
	speed: 0.0200s/iter; left time: 426.1731s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.74s
Steps: 226 | Train Loss: 0.0610643 Vali Loss: 0.0572503 Test Loss: 0.0633823
Validation loss decreased (0.058150 --> 0.057250).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0577566
	speed: 0.0398s/iter; left time: 840.9181s
	iters: 200, epoch: 7 | loss: 0.0595189
	speed: 0.0215s/iter; left time: 452.3899s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.22s
Steps: 226 | Train Loss: 0.0599456 Vali Loss: 0.0565520 Test Loss: 0.0626068
Validation loss decreased (0.057250 --> 0.056552).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0583735
	speed: 0.0344s/iter; left time: 719.6524s
	iters: 200, epoch: 8 | loss: 0.0600804
	speed: 0.0155s/iter; left time: 323.5563s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.80s
Steps: 226 | Train Loss: 0.0591601 Vali Loss: 0.0560919 Test Loss: 0.0620987
Validation loss decreased (0.056552 --> 0.056092).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0583554
	speed: 0.0353s/iter; left time: 730.4459s
	iters: 200, epoch: 9 | loss: 0.0625408
	speed: 0.0158s/iter; left time: 324.4926s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0584560 Vali Loss: 0.0557185 Test Loss: 0.0616777
Validation loss decreased (0.056092 --> 0.055719).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0586190
	speed: 0.0380s/iter; left time: 778.4299s
	iters: 200, epoch: 10 | loss: 0.0579860
	speed: 0.0197s/iter; left time: 401.0224s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.77s
Steps: 226 | Train Loss: 0.0579441 Vali Loss: 0.0553816 Test Loss: 0.0612375
Validation loss decreased (0.055719 --> 0.055382).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0550162
	speed: 0.0354s/iter; left time: 717.1668s
	iters: 200, epoch: 11 | loss: 0.0574639
	speed: 0.0172s/iter; left time: 346.2872s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.12s
Steps: 226 | Train Loss: 0.0574571 Vali Loss: 0.0549510 Test Loss: 0.0610811
Validation loss decreased (0.055382 --> 0.054951).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0580048
	speed: 0.0352s/iter; left time: 703.7974s
	iters: 200, epoch: 12 | loss: 0.0585291
	speed: 0.0173s/iter; left time: 345.1191s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.25s
Steps: 226 | Train Loss: 0.0570274 Vali Loss: 0.0547696 Test Loss: 0.0606912
Validation loss decreased (0.054951 --> 0.054770).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0554573
	speed: 0.0340s/iter; left time: 673.3766s
	iters: 200, epoch: 13 | loss: 0.0591582
	speed: 0.0172s/iter; left time: 337.7085s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.21s
Steps: 226 | Train Loss: 0.0566880 Vali Loss: 0.0546194 Test Loss: 0.0605852
Validation loss decreased (0.054770 --> 0.054619).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0542542
	speed: 0.0369s/iter; left time: 721.0404s
	iters: 200, epoch: 14 | loss: 0.0572352
	speed: 0.0199s/iter; left time: 386.7894s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.65s
Steps: 226 | Train Loss: 0.0564119 Vali Loss: 0.0544218 Test Loss: 0.0603917
Validation loss decreased (0.054619 --> 0.054422).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0540660
	speed: 0.0353s/iter; left time: 681.8516s
	iters: 200, epoch: 15 | loss: 0.0574466
	speed: 0.0172s/iter; left time: 330.8605s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.26s
Steps: 226 | Train Loss: 0.0561427 Vali Loss: 0.0542233 Test Loss: 0.0602162
Validation loss decreased (0.054422 --> 0.054223).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0569734
	speed: 0.0354s/iter; left time: 676.9982s
	iters: 200, epoch: 16 | loss: 0.0520816
	speed: 0.0170s/iter; left time: 322.6875s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0559051 Vali Loss: 0.0542752 Test Loss: 0.0600648
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0512955
	speed: 0.0350s/iter; left time: 661.3820s
	iters: 200, epoch: 17 | loss: 0.0539228
	speed: 0.0192s/iter; left time: 361.4004s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.46s
Steps: 226 | Train Loss: 0.0556844 Vali Loss: 0.0540120 Test Loss: 0.0600547
Validation loss decreased (0.054223 --> 0.054012).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0542477
	speed: 0.0356s/iter; left time: 663.8737s
	iters: 200, epoch: 18 | loss: 0.0539086
	speed: 0.0175s/iter; left time: 324.7138s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0555654 Vali Loss: 0.0539356 Test Loss: 0.0599224
Validation loss decreased (0.054012 --> 0.053936).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0571002
	speed: 0.0365s/iter; left time: 673.3697s
	iters: 200, epoch: 19 | loss: 0.0550000
	speed: 0.0195s/iter; left time: 357.1438s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.67s
Steps: 226 | Train Loss: 0.0553925 Vali Loss: 0.0537290 Test Loss: 0.0598146
Validation loss decreased (0.053936 --> 0.053729).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0542098
	speed: 0.0336s/iter; left time: 612.3132s
	iters: 200, epoch: 20 | loss: 0.0565600
	speed: 0.0149s/iter; left time: 269.3857s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.0552582 Vali Loss: 0.0536194 Test Loss: 0.0596348
Validation loss decreased (0.053729 --> 0.053619).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0570835
	speed: 0.0300s/iter; left time: 538.8699s
	iters: 200, epoch: 21 | loss: 0.0525154
	speed: 0.0174s/iter; left time: 310.7551s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.83s
Steps: 226 | Train Loss: 0.0551466 Vali Loss: 0.0537754 Test Loss: 0.0597416
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0550864
	speed: 0.0319s/iter; left time: 566.1580s
	iters: 200, epoch: 22 | loss: 0.0529542
	speed: 0.0151s/iter; left time: 266.4800s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.76s
Steps: 226 | Train Loss: 0.0550331 Vali Loss: 0.0535485 Test Loss: 0.0595939
Validation loss decreased (0.053619 --> 0.053548).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0570377
	speed: 0.0327s/iter; left time: 573.6363s
	iters: 200, epoch: 23 | loss: 0.0554462
	speed: 0.0192s/iter; left time: 334.3308s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.29s
Steps: 226 | Train Loss: 0.0549571 Vali Loss: 0.0536868 Test Loss: 0.0597135
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0528872
	speed: 0.0315s/iter; left time: 544.7078s
	iters: 200, epoch: 24 | loss: 0.0580698
	speed: 0.0167s/iter; left time: 287.5093s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.93s
Steps: 226 | Train Loss: 0.0548983 Vali Loss: 0.0533693 Test Loss: 0.0593940
Validation loss decreased (0.053548 --> 0.053369).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0536186
	speed: 0.0309s/iter; left time: 527.9620s
	iters: 200, epoch: 25 | loss: 0.0545483
	speed: 0.0130s/iter; left time: 220.9203s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.25s
Steps: 226 | Train Loss: 0.0548395 Vali Loss: 0.0534591 Test Loss: 0.0594047
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0536943
	speed: 0.0284s/iter; left time: 479.1360s
	iters: 200, epoch: 26 | loss: 0.0547102
	speed: 0.0137s/iter; left time: 228.9919s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.25s
Steps: 226 | Train Loss: 0.0547063 Vali Loss: 0.0533696 Test Loss: 0.0594442
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0586530
	speed: 0.0287s/iter; left time: 477.2321s
	iters: 200, epoch: 27 | loss: 0.0519660
	speed: 0.0136s/iter; left time: 224.7275s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.31s
Steps: 226 | Train Loss: 0.0546750 Vali Loss: 0.0533953 Test Loss: 0.0594027
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0549270
	speed: 0.0294s/iter; left time: 481.3725s
	iters: 200, epoch: 28 | loss: 0.0517543
	speed: 0.0135s/iter; left time: 219.6915s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.32s
Steps: 226 | Train Loss: 0.0546615 Vali Loss: 0.0533006 Test Loss: 0.0593567
Validation loss decreased (0.053369 --> 0.053301).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0557347
	speed: 0.0290s/iter; left time: 468.2238s
	iters: 200, epoch: 29 | loss: 0.0538403
	speed: 0.0129s/iter; left time: 207.9327s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0546012 Vali Loss: 0.0533369 Test Loss: 0.0592920
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0516878
	speed: 0.0296s/iter; left time: 471.9321s
	iters: 200, epoch: 30 | loss: 0.0524874
	speed: 0.0136s/iter; left time: 215.9387s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.39s
Steps: 226 | Train Loss: 0.0545499 Vali Loss: 0.0533188 Test Loss: 0.0593219
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0556062
	speed: 0.0303s/iter; left time: 475.7911s
	iters: 200, epoch: 31 | loss: 0.0533224
	speed: 0.0139s/iter; left time: 216.5673s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.38s
Steps: 226 | Train Loss: 0.0545046 Vali Loss: 0.0533411 Test Loss: 0.0593881
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0547356
	speed: 0.0282s/iter; left time: 437.0103s
	iters: 200, epoch: 32 | loss: 0.0559356
	speed: 0.0142s/iter; left time: 218.5186s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.32s
Steps: 226 | Train Loss: 0.0544690 Vali Loss: 0.0532426 Test Loss: 0.0593208
Validation loss decreased (0.053301 --> 0.053243).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0555151
	speed: 0.0287s/iter; left time: 438.1923s
	iters: 200, epoch: 33 | loss: 0.0566518
	speed: 0.0133s/iter; left time: 202.2594s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.17s
Steps: 226 | Train Loss: 0.0544179 Vali Loss: 0.0533163 Test Loss: 0.0592986
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0558582
	speed: 0.0281s/iter; left time: 422.6046s
	iters: 200, epoch: 34 | loss: 0.0547988
	speed: 0.0132s/iter; left time: 197.2114s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.21s
Steps: 226 | Train Loss: 0.0544022 Vali Loss: 0.0532038 Test Loss: 0.0591519
Validation loss decreased (0.053243 --> 0.053204).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0563478
	speed: 0.0299s/iter; left time: 442.8674s
	iters: 200, epoch: 35 | loss: 0.0556942
	speed: 0.0118s/iter; left time: 173.6555s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0543788 Vali Loss: 0.0532233 Test Loss: 0.0592055
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0515261
	speed: 0.0282s/iter; left time: 411.0176s
	iters: 200, epoch: 36 | loss: 0.0552400
	speed: 0.0135s/iter; left time: 195.6948s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.24s
Steps: 226 | Train Loss: 0.0543355 Vali Loss: 0.0531696 Test Loss: 0.0591507
Validation loss decreased (0.053204 --> 0.053170).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0567131
	speed: 0.0290s/iter; left time: 417.2604s
	iters: 200, epoch: 37 | loss: 0.0568572
	speed: 0.0153s/iter; left time: 218.3924s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.52s
Steps: 226 | Train Loss: 0.0543303 Vali Loss: 0.0532427 Test Loss: 0.0592053
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0516365
	speed: 0.0281s/iter; left time: 397.9304s
	iters: 200, epoch: 38 | loss: 0.0545847
	speed: 0.0114s/iter; left time: 160.6859s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:02.93s
Steps: 226 | Train Loss: 0.0543382 Vali Loss: 0.0532185 Test Loss: 0.0591625
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0540008
	speed: 0.0277s/iter; left time: 385.6329s
	iters: 200, epoch: 39 | loss: 0.0528272
	speed: 0.0118s/iter; left time: 162.4769s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:02.80s
Steps: 226 | Train Loss: 0.0542832 Vali Loss: 0.0531784 Test Loss: 0.0591502
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0516087
	speed: 0.0261s/iter; left time: 357.7612s
	iters: 200, epoch: 40 | loss: 0.0524877
	speed: 0.0117s/iter; left time: 159.2040s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:02.80s
Steps: 226 | Train Loss: 0.0542918 Vali Loss: 0.0532291 Test Loss: 0.0591576
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0586451
	speed: 0.0272s/iter; left time: 365.4904s
	iters: 200, epoch: 41 | loss: 0.0575853
	speed: 0.0117s/iter; left time: 156.9834s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0542267 Vali Loss: 0.0530851 Test Loss: 0.0592127
Validation loss decreased (0.053170 --> 0.053085).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0498054
	speed: 0.0326s/iter; left time: 431.2476s
	iters: 200, epoch: 42 | loss: 0.0552870
	speed: 0.0123s/iter; left time: 161.0475s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.29s
Steps: 226 | Train Loss: 0.0543146 Vali Loss: 0.0531483 Test Loss: 0.0591471
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0503690
	speed: 0.0294s/iter; left time: 382.3126s
	iters: 200, epoch: 43 | loss: 0.0562914
	speed: 0.0128s/iter; left time: 165.7275s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.23s
Steps: 226 | Train Loss: 0.0542930 Vali Loss: 0.0531643 Test Loss: 0.0592036
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0539966
	speed: 0.0299s/iter; left time: 382.5697s
	iters: 200, epoch: 44 | loss: 0.0501583
	speed: 0.0130s/iter; left time: 164.5872s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.32s
Steps: 226 | Train Loss: 0.0542000 Vali Loss: 0.0531088 Test Loss: 0.0590504
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0574259
	speed: 0.0273s/iter; left time: 342.4563s
	iters: 200, epoch: 45 | loss: 0.0551004
	speed: 0.0111s/iter; left time: 138.0703s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0542018 Vali Loss: 0.0531857 Test Loss: 0.0591267
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0549353
	speed: 0.0265s/iter; left time: 326.4648s
	iters: 200, epoch: 46 | loss: 0.0492027
	speed: 0.0126s/iter; left time: 153.7117s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:02.95s
Steps: 226 | Train Loss: 0.0542488 Vali Loss: 0.0531209 Test Loss: 0.0592010
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0555106
	speed: 0.0269s/iter; left time: 325.1362s
	iters: 200, epoch: 47 | loss: 0.0540510
	speed: 0.0113s/iter; left time: 136.0794s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0542097 Vali Loss: 0.0531165 Test Loss: 0.0591204
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0553315
	speed: 0.0270s/iter; left time: 320.2321s
	iters: 200, epoch: 48 | loss: 0.0546300
	speed: 0.0114s/iter; left time: 134.4081s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:02.88s
Steps: 226 | Train Loss: 0.0541788 Vali Loss: 0.0531417 Test Loss: 0.0590926
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0549805
	speed: 0.0267s/iter; left time: 310.7206s
	iters: 200, epoch: 49 | loss: 0.0557395
	speed: 0.0112s/iter; left time: 128.9113s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:02.79s
Steps: 226 | Train Loss: 0.0541946 Vali Loss: 0.0531759 Test Loss: 0.0591419
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0542814
	speed: 0.0268s/iter; left time: 306.4461s
	iters: 200, epoch: 50 | loss: 0.0558326
	speed: 0.0137s/iter; left time: 155.4221s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:03.16s
Steps: 226 | Train Loss: 0.0541970 Vali Loss: 0.0531588 Test Loss: 0.0592191
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0540405
	speed: 0.0286s/iter; left time: 319.9939s
	iters: 200, epoch: 51 | loss: 0.0547026
	speed: 0.0130s/iter; left time: 144.2814s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:03.15s
Steps: 226 | Train Loss: 0.0541853 Vali Loss: 0.0531794 Test Loss: 0.0590807
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_24_ES_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009818107821047306, rmse:0.09908636659383774, mae:0.05921265855431557, rse:0.29159918427467346
Use GPU: cuda:0
>>>>>>>start training : ES_168_24_ES_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1507255
	speed: 0.0146s/iter; left time: 327.6570s
	iters: 200, epoch: 1 | loss: 0.1207082
	speed: 0.0143s/iter; left time: 319.5182s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.30s
Steps: 226 | Train Loss: 0.1465289 Vali Loss: 0.1071480 Test Loss: 0.1212301
Validation loss decreased (inf --> 0.107148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0785520
	speed: 0.0280s/iter; left time: 622.9595s
	iters: 200, epoch: 2 | loss: 0.0688930
	speed: 0.0117s/iter; left time: 259.3009s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:02.84s
Steps: 226 | Train Loss: 0.0799033 Vali Loss: 0.0661498 Test Loss: 0.0729442
Validation loss decreased (0.107148 --> 0.066150).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0675750
	speed: 0.0298s/iter; left time: 657.1261s
	iters: 200, epoch: 3 | loss: 0.0637515
	speed: 0.0114s/iter; left time: 249.2229s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0680635 Vali Loss: 0.0614426 Test Loss: 0.0683460
Validation loss decreased (0.066150 --> 0.061443).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0669186
	speed: 0.0290s/iter; left time: 633.9092s
	iters: 200, epoch: 4 | loss: 0.0643349
	speed: 0.0131s/iter; left time: 283.5528s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.19s
Steps: 226 | Train Loss: 0.0648668 Vali Loss: 0.0593724 Test Loss: 0.0657995
Validation loss decreased (0.061443 --> 0.059372).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0610497
	speed: 0.0305s/iter; left time: 658.0443s
	iters: 200, epoch: 5 | loss: 0.0619393
	speed: 0.0118s/iter; left time: 254.3407s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0626716 Vali Loss: 0.0577798 Test Loss: 0.0641355
Validation loss decreased (0.059372 --> 0.057780).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0614329
	speed: 0.0273s/iter; left time: 582.4532s
	iters: 200, epoch: 6 | loss: 0.0615167
	speed: 0.0124s/iter; left time: 263.1770s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0611074 Vali Loss: 0.0574545 Test Loss: 0.0633995
Validation loss decreased (0.057780 --> 0.057454).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0597643
	speed: 0.0283s/iter; left time: 599.3577s
	iters: 200, epoch: 7 | loss: 0.0607079
	speed: 0.0116s/iter; left time: 244.2328s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:02.87s
Steps: 226 | Train Loss: 0.0599273 Vali Loss: 0.0563146 Test Loss: 0.0625127
Validation loss decreased (0.057454 --> 0.056315).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0574845
	speed: 0.0285s/iter; left time: 596.6742s
	iters: 200, epoch: 8 | loss: 0.0590476
	speed: 0.0120s/iter; left time: 250.2880s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0590586 Vali Loss: 0.0560240 Test Loss: 0.0619528
Validation loss decreased (0.056315 --> 0.056024).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0639373
	speed: 0.0279s/iter; left time: 576.6687s
	iters: 200, epoch: 9 | loss: 0.0527270
	speed: 0.0118s/iter; left time: 242.8839s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:02.90s
Steps: 226 | Train Loss: 0.0583976 Vali Loss: 0.0554776 Test Loss: 0.0613036
Validation loss decreased (0.056024 --> 0.055478).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0565735
	speed: 0.0287s/iter; left time: 587.6593s
	iters: 200, epoch: 10 | loss: 0.0558760
	speed: 0.0118s/iter; left time: 240.1462s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0577687 Vali Loss: 0.0552871 Test Loss: 0.0610560
Validation loss decreased (0.055478 --> 0.055287).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0571113
	speed: 0.0293s/iter; left time: 592.0521s
	iters: 200, epoch: 11 | loss: 0.0566703
	speed: 0.0118s/iter; left time: 237.6151s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.09s
Steps: 226 | Train Loss: 0.0573187 Vali Loss: 0.0547834 Test Loss: 0.0607028
Validation loss decreased (0.055287 --> 0.054783).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0586570
	speed: 0.0273s/iter; left time: 547.2207s
	iters: 200, epoch: 12 | loss: 0.0570341
	speed: 0.0119s/iter; left time: 236.3911s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:02.94s
Steps: 226 | Train Loss: 0.0569485 Vali Loss: 0.0544821 Test Loss: 0.0604087
Validation loss decreased (0.054783 --> 0.054482).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0555787
	speed: 0.0303s/iter; left time: 599.0129s
	iters: 200, epoch: 13 | loss: 0.0562803
	speed: 0.0129s/iter; left time: 253.6387s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.35s
Steps: 226 | Train Loss: 0.0566200 Vali Loss: 0.0545550 Test Loss: 0.0603720
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0575179
	speed: 0.0300s/iter; left time: 587.0186s
	iters: 200, epoch: 14 | loss: 0.0569978
	speed: 0.0119s/iter; left time: 231.7979s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.11s
Steps: 226 | Train Loss: 0.0562737 Vali Loss: 0.0543751 Test Loss: 0.0601368
Validation loss decreased (0.054482 --> 0.054375).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0523732
	speed: 0.0262s/iter; left time: 507.0347s
	iters: 200, epoch: 15 | loss: 0.0562500
	speed: 0.0124s/iter; left time: 239.1976s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:02.82s
Steps: 226 | Train Loss: 0.0560525 Vali Loss: 0.0540945 Test Loss: 0.0599775
Validation loss decreased (0.054375 --> 0.054095).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0528089
	speed: 0.0271s/iter; left time: 517.4916s
	iters: 200, epoch: 16 | loss: 0.0597127
	speed: 0.0117s/iter; left time: 222.2026s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:02.92s
Steps: 226 | Train Loss: 0.0558022 Vali Loss: 0.0539221 Test Loss: 0.0597435
Validation loss decreased (0.054095 --> 0.053922).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0559879
	speed: 0.0289s/iter; left time: 545.5689s
	iters: 200, epoch: 17 | loss: 0.0581747
	speed: 0.0117s/iter; left time: 218.8945s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0556188 Vali Loss: 0.0539700 Test Loss: 0.0597727
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0555314
	speed: 0.0261s/iter; left time: 486.7138s
	iters: 200, epoch: 18 | loss: 0.0544397
	speed: 0.0110s/iter; left time: 203.5240s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:02.78s
Steps: 226 | Train Loss: 0.0554477 Vali Loss: 0.0536921 Test Loss: 0.0595935
Validation loss decreased (0.053922 --> 0.053692).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0524647
	speed: 0.0272s/iter; left time: 501.1017s
	iters: 200, epoch: 19 | loss: 0.0516993
	speed: 0.0121s/iter; left time: 221.9829s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0553181 Vali Loss: 0.0537883 Test Loss: 0.0596126
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0527550
	speed: 0.0291s/iter; left time: 529.7238s
	iters: 200, epoch: 20 | loss: 0.0565373
	speed: 0.0142s/iter; left time: 257.1261s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.31s
Steps: 226 | Train Loss: 0.0551740 Vali Loss: 0.0537758 Test Loss: 0.0596166
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0569603
	speed: 0.0264s/iter; left time: 474.5772s
	iters: 200, epoch: 21 | loss: 0.0545343
	speed: 0.0118s/iter; left time: 210.3655s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:02.78s
Steps: 226 | Train Loss: 0.0550889 Vali Loss: 0.0533999 Test Loss: 0.0594185
Validation loss decreased (0.053692 --> 0.053400).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0562903
	speed: 0.0269s/iter; left time: 477.0942s
	iters: 200, epoch: 22 | loss: 0.0577873
	speed: 0.0137s/iter; left time: 241.9848s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.01s
Steps: 226 | Train Loss: 0.0549383 Vali Loss: 0.0534308 Test Loss: 0.0593246
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0538595
	speed: 0.0284s/iter; left time: 498.1272s
	iters: 200, epoch: 23 | loss: 0.0566281
	speed: 0.0130s/iter; left time: 226.2498s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.05s
Steps: 226 | Train Loss: 0.0548749 Vali Loss: 0.0534087 Test Loss: 0.0593133
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0507098
	speed: 0.0292s/iter; left time: 504.9074s
	iters: 200, epoch: 24 | loss: 0.0538428
	speed: 0.0121s/iter; left time: 207.5786s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:02.93s
Steps: 226 | Train Loss: 0.0548080 Vali Loss: 0.0533418 Test Loss: 0.0593664
Validation loss decreased (0.053400 --> 0.053342).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0554929
	speed: 0.0276s/iter; left time: 471.6608s
	iters: 200, epoch: 25 | loss: 0.0567786
	speed: 0.0115s/iter; left time: 195.1835s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0546885 Vali Loss: 0.0534237 Test Loss: 0.0594419
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0548124
	speed: 0.0265s/iter; left time: 446.6148s
	iters: 200, epoch: 26 | loss: 0.0535798
	speed: 0.0110s/iter; left time: 183.6588s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:02.68s
Steps: 226 | Train Loss: 0.0546452 Vali Loss: 0.0533526 Test Loss: 0.0591975
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0557830
	speed: 0.0274s/iter; left time: 455.9417s
	iters: 200, epoch: 27 | loss: 0.0586098
	speed: 0.0135s/iter; left time: 222.7970s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.07s
Steps: 226 | Train Loss: 0.0545553 Vali Loss: 0.0533763 Test Loss: 0.0592641
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0546051
	speed: 0.0277s/iter; left time: 454.7507s
	iters: 200, epoch: 28 | loss: 0.0558206
	speed: 0.0126s/iter; left time: 204.6338s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.07s
Steps: 226 | Train Loss: 0.0545318 Vali Loss: 0.0532169 Test Loss: 0.0592011
Validation loss decreased (0.053342 --> 0.053217).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0563632
	speed: 0.0271s/iter; left time: 438.6456s
	iters: 200, epoch: 29 | loss: 0.0581273
	speed: 0.0125s/iter; left time: 200.6389s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0544601 Vali Loss: 0.0531060 Test Loss: 0.0591692
Validation loss decreased (0.053217 --> 0.053106).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0574518
	speed: 0.0266s/iter; left time: 424.1283s
	iters: 200, epoch: 30 | loss: 0.0555285
	speed: 0.0108s/iter; left time: 171.7217s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:02.69s
Steps: 226 | Train Loss: 0.0544499 Vali Loss: 0.0530576 Test Loss: 0.0590920
Validation loss decreased (0.053106 --> 0.053058).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0510666
	speed: 0.0274s/iter; left time: 431.2590s
	iters: 200, epoch: 31 | loss: 0.0540474
	speed: 0.0111s/iter; left time: 173.9952s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0544246 Vali Loss: 0.0533034 Test Loss: 0.0591211
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0568054
	speed: 0.0268s/iter; left time: 416.0011s
	iters: 200, epoch: 32 | loss: 0.0557136
	speed: 0.0116s/iter; left time: 178.5640s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:02.82s
Steps: 226 | Train Loss: 0.0543331 Vali Loss: 0.0531352 Test Loss: 0.0590774
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0552513
	speed: 0.0290s/iter; left time: 443.3887s
	iters: 200, epoch: 33 | loss: 0.0547300
	speed: 0.0120s/iter; left time: 181.6856s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0543432 Vali Loss: 0.0531316 Test Loss: 0.0590895
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0512971
	speed: 0.0261s/iter; left time: 392.2131s
	iters: 200, epoch: 34 | loss: 0.0529503
	speed: 0.0118s/iter; left time: 176.7132s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:02.83s
Steps: 226 | Train Loss: 0.0543068 Vali Loss: 0.0530512 Test Loss: 0.0591309
Validation loss decreased (0.053058 --> 0.053051).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0559119
	speed: 0.0271s/iter; left time: 401.2238s
	iters: 200, epoch: 35 | loss: 0.0545416
	speed: 0.0123s/iter; left time: 180.3106s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.02s
Steps: 226 | Train Loss: 0.0542706 Vali Loss: 0.0530420 Test Loss: 0.0589782
Validation loss decreased (0.053051 --> 0.053042).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0561696
	speed: 0.0283s/iter; left time: 412.9282s
	iters: 200, epoch: 36 | loss: 0.0561849
	speed: 0.0117s/iter; left time: 169.7662s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:02.95s
Steps: 226 | Train Loss: 0.0542947 Vali Loss: 0.0530133 Test Loss: 0.0590346
Validation loss decreased (0.053042 --> 0.053013).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0509262
	speed: 0.0275s/iter; left time: 394.9990s
	iters: 200, epoch: 37 | loss: 0.0508690
	speed: 0.0119s/iter; left time: 169.9204s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:02.91s
Steps: 226 | Train Loss: 0.0541840 Vali Loss: 0.0531005 Test Loss: 0.0591013
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0554777
	speed: 0.0279s/iter; left time: 394.2060s
	iters: 200, epoch: 38 | loss: 0.0548198
	speed: 0.0120s/iter; left time: 169.1098s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.03s
Steps: 226 | Train Loss: 0.0542373 Vali Loss: 0.0530459 Test Loss: 0.0589842
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0525637
	speed: 0.0294s/iter; left time: 408.4744s
	iters: 200, epoch: 39 | loss: 0.0543035
	speed: 0.0164s/iter; left time: 226.7572s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.77s
Steps: 226 | Train Loss: 0.0542141 Vali Loss: 0.0530863 Test Loss: 0.0589925
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0504019
	speed: 0.0292s/iter; left time: 399.6585s
	iters: 200, epoch: 40 | loss: 0.0561855
	speed: 0.0114s/iter; left time: 154.5823s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:02.83s
Steps: 226 | Train Loss: 0.0542050 Vali Loss: 0.0530611 Test Loss: 0.0590304
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0555407
	speed: 0.0284s/iter; left time: 382.3314s
	iters: 200, epoch: 41 | loss: 0.0573847
	speed: 0.0121s/iter; left time: 161.0054s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:02.85s
Steps: 226 | Train Loss: 0.0541970 Vali Loss: 0.0529732 Test Loss: 0.0589725
Validation loss decreased (0.053013 --> 0.052973).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0557087
	speed: 0.0262s/iter; left time: 347.2037s
	iters: 200, epoch: 42 | loss: 0.0507394
	speed: 0.0107s/iter; left time: 140.7004s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:02.70s
Steps: 226 | Train Loss: 0.0542100 Vali Loss: 0.0530530 Test Loss: 0.0589480
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0532187
	speed: 0.0280s/iter; left time: 364.2858s
	iters: 200, epoch: 43 | loss: 0.0522638
	speed: 0.0114s/iter; left time: 146.7772s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:02.84s
Steps: 226 | Train Loss: 0.0541853 Vali Loss: 0.0530456 Test Loss: 0.0589709
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0523888
	speed: 0.0294s/iter; left time: 376.4591s
	iters: 200, epoch: 44 | loss: 0.0555471
	speed: 0.0114s/iter; left time: 145.1637s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:02.90s
Steps: 226 | Train Loss: 0.0541429 Vali Loss: 0.0530979 Test Loss: 0.0590576
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0518244
	speed: 0.0268s/iter; left time: 336.3404s
	iters: 200, epoch: 45 | loss: 0.0573724
	speed: 0.0110s/iter; left time: 137.2029s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:02.79s
Steps: 226 | Train Loss: 0.0541446 Vali Loss: 0.0530079 Test Loss: 0.0589412
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0536192
	speed: 0.0274s/iter; left time: 338.2583s
	iters: 200, epoch: 46 | loss: 0.0520935
	speed: 0.0119s/iter; left time: 146.1002s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:02.95s
Steps: 226 | Train Loss: 0.0541448 Vali Loss: 0.0530503 Test Loss: 0.0589884
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0567641
	speed: 0.0258s/iter; left time: 312.7587s
	iters: 200, epoch: 47 | loss: 0.0499426
	speed: 0.0110s/iter; left time: 132.3000s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:02.70s
Steps: 226 | Train Loss: 0.0541792 Vali Loss: 0.0529625 Test Loss: 0.0589573
Validation loss decreased (0.052973 --> 0.052963).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0543365
	speed: 0.0311s/iter; left time: 369.0471s
	iters: 200, epoch: 48 | loss: 0.0528470
	speed: 0.0118s/iter; left time: 139.1361s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.00s
Steps: 226 | Train Loss: 0.0540931 Vali Loss: 0.0529664 Test Loss: 0.0589474
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0498530
	speed: 0.0266s/iter; left time: 309.8380s
	iters: 200, epoch: 49 | loss: 0.0562437
	speed: 0.0115s/iter; left time: 133.3083s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0541368 Vali Loss: 0.0529739 Test Loss: 0.0589651
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0547175
	speed: 0.0263s/iter; left time: 300.8490s
	iters: 200, epoch: 50 | loss: 0.0537487
	speed: 0.0108s/iter; left time: 122.8662s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:02.72s
Steps: 226 | Train Loss: 0.0540701 Vali Loss: 0.0530535 Test Loss: 0.0589779
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0549713
	speed: 0.0263s/iter; left time: 294.7595s
	iters: 200, epoch: 51 | loss: 0.0546206
	speed: 0.0119s/iter; left time: 131.8535s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:02.88s
Steps: 226 | Train Loss: 0.0541515 Vali Loss: 0.0530221 Test Loss: 0.0589595
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0527683
	speed: 0.0266s/iter; left time: 292.3650s
	iters: 200, epoch: 52 | loss: 0.0574221
	speed: 0.0120s/iter; left time: 130.9350s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:02.91s
Steps: 226 | Train Loss: 0.0541668 Vali Loss: 0.0530018 Test Loss: 0.0589725
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0534396
	speed: 0.0290s/iter; left time: 311.5190s
	iters: 200, epoch: 53 | loss: 0.0520115
	speed: 0.0114s/iter; left time: 121.6793s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:02.99s
Steps: 226 | Train Loss: 0.0540821 Vali Loss: 0.0530134 Test Loss: 0.0589416
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0542039
	speed: 0.0269s/iter; left time: 283.4755s
	iters: 200, epoch: 54 | loss: 0.0522672
	speed: 0.0119s/iter; left time: 124.2941s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:02.79s
Steps: 226 | Train Loss: 0.0541188 Vali Loss: 0.0530085 Test Loss: 0.0589848
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0503511
	speed: 0.0266s/iter; left time: 274.0105s
	iters: 200, epoch: 55 | loss: 0.0528312
	speed: 0.0115s/iter; left time: 117.1317s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:02.92s
Steps: 226 | Train Loss: 0.0540319 Vali Loss: 0.0529898 Test Loss: 0.0589086
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0524455
	speed: 0.0277s/iter; left time: 278.7486s
	iters: 200, epoch: 56 | loss: 0.0551980
	speed: 0.0115s/iter; left time: 114.6139s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:02.88s
Steps: 226 | Train Loss: 0.0541053 Vali Loss: 0.0529852 Test Loss: 0.0588668
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0554461
	speed: 0.0263s/iter; left time: 259.1786s
	iters: 200, epoch: 57 | loss: 0.0511636
	speed: 0.0109s/iter; left time: 106.5654s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:02.74s
Steps: 226 | Train Loss: 0.0540857 Vali Loss: 0.0530011 Test Loss: 0.0590005
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_24_ES_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009839903563261032, rmse:0.09919628500938416, mae:0.058957286179065704, rse:0.2919226884841919
Intermediate time for ES and pred_len 24: 00h:07m:56.18s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_168_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_168_96_ES_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1514326
	speed: 0.0397s/iter; left time: 889.9418s
	iters: 200, epoch: 1 | loss: 0.1340956
	speed: 0.0111s/iter; left time: 247.7902s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.22s
Steps: 225 | Train Loss: 0.1534535 Vali Loss: 0.1192981 Test Loss: 0.1362016
Validation loss decreased (inf --> 0.119298).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0992987
	speed: 0.0289s/iter; left time: 640.6691s
	iters: 200, epoch: 2 | loss: 0.0911604
	speed: 0.0132s/iter; left time: 291.7629s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.18s
Steps: 225 | Train Loss: 0.0996113 Vali Loss: 0.0870584 Test Loss: 0.0990485
Validation loss decreased (0.119298 --> 0.087058).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0860890
	speed: 0.0287s/iter; left time: 630.2518s
	iters: 200, epoch: 3 | loss: 0.0849074
	speed: 0.0134s/iter; left time: 292.4695s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.16s
Steps: 225 | Train Loss: 0.0886737 Vali Loss: 0.0814001 Test Loss: 0.0934050
Validation loss decreased (0.087058 --> 0.081400).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0801919
	speed: 0.0299s/iter; left time: 649.1137s
	iters: 200, epoch: 4 | loss: 0.0829801
	speed: 0.0112s/iter; left time: 241.7950s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:02.94s
Steps: 225 | Train Loss: 0.0853538 Vali Loss: 0.0797981 Test Loss: 0.0914087
Validation loss decreased (0.081400 --> 0.079798).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0849047
	speed: 0.0306s/iter; left time: 657.2593s
	iters: 200, epoch: 5 | loss: 0.0815262
	speed: 0.0136s/iter; left time: 291.6153s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.35s
Steps: 225 | Train Loss: 0.0834915 Vali Loss: 0.0786919 Test Loss: 0.0897241
Validation loss decreased (0.079798 --> 0.078692).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0793926
	speed: 0.0287s/iter; left time: 611.6769s
	iters: 200, epoch: 6 | loss: 0.0799922
	speed: 0.0113s/iter; left time: 238.2779s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:02.99s
Steps: 225 | Train Loss: 0.0820761 Vali Loss: 0.0781931 Test Loss: 0.0889015
Validation loss decreased (0.078692 --> 0.078193).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0787506
	speed: 0.0286s/iter; left time: 601.3436s
	iters: 200, epoch: 7 | loss: 0.0792138
	speed: 0.0109s/iter; left time: 228.5881s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:02.94s
Steps: 225 | Train Loss: 0.0810654 Vali Loss: 0.0774327 Test Loss: 0.0880531
Validation loss decreased (0.078193 --> 0.077433).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0786066
	speed: 0.0290s/iter; left time: 604.3271s
	iters: 200, epoch: 8 | loss: 0.0784651
	speed: 0.0110s/iter; left time: 228.6810s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:02.88s
Steps: 225 | Train Loss: 0.0803040 Vali Loss: 0.0773680 Test Loss: 0.0878483
Validation loss decreased (0.077433 --> 0.077368).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0771229
	speed: 0.0279s/iter; left time: 575.3227s
	iters: 200, epoch: 9 | loss: 0.0784607
	speed: 0.0111s/iter; left time: 228.1325s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:02.89s
Steps: 225 | Train Loss: 0.0797460 Vali Loss: 0.0767728 Test Loss: 0.0873519
Validation loss decreased (0.077368 --> 0.076773).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0769961
	speed: 0.0305s/iter; left time: 622.3057s
	iters: 200, epoch: 10 | loss: 0.0839497
	speed: 0.0112s/iter; left time: 227.5590s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:02.97s
Steps: 225 | Train Loss: 0.0792595 Vali Loss: 0.0770860 Test Loss: 0.0873690
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0784799
	speed: 0.0265s/iter; left time: 533.1242s
	iters: 200, epoch: 11 | loss: 0.0806227
	speed: 0.0124s/iter; left time: 248.0597s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:02.91s
Steps: 225 | Train Loss: 0.0788540 Vali Loss: 0.0766369 Test Loss: 0.0871308
Validation loss decreased (0.076773 --> 0.076637).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0758444
	speed: 0.0291s/iter; left time: 580.7146s
	iters: 200, epoch: 12 | loss: 0.0784750
	speed: 0.0133s/iter; left time: 262.9866s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.11s
Steps: 225 | Train Loss: 0.0784713 Vali Loss: 0.0762269 Test Loss: 0.0869149
Validation loss decreased (0.076637 --> 0.076227).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0733879
	speed: 0.0281s/iter; left time: 553.2530s
	iters: 200, epoch: 13 | loss: 0.0769888
	speed: 0.0111s/iter; left time: 218.1576s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:02.85s
Steps: 225 | Train Loss: 0.0781977 Vali Loss: 0.0762897 Test Loss: 0.0870662
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0810686
	speed: 0.0264s/iter; left time: 514.1753s
	iters: 200, epoch: 14 | loss: 0.0795114
	speed: 0.0113s/iter; left time: 219.2021s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:02.77s
Steps: 225 | Train Loss: 0.0779459 Vali Loss: 0.0761060 Test Loss: 0.0869318
Validation loss decreased (0.076227 --> 0.076106).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0744233
	speed: 0.0289s/iter; left time: 555.8119s
	iters: 200, epoch: 15 | loss: 0.0829216
	speed: 0.0138s/iter; left time: 264.6969s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.17s
Steps: 225 | Train Loss: 0.0777016 Vali Loss: 0.0759125 Test Loss: 0.0868220
Validation loss decreased (0.076106 --> 0.075912).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0767097
	speed: 0.0306s/iter; left time: 581.5039s
	iters: 200, epoch: 16 | loss: 0.0796856
	speed: 0.0144s/iter; left time: 271.6993s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.47s
Steps: 225 | Train Loss: 0.0774920 Vali Loss: 0.0758455 Test Loss: 0.0867436
Validation loss decreased (0.075912 --> 0.075846).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0774719
	speed: 0.0277s/iter; left time: 521.3130s
	iters: 200, epoch: 17 | loss: 0.0752526
	speed: 0.0130s/iter; left time: 243.5460s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:02.96s
Steps: 225 | Train Loss: 0.0773374 Vali Loss: 0.0755446 Test Loss: 0.0865177
Validation loss decreased (0.075846 --> 0.075545).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0765253
	speed: 0.0286s/iter; left time: 530.7867s
	iters: 200, epoch: 18 | loss: 0.0765767
	speed: 0.0122s/iter; left time: 225.3476s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.05s
Steps: 225 | Train Loss: 0.0771752 Vali Loss: 0.0757170 Test Loss: 0.0865492
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0783547
	speed: 0.0282s/iter; left time: 518.1567s
	iters: 200, epoch: 19 | loss: 0.0767365
	speed: 0.0143s/iter; left time: 261.0149s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.26s
Steps: 225 | Train Loss: 0.0769659 Vali Loss: 0.0754213 Test Loss: 0.0863692
Validation loss decreased (0.075545 --> 0.075421).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0790408
	speed: 0.0282s/iter; left time: 510.8319s
	iters: 200, epoch: 20 | loss: 0.0773466
	speed: 0.0128s/iter; left time: 231.5648s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:02.98s
Steps: 225 | Train Loss: 0.0768425 Vali Loss: 0.0754664 Test Loss: 0.0864002
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0753531
	speed: 0.0301s/iter; left time: 539.1700s
	iters: 200, epoch: 21 | loss: 0.0731350
	speed: 0.0137s/iter; left time: 243.5377s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.30s
Steps: 225 | Train Loss: 0.0766955 Vali Loss: 0.0754862 Test Loss: 0.0863862
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0779898
	speed: 0.0269s/iter; left time: 475.8422s
	iters: 200, epoch: 22 | loss: 0.0825680
	speed: 0.0122s/iter; left time: 214.5052s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:02.87s
Steps: 225 | Train Loss: 0.0766248 Vali Loss: 0.0755235 Test Loss: 0.0864362
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0791111
	speed: 0.0267s/iter; left time: 465.7960s
	iters: 200, epoch: 23 | loss: 0.0759331
	speed: 0.0114s/iter; left time: 197.1899s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:02.86s
Steps: 225 | Train Loss: 0.0765473 Vali Loss: 0.0753228 Test Loss: 0.0863299
Validation loss decreased (0.075421 --> 0.075323).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0761495
	speed: 0.0284s/iter; left time: 488.6902s
	iters: 200, epoch: 24 | loss: 0.0738292
	speed: 0.0112s/iter; left time: 190.9734s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:02.93s
Steps: 225 | Train Loss: 0.0765094 Vali Loss: 0.0753156 Test Loss: 0.0862079
Validation loss decreased (0.075323 --> 0.075316).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0779993
	speed: 0.0305s/iter; left time: 519.3030s
	iters: 200, epoch: 25 | loss: 0.0782428
	speed: 0.0151s/iter; left time: 255.7180s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0763938 Vali Loss: 0.0753543 Test Loss: 0.0861947
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0742307
	speed: 0.0315s/iter; left time: 528.8139s
	iters: 200, epoch: 26 | loss: 0.0757918
	speed: 0.0134s/iter; left time: 223.1370s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0762774 Vali Loss: 0.0752724 Test Loss: 0.0862290
Validation loss decreased (0.075316 --> 0.075272).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0783321
	speed: 0.0281s/iter; left time: 465.0481s
	iters: 200, epoch: 27 | loss: 0.0757260
	speed: 0.0135s/iter; left time: 222.5280s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.13s
Steps: 225 | Train Loss: 0.0762253 Vali Loss: 0.0752488 Test Loss: 0.0862783
Validation loss decreased (0.075272 --> 0.075249).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0790930
	speed: 0.0276s/iter; left time: 450.5264s
	iters: 200, epoch: 28 | loss: 0.0729679
	speed: 0.0121s/iter; left time: 195.8151s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:02.90s
Steps: 225 | Train Loss: 0.0761534 Vali Loss: 0.0751565 Test Loss: 0.0862070
Validation loss decreased (0.075249 --> 0.075156).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0786199
	speed: 0.0269s/iter; left time: 432.6455s
	iters: 200, epoch: 29 | loss: 0.0761598
	speed: 0.0112s/iter; left time: 179.7185s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:02.79s
Steps: 225 | Train Loss: 0.0761940 Vali Loss: 0.0751621 Test Loss: 0.0861756
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0733554
	speed: 0.0295s/iter; left time: 467.9329s
	iters: 200, epoch: 30 | loss: 0.0730510
	speed: 0.0106s/iter; left time: 167.8956s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:02.94s
Steps: 225 | Train Loss: 0.0761272 Vali Loss: 0.0751793 Test Loss: 0.0861981
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0754577
	speed: 0.0268s/iter; left time: 419.6410s
	iters: 200, epoch: 31 | loss: 0.0763041
	speed: 0.0118s/iter; left time: 183.2617s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:02.92s
Steps: 225 | Train Loss: 0.0761112 Vali Loss: 0.0752193 Test Loss: 0.0862073
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0753690
	speed: 0.0270s/iter; left time: 417.0290s
	iters: 200, epoch: 32 | loss: 0.0749692
	speed: 0.0145s/iter; left time: 222.8969s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.28s
Steps: 225 | Train Loss: 0.0760013 Vali Loss: 0.0751270 Test Loss: 0.0861752
Validation loss decreased (0.075156 --> 0.075127).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0775594
	speed: 0.0288s/iter; left time: 437.4118s
	iters: 200, epoch: 33 | loss: 0.0772318
	speed: 0.0126s/iter; left time: 189.6302s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:02.92s
Steps: 225 | Train Loss: 0.0760387 Vali Loss: 0.0752166 Test Loss: 0.0862664
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0794576
	speed: 0.0310s/iter; left time: 464.7791s
	iters: 200, epoch: 34 | loss: 0.0768538
	speed: 0.0135s/iter; left time: 200.1176s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0760135 Vali Loss: 0.0751128 Test Loss: 0.0860821
Validation loss decreased (0.075127 --> 0.075113).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0735802
	speed: 0.0271s/iter; left time: 400.3334s
	iters: 200, epoch: 35 | loss: 0.0766621
	speed: 0.0134s/iter; left time: 196.3351s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:02.99s
Steps: 225 | Train Loss: 0.0760044 Vali Loss: 0.0751563 Test Loss: 0.0862373
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0772841
	speed: 0.0301s/iter; left time: 436.7725s
	iters: 200, epoch: 36 | loss: 0.0781624
	speed: 0.0126s/iter; left time: 182.0036s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.19s
Steps: 225 | Train Loss: 0.0759210 Vali Loss: 0.0752047 Test Loss: 0.0861904
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0786459
	speed: 0.0323s/iter; left time: 462.1864s
	iters: 200, epoch: 37 | loss: 0.0782112
	speed: 0.0140s/iter; left time: 199.1692s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0759412 Vali Loss: 0.0751507 Test Loss: 0.0861724
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0764863
	speed: 0.0285s/iter; left time: 400.6951s
	iters: 200, epoch: 38 | loss: 0.0763690
	speed: 0.0114s/iter; left time: 159.7223s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:02.73s
Steps: 225 | Train Loss: 0.0758886 Vali Loss: 0.0750675 Test Loss: 0.0861431
Validation loss decreased (0.075113 --> 0.075067).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0746387
	speed: 0.0303s/iter; left time: 420.2301s
	iters: 200, epoch: 39 | loss: 0.0787861
	speed: 0.0153s/iter; left time: 210.9251s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0758228 Vali Loss: 0.0751216 Test Loss: 0.0861156
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0776882
	speed: 0.0279s/iter; left time: 380.6277s
	iters: 200, epoch: 40 | loss: 0.0786385
	speed: 0.0113s/iter; left time: 152.2141s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:02.87s
Steps: 225 | Train Loss: 0.0759235 Vali Loss: 0.0751186 Test Loss: 0.0860987
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0728601
	speed: 0.0277s/iter; left time: 371.5797s
	iters: 200, epoch: 41 | loss: 0.0760473
	speed: 0.0117s/iter; left time: 155.2885s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:02.94s
Steps: 225 | Train Loss: 0.0759023 Vali Loss: 0.0751263 Test Loss: 0.0861959
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0754796
	speed: 0.0293s/iter; left time: 385.9538s
	iters: 200, epoch: 42 | loss: 0.0757237
	speed: 0.0123s/iter; left time: 160.2953s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.19s
Steps: 225 | Train Loss: 0.0758651 Vali Loss: 0.0751259 Test Loss: 0.0861585
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0747819
	speed: 0.0280s/iter; left time: 362.8419s
	iters: 200, epoch: 43 | loss: 0.0768324
	speed: 0.0109s/iter; left time: 139.8543s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:02.83s
Steps: 225 | Train Loss: 0.0758420 Vali Loss: 0.0750790 Test Loss: 0.0861122
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0760698
	speed: 0.0267s/iter; left time: 339.2354s
	iters: 200, epoch: 44 | loss: 0.0753583
	speed: 0.0144s/iter; left time: 181.2118s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.13s
Steps: 225 | Train Loss: 0.0758371 Vali Loss: 0.0751272 Test Loss: 0.0861907
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0728124
	speed: 0.0275s/iter; left time: 344.0722s
	iters: 200, epoch: 45 | loss: 0.0740116
	speed: 0.0145s/iter; left time: 180.2584s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.24s
Steps: 225 | Train Loss: 0.0758549 Vali Loss: 0.0751464 Test Loss: 0.0861597
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0761023
	speed: 0.0271s/iter; left time: 333.1433s
	iters: 200, epoch: 46 | loss: 0.0756330
	speed: 0.0132s/iter; left time: 160.3492s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.03s
Steps: 225 | Train Loss: 0.0758372 Vali Loss: 0.0751317 Test Loss: 0.0862101
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0762448
	speed: 0.0301s/iter; left time: 362.6132s
	iters: 200, epoch: 47 | loss: 0.0742020
	speed: 0.0126s/iter; left time: 151.0476s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.29s
Steps: 225 | Train Loss: 0.0758265 Vali Loss: 0.0751139 Test Loss: 0.0861376
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0784523
	speed: 0.0285s/iter; left time: 337.1899s
	iters: 200, epoch: 48 | loss: 0.0720111
	speed: 0.0114s/iter; left time: 133.1720s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:02.89s
Steps: 225 | Train Loss: 0.0757754 Vali Loss: 0.0750921 Test Loss: 0.0861033
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_96_ES_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019112445414066315, rmse:0.1382477730512619, mae:0.08614306151866913, rse:0.4061303436756134
Use GPU: cuda:0
>>>>>>>start training : ES_168_96_ES_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1577033
	speed: 0.0132s/iter; left time: 295.0442s
	iters: 200, epoch: 1 | loss: 0.1350389
	speed: 0.0130s/iter; left time: 290.4807s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:02.96s
Steps: 225 | Train Loss: 0.1574104 Vali Loss: 0.1217240 Test Loss: 0.1391744
Validation loss decreased (inf --> 0.121724).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0954664
	speed: 0.0301s/iter; left time: 668.4554s
	iters: 200, epoch: 2 | loss: 0.0901520
	speed: 0.0124s/iter; left time: 272.9335s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.15s
Steps: 225 | Train Loss: 0.0996074 Vali Loss: 0.0869710 Test Loss: 0.0990641
Validation loss decreased (0.121724 --> 0.086971).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0872138
	speed: 0.0288s/iter; left time: 633.0436s
	iters: 200, epoch: 3 | loss: 0.0905658
	speed: 0.0122s/iter; left time: 267.1381s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:02.86s
Steps: 225 | Train Loss: 0.0889019 Vali Loss: 0.0821534 Test Loss: 0.0939969
Validation loss decreased (0.086971 --> 0.082153).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0868627
	speed: 0.0313s/iter; left time: 680.1948s
	iters: 200, epoch: 4 | loss: 0.0845538
	speed: 0.0119s/iter; left time: 256.8477s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.16s
Steps: 225 | Train Loss: 0.0855274 Vali Loss: 0.0803953 Test Loss: 0.0916625
Validation loss decreased (0.082153 --> 0.080395).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0849042
	speed: 0.0300s/iter; left time: 644.3792s
	iters: 200, epoch: 5 | loss: 0.0862014
	speed: 0.0120s/iter; left time: 257.1171s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:02.95s
Steps: 225 | Train Loss: 0.0836403 Vali Loss: 0.0792225 Test Loss: 0.0900389
Validation loss decreased (0.080395 --> 0.079222).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0834529
	speed: 0.0287s/iter; left time: 609.7094s
	iters: 200, epoch: 6 | loss: 0.0859380
	speed: 0.0122s/iter; left time: 257.3358s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:02.95s
Steps: 225 | Train Loss: 0.0823096 Vali Loss: 0.0782612 Test Loss: 0.0890277
Validation loss decreased (0.079222 --> 0.078261).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0838038
	speed: 0.0294s/iter; left time: 618.4004s
	iters: 200, epoch: 7 | loss: 0.0800350
	speed: 0.0121s/iter; left time: 253.3095s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:02.90s
Steps: 225 | Train Loss: 0.0814003 Vali Loss: 0.0777358 Test Loss: 0.0884875
Validation loss decreased (0.078261 --> 0.077736).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0803438
	speed: 0.0281s/iter; left time: 585.6875s
	iters: 200, epoch: 8 | loss: 0.0797413
	speed: 0.0114s/iter; left time: 236.6889s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:02.88s
Steps: 225 | Train Loss: 0.0805841 Vali Loss: 0.0774105 Test Loss: 0.0880362
Validation loss decreased (0.077736 --> 0.077410).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0753549
	speed: 0.0284s/iter; left time: 584.4948s
	iters: 200, epoch: 9 | loss: 0.0840414
	speed: 0.0139s/iter; left time: 285.0079s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.14s
Steps: 225 | Train Loss: 0.0800004 Vali Loss: 0.0773046 Test Loss: 0.0879727
Validation loss decreased (0.077410 --> 0.077305).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0788011
	speed: 0.0319s/iter; left time: 650.2066s
	iters: 200, epoch: 10 | loss: 0.0813491
	speed: 0.0128s/iter; left time: 259.4920s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.28s
Steps: 225 | Train Loss: 0.0794434 Vali Loss: 0.0767787 Test Loss: 0.0874287
Validation loss decreased (0.077305 --> 0.076779).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0806336
	speed: 0.0278s/iter; left time: 560.6176s
	iters: 200, epoch: 11 | loss: 0.0811494
	speed: 0.0159s/iter; left time: 318.1278s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.19s
Steps: 225 | Train Loss: 0.0790037 Vali Loss: 0.0766619 Test Loss: 0.0873398
Validation loss decreased (0.076779 --> 0.076662).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0747868
	speed: 0.0323s/iter; left time: 643.0898s
	iters: 200, epoch: 12 | loss: 0.0767990
	speed: 0.0126s/iter; left time: 250.5711s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.36s
Steps: 225 | Train Loss: 0.0786772 Vali Loss: 0.0761316 Test Loss: 0.0871168
Validation loss decreased (0.076662 --> 0.076132).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0763483
	speed: 0.0292s/iter; left time: 575.5384s
	iters: 200, epoch: 13 | loss: 0.0806691
	speed: 0.0119s/iter; left time: 232.6534s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:02.92s
Steps: 225 | Train Loss: 0.0784107 Vali Loss: 0.0759851 Test Loss: 0.0868440
Validation loss decreased (0.076132 --> 0.075985).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0810251
	speed: 0.0280s/iter; left time: 545.8384s
	iters: 200, epoch: 14 | loss: 0.0781442
	speed: 0.0144s/iter; left time: 279.8245s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.15s
Steps: 225 | Train Loss: 0.0781160 Vali Loss: 0.0762808 Test Loss: 0.0871939
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0731684
	speed: 0.0293s/iter; left time: 563.2923s
	iters: 200, epoch: 15 | loss: 0.0800549
	speed: 0.0114s/iter; left time: 217.8838s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:02.99s
Steps: 225 | Train Loss: 0.0779006 Vali Loss: 0.0761531 Test Loss: 0.0868299
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0808244
	speed: 0.0282s/iter; left time: 535.8622s
	iters: 200, epoch: 16 | loss: 0.0744877
	speed: 0.0121s/iter; left time: 229.2133s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:02.98s
Steps: 225 | Train Loss: 0.0776603 Vali Loss: 0.0759935 Test Loss: 0.0866621
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0797293
	speed: 0.0351s/iter; left time: 660.5789s
	iters: 200, epoch: 17 | loss: 0.0745371
	speed: 0.0166s/iter; left time: 310.5409s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.09s
Steps: 225 | Train Loss: 0.0774855 Vali Loss: 0.0758769 Test Loss: 0.0865073
Validation loss decreased (0.075985 --> 0.075877).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0825204
	speed: 0.0306s/iter; left time: 567.7591s
	iters: 200, epoch: 18 | loss: 0.0759405
	speed: 0.0110s/iter; left time: 203.2242s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:02.73s
Steps: 225 | Train Loss: 0.0773324 Vali Loss: 0.0759104 Test Loss: 0.0866722
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0751155
	speed: 0.0279s/iter; left time: 511.4307s
	iters: 200, epoch: 19 | loss: 0.0759723
	speed: 0.0126s/iter; left time: 229.3944s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.00s
Steps: 225 | Train Loss: 0.0771947 Vali Loss: 0.0758913 Test Loss: 0.0865089
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0770257
	speed: 0.0271s/iter; left time: 490.9193s
	iters: 200, epoch: 20 | loss: 0.0793783
	speed: 0.0117s/iter; left time: 211.5986s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:02.87s
Steps: 225 | Train Loss: 0.0770421 Vali Loss: 0.0759149 Test Loss: 0.0864828
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0808547
	speed: 0.0325s/iter; left time: 581.6474s
	iters: 200, epoch: 21 | loss: 0.0746658
	speed: 0.0117s/iter; left time: 207.8956s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.28s
Steps: 225 | Train Loss: 0.0769642 Vali Loss: 0.0755270 Test Loss: 0.0862854
Validation loss decreased (0.075877 --> 0.075527).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0799318
	speed: 0.0300s/iter; left time: 529.7660s
	iters: 200, epoch: 22 | loss: 0.0795009
	speed: 0.0121s/iter; left time: 212.7625s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:02.97s
Steps: 225 | Train Loss: 0.0769058 Vali Loss: 0.0755863 Test Loss: 0.0861169
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0806981
	speed: 0.0276s/iter; left time: 481.9471s
	iters: 200, epoch: 23 | loss: 0.0776285
	speed: 0.0116s/iter; left time: 201.0092s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:02.88s
Steps: 225 | Train Loss: 0.0767392 Vali Loss: 0.0755869 Test Loss: 0.0862814
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0757655
	speed: 0.0292s/iter; left time: 503.2249s
	iters: 200, epoch: 24 | loss: 0.0774275
	speed: 0.0116s/iter; left time: 198.3893s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:02.97s
Steps: 225 | Train Loss: 0.0766776 Vali Loss: 0.0756844 Test Loss: 0.0863970
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0719616
	speed: 0.0294s/iter; left time: 500.1217s
	iters: 200, epoch: 25 | loss: 0.0789211
	speed: 0.0115s/iter; left time: 193.7666s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.06s
Steps: 225 | Train Loss: 0.0766260 Vali Loss: 0.0756459 Test Loss: 0.0862978
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0750893
	speed: 0.0280s/iter; left time: 469.5322s
	iters: 200, epoch: 26 | loss: 0.0768932
	speed: 0.0116s/iter; left time: 193.4952s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:02.72s
Steps: 225 | Train Loss: 0.0765750 Vali Loss: 0.0754100 Test Loss: 0.0859953
Validation loss decreased (0.075527 --> 0.075410).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0803022
	speed: 0.0282s/iter; left time: 466.6631s
	iters: 200, epoch: 27 | loss: 0.0765712
	speed: 0.0122s/iter; left time: 201.0474s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:02.90s
Steps: 225 | Train Loss: 0.0764555 Vali Loss: 0.0756538 Test Loss: 0.0862654
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0799393
	speed: 0.0319s/iter; left time: 520.0467s
	iters: 200, epoch: 28 | loss: 0.0732785
	speed: 0.0129s/iter; left time: 209.6058s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0764959 Vali Loss: 0.0755844 Test Loss: 0.0862349
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0759135
	speed: 0.0282s/iter; left time: 454.3806s
	iters: 200, epoch: 29 | loss: 0.0728304
	speed: 0.0118s/iter; left time: 188.9390s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:02.94s
Steps: 225 | Train Loss: 0.0763770 Vali Loss: 0.0755688 Test Loss: 0.0862012
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0758216
	speed: 0.0286s/iter; left time: 453.5418s
	iters: 200, epoch: 30 | loss: 0.0788435
	speed: 0.0122s/iter; left time: 193.0649s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:02.96s
Steps: 225 | Train Loss: 0.0763523 Vali Loss: 0.0754775 Test Loss: 0.0861182
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0740229
	speed: 0.0326s/iter; left time: 509.6023s
	iters: 200, epoch: 31 | loss: 0.0750465
	speed: 0.0121s/iter; left time: 188.4770s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.35s
Steps: 225 | Train Loss: 0.0762969 Vali Loss: 0.0754892 Test Loss: 0.0860911
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0735503
	speed: 0.0292s/iter; left time: 450.2291s
	iters: 200, epoch: 32 | loss: 0.0753440
	speed: 0.0115s/iter; left time: 176.3807s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:02.81s
Steps: 225 | Train Loss: 0.0762555 Vali Loss: 0.0753743 Test Loss: 0.0860091
Validation loss decreased (0.075410 --> 0.075374).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0745924
	speed: 0.0290s/iter; left time: 441.1284s
	iters: 200, epoch: 33 | loss: 0.0805365
	speed: 0.0129s/iter; left time: 195.3121s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.16s
Steps: 225 | Train Loss: 0.0762440 Vali Loss: 0.0754154 Test Loss: 0.0860034
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0734176
	speed: 0.0289s/iter; left time: 432.1467s
	iters: 200, epoch: 34 | loss: 0.0756994
	speed: 0.0121s/iter; left time: 180.7071s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.04s
Steps: 225 | Train Loss: 0.0761795 Vali Loss: 0.0754332 Test Loss: 0.0861153
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0789745
	speed: 0.0296s/iter; left time: 436.9366s
	iters: 200, epoch: 35 | loss: 0.0763532
	speed: 0.0154s/iter; left time: 225.1775s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0761926 Vali Loss: 0.0754571 Test Loss: 0.0860438
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0762898
	speed: 0.0288s/iter; left time: 418.2761s
	iters: 200, epoch: 36 | loss: 0.0747354
	speed: 0.0123s/iter; left time: 177.7872s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:02.97s
Steps: 225 | Train Loss: 0.0761171 Vali Loss: 0.0755036 Test Loss: 0.0860654
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0761736
	speed: 0.0277s/iter; left time: 396.2141s
	iters: 200, epoch: 37 | loss: 0.0747050
	speed: 0.0137s/iter; left time: 194.9572s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.08s
Steps: 225 | Train Loss: 0.0761568 Vali Loss: 0.0753613 Test Loss: 0.0860309
Validation loss decreased (0.075374 --> 0.075361).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0727366
	speed: 0.0293s/iter; left time: 412.1367s
	iters: 200, epoch: 38 | loss: 0.0777595
	speed: 0.0129s/iter; left time: 180.8990s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.05s
Steps: 225 | Train Loss: 0.0761321 Vali Loss: 0.0753521 Test Loss: 0.0860522
Validation loss decreased (0.075361 --> 0.075352).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0778039
	speed: 0.0298s/iter; left time: 413.1627s
	iters: 200, epoch: 39 | loss: 0.0722151
	speed: 0.0128s/iter; left time: 176.6077s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.25s
Steps: 225 | Train Loss: 0.0760934 Vali Loss: 0.0754370 Test Loss: 0.0860848
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0743089
	speed: 0.0336s/iter; left time: 458.4894s
	iters: 200, epoch: 40 | loss: 0.0775397
	speed: 0.0140s/iter; left time: 188.9733s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0760195 Vali Loss: 0.0753774 Test Loss: 0.0860355
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0738335
	speed: 0.0334s/iter; left time: 447.5114s
	iters: 200, epoch: 41 | loss: 0.0781013
	speed: 0.0166s/iter; left time: 220.8505s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:03.90s
Steps: 225 | Train Loss: 0.0760308 Vali Loss: 0.0753938 Test Loss: 0.0860646
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0752735
	speed: 0.0323s/iter; left time: 426.0101s
	iters: 200, epoch: 42 | loss: 0.0769139
	speed: 0.0115s/iter; left time: 150.9601s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.13s
Steps: 225 | Train Loss: 0.0760375 Vali Loss: 0.0753885 Test Loss: 0.0860948
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0789014
	speed: 0.0278s/iter; left time: 359.7525s
	iters: 200, epoch: 43 | loss: 0.0771543
	speed: 0.0110s/iter; left time: 141.2079s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:02.71s
Steps: 225 | Train Loss: 0.0760886 Vali Loss: 0.0754264 Test Loss: 0.0860126
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0794128
	speed: 0.0305s/iter; left time: 388.6699s
	iters: 200, epoch: 44 | loss: 0.0747860
	speed: 0.0124s/iter; left time: 156.6997s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.25s
Steps: 225 | Train Loss: 0.0760847 Vali Loss: 0.0753687 Test Loss: 0.0860298
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0770456
	speed: 0.0286s/iter; left time: 357.1021s
	iters: 200, epoch: 45 | loss: 0.0763281
	speed: 0.0129s/iter; left time: 160.1738s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.09s
Steps: 225 | Train Loss: 0.0760148 Vali Loss: 0.0753657 Test Loss: 0.0860127
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0800752
	speed: 0.0316s/iter; left time: 387.8871s
	iters: 200, epoch: 46 | loss: 0.0794832
	speed: 0.0119s/iter; left time: 144.7473s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.13s
Steps: 225 | Train Loss: 0.0760315 Vali Loss: 0.0753694 Test Loss: 0.0860104
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0796557
	speed: 0.0317s/iter; left time: 382.5726s
	iters: 200, epoch: 47 | loss: 0.0767693
	speed: 0.0136s/iter; left time: 161.9843s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:03.41s
Steps: 225 | Train Loss: 0.0760123 Vali Loss: 0.0753986 Test Loss: 0.0860624
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0745895
	speed: 0.0291s/iter; left time: 343.7544s
	iters: 200, epoch: 48 | loss: 0.0807312
	speed: 0.0126s/iter; left time: 147.4480s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.03s
Steps: 225 | Train Loss: 0.0760364 Vali Loss: 0.0753589 Test Loss: 0.0860535
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_96_ES_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019077060744166374, rmse:0.13811972737312317, mae:0.08605219423770905, rse:0.4057542085647583
Intermediate time for ES and pred_len 96: 00h:06m:52.79s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_168_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_168_168_ES_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1568499
	speed: 0.0381s/iter; left time: 853.6006s
	iters: 200, epoch: 1 | loss: 0.1316590
	speed: 0.0128s/iter; left time: 285.2831s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.43s
Steps: 225 | Train Loss: 0.1573622 Vali Loss: 0.1235502 Test Loss: 0.1400854
Validation loss decreased (inf --> 0.123550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1035424
	speed: 0.0314s/iter; left time: 696.2753s
	iters: 200, epoch: 2 | loss: 0.1005864
	speed: 0.0122s/iter; left time: 270.1457s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.26s
Steps: 225 | Train Loss: 0.1043460 Vali Loss: 0.0933807 Test Loss: 0.1052763
Validation loss decreased (0.123550 --> 0.093381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0921834
	speed: 0.0291s/iter; left time: 638.4836s
	iters: 200, epoch: 3 | loss: 0.0943769
	speed: 0.0138s/iter; left time: 301.3485s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.17s
Steps: 225 | Train Loss: 0.0942344 Vali Loss: 0.0873603 Test Loss: 0.0990985
Validation loss decreased (0.093381 --> 0.087360).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0907277
	speed: 0.0332s/iter; left time: 720.7441s
	iters: 200, epoch: 4 | loss: 0.0888133
	speed: 0.0141s/iter; left time: 304.7834s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.40s
Steps: 225 | Train Loss: 0.0908532 Vali Loss: 0.0852744 Test Loss: 0.0964538
Validation loss decreased (0.087360 --> 0.085274).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0867176
	speed: 0.0328s/iter; left time: 706.0179s
	iters: 200, epoch: 5 | loss: 0.0870261
	speed: 0.0137s/iter; left time: 293.2151s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.54s
Steps: 225 | Train Loss: 0.0889696 Vali Loss: 0.0843731 Test Loss: 0.0953252
Validation loss decreased (0.085274 --> 0.084373).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0842111
	speed: 0.0327s/iter; left time: 696.3192s
	iters: 200, epoch: 6 | loss: 0.0886363
	speed: 0.0137s/iter; left time: 289.3246s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.41s
Steps: 225 | Train Loss: 0.0875895 Vali Loss: 0.0837014 Test Loss: 0.0944848
Validation loss decreased (0.084373 --> 0.083701).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0892857
	speed: 0.0325s/iter; left time: 683.8164s
	iters: 200, epoch: 7 | loss: 0.0852607
	speed: 0.0141s/iter; left time: 296.2138s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0865385 Vali Loss: 0.0830057 Test Loss: 0.0939623
Validation loss decreased (0.083701 --> 0.083006).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0876576
	speed: 0.0328s/iter; left time: 683.0705s
	iters: 200, epoch: 8 | loss: 0.0875875
	speed: 0.0139s/iter; left time: 288.6094s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0857704 Vali Loss: 0.0828423 Test Loss: 0.0935337
Validation loss decreased (0.083006 --> 0.082842).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0869338
	speed: 0.0333s/iter; left time: 686.7570s
	iters: 200, epoch: 9 | loss: 0.0878397
	speed: 0.0133s/iter; left time: 272.0531s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.39s
Steps: 225 | Train Loss: 0.0851366 Vali Loss: 0.0828146 Test Loss: 0.0935755
Validation loss decreased (0.082842 --> 0.082815).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0832062
	speed: 0.0298s/iter; left time: 608.1331s
	iters: 200, epoch: 10 | loss: 0.0817573
	speed: 0.0143s/iter; left time: 289.2983s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.33s
Steps: 225 | Train Loss: 0.0846364 Vali Loss: 0.0826662 Test Loss: 0.0931646
Validation loss decreased (0.082815 --> 0.082666).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0856273
	speed: 0.0316s/iter; left time: 637.3718s
	iters: 200, epoch: 11 | loss: 0.0868291
	speed: 0.0145s/iter; left time: 290.7215s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.46s
Steps: 225 | Train Loss: 0.0842443 Vali Loss: 0.0824437 Test Loss: 0.0931207
Validation loss decreased (0.082666 --> 0.082444).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0871971
	speed: 0.0311s/iter; left time: 620.3054s
	iters: 200, epoch: 12 | loss: 0.0862963
	speed: 0.0144s/iter; left time: 285.8496s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.42s
Steps: 225 | Train Loss: 0.0839270 Vali Loss: 0.0820603 Test Loss: 0.0927688
Validation loss decreased (0.082444 --> 0.082060).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0827589
	speed: 0.0322s/iter; left time: 633.7782s
	iters: 200, epoch: 13 | loss: 0.0821555
	speed: 0.0140s/iter; left time: 275.2710s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.34s
Steps: 225 | Train Loss: 0.0836436 Vali Loss: 0.0825373 Test Loss: 0.0930180
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0816468
	speed: 0.0305s/iter; left time: 594.9166s
	iters: 200, epoch: 14 | loss: 0.0777866
	speed: 0.0142s/iter; left time: 274.4008s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.36s
Steps: 225 | Train Loss: 0.0833672 Vali Loss: 0.0822728 Test Loss: 0.0929308
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0817904
	speed: 0.0316s/iter; left time: 608.8828s
	iters: 200, epoch: 15 | loss: 0.0814839
	speed: 0.0151s/iter; left time: 289.1291s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.50s
Steps: 225 | Train Loss: 0.0831294 Vali Loss: 0.0823914 Test Loss: 0.0927944
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0831645
	speed: 0.0281s/iter; left time: 534.4025s
	iters: 200, epoch: 16 | loss: 0.0814912
	speed: 0.0125s/iter; left time: 236.2610s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:02.93s
Steps: 225 | Train Loss: 0.0829364 Vali Loss: 0.0822596 Test Loss: 0.0928918
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0829945
	speed: 0.0293s/iter; left time: 551.2159s
	iters: 200, epoch: 17 | loss: 0.0866629
	speed: 0.0124s/iter; left time: 231.6541s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.06s
Steps: 225 | Train Loss: 0.0827697 Vali Loss: 0.0822756 Test Loss: 0.0927913
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0808619
	speed: 0.0289s/iter; left time: 536.1474s
	iters: 200, epoch: 18 | loss: 0.0827853
	speed: 0.0123s/iter; left time: 226.3833s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:02.98s
Steps: 225 | Train Loss: 0.0825893 Vali Loss: 0.0821652 Test Loss: 0.0926397
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0829511
	speed: 0.0302s/iter; left time: 554.6400s
	iters: 200, epoch: 19 | loss: 0.0840674
	speed: 0.0144s/iter; left time: 263.3367s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0824541 Vali Loss: 0.0822779 Test Loss: 0.0930222
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0822663
	speed: 0.0309s/iter; left time: 559.9971s
	iters: 200, epoch: 20 | loss: 0.0844956
	speed: 0.0139s/iter; left time: 249.8060s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.30s
Steps: 225 | Train Loss: 0.0823565 Vali Loss: 0.0822376 Test Loss: 0.0928995
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0786321
	speed: 0.0304s/iter; left time: 543.4276s
	iters: 200, epoch: 21 | loss: 0.0809851
	speed: 0.0137s/iter; left time: 244.1324s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.35s
Steps: 225 | Train Loss: 0.0822532 Vali Loss: 0.0821607 Test Loss: 0.0927439
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0797071
	speed: 0.0305s/iter; left time: 538.3366s
	iters: 200, epoch: 22 | loss: 0.0842925
	speed: 0.0144s/iter; left time: 252.2247s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0821002 Vali Loss: 0.0822368 Test Loss: 0.0929710
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_168_ES_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021398216485977173, rmse:0.14628128707408905, mae:0.09276880323886871, rse:0.42976129055023193
Use GPU: cuda:0
>>>>>>>start training : ES_168_168_ES_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1665550
	speed: 0.0171s/iter; left time: 383.3097s
	iters: 200, epoch: 1 | loss: 0.1342119
	speed: 0.0155s/iter; left time: 345.8533s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.59s
Steps: 225 | Train Loss: 0.1595942 Vali Loss: 0.1252286 Test Loss: 0.1425784
Validation loss decreased (inf --> 0.125229).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1071426
	speed: 0.0318s/iter; left time: 705.9752s
	iters: 200, epoch: 2 | loss: 0.0988839
	speed: 0.0144s/iter; left time: 316.7955s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.47s
Steps: 225 | Train Loss: 0.1038184 Vali Loss: 0.0923388 Test Loss: 0.1043468
Validation loss decreased (0.125229 --> 0.092339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0954366
	speed: 0.0328s/iter; left time: 720.6446s
	iters: 200, epoch: 3 | loss: 0.0929098
	speed: 0.0141s/iter; left time: 307.4602s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.50s
Steps: 225 | Train Loss: 0.0936030 Vali Loss: 0.0874168 Test Loss: 0.0985869
Validation loss decreased (0.092339 --> 0.087417).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0919800
	speed: 0.0328s/iter; left time: 712.6136s
	iters: 200, epoch: 4 | loss: 0.0923115
	speed: 0.0140s/iter; left time: 302.1806s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0906089 Vali Loss: 0.0856613 Test Loss: 0.0964879
Validation loss decreased (0.087417 --> 0.085661).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0887270
	speed: 0.0319s/iter; left time: 686.2710s
	iters: 200, epoch: 5 | loss: 0.0917832
	speed: 0.0149s/iter; left time: 319.1147s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0887391 Vali Loss: 0.0848867 Test Loss: 0.0954072
Validation loss decreased (0.085661 --> 0.084887).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0873320
	speed: 0.0322s/iter; left time: 685.0572s
	iters: 200, epoch: 6 | loss: 0.0866217
	speed: 0.0141s/iter; left time: 298.1572s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.47s
Steps: 225 | Train Loss: 0.0875130 Vali Loss: 0.0838974 Test Loss: 0.0948258
Validation loss decreased (0.084887 --> 0.083897).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0856005
	speed: 0.0316s/iter; left time: 665.8393s
	iters: 200, epoch: 7 | loss: 0.0889447
	speed: 0.0143s/iter; left time: 299.9235s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.40s
Steps: 225 | Train Loss: 0.0866496 Vali Loss: 0.0836268 Test Loss: 0.0943554
Validation loss decreased (0.083897 --> 0.083627).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0852821
	speed: 0.0336s/iter; left time: 698.7176s
	iters: 200, epoch: 8 | loss: 0.0845993
	speed: 0.0161s/iter; left time: 333.6187s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0859998 Vali Loss: 0.0833807 Test Loss: 0.0940453
Validation loss decreased (0.083627 --> 0.083381).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0903444
	speed: 0.0305s/iter; left time: 628.0585s
	iters: 200, epoch: 9 | loss: 0.0831527
	speed: 0.0122s/iter; left time: 249.4787s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:02.93s
Steps: 225 | Train Loss: 0.0854311 Vali Loss: 0.0835337 Test Loss: 0.0938182
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0861049
	speed: 0.0310s/iter; left time: 631.4107s
	iters: 200, epoch: 10 | loss: 0.0856074
	speed: 0.0130s/iter; left time: 264.5615s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.28s
Steps: 225 | Train Loss: 0.0849855 Vali Loss: 0.0832467 Test Loss: 0.0936491
Validation loss decreased (0.083381 --> 0.083247).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0823327
	speed: 0.0299s/iter; left time: 603.0824s
	iters: 200, epoch: 11 | loss: 0.0823785
	speed: 0.0136s/iter; left time: 272.2093s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.19s
Steps: 225 | Train Loss: 0.0845717 Vali Loss: 0.0834375 Test Loss: 0.0938023
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0852507
	speed: 0.0306s/iter; left time: 610.6626s
	iters: 200, epoch: 12 | loss: 0.0844938
	speed: 0.0131s/iter; left time: 260.5466s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.16s
Steps: 225 | Train Loss: 0.0841896 Vali Loss: 0.0829765 Test Loss: 0.0932096
Validation loss decreased (0.083247 --> 0.082976).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0808426
	speed: 0.0333s/iter; left time: 656.3417s
	iters: 200, epoch: 13 | loss: 0.0806663
	speed: 0.0167s/iter; left time: 327.2867s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.0839008 Vali Loss: 0.0827313 Test Loss: 0.0932784
Validation loss decreased (0.082976 --> 0.082731).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0810001
	speed: 0.0325s/iter; left time: 632.8474s
	iters: 200, epoch: 14 | loss: 0.0829864
	speed: 0.0134s/iter; left time: 259.9685s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.41s
Steps: 225 | Train Loss: 0.0836157 Vali Loss: 0.0822975 Test Loss: 0.0925756
Validation loss decreased (0.082731 --> 0.082298).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0856069
	speed: 0.0336s/iter; left time: 646.3278s
	iters: 200, epoch: 15 | loss: 0.0858787
	speed: 0.0138s/iter; left time: 264.6898s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0833859 Vali Loss: 0.0826017 Test Loss: 0.0927973
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0810837
	speed: 0.0321s/iter; left time: 610.0693s
	iters: 200, epoch: 16 | loss: 0.0873101
	speed: 0.0139s/iter; left time: 262.1592s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.40s
Steps: 225 | Train Loss: 0.0832361 Vali Loss: 0.0825363 Test Loss: 0.0927583
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0846607
	speed: 0.0319s/iter; left time: 598.8119s
	iters: 200, epoch: 17 | loss: 0.0821061
	speed: 0.0150s/iter; left time: 281.1685s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.65s
Steps: 225 | Train Loss: 0.0830506 Vali Loss: 0.0828263 Test Loss: 0.0932079
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0788185
	speed: 0.0334s/iter; left time: 620.2452s
	iters: 200, epoch: 18 | loss: 0.0828428
	speed: 0.0138s/iter; left time: 255.8784s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.47s
Steps: 225 | Train Loss: 0.0828306 Vali Loss: 0.0825819 Test Loss: 0.0928293
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0817331
	speed: 0.0304s/iter; left time: 558.5909s
	iters: 200, epoch: 19 | loss: 0.0834585
	speed: 0.0134s/iter; left time: 245.0410s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.30s
Steps: 225 | Train Loss: 0.0827299 Vali Loss: 0.0825543 Test Loss: 0.0930653
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0806477
	speed: 0.0298s/iter; left time: 540.3614s
	iters: 200, epoch: 20 | loss: 0.0841569
	speed: 0.0147s/iter; left time: 264.0877s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.34s
Steps: 225 | Train Loss: 0.0826318 Vali Loss: 0.0825693 Test Loss: 0.0926642
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0823159
	speed: 0.0311s/iter; left time: 556.3385s
	iters: 200, epoch: 21 | loss: 0.0850630
	speed: 0.0157s/iter; left time: 280.1273s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0824663 Vali Loss: 0.0825424 Test Loss: 0.0927273
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0775800
	speed: 0.0318s/iter; left time: 562.2015s
	iters: 200, epoch: 22 | loss: 0.0822026
	speed: 0.0134s/iter; left time: 235.9942s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.31s
Steps: 225 | Train Loss: 0.0823799 Vali Loss: 0.0825105 Test Loss: 0.0927264
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0850594
	speed: 0.0313s/iter; left time: 545.4146s
	iters: 200, epoch: 23 | loss: 0.0854007
	speed: 0.0148s/iter; left time: 257.1360s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0822438 Vali Loss: 0.0825739 Test Loss: 0.0928915
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0819938
	speed: 0.0318s/iter; left time: 548.4068s
	iters: 200, epoch: 24 | loss: 0.0815709
	speed: 0.0136s/iter; left time: 232.0669s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.39s
Steps: 225 | Train Loss: 0.0821720 Vali Loss: 0.0823585 Test Loss: 0.0925500
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_168_168_ES_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02151847630739212, rmse:0.14669176936149597, mae:0.09257563203573227, rse:0.43096721172332764
Intermediate time for ES and pred_len 168: 00h:03m:42.31sIntermediate time for ES: 00h:18m:31.27s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1076997
	speed: 0.0366s/iter; left time: 822.6094s
	iters: 200, epoch: 1 | loss: 0.0844932
	speed: 0.0120s/iter; left time: 267.7536s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.20s
Steps: 226 | Train Loss: 0.1071305 Vali Loss: 0.0901043 Test Loss: 0.0994532
Validation loss decreased (inf --> 0.090104).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0561477
	speed: 0.0277s/iter; left time: 615.9330s
	iters: 200, epoch: 2 | loss: 0.0513192
	speed: 0.0130s/iter; left time: 287.6878s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.04s
Steps: 226 | Train Loss: 0.0585561 Vali Loss: 0.0592476 Test Loss: 0.0617865
Validation loss decreased (0.090104 --> 0.059248).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0513508
	speed: 0.0291s/iter; left time: 642.1081s
	iters: 200, epoch: 3 | loss: 0.0479516
	speed: 0.0128s/iter; left time: 281.1625s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.12s
Steps: 226 | Train Loss: 0.0507629 Vali Loss: 0.0568690 Test Loss: 0.0597648
Validation loss decreased (0.059248 --> 0.056869).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0521114
	speed: 0.0289s/iter; left time: 631.1283s
	iters: 200, epoch: 4 | loss: 0.0502443
	speed: 0.0111s/iter; left time: 240.2410s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0488265 Vali Loss: 0.0553084 Test Loss: 0.0585132
Validation loss decreased (0.056869 --> 0.055308).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0463736
	speed: 0.0269s/iter; left time: 582.0012s
	iters: 200, epoch: 5 | loss: 0.0434525
	speed: 0.0115s/iter; left time: 247.6833s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:02.80s
Steps: 226 | Train Loss: 0.0475343 Vali Loss: 0.0543128 Test Loss: 0.0578031
Validation loss decreased (0.055308 --> 0.054313).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0460580
	speed: 0.0264s/iter; left time: 563.7507s
	iters: 200, epoch: 6 | loss: 0.0450222
	speed: 0.0112s/iter; left time: 238.2665s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0466277 Vali Loss: 0.0534805 Test Loss: 0.0573687
Validation loss decreased (0.054313 --> 0.053480).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0470545
	speed: 0.0273s/iter; left time: 577.0121s
	iters: 200, epoch: 7 | loss: 0.0459243
	speed: 0.0134s/iter; left time: 282.4111s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.16s
Steps: 226 | Train Loss: 0.0458450 Vali Loss: 0.0528845 Test Loss: 0.0568669
Validation loss decreased (0.053480 --> 0.052884).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0449147
	speed: 0.0286s/iter; left time: 598.4418s
	iters: 200, epoch: 8 | loss: 0.0446093
	speed: 0.0121s/iter; left time: 252.7594s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0452563 Vali Loss: 0.0526112 Test Loss: 0.0566168
Validation loss decreased (0.052884 --> 0.052611).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0432319
	speed: 0.0289s/iter; left time: 597.5363s
	iters: 200, epoch: 9 | loss: 0.0445187
	speed: 0.0134s/iter; left time: 276.2346s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.18s
Steps: 226 | Train Loss: 0.0447915 Vali Loss: 0.0519764 Test Loss: 0.0564366
Validation loss decreased (0.052611 --> 0.051976).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0441739
	speed: 0.0284s/iter; left time: 581.9944s
	iters: 200, epoch: 10 | loss: 0.0453514
	speed: 0.0111s/iter; left time: 225.2967s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0443843 Vali Loss: 0.0517694 Test Loss: 0.0559094
Validation loss decreased (0.051976 --> 0.051769).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0440916
	speed: 0.0287s/iter; left time: 580.5034s
	iters: 200, epoch: 11 | loss: 0.0410351
	speed: 0.0130s/iter; left time: 261.3078s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.11s
Steps: 226 | Train Loss: 0.0440559 Vali Loss: 0.0514138 Test Loss: 0.0556246
Validation loss decreased (0.051769 --> 0.051414).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0477772
	speed: 0.0277s/iter; left time: 554.8615s
	iters: 200, epoch: 12 | loss: 0.0450721
	speed: 0.0112s/iter; left time: 222.1772s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:02.85s
Steps: 226 | Train Loss: 0.0437628 Vali Loss: 0.0512534 Test Loss: 0.0554950
Validation loss decreased (0.051414 --> 0.051253).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0407731
	speed: 0.0260s/iter; left time: 514.7758s
	iters: 200, epoch: 13 | loss: 0.0449747
	speed: 0.0109s/iter; left time: 215.0415s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:02.75s
Steps: 226 | Train Loss: 0.0434858 Vali Loss: 0.0510212 Test Loss: 0.0552484
Validation loss decreased (0.051253 --> 0.051021).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0429213
	speed: 0.0290s/iter; left time: 566.4141s
	iters: 200, epoch: 14 | loss: 0.0441765
	speed: 0.0119s/iter; left time: 231.0266s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.01s
Steps: 226 | Train Loss: 0.0432644 Vali Loss: 0.0510122 Test Loss: 0.0552304
Validation loss decreased (0.051021 --> 0.051012).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0418309
	speed: 0.0284s/iter; left time: 549.5122s
	iters: 200, epoch: 15 | loss: 0.0407279
	speed: 0.0119s/iter; left time: 229.4668s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.03s
Steps: 226 | Train Loss: 0.0430998 Vali Loss: 0.0508352 Test Loss: 0.0550930
Validation loss decreased (0.051012 --> 0.050835).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0448649
	speed: 0.0265s/iter; left time: 506.1767s
	iters: 200, epoch: 16 | loss: 0.0415453
	speed: 0.0116s/iter; left time: 220.8009s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0428707 Vali Loss: 0.0507972 Test Loss: 0.0549450
Validation loss decreased (0.050835 --> 0.050797).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0412447
	speed: 0.0284s/iter; left time: 536.5456s
	iters: 200, epoch: 17 | loss: 0.0421428
	speed: 0.0124s/iter; left time: 233.1482s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.04s
Steps: 226 | Train Loss: 0.0427756 Vali Loss: 0.0509308 Test Loss: 0.0550025
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0438714
	speed: 0.0317s/iter; left time: 591.5384s
	iters: 200, epoch: 18 | loss: 0.0411248
	speed: 0.0116s/iter; left time: 214.6642s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.26s
Steps: 226 | Train Loss: 0.0427111 Vali Loss: 0.0506774 Test Loss: 0.0549089
Validation loss decreased (0.050797 --> 0.050677).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0438699
	speed: 0.0279s/iter; left time: 514.4521s
	iters: 200, epoch: 19 | loss: 0.0439883
	speed: 0.0120s/iter; left time: 219.2189s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:02.85s
Steps: 226 | Train Loss: 0.0425621 Vali Loss: 0.0504781 Test Loss: 0.0547615
Validation loss decreased (0.050677 --> 0.050478).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0443324
	speed: 0.0284s/iter; left time: 517.3331s
	iters: 200, epoch: 20 | loss: 0.0498845
	speed: 0.0132s/iter; left time: 238.5692s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0424116 Vali Loss: 0.0505399 Test Loss: 0.0547433
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0421793
	speed: 0.0311s/iter; left time: 559.8406s
	iters: 200, epoch: 21 | loss: 0.0429938
	speed: 0.0119s/iter; left time: 212.0525s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.19s
Steps: 226 | Train Loss: 0.0423381 Vali Loss: 0.0505695 Test Loss: 0.0546886
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0414619
	speed: 0.0274s/iter; left time: 486.8265s
	iters: 200, epoch: 22 | loss: 0.0428697
	speed: 0.0109s/iter; left time: 193.1303s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:02.80s
Steps: 226 | Train Loss: 0.0423087 Vali Loss: 0.0504615 Test Loss: 0.0547043
Validation loss decreased (0.050478 --> 0.050462).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0432623
	speed: 0.0273s/iter; left time: 478.8892s
	iters: 200, epoch: 23 | loss: 0.0416626
	speed: 0.0132s/iter; left time: 230.4555s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.12s
Steps: 226 | Train Loss: 0.0422408 Vali Loss: 0.0504132 Test Loss: 0.0545935
Validation loss decreased (0.050462 --> 0.050413).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0429033
	speed: 0.0276s/iter; left time: 478.1290s
	iters: 200, epoch: 24 | loss: 0.0424754
	speed: 0.0126s/iter; left time: 216.1814s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.03s
Steps: 226 | Train Loss: 0.0422113 Vali Loss: 0.0503552 Test Loss: 0.0545690
Validation loss decreased (0.050413 --> 0.050355).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0423113
	speed: 0.0304s/iter; left time: 518.4762s
	iters: 200, epoch: 25 | loss: 0.0433888
	speed: 0.0114s/iter; left time: 193.2392s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:02.90s
Steps: 226 | Train Loss: 0.0421563 Vali Loss: 0.0502765 Test Loss: 0.0544758
Validation loss decreased (0.050355 --> 0.050276).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0431847
	speed: 0.0268s/iter; left time: 451.9787s
	iters: 200, epoch: 26 | loss: 0.0440871
	speed: 0.0124s/iter; left time: 208.1440s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.07s
Steps: 226 | Train Loss: 0.0420852 Vali Loss: 0.0502675 Test Loss: 0.0544903
Validation loss decreased (0.050276 --> 0.050267).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0451052
	speed: 0.0275s/iter; left time: 457.9538s
	iters: 200, epoch: 27 | loss: 0.0414471
	speed: 0.0127s/iter; left time: 209.5615s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:02.99s
Steps: 226 | Train Loss: 0.0420029 Vali Loss: 0.0502640 Test Loss: 0.0544903
Validation loss decreased (0.050267 --> 0.050264).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0410312
	speed: 0.0275s/iter; left time: 451.0224s
	iters: 200, epoch: 28 | loss: 0.0397029
	speed: 0.0112s/iter; left time: 181.8583s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:02.84s
Steps: 226 | Train Loss: 0.0420169 Vali Loss: 0.0502905 Test Loss: 0.0544227
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0439552
	speed: 0.0268s/iter; left time: 434.0147s
	iters: 200, epoch: 29 | loss: 0.0436785
	speed: 0.0121s/iter; left time: 194.7942s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.00s
Steps: 226 | Train Loss: 0.0420040 Vali Loss: 0.0502262 Test Loss: 0.0544775
Validation loss decreased (0.050264 --> 0.050226).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0386494
	speed: 0.0273s/iter; left time: 435.8998s
	iters: 200, epoch: 30 | loss: 0.0414599
	speed: 0.0114s/iter; left time: 180.3202s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:02.87s
Steps: 226 | Train Loss: 0.0419425 Vali Loss: 0.0501913 Test Loss: 0.0544087
Validation loss decreased (0.050226 --> 0.050191).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0415383
	speed: 0.0284s/iter; left time: 446.9521s
	iters: 200, epoch: 31 | loss: 0.0454751
	speed: 0.0122s/iter; left time: 190.2034s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:02.94s
Steps: 226 | Train Loss: 0.0419474 Vali Loss: 0.0501453 Test Loss: 0.0544220
Validation loss decreased (0.050191 --> 0.050145).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0417625
	speed: 0.0254s/iter; left time: 393.5596s
	iters: 200, epoch: 32 | loss: 0.0423680
	speed: 0.0114s/iter; left time: 175.3526s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:02.73s
Steps: 226 | Train Loss: 0.0418900 Vali Loss: 0.0501593 Test Loss: 0.0543905
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0450227
	speed: 0.0287s/iter; left time: 438.5214s
	iters: 200, epoch: 33 | loss: 0.0442311
	speed: 0.0111s/iter; left time: 168.6886s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:02.82s
Steps: 226 | Train Loss: 0.0418550 Vali Loss: 0.0501616 Test Loss: 0.0544021
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0403130
	speed: 0.0265s/iter; left time: 398.1377s
	iters: 200, epoch: 34 | loss: 0.0437343
	speed: 0.0123s/iter; left time: 184.3483s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:02.97s
Steps: 226 | Train Loss: 0.0418723 Vali Loss: 0.0501117 Test Loss: 0.0543684
Validation loss decreased (0.050145 --> 0.050112).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0398785
	speed: 0.0289s/iter; left time: 428.2609s
	iters: 200, epoch: 35 | loss: 0.0417303
	speed: 0.0115s/iter; left time: 169.1680s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.00s
Steps: 226 | Train Loss: 0.0418444 Vali Loss: 0.0501631 Test Loss: 0.0543461
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0433487
	speed: 0.0281s/iter; left time: 409.7674s
	iters: 200, epoch: 36 | loss: 0.0434720
	speed: 0.0119s/iter; left time: 172.4704s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:02.91s
Steps: 226 | Train Loss: 0.0417718 Vali Loss: 0.0501187 Test Loss: 0.0543627
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0401681
	speed: 0.0268s/iter; left time: 385.0938s
	iters: 200, epoch: 37 | loss: 0.0441142
	speed: 0.0115s/iter; left time: 164.4987s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:02.79s
Steps: 226 | Train Loss: 0.0417959 Vali Loss: 0.0501724 Test Loss: 0.0543492
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0411178
	speed: 0.0272s/iter; left time: 384.8570s
	iters: 200, epoch: 38 | loss: 0.0432949
	speed: 0.0118s/iter; left time: 164.9964s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0417960 Vali Loss: 0.0501164 Test Loss: 0.0543611
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0413207
	speed: 0.0268s/iter; left time: 373.2222s
	iters: 200, epoch: 39 | loss: 0.0395798
	speed: 0.0134s/iter; left time: 185.3978s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.09s
Steps: 226 | Train Loss: 0.0417862 Vali Loss: 0.0501370 Test Loss: 0.0543230
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0393236
	speed: 0.0276s/iter; left time: 378.2623s
	iters: 200, epoch: 40 | loss: 0.0432977
	speed: 0.0140s/iter; left time: 190.7140s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:03.27s
Steps: 226 | Train Loss: 0.0417697 Vali Loss: 0.0501129 Test Loss: 0.0543245
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0413589
	speed: 0.0276s/iter; left time: 371.8289s
	iters: 200, epoch: 41 | loss: 0.0408612
	speed: 0.0118s/iter; left time: 157.1315s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0417722 Vali Loss: 0.0501124 Test Loss: 0.0543231
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0411079
	speed: 0.0275s/iter; left time: 364.1753s
	iters: 200, epoch: 42 | loss: 0.0426689
	speed: 0.0134s/iter; left time: 175.4101s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.04s
Steps: 226 | Train Loss: 0.0417917 Vali Loss: 0.0500473 Test Loss: 0.0543122
Validation loss decreased (0.050112 --> 0.050047).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0426921
	speed: 0.0298s/iter; left time: 387.4994s
	iters: 200, epoch: 43 | loss: 0.0417973
	speed: 0.0127s/iter; left time: 164.1010s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.02s
Steps: 226 | Train Loss: 0.0417330 Vali Loss: 0.0501269 Test Loss: 0.0543233
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0460333
	speed: 0.0263s/iter; left time: 336.7133s
	iters: 200, epoch: 44 | loss: 0.0428604
	speed: 0.0118s/iter; left time: 149.8997s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0417183 Vali Loss: 0.0500891 Test Loss: 0.0543393
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0413917
	speed: 0.0278s/iter; left time: 349.1030s
	iters: 200, epoch: 45 | loss: 0.0451330
	speed: 0.0121s/iter; left time: 150.2750s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:02.94s
Steps: 226 | Train Loss: 0.0417131 Vali Loss: 0.0501954 Test Loss: 0.0542969
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0412224
	speed: 0.0257s/iter; left time: 317.2667s
	iters: 200, epoch: 46 | loss: 0.0388272
	speed: 0.0122s/iter; left time: 149.6360s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:02.80s
Steps: 226 | Train Loss: 0.0417154 Vali Loss: 0.0500848 Test Loss: 0.0543053
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0411421
	speed: 0.0256s/iter; left time: 309.2963s
	iters: 200, epoch: 47 | loss: 0.0433625
	speed: 0.0123s/iter; left time: 147.1452s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:02.93s
Steps: 226 | Train Loss: 0.0416896 Vali Loss: 0.0500637 Test Loss: 0.0543185
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0429682
	speed: 0.0280s/iter; left time: 332.5864s
	iters: 200, epoch: 48 | loss: 0.0388278
	speed: 0.0115s/iter; left time: 135.4371s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:02.99s
Steps: 226 | Train Loss: 0.0417241 Vali Loss: 0.0501448 Test Loss: 0.0543115
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0408700
	speed: 0.0274s/iter; left time: 318.8413s
	iters: 200, epoch: 49 | loss: 0.0415598
	speed: 0.0126s/iter; left time: 145.7730s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:02.96s
Steps: 226 | Train Loss: 0.0417560 Vali Loss: 0.0500766 Test Loss: 0.0543064
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0433627
	speed: 0.0270s/iter; left time: 307.9947s
	iters: 200, epoch: 50 | loss: 0.0431110
	speed: 0.0123s/iter; left time: 139.3977s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:02.88s
Steps: 226 | Train Loss: 0.0417134 Vali Loss: 0.0501223 Test Loss: 0.0543024
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0428324
	speed: 0.0267s/iter; left time: 298.6868s
	iters: 200, epoch: 51 | loss: 0.0426559
	speed: 0.0122s/iter; left time: 134.8948s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:02.97s
Steps: 226 | Train Loss: 0.0417224 Vali Loss: 0.0500905 Test Loss: 0.0542994
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0420346
	speed: 0.0272s/iter; left time: 298.8920s
	iters: 200, epoch: 52 | loss: 0.0446948
	speed: 0.0113s/iter; left time: 122.8232s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:02.91s
Steps: 226 | Train Loss: 0.0417438 Vali Loss: 0.0500549 Test Loss: 0.0543111
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009950376115739346, rmse:0.09975156933069229, mae:0.05431215465068817, rse:0.3848387897014618
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1132520
	speed: 0.0132s/iter; left time: 297.2207s
	iters: 200, epoch: 1 | loss: 0.0936352
	speed: 0.0115s/iter; left time: 257.0075s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:02.84s
Steps: 226 | Train Loss: 0.1100713 Vali Loss: 0.0928013 Test Loss: 0.1021270
Validation loss decreased (inf --> 0.092801).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0561683
	speed: 0.0279s/iter; left time: 621.7909s
	iters: 200, epoch: 2 | loss: 0.0500469
	speed: 0.0119s/iter; left time: 263.9628s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0584609 Vali Loss: 0.0593945 Test Loss: 0.0617017
Validation loss decreased (0.092801 --> 0.059395).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0524821
	speed: 0.0300s/iter; left time: 661.1010s
	iters: 200, epoch: 3 | loss: 0.0518600
	speed: 0.0117s/iter; left time: 257.1392s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.02s
Steps: 226 | Train Loss: 0.0507010 Vali Loss: 0.0567825 Test Loss: 0.0595066
Validation loss decreased (0.059395 --> 0.056782).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0513417
	speed: 0.0290s/iter; left time: 632.3452s
	iters: 200, epoch: 4 | loss: 0.0476954
	speed: 0.0115s/iter; left time: 250.4855s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:02.85s
Steps: 226 | Train Loss: 0.0487247 Vali Loss: 0.0548968 Test Loss: 0.0583465
Validation loss decreased (0.056782 --> 0.054897).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0463436
	speed: 0.0274s/iter; left time: 591.8462s
	iters: 200, epoch: 5 | loss: 0.0457454
	speed: 0.0131s/iter; left time: 280.7838s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.03s
Steps: 226 | Train Loss: 0.0475371 Vali Loss: 0.0540130 Test Loss: 0.0578556
Validation loss decreased (0.054897 --> 0.054013).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0482146
	speed: 0.0287s/iter; left time: 613.4564s
	iters: 200, epoch: 6 | loss: 0.0426126
	speed: 0.0118s/iter; left time: 249.9885s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.04s
Steps: 226 | Train Loss: 0.0466017 Vali Loss: 0.0535288 Test Loss: 0.0573014
Validation loss decreased (0.054013 --> 0.053529).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0471374
	speed: 0.0281s/iter; left time: 594.3587s
	iters: 200, epoch: 7 | loss: 0.0462750
	speed: 0.0129s/iter; left time: 271.1982s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0458805 Vali Loss: 0.0530002 Test Loss: 0.0569769
Validation loss decreased (0.053529 --> 0.053000).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0432870
	speed: 0.0327s/iter; left time: 683.8869s
	iters: 200, epoch: 8 | loss: 0.0464771
	speed: 0.0157s/iter; left time: 327.5047s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0453083 Vali Loss: 0.0525476 Test Loss: 0.0566880
Validation loss decreased (0.053000 --> 0.052548).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0439847
	speed: 0.0334s/iter; left time: 690.6590s
	iters: 200, epoch: 9 | loss: 0.0429174
	speed: 0.0119s/iter; left time: 244.4898s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.21s
Steps: 226 | Train Loss: 0.0448298 Vali Loss: 0.0522136 Test Loss: 0.0562477
Validation loss decreased (0.052548 --> 0.052214).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0473599
	speed: 0.0308s/iter; left time: 629.5455s
	iters: 200, epoch: 10 | loss: 0.0475908
	speed: 0.0141s/iter; left time: 288.0111s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.35s
Steps: 226 | Train Loss: 0.0443794 Vali Loss: 0.0519422 Test Loss: 0.0561186
Validation loss decreased (0.052214 --> 0.051942).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0444583
	speed: 0.0281s/iter; left time: 567.8487s
	iters: 200, epoch: 11 | loss: 0.0427089
	speed: 0.0138s/iter; left time: 277.9358s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0440518 Vali Loss: 0.0515362 Test Loss: 0.0558749
Validation loss decreased (0.051942 --> 0.051536).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0448553
	speed: 0.0275s/iter; left time: 550.6003s
	iters: 200, epoch: 12 | loss: 0.0447962
	speed: 0.0109s/iter; left time: 217.4199s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:02.84s
Steps: 226 | Train Loss: 0.0438076 Vali Loss: 0.0513053 Test Loss: 0.0556109
Validation loss decreased (0.051536 --> 0.051305).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0434728
	speed: 0.0278s/iter; left time: 550.7100s
	iters: 200, epoch: 13 | loss: 0.0442762
	speed: 0.0111s/iter; left time: 219.3322s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:02.82s
Steps: 226 | Train Loss: 0.0434890 Vali Loss: 0.0513953 Test Loss: 0.0555171
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0443075
	speed: 0.0261s/iter; left time: 509.9389s
	iters: 200, epoch: 14 | loss: 0.0430610
	speed: 0.0115s/iter; left time: 224.1380s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:02.76s
Steps: 226 | Train Loss: 0.0432744 Vali Loss: 0.0510744 Test Loss: 0.0554607
Validation loss decreased (0.051305 --> 0.051074).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0478131
	speed: 0.0278s/iter; left time: 538.2221s
	iters: 200, epoch: 15 | loss: 0.0429646
	speed: 0.0122s/iter; left time: 235.0548s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:02.93s
Steps: 226 | Train Loss: 0.0430683 Vali Loss: 0.0510316 Test Loss: 0.0552032
Validation loss decreased (0.051074 --> 0.051032).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0433127
	speed: 0.0278s/iter; left time: 530.7388s
	iters: 200, epoch: 16 | loss: 0.0383054
	speed: 0.0116s/iter; left time: 220.2999s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:02.87s
Steps: 226 | Train Loss: 0.0430262 Vali Loss: 0.0509267 Test Loss: 0.0551992
Validation loss decreased (0.051032 --> 0.050927).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0434445
	speed: 0.0290s/iter; left time: 547.1359s
	iters: 200, epoch: 17 | loss: 0.0434979
	speed: 0.0119s/iter; left time: 223.9480s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:02.95s
Steps: 226 | Train Loss: 0.0427973 Vali Loss: 0.0510822 Test Loss: 0.0551089
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0394827
	speed: 0.0273s/iter; left time: 509.1593s
	iters: 200, epoch: 18 | loss: 0.0379569
	speed: 0.0114s/iter; left time: 211.1277s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0426730 Vali Loss: 0.0507940 Test Loss: 0.0550116
Validation loss decreased (0.050927 --> 0.050794).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0458686
	speed: 0.0291s/iter; left time: 536.9927s
	iters: 200, epoch: 19 | loss: 0.0403266
	speed: 0.0116s/iter; left time: 212.9359s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:02.94s
Steps: 226 | Train Loss: 0.0425948 Vali Loss: 0.0506898 Test Loss: 0.0550069
Validation loss decreased (0.050794 --> 0.050690).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0466481
	speed: 0.0285s/iter; left time: 518.3718s
	iters: 200, epoch: 20 | loss: 0.0429751
	speed: 0.0122s/iter; left time: 220.2748s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.10s
Steps: 226 | Train Loss: 0.0425307 Vali Loss: 0.0506668 Test Loss: 0.0549237
Validation loss decreased (0.050690 --> 0.050667).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0463741
	speed: 0.0276s/iter; left time: 496.2116s
	iters: 200, epoch: 21 | loss: 0.0434584
	speed: 0.0125s/iter; left time: 223.6884s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:02.97s
Steps: 226 | Train Loss: 0.0424368 Vali Loss: 0.0507159 Test Loss: 0.0549146
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0432137
	speed: 0.0270s/iter; left time: 478.9800s
	iters: 200, epoch: 22 | loss: 0.0440204
	speed: 0.0135s/iter; left time: 239.1491s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.07s
Steps: 226 | Train Loss: 0.0423375 Vali Loss: 0.0507138 Test Loss: 0.0549455
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0391456
	speed: 0.0269s/iter; left time: 471.1515s
	iters: 200, epoch: 23 | loss: 0.0456504
	speed: 0.0127s/iter; left time: 221.3429s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:02.93s
Steps: 226 | Train Loss: 0.0423303 Vali Loss: 0.0505761 Test Loss: 0.0547516
Validation loss decreased (0.050667 --> 0.050576).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0495292
	speed: 0.0277s/iter; left time: 479.3011s
	iters: 200, epoch: 24 | loss: 0.0441425
	speed: 0.0131s/iter; left time: 225.6500s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.06s
Steps: 226 | Train Loss: 0.0422179 Vali Loss: 0.0504646 Test Loss: 0.0548036
Validation loss decreased (0.050576 --> 0.050465).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0434198
	speed: 0.0265s/iter; left time: 453.2344s
	iters: 200, epoch: 25 | loss: 0.0399199
	speed: 0.0117s/iter; left time: 198.7763s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0421116 Vali Loss: 0.0505635 Test Loss: 0.0547086
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0391855
	speed: 0.0289s/iter; left time: 486.2451s
	iters: 200, epoch: 26 | loss: 0.0404929
	speed: 0.0113s/iter; left time: 189.8901s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:02.86s
Steps: 226 | Train Loss: 0.0420860 Vali Loss: 0.0504334 Test Loss: 0.0546581
Validation loss decreased (0.050465 --> 0.050433).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0421239
	speed: 0.0288s/iter; left time: 479.4316s
	iters: 200, epoch: 27 | loss: 0.0430600
	speed: 0.0117s/iter; left time: 193.9887s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0420590 Vali Loss: 0.0504060 Test Loss: 0.0546327
Validation loss decreased (0.050433 --> 0.050406).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0418076
	speed: 0.0262s/iter; left time: 429.7771s
	iters: 200, epoch: 28 | loss: 0.0465923
	speed: 0.0110s/iter; left time: 179.8877s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:02.72s
Steps: 226 | Train Loss: 0.0420133 Vali Loss: 0.0503824 Test Loss: 0.0546185
Validation loss decreased (0.050406 --> 0.050382).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0430298
	speed: 0.0268s/iter; left time: 433.2265s
	iters: 200, epoch: 29 | loss: 0.0435396
	speed: 0.0116s/iter; left time: 187.2239s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:02.89s
Steps: 226 | Train Loss: 0.0419836 Vali Loss: 0.0504460 Test Loss: 0.0546655
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0395162
	speed: 0.0268s/iter; left time: 427.9269s
	iters: 200, epoch: 30 | loss: 0.0399079
	speed: 0.0130s/iter; left time: 205.6669s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.07s
Steps: 226 | Train Loss: 0.0419524 Vali Loss: 0.0503811 Test Loss: 0.0545891
Validation loss decreased (0.050382 --> 0.050381).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0434384
	speed: 0.0285s/iter; left time: 447.4180s
	iters: 200, epoch: 31 | loss: 0.0422784
	speed: 0.0114s/iter; left time: 177.7662s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:02.93s
Steps: 226 | Train Loss: 0.0419383 Vali Loss: 0.0504887 Test Loss: 0.0545525
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0440265
	speed: 0.0284s/iter; left time: 440.6071s
	iters: 200, epoch: 32 | loss: 0.0421281
	speed: 0.0110s/iter; left time: 169.6399s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.01s
Steps: 226 | Train Loss: 0.0418608 Vali Loss: 0.0503399 Test Loss: 0.0545567
Validation loss decreased (0.050381 --> 0.050340).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0409427
	speed: 0.0294s/iter; left time: 449.6261s
	iters: 200, epoch: 33 | loss: 0.0411612
	speed: 0.0126s/iter; left time: 191.1955s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.15s
Steps: 226 | Train Loss: 0.0419174 Vali Loss: 0.0503196 Test Loss: 0.0545303
Validation loss decreased (0.050340 --> 0.050320).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0402150
	speed: 0.0267s/iter; left time: 401.9880s
	iters: 200, epoch: 34 | loss: 0.0400097
	speed: 0.0131s/iter; left time: 195.9237s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.00s
Steps: 226 | Train Loss: 0.0418580 Vali Loss: 0.0503860 Test Loss: 0.0545335
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0419727
	speed: 0.0287s/iter; left time: 424.6724s
	iters: 200, epoch: 35 | loss: 0.0405766
	speed: 0.0123s/iter; left time: 180.5289s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.01s
Steps: 226 | Train Loss: 0.0418350 Vali Loss: 0.0503724 Test Loss: 0.0545397
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0433877
	speed: 0.0278s/iter; left time: 405.8178s
	iters: 200, epoch: 36 | loss: 0.0435869
	speed: 0.0116s/iter; left time: 168.6662s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:02.98s
Steps: 226 | Train Loss: 0.0417693 Vali Loss: 0.0502802 Test Loss: 0.0544944
Validation loss decreased (0.050320 --> 0.050280).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0458055
	speed: 0.0283s/iter; left time: 405.9492s
	iters: 200, epoch: 37 | loss: 0.0446754
	speed: 0.0119s/iter; left time: 169.2022s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.01s
Steps: 226 | Train Loss: 0.0418336 Vali Loss: 0.0503019 Test Loss: 0.0545030
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0411173
	speed: 0.0282s/iter; left time: 398.5139s
	iters: 200, epoch: 38 | loss: 0.0411220
	speed: 0.0133s/iter; left time: 186.4709s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.09s
Steps: 226 | Train Loss: 0.0418050 Vali Loss: 0.0503602 Test Loss: 0.0544847
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0413137
	speed: 0.0278s/iter; left time: 387.2038s
	iters: 200, epoch: 39 | loss: 0.0416295
	speed: 0.0125s/iter; left time: 172.9040s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.06s
Steps: 226 | Train Loss: 0.0417889 Vali Loss: 0.0503047 Test Loss: 0.0544787
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0432878
	speed: 0.0281s/iter; left time: 384.8453s
	iters: 200, epoch: 40 | loss: 0.0432607
	speed: 0.0111s/iter; left time: 150.3973s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:02.85s
Steps: 226 | Train Loss: 0.0417856 Vali Loss: 0.0502169 Test Loss: 0.0544858
Validation loss decreased (0.050280 --> 0.050217).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0388566
	speed: 0.0297s/iter; left time: 399.2168s
	iters: 200, epoch: 41 | loss: 0.0415661
	speed: 0.0135s/iter; left time: 180.3718s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:03.28s
Steps: 226 | Train Loss: 0.0417968 Vali Loss: 0.0503313 Test Loss: 0.0544953
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0421035
	speed: 0.0279s/iter; left time: 368.7326s
	iters: 200, epoch: 42 | loss: 0.0378885
	speed: 0.0117s/iter; left time: 154.0075s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:02.99s
Steps: 226 | Train Loss: 0.0417965 Vali Loss: 0.0501956 Test Loss: 0.0544790
Validation loss decreased (0.050217 --> 0.050196).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0376006
	speed: 0.0267s/iter; left time: 347.5844s
	iters: 200, epoch: 43 | loss: 0.0401736
	speed: 0.0114s/iter; left time: 146.5200s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:02.69s
Steps: 226 | Train Loss: 0.0417676 Vali Loss: 0.0502214 Test Loss: 0.0544823
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0423001
	speed: 0.0292s/iter; left time: 372.6998s
	iters: 200, epoch: 44 | loss: 0.0432456
	speed: 0.0123s/iter; left time: 155.8112s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.14s
Steps: 226 | Train Loss: 0.0417521 Vali Loss: 0.0502241 Test Loss: 0.0544708
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0473008
	speed: 0.0268s/iter; left time: 336.7709s
	iters: 200, epoch: 45 | loss: 0.0419766
	speed: 0.0125s/iter; left time: 155.1347s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:02.92s
Steps: 226 | Train Loss: 0.0417417 Vali Loss: 0.0502226 Test Loss: 0.0544550
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0400830
	speed: 0.0257s/iter; left time: 316.9914s
	iters: 200, epoch: 46 | loss: 0.0410218
	speed: 0.0109s/iter; left time: 132.8488s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:02.68s
Steps: 226 | Train Loss: 0.0417677 Vali Loss: 0.0502597 Test Loss: 0.0544538
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0393896
	speed: 0.0263s/iter; left time: 318.7374s
	iters: 200, epoch: 47 | loss: 0.0409002
	speed: 0.0120s/iter; left time: 144.0154s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:02.82s
Steps: 226 | Train Loss: 0.0417359 Vali Loss: 0.0502057 Test Loss: 0.0544625
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0393750
	speed: 0.0262s/iter; left time: 311.5134s
	iters: 200, epoch: 48 | loss: 0.0431451
	speed: 0.0119s/iter; left time: 140.6390s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:02.90s
Steps: 226 | Train Loss: 0.0417638 Vali Loss: 0.0502611 Test Loss: 0.0544590
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0408053
	speed: 0.0261s/iter; left time: 303.7718s
	iters: 200, epoch: 49 | loss: 0.0423045
	speed: 0.0117s/iter; left time: 135.7007s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:02.81s
Steps: 226 | Train Loss: 0.0417316 Vali Loss: 0.0502708 Test Loss: 0.0544587
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0426644
	speed: 0.0275s/iter; left time: 313.6911s
	iters: 200, epoch: 50 | loss: 0.0394742
	speed: 0.0124s/iter; left time: 140.2110s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:02.96s
Steps: 226 | Train Loss: 0.0417384 Vali Loss: 0.0502756 Test Loss: 0.0544553
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0417658
	speed: 0.0281s/iter; left time: 315.2885s
	iters: 200, epoch: 51 | loss: 0.0443871
	speed: 0.0110s/iter; left time: 121.9939s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:02.84s
Steps: 226 | Train Loss: 0.0417456 Vali Loss: 0.0502617 Test Loss: 0.0544569
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0391585
	speed: 0.0267s/iter; left time: 293.0616s
	iters: 200, epoch: 52 | loss: 0.0424905
	speed: 0.0127s/iter; left time: 138.5199s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.03s
Steps: 226 | Train Loss: 0.0417283 Vali Loss: 0.0502521 Test Loss: 0.0544676
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009985145181417465, rmse:0.099925696849823, mae:0.05447903648018837, rse:0.3855105936527252
Intermediate time for FR and pred_len 24: 00h:07m:07.70s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1123679
	speed: 0.0368s/iter; left time: 823.6254s
	iters: 200, epoch: 1 | loss: 0.0958893
	speed: 0.0191s/iter; left time: 424.9553s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.1128916 Vali Loss: 0.0989846 Test Loss: 0.1113308
Validation loss decreased (inf --> 0.098985).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0745022
	speed: 0.0299s/iter; left time: 663.2570s
	iters: 200, epoch: 2 | loss: 0.0712615
	speed: 0.0155s/iter; left time: 343.1709s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0742915 Vali Loss: 0.0767684 Test Loss: 0.0858899
Validation loss decreased (0.098985 --> 0.076768).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0659868
	speed: 0.0292s/iter; left time: 640.4535s
	iters: 200, epoch: 3 | loss: 0.0683075
	speed: 0.0142s/iter; left time: 309.6674s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.20s
Steps: 225 | Train Loss: 0.0667917 Vali Loss: 0.0733530 Test Loss: 0.0831187
Validation loss decreased (0.076768 --> 0.073353).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0611087
	speed: 0.0294s/iter; left time: 639.5643s
	iters: 200, epoch: 4 | loss: 0.0628312
	speed: 0.0154s/iter; left time: 333.3650s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.52s
Steps: 225 | Train Loss: 0.0646899 Vali Loss: 0.0722058 Test Loss: 0.0819560
Validation loss decreased (0.073353 --> 0.072206).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0643648
	speed: 0.0304s/iter; left time: 653.2929s
	iters: 200, epoch: 5 | loss: 0.0637357
	speed: 0.0140s/iter; left time: 300.5680s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.32s
Steps: 225 | Train Loss: 0.0635126 Vali Loss: 0.0712091 Test Loss: 0.0811195
Validation loss decreased (0.072206 --> 0.071209).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0619154
	speed: 0.0295s/iter; left time: 627.6468s
	iters: 200, epoch: 6 | loss: 0.0602226
	speed: 0.0145s/iter; left time: 306.2938s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.44s
Steps: 225 | Train Loss: 0.0626181 Vali Loss: 0.0708816 Test Loss: 0.0805953
Validation loss decreased (0.071209 --> 0.070882).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0573235
	speed: 0.0315s/iter; left time: 662.3238s
	iters: 200, epoch: 7 | loss: 0.0595317
	speed: 0.0144s/iter; left time: 301.9348s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.60s
Steps: 225 | Train Loss: 0.0619120 Vali Loss: 0.0703958 Test Loss: 0.0801718
Validation loss decreased (0.070882 --> 0.070396).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0658628
	speed: 0.0313s/iter; left time: 652.1954s
	iters: 200, epoch: 8 | loss: 0.0633189
	speed: 0.0138s/iter; left time: 286.9200s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0613964 Vali Loss: 0.0702106 Test Loss: 0.0801473
Validation loss decreased (0.070396 --> 0.070211).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0600250
	speed: 0.0294s/iter; left time: 605.1540s
	iters: 200, epoch: 9 | loss: 0.0614435
	speed: 0.0146s/iter; left time: 298.5722s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.39s
Steps: 225 | Train Loss: 0.0609292 Vali Loss: 0.0699040 Test Loss: 0.0799337
Validation loss decreased (0.070211 --> 0.069904).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0612160
	speed: 0.0299s/iter; left time: 610.1638s
	iters: 200, epoch: 10 | loss: 0.0641046
	speed: 0.0140s/iter; left time: 284.0547s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.43s
Steps: 225 | Train Loss: 0.0605648 Vali Loss: 0.0696879 Test Loss: 0.0796519
Validation loss decreased (0.069904 --> 0.069688).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0595196
	speed: 0.0293s/iter; left time: 591.3284s
	iters: 200, epoch: 11 | loss: 0.0624229
	speed: 0.0135s/iter; left time: 270.9274s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.23s
Steps: 225 | Train Loss: 0.0602561 Vali Loss: 0.0694851 Test Loss: 0.0793414
Validation loss decreased (0.069688 --> 0.069485).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0597834
	speed: 0.0298s/iter; left time: 593.3318s
	iters: 200, epoch: 12 | loss: 0.0628897
	speed: 0.0145s/iter; left time: 286.8973s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.39s
Steps: 225 | Train Loss: 0.0599916 Vali Loss: 0.0693257 Test Loss: 0.0792334
Validation loss decreased (0.069485 --> 0.069326).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0558545
	speed: 0.0301s/iter; left time: 592.0259s
	iters: 200, epoch: 13 | loss: 0.0633420
	speed: 0.0146s/iter; left time: 286.3185s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.40s
Steps: 225 | Train Loss: 0.0597048 Vali Loss: 0.0692271 Test Loss: 0.0793881
Validation loss decreased (0.069326 --> 0.069227).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0623547
	speed: 0.0304s/iter; left time: 591.3906s
	iters: 200, epoch: 14 | loss: 0.0607159
	speed: 0.0148s/iter; left time: 286.5679s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.46s
Steps: 225 | Train Loss: 0.0595040 Vali Loss: 0.0691486 Test Loss: 0.0791799
Validation loss decreased (0.069227 --> 0.069149).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0574526
	speed: 0.0282s/iter; left time: 542.7165s
	iters: 200, epoch: 15 | loss: 0.0585850
	speed: 0.0125s/iter; left time: 239.5664s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.05s
Steps: 225 | Train Loss: 0.0592926 Vali Loss: 0.0690939 Test Loss: 0.0789895
Validation loss decreased (0.069149 --> 0.069094).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0594159
	speed: 0.0278s/iter; left time: 528.4335s
	iters: 200, epoch: 16 | loss: 0.0593273
	speed: 0.0131s/iter; left time: 247.8924s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.11s
Steps: 225 | Train Loss: 0.0591808 Vali Loss: 0.0690333 Test Loss: 0.0789739
Validation loss decreased (0.069094 --> 0.069033).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0589404
	speed: 0.0312s/iter; left time: 586.7048s
	iters: 200, epoch: 17 | loss: 0.0600491
	speed: 0.0145s/iter; left time: 271.7117s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0589729 Vali Loss: 0.0689332 Test Loss: 0.0788983
Validation loss decreased (0.069033 --> 0.068933).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0599934
	speed: 0.0300s/iter; left time: 556.4016s
	iters: 200, epoch: 18 | loss: 0.0601626
	speed: 0.0142s/iter; left time: 262.6730s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0588744 Vali Loss: 0.0689585 Test Loss: 0.0789438
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0574171
	speed: 0.0301s/iter; left time: 552.2804s
	iters: 200, epoch: 19 | loss: 0.0597989
	speed: 0.0142s/iter; left time: 259.8038s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.46s
Steps: 225 | Train Loss: 0.0587569 Vali Loss: 0.0688923 Test Loss: 0.0789166
Validation loss decreased (0.068933 --> 0.068892).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0599075
	speed: 0.0318s/iter; left time: 576.1903s
	iters: 200, epoch: 20 | loss: 0.0607334
	speed: 0.0144s/iter; left time: 260.3306s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.57s
Steps: 225 | Train Loss: 0.0586495 Vali Loss: 0.0688203 Test Loss: 0.0789143
Validation loss decreased (0.068892 --> 0.068820).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0559591
	speed: 0.0300s/iter; left time: 537.8844s
	iters: 200, epoch: 21 | loss: 0.0560985
	speed: 0.0136s/iter; left time: 242.1900s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.23s
Steps: 225 | Train Loss: 0.0585981 Vali Loss: 0.0689306 Test Loss: 0.0788465
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0595138
	speed: 0.0290s/iter; left time: 512.5853s
	iters: 200, epoch: 22 | loss: 0.0625688
	speed: 0.0151s/iter; left time: 265.3506s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.0584874 Vali Loss: 0.0688657 Test Loss: 0.0787652
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0635147
	speed: 0.0295s/iter; left time: 515.2432s
	iters: 200, epoch: 23 | loss: 0.0556708
	speed: 0.0137s/iter; left time: 237.6141s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.27s
Steps: 225 | Train Loss: 0.0584421 Vali Loss: 0.0688052 Test Loss: 0.0788075
Validation loss decreased (0.068820 --> 0.068805).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0591203
	speed: 0.0308s/iter; left time: 530.1169s
	iters: 200, epoch: 24 | loss: 0.0588287
	speed: 0.0145s/iter; left time: 247.6009s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.45s
Steps: 225 | Train Loss: 0.0583241 Vali Loss: 0.0688512 Test Loss: 0.0787713
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0583268
	speed: 0.0289s/iter; left time: 491.5857s
	iters: 200, epoch: 25 | loss: 0.0582507
	speed: 0.0149s/iter; left time: 252.1880s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:03.46s
Steps: 225 | Train Loss: 0.0583419 Vali Loss: 0.0687748 Test Loss: 0.0787924
Validation loss decreased (0.068805 --> 0.068775).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0603914
	speed: 0.0310s/iter; left time: 519.6890s
	iters: 200, epoch: 26 | loss: 0.0552229
	speed: 0.0158s/iter; left time: 263.1600s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.54s
Steps: 225 | Train Loss: 0.0582278 Vali Loss: 0.0688510 Test Loss: 0.0787250
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0577940
	speed: 0.0299s/iter; left time: 495.3489s
	iters: 200, epoch: 27 | loss: 0.0601696
	speed: 0.0150s/iter; left time: 246.5478s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.53s
Steps: 225 | Train Loss: 0.0582012 Vali Loss: 0.0688192 Test Loss: 0.0786948
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0578605
	speed: 0.0294s/iter; left time: 480.7478s
	iters: 200, epoch: 28 | loss: 0.0600844
	speed: 0.0147s/iter; left time: 238.6222s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:03.42s
Steps: 225 | Train Loss: 0.0581673 Vali Loss: 0.0688492 Test Loss: 0.0787168
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0583453
	speed: 0.0299s/iter; left time: 480.8207s
	iters: 200, epoch: 29 | loss: 0.0567716
	speed: 0.0155s/iter; left time: 247.4834s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0581208 Vali Loss: 0.0688215 Test Loss: 0.0787646
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0565776
	speed: 0.0270s/iter; left time: 428.6058s
	iters: 200, epoch: 30 | loss: 0.0572355
	speed: 0.0122s/iter; left time: 191.8745s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:02.90s
Steps: 225 | Train Loss: 0.0581081 Vali Loss: 0.0688053 Test Loss: 0.0787088
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0574476
	speed: 0.0281s/iter; left time: 439.2139s
	iters: 200, epoch: 31 | loss: 0.0602526
	speed: 0.0118s/iter; left time: 183.4216s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.01s
Steps: 225 | Train Loss: 0.0580495 Vali Loss: 0.0688045 Test Loss: 0.0786794
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0563497
	speed: 0.0262s/iter; left time: 404.6826s
	iters: 200, epoch: 32 | loss: 0.0547948
	speed: 0.0159s/iter; left time: 243.8859s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:03.42s
Steps: 225 | Train Loss: 0.0580019 Vali Loss: 0.0688197 Test Loss: 0.0786736
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0594476
	speed: 0.0313s/iter; left time: 475.3239s
	iters: 200, epoch: 33 | loss: 0.0562596
	speed: 0.0155s/iter; left time: 233.8439s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0580157 Vali Loss: 0.0687966 Test Loss: 0.0787213
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0581558
	speed: 0.0301s/iter; left time: 450.2101s
	iters: 200, epoch: 34 | loss: 0.0557810
	speed: 0.0138s/iter; left time: 205.9344s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.38s
Steps: 225 | Train Loss: 0.0579935 Vali Loss: 0.0687963 Test Loss: 0.0786681
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0563106
	speed: 0.0292s/iter; left time: 430.2525s
	iters: 200, epoch: 35 | loss: 0.0524707
	speed: 0.0144s/iter; left time: 211.2295s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.27s
Steps: 225 | Train Loss: 0.0579753 Vali Loss: 0.0687898 Test Loss: 0.0786819
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0190742090344429, rmse:0.13810941576957703, mae:0.07879239320755005, rse:0.5342438817024231
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1166308
	speed: 0.0159s/iter; left time: 355.2066s
	iters: 200, epoch: 1 | loss: 0.0994046
	speed: 0.0146s/iter; left time: 326.4472s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.48s
Steps: 225 | Train Loss: 0.1117094 Vali Loss: 0.0984777 Test Loss: 0.1107020
Validation loss decreased (inf --> 0.098478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0687049
	speed: 0.0310s/iter; left time: 688.1168s
	iters: 200, epoch: 2 | loss: 0.0646807
	speed: 0.0152s/iter; left time: 334.8703s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.42s
Steps: 225 | Train Loss: 0.0741771 Vali Loss: 0.0772416 Test Loss: 0.0861534
Validation loss decreased (0.098478 --> 0.077242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0712700
	speed: 0.0307s/iter; left time: 674.4700s
	iters: 200, epoch: 3 | loss: 0.0663007
	speed: 0.0142s/iter; left time: 310.0810s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0670107 Vali Loss: 0.0735325 Test Loss: 0.0832724
Validation loss decreased (0.077242 --> 0.073533).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0639523
	speed: 0.0304s/iter; left time: 660.3264s
	iters: 200, epoch: 4 | loss: 0.0674347
	speed: 0.0146s/iter; left time: 315.9519s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.46s
Steps: 225 | Train Loss: 0.0648524 Vali Loss: 0.0721268 Test Loss: 0.0823177
Validation loss decreased (0.073533 --> 0.072127).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0598700
	speed: 0.0316s/iter; left time: 680.2964s
	iters: 200, epoch: 5 | loss: 0.0624903
	speed: 0.0137s/iter; left time: 292.8257s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.37s
Steps: 225 | Train Loss: 0.0635970 Vali Loss: 0.0713102 Test Loss: 0.0813186
Validation loss decreased (0.072127 --> 0.071310).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0572047
	speed: 0.0304s/iter; left time: 647.7199s
	iters: 200, epoch: 6 | loss: 0.0654277
	speed: 0.0137s/iter; left time: 290.0052s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.33s
Steps: 225 | Train Loss: 0.0626289 Vali Loss: 0.0707619 Test Loss: 0.0812851
Validation loss decreased (0.071310 --> 0.070762).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0640521
	speed: 0.0322s/iter; left time: 677.7879s
	iters: 200, epoch: 7 | loss: 0.0631458
	speed: 0.0140s/iter; left time: 292.7822s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:03.55s
Steps: 225 | Train Loss: 0.0619283 Vali Loss: 0.0702095 Test Loss: 0.0806952
Validation loss decreased (0.070762 --> 0.070209).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0586155
	speed: 0.0303s/iter; left time: 630.4248s
	iters: 200, epoch: 8 | loss: 0.0610592
	speed: 0.0125s/iter; left time: 259.7109s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:03.22s
Steps: 225 | Train Loss: 0.0613886 Vali Loss: 0.0699927 Test Loss: 0.0804892
Validation loss decreased (0.070209 --> 0.069993).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0590662
	speed: 0.0295s/iter; left time: 607.9826s
	iters: 200, epoch: 9 | loss: 0.0599735
	speed: 0.0135s/iter; left time: 276.1371s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:03.24s
Steps: 225 | Train Loss: 0.0609320 Vali Loss: 0.0695000 Test Loss: 0.0799430
Validation loss decreased (0.069993 --> 0.069500).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0586988
	speed: 0.0293s/iter; left time: 597.5257s
	iters: 200, epoch: 10 | loss: 0.0605690
	speed: 0.0121s/iter; left time: 245.6419s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:02.99s
Steps: 225 | Train Loss: 0.0605663 Vali Loss: 0.0694764 Test Loss: 0.0797163
Validation loss decreased (0.069500 --> 0.069476).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0579402
	speed: 0.0278s/iter; left time: 560.6244s
	iters: 200, epoch: 11 | loss: 0.0572975
	speed: 0.0127s/iter; left time: 254.9129s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.01s
Steps: 225 | Train Loss: 0.0602539 Vali Loss: 0.0695163 Test Loss: 0.0795091
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0620443
	speed: 0.0278s/iter; left time: 554.5792s
	iters: 200, epoch: 12 | loss: 0.0597114
	speed: 0.0126s/iter; left time: 249.0868s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:03.00s
Steps: 225 | Train Loss: 0.0599766 Vali Loss: 0.0692275 Test Loss: 0.0796349
Validation loss decreased (0.069476 --> 0.069227).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0643581
	speed: 0.0307s/iter; left time: 604.3868s
	iters: 200, epoch: 13 | loss: 0.0598506
	speed: 0.0127s/iter; left time: 249.7391s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:03.08s
Steps: 225 | Train Loss: 0.0596898 Vali Loss: 0.0689855 Test Loss: 0.0796881
Validation loss decreased (0.069227 --> 0.068986).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0596512
	speed: 0.0287s/iter; left time: 558.9535s
	iters: 200, epoch: 14 | loss: 0.0564288
	speed: 0.0193s/iter; left time: 374.7061s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0595472 Vali Loss: 0.0690365 Test Loss: 0.0794910
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0556980
	speed: 0.0384s/iter; left time: 739.9536s
	iters: 200, epoch: 15 | loss: 0.0596696
	speed: 0.0159s/iter; left time: 303.6461s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0593626 Vali Loss: 0.0688358 Test Loss: 0.0795370
Validation loss decreased (0.068986 --> 0.068836).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0549609
	speed: 0.0346s/iter; left time: 658.5274s
	iters: 200, epoch: 16 | loss: 0.0632015
	speed: 0.0176s/iter; left time: 333.0713s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:03.98s
Steps: 225 | Train Loss: 0.0592233 Vali Loss: 0.0688676 Test Loss: 0.0792973
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0562952
	speed: 0.0360s/iter; left time: 676.4448s
	iters: 200, epoch: 17 | loss: 0.0567398
	speed: 0.0190s/iter; left time: 355.0403s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0590819 Vali Loss: 0.0688663 Test Loss: 0.0794996
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0627169
	speed: 0.0368s/iter; left time: 683.1355s
	iters: 200, epoch: 18 | loss: 0.0635834
	speed: 0.0186s/iter; left time: 343.2976s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.0588690 Vali Loss: 0.0687865 Test Loss: 0.0791472
Validation loss decreased (0.068836 --> 0.068786).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0616352
	speed: 0.0353s/iter; left time: 648.4132s
	iters: 200, epoch: 19 | loss: 0.0590960
	speed: 0.0164s/iter; left time: 298.7639s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0588683 Vali Loss: 0.0687898 Test Loss: 0.0792912
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0610490
	speed: 0.0321s/iter; left time: 582.4944s
	iters: 200, epoch: 20 | loss: 0.0584898
	speed: 0.0136s/iter; left time: 245.0197s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:03.56s
Steps: 225 | Train Loss: 0.0587853 Vali Loss: 0.0687302 Test Loss: 0.0791306
Validation loss decreased (0.068786 --> 0.068730).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0583889
	speed: 0.0369s/iter; left time: 661.3062s
	iters: 200, epoch: 21 | loss: 0.0628211
	speed: 0.0122s/iter; left time: 217.6094s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.66s
Steps: 225 | Train Loss: 0.0586868 Vali Loss: 0.0687014 Test Loss: 0.0791981
Validation loss decreased (0.068730 --> 0.068701).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0587090
	speed: 0.0343s/iter; left time: 605.6964s
	iters: 200, epoch: 22 | loss: 0.0551478
	speed: 0.0176s/iter; left time: 309.5371s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0585566 Vali Loss: 0.0686361 Test Loss: 0.0792414
Validation loss decreased (0.068701 --> 0.068636).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0580032
	speed: 0.0365s/iter; left time: 636.1141s
	iters: 200, epoch: 23 | loss: 0.0596124
	speed: 0.0216s/iter; left time: 375.5582s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0585786 Vali Loss: 0.0686573 Test Loss: 0.0791250
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0593962
	speed: 0.0341s/iter; left time: 586.5833s
	iters: 200, epoch: 24 | loss: 0.0610090
	speed: 0.0186s/iter; left time: 317.9300s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.05s
Steps: 225 | Train Loss: 0.0584186 Vali Loss: 0.0686477 Test Loss: 0.0791397
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0564482
	speed: 0.0344s/iter; left time: 584.3063s
	iters: 200, epoch: 25 | loss: 0.0560195
	speed: 0.0201s/iter; left time: 339.9757s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0583797 Vali Loss: 0.0685837 Test Loss: 0.0791009
Validation loss decreased (0.068636 --> 0.068584).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0605035
	speed: 0.0330s/iter; left time: 553.4683s
	iters: 200, epoch: 26 | loss: 0.0577445
	speed: 0.0185s/iter; left time: 308.7116s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0583410 Vali Loss: 0.0685910 Test Loss: 0.0791649
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0584437
	speed: 0.0342s/iter; left time: 565.2720s
	iters: 200, epoch: 27 | loss: 0.0561151
	speed: 0.0183s/iter; left time: 300.3774s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.29s
Steps: 225 | Train Loss: 0.0582971 Vali Loss: 0.0685541 Test Loss: 0.0791507
Validation loss decreased (0.068584 --> 0.068554).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0558530
	speed: 0.0352s/iter; left time: 573.8647s
	iters: 200, epoch: 28 | loss: 0.0564394
	speed: 0.0171s/iter; left time: 277.6879s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.08s
Steps: 225 | Train Loss: 0.0582924 Vali Loss: 0.0686031 Test Loss: 0.0790981
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0609890
	speed: 0.0321s/iter; left time: 516.7603s
	iters: 200, epoch: 29 | loss: 0.0533565
	speed: 0.0162s/iter; left time: 259.1166s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.81s
Steps: 225 | Train Loss: 0.0582134 Vali Loss: 0.0685947 Test Loss: 0.0790453
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0584938
	speed: 0.0349s/iter; left time: 553.8667s
	iters: 200, epoch: 30 | loss: 0.0573765
	speed: 0.0175s/iter; left time: 276.4547s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0582150 Vali Loss: 0.0685356 Test Loss: 0.0789865
Validation loss decreased (0.068554 --> 0.068536).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0600751
	speed: 0.0314s/iter; left time: 490.7125s
	iters: 200, epoch: 31 | loss: 0.0535122
	speed: 0.0156s/iter; left time: 242.2622s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:03.42s
Steps: 225 | Train Loss: 0.0581959 Vali Loss: 0.0685362 Test Loss: 0.0790093
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0585135
	speed: 0.0328s/iter; left time: 506.1256s
	iters: 200, epoch: 32 | loss: 0.0575287
	speed: 0.0189s/iter; left time: 289.0031s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0581202 Vali Loss: 0.0685129 Test Loss: 0.0790591
Validation loss decreased (0.068536 --> 0.068513).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0580706
	speed: 0.0356s/iter; left time: 541.7282s
	iters: 200, epoch: 33 | loss: 0.0604630
	speed: 0.0184s/iter; left time: 278.5726s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0581116 Vali Loss: 0.0685235 Test Loss: 0.0790510
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0582404
	speed: 0.0341s/iter; left time: 511.3092s
	iters: 200, epoch: 34 | loss: 0.0577914
	speed: 0.0210s/iter; left time: 312.6490s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0580539 Vali Loss: 0.0685138 Test Loss: 0.0790187
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0584563
	speed: 0.0364s/iter; left time: 536.4841s
	iters: 200, epoch: 35 | loss: 0.0595547
	speed: 0.0155s/iter; left time: 227.8006s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.92s
Steps: 225 | Train Loss: 0.0580781 Vali Loss: 0.0685244 Test Loss: 0.0790781
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0601649
	speed: 0.0338s/iter; left time: 491.5926s
	iters: 200, epoch: 36 | loss: 0.0602529
	speed: 0.0210s/iter; left time: 303.1779s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0580418 Vali Loss: 0.0685017 Test Loss: 0.0790352
Validation loss decreased (0.068513 --> 0.068502).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0571623
	speed: 0.0419s/iter; left time: 598.8166s
	iters: 200, epoch: 37 | loss: 0.0578815
	speed: 0.0212s/iter; left time: 300.7923s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.28s
Steps: 225 | Train Loss: 0.0580344 Vali Loss: 0.0685067 Test Loss: 0.0790283
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0573594
	speed: 0.0360s/iter; left time: 507.2722s
	iters: 200, epoch: 38 | loss: 0.0590343
	speed: 0.0158s/iter; left time: 221.1354s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.0580271 Vali Loss: 0.0685113 Test Loss: 0.0789837
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0553383
	speed: 0.0376s/iter; left time: 520.1840s
	iters: 200, epoch: 39 | loss: 0.0529877
	speed: 0.0152s/iter; left time: 208.8151s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.21s
Steps: 225 | Train Loss: 0.0580175 Vali Loss: 0.0685062 Test Loss: 0.0790252
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0592485
	speed: 0.0342s/iter; left time: 465.9658s
	iters: 200, epoch: 40 | loss: 0.0586444
	speed: 0.0172s/iter; left time: 232.7820s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.17s
Steps: 225 | Train Loss: 0.0579980 Vali Loss: 0.0684937 Test Loss: 0.0790323
Validation loss decreased (0.068502 --> 0.068494).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0628458
	speed: 0.0370s/iter; left time: 495.8552s
	iters: 200, epoch: 41 | loss: 0.0581595
	speed: 0.0167s/iter; left time: 222.2707s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0579853 Vali Loss: 0.0684993 Test Loss: 0.0790148
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0597324
	speed: 0.0307s/iter; left time: 404.9280s
	iters: 200, epoch: 42 | loss: 0.0543683
	speed: 0.0181s/iter; left time: 236.8525s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.96s
Steps: 225 | Train Loss: 0.0580027 Vali Loss: 0.0685095 Test Loss: 0.0790117
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0602942
	speed: 0.0344s/iter; left time: 445.4938s
	iters: 200, epoch: 43 | loss: 0.0588281
	speed: 0.0170s/iter; left time: 218.3892s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0579897 Vali Loss: 0.0685076 Test Loss: 0.0789774
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0577775
	speed: 0.0354s/iter; left time: 450.6939s
	iters: 200, epoch: 44 | loss: 0.0578619
	speed: 0.0146s/iter; left time: 184.1668s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:03.88s
Steps: 225 | Train Loss: 0.0579762 Vali Loss: 0.0685071 Test Loss: 0.0790132
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0587692
	speed: 0.0285s/iter; left time: 356.2176s
	iters: 200, epoch: 45 | loss: 0.0575636
	speed: 0.0171s/iter; left time: 211.9441s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:03.58s
Steps: 225 | Train Loss: 0.0579338 Vali Loss: 0.0685000 Test Loss: 0.0790003
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0571148
	speed: 0.0347s/iter; left time: 426.0458s
	iters: 200, epoch: 46 | loss: 0.0616274
	speed: 0.0154s/iter; left time: 187.6902s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:03.80s
Steps: 225 | Train Loss: 0.0580003 Vali Loss: 0.0684827 Test Loss: 0.0790229
Validation loss decreased (0.068494 --> 0.068483).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0560301
	speed: 0.0333s/iter; left time: 401.3574s
	iters: 200, epoch: 47 | loss: 0.0598776
	speed: 0.0145s/iter; left time: 173.6396s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.00s
Steps: 225 | Train Loss: 0.0579353 Vali Loss: 0.0684818 Test Loss: 0.0790140
Validation loss decreased (0.068483 --> 0.068482).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0621192
	speed: 0.0364s/iter; left time: 431.0097s
	iters: 200, epoch: 48 | loss: 0.0558696
	speed: 0.0180s/iter; left time: 211.2700s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0579430 Vali Loss: 0.0684988 Test Loss: 0.0790144
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0549243
	speed: 0.0354s/iter; left time: 411.1534s
	iters: 200, epoch: 49 | loss: 0.0607253
	speed: 0.0200s/iter; left time: 230.2264s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.0579465 Vali Loss: 0.0684958 Test Loss: 0.0789943
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0580601
	speed: 0.0360s/iter; left time: 409.2362s
	iters: 200, epoch: 50 | loss: 0.0604288
	speed: 0.0216s/iter; left time: 243.6591s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.72s
Steps: 225 | Train Loss: 0.0578998 Vali Loss: 0.0684910 Test Loss: 0.0790050
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0581676
	speed: 0.0343s/iter; left time: 382.0332s
	iters: 200, epoch: 51 | loss: 0.0585575
	speed: 0.0185s/iter; left time: 204.3241s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.22s
Steps: 225 | Train Loss: 0.0579432 Vali Loss: 0.0684809 Test Loss: 0.0790085
Validation loss decreased (0.068482 --> 0.068481).  Saving model ...
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0603360
	speed: 0.0393s/iter; left time: 429.5871s
	iters: 200, epoch: 52 | loss: 0.0584841
	speed: 0.0237s/iter; left time: 256.9186s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.39s
Steps: 225 | Train Loss: 0.0579319 Vali Loss: 0.0684904 Test Loss: 0.0789994
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0585743
	speed: 0.0372s/iter; left time: 397.6573s
	iters: 200, epoch: 53 | loss: 0.0588034
	speed: 0.0192s/iter; left time: 203.8414s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.0579132 Vali Loss: 0.0684941 Test Loss: 0.0790057
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0557282
	speed: 0.0357s/iter; left time: 373.8456s
	iters: 200, epoch: 54 | loss: 0.0613860
	speed: 0.0172s/iter; left time: 178.3674s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.42s
Steps: 225 | Train Loss: 0.0579653 Vali Loss: 0.0685006 Test Loss: 0.0789996
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0585939
	speed: 0.0368s/iter; left time: 376.8087s
	iters: 200, epoch: 55 | loss: 0.0651440
	speed: 0.0153s/iter; left time: 154.9025s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0579389 Vali Loss: 0.0684873 Test Loss: 0.0790061
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0619266
	speed: 0.0351s/iter; left time: 351.5120s
	iters: 200, epoch: 56 | loss: 0.0551651
	speed: 0.0203s/iter; left time: 201.4826s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.55s
Steps: 225 | Train Loss: 0.0579282 Vali Loss: 0.0684934 Test Loss: 0.0789854
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0585389
	speed: 0.0339s/iter; left time: 332.6475s
	iters: 200, epoch: 57 | loss: 0.0609670
	speed: 0.0187s/iter; left time: 181.5152s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.26s
Steps: 225 | Train Loss: 0.0579366 Vali Loss: 0.0684922 Test Loss: 0.0789980
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0598860
	speed: 0.0352s/iter; left time: 337.3262s
	iters: 200, epoch: 58 | loss: 0.0599037
	speed: 0.0192s/iter; left time: 182.0973s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0579010 Vali Loss: 0.0684900 Test Loss: 0.0789935
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0599850
	speed: 0.0360s/iter; left time: 336.9727s
	iters: 200, epoch: 59 | loss: 0.0567161
	speed: 0.0183s/iter; left time: 169.4103s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.0579170 Vali Loss: 0.0685022 Test Loss: 0.0789889
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0599660
	speed: 0.0346s/iter; left time: 316.1463s
	iters: 200, epoch: 60 | loss: 0.0574773
	speed: 0.0191s/iter; left time: 172.0093s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0579000 Vali Loss: 0.0684907 Test Loss: 0.0789931
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0555947
	speed: 0.0367s/iter; left time: 326.8183s
	iters: 200, epoch: 61 | loss: 0.0567072
	speed: 0.0197s/iter; left time: 173.1108s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.67s
Steps: 225 | Train Loss: 0.0579001 Vali Loss: 0.0684961 Test Loss: 0.0790021
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019269950687885284, rmse:0.1388162523508072, mae:0.07900849729776382, rse:0.5369781255722046
Intermediate time for FR and pred_len 96: 00h:07m:56.48s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1178433
	speed: 0.0442s/iter; left time: 990.4424s
	iters: 200, epoch: 1 | loss: 0.0979904
	speed: 0.0151s/iter; left time: 335.9293s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:03.99s
Steps: 225 | Train Loss: 0.1161686 Vali Loss: 0.1026122 Test Loss: 0.1144287
Validation loss decreased (inf --> 0.102612).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0802685
	speed: 0.0318s/iter; left time: 705.8233s
	iters: 200, epoch: 2 | loss: 0.0758796
	speed: 0.0206s/iter; left time: 453.9611s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.35s
Steps: 225 | Train Loss: 0.0786359 Vali Loss: 0.0817531 Test Loss: 0.0914209
Validation loss decreased (0.102612 --> 0.081753).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0686616
	speed: 0.0396s/iter; left time: 869.3379s
	iters: 200, epoch: 3 | loss: 0.0681255
	speed: 0.0236s/iter; left time: 515.7433s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.45s
Steps: 225 | Train Loss: 0.0712700 Vali Loss: 0.0772329 Test Loss: 0.0881135
Validation loss decreased (0.081753 --> 0.077233).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0735443
	speed: 0.0391s/iter; left time: 848.8578s
	iters: 200, epoch: 4 | loss: 0.0703870
	speed: 0.0260s/iter; left time: 561.6474s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.43s
Steps: 225 | Train Loss: 0.0689783 Vali Loss: 0.0761214 Test Loss: 0.0871739
Validation loss decreased (0.077233 --> 0.076121).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0685207
	speed: 0.0397s/iter; left time: 854.0756s
	iters: 200, epoch: 5 | loss: 0.0634067
	speed: 0.0196s/iter; left time: 418.5965s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.62s
Steps: 225 | Train Loss: 0.0678461 Vali Loss: 0.0758394 Test Loss: 0.0865922
Validation loss decreased (0.076121 --> 0.075839).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0663654
	speed: 0.0347s/iter; left time: 737.2492s
	iters: 200, epoch: 6 | loss: 0.0719434
	speed: 0.0148s/iter; left time: 313.6845s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:03.78s
Steps: 225 | Train Loss: 0.0670404 Vali Loss: 0.0752677 Test Loss: 0.0862171
Validation loss decreased (0.075839 --> 0.075268).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0663606
	speed: 0.0406s/iter; left time: 854.5411s
	iters: 200, epoch: 7 | loss: 0.0665885
	speed: 0.0240s/iter; left time: 503.5008s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.39s
Steps: 225 | Train Loss: 0.0664133 Vali Loss: 0.0750782 Test Loss: 0.0859377
Validation loss decreased (0.075268 --> 0.075078).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0610192
	speed: 0.0403s/iter; left time: 838.8842s
	iters: 200, epoch: 8 | loss: 0.0643330
	speed: 0.0140s/iter; left time: 291.0092s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.00s
Steps: 225 | Train Loss: 0.0659399 Vali Loss: 0.0749717 Test Loss: 0.0858859
Validation loss decreased (0.075078 --> 0.074972).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0677186
	speed: 0.0362s/iter; left time: 746.3905s
	iters: 200, epoch: 9 | loss: 0.0667564
	speed: 0.0157s/iter; left time: 321.6059s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.0655065 Vali Loss: 0.0745897 Test Loss: 0.0855368
Validation loss decreased (0.074972 --> 0.074590).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0658022
	speed: 0.0340s/iter; left time: 693.1290s
	iters: 200, epoch: 10 | loss: 0.0643987
	speed: 0.0175s/iter; left time: 354.2846s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.03s
Steps: 225 | Train Loss: 0.0651897 Vali Loss: 0.0747029 Test Loss: 0.0855107
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0664462
	speed: 0.0326s/iter; left time: 657.3021s
	iters: 200, epoch: 11 | loss: 0.0612322
	speed: 0.0131s/iter; left time: 261.9434s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:03.49s
Steps: 225 | Train Loss: 0.0649022 Vali Loss: 0.0745873 Test Loss: 0.0857235
Validation loss decreased (0.074590 --> 0.074587).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0639878
	speed: 0.0313s/iter; left time: 623.6526s
	iters: 200, epoch: 12 | loss: 0.0650366
	speed: 0.0104s/iter; left time: 206.9734s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:02.86s
Steps: 225 | Train Loss: 0.0645888 Vali Loss: 0.0743928 Test Loss: 0.0858431
Validation loss decreased (0.074587 --> 0.074393).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0629034
	speed: 0.0336s/iter; left time: 662.0700s
	iters: 200, epoch: 13 | loss: 0.0618235
	speed: 0.0180s/iter; left time: 352.6492s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.48s
Steps: 225 | Train Loss: 0.0643678 Vali Loss: 0.0744177 Test Loss: 0.0855179
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0662641
	speed: 0.0380s/iter; left time: 739.7201s
	iters: 200, epoch: 14 | loss: 0.0653053
	speed: 0.0193s/iter; left time: 374.6490s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.56s
Steps: 225 | Train Loss: 0.0641760 Vali Loss: 0.0742883 Test Loss: 0.0857224
Validation loss decreased (0.074393 --> 0.074288).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0616458
	speed: 0.0398s/iter; left time: 766.2188s
	iters: 200, epoch: 15 | loss: 0.0615292
	speed: 0.0170s/iter; left time: 325.3566s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0639647 Vali Loss: 0.0742747 Test Loss: 0.0858672
Validation loss decreased (0.074288 --> 0.074275).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0649231
	speed: 0.0355s/iter; left time: 674.5108s
	iters: 200, epoch: 16 | loss: 0.0664912
	speed: 0.0218s/iter; left time: 412.6628s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.0638754 Vali Loss: 0.0742751 Test Loss: 0.0856137
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0634356
	speed: 0.0361s/iter; left time: 678.0320s
	iters: 200, epoch: 17 | loss: 0.0662411
	speed: 0.0165s/iter; left time: 308.6902s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.05s
Steps: 225 | Train Loss: 0.0636968 Vali Loss: 0.0742034 Test Loss: 0.0857146
Validation loss decreased (0.074275 --> 0.074203).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0625355
	speed: 0.0384s/iter; left time: 714.0764s
	iters: 200, epoch: 18 | loss: 0.0631167
	speed: 0.0179s/iter; left time: 329.8468s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0635564 Vali Loss: 0.0741951 Test Loss: 0.0855760
Validation loss decreased (0.074203 --> 0.074195).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0636816
	speed: 0.0388s/iter; left time: 711.9540s
	iters: 200, epoch: 19 | loss: 0.0653322
	speed: 0.0224s/iter; left time: 408.6139s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0634603 Vali Loss: 0.0741919 Test Loss: 0.0857492
Validation loss decreased (0.074195 --> 0.074192).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0619669
	speed: 0.0425s/iter; left time: 770.9257s
	iters: 200, epoch: 20 | loss: 0.0645041
	speed: 0.0190s/iter; left time: 342.8604s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0633220 Vali Loss: 0.0740985 Test Loss: 0.0858055
Validation loss decreased (0.074192 --> 0.074098).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0634483
	speed: 0.0358s/iter; left time: 640.4021s
	iters: 200, epoch: 21 | loss: 0.0661550
	speed: 0.0158s/iter; left time: 280.9104s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:03.89s
Steps: 225 | Train Loss: 0.0632298 Vali Loss: 0.0740741 Test Loss: 0.0856835
Validation loss decreased (0.074098 --> 0.074074).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0665884
	speed: 0.0412s/iter; left time: 727.7174s
	iters: 200, epoch: 22 | loss: 0.0624136
	speed: 0.0192s/iter; left time: 337.2748s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0631625 Vali Loss: 0.0741992 Test Loss: 0.0855839
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0592897
	speed: 0.0360s/iter; left time: 628.8964s
	iters: 200, epoch: 23 | loss: 0.0609877
	speed: 0.0190s/iter; left time: 329.3686s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.64s
Steps: 225 | Train Loss: 0.0630976 Vali Loss: 0.0740889 Test Loss: 0.0858281
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0619836
	speed: 0.0388s/iter; left time: 667.9136s
	iters: 200, epoch: 24 | loss: 0.0606376
	speed: 0.0196s/iter; left time: 334.8623s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.59s
Steps: 225 | Train Loss: 0.0630359 Vali Loss: 0.0742436 Test Loss: 0.0856210
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0620375
	speed: 0.0345s/iter; left time: 587.0172s
	iters: 200, epoch: 25 | loss: 0.0610093
	speed: 0.0175s/iter; left time: 295.2206s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.18s
Steps: 225 | Train Loss: 0.0629425 Vali Loss: 0.0740689 Test Loss: 0.0856918
Validation loss decreased (0.074074 --> 0.074069).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0623213
	speed: 0.0420s/iter; left time: 704.5601s
	iters: 200, epoch: 26 | loss: 0.0607373
	speed: 0.0224s/iter; left time: 373.9348s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.45s
Steps: 225 | Train Loss: 0.0629212 Vali Loss: 0.0741398 Test Loss: 0.0855965
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0599672
	speed: 0.0363s/iter; left time: 600.5544s
	iters: 200, epoch: 27 | loss: 0.0638771
	speed: 0.0233s/iter; left time: 382.7389s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0628768 Vali Loss: 0.0741251 Test Loss: 0.0856418
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0645678
	speed: 0.0372s/iter; left time: 607.0370s
	iters: 200, epoch: 28 | loss: 0.0622639
	speed: 0.0179s/iter; left time: 290.0750s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.30s
Steps: 225 | Train Loss: 0.0628522 Vali Loss: 0.0740774 Test Loss: 0.0857350
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0643791
	speed: 0.0335s/iter; left time: 539.3548s
	iters: 200, epoch: 29 | loss: 0.0624117
	speed: 0.0174s/iter; left time: 278.5146s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:03.95s
Steps: 225 | Train Loss: 0.0628074 Vali Loss: 0.0740491 Test Loss: 0.0857703
Validation loss decreased (0.074069 --> 0.074049).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0639029
	speed: 0.0334s/iter; left time: 530.8416s
	iters: 200, epoch: 30 | loss: 0.0644022
	speed: 0.0198s/iter; left time: 312.0720s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0627769 Vali Loss: 0.0741052 Test Loss: 0.0856595
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0654455
	speed: 0.0327s/iter; left time: 511.9813s
	iters: 200, epoch: 31 | loss: 0.0616240
	speed: 0.0176s/iter; left time: 273.5103s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.0627635 Vali Loss: 0.0741205 Test Loss: 0.0856111
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0611650
	speed: 0.0301s/iter; left time: 465.0414s
	iters: 200, epoch: 32 | loss: 0.0649987
	speed: 0.0101s/iter; left time: 154.8347s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:02.54s
Steps: 225 | Train Loss: 0.0627000 Vali Loss: 0.0740636 Test Loss: 0.0857006
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0597707
	speed: 0.0298s/iter; left time: 453.2348s
	iters: 200, epoch: 33 | loss: 0.0641938
	speed: 0.0153s/iter; left time: 231.4744s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.53s
Steps: 225 | Train Loss: 0.0627276 Vali Loss: 0.0741174 Test Loss: 0.0856934
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0659970
	speed: 0.0363s/iter; left time: 542.8981s
	iters: 200, epoch: 34 | loss: 0.0607483
	speed: 0.0221s/iter; left time: 329.2136s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.84s
Steps: 225 | Train Loss: 0.0626968 Vali Loss: 0.0741465 Test Loss: 0.0856483
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0599526
	speed: 0.0340s/iter; left time: 501.6005s
	iters: 200, epoch: 35 | loss: 0.0630129
	speed: 0.0152s/iter; left time: 222.7658s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:03.94s
Steps: 225 | Train Loss: 0.0626719 Vali Loss: 0.0740543 Test Loss: 0.0856168
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0640251
	speed: 0.0362s/iter; left time: 525.7571s
	iters: 200, epoch: 36 | loss: 0.0665271
	speed: 0.0182s/iter; left time: 262.9388s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.38s
Steps: 225 | Train Loss: 0.0626520 Vali Loss: 0.0740346 Test Loss: 0.0856374
Validation loss decreased (0.074049 --> 0.074035).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0650771
	speed: 0.0383s/iter; left time: 547.4149s
	iters: 200, epoch: 37 | loss: 0.0620096
	speed: 0.0125s/iter; left time: 176.8464s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:03.74s
Steps: 225 | Train Loss: 0.0626566 Vali Loss: 0.0740899 Test Loss: 0.0856191
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0620774
	speed: 0.0358s/iter; left time: 503.2467s
	iters: 200, epoch: 38 | loss: 0.0605291
	speed: 0.0227s/iter; left time: 317.3686s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.11s
Steps: 225 | Train Loss: 0.0626232 Vali Loss: 0.0740508 Test Loss: 0.0856860
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0638552
	speed: 0.0358s/iter; left time: 496.2853s
	iters: 200, epoch: 39 | loss: 0.0609560
	speed: 0.0127s/iter; left time: 174.9525s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:03.61s
Steps: 225 | Train Loss: 0.0626238 Vali Loss: 0.0741312 Test Loss: 0.0856796
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0629077
	speed: 0.0332s/iter; left time: 452.9871s
	iters: 200, epoch: 40 | loss: 0.0619635
	speed: 0.0172s/iter; left time: 232.3828s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.04s
Steps: 225 | Train Loss: 0.0625679 Vali Loss: 0.0740890 Test Loss: 0.0856143
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0585513
	speed: 0.0334s/iter; left time: 447.2526s
	iters: 200, epoch: 41 | loss: 0.0619032
	speed: 0.0175s/iter; left time: 232.2866s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.01s
Steps: 225 | Train Loss: 0.0625734 Vali Loss: 0.0740964 Test Loss: 0.0856672
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0622944
	speed: 0.0330s/iter; left time: 434.3602s
	iters: 200, epoch: 42 | loss: 0.0620603
	speed: 0.0116s/iter; left time: 152.1977s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:03.33s
Steps: 225 | Train Loss: 0.0625519 Vali Loss: 0.0740899 Test Loss: 0.0856896
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0636618
	speed: 0.0339s/iter; left time: 439.3911s
	iters: 200, epoch: 43 | loss: 0.0662818
	speed: 0.0193s/iter; left time: 247.6156s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.25s
Steps: 225 | Train Loss: 0.0625558 Vali Loss: 0.0740881 Test Loss: 0.0856588
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0609411
	speed: 0.0347s/iter; left time: 442.1387s
	iters: 200, epoch: 44 | loss: 0.0611548
	speed: 0.0181s/iter; left time: 228.6233s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.46s
Steps: 225 | Train Loss: 0.0625591 Vali Loss: 0.0740926 Test Loss: 0.0856833
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0599050
	speed: 0.0359s/iter; left time: 448.8544s
	iters: 200, epoch: 45 | loss: 0.0615746
	speed: 0.0186s/iter; left time: 230.9045s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0625465 Vali Loss: 0.0740532 Test Loss: 0.0857476
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0656682
	speed: 0.0346s/iter; left time: 425.1519s
	iters: 200, epoch: 46 | loss: 0.0665195
	speed: 0.0171s/iter; left time: 208.7176s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.23s
Steps: 225 | Train Loss: 0.0625344 Vali Loss: 0.0740709 Test Loss: 0.0856607
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021044865250587463, rmse:0.1450684815645218, mae:0.08563748002052307, rse:0.5618639588356018
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1210394
	speed: 0.0218s/iter; left time: 489.1919s
	iters: 200, epoch: 1 | loss: 0.1047875
	speed: 0.0180s/iter; left time: 401.5083s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.61s
Steps: 225 | Train Loss: 0.1171486 Vali Loss: 0.1032319 Test Loss: 0.1152084
Validation loss decreased (inf --> 0.103232).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0764794
	speed: 0.0339s/iter; left time: 751.2943s
	iters: 200, epoch: 2 | loss: 0.0732857
	speed: 0.0101s/iter; left time: 224.0087s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:03.03s
Steps: 225 | Train Loss: 0.0785486 Vali Loss: 0.0815163 Test Loss: 0.0911878
Validation loss decreased (0.103232 --> 0.081516).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0692481
	speed: 0.0352s/iter; left time: 773.6957s
	iters: 200, epoch: 3 | loss: 0.0701355
	speed: 0.0158s/iter; left time: 344.6178s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:03.73s
Steps: 225 | Train Loss: 0.0712442 Vali Loss: 0.0773953 Test Loss: 0.0882910
Validation loss decreased (0.081516 --> 0.077395).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0653713
	speed: 0.0373s/iter; left time: 809.7535s
	iters: 200, epoch: 4 | loss: 0.0740804
	speed: 0.0200s/iter; left time: 432.0679s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.73s
Steps: 225 | Train Loss: 0.0692651 Vali Loss: 0.0763515 Test Loss: 0.0871971
Validation loss decreased (0.077395 --> 0.076352).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0681931
	speed: 0.0284s/iter; left time: 609.5723s
	iters: 200, epoch: 5 | loss: 0.0681475
	speed: 0.0171s/iter; left time: 365.1300s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:03.51s
Steps: 225 | Train Loss: 0.0681561 Vali Loss: 0.0757714 Test Loss: 0.0865808
Validation loss decreased (0.076352 --> 0.075771).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0646403
	speed: 0.0391s/iter; left time: 831.2309s
	iters: 200, epoch: 6 | loss: 0.0670295
	speed: 0.0180s/iter; left time: 381.7458s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.40s
Steps: 225 | Train Loss: 0.0673313 Vali Loss: 0.0754521 Test Loss: 0.0862572
Validation loss decreased (0.075771 --> 0.075452).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0610189
	speed: 0.0350s/iter; left time: 737.7563s
	iters: 200, epoch: 7 | loss: 0.0690645
	speed: 0.0175s/iter; left time: 366.9610s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.13s
Steps: 225 | Train Loss: 0.0667259 Vali Loss: 0.0749807 Test Loss: 0.0862407
Validation loss decreased (0.075452 --> 0.074981).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0644768
	speed: 0.0379s/iter; left time: 788.9388s
	iters: 200, epoch: 8 | loss: 0.0653624
	speed: 0.0185s/iter; left time: 382.6627s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0662581 Vali Loss: 0.0748040 Test Loss: 0.0859648
Validation loss decreased (0.074981 --> 0.074804).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0657071
	speed: 0.0377s/iter; left time: 777.6188s
	iters: 200, epoch: 9 | loss: 0.0655997
	speed: 0.0181s/iter; left time: 370.7408s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0658779 Vali Loss: 0.0746631 Test Loss: 0.0856976
Validation loss decreased (0.074804 --> 0.074663).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0684024
	speed: 0.0375s/iter; left time: 764.8521s
	iters: 200, epoch: 10 | loss: 0.0660051
	speed: 0.0208s/iter; left time: 422.6620s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.82s
Steps: 225 | Train Loss: 0.0655724 Vali Loss: 0.0745846 Test Loss: 0.0858406
Validation loss decreased (0.074663 --> 0.074585).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0623031
	speed: 0.0423s/iter; left time: 851.5952s
	iters: 200, epoch: 11 | loss: 0.0676518
	speed: 0.0215s/iter; left time: 431.4951s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.11s
Steps: 225 | Train Loss: 0.0652500 Vali Loss: 0.0747508 Test Loss: 0.0857698
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0664428
	speed: 0.0370s/iter; left time: 737.4653s
	iters: 200, epoch: 12 | loss: 0.0653762
	speed: 0.0151s/iter; left time: 299.8820s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.20s
Steps: 225 | Train Loss: 0.0650192 Vali Loss: 0.0744734 Test Loss: 0.0855734
Validation loss decreased (0.074585 --> 0.074473).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0646388
	speed: 0.0372s/iter; left time: 732.2521s
	iters: 200, epoch: 13 | loss: 0.0651568
	speed: 0.0187s/iter; left time: 365.9300s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.12s
Steps: 225 | Train Loss: 0.0647588 Vali Loss: 0.0744340 Test Loss: 0.0853351
Validation loss decreased (0.074473 --> 0.074434).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0667653
	speed: 0.0349s/iter; left time: 679.3370s
	iters: 200, epoch: 14 | loss: 0.0626236
	speed: 0.0170s/iter; left time: 328.9921s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:03.97s
Steps: 225 | Train Loss: 0.0645367 Vali Loss: 0.0741993 Test Loss: 0.0855686
Validation loss decreased (0.074434 --> 0.074199).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0680252
	speed: 0.0361s/iter; left time: 695.7682s
	iters: 200, epoch: 15 | loss: 0.0593005
	speed: 0.0169s/iter; left time: 323.9471s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.31s
Steps: 225 | Train Loss: 0.0643566 Vali Loss: 0.0741186 Test Loss: 0.0857946
Validation loss decreased (0.074199 --> 0.074119).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0614194
	speed: 0.0366s/iter; left time: 697.0894s
	iters: 200, epoch: 16 | loss: 0.0623373
	speed: 0.0210s/iter; left time: 397.6584s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.81s
Steps: 225 | Train Loss: 0.0642088 Vali Loss: 0.0741625 Test Loss: 0.0854788
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0665994
	speed: 0.0375s/iter; left time: 705.5601s
	iters: 200, epoch: 17 | loss: 0.0648475
	speed: 0.0137s/iter; left time: 256.1624s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:03.85s
Steps: 225 | Train Loss: 0.0640424 Vali Loss: 0.0741478 Test Loss: 0.0855078
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0663047
	speed: 0.0415s/iter; left time: 770.2559s
	iters: 200, epoch: 18 | loss: 0.0661211
	speed: 0.0182s/iter; left time: 335.9096s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.85s
Steps: 225 | Train Loss: 0.0639167 Vali Loss: 0.0740825 Test Loss: 0.0855979
Validation loss decreased (0.074119 --> 0.074082).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0629823
	speed: 0.0371s/iter; left time: 680.3404s
	iters: 200, epoch: 19 | loss: 0.0630848
	speed: 0.0190s/iter; left time: 346.2704s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.52s
Steps: 225 | Train Loss: 0.0637715 Vali Loss: 0.0740956 Test Loss: 0.0853726
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0632227
	speed: 0.0390s/iter; left time: 707.3950s
	iters: 200, epoch: 20 | loss: 0.0624366
	speed: 0.0219s/iter; left time: 394.8818s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0637345 Vali Loss: 0.0740992 Test Loss: 0.0856143
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0620175
	speed: 0.0429s/iter; left time: 768.7946s
	iters: 200, epoch: 21 | loss: 0.0622662
	speed: 0.0251s/iter; left time: 446.9162s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.79s
Steps: 225 | Train Loss: 0.0636170 Vali Loss: 0.0739984 Test Loss: 0.0854581
Validation loss decreased (0.074082 --> 0.073998).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0642883
	speed: 0.0401s/iter; left time: 709.4577s
	iters: 200, epoch: 22 | loss: 0.0624295
	speed: 0.0192s/iter; left time: 338.0463s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0635554 Vali Loss: 0.0738083 Test Loss: 0.0854759
Validation loss decreased (0.073998 --> 0.073808).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0619837
	speed: 0.0440s/iter; left time: 767.9425s
	iters: 200, epoch: 23 | loss: 0.0606846
	speed: 0.0231s/iter; left time: 401.4691s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.33s
Steps: 225 | Train Loss: 0.0634304 Vali Loss: 0.0739375 Test Loss: 0.0856123
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0621821
	speed: 0.0305s/iter; left time: 525.0064s
	iters: 200, epoch: 24 | loss: 0.0660644
	speed: 0.0144s/iter; left time: 246.1867s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:03.40s
Steps: 225 | Train Loss: 0.0633682 Vali Loss: 0.0739710 Test Loss: 0.0856309
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0619161
	speed: 0.0325s/iter; left time: 552.7801s
	iters: 200, epoch: 25 | loss: 0.0685211
	speed: 0.0234s/iter; left time: 395.6627s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.78s
Steps: 225 | Train Loss: 0.0633131 Vali Loss: 0.0738985 Test Loss: 0.0855332
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0625157
	speed: 0.0427s/iter; left time: 716.5477s
	iters: 200, epoch: 26 | loss: 0.0681692
	speed: 0.0162s/iter; left time: 270.6994s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.81s
Steps: 225 | Train Loss: 0.0632651 Vali Loss: 0.0739015 Test Loss: 0.0856150
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0608956
	speed: 0.0388s/iter; left time: 642.5381s
	iters: 200, epoch: 27 | loss: 0.0656074
	speed: 0.0127s/iter; left time: 208.9528s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.70s
Steps: 225 | Train Loss: 0.0632046 Vali Loss: 0.0739431 Test Loss: 0.0855818
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0641362
	speed: 0.0339s/iter; left time: 554.2001s
	iters: 200, epoch: 28 | loss: 0.0657411
	speed: 0.0199s/iter; left time: 322.5295s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0631599 Vali Loss: 0.0738821 Test Loss: 0.0856754
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0651714
	speed: 0.0356s/iter; left time: 573.7399s
	iters: 200, epoch: 29 | loss: 0.0617112
	speed: 0.0231s/iter; left time: 368.9746s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.0631507 Vali Loss: 0.0738765 Test Loss: 0.0856216
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0614604
	speed: 0.0370s/iter; left time: 587.6082s
	iters: 200, epoch: 30 | loss: 0.0620838
	speed: 0.0102s/iter; left time: 161.0589s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:03.34s
Steps: 225 | Train Loss: 0.0630906 Vali Loss: 0.0737731 Test Loss: 0.0855447
Validation loss decreased (0.073808 --> 0.073773).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0615081
	speed: 0.0341s/iter; left time: 534.3254s
	iters: 200, epoch: 31 | loss: 0.0636241
	speed: 0.0191s/iter; left time: 297.5653s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.27s
Steps: 225 | Train Loss: 0.0630592 Vali Loss: 0.0738371 Test Loss: 0.0856570
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0609704
	speed: 0.0391s/iter; left time: 603.8718s
	iters: 200, epoch: 32 | loss: 0.0635759
	speed: 0.0171s/iter; left time: 261.5681s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.41s
Steps: 225 | Train Loss: 0.0630527 Vali Loss: 0.0738693 Test Loss: 0.0855334
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0646972
	speed: 0.0420s/iter; left time: 637.8868s
	iters: 200, epoch: 33 | loss: 0.0630995
	speed: 0.0148s/iter; left time: 222.7896s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.33s
Steps: 225 | Train Loss: 0.0630115 Vali Loss: 0.0738945 Test Loss: 0.0855332
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0654340
	speed: 0.0340s/iter; left time: 509.1516s
	iters: 200, epoch: 34 | loss: 0.0624656
	speed: 0.0128s/iter; left time: 191.0808s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:03.67s
Steps: 225 | Train Loss: 0.0630298 Vali Loss: 0.0738741 Test Loss: 0.0855332
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0638330
	speed: 0.0341s/iter; left time: 502.8451s
	iters: 200, epoch: 35 | loss: 0.0668810
	speed: 0.0212s/iter; left time: 311.1070s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.39s
Steps: 225 | Train Loss: 0.0629951 Vali Loss: 0.0739457 Test Loss: 0.0855343
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0623147
	speed: 0.0343s/iter; left time: 498.7837s
	iters: 200, epoch: 36 | loss: 0.0608723
	speed: 0.0205s/iter; left time: 296.2423s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.58s
Steps: 225 | Train Loss: 0.0629881 Vali Loss: 0.0737848 Test Loss: 0.0855618
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0630879
	speed: 0.0392s/iter; left time: 559.9751s
	iters: 200, epoch: 37 | loss: 0.0650850
	speed: 0.0183s/iter; left time: 260.0596s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.51s
Steps: 225 | Train Loss: 0.0629607 Vali Loss: 0.0738439 Test Loss: 0.0855667
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0633509
	speed: 0.0409s/iter; left time: 575.3754s
	iters: 200, epoch: 38 | loss: 0.0605446
	speed: 0.0228s/iter; left time: 319.1319s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.23s
Steps: 225 | Train Loss: 0.0629436 Vali Loss: 0.0738411 Test Loss: 0.0855348
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0598986
	speed: 0.0325s/iter; left time: 450.1978s
	iters: 200, epoch: 39 | loss: 0.0613178
	speed: 0.0182s/iter; left time: 250.5012s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.06s
Steps: 225 | Train Loss: 0.0628666 Vali Loss: 0.0738966 Test Loss: 0.0854778
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0665396
	speed: 0.0381s/iter; left time: 518.5626s
	iters: 200, epoch: 40 | loss: 0.0625084
	speed: 0.0184s/iter; left time: 248.9669s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0628995 Vali Loss: 0.0738050 Test Loss: 0.0855525
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021028192713856697, rmse:0.14501100778579712, mae:0.08554467558860779, rse:0.5616413950920105
Intermediate time for FR and pred_len 168: 00h:08m:01.02sIntermediate time for FR: 00h:23m:05.21s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1593821
	speed: 0.0385s/iter; left time: 866.1848s
	iters: 200, epoch: 1 | loss: 0.1234813
	speed: 0.0164s/iter; left time: 367.6677s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.03s
Steps: 226 | Train Loss: 0.1570896 Vali Loss: 0.1092966 Test Loss: 0.1122958
Validation loss decreased (inf --> 0.109297).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0768305
	speed: 0.0344s/iter; left time: 767.1176s
	iters: 200, epoch: 2 | loss: 0.0711576
	speed: 0.0164s/iter; left time: 364.3583s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.02s
Steps: 226 | Train Loss: 0.0823309 Vali Loss: 0.0656439 Test Loss: 0.0675110
Validation loss decreased (0.109297 --> 0.065644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0701625
	speed: 0.0344s/iter; left time: 758.6147s
	iters: 200, epoch: 3 | loss: 0.0677254
	speed: 0.0169s/iter; left time: 371.2511s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.30s
Steps: 226 | Train Loss: 0.0685028 Vali Loss: 0.0616079 Test Loss: 0.0640182
Validation loss decreased (0.065644 --> 0.061608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0659868
	speed: 0.0351s/iter; left time: 766.3866s
	iters: 200, epoch: 4 | loss: 0.0607433
	speed: 0.0153s/iter; left time: 332.6987s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:03.81s
Steps: 226 | Train Loss: 0.0651398 Vali Loss: 0.0595158 Test Loss: 0.0618037
Validation loss decreased (0.061608 --> 0.059516).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0652476
	speed: 0.0306s/iter; left time: 659.8101s
	iters: 200, epoch: 5 | loss: 0.0612183
	speed: 0.0190s/iter; left time: 408.4151s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.22s
Steps: 226 | Train Loss: 0.0629467 Vali Loss: 0.0581176 Test Loss: 0.0603192
Validation loss decreased (0.059516 --> 0.058118).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0603484
	speed: 0.0346s/iter; left time: 738.6505s
	iters: 200, epoch: 6 | loss: 0.0601482
	speed: 0.0182s/iter; left time: 386.2320s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.46s
Steps: 226 | Train Loss: 0.0615746 Vali Loss: 0.0571964 Test Loss: 0.0595768
Validation loss decreased (0.058118 --> 0.057196).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0648735
	speed: 0.0350s/iter; left time: 740.6096s
	iters: 200, epoch: 7 | loss: 0.0578561
	speed: 0.0161s/iter; left time: 339.7506s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.04s
Steps: 226 | Train Loss: 0.0606378 Vali Loss: 0.0574239 Test Loss: 0.0596774
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0606239
	speed: 0.0338s/iter; left time: 706.0522s
	iters: 200, epoch: 8 | loss: 0.0619788
	speed: 0.0189s/iter; left time: 393.6880s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.36s
Steps: 226 | Train Loss: 0.0599561 Vali Loss: 0.0565249 Test Loss: 0.0588886
Validation loss decreased (0.057196 --> 0.056525).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0612155
	speed: 0.0348s/iter; left time: 719.4713s
	iters: 200, epoch: 9 | loss: 0.0603437
	speed: 0.0223s/iter; left time: 458.2013s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.70s
Steps: 226 | Train Loss: 0.0592684 Vali Loss: 0.0561483 Test Loss: 0.0586221
Validation loss decreased (0.056525 --> 0.056148).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0569037
	speed: 0.0322s/iter; left time: 658.4225s
	iters: 200, epoch: 10 | loss: 0.0605587
	speed: 0.0154s/iter; left time: 313.0810s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:03.75s
Steps: 226 | Train Loss: 0.0588348 Vali Loss: 0.0559605 Test Loss: 0.0583189
Validation loss decreased (0.056148 --> 0.055961).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0575559
	speed: 0.0350s/iter; left time: 709.0042s
	iters: 200, epoch: 11 | loss: 0.0598319
	speed: 0.0183s/iter; left time: 368.9476s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.34s
Steps: 226 | Train Loss: 0.0583838 Vali Loss: 0.0558892 Test Loss: 0.0580843
Validation loss decreased (0.055961 --> 0.055889).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0626877
	speed: 0.0348s/iter; left time: 697.1967s
	iters: 200, epoch: 12 | loss: 0.0601823
	speed: 0.0203s/iter; left time: 403.4687s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.72s
Steps: 226 | Train Loss: 0.0580430 Vali Loss: 0.0554932 Test Loss: 0.0579933
Validation loss decreased (0.055889 --> 0.055493).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0553428
	speed: 0.0341s/iter; left time: 674.9824s
	iters: 200, epoch: 13 | loss: 0.0518866
	speed: 0.0216s/iter; left time: 425.1390s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.70s
Steps: 226 | Train Loss: 0.0577669 Vali Loss: 0.0554023 Test Loss: 0.0577424
Validation loss decreased (0.055493 --> 0.055402).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0606736
	speed: 0.0393s/iter; left time: 768.9665s
	iters: 200, epoch: 14 | loss: 0.0573600
	speed: 0.0219s/iter; left time: 426.6344s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.13s
Steps: 226 | Train Loss: 0.0575232 Vali Loss: 0.0553580 Test Loss: 0.0577659
Validation loss decreased (0.055402 --> 0.055358).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0550222
	speed: 0.0346s/iter; left time: 668.2236s
	iters: 200, epoch: 15 | loss: 0.0600982
	speed: 0.0158s/iter; left time: 304.6946s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:03.93s
Steps: 226 | Train Loss: 0.0572379 Vali Loss: 0.0551939 Test Loss: 0.0576582
Validation loss decreased (0.055358 --> 0.055194).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0585859
	speed: 0.0326s/iter; left time: 623.2261s
	iters: 200, epoch: 16 | loss: 0.0548897
	speed: 0.0212s/iter; left time: 403.3005s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.47s
Steps: 226 | Train Loss: 0.0570594 Vali Loss: 0.0551680 Test Loss: 0.0576045
Validation loss decreased (0.055194 --> 0.055168).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0570717
	speed: 0.0328s/iter; left time: 619.0840s
	iters: 200, epoch: 17 | loss: 0.0575829
	speed: 0.0171s/iter; left time: 321.2761s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.01s
Steps: 226 | Train Loss: 0.0569856 Vali Loss: 0.0549979 Test Loss: 0.0573956
Validation loss decreased (0.055168 --> 0.054998).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0575156
	speed: 0.0299s/iter; left time: 556.9840s
	iters: 200, epoch: 18 | loss: 0.0545770
	speed: 0.0154s/iter; left time: 285.1953s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:03.62s
Steps: 226 | Train Loss: 0.0567499 Vali Loss: 0.0549638 Test Loss: 0.0573878
Validation loss decreased (0.054998 --> 0.054964).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0576251
	speed: 0.0311s/iter; left time: 573.1316s
	iters: 200, epoch: 19 | loss: 0.0538437
	speed: 0.0170s/iter; left time: 311.3687s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.00s
Steps: 226 | Train Loss: 0.0566140 Vali Loss: 0.0548153 Test Loss: 0.0572582
Validation loss decreased (0.054964 --> 0.054815).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0549435
	speed: 0.0370s/iter; left time: 674.0809s
	iters: 200, epoch: 20 | loss: 0.0604172
	speed: 0.0197s/iter; left time: 357.5049s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.68s
Steps: 226 | Train Loss: 0.0564828 Vali Loss: 0.0547100 Test Loss: 0.0570773
Validation loss decreased (0.054815 --> 0.054710).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0577941
	speed: 0.0342s/iter; left time: 614.9415s
	iters: 200, epoch: 21 | loss: 0.0589544
	speed: 0.0195s/iter; left time: 347.8787s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.50s
Steps: 226 | Train Loss: 0.0563989 Vali Loss: 0.0548747 Test Loss: 0.0571588
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0532447
	speed: 0.0364s/iter; left time: 646.6842s
	iters: 200, epoch: 22 | loss: 0.0579227
	speed: 0.0174s/iter; left time: 307.2077s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.32s
Steps: 226 | Train Loss: 0.0563174 Vali Loss: 0.0547841 Test Loss: 0.0570779
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0529711
	speed: 0.0317s/iter; left time: 556.5155s
	iters: 200, epoch: 23 | loss: 0.0534307
	speed: 0.0172s/iter; left time: 299.5708s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:03.92s
Steps: 226 | Train Loss: 0.0561656 Vali Loss: 0.0546956 Test Loss: 0.0570976
Validation loss decreased (0.054710 --> 0.054696).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0533154
	speed: 0.0320s/iter; left time: 553.2430s
	iters: 200, epoch: 24 | loss: 0.0565265
	speed: 0.0173s/iter; left time: 297.2476s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.15s
Steps: 226 | Train Loss: 0.0560654 Vali Loss: 0.0544975 Test Loss: 0.0569965
Validation loss decreased (0.054696 --> 0.054497).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0553172
	speed: 0.0346s/iter; left time: 590.9189s
	iters: 200, epoch: 25 | loss: 0.0583547
	speed: 0.0168s/iter; left time: 284.5796s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0560763 Vali Loss: 0.0545897 Test Loss: 0.0569591
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0532063
	speed: 0.0335s/iter; left time: 564.5653s
	iters: 200, epoch: 26 | loss: 0.0599777
	speed: 0.0202s/iter; left time: 338.3369s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.44s
Steps: 226 | Train Loss: 0.0559622 Vali Loss: 0.0546010 Test Loss: 0.0569279
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0548969
	speed: 0.0322s/iter; left time: 535.6900s
	iters: 200, epoch: 27 | loss: 0.0585928
	speed: 0.0160s/iter; left time: 264.1777s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:03.97s
Steps: 226 | Train Loss: 0.0559206 Vali Loss: 0.0545490 Test Loss: 0.0569308
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0570990
	speed: 0.0350s/iter; left time: 573.2734s
	iters: 200, epoch: 28 | loss: 0.0536195
	speed: 0.0202s/iter; left time: 328.8855s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.60s
Steps: 226 | Train Loss: 0.0558758 Vali Loss: 0.0544448 Test Loss: 0.0568816
Validation loss decreased (0.054497 --> 0.054445).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0576614
	speed: 0.0360s/iter; left time: 582.2564s
	iters: 200, epoch: 29 | loss: 0.0557368
	speed: 0.0193s/iter; left time: 310.9785s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.67s
Steps: 226 | Train Loss: 0.0558452 Vali Loss: 0.0543916 Test Loss: 0.0567876
Validation loss decreased (0.054445 --> 0.054392).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0537613
	speed: 0.0356s/iter; left time: 568.2374s
	iters: 200, epoch: 30 | loss: 0.0583726
	speed: 0.0197s/iter; left time: 312.8785s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.59s
Steps: 226 | Train Loss: 0.0557715 Vali Loss: 0.0544268 Test Loss: 0.0568058
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0558028
	speed: 0.0337s/iter; left time: 529.2667s
	iters: 200, epoch: 31 | loss: 0.0578166
	speed: 0.0179s/iter; left time: 278.8404s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.07s
Steps: 226 | Train Loss: 0.0557194 Vali Loss: 0.0544070 Test Loss: 0.0568181
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0546350
	speed: 0.0384s/iter; left time: 595.2493s
	iters: 200, epoch: 32 | loss: 0.0560995
	speed: 0.0170s/iter; left time: 261.2167s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.81s
Steps: 226 | Train Loss: 0.0556565 Vali Loss: 0.0543337 Test Loss: 0.0567663
Validation loss decreased (0.054392 --> 0.054334).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0553093
	speed: 0.0340s/iter; left time: 518.8935s
	iters: 200, epoch: 33 | loss: 0.0544334
	speed: 0.0158s/iter; left time: 239.6582s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:03.83s
Steps: 226 | Train Loss: 0.0557085 Vali Loss: 0.0544495 Test Loss: 0.0567643
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0517952
	speed: 0.0335s/iter; left time: 503.3773s
	iters: 200, epoch: 34 | loss: 0.0577175
	speed: 0.0186s/iter; left time: 277.9493s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0556033 Vali Loss: 0.0542944 Test Loss: 0.0567092
Validation loss decreased (0.054334 --> 0.054294).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0554626
	speed: 0.0333s/iter; left time: 493.7844s
	iters: 200, epoch: 35 | loss: 0.0574955
	speed: 0.0172s/iter; left time: 252.4543s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.17s
Steps: 226 | Train Loss: 0.0556600 Vali Loss: 0.0544349 Test Loss: 0.0567912
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0561451
	speed: 0.0317s/iter; left time: 462.0321s
	iters: 200, epoch: 36 | loss: 0.0557724
	speed: 0.0182s/iter; left time: 263.9853s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:03.94s
Steps: 226 | Train Loss: 0.0555661 Vali Loss: 0.0543601 Test Loss: 0.0567166
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0554360
	speed: 0.0333s/iter; left time: 478.6523s
	iters: 200, epoch: 37 | loss: 0.0573009
	speed: 0.0201s/iter; left time: 286.7724s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.53s
Steps: 226 | Train Loss: 0.0556243 Vali Loss: 0.0543863 Test Loss: 0.0567281
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0536021
	speed: 0.0335s/iter; left time: 474.1719s
	iters: 200, epoch: 38 | loss: 0.0571662
	speed: 0.0178s/iter; left time: 250.0930s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.23s
Steps: 226 | Train Loss: 0.0555641 Vali Loss: 0.0543375 Test Loss: 0.0567224
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0549302
	speed: 0.0352s/iter; left time: 489.1106s
	iters: 200, epoch: 39 | loss: 0.0537636
	speed: 0.0171s/iter; left time: 236.3770s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0555776 Vali Loss: 0.0542915 Test Loss: 0.0567141
Validation loss decreased (0.054294 --> 0.054291).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0591478
	speed: 0.0335s/iter; left time: 458.8138s
	iters: 200, epoch: 40 | loss: 0.0551421
	speed: 0.0189s/iter; left time: 256.9996s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.27s
Steps: 226 | Train Loss: 0.0555408 Vali Loss: 0.0542786 Test Loss: 0.0566839
Validation loss decreased (0.054291 --> 0.054279).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0548276
	speed: 0.0344s/iter; left time: 462.9470s
	iters: 200, epoch: 41 | loss: 0.0597277
	speed: 0.0158s/iter; left time: 211.6258s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.11s
Steps: 226 | Train Loss: 0.0555752 Vali Loss: 0.0542433 Test Loss: 0.0566768
Validation loss decreased (0.054279 --> 0.054243).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0533049
	speed: 0.0370s/iter; left time: 489.7141s
	iters: 200, epoch: 42 | loss: 0.0562531
	speed: 0.0172s/iter; left time: 225.7019s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.31s
Steps: 226 | Train Loss: 0.0555230 Vali Loss: 0.0542666 Test Loss: 0.0566782
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0556623
	speed: 0.0317s/iter; left time: 412.4533s
	iters: 200, epoch: 43 | loss: 0.0522621
	speed: 0.0143s/iter; left time: 184.1355s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:03.83s
Steps: 226 | Train Loss: 0.0555398 Vali Loss: 0.0542849 Test Loss: 0.0567014
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0547930
	speed: 0.0364s/iter; left time: 465.2045s
	iters: 200, epoch: 44 | loss: 0.0556331
	speed: 0.0173s/iter; left time: 220.0462s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.38s
Steps: 226 | Train Loss: 0.0555342 Vali Loss: 0.0542565 Test Loss: 0.0566445
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0550974
	speed: 0.0316s/iter; left time: 396.7160s
	iters: 200, epoch: 45 | loss: 0.0577911
	speed: 0.0199s/iter; left time: 248.0192s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.36s
Steps: 226 | Train Loss: 0.0554842 Vali Loss: 0.0542433 Test Loss: 0.0566635
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0575353
	speed: 0.0373s/iter; left time: 460.4084s
	iters: 200, epoch: 46 | loss: 0.0522142
	speed: 0.0186s/iter; left time: 226.9569s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.42s
Steps: 226 | Train Loss: 0.0554918 Vali Loss: 0.0542934 Test Loss: 0.0567038
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0574253
	speed: 0.0366s/iter; left time: 442.6720s
	iters: 200, epoch: 47 | loss: 0.0566233
	speed: 0.0188s/iter; left time: 225.4367s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.72s
Steps: 226 | Train Loss: 0.0554435 Vali Loss: 0.0542549 Test Loss: 0.0566532
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0553350
	speed: 0.0327s/iter; left time: 388.8370s
	iters: 200, epoch: 48 | loss: 0.0556369
	speed: 0.0110s/iter; left time: 129.4813s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:03.18s
Steps: 226 | Train Loss: 0.0554421 Vali Loss: 0.0542326 Test Loss: 0.0566230
Validation loss decreased (0.054243 --> 0.054233).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0547879
	speed: 0.0266s/iter; left time: 309.4427s
	iters: 200, epoch: 49 | loss: 0.0571191
	speed: 0.0154s/iter; left time: 178.2024s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:03.45s
Steps: 226 | Train Loss: 0.0554875 Vali Loss: 0.0542973 Test Loss: 0.0566744
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0545607
	speed: 0.0302s/iter; left time: 345.2076s
	iters: 200, epoch: 50 | loss: 0.0601258
	speed: 0.0158s/iter; left time: 179.0683s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:03.63s
Steps: 226 | Train Loss: 0.0554540 Vali Loss: 0.0543102 Test Loss: 0.0566505
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0563313
	speed: 0.0290s/iter; left time: 325.0505s
	iters: 200, epoch: 51 | loss: 0.0548222
	speed: 0.0199s/iter; left time: 221.3185s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.19s
Steps: 226 | Train Loss: 0.0554719 Vali Loss: 0.0542533 Test Loss: 0.0566383
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0545011
	speed: 0.0325s/iter; left time: 356.8565s
	iters: 200, epoch: 52 | loss: 0.0588692
	speed: 0.0156s/iter; left time: 169.3862s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:03.87s
Steps: 226 | Train Loss: 0.0554400 Vali Loss: 0.0542348 Test Loss: 0.0566454
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0573895
	speed: 0.0347s/iter; left time: 373.1242s
	iters: 200, epoch: 53 | loss: 0.0557008
	speed: 0.0129s/iter; left time: 137.7364s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:03.82s
Steps: 226 | Train Loss: 0.0554208 Vali Loss: 0.0542583 Test Loss: 0.0566513
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0584419
	speed: 0.0320s/iter; left time: 336.7609s
	iters: 200, epoch: 54 | loss: 0.0557770
	speed: 0.0162s/iter; left time: 169.1376s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.08s
Steps: 226 | Train Loss: 0.0554332 Vali Loss: 0.0543062 Test Loss: 0.0566685
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0592031
	speed: 0.0389s/iter; left time: 400.3010s
	iters: 200, epoch: 55 | loss: 0.0580452
	speed: 0.0206s/iter; left time: 210.5210s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.83s
Steps: 226 | Train Loss: 0.0554006 Vali Loss: 0.0542188 Test Loss: 0.0566485
Validation loss decreased (0.054233 --> 0.054219).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0557944
	speed: 0.0409s/iter; left time: 411.7455s
	iters: 200, epoch: 56 | loss: 0.0575436
	speed: 0.0207s/iter; left time: 206.6229s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.95s
Steps: 226 | Train Loss: 0.0554949 Vali Loss: 0.0542535 Test Loss: 0.0566425
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0552367
	speed: 0.0414s/iter; left time: 407.1292s
	iters: 200, epoch: 57 | loss: 0.0526632
	speed: 0.0241s/iter; left time: 235.1720s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.29s
Steps: 226 | Train Loss: 0.0554752 Vali Loss: 0.0542661 Test Loss: 0.0566391
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0547907
	speed: 0.0400s/iter; left time: 384.9602s
	iters: 200, epoch: 58 | loss: 0.0545247
	speed: 0.0207s/iter; left time: 196.9682s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.91s
Steps: 226 | Train Loss: 0.0554905 Vali Loss: 0.0541866 Test Loss: 0.0566272
Validation loss decreased (0.054219 --> 0.054187).  Saving model ...
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0552047
	speed: 0.0409s/iter; left time: 384.3971s
	iters: 200, epoch: 59 | loss: 0.0546905
	speed: 0.0208s/iter; left time: 193.3856s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0554464 Vali Loss: 0.0542363 Test Loss: 0.0566469
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0582271
	speed: 0.0398s/iter; left time: 365.0822s
	iters: 200, epoch: 60 | loss: 0.0584647
	speed: 0.0210s/iter; left time: 190.2132s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0553746 Vali Loss: 0.0542754 Test Loss: 0.0566607
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0538022
	speed: 0.0400s/iter; left time: 357.9140s
	iters: 200, epoch: 61 | loss: 0.0595238
	speed: 0.0210s/iter; left time: 185.6320s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0554177 Vali Loss: 0.0542619 Test Loss: 0.0566389
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0548657
	speed: 0.0397s/iter; left time: 345.9753s
	iters: 200, epoch: 62 | loss: 0.0552229
	speed: 0.0208s/iter; left time: 179.1133s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0553776 Vali Loss: 0.0542065 Test Loss: 0.0566425
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0586561
	speed: 0.0395s/iter; left time: 335.5264s
	iters: 200, epoch: 63 | loss: 0.0528608
	speed: 0.0208s/iter; left time: 174.7253s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0554656 Vali Loss: 0.0543084 Test Loss: 0.0566508
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0573308
	speed: 0.0396s/iter; left time: 327.3391s
	iters: 200, epoch: 64 | loss: 0.0524875
	speed: 0.0207s/iter; left time: 168.9254s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0554920 Vali Loss: 0.0543357 Test Loss: 0.0566719
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0554935
	speed: 0.0400s/iter; left time: 321.1642s
	iters: 200, epoch: 65 | loss: 0.0556387
	speed: 0.0209s/iter; left time: 166.0542s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0554536 Vali Loss: 0.0542445 Test Loss: 0.0566510
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0557238
	speed: 0.0407s/iter; left time: 317.9882s
	iters: 200, epoch: 66 | loss: 0.0578800
	speed: 0.0207s/iter; left time: 159.4104s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:04.91s
Steps: 226 | Train Loss: 0.0554466 Vali Loss: 0.0542907 Test Loss: 0.0566411
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0559544
	speed: 0.0414s/iter; left time: 314.2850s
	iters: 200, epoch: 67 | loss: 0.0554192
	speed: 0.0211s/iter; left time: 158.1903s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.94s
Steps: 226 | Train Loss: 0.0554506 Vali Loss: 0.0542586 Test Loss: 0.0566385
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0526508
	speed: 0.0402s/iter; left time: 295.5240s
	iters: 200, epoch: 68 | loss: 0.0582800
	speed: 0.0209s/iter; left time: 151.3871s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0554338 Vali Loss: 0.0542876 Test Loss: 0.0566296
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010013620369136333, rmse:0.10006807744503021, mae:0.05662719905376434, rse:0.3781079947948456
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1573607
	speed: 0.0223s/iter; left time: 501.1747s
	iters: 200, epoch: 1 | loss: 0.1300314
	speed: 0.0211s/iter; left time: 473.0246s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.91s
Steps: 226 | Train Loss: 0.1577573 Vali Loss: 0.1105426 Test Loss: 0.1145439
Validation loss decreased (inf --> 0.110543).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0793203
	speed: 0.0412s/iter; left time: 917.2832s
	iters: 200, epoch: 2 | loss: 0.0723160
	speed: 0.0207s/iter; left time: 458.9329s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0822697 Vali Loss: 0.0660343 Test Loss: 0.0675971
Validation loss decreased (0.110543 --> 0.066034).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0746850
	speed: 0.0424s/iter; left time: 935.3700s
	iters: 200, epoch: 3 | loss: 0.0648276
	speed: 0.0207s/iter; left time: 455.0452s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.00s
Steps: 226 | Train Loss: 0.0688575 Vali Loss: 0.0622213 Test Loss: 0.0644347
Validation loss decreased (0.066034 --> 0.062221).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0676612
	speed: 0.0410s/iter; left time: 893.8046s
	iters: 200, epoch: 4 | loss: 0.0647271
	speed: 0.0206s/iter; left time: 448.5015s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0654854 Vali Loss: 0.0597844 Test Loss: 0.0622531
Validation loss decreased (0.062221 --> 0.059784).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0643532
	speed: 0.0410s/iter; left time: 885.2005s
	iters: 200, epoch: 5 | loss: 0.0649878
	speed: 0.0208s/iter; left time: 447.2706s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0632192 Vali Loss: 0.0583535 Test Loss: 0.0607662
Validation loss decreased (0.059784 --> 0.058354).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0636768
	speed: 0.0413s/iter; left time: 883.6520s
	iters: 200, epoch: 6 | loss: 0.0600426
	speed: 0.0208s/iter; left time: 442.7422s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0617498 Vali Loss: 0.0575012 Test Loss: 0.0599200
Validation loss decreased (0.058354 --> 0.057501).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0585431
	speed: 0.0420s/iter; left time: 887.2518s
	iters: 200, epoch: 7 | loss: 0.0626427
	speed: 0.0207s/iter; left time: 435.7020s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0607552 Vali Loss: 0.0570765 Test Loss: 0.0593813
Validation loss decreased (0.057501 --> 0.057077).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0621818
	speed: 0.0453s/iter; left time: 947.4440s
	iters: 200, epoch: 8 | loss: 0.0585240
	speed: 0.0223s/iter; left time: 463.6879s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.28s
Steps: 226 | Train Loss: 0.0598608 Vali Loss: 0.0566811 Test Loss: 0.0587871
Validation loss decreased (0.057077 --> 0.056681).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0634323
	speed: 0.0434s/iter; left time: 898.4721s
	iters: 200, epoch: 9 | loss: 0.0529604
	speed: 0.0216s/iter; left time: 445.1481s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.23s
Steps: 226 | Train Loss: 0.0592861 Vali Loss: 0.0563962 Test Loss: 0.0584393
Validation loss decreased (0.056681 --> 0.056396).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0588704
	speed: 0.0410s/iter; left time: 840.1156s
	iters: 200, epoch: 10 | loss: 0.0591631
	speed: 0.0207s/iter; left time: 421.8288s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0588297 Vali Loss: 0.0560655 Test Loss: 0.0582095
Validation loss decreased (0.056396 --> 0.056065).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0584188
	speed: 0.0406s/iter; left time: 822.6313s
	iters: 200, epoch: 11 | loss: 0.0559009
	speed: 0.0206s/iter; left time: 415.2575s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0584830 Vali Loss: 0.0559946 Test Loss: 0.0581161
Validation loss decreased (0.056065 --> 0.055995).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0601121
	speed: 0.0408s/iter; left time: 817.4414s
	iters: 200, epoch: 12 | loss: 0.0607920
	speed: 0.0208s/iter; left time: 413.2930s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.90s
Steps: 226 | Train Loss: 0.0580687 Vali Loss: 0.0558722 Test Loss: 0.0578477
Validation loss decreased (0.055995 --> 0.055872).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0583283
	speed: 0.0406s/iter; left time: 803.1971s
	iters: 200, epoch: 13 | loss: 0.0573606
	speed: 0.0206s/iter; left time: 405.2534s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.86s
Steps: 226 | Train Loss: 0.0577804 Vali Loss: 0.0556091 Test Loss: 0.0576085
Validation loss decreased (0.055872 --> 0.055609).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0578804
	speed: 0.0409s/iter; left time: 799.8185s
	iters: 200, epoch: 14 | loss: 0.0590153
	speed: 0.0207s/iter; left time: 403.6088s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0575066 Vali Loss: 0.0554821 Test Loss: 0.0575015
Validation loss decreased (0.055609 --> 0.055482).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0571506
	speed: 0.0403s/iter; left time: 778.3618s
	iters: 200, epoch: 15 | loss: 0.0561143
	speed: 0.0206s/iter; left time: 397.1777s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.91s
Steps: 226 | Train Loss: 0.0572847 Vali Loss: 0.0552979 Test Loss: 0.0573816
Validation loss decreased (0.055482 --> 0.055298).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0606932
	speed: 0.0411s/iter; left time: 785.0597s
	iters: 200, epoch: 16 | loss: 0.0601799
	speed: 0.0209s/iter; left time: 397.3904s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0570542 Vali Loss: 0.0552463 Test Loss: 0.0573230
Validation loss decreased (0.055298 --> 0.055246).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0562132
	speed: 0.0421s/iter; left time: 795.8917s
	iters: 200, epoch: 17 | loss: 0.0517945
	speed: 0.0207s/iter; left time: 388.7424s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0569558 Vali Loss: 0.0551512 Test Loss: 0.0572169
Validation loss decreased (0.055246 --> 0.055151).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0549782
	speed: 0.0406s/iter; left time: 757.9198s
	iters: 200, epoch: 18 | loss: 0.0557214
	speed: 0.0207s/iter; left time: 383.2907s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0567689 Vali Loss: 0.0550626 Test Loss: 0.0571761
Validation loss decreased (0.055151 --> 0.055063).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0578548
	speed: 0.0408s/iter; left time: 751.9434s
	iters: 200, epoch: 19 | loss: 0.0540285
	speed: 0.0207s/iter; left time: 380.0217s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.86s
Steps: 226 | Train Loss: 0.0566034 Vali Loss: 0.0548398 Test Loss: 0.0571010
Validation loss decreased (0.055063 --> 0.054840).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0574559
	speed: 0.0437s/iter; left time: 796.3183s
	iters: 200, epoch: 20 | loss: 0.0562656
	speed: 0.0207s/iter; left time: 374.3009s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.91s
Steps: 226 | Train Loss: 0.0564844 Vali Loss: 0.0550186 Test Loss: 0.0571432
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0561579
	speed: 0.0405s/iter; left time: 728.9998s
	iters: 200, epoch: 21 | loss: 0.0594371
	speed: 0.0207s/iter; left time: 369.8702s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.90s
Steps: 226 | Train Loss: 0.0563916 Vali Loss: 0.0548216 Test Loss: 0.0570241
Validation loss decreased (0.054840 --> 0.054822).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0581695
	speed: 0.0408s/iter; left time: 725.0918s
	iters: 200, epoch: 22 | loss: 0.0569547
	speed: 0.0208s/iter; left time: 367.2073s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0561927 Vali Loss: 0.0548563 Test Loss: 0.0569162
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0582812
	speed: 0.0404s/iter; left time: 708.2660s
	iters: 200, epoch: 23 | loss: 0.0591026
	speed: 0.0206s/iter; left time: 359.8671s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0562241 Vali Loss: 0.0548312 Test Loss: 0.0568969
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0575212
	speed: 0.0405s/iter; left time: 701.1362s
	iters: 200, epoch: 24 | loss: 0.0577626
	speed: 0.0208s/iter; left time: 357.7147s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0560995 Vali Loss: 0.0546449 Test Loss: 0.0568261
Validation loss decreased (0.054822 --> 0.054645).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0569925
	speed: 0.0414s/iter; left time: 707.1271s
	iters: 200, epoch: 25 | loss: 0.0539485
	speed: 0.0208s/iter; left time: 352.7335s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.96s
Steps: 226 | Train Loss: 0.0560700 Vali Loss: 0.0546967 Test Loss: 0.0567787
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0563161
	speed: 0.0406s/iter; left time: 684.3640s
	iters: 200, epoch: 26 | loss: 0.0521550
	speed: 0.0212s/iter; left time: 354.6125s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.90s
Steps: 226 | Train Loss: 0.0559894 Vali Loss: 0.0546580 Test Loss: 0.0567892
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0538891
	speed: 0.0410s/iter; left time: 682.0252s
	iters: 200, epoch: 27 | loss: 0.0539563
	speed: 0.0207s/iter; left time: 342.8657s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0559241 Vali Loss: 0.0546632 Test Loss: 0.0567738
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0540387
	speed: 0.0402s/iter; left time: 659.2702s
	iters: 200, epoch: 28 | loss: 0.0539434
	speed: 0.0207s/iter; left time: 338.1497s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.94s
Steps: 226 | Train Loss: 0.0559196 Vali Loss: 0.0546260 Test Loss: 0.0567322
Validation loss decreased (0.054645 --> 0.054626).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0551787
	speed: 0.0415s/iter; left time: 670.8148s
	iters: 200, epoch: 29 | loss: 0.0559215
	speed: 0.0208s/iter; left time: 334.8640s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0558759 Vali Loss: 0.0545475 Test Loss: 0.0567204
Validation loss decreased (0.054626 --> 0.054548).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0539703
	speed: 0.0407s/iter; left time: 649.3731s
	iters: 200, epoch: 30 | loss: 0.0529386
	speed: 0.0220s/iter; left time: 348.6622s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.01s
Steps: 226 | Train Loss: 0.0558195 Vali Loss: 0.0545579 Test Loss: 0.0566725
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0549525
	speed: 0.0403s/iter; left time: 633.1932s
	iters: 200, epoch: 31 | loss: 0.0581255
	speed: 0.0210s/iter; left time: 327.4066s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.89s
Steps: 226 | Train Loss: 0.0557404 Vali Loss: 0.0544842 Test Loss: 0.0566326
Validation loss decreased (0.054548 --> 0.054484).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0531414
	speed: 0.0407s/iter; left time: 629.8803s
	iters: 200, epoch: 32 | loss: 0.0568882
	speed: 0.0208s/iter; left time: 320.5728s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0557324 Vali Loss: 0.0545144 Test Loss: 0.0566872
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0525673
	speed: 0.0407s/iter; left time: 620.7663s
	iters: 200, epoch: 33 | loss: 0.0552366
	speed: 0.0208s/iter; left time: 314.8116s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.90s
Steps: 226 | Train Loss: 0.0557313 Vali Loss: 0.0545479 Test Loss: 0.0566107
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0545913
	speed: 0.0407s/iter; left time: 612.7376s
	iters: 200, epoch: 34 | loss: 0.0527151
	speed: 0.0214s/iter; left time: 320.3710s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.95s
Steps: 226 | Train Loss: 0.0556540 Vali Loss: 0.0545217 Test Loss: 0.0565855
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0528577
	speed: 0.0404s/iter; left time: 598.0508s
	iters: 200, epoch: 35 | loss: 0.0565141
	speed: 0.0222s/iter; left time: 326.3708s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.09s
Steps: 226 | Train Loss: 0.0556809 Vali Loss: 0.0545160 Test Loss: 0.0565746
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0542427
	speed: 0.0414s/iter; left time: 603.8443s
	iters: 200, epoch: 36 | loss: 0.0564523
	speed: 0.0208s/iter; left time: 301.4674s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0556686 Vali Loss: 0.0544228 Test Loss: 0.0565843
Validation loss decreased (0.054484 --> 0.054423).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0549694
	speed: 0.0408s/iter; left time: 586.3012s
	iters: 200, epoch: 37 | loss: 0.0558352
	speed: 0.0208s/iter; left time: 296.1056s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.87s
Steps: 226 | Train Loss: 0.0556525 Vali Loss: 0.0544250 Test Loss: 0.0566035
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0556710
	speed: 0.0408s/iter; left time: 576.6104s
	iters: 200, epoch: 38 | loss: 0.0572953
	speed: 0.0212s/iter; left time: 297.9368s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.01s
Steps: 226 | Train Loss: 0.0556188 Vali Loss: 0.0544323 Test Loss: 0.0565958
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0535805
	speed: 0.0412s/iter; left time: 572.9118s
	iters: 200, epoch: 39 | loss: 0.0622349
	speed: 0.0208s/iter; left time: 287.0422s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.91s
Steps: 226 | Train Loss: 0.0556048 Vali Loss: 0.0544680 Test Loss: 0.0565738
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0561483
	speed: 0.0412s/iter; left time: 564.3674s
	iters: 200, epoch: 40 | loss: 0.0531933
	speed: 0.0207s/iter; left time: 281.3035s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.94s
Steps: 226 | Train Loss: 0.0555662 Vali Loss: 0.0544984 Test Loss: 0.0565711
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0561239
	speed: 0.0408s/iter; left time: 549.7383s
	iters: 200, epoch: 41 | loss: 0.0517765
	speed: 0.0217s/iter; left time: 289.5929s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.04s
Steps: 226 | Train Loss: 0.0555728 Vali Loss: 0.0543907 Test Loss: 0.0565282
Validation loss decreased (0.054423 --> 0.054391).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0523082
	speed: 0.0408s/iter; left time: 540.0180s
	iters: 200, epoch: 42 | loss: 0.0538820
	speed: 0.0208s/iter; left time: 272.5841s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.88s
Steps: 226 | Train Loss: 0.0555350 Vali Loss: 0.0544950 Test Loss: 0.0565574
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0518777
	speed: 0.0401s/iter; left time: 521.5896s
	iters: 200, epoch: 43 | loss: 0.0526231
	speed: 0.0207s/iter; left time: 267.1871s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0555422 Vali Loss: 0.0543530 Test Loss: 0.0565322
Validation loss decreased (0.054391 --> 0.054353).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0558865
	speed: 0.0432s/iter; left time: 552.5992s
	iters: 200, epoch: 44 | loss: 0.0584679
	speed: 0.0217s/iter; left time: 275.7026s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.12s
Steps: 226 | Train Loss: 0.0555280 Vali Loss: 0.0543507 Test Loss: 0.0565503
Validation loss decreased (0.054353 --> 0.054351).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0574074
	speed: 0.0420s/iter; left time: 528.0008s
	iters: 200, epoch: 45 | loss: 0.0555215
	speed: 0.0212s/iter; left time: 264.6747s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.99s
Steps: 226 | Train Loss: 0.0555235 Vali Loss: 0.0544811 Test Loss: 0.0565407
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0546385
	speed: 0.0412s/iter; left time: 508.5139s
	iters: 200, epoch: 46 | loss: 0.0590151
	speed: 0.0210s/iter; left time: 256.3552s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.95s
Steps: 226 | Train Loss: 0.0555281 Vali Loss: 0.0544902 Test Loss: 0.0565665
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0578885
	speed: 0.0403s/iter; left time: 487.7635s
	iters: 200, epoch: 47 | loss: 0.0509819
	speed: 0.0207s/iter; left time: 248.0247s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0555610 Vali Loss: 0.0544188 Test Loss: 0.0565211
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0543291
	speed: 0.0414s/iter; left time: 491.3178s
	iters: 200, epoch: 48 | loss: 0.0562213
	speed: 0.0212s/iter; left time: 249.5475s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.02s
Steps: 226 | Train Loss: 0.0555136 Vali Loss: 0.0544448 Test Loss: 0.0565119
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0515884
	speed: 0.0400s/iter; left time: 466.3707s
	iters: 200, epoch: 49 | loss: 0.0570134
	speed: 0.0207s/iter; left time: 239.5060s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.86s
Steps: 226 | Train Loss: 0.0555256 Vali Loss: 0.0544299 Test Loss: 0.0565411
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0553536
	speed: 0.0418s/iter; left time: 477.6535s
	iters: 200, epoch: 50 | loss: 0.0554720
	speed: 0.0207s/iter; left time: 234.2724s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.86s
Steps: 226 | Train Loss: 0.0554629 Vali Loss: 0.0543953 Test Loss: 0.0565168
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0514704
	speed: 0.0408s/iter; left time: 456.4795s
	iters: 200, epoch: 51 | loss: 0.0539592
	speed: 0.0208s/iter; left time: 230.4370s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.86s
Steps: 226 | Train Loss: 0.0554583 Vali Loss: 0.0544391 Test Loss: 0.0565219
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0580358
	speed: 0.0400s/iter; left time: 439.3845s
	iters: 200, epoch: 52 | loss: 0.0561351
	speed: 0.0208s/iter; left time: 225.6900s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.85s
Steps: 226 | Train Loss: 0.0555748 Vali Loss: 0.0544157 Test Loss: 0.0565323
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0542540
	speed: 0.0416s/iter; left time: 447.1590s
	iters: 200, epoch: 53 | loss: 0.0574763
	speed: 0.0211s/iter; left time: 224.5078s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0554894 Vali Loss: 0.0544404 Test Loss: 0.0565196
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0552687
	speed: 0.0401s/iter; left time: 422.0096s
	iters: 200, epoch: 54 | loss: 0.0548174
	speed: 0.0211s/iter; left time: 219.9987s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.92s
Steps: 226 | Train Loss: 0.0555267 Vali Loss: 0.0543990 Test Loss: 0.0565228
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009993644431233406, rmse:0.09996821731328964, mae:0.05655033513903618, rse:0.37773069739341736
Intermediate time for IT and pred_len 24: 00h:11m:50.74s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1669092
	speed: 0.0452s/iter; left time: 1012.5820s
	iters: 200, epoch: 1 | loss: 0.1401041
	speed: 0.0207s/iter; left time: 461.9160s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.21s
Steps: 225 | Train Loss: 0.1638128 Vali Loss: 0.1188383 Test Loss: 0.1233246
Validation loss decreased (inf --> 0.118838).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1033055
	speed: 0.0424s/iter; left time: 941.3287s
	iters: 200, epoch: 2 | loss: 0.0938538
	speed: 0.0208s/iter; left time: 459.3385s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.1024199 Vali Loss: 0.0843555 Test Loss: 0.0881399
Validation loss decreased (0.118838 --> 0.084356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0874186
	speed: 0.0430s/iter; left time: 944.8962s
	iters: 200, epoch: 3 | loss: 0.0862540
	speed: 0.0210s/iter; left time: 459.1061s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0883068 Vali Loss: 0.0805757 Test Loss: 0.0844691
Validation loss decreased (0.084356 --> 0.080576).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0822606
	speed: 0.0446s/iter; left time: 970.0285s
	iters: 200, epoch: 4 | loss: 0.0853445
	speed: 0.0209s/iter; left time: 451.1690s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0851258 Vali Loss: 0.0790129 Test Loss: 0.0829461
Validation loss decreased (0.080576 --> 0.079013).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0794841
	speed: 0.0420s/iter; left time: 904.0994s
	iters: 200, epoch: 5 | loss: 0.0796301
	speed: 0.0208s/iter; left time: 445.1998s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0833385 Vali Loss: 0.0780248 Test Loss: 0.0820323
Validation loss decreased (0.079013 --> 0.078025).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0790213
	speed: 0.0420s/iter; left time: 892.9639s
	iters: 200, epoch: 6 | loss: 0.0824916
	speed: 0.0209s/iter; left time: 443.5980s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0820430 Vali Loss: 0.0773483 Test Loss: 0.0812382
Validation loss decreased (0.078025 --> 0.077348).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0770506
	speed: 0.0432s/iter; left time: 910.1604s
	iters: 200, epoch: 7 | loss: 0.0813279
	speed: 0.0207s/iter; left time: 433.1506s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0810946 Vali Loss: 0.0771037 Test Loss: 0.0812631
Validation loss decreased (0.077348 --> 0.077104).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0820660
	speed: 0.0430s/iter; left time: 895.8289s
	iters: 200, epoch: 8 | loss: 0.0803185
	speed: 0.0206s/iter; left time: 427.7180s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0803903 Vali Loss: 0.0763726 Test Loss: 0.0802872
Validation loss decreased (0.077104 --> 0.076373).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0789092
	speed: 0.0433s/iter; left time: 891.1467s
	iters: 200, epoch: 9 | loss: 0.0763635
	speed: 0.0208s/iter; left time: 425.9586s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0797350 Vali Loss: 0.0760175 Test Loss: 0.0801024
Validation loss decreased (0.076373 --> 0.076018).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0757352
	speed: 0.0423s/iter; left time: 862.3985s
	iters: 200, epoch: 10 | loss: 0.0821360
	speed: 0.0207s/iter; left time: 419.8929s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0792618 Vali Loss: 0.0760024 Test Loss: 0.0800756
Validation loss decreased (0.076018 --> 0.076002).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0765340
	speed: 0.0424s/iter; left time: 854.6667s
	iters: 200, epoch: 11 | loss: 0.0766016
	speed: 0.0208s/iter; left time: 417.1430s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0788864 Vali Loss: 0.0757054 Test Loss: 0.0797140
Validation loss decreased (0.076002 --> 0.075705).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0787157
	speed: 0.0427s/iter; left time: 850.0699s
	iters: 200, epoch: 12 | loss: 0.0781840
	speed: 0.0208s/iter; left time: 412.6570s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0785617 Vali Loss: 0.0754555 Test Loss: 0.0794976
Validation loss decreased (0.075705 --> 0.075456).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0803629
	speed: 0.0424s/iter; left time: 835.8411s
	iters: 200, epoch: 13 | loss: 0.0813732
	speed: 0.0208s/iter; left time: 407.4320s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0782243 Vali Loss: 0.0753873 Test Loss: 0.0795178
Validation loss decreased (0.075456 --> 0.075387).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0805302
	speed: 0.0426s/iter; left time: 830.4879s
	iters: 200, epoch: 14 | loss: 0.0788860
	speed: 0.0208s/iter; left time: 403.1575s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0779015 Vali Loss: 0.0751808 Test Loss: 0.0794455
Validation loss decreased (0.075387 --> 0.075181).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0773549
	speed: 0.0425s/iter; left time: 817.5567s
	iters: 200, epoch: 15 | loss: 0.0791559
	speed: 0.0227s/iter; left time: 434.5042s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.10s
Steps: 225 | Train Loss: 0.0777317 Vali Loss: 0.0751953 Test Loss: 0.0795967
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0785272
	speed: 0.0422s/iter; left time: 802.9055s
	iters: 200, epoch: 16 | loss: 0.0769728
	speed: 0.0209s/iter; left time: 394.6718s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.0774655 Vali Loss: 0.0749888 Test Loss: 0.0792939
Validation loss decreased (0.075181 --> 0.074989).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0769738
	speed: 0.0438s/iter; left time: 824.3760s
	iters: 200, epoch: 17 | loss: 0.0778376
	speed: 0.0213s/iter; left time: 398.3164s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0772400 Vali Loss: 0.0750678 Test Loss: 0.0794692
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0805343
	speed: 0.0424s/iter; left time: 787.8991s
	iters: 200, epoch: 18 | loss: 0.0752611
	speed: 0.0207s/iter; left time: 383.1283s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0770767 Vali Loss: 0.0748767 Test Loss: 0.0791836
Validation loss decreased (0.074989 --> 0.074877).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0779965
	speed: 0.0429s/iter; left time: 787.0227s
	iters: 200, epoch: 19 | loss: 0.0749951
	speed: 0.0209s/iter; left time: 380.8751s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0769474 Vali Loss: 0.0746936 Test Loss: 0.0789684
Validation loss decreased (0.074877 --> 0.074694).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0736500
	speed: 0.0420s/iter; left time: 762.0740s
	iters: 200, epoch: 20 | loss: 0.0772865
	speed: 0.0207s/iter; left time: 373.4359s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0767863 Vali Loss: 0.0748690 Test Loss: 0.0791829
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0763280
	speed: 0.0422s/iter; left time: 755.2023s
	iters: 200, epoch: 21 | loss: 0.0714772
	speed: 0.0208s/iter; left time: 370.8403s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0766963 Vali Loss: 0.0748559 Test Loss: 0.0792080
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0795258
	speed: 0.0434s/iter; left time: 766.9435s
	iters: 200, epoch: 22 | loss: 0.0783744
	speed: 0.0208s/iter; left time: 365.7919s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.04s
Steps: 225 | Train Loss: 0.0765899 Vali Loss: 0.0747872 Test Loss: 0.0790109
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0773060
	speed: 0.0423s/iter; left time: 738.0832s
	iters: 200, epoch: 23 | loss: 0.0768325
	speed: 0.0213s/iter; left time: 368.8153s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0765073 Vali Loss: 0.0747645 Test Loss: 0.0790767
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0763985
	speed: 0.0426s/iter; left time: 733.1196s
	iters: 200, epoch: 24 | loss: 0.0742462
	speed: 0.0208s/iter; left time: 355.9960s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0763747 Vali Loss: 0.0746120 Test Loss: 0.0790180
Validation loss decreased (0.074694 --> 0.074612).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0758858
	speed: 0.0437s/iter; left time: 742.7844s
	iters: 200, epoch: 25 | loss: 0.0799969
	speed: 0.0208s/iter; left time: 351.7127s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0762890 Vali Loss: 0.0746417 Test Loss: 0.0790498
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0812193
	speed: 0.0425s/iter; left time: 713.7002s
	iters: 200, epoch: 26 | loss: 0.0759417
	speed: 0.0208s/iter; left time: 346.1590s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0762690 Vali Loss: 0.0745990 Test Loss: 0.0788645
Validation loss decreased (0.074612 --> 0.074599).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0765115
	speed: 0.0425s/iter; left time: 703.0682s
	iters: 200, epoch: 27 | loss: 0.0747217
	speed: 0.0208s/iter; left time: 342.8083s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0761361 Vali Loss: 0.0745715 Test Loss: 0.0788600
Validation loss decreased (0.074599 --> 0.074571).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0780237
	speed: 0.0427s/iter; left time: 696.8410s
	iters: 200, epoch: 28 | loss: 0.0751070
	speed: 0.0209s/iter; left time: 338.5861s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0761311 Vali Loss: 0.0746733 Test Loss: 0.0790727
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0780154
	speed: 0.0419s/iter; left time: 673.9280s
	iters: 200, epoch: 29 | loss: 0.0717261
	speed: 0.0208s/iter; left time: 333.3440s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0760820 Vali Loss: 0.0745423 Test Loss: 0.0788420
Validation loss decreased (0.074571 --> 0.074542).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0772073
	speed: 0.0436s/iter; left time: 691.9070s
	iters: 200, epoch: 30 | loss: 0.0782413
	speed: 0.0209s/iter; left time: 329.0996s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0759955 Vali Loss: 0.0745012 Test Loss: 0.0788583
Validation loss decreased (0.074542 --> 0.074501).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0736191
	speed: 0.0427s/iter; left time: 667.9280s
	iters: 200, epoch: 31 | loss: 0.0757232
	speed: 0.0219s/iter; left time: 339.8442s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0759875 Vali Loss: 0.0745420 Test Loss: 0.0788668
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0742540
	speed: 0.0434s/iter; left time: 668.7807s
	iters: 200, epoch: 32 | loss: 0.0766309
	speed: 0.0209s/iter; left time: 320.5931s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0758916 Vali Loss: 0.0745379 Test Loss: 0.0788726
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0806924
	speed: 0.0426s/iter; left time: 647.6184s
	iters: 200, epoch: 33 | loss: 0.0794868
	speed: 0.0208s/iter; left time: 314.0196s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0758924 Vali Loss: 0.0745164 Test Loss: 0.0788155
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0811082
	speed: 0.0425s/iter; left time: 636.3328s
	iters: 200, epoch: 34 | loss: 0.0749670
	speed: 0.0210s/iter; left time: 311.9770s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0758676 Vali Loss: 0.0745435 Test Loss: 0.0788689
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0753011
	speed: 0.0430s/iter; left time: 633.9118s
	iters: 200, epoch: 35 | loss: 0.0762374
	speed: 0.0208s/iter; left time: 304.8828s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0758858 Vali Loss: 0.0745267 Test Loss: 0.0788663
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0790051
	speed: 0.0434s/iter; left time: 630.9701s
	iters: 200, epoch: 36 | loss: 0.0784262
	speed: 0.0207s/iter; left time: 298.3493s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0758194 Vali Loss: 0.0745543 Test Loss: 0.0789160
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0786390
	speed: 0.0423s/iter; left time: 604.3992s
	iters: 200, epoch: 37 | loss: 0.0717152
	speed: 0.0208s/iter; left time: 295.3585s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0757936 Vali Loss: 0.0745547 Test Loss: 0.0788500
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0799452
	speed: 0.0417s/iter; left time: 587.3101s
	iters: 200, epoch: 38 | loss: 0.0723355
	speed: 0.0211s/iter; left time: 294.3699s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0757439 Vali Loss: 0.0744955 Test Loss: 0.0787958
Validation loss decreased (0.074501 --> 0.074495).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0733191
	speed: 0.0428s/iter; left time: 592.7958s
	iters: 200, epoch: 39 | loss: 0.0772472
	speed: 0.0208s/iter; left time: 286.3662s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0757125 Vali Loss: 0.0745277 Test Loss: 0.0788285
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0731022
	speed: 0.0412s/iter; left time: 561.8233s
	iters: 200, epoch: 40 | loss: 0.0813463
	speed: 0.0208s/iter; left time: 281.5469s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0757605 Vali Loss: 0.0744777 Test Loss: 0.0787457
Validation loss decreased (0.074495 --> 0.074478).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0726994
	speed: 0.0424s/iter; left time: 567.6496s
	iters: 200, epoch: 41 | loss: 0.0707508
	speed: 0.0209s/iter; left time: 277.5703s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0757570 Vali Loss: 0.0744992 Test Loss: 0.0788272
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0751855
	speed: 0.0425s/iter; left time: 559.6674s
	iters: 200, epoch: 42 | loss: 0.0751205
	speed: 0.0209s/iter; left time: 273.7084s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0757228 Vali Loss: 0.0745397 Test Loss: 0.0788634
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0758706
	speed: 0.0418s/iter; left time: 541.9239s
	iters: 200, epoch: 43 | loss: 0.0756615
	speed: 0.0211s/iter; left time: 271.0653s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0756767 Vali Loss: 0.0745036 Test Loss: 0.0788214
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0782793
	speed: 0.0428s/iter; left time: 545.1089s
	iters: 200, epoch: 44 | loss: 0.0709118
	speed: 0.0208s/iter; left time: 262.5144s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0756931 Vali Loss: 0.0744941 Test Loss: 0.0787882
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0769355
	speed: 0.0436s/iter; left time: 544.8735s
	iters: 200, epoch: 45 | loss: 0.0730018
	speed: 0.0215s/iter; left time: 267.1578s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0757256 Vali Loss: 0.0745007 Test Loss: 0.0788010
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0741454
	speed: 0.0419s/iter; left time: 514.3173s
	iters: 200, epoch: 46 | loss: 0.0757747
	speed: 0.0208s/iter; left time: 252.7332s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0757511 Vali Loss: 0.0745217 Test Loss: 0.0788470
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0733297
	speed: 0.0424s/iter; left time: 511.4022s
	iters: 200, epoch: 47 | loss: 0.0752435
	speed: 0.0212s/iter; left time: 253.2974s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.0756909 Vali Loss: 0.0744966 Test Loss: 0.0787864
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0742979
	speed: 0.0416s/iter; left time: 492.4860s
	iters: 200, epoch: 48 | loss: 0.0754963
	speed: 0.0208s/iter; left time: 244.2303s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0756908 Vali Loss: 0.0744999 Test Loss: 0.0788212
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0724371
	speed: 0.0419s/iter; left time: 485.7096s
	iters: 200, epoch: 49 | loss: 0.0771678
	speed: 0.0209s/iter; left time: 240.7574s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0756535 Vali Loss: 0.0745001 Test Loss: 0.0788215
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0750389
	speed: 0.0418s/iter; left time: 475.4922s
	iters: 200, epoch: 50 | loss: 0.0723733
	speed: 0.0208s/iter; left time: 234.6073s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0756713 Vali Loss: 0.0744728 Test Loss: 0.0788004
Validation loss decreased (0.074478 --> 0.074473).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0770440
	speed: 0.0433s/iter; left time: 483.0598s
	iters: 200, epoch: 51 | loss: 0.0769106
	speed: 0.0208s/iter; left time: 229.8911s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0756731 Vali Loss: 0.0744990 Test Loss: 0.0788114
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0742975
	speed: 0.0423s/iter; left time: 462.5962s
	iters: 200, epoch: 52 | loss: 0.0723217
	speed: 0.0216s/iter; left time: 233.6649s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0755942 Vali Loss: 0.0744465 Test Loss: 0.0787730
Validation loss decreased (0.074473 --> 0.074446).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0775662
	speed: 0.0423s/iter; left time: 452.9437s
	iters: 200, epoch: 53 | loss: 0.0746110
	speed: 0.0208s/iter; left time: 220.7885s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0756881 Vali Loss: 0.0744816 Test Loss: 0.0788015
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0793720
	speed: 0.0432s/iter; left time: 452.0537s
	iters: 200, epoch: 54 | loss: 0.0751703
	speed: 0.0208s/iter; left time: 215.6915s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0756899 Vali Loss: 0.0744729 Test Loss: 0.0787960
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0773408
	speed: 0.0417s/iter; left time: 427.0356s
	iters: 200, epoch: 55 | loss: 0.0790814
	speed: 0.0208s/iter; left time: 211.1901s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0756388 Vali Loss: 0.0744965 Test Loss: 0.0788164
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0722554
	speed: 0.0414s/iter; left time: 415.4101s
	iters: 200, epoch: 56 | loss: 0.0734554
	speed: 0.0207s/iter; left time: 205.6383s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0756295 Vali Loss: 0.0744851 Test Loss: 0.0788308
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0712699
	speed: 0.0416s/iter; left time: 408.0694s
	iters: 200, epoch: 57 | loss: 0.0767291
	speed: 0.0209s/iter; left time: 203.0484s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0756545 Vali Loss: 0.0744595 Test Loss: 0.0788006
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0736074
	speed: 0.0417s/iter; left time: 399.2716s
	iters: 200, epoch: 58 | loss: 0.0721901
	speed: 0.0208s/iter; left time: 196.7861s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0756565 Vali Loss: 0.0744689 Test Loss: 0.0787867
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0782748
	speed: 0.0424s/iter; left time: 396.4029s
	iters: 200, epoch: 59 | loss: 0.0734969
	speed: 0.0208s/iter; left time: 192.2105s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0756559 Vali Loss: 0.0744646 Test Loss: 0.0787873
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0761360
	speed: 0.0428s/iter; left time: 390.8161s
	iters: 200, epoch: 60 | loss: 0.0774208
	speed: 0.0227s/iter; left time: 204.6595s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.12s
Steps: 225 | Train Loss: 0.0756059 Vali Loss: 0.0744760 Test Loss: 0.0788017
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0744535
	speed: 0.0415s/iter; left time: 369.6899s
	iters: 200, epoch: 61 | loss: 0.0719408
	speed: 0.0211s/iter; left time: 185.7047s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0756347 Vali Loss: 0.0744701 Test Loss: 0.0788029
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0716773
	speed: 0.0423s/iter; left time: 367.0738s
	iters: 200, epoch: 62 | loss: 0.0718452
	speed: 0.0207s/iter; left time: 177.7702s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0756371 Vali Loss: 0.0744701 Test Loss: 0.0787790
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01815042831003666, rmse:0.13472352921962738, mae:0.07877302914857864, rse:0.509404182434082
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1637366
	speed: 0.0231s/iter; left time: 517.0028s
	iters: 200, epoch: 1 | loss: 0.1366874
	speed: 0.0209s/iter; left time: 466.2575s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.1638897 Vali Loss: 0.1186297 Test Loss: 0.1232584
Validation loss decreased (inf --> 0.118630).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1025519
	speed: 0.0436s/iter; left time: 967.0378s
	iters: 200, epoch: 2 | loss: 0.0871551
	speed: 0.0208s/iter; left time: 459.8981s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.1019576 Vali Loss: 0.0846024 Test Loss: 0.0879323
Validation loss decreased (0.118630 --> 0.084602).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878244
	speed: 0.0432s/iter; left time: 947.6436s
	iters: 200, epoch: 3 | loss: 0.0881555
	speed: 0.0208s/iter; left time: 454.8765s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0882597 Vali Loss: 0.0806726 Test Loss: 0.0843868
Validation loss decreased (0.084602 --> 0.080673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0828160
	speed: 0.0432s/iter; left time: 939.3650s
	iters: 200, epoch: 4 | loss: 0.0839197
	speed: 0.0208s/iter; left time: 449.7874s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0853353 Vali Loss: 0.0792031 Test Loss: 0.0830309
Validation loss decreased (0.080673 --> 0.079203).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0871444
	speed: 0.0431s/iter; left time: 927.0891s
	iters: 200, epoch: 5 | loss: 0.0783487
	speed: 0.0208s/iter; left time: 445.1639s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0834572 Vali Loss: 0.0779789 Test Loss: 0.0820830
Validation loss decreased (0.079203 --> 0.077979).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0861226
	speed: 0.0424s/iter; left time: 903.0358s
	iters: 200, epoch: 6 | loss: 0.0838076
	speed: 0.0209s/iter; left time: 442.8537s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0821980 Vali Loss: 0.0772114 Test Loss: 0.0812530
Validation loss decreased (0.077979 --> 0.077211).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0826203
	speed: 0.0424s/iter; left time: 891.6210s
	iters: 200, epoch: 7 | loss: 0.0811351
	speed: 0.0223s/iter; left time: 467.9381s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0812458 Vali Loss: 0.0769910 Test Loss: 0.0810177
Validation loss decreased (0.077211 --> 0.076991).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0833413
	speed: 0.0428s/iter; left time: 890.9293s
	iters: 200, epoch: 8 | loss: 0.0802773
	speed: 0.0208s/iter; left time: 430.7329s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0805587 Vali Loss: 0.0763516 Test Loss: 0.0804884
Validation loss decreased (0.076991 --> 0.076352).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0844949
	speed: 0.0437s/iter; left time: 901.2843s
	iters: 200, epoch: 9 | loss: 0.0781104
	speed: 0.0216s/iter; left time: 442.0718s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0798999 Vali Loss: 0.0760150 Test Loss: 0.0802005
Validation loss decreased (0.076352 --> 0.076015).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0761344
	speed: 0.0433s/iter; left time: 883.0924s
	iters: 200, epoch: 10 | loss: 0.0780614
	speed: 0.0215s/iter; left time: 435.1111s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0794445 Vali Loss: 0.0758701 Test Loss: 0.0802442
Validation loss decreased (0.076015 --> 0.075870).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0743540
	speed: 0.0430s/iter; left time: 866.9888s
	iters: 200, epoch: 11 | loss: 0.0809893
	speed: 0.0208s/iter; left time: 417.2845s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0789785 Vali Loss: 0.0756105 Test Loss: 0.0798962
Validation loss decreased (0.075870 --> 0.075610).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0815798
	speed: 0.0427s/iter; left time: 851.0189s
	iters: 200, epoch: 12 | loss: 0.0788627
	speed: 0.0208s/iter; left time: 412.9907s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0785684 Vali Loss: 0.0752351 Test Loss: 0.0795540
Validation loss decreased (0.075610 --> 0.075235).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0776551
	speed: 0.0428s/iter; left time: 843.9088s
	iters: 200, epoch: 13 | loss: 0.0810024
	speed: 0.0208s/iter; left time: 408.0138s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0782453 Vali Loss: 0.0750905 Test Loss: 0.0796944
Validation loss decreased (0.075235 --> 0.075090).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0825704
	speed: 0.0427s/iter; left time: 831.7960s
	iters: 200, epoch: 14 | loss: 0.0778248
	speed: 0.0208s/iter; left time: 403.3784s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0779376 Vali Loss: 0.0748365 Test Loss: 0.0794269
Validation loss decreased (0.075090 --> 0.074837).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0827974
	speed: 0.0433s/iter; left time: 832.9973s
	iters: 200, epoch: 15 | loss: 0.0739762
	speed: 0.0208s/iter; left time: 398.7978s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0777293 Vali Loss: 0.0748100 Test Loss: 0.0795144
Validation loss decreased (0.074837 --> 0.074810).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0784488
	speed: 0.0427s/iter; left time: 813.1082s
	iters: 200, epoch: 16 | loss: 0.0808750
	speed: 0.0208s/iter; left time: 394.2690s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0774809 Vali Loss: 0.0746060 Test Loss: 0.0792269
Validation loss decreased (0.074810 --> 0.074606).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0773868
	speed: 0.0459s/iter; left time: 862.9082s
	iters: 200, epoch: 17 | loss: 0.0736612
	speed: 0.0219s/iter; left time: 409.3087s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.33s
Steps: 225 | Train Loss: 0.0773585 Vali Loss: 0.0745304 Test Loss: 0.0792232
Validation loss decreased (0.074606 --> 0.074530).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0773715
	speed: 0.0442s/iter; left time: 820.4977s
	iters: 200, epoch: 18 | loss: 0.0747276
	speed: 0.0210s/iter; left time: 387.6005s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0770840 Vali Loss: 0.0744964 Test Loss: 0.0793575
Validation loss decreased (0.074530 --> 0.074496).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0817562
	speed: 0.0428s/iter; left time: 784.5678s
	iters: 200, epoch: 19 | loss: 0.0816317
	speed: 0.0208s/iter; left time: 380.3266s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0769545 Vali Loss: 0.0744677 Test Loss: 0.0792675
Validation loss decreased (0.074496 --> 0.074468).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0807086
	speed: 0.0424s/iter; left time: 767.8067s
	iters: 200, epoch: 20 | loss: 0.0757208
	speed: 0.0208s/iter; left time: 375.4239s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0768689 Vali Loss: 0.0743737 Test Loss: 0.0792753
Validation loss decreased (0.074468 --> 0.074374).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0757226
	speed: 0.0429s/iter; left time: 767.8128s
	iters: 200, epoch: 21 | loss: 0.0786389
	speed: 0.0209s/iter; left time: 371.3083s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0767737 Vali Loss: 0.0742612 Test Loss: 0.0792980
Validation loss decreased (0.074374 --> 0.074261).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0767378
	speed: 0.0428s/iter; left time: 755.7606s
	iters: 200, epoch: 22 | loss: 0.0715712
	speed: 0.0210s/iter; left time: 368.9089s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0766468 Vali Loss: 0.0742626 Test Loss: 0.0791987
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0740811
	speed: 0.0424s/iter; left time: 739.8467s
	iters: 200, epoch: 23 | loss: 0.0805914
	speed: 0.0208s/iter; left time: 361.2949s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0765060 Vali Loss: 0.0741969 Test Loss: 0.0790897
Validation loss decreased (0.074261 --> 0.074197).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0789765
	speed: 0.0431s/iter; left time: 741.6001s
	iters: 200, epoch: 24 | loss: 0.0792555
	speed: 0.0208s/iter; left time: 356.5211s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0764295 Vali Loss: 0.0741928 Test Loss: 0.0790885
Validation loss decreased (0.074197 --> 0.074193).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0770093
	speed: 0.0438s/iter; left time: 744.7209s
	iters: 200, epoch: 25 | loss: 0.0734579
	speed: 0.0207s/iter; left time: 349.9033s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0763085 Vali Loss: 0.0740530 Test Loss: 0.0790376
Validation loss decreased (0.074193 --> 0.074053).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0832152
	speed: 0.0453s/iter; left time: 759.3065s
	iters: 200, epoch: 26 | loss: 0.0771939
	speed: 0.0208s/iter; left time: 347.2092s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.11s
Steps: 225 | Train Loss: 0.0762396 Vali Loss: 0.0740980 Test Loss: 0.0791892
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0793880
	speed: 0.0434s/iter; left time: 718.4866s
	iters: 200, epoch: 27 | loss: 0.0780192
	speed: 0.0211s/iter; left time: 347.3819s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.0762377 Vali Loss: 0.0741957 Test Loss: 0.0793163
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0764170
	speed: 0.0426s/iter; left time: 694.9966s
	iters: 200, epoch: 28 | loss: 0.0761216
	speed: 0.0208s/iter; left time: 338.2918s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0761330 Vali Loss: 0.0740410 Test Loss: 0.0790464
Validation loss decreased (0.074053 --> 0.074041).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0765215
	speed: 0.0427s/iter; left time: 687.8919s
	iters: 200, epoch: 29 | loss: 0.0725563
	speed: 0.0208s/iter; left time: 332.4940s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0760898 Vali Loss: 0.0741024 Test Loss: 0.0792137
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0759419
	speed: 0.0422s/iter; left time: 670.5457s
	iters: 200, epoch: 30 | loss: 0.0745000
	speed: 0.0209s/iter; left time: 330.2125s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0760080 Vali Loss: 0.0740135 Test Loss: 0.0790522
Validation loss decreased (0.074041 --> 0.074014).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0778709
	speed: 0.0429s/iter; left time: 671.6879s
	iters: 200, epoch: 31 | loss: 0.0792639
	speed: 0.0208s/iter; left time: 323.3313s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0760577 Vali Loss: 0.0741240 Test Loss: 0.0792914
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0790154
	speed: 0.0419s/iter; left time: 645.6491s
	iters: 200, epoch: 32 | loss: 0.0769542
	speed: 0.0208s/iter; left time: 318.7286s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0760318 Vali Loss: 0.0740355 Test Loss: 0.0791062
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0813910
	speed: 0.0417s/iter; left time: 633.5168s
	iters: 200, epoch: 33 | loss: 0.0737934
	speed: 0.0213s/iter; left time: 321.0924s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0759564 Vali Loss: 0.0739913 Test Loss: 0.0790909
Validation loss decreased (0.074014 --> 0.073991).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0782049
	speed: 0.0421s/iter; left time: 630.2455s
	iters: 200, epoch: 34 | loss: 0.0774192
	speed: 0.0209s/iter; left time: 311.4326s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0759514 Vali Loss: 0.0739873 Test Loss: 0.0791798
Validation loss decreased (0.073991 --> 0.073987).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0769778
	speed: 0.0436s/iter; left time: 642.9995s
	iters: 200, epoch: 35 | loss: 0.0772953
	speed: 0.0208s/iter; left time: 304.9065s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.17s
Steps: 225 | Train Loss: 0.0758533 Vali Loss: 0.0739304 Test Loss: 0.0789606
Validation loss decreased (0.073987 --> 0.073930).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0746399
	speed: 0.0455s/iter; left time: 661.3682s
	iters: 200, epoch: 36 | loss: 0.0737523
	speed: 0.0208s/iter; left time: 299.9973s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0758686 Vali Loss: 0.0739765 Test Loss: 0.0790756
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0740244
	speed: 0.0424s/iter; left time: 605.7217s
	iters: 200, epoch: 37 | loss: 0.0774450
	speed: 0.0207s/iter; left time: 294.2206s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0758347 Vali Loss: 0.0739992 Test Loss: 0.0791410
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0760316
	speed: 0.0423s/iter; left time: 594.7847s
	iters: 200, epoch: 38 | loss: 0.0810028
	speed: 0.0208s/iter; left time: 291.0087s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0758681 Vali Loss: 0.0739593 Test Loss: 0.0791034
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0781216
	speed: 0.0430s/iter; left time: 595.2613s
	iters: 200, epoch: 39 | loss: 0.0778835
	speed: 0.0211s/iter; left time: 289.4753s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.0758622 Vali Loss: 0.0739404 Test Loss: 0.0790583
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0765964
	speed: 0.0419s/iter; left time: 570.6301s
	iters: 200, epoch: 40 | loss: 0.0763901
	speed: 0.0208s/iter; left time: 281.6789s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.86s
Steps: 225 | Train Loss: 0.0758224 Vali Loss: 0.0739679 Test Loss: 0.0791334
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0790652
	speed: 0.0421s/iter; left time: 563.5811s
	iters: 200, epoch: 41 | loss: 0.0755022
	speed: 0.0209s/iter; left time: 278.3591s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0757684 Vali Loss: 0.0739002 Test Loss: 0.0790835
Validation loss decreased (0.073930 --> 0.073900).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0815259
	speed: 0.0429s/iter; left time: 565.5794s
	iters: 200, epoch: 42 | loss: 0.0795795
	speed: 0.0208s/iter; left time: 272.5765s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0757486 Vali Loss: 0.0739190 Test Loss: 0.0790768
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0742600
	speed: 0.0424s/iter; left time: 548.7140s
	iters: 200, epoch: 43 | loss: 0.0753905
	speed: 0.0208s/iter; left time: 267.4621s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0758130 Vali Loss: 0.0739081 Test Loss: 0.0790901
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0768929
	speed: 0.0432s/iter; left time: 549.9354s
	iters: 200, epoch: 44 | loss: 0.0757903
	speed: 0.0212s/iter; left time: 267.8504s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0757794 Vali Loss: 0.0738924 Test Loss: 0.0790688
Validation loss decreased (0.073900 --> 0.073892).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0742073
	speed: 0.0453s/iter; left time: 565.6969s
	iters: 200, epoch: 45 | loss: 0.0791050
	speed: 0.0209s/iter; left time: 259.7485s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.17s
Steps: 225 | Train Loss: 0.0756737 Vali Loss: 0.0739171 Test Loss: 0.0791214
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0739328
	speed: 0.0424s/iter; left time: 519.9308s
	iters: 200, epoch: 46 | loss: 0.0770414
	speed: 0.0207s/iter; left time: 252.1723s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0757725 Vali Loss: 0.0739116 Test Loss: 0.0790839
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0783244
	speed: 0.0424s/iter; left time: 511.2184s
	iters: 200, epoch: 47 | loss: 0.0803114
	speed: 0.0207s/iter; left time: 247.8233s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0757178 Vali Loss: 0.0738894 Test Loss: 0.0791115
Validation loss decreased (0.073892 --> 0.073889).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0748944
	speed: 0.0432s/iter; left time: 510.9230s
	iters: 200, epoch: 48 | loss: 0.0788200
	speed: 0.0208s/iter; left time: 244.0267s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0757473 Vali Loss: 0.0738987 Test Loss: 0.0791051
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0736010
	speed: 0.0431s/iter; left time: 500.0674s
	iters: 200, epoch: 49 | loss: 0.0762456
	speed: 0.0207s/iter; left time: 238.5617s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0757577 Vali Loss: 0.0738834 Test Loss: 0.0790763
Validation loss decreased (0.073889 --> 0.073883).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0700971
	speed: 0.0430s/iter; left time: 488.8589s
	iters: 200, epoch: 50 | loss: 0.0790049
	speed: 0.0208s/iter; left time: 234.9732s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0757238 Vali Loss: 0.0739081 Test Loss: 0.0790725
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0741337
	speed: 0.0434s/iter; left time: 483.5952s
	iters: 200, epoch: 51 | loss: 0.0769934
	speed: 0.0213s/iter; left time: 235.6582s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.07s
Steps: 225 | Train Loss: 0.0757236 Vali Loss: 0.0738909 Test Loss: 0.0790586
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0763995
	speed: 0.0427s/iter; left time: 466.1849s
	iters: 200, epoch: 52 | loss: 0.0747798
	speed: 0.0208s/iter; left time: 225.6680s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0757349 Vali Loss: 0.0738992 Test Loss: 0.0790633
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0728023
	speed: 0.0423s/iter; left time: 452.7777s
	iters: 200, epoch: 53 | loss: 0.0762027
	speed: 0.0209s/iter; left time: 221.2828s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0756397 Vali Loss: 0.0739138 Test Loss: 0.0791167
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0740082
	speed: 0.0450s/iter; left time: 471.0190s
	iters: 200, epoch: 54 | loss: 0.0776390
	speed: 0.0218s/iter; left time: 226.0427s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.15s
Steps: 225 | Train Loss: 0.0756919 Vali Loss: 0.0738933 Test Loss: 0.0790710
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0747488
	speed: 0.0422s/iter; left time: 433.0729s
	iters: 200, epoch: 55 | loss: 0.0785796
	speed: 0.0208s/iter; left time: 211.1443s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0757207 Vali Loss: 0.0739212 Test Loss: 0.0790721
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0747373
	speed: 0.0422s/iter; left time: 423.0414s
	iters: 200, epoch: 56 | loss: 0.0743050
	speed: 0.0208s/iter; left time: 206.6300s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0757606 Vali Loss: 0.0739115 Test Loss: 0.0790838
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0753724
	speed: 0.0423s/iter; left time: 414.1041s
	iters: 200, epoch: 57 | loss: 0.0762969
	speed: 0.0208s/iter; left time: 202.0542s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0756882 Vali Loss: 0.0739037 Test Loss: 0.0791009
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0766754
	speed: 0.0419s/iter; left time: 400.8963s
	iters: 200, epoch: 58 | loss: 0.0779277
	speed: 0.0209s/iter; left time: 198.3851s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0756607 Vali Loss: 0.0738946 Test Loss: 0.0790789
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0737864
	speed: 0.0425s/iter; left time: 397.3271s
	iters: 200, epoch: 59 | loss: 0.0765655
	speed: 0.0208s/iter; left time: 192.5878s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.89s
Steps: 225 | Train Loss: 0.0757330 Vali Loss: 0.0738989 Test Loss: 0.0790683
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01840369589626789, rmse:0.13566021621227264, mae:0.07907634228467941, rse:0.5129459500312805
Intermediate time for IT and pred_len 96: 00h:13m:02.77s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1675196
	speed: 0.0455s/iter; left time: 1019.6653s
	iters: 200, epoch: 1 | loss: 0.1351112
	speed: 0.0208s/iter; left time: 464.3052s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.25s
Steps: 225 | Train Loss: 0.1671171 Vali Loss: 0.1215574 Test Loss: 0.1261611
Validation loss decreased (inf --> 0.121557).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1031348
	speed: 0.0437s/iter; left time: 969.0172s
	iters: 200, epoch: 2 | loss: 0.0999422
	speed: 0.0220s/iter; left time: 485.3338s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.1065610 Vali Loss: 0.0884258 Test Loss: 0.0920818
Validation loss decreased (0.121557 --> 0.088426).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0900225
	speed: 0.0428s/iter; left time: 938.9655s
	iters: 200, epoch: 3 | loss: 0.0932892
	speed: 0.0225s/iter; left time: 490.7289s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.12s
Steps: 225 | Train Loss: 0.0926197 Vali Loss: 0.0852258 Test Loss: 0.0879315
Validation loss decreased (0.088426 --> 0.085226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0967898
	speed: 0.0440s/iter; left time: 955.5760s
	iters: 200, epoch: 4 | loss: 0.0888191
	speed: 0.0210s/iter; left time: 454.5103s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.92s
Steps: 225 | Train Loss: 0.0894399 Vali Loss: 0.0838193 Test Loss: 0.0868821
Validation loss decreased (0.085226 --> 0.083819).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0854920
	speed: 0.0425s/iter; left time: 914.2286s
	iters: 200, epoch: 5 | loss: 0.0858616
	speed: 0.0209s/iter; left time: 446.6717s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.87s
Steps: 225 | Train Loss: 0.0877595 Vali Loss: 0.0828019 Test Loss: 0.0860332
Validation loss decreased (0.083819 --> 0.082802).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0848903
	speed: 0.0431s/iter; left time: 917.5603s
	iters: 200, epoch: 6 | loss: 0.0884574
	speed: 0.0213s/iter; left time: 451.1935s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0865596 Vali Loss: 0.0821893 Test Loss: 0.0856452
Validation loss decreased (0.082802 --> 0.082189).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0887724
	speed: 0.0432s/iter; left time: 909.2714s
	iters: 200, epoch: 7 | loss: 0.0849123
	speed: 0.0210s/iter; left time: 439.8297s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0856343 Vali Loss: 0.0817578 Test Loss: 0.0851978
Validation loss decreased (0.082189 --> 0.081758).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0789314
	speed: 0.0439s/iter; left time: 914.9497s
	iters: 200, epoch: 8 | loss: 0.0849873
	speed: 0.0210s/iter; left time: 435.0862s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0849655 Vali Loss: 0.0811689 Test Loss: 0.0848261
Validation loss decreased (0.081758 --> 0.081169).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0853073
	speed: 0.0431s/iter; left time: 887.0343s
	iters: 200, epoch: 9 | loss: 0.0846582
	speed: 0.0215s/iter; left time: 441.0142s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.0844583 Vali Loss: 0.0811148 Test Loss: 0.0850324
Validation loss decreased (0.081169 --> 0.081115).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0830734
	speed: 0.0443s/iter; left time: 903.2897s
	iters: 200, epoch: 10 | loss: 0.0843825
	speed: 0.0211s/iter; left time: 428.0551s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0839714 Vali Loss: 0.0809264 Test Loss: 0.0847705
Validation loss decreased (0.081115 --> 0.080926).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0843134
	speed: 0.0446s/iter; left time: 898.3811s
	iters: 200, epoch: 11 | loss: 0.0844380
	speed: 0.0212s/iter; left time: 424.4577s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0835984 Vali Loss: 0.0808471 Test Loss: 0.0847906
Validation loss decreased (0.080926 --> 0.080847).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0834019
	speed: 0.0448s/iter; left time: 892.2764s
	iters: 200, epoch: 12 | loss: 0.0831338
	speed: 0.0216s/iter; left time: 427.7258s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.04s
Steps: 225 | Train Loss: 0.0832907 Vali Loss: 0.0806723 Test Loss: 0.0847298
Validation loss decreased (0.080847 --> 0.080672).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0809376
	speed: 0.0437s/iter; left time: 860.7938s
	iters: 200, epoch: 13 | loss: 0.0834955
	speed: 0.0214s/iter; left time: 419.2213s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0829945 Vali Loss: 0.0804892 Test Loss: 0.0845646
Validation loss decreased (0.080672 --> 0.080489).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0804204
	speed: 0.0460s/iter; left time: 896.7504s
	iters: 200, epoch: 14 | loss: 0.0837203
	speed: 0.0226s/iter; left time: 437.9881s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.23s
Steps: 225 | Train Loss: 0.0827314 Vali Loss: 0.0807291 Test Loss: 0.0849005
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0817830
	speed: 0.0452s/iter; left time: 870.7303s
	iters: 200, epoch: 15 | loss: 0.0796863
	speed: 0.0223s/iter; left time: 426.5884s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.33s
Steps: 225 | Train Loss: 0.0825446 Vali Loss: 0.0806930 Test Loss: 0.0848130
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0841687
	speed: 0.0451s/iter; left time: 858.3058s
	iters: 200, epoch: 16 | loss: 0.0846400
	speed: 0.0212s/iter; left time: 400.8640s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0823802 Vali Loss: 0.0802775 Test Loss: 0.0843863
Validation loss decreased (0.080489 --> 0.080277).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0783478
	speed: 0.0432s/iter; left time: 812.7774s
	iters: 200, epoch: 17 | loss: 0.0813191
	speed: 0.0215s/iter; left time: 401.9716s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0821796 Vali Loss: 0.0805252 Test Loss: 0.0847103
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0785803
	speed: 0.0444s/iter; left time: 824.1841s
	iters: 200, epoch: 18 | loss: 0.0818048
	speed: 0.0222s/iter; left time: 410.6834s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.23s
Steps: 225 | Train Loss: 0.0820156 Vali Loss: 0.0805238 Test Loss: 0.0847063
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800474
	speed: 0.0458s/iter; left time: 840.6102s
	iters: 200, epoch: 19 | loss: 0.0857451
	speed: 0.0214s/iter; left time: 390.8593s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0818886 Vali Loss: 0.0803709 Test Loss: 0.0845447
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0820571
	speed: 0.0427s/iter; left time: 774.2087s
	iters: 200, epoch: 20 | loss: 0.0827842
	speed: 0.0211s/iter; left time: 379.9213s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.0817707 Vali Loss: 0.0800992 Test Loss: 0.0843321
Validation loss decreased (0.080277 --> 0.080099).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0820213
	speed: 0.0448s/iter; left time: 801.3819s
	iters: 200, epoch: 21 | loss: 0.0828019
	speed: 0.0214s/iter; left time: 381.5673s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0816757 Vali Loss: 0.0801997 Test Loss: 0.0845056
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0833179
	speed: 0.0437s/iter; left time: 771.6586s
	iters: 200, epoch: 22 | loss: 0.0828262
	speed: 0.0213s/iter; left time: 374.3427s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0816062 Vali Loss: 0.0802053 Test Loss: 0.0843733
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0830522
	speed: 0.0426s/iter; left time: 742.5511s
	iters: 200, epoch: 23 | loss: 0.0795102
	speed: 0.0209s/iter; left time: 361.9630s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0814414 Vali Loss: 0.0802630 Test Loss: 0.0844419
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0818892
	speed: 0.0440s/iter; left time: 757.4071s
	iters: 200, epoch: 24 | loss: 0.0818965
	speed: 0.0213s/iter; left time: 365.4885s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.0813995 Vali Loss: 0.0802461 Test Loss: 0.0845363
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0841812
	speed: 0.0458s/iter; left time: 779.0422s
	iters: 200, epoch: 25 | loss: 0.0822478
	speed: 0.0225s/iter; left time: 380.5194s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.28s
Steps: 225 | Train Loss: 0.0813018 Vali Loss: 0.0802634 Test Loss: 0.0843812
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0777834
	speed: 0.0458s/iter; left time: 768.9485s
	iters: 200, epoch: 26 | loss: 0.0825829
	speed: 0.0231s/iter; left time: 385.7668s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.32s
Steps: 225 | Train Loss: 0.0812938 Vali Loss: 0.0803251 Test Loss: 0.0844741
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0830875
	speed: 0.0447s/iter; left time: 739.8634s
	iters: 200, epoch: 27 | loss: 0.0833670
	speed: 0.0211s/iter; left time: 347.0183s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.09s
Steps: 225 | Train Loss: 0.0812281 Vali Loss: 0.0802615 Test Loss: 0.0844546
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0843309
	speed: 0.0485s/iter; left time: 791.9854s
	iters: 200, epoch: 28 | loss: 0.0831686
	speed: 0.0210s/iter; left time: 340.3184s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.35s
Steps: 225 | Train Loss: 0.0811787 Vali Loss: 0.0801265 Test Loss: 0.0844517
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0850645
	speed: 0.0454s/iter; left time: 730.9687s
	iters: 200, epoch: 29 | loss: 0.0777995
	speed: 0.0213s/iter; left time: 341.1828s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.16s
Steps: 225 | Train Loss: 0.0811257 Vali Loss: 0.0802395 Test Loss: 0.0844292
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0833312
	speed: 0.0437s/iter; left time: 694.2218s
	iters: 200, epoch: 30 | loss: 0.0835697
	speed: 0.0210s/iter; left time: 331.4497s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.07s
Steps: 225 | Train Loss: 0.0810430 Vali Loss: 0.0800870 Test Loss: 0.0843664
Validation loss decreased (0.080099 --> 0.080087).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0794675
	speed: 0.0447s/iter; left time: 698.9395s
	iters: 200, epoch: 31 | loss: 0.0752372
	speed: 0.0214s/iter; left time: 332.8691s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0810523 Vali Loss: 0.0801989 Test Loss: 0.0844223
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0761456
	speed: 0.0427s/iter; left time: 658.7947s
	iters: 200, epoch: 32 | loss: 0.0814829
	speed: 0.0209s/iter; left time: 321.0435s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.94s
Steps: 225 | Train Loss: 0.0809560 Vali Loss: 0.0802140 Test Loss: 0.0844132
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0846063
	speed: 0.0426s/iter; left time: 648.2480s
	iters: 200, epoch: 33 | loss: 0.0834327
	speed: 0.0215s/iter; left time: 324.0624s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0809523 Vali Loss: 0.0801794 Test Loss: 0.0844204
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0829760
	speed: 0.0445s/iter; left time: 665.9268s
	iters: 200, epoch: 34 | loss: 0.0789234
	speed: 0.0211s/iter; left time: 314.2242s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0809624 Vali Loss: 0.0801088 Test Loss: 0.0844282
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0787716
	speed: 0.0434s/iter; left time: 640.1970s
	iters: 200, epoch: 35 | loss: 0.0819648
	speed: 0.0210s/iter; left time: 307.9840s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0809053 Vali Loss: 0.0802213 Test Loss: 0.0844526
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0825160
	speed: 0.0430s/iter; left time: 624.7136s
	iters: 200, epoch: 36 | loss: 0.0825815
	speed: 0.0236s/iter; left time: 340.2649s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.27s
Steps: 225 | Train Loss: 0.0809145 Vali Loss: 0.0801888 Test Loss: 0.0844691
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0832706
	speed: 0.0461s/iter; left time: 659.4208s
	iters: 200, epoch: 37 | loss: 0.0800724
	speed: 0.0247s/iter; left time: 350.5937s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.50s
Steps: 225 | Train Loss: 0.0809248 Vali Loss: 0.0802255 Test Loss: 0.0845230
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0829193
	speed: 0.0446s/iter; left time: 627.5722s
	iters: 200, epoch: 38 | loss: 0.0800956
	speed: 0.0214s/iter; left time: 299.3514s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.06s
Steps: 225 | Train Loss: 0.0808739 Vali Loss: 0.0801478 Test Loss: 0.0844169
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0799479
	speed: 0.0425s/iter; left time: 588.2335s
	iters: 200, epoch: 39 | loss: 0.0808654
	speed: 0.0212s/iter; left time: 291.6340s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.0808252 Vali Loss: 0.0801744 Test Loss: 0.0843554
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0795623
	speed: 0.0441s/iter; left time: 601.1513s
	iters: 200, epoch: 40 | loss: 0.0801233
	speed: 0.0211s/iter; left time: 285.0081s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.0808554 Vali Loss: 0.0801609 Test Loss: 0.0843641
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019854335114359856, rmse:0.14090541005134583, mae:0.0843663439154625, rse:0.5332736968994141
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1652622
	speed: 0.0232s/iter; left time: 519.1311s
	iters: 200, epoch: 1 | loss: 0.1404813
	speed: 0.0210s/iter; left time: 469.1548s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.1664556 Vali Loss: 0.1211868 Test Loss: 0.1257116
Validation loss decreased (inf --> 0.121187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1001732
	speed: 0.0443s/iter; left time: 981.5909s
	iters: 200, epoch: 2 | loss: 0.0941014
	speed: 0.0212s/iter; left time: 467.2625s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.98s
Steps: 225 | Train Loss: 0.1058553 Vali Loss: 0.0880442 Test Loss: 0.0913735
Validation loss decreased (0.121187 --> 0.088044).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0931144
	speed: 0.0447s/iter; left time: 981.7382s
	iters: 200, epoch: 3 | loss: 0.0911077
	speed: 0.0211s/iter; left time: 461.4357s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0923617 Vali Loss: 0.0853995 Test Loss: 0.0880064
Validation loss decreased (0.088044 --> 0.085400).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0853205
	speed: 0.0446s/iter; left time: 968.7180s
	iters: 200, epoch: 4 | loss: 0.0874901
	speed: 0.0210s/iter; left time: 454.2716s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0895202 Vali Loss: 0.0841055 Test Loss: 0.0870050
Validation loss decreased (0.085400 --> 0.084106).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0884530
	speed: 0.0443s/iter; left time: 951.4534s
	iters: 200, epoch: 5 | loss: 0.0848126
	speed: 0.0212s/iter; left time: 454.4986s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.0878166 Vali Loss: 0.0832510 Test Loss: 0.0864866
Validation loss decreased (0.084106 --> 0.083251).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0878976
	speed: 0.0458s/iter; left time: 973.4764s
	iters: 200, epoch: 6 | loss: 0.0865265
	speed: 0.0211s/iter; left time: 447.1548s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.05s
Steps: 225 | Train Loss: 0.0865827 Vali Loss: 0.0824401 Test Loss: 0.0857387
Validation loss decreased (0.083251 --> 0.082440).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0860272
	speed: 0.0474s/iter; left time: 998.4010s
	iters: 200, epoch: 7 | loss: 0.0851911
	speed: 0.0226s/iter; left time: 472.9899s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.47s
Steps: 225 | Train Loss: 0.0856870 Vali Loss: 0.0824135 Test Loss: 0.0859005
Validation loss decreased (0.082440 --> 0.082414).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0836059
	speed: 0.0474s/iter; left time: 987.9994s
	iters: 200, epoch: 8 | loss: 0.0850868
	speed: 0.0240s/iter; left time: 497.4643s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.44s
Steps: 225 | Train Loss: 0.0850325 Vali Loss: 0.0819788 Test Loss: 0.0854102
Validation loss decreased (0.082414 --> 0.081979).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0825220
	speed: 0.0448s/iter; left time: 922.1460s
	iters: 200, epoch: 9 | loss: 0.0837478
	speed: 0.0209s/iter; left time: 429.1055s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0845037 Vali Loss: 0.0815998 Test Loss: 0.0851035
Validation loss decreased (0.081979 --> 0.081600).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0803746
	speed: 0.0453s/iter; left time: 923.0652s
	iters: 200, epoch: 10 | loss: 0.0891691
	speed: 0.0210s/iter; left time: 425.4087s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.93s
Steps: 225 | Train Loss: 0.0840277 Vali Loss: 0.0817864 Test Loss: 0.0854826
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0864499
	speed: 0.0432s/iter; left time: 870.8315s
	iters: 200, epoch: 11 | loss: 0.0839852
	speed: 0.0208s/iter; left time: 417.1957s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.91s
Steps: 225 | Train Loss: 0.0836376 Vali Loss: 0.0811616 Test Loss: 0.0847526
Validation loss decreased (0.081600 --> 0.081162).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0767773
	speed: 0.0456s/iter; left time: 907.7313s
	iters: 200, epoch: 12 | loss: 0.0848929
	speed: 0.0209s/iter; left time: 414.3811s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0832515 Vali Loss: 0.0814082 Test Loss: 0.0850126
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0802320
	speed: 0.0440s/iter; left time: 866.5832s
	iters: 200, epoch: 13 | loss: 0.0809709
	speed: 0.0216s/iter; left time: 424.1070s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.04s
Steps: 225 | Train Loss: 0.0829782 Vali Loss: 0.0811389 Test Loss: 0.0850046
Validation loss decreased (0.081162 --> 0.081139).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0820090
	speed: 0.0441s/iter; left time: 858.8439s
	iters: 200, epoch: 14 | loss: 0.0813529
	speed: 0.0212s/iter; left time: 409.8720s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0827546 Vali Loss: 0.0811062 Test Loss: 0.0849319
Validation loss decreased (0.081139 --> 0.081106).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0848976
	speed: 0.0447s/iter; left time: 860.7876s
	iters: 200, epoch: 15 | loss: 0.0821725
	speed: 0.0211s/iter; left time: 404.9143s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.96s
Steps: 225 | Train Loss: 0.0825002 Vali Loss: 0.0809575 Test Loss: 0.0847491
Validation loss decreased (0.081106 --> 0.080958).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0843849
	speed: 0.0445s/iter; left time: 846.6210s
	iters: 200, epoch: 16 | loss: 0.0846112
	speed: 0.0211s/iter; left time: 400.0350s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.04s
Steps: 225 | Train Loss: 0.0823768 Vali Loss: 0.0810634 Test Loss: 0.0850165
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0804768
	speed: 0.0445s/iter; left time: 837.5316s
	iters: 200, epoch: 17 | loss: 0.0819272
	speed: 0.0215s/iter; left time: 401.5585s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0821746 Vali Loss: 0.0809309 Test Loss: 0.0847746
Validation loss decreased (0.080958 --> 0.080931).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0849409
	speed: 0.0486s/iter; left time: 902.0315s
	iters: 200, epoch: 18 | loss: 0.0796754
	speed: 0.0231s/iter; left time: 426.0683s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.39s
Steps: 225 | Train Loss: 0.0820180 Vali Loss: 0.0812055 Test Loss: 0.0849243
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0853030
	speed: 0.0452s/iter; left time: 829.6599s
	iters: 200, epoch: 19 | loss: 0.0831308
	speed: 0.0222s/iter; left time: 405.4055s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.22s
Steps: 225 | Train Loss: 0.0819087 Vali Loss: 0.0809420 Test Loss: 0.0848769
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0851120
	speed: 0.0440s/iter; left time: 798.2612s
	iters: 200, epoch: 20 | loss: 0.0824348
	speed: 0.0214s/iter; left time: 385.0279s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.01s
Steps: 225 | Train Loss: 0.0817413 Vali Loss: 0.0807580 Test Loss: 0.0846950
Validation loss decreased (0.080931 --> 0.080758).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0814391
	speed: 0.0443s/iter; left time: 793.3440s
	iters: 200, epoch: 21 | loss: 0.0771562
	speed: 0.0210s/iter; left time: 373.5940s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.97s
Steps: 225 | Train Loss: 0.0816750 Vali Loss: 0.0808036 Test Loss: 0.0846861
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0778086
	speed: 0.0451s/iter; left time: 797.0586s
	iters: 200, epoch: 22 | loss: 0.0811467
	speed: 0.0215s/iter; left time: 377.8273s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.10s
Steps: 225 | Train Loss: 0.0815788 Vali Loss: 0.0809256 Test Loss: 0.0848525
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0824416
	speed: 0.0441s/iter; left time: 770.0673s
	iters: 200, epoch: 23 | loss: 0.0784462
	speed: 0.0213s/iter; left time: 369.5129s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.99s
Steps: 225 | Train Loss: 0.0814378 Vali Loss: 0.0809654 Test Loss: 0.0849848
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0791086
	speed: 0.0436s/iter; left time: 751.3391s
	iters: 200, epoch: 24 | loss: 0.0820934
	speed: 0.0216s/iter; left time: 370.5619s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.06s
Steps: 225 | Train Loss: 0.0814123 Vali Loss: 0.0806765 Test Loss: 0.0846652
Validation loss decreased (0.080758 --> 0.080677).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0811704
	speed: 0.0457s/iter; left time: 776.4811s
	iters: 200, epoch: 25 | loss: 0.0821694
	speed: 0.0217s/iter; left time: 367.4871s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.10s
Steps: 225 | Train Loss: 0.0813322 Vali Loss: 0.0805845 Test Loss: 0.0845726
Validation loss decreased (0.080677 --> 0.080584).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0817250
	speed: 0.0462s/iter; left time: 774.3704s
	iters: 200, epoch: 26 | loss: 0.0778832
	speed: 0.0218s/iter; left time: 363.5466s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.10s
Steps: 225 | Train Loss: 0.0812857 Vali Loss: 0.0807814 Test Loss: 0.0848495
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0824615
	speed: 0.0433s/iter; left time: 717.2513s
	iters: 200, epoch: 27 | loss: 0.0821413
	speed: 0.0214s/iter; left time: 352.0494s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.00s
Steps: 225 | Train Loss: 0.0812399 Vali Loss: 0.0807473 Test Loss: 0.0846913
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0795153
	speed: 0.0441s/iter; left time: 720.7613s
	iters: 200, epoch: 28 | loss: 0.0785849
	speed: 0.0215s/iter; left time: 348.1792s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.08s
Steps: 225 | Train Loss: 0.0811807 Vali Loss: 0.0805473 Test Loss: 0.0845542
Validation loss decreased (0.080584 --> 0.080547).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0777873
	speed: 0.0468s/iter; left time: 752.7332s
	iters: 200, epoch: 29 | loss: 0.0784044
	speed: 0.0228s/iter; left time: 364.8290s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.42s
Steps: 225 | Train Loss: 0.0810897 Vali Loss: 0.0807531 Test Loss: 0.0847337
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0815641
	speed: 0.0487s/iter; left time: 773.2801s
	iters: 200, epoch: 30 | loss: 0.0812558
	speed: 0.0239s/iter; left time: 376.5028s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.53s
Steps: 225 | Train Loss: 0.0810745 Vali Loss: 0.0806763 Test Loss: 0.0847119
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0809474
	speed: 0.0474s/iter; left time: 742.0042s
	iters: 200, epoch: 31 | loss: 0.0841402
	speed: 0.0215s/iter; left time: 334.7675s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.22s
Steps: 225 | Train Loss: 0.0810559 Vali Loss: 0.0807105 Test Loss: 0.0848644
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0809512
	speed: 0.0464s/iter; left time: 715.3745s
	iters: 200, epoch: 32 | loss: 0.0841629
	speed: 0.0218s/iter; left time: 333.3990s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.22s
Steps: 225 | Train Loss: 0.0810150 Vali Loss: 0.0805942 Test Loss: 0.0846576
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0792692
	speed: 0.0456s/iter; left time: 693.1431s
	iters: 200, epoch: 33 | loss: 0.0807642
	speed: 0.0216s/iter; left time: 325.9586s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.12s
Steps: 225 | Train Loss: 0.0809633 Vali Loss: 0.0807331 Test Loss: 0.0847103
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0831877
	speed: 0.0474s/iter; left time: 709.9593s
	iters: 200, epoch: 34 | loss: 0.0842134
	speed: 0.0216s/iter; left time: 321.5407s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.10s
Steps: 225 | Train Loss: 0.0809410 Vali Loss: 0.0806199 Test Loss: 0.0846308
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0810156
	speed: 0.0443s/iter; left time: 653.5369s
	iters: 200, epoch: 35 | loss: 0.0843082
	speed: 0.0222s/iter; left time: 325.9481s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.09s
Steps: 225 | Train Loss: 0.0809370 Vali Loss: 0.0806307 Test Loss: 0.0846762
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0791221
	speed: 0.0443s/iter; left time: 643.9385s
	iters: 200, epoch: 36 | loss: 0.0835913
	speed: 0.0218s/iter; left time: 314.9123s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.20s
Steps: 225 | Train Loss: 0.0809455 Vali Loss: 0.0806180 Test Loss: 0.0845773
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0796506
	speed: 0.0471s/iter; left time: 673.1462s
	iters: 200, epoch: 37 | loss: 0.0805812
	speed: 0.0217s/iter; left time: 307.8671s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.20s
Steps: 225 | Train Loss: 0.0809259 Vali Loss: 0.0806551 Test Loss: 0.0846410
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0800527
	speed: 0.0454s/iter; left time: 638.7925s
	iters: 200, epoch: 38 | loss: 0.0819848
	speed: 0.0221s/iter; left time: 309.4819s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.19s
Steps: 225 | Train Loss: 0.0809210 Vali Loss: 0.0806320 Test Loss: 0.0846083
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019946319982409477, rmse:0.1412314474582672, mae:0.08455415815114975, rse:0.5345075726509094
Intermediate time for IT and pred_len 168: 00h:08m:50.21sIntermediate time for IT: 00h:33m:43.72sTotal time: 01h:52m:05.01s