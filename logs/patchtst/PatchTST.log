
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1369714
	speed: 0.0541s/iter; left time: 1205.4753s
	iters: 200, epoch: 1 | loss: 0.1247781
	speed: 0.0266s/iter; left time: 591.5635s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.51s
Steps: 224 | Train Loss: 0.1417671 Vali Loss: 0.1297606 Test Loss: 0.1347090
Validation loss decreased (inf --> 0.129761).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0869461
	speed: 0.0521s/iter; left time: 1150.1137s
	iters: 200, epoch: 2 | loss: 0.0833711
	speed: 0.0267s/iter; left time: 587.7804s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0896184 Vali Loss: 0.0936917 Test Loss: 0.0950095
Validation loss decreased (0.129761 --> 0.093692).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0781575
	speed: 0.0518s/iter; left time: 1132.7286s
	iters: 200, epoch: 3 | loss: 0.0792153
	speed: 0.0268s/iter; left time: 582.5031s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0797606 Vali Loss: 0.0909321 Test Loss: 0.0923397
Validation loss decreased (0.093692 --> 0.090932).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0807218
	speed: 0.0511s/iter; left time: 1106.0893s
	iters: 200, epoch: 4 | loss: 0.0808649
	speed: 0.0267s/iter; left time: 574.3723s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0773325 Vali Loss: 0.0890039 Test Loss: 0.0909385
Validation loss decreased (0.090932 --> 0.089004).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0773130
	speed: 0.0520s/iter; left time: 1112.2830s
	iters: 200, epoch: 5 | loss: 0.0740610
	speed: 0.0267s/iter; left time: 569.8133s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0758602 Vali Loss: 0.0885584 Test Loss: 0.0901798
Validation loss decreased (0.089004 --> 0.088558).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0830306
	speed: 0.0516s/iter; left time: 1093.4893s
	iters: 200, epoch: 6 | loss: 0.0726725
	speed: 0.0267s/iter; left time: 563.4790s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0749306 Vali Loss: 0.0880955 Test Loss: 0.0901085
Validation loss decreased (0.088558 --> 0.088095).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0732605
	speed: 0.0517s/iter; left time: 1082.8480s
	iters: 200, epoch: 7 | loss: 0.0776332
	speed: 0.0267s/iter; left time: 555.8914s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0740759 Vali Loss: 0.0876682 Test Loss: 0.0896309
Validation loss decreased (0.088095 --> 0.087668).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0715202
	speed: 0.0528s/iter; left time: 1093.9648s
	iters: 200, epoch: 8 | loss: 0.0723670
	speed: 0.0267s/iter; left time: 550.0941s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0736438 Vali Loss: 0.0882936 Test Loss: 0.0894522
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0775626
	speed: 0.0514s/iter; left time: 1054.5261s
	iters: 200, epoch: 9 | loss: 0.0756080
	speed: 0.0267s/iter; left time: 545.5887s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0733198 Vali Loss: 0.0876187 Test Loss: 0.0892001
Validation loss decreased (0.087668 --> 0.087619).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0764146
	speed: 0.0525s/iter; left time: 1064.7971s
	iters: 200, epoch: 10 | loss: 0.0708030
	speed: 0.0265s/iter; left time: 535.3827s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0727986 Vali Loss: 0.0873704 Test Loss: 0.0889288
Validation loss decreased (0.087619 --> 0.087370).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0678855
	speed: 0.0522s/iter; left time: 1048.0739s
	iters: 200, epoch: 11 | loss: 0.0720052
	speed: 0.0268s/iter; left time: 534.1416s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0725260 Vali Loss: 0.0871207 Test Loss: 0.0886076
Validation loss decreased (0.087370 --> 0.087121).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0715223
	speed: 0.0519s/iter; left time: 1030.5229s
	iters: 200, epoch: 12 | loss: 0.0742159
	speed: 0.0266s/iter; left time: 524.8495s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0722907 Vali Loss: 0.0866924 Test Loss: 0.0887910
Validation loss decreased (0.087121 --> 0.086692).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0667619
	speed: 0.0517s/iter; left time: 1013.0115s
	iters: 200, epoch: 13 | loss: 0.0701735
	speed: 0.0267s/iter; left time: 520.5110s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0720069 Vali Loss: 0.0869621 Test Loss: 0.0883650
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0710825
	speed: 0.0510s/iter; left time: 988.5146s
	iters: 200, epoch: 14 | loss: 0.0727319
	speed: 0.0266s/iter; left time: 512.6291s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0718207 Vali Loss: 0.0862084 Test Loss: 0.0881200
Validation loss decreased (0.086692 --> 0.086208).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0721587
	speed: 0.0518s/iter; left time: 993.4135s
	iters: 200, epoch: 15 | loss: 0.0660384
	speed: 0.0267s/iter; left time: 509.9562s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0716865 Vali Loss: 0.0862676 Test Loss: 0.0882083
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0726189
	speed: 0.0513s/iter; left time: 971.7333s
	iters: 200, epoch: 16 | loss: 0.0699743
	speed: 0.0266s/iter; left time: 500.9338s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0715561 Vali Loss: 0.0862403 Test Loss: 0.0882708
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0734295
	speed: 0.0508s/iter; left time: 950.7064s
	iters: 200, epoch: 17 | loss: 0.0729700
	speed: 0.0269s/iter; left time: 499.9748s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0714500 Vali Loss: 0.0860131 Test Loss: 0.0878391
Validation loss decreased (0.086208 --> 0.086013).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0720860
	speed: 0.0510s/iter; left time: 943.6124s
	iters: 200, epoch: 18 | loss: 0.0807038
	speed: 0.0285s/iter; left time: 524.0595s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.44s
Steps: 224 | Train Loss: 0.0712926 Vali Loss: 0.0858605 Test Loss: 0.0881299
Validation loss decreased (0.086013 --> 0.085860).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0672827
	speed: 0.0521s/iter; left time: 952.6361s
	iters: 200, epoch: 19 | loss: 0.0683527
	speed: 0.0268s/iter; left time: 486.3279s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0712880 Vali Loss: 0.0860396 Test Loss: 0.0881207
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0685089
	speed: 0.0512s/iter; left time: 924.0535s
	iters: 200, epoch: 20 | loss: 0.0723603
	speed: 0.0266s/iter; left time: 477.9046s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0711309 Vali Loss: 0.0858991 Test Loss: 0.0879555
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0669795
	speed: 0.0510s/iter; left time: 908.4794s
	iters: 200, epoch: 21 | loss: 0.0729611
	speed: 0.0266s/iter; left time: 471.7793s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0710612 Vali Loss: 0.0858557 Test Loss: 0.0878603
Validation loss decreased (0.085860 --> 0.085856).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0644646
	speed: 0.0516s/iter; left time: 908.2609s
	iters: 200, epoch: 22 | loss: 0.0674015
	speed: 0.0267s/iter; left time: 466.7681s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0709746 Vali Loss: 0.0858742 Test Loss: 0.0879468
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0715065
	speed: 0.0506s/iter; left time: 878.9808s
	iters: 200, epoch: 23 | loss: 0.0664888
	speed: 0.0266s/iter; left time: 459.9734s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0708909 Vali Loss: 0.0858572 Test Loss: 0.0878468
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0697132
	speed: 0.0514s/iter; left time: 881.7388s
	iters: 200, epoch: 24 | loss: 0.0695731
	speed: 0.0265s/iter; left time: 451.7208s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0709061 Vali Loss: 0.0856822 Test Loss: 0.0878505
Validation loss decreased (0.085856 --> 0.085682).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0698776
	speed: 0.0509s/iter; left time: 862.2074s
	iters: 200, epoch: 25 | loss: 0.0794153
	speed: 0.0264s/iter; left time: 444.6524s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0708391 Vali Loss: 0.0857899 Test Loss: 0.0877605
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0693570
	speed: 0.0507s/iter; left time: 847.0964s
	iters: 200, epoch: 26 | loss: 0.0686728
	speed: 0.0267s/iter; left time: 442.6402s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0708132 Vali Loss: 0.0856289 Test Loss: 0.0876225
Validation loss decreased (0.085682 --> 0.085629).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0736588
	speed: 0.0522s/iter; left time: 859.5258s
	iters: 200, epoch: 27 | loss: 0.0751999
	speed: 0.0266s/iter; left time: 435.8053s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0706946 Vali Loss: 0.0857887 Test Loss: 0.0877622
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0681836
	speed: 0.0513s/iter; left time: 834.2176s
	iters: 200, epoch: 28 | loss: 0.0738424
	speed: 0.0267s/iter; left time: 430.8984s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0707199 Vali Loss: 0.0856799 Test Loss: 0.0876857
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0720591
	speed: 0.0512s/iter; left time: 820.0638s
	iters: 200, epoch: 29 | loss: 0.0661264
	speed: 0.0267s/iter; left time: 425.0420s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0706302 Vali Loss: 0.0856200 Test Loss: 0.0876701
Validation loss decreased (0.085629 --> 0.085620).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0764758
	speed: 0.0525s/iter; left time: 829.9523s
	iters: 200, epoch: 30 | loss: 0.0717371
	speed: 0.0265s/iter; left time: 415.4110s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0705703 Vali Loss: 0.0856172 Test Loss: 0.0877889
Validation loss decreased (0.085620 --> 0.085617).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0694562
	speed: 0.0528s/iter; left time: 823.0867s
	iters: 200, epoch: 31 | loss: 0.0669540
	speed: 0.0271s/iter; left time: 420.0180s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0705669 Vali Loss: 0.0855405 Test Loss: 0.0876212
Validation loss decreased (0.085617 --> 0.085541).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0648792
	speed: 0.0519s/iter; left time: 796.4069s
	iters: 200, epoch: 32 | loss: 0.0739037
	speed: 0.0265s/iter; left time: 403.8020s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0705570 Vali Loss: 0.0856224 Test Loss: 0.0876501
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0760883
	speed: 0.0509s/iter; left time: 769.5590s
	iters: 200, epoch: 33 | loss: 0.0659316
	speed: 0.0264s/iter; left time: 397.5187s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0705282 Vali Loss: 0.0856680 Test Loss: 0.0876398
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0700403
	speed: 0.0509s/iter; left time: 758.6267s
	iters: 200, epoch: 34 | loss: 0.0733599
	speed: 0.0265s/iter; left time: 392.6828s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0705505 Vali Loss: 0.0856534 Test Loss: 0.0876419
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0716821
	speed: 0.0509s/iter; left time: 747.2629s
	iters: 200, epoch: 35 | loss: 0.0660121
	speed: 0.0267s/iter; left time: 389.8769s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0704936 Vali Loss: 0.0856017 Test Loss: 0.0876743
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0702281
	speed: 0.0520s/iter; left time: 751.7426s
	iters: 200, epoch: 36 | loss: 0.0758533
	speed: 0.0268s/iter; left time: 385.3588s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0704848 Vali Loss: 0.0856520 Test Loss: 0.0876421
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0775575
	speed: 0.0516s/iter; left time: 734.5360s
	iters: 200, epoch: 37 | loss: 0.0730687
	speed: 0.0267s/iter; left time: 377.5591s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0705037 Vali Loss: 0.0856726 Test Loss: 0.0876410
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0694183
	speed: 0.0517s/iter; left time: 724.0252s
	iters: 200, epoch: 38 | loss: 0.0666340
	speed: 0.0268s/iter; left time: 372.9038s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0704922 Vali Loss: 0.0855943 Test Loss: 0.0876738
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0741279
	speed: 0.0517s/iter; left time: 713.1725s
	iters: 200, epoch: 39 | loss: 0.0680151
	speed: 0.0268s/iter; left time: 366.5661s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0704478 Vali Loss: 0.0855522 Test Loss: 0.0876500
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0680514
	speed: 0.0510s/iter; left time: 691.1667s
	iters: 200, epoch: 40 | loss: 0.0764029
	speed: 0.0265s/iter; left time: 356.5305s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0704099 Vali Loss: 0.0856432 Test Loss: 0.0876450
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0655310
	speed: 0.0508s/iter; left time: 677.2596s
	iters: 200, epoch: 41 | loss: 0.0691073
	speed: 0.0268s/iter; left time: 355.4340s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0703985 Vali Loss: 0.0854845 Test Loss: 0.0875877
Validation loss decreased (0.085541 --> 0.085485).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0682409
	speed: 0.0513s/iter; left time: 672.5361s
	iters: 200, epoch: 42 | loss: 0.0763331
	speed: 0.0265s/iter; left time: 345.1031s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0704444 Vali Loss: 0.0856361 Test Loss: 0.0876294
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0755680
	speed: 0.0513s/iter; left time: 661.0572s
	iters: 200, epoch: 43 | loss: 0.0719940
	speed: 0.0265s/iter; left time: 339.5485s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0704495 Vali Loss: 0.0855508 Test Loss: 0.0876172
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0644201
	speed: 0.0509s/iter; left time: 645.4822s
	iters: 200, epoch: 44 | loss: 0.0712258
	speed: 0.0265s/iter; left time: 333.6335s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0704013 Vali Loss: 0.0855588 Test Loss: 0.0876322
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0704731
	speed: 0.0520s/iter; left time: 647.4943s
	iters: 200, epoch: 45 | loss: 0.0729366
	speed: 0.0265s/iter; left time: 327.3558s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0703918 Vali Loss: 0.0855635 Test Loss: 0.0876621
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0704228
	speed: 0.0513s/iter; left time: 627.0158s
	iters: 200, epoch: 46 | loss: 0.0755504
	speed: 0.0266s/iter; left time: 323.0006s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0703368 Vali Loss: 0.0855913 Test Loss: 0.0876351
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0714861
	speed: 0.0527s/iter; left time: 632.7437s
	iters: 200, epoch: 47 | loss: 0.0703084
	speed: 0.0270s/iter; left time: 321.7155s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.0703858 Vali Loss: 0.0855839 Test Loss: 0.0876863
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0716547
	speed: 0.0512s/iter; left time: 603.1520s
	iters: 200, epoch: 48 | loss: 0.0697001
	speed: 0.0269s/iter; left time: 314.4462s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0703595 Vali Loss: 0.0855201 Test Loss: 0.0876336
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0721770
	speed: 0.0514s/iter; left time: 593.2863s
	iters: 200, epoch: 49 | loss: 0.0752482
	speed: 0.0269s/iter; left time: 308.3018s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0703970 Vali Loss: 0.0854210 Test Loss: 0.0876339
Validation loss decreased (0.085485 --> 0.085421).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0676463
	speed: 0.0513s/iter; left time: 580.5348s
	iters: 200, epoch: 50 | loss: 0.0677730
	speed: 0.0265s/iter; left time: 297.8902s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0703362 Vali Loss: 0.0856355 Test Loss: 0.0876200
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0666008
	speed: 0.0516s/iter; left time: 573.0979s
	iters: 200, epoch: 51 | loss: 0.0702993
	speed: 0.0268s/iter; left time: 294.2959s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0703573 Vali Loss: 0.0855665 Test Loss: 0.0876208
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0723010
	speed: 0.0510s/iter; left time: 555.1316s
	iters: 200, epoch: 52 | loss: 0.0758060
	speed: 0.0265s/iter; left time: 285.6798s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0703259 Vali Loss: 0.0854868 Test Loss: 0.0876280
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0706884
	speed: 0.0514s/iter; left time: 547.3564s
	iters: 200, epoch: 53 | loss: 0.0751953
	speed: 0.0265s/iter; left time: 280.0987s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0703530 Vali Loss: 0.0855637 Test Loss: 0.0876266
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0702771
	speed: 0.0513s/iter; left time: 535.4939s
	iters: 200, epoch: 54 | loss: 0.0684877
	speed: 0.0268s/iter; left time: 277.2506s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0703710 Vali Loss: 0.0855449 Test Loss: 0.0876197
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0688983
	speed: 0.0514s/iter; left time: 524.3484s
	iters: 200, epoch: 55 | loss: 0.0738532
	speed: 0.0269s/iter; left time: 271.4666s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0703545 Vali Loss: 0.0854906 Test Loss: 0.0876294
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0730539
	speed: 0.0526s/iter; left time: 525.1879s
	iters: 200, epoch: 56 | loss: 0.0674224
	speed: 0.0266s/iter; left time: 263.0577s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0704173 Vali Loss: 0.0854536 Test Loss: 0.0876250
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0707048
	speed: 0.0513s/iter; left time: 500.7753s
	iters: 200, epoch: 57 | loss: 0.0710349
	speed: 0.0265s/iter; left time: 255.7968s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.14s
Steps: 224 | Train Loss: 0.0703584 Vali Loss: 0.0855452 Test Loss: 0.0876381
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0736169
	speed: 0.0504s/iter; left time: 480.1522s
	iters: 200, epoch: 58 | loss: 0.0741034
	speed: 0.0266s/iter; left time: 250.9510s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0703132 Vali Loss: 0.0855490 Test Loss: 0.0876148
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0710790
	speed: 0.0514s/iter; left time: 478.3326s
	iters: 200, epoch: 59 | loss: 0.0729701
	speed: 0.0269s/iter; left time: 247.8992s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0703250 Vali Loss: 0.0855128 Test Loss: 0.0876621
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.020939357578754425, rmse:0.14470438659191132, mae:0.08763387054204941, rse:0.5106817483901978
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1389406
	speed: 0.0286s/iter; left time: 637.3228s
	iters: 200, epoch: 1 | loss: 0.1228134
	speed: 0.0266s/iter; left time: 590.7752s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1422911 Vali Loss: 0.1295809 Test Loss: 0.1351006
Validation loss decreased (inf --> 0.129581).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0877811
	speed: 0.0524s/iter; left time: 1157.5606s
	iters: 200, epoch: 2 | loss: 0.0832211
	speed: 0.0267s/iter; left time: 585.6942s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0894358 Vali Loss: 0.0936241 Test Loss: 0.0940987
Validation loss decreased (0.129581 --> 0.093624).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0775893
	speed: 0.0529s/iter; left time: 1155.7753s
	iters: 200, epoch: 3 | loss: 0.0735417
	speed: 0.0268s/iter; left time: 582.7706s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0796590 Vali Loss: 0.0902558 Test Loss: 0.0915840
Validation loss decreased (0.093624 --> 0.090256).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0772389
	speed: 0.0535s/iter; left time: 1157.4906s
	iters: 200, epoch: 4 | loss: 0.0764423
	speed: 0.0267s/iter; left time: 575.2471s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0774734 Vali Loss: 0.0893443 Test Loss: 0.0907840
Validation loss decreased (0.090256 --> 0.089344).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0743019
	speed: 0.0524s/iter; left time: 1122.3344s
	iters: 200, epoch: 5 | loss: 0.0750691
	speed: 0.0266s/iter; left time: 566.5313s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0761713 Vali Loss: 0.0888839 Test Loss: 0.0900800
Validation loss decreased (0.089344 --> 0.088884).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0693859
	speed: 0.0531s/iter; left time: 1125.5393s
	iters: 200, epoch: 6 | loss: 0.0754470
	speed: 0.0268s/iter; left time: 564.1376s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0751449 Vali Loss: 0.0878856 Test Loss: 0.0899183
Validation loss decreased (0.088884 --> 0.087886).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0723351
	speed: 0.0524s/iter; left time: 1098.0215s
	iters: 200, epoch: 7 | loss: 0.0741934
	speed: 0.0266s/iter; left time: 553.7878s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0744148 Vali Loss: 0.0882161 Test Loss: 0.0896968
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0743478
	speed: 0.0515s/iter; left time: 1067.8407s
	iters: 200, epoch: 8 | loss: 0.0734460
	speed: 0.0266s/iter; left time: 547.8442s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0738465 Vali Loss: 0.0875170 Test Loss: 0.0890645
Validation loss decreased (0.087886 --> 0.087517).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0690735
	speed: 0.0529s/iter; left time: 1085.3019s
	iters: 200, epoch: 9 | loss: 0.0759658
	speed: 0.0267s/iter; left time: 545.8860s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0733618 Vali Loss: 0.0870617 Test Loss: 0.0888512
Validation loss decreased (0.087517 --> 0.087062).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0763888
	speed: 0.0540s/iter; left time: 1095.9059s
	iters: 200, epoch: 10 | loss: 0.0748855
	speed: 0.0267s/iter; left time: 538.2266s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0729996 Vali Loss: 0.0868114 Test Loss: 0.0887925
Validation loss decreased (0.087062 --> 0.086811).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0753090
	speed: 0.0522s/iter; left time: 1047.6334s
	iters: 200, epoch: 11 | loss: 0.0728513
	speed: 0.0265s/iter; left time: 528.3926s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0726921 Vali Loss: 0.0872061 Test Loss: 0.0885696
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0705457
	speed: 0.0520s/iter; left time: 1031.3150s
	iters: 200, epoch: 12 | loss: 0.0726305
	speed: 0.0265s/iter; left time: 523.8657s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0723711 Vali Loss: 0.0864833 Test Loss: 0.0882598
Validation loss decreased (0.086811 --> 0.086483).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0700529
	speed: 0.0524s/iter; left time: 1027.1079s
	iters: 200, epoch: 13 | loss: 0.0684496
	speed: 0.0267s/iter; left time: 520.3979s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0721546 Vali Loss: 0.0865951 Test Loss: 0.0883359
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0748019
	speed: 0.0529s/iter; left time: 1024.8560s
	iters: 200, epoch: 14 | loss: 0.0713811
	speed: 0.0270s/iter; left time: 520.5069s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0719527 Vali Loss: 0.0866737 Test Loss: 0.0880236
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0713503
	speed: 0.0521s/iter; left time: 999.2792s
	iters: 200, epoch: 15 | loss: 0.0763744
	speed: 0.0266s/iter; left time: 506.3787s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0716899 Vali Loss: 0.0864420 Test Loss: 0.0880862
Validation loss decreased (0.086483 --> 0.086442).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0746533
	speed: 0.0524s/iter; left time: 992.8871s
	iters: 200, epoch: 16 | loss: 0.0665798
	speed: 0.0265s/iter; left time: 499.9673s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0715671 Vali Loss: 0.0860693 Test Loss: 0.0879256
Validation loss decreased (0.086442 --> 0.086069).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0704673
	speed: 0.0527s/iter; left time: 987.2801s
	iters: 200, epoch: 17 | loss: 0.0683351
	speed: 0.0268s/iter; left time: 498.8685s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0714092 Vali Loss: 0.0860398 Test Loss: 0.0881202
Validation loss decreased (0.086069 --> 0.086040).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0692278
	speed: 0.0532s/iter; left time: 984.5075s
	iters: 200, epoch: 18 | loss: 0.0706096
	speed: 0.0265s/iter; left time: 487.5949s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0713103 Vali Loss: 0.0860568 Test Loss: 0.0880662
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0711174
	speed: 0.0527s/iter; left time: 963.1993s
	iters: 200, epoch: 19 | loss: 0.0707833
	speed: 0.0265s/iter; left time: 480.7723s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0711834 Vali Loss: 0.0858907 Test Loss: 0.0879579
Validation loss decreased (0.086040 --> 0.085891).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0700932
	speed: 0.0527s/iter; left time: 951.2086s
	iters: 200, epoch: 20 | loss: 0.0701582
	speed: 0.0268s/iter; left time: 480.1339s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0710876 Vali Loss: 0.0862701 Test Loss: 0.0880781
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0699507
	speed: 0.0528s/iter; left time: 940.8659s
	iters: 200, epoch: 21 | loss: 0.0683075
	speed: 0.0267s/iter; left time: 473.7849s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0710427 Vali Loss: 0.0861612 Test Loss: 0.0881739
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0751726
	speed: 0.0519s/iter; left time: 912.4235s
	iters: 200, epoch: 22 | loss: 0.0686039
	speed: 0.0265s/iter; left time: 464.2898s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0709314 Vali Loss: 0.0859297 Test Loss: 0.0879431
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0740635
	speed: 0.0530s/iter; left time: 920.0264s
	iters: 200, epoch: 23 | loss: 0.0754669
	speed: 0.0267s/iter; left time: 460.5146s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0708511 Vali Loss: 0.0858247 Test Loss: 0.0877661
Validation loss decreased (0.085891 --> 0.085825).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0669902
	speed: 0.0531s/iter; left time: 911.2386s
	iters: 200, epoch: 24 | loss: 0.0699968
	speed: 0.0264s/iter; left time: 450.4041s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0708038 Vali Loss: 0.0857948 Test Loss: 0.0880593
Validation loss decreased (0.085825 --> 0.085795).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0710267
	speed: 0.0519s/iter; left time: 878.6579s
	iters: 200, epoch: 25 | loss: 0.0701005
	speed: 0.0265s/iter; left time: 445.0995s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0707550 Vali Loss: 0.0858620 Test Loss: 0.0879302
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0675721
	speed: 0.0519s/iter; left time: 866.8273s
	iters: 200, epoch: 26 | loss: 0.0723306
	speed: 0.0266s/iter; left time: 441.2651s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0707452 Vali Loss: 0.0857506 Test Loss: 0.0878565
Validation loss decreased (0.085795 --> 0.085751).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0725780
	speed: 0.0528s/iter; left time: 869.7247s
	iters: 200, epoch: 27 | loss: 0.0715543
	speed: 0.0268s/iter; left time: 438.1994s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0706913 Vali Loss: 0.0857717 Test Loss: 0.0878863
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0656819
	speed: 0.0536s/iter; left time: 870.6048s
	iters: 200, epoch: 28 | loss: 0.0728222
	speed: 0.0269s/iter; left time: 434.1364s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0706028 Vali Loss: 0.0855976 Test Loss: 0.0878353
Validation loss decreased (0.085751 --> 0.085598).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0716999
	speed: 0.0531s/iter; left time: 850.3424s
	iters: 200, epoch: 29 | loss: 0.0711410
	speed: 0.0265s/iter; left time: 422.4973s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0705973 Vali Loss: 0.0859616 Test Loss: 0.0878585
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0745615
	speed: 0.0523s/iter; left time: 827.2763s
	iters: 200, epoch: 30 | loss: 0.0758140
	speed: 0.0269s/iter; left time: 422.8718s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0705595 Vali Loss: 0.0856872 Test Loss: 0.0878131
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0744614
	speed: 0.0525s/iter; left time: 818.0931s
	iters: 200, epoch: 31 | loss: 0.0705624
	speed: 0.0267s/iter; left time: 414.0832s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0705045 Vali Loss: 0.0857018 Test Loss: 0.0878923
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0687968
	speed: 0.0528s/iter; left time: 810.4927s
	iters: 200, epoch: 32 | loss: 0.0645319
	speed: 0.0267s/iter; left time: 406.9177s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0705371 Vali Loss: 0.0856552 Test Loss: 0.0878005
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0692253
	speed: 0.0522s/iter; left time: 790.4230s
	iters: 200, epoch: 33 | loss: 0.0719842
	speed: 0.0267s/iter; left time: 401.2847s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0704541 Vali Loss: 0.0857210 Test Loss: 0.0878580
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0711537
	speed: 0.0519s/iter; left time: 773.8731s
	iters: 200, epoch: 34 | loss: 0.0700859
	speed: 0.0267s/iter; left time: 395.2276s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0704086 Vali Loss: 0.0857385 Test Loss: 0.0877898
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0727249
	speed: 0.0525s/iter; left time: 771.6492s
	iters: 200, epoch: 35 | loss: 0.0703164
	speed: 0.0265s/iter; left time: 386.3865s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0704289 Vali Loss: 0.0856548 Test Loss: 0.0878404
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0692909
	speed: 0.0518s/iter; left time: 749.3944s
	iters: 200, epoch: 36 | loss: 0.0745890
	speed: 0.0265s/iter; left time: 380.6575s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.12s
Steps: 224 | Train Loss: 0.0704170 Vali Loss: 0.0855795 Test Loss: 0.0877761
Validation loss decreased (0.085598 --> 0.085579).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0669411
	speed: 0.0523s/iter; left time: 743.9817s
	iters: 200, epoch: 37 | loss: 0.0717780
	speed: 0.0265s/iter; left time: 374.9112s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0703451 Vali Loss: 0.0857678 Test Loss: 0.0877872
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0692922
	speed: 0.0523s/iter; left time: 732.2128s
	iters: 200, epoch: 38 | loss: 0.0706012
	speed: 0.0274s/iter; left time: 381.4217s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0703509 Vali Loss: 0.0856808 Test Loss: 0.0877914
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0644956
	speed: 0.0523s/iter; left time: 721.3358s
	iters: 200, epoch: 39 | loss: 0.0683517
	speed: 0.0265s/iter; left time: 362.8521s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0703036 Vali Loss: 0.0857069 Test Loss: 0.0877940
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0712174
	speed: 0.0528s/iter; left time: 716.0116s
	iters: 200, epoch: 40 | loss: 0.0717972
	speed: 0.0266s/iter; left time: 357.5409s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0703386 Vali Loss: 0.0855974 Test Loss: 0.0877805
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0709783
	speed: 0.0521s/iter; left time: 694.8751s
	iters: 200, epoch: 41 | loss: 0.0727384
	speed: 0.0267s/iter; left time: 353.5061s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0703057 Vali Loss: 0.0855847 Test Loss: 0.0877485
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0696685
	speed: 0.0521s/iter; left time: 684.0514s
	iters: 200, epoch: 42 | loss: 0.0708702
	speed: 0.0266s/iter; left time: 345.9082s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0702815 Vali Loss: 0.0856937 Test Loss: 0.0877606
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0755521
	speed: 0.0524s/iter; left time: 675.6540s
	iters: 200, epoch: 43 | loss: 0.0711717
	speed: 0.0266s/iter; left time: 340.3418s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0703419 Vali Loss: 0.0854786 Test Loss: 0.0877750
Validation loss decreased (0.085579 --> 0.085479).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0711064
	speed: 0.0524s/iter; left time: 664.3796s
	iters: 200, epoch: 44 | loss: 0.0720553
	speed: 0.0267s/iter; left time: 335.1416s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0703236 Vali Loss: 0.0856422 Test Loss: 0.0877193
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0685135
	speed: 0.0518s/iter; left time: 645.1912s
	iters: 200, epoch: 45 | loss: 0.0710313
	speed: 0.0270s/iter; left time: 333.5153s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0703195 Vali Loss: 0.0855412 Test Loss: 0.0877509
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0682689
	speed: 0.0519s/iter; left time: 634.1017s
	iters: 200, epoch: 46 | loss: 0.0663539
	speed: 0.0265s/iter; left time: 321.4410s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0702857 Vali Loss: 0.0856832 Test Loss: 0.0877343
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0781750
	speed: 0.0532s/iter; left time: 637.8936s
	iters: 200, epoch: 47 | loss: 0.0668642
	speed: 0.0267s/iter; left time: 317.4136s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0703067 Vali Loss: 0.0856037 Test Loss: 0.0877680
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0757289
	speed: 0.0527s/iter; left time: 620.0069s
	iters: 200, epoch: 48 | loss: 0.0714607
	speed: 0.0265s/iter; left time: 309.2458s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0703030 Vali Loss: 0.0855959 Test Loss: 0.0877536
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0738765
	speed: 0.0524s/iter; left time: 605.3152s
	iters: 200, epoch: 49 | loss: 0.0682928
	speed: 0.0268s/iter; left time: 306.6758s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0703193 Vali Loss: 0.0856737 Test Loss: 0.0877642
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0721883
	speed: 0.0523s/iter; left time: 592.4528s
	iters: 200, epoch: 50 | loss: 0.0696596
	speed: 0.0266s/iter; left time: 298.0533s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0702247 Vali Loss: 0.0856217 Test Loss: 0.0877349
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0724216
	speed: 0.0521s/iter; left time: 578.8286s
	iters: 200, epoch: 51 | loss: 0.0683385
	speed: 0.0264s/iter; left time: 290.4087s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.13s
Steps: 224 | Train Loss: 0.0702224 Vali Loss: 0.0856550 Test Loss: 0.0877666
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0707191
	speed: 0.0517s/iter; left time: 562.1389s
	iters: 200, epoch: 52 | loss: 0.0697485
	speed: 0.0265s/iter; left time: 285.9799s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0702648 Vali Loss: 0.0856051 Test Loss: 0.0877736
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0723032
	speed: 0.0528s/iter; left time: 562.8959s
	iters: 200, epoch: 53 | loss: 0.0695717
	speed: 0.0266s/iter; left time: 280.2167s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0702753 Vali Loss: 0.0856733 Test Loss: 0.0877745
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.020994756370782852, rmse:0.14489567279815674, mae:0.08777499943971634, rse:0.5113568902015686
Intermediate time for DE and pred_len 24: 00h:14m:50.78s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1487391
	speed: 0.0547s/iter; left time: 1219.1487s
	iters: 200, epoch: 1 | loss: 0.1375452
	speed: 0.0269s/iter; left time: 598.1186s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.55s
Steps: 224 | Train Loss: 0.1484455 Vali Loss: 0.1405499 Test Loss: 0.1490060
Validation loss decreased (inf --> 0.140550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1194897
	speed: 0.0533s/iter; left time: 1176.9588s
	iters: 200, epoch: 2 | loss: 0.1064227
	speed: 0.0268s/iter; left time: 588.5725s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.1145359 Vali Loss: 0.1213630 Test Loss: 0.1295630
Validation loss decreased (0.140550 --> 0.121363).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1036745
	speed: 0.0540s/iter; left time: 1179.6751s
	iters: 200, epoch: 3 | loss: 0.1068880
	speed: 0.0268s/iter; left time: 583.1440s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1064633 Vali Loss: 0.1195266 Test Loss: 0.1282235
Validation loss decreased (0.121363 --> 0.119527).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1044791
	speed: 0.0537s/iter; left time: 1160.7622s
	iters: 200, epoch: 4 | loss: 0.1004268
	speed: 0.0269s/iter; left time: 579.9229s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1045039 Vali Loss: 0.1190653 Test Loss: 0.1280503
Validation loss decreased (0.119527 --> 0.119065).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1030031
	speed: 0.0531s/iter; left time: 1137.1471s
	iters: 200, epoch: 5 | loss: 0.0965900
	speed: 0.0268s/iter; left time: 570.3459s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1033400 Vali Loss: 0.1186632 Test Loss: 0.1276050
Validation loss decreased (0.119065 --> 0.118663).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1102587
	speed: 0.0538s/iter; left time: 1140.5733s
	iters: 200, epoch: 6 | loss: 0.1076527
	speed: 0.0269s/iter; left time: 567.7705s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1024590 Vali Loss: 0.1179634 Test Loss: 0.1265461
Validation loss decreased (0.118663 --> 0.117963).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1025728
	speed: 0.0538s/iter; left time: 1126.7627s
	iters: 200, epoch: 7 | loss: 0.0953970
	speed: 0.0269s/iter; left time: 560.6149s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1016823 Vali Loss: 0.1186003 Test Loss: 0.1277381
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0998731
	speed: 0.0539s/iter; left time: 1116.5655s
	iters: 200, epoch: 8 | loss: 0.0977558
	speed: 0.0267s/iter; left time: 551.2720s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1010973 Vali Loss: 0.1182861 Test Loss: 0.1272469
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0999197
	speed: 0.0532s/iter; left time: 1090.9066s
	iters: 200, epoch: 9 | loss: 0.1026386
	speed: 0.0268s/iter; left time: 546.7894s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1004929 Vali Loss: 0.1175796 Test Loss: 0.1266904
Validation loss decreased (0.117963 --> 0.117580).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1008377
	speed: 0.0538s/iter; left time: 1091.6922s
	iters: 200, epoch: 10 | loss: 0.0974689
	speed: 0.0268s/iter; left time: 541.3570s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1000229 Vali Loss: 0.1174014 Test Loss: 0.1273050
Validation loss decreased (0.117580 --> 0.117401).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0975121
	speed: 0.0536s/iter; left time: 1074.5040s
	iters: 200, epoch: 11 | loss: 0.1031677
	speed: 0.0268s/iter; left time: 534.5612s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0996410 Vali Loss: 0.1172269 Test Loss: 0.1274734
Validation loss decreased (0.117401 --> 0.117227).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1019047
	speed: 0.0535s/iter; left time: 1062.0590s
	iters: 200, epoch: 12 | loss: 0.0963887
	speed: 0.0268s/iter; left time: 528.2677s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0992125 Vali Loss: 0.1170878 Test Loss: 0.1278752
Validation loss decreased (0.117227 --> 0.117088).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0961119
	speed: 0.0544s/iter; left time: 1066.5978s
	iters: 200, epoch: 13 | loss: 0.0989636
	speed: 0.0268s/iter; left time: 523.3661s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0988020 Vali Loss: 0.1168609 Test Loss: 0.1279964
Validation loss decreased (0.117088 --> 0.116861).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0999261
	speed: 0.0537s/iter; left time: 1040.9073s
	iters: 200, epoch: 14 | loss: 0.0937633
	speed: 0.0269s/iter; left time: 517.9592s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0984957 Vali Loss: 0.1170542 Test Loss: 0.1275455
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0966726
	speed: 0.0539s/iter; left time: 1033.5501s
	iters: 200, epoch: 15 | loss: 0.0981507
	speed: 0.0270s/iter; left time: 515.3432s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0981710 Vali Loss: 0.1166702 Test Loss: 0.1279635
Validation loss decreased (0.116861 --> 0.116670).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1011894
	speed: 0.0547s/iter; left time: 1036.4337s
	iters: 200, epoch: 16 | loss: 0.1026321
	speed: 0.0271s/iter; left time: 510.4542s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0978653 Vali Loss: 0.1167809 Test Loss: 0.1274564
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0973510
	speed: 0.0535s/iter; left time: 1000.7220s
	iters: 200, epoch: 17 | loss: 0.0980666
	speed: 0.0269s/iter; left time: 501.0544s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0976454 Vali Loss: 0.1168894 Test Loss: 0.1274555
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0964897
	speed: 0.0535s/iter; left time: 989.2355s
	iters: 200, epoch: 18 | loss: 0.0915851
	speed: 0.0269s/iter; left time: 494.0373s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0973645 Vali Loss: 0.1169818 Test Loss: 0.1278145
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0937841
	speed: 0.0539s/iter; left time: 984.7285s
	iters: 200, epoch: 19 | loss: 0.0945172
	speed: 0.0268s/iter; left time: 486.4706s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0971042 Vali Loss: 0.1170631 Test Loss: 0.1279219
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0976394
	speed: 0.0532s/iter; left time: 959.2814s
	iters: 200, epoch: 20 | loss: 0.1025702
	speed: 0.0268s/iter; left time: 480.4077s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0969481 Vali Loss: 0.1168795 Test Loss: 0.1282358
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0984403
	speed: 0.0539s/iter; left time: 960.3656s
	iters: 200, epoch: 21 | loss: 0.0932305
	speed: 0.0269s/iter; left time: 477.2151s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0967456 Vali Loss: 0.1170377 Test Loss: 0.1280329
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0958503
	speed: 0.0537s/iter; left time: 945.1394s
	iters: 200, epoch: 22 | loss: 0.0987119
	speed: 0.0269s/iter; left time: 471.5420s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0965442 Vali Loss: 0.1168456 Test Loss: 0.1277162
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0967639
	speed: 0.0528s/iter; left time: 917.3884s
	iters: 200, epoch: 23 | loss: 0.1017741
	speed: 0.0268s/iter; left time: 463.1707s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0964595 Vali Loss: 0.1169775 Test Loss: 0.1280533
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1019816
	speed: 0.0538s/iter; left time: 922.2519s
	iters: 200, epoch: 24 | loss: 0.0947855
	speed: 0.0269s/iter; left time: 458.3107s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0962695 Vali Loss: 0.1168131 Test Loss: 0.1279567
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0958062
	speed: 0.0530s/iter; left time: 897.5916s
	iters: 200, epoch: 25 | loss: 0.0925729
	speed: 0.0269s/iter; left time: 452.2235s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0961852 Vali Loss: 0.1169263 Test Loss: 0.1279396
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03738878667354584, rmse:0.1933618038892746, mae:0.12796346843242645, rse:0.6847332715988159
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1453122
	speed: 0.0287s/iter; left time: 639.1908s
	iters: 200, epoch: 1 | loss: 0.1341071
	speed: 0.0268s/iter; left time: 594.2778s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.1493950 Vali Loss: 0.1402512 Test Loss: 0.1483553
Validation loss decreased (inf --> 0.140251).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1097633
	speed: 0.0543s/iter; left time: 1198.2260s
	iters: 200, epoch: 2 | loss: 0.1095724
	speed: 0.0269s/iter; left time: 591.8869s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1142674 Vali Loss: 0.1222842 Test Loss: 0.1300744
Validation loss decreased (0.140251 --> 0.122284).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1055942
	speed: 0.0555s/iter; left time: 1212.4990s
	iters: 200, epoch: 3 | loss: 0.1084602
	speed: 0.0270s/iter; left time: 587.2759s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.36s
Steps: 224 | Train Loss: 0.1065267 Vali Loss: 0.1205910 Test Loss: 0.1294958
Validation loss decreased (0.122284 --> 0.120591).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1018099
	speed: 0.0542s/iter; left time: 1171.7338s
	iters: 200, epoch: 4 | loss: 0.1051938
	speed: 0.0269s/iter; left time: 579.9607s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.1047808 Vali Loss: 0.1190739 Test Loss: 0.1283687
Validation loss decreased (0.120591 --> 0.119074).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1018800
	speed: 0.0539s/iter; left time: 1153.8204s
	iters: 200, epoch: 5 | loss: 0.0956694
	speed: 0.0267s/iter; left time: 569.7476s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1035395 Vali Loss: 0.1188459 Test Loss: 0.1280372
Validation loss decreased (0.119074 --> 0.118846).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0991640
	speed: 0.0546s/iter; left time: 1156.3359s
	iters: 200, epoch: 6 | loss: 0.1049700
	speed: 0.0269s/iter; left time: 568.1287s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1025582 Vali Loss: 0.1181803 Test Loss: 0.1279618
Validation loss decreased (0.118846 --> 0.118180).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1013687
	speed: 0.0545s/iter; left time: 1142.8758s
	iters: 200, epoch: 7 | loss: 0.0993038
	speed: 0.0268s/iter; left time: 557.9995s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1018238 Vali Loss: 0.1180655 Test Loss: 0.1277595
Validation loss decreased (0.118180 --> 0.118066).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0997346
	speed: 0.0555s/iter; left time: 1150.8520s
	iters: 200, epoch: 8 | loss: 0.0997878
	speed: 0.0270s/iter; left time: 557.3852s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.1010508 Vali Loss: 0.1179035 Test Loss: 0.1281448
Validation loss decreased (0.118066 --> 0.117903).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0988701
	speed: 0.0563s/iter; left time: 1154.6799s
	iters: 200, epoch: 9 | loss: 0.0968515
	speed: 0.0271s/iter; left time: 552.7574s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.1004422 Vali Loss: 0.1178284 Test Loss: 0.1291293
Validation loss decreased (0.117903 --> 0.117828).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1008913
	speed: 0.0546s/iter; left time: 1108.5587s
	iters: 200, epoch: 10 | loss: 0.0954883
	speed: 0.0267s/iter; left time: 539.5886s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0998062 Vali Loss: 0.1179435 Test Loss: 0.1273128
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1016945
	speed: 0.0525s/iter; left time: 1052.5954s
	iters: 200, epoch: 11 | loss: 0.0974247
	speed: 0.0269s/iter; left time: 536.6181s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0992023 Vali Loss: 0.1177902 Test Loss: 0.1276344
Validation loss decreased (0.117828 --> 0.117790).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0978504
	speed: 0.0552s/iter; left time: 1094.3827s
	iters: 200, epoch: 12 | loss: 0.1006840
	speed: 0.0270s/iter; left time: 533.7357s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.38s
Steps: 224 | Train Loss: 0.0986686 Vali Loss: 0.1178868 Test Loss: 0.1283520
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1029566
	speed: 0.0534s/iter; left time: 1048.1343s
	iters: 200, epoch: 13 | loss: 0.0995638
	speed: 0.0267s/iter; left time: 521.1144s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0982064 Vali Loss: 0.1177266 Test Loss: 0.1271849
Validation loss decreased (0.117790 --> 0.117727).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0966322
	speed: 0.0541s/iter; left time: 1048.6480s
	iters: 200, epoch: 14 | loss: 0.0939447
	speed: 0.0271s/iter; left time: 521.7804s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0977019 Vali Loss: 0.1176199 Test Loss: 0.1285766
Validation loss decreased (0.117727 --> 0.117620).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0955380
	speed: 0.0567s/iter; left time: 1086.8307s
	iters: 200, epoch: 15 | loss: 0.0928111
	speed: 0.0271s/iter; left time: 516.2004s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0973574 Vali Loss: 0.1177496 Test Loss: 0.1279720
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1019763
	speed: 0.0549s/iter; left time: 1039.6933s
	iters: 200, epoch: 16 | loss: 0.1012777
	speed: 0.0270s/iter; left time: 509.2594s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.0969753 Vali Loss: 0.1177540 Test Loss: 0.1296667
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0968168
	speed: 0.0551s/iter; left time: 1030.4448s
	iters: 200, epoch: 17 | loss: 0.0930788
	speed: 0.0270s/iter; left time: 502.4510s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0968140 Vali Loss: 0.1179194 Test Loss: 0.1291604
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0877084
	speed: 0.0546s/iter; left time: 1009.5318s
	iters: 200, epoch: 18 | loss: 0.0964585
	speed: 0.0271s/iter; left time: 497.7989s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.0964126 Vali Loss: 0.1179514 Test Loss: 0.1292164
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0978073
	speed: 0.0549s/iter; left time: 1002.6800s
	iters: 200, epoch: 19 | loss: 0.0927446
	speed: 0.0270s/iter; left time: 491.0907s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0961563 Vali Loss: 0.1180256 Test Loss: 0.1296065
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0997547
	speed: 0.0541s/iter; left time: 976.4935s
	iters: 200, epoch: 20 | loss: 0.0986387
	speed: 0.0274s/iter; left time: 491.8739s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.45s
Steps: 224 | Train Loss: 0.0959443 Vali Loss: 0.1176773 Test Loss: 0.1286344
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0958655
	speed: 0.0560s/iter; left time: 998.6060s
	iters: 200, epoch: 21 | loss: 0.0964852
	speed: 0.0270s/iter; left time: 478.1552s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0957407 Vali Loss: 0.1176798 Test Loss: 0.1287229
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0942021
	speed: 0.0553s/iter; left time: 972.3128s
	iters: 200, epoch: 22 | loss: 0.0922590
	speed: 0.0270s/iter; left time: 472.9177s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.0955422 Vali Loss: 0.1179530 Test Loss: 0.1288881
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0922816
	speed: 0.0546s/iter; left time: 948.8017s
	iters: 200, epoch: 23 | loss: 0.0962126
	speed: 0.0273s/iter; left time: 471.6925s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.38s
Steps: 224 | Train Loss: 0.0954098 Vali Loss: 0.1179873 Test Loss: 0.1291286
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0962873
	speed: 0.0545s/iter; left time: 933.8682s
	iters: 200, epoch: 24 | loss: 0.0961054
	speed: 0.0271s/iter; left time: 462.0647s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.38s
Steps: 224 | Train Loss: 0.0953075 Vali Loss: 0.1179708 Test Loss: 0.1295294
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.037975143641233444, rmse:0.19487212598323822, mae:0.1285766065120697, rse:0.6900815963745117
Intermediate time for DE and pred_len 96: 00h:06m:50.94s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1511204
	speed: 0.0547s/iter; left time: 1213.9765s
	iters: 200, epoch: 1 | loss: 0.1396091
	speed: 0.0271s/iter; left time: 598.0707s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.59s
Steps: 223 | Train Loss: 0.1507847 Vali Loss: 0.1426704 Test Loss: 0.1519556
Validation loss decreased (inf --> 0.142670).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1238355
	speed: 0.0542s/iter; left time: 1191.4815s
	iters: 200, epoch: 2 | loss: 0.1123134
	speed: 0.0274s/iter; left time: 599.3626s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1200940 Vali Loss: 0.1261885 Test Loss: 0.1355995
Validation loss decreased (0.142670 --> 0.126188).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1164904
	speed: 0.0582s/iter; left time: 1265.1403s
	iters: 200, epoch: 3 | loss: 0.1123756
	speed: 0.0274s/iter; left time: 593.0027s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.1126304 Vali Loss: 0.1248742 Test Loss: 0.1346599
Validation loss decreased (0.126188 --> 0.124874).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1090264
	speed: 0.0564s/iter; left time: 1214.2777s
	iters: 200, epoch: 4 | loss: 0.1161850
	speed: 0.0277s/iter; left time: 593.5026s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.45s
Steps: 223 | Train Loss: 0.1108241 Vali Loss: 0.1231168 Test Loss: 0.1345049
Validation loss decreased (0.124874 --> 0.123117).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1067239
	speed: 0.0557s/iter; left time: 1187.0533s
	iters: 200, epoch: 5 | loss: 0.1134487
	speed: 0.0273s/iter; left time: 578.5087s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1096404 Vali Loss: 0.1232052 Test Loss: 0.1344802
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1046681
	speed: 0.0548s/iter; left time: 1154.7548s
	iters: 200, epoch: 6 | loss: 0.1130422
	speed: 0.0273s/iter; left time: 573.3944s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1086139 Vali Loss: 0.1229566 Test Loss: 0.1347695
Validation loss decreased (0.123117 --> 0.122957).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1078895
	speed: 0.0562s/iter; left time: 1172.1359s
	iters: 200, epoch: 7 | loss: 0.1087261
	speed: 0.0273s/iter; left time: 566.9128s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1077184 Vali Loss: 0.1223245 Test Loss: 0.1334847
Validation loss decreased (0.122957 --> 0.122324).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1035181
	speed: 0.0547s/iter; left time: 1129.6720s
	iters: 200, epoch: 8 | loss: 0.1118061
	speed: 0.0274s/iter; left time: 562.4612s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1069834 Vali Loss: 0.1218858 Test Loss: 0.1330454
Validation loss decreased (0.122324 --> 0.121886).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1058632
	speed: 0.0555s/iter; left time: 1132.6126s
	iters: 200, epoch: 9 | loss: 0.0987647
	speed: 0.0272s/iter; left time: 553.0275s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1062651 Vali Loss: 0.1219982 Test Loss: 0.1338042
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1030127
	speed: 0.0538s/iter; left time: 1086.2314s
	iters: 200, epoch: 10 | loss: 0.1031541
	speed: 0.0273s/iter; left time: 548.5068s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1056596 Vali Loss: 0.1220121 Test Loss: 0.1338617
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1061721
	speed: 0.0545s/iter; left time: 1089.1685s
	iters: 200, epoch: 11 | loss: 0.1000139
	speed: 0.0286s/iter; left time: 568.3590s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.49s
Steps: 223 | Train Loss: 0.1051509 Vali Loss: 0.1223389 Test Loss: 0.1343730
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1016918
	speed: 0.0557s/iter; left time: 1099.9068s
	iters: 200, epoch: 12 | loss: 0.1091376
	speed: 0.0273s/iter; left time: 536.3957s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.48s
Steps: 223 | Train Loss: 0.1046909 Vali Loss: 0.1220724 Test Loss: 0.1342280
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1095180
	speed: 0.0545s/iter; left time: 1064.6654s
	iters: 200, epoch: 13 | loss: 0.1059984
	speed: 0.0273s/iter; left time: 529.9918s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1042259 Vali Loss: 0.1223401 Test Loss: 0.1342049
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0977468
	speed: 0.0541s/iter; left time: 1045.0044s
	iters: 200, epoch: 14 | loss: 0.1107927
	speed: 0.0270s/iter; left time: 518.3209s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1039162 Vali Loss: 0.1222137 Test Loss: 0.1342742
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1054508
	speed: 0.0546s/iter; left time: 1042.4705s
	iters: 200, epoch: 15 | loss: 0.1117989
	speed: 0.0273s/iter; left time: 517.3343s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1035189 Vali Loss: 0.1224293 Test Loss: 0.1347673
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1062974
	speed: 0.0547s/iter; left time: 1030.8627s
	iters: 200, epoch: 16 | loss: 0.1125161
	speed: 0.0272s/iter; left time: 511.0602s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1031467 Vali Loss: 0.1224126 Test Loss: 0.1339886
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1029710
	speed: 0.0545s/iter; left time: 1015.8779s
	iters: 200, epoch: 17 | loss: 0.1050183
	speed: 0.0273s/iter; left time: 505.0420s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1029577 Vali Loss: 0.1227930 Test Loss: 0.1340047
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1025430
	speed: 0.0542s/iter; left time: 998.1419s
	iters: 200, epoch: 18 | loss: 0.1046702
	speed: 0.0272s/iter; left time: 497.8253s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1026303 Vali Loss: 0.1226197 Test Loss: 0.1343808
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03874775022268295, rmse:0.19684448838233948, mae:0.13304544985294342, rse:0.6972389817237854
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1546361
	speed: 0.0298s/iter; left time: 662.3935s
	iters: 200, epoch: 1 | loss: 0.1357865
	speed: 0.0272s/iter; left time: 600.4411s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1520326 Vali Loss: 0.1427907 Test Loss: 0.1520844
Validation loss decreased (inf --> 0.142791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1183958
	speed: 0.0566s/iter; left time: 1243.1818s
	iters: 200, epoch: 2 | loss: 0.1188114
	speed: 0.0273s/iter; left time: 597.6013s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.1199734 Vali Loss: 0.1263667 Test Loss: 0.1363375
Validation loss decreased (0.142791 --> 0.126367).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1155362
	speed: 0.0556s/iter; left time: 1208.6087s
	iters: 200, epoch: 3 | loss: 0.1098592
	speed: 0.0272s/iter; left time: 588.7107s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1126673 Vali Loss: 0.1251423 Test Loss: 0.1348121
Validation loss decreased (0.126367 --> 0.125142).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1086826
	speed: 0.0557s/iter; left time: 1199.5182s
	iters: 200, epoch: 4 | loss: 0.1126055
	speed: 0.0274s/iter; left time: 587.2671s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.1106587 Vali Loss: 0.1242879 Test Loss: 0.1354954
Validation loss decreased (0.125142 --> 0.124288).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1116844
	speed: 0.0560s/iter; left time: 1194.1369s
	iters: 200, epoch: 5 | loss: 0.1103760
	speed: 0.0274s/iter; left time: 580.3442s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.1092648 Vali Loss: 0.1238110 Test Loss: 0.1339414
Validation loss decreased (0.124288 --> 0.123811).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1062780
	speed: 0.0556s/iter; left time: 1172.0651s
	iters: 200, epoch: 6 | loss: 0.1105472
	speed: 0.0275s/iter; left time: 576.8189s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.1083813 Vali Loss: 0.1230377 Test Loss: 0.1344151
Validation loss decreased (0.123811 --> 0.123038).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1100236
	speed: 0.0563s/iter; left time: 1173.7410s
	iters: 200, epoch: 7 | loss: 0.1094361
	speed: 0.0271s/iter; left time: 563.2219s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1075638 Vali Loss: 0.1233376 Test Loss: 0.1351425
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1083931
	speed: 0.0550s/iter; left time: 1135.7034s
	iters: 200, epoch: 8 | loss: 0.1076261
	speed: 0.0272s/iter; left time: 559.3620s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.1067569 Vali Loss: 0.1231392 Test Loss: 0.1350849
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1042043
	speed: 0.0562s/iter; left time: 1148.2966s
	iters: 200, epoch: 9 | loss: 0.1087456
	speed: 0.0286s/iter; left time: 580.1777s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.64s
Steps: 223 | Train Loss: 0.1061874 Vali Loss: 0.1229115 Test Loss: 0.1347596
Validation loss decreased (0.123038 --> 0.122912).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1047019
	speed: 0.0569s/iter; left time: 1149.2216s
	iters: 200, epoch: 10 | loss: 0.1098653
	speed: 0.0274s/iter; left time: 551.2643s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.49s
Steps: 223 | Train Loss: 0.1054878 Vali Loss: 0.1231185 Test Loss: 0.1345507
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1028828
	speed: 0.0549s/iter; left time: 1096.4879s
	iters: 200, epoch: 11 | loss: 0.1091575
	speed: 0.0277s/iter; left time: 549.9330s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.46s
Steps: 223 | Train Loss: 0.1048839 Vali Loss: 0.1236878 Test Loss: 0.1354434
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1043799
	speed: 0.0562s/iter; left time: 1109.6457s
	iters: 200, epoch: 12 | loss: 0.1061269
	speed: 0.0280s/iter; left time: 549.9235s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.54s
Steps: 223 | Train Loss: 0.1043107 Vali Loss: 0.1239945 Test Loss: 0.1346901
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1080359
	speed: 0.0548s/iter; left time: 1070.4594s
	iters: 200, epoch: 13 | loss: 0.1058448
	speed: 0.0271s/iter; left time: 527.0663s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1037742 Vali Loss: 0.1241476 Test Loss: 0.1351113
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1032596
	speed: 0.0556s/iter; left time: 1073.1232s
	iters: 200, epoch: 14 | loss: 0.1017853
	speed: 0.0273s/iter; left time: 523.9345s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1033254 Vali Loss: 0.1241768 Test Loss: 0.1357941
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1011182
	speed: 0.0548s/iter; left time: 1044.6235s
	iters: 200, epoch: 15 | loss: 0.1017340
	speed: 0.0272s/iter; left time: 516.5955s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.1029318 Vali Loss: 0.1242862 Test Loss: 0.1359198
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1043327
	speed: 0.0555s/iter; left time: 1046.7619s
	iters: 200, epoch: 16 | loss: 0.1076296
	speed: 0.0273s/iter; left time: 511.9069s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.1024750 Vali Loss: 0.1245145 Test Loss: 0.1355859
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1003824
	speed: 0.0549s/iter; left time: 1023.8289s
	iters: 200, epoch: 17 | loss: 0.1016187
	speed: 0.0274s/iter; left time: 507.3118s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1022286 Vali Loss: 0.1240813 Test Loss: 0.1352433
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1041608
	speed: 0.0561s/iter; left time: 1032.5608s
	iters: 200, epoch: 18 | loss: 0.1061510
	speed: 0.0277s/iter; left time: 506.7508s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.1019955 Vali Loss: 0.1249169 Test Loss: 0.1354775
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1080255
	speed: 0.0557s/iter; left time: 1013.8191s
	iters: 200, epoch: 19 | loss: 0.0987023
	speed: 0.0274s/iter; left time: 496.4279s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.1016865 Vali Loss: 0.1249771 Test Loss: 0.1352909
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03975802659988403, rmse:0.19939415156841278, mae:0.13475961983203888, rse:0.7062700986862183
Intermediate time for DE and pred_len 168: 00h:05m:20.07sIntermediate time for DE: 00h:27m:01.80s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1243801
	speed: 0.0543s/iter; left time: 1211.2700s
	iters: 200, epoch: 1 | loss: 0.1137652
	speed: 0.0266s/iter; left time: 590.8778s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.47s
Steps: 224 | Train Loss: 0.1302879 Vali Loss: 0.1216964 Test Loss: 0.1408504
Validation loss decreased (inf --> 0.121696).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0839070
	speed: 0.0520s/iter; left time: 1147.3483s
	iters: 200, epoch: 2 | loss: 0.0818553
	speed: 0.0265s/iter; left time: 583.1974s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0865396 Vali Loss: 0.0920018 Test Loss: 0.1033591
Validation loss decreased (0.121696 --> 0.092002).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0733085
	speed: 0.0515s/iter; left time: 1125.3848s
	iters: 200, epoch: 3 | loss: 0.0821068
	speed: 0.0267s/iter; left time: 581.5578s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0793856 Vali Loss: 0.0900384 Test Loss: 0.1024917
Validation loss decreased (0.092002 --> 0.090038).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0750556
	speed: 0.0518s/iter; left time: 1121.1212s
	iters: 200, epoch: 4 | loss: 0.0780856
	speed: 0.0264s/iter; left time: 568.7586s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0779691 Vali Loss: 0.0899016 Test Loss: 0.1022058
Validation loss decreased (0.090038 --> 0.089902).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0758535
	speed: 0.0517s/iter; left time: 1107.5445s
	iters: 200, epoch: 5 | loss: 0.0757776
	speed: 0.0267s/iter; left time: 568.9676s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0769919 Vali Loss: 0.0893033 Test Loss: 0.1019564
Validation loss decreased (0.089902 --> 0.089303).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0798705
	speed: 0.0522s/iter; left time: 1104.7398s
	iters: 200, epoch: 6 | loss: 0.0816744
	speed: 0.0267s/iter; left time: 563.1827s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0762630 Vali Loss: 0.0887678 Test Loss: 0.1014424
Validation loss decreased (0.089303 --> 0.088768).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0754332
	speed: 0.0518s/iter; left time: 1085.2478s
	iters: 200, epoch: 7 | loss: 0.0806607
	speed: 0.0267s/iter; left time: 557.7843s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0756519 Vali Loss: 0.0887744 Test Loss: 0.1014127
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0728288
	speed: 0.0511s/iter; left time: 1059.7034s
	iters: 200, epoch: 8 | loss: 0.0775176
	speed: 0.0266s/iter; left time: 547.8825s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0752004 Vali Loss: 0.0885392 Test Loss: 0.1006487
Validation loss decreased (0.088768 --> 0.088539).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738876
	speed: 0.0528s/iter; left time: 1082.2772s
	iters: 200, epoch: 9 | loss: 0.0792237
	speed: 0.0268s/iter; left time: 546.9247s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0748653 Vali Loss: 0.0884795 Test Loss: 0.1006068
Validation loss decreased (0.088539 --> 0.088479).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0808073
	speed: 0.0520s/iter; left time: 1054.3701s
	iters: 200, epoch: 10 | loss: 0.0720843
	speed: 0.0267s/iter; left time: 538.8149s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0745151 Vali Loss: 0.0878042 Test Loss: 0.1009895
Validation loss decreased (0.088479 --> 0.087804).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0773240
	speed: 0.0519s/iter; left time: 1041.0894s
	iters: 200, epoch: 11 | loss: 0.0738162
	speed: 0.0267s/iter; left time: 531.9959s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0742512 Vali Loss: 0.0880865 Test Loss: 0.1001864
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0778451
	speed: 0.0510s/iter; left time: 1012.4607s
	iters: 200, epoch: 12 | loss: 0.0704564
	speed: 0.0267s/iter; left time: 527.7664s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0739914 Vali Loss: 0.0879424 Test Loss: 0.1007774
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0728143
	speed: 0.0519s/iter; left time: 1018.4859s
	iters: 200, epoch: 13 | loss: 0.0723630
	speed: 0.0266s/iter; left time: 520.0003s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0738506 Vali Loss: 0.0879685 Test Loss: 0.1000657
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0773398
	speed: 0.0518s/iter; left time: 1004.9878s
	iters: 200, epoch: 14 | loss: 0.0699778
	speed: 0.0267s/iter; left time: 514.5266s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0736961 Vali Loss: 0.0878420 Test Loss: 0.0999213
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0665786
	speed: 0.0518s/iter; left time: 992.4915s
	iters: 200, epoch: 15 | loss: 0.0686087
	speed: 0.0266s/iter; left time: 507.6368s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0734943 Vali Loss: 0.0880088 Test Loss: 0.1000402
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0704044
	speed: 0.0525s/iter; left time: 993.4795s
	iters: 200, epoch: 16 | loss: 0.0735029
	speed: 0.0268s/iter; left time: 505.2922s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0733230 Vali Loss: 0.0875390 Test Loss: 0.1002045
Validation loss decreased (0.087804 --> 0.087539).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0733052
	speed: 0.0529s/iter; left time: 989.9356s
	iters: 200, epoch: 17 | loss: 0.0776525
	speed: 0.0267s/iter; left time: 496.7882s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0732607 Vali Loss: 0.0874719 Test Loss: 0.0997542
Validation loss decreased (0.087539 --> 0.087472).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0733563
	speed: 0.0528s/iter; left time: 976.5661s
	iters: 200, epoch: 18 | loss: 0.0740419
	speed: 0.0269s/iter; left time: 493.9018s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0731655 Vali Loss: 0.0875383 Test Loss: 0.0997216
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0704366
	speed: 0.0523s/iter; left time: 956.2087s
	iters: 200, epoch: 19 | loss: 0.0727878
	speed: 0.0269s/iter; left time: 488.2725s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0730607 Vali Loss: 0.0878342 Test Loss: 0.0998149
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0639565
	speed: 0.0523s/iter; left time: 943.3723s
	iters: 200, epoch: 20 | loss: 0.0710644
	speed: 0.0268s/iter; left time: 481.5404s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0729284 Vali Loss: 0.0876287 Test Loss: 0.0996863
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0751909
	speed: 0.0521s/iter; left time: 928.5994s
	iters: 200, epoch: 21 | loss: 0.0704616
	speed: 0.0265s/iter; left time: 469.7206s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0727867 Vali Loss: 0.0875195 Test Loss: 0.0996076
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0709846
	speed: 0.0528s/iter; left time: 928.9821s
	iters: 200, epoch: 22 | loss: 0.0672187
	speed: 0.0271s/iter; left time: 473.5919s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0727850 Vali Loss: 0.0873734 Test Loss: 0.0995667
Validation loss decreased (0.087472 --> 0.087373).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0724984
	speed: 0.0546s/iter; left time: 947.7766s
	iters: 200, epoch: 23 | loss: 0.0676599
	speed: 0.0269s/iter; left time: 464.2573s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0727007 Vali Loss: 0.0874452 Test Loss: 0.0995794
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0710710
	speed: 0.0533s/iter; left time: 914.8627s
	iters: 200, epoch: 24 | loss: 0.0718718
	speed: 0.0272s/iter; left time: 463.7653s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0726696 Vali Loss: 0.0874877 Test Loss: 0.0994474
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0733318
	speed: 0.0538s/iter; left time: 909.7842s
	iters: 200, epoch: 25 | loss: 0.0770599
	speed: 0.0271s/iter; left time: 456.1697s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.39s
Steps: 224 | Train Loss: 0.0726920 Vali Loss: 0.0873381 Test Loss: 0.0994857
Validation loss decreased (0.087373 --> 0.087338).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0732230
	speed: 0.0537s/iter; left time: 896.6000s
	iters: 200, epoch: 26 | loss: 0.0704290
	speed: 0.0268s/iter; left time: 445.1579s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0726002 Vali Loss: 0.0874241 Test Loss: 0.0995524
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0722607
	speed: 0.0535s/iter; left time: 881.7593s
	iters: 200, epoch: 27 | loss: 0.0757692
	speed: 0.0273s/iter; left time: 446.7889s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0725308 Vali Loss: 0.0873835 Test Loss: 0.0995856
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0780362
	speed: 0.0530s/iter; left time: 860.7019s
	iters: 200, epoch: 28 | loss: 0.0754186
	speed: 0.0269s/iter; left time: 433.8187s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0724948 Vali Loss: 0.0874800 Test Loss: 0.0996659
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0755497
	speed: 0.0534s/iter; left time: 856.6310s
	iters: 200, epoch: 29 | loss: 0.0672095
	speed: 0.0269s/iter; left time: 427.9496s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0724994 Vali Loss: 0.0873726 Test Loss: 0.0994512
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0743681
	speed: 0.0530s/iter; left time: 837.2495s
	iters: 200, epoch: 30 | loss: 0.0714248
	speed: 0.0268s/iter; left time: 421.2640s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0724325 Vali Loss: 0.0874007 Test Loss: 0.0996015
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0670253
	speed: 0.0540s/iter; left time: 840.9434s
	iters: 200, epoch: 31 | loss: 0.0738778
	speed: 0.0265s/iter; left time: 410.8588s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0723963 Vali Loss: 0.0873461 Test Loss: 0.0995764
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0729594
	speed: 0.0534s/iter; left time: 820.6041s
	iters: 200, epoch: 32 | loss: 0.0743888
	speed: 0.0268s/iter; left time: 409.0421s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0724081 Vali Loss: 0.0872245 Test Loss: 0.0994373
Validation loss decreased (0.087338 --> 0.087224).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0723266
	speed: 0.0541s/iter; left time: 818.1361s
	iters: 200, epoch: 33 | loss: 0.0713193
	speed: 0.0269s/iter; left time: 404.1250s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0723961 Vali Loss: 0.0874335 Test Loss: 0.0996177
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0732763
	speed: 0.0532s/iter; left time: 793.2879s
	iters: 200, epoch: 34 | loss: 0.0748497
	speed: 0.0268s/iter; left time: 396.9748s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0723704 Vali Loss: 0.0873889 Test Loss: 0.0995195
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0779761
	speed: 0.0529s/iter; left time: 776.7366s
	iters: 200, epoch: 35 | loss: 0.0753652
	speed: 0.0268s/iter; left time: 390.9129s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0723036 Vali Loss: 0.0872547 Test Loss: 0.0995013
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0686231
	speed: 0.0528s/iter; left time: 764.0125s
	iters: 200, epoch: 36 | loss: 0.0763031
	speed: 0.0268s/iter; left time: 384.9277s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0722592 Vali Loss: 0.0874217 Test Loss: 0.0995324
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0755020
	speed: 0.0527s/iter; left time: 750.5292s
	iters: 200, epoch: 37 | loss: 0.0714776
	speed: 0.0268s/iter; left time: 378.6925s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0723462 Vali Loss: 0.0874196 Test Loss: 0.0995449
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0748234
	speed: 0.0534s/iter; left time: 747.9698s
	iters: 200, epoch: 38 | loss: 0.0689176
	speed: 0.0268s/iter; left time: 373.2992s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0723155 Vali Loss: 0.0872684 Test Loss: 0.0995207
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0765601
	speed: 0.0540s/iter; left time: 744.7602s
	iters: 200, epoch: 39 | loss: 0.0677570
	speed: 0.0268s/iter; left time: 366.6405s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.36s
Steps: 224 | Train Loss: 0.0722663 Vali Loss: 0.0874316 Test Loss: 0.0995467
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0654785
	speed: 0.0528s/iter; left time: 716.1290s
	iters: 200, epoch: 40 | loss: 0.0748680
	speed: 0.0265s/iter; left time: 356.7651s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0723363 Vali Loss: 0.0873764 Test Loss: 0.0994863
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0700707
	speed: 0.0531s/iter; left time: 708.0991s
	iters: 200, epoch: 41 | loss: 0.0708900
	speed: 0.0270s/iter; left time: 356.9407s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.0722918 Vali Loss: 0.0873483 Test Loss: 0.0995223
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0721399
	speed: 0.0532s/iter; left time: 697.5313s
	iters: 200, epoch: 42 | loss: 0.0775154
	speed: 0.0272s/iter; left time: 353.7779s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.35s
Steps: 224 | Train Loss: 0.0722849 Vali Loss: 0.0872172 Test Loss: 0.0995116
Validation loss decreased (0.087224 --> 0.087217).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0751871
	speed: 0.0535s/iter; left time: 689.5227s
	iters: 200, epoch: 43 | loss: 0.0700004
	speed: 0.0269s/iter; left time: 343.9482s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0722874 Vali Loss: 0.0872460 Test Loss: 0.0994964
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0771745
	speed: 0.0536s/iter; left time: 678.9808s
	iters: 200, epoch: 44 | loss: 0.0732692
	speed: 0.0268s/iter; left time: 336.6190s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0722729 Vali Loss: 0.0872457 Test Loss: 0.0994803
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0702146
	speed: 0.0527s/iter; left time: 656.2688s
	iters: 200, epoch: 45 | loss: 0.0754088
	speed: 0.0268s/iter; left time: 330.2795s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0722204 Vali Loss: 0.0872447 Test Loss: 0.0994848
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0695563
	speed: 0.0525s/iter; left time: 641.3707s
	iters: 200, epoch: 46 | loss: 0.0708172
	speed: 0.0269s/iter; left time: 325.7894s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0722368 Vali Loss: 0.0872585 Test Loss: 0.0994719
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0748870
	speed: 0.0531s/iter; left time: 636.6953s
	iters: 200, epoch: 47 | loss: 0.0730831
	speed: 0.0269s/iter; left time: 319.4743s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0722215 Vali Loss: 0.0873487 Test Loss: 0.0995225
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0761661
	speed: 0.0530s/iter; left time: 624.1234s
	iters: 200, epoch: 48 | loss: 0.0745982
	speed: 0.0268s/iter; left time: 312.8444s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0721901 Vali Loss: 0.0873764 Test Loss: 0.0994837
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0708556
	speed: 0.0533s/iter; left time: 615.7655s
	iters: 200, epoch: 49 | loss: 0.0708657
	speed: 0.0268s/iter; left time: 307.3317s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0722119 Vali Loss: 0.0872935 Test Loss: 0.0994825
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0738270
	speed: 0.0525s/iter; left time: 594.2805s
	iters: 200, epoch: 50 | loss: 0.0708394
	speed: 0.0269s/iter; left time: 301.5389s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0721791 Vali Loss: 0.0872133 Test Loss: 0.0994824
Validation loss decreased (0.087217 --> 0.087213).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0729056
	speed: 0.0537s/iter; left time: 596.5067s
	iters: 200, epoch: 51 | loss: 0.0680218
	speed: 0.0268s/iter; left time: 294.5880s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0721853 Vali Loss: 0.0873186 Test Loss: 0.0994690
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0694491
	speed: 0.0528s/iter; left time: 574.4605s
	iters: 200, epoch: 52 | loss: 0.0776386
	speed: 0.0269s/iter; left time: 289.3990s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0722179 Vali Loss: 0.0873789 Test Loss: 0.0994850
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0731650
	speed: 0.0526s/iter; left time: 559.9777s
	iters: 200, epoch: 53 | loss: 0.0769954
	speed: 0.0268s/iter; left time: 283.0889s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0721883 Vali Loss: 0.0873961 Test Loss: 0.0994792
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0745562
	speed: 0.0537s/iter; left time: 559.6576s
	iters: 200, epoch: 54 | loss: 0.0707905
	speed: 0.0268s/iter; left time: 276.8467s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0722220 Vali Loss: 0.0872954 Test Loss: 0.0995034
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0701514
	speed: 0.0533s/iter; left time: 543.8353s
	iters: 200, epoch: 55 | loss: 0.0714959
	speed: 0.0271s/iter; left time: 274.1043s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.35s
Steps: 224 | Train Loss: 0.0721793 Vali Loss: 0.0873029 Test Loss: 0.0994843
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0704450
	speed: 0.0535s/iter; left time: 534.3546s
	iters: 200, epoch: 56 | loss: 0.0675059
	speed: 0.0269s/iter; left time: 266.2749s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.0721501 Vali Loss: 0.0873734 Test Loss: 0.0994912
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0738333
	speed: 0.0537s/iter; left time: 523.7482s
	iters: 200, epoch: 57 | loss: 0.0705020
	speed: 0.0269s/iter; left time: 259.8038s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0722345 Vali Loss: 0.0874336 Test Loss: 0.0994758
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0767229
	speed: 0.0527s/iter; left time: 502.0444s
	iters: 200, epoch: 58 | loss: 0.0729605
	speed: 0.0268s/iter; left time: 253.1113s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0722041 Vali Loss: 0.0873020 Test Loss: 0.0994863
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0756847
	speed: 0.0534s/iter; left time: 497.0981s
	iters: 200, epoch: 59 | loss: 0.0757611
	speed: 0.0268s/iter; left time: 247.1903s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0721992 Vali Loss: 0.0872928 Test Loss: 0.0994752
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0702965
	speed: 0.0524s/iter; left time: 476.4810s
	iters: 200, epoch: 60 | loss: 0.0741313
	speed: 0.0268s/iter; left time: 240.8298s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0722097 Vali Loss: 0.0873115 Test Loss: 0.0994877
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02502487227320671, rmse:0.15819251537322998, mae:0.09948243200778961, rse:0.54571932554245
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1281256
	speed: 0.0292s/iter; left time: 650.2233s
	iters: 200, epoch: 1 | loss: 0.1138560
	speed: 0.0268s/iter; left time: 594.1969s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1290584 Vali Loss: 0.1207433 Test Loss: 0.1395016
Validation loss decreased (inf --> 0.120743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0853941
	speed: 0.0536s/iter; left time: 1182.5697s
	iters: 200, epoch: 2 | loss: 0.0847853
	speed: 0.0269s/iter; left time: 590.1108s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0861361 Vali Loss: 0.0918532 Test Loss: 0.1040095
Validation loss decreased (0.120743 --> 0.091853).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0775025
	speed: 0.0535s/iter; left time: 1169.8274s
	iters: 200, epoch: 3 | loss: 0.0788021
	speed: 0.0268s/iter; left time: 583.5978s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0792676 Vali Loss: 0.0905056 Test Loss: 0.1025451
Validation loss decreased (0.091853 --> 0.090506).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0744780
	speed: 0.0530s/iter; left time: 1146.1907s
	iters: 200, epoch: 4 | loss: 0.0797157
	speed: 0.0268s/iter; left time: 576.1945s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0780674 Vali Loss: 0.0906739 Test Loss: 0.1020297
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0770665
	speed: 0.0537s/iter; left time: 1149.1107s
	iters: 200, epoch: 5 | loss: 0.0766374
	speed: 0.0268s/iter; left time: 571.0425s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0769707 Vali Loss: 0.0894935 Test Loss: 0.1018222
Validation loss decreased (0.090506 --> 0.089494).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0809719
	speed: 0.0542s/iter; left time: 1148.6083s
	iters: 200, epoch: 6 | loss: 0.0820128
	speed: 0.0268s/iter; left time: 565.4964s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.0762634 Vali Loss: 0.0891491 Test Loss: 0.1013036
Validation loss decreased (0.089494 --> 0.089149).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0794357
	speed: 0.0534s/iter; left time: 1119.2823s
	iters: 200, epoch: 7 | loss: 0.0746093
	speed: 0.0269s/iter; left time: 560.1571s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0757042 Vali Loss: 0.0887241 Test Loss: 0.1007391
Validation loss decreased (0.089149 --> 0.088724).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0761330
	speed: 0.0535s/iter; left time: 1109.9562s
	iters: 200, epoch: 8 | loss: 0.0747115
	speed: 0.0269s/iter; left time: 555.3860s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0752742 Vali Loss: 0.0889610 Test Loss: 0.1005073
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0797194
	speed: 0.0531s/iter; left time: 1089.4519s
	iters: 200, epoch: 9 | loss: 0.0733876
	speed: 0.0269s/iter; left time: 548.5192s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0748621 Vali Loss: 0.0881851 Test Loss: 0.1004349
Validation loss decreased (0.088724 --> 0.088185).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0750555
	speed: 0.0529s/iter; left time: 1073.6207s
	iters: 200, epoch: 10 | loss: 0.0730892
	speed: 0.0268s/iter; left time: 540.9033s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0745724 Vali Loss: 0.0886613 Test Loss: 0.0999387
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0729881
	speed: 0.0534s/iter; left time: 1071.6187s
	iters: 200, epoch: 11 | loss: 0.0750049
	speed: 0.0268s/iter; left time: 534.9647s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.31s
Steps: 224 | Train Loss: 0.0742235 Vali Loss: 0.0879054 Test Loss: 0.1000553
Validation loss decreased (0.088185 --> 0.087905).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0731180
	speed: 0.0537s/iter; left time: 1065.7722s
	iters: 200, epoch: 12 | loss: 0.0704911
	speed: 0.0268s/iter; left time: 529.6777s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0739811 Vali Loss: 0.0880940 Test Loss: 0.1000203
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0734993
	speed: 0.0533s/iter; left time: 1046.3170s
	iters: 200, epoch: 13 | loss: 0.0771078
	speed: 0.0268s/iter; left time: 522.8338s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0738054 Vali Loss: 0.0879598 Test Loss: 0.1001505
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0748501
	speed: 0.0532s/iter; left time: 1031.9631s
	iters: 200, epoch: 14 | loss: 0.0740310
	speed: 0.0269s/iter; left time: 518.3231s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0736476 Vali Loss: 0.0878529 Test Loss: 0.1002746
Validation loss decreased (0.087905 --> 0.087853).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0738298
	speed: 0.0543s/iter; left time: 1041.4646s
	iters: 200, epoch: 15 | loss: 0.0762812
	speed: 0.0269s/iter; left time: 513.3244s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0735278 Vali Loss: 0.0878173 Test Loss: 0.1001467
Validation loss decreased (0.087853 --> 0.087817).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0707365
	speed: 0.0534s/iter; left time: 1010.9710s
	iters: 200, epoch: 16 | loss: 0.0745331
	speed: 0.0269s/iter; left time: 505.9793s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0732803 Vali Loss: 0.0877546 Test Loss: 0.0999003
Validation loss decreased (0.087817 --> 0.087755).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0703407
	speed: 0.0537s/iter; left time: 1005.2025s
	iters: 200, epoch: 17 | loss: 0.0806976
	speed: 0.0270s/iter; left time: 501.9173s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.34s
Steps: 224 | Train Loss: 0.0732293 Vali Loss: 0.0877284 Test Loss: 0.1001207
Validation loss decreased (0.087755 --> 0.087728).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0721018
	speed: 0.0533s/iter; left time: 985.6505s
	iters: 200, epoch: 18 | loss: 0.0723104
	speed: 0.0268s/iter; left time: 493.3362s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0730768 Vali Loss: 0.0877988 Test Loss: 0.0999179
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0745736
	speed: 0.0523s/iter; left time: 954.9691s
	iters: 200, epoch: 19 | loss: 0.0709844
	speed: 0.0268s/iter; left time: 486.2546s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0729765 Vali Loss: 0.0877342 Test Loss: 0.0999373
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0700831
	speed: 0.0528s/iter; left time: 951.9676s
	iters: 200, epoch: 20 | loss: 0.0720744
	speed: 0.0268s/iter; left time: 480.2256s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0728975 Vali Loss: 0.0876718 Test Loss: 0.0999224
Validation loss decreased (0.087728 --> 0.087672).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0748239
	speed: 0.0530s/iter; left time: 943.8389s
	iters: 200, epoch: 21 | loss: 0.0763428
	speed: 0.0268s/iter; left time: 474.5804s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0728158 Vali Loss: 0.0874219 Test Loss: 0.0997877
Validation loss decreased (0.087672 --> 0.087422).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0726125
	speed: 0.0535s/iter; left time: 941.3583s
	iters: 200, epoch: 22 | loss: 0.0784063
	speed: 0.0267s/iter; left time: 467.6504s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0727590 Vali Loss: 0.0874105 Test Loss: 0.0995382
Validation loss decreased (0.087422 --> 0.087410).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0671866
	speed: 0.0535s/iter; left time: 929.4445s
	iters: 200, epoch: 23 | loss: 0.0725489
	speed: 0.0268s/iter; left time: 462.3579s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0726649 Vali Loss: 0.0874186 Test Loss: 0.0996998
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0776832
	speed: 0.0533s/iter; left time: 913.3976s
	iters: 200, epoch: 24 | loss: 0.0751887
	speed: 0.0268s/iter; left time: 456.9522s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0726117 Vali Loss: 0.0874993 Test Loss: 0.0999176
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0748994
	speed: 0.0529s/iter; left time: 894.5695s
	iters: 200, epoch: 25 | loss: 0.0756038
	speed: 0.0265s/iter; left time: 446.0495s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.16s
Steps: 224 | Train Loss: 0.0725972 Vali Loss: 0.0874437 Test Loss: 0.0998308
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0704204
	speed: 0.0528s/iter; left time: 881.4889s
	iters: 200, epoch: 26 | loss: 0.0690703
	speed: 0.0265s/iter; left time: 439.9701s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0725073 Vali Loss: 0.0873915 Test Loss: 0.0997966
Validation loss decreased (0.087410 --> 0.087391).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0722938
	speed: 0.0550s/iter; left time: 906.8522s
	iters: 200, epoch: 27 | loss: 0.0707320
	speed: 0.0269s/iter; left time: 440.5791s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.44s
Steps: 224 | Train Loss: 0.0724955 Vali Loss: 0.0874042 Test Loss: 0.0997572
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0708005
	speed: 0.0524s/iter; left time: 852.1813s
	iters: 200, epoch: 28 | loss: 0.0706717
	speed: 0.0265s/iter; left time: 427.8731s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0725039 Vali Loss: 0.0873560 Test Loss: 0.0996761
Validation loss decreased (0.087391 --> 0.087356).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0742883
	speed: 0.0536s/iter; left time: 859.0053s
	iters: 200, epoch: 29 | loss: 0.0742773
	speed: 0.0269s/iter; left time: 427.9196s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0724317 Vali Loss: 0.0874750 Test Loss: 0.0997233
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0733841
	speed: 0.0534s/iter; left time: 844.4930s
	iters: 200, epoch: 30 | loss: 0.0713019
	speed: 0.0268s/iter; left time: 421.0308s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0724177 Vali Loss: 0.0873239 Test Loss: 0.0995659
Validation loss decreased (0.087356 --> 0.087324).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0728526
	speed: 0.0535s/iter; left time: 834.2808s
	iters: 200, epoch: 31 | loss: 0.0712871
	speed: 0.0268s/iter; left time: 414.1573s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0723862 Vali Loss: 0.0873993 Test Loss: 0.0997216
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0745156
	speed: 0.0529s/iter; left time: 811.9430s
	iters: 200, epoch: 32 | loss: 0.0705794
	speed: 0.0267s/iter; left time: 407.1530s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.0723662 Vali Loss: 0.0874361 Test Loss: 0.0997775
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0698627
	speed: 0.0531s/iter; left time: 804.2879s
	iters: 200, epoch: 33 | loss: 0.0744560
	speed: 0.0267s/iter; left time: 401.0148s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0723162 Vali Loss: 0.0872565 Test Loss: 0.0996848
Validation loss decreased (0.087324 --> 0.087256).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0720458
	speed: 0.0529s/iter; left time: 789.0979s
	iters: 200, epoch: 34 | loss: 0.0796783
	speed: 0.0267s/iter; left time: 395.3279s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0722920 Vali Loss: 0.0873715 Test Loss: 0.0996110
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0731819
	speed: 0.0527s/iter; left time: 773.4842s
	iters: 200, epoch: 35 | loss: 0.0786404
	speed: 0.0267s/iter; left time: 389.3003s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0723127 Vali Loss: 0.0874032 Test Loss: 0.0996725
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0717856
	speed: 0.0527s/iter; left time: 761.5788s
	iters: 200, epoch: 36 | loss: 0.0735888
	speed: 0.0267s/iter; left time: 383.7417s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0723288 Vali Loss: 0.0872270 Test Loss: 0.0996796
Validation loss decreased (0.087256 --> 0.087227).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0752889
	speed: 0.0529s/iter; left time: 753.7263s
	iters: 200, epoch: 37 | loss: 0.0713401
	speed: 0.0268s/iter; left time: 378.6254s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0723031 Vali Loss: 0.0874127 Test Loss: 0.0996993
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0730377
	speed: 0.0528s/iter; left time: 740.2937s
	iters: 200, epoch: 38 | loss: 0.0670286
	speed: 0.0266s/iter; left time: 369.5143s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0722490 Vali Loss: 0.0873063 Test Loss: 0.0996096
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0739416
	speed: 0.0528s/iter; left time: 727.5970s
	iters: 200, epoch: 39 | loss: 0.0706054
	speed: 0.0266s/iter; left time: 364.6982s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0722615 Vali Loss: 0.0873521 Test Loss: 0.0996684
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0689131
	speed: 0.0538s/iter; left time: 729.3039s
	iters: 200, epoch: 40 | loss: 0.0731106
	speed: 0.0269s/iter; left time: 362.6498s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.36s
Steps: 224 | Train Loss: 0.0722557 Vali Loss: 0.0874369 Test Loss: 0.0997051
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0715132
	speed: 0.0532s/iter; left time: 710.0583s
	iters: 200, epoch: 41 | loss: 0.0690387
	speed: 0.0267s/iter; left time: 353.6279s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0722332 Vali Loss: 0.0872902 Test Loss: 0.0996747
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0766864
	speed: 0.0525s/iter; left time: 688.9114s
	iters: 200, epoch: 42 | loss: 0.0704855
	speed: 0.0265s/iter; left time: 345.2232s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.18s
Steps: 224 | Train Loss: 0.0722141 Vali Loss: 0.0873723 Test Loss: 0.0996596
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0717274
	speed: 0.0530s/iter; left time: 683.2456s
	iters: 200, epoch: 43 | loss: 0.0687616
	speed: 0.0274s/iter; left time: 350.3659s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.0721847 Vali Loss: 0.0872899 Test Loss: 0.0996401
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0682925
	speed: 0.0532s/iter; left time: 673.6730s
	iters: 200, epoch: 44 | loss: 0.0717148
	speed: 0.0267s/iter; left time: 336.1236s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0722191 Vali Loss: 0.0873592 Test Loss: 0.0996715
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0739661
	speed: 0.0526s/iter; left time: 654.3423s
	iters: 200, epoch: 45 | loss: 0.0704421
	speed: 0.0268s/iter; left time: 330.5871s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0721614 Vali Loss: 0.0873060 Test Loss: 0.0996651
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0744253
	speed: 0.0525s/iter; left time: 642.1980s
	iters: 200, epoch: 46 | loss: 0.0733730
	speed: 0.0268s/iter; left time: 324.9944s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0721902 Vali Loss: 0.0871615 Test Loss: 0.0996455
Validation loss decreased (0.087227 --> 0.087162).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0738844
	speed: 0.0523s/iter; left time: 627.0182s
	iters: 200, epoch: 47 | loss: 0.0732504
	speed: 0.0265s/iter; left time: 315.4640s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.15s
Steps: 224 | Train Loss: 0.0721966 Vali Loss: 0.0873352 Test Loss: 0.0996582
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0738569
	speed: 0.0522s/iter; left time: 615.0724s
	iters: 200, epoch: 48 | loss: 0.0660235
	speed: 0.0265s/iter; left time: 309.1684s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0721567 Vali Loss: 0.0874393 Test Loss: 0.0996577
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0700567
	speed: 0.0530s/iter; left time: 611.5923s
	iters: 200, epoch: 49 | loss: 0.0708773
	speed: 0.0268s/iter; left time: 306.5727s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0721437 Vali Loss: 0.0873161 Test Loss: 0.0996556
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0701776
	speed: 0.0522s/iter; left time: 590.7105s
	iters: 200, epoch: 50 | loss: 0.0751142
	speed: 0.0267s/iter; left time: 299.9530s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0721538 Vali Loss: 0.0873739 Test Loss: 0.0996439
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0683126
	speed: 0.0519s/iter; left time: 576.3710s
	iters: 200, epoch: 51 | loss: 0.0737489
	speed: 0.0270s/iter; left time: 297.0958s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.20s
Steps: 224 | Train Loss: 0.0721442 Vali Loss: 0.0874031 Test Loss: 0.0996389
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0686506
	speed: 0.0521s/iter; left time: 566.9737s
	iters: 200, epoch: 52 | loss: 0.0714018
	speed: 0.0266s/iter; left time: 286.3902s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.19s
Steps: 224 | Train Loss: 0.0721793 Vali Loss: 0.0872806 Test Loss: 0.0996446
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0680443
	speed: 0.0520s/iter; left time: 553.8117s
	iters: 200, epoch: 53 | loss: 0.0746092
	speed: 0.0268s/iter; left time: 282.8700s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.0721653 Vali Loss: 0.0872594 Test Loss: 0.0996658
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0697796
	speed: 0.0522s/iter; left time: 544.4062s
	iters: 200, epoch: 54 | loss: 0.0704911
	speed: 0.0264s/iter; left time: 273.0792s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0721745 Vali Loss: 0.0874115 Test Loss: 0.0996338
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0660143
	speed: 0.0517s/iter; left time: 527.2257s
	iters: 200, epoch: 55 | loss: 0.0712318
	speed: 0.0265s/iter; left time: 268.1720s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.17s
Steps: 224 | Train Loss: 0.0721330 Vali Loss: 0.0873371 Test Loss: 0.0996511
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0705199
	speed: 0.0519s/iter; left time: 518.3399s
	iters: 200, epoch: 56 | loss: 0.0784174
	speed: 0.0265s/iter; left time: 262.1413s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0721358 Vali Loss: 0.0872928 Test Loss: 0.0996450
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025020133703947067, rmse:0.15817753970623016, mae:0.09964548796415329, rse:0.5456676483154297
Intermediate time for GB and pred_len 24: 00h:15m:37.54s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1362466
	speed: 0.0553s/iter; left time: 1234.0899s
	iters: 200, epoch: 1 | loss: 0.1315828
	speed: 0.0268s/iter; left time: 594.1684s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.48s
Steps: 224 | Train Loss: 0.1354785 Vali Loss: 0.1317148 Test Loss: 0.1549259
Validation loss decreased (inf --> 0.131715).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1100148
	speed: 0.0537s/iter; left time: 1185.5225s
	iters: 200, epoch: 2 | loss: 0.1011972
	speed: 0.0269s/iter; left time: 590.6520s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.1090403 Vali Loss: 0.1182589 Test Loss: 0.1401924
Validation loss decreased (0.131715 --> 0.118259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1020023
	speed: 0.0538s/iter; left time: 1174.9266s
	iters: 200, epoch: 3 | loss: 0.1028889
	speed: 0.0270s/iter; left time: 586.9918s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.1039733 Vali Loss: 0.1175403 Test Loss: 0.1411576
Validation loss decreased (0.118259 --> 0.117540).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1018276
	speed: 0.0529s/iter; left time: 1143.3982s
	iters: 200, epoch: 4 | loss: 0.1026525
	speed: 0.0270s/iter; left time: 581.7061s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1026064 Vali Loss: 0.1166299 Test Loss: 0.1399759
Validation loss decreased (0.117540 --> 0.116630).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1026763
	speed: 0.0534s/iter; left time: 1144.0695s
	iters: 200, epoch: 5 | loss: 0.0943075
	speed: 0.0268s/iter; left time: 570.9902s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1015074 Vali Loss: 0.1164241 Test Loss: 0.1412032
Validation loss decreased (0.116630 --> 0.116424).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1025002
	speed: 0.0531s/iter; left time: 1123.7738s
	iters: 200, epoch: 6 | loss: 0.1032541
	speed: 0.0271s/iter; left time: 571.4594s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1006094 Vali Loss: 0.1160348 Test Loss: 0.1397788
Validation loss decreased (0.116424 --> 0.116035).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1038390
	speed: 0.0535s/iter; left time: 1121.2498s
	iters: 200, epoch: 7 | loss: 0.0969341
	speed: 0.0268s/iter; left time: 559.7882s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0997999 Vali Loss: 0.1159833 Test Loss: 0.1389591
Validation loss decreased (0.116035 --> 0.115983).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1006562
	speed: 0.0540s/iter; left time: 1120.2872s
	iters: 200, epoch: 8 | loss: 0.0981172
	speed: 0.0270s/iter; left time: 557.5209s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.35s
Steps: 224 | Train Loss: 0.0990484 Vali Loss: 0.1169135 Test Loss: 0.1407297
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0989951
	speed: 0.0535s/iter; left time: 1097.1081s
	iters: 200, epoch: 9 | loss: 0.0990440
	speed: 0.0271s/iter; left time: 553.4864s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.30s
Steps: 224 | Train Loss: 0.0983205 Vali Loss: 0.1171196 Test Loss: 0.1430553
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1003540
	speed: 0.0529s/iter; left time: 1073.5132s
	iters: 200, epoch: 10 | loss: 0.0943393
	speed: 0.0269s/iter; left time: 543.6021s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0977161 Vali Loss: 0.1167704 Test Loss: 0.1415311
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0969625
	speed: 0.0539s/iter; left time: 1081.2312s
	iters: 200, epoch: 11 | loss: 0.0986367
	speed: 0.0268s/iter; left time: 534.8406s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0971241 Vali Loss: 0.1168764 Test Loss: 0.1429615
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1012906
	speed: 0.0530s/iter; left time: 1051.5503s
	iters: 200, epoch: 12 | loss: 0.0969430
	speed: 0.0268s/iter; left time: 529.7850s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.23s
Steps: 224 | Train Loss: 0.0966664 Vali Loss: 0.1162381 Test Loss: 0.1405379
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0961613
	speed: 0.0536s/iter; left time: 1050.6042s
	iters: 200, epoch: 13 | loss: 0.0981514
	speed: 0.0270s/iter; left time: 525.9338s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.29s
Steps: 224 | Train Loss: 0.0962394 Vali Loss: 0.1173263 Test Loss: 0.1436641
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0961513
	speed: 0.0532s/iter; left time: 1031.3833s
	iters: 200, epoch: 14 | loss: 0.0940166
	speed: 0.0269s/iter; left time: 518.8035s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0958293 Vali Loss: 0.1172846 Test Loss: 0.1412998
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0907448
	speed: 0.0530s/iter; left time: 1015.5836s
	iters: 200, epoch: 15 | loss: 0.0936777
	speed: 0.0269s/iter; left time: 513.1994s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0954853 Vali Loss: 0.1174681 Test Loss: 0.1431191
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0971071
	speed: 0.0530s/iter; left time: 1004.5613s
	iters: 200, epoch: 16 | loss: 0.0991246
	speed: 0.0270s/iter; left time: 508.0854s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0951561 Vali Loss: 0.1177430 Test Loss: 0.1433660
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0933138
	speed: 0.0532s/iter; left time: 996.3669s
	iters: 200, epoch: 17 | loss: 0.0953560
	speed: 0.0270s/iter; left time: 502.4915s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0948642 Vali Loss: 0.1173937 Test Loss: 0.1422419
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04156280308961868, rmse:0.20386956632137299, mae:0.138959139585495, rse:0.705009400844574
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1342963
	speed: 0.0294s/iter; left time: 655.5017s
	iters: 200, epoch: 1 | loss: 0.1212572
	speed: 0.0270s/iter; left time: 598.4054s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.32s
Steps: 224 | Train Loss: 0.1354378 Vali Loss: 0.1306439 Test Loss: 0.1532763
Validation loss decreased (inf --> 0.130644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1063669
	speed: 0.0539s/iter; left time: 1190.0957s
	iters: 200, epoch: 2 | loss: 0.1015290
	speed: 0.0268s/iter; left time: 588.5278s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.24s
Steps: 224 | Train Loss: 0.1090908 Vali Loss: 0.1179647 Test Loss: 0.1400083
Validation loss decreased (0.130644 --> 0.117965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1034727
	speed: 0.0543s/iter; left time: 1186.3327s
	iters: 200, epoch: 3 | loss: 0.1050127
	speed: 0.0268s/iter; left time: 582.9759s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1041194 Vali Loss: 0.1176144 Test Loss: 0.1397710
Validation loss decreased (0.117965 --> 0.117614).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0971245
	speed: 0.0556s/iter; left time: 1202.5577s
	iters: 200, epoch: 4 | loss: 0.1046980
	speed: 0.0271s/iter; left time: 583.1737s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.37s
Steps: 224 | Train Loss: 0.1028142 Vali Loss: 0.1171384 Test Loss: 0.1404998
Validation loss decreased (0.117614 --> 0.117138).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0977949
	speed: 0.0553s/iter; left time: 1182.8713s
	iters: 200, epoch: 5 | loss: 0.1043665
	speed: 0.0268s/iter; left time: 571.7380s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1018217 Vali Loss: 0.1171914 Test Loss: 0.1403327
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0947371
	speed: 0.0534s/iter; left time: 1131.0207s
	iters: 200, epoch: 6 | loss: 0.1068232
	speed: 0.0268s/iter; left time: 564.4918s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.1010497 Vali Loss: 0.1167937 Test Loss: 0.1400926
Validation loss decreased (0.117138 --> 0.116794).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0955816
	speed: 0.0545s/iter; left time: 1143.1946s
	iters: 200, epoch: 7 | loss: 0.0973860
	speed: 0.0267s/iter; left time: 557.5776s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.22s
Steps: 224 | Train Loss: 0.1002006 Vali Loss: 0.1169059 Test Loss: 0.1398973
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0982215
	speed: 0.0550s/iter; left time: 1140.3708s
	iters: 200, epoch: 8 | loss: 0.0986912
	speed: 0.0269s/iter; left time: 555.7562s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.38s
Steps: 224 | Train Loss: 0.0995622 Vali Loss: 0.1171644 Test Loss: 0.1394792
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0983291
	speed: 0.0544s/iter; left time: 1115.5611s
	iters: 200, epoch: 9 | loss: 0.1015055
	speed: 0.0267s/iter; left time: 544.4182s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.21s
Steps: 224 | Train Loss: 0.0990405 Vali Loss: 0.1170354 Test Loss: 0.1404738
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0966749
	speed: 0.0548s/iter; left time: 1111.2377s
	iters: 200, epoch: 10 | loss: 0.0984571
	speed: 0.0271s/iter; left time: 547.2893s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0984118 Vali Loss: 0.1174196 Test Loss: 0.1405433
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0945642
	speed: 0.0554s/iter; left time: 1111.9260s
	iters: 200, epoch: 11 | loss: 0.0937180
	speed: 0.0268s/iter; left time: 534.4278s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0979818 Vali Loss: 0.1171703 Test Loss: 0.1407737
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0964229
	speed: 0.0543s/iter; left time: 1077.2916s
	iters: 200, epoch: 12 | loss: 0.1007808
	speed: 0.0270s/iter; left time: 533.2125s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.33s
Steps: 224 | Train Loss: 0.0975590 Vali Loss: 0.1174397 Test Loss: 0.1414426
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0947333
	speed: 0.0534s/iter; left time: 1048.2167s
	iters: 200, epoch: 13 | loss: 0.0915383
	speed: 0.0268s/iter; left time: 523.3890s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.25s
Steps: 224 | Train Loss: 0.0971209 Vali Loss: 0.1181216 Test Loss: 0.1418197
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0964207
	speed: 0.0543s/iter; left time: 1053.2275s
	iters: 200, epoch: 14 | loss: 0.0957182
	speed: 0.0268s/iter; left time: 516.4400s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.27s
Steps: 224 | Train Loss: 0.0966924 Vali Loss: 0.1173833 Test Loss: 0.1408844
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0976923
	speed: 0.0538s/iter; left time: 1031.1701s
	iters: 200, epoch: 15 | loss: 0.0943371
	speed: 0.0268s/iter; left time: 511.0717s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.28s
Steps: 224 | Train Loss: 0.0964538 Vali Loss: 0.1180992 Test Loss: 0.1427835
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0937670
	speed: 0.0538s/iter; left time: 1018.7485s
	iters: 200, epoch: 16 | loss: 0.0968458
	speed: 0.0268s/iter; left time: 505.2303s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.26s
Steps: 224 | Train Loss: 0.0961151 Vali Loss: 0.1176016 Test Loss: 0.1419638
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04211575910449028, rmse:0.2052212506532669, mae:0.1400926262140274, rse:0.7096836566925049
Intermediate time for GB and pred_len 96: 00h:04m:39.59s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1354124
	speed: 0.0554s/iter; left time: 1229.6732s
	iters: 200, epoch: 1 | loss: 0.1269919
	speed: 0.0271s/iter; left time: 599.2000s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.57s
Steps: 223 | Train Loss: 0.1370751 Vali Loss: 0.1339571 Test Loss: 0.1580050
Validation loss decreased (inf --> 0.133957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1144067
	speed: 0.0538s/iter; left time: 1181.8960s
	iters: 200, epoch: 2 | loss: 0.1070809
	speed: 0.0271s/iter; left time: 593.3056s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.26s
Steps: 223 | Train Loss: 0.1134790 Vali Loss: 0.1227112 Test Loss: 0.1471968
Validation loss decreased (0.133957 --> 0.122711).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1099978
	speed: 0.0546s/iter; left time: 1186.9160s
	iters: 200, epoch: 3 | loss: 0.1067006
	speed: 0.0272s/iter; left time: 588.4087s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.27s
Steps: 223 | Train Loss: 0.1086630 Vali Loss: 0.1216847 Test Loss: 0.1465340
Validation loss decreased (0.122711 --> 0.121685).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1087929
	speed: 0.0553s/iter; left time: 1189.7324s
	iters: 200, epoch: 4 | loss: 0.1128875
	speed: 0.0271s/iter; left time: 580.9516s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1071564 Vali Loss: 0.1216329 Test Loss: 0.1464036
Validation loss decreased (0.121685 --> 0.121633).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1036660
	speed: 0.0565s/iter; left time: 1204.0028s
	iters: 200, epoch: 5 | loss: 0.1098936
	speed: 0.0271s/iter; left time: 575.1704s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.1058232 Vali Loss: 0.1211363 Test Loss: 0.1468929
Validation loss decreased (0.121633 --> 0.121136).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1023184
	speed: 0.0551s/iter; left time: 1162.4825s
	iters: 200, epoch: 6 | loss: 0.1047149
	speed: 0.0272s/iter; left time: 570.5859s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.29s
Steps: 223 | Train Loss: 0.1045786 Vali Loss: 0.1214660 Test Loss: 0.1477442
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1030283
	speed: 0.0551s/iter; left time: 1148.7618s
	iters: 200, epoch: 7 | loss: 0.0983301
	speed: 0.0274s/iter; left time: 568.0045s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1035771 Vali Loss: 0.1215716 Test Loss: 0.1494350
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1021642
	speed: 0.0551s/iter; left time: 1137.1951s
	iters: 200, epoch: 8 | loss: 0.1072234
	speed: 0.0274s/iter; left time: 562.8402s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1026726 Vali Loss: 0.1215428 Test Loss: 0.1478654
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1027741
	speed: 0.0555s/iter; left time: 1132.5589s
	iters: 200, epoch: 9 | loss: 0.0979295
	speed: 0.0273s/iter; left time: 554.2150s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1020552 Vali Loss: 0.1213815 Test Loss: 0.1498316
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0996236
	speed: 0.0543s/iter; left time: 1096.0517s
	iters: 200, epoch: 10 | loss: 0.1013777
	speed: 0.0273s/iter; left time: 548.1214s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.32s
Steps: 223 | Train Loss: 0.1013867 Vali Loss: 0.1220490 Test Loss: 0.1514326
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0994694
	speed: 0.0553s/iter; left time: 1104.2498s
	iters: 200, epoch: 11 | loss: 0.0999421
	speed: 0.0274s/iter; left time: 543.6891s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.1007758 Vali Loss: 0.1213371 Test Loss: 0.1484833
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0966362
	speed: 0.0549s/iter; left time: 1083.1968s
	iters: 200, epoch: 12 | loss: 0.0990719
	speed: 0.0273s/iter; left time: 535.5950s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.1002209 Vali Loss: 0.1218838 Test Loss: 0.1496712
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0996767
	speed: 0.0548s/iter; left time: 1070.0136s
	iters: 200, epoch: 13 | loss: 0.1026959
	speed: 0.0272s/iter; left time: 528.3274s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.30s
Steps: 223 | Train Loss: 0.0997564 Vali Loss: 0.1217964 Test Loss: 0.1501298
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0985504
	speed: 0.0554s/iter; left time: 1068.8520s
	iters: 200, epoch: 14 | loss: 0.0999128
	speed: 0.0272s/iter; left time: 523.1002s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0993586 Vali Loss: 0.1223004 Test Loss: 0.1509998
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1021761
	speed: 0.0548s/iter; left time: 1045.3280s
	iters: 200, epoch: 15 | loss: 0.1022515
	speed: 0.0273s/iter; left time: 517.9778s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.34s
Steps: 223 | Train Loss: 0.0989366 Vali Loss: 0.1226592 Test Loss: 0.1515421
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04459306597709656, rmse:0.21117070317268372, mae:0.14689284563064575, rse:0.7321591973304749
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1343334
	speed: 0.0304s/iter; left time: 675.5745s
	iters: 200, epoch: 1 | loss: 0.1274043
	speed: 0.0273s/iter; left time: 604.2605s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.45s
Steps: 223 | Train Loss: 0.1373720 Vali Loss: 0.1342096 Test Loss: 0.1581728
Validation loss decreased (inf --> 0.134210).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1134263
	speed: 0.0564s/iter; left time: 1240.0853s
	iters: 200, epoch: 2 | loss: 0.1105637
	speed: 0.0276s/iter; left time: 603.9956s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.43s
Steps: 223 | Train Loss: 0.1132997 Vali Loss: 0.1233650 Test Loss: 0.1481477
Validation loss decreased (0.134210 --> 0.123365).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1110428
	speed: 0.0561s/iter; left time: 1219.9967s
	iters: 200, epoch: 3 | loss: 0.1082572
	speed: 0.0271s/iter; left time: 587.4130s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1087510 Vali Loss: 0.1223908 Test Loss: 0.1466880
Validation loss decreased (0.123365 --> 0.122391).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1091575
	speed: 0.0577s/iter; left time: 1241.7612s
	iters: 200, epoch: 4 | loss: 0.1072541
	speed: 0.0274s/iter; left time: 587.3713s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.49s
Steps: 223 | Train Loss: 0.1072281 Vali Loss: 0.1221424 Test Loss: 0.1471605
Validation loss decreased (0.122391 --> 0.122142).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1074684
	speed: 0.0569s/iter; left time: 1212.2677s
	iters: 200, epoch: 5 | loss: 0.1056222
	speed: 0.0274s/iter; left time: 581.0567s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.40s
Steps: 223 | Train Loss: 0.1056581 Vali Loss: 0.1219717 Test Loss: 0.1469719
Validation loss decreased (0.122142 --> 0.121972).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1063322
	speed: 0.0565s/iter; left time: 1192.2183s
	iters: 200, epoch: 6 | loss: 0.1021206
	speed: 0.0273s/iter; left time: 572.7672s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.1043592 Vali Loss: 0.1220159 Test Loss: 0.1479042
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1007787
	speed: 0.0559s/iter; left time: 1165.4247s
	iters: 200, epoch: 7 | loss: 0.1071176
	speed: 0.0273s/iter; left time: 565.9989s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.42s
Steps: 223 | Train Loss: 0.1034426 Vali Loss: 0.1219470 Test Loss: 0.1468008
Validation loss decreased (0.121972 --> 0.121947).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1024007
	speed: 0.0562s/iter; left time: 1159.3587s
	iters: 200, epoch: 8 | loss: 0.1011106
	speed: 0.0273s/iter; left time: 560.3937s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.1026371 Vali Loss: 0.1226881 Test Loss: 0.1485755
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1010926
	speed: 0.0561s/iter; left time: 1146.1769s
	iters: 200, epoch: 9 | loss: 0.1037420
	speed: 0.0273s/iter; left time: 555.1563s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.39s
Steps: 223 | Train Loss: 0.1018770 Vali Loss: 0.1230170 Test Loss: 0.1505015
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0995526
	speed: 0.0558s/iter; left time: 1126.7199s
	iters: 200, epoch: 10 | loss: 0.1030146
	speed: 0.0273s/iter; left time: 549.1751s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.35s
Steps: 223 | Train Loss: 0.1011918 Vali Loss: 0.1236346 Test Loss: 0.1512475
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1019870
	speed: 0.0558s/iter; left time: 1114.2898s
	iters: 200, epoch: 11 | loss: 0.1035597
	speed: 0.0274s/iter; left time: 543.9733s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.36s
Steps: 223 | Train Loss: 0.1005595 Vali Loss: 0.1228452 Test Loss: 0.1502132
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1003256
	speed: 0.0562s/iter; left time: 1110.7425s
	iters: 200, epoch: 12 | loss: 0.1002665
	speed: 0.0273s/iter; left time: 537.0601s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.46s
Steps: 223 | Train Loss: 0.1000163 Vali Loss: 0.1234094 Test Loss: 0.1494783
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1022886
	speed: 0.0564s/iter; left time: 1101.7633s
	iters: 200, epoch: 13 | loss: 0.1002941
	speed: 0.0274s/iter; left time: 531.9867s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0994505 Vali Loss: 0.1235107 Test Loss: 0.1497943
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0975255
	speed: 0.0559s/iter; left time: 1078.1402s
	iters: 200, epoch: 14 | loss: 0.0986446
	speed: 0.0274s/iter; left time: 526.0219s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0990837 Vali Loss: 0.1231035 Test Loss: 0.1512404
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0982782
	speed: 0.0557s/iter; left time: 1061.8515s
	iters: 200, epoch: 15 | loss: 0.1003537
	speed: 0.0273s/iter; left time: 518.8105s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.38s
Steps: 223 | Train Loss: 0.0986666 Vali Loss: 0.1234591 Test Loss: 0.1508010
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1010868
	speed: 0.0562s/iter; left time: 1058.7894s
	iters: 200, epoch: 16 | loss: 0.1004014
	speed: 0.0274s/iter; left time: 513.3969s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.41s
Steps: 223 | Train Loss: 0.0983119 Vali Loss: 0.1234264 Test Loss: 0.1515623
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0973225
	speed: 0.0560s/iter; left time: 1042.6396s
	iters: 200, epoch: 17 | loss: 0.0972442
	speed: 0.0271s/iter; left time: 502.8125s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.37s
Steps: 223 | Train Loss: 0.0979932 Vali Loss: 0.1239732 Test Loss: 0.1527091
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04486566409468651, rmse:0.21181516349315643, mae:0.14680077135562897, rse:0.7343935966491699
Intermediate time for GB and pred_len 168: 00h:04m:39.74sIntermediate time for GB: 00h:24m:56.87s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1297289
	speed: 0.0455s/iter; left time: 1015.3594s
	iters: 200, epoch: 1 | loss: 0.1126045
	speed: 0.0178s/iter; left time: 395.4763s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.67s
Steps: 224 | Train Loss: 0.1356361 Vali Loss: 0.0979728 Test Loss: 0.1105253
Validation loss decreased (inf --> 0.097973).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0740920
	speed: 0.0365s/iter; left time: 805.5324s
	iters: 200, epoch: 2 | loss: 0.0695283
	speed: 0.0174s/iter; left time: 382.0421s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0769994 Vali Loss: 0.0646745 Test Loss: 0.0711548
Validation loss decreased (0.097973 --> 0.064675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0641058
	speed: 0.0361s/iter; left time: 789.8069s
	iters: 200, epoch: 3 | loss: 0.0647144
	speed: 0.0174s/iter; left time: 378.6878s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.08s
Steps: 224 | Train Loss: 0.0655269 Vali Loss: 0.0602642 Test Loss: 0.0665508
Validation loss decreased (0.064675 --> 0.060264).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0620353
	speed: 0.0359s/iter; left time: 777.5343s
	iters: 200, epoch: 4 | loss: 0.0641675
	speed: 0.0180s/iter; left time: 386.8719s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0622778 Vali Loss: 0.0589169 Test Loss: 0.0652260
Validation loss decreased (0.060264 --> 0.058917).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0600411
	speed: 0.0386s/iter; left time: 827.2866s
	iters: 200, epoch: 5 | loss: 0.0605951
	speed: 0.0208s/iter; left time: 443.8745s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0604136 Vali Loss: 0.0574598 Test Loss: 0.0637832
Validation loss decreased (0.058917 --> 0.057460).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0576362
	speed: 0.0362s/iter; left time: 767.1964s
	iters: 200, epoch: 6 | loss: 0.0572372
	speed: 0.0185s/iter; left time: 389.9134s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0592250 Vali Loss: 0.0569232 Test Loss: 0.0629814
Validation loss decreased (0.057460 --> 0.056923).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0641758
	speed: 0.0404s/iter; left time: 847.3156s
	iters: 200, epoch: 7 | loss: 0.0604304
	speed: 0.0228s/iter; left time: 474.5829s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0582727 Vali Loss: 0.0563158 Test Loss: 0.0624014
Validation loss decreased (0.056923 --> 0.056316).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0597004
	speed: 0.0397s/iter; left time: 823.0412s
	iters: 200, epoch: 8 | loss: 0.0545038
	speed: 0.0217s/iter; left time: 448.3926s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0575341 Vali Loss: 0.0555614 Test Loss: 0.0619747
Validation loss decreased (0.056316 --> 0.055561).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0581241
	speed: 0.0373s/iter; left time: 764.9084s
	iters: 200, epoch: 9 | loss: 0.0560733
	speed: 0.0177s/iter; left time: 361.4737s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0569077 Vali Loss: 0.0551520 Test Loss: 0.0613294
Validation loss decreased (0.055561 --> 0.055152).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0600654
	speed: 0.0369s/iter; left time: 748.1508s
	iters: 200, epoch: 10 | loss: 0.0543051
	speed: 0.0173s/iter; left time: 349.3145s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0564565 Vali Loss: 0.0552002 Test Loss: 0.0615373
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0573782
	speed: 0.0354s/iter; left time: 710.7419s
	iters: 200, epoch: 11 | loss: 0.0561891
	speed: 0.0173s/iter; left time: 346.3160s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0560166 Vali Loss: 0.0547021 Test Loss: 0.0608617
Validation loss decreased (0.055152 --> 0.054702).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0549166
	speed: 0.0368s/iter; left time: 730.5754s
	iters: 200, epoch: 12 | loss: 0.0550303
	speed: 0.0175s/iter; left time: 345.7978s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0556077 Vali Loss: 0.0544642 Test Loss: 0.0607819
Validation loss decreased (0.054702 --> 0.054464).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0530001
	speed: 0.0374s/iter; left time: 734.4276s
	iters: 200, epoch: 13 | loss: 0.0505261
	speed: 0.0172s/iter; left time: 336.1488s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0553481 Vali Loss: 0.0544108 Test Loss: 0.0603867
Validation loss decreased (0.054464 --> 0.054411).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0576824
	speed: 0.0382s/iter; left time: 741.3690s
	iters: 200, epoch: 14 | loss: 0.0537340
	speed: 0.0180s/iter; left time: 347.9689s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0550210 Vali Loss: 0.0542770 Test Loss: 0.0605504
Validation loss decreased (0.054411 --> 0.054277).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0541440
	speed: 0.0374s/iter; left time: 716.8168s
	iters: 200, epoch: 15 | loss: 0.0551845
	speed: 0.0176s/iter; left time: 336.3310s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0547780 Vali Loss: 0.0540772 Test Loss: 0.0603587
Validation loss decreased (0.054277 --> 0.054077).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0509629
	speed: 0.0377s/iter; left time: 714.1568s
	iters: 200, epoch: 16 | loss: 0.0555559
	speed: 0.0201s/iter; left time: 379.2681s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0545937 Vali Loss: 0.0540071 Test Loss: 0.0602936
Validation loss decreased (0.054077 --> 0.054007).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0533449
	speed: 0.0376s/iter; left time: 702.8441s
	iters: 200, epoch: 17 | loss: 0.0549480
	speed: 0.0232s/iter; left time: 431.4784s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.92s
Steps: 224 | Train Loss: 0.0543840 Vali Loss: 0.0535351 Test Loss: 0.0598909
Validation loss decreased (0.054007 --> 0.053535).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0534377
	speed: 0.0413s/iter; left time: 763.0813s
	iters: 200, epoch: 18 | loss: 0.0519669
	speed: 0.0180s/iter; left time: 330.7770s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0541835 Vali Loss: 0.0535182 Test Loss: 0.0599301
Validation loss decreased (0.053535 --> 0.053518).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0546421
	speed: 0.0365s/iter; left time: 666.7154s
	iters: 200, epoch: 19 | loss: 0.0532574
	speed: 0.0173s/iter; left time: 315.1478s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0541097 Vali Loss: 0.0536294 Test Loss: 0.0598268
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0540954
	speed: 0.0388s/iter; left time: 699.9337s
	iters: 200, epoch: 20 | loss: 0.0566773
	speed: 0.0218s/iter; left time: 391.6953s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0538978 Vali Loss: 0.0535801 Test Loss: 0.0599190
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0543947
	speed: 0.0428s/iter; left time: 762.3693s
	iters: 200, epoch: 21 | loss: 0.0548367
	speed: 0.0209s/iter; left time: 369.5021s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0537692 Vali Loss: 0.0534152 Test Loss: 0.0598009
Validation loss decreased (0.053518 --> 0.053415).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0549492
	speed: 0.0444s/iter; left time: 780.6195s
	iters: 200, epoch: 22 | loss: 0.0514017
	speed: 0.0198s/iter; left time: 346.0010s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0537207 Vali Loss: 0.0533374 Test Loss: 0.0596908
Validation loss decreased (0.053415 --> 0.053337).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0534591
	speed: 0.0393s/iter; left time: 682.3595s
	iters: 200, epoch: 23 | loss: 0.0526582
	speed: 0.0216s/iter; left time: 372.3723s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.85s
Steps: 224 | Train Loss: 0.0536544 Vali Loss: 0.0533163 Test Loss: 0.0596185
Validation loss decreased (0.053337 --> 0.053316).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0538955
	speed: 0.0382s/iter; left time: 655.3983s
	iters: 200, epoch: 24 | loss: 0.0538660
	speed: 0.0208s/iter; left time: 354.4755s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0535522 Vali Loss: 0.0532527 Test Loss: 0.0594967
Validation loss decreased (0.053316 --> 0.053253).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0573650
	speed: 0.0380s/iter; left time: 643.7574s
	iters: 200, epoch: 25 | loss: 0.0528080
	speed: 0.0178s/iter; left time: 300.2893s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0534546 Vali Loss: 0.0532459 Test Loss: 0.0595710
Validation loss decreased (0.053253 --> 0.053246).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0537234
	speed: 0.0401s/iter; left time: 669.8796s
	iters: 200, epoch: 26 | loss: 0.0546586
	speed: 0.0176s/iter; left time: 292.8550s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0533645 Vali Loss: 0.0533376 Test Loss: 0.0595235
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0516834
	speed: 0.0371s/iter; left time: 610.6094s
	iters: 200, epoch: 27 | loss: 0.0571585
	speed: 0.0177s/iter; left time: 289.8198s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0532839 Vali Loss: 0.0533172 Test Loss: 0.0594809
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0494189
	speed: 0.0375s/iter; left time: 610.2077s
	iters: 200, epoch: 28 | loss: 0.0522387
	speed: 0.0174s/iter; left time: 281.3267s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0533023 Vali Loss: 0.0531314 Test Loss: 0.0593853
Validation loss decreased (0.053246 --> 0.053131).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0519411
	speed: 0.0371s/iter; left time: 594.9347s
	iters: 200, epoch: 29 | loss: 0.0522147
	speed: 0.0180s/iter; left time: 286.0264s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0532008 Vali Loss: 0.0530601 Test Loss: 0.0593986
Validation loss decreased (0.053131 --> 0.053060).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0523858
	speed: 0.0420s/iter; left time: 664.5347s
	iters: 200, epoch: 30 | loss: 0.0539169
	speed: 0.0184s/iter; left time: 288.5349s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0532031 Vali Loss: 0.0530461 Test Loss: 0.0593301
Validation loss decreased (0.053060 --> 0.053046).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0542132
	speed: 0.0406s/iter; left time: 633.3297s
	iters: 200, epoch: 31 | loss: 0.0558742
	speed: 0.0176s/iter; left time: 272.9324s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.0531557 Vali Loss: 0.0529637 Test Loss: 0.0594197
Validation loss decreased (0.053046 --> 0.052964).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0531322
	speed: 0.0409s/iter; left time: 627.4583s
	iters: 200, epoch: 32 | loss: 0.0507826
	speed: 0.0204s/iter; left time: 310.8573s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0531287 Vali Loss: 0.0530666 Test Loss: 0.0593458
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0550206
	speed: 0.0367s/iter; left time: 555.3600s
	iters: 200, epoch: 33 | loss: 0.0542851
	speed: 0.0176s/iter; left time: 264.7813s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0531302 Vali Loss: 0.0529413 Test Loss: 0.0592580
Validation loss decreased (0.052964 --> 0.052941).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0553355
	speed: 0.0431s/iter; left time: 642.1845s
	iters: 200, epoch: 34 | loss: 0.0519135
	speed: 0.0197s/iter; left time: 292.1441s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0530112 Vali Loss: 0.0529859 Test Loss: 0.0593040
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0532875
	speed: 0.0362s/iter; left time: 530.9979s
	iters: 200, epoch: 35 | loss: 0.0528023
	speed: 0.0181s/iter; left time: 264.2406s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0530626 Vali Loss: 0.0530781 Test Loss: 0.0593102
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0557845
	speed: 0.0373s/iter; left time: 539.1795s
	iters: 200, epoch: 36 | loss: 0.0521810
	speed: 0.0176s/iter; left time: 252.7647s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0529679 Vali Loss: 0.0529296 Test Loss: 0.0592321
Validation loss decreased (0.052941 --> 0.052930).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0516731
	speed: 0.0358s/iter; left time: 510.3623s
	iters: 200, epoch: 37 | loss: 0.0540236
	speed: 0.0172s/iter; left time: 243.4831s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.05s
Steps: 224 | Train Loss: 0.0529866 Vali Loss: 0.0529916 Test Loss: 0.0592840
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0508000
	speed: 0.0362s/iter; left time: 507.2096s
	iters: 200, epoch: 38 | loss: 0.0547213
	speed: 0.0175s/iter; left time: 244.1583s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0529485 Vali Loss: 0.0529122 Test Loss: 0.0592196
Validation loss decreased (0.052930 --> 0.052912).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0529043
	speed: 0.0439s/iter; left time: 605.4128s
	iters: 200, epoch: 39 | loss: 0.0516311
	speed: 0.0246s/iter; left time: 337.1242s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.64s
Steps: 224 | Train Loss: 0.0529279 Vali Loss: 0.0528965 Test Loss: 0.0592480
Validation loss decreased (0.052912 --> 0.052897).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0494722
	speed: 0.0396s/iter; left time: 537.3741s
	iters: 200, epoch: 40 | loss: 0.0527704
	speed: 0.0175s/iter; left time: 235.0697s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0528899 Vali Loss: 0.0529518 Test Loss: 0.0593059
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0527010
	speed: 0.0354s/iter; left time: 471.6542s
	iters: 200, epoch: 41 | loss: 0.0523881
	speed: 0.0176s/iter; left time: 232.6918s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0529096 Vali Loss: 0.0528782 Test Loss: 0.0592054
Validation loss decreased (0.052897 --> 0.052878).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0550479
	speed: 0.0420s/iter; left time: 550.5007s
	iters: 200, epoch: 42 | loss: 0.0528131
	speed: 0.0175s/iter; left time: 227.9125s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0529324 Vali Loss: 0.0529419 Test Loss: 0.0592431
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0511567
	speed: 0.0449s/iter; left time: 578.9241s
	iters: 200, epoch: 43 | loss: 0.0510774
	speed: 0.0215s/iter; left time: 275.0716s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.43s
Steps: 224 | Train Loss: 0.0528664 Vali Loss: 0.0529480 Test Loss: 0.0592471
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0547131
	speed: 0.0377s/iter; left time: 478.0473s
	iters: 200, epoch: 44 | loss: 0.0535225
	speed: 0.0176s/iter; left time: 220.8867s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0529409 Vali Loss: 0.0529403 Test Loss: 0.0591982
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0499585
	speed: 0.0368s/iter; left time: 458.5532s
	iters: 200, epoch: 45 | loss: 0.0560696
	speed: 0.0211s/iter; left time: 260.0709s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0528784 Vali Loss: 0.0529030 Test Loss: 0.0592152
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0512092
	speed: 0.0385s/iter; left time: 470.9820s
	iters: 200, epoch: 46 | loss: 0.0548510
	speed: 0.0178s/iter; left time: 216.1218s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0528416 Vali Loss: 0.0529498 Test Loss: 0.0591846
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0539514
	speed: 0.0358s/iter; left time: 429.2966s
	iters: 200, epoch: 47 | loss: 0.0507728
	speed: 0.0174s/iter; left time: 207.2443s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0528806 Vali Loss: 0.0529439 Test Loss: 0.0591778
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0547237
	speed: 0.0360s/iter; left time: 423.9098s
	iters: 200, epoch: 48 | loss: 0.0500909
	speed: 0.0175s/iter; left time: 204.6962s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0528072 Vali Loss: 0.0529146 Test Loss: 0.0592384
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0538362
	speed: 0.0378s/iter; left time: 436.7830s
	iters: 200, epoch: 49 | loss: 0.0551731
	speed: 0.0176s/iter; left time: 201.9341s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0528127 Vali Loss: 0.0528409 Test Loss: 0.0591774
Validation loss decreased (0.052878 --> 0.052841).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0547548
	speed: 0.0363s/iter; left time: 410.5844s
	iters: 200, epoch: 50 | loss: 0.0522613
	speed: 0.0175s/iter; left time: 196.0091s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0528483 Vali Loss: 0.0529676 Test Loss: 0.0592235
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0515651
	speed: 0.0434s/iter; left time: 482.0306s
	iters: 200, epoch: 51 | loss: 0.0519167
	speed: 0.0205s/iter; left time: 225.8656s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0528751 Vali Loss: 0.0528772 Test Loss: 0.0591687
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0547058
	speed: 0.0394s/iter; left time: 428.2818s
	iters: 200, epoch: 52 | loss: 0.0527426
	speed: 0.0233s/iter; left time: 251.0973s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0528348 Vali Loss: 0.0528290 Test Loss: 0.0591753
Validation loss decreased (0.052841 --> 0.052829).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0529373
	speed: 0.0379s/iter; left time: 404.1027s
	iters: 200, epoch: 53 | loss: 0.0567268
	speed: 0.0182s/iter; left time: 192.0740s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0528269 Vali Loss: 0.0528880 Test Loss: 0.0591835
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0536679
	speed: 0.0388s/iter; left time: 404.9540s
	iters: 200, epoch: 54 | loss: 0.0512394
	speed: 0.0189s/iter; left time: 195.4855s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0527903 Vali Loss: 0.0528845 Test Loss: 0.0591716
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0511981
	speed: 0.0394s/iter; left time: 401.7271s
	iters: 200, epoch: 55 | loss: 0.0518198
	speed: 0.0175s/iter; left time: 176.4886s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0527804 Vali Loss: 0.0528382 Test Loss: 0.0591643
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0501965
	speed: 0.0377s/iter; left time: 376.6580s
	iters: 200, epoch: 56 | loss: 0.0531978
	speed: 0.0177s/iter; left time: 175.2349s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0528132 Vali Loss: 0.0529282 Test Loss: 0.0592545
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0523530
	speed: 0.0383s/iter; left time: 373.5001s
	iters: 200, epoch: 57 | loss: 0.0532235
	speed: 0.0188s/iter; left time: 181.9125s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0528334 Vali Loss: 0.0528543 Test Loss: 0.0591806
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0517060
	speed: 0.0385s/iter; left time: 367.0567s
	iters: 200, epoch: 58 | loss: 0.0537203
	speed: 0.0222s/iter; left time: 209.4681s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0528633 Vali Loss: 0.0529062 Test Loss: 0.0591597
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0542901
	speed: 0.0444s/iter; left time: 413.4854s
	iters: 200, epoch: 59 | loss: 0.0490207
	speed: 0.0196s/iter; left time: 180.7445s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0527814 Vali Loss: 0.0528723 Test Loss: 0.0591480
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0534826
	speed: 0.0398s/iter; left time: 361.2870s
	iters: 200, epoch: 60 | loss: 0.0522820
	speed: 0.0175s/iter; left time: 157.0870s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0528065 Vali Loss: 0.0528880 Test Loss: 0.0591799
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0541162
	speed: 0.0382s/iter; left time: 338.2691s
	iters: 200, epoch: 61 | loss: 0.0526189
	speed: 0.0199s/iter; left time: 174.4025s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.71s
Steps: 224 | Train Loss: 0.0528557 Vali Loss: 0.0528851 Test Loss: 0.0591978
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0529211
	speed: 0.0372s/iter; left time: 321.3345s
	iters: 200, epoch: 62 | loss: 0.0479516
	speed: 0.0172s/iter; left time: 147.0690s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.07s
Steps: 224 | Train Loss: 0.0527867 Vali Loss: 0.0529483 Test Loss: 0.0591934
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009751381352543831, rmse:0.0987490862607956, mae:0.05917529761791229, rse:0.29060661792755127
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1337921
	speed: 0.0206s/iter; left time: 458.7822s
	iters: 200, epoch: 1 | loss: 0.1069674
	speed: 0.0206s/iter; left time: 458.2845s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.1356587 Vali Loss: 0.0968538 Test Loss: 0.1094441
Validation loss decreased (inf --> 0.096854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0746105
	speed: 0.0394s/iter; left time: 869.6349s
	iters: 200, epoch: 2 | loss: 0.0701489
	speed: 0.0175s/iter; left time: 385.2628s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0767475 Vali Loss: 0.0639559 Test Loss: 0.0706353
Validation loss decreased (0.096854 --> 0.063956).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0675678
	speed: 0.0370s/iter; left time: 807.9522s
	iters: 200, epoch: 3 | loss: 0.0615702
	speed: 0.0174s/iter; left time: 379.5001s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0655629 Vali Loss: 0.0605291 Test Loss: 0.0668655
Validation loss decreased (0.063956 --> 0.060529).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0629944
	speed: 0.0368s/iter; left time: 795.4977s
	iters: 200, epoch: 4 | loss: 0.0648704
	speed: 0.0183s/iter; left time: 393.1143s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0625614 Vali Loss: 0.0589684 Test Loss: 0.0655182
Validation loss decreased (0.060529 --> 0.058968).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0588870
	speed: 0.0402s/iter; left time: 860.9520s
	iters: 200, epoch: 5 | loss: 0.0615544
	speed: 0.0176s/iter; left time: 375.3501s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0606106 Vali Loss: 0.0578980 Test Loss: 0.0645265
Validation loss decreased (0.058968 --> 0.057898).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0592575
	speed: 0.0370s/iter; left time: 782.9556s
	iters: 200, epoch: 6 | loss: 0.0571381
	speed: 0.0175s/iter; left time: 368.9623s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0593913 Vali Loss: 0.0566761 Test Loss: 0.0631738
Validation loss decreased (0.057898 --> 0.056676).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0611145
	speed: 0.0367s/iter; left time: 769.3887s
	iters: 200, epoch: 7 | loss: 0.0605097
	speed: 0.0174s/iter; left time: 362.4459s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0583720 Vali Loss: 0.0562617 Test Loss: 0.0624770
Validation loss decreased (0.056676 --> 0.056262).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0629369
	speed: 0.0418s/iter; left time: 866.8303s
	iters: 200, epoch: 8 | loss: 0.0618621
	speed: 0.0217s/iter; left time: 447.5527s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0576425 Vali Loss: 0.0556517 Test Loss: 0.0618897
Validation loss decreased (0.056262 --> 0.055652).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0606712
	speed: 0.0427s/iter; left time: 875.6113s
	iters: 200, epoch: 9 | loss: 0.0555764
	speed: 0.0222s/iter; left time: 453.1669s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0569985 Vali Loss: 0.0555573 Test Loss: 0.0616752
Validation loss decreased (0.055652 --> 0.055557).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0596933
	speed: 0.0453s/iter; left time: 919.0482s
	iters: 200, epoch: 10 | loss: 0.0554582
	speed: 0.0227s/iter; left time: 457.5148s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0565138 Vali Loss: 0.0551991 Test Loss: 0.0614132
Validation loss decreased (0.055557 --> 0.055199).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0616147
	speed: 0.0387s/iter; left time: 776.9877s
	iters: 200, epoch: 11 | loss: 0.0578825
	speed: 0.0174s/iter; left time: 348.0775s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0561789 Vali Loss: 0.0549304 Test Loss: 0.0611437
Validation loss decreased (0.055199 --> 0.054930).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0537045
	speed: 0.0367s/iter; left time: 727.8192s
	iters: 200, epoch: 12 | loss: 0.0578890
	speed: 0.0176s/iter; left time: 347.1098s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0557681 Vali Loss: 0.0547644 Test Loss: 0.0607991
Validation loss decreased (0.054930 --> 0.054764).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0570883
	speed: 0.0426s/iter; left time: 835.6845s
	iters: 200, epoch: 13 | loss: 0.0543759
	speed: 0.0178s/iter; left time: 347.4425s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.75s
Steps: 224 | Train Loss: 0.0554576 Vali Loss: 0.0546486 Test Loss: 0.0609315
Validation loss decreased (0.054764 --> 0.054649).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0559569
	speed: 0.0405s/iter; left time: 784.2899s
	iters: 200, epoch: 14 | loss: 0.0576939
	speed: 0.0206s/iter; left time: 397.7978s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0551173 Vali Loss: 0.0543713 Test Loss: 0.0607464
Validation loss decreased (0.054649 --> 0.054371).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0574309
	speed: 0.0404s/iter; left time: 773.9555s
	iters: 200, epoch: 15 | loss: 0.0533791
	speed: 0.0193s/iter; left time: 367.0969s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.70s
Steps: 224 | Train Loss: 0.0548902 Vali Loss: 0.0541163 Test Loss: 0.0603891
Validation loss decreased (0.054371 --> 0.054116).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0560301
	speed: 0.0400s/iter; left time: 758.5325s
	iters: 200, epoch: 16 | loss: 0.0556359
	speed: 0.0215s/iter; left time: 404.2720s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.71s
Steps: 224 | Train Loss: 0.0546661 Vali Loss: 0.0540735 Test Loss: 0.0603688
Validation loss decreased (0.054116 --> 0.054073).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0567861
	speed: 0.0400s/iter; left time: 749.0467s
	iters: 200, epoch: 17 | loss: 0.0534253
	speed: 0.0173s/iter; left time: 321.5685s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0545065 Vali Loss: 0.0539584 Test Loss: 0.0603209
Validation loss decreased (0.054073 --> 0.053958).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0544936
	speed: 0.0390s/iter; left time: 721.0882s
	iters: 200, epoch: 18 | loss: 0.0505661
	speed: 0.0215s/iter; left time: 394.5933s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.81s
Steps: 224 | Train Loss: 0.0542611 Vali Loss: 0.0537714 Test Loss: 0.0600516
Validation loss decreased (0.053958 --> 0.053771).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0572401
	speed: 0.0395s/iter; left time: 720.9557s
	iters: 200, epoch: 19 | loss: 0.0509766
	speed: 0.0203s/iter; left time: 368.0546s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0541876 Vali Loss: 0.0537230 Test Loss: 0.0601269
Validation loss decreased (0.053771 --> 0.053723).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0581672
	speed: 0.0391s/iter; left time: 704.9706s
	iters: 200, epoch: 20 | loss: 0.0560375
	speed: 0.0176s/iter; left time: 316.4305s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0540584 Vali Loss: 0.0535869 Test Loss: 0.0598196
Validation loss decreased (0.053723 --> 0.053587).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0489908
	speed: 0.0382s/iter; left time: 680.8923s
	iters: 200, epoch: 21 | loss: 0.0556523
	speed: 0.0175s/iter; left time: 310.5944s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0539873 Vali Loss: 0.0535157 Test Loss: 0.0598667
Validation loss decreased (0.053587 --> 0.053516).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0564136
	speed: 0.0368s/iter; left time: 647.5133s
	iters: 200, epoch: 22 | loss: 0.0507003
	speed: 0.0175s/iter; left time: 305.8646s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0538451 Vali Loss: 0.0534693 Test Loss: 0.0597156
Validation loss decreased (0.053516 --> 0.053469).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0500772
	speed: 0.0375s/iter; left time: 651.1026s
	iters: 200, epoch: 23 | loss: 0.0531840
	speed: 0.0175s/iter; left time: 301.5679s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0537557 Vali Loss: 0.0533803 Test Loss: 0.0598192
Validation loss decreased (0.053469 --> 0.053380).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0520380
	speed: 0.0453s/iter; left time: 776.9973s
	iters: 200, epoch: 24 | loss: 0.0564743
	speed: 0.0176s/iter; left time: 300.5953s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0536120 Vali Loss: 0.0534145 Test Loss: 0.0596311
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0510081
	speed: 0.0377s/iter; left time: 638.7096s
	iters: 200, epoch: 25 | loss: 0.0502159
	speed: 0.0174s/iter; left time: 293.4223s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0535521 Vali Loss: 0.0534059 Test Loss: 0.0596591
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0510387
	speed: 0.0371s/iter; left time: 620.4239s
	iters: 200, epoch: 26 | loss: 0.0527924
	speed: 0.0177s/iter; left time: 293.0691s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0534718 Vali Loss: 0.0533074 Test Loss: 0.0596614
Validation loss decreased (0.053380 --> 0.053307).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0546484
	speed: 0.0363s/iter; left time: 597.5156s
	iters: 200, epoch: 27 | loss: 0.0502867
	speed: 0.0173s/iter; left time: 283.2315s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0534427 Vali Loss: 0.0532914 Test Loss: 0.0595673
Validation loss decreased (0.053307 --> 0.053291).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0513472
	speed: 0.0380s/iter; left time: 617.8899s
	iters: 200, epoch: 28 | loss: 0.0544608
	speed: 0.0177s/iter; left time: 286.4943s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0534265 Vali Loss: 0.0533097 Test Loss: 0.0595132
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0543246
	speed: 0.0378s/iter; left time: 606.4173s
	iters: 200, epoch: 29 | loss: 0.0545000
	speed: 0.0175s/iter; left time: 278.9645s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0533031 Vali Loss: 0.0533129 Test Loss: 0.0596252
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0578123
	speed: 0.0384s/iter; left time: 606.5506s
	iters: 200, epoch: 30 | loss: 0.0523473
	speed: 0.0175s/iter; left time: 275.2154s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0532915 Vali Loss: 0.0531913 Test Loss: 0.0594889
Validation loss decreased (0.053291 --> 0.053191).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0544150
	speed: 0.0371s/iter; left time: 578.5391s
	iters: 200, epoch: 31 | loss: 0.0515520
	speed: 0.0175s/iter; left time: 270.9475s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0532813 Vali Loss: 0.0531744 Test Loss: 0.0595354
Validation loss decreased (0.053191 --> 0.053174).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0559174
	speed: 0.0378s/iter; left time: 580.8415s
	iters: 200, epoch: 32 | loss: 0.0526729
	speed: 0.0173s/iter; left time: 264.4082s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0532091 Vali Loss: 0.0531425 Test Loss: 0.0594587
Validation loss decreased (0.053174 --> 0.053143).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0532093
	speed: 0.0366s/iter; left time: 553.8593s
	iters: 200, epoch: 33 | loss: 0.0478663
	speed: 0.0173s/iter; left time: 259.7646s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0531877 Vali Loss: 0.0531788 Test Loss: 0.0594424
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0499334
	speed: 0.0370s/iter; left time: 551.6185s
	iters: 200, epoch: 34 | loss: 0.0506587
	speed: 0.0175s/iter; left time: 259.2720s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0531430 Vali Loss: 0.0531837 Test Loss: 0.0594441
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0517330
	speed: 0.0424s/iter; left time: 622.5793s
	iters: 200, epoch: 35 | loss: 0.0551342
	speed: 0.0203s/iter; left time: 295.9249s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0531663 Vali Loss: 0.0531581 Test Loss: 0.0594528
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0506947
	speed: 0.0403s/iter; left time: 582.4848s
	iters: 200, epoch: 36 | loss: 0.0583177
	speed: 0.0203s/iter; left time: 291.9542s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0531392 Vali Loss: 0.0531340 Test Loss: 0.0594451
Validation loss decreased (0.053143 --> 0.053134).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0542479
	speed: 0.0454s/iter; left time: 646.6699s
	iters: 200, epoch: 37 | loss: 0.0510775
	speed: 0.0217s/iter; left time: 306.7741s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0530918 Vali Loss: 0.0530867 Test Loss: 0.0593737
Validation loss decreased (0.053134 --> 0.053087).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0556557
	speed: 0.0396s/iter; left time: 554.6645s
	iters: 200, epoch: 38 | loss: 0.0513426
	speed: 0.0202s/iter; left time: 281.5902s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0530756 Vali Loss: 0.0531610 Test Loss: 0.0594667
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0526359
	speed: 0.0394s/iter; left time: 543.4934s
	iters: 200, epoch: 39 | loss: 0.0522014
	speed: 0.0172s/iter; left time: 235.9600s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0530237 Vali Loss: 0.0530525 Test Loss: 0.0593700
Validation loss decreased (0.053087 --> 0.053052).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0489786
	speed: 0.0409s/iter; left time: 554.8960s
	iters: 200, epoch: 40 | loss: 0.0538423
	speed: 0.0191s/iter; left time: 257.7489s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.67s
Steps: 224 | Train Loss: 0.0530496 Vali Loss: 0.0531109 Test Loss: 0.0593490
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0539034
	speed: 0.0382s/iter; left time: 508.9971s
	iters: 200, epoch: 41 | loss: 0.0502612
	speed: 0.0201s/iter; left time: 266.3523s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0529953 Vali Loss: 0.0531376 Test Loss: 0.0593575
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0509308
	speed: 0.0407s/iter; left time: 533.3291s
	iters: 200, epoch: 42 | loss: 0.0528011
	speed: 0.0203s/iter; left time: 264.3485s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.75s
Steps: 224 | Train Loss: 0.0530408 Vali Loss: 0.0531074 Test Loss: 0.0593930
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0536508
	speed: 0.0398s/iter; left time: 513.6043s
	iters: 200, epoch: 43 | loss: 0.0535419
	speed: 0.0209s/iter; left time: 267.6998s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0530064 Vali Loss: 0.0531483 Test Loss: 0.0593524
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0534231
	speed: 0.0422s/iter; left time: 534.2851s
	iters: 200, epoch: 44 | loss: 0.0485632
	speed: 0.0199s/iter; left time: 250.2485s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0529402 Vali Loss: 0.0530934 Test Loss: 0.0593843
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0504932
	speed: 0.0404s/iter; left time: 502.4356s
	iters: 200, epoch: 45 | loss: 0.0521229
	speed: 0.0174s/iter; left time: 214.9795s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0530215 Vali Loss: 0.0530575 Test Loss: 0.0593451
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0538279
	speed: 0.0362s/iter; left time: 442.9136s
	iters: 200, epoch: 46 | loss: 0.0554503
	speed: 0.0174s/iter; left time: 211.2609s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0529353 Vali Loss: 0.0530863 Test Loss: 0.0592994
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0534511
	speed: 0.0370s/iter; left time: 444.1844s
	iters: 200, epoch: 47 | loss: 0.0537172
	speed: 0.0176s/iter; left time: 208.8014s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0529956 Vali Loss: 0.0529808 Test Loss: 0.0593239
Validation loss decreased (0.053052 --> 0.052981).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0545642
	speed: 0.0414s/iter; left time: 487.0466s
	iters: 200, epoch: 48 | loss: 0.0503907
	speed: 0.0176s/iter; left time: 205.4235s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0529698 Vali Loss: 0.0530103 Test Loss: 0.0593279
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0509437
	speed: 0.0385s/iter; left time: 444.9423s
	iters: 200, epoch: 49 | loss: 0.0518087
	speed: 0.0175s/iter; left time: 200.7417s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0529407 Vali Loss: 0.0531188 Test Loss: 0.0594364
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0541317
	speed: 0.0405s/iter; left time: 458.9719s
	iters: 200, epoch: 50 | loss: 0.0539311
	speed: 0.0204s/iter; left time: 228.5966s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0529140 Vali Loss: 0.0530143 Test Loss: 0.0593071
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0535859
	speed: 0.0379s/iter; left time: 421.0638s
	iters: 200, epoch: 51 | loss: 0.0555147
	speed: 0.0172s/iter; left time: 189.5783s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0529585 Vali Loss: 0.0530431 Test Loss: 0.0593245
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0542467
	speed: 0.0359s/iter; left time: 390.8151s
	iters: 200, epoch: 52 | loss: 0.0480840
	speed: 0.0176s/iter; left time: 189.3970s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0529279 Vali Loss: 0.0530876 Test Loss: 0.0593659
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0522306
	speed: 0.0385s/iter; left time: 410.1747s
	iters: 200, epoch: 53 | loss: 0.0510478
	speed: 0.0195s/iter; left time: 205.8764s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0529877 Vali Loss: 0.0530985 Test Loss: 0.0593327
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0538847
	speed: 0.0378s/iter; left time: 394.1452s
	iters: 200, epoch: 54 | loss: 0.0531133
	speed: 0.0174s/iter; left time: 179.4616s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0529167 Vali Loss: 0.0530712 Test Loss: 0.0593545
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0534907
	speed: 0.0399s/iter; left time: 407.1084s
	iters: 200, epoch: 55 | loss: 0.0500412
	speed: 0.0200s/iter; left time: 202.3711s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.71s
Steps: 224 | Train Loss: 0.0529414 Vali Loss: 0.0530433 Test Loss: 0.0593276
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0530696
	speed: 0.0400s/iter; left time: 398.8456s
	iters: 200, epoch: 56 | loss: 0.0546860
	speed: 0.0176s/iter; left time: 173.6426s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0529148 Vali Loss: 0.0530499 Test Loss: 0.0593268
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0518850
	speed: 0.0382s/iter; left time: 372.5004s
	iters: 200, epoch: 57 | loss: 0.0534603
	speed: 0.0229s/iter; left time: 221.5153s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0529192 Vali Loss: 0.0530396 Test Loss: 0.0593469
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009775502607226372, rmse:0.0988711416721344, mae:0.05932391434907913, rse:0.29096582531929016
Intermediate time for ES and pred_len 24: 00h:11m:39.06s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1329530
	speed: 0.0443s/iter; left time: 987.1059s
	iters: 200, epoch: 1 | loss: 0.1160002
	speed: 0.0176s/iter; left time: 390.9360s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.1391902 Vali Loss: 0.1071772 Test Loss: 0.1206293
Validation loss decreased (inf --> 0.107177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0942523
	speed: 0.0385s/iter; left time: 850.8737s
	iters: 200, epoch: 2 | loss: 0.0861847
	speed: 0.0185s/iter; left time: 406.4747s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0945715 Vali Loss: 0.0842465 Test Loss: 0.0952013
Validation loss decreased (0.107177 --> 0.084247).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0845243
	speed: 0.0382s/iter; left time: 834.0629s
	iters: 200, epoch: 3 | loss: 0.0815090
	speed: 0.0181s/iter; left time: 393.0070s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0852838 Vali Loss: 0.0807858 Test Loss: 0.0915264
Validation loss decreased (0.084247 --> 0.080786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0820356
	speed: 0.0378s/iter; left time: 816.7261s
	iters: 200, epoch: 4 | loss: 0.0805881
	speed: 0.0176s/iter; left time: 378.4579s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0823000 Vali Loss: 0.0797732 Test Loss: 0.0897798
Validation loss decreased (0.080786 --> 0.079773).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0798331
	speed: 0.0379s/iter; left time: 810.5959s
	iters: 200, epoch: 5 | loss: 0.0755010
	speed: 0.0177s/iter; left time: 376.4547s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0804131 Vali Loss: 0.0779141 Test Loss: 0.0881555
Validation loss decreased (0.079773 --> 0.077914).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0796704
	speed: 0.0375s/iter; left time: 793.5661s
	iters: 200, epoch: 6 | loss: 0.0799784
	speed: 0.0176s/iter; left time: 371.3938s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0789057 Vali Loss: 0.0770733 Test Loss: 0.0876542
Validation loss decreased (0.077914 --> 0.077073).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0788884
	speed: 0.0376s/iter; left time: 788.3541s
	iters: 200, epoch: 7 | loss: 0.0752197
	speed: 0.0177s/iter; left time: 368.9421s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0777904 Vali Loss: 0.0771061 Test Loss: 0.0872416
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0774317
	speed: 0.0376s/iter; left time: 779.7228s
	iters: 200, epoch: 8 | loss: 0.0751686
	speed: 0.0205s/iter; left time: 423.0827s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0770810 Vali Loss: 0.0767934 Test Loss: 0.0870996
Validation loss decreased (0.077073 --> 0.076793).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0771739
	speed: 0.0401s/iter; left time: 823.3700s
	iters: 200, epoch: 9 | loss: 0.0746005
	speed: 0.0182s/iter; left time: 372.1932s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0765222 Vali Loss: 0.0760892 Test Loss: 0.0869368
Validation loss decreased (0.076793 --> 0.076089).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0779370
	speed: 0.0435s/iter; left time: 882.3856s
	iters: 200, epoch: 10 | loss: 0.0787978
	speed: 0.0186s/iter; left time: 375.7706s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0760347 Vali Loss: 0.0766135 Test Loss: 0.0868480
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0761426
	speed: 0.0382s/iter; left time: 765.4540s
	iters: 200, epoch: 11 | loss: 0.0789521
	speed: 0.0178s/iter; left time: 355.2533s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0756286 Vali Loss: 0.0763626 Test Loss: 0.0866961
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0761763
	speed: 0.0373s/iter; left time: 740.3132s
	iters: 200, epoch: 12 | loss: 0.0757204
	speed: 0.0178s/iter; left time: 352.1149s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0753164 Vali Loss: 0.0763749 Test Loss: 0.0863272
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0718356
	speed: 0.0375s/iter; left time: 735.7471s
	iters: 200, epoch: 13 | loss: 0.0752915
	speed: 0.0178s/iter; left time: 348.1502s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0749505 Vali Loss: 0.0764924 Test Loss: 0.0864433
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0712507
	speed: 0.0413s/iter; left time: 800.9626s
	iters: 200, epoch: 14 | loss: 0.0751940
	speed: 0.0204s/iter; left time: 393.4338s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0747298 Vali Loss: 0.0763432 Test Loss: 0.0865515
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0714074
	speed: 0.0389s/iter; left time: 746.0339s
	iters: 200, epoch: 15 | loss: 0.0769075
	speed: 0.0179s/iter; left time: 340.5364s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0744110 Vali Loss: 0.0763409 Test Loss: 0.0860551
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0736857
	speed: 0.0390s/iter; left time: 738.2485s
	iters: 200, epoch: 16 | loss: 0.0758855
	speed: 0.0179s/iter; left time: 336.5092s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0741638 Vali Loss: 0.0763573 Test Loss: 0.0862534
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0732683
	speed: 0.0372s/iter; left time: 696.4759s
	iters: 200, epoch: 17 | loss: 0.0766605
	speed: 0.0178s/iter; left time: 332.1364s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0739782 Vali Loss: 0.0760687 Test Loss: 0.0860618
Validation loss decreased (0.076089 --> 0.076069).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0758949
	speed: 0.0420s/iter; left time: 775.8797s
	iters: 200, epoch: 18 | loss: 0.0741989
	speed: 0.0201s/iter; left time: 369.7413s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0738317 Vali Loss: 0.0758029 Test Loss: 0.0859767
Validation loss decreased (0.076069 --> 0.075803).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0731899
	speed: 0.0400s/iter; left time: 730.6615s
	iters: 200, epoch: 19 | loss: 0.0783558
	speed: 0.0180s/iter; left time: 326.9009s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0736161 Vali Loss: 0.0767120 Test Loss: 0.0861842
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0724703
	speed: 0.0395s/iter; left time: 713.2295s
	iters: 200, epoch: 20 | loss: 0.0739780
	speed: 0.0187s/iter; left time: 335.3997s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0735227 Vali Loss: 0.0763454 Test Loss: 0.0858723
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0736979
	speed: 0.0383s/iter; left time: 681.9721s
	iters: 200, epoch: 21 | loss: 0.0692475
	speed: 0.0176s/iter; left time: 312.3662s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0733244 Vali Loss: 0.0759520 Test Loss: 0.0858447
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0742377
	speed: 0.0378s/iter; left time: 664.7089s
	iters: 200, epoch: 22 | loss: 0.0738283
	speed: 0.0177s/iter; left time: 309.2537s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0732371 Vali Loss: 0.0761869 Test Loss: 0.0859049
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0716027
	speed: 0.0386s/iter; left time: 671.2958s
	iters: 200, epoch: 23 | loss: 0.0768406
	speed: 0.0176s/iter; left time: 304.6666s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0730942 Vali Loss: 0.0761952 Test Loss: 0.0858184
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0739905
	speed: 0.0375s/iter; left time: 643.1647s
	iters: 200, epoch: 24 | loss: 0.0714365
	speed: 0.0177s/iter; left time: 300.9809s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0729818 Vali Loss: 0.0762859 Test Loss: 0.0857470
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0700301
	speed: 0.0383s/iter; left time: 648.7693s
	iters: 200, epoch: 25 | loss: 0.0753928
	speed: 0.0181s/iter; left time: 303.6990s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0729328 Vali Loss: 0.0763261 Test Loss: 0.0859215
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0696138
	speed: 0.0382s/iter; left time: 637.6291s
	iters: 200, epoch: 26 | loss: 0.0715025
	speed: 0.0196s/iter; left time: 325.3901s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0728175 Vali Loss: 0.0762029 Test Loss: 0.0858192
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0725613
	speed: 0.0370s/iter; left time: 610.2925s
	iters: 200, epoch: 27 | loss: 0.0719680
	speed: 0.0185s/iter; left time: 302.3377s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0727753 Vali Loss: 0.0761756 Test Loss: 0.0857254
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0751431
	speed: 0.0390s/iter; left time: 634.0645s
	iters: 200, epoch: 28 | loss: 0.0738966
	speed: 0.0178s/iter; left time: 287.2074s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0727138 Vali Loss: 0.0765646 Test Loss: 0.0857118
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01854773983359337, rmse:0.13619008660316467, mae:0.08597671240568161, rse:0.4000854790210724
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1367538
	speed: 0.0223s/iter; left time: 496.8574s
	iters: 200, epoch: 1 | loss: 0.1153385
	speed: 0.0233s/iter; left time: 517.9805s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.1400050 Vali Loss: 0.1071248 Test Loss: 0.1205454
Validation loss decreased (inf --> 0.107125).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0936913
	speed: 0.0460s/iter; left time: 1015.9851s
	iters: 200, epoch: 2 | loss: 0.0879241
	speed: 0.0176s/iter; left time: 387.3446s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0942411 Vali Loss: 0.0843040 Test Loss: 0.0953580
Validation loss decreased (0.107125 --> 0.084304).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0803946
	speed: 0.0403s/iter; left time: 880.0693s
	iters: 200, epoch: 3 | loss: 0.0812021
	speed: 0.0178s/iter; left time: 386.2305s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0852106 Vali Loss: 0.0801856 Test Loss: 0.0912001
Validation loss decreased (0.084304 --> 0.080186).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0788692
	speed: 0.0415s/iter; left time: 898.5903s
	iters: 200, epoch: 4 | loss: 0.0762093
	speed: 0.0216s/iter; left time: 466.0767s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0821201 Vali Loss: 0.0789561 Test Loss: 0.0895967
Validation loss decreased (0.080186 --> 0.078956).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0793223
	speed: 0.0421s/iter; left time: 900.2679s
	iters: 200, epoch: 5 | loss: 0.0773962
	speed: 0.0193s/iter; left time: 410.6598s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0802467 Vali Loss: 0.0778591 Test Loss: 0.0884357
Validation loss decreased (0.078956 --> 0.077859).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0816932
	speed: 0.0403s/iter; left time: 853.8364s
	iters: 200, epoch: 6 | loss: 0.0778644
	speed: 0.0177s/iter; left time: 373.6399s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0790325 Vali Loss: 0.0767959 Test Loss: 0.0875439
Validation loss decreased (0.077859 --> 0.076796).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0745961
	speed: 0.0387s/iter; left time: 810.0707s
	iters: 200, epoch: 7 | loss: 0.0834768
	speed: 0.0178s/iter; left time: 371.2190s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0781038 Vali Loss: 0.0762627 Test Loss: 0.0873462
Validation loss decreased (0.076796 --> 0.076263).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0800848
	speed: 0.0400s/iter; left time: 829.6929s
	iters: 200, epoch: 8 | loss: 0.0742644
	speed: 0.0178s/iter; left time: 367.8463s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0773239 Vali Loss: 0.0775152 Test Loss: 0.0874873
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0721739
	speed: 0.0381s/iter; left time: 780.9902s
	iters: 200, epoch: 9 | loss: 0.0794274
	speed: 0.0209s/iter; left time: 426.2011s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.0767547 Vali Loss: 0.0763608 Test Loss: 0.0870005
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0758219
	speed: 0.0409s/iter; left time: 828.6589s
	iters: 200, epoch: 10 | loss: 0.0767745
	speed: 0.0189s/iter; left time: 381.8243s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.77s
Steps: 224 | Train Loss: 0.0761915 Vali Loss: 0.0771433 Test Loss: 0.0867632
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0747136
	speed: 0.0450s/iter; left time: 903.2435s
	iters: 200, epoch: 11 | loss: 0.0756405
	speed: 0.0197s/iter; left time: 394.1105s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0757717 Vali Loss: 0.0765610 Test Loss: 0.0865518
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0714020
	speed: 0.0425s/iter; left time: 843.1375s
	iters: 200, epoch: 12 | loss: 0.0774138
	speed: 0.0219s/iter; left time: 431.8730s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0754335 Vali Loss: 0.0767363 Test Loss: 0.0865050
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0722883
	speed: 0.0396s/iter; left time: 775.7284s
	iters: 200, epoch: 13 | loss: 0.0759881
	speed: 0.0175s/iter; left time: 341.8679s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0751549 Vali Loss: 0.0761463 Test Loss: 0.0862424
Validation loss decreased (0.076263 --> 0.076146).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0745482
	speed: 0.0412s/iter; left time: 799.4890s
	iters: 200, epoch: 14 | loss: 0.0744093
	speed: 0.0245s/iter; left time: 471.7068s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0747696 Vali Loss: 0.0762650 Test Loss: 0.0862187
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0720881
	speed: 0.0400s/iter; left time: 765.8024s
	iters: 200, epoch: 15 | loss: 0.0781316
	speed: 0.0174s/iter; left time: 331.5139s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0745868 Vali Loss: 0.0765290 Test Loss: 0.0860522
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0727114
	speed: 0.0412s/iter; left time: 779.4685s
	iters: 200, epoch: 16 | loss: 0.0736387
	speed: 0.0179s/iter; left time: 337.6929s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0743449 Vali Loss: 0.0765852 Test Loss: 0.0860310
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0706794
	speed: 0.0388s/iter; left time: 726.9777s
	iters: 200, epoch: 17 | loss: 0.0752406
	speed: 0.0205s/iter; left time: 381.2807s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0741923 Vali Loss: 0.0764369 Test Loss: 0.0859239
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0744676
	speed: 0.0419s/iter; left time: 775.4276s
	iters: 200, epoch: 18 | loss: 0.0762818
	speed: 0.0202s/iter; left time: 371.9966s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0740024 Vali Loss: 0.0767829 Test Loss: 0.0857268
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0720721
	speed: 0.0437s/iter; left time: 797.7713s
	iters: 200, epoch: 19 | loss: 0.0713664
	speed: 0.0189s/iter; left time: 342.6416s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0738495 Vali Loss: 0.0765352 Test Loss: 0.0859384
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0717330
	speed: 0.0413s/iter; left time: 745.2349s
	iters: 200, epoch: 20 | loss: 0.0795915
	speed: 0.0205s/iter; left time: 368.4882s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.85s
Steps: 224 | Train Loss: 0.0736705 Vali Loss: 0.0764407 Test Loss: 0.0857348
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0724586
	speed: 0.0392s/iter; left time: 697.8497s
	iters: 200, epoch: 21 | loss: 0.0760887
	speed: 0.0186s/iter; left time: 329.4173s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0735496 Vali Loss: 0.0764364 Test Loss: 0.0857035
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0712291
	speed: 0.0433s/iter; left time: 762.3607s
	iters: 200, epoch: 22 | loss: 0.0771685
	speed: 0.0197s/iter; left time: 344.7128s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0734158 Vali Loss: 0.0766588 Test Loss: 0.0858466
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0699845
	speed: 0.0433s/iter; left time: 751.8209s
	iters: 200, epoch: 23 | loss: 0.0729147
	speed: 0.0220s/iter; left time: 380.6992s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0733128 Vali Loss: 0.0762644 Test Loss: 0.0857591
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018521282821893692, rmse:0.1360929161310196, mae:0.08624237030744553, rse:0.39980003237724304
Intermediate time for ES and pred_len 96: 00h:05m:11.72s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1373530
	speed: 0.0465s/iter; left time: 1032.9857s
	iters: 200, epoch: 1 | loss: 0.1231130
	speed: 0.0178s/iter; left time: 392.6448s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.52s
Steps: 223 | Train Loss: 0.1409036 Vali Loss: 0.1098791 Test Loss: 0.1227950
Validation loss decreased (inf --> 0.109879).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0984424
	speed: 0.0383s/iter; left time: 841.7268s
	iters: 200, epoch: 2 | loss: 0.0898476
	speed: 0.0182s/iter; left time: 398.6883s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0985992 Vali Loss: 0.0892979 Test Loss: 0.1007477
Validation loss decreased (0.109879 --> 0.089298).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0924045
	speed: 0.0405s/iter; left time: 880.7054s
	iters: 200, epoch: 3 | loss: 0.0917421
	speed: 0.0180s/iter; left time: 389.3996s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.36s
Steps: 223 | Train Loss: 0.0898567 Vali Loss: 0.0863748 Test Loss: 0.0964161
Validation loss decreased (0.089298 --> 0.086375).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0892772
	speed: 0.0398s/iter; left time: 856.7383s
	iters: 200, epoch: 4 | loss: 0.0851799
	speed: 0.0179s/iter; left time: 383.3302s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0869219 Vali Loss: 0.0845703 Test Loss: 0.0945225
Validation loss decreased (0.086375 --> 0.084570).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0874058
	speed: 0.0391s/iter; left time: 832.4707s
	iters: 200, epoch: 5 | loss: 0.0828013
	speed: 0.0178s/iter; left time: 377.3469s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0849152 Vali Loss: 0.0836334 Test Loss: 0.0937513
Validation loss decreased (0.084570 --> 0.083633).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0815478
	speed: 0.0387s/iter; left time: 816.1537s
	iters: 200, epoch: 6 | loss: 0.0822768
	speed: 0.0180s/iter; left time: 377.1736s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0835952 Vali Loss: 0.0829994 Test Loss: 0.0932573
Validation loss decreased (0.083633 --> 0.082999).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0838339
	speed: 0.0395s/iter; left time: 823.9421s
	iters: 200, epoch: 7 | loss: 0.0832751
	speed: 0.0178s/iter; left time: 370.5364s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0826350 Vali Loss: 0.0830178 Test Loss: 0.0929825
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0780568
	speed: 0.0390s/iter; left time: 803.9680s
	iters: 200, epoch: 8 | loss: 0.0825638
	speed: 0.0203s/iter; left time: 417.1095s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.52s
Steps: 223 | Train Loss: 0.0819650 Vali Loss: 0.0831217 Test Loss: 0.0930658
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0815612
	speed: 0.0383s/iter; left time: 782.0732s
	iters: 200, epoch: 9 | loss: 0.0793496
	speed: 0.0184s/iter; left time: 373.9912s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0814262 Vali Loss: 0.0825041 Test Loss: 0.0924428
Validation loss decreased (0.082999 --> 0.082504).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0814151
	speed: 0.0392s/iter; left time: 790.9053s
	iters: 200, epoch: 10 | loss: 0.0819548
	speed: 0.0179s/iter; left time: 360.3476s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0809147 Vali Loss: 0.0830627 Test Loss: 0.0926520
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0803450
	speed: 0.0384s/iter; left time: 767.3787s
	iters: 200, epoch: 11 | loss: 0.0782218
	speed: 0.0181s/iter; left time: 360.2847s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0805403 Vali Loss: 0.0824139 Test Loss: 0.0921823
Validation loss decreased (0.082504 --> 0.082414).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0775920
	speed: 0.0397s/iter; left time: 784.6760s
	iters: 200, epoch: 12 | loss: 0.0816294
	speed: 0.0182s/iter; left time: 357.0129s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0801135 Vali Loss: 0.0824283 Test Loss: 0.0917523
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0782452
	speed: 0.0407s/iter; left time: 794.1000s
	iters: 200, epoch: 13 | loss: 0.0793490
	speed: 0.0190s/iter; left time: 369.0805s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0797442 Vali Loss: 0.0824807 Test Loss: 0.0922180
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0785616
	speed: 0.0401s/iter; left time: 773.2075s
	iters: 200, epoch: 14 | loss: 0.0811015
	speed: 0.0178s/iter; left time: 342.7203s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0794834 Vali Loss: 0.0825382 Test Loss: 0.0917946
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0793498
	speed: 0.0381s/iter; left time: 726.5424s
	iters: 200, epoch: 15 | loss: 0.0845542
	speed: 0.0178s/iter; left time: 337.7802s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0791975 Vali Loss: 0.0827265 Test Loss: 0.0922221
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0800094
	speed: 0.0381s/iter; left time: 719.1809s
	iters: 200, epoch: 16 | loss: 0.0803068
	speed: 0.0181s/iter; left time: 340.3413s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0789066 Vali Loss: 0.0829194 Test Loss: 0.0920897
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0777317
	speed: 0.0381s/iter; left time: 710.2658s
	iters: 200, epoch: 17 | loss: 0.0769415
	speed: 0.0178s/iter; left time: 329.6211s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0787117 Vali Loss: 0.0828620 Test Loss: 0.0919372
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0754707
	speed: 0.0418s/iter; left time: 769.0558s
	iters: 200, epoch: 18 | loss: 0.0807448
	speed: 0.0184s/iter; left time: 336.4545s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0784592 Vali Loss: 0.0827428 Test Loss: 0.0919137
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0788248
	speed: 0.0387s/iter; left time: 703.3631s
	iters: 200, epoch: 19 | loss: 0.0779088
	speed: 0.0180s/iter; left time: 325.4452s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0783152 Vali Loss: 0.0827719 Test Loss: 0.0921597
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0814836
	speed: 0.0378s/iter; left time: 678.8644s
	iters: 200, epoch: 20 | loss: 0.0774235
	speed: 0.0178s/iter; left time: 317.4518s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0781401 Vali Loss: 0.0830398 Test Loss: 0.0921266
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0771261
	speed: 0.0382s/iter; left time: 677.8467s
	iters: 200, epoch: 21 | loss: 0.0789094
	speed: 0.0178s/iter; left time: 314.8230s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0780248 Vali Loss: 0.0829910 Test Loss: 0.0919375
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020852474495768547, rmse:0.1444038599729538, mae:0.09218230098485947, rse:0.42424553632736206
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1372358
	speed: 0.0202s/iter; left time: 449.2328s
	iters: 200, epoch: 1 | loss: 0.1189031
	speed: 0.0179s/iter; left time: 395.0614s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.1425659 Vali Loss: 0.1109068 Test Loss: 0.1238196
Validation loss decreased (inf --> 0.110907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0962597
	speed: 0.0425s/iter; left time: 935.0872s
	iters: 200, epoch: 2 | loss: 0.0892632
	speed: 0.0180s/iter; left time: 393.8238s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0986520 Vali Loss: 0.0897229 Test Loss: 0.1013632
Validation loss decreased (0.110907 --> 0.089723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0895527
	speed: 0.0434s/iter; left time: 943.5019s
	iters: 200, epoch: 3 | loss: 0.0907336
	speed: 0.0201s/iter; left time: 435.8484s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.80s
Steps: 223 | Train Loss: 0.0899338 Vali Loss: 0.0860113 Test Loss: 0.0964112
Validation loss decreased (0.089723 --> 0.086011).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0877847
	speed: 0.0397s/iter; left time: 854.1758s
	iters: 200, epoch: 4 | loss: 0.0873513
	speed: 0.0179s/iter; left time: 383.5098s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0867699 Vali Loss: 0.0845652 Test Loss: 0.0945405
Validation loss decreased (0.086011 --> 0.084565).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0860343
	speed: 0.0392s/iter; left time: 834.4113s
	iters: 200, epoch: 5 | loss: 0.0856858
	speed: 0.0179s/iter; left time: 380.5522s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0848098 Vali Loss: 0.0831996 Test Loss: 0.0935732
Validation loss decreased (0.084565 --> 0.083200).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0817515
	speed: 0.0383s/iter; left time: 807.6410s
	iters: 200, epoch: 6 | loss: 0.0839486
	speed: 0.0178s/iter; left time: 374.5704s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0835718 Vali Loss: 0.0824345 Test Loss: 0.0923223
Validation loss decreased (0.083200 --> 0.082434).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0821306
	speed: 0.0427s/iter; left time: 891.5068s
	iters: 200, epoch: 7 | loss: 0.0817424
	speed: 0.0198s/iter; left time: 410.6680s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.81s
Steps: 223 | Train Loss: 0.0828282 Vali Loss: 0.0827731 Test Loss: 0.0922567
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0816821
	speed: 0.0384s/iter; left time: 791.9485s
	iters: 200, epoch: 8 | loss: 0.0851653
	speed: 0.0178s/iter; left time: 366.0989s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0822374 Vali Loss: 0.0825162 Test Loss: 0.0923592
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0792334
	speed: 0.0387s/iter; left time: 789.8722s
	iters: 200, epoch: 9 | loss: 0.0820873
	speed: 0.0177s/iter; left time: 360.0818s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0817259 Vali Loss: 0.0824933 Test Loss: 0.0925659
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0831882
	speed: 0.0420s/iter; left time: 848.0628s
	iters: 200, epoch: 10 | loss: 0.0840190
	speed: 0.0204s/iter; left time: 410.2407s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.79s
Steps: 223 | Train Loss: 0.0812772 Vali Loss: 0.0824480 Test Loss: 0.0920063
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0844629
	speed: 0.0422s/iter; left time: 842.0142s
	iters: 200, epoch: 11 | loss: 0.0821361
	speed: 0.0217s/iter; left time: 430.9348s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.93s
Steps: 223 | Train Loss: 0.0809295 Vali Loss: 0.0831282 Test Loss: 0.0924046
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0819720
	speed: 0.0393s/iter; left time: 775.8412s
	iters: 200, epoch: 12 | loss: 0.0770248
	speed: 0.0181s/iter; left time: 356.2009s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.36s
Steps: 223 | Train Loss: 0.0805377 Vali Loss: 0.0823976 Test Loss: 0.0917684
Validation loss decreased (0.082434 --> 0.082398).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0825309
	speed: 0.0393s/iter; left time: 768.1248s
	iters: 200, epoch: 13 | loss: 0.0808482
	speed: 0.0178s/iter; left time: 346.5230s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0802130 Vali Loss: 0.0822795 Test Loss: 0.0915192
Validation loss decreased (0.082398 --> 0.082279).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0787355
	speed: 0.0396s/iter; left time: 764.3940s
	iters: 200, epoch: 14 | loss: 0.0800075
	speed: 0.0178s/iter; left time: 341.8925s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0799463 Vali Loss: 0.0827081 Test Loss: 0.0917543
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0808903
	speed: 0.0406s/iter; left time: 775.0545s
	iters: 200, epoch: 15 | loss: 0.0780651
	speed: 0.0209s/iter; left time: 397.2604s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.77s
Steps: 223 | Train Loss: 0.0796282 Vali Loss: 0.0825399 Test Loss: 0.0913055
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0823017
	speed: 0.0437s/iter; left time: 823.8916s
	iters: 200, epoch: 16 | loss: 0.0812932
	speed: 0.0181s/iter; left time: 339.9237s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.76s
Steps: 223 | Train Loss: 0.0794008 Vali Loss: 0.0822595 Test Loss: 0.0912687
Validation loss decreased (0.082279 --> 0.082259).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0768999
	speed: 0.0397s/iter; left time: 740.5874s
	iters: 200, epoch: 17 | loss: 0.0793285
	speed: 0.0182s/iter; left time: 337.0923s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0792046 Vali Loss: 0.0824286 Test Loss: 0.0913005
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0811558
	speed: 0.0422s/iter; left time: 776.8880s
	iters: 200, epoch: 18 | loss: 0.0767288
	speed: 0.0186s/iter; left time: 341.1605s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.67s
Steps: 223 | Train Loss: 0.0790217 Vali Loss: 0.0826947 Test Loss: 0.0914750
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0766188
	speed: 0.0383s/iter; left time: 696.5783s
	iters: 200, epoch: 19 | loss: 0.0823196
	speed: 0.0180s/iter; left time: 325.6948s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0788044 Vali Loss: 0.0827591 Test Loss: 0.0914700
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0801984
	speed: 0.0382s/iter; left time: 686.2105s
	iters: 200, epoch: 20 | loss: 0.0807184
	speed: 0.0179s/iter; left time: 319.6310s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0786730 Vali Loss: 0.0820548 Test Loss: 0.0909845
Validation loss decreased (0.082259 --> 0.082055).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0805757
	speed: 0.0410s/iter; left time: 726.6098s
	iters: 200, epoch: 21 | loss: 0.0777372
	speed: 0.0185s/iter; left time: 325.7602s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.42s
Steps: 223 | Train Loss: 0.0785318 Vali Loss: 0.0824276 Test Loss: 0.0911584
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0793678
	speed: 0.0398s/iter; left time: 697.4270s
	iters: 200, epoch: 22 | loss: 0.0783650
	speed: 0.0185s/iter; left time: 322.6439s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0784128 Vali Loss: 0.0825987 Test Loss: 0.0912330
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0799742
	speed: 0.0389s/iter; left time: 673.1967s
	iters: 200, epoch: 23 | loss: 0.0794193
	speed: 0.0180s/iter; left time: 308.8951s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.32s
Steps: 223 | Train Loss: 0.0783116 Vali Loss: 0.0825067 Test Loss: 0.0911256
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0774844
	speed: 0.0408s/iter; left time: 695.8240s
	iters: 200, epoch: 24 | loss: 0.0797026
	speed: 0.0187s/iter; left time: 317.2155s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.0781464 Vali Loss: 0.0826594 Test Loss: 0.0912149
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0770763
	speed: 0.0453s/iter; left time: 763.6968s
	iters: 200, epoch: 25 | loss: 0.0791379
	speed: 0.0215s/iter; left time: 359.3924s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0780359 Vali Loss: 0.0827667 Test Loss: 0.0911917
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0812251
	speed: 0.0463s/iter; left time: 769.7062s
	iters: 200, epoch: 26 | loss: 0.0773855
	speed: 0.0217s/iter; left time: 358.8940s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.96s
Steps: 223 | Train Loss: 0.0779974 Vali Loss: 0.0827996 Test Loss: 0.0910253
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0775638
	speed: 0.0450s/iter; left time: 737.7617s
	iters: 200, epoch: 27 | loss: 0.0749843
	speed: 0.0213s/iter; left time: 346.7639s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.24s
Steps: 223 | Train Loss: 0.0779365 Vali Loss: 0.0824053 Test Loss: 0.0909868
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0782782
	speed: 0.0427s/iter; left time: 691.0858s
	iters: 200, epoch: 28 | loss: 0.0794728
	speed: 0.0213s/iter; left time: 342.2955s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0778237 Vali Loss: 0.0824167 Test Loss: 0.0909431
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0744470
	speed: 0.0498s/iter; left time: 794.5243s
	iters: 200, epoch: 29 | loss: 0.0743873
	speed: 0.0229s/iter; left time: 363.0499s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.51s
Steps: 223 | Train Loss: 0.0778208 Vali Loss: 0.0826677 Test Loss: 0.0910047
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0778956
	speed: 0.0468s/iter; left time: 736.4441s
	iters: 200, epoch: 30 | loss: 0.0735903
	speed: 0.0199s/iter; left time: 311.7442s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0777318 Vali Loss: 0.0826702 Test Loss: 0.0909662
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02058718539774418, rmse:0.14348235726356506, mae:0.09098456054925919, rse:0.42153823375701904
Intermediate time for ES and pred_len 168: 00h:05m:15.25sIntermediate time for ES: 00h:22m:06.03s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0923198
	speed: 0.0471s/iter; left time: 1050.7328s
	iters: 200, epoch: 1 | loss: 0.0812700
	speed: 0.0175s/iter; left time: 389.2890s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0997137 Vali Loss: 0.0826080 Test Loss: 0.0894115
Validation loss decreased (inf --> 0.082608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0530040
	speed: 0.0374s/iter; left time: 825.2455s
	iters: 200, epoch: 2 | loss: 0.0500890
	speed: 0.0176s/iter; left time: 386.6843s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0568332 Vali Loss: 0.0584304 Test Loss: 0.0615740
Validation loss decreased (0.082608 --> 0.058430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0495541
	speed: 0.0390s/iter; left time: 852.1089s
	iters: 200, epoch: 3 | loss: 0.0470994
	speed: 0.0178s/iter; left time: 386.2175s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0492891 Vali Loss: 0.0561867 Test Loss: 0.0599419
Validation loss decreased (0.058430 --> 0.056187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0472196
	speed: 0.0373s/iter; left time: 805.7826s
	iters: 200, epoch: 4 | loss: 0.0496854
	speed: 0.0175s/iter; left time: 375.9812s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0474948 Vali Loss: 0.0547214 Test Loss: 0.0583943
Validation loss decreased (0.056187 --> 0.054721).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0445898
	speed: 0.0379s/iter; left time: 811.0635s
	iters: 200, epoch: 5 | loss: 0.0486444
	speed: 0.0175s/iter; left time: 373.1694s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0462286 Vali Loss: 0.0537535 Test Loss: 0.0576479
Validation loss decreased (0.054721 --> 0.053753).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0466075
	speed: 0.0384s/iter; left time: 813.6643s
	iters: 200, epoch: 6 | loss: 0.0427133
	speed: 0.0173s/iter; left time: 364.8253s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0453936 Vali Loss: 0.0532484 Test Loss: 0.0574954
Validation loss decreased (0.053753 --> 0.053248).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0491663
	speed: 0.0406s/iter; left time: 851.6473s
	iters: 200, epoch: 7 | loss: 0.0448862
	speed: 0.0174s/iter; left time: 362.2701s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0447000 Vali Loss: 0.0526119 Test Loss: 0.0567984
Validation loss decreased (0.053248 --> 0.052612).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0448391
	speed: 0.0388s/iter; left time: 803.6487s
	iters: 200, epoch: 8 | loss: 0.0443497
	speed: 0.0175s/iter; left time: 361.5817s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0441658 Vali Loss: 0.0528287 Test Loss: 0.0566366
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0405296
	speed: 0.0380s/iter; left time: 779.3198s
	iters: 200, epoch: 9 | loss: 0.0458015
	speed: 0.0173s/iter; left time: 354.0245s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0437640 Vali Loss: 0.0521360 Test Loss: 0.0564570
Validation loss decreased (0.052612 --> 0.052136).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0441886
	speed: 0.0407s/iter; left time: 826.5387s
	iters: 200, epoch: 10 | loss: 0.0448638
	speed: 0.0206s/iter; left time: 415.6430s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.94s
Steps: 224 | Train Loss: 0.0434143 Vali Loss: 0.0517792 Test Loss: 0.0561378
Validation loss decreased (0.052136 --> 0.051779).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0440236
	speed: 0.0429s/iter; left time: 861.3392s
	iters: 200, epoch: 11 | loss: 0.0420616
	speed: 0.0212s/iter; left time: 423.0474s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.87s
Steps: 224 | Train Loss: 0.0431010 Vali Loss: 0.0520836 Test Loss: 0.0564000
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0403346
	speed: 0.0366s/iter; left time: 726.8405s
	iters: 200, epoch: 12 | loss: 0.0413291
	speed: 0.0175s/iter; left time: 345.6713s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0428325 Vali Loss: 0.0517494 Test Loss: 0.0560631
Validation loss decreased (0.051779 --> 0.051749).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0406433
	speed: 0.0376s/iter; left time: 737.7125s
	iters: 200, epoch: 13 | loss: 0.0392740
	speed: 0.0175s/iter; left time: 342.3012s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0425714 Vali Loss: 0.0517062 Test Loss: 0.0557897
Validation loss decreased (0.051749 --> 0.051706).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0407032
	speed: 0.0399s/iter; left time: 773.5516s
	iters: 200, epoch: 14 | loss: 0.0415839
	speed: 0.0184s/iter; left time: 355.1644s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0424152 Vali Loss: 0.0514950 Test Loss: 0.0557442
Validation loss decreased (0.051706 --> 0.051495).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0427796
	speed: 0.0377s/iter; left time: 723.2441s
	iters: 200, epoch: 15 | loss: 0.0386341
	speed: 0.0173s/iter; left time: 330.6866s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0422304 Vali Loss: 0.0514152 Test Loss: 0.0555388
Validation loss decreased (0.051495 --> 0.051415).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0407047
	speed: 0.0367s/iter; left time: 695.1301s
	iters: 200, epoch: 16 | loss: 0.0395314
	speed: 0.0197s/iter; left time: 370.9850s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0421071 Vali Loss: 0.0514455 Test Loss: 0.0555331
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0455639
	speed: 0.0411s/iter; left time: 768.5792s
	iters: 200, epoch: 17 | loss: 0.0418858
	speed: 0.0178s/iter; left time: 331.8940s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0419426 Vali Loss: 0.0512198 Test Loss: 0.0553853
Validation loss decreased (0.051415 --> 0.051220).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0401110
	speed: 0.0382s/iter; left time: 706.4201s
	iters: 200, epoch: 18 | loss: 0.0410072
	speed: 0.0177s/iter; left time: 326.4655s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0418059 Vali Loss: 0.0510725 Test Loss: 0.0553629
Validation loss decreased (0.051220 --> 0.051072).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0397940
	speed: 0.0400s/iter; left time: 730.7567s
	iters: 200, epoch: 19 | loss: 0.0415944
	speed: 0.0209s/iter; left time: 378.9757s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0416938 Vali Loss: 0.0510424 Test Loss: 0.0552553
Validation loss decreased (0.051072 --> 0.051042).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0410033
	speed: 0.0427s/iter; left time: 770.8388s
	iters: 200, epoch: 20 | loss: 0.0419177
	speed: 0.0181s/iter; left time: 324.9806s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0416170 Vali Loss: 0.0509896 Test Loss: 0.0552562
Validation loss decreased (0.051042 --> 0.050990).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0414350
	speed: 0.0380s/iter; left time: 677.0998s
	iters: 200, epoch: 21 | loss: 0.0406842
	speed: 0.0174s/iter; left time: 307.8928s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0415393 Vali Loss: 0.0508995 Test Loss: 0.0550967
Validation loss decreased (0.050990 --> 0.050899).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0403014
	speed: 0.0401s/iter; left time: 705.8079s
	iters: 200, epoch: 22 | loss: 0.0367226
	speed: 0.0178s/iter; left time: 310.8791s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0414575 Vali Loss: 0.0509838 Test Loss: 0.0551132
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0409429
	speed: 0.0398s/iter; left time: 691.6798s
	iters: 200, epoch: 23 | loss: 0.0429620
	speed: 0.0223s/iter; left time: 385.9510s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0413607 Vali Loss: 0.0509441 Test Loss: 0.0551800
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0404058
	speed: 0.0397s/iter; left time: 681.0152s
	iters: 200, epoch: 24 | loss: 0.0405565
	speed: 0.0222s/iter; left time: 378.7753s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0413338 Vali Loss: 0.0509188 Test Loss: 0.0551000
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0423914
	speed: 0.0407s/iter; left time: 688.4196s
	iters: 200, epoch: 25 | loss: 0.0413437
	speed: 0.0197s/iter; left time: 330.8031s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0412619 Vali Loss: 0.0509029 Test Loss: 0.0551642
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0389570
	speed: 0.0380s/iter; left time: 634.0786s
	iters: 200, epoch: 26 | loss: 0.0388686
	speed: 0.0176s/iter; left time: 292.7746s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0412201 Vali Loss: 0.0509290 Test Loss: 0.0551733
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0415587
	speed: 0.0369s/iter; left time: 607.7228s
	iters: 200, epoch: 27 | loss: 0.0423500
	speed: 0.0197s/iter; left time: 322.9005s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0411406 Vali Loss: 0.0508458 Test Loss: 0.0550130
Validation loss decreased (0.050899 --> 0.050846).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0435844
	speed: 0.0411s/iter; left time: 668.6772s
	iters: 200, epoch: 28 | loss: 0.0385247
	speed: 0.0200s/iter; left time: 322.4600s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0411405 Vali Loss: 0.0508347 Test Loss: 0.0550222
Validation loss decreased (0.050846 --> 0.050835).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0420762
	speed: 0.0368s/iter; left time: 589.5002s
	iters: 200, epoch: 29 | loss: 0.0388678
	speed: 0.0175s/iter; left time: 278.2439s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0411094 Vali Loss: 0.0508880 Test Loss: 0.0549905
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0427229
	speed: 0.0421s/iter; left time: 665.9101s
	iters: 200, epoch: 30 | loss: 0.0388344
	speed: 0.0202s/iter; left time: 317.1304s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.94s
Steps: 224 | Train Loss: 0.0410763 Vali Loss: 0.0508937 Test Loss: 0.0550308
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0407782
	speed: 0.0365s/iter; left time: 568.3944s
	iters: 200, epoch: 31 | loss: 0.0419291
	speed: 0.0195s/iter; left time: 302.0674s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0410766 Vali Loss: 0.0506749 Test Loss: 0.0550058
Validation loss decreased (0.050835 --> 0.050675).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0414399
	speed: 0.0382s/iter; left time: 586.8291s
	iters: 200, epoch: 32 | loss: 0.0421118
	speed: 0.0199s/iter; left time: 303.4446s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0410319 Vali Loss: 0.0507480 Test Loss: 0.0549598
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0422271
	speed: 0.0365s/iter; left time: 552.3449s
	iters: 200, epoch: 33 | loss: 0.0414499
	speed: 0.0175s/iter; left time: 263.3971s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0409737 Vali Loss: 0.0507774 Test Loss: 0.0549851
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0413024
	speed: 0.0361s/iter; left time: 538.2906s
	iters: 200, epoch: 34 | loss: 0.0401151
	speed: 0.0174s/iter; left time: 256.9833s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0409406 Vali Loss: 0.0506703 Test Loss: 0.0549519
Validation loss decreased (0.050675 --> 0.050670).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0408263
	speed: 0.0391s/iter; left time: 574.3639s
	iters: 200, epoch: 35 | loss: 0.0405118
	speed: 0.0176s/iter; left time: 256.1625s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0409528 Vali Loss: 0.0507586 Test Loss: 0.0549365
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0392115
	speed: 0.0370s/iter; left time: 534.8904s
	iters: 200, epoch: 36 | loss: 0.0404948
	speed: 0.0175s/iter; left time: 251.1525s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0409394 Vali Loss: 0.0507388 Test Loss: 0.0549210
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0423826
	speed: 0.0361s/iter; left time: 513.9982s
	iters: 200, epoch: 37 | loss: 0.0399949
	speed: 0.0187s/iter; left time: 264.5065s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0409280 Vali Loss: 0.0507797 Test Loss: 0.0549513
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0420419
	speed: 0.0364s/iter; left time: 509.5619s
	iters: 200, epoch: 38 | loss: 0.0414468
	speed: 0.0180s/iter; left time: 250.4319s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0408825 Vali Loss: 0.0506685 Test Loss: 0.0549180
Validation loss decreased (0.050670 --> 0.050669).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0411821
	speed: 0.0397s/iter; left time: 546.7866s
	iters: 200, epoch: 39 | loss: 0.0366663
	speed: 0.0173s/iter; left time: 236.9769s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0409059 Vali Loss: 0.0507391 Test Loss: 0.0549399
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0391978
	speed: 0.0413s/iter; left time: 560.1932s
	iters: 200, epoch: 40 | loss: 0.0425756
	speed: 0.0195s/iter; left time: 263.0504s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.90s
Steps: 224 | Train Loss: 0.0409207 Vali Loss: 0.0506791 Test Loss: 0.0549067
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0416604
	speed: 0.0367s/iter; left time: 489.4409s
	iters: 200, epoch: 41 | loss: 0.0402725
	speed: 0.0173s/iter; left time: 228.8396s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.06s
Steps: 224 | Train Loss: 0.0408218 Vali Loss: 0.0507860 Test Loss: 0.0549271
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0415616
	speed: 0.0356s/iter; left time: 466.7670s
	iters: 200, epoch: 42 | loss: 0.0426821
	speed: 0.0174s/iter; left time: 226.4421s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0408661 Vali Loss: 0.0506999 Test Loss: 0.0549061
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0412373
	speed: 0.0362s/iter; left time: 466.9375s
	iters: 200, epoch: 43 | loss: 0.0388965
	speed: 0.0175s/iter; left time: 224.2588s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0408737 Vali Loss: 0.0507067 Test Loss: 0.0549184
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0409356
	speed: 0.0366s/iter; left time: 463.4980s
	iters: 200, epoch: 44 | loss: 0.0419919
	speed: 0.0175s/iter; left time: 220.0932s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0407900 Vali Loss: 0.0507195 Test Loss: 0.0548893
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0395876
	speed: 0.0357s/iter; left time: 444.3419s
	iters: 200, epoch: 45 | loss: 0.0424386
	speed: 0.0176s/iter; left time: 217.8826s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0408467 Vali Loss: 0.0507040 Test Loss: 0.0548965
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0400761
	speed: 0.0384s/iter; left time: 468.8836s
	iters: 200, epoch: 46 | loss: 0.0398946
	speed: 0.0200s/iter; left time: 242.1027s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.58s
Steps: 224 | Train Loss: 0.0407960 Vali Loss: 0.0507497 Test Loss: 0.0548866
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0393914
	speed: 0.0370s/iter; left time: 443.4982s
	iters: 200, epoch: 47 | loss: 0.0387283
	speed: 0.0223s/iter; left time: 265.7545s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0408184 Vali Loss: 0.0507020 Test Loss: 0.0548986
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0393765
	speed: 0.0409s/iter; left time: 481.1759s
	iters: 200, epoch: 48 | loss: 0.0420225
	speed: 0.0176s/iter; left time: 205.0290s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0408080 Vali Loss: 0.0507258 Test Loss: 0.0548816
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010047451592981815, rmse:0.10023697465658188, mae:0.05491799861192703, rse:0.3867114782333374
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0935595
	speed: 0.0249s/iter; left time: 554.6922s
	iters: 200, epoch: 1 | loss: 0.0815350
	speed: 0.0238s/iter; left time: 529.2233s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.42s
Steps: 224 | Train Loss: 0.0985673 Vali Loss: 0.0815828 Test Loss: 0.0878835
Validation loss decreased (inf --> 0.081583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0546182
	speed: 0.0405s/iter; left time: 894.5638s
	iters: 200, epoch: 2 | loss: 0.0524375
	speed: 0.0177s/iter; left time: 388.7679s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0564773 Vali Loss: 0.0585265 Test Loss: 0.0620153
Validation loss decreased (0.081583 --> 0.058526).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0516169
	speed: 0.0405s/iter; left time: 883.9750s
	iters: 200, epoch: 3 | loss: 0.0538712
	speed: 0.0176s/iter; left time: 383.7673s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0494922 Vali Loss: 0.0564595 Test Loss: 0.0600532
Validation loss decreased (0.058526 --> 0.056460).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0500758
	speed: 0.0409s/iter; left time: 884.1769s
	iters: 200, epoch: 4 | loss: 0.0470287
	speed: 0.0173s/iter; left time: 372.5298s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0476510 Vali Loss: 0.0550841 Test Loss: 0.0591046
Validation loss decreased (0.056460 --> 0.055084).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0476657
	speed: 0.0393s/iter; left time: 840.3386s
	iters: 200, epoch: 5 | loss: 0.0453900
	speed: 0.0175s/iter; left time: 372.3863s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0462703 Vali Loss: 0.0539240 Test Loss: 0.0578887
Validation loss decreased (0.055084 --> 0.053924).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0436470
	speed: 0.0385s/iter; left time: 815.6399s
	iters: 200, epoch: 6 | loss: 0.0469544
	speed: 0.0179s/iter; left time: 377.9068s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0453504 Vali Loss: 0.0534992 Test Loss: 0.0576763
Validation loss decreased (0.053924 --> 0.053499).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0498019
	speed: 0.0372s/iter; left time: 780.1501s
	iters: 200, epoch: 7 | loss: 0.0435070
	speed: 0.0173s/iter; left time: 361.5620s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0447041 Vali Loss: 0.0528023 Test Loss: 0.0570895
Validation loss decreased (0.053499 --> 0.052802).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0433632
	speed: 0.0385s/iter; left time: 797.2715s
	iters: 200, epoch: 8 | loss: 0.0472117
	speed: 0.0184s/iter; left time: 380.0873s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0442430 Vali Loss: 0.0525080 Test Loss: 0.0565417
Validation loss decreased (0.052802 --> 0.052508).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0442935
	speed: 0.0381s/iter; left time: 780.5073s
	iters: 200, epoch: 9 | loss: 0.0439991
	speed: 0.0181s/iter; left time: 369.4853s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0437869 Vali Loss: 0.0521499 Test Loss: 0.0563267
Validation loss decreased (0.052508 --> 0.052150).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0457982
	speed: 0.0375s/iter; left time: 761.0894s
	iters: 200, epoch: 10 | loss: 0.0451140
	speed: 0.0175s/iter; left time: 354.1754s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0434726 Vali Loss: 0.0523196 Test Loss: 0.0562200
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0418626
	speed: 0.0373s/iter; left time: 747.8968s
	iters: 200, epoch: 11 | loss: 0.0411332
	speed: 0.0176s/iter; left time: 350.3164s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0431422 Vali Loss: 0.0519555 Test Loss: 0.0562363
Validation loss decreased (0.052150 --> 0.051955).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0414568
	speed: 0.0397s/iter; left time: 787.3697s
	iters: 200, epoch: 12 | loss: 0.0442729
	speed: 0.0185s/iter; left time: 365.8385s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.0429151 Vali Loss: 0.0517021 Test Loss: 0.0557212
Validation loss decreased (0.051955 --> 0.051702).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0447191
	speed: 0.0423s/iter; left time: 829.6593s
	iters: 200, epoch: 13 | loss: 0.0452590
	speed: 0.0227s/iter; left time: 443.6820s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0426312 Vali Loss: 0.0516790 Test Loss: 0.0557699
Validation loss decreased (0.051702 --> 0.051679).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0460300
	speed: 0.0378s/iter; left time: 732.2859s
	iters: 200, epoch: 14 | loss: 0.0424465
	speed: 0.0174s/iter; left time: 335.0909s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0424535 Vali Loss: 0.0514955 Test Loss: 0.0555738
Validation loss decreased (0.051679 --> 0.051495).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0425895
	speed: 0.0379s/iter; left time: 725.9930s
	iters: 200, epoch: 15 | loss: 0.0400014
	speed: 0.0199s/iter; left time: 379.4924s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0422823 Vali Loss: 0.0517129 Test Loss: 0.0555978
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0436068
	speed: 0.0389s/iter; left time: 736.5599s
	iters: 200, epoch: 16 | loss: 0.0415642
	speed: 0.0175s/iter; left time: 330.0857s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0421010 Vali Loss: 0.0514501 Test Loss: 0.0553953
Validation loss decreased (0.051495 --> 0.051450).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0403893
	speed: 0.0378s/iter; left time: 707.0198s
	iters: 200, epoch: 17 | loss: 0.0428705
	speed: 0.0175s/iter; left time: 326.4151s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0419437 Vali Loss: 0.0512283 Test Loss: 0.0553973
Validation loss decreased (0.051450 --> 0.051228).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0435594
	speed: 0.0374s/iter; left time: 691.4029s
	iters: 200, epoch: 18 | loss: 0.0430981
	speed: 0.0176s/iter; left time: 323.8830s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0418711 Vali Loss: 0.0511208 Test Loss: 0.0552354
Validation loss decreased (0.051228 --> 0.051121).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0425317
	speed: 0.0388s/iter; left time: 708.5180s
	iters: 200, epoch: 19 | loss: 0.0425620
	speed: 0.0178s/iter; left time: 322.9222s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0417220 Vali Loss: 0.0513766 Test Loss: 0.0552269
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0389410
	speed: 0.0386s/iter; left time: 696.3162s
	iters: 200, epoch: 20 | loss: 0.0418354
	speed: 0.0176s/iter; left time: 316.2799s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0416325 Vali Loss: 0.0510026 Test Loss: 0.0550833
Validation loss decreased (0.051121 --> 0.051003).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0438422
	speed: 0.0370s/iter; left time: 659.7459s
	iters: 200, epoch: 21 | loss: 0.0418498
	speed: 0.0176s/iter; left time: 311.9549s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0415382 Vali Loss: 0.0509244 Test Loss: 0.0550689
Validation loss decreased (0.051003 --> 0.050924).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0414739
	speed: 0.0399s/iter; left time: 701.7967s
	iters: 200, epoch: 22 | loss: 0.0414515
	speed: 0.0176s/iter; left time: 307.1674s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0414551 Vali Loss: 0.0509189 Test Loss: 0.0550239
Validation loss decreased (0.050924 --> 0.050919).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0412667
	speed: 0.0418s/iter; left time: 726.3481s
	iters: 200, epoch: 23 | loss: 0.0385480
	speed: 0.0183s/iter; left time: 316.2179s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.71s
Steps: 224 | Train Loss: 0.0414020 Vali Loss: 0.0509293 Test Loss: 0.0549526
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0404608
	speed: 0.0433s/iter; left time: 742.8594s
	iters: 200, epoch: 24 | loss: 0.0383370
	speed: 0.0182s/iter; left time: 310.0881s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.79s
Steps: 224 | Train Loss: 0.0413754 Vali Loss: 0.0509873 Test Loss: 0.0550544
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0416779
	speed: 0.0377s/iter; left time: 638.7238s
	iters: 200, epoch: 25 | loss: 0.0415474
	speed: 0.0176s/iter; left time: 295.5511s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0412857 Vali Loss: 0.0509787 Test Loss: 0.0549485
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0422339
	speed: 0.0382s/iter; left time: 638.6748s
	iters: 200, epoch: 26 | loss: 0.0430234
	speed: 0.0173s/iter; left time: 287.3618s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0412502 Vali Loss: 0.0510159 Test Loss: 0.0549871
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0391803
	speed: 0.0425s/iter; left time: 699.8363s
	iters: 200, epoch: 27 | loss: 0.0413634
	speed: 0.0215s/iter; left time: 351.6535s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0412082 Vali Loss: 0.0509350 Test Loss: 0.0548990
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0405897
	speed: 0.0418s/iter; left time: 679.4927s
	iters: 200, epoch: 28 | loss: 0.0397338
	speed: 0.0213s/iter; left time: 344.7995s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0411314 Vali Loss: 0.0508925 Test Loss: 0.0549294
Validation loss decreased (0.050919 --> 0.050893).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0437130
	speed: 0.0387s/iter; left time: 619.6992s
	iters: 200, epoch: 29 | loss: 0.0453305
	speed: 0.0173s/iter; left time: 276.2218s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0410808 Vali Loss: 0.0508684 Test Loss: 0.0549480
Validation loss decreased (0.050893 --> 0.050868).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0404034
	speed: 0.0374s/iter; left time: 591.2247s
	iters: 200, epoch: 30 | loss: 0.0408411
	speed: 0.0175s/iter; left time: 274.8780s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0410524 Vali Loss: 0.0508277 Test Loss: 0.0548504
Validation loss decreased (0.050868 --> 0.050828).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0427010
	speed: 0.0380s/iter; left time: 592.4086s
	iters: 200, epoch: 31 | loss: 0.0425292
	speed: 0.0176s/iter; left time: 271.9788s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0410449 Vali Loss: 0.0508885 Test Loss: 0.0548904
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0403372
	speed: 0.0369s/iter; left time: 566.6934s
	iters: 200, epoch: 32 | loss: 0.0405556
	speed: 0.0175s/iter; left time: 266.3821s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0410464 Vali Loss: 0.0508567 Test Loss: 0.0548694
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0431220
	speed: 0.0385s/iter; left time: 582.1933s
	iters: 200, epoch: 33 | loss: 0.0424416
	speed: 0.0190s/iter; left time: 286.1733s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.59s
Steps: 224 | Train Loss: 0.0410148 Vali Loss: 0.0507454 Test Loss: 0.0548886
Validation loss decreased (0.050828 --> 0.050745).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0425253
	speed: 0.0384s/iter; left time: 572.9638s
	iters: 200, epoch: 34 | loss: 0.0445072
	speed: 0.0176s/iter; left time: 260.8919s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0409694 Vali Loss: 0.0507921 Test Loss: 0.0548382
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0386003
	speed: 0.0386s/iter; left time: 567.2513s
	iters: 200, epoch: 35 | loss: 0.0397497
	speed: 0.0178s/iter; left time: 259.6244s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0409914 Vali Loss: 0.0507661 Test Loss: 0.0548480
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0463726
	speed: 0.0379s/iter; left time: 547.6972s
	iters: 200, epoch: 36 | loss: 0.0397050
	speed: 0.0176s/iter; left time: 252.7580s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0409164 Vali Loss: 0.0508233 Test Loss: 0.0548441
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0409133
	speed: 0.0376s/iter; left time: 534.7156s
	iters: 200, epoch: 37 | loss: 0.0423615
	speed: 0.0175s/iter; left time: 247.0466s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0409337 Vali Loss: 0.0508035 Test Loss: 0.0548229
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0406316
	speed: 0.0387s/iter; left time: 542.5981s
	iters: 200, epoch: 38 | loss: 0.0397512
	speed: 0.0189s/iter; left time: 263.6104s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0409042 Vali Loss: 0.0507964 Test Loss: 0.0548444
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0381033
	speed: 0.0399s/iter; left time: 550.0490s
	iters: 200, epoch: 39 | loss: 0.0382526
	speed: 0.0173s/iter; left time: 236.9881s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0409219 Vali Loss: 0.0508203 Test Loss: 0.0548079
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0409601
	speed: 0.0444s/iter; left time: 602.0461s
	iters: 200, epoch: 40 | loss: 0.0414687
	speed: 0.0204s/iter; left time: 274.9994s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0408627 Vali Loss: 0.0507907 Test Loss: 0.0547983
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0436835
	speed: 0.0442s/iter; left time: 590.2730s
	iters: 200, epoch: 41 | loss: 0.0395844
	speed: 0.0205s/iter; left time: 271.4005s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0408995 Vali Loss: 0.0507025 Test Loss: 0.0547880
Validation loss decreased (0.050745 --> 0.050702).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0397279
	speed: 0.0438s/iter; left time: 574.0071s
	iters: 200, epoch: 42 | loss: 0.0432200
	speed: 0.0203s/iter; left time: 264.4095s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408592 Vali Loss: 0.0507363 Test Loss: 0.0547963
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0390139
	speed: 0.0385s/iter; left time: 496.0208s
	iters: 200, epoch: 43 | loss: 0.0416165
	speed: 0.0176s/iter; left time: 225.1180s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0409098 Vali Loss: 0.0507644 Test Loss: 0.0547888
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0394929
	speed: 0.0378s/iter; left time: 478.8054s
	iters: 200, epoch: 44 | loss: 0.0391143
	speed: 0.0177s/iter; left time: 222.2654s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0408876 Vali Loss: 0.0507556 Test Loss: 0.0547861
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0385056
	speed: 0.0373s/iter; left time: 463.8164s
	iters: 200, epoch: 45 | loss: 0.0418280
	speed: 0.0176s/iter; left time: 216.6654s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0408062 Vali Loss: 0.0506480 Test Loss: 0.0547880
Validation loss decreased (0.050702 --> 0.050648).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0404662
	speed: 0.0407s/iter; left time: 496.9452s
	iters: 200, epoch: 46 | loss: 0.0425981
	speed: 0.0212s/iter; left time: 257.3356s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0408597 Vali Loss: 0.0507410 Test Loss: 0.0547948
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0412951
	speed: 0.0371s/iter; left time: 445.5673s
	iters: 200, epoch: 47 | loss: 0.0460205
	speed: 0.0176s/iter; left time: 209.2433s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0408051 Vali Loss: 0.0507380 Test Loss: 0.0547790
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0396187
	speed: 0.0385s/iter; left time: 453.1386s
	iters: 200, epoch: 48 | loss: 0.0420261
	speed: 0.0177s/iter; left time: 206.6512s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0408679 Vali Loss: 0.0508199 Test Loss: 0.0547630
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0402250
	speed: 0.0394s/iter; left time: 455.5809s
	iters: 200, epoch: 49 | loss: 0.0436193
	speed: 0.0194s/iter; left time: 222.1323s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0408469 Vali Loss: 0.0507091 Test Loss: 0.0547697
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0362207
	speed: 0.0371s/iter; left time: 420.3064s
	iters: 200, epoch: 50 | loss: 0.0385387
	speed: 0.0175s/iter; left time: 196.0646s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0408548 Vali Loss: 0.0506502 Test Loss: 0.0547767
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0440735
	speed: 0.0385s/iter; left time: 427.6925s
	iters: 200, epoch: 51 | loss: 0.0387501
	speed: 0.0181s/iter; left time: 199.0820s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0408112 Vali Loss: 0.0507077 Test Loss: 0.0547609
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0404372
	speed: 0.0432s/iter; left time: 470.1337s
	iters: 200, epoch: 52 | loss: 0.0423694
	speed: 0.0177s/iter; left time: 190.5553s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0408257 Vali Loss: 0.0507446 Test Loss: 0.0547665
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0421164
	speed: 0.0409s/iter; left time: 435.6301s
	iters: 200, epoch: 53 | loss: 0.0415824
	speed: 0.0186s/iter; left time: 196.3912s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0408422 Vali Loss: 0.0507633 Test Loss: 0.0547696
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0443786
	speed: 0.0368s/iter; left time: 383.9620s
	iters: 200, epoch: 54 | loss: 0.0391313
	speed: 0.0175s/iter; left time: 181.2720s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0408320 Vali Loss: 0.0507100 Test Loss: 0.0547600
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0417649
	speed: 0.0400s/iter; left time: 408.2279s
	iters: 200, epoch: 55 | loss: 0.0409617
	speed: 0.0212s/iter; left time: 214.4113s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408236 Vali Loss: 0.0506238 Test Loss: 0.0547631
Validation loss decreased (0.050648 --> 0.050624).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0360162
	speed: 0.0393s/iter; left time: 392.0179s
	iters: 200, epoch: 56 | loss: 0.0408644
	speed: 0.0177s/iter; left time: 174.4649s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0407994 Vali Loss: 0.0507128 Test Loss: 0.0547610
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0406955
	speed: 0.0369s/iter; left time: 359.5597s
	iters: 200, epoch: 57 | loss: 0.0420306
	speed: 0.0176s/iter; left time: 170.1307s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0408128 Vali Loss: 0.0507455 Test Loss: 0.0547706
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0457876
	speed: 0.0364s/iter; left time: 346.5785s
	iters: 200, epoch: 58 | loss: 0.0406639
	speed: 0.0176s/iter; left time: 166.1503s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.13s
Steps: 224 | Train Loss: 0.0408230 Vali Loss: 0.0506479 Test Loss: 0.0547651
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0408023
	speed: 0.0401s/iter; left time: 373.1203s
	iters: 200, epoch: 59 | loss: 0.0427719
	speed: 0.0178s/iter; left time: 163.6327s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0407709 Vali Loss: 0.0507367 Test Loss: 0.0547671
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0425067
	speed: 0.0369s/iter; left time: 335.6411s
	iters: 200, epoch: 60 | loss: 0.0396171
	speed: 0.0190s/iter; left time: 170.8104s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0408547 Vali Loss: 0.0507473 Test Loss: 0.0547641
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0417092
	speed: 0.0435s/iter; left time: 385.4814s
	iters: 200, epoch: 61 | loss: 0.0407552
	speed: 0.0225s/iter; left time: 196.9673s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0408172 Vali Loss: 0.0507417 Test Loss: 0.0547586
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0394446
	speed: 0.0441s/iter; left time: 380.7387s
	iters: 200, epoch: 62 | loss: 0.0394354
	speed: 0.0205s/iter; left time: 174.7707s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0408144 Vali Loss: 0.0506968 Test Loss: 0.0547682
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0409796
	speed: 0.0377s/iter; left time: 316.9350s
	iters: 200, epoch: 63 | loss: 0.0429062
	speed: 0.0180s/iter; left time: 149.5647s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0408127 Vali Loss: 0.0507607 Test Loss: 0.0547640
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0448329
	speed: 0.0409s/iter; left time: 334.5994s
	iters: 200, epoch: 64 | loss: 0.0424715
	speed: 0.0195s/iter; left time: 157.3831s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0408103 Vali Loss: 0.0507010 Test Loss: 0.0547563
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0428965
	speed: 0.0388s/iter; left time: 309.0573s
	iters: 200, epoch: 65 | loss: 0.0406603
	speed: 0.0200s/iter; left time: 156.9265s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0407825 Vali Loss: 0.0506624 Test Loss: 0.0547556
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009938369505107403, rmse:0.09969136863946915, mae:0.05476314201951027, rse:0.3846065402030945
Intermediate time for FR and pred_len 24: 00h:11m:01.97s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0980609
	speed: 0.0442s/iter; left time: 986.0843s
	iters: 200, epoch: 1 | loss: 0.0871001
	speed: 0.0176s/iter; left time: 391.0175s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.1031007 Vali Loss: 0.0901211 Test Loss: 0.0987843
Validation loss decreased (inf --> 0.090121).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0744202
	speed: 0.0399s/iter; left time: 880.2678s
	iters: 200, epoch: 2 | loss: 0.0627046
	speed: 0.0176s/iter; left time: 387.0866s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0707878 Vali Loss: 0.0750685 Test Loss: 0.0840957
Validation loss decreased (0.090121 --> 0.075069).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0646639
	speed: 0.0380s/iter; left time: 829.7925s
	iters: 200, epoch: 3 | loss: 0.0631343
	speed: 0.0185s/iter; left time: 403.3209s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0642391 Vali Loss: 0.0723593 Test Loss: 0.0822695
Validation loss decreased (0.075069 --> 0.072359).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0610678
	speed: 0.0388s/iter; left time: 838.9979s
	iters: 200, epoch: 4 | loss: 0.0642769
	speed: 0.0196s/iter; left time: 421.1363s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0623806 Vali Loss: 0.0713594 Test Loss: 0.0812874
Validation loss decreased (0.072359 --> 0.071359).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0621786
	speed: 0.0390s/iter; left time: 835.2215s
	iters: 200, epoch: 5 | loss: 0.0588774
	speed: 0.0199s/iter; left time: 424.5958s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.53s
Steps: 224 | Train Loss: 0.0612256 Vali Loss: 0.0713809 Test Loss: 0.0812414
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0647122
	speed: 0.0367s/iter; left time: 776.4822s
	iters: 200, epoch: 6 | loss: 0.0587326
	speed: 0.0176s/iter; left time: 371.3184s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0604238 Vali Loss: 0.0708679 Test Loss: 0.0803343
Validation loss decreased (0.071359 --> 0.070868).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0619604
	speed: 0.0379s/iter; left time: 793.8591s
	iters: 200, epoch: 7 | loss: 0.0573329
	speed: 0.0176s/iter; left time: 367.0075s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0597714 Vali Loss: 0.0706334 Test Loss: 0.0803544
Validation loss decreased (0.070868 --> 0.070633).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0618974
	speed: 0.0390s/iter; left time: 809.4536s
	iters: 200, epoch: 8 | loss: 0.0577334
	speed: 0.0230s/iter; left time: 475.4334s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0593515 Vali Loss: 0.0705784 Test Loss: 0.0799828
Validation loss decreased (0.070633 --> 0.070578).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0578773
	speed: 0.0423s/iter; left time: 866.8690s
	iters: 200, epoch: 9 | loss: 0.0587067
	speed: 0.0201s/iter; left time: 411.0614s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0589615 Vali Loss: 0.0703924 Test Loss: 0.0804243
Validation loss decreased (0.070578 --> 0.070392).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0590116
	speed: 0.0401s/iter; left time: 813.8909s
	iters: 200, epoch: 10 | loss: 0.0577656
	speed: 0.0204s/iter; left time: 410.9379s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.70s
Steps: 224 | Train Loss: 0.0585875 Vali Loss: 0.0701964 Test Loss: 0.0800692
Validation loss decreased (0.070392 --> 0.070196).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0595273
	speed: 0.0388s/iter; left time: 777.9013s
	iters: 200, epoch: 11 | loss: 0.0568395
	speed: 0.0190s/iter; left time: 379.8367s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0582978 Vali Loss: 0.0700665 Test Loss: 0.0801848
Validation loss decreased (0.070196 --> 0.070066).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0578398
	speed: 0.0400s/iter; left time: 792.9082s
	iters: 200, epoch: 12 | loss: 0.0565718
	speed: 0.0179s/iter; left time: 352.3343s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0580421 Vali Loss: 0.0702680 Test Loss: 0.0803339
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0582126
	speed: 0.0399s/iter; left time: 783.3161s
	iters: 200, epoch: 13 | loss: 0.0575784
	speed: 0.0212s/iter; left time: 414.4235s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0577998 Vali Loss: 0.0704259 Test Loss: 0.0806946
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0567649
	speed: 0.0372s/iter; left time: 721.7618s
	iters: 200, epoch: 14 | loss: 0.0573596
	speed: 0.0178s/iter; left time: 342.9793s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0575422 Vali Loss: 0.0701961 Test Loss: 0.0797991
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0537720
	speed: 0.0373s/iter; left time: 714.3229s
	iters: 200, epoch: 15 | loss: 0.0601896
	speed: 0.0177s/iter; left time: 338.0865s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0573678 Vali Loss: 0.0700427 Test Loss: 0.0800929
Validation loss decreased (0.070066 --> 0.070043).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0578917
	speed: 0.0399s/iter; left time: 756.3327s
	iters: 200, epoch: 16 | loss: 0.0594120
	speed: 0.0189s/iter; left time: 355.4911s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0571036 Vali Loss: 0.0701092 Test Loss: 0.0802814
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0561508
	speed: 0.0362s/iter; left time: 677.5379s
	iters: 200, epoch: 17 | loss: 0.0588087
	speed: 0.0178s/iter; left time: 330.7245s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0569985 Vali Loss: 0.0697514 Test Loss: 0.0801798
Validation loss decreased (0.070043 --> 0.069751).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0570127
	speed: 0.0401s/iter; left time: 741.0149s
	iters: 200, epoch: 18 | loss: 0.0550547
	speed: 0.0204s/iter; left time: 374.4843s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.81s
Steps: 224 | Train Loss: 0.0568377 Vali Loss: 0.0700514 Test Loss: 0.0800432
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0599390
	speed: 0.0424s/iter; left time: 773.9867s
	iters: 200, epoch: 19 | loss: 0.0592506
	speed: 0.0201s/iter; left time: 365.6997s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.87s
Steps: 224 | Train Loss: 0.0566340 Vali Loss: 0.0700143 Test Loss: 0.0800947
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0555497
	speed: 0.0402s/iter; left time: 725.6980s
	iters: 200, epoch: 20 | loss: 0.0594845
	speed: 0.0177s/iter; left time: 317.6250s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0565479 Vali Loss: 0.0699431 Test Loss: 0.0799722
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0595895
	speed: 0.0426s/iter; left time: 758.6109s
	iters: 200, epoch: 21 | loss: 0.0514547
	speed: 0.0180s/iter; left time: 319.0180s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0564134 Vali Loss: 0.0699077 Test Loss: 0.0799024
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0577438
	speed: 0.0406s/iter; left time: 713.9933s
	iters: 200, epoch: 22 | loss: 0.0570781
	speed: 0.0180s/iter; left time: 315.6405s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0562344 Vali Loss: 0.0699412 Test Loss: 0.0799161
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0543055
	speed: 0.0374s/iter; left time: 650.0469s
	iters: 200, epoch: 23 | loss: 0.0568372
	speed: 0.0178s/iter; left time: 307.3187s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0561991 Vali Loss: 0.0698163 Test Loss: 0.0800117
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0562022
	speed: 0.0401s/iter; left time: 687.3905s
	iters: 200, epoch: 24 | loss: 0.0531656
	speed: 0.0196s/iter; left time: 334.9960s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0560687 Vali Loss: 0.0699291 Test Loss: 0.0799469
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0552870
	speed: 0.0384s/iter; left time: 650.0462s
	iters: 200, epoch: 25 | loss: 0.0552926
	speed: 0.0192s/iter; left time: 322.8322s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0560483 Vali Loss: 0.0698628 Test Loss: 0.0803341
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0539591
	speed: 0.0398s/iter; left time: 663.8899s
	iters: 200, epoch: 26 | loss: 0.0611918
	speed: 0.0195s/iter; left time: 323.2439s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.68s
Steps: 224 | Train Loss: 0.0559247 Vali Loss: 0.0697493 Test Loss: 0.0802485
Validation loss decreased (0.069751 --> 0.069749).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0552940
	speed: 0.0390s/iter; left time: 643.2036s
	iters: 200, epoch: 27 | loss: 0.0568207
	speed: 0.0177s/iter; left time: 290.2654s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0558538 Vali Loss: 0.0698645 Test Loss: 0.0802962
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0553827
	speed: 0.0366s/iter; left time: 595.1012s
	iters: 200, epoch: 28 | loss: 0.0563543
	speed: 0.0176s/iter; left time: 283.8304s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0558139 Vali Loss: 0.0699737 Test Loss: 0.0799117
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0549611
	speed: 0.0382s/iter; left time: 612.8983s
	iters: 200, epoch: 29 | loss: 0.0588496
	speed: 0.0220s/iter; left time: 350.8882s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.75s
Steps: 224 | Train Loss: 0.0557804 Vali Loss: 0.0698076 Test Loss: 0.0803077
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0569736
	speed: 0.0406s/iter; left time: 642.2532s
	iters: 200, epoch: 30 | loss: 0.0523944
	speed: 0.0191s/iter; left time: 300.5794s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0556698 Vali Loss: 0.0699552 Test Loss: 0.0799103
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0591903
	speed: 0.0438s/iter; left time: 682.9421s
	iters: 200, epoch: 31 | loss: 0.0563744
	speed: 0.0195s/iter; left time: 302.0995s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0557028 Vali Loss: 0.0698280 Test Loss: 0.0799427
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0564075
	speed: 0.0367s/iter; left time: 563.8824s
	iters: 200, epoch: 32 | loss: 0.0564259
	speed: 0.0178s/iter; left time: 271.1206s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0556475 Vali Loss: 0.0699557 Test Loss: 0.0800001
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0571123
	speed: 0.0371s/iter; left time: 561.7987s
	iters: 200, epoch: 33 | loss: 0.0562876
	speed: 0.0178s/iter; left time: 267.4506s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0555754 Vali Loss: 0.0698408 Test Loss: 0.0799727
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0549147
	speed: 0.0368s/iter; left time: 549.0334s
	iters: 200, epoch: 34 | loss: 0.0569688
	speed: 0.0176s/iter; left time: 260.6367s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0555628 Vali Loss: 0.0698081 Test Loss: 0.0801774
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0539672
	speed: 0.0394s/iter; left time: 577.9793s
	iters: 200, epoch: 35 | loss: 0.0568721
	speed: 0.0178s/iter; left time: 259.0305s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0555678 Vali Loss: 0.0698511 Test Loss: 0.0800220
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0555374
	speed: 0.0413s/iter; left time: 596.6173s
	iters: 200, epoch: 36 | loss: 0.0540787
	speed: 0.0202s/iter; left time: 289.5297s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0554807 Vali Loss: 0.0698264 Test Loss: 0.0801089
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019129442051053047, rmse:0.13830922544002533, mae:0.08024851232767105, rse:0.5350168347358704
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0993653
	speed: 0.0221s/iter; left time: 493.6278s
	iters: 200, epoch: 1 | loss: 0.0925130
	speed: 0.0200s/iter; left time: 443.9665s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.1028261 Vali Loss: 0.0896393 Test Loss: 0.0984749
Validation loss decreased (inf --> 0.089639).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0716707
	speed: 0.0402s/iter; left time: 888.0405s
	iters: 200, epoch: 2 | loss: 0.0649474
	speed: 0.0206s/iter; left time: 452.4188s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.65s
Steps: 224 | Train Loss: 0.0706721 Vali Loss: 0.0753703 Test Loss: 0.0839644
Validation loss decreased (0.089639 --> 0.075370).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0619266
	speed: 0.0440s/iter; left time: 960.5970s
	iters: 200, epoch: 3 | loss: 0.0610446
	speed: 0.0202s/iter; left time: 438.9716s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0645758 Vali Loss: 0.0726078 Test Loss: 0.0825484
Validation loss decreased (0.075370 --> 0.072608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0586112
	speed: 0.0396s/iter; left time: 856.5662s
	iters: 200, epoch: 4 | loss: 0.0566655
	speed: 0.0199s/iter; left time: 429.0625s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0626355 Vali Loss: 0.0717694 Test Loss: 0.0815929
Validation loss decreased (0.072608 --> 0.071769).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0629928
	speed: 0.0434s/iter; left time: 928.5031s
	iters: 200, epoch: 5 | loss: 0.0631500
	speed: 0.0198s/iter; left time: 421.4720s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.88s
Steps: 224 | Train Loss: 0.0614584 Vali Loss: 0.0710907 Test Loss: 0.0806131
Validation loss decreased (0.071769 --> 0.071091).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0608282
	speed: 0.0438s/iter; left time: 928.3181s
	iters: 200, epoch: 6 | loss: 0.0621219
	speed: 0.0202s/iter; left time: 425.8708s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0605699 Vali Loss: 0.0708390 Test Loss: 0.0803163
Validation loss decreased (0.071091 --> 0.070839).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0545628
	speed: 0.0392s/iter; left time: 820.7465s
	iters: 200, epoch: 7 | loss: 0.0594872
	speed: 0.0180s/iter; left time: 375.5826s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0599846 Vali Loss: 0.0707349 Test Loss: 0.0810065
Validation loss decreased (0.070839 --> 0.070735).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0596696
	speed: 0.0429s/iter; left time: 889.9808s
	iters: 200, epoch: 8 | loss: 0.0551469
	speed: 0.0199s/iter; left time: 409.7692s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0594251 Vali Loss: 0.0704187 Test Loss: 0.0808286
Validation loss decreased (0.070735 --> 0.070419).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0601396
	speed: 0.0434s/iter; left time: 889.6753s
	iters: 200, epoch: 9 | loss: 0.0632646
	speed: 0.0244s/iter; left time: 497.9582s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.53s
Steps: 224 | Train Loss: 0.0589964 Vali Loss: 0.0704514 Test Loss: 0.0805737
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0605195
	speed: 0.0416s/iter; left time: 844.5786s
	iters: 200, epoch: 10 | loss: 0.0591787
	speed: 0.0232s/iter; left time: 467.5303s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0585768 Vali Loss: 0.0702656 Test Loss: 0.0809564
Validation loss decreased (0.070419 --> 0.070266).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0585001
	speed: 0.0410s/iter; left time: 822.7208s
	iters: 200, epoch: 11 | loss: 0.0562668
	speed: 0.0186s/iter; left time: 371.3650s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.47s
Steps: 224 | Train Loss: 0.0582614 Vali Loss: 0.0702181 Test Loss: 0.0812004
Validation loss decreased (0.070266 --> 0.070218).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0563077
	speed: 0.0414s/iter; left time: 821.1961s
	iters: 200, epoch: 12 | loss: 0.0616315
	speed: 0.0200s/iter; left time: 395.3603s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0579842 Vali Loss: 0.0700841 Test Loss: 0.0812889
Validation loss decreased (0.070218 --> 0.070084).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0610500
	speed: 0.0430s/iter; left time: 843.5268s
	iters: 200, epoch: 13 | loss: 0.0572273
	speed: 0.0196s/iter; left time: 381.9439s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0576614 Vali Loss: 0.0702207 Test Loss: 0.0815973
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0575464
	speed: 0.0443s/iter; left time: 859.2950s
	iters: 200, epoch: 14 | loss: 0.0597506
	speed: 0.0186s/iter; left time: 359.4968s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0574103 Vali Loss: 0.0701746 Test Loss: 0.0815515
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0539393
	speed: 0.0410s/iter; left time: 785.1048s
	iters: 200, epoch: 15 | loss: 0.0575244
	speed: 0.0180s/iter; left time: 343.9889s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0571507 Vali Loss: 0.0700377 Test Loss: 0.0809218
Validation loss decreased (0.070084 --> 0.070038).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0552823
	speed: 0.0431s/iter; left time: 816.5003s
	iters: 200, epoch: 16 | loss: 0.0567672
	speed: 0.0242s/iter; left time: 456.1389s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.43s
Steps: 224 | Train Loss: 0.0569635 Vali Loss: 0.0699133 Test Loss: 0.0814106
Validation loss decreased (0.070038 --> 0.069913).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0533414
	speed: 0.0426s/iter; left time: 796.9191s
	iters: 200, epoch: 17 | loss: 0.0565612
	speed: 0.0203s/iter; left time: 377.1473s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0567306 Vali Loss: 0.0700455 Test Loss: 0.0815984
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0608345
	speed: 0.0403s/iter; left time: 745.6117s
	iters: 200, epoch: 18 | loss: 0.0592519
	speed: 0.0183s/iter; left time: 335.8144s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0566090 Vali Loss: 0.0699562 Test Loss: 0.0814214
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0590397
	speed: 0.0403s/iter; left time: 735.9679s
	iters: 200, epoch: 19 | loss: 0.0541783
	speed: 0.0202s/iter; left time: 367.6942s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0564276 Vali Loss: 0.0701004 Test Loss: 0.0813950
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0572432
	speed: 0.0412s/iter; left time: 742.9460s
	iters: 200, epoch: 20 | loss: 0.0551385
	speed: 0.0200s/iter; left time: 358.4512s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0562702 Vali Loss: 0.0701160 Test Loss: 0.0818849
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0536732
	speed: 0.0392s/iter; left time: 698.7143s
	iters: 200, epoch: 21 | loss: 0.0556528
	speed: 0.0213s/iter; left time: 378.0601s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0561357 Vali Loss: 0.0701280 Test Loss: 0.0817430
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0569166
	speed: 0.0418s/iter; left time: 734.7146s
	iters: 200, epoch: 22 | loss: 0.0534606
	speed: 0.0236s/iter; left time: 413.4644s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0559808 Vali Loss: 0.0702114 Test Loss: 0.0819262
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0560534
	speed: 0.0420s/iter; left time: 729.4056s
	iters: 200, epoch: 23 | loss: 0.0574485
	speed: 0.0224s/iter; left time: 386.9872s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0559322 Vali Loss: 0.0700866 Test Loss: 0.0819694
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0585243
	speed: 0.0422s/iter; left time: 724.4744s
	iters: 200, epoch: 24 | loss: 0.0549269
	speed: 0.0235s/iter; left time: 400.1306s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.0557595 Vali Loss: 0.0701298 Test Loss: 0.0818227
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0532516
	speed: 0.0463s/iter; left time: 783.6475s
	iters: 200, epoch: 25 | loss: 0.0586018
	speed: 0.0249s/iter; left time: 419.5715s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.84s
Steps: 224 | Train Loss: 0.0557496 Vali Loss: 0.0702347 Test Loss: 0.0820146
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0552508
	speed: 0.0463s/iter; left time: 772.7935s
	iters: 200, epoch: 26 | loss: 0.0518143
	speed: 0.0206s/iter; left time: 342.7141s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0555888 Vali Loss: 0.0702477 Test Loss: 0.0821850
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019507648423314095, rmse:0.13966979086399078, mae:0.08141053467988968, rse:0.5402798652648926
Intermediate time for FR and pred_len 96: 00h:06m:24.65s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1048215
	speed: 0.0448s/iter; left time: 993.6942s
	iters: 200, epoch: 1 | loss: 0.0905720
	speed: 0.0178s/iter; left time: 393.7356s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.1048050 Vali Loss: 0.0926501 Test Loss: 0.1004419
Validation loss decreased (inf --> 0.092650).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0787801
	speed: 0.0392s/iter; left time: 860.8228s
	iters: 200, epoch: 2 | loss: 0.0704006
	speed: 0.0178s/iter; left time: 390.3705s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0745573 Vali Loss: 0.0786099 Test Loss: 0.0878751
Validation loss decreased (0.092650 --> 0.078610).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0726460
	speed: 0.0391s/iter; left time: 849.8043s
	iters: 200, epoch: 3 | loss: 0.0645619
	speed: 0.0178s/iter; left time: 386.1332s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0679619 Vali Loss: 0.0757840 Test Loss: 0.0871083
Validation loss decreased (0.078610 --> 0.075784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0659405
	speed: 0.0392s/iter; left time: 844.1832s
	iters: 200, epoch: 4 | loss: 0.0691877
	speed: 0.0180s/iter; left time: 385.7610s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0661932 Vali Loss: 0.0753940 Test Loss: 0.0867535
Validation loss decreased (0.075784 --> 0.075394).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0673685
	speed: 0.0386s/iter; left time: 823.0725s
	iters: 200, epoch: 5 | loss: 0.0653306
	speed: 0.0184s/iter; left time: 390.6419s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0651771 Vali Loss: 0.0749387 Test Loss: 0.0866767
Validation loss decreased (0.075394 --> 0.074939).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0621401
	speed: 0.0391s/iter; left time: 825.2142s
	iters: 200, epoch: 6 | loss: 0.0653071
	speed: 0.0183s/iter; left time: 385.0335s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0644035 Vali Loss: 0.0745415 Test Loss: 0.0861986
Validation loss decreased (0.074939 --> 0.074541).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0668753
	speed: 0.0396s/iter; left time: 826.2922s
	iters: 200, epoch: 7 | loss: 0.0647811
	speed: 0.0181s/iter; left time: 376.4558s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0638201 Vali Loss: 0.0746210 Test Loss: 0.0858707
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0590196
	speed: 0.0405s/iter; left time: 835.0479s
	iters: 200, epoch: 8 | loss: 0.0675284
	speed: 0.0182s/iter; left time: 374.3421s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0633939 Vali Loss: 0.0744509 Test Loss: 0.0864062
Validation loss decreased (0.074541 --> 0.074451).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0666170
	speed: 0.0394s/iter; left time: 805.2458s
	iters: 200, epoch: 9 | loss: 0.0584317
	speed: 0.0178s/iter; left time: 360.9212s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0629750 Vali Loss: 0.0741344 Test Loss: 0.0858306
Validation loss decreased (0.074451 --> 0.074134).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0615673
	speed: 0.0384s/iter; left time: 775.9894s
	iters: 200, epoch: 10 | loss: 0.0612158
	speed: 0.0178s/iter; left time: 357.7110s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.19s
Steps: 223 | Train Loss: 0.0626131 Vali Loss: 0.0743963 Test Loss: 0.0868935
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0669771
	speed: 0.0389s/iter; left time: 776.3254s
	iters: 200, epoch: 11 | loss: 0.0583333
	speed: 0.0182s/iter; left time: 360.8506s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.32s
Steps: 223 | Train Loss: 0.0622680 Vali Loss: 0.0740912 Test Loss: 0.0864191
Validation loss decreased (0.074134 --> 0.074091).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0600857
	speed: 0.0398s/iter; left time: 785.8133s
	iters: 200, epoch: 12 | loss: 0.0624289
	speed: 0.0182s/iter; left time: 357.3477s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0620072 Vali Loss: 0.0738088 Test Loss: 0.0868813
Validation loss decreased (0.074091 --> 0.073809).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0633508
	speed: 0.0382s/iter; left time: 746.2036s
	iters: 200, epoch: 13 | loss: 0.0622426
	speed: 0.0177s/iter; left time: 344.4771s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0617034 Vali Loss: 0.0738194 Test Loss: 0.0859601
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0624652
	speed: 0.0432s/iter; left time: 833.1308s
	iters: 200, epoch: 14 | loss: 0.0640134
	speed: 0.0223s/iter; left time: 428.7406s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0614224 Vali Loss: 0.0735637 Test Loss: 0.0866766
Validation loss decreased (0.073809 --> 0.073564).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0592811
	speed: 0.0412s/iter; left time: 786.3647s
	iters: 200, epoch: 15 | loss: 0.0659775
	speed: 0.0198s/iter; left time: 375.3016s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.71s
Steps: 223 | Train Loss: 0.0612476 Vali Loss: 0.0735167 Test Loss: 0.0868006
Validation loss decreased (0.073564 --> 0.073517).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0644561
	speed: 0.0412s/iter; left time: 777.3279s
	iters: 200, epoch: 16 | loss: 0.0619274
	speed: 0.0179s/iter; left time: 336.3052s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0610197 Vali Loss: 0.0734734 Test Loss: 0.0862646
Validation loss decreased (0.073517 --> 0.073473).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0604587
	speed: 0.0385s/iter; left time: 717.5171s
	iters: 200, epoch: 17 | loss: 0.0619207
	speed: 0.0182s/iter; left time: 337.1800s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0608512 Vali Loss: 0.0734382 Test Loss: 0.0864064
Validation loss decreased (0.073473 --> 0.073438).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0621410
	speed: 0.0444s/iter; left time: 816.7679s
	iters: 200, epoch: 18 | loss: 0.0610293
	speed: 0.0209s/iter; left time: 382.2176s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.98s
Steps: 223 | Train Loss: 0.0606406 Vali Loss: 0.0735055 Test Loss: 0.0865836
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0594858
	speed: 0.0395s/iter; left time: 717.9466s
	iters: 200, epoch: 19 | loss: 0.0603400
	speed: 0.0225s/iter; left time: 407.7429s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.96s
Steps: 223 | Train Loss: 0.0604943 Vali Loss: 0.0733934 Test Loss: 0.0866218
Validation loss decreased (0.073438 --> 0.073393).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0621189
	speed: 0.0405s/iter; left time: 726.9494s
	iters: 200, epoch: 20 | loss: 0.0579614
	speed: 0.0179s/iter; left time: 320.4131s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0603450 Vali Loss: 0.0734274 Test Loss: 0.0866431
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0576071
	speed: 0.0397s/iter; left time: 705.1230s
	iters: 200, epoch: 21 | loss: 0.0587716
	speed: 0.0182s/iter; left time: 320.4938s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0602134 Vali Loss: 0.0735609 Test Loss: 0.0867124
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0592390
	speed: 0.0411s/iter; left time: 719.6329s
	iters: 200, epoch: 22 | loss: 0.0672747
	speed: 0.0205s/iter; left time: 357.9042s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.80s
Steps: 223 | Train Loss: 0.0601358 Vali Loss: 0.0734848 Test Loss: 0.0864877
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0589457
	speed: 0.0420s/iter; left time: 727.1040s
	iters: 200, epoch: 23 | loss: 0.0600802
	speed: 0.0195s/iter; left time: 334.9906s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.67s
Steps: 223 | Train Loss: 0.0600169 Vali Loss: 0.0735971 Test Loss: 0.0867336
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0622105
	speed: 0.0390s/iter; left time: 665.8311s
	iters: 200, epoch: 24 | loss: 0.0587972
	speed: 0.0185s/iter; left time: 314.6196s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0599399 Vali Loss: 0.0733272 Test Loss: 0.0868346
Validation loss decreased (0.073393 --> 0.073327).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0618487
	speed: 0.0408s/iter; left time: 686.9191s
	iters: 200, epoch: 25 | loss: 0.0623286
	speed: 0.0199s/iter; left time: 332.7939s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.66s
Steps: 223 | Train Loss: 0.0598832 Vali Loss: 0.0733698 Test Loss: 0.0870481
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0628185
	speed: 0.0403s/iter; left time: 669.1997s
	iters: 200, epoch: 26 | loss: 0.0600777
	speed: 0.0178s/iter; left time: 294.5353s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0597476 Vali Loss: 0.0735480 Test Loss: 0.0870731
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0584035
	speed: 0.0386s/iter; left time: 633.3759s
	iters: 200, epoch: 27 | loss: 0.0596758
	speed: 0.0178s/iter; left time: 290.3919s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0597152 Vali Loss: 0.0735673 Test Loss: 0.0869513
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0575937
	speed: 0.0411s/iter; left time: 664.7704s
	iters: 200, epoch: 28 | loss: 0.0598191
	speed: 0.0194s/iter; left time: 311.1870s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0596151 Vali Loss: 0.0735890 Test Loss: 0.0869191
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0602850
	speed: 0.0385s/iter; left time: 614.2782s
	iters: 200, epoch: 29 | loss: 0.0603580
	speed: 0.0199s/iter; left time: 315.1132s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.55s
Steps: 223 | Train Loss: 0.0595701 Vali Loss: 0.0735271 Test Loss: 0.0868389
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0609483
	speed: 0.0398s/iter; left time: 625.4291s
	iters: 200, epoch: 30 | loss: 0.0605431
	speed: 0.0178s/iter; left time: 277.8173s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0595073 Vali Loss: 0.0735774 Test Loss: 0.0868500
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0565855
	speed: 0.0380s/iter; left time: 588.8619s
	iters: 200, epoch: 31 | loss: 0.0568368
	speed: 0.0178s/iter; left time: 273.7322s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.18s
Steps: 223 | Train Loss: 0.0594662 Vali Loss: 0.0736190 Test Loss: 0.0867959
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0585387
	speed: 0.0384s/iter; left time: 586.9124s
	iters: 200, epoch: 32 | loss: 0.0621870
	speed: 0.0179s/iter; left time: 271.9392s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0594207 Vali Loss: 0.0734954 Test Loss: 0.0867695
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0560987
	speed: 0.0403s/iter; left time: 607.2936s
	iters: 200, epoch: 33 | loss: 0.0594956
	speed: 0.0179s/iter; left time: 267.6390s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.39s
Steps: 223 | Train Loss: 0.0594061 Vali Loss: 0.0736040 Test Loss: 0.0867877
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0592257
	speed: 0.0398s/iter; left time: 590.9892s
	iters: 200, epoch: 34 | loss: 0.0612799
	speed: 0.0178s/iter; left time: 262.3133s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.39s
Steps: 223 | Train Loss: 0.0593490 Vali Loss: 0.0734889 Test Loss: 0.0869637
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021609371528029442, rmse:0.1470012664794922, mae:0.08683455735445023, rse:0.5693498253822327
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1029223
	speed: 0.0243s/iter; left time: 539.9811s
	iters: 200, epoch: 1 | loss: 0.0873014
	speed: 0.0203s/iter; left time: 449.2947s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.92s
Steps: 223 | Train Loss: 0.1060672 Vali Loss: 0.0924755 Test Loss: 0.1004355
Validation loss decreased (inf --> 0.092476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0753753
	speed: 0.0444s/iter; left time: 975.9962s
	iters: 200, epoch: 2 | loss: 0.0723152
	speed: 0.0240s/iter; left time: 525.7381s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.39s
Steps: 223 | Train Loss: 0.0746971 Vali Loss: 0.0789733 Test Loss: 0.0883853
Validation loss decreased (0.092476 --> 0.078973).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0749349
	speed: 0.0390s/iter; left time: 849.2280s
	iters: 200, epoch: 3 | loss: 0.0635487
	speed: 0.0181s/iter; left time: 391.4716s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.37s
Steps: 223 | Train Loss: 0.0682782 Vali Loss: 0.0764451 Test Loss: 0.0874010
Validation loss decreased (0.078973 --> 0.076445).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0650547
	speed: 0.0431s/iter; left time: 927.6328s
	iters: 200, epoch: 4 | loss: 0.0675071
	speed: 0.0189s/iter; left time: 404.4159s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0665174 Vali Loss: 0.0751456 Test Loss: 0.0865133
Validation loss decreased (0.076445 --> 0.075146).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0633389
	speed: 0.0399s/iter; left time: 850.2645s
	iters: 200, epoch: 5 | loss: 0.0628508
	speed: 0.0180s/iter; left time: 380.7167s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0653938 Vali Loss: 0.0750249 Test Loss: 0.0866540
Validation loss decreased (0.075146 --> 0.075025).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0610570
	speed: 0.0435s/iter; left time: 916.2526s
	iters: 200, epoch: 6 | loss: 0.0691948
	speed: 0.0227s/iter; left time: 476.3341s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0645714 Vali Loss: 0.0748224 Test Loss: 0.0866774
Validation loss decreased (0.075025 --> 0.074822).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0635364
	speed: 0.0438s/iter; left time: 913.4307s
	iters: 200, epoch: 7 | loss: 0.0676383
	speed: 0.0196s/iter; left time: 405.9342s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.67s
Steps: 223 | Train Loss: 0.0640450 Vali Loss: 0.0747084 Test Loss: 0.0860682
Validation loss decreased (0.074822 --> 0.074708).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0642655
	speed: 0.0433s/iter; left time: 894.1643s
	iters: 200, epoch: 8 | loss: 0.0633054
	speed: 0.0209s/iter; left time: 430.0451s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.96s
Steps: 223 | Train Loss: 0.0635069 Vali Loss: 0.0743306 Test Loss: 0.0875940
Validation loss decreased (0.074708 --> 0.074331).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0672177
	speed: 0.0429s/iter; left time: 874.8904s
	iters: 200, epoch: 9 | loss: 0.0657890
	speed: 0.0209s/iter; left time: 424.9781s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.96s
Steps: 223 | Train Loss: 0.0630452 Vali Loss: 0.0741678 Test Loss: 0.0868630
Validation loss decreased (0.074331 --> 0.074168).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0632034
	speed: 0.0434s/iter; left time: 876.3151s
	iters: 200, epoch: 10 | loss: 0.0645544
	speed: 0.0202s/iter; left time: 404.9018s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.76s
Steps: 223 | Train Loss: 0.0627409 Vali Loss: 0.0743513 Test Loss: 0.0880571
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0636334
	speed: 0.0404s/iter; left time: 806.8377s
	iters: 200, epoch: 11 | loss: 0.0602807
	speed: 0.0178s/iter; left time: 353.4845s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0623453 Vali Loss: 0.0742074 Test Loss: 0.0878647
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0583318
	speed: 0.0410s/iter; left time: 808.9365s
	iters: 200, epoch: 12 | loss: 0.0650040
	speed: 0.0179s/iter; left time: 352.6349s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0620972 Vali Loss: 0.0737038 Test Loss: 0.0867297
Validation loss decreased (0.074168 --> 0.073704).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0613920
	speed: 0.0414s/iter; left time: 808.6399s
	iters: 200, epoch: 13 | loss: 0.0611318
	speed: 0.0182s/iter; left time: 353.5221s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0618523 Vali Loss: 0.0738235 Test Loss: 0.0875536
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0610238
	speed: 0.0386s/iter; left time: 744.5537s
	iters: 200, epoch: 14 | loss: 0.0601860
	speed: 0.0179s/iter; left time: 343.8556s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0615380 Vali Loss: 0.0738372 Test Loss: 0.0877525
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0598381
	speed: 0.0387s/iter; left time: 738.9436s
	iters: 200, epoch: 15 | loss: 0.0587940
	speed: 0.0178s/iter; left time: 338.4882s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0612895 Vali Loss: 0.0739167 Test Loss: 0.0872995
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0566209
	speed: 0.0421s/iter; left time: 794.7425s
	iters: 200, epoch: 16 | loss: 0.0571298
	speed: 0.0183s/iter; left time: 343.1060s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.63s
Steps: 223 | Train Loss: 0.0611391 Vali Loss: 0.0740395 Test Loss: 0.0877071
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0624488
	speed: 0.0436s/iter; left time: 813.1598s
	iters: 200, epoch: 17 | loss: 0.0577584
	speed: 0.0198s/iter; left time: 367.2917s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.91s
Steps: 223 | Train Loss: 0.0609111 Vali Loss: 0.0737153 Test Loss: 0.0876156
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0645408
	speed: 0.0412s/iter; left time: 758.7901s
	iters: 200, epoch: 18 | loss: 0.0614708
	speed: 0.0182s/iter; left time: 332.5920s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.50s
Steps: 223 | Train Loss: 0.0607212 Vali Loss: 0.0740565 Test Loss: 0.0879836
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0585145
	speed: 0.0441s/iter; left time: 802.3411s
	iters: 200, epoch: 19 | loss: 0.0603509
	speed: 0.0209s/iter; left time: 378.3687s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.07s
Steps: 223 | Train Loss: 0.0606192 Vali Loss: 0.0737144 Test Loss: 0.0875244
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0605584
	speed: 0.0389s/iter; left time: 698.6056s
	iters: 200, epoch: 20 | loss: 0.0584688
	speed: 0.0180s/iter; left time: 321.6657s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0604933 Vali Loss: 0.0737341 Test Loss: 0.0881607
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0649967
	speed: 0.0399s/iter; left time: 707.6438s
	iters: 200, epoch: 21 | loss: 0.0591727
	speed: 0.0178s/iter; left time: 314.3493s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.35s
Steps: 223 | Train Loss: 0.0603355 Vali Loss: 0.0738130 Test Loss: 0.0877827
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0593023
	speed: 0.0445s/iter; left time: 779.7140s
	iters: 200, epoch: 22 | loss: 0.0619041
	speed: 0.0183s/iter; left time: 319.1066s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.78s
Steps: 223 | Train Loss: 0.0601923 Vali Loss: 0.0737966 Test Loss: 0.0876334
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021043021231889725, rmse:0.1450621336698532, mae:0.08672972023487091, rse:0.5618393421173096
Intermediate time for FR and pred_len 168: 00h:05m:46.06sIntermediate time for FR: 00h:23m:12.68s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1379552
	speed: 0.0457s/iter; left time: 1019.8141s
	iters: 200, epoch: 1 | loss: 0.1160477
	speed: 0.0178s/iter; left time: 394.3184s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.51s
Steps: 224 | Train Loss: 0.1433041 Vali Loss: 0.0977655 Test Loss: 0.1001861
Validation loss decreased (inf --> 0.097766).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0780573
	speed: 0.0397s/iter; left time: 877.4531s
	iters: 200, epoch: 2 | loss: 0.0670697
	speed: 0.0178s/iter; left time: 390.0941s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0783016 Vali Loss: 0.0630192 Test Loss: 0.0662496
Validation loss decreased (0.097766 --> 0.063019).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0623454
	speed: 0.0369s/iter; left time: 805.5581s
	iters: 200, epoch: 3 | loss: 0.0655507
	speed: 0.0175s/iter; left time: 381.6010s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0659248 Vali Loss: 0.0605475 Test Loss: 0.0632674
Validation loss decreased (0.063019 --> 0.060548).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0630882
	speed: 0.0372s/iter; left time: 805.2769s
	iters: 200, epoch: 4 | loss: 0.0590766
	speed: 0.0177s/iter; left time: 380.6010s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0628566 Vali Loss: 0.0584909 Test Loss: 0.0608319
Validation loss decreased (0.060548 --> 0.058491).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0591956
	speed: 0.0442s/iter; left time: 946.6197s
	iters: 200, epoch: 5 | loss: 0.0613977
	speed: 0.0240s/iter; left time: 510.6079s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.66s
Steps: 224 | Train Loss: 0.0611276 Vali Loss: 0.0580106 Test Loss: 0.0599504
Validation loss decreased (0.058491 --> 0.058011).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0577363
	speed: 0.0466s/iter; left time: 987.1521s
	iters: 200, epoch: 6 | loss: 0.0550658
	speed: 0.0258s/iter; left time: 543.1226s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.97s
Steps: 224 | Train Loss: 0.0599828 Vali Loss: 0.0571707 Test Loss: 0.0595299
Validation loss decreased (0.058011 --> 0.057171).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0601596
	speed: 0.0470s/iter; left time: 985.0367s
	iters: 200, epoch: 7 | loss: 0.0558117
	speed: 0.0244s/iter; left time: 508.4846s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.69s
Steps: 224 | Train Loss: 0.0591725 Vali Loss: 0.0566996 Test Loss: 0.0588407
Validation loss decreased (0.057171 --> 0.056700).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0567679
	speed: 0.0453s/iter; left time: 938.7148s
	iters: 200, epoch: 8 | loss: 0.0577220
	speed: 0.0207s/iter; left time: 427.8742s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0585837 Vali Loss: 0.0563851 Test Loss: 0.0587719
Validation loss decreased (0.056700 --> 0.056385).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0536918
	speed: 0.0433s/iter; left time: 888.3929s
	iters: 200, epoch: 9 | loss: 0.0593248
	speed: 0.0202s/iter; left time: 412.5522s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0579274 Vali Loss: 0.0560959 Test Loss: 0.0584001
Validation loss decreased (0.056385 --> 0.056096).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0576015
	speed: 0.0392s/iter; left time: 795.0024s
	iters: 200, epoch: 10 | loss: 0.0572641
	speed: 0.0197s/iter; left time: 397.1217s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0574487 Vali Loss: 0.0561246 Test Loss: 0.0586067
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0603743
	speed: 0.0446s/iter; left time: 894.4247s
	iters: 200, epoch: 11 | loss: 0.0529461
	speed: 0.0243s/iter; left time: 485.5059s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.51s
Steps: 224 | Train Loss: 0.0571570 Vali Loss: 0.0558561 Test Loss: 0.0580777
Validation loss decreased (0.056096 --> 0.055856).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0538307
	speed: 0.0408s/iter; left time: 809.1254s
	iters: 200, epoch: 12 | loss: 0.0569894
	speed: 0.0203s/iter; left time: 401.6194s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.77s
Steps: 224 | Train Loss: 0.0567255 Vali Loss: 0.0555736 Test Loss: 0.0576931
Validation loss decreased (0.055856 --> 0.055574).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0559114
	speed: 0.0453s/iter; left time: 888.4679s
	iters: 200, epoch: 13 | loss: 0.0570156
	speed: 0.0183s/iter; left time: 357.3338s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.93s
Steps: 224 | Train Loss: 0.0564412 Vali Loss: 0.0555875 Test Loss: 0.0576721
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0608026
	speed: 0.0409s/iter; left time: 793.3031s
	iters: 200, epoch: 14 | loss: 0.0548942
	speed: 0.0202s/iter; left time: 389.9872s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.77s
Steps: 224 | Train Loss: 0.0562439 Vali Loss: 0.0556266 Test Loss: 0.0576045
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0568721
	speed: 0.0432s/iter; left time: 828.8342s
	iters: 200, epoch: 15 | loss: 0.0553573
	speed: 0.0237s/iter; left time: 452.2303s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.54s
Steps: 224 | Train Loss: 0.0559618 Vali Loss: 0.0554153 Test Loss: 0.0574718
Validation loss decreased (0.055574 --> 0.055415).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0573713
	speed: 0.0398s/iter; left time: 754.3022s
	iters: 200, epoch: 16 | loss: 0.0561678
	speed: 0.0175s/iter; left time: 329.9052s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0558215 Vali Loss: 0.0551744 Test Loss: 0.0573095
Validation loss decreased (0.055415 --> 0.055174).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0589329
	speed: 0.0376s/iter; left time: 703.8887s
	iters: 200, epoch: 17 | loss: 0.0574918
	speed: 0.0179s/iter; left time: 332.8941s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0556505 Vali Loss: 0.0550482 Test Loss: 0.0572504
Validation loss decreased (0.055174 --> 0.055048).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0534935
	speed: 0.0414s/iter; left time: 765.8245s
	iters: 200, epoch: 18 | loss: 0.0574331
	speed: 0.0198s/iter; left time: 364.0729s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0554857 Vali Loss: 0.0549875 Test Loss: 0.0572133
Validation loss decreased (0.055048 --> 0.054988).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0556992
	speed: 0.0385s/iter; left time: 704.2454s
	iters: 200, epoch: 19 | loss: 0.0604655
	speed: 0.0240s/iter; left time: 435.5577s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0553156 Vali Loss: 0.0548461 Test Loss: 0.0571244
Validation loss decreased (0.054988 --> 0.054846).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0546956
	speed: 0.0414s/iter; left time: 746.4803s
	iters: 200, epoch: 20 | loss: 0.0543233
	speed: 0.0245s/iter; left time: 440.2570s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.24s
Steps: 224 | Train Loss: 0.0551500 Vali Loss: 0.0548050 Test Loss: 0.0570001
Validation loss decreased (0.054846 --> 0.054805).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0572998
	speed: 0.0456s/iter; left time: 812.4846s
	iters: 200, epoch: 21 | loss: 0.0540240
	speed: 0.0193s/iter; left time: 341.7252s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0551207 Vali Loss: 0.0548231 Test Loss: 0.0570231
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0534088
	speed: 0.0378s/iter; left time: 664.9020s
	iters: 200, epoch: 22 | loss: 0.0502284
	speed: 0.0173s/iter; left time: 302.8267s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0549312 Vali Loss: 0.0548708 Test Loss: 0.0570204
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0540605
	speed: 0.0385s/iter; left time: 668.9097s
	iters: 200, epoch: 23 | loss: 0.0507261
	speed: 0.0178s/iter; left time: 306.7572s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0548571 Vali Loss: 0.0547824 Test Loss: 0.0569985
Validation loss decreased (0.054805 --> 0.054782).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0583674
	speed: 0.0442s/iter; left time: 758.5964s
	iters: 200, epoch: 24 | loss: 0.0544730
	speed: 0.0176s/iter; left time: 299.3395s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.79s
Steps: 224 | Train Loss: 0.0547987 Vali Loss: 0.0546288 Test Loss: 0.0570315
Validation loss decreased (0.054782 --> 0.054629).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0508277
	speed: 0.0373s/iter; left time: 631.7015s
	iters: 200, epoch: 25 | loss: 0.0581925
	speed: 0.0194s/iter; left time: 327.1373s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0547711 Vali Loss: 0.0544805 Test Loss: 0.0568517
Validation loss decreased (0.054629 --> 0.054480).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0556801
	speed: 0.0391s/iter; left time: 653.4126s
	iters: 200, epoch: 26 | loss: 0.0554455
	speed: 0.0195s/iter; left time: 323.3488s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.63s
Steps: 224 | Train Loss: 0.0546281 Vali Loss: 0.0546029 Test Loss: 0.0568632
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0572915
	speed: 0.0379s/iter; left time: 623.7133s
	iters: 200, epoch: 27 | loss: 0.0576790
	speed: 0.0253s/iter; left time: 414.7405s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0545952 Vali Loss: 0.0546437 Test Loss: 0.0568861
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0563810
	speed: 0.0466s/iter; left time: 756.6862s
	iters: 200, epoch: 28 | loss: 0.0515816
	speed: 0.0244s/iter; left time: 393.7509s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.57s
Steps: 224 | Train Loss: 0.0545041 Vali Loss: 0.0544355 Test Loss: 0.0567258
Validation loss decreased (0.054480 --> 0.054436).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0575383
	speed: 0.0415s/iter; left time: 665.5287s
	iters: 200, epoch: 29 | loss: 0.0517639
	speed: 0.0202s/iter; left time: 321.4854s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.81s
Steps: 224 | Train Loss: 0.0544492 Vali Loss: 0.0544463 Test Loss: 0.0569202
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0554202
	speed: 0.0422s/iter; left time: 667.1427s
	iters: 200, epoch: 30 | loss: 0.0573169
	speed: 0.0204s/iter; left time: 320.2329s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.82s
Steps: 224 | Train Loss: 0.0544512 Vali Loss: 0.0544945 Test Loss: 0.0567682
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0525765
	speed: 0.0452s/iter; left time: 704.1949s
	iters: 200, epoch: 31 | loss: 0.0568761
	speed: 0.0243s/iter; left time: 375.9394s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.75s
Steps: 224 | Train Loss: 0.0543604 Vali Loss: 0.0544442 Test Loss: 0.0567680
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0544155
	speed: 0.0463s/iter; left time: 711.2055s
	iters: 200, epoch: 32 | loss: 0.0564592
	speed: 0.0197s/iter; left time: 301.2756s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0543330 Vali Loss: 0.0544301 Test Loss: 0.0567419
Validation loss decreased (0.054436 --> 0.054430).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0549597
	speed: 0.0429s/iter; left time: 648.7709s
	iters: 200, epoch: 33 | loss: 0.0541910
	speed: 0.0181s/iter; left time: 272.4328s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0543469 Vali Loss: 0.0543835 Test Loss: 0.0567440
Validation loss decreased (0.054430 --> 0.054384).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0571987
	speed: 0.0416s/iter; left time: 620.5499s
	iters: 200, epoch: 34 | loss: 0.0567482
	speed: 0.0201s/iter; left time: 297.4267s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.88s
Steps: 224 | Train Loss: 0.0543108 Vali Loss: 0.0543652 Test Loss: 0.0567222
Validation loss decreased (0.054384 --> 0.054365).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0535260
	speed: 0.0423s/iter; left time: 621.8226s
	iters: 200, epoch: 35 | loss: 0.0561866
	speed: 0.0193s/iter; left time: 281.2994s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0542972 Vali Loss: 0.0544265 Test Loss: 0.0567667
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0549961
	speed: 0.0410s/iter; left time: 593.5670s
	iters: 200, epoch: 36 | loss: 0.0541536
	speed: 0.0192s/iter; left time: 275.6673s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0542406 Vali Loss: 0.0544166 Test Loss: 0.0566596
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0532916
	speed: 0.0400s/iter; left time: 569.6183s
	iters: 200, epoch: 37 | loss: 0.0511241
	speed: 0.0198s/iter; left time: 280.1657s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.67s
Steps: 224 | Train Loss: 0.0542641 Vali Loss: 0.0543706 Test Loss: 0.0566760
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0539109
	speed: 0.0399s/iter; left time: 558.4617s
	iters: 200, epoch: 38 | loss: 0.0564077
	speed: 0.0205s/iter; left time: 285.2931s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.80s
Steps: 224 | Train Loss: 0.0541845 Vali Loss: 0.0543355 Test Loss: 0.0566975
Validation loss decreased (0.054365 --> 0.054336).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0503076
	speed: 0.0409s/iter; left time: 563.8564s
	iters: 200, epoch: 39 | loss: 0.0562198
	speed: 0.0200s/iter; left time: 273.4567s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.75s
Steps: 224 | Train Loss: 0.0541782 Vali Loss: 0.0543724 Test Loss: 0.0566402
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0552053
	speed: 0.0407s/iter; left time: 552.2094s
	iters: 200, epoch: 40 | loss: 0.0516493
	speed: 0.0199s/iter; left time: 267.7142s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.76s
Steps: 224 | Train Loss: 0.0541814 Vali Loss: 0.0543906 Test Loss: 0.0566315
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0556425
	speed: 0.0412s/iter; left time: 550.0056s
	iters: 200, epoch: 41 | loss: 0.0509712
	speed: 0.0201s/iter; left time: 266.7258s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.74s
Steps: 224 | Train Loss: 0.0541427 Vali Loss: 0.0543536 Test Loss: 0.0566362
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0523108
	speed: 0.0422s/iter; left time: 553.7186s
	iters: 200, epoch: 42 | loss: 0.0576750
	speed: 0.0195s/iter; left time: 253.9358s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.92s
Steps: 224 | Train Loss: 0.0541833 Vali Loss: 0.0542894 Test Loss: 0.0566669
Validation loss decreased (0.054336 --> 0.054289).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0529656
	speed: 0.0435s/iter; left time: 561.1621s
	iters: 200, epoch: 43 | loss: 0.0502761
	speed: 0.0229s/iter; left time: 292.3420s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0541143 Vali Loss: 0.0543694 Test Loss: 0.0566259
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0537367
	speed: 0.0447s/iter; left time: 566.3745s
	iters: 200, epoch: 44 | loss: 0.0559055
	speed: 0.0200s/iter; left time: 251.4707s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0541310 Vali Loss: 0.0542568 Test Loss: 0.0566117
Validation loss decreased (0.054289 --> 0.054257).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0569029
	speed: 0.0405s/iter; left time: 504.4566s
	iters: 200, epoch: 45 | loss: 0.0579741
	speed: 0.0183s/iter; left time: 225.8235s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0541451 Vali Loss: 0.0543393 Test Loss: 0.0566353
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0510111
	speed: 0.0435s/iter; left time: 531.5669s
	iters: 200, epoch: 46 | loss: 0.0570540
	speed: 0.0194s/iter; left time: 235.3549s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0541030 Vali Loss: 0.0543384 Test Loss: 0.0565993
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0603271
	speed: 0.0408s/iter; left time: 489.8614s
	iters: 200, epoch: 47 | loss: 0.0489362
	speed: 0.0221s/iter; left time: 262.5342s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.89s
Steps: 224 | Train Loss: 0.0541158 Vali Loss: 0.0542949 Test Loss: 0.0566084
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0562014
	speed: 0.0430s/iter; left time: 506.5203s
	iters: 200, epoch: 48 | loss: 0.0527634
	speed: 0.0175s/iter; left time: 204.8135s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0541052 Vali Loss: 0.0542426 Test Loss: 0.0566221
Validation loss decreased (0.054257 --> 0.054243).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0550343
	speed: 0.0405s/iter; left time: 468.1700s
	iters: 200, epoch: 49 | loss: 0.0519099
	speed: 0.0199s/iter; left time: 227.8234s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.84s
Steps: 224 | Train Loss: 0.0540786 Vali Loss: 0.0543246 Test Loss: 0.0566017
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0535444
	speed: 0.0454s/iter; left time: 514.6661s
	iters: 200, epoch: 50 | loss: 0.0502683
	speed: 0.0237s/iter; left time: 265.9353s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.67s
Steps: 224 | Train Loss: 0.0540946 Vali Loss: 0.0542993 Test Loss: 0.0566170
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0525270
	speed: 0.0416s/iter; left time: 462.1014s
	iters: 200, epoch: 51 | loss: 0.0515277
	speed: 0.0226s/iter; left time: 248.5409s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0541030 Vali Loss: 0.0542633 Test Loss: 0.0566191
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0528202
	speed: 0.0388s/iter; left time: 422.3969s
	iters: 200, epoch: 52 | loss: 0.0524368
	speed: 0.0174s/iter; left time: 187.8695s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0540361 Vali Loss: 0.0542905 Test Loss: 0.0565996
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0548940
	speed: 0.0396s/iter; left time: 421.7677s
	iters: 200, epoch: 53 | loss: 0.0519573
	speed: 0.0204s/iter; left time: 214.8931s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0541037 Vali Loss: 0.0542877 Test Loss: 0.0566198
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0533164
	speed: 0.0430s/iter; left time: 448.0185s
	iters: 200, epoch: 54 | loss: 0.0578958
	speed: 0.0241s/iter; left time: 249.1271s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.47s
Steps: 224 | Train Loss: 0.0540474 Vali Loss: 0.0542890 Test Loss: 0.0566051
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0548727
	speed: 0.0412s/iter; left time: 419.9655s
	iters: 200, epoch: 55 | loss: 0.0566967
	speed: 0.0198s/iter; left time: 200.3428s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.72s
Steps: 224 | Train Loss: 0.0540961 Vali Loss: 0.0543088 Test Loss: 0.0566188
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0531577
	speed: 0.0392s/iter; left time: 391.2384s
	iters: 200, epoch: 56 | loss: 0.0580916
	speed: 0.0175s/iter; left time: 173.3003s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.27s
Steps: 224 | Train Loss: 0.0540501 Vali Loss: 0.0543088 Test Loss: 0.0566136
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0559601
	speed: 0.0367s/iter; left time: 358.4146s
	iters: 200, epoch: 57 | loss: 0.0543095
	speed: 0.0174s/iter; left time: 167.8855s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0540529 Vali Loss: 0.0542350 Test Loss: 0.0566049
Validation loss decreased (0.054243 --> 0.054235).  Saving model ...
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0538715
	speed: 0.0394s/iter; left time: 375.2252s
	iters: 200, epoch: 58 | loss: 0.0555631
	speed: 0.0176s/iter; left time: 165.7746s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:04.32s
Steps: 224 | Train Loss: 0.0540707 Vali Loss: 0.0542733 Test Loss: 0.0566099
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0560754
	speed: 0.0395s/iter; left time: 367.5105s
	iters: 200, epoch: 59 | loss: 0.0519199
	speed: 0.0216s/iter; left time: 199.1363s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0540248 Vali Loss: 0.0542616 Test Loss: 0.0566028
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0571120
	speed: 0.0394s/iter; left time: 358.0110s
	iters: 200, epoch: 60 | loss: 0.0582117
	speed: 0.0174s/iter; left time: 156.2261s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0540845 Vali Loss: 0.0542328 Test Loss: 0.0565980
Validation loss decreased (0.054235 --> 0.054233).  Saving model ...
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0584766
	speed: 0.0408s/iter; left time: 361.3126s
	iters: 200, epoch: 61 | loss: 0.0535091
	speed: 0.0177s/iter; left time: 154.7141s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.52s
Steps: 224 | Train Loss: 0.0540387 Vali Loss: 0.0543091 Test Loss: 0.0566107
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0581197
	speed: 0.0361s/iter; left time: 312.1834s
	iters: 200, epoch: 62 | loss: 0.0556779
	speed: 0.0181s/iter; left time: 154.2599s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0540725 Vali Loss: 0.0543238 Test Loss: 0.0566121
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0515098
	speed: 0.0379s/iter; left time: 318.9160s
	iters: 200, epoch: 63 | loss: 0.0547690
	speed: 0.0175s/iter; left time: 145.5771s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0539889 Vali Loss: 0.0542935 Test Loss: 0.0566016
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0558435
	speed: 0.0362s/iter; left time: 296.3327s
	iters: 200, epoch: 64 | loss: 0.0558558
	speed: 0.0176s/iter; left time: 141.9768s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0540476 Vali Loss: 0.0542764 Test Loss: 0.0566100
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0546813
	speed: 0.0395s/iter; left time: 314.6030s
	iters: 200, epoch: 65 | loss: 0.0554467
	speed: 0.0175s/iter; left time: 137.9191s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0540326 Vali Loss: 0.0543010 Test Loss: 0.0565934
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0568983
	speed: 0.0397s/iter; left time: 306.9717s
	iters: 200, epoch: 66 | loss: 0.0544441
	speed: 0.0206s/iter; left time: 157.1418s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:04.86s
Steps: 224 | Train Loss: 0.0540953 Vali Loss: 0.0543162 Test Loss: 0.0565933
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0554599
	speed: 0.0427s/iter; left time: 321.0730s
	iters: 200, epoch: 67 | loss: 0.0513533
	speed: 0.0207s/iter; left time: 153.3647s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:04.88s
Steps: 224 | Train Loss: 0.0540845 Vali Loss: 0.0543076 Test Loss: 0.0566009
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0543297
	speed: 0.0370s/iter; left time: 269.8459s
	iters: 200, epoch: 68 | loss: 0.0517003
	speed: 0.0173s/iter; left time: 124.6368s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0540420 Vali Loss: 0.0542774 Test Loss: 0.0566046
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0578591
	speed: 0.0356s/iter; left time: 251.9135s
	iters: 200, epoch: 69 | loss: 0.0572697
	speed: 0.0175s/iter; left time: 121.7898s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0540791 Vali Loss: 0.0542371 Test Loss: 0.0566058
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0537115
	speed: 0.0371s/iter; left time: 253.6271s
	iters: 200, epoch: 70 | loss: 0.0505972
	speed: 0.0210s/iter; left time: 141.8764s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:04.56s
Steps: 224 | Train Loss: 0.0540482 Vali Loss: 0.0542732 Test Loss: 0.0565958
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010083218105137348, rmse:0.10041522979736328, mae:0.0565979890525341, rse:0.3794197142124176
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1359126
	speed: 0.0225s/iter; left time: 502.7281s
	iters: 200, epoch: 1 | loss: 0.1098680
	speed: 0.0213s/iter; left time: 473.7733s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.1422349 Vali Loss: 0.0974500 Test Loss: 0.0992706
Validation loss decreased (inf --> 0.097450).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0754588
	speed: 0.0417s/iter; left time: 921.0493s
	iters: 200, epoch: 2 | loss: 0.0673907
	speed: 0.0174s/iter; left time: 382.6453s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.36s
Steps: 224 | Train Loss: 0.0780355 Vali Loss: 0.0627294 Test Loss: 0.0657381
Validation loss decreased (0.097450 --> 0.062729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0637678
	speed: 0.0431s/iter; left time: 942.5154s
	iters: 200, epoch: 3 | loss: 0.0663196
	speed: 0.0196s/iter; left time: 425.2926s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.95s
Steps: 224 | Train Loss: 0.0660164 Vali Loss: 0.0599926 Test Loss: 0.0628002
Validation loss decreased (0.062729 --> 0.059993).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0638419
	speed: 0.0413s/iter; left time: 893.2220s
	iters: 200, epoch: 4 | loss: 0.0635814
	speed: 0.0202s/iter; left time: 435.3635s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.75s
Steps: 224 | Train Loss: 0.0630481 Vali Loss: 0.0586561 Test Loss: 0.0615792
Validation loss decreased (0.059993 --> 0.058656).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0630238
	speed: 0.0430s/iter; left time: 921.1678s
	iters: 200, epoch: 5 | loss: 0.0610638
	speed: 0.0176s/iter; left time: 373.9658s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.54s
Steps: 224 | Train Loss: 0.0612143 Vali Loss: 0.0575957 Test Loss: 0.0601869
Validation loss decreased (0.058656 --> 0.057596).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0648216
	speed: 0.0375s/iter; left time: 794.3087s
	iters: 200, epoch: 6 | loss: 0.0634050
	speed: 0.0176s/iter; left time: 370.5630s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0601831 Vali Loss: 0.0573942 Test Loss: 0.0597799
Validation loss decreased (0.057596 --> 0.057394).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0599069
	speed: 0.0371s/iter; left time: 778.1308s
	iters: 200, epoch: 7 | loss: 0.0612065
	speed: 0.0175s/iter; left time: 364.2673s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0593155 Vali Loss: 0.0566541 Test Loss: 0.0591102
Validation loss decreased (0.057394 --> 0.056654).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0542986
	speed: 0.0415s/iter; left time: 859.8482s
	iters: 200, epoch: 8 | loss: 0.0572991
	speed: 0.0223s/iter; left time: 460.6898s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.30s
Steps: 224 | Train Loss: 0.0585377 Vali Loss: 0.0566305 Test Loss: 0.0588562
Validation loss decreased (0.056654 --> 0.056631).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0640263
	speed: 0.0471s/iter; left time: 966.1459s
	iters: 200, epoch: 9 | loss: 0.0615080
	speed: 0.0202s/iter; left time: 412.8297s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0579915 Vali Loss: 0.0559572 Test Loss: 0.0582891
Validation loss decreased (0.056631 --> 0.055957).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0577642
	speed: 0.0505s/iter; left time: 1025.0210s
	iters: 200, epoch: 10 | loss: 0.0594756
	speed: 0.0264s/iter; left time: 532.9700s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.42s
Steps: 224 | Train Loss: 0.0575409 Vali Loss: 0.0558674 Test Loss: 0.0583287
Validation loss decreased (0.055957 --> 0.055867).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0579124
	speed: 0.0448s/iter; left time: 899.5653s
	iters: 200, epoch: 11 | loss: 0.0581660
	speed: 0.0204s/iter; left time: 406.3772s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0571616 Vali Loss: 0.0555863 Test Loss: 0.0582007
Validation loss decreased (0.055867 --> 0.055586).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0618948
	speed: 0.0424s/iter; left time: 840.9896s
	iters: 200, epoch: 12 | loss: 0.0521666
	speed: 0.0205s/iter; left time: 405.2581s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.79s
Steps: 224 | Train Loss: 0.0569079 Vali Loss: 0.0554603 Test Loss: 0.0577516
Validation loss decreased (0.055586 --> 0.055460).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0548473
	speed: 0.0413s/iter; left time: 809.2691s
	iters: 200, epoch: 13 | loss: 0.0552182
	speed: 0.0208s/iter; left time: 405.4899s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0565429 Vali Loss: 0.0553249 Test Loss: 0.0574627
Validation loss decreased (0.055460 --> 0.055325).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0554208
	speed: 0.0444s/iter; left time: 861.4926s
	iters: 200, epoch: 14 | loss: 0.0541941
	speed: 0.0230s/iter; left time: 443.2808s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.0562538 Vali Loss: 0.0553683 Test Loss: 0.0575624
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0557231
	speed: 0.0443s/iter; left time: 848.9220s
	iters: 200, epoch: 15 | loss: 0.0574080
	speed: 0.0209s/iter; left time: 397.5855s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0560413 Vali Loss: 0.0551291 Test Loss: 0.0575157
Validation loss decreased (0.055325 --> 0.055129).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0575104
	speed: 0.0396s/iter; left time: 749.1542s
	iters: 200, epoch: 16 | loss: 0.0551079
	speed: 0.0208s/iter; left time: 392.2356s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.79s
Steps: 224 | Train Loss: 0.0557593 Vali Loss: 0.0548837 Test Loss: 0.0574590
Validation loss decreased (0.055129 --> 0.054884).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0595915
	speed: 0.0407s/iter; left time: 761.5210s
	iters: 200, epoch: 17 | loss: 0.0584150
	speed: 0.0174s/iter; left time: 323.3025s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0556200 Vali Loss: 0.0549069 Test Loss: 0.0572072
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0574168
	speed: 0.0400s/iter; left time: 740.2444s
	iters: 200, epoch: 18 | loss: 0.0581237
	speed: 0.0177s/iter; left time: 326.0305s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.48s
Steps: 224 | Train Loss: 0.0554449 Vali Loss: 0.0550244 Test Loss: 0.0573702
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0542099
	speed: 0.0398s/iter; left time: 726.2855s
	iters: 200, epoch: 19 | loss: 0.0559456
	speed: 0.0176s/iter; left time: 319.8055s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.47s
Steps: 224 | Train Loss: 0.0553786 Vali Loss: 0.0548329 Test Loss: 0.0571894
Validation loss decreased (0.054884 --> 0.054833).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0572355
	speed: 0.0380s/iter; left time: 686.2173s
	iters: 200, epoch: 20 | loss: 0.0561926
	speed: 0.0173s/iter; left time: 310.9383s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0551821 Vali Loss: 0.0546544 Test Loss: 0.0570234
Validation loss decreased (0.054833 --> 0.054654).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0563121
	speed: 0.0377s/iter; left time: 671.9930s
	iters: 200, epoch: 21 | loss: 0.0511623
	speed: 0.0173s/iter; left time: 307.3850s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.09s
Steps: 224 | Train Loss: 0.0551742 Vali Loss: 0.0547604 Test Loss: 0.0571249
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0555600
	speed: 0.0370s/iter; left time: 651.3281s
	iters: 200, epoch: 22 | loss: 0.0522842
	speed: 0.0177s/iter; left time: 309.7261s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0550073 Vali Loss: 0.0546179 Test Loss: 0.0571097
Validation loss decreased (0.054654 --> 0.054618).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0549146
	speed: 0.0380s/iter; left time: 660.0129s
	iters: 200, epoch: 23 | loss: 0.0585962
	speed: 0.0176s/iter; left time: 303.3591s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0548645 Vali Loss: 0.0546012 Test Loss: 0.0568507
Validation loss decreased (0.054618 --> 0.054601).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0522619
	speed: 0.0411s/iter; left time: 705.5859s
	iters: 200, epoch: 24 | loss: 0.0523071
	speed: 0.0209s/iter; left time: 356.1269s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.90s
Steps: 224 | Train Loss: 0.0547287 Vali Loss: 0.0545045 Test Loss: 0.0567771
Validation loss decreased (0.054601 --> 0.054504).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0524549
	speed: 0.0374s/iter; left time: 632.9479s
	iters: 200, epoch: 25 | loss: 0.0523958
	speed: 0.0175s/iter; left time: 294.7094s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0546907 Vali Loss: 0.0543925 Test Loss: 0.0568053
Validation loss decreased (0.054504 --> 0.054393).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0491656
	speed: 0.0375s/iter; left time: 627.0800s
	iters: 200, epoch: 26 | loss: 0.0519010
	speed: 0.0187s/iter; left time: 309.6331s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.45s
Steps: 224 | Train Loss: 0.0546669 Vali Loss: 0.0544461 Test Loss: 0.0568800
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0501324
	speed: 0.0378s/iter; left time: 622.8373s
	iters: 200, epoch: 27 | loss: 0.0555143
	speed: 0.0176s/iter; left time: 287.4918s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0545846 Vali Loss: 0.0543533 Test Loss: 0.0567463
Validation loss decreased (0.054393 --> 0.054353).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0519045
	speed: 0.0415s/iter; left time: 674.8438s
	iters: 200, epoch: 28 | loss: 0.0593164
	speed: 0.0198s/iter; left time: 319.1139s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0545893 Vali Loss: 0.0543581 Test Loss: 0.0567341
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0529863
	speed: 0.0364s/iter; left time: 583.2380s
	iters: 200, epoch: 29 | loss: 0.0542369
	speed: 0.0178s/iter; left time: 282.9513s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0544853 Vali Loss: 0.0542986 Test Loss: 0.0568295
Validation loss decreased (0.054353 --> 0.054299).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0555674
	speed: 0.0386s/iter; left time: 609.8705s
	iters: 200, epoch: 30 | loss: 0.0536577
	speed: 0.0180s/iter; left time: 283.4215s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0544743 Vali Loss: 0.0543639 Test Loss: 0.0568086
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0559736
	speed: 0.0426s/iter; left time: 664.2999s
	iters: 200, epoch: 31 | loss: 0.0530356
	speed: 0.0198s/iter; left time: 307.1886s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.91s
Steps: 224 | Train Loss: 0.0543727 Vali Loss: 0.0542804 Test Loss: 0.0567701
Validation loss decreased (0.054299 --> 0.054280).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0506607
	speed: 0.0423s/iter; left time: 648.9617s
	iters: 200, epoch: 32 | loss: 0.0552089
	speed: 0.0197s/iter; left time: 301.0799s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.92s
Steps: 224 | Train Loss: 0.0543940 Vali Loss: 0.0542822 Test Loss: 0.0566895
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0566098
	speed: 0.0416s/iter; left time: 628.8243s
	iters: 200, epoch: 33 | loss: 0.0505462
	speed: 0.0176s/iter; left time: 264.0469s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0543382 Vali Loss: 0.0542966 Test Loss: 0.0567221
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0536274
	speed: 0.0372s/iter; left time: 554.7289s
	iters: 200, epoch: 34 | loss: 0.0556459
	speed: 0.0177s/iter; left time: 262.1654s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0542882 Vali Loss: 0.0541794 Test Loss: 0.0567122
Validation loss decreased (0.054280 --> 0.054179).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0517977
	speed: 0.0418s/iter; left time: 614.2475s
	iters: 200, epoch: 35 | loss: 0.0515377
	speed: 0.0187s/iter; left time: 272.4462s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.44s
Steps: 224 | Train Loss: 0.0542845 Vali Loss: 0.0542402 Test Loss: 0.0566953
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0548994
	speed: 0.0390s/iter; left time: 564.5106s
	iters: 200, epoch: 36 | loss: 0.0516339
	speed: 0.0174s/iter; left time: 249.7458s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0543297 Vali Loss: 0.0541653 Test Loss: 0.0567088
Validation loss decreased (0.054179 --> 0.054165).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0532896
	speed: 0.0374s/iter; left time: 532.2474s
	iters: 200, epoch: 37 | loss: 0.0552534
	speed: 0.0173s/iter; left time: 245.2337s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.10s
Steps: 224 | Train Loss: 0.0542318 Vali Loss: 0.0542396 Test Loss: 0.0566283
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0579502
	speed: 0.0363s/iter; left time: 509.2660s
	iters: 200, epoch: 38 | loss: 0.0564580
	speed: 0.0174s/iter; left time: 241.3944s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.11s
Steps: 224 | Train Loss: 0.0541829 Vali Loss: 0.0542048 Test Loss: 0.0566276
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0524793
	speed: 0.0436s/iter; left time: 601.4429s
	iters: 200, epoch: 39 | loss: 0.0540179
	speed: 0.0233s/iter; left time: 319.1015s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.49s
Steps: 224 | Train Loss: 0.0542241 Vali Loss: 0.0542069 Test Loss: 0.0566297
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0576975
	speed: 0.0376s/iter; left time: 509.5911s
	iters: 200, epoch: 40 | loss: 0.0566987
	speed: 0.0200s/iter; left time: 269.4703s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.43s
Steps: 224 | Train Loss: 0.0542656 Vali Loss: 0.0541664 Test Loss: 0.0566543
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0545915
	speed: 0.0367s/iter; left time: 489.2609s
	iters: 200, epoch: 41 | loss: 0.0532811
	speed: 0.0210s/iter; left time: 277.9300s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0542114 Vali Loss: 0.0541793 Test Loss: 0.0566813
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0551827
	speed: 0.0411s/iter; left time: 539.2438s
	iters: 200, epoch: 42 | loss: 0.0532943
	speed: 0.0185s/iter; left time: 241.3391s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.60s
Steps: 224 | Train Loss: 0.0541279 Vali Loss: 0.0542011 Test Loss: 0.0566544
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0552357
	speed: 0.0401s/iter; left time: 517.6390s
	iters: 200, epoch: 43 | loss: 0.0531659
	speed: 0.0226s/iter; left time: 288.8377s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0541679 Vali Loss: 0.0542149 Test Loss: 0.0566875
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0508406
	speed: 0.0397s/iter; left time: 502.6425s
	iters: 200, epoch: 44 | loss: 0.0489071
	speed: 0.0176s/iter; left time: 220.8664s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0541656 Vali Loss: 0.0542703 Test Loss: 0.0566778
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0571226
	speed: 0.0372s/iter; left time: 463.0165s
	iters: 200, epoch: 45 | loss: 0.0516223
	speed: 0.0175s/iter; left time: 216.2234s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0541814 Vali Loss: 0.0541900 Test Loss: 0.0566624
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0533346
	speed: 0.0367s/iter; left time: 448.1339s
	iters: 200, epoch: 46 | loss: 0.0554680
	speed: 0.0176s/iter; left time: 213.1437s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0541046 Vali Loss: 0.0542059 Test Loss: 0.0566667
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010069291107356548, rmse:0.10034585744142532, mae:0.05670879781246185, rse:0.37915757298469543
Intermediate time for IT and pred_len 24: 00h:11m:52.66s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1438253
	speed: 0.0460s/iter; left time: 1024.9099s
	iters: 200, epoch: 1 | loss: 0.1208758
	speed: 0.0179s/iter; left time: 397.9643s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.55s
Steps: 224 | Train Loss: 0.1473302 Vali Loss: 0.1059266 Test Loss: 0.1091740
Validation loss decreased (inf --> 0.105927).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0936386
	speed: 0.0392s/iter; left time: 865.1550s
	iters: 200, epoch: 2 | loss: 0.0860985
	speed: 0.0179s/iter; left time: 392.3694s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0960414 Vali Loss: 0.0816183 Test Loss: 0.0868534
Validation loss decreased (0.105927 --> 0.081618).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0869685
	speed: 0.0384s/iter; left time: 839.2529s
	iters: 200, epoch: 3 | loss: 0.0824700
	speed: 0.0177s/iter; left time: 384.1694s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.19s
Steps: 224 | Train Loss: 0.0850344 Vali Loss: 0.0794767 Test Loss: 0.0840807
Validation loss decreased (0.081618 --> 0.079477).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0811073
	speed: 0.0395s/iter; left time: 854.8521s
	iters: 200, epoch: 4 | loss: 0.0803189
	speed: 0.0192s/iter; left time: 413.3789s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0823571 Vali Loss: 0.0782248 Test Loss: 0.0828857
Validation loss decreased (0.079477 --> 0.078225).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0829862
	speed: 0.0391s/iter; left time: 837.2694s
	iters: 200, epoch: 5 | loss: 0.0771629
	speed: 0.0180s/iter; left time: 383.0649s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.28s
Steps: 224 | Train Loss: 0.0807140 Vali Loss: 0.0776065 Test Loss: 0.0829133
Validation loss decreased (0.078225 --> 0.077606).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0808049
	speed: 0.0381s/iter; left time: 806.9387s
	iters: 200, epoch: 6 | loss: 0.0791209
	speed: 0.0175s/iter; left time: 369.8217s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0796624 Vali Loss: 0.0771222 Test Loss: 0.0819657
Validation loss decreased (0.077606 --> 0.077122).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0809408
	speed: 0.0381s/iter; left time: 797.8413s
	iters: 200, epoch: 7 | loss: 0.0773605
	speed: 0.0179s/iter; left time: 373.1060s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0788298 Vali Loss: 0.0770251 Test Loss: 0.0816225
Validation loss decreased (0.077122 --> 0.077025).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0780101
	speed: 0.0386s/iter; left time: 800.1361s
	iters: 200, epoch: 8 | loss: 0.0734982
	speed: 0.0178s/iter; left time: 366.6406s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0781991 Vali Loss: 0.0765766 Test Loss: 0.0813183
Validation loss decreased (0.077025 --> 0.076577).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0775502
	speed: 0.0390s/iter; left time: 800.2133s
	iters: 200, epoch: 9 | loss: 0.0727340
	speed: 0.0179s/iter; left time: 365.0391s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0776098 Vali Loss: 0.0765785 Test Loss: 0.0815433
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0742046
	speed: 0.0384s/iter; left time: 778.6754s
	iters: 200, epoch: 10 | loss: 0.0804574
	speed: 0.0179s/iter; left time: 361.6385s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0770741 Vali Loss: 0.0760664 Test Loss: 0.0814565
Validation loss decreased (0.076577 --> 0.076066).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0781170
	speed: 0.0385s/iter; left time: 771.6587s
	iters: 200, epoch: 11 | loss: 0.0763606
	speed: 0.0177s/iter; left time: 354.2933s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0766591 Vali Loss: 0.0762633 Test Loss: 0.0814268
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0788421
	speed: 0.0386s/iter; left time: 765.1212s
	iters: 200, epoch: 12 | loss: 0.0785553
	speed: 0.0186s/iter; left time: 367.8299s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.46s
Steps: 224 | Train Loss: 0.0762871 Vali Loss: 0.0763303 Test Loss: 0.0807374
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0767044
	speed: 0.0405s/iter; left time: 794.2752s
	iters: 200, epoch: 13 | loss: 0.0790308
	speed: 0.0190s/iter; left time: 370.3604s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0760010 Vali Loss: 0.0760269 Test Loss: 0.0811383
Validation loss decreased (0.076066 --> 0.076027).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0738585
	speed: 0.0382s/iter; left time: 740.1297s
	iters: 200, epoch: 14 | loss: 0.0735675
	speed: 0.0175s/iter; left time: 337.8237s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0756241 Vali Loss: 0.0759628 Test Loss: 0.0812599
Validation loss decreased (0.076027 --> 0.075963).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0746233
	speed: 0.0403s/iter; left time: 773.2452s
	iters: 200, epoch: 15 | loss: 0.0766651
	speed: 0.0178s/iter; left time: 340.1740s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.33s
Steps: 224 | Train Loss: 0.0754588 Vali Loss: 0.0756437 Test Loss: 0.0810107
Validation loss decreased (0.075963 --> 0.075644).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0798216
	speed: 0.0379s/iter; left time: 718.3975s
	iters: 200, epoch: 16 | loss: 0.0763530
	speed: 0.0177s/iter; left time: 333.0846s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0750988 Vali Loss: 0.0756608 Test Loss: 0.0809585
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0749412
	speed: 0.0400s/iter; left time: 748.7746s
	iters: 200, epoch: 17 | loss: 0.0748506
	speed: 0.0177s/iter; left time: 329.7582s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.47s
Steps: 224 | Train Loss: 0.0748632 Vali Loss: 0.0757296 Test Loss: 0.0809511
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0732470
	speed: 0.0383s/iter; left time: 708.6400s
	iters: 200, epoch: 18 | loss: 0.0771152
	speed: 0.0177s/iter; left time: 325.2143s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0746712 Vali Loss: 0.0759519 Test Loss: 0.0808242
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0716322
	speed: 0.0374s/iter; left time: 682.6111s
	iters: 200, epoch: 19 | loss: 0.0734277
	speed: 0.0175s/iter; left time: 318.4366s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0744779 Vali Loss: 0.0757884 Test Loss: 0.0807449
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0720630
	speed: 0.0396s/iter; left time: 714.6965s
	iters: 200, epoch: 20 | loss: 0.0764352
	speed: 0.0176s/iter; left time: 315.0124s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.42s
Steps: 224 | Train Loss: 0.0742645 Vali Loss: 0.0756426 Test Loss: 0.0808228
Validation loss decreased (0.075644 --> 0.075643).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0752152
	speed: 0.0425s/iter; left time: 757.8532s
	iters: 200, epoch: 21 | loss: 0.0683738
	speed: 0.0190s/iter; left time: 336.3019s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.78s
Steps: 224 | Train Loss: 0.0741271 Vali Loss: 0.0756992 Test Loss: 0.0806643
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0747552
	speed: 0.0387s/iter; left time: 680.3511s
	iters: 200, epoch: 22 | loss: 0.0740042
	speed: 0.0178s/iter; left time: 311.6218s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.31s
Steps: 224 | Train Loss: 0.0740510 Vali Loss: 0.0756657 Test Loss: 0.0808825
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0729785
	speed: 0.0379s/iter; left time: 658.7155s
	iters: 200, epoch: 23 | loss: 0.0724722
	speed: 0.0175s/iter; left time: 302.7692s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0738833 Vali Loss: 0.0756935 Test Loss: 0.0808874
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0741584
	speed: 0.0379s/iter; left time: 650.3920s
	iters: 200, epoch: 24 | loss: 0.0702976
	speed: 0.0176s/iter; left time: 299.2664s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.15s
Steps: 224 | Train Loss: 0.0737572 Vali Loss: 0.0755926 Test Loss: 0.0806114
Validation loss decreased (0.075643 --> 0.075593).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0726041
	speed: 0.0387s/iter; left time: 654.9765s
	iters: 200, epoch: 25 | loss: 0.0721414
	speed: 0.0177s/iter; left time: 297.1581s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0735935 Vali Loss: 0.0755621 Test Loss: 0.0806927
Validation loss decreased (0.075593 --> 0.075562).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0734444
	speed: 0.0385s/iter; left time: 643.0189s
	iters: 200, epoch: 26 | loss: 0.0754302
	speed: 0.0175s/iter; left time: 291.2417s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0735225 Vali Loss: 0.0756676 Test Loss: 0.0805907
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0747007
	speed: 0.0378s/iter; left time: 623.2643s
	iters: 200, epoch: 27 | loss: 0.0694138
	speed: 0.0177s/iter; left time: 290.0670s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0734549 Vali Loss: 0.0755092 Test Loss: 0.0805312
Validation loss decreased (0.075562 --> 0.075509).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0760770
	speed: 0.0391s/iter; left time: 635.0650s
	iters: 200, epoch: 28 | loss: 0.0724863
	speed: 0.0178s/iter; left time: 287.2127s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0733856 Vali Loss: 0.0755548 Test Loss: 0.0805923
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0735273
	speed: 0.0381s/iter; left time: 610.0264s
	iters: 200, epoch: 29 | loss: 0.0731055
	speed: 0.0177s/iter; left time: 281.2472s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.24s
Steps: 224 | Train Loss: 0.0733169 Vali Loss: 0.0754803 Test Loss: 0.0806061
Validation loss decreased (0.075509 --> 0.075480).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0725225
	speed: 0.0388s/iter; left time: 613.0244s
	iters: 200, epoch: 30 | loss: 0.0722679
	speed: 0.0177s/iter; left time: 278.3916s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0732621 Vali Loss: 0.0754730 Test Loss: 0.0806382
Validation loss decreased (0.075480 --> 0.075473).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0735552
	speed: 0.0406s/iter; left time: 632.5392s
	iters: 200, epoch: 31 | loss: 0.0696184
	speed: 0.0177s/iter; left time: 273.4272s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.40s
Steps: 224 | Train Loss: 0.0732522 Vali Loss: 0.0753299 Test Loss: 0.0805189
Validation loss decreased (0.075473 --> 0.075330).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0748394
	speed: 0.0394s/iter; left time: 605.2338s
	iters: 200, epoch: 32 | loss: 0.0749177
	speed: 0.0178s/iter; left time: 271.4242s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0731558 Vali Loss: 0.0754113 Test Loss: 0.0805488
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0731158
	speed: 0.0415s/iter; left time: 628.1651s
	iters: 200, epoch: 33 | loss: 0.0764134
	speed: 0.0190s/iter; left time: 285.2683s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.64s
Steps: 224 | Train Loss: 0.0731354 Vali Loss: 0.0754464 Test Loss: 0.0805663
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0720409
	speed: 0.0380s/iter; left time: 566.4270s
	iters: 200, epoch: 34 | loss: 0.0738428
	speed: 0.0178s/iter; left time: 262.9375s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.35s
Steps: 224 | Train Loss: 0.0730683 Vali Loss: 0.0754058 Test Loss: 0.0804376
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0698061
	speed: 0.0400s/iter; left time: 587.5626s
	iters: 200, epoch: 35 | loss: 0.0759599
	speed: 0.0194s/iter; left time: 283.0952s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.62s
Steps: 224 | Train Loss: 0.0730275 Vali Loss: 0.0754564 Test Loss: 0.0805740
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0716557
	speed: 0.0385s/iter; left time: 557.2221s
	iters: 200, epoch: 36 | loss: 0.0711207
	speed: 0.0175s/iter; left time: 251.3743s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.12s
Steps: 224 | Train Loss: 0.0730016 Vali Loss: 0.0754517 Test Loss: 0.0805066
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0755870
	speed: 0.0383s/iter; left time: 545.3388s
	iters: 200, epoch: 37 | loss: 0.0734674
	speed: 0.0181s/iter; left time: 255.7564s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0729387 Vali Loss: 0.0754124 Test Loss: 0.0805279
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0684947
	speed: 0.0376s/iter; left time: 526.9358s
	iters: 200, epoch: 38 | loss: 0.0758405
	speed: 0.0177s/iter; left time: 245.7336s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0729181 Vali Loss: 0.0754555 Test Loss: 0.0805209
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0743821
	speed: 0.0375s/iter; left time: 517.0128s
	iters: 200, epoch: 39 | loss: 0.0711856
	speed: 0.0175s/iter; left time: 239.4779s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.14s
Steps: 224 | Train Loss: 0.0728928 Vali Loss: 0.0753763 Test Loss: 0.0805926
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0773584
	speed: 0.0425s/iter; left time: 576.3701s
	iters: 200, epoch: 40 | loss: 0.0719035
	speed: 0.0231s/iter; left time: 311.2183s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0729117 Vali Loss: 0.0754172 Test Loss: 0.0805385
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0723396
	speed: 0.0413s/iter; left time: 551.6058s
	iters: 200, epoch: 41 | loss: 0.0712304
	speed: 0.0176s/iter; left time: 232.6121s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.37s
Steps: 224 | Train Loss: 0.0729427 Vali Loss: 0.0753424 Test Loss: 0.0805553
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018678918480873108, rmse:0.13667084276676178, mae:0.08051890879869461, rse:0.5167672038078308
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1446110
	speed: 0.0221s/iter; left time: 493.8308s
	iters: 200, epoch: 1 | loss: 0.1253999
	speed: 0.0199s/iter; left time: 441.9493s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.85s
Steps: 224 | Train Loss: 0.1496909 Vali Loss: 0.1045320 Test Loss: 0.1075368
Validation loss decreased (inf --> 0.104532).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0924727
	speed: 0.0412s/iter; left time: 910.6740s
	iters: 200, epoch: 2 | loss: 0.0894741
	speed: 0.0178s/iter; left time: 390.7651s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.26s
Steps: 224 | Train Loss: 0.0954484 Vali Loss: 0.0817993 Test Loss: 0.0867445
Validation loss decreased (0.104532 --> 0.081799).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0847295
	speed: 0.0402s/iter; left time: 878.0263s
	iters: 200, epoch: 3 | loss: 0.0820517
	speed: 0.0180s/iter; left time: 391.8004s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0846861 Vali Loss: 0.0795831 Test Loss: 0.0841799
Validation loss decreased (0.081799 --> 0.079583).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0826818
	speed: 0.0404s/iter; left time: 873.8917s
	iters: 200, epoch: 4 | loss: 0.0826001
	speed: 0.0179s/iter; left time: 386.0319s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.39s
Steps: 224 | Train Loss: 0.0823463 Vali Loss: 0.0784222 Test Loss: 0.0830313
Validation loss decreased (0.079583 --> 0.078422).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0834706
	speed: 0.0389s/iter; left time: 833.0787s
	iters: 200, epoch: 5 | loss: 0.0793772
	speed: 0.0177s/iter; left time: 376.3514s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0808059 Vali Loss: 0.0778977 Test Loss: 0.0820265
Validation loss decreased (0.078422 --> 0.077898).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0793130
	speed: 0.0408s/iter; left time: 863.3459s
	iters: 200, epoch: 6 | loss: 0.0798471
	speed: 0.0182s/iter; left time: 382.9665s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.49s
Steps: 224 | Train Loss: 0.0797353 Vali Loss: 0.0771687 Test Loss: 0.0820218
Validation loss decreased (0.077898 --> 0.077169).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0792806
	speed: 0.0394s/iter; left time: 825.4901s
	iters: 200, epoch: 7 | loss: 0.0804888
	speed: 0.0179s/iter; left time: 373.8149s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.34s
Steps: 224 | Train Loss: 0.0788949 Vali Loss: 0.0769688 Test Loss: 0.0814737
Validation loss decreased (0.077169 --> 0.076969).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0805822
	speed: 0.0417s/iter; left time: 865.1671s
	iters: 200, epoch: 8 | loss: 0.0799717
	speed: 0.0187s/iter; left time: 385.6848s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0782915 Vali Loss: 0.0768342 Test Loss: 0.0813357
Validation loss decreased (0.076969 --> 0.076834).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0787869
	speed: 0.0384s/iter; left time: 787.5092s
	iters: 200, epoch: 9 | loss: 0.0796126
	speed: 0.0176s/iter; left time: 358.7167s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.17s
Steps: 224 | Train Loss: 0.0777337 Vali Loss: 0.0765885 Test Loss: 0.0811092
Validation loss decreased (0.076834 --> 0.076589).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0715174
	speed: 0.0388s/iter; left time: 786.4551s
	iters: 200, epoch: 10 | loss: 0.0793800
	speed: 0.0177s/iter; left time: 358.1980s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.21s
Steps: 224 | Train Loss: 0.0773026 Vali Loss: 0.0766290 Test Loss: 0.0812185
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0754477
	speed: 0.0381s/iter; left time: 764.6416s
	iters: 200, epoch: 11 | loss: 0.0789837
	speed: 0.0178s/iter; left time: 354.4071s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.30s
Steps: 224 | Train Loss: 0.0767757 Vali Loss: 0.0764785 Test Loss: 0.0808268
Validation loss decreased (0.076589 --> 0.076479).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0715470
	speed: 0.0443s/iter; left time: 879.6698s
	iters: 200, epoch: 12 | loss: 0.0762711
	speed: 0.0199s/iter; left time: 392.9371s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.85s
Steps: 224 | Train Loss: 0.0764457 Vali Loss: 0.0764530 Test Loss: 0.0807678
Validation loss decreased (0.076479 --> 0.076453).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0757492
	speed: 0.0450s/iter; left time: 883.5416s
	iters: 200, epoch: 13 | loss: 0.0821893
	speed: 0.0204s/iter; left time: 397.2539s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.94s
Steps: 224 | Train Loss: 0.0761522 Vali Loss: 0.0763963 Test Loss: 0.0806580
Validation loss decreased (0.076453 --> 0.076396).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0764003
	speed: 0.0461s/iter; left time: 894.1181s
	iters: 200, epoch: 14 | loss: 0.0738080
	speed: 0.0196s/iter; left time: 378.3026s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0758944 Vali Loss: 0.0761132 Test Loss: 0.0809184
Validation loss decreased (0.076396 --> 0.076113).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0746748
	speed: 0.0406s/iter; left time: 778.9004s
	iters: 200, epoch: 15 | loss: 0.0724435
	speed: 0.0194s/iter; left time: 370.6361s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.57s
Steps: 224 | Train Loss: 0.0755759 Vali Loss: 0.0764618 Test Loss: 0.0805427
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0719663
	speed: 0.0390s/iter; left time: 737.9347s
	iters: 200, epoch: 16 | loss: 0.0697170
	speed: 0.0178s/iter; left time: 335.5655s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.22s
Steps: 224 | Train Loss: 0.0753819 Vali Loss: 0.0761848 Test Loss: 0.0806028
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0727296
	speed: 0.0406s/iter; left time: 760.1802s
	iters: 200, epoch: 17 | loss: 0.0727161
	speed: 0.0177s/iter; left time: 330.2366s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.50s
Steps: 224 | Train Loss: 0.0750679 Vali Loss: 0.0762574 Test Loss: 0.0805783
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0725658
	speed: 0.0381s/iter; left time: 703.8773s
	iters: 200, epoch: 18 | loss: 0.0764599
	speed: 0.0178s/iter; left time: 327.2250s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0748732 Vali Loss: 0.0761443 Test Loss: 0.0805745
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0747242
	speed: 0.0466s/iter; left time: 851.3817s
	iters: 200, epoch: 19 | loss: 0.0744604
	speed: 0.0214s/iter; left time: 388.4899s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0746945 Vali Loss: 0.0761027 Test Loss: 0.0805595
Validation loss decreased (0.076113 --> 0.076103).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0739140
	speed: 0.0443s/iter; left time: 798.5066s
	iters: 200, epoch: 20 | loss: 0.0799948
	speed: 0.0225s/iter; left time: 403.7873s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0745287 Vali Loss: 0.0761509 Test Loss: 0.0804114
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0718822
	speed: 0.0403s/iter; left time: 719.0455s
	iters: 200, epoch: 21 | loss: 0.0686560
	speed: 0.0197s/iter; left time: 348.4729s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.41s
Steps: 224 | Train Loss: 0.0743691 Vali Loss: 0.0761282 Test Loss: 0.0804886
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0756082
	speed: 0.0382s/iter; left time: 671.8549s
	iters: 200, epoch: 22 | loss: 0.0743395
	speed: 0.0176s/iter; left time: 307.8186s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0742769 Vali Loss: 0.0762186 Test Loss: 0.0808756
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0802817
	speed: 0.0395s/iter; left time: 686.2851s
	iters: 200, epoch: 23 | loss: 0.0747382
	speed: 0.0194s/iter; left time: 334.4759s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.47s
Steps: 224 | Train Loss: 0.0740906 Vali Loss: 0.0761006 Test Loss: 0.0809374
Validation loss decreased (0.076103 --> 0.076101).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0721726
	speed: 0.0388s/iter; left time: 665.4127s
	iters: 200, epoch: 24 | loss: 0.0764399
	speed: 0.0179s/iter; left time: 305.9124s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.25s
Steps: 224 | Train Loss: 0.0739739 Vali Loss: 0.0763183 Test Loss: 0.0805535
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0713016
	speed: 0.0377s/iter; left time: 638.2618s
	iters: 200, epoch: 25 | loss: 0.0763350
	speed: 0.0177s/iter; left time: 297.7267s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0739049 Vali Loss: 0.0761669 Test Loss: 0.0804498
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0704296
	speed: 0.0396s/iter; left time: 661.2235s
	iters: 200, epoch: 26 | loss: 0.0738422
	speed: 0.0211s/iter; left time: 350.1026s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.73s
Steps: 224 | Train Loss: 0.0737833 Vali Loss: 0.0761739 Test Loss: 0.0806323
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0736066
	speed: 0.0397s/iter; left time: 654.4782s
	iters: 200, epoch: 27 | loss: 0.0724954
	speed: 0.0181s/iter; left time: 295.6898s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.38s
Steps: 224 | Train Loss: 0.0737053 Vali Loss: 0.0761146 Test Loss: 0.0805858
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0708030
	speed: 0.0417s/iter; left time: 678.2211s
	iters: 200, epoch: 28 | loss: 0.0726346
	speed: 0.0224s/iter; left time: 361.8982s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0736342 Vali Loss: 0.0761730 Test Loss: 0.0805067
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0736985
	speed: 0.0394s/iter; left time: 631.5932s
	iters: 200, epoch: 29 | loss: 0.0757324
	speed: 0.0175s/iter; left time: 279.1250s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.18s
Steps: 224 | Train Loss: 0.0736515 Vali Loss: 0.0762277 Test Loss: 0.0805709
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0738680
	speed: 0.0382s/iter; left time: 604.3951s
	iters: 200, epoch: 30 | loss: 0.0754899
	speed: 0.0175s/iter; left time: 275.0779s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.20s
Steps: 224 | Train Loss: 0.0735729 Vali Loss: 0.0761100 Test Loss: 0.0804291
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0771352
	speed: 0.0394s/iter; left time: 614.2084s
	iters: 200, epoch: 31 | loss: 0.0740414
	speed: 0.0175s/iter; left time: 271.1425s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.29s
Steps: 224 | Train Loss: 0.0734717 Vali Loss: 0.0763483 Test Loss: 0.0805765
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0702331
	speed: 0.0375s/iter; left time: 576.6210s
	iters: 200, epoch: 32 | loss: 0.0758914
	speed: 0.0181s/iter; left time: 276.2274s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.23s
Steps: 224 | Train Loss: 0.0734446 Vali Loss: 0.0761305 Test Loss: 0.0804661
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0723481
	speed: 0.0372s/iter; left time: 563.5045s
	iters: 200, epoch: 33 | loss: 0.0725820
	speed: 0.0176s/iter; left time: 264.1281s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.16s
Steps: 224 | Train Loss: 0.0733762 Vali Loss: 0.0761667 Test Loss: 0.0805655
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018912920728325844, rmse:0.13752426207065582, mae:0.08093737810850143, rse:0.5199940204620361
Intermediate time for IT and pred_len 96: 00h:07m:21.13s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1423216
	speed: 0.0461s/iter; left time: 1023.0411s
	iters: 200, epoch: 1 | loss: 0.1238418
	speed: 0.0180s/iter; left time: 397.9219s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.57s
Steps: 223 | Train Loss: 0.1487374 Vali Loss: 0.1077961 Test Loss: 0.1103803
Validation loss decreased (inf --> 0.107796).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0939423
	speed: 0.0391s/iter; left time: 860.2094s
	iters: 200, epoch: 2 | loss: 0.0893055
	speed: 0.0179s/iter; left time: 392.1026s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0994013 Vali Loss: 0.0860546 Test Loss: 0.0906314
Validation loss decreased (0.107796 --> 0.086055).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0925718
	speed: 0.0395s/iter; left time: 859.8668s
	iters: 200, epoch: 3 | loss: 0.0874189
	speed: 0.0179s/iter; left time: 387.7733s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0890840 Vali Loss: 0.0842465 Test Loss: 0.0879599
Validation loss decreased (0.086055 --> 0.084247).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0881069
	speed: 0.0411s/iter; left time: 885.5673s
	iters: 200, epoch: 4 | loss: 0.0894828
	speed: 0.0193s/iter; left time: 413.8056s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.66s
Steps: 223 | Train Loss: 0.0864151 Vali Loss: 0.0837157 Test Loss: 0.0879383
Validation loss decreased (0.084247 --> 0.083716).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0829716
	speed: 0.0404s/iter; left time: 860.1269s
	iters: 200, epoch: 5 | loss: 0.0826994
	speed: 0.0179s/iter; left time: 379.1964s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0848429 Vali Loss: 0.0827259 Test Loss: 0.0875212
Validation loss decreased (0.083716 --> 0.082726).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0817767
	speed: 0.0409s/iter; left time: 861.8152s
	iters: 200, epoch: 6 | loss: 0.0862948
	speed: 0.0193s/iter; left time: 404.2502s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.60s
Steps: 223 | Train Loss: 0.0836924 Vali Loss: 0.0822996 Test Loss: 0.0872402
Validation loss decreased (0.082726 --> 0.082300).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0838116
	speed: 0.0392s/iter; left time: 818.1758s
	iters: 200, epoch: 7 | loss: 0.0848943
	speed: 0.0179s/iter; left time: 370.8490s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0827538 Vali Loss: 0.0820797 Test Loss: 0.0871094
Validation loss decreased (0.082300 --> 0.082080).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0825785
	speed: 0.0387s/iter; left time: 799.7960s
	iters: 200, epoch: 8 | loss: 0.0793753
	speed: 0.0179s/iter; left time: 366.8962s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0820263 Vali Loss: 0.0822556 Test Loss: 0.0876831
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0795462
	speed: 0.0425s/iter; left time: 868.7222s
	iters: 200, epoch: 9 | loss: 0.0789129
	speed: 0.0228s/iter; left time: 464.0423s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.27s
Steps: 223 | Train Loss: 0.0815050 Vali Loss: 0.0815729 Test Loss: 0.0867696
Validation loss decreased (0.082080 --> 0.081573).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0811481
	speed: 0.0412s/iter; left time: 831.2948s
	iters: 200, epoch: 10 | loss: 0.0825071
	speed: 0.0183s/iter; left time: 368.1365s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.43s
Steps: 223 | Train Loss: 0.0810133 Vali Loss: 0.0817944 Test Loss: 0.0868367
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0821963
	speed: 0.0398s/iter; left time: 794.0686s
	iters: 200, epoch: 11 | loss: 0.0761625
	speed: 0.0208s/iter; left time: 413.9829s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.77s
Steps: 223 | Train Loss: 0.0805028 Vali Loss: 0.0818734 Test Loss: 0.0874601
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0790672
	speed: 0.0383s/iter; left time: 756.6160s
	iters: 200, epoch: 12 | loss: 0.0799741
	speed: 0.0178s/iter; left time: 350.1716s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.20s
Steps: 223 | Train Loss: 0.0801906 Vali Loss: 0.0817134 Test Loss: 0.0878104
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0782696
	speed: 0.0420s/iter; left time: 820.3538s
	iters: 200, epoch: 13 | loss: 0.0798471
	speed: 0.0206s/iter; left time: 400.7098s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.86s
Steps: 223 | Train Loss: 0.0798508 Vali Loss: 0.0815302 Test Loss: 0.0871841
Validation loss decreased (0.081573 --> 0.081530).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0773299
	speed: 0.0454s/iter; left time: 876.7918s
	iters: 200, epoch: 14 | loss: 0.0797019
	speed: 0.0185s/iter; left time: 354.6894s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.89s
Steps: 223 | Train Loss: 0.0794928 Vali Loss: 0.0817144 Test Loss: 0.0871146
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0791878
	speed: 0.0386s/iter; left time: 736.6542s
	iters: 200, epoch: 15 | loss: 0.0850011
	speed: 0.0180s/iter; left time: 341.1535s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0791677 Vali Loss: 0.0815923 Test Loss: 0.0870508
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0806760
	speed: 0.0414s/iter; left time: 779.9618s
	iters: 200, epoch: 16 | loss: 0.0801392
	speed: 0.0179s/iter; left time: 336.1305s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.54s
Steps: 223 | Train Loss: 0.0789298 Vali Loss: 0.0816933 Test Loss: 0.0873272
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0782162
	speed: 0.0394s/iter; left time: 734.2989s
	iters: 200, epoch: 17 | loss: 0.0770024
	speed: 0.0182s/iter; left time: 337.2990s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.42s
Steps: 223 | Train Loss: 0.0786994 Vali Loss: 0.0814644 Test Loss: 0.0871423
Validation loss decreased (0.081530 --> 0.081464).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0750689
	speed: 0.0393s/iter; left time: 723.2489s
	iters: 200, epoch: 18 | loss: 0.0791912
	speed: 0.0179s/iter; left time: 326.9713s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0784913 Vali Loss: 0.0817581 Test Loss: 0.0871634
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0772508
	speed: 0.0385s/iter; left time: 700.3244s
	iters: 200, epoch: 19 | loss: 0.0785425
	speed: 0.0179s/iter; left time: 323.0485s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.27s
Steps: 223 | Train Loss: 0.0782302 Vali Loss: 0.0813190 Test Loss: 0.0870724
Validation loss decreased (0.081464 --> 0.081319).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0796085
	speed: 0.0418s/iter; left time: 750.8243s
	iters: 200, epoch: 20 | loss: 0.0747003
	speed: 0.0179s/iter; left time: 319.8981s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.50s
Steps: 223 | Train Loss: 0.0780742 Vali Loss: 0.0815029 Test Loss: 0.0872391
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0798976
	speed: 0.0385s/iter; left time: 682.9507s
	iters: 200, epoch: 21 | loss: 0.0783784
	speed: 0.0205s/iter; left time: 360.8688s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.79s
Steps: 223 | Train Loss: 0.0778642 Vali Loss: 0.0814129 Test Loss: 0.0872288
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0798767
	speed: 0.0401s/iter; left time: 701.9505s
	iters: 200, epoch: 22 | loss: 0.0798330
	speed: 0.0185s/iter; left time: 323.0699s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0777549 Vali Loss: 0.0814658 Test Loss: 0.0875085
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0734261
	speed: 0.0395s/iter; left time: 683.3050s
	iters: 200, epoch: 23 | loss: 0.0779886
	speed: 0.0181s/iter; left time: 311.2552s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.38s
Steps: 223 | Train Loss: 0.0775775 Vali Loss: 0.0814620 Test Loss: 0.0873106
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0789265
	speed: 0.0384s/iter; left time: 655.8847s
	iters: 200, epoch: 24 | loss: 0.0768867
	speed: 0.0181s/iter; left time: 306.7642s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0774439 Vali Loss: 0.0814374 Test Loss: 0.0870546
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0773396
	speed: 0.0389s/iter; left time: 655.6546s
	iters: 200, epoch: 25 | loss: 0.0760351
	speed: 0.0185s/iter; left time: 310.4427s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.29s
Steps: 223 | Train Loss: 0.0773691 Vali Loss: 0.0813845 Test Loss: 0.0871841
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0796533
	speed: 0.0399s/iter; left time: 662.7052s
	iters: 200, epoch: 26 | loss: 0.0774103
	speed: 0.0180s/iter; left time: 297.4635s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.43s
Steps: 223 | Train Loss: 0.0771835 Vali Loss: 0.0814663 Test Loss: 0.0871791
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0742327
	speed: 0.0372s/iter; left time: 610.6163s
	iters: 200, epoch: 27 | loss: 0.0805335
	speed: 0.0178s/iter; left time: 289.9990s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.16s
Steps: 223 | Train Loss: 0.0771259 Vali Loss: 0.0814744 Test Loss: 0.0872126
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0766790
	speed: 0.0381s/iter; left time: 616.6928s
	iters: 200, epoch: 28 | loss: 0.0775495
	speed: 0.0179s/iter; left time: 288.0162s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.24s
Steps: 223 | Train Loss: 0.0770471 Vali Loss: 0.0813009 Test Loss: 0.0870816
Validation loss decreased (0.081319 --> 0.081301).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0757094
	speed: 0.0408s/iter; left time: 650.4701s
	iters: 200, epoch: 29 | loss: 0.0760654
	speed: 0.0180s/iter; left time: 285.5870s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0769555 Vali Loss: 0.0812396 Test Loss: 0.0871117
Validation loss decreased (0.081301 --> 0.081240).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0767229
	speed: 0.0404s/iter; left time: 635.6768s
	iters: 200, epoch: 30 | loss: 0.0786787
	speed: 0.0180s/iter; left time: 282.1841s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.41s
Steps: 223 | Train Loss: 0.0768584 Vali Loss: 0.0815030 Test Loss: 0.0869776
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0778194
	speed: 0.0383s/iter; left time: 594.6005s
	iters: 200, epoch: 31 | loss: 0.0778298
	speed: 0.0178s/iter; left time: 274.3076s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0767776 Vali Loss: 0.0813545 Test Loss: 0.0871082
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0754501
	speed: 0.0407s/iter; left time: 622.4346s
	iters: 200, epoch: 32 | loss: 0.0764830
	speed: 0.0179s/iter; left time: 272.2614s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.50s
Steps: 223 | Train Loss: 0.0767559 Vali Loss: 0.0812562 Test Loss: 0.0870397
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0755639
	speed: 0.0414s/iter; left time: 624.0858s
	iters: 200, epoch: 33 | loss: 0.0777980
	speed: 0.0204s/iter; left time: 305.6632s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.97s
Steps: 223 | Train Loss: 0.0767118 Vali Loss: 0.0814427 Test Loss: 0.0868835
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0754135
	speed: 0.0393s/iter; left time: 583.4103s
	iters: 200, epoch: 34 | loss: 0.0785940
	speed: 0.0180s/iter; left time: 264.7266s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0766594 Vali Loss: 0.0814381 Test Loss: 0.0870054
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0776752
	speed: 0.0433s/iter; left time: 633.2336s
	iters: 200, epoch: 35 | loss: 0.0752889
	speed: 0.0219s/iter; left time: 318.3048s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.31s
Steps: 223 | Train Loss: 0.0766568 Vali Loss: 0.0813767 Test Loss: 0.0870404
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0754985
	speed: 0.0434s/iter; left time: 624.6602s
	iters: 200, epoch: 36 | loss: 0.0774933
	speed: 0.0183s/iter; left time: 261.0258s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.64s
Steps: 223 | Train Loss: 0.0765844 Vali Loss: 0.0814429 Test Loss: 0.0870331
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0767131
	speed: 0.0404s/iter; left time: 572.0861s
	iters: 200, epoch: 37 | loss: 0.0771547
	speed: 0.0180s/iter; left time: 253.5340s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.49s
Steps: 223 | Train Loss: 0.0765541 Vali Loss: 0.0814060 Test Loss: 0.0868510
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0774624
	speed: 0.0379s/iter; left time: 528.8624s
	iters: 200, epoch: 38 | loss: 0.0765092
	speed: 0.0180s/iter; left time: 249.0256s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.23s
Steps: 223 | Train Loss: 0.0765164 Vali Loss: 0.0814066 Test Loss: 0.0870728
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0766422
	speed: 0.0387s/iter; left time: 531.8544s
	iters: 200, epoch: 39 | loss: 0.0785535
	speed: 0.0204s/iter; left time: 278.2109s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.53s
Steps: 223 | Train Loss: 0.0765010 Vali Loss: 0.0812689 Test Loss: 0.0869280
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02109212428331375, rmse:0.14523127675056458, mae:0.08711174875497818, rse:0.5496454238891602
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1449288
	speed: 0.0237s/iter; left time: 527.1092s
	iters: 200, epoch: 1 | loss: 0.1275386
	speed: 0.0189s/iter; left time: 416.6627s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.75s
Steps: 223 | Train Loss: 0.1514120 Vali Loss: 0.1083481 Test Loss: 0.1111070
Validation loss decreased (inf --> 0.108348).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0964038
	speed: 0.0406s/iter; left time: 891.5062s
	iters: 200, epoch: 2 | loss: 0.0950081
	speed: 0.0182s/iter; left time: 397.9964s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:04.36s
Steps: 223 | Train Loss: 0.0995364 Vali Loss: 0.0861125 Test Loss: 0.0903715
Validation loss decreased (0.108348 --> 0.086113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0903619
	speed: 0.0439s/iter; left time: 955.2516s
	iters: 200, epoch: 3 | loss: 0.0892618
	speed: 0.0180s/iter; left time: 388.8537s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.56s
Steps: 223 | Train Loss: 0.0891035 Vali Loss: 0.0844135 Test Loss: 0.0887872
Validation loss decreased (0.086113 --> 0.084413).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0915347
	speed: 0.0401s/iter; left time: 863.5181s
	iters: 200, epoch: 4 | loss: 0.0848709
	speed: 0.0179s/iter; left time: 384.2669s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0866611 Vali Loss: 0.0836004 Test Loss: 0.0878691
Validation loss decreased (0.084413 --> 0.083600).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0874841
	speed: 0.0425s/iter; left time: 906.4325s
	iters: 200, epoch: 5 | loss: 0.0879956
	speed: 0.0203s/iter; left time: 430.8733s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.86s
Steps: 223 | Train Loss: 0.0851195 Vali Loss: 0.0828480 Test Loss: 0.0873044
Validation loss decreased (0.083600 --> 0.082848).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839838
	speed: 0.0420s/iter; left time: 885.0919s
	iters: 200, epoch: 6 | loss: 0.0821068
	speed: 0.0179s/iter; left time: 375.3691s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0839008 Vali Loss: 0.0822585 Test Loss: 0.0870409
Validation loss decreased (0.082848 --> 0.082259).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0821517
	speed: 0.0422s/iter; left time: 879.5556s
	iters: 200, epoch: 7 | loss: 0.0844231
	speed: 0.0184s/iter; left time: 381.8262s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.58s
Steps: 223 | Train Loss: 0.0830070 Vali Loss: 0.0822771 Test Loss: 0.0872937
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0803021
	speed: 0.0392s/iter; left time: 809.3280s
	iters: 200, epoch: 8 | loss: 0.0812417
	speed: 0.0180s/iter; left time: 368.8296s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0822285 Vali Loss: 0.0821905 Test Loss: 0.0874587
Validation loss decreased (0.082259 --> 0.082190).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0808798
	speed: 0.0417s/iter; left time: 851.4096s
	iters: 200, epoch: 9 | loss: 0.0797862
	speed: 0.0180s/iter; left time: 364.8351s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.28s
Steps: 223 | Train Loss: 0.0815818 Vali Loss: 0.0818749 Test Loss: 0.0877508
Validation loss decreased (0.082190 --> 0.081875).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0799902
	speed: 0.0440s/iter; left time: 888.7792s
	iters: 200, epoch: 10 | loss: 0.0788336
	speed: 0.0186s/iter; left time: 372.8630s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.71s
Steps: 223 | Train Loss: 0.0810375 Vali Loss: 0.0815037 Test Loss: 0.0872590
Validation loss decreased (0.081875 --> 0.081504).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0795319
	speed: 0.0391s/iter; left time: 780.5435s
	iters: 200, epoch: 11 | loss: 0.0794025
	speed: 0.0180s/iter; left time: 357.3691s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:04.25s
Steps: 223 | Train Loss: 0.0806232 Vali Loss: 0.0819767 Test Loss: 0.0874538
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0821759
	speed: 0.0420s/iter; left time: 829.3506s
	iters: 200, epoch: 12 | loss: 0.0778371
	speed: 0.0198s/iter; left time: 388.3896s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.81s
Steps: 223 | Train Loss: 0.0801564 Vali Loss: 0.0814462 Test Loss: 0.0873747
Validation loss decreased (0.081504 --> 0.081446).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0842263
	speed: 0.0417s/iter; left time: 814.4622s
	iters: 200, epoch: 13 | loss: 0.0809889
	speed: 0.0182s/iter; left time: 352.9573s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0797804 Vali Loss: 0.0816962 Test Loss: 0.0877320
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0751703
	speed: 0.0421s/iter; left time: 811.9402s
	iters: 200, epoch: 14 | loss: 0.0763598
	speed: 0.0207s/iter; left time: 397.4312s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.87s
Steps: 223 | Train Loss: 0.0794535 Vali Loss: 0.0814359 Test Loss: 0.0876379
Validation loss decreased (0.081446 --> 0.081436).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0789681
	speed: 0.0400s/iter; left time: 763.7075s
	iters: 200, epoch: 15 | loss: 0.0766760
	speed: 0.0180s/iter; left time: 342.0794s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.31s
Steps: 223 | Train Loss: 0.0791543 Vali Loss: 0.0809303 Test Loss: 0.0873543
Validation loss decreased (0.081436 --> 0.080930).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0803362
	speed: 0.0399s/iter; left time: 753.0844s
	iters: 200, epoch: 16 | loss: 0.0774697
	speed: 0.0182s/iter; left time: 341.7943s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0788688 Vali Loss: 0.0816369 Test Loss: 0.0876021
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0793249
	speed: 0.0407s/iter; left time: 757.9852s
	iters: 200, epoch: 17 | loss: 0.0790591
	speed: 0.0200s/iter; left time: 370.2881s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.69s
Steps: 223 | Train Loss: 0.0786432 Vali Loss: 0.0810094 Test Loss: 0.0877025
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0760391
	speed: 0.0409s/iter; left time: 753.7718s
	iters: 200, epoch: 18 | loss: 0.0795988
	speed: 0.0204s/iter; left time: 374.0401s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.87s
Steps: 223 | Train Loss: 0.0784823 Vali Loss: 0.0814446 Test Loss: 0.0877750
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0790216
	speed: 0.0412s/iter; left time: 749.6815s
	iters: 200, epoch: 19 | loss: 0.0839612
	speed: 0.0182s/iter; left time: 328.9115s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.47s
Steps: 223 | Train Loss: 0.0782333 Vali Loss: 0.0810218 Test Loss: 0.0872108
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0764522
	speed: 0.0399s/iter; left time: 716.8600s
	iters: 200, epoch: 20 | loss: 0.0756822
	speed: 0.0180s/iter; left time: 321.3500s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0780890 Vali Loss: 0.0807879 Test Loss: 0.0873520
Validation loss decreased (0.080930 --> 0.080788).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0766985
	speed: 0.0389s/iter; left time: 689.3043s
	iters: 200, epoch: 21 | loss: 0.0789640
	speed: 0.0181s/iter; left time: 319.1252s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0778664 Vali Loss: 0.0809161 Test Loss: 0.0873467
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0807523
	speed: 0.0377s/iter; left time: 660.2344s
	iters: 200, epoch: 22 | loss: 0.0760726
	speed: 0.0180s/iter; left time: 313.6632s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0777179 Vali Loss: 0.0807275 Test Loss: 0.0872172
Validation loss decreased (0.080788 --> 0.080727).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0772732
	speed: 0.0393s/iter; left time: 680.4143s
	iters: 200, epoch: 23 | loss: 0.0791408
	speed: 0.0183s/iter; left time: 314.8837s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:04.34s
Steps: 223 | Train Loss: 0.0775855 Vali Loss: 0.0809376 Test Loss: 0.0875355
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0792675
	speed: 0.0397s/iter; left time: 677.4338s
	iters: 200, epoch: 24 | loss: 0.0806082
	speed: 0.0195s/iter; left time: 331.1184s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.61s
Steps: 223 | Train Loss: 0.0774288 Vali Loss: 0.0809761 Test Loss: 0.0873712
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0786049
	speed: 0.0395s/iter; left time: 665.1974s
	iters: 200, epoch: 25 | loss: 0.0782466
	speed: 0.0180s/iter; left time: 301.7335s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.26s
Steps: 223 | Train Loss: 0.0773741 Vali Loss: 0.0809126 Test Loss: 0.0873566
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0797315
	speed: 0.0417s/iter; left time: 694.0438s
	iters: 200, epoch: 26 | loss: 0.0777119
	speed: 0.0210s/iter; left time: 347.7726s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.91s
Steps: 223 | Train Loss: 0.0772352 Vali Loss: 0.0808808 Test Loss: 0.0872862
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0776568
	speed: 0.0410s/iter; left time: 671.8824s
	iters: 200, epoch: 27 | loss: 0.0756376
	speed: 0.0179s/iter; left time: 291.3500s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.49s
Steps: 223 | Train Loss: 0.0771665 Vali Loss: 0.0809822 Test Loss: 0.0873216
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0762978
	speed: 0.0376s/iter; left time: 608.6421s
	iters: 200, epoch: 28 | loss: 0.0765274
	speed: 0.0178s/iter; left time: 286.6605s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.21s
Steps: 223 | Train Loss: 0.0770732 Vali Loss: 0.0810418 Test Loss: 0.0872446
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0719681
	speed: 0.0379s/iter; left time: 605.4086s
	iters: 200, epoch: 29 | loss: 0.0788069
	speed: 0.0182s/iter; left time: 288.8801s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0769719 Vali Loss: 0.0809646 Test Loss: 0.0873285
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0789183
	speed: 0.0404s/iter; left time: 635.3260s
	iters: 200, epoch: 30 | loss: 0.0782066
	speed: 0.0180s/iter; left time: 281.9131s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.42s
Steps: 223 | Train Loss: 0.0769468 Vali Loss: 0.0807314 Test Loss: 0.0870685
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0808447
	speed: 0.0380s/iter; left time: 589.4340s
	iters: 200, epoch: 31 | loss: 0.0765283
	speed: 0.0181s/iter; left time: 278.3549s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.22s
Steps: 223 | Train Loss: 0.0768495 Vali Loss: 0.0806943 Test Loss: 0.0872749
Validation loss decreased (0.080727 --> 0.080694).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0761573
	speed: 0.0438s/iter; left time: 668.9799s
	iters: 200, epoch: 32 | loss: 0.0757153
	speed: 0.0182s/iter; left time: 276.4012s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.57s
Steps: 223 | Train Loss: 0.0768053 Vali Loss: 0.0808349 Test Loss: 0.0872295
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0775786
	speed: 0.0419s/iter; left time: 631.6551s
	iters: 200, epoch: 33 | loss: 0.0767409
	speed: 0.0190s/iter; left time: 283.6921s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.73s
Steps: 223 | Train Loss: 0.0767355 Vali Loss: 0.0808667 Test Loss: 0.0871681
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0757100
	speed: 0.0388s/iter; left time: 576.0192s
	iters: 200, epoch: 34 | loss: 0.0774558
	speed: 0.0180s/iter; left time: 265.6552s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:04.33s
Steps: 223 | Train Loss: 0.0767543 Vali Loss: 0.0808929 Test Loss: 0.0871076
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0778735
	speed: 0.0407s/iter; left time: 594.7343s
	iters: 200, epoch: 35 | loss: 0.0775153
	speed: 0.0189s/iter; left time: 274.4915s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.58s
Steps: 223 | Train Loss: 0.0766747 Vali Loss: 0.0807420 Test Loss: 0.0872145
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0747025
	speed: 0.0386s/iter; left time: 555.6579s
	iters: 200, epoch: 36 | loss: 0.0751638
	speed: 0.0182s/iter; left time: 260.0684s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0766659 Vali Loss: 0.0808573 Test Loss: 0.0873167
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0759581
	speed: 0.0399s/iter; left time: 565.5094s
	iters: 200, epoch: 37 | loss: 0.0804632
	speed: 0.0189s/iter; left time: 265.5958s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.56s
Steps: 223 | Train Loss: 0.0766658 Vali Loss: 0.0808365 Test Loss: 0.0872206
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0759550
	speed: 0.0397s/iter; left time: 554.0831s
	iters: 200, epoch: 38 | loss: 0.0777812
	speed: 0.0181s/iter; left time: 251.1645s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.30s
Steps: 223 | Train Loss: 0.0766106 Vali Loss: 0.0808862 Test Loss: 0.0872444
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0806029
	speed: 0.0399s/iter; left time: 548.0181s
	iters: 200, epoch: 39 | loss: 0.0741781
	speed: 0.0183s/iter; left time: 248.7539s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.44s
Steps: 223 | Train Loss: 0.0765723 Vali Loss: 0.0807692 Test Loss: 0.0871365
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0759363
	speed: 0.0406s/iter; left time: 548.8343s
	iters: 200, epoch: 40 | loss: 0.0809224
	speed: 0.0184s/iter; left time: 246.0285s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.51s
Steps: 223 | Train Loss: 0.0764995 Vali Loss: 0.0808269 Test Loss: 0.0872263
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0751095
	speed: 0.0400s/iter; left time: 531.8427s
	iters: 200, epoch: 41 | loss: 0.0726962
	speed: 0.0206s/iter; left time: 271.4748s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.75s
Steps: 223 | Train Loss: 0.0764408 Vali Loss: 0.0807421 Test Loss: 0.0871634
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020868754014372826, rmse:0.14446021616458893, mae:0.08727487176656723, rse:0.5467272400856018
Intermediate time for IT and pred_len 168: 00h:08m:06.28sIntermediate time for IT: 00h:27m:20.07sTotal time: 02h:04m:37.46s