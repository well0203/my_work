
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0331299
	speed: 0.0707s/iter; left time: 1575.6582s
	iters: 200, epoch: 1 | loss: 0.0287433
	speed: 0.0384s/iter; left time: 851.8963s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0354802 Vali Loss: 0.0319702 Test Loss: 0.0360805
Validation loss decreased (inf --> 0.031970).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0159255
	speed: 0.0674s/iter; left time: 1487.0161s
	iters: 200, epoch: 2 | loss: 0.0169086
	speed: 0.0336s/iter; left time: 738.9185s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0172425 Vali Loss: 0.0207260 Test Loss: 0.0221175
Validation loss decreased (0.031970 --> 0.020726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0144151
	speed: 0.0790s/iter; left time: 1726.1905s
	iters: 200, epoch: 3 | loss: 0.0146772
	speed: 0.0416s/iter; left time: 903.9022s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.79s
Steps: 224 | Train Loss: 0.0146521 Vali Loss: 0.0201139 Test Loss: 0.0216509
Validation loss decreased (0.020726 --> 0.020114).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0158383
	speed: 0.0821s/iter; left time: 1775.0880s
	iters: 200, epoch: 4 | loss: 0.0160625
	speed: 0.0384s/iter; left time: 826.4032s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.29s
Steps: 224 | Train Loss: 0.0140296 Vali Loss: 0.0195571 Test Loss: 0.0211821
Validation loss decreased (0.020114 --> 0.019557).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0142890
	speed: 0.0822s/iter; left time: 1758.5232s
	iters: 200, epoch: 5 | loss: 0.0131326
	speed: 0.0412s/iter; left time: 877.3811s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.32s
Steps: 224 | Train Loss: 0.0136609 Vali Loss: 0.0193199 Test Loss: 0.0209985
Validation loss decreased (0.019557 --> 0.019320).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0164826
	speed: 0.0817s/iter; left time: 1730.5515s
	iters: 200, epoch: 6 | loss: 0.0126204
	speed: 0.0443s/iter; left time: 933.5930s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.48s
Steps: 224 | Train Loss: 0.0134594 Vali Loss: 0.0192443 Test Loss: 0.0211259
Validation loss decreased (0.019320 --> 0.019244).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0128278
	speed: 0.0834s/iter; left time: 1747.2703s
	iters: 200, epoch: 7 | loss: 0.0147099
	speed: 0.0536s/iter; left time: 1116.9657s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.52s
Steps: 224 | Train Loss: 0.0132826 Vali Loss: 0.0190823 Test Loss: 0.0211098
Validation loss decreased (0.019244 --> 0.019082).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0118263
	speed: 0.1093s/iter; left time: 2265.2138s
	iters: 200, epoch: 8 | loss: 0.0127398
	speed: 0.0483s/iter; left time: 996.3191s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.01s
Steps: 224 | Train Loss: 0.0131595 Vali Loss: 0.0192576 Test Loss: 0.0208804
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0148438
	speed: 0.1102s/iter; left time: 2259.8762s
	iters: 200, epoch: 9 | loss: 0.0141029
	speed: 0.0637s/iter; left time: 1300.4499s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.94s
Steps: 224 | Train Loss: 0.0130791 Vali Loss: 0.0191878 Test Loss: 0.0210775
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0133966
	speed: 0.1038s/iter; left time: 2106.1482s
	iters: 200, epoch: 10 | loss: 0.0124890
	speed: 0.0477s/iter; left time: 962.0660s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0129684 Vali Loss: 0.0189475 Test Loss: 0.0207936
Validation loss decreased (0.019082 --> 0.018948).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0106154
	speed: 0.1090s/iter; left time: 2186.6887s
	iters: 200, epoch: 11 | loss: 0.0129889
	speed: 0.0557s/iter; left time: 1112.4528s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.57s
Steps: 224 | Train Loss: 0.0129028 Vali Loss: 0.0188844 Test Loss: 0.0209089
Validation loss decreased (0.018948 --> 0.018884).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0125292
	speed: 0.1107s/iter; left time: 2196.0378s
	iters: 200, epoch: 12 | loss: 0.0131749
	speed: 0.0459s/iter; left time: 905.1567s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.07s
Steps: 224 | Train Loss: 0.0128195 Vali Loss: 0.0188164 Test Loss: 0.0208695
Validation loss decreased (0.018884 --> 0.018816).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0113560
	speed: 0.1107s/iter; left time: 2171.3120s
	iters: 200, epoch: 13 | loss: 0.0122889
	speed: 0.0522s/iter; left time: 1018.6841s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0127381 Vali Loss: 0.0188539 Test Loss: 0.0208254
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0127220
	speed: 0.1141s/iter; left time: 2212.7356s
	iters: 200, epoch: 14 | loss: 0.0135412
	speed: 0.0512s/iter; left time: 987.5221s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.80s
Steps: 224 | Train Loss: 0.0127018 Vali Loss: 0.0187021 Test Loss: 0.0206928
Validation loss decreased (0.018816 --> 0.018702).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0127345
	speed: 0.1138s/iter; left time: 2181.9086s
	iters: 200, epoch: 15 | loss: 0.0107379
	speed: 0.0581s/iter; left time: 1107.1712s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.32s
Steps: 224 | Train Loss: 0.0126647 Vali Loss: 0.0187818 Test Loss: 0.0208291
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0131628
	speed: 0.1331s/iter; left time: 2520.5197s
	iters: 200, epoch: 16 | loss: 0.0119425
	speed: 0.0613s/iter; left time: 1155.0066s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.05s
Steps: 224 | Train Loss: 0.0126147 Vali Loss: 0.0187834 Test Loss: 0.0210146
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0133438
	speed: 0.1468s/iter; left time: 2747.9899s
	iters: 200, epoch: 17 | loss: 0.0122820
	speed: 0.0577s/iter; left time: 1074.1064s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.21s
Steps: 224 | Train Loss: 0.0125655 Vali Loss: 0.0185552 Test Loss: 0.0206705
Validation loss decreased (0.018702 --> 0.018555).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0129390
	speed: 0.1468s/iter; left time: 2715.0802s
	iters: 200, epoch: 18 | loss: 0.0157475
	speed: 0.0836s/iter; left time: 1538.2893s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:16.27s
Steps: 224 | Train Loss: 0.0125308 Vali Loss: 0.0186281 Test Loss: 0.0207464
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0110804
	speed: 0.1466s/iter; left time: 2677.9508s
	iters: 200, epoch: 19 | loss: 0.0113313
	speed: 0.0694s/iter; left time: 1260.8440s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.99s
Steps: 224 | Train Loss: 0.0125154 Vali Loss: 0.0187080 Test Loss: 0.0210039
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0120892
	speed: 0.1453s/iter; left time: 2622.2886s
	iters: 200, epoch: 20 | loss: 0.0129364
	speed: 0.0577s/iter; left time: 1035.4401s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.27s
Steps: 224 | Train Loss: 0.0124660 Vali Loss: 0.0186161 Test Loss: 0.0207673
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0110016
	speed: 0.1372s/iter; left time: 2444.2884s
	iters: 200, epoch: 21 | loss: 0.0132078
	speed: 0.0635s/iter; left time: 1125.2830s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:15.06s
Steps: 224 | Train Loss: 0.0124346 Vali Loss: 0.0186258 Test Loss: 0.0207704
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0102475
	speed: 0.1537s/iter; left time: 2704.5341s
	iters: 200, epoch: 22 | loss: 0.0119495
	speed: 0.0742s/iter; left time: 1298.1239s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:16.61s
Steps: 224 | Train Loss: 0.0124349 Vali Loss: 0.0185870 Test Loss: 0.0208066
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0129670
	speed: 0.1210s/iter; left time: 2102.5517s
	iters: 200, epoch: 23 | loss: 0.0114171
	speed: 0.0690s/iter; left time: 1191.4217s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:13.87s
Steps: 224 | Train Loss: 0.0124044 Vali Loss: 0.0185987 Test Loss: 0.0207789
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0116020
	speed: 0.0766s/iter; left time: 1312.9771s
	iters: 200, epoch: 24 | loss: 0.0120706
	speed: 0.0434s/iter; left time: 739.7107s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.70s
Steps: 224 | Train Loss: 0.0123961 Vali Loss: 0.0185948 Test Loss: 0.0207864
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0124222
	speed: 0.1250s/iter; left time: 2115.7450s
	iters: 200, epoch: 25 | loss: 0.0153793
	speed: 0.0649s/iter; left time: 1091.5692s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:15.31s
Steps: 224 | Train Loss: 0.0123830 Vali Loss: 0.0185996 Test Loss: 0.0207961
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0122711
	speed: 0.1567s/iter; left time: 2616.6654s
	iters: 200, epoch: 26 | loss: 0.0115288
	speed: 0.0651s/iter; left time: 1080.2294s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.79s
Steps: 224 | Train Loss: 0.0123559 Vali Loss: 0.0185369 Test Loss: 0.0206521
Validation loss decreased (0.018555 --> 0.018537).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0131443
	speed: 0.1325s/iter; left time: 2182.9369s
	iters: 200, epoch: 27 | loss: 0.0136372
	speed: 0.0636s/iter; left time: 1041.6113s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:13.97s
Steps: 224 | Train Loss: 0.0123368 Vali Loss: 0.0186206 Test Loss: 0.0208083
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0118613
	speed: 0.1272s/iter; left time: 2067.6074s
	iters: 200, epoch: 28 | loss: 0.0137763
	speed: 0.0586s/iter; left time: 946.7049s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:13.45s
Steps: 224 | Train Loss: 0.0123275 Vali Loss: 0.0185284 Test Loss: 0.0208035
Validation loss decreased (0.018537 --> 0.018528).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0121510
	speed: 0.1405s/iter; left time: 2252.2776s
	iters: 200, epoch: 29 | loss: 0.0107840
	speed: 0.0712s/iter; left time: 1134.5924s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:16.30s
Steps: 224 | Train Loss: 0.0123369 Vali Loss: 0.0185281 Test Loss: 0.0207493
Validation loss decreased (0.018528 --> 0.018528).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0138683
	speed: 0.1391s/iter; left time: 2198.7351s
	iters: 200, epoch: 30 | loss: 0.0133592
	speed: 0.0617s/iter; left time: 969.2713s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:14.09s
Steps: 224 | Train Loss: 0.0123014 Vali Loss: 0.0185362 Test Loss: 0.0208496
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0119280
	speed: 0.1239s/iter; left time: 1930.4301s
	iters: 200, epoch: 31 | loss: 0.0113524
	speed: 0.0678s/iter; left time: 1050.2827s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:14.30s
Steps: 224 | Train Loss: 0.0123056 Vali Loss: 0.0185103 Test Loss: 0.0208459
Validation loss decreased (0.018528 --> 0.018510).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0114114
	speed: 0.1271s/iter; left time: 1951.3709s
	iters: 200, epoch: 32 | loss: 0.0130700
	speed: 0.0614s/iter; left time: 937.3906s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0123037 Vali Loss: 0.0185335 Test Loss: 0.0207588
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0132595
	speed: 0.1552s/iter; left time: 2348.9561s
	iters: 200, epoch: 33 | loss: 0.0107495
	speed: 0.0586s/iter; left time: 880.2307s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:14.24s
Steps: 224 | Train Loss: 0.0122890 Vali Loss: 0.0185438 Test Loss: 0.0208019
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0122293
	speed: 0.1298s/iter; left time: 1935.9060s
	iters: 200, epoch: 34 | loss: 0.0126933
	speed: 0.0633s/iter; left time: 937.3475s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:14.02s
Steps: 224 | Train Loss: 0.0122830 Vali Loss: 0.0185324 Test Loss: 0.0207754
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0129222
	speed: 0.1343s/iter; left time: 1972.1209s
	iters: 200, epoch: 35 | loss: 0.0108182
	speed: 0.0615s/iter; left time: 897.3826s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:14.57s
Steps: 224 | Train Loss: 0.0122650 Vali Loss: 0.0185707 Test Loss: 0.0208121
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0125490
	speed: 0.1408s/iter; left time: 2036.5078s
	iters: 200, epoch: 36 | loss: 0.0140222
	speed: 0.0683s/iter; left time: 980.9939s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0122610 Vali Loss: 0.0185492 Test Loss: 0.0208118
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0152776
	speed: 0.1168s/iter; left time: 1663.3829s
	iters: 200, epoch: 37 | loss: 0.0121370
	speed: 0.0571s/iter; left time: 806.8245s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:12.74s
Steps: 224 | Train Loss: 0.0122684 Vali Loss: 0.0185470 Test Loss: 0.0208452
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0121063
	speed: 0.1275s/iter; left time: 1786.5817s
	iters: 200, epoch: 38 | loss: 0.0114475
	speed: 0.0562s/iter; left time: 782.3565s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:13.17s
Steps: 224 | Train Loss: 0.0122699 Vali Loss: 0.0185565 Test Loss: 0.0208614
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0134420
	speed: 0.1198s/iter; left time: 1651.4766s
	iters: 200, epoch: 39 | loss: 0.0113555
	speed: 0.0696s/iter; left time: 953.4177s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.03s
Steps: 224 | Train Loss: 0.0122534 Vali Loss: 0.0185123 Test Loss: 0.0208491
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0111702
	speed: 0.1392s/iter; left time: 1887.5824s
	iters: 200, epoch: 40 | loss: 0.0136204
	speed: 0.0584s/iter; left time: 785.7224s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:13.67s
Steps: 224 | Train Loss: 0.0122599 Vali Loss: 0.0185720 Test Loss: 0.0208392
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0110373
	speed: 0.1189s/iter; left time: 1585.5869s
	iters: 200, epoch: 41 | loss: 0.0121039
	speed: 0.0601s/iter; left time: 796.0753s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:12.82s
Steps: 224 | Train Loss: 0.0122421 Vali Loss: 0.0184958 Test Loss: 0.0207846
Validation loss decreased (0.018510 --> 0.018496).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0117363
	speed: 0.1270s/iter; left time: 1665.2070s
	iters: 200, epoch: 42 | loss: 0.0141523
	speed: 0.0556s/iter; left time: 723.7693s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:13.06s
Steps: 224 | Train Loss: 0.0122492 Vali Loss: 0.0185481 Test Loss: 0.0208161
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0135011
	speed: 0.1422s/iter; left time: 1833.2903s
	iters: 200, epoch: 43 | loss: 0.0126329
	speed: 0.0631s/iter; left time: 807.5494s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0122592 Vali Loss: 0.0185243 Test Loss: 0.0208267
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0100381
	speed: 0.1192s/iter; left time: 1510.3343s
	iters: 200, epoch: 44 | loss: 0.0122319
	speed: 0.0520s/iter; left time: 653.5911s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0122403 Vali Loss: 0.0185204 Test Loss: 0.0207974
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0127638
	speed: 0.0910s/iter; left time: 1132.3478s
	iters: 200, epoch: 45 | loss: 0.0129958
	speed: 0.0476s/iter; left time: 587.6923s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:11.09s
Steps: 224 | Train Loss: 0.0122323 Vali Loss: 0.0185284 Test Loss: 0.0208220
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0121234
	speed: 0.0910s/iter; left time: 1112.1473s
	iters: 200, epoch: 46 | loss: 0.0132324
	speed: 0.0441s/iter; left time: 534.9395s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:10.01s
Steps: 224 | Train Loss: 0.0122421 Vali Loss: 0.0185286 Test Loss: 0.0207993
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0124325
	speed: 0.0878s/iter; left time: 1053.5875s
	iters: 200, epoch: 47 | loss: 0.0115689
	speed: 0.0497s/iter; left time: 591.7240s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:10.76s
Steps: 224 | Train Loss: 0.0122320 Vali Loss: 0.0185471 Test Loss: 0.0208486
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0131577
	speed: 0.1046s/iter; left time: 1230.9453s
	iters: 200, epoch: 48 | loss: 0.0117313
	speed: 0.0462s/iter; left time: 538.7897s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:10.86s
Steps: 224 | Train Loss: 0.0122374 Vali Loss: 0.0185213 Test Loss: 0.0208071
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0126173
	speed: 0.1129s/iter; left time: 1304.1703s
	iters: 200, epoch: 49 | loss: 0.0135240
	speed: 0.0472s/iter; left time: 540.6533s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:11.56s
Steps: 224 | Train Loss: 0.0122360 Vali Loss: 0.0184857 Test Loss: 0.0208153
Validation loss decreased (0.018496 --> 0.018486).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0112510
	speed: 0.0976s/iter; left time: 1105.7939s
	iters: 200, epoch: 50 | loss: 0.0112302
	speed: 0.0548s/iter; left time: 615.6263s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.0122434 Vali Loss: 0.0185543 Test Loss: 0.0208179
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0113205
	speed: 0.1005s/iter; left time: 1116.0836s
	iters: 200, epoch: 51 | loss: 0.0120899
	speed: 0.0567s/iter; left time: 623.6655s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:12.34s
Steps: 224 | Train Loss: 0.0122339 Vali Loss: 0.0185324 Test Loss: 0.0208079
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0130218
	speed: 0.1070s/iter; left time: 1163.7954s
	iters: 200, epoch: 52 | loss: 0.0135182
	speed: 0.0462s/iter; left time: 497.6466s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:10.78s
Steps: 224 | Train Loss: 0.0122330 Vali Loss: 0.0185057 Test Loss: 0.0208085
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0123628
	speed: 0.1162s/iter; left time: 1237.6015s
	iters: 200, epoch: 53 | loss: 0.0136013
	speed: 0.0489s/iter; left time: 516.4281s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:11.57s
Steps: 224 | Train Loss: 0.0122287 Vali Loss: 0.0185395 Test Loss: 0.0208171
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0124737
	speed: 0.1097s/iter; left time: 1144.2586s
	iters: 200, epoch: 54 | loss: 0.0119168
	speed: 0.0528s/iter; left time: 544.9805s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:12.56s
Steps: 224 | Train Loss: 0.0122233 Vali Loss: 0.0185316 Test Loss: 0.0208232
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0115388
	speed: 0.0969s/iter; left time: 988.4192s
	iters: 200, epoch: 55 | loss: 0.0133567
	speed: 0.0584s/iter; left time: 590.5362s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:12.14s
Steps: 224 | Train Loss: 0.0122370 Vali Loss: 0.0185180 Test Loss: 0.0208282
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0134816
	speed: 0.1025s/iter; left time: 1022.7812s
	iters: 200, epoch: 56 | loss: 0.0113304
	speed: 0.0492s/iter; left time: 485.9324s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:11.49s
Steps: 224 | Train Loss: 0.0122237 Vali Loss: 0.0184812 Test Loss: 0.0208191
Validation loss decreased (0.018486 --> 0.018481).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0127599
	speed: 0.1228s/iter; left time: 1197.7781s
	iters: 200, epoch: 57 | loss: 0.0126832
	speed: 0.0487s/iter; left time: 470.1340s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:11.19s
Steps: 224 | Train Loss: 0.0122149 Vali Loss: 0.0185322 Test Loss: 0.0208272
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0128764
	speed: 0.1076s/iter; left time: 1025.8135s
	iters: 200, epoch: 58 | loss: 0.0134127
	speed: 0.0420s/iter; left time: 395.8140s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:11.67s
Steps: 224 | Train Loss: 0.0122195 Vali Loss: 0.0185319 Test Loss: 0.0208226
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0128281
	speed: 0.0714s/iter; left time: 664.3876s
	iters: 200, epoch: 59 | loss: 0.0132629
	speed: 0.0470s/iter; left time: 432.9041s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0122318 Vali Loss: 0.0185162 Test Loss: 0.0208412
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0120071
	speed: 0.0985s/iter; left time: 894.8921s
	iters: 200, epoch: 60 | loss: 0.0123658
	speed: 0.0424s/iter; left time: 380.5809s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:11.47s
Steps: 224 | Train Loss: 0.0122378 Vali Loss: 0.0185121 Test Loss: 0.0208320
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0136733
	speed: 0.1227s/iter; left time: 1087.6455s
	iters: 200, epoch: 61 | loss: 0.0110619
	speed: 0.0548s/iter; left time: 479.6697s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:11.57s
Steps: 224 | Train Loss: 0.0122343 Vali Loss: 0.0185155 Test Loss: 0.0208189
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0118293
	speed: 0.1127s/iter; left time: 973.2033s
	iters: 200, epoch: 62 | loss: 0.0110706
	speed: 0.0456s/iter; left time: 389.1568s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:12.87s
Steps: 224 | Train Loss: 0.0122327 Vali Loss: 0.0185753 Test Loss: 0.0208160
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0124438
	speed: 0.0982s/iter; left time: 825.7776s
	iters: 200, epoch: 63 | loss: 0.0103165
	speed: 0.0650s/iter; left time: 540.6758s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:12.78s
Steps: 224 | Train Loss: 0.0122317 Vali Loss: 0.0185079 Test Loss: 0.0208250
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0115705
	speed: 0.1035s/iter; left time: 847.7687s
	iters: 200, epoch: 64 | loss: 0.0128942
	speed: 0.0482s/iter; left time: 389.5647s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:12.07s
Steps: 224 | Train Loss: 0.0122176 Vali Loss: 0.0185142 Test Loss: 0.0208247
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0127902
	speed: 0.1255s/iter; left time: 999.6059s
	iters: 200, epoch: 65 | loss: 0.0122773
	speed: 0.0529s/iter; left time: 415.8707s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:11.59s
Steps: 224 | Train Loss: 0.0122278 Vali Loss: 0.0184961 Test Loss: 0.0208173
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0115899
	speed: 0.1097s/iter; left time: 849.0888s
	iters: 200, epoch: 66 | loss: 0.0130514
	speed: 0.0504s/iter; left time: 385.4667s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:12.76s
Steps: 224 | Train Loss: 0.0122333 Vali Loss: 0.0185431 Test Loss: 0.0208185
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.020819105207920074, rmse:0.14428827166557312, mae:0.09108439832925797, rse:0.5092132687568665
Intermediate time for DE and pred_len 24: 00h:18m:52.55s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0377843
	speed: 0.0664s/iter; left time: 1480.6712s
	iters: 200, epoch: 1 | loss: 0.0344038
	speed: 0.0434s/iter; left time: 963.5698s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.99s
Steps: 224 | Train Loss: 0.0388491 Vali Loss: 0.0371462 Test Loss: 0.0431195
Validation loss decreased (inf --> 0.037146).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0295151
	speed: 0.1346s/iter; left time: 2972.3932s
	iters: 200, epoch: 2 | loss: 0.0236684
	speed: 0.0402s/iter; left time: 883.2348s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.37s
Steps: 224 | Train Loss: 0.0264033 Vali Loss: 0.0309098 Test Loss: 0.0364046
Validation loss decreased (0.037146 --> 0.030910).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0219902
	speed: 0.0939s/iter; left time: 2052.1336s
	iters: 200, epoch: 3 | loss: 0.0236232
	speed: 0.0450s/iter; left time: 978.4734s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.75s
Steps: 224 | Train Loss: 0.0239233 Vali Loss: 0.0303387 Test Loss: 0.0362125
Validation loss decreased (0.030910 --> 0.030339).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0230603
	speed: 0.1200s/iter; left time: 2595.1718s
	iters: 200, epoch: 4 | loss: 0.0216371
	speed: 0.0476s/iter; left time: 1025.1456s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.42s
Steps: 224 | Train Loss: 0.0233313 Vali Loss: 0.0303084 Test Loss: 0.0360353
Validation loss decreased (0.030339 --> 0.030308).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0232691
	speed: 0.1140s/iter; left time: 2440.5904s
	iters: 200, epoch: 5 | loss: 0.0200354
	speed: 0.0644s/iter; left time: 1372.9709s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.60s
Steps: 224 | Train Loss: 0.0229674 Vali Loss: 0.0302206 Test Loss: 0.0355811
Validation loss decreased (0.030308 --> 0.030221).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0257173
	speed: 0.0781s/iter; left time: 1653.3021s
	iters: 200, epoch: 6 | loss: 0.0252964
	speed: 0.0441s/iter; left time: 929.2472s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.37s
Steps: 224 | Train Loss: 0.0226332 Vali Loss: 0.0301113 Test Loss: 0.0356656
Validation loss decreased (0.030221 --> 0.030111).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0228483
	speed: 0.1411s/iter; left time: 2956.4237s
	iters: 200, epoch: 7 | loss: 0.0201746
	speed: 0.0433s/iter; left time: 903.4735s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.37s
Steps: 224 | Train Loss: 0.0223822 Vali Loss: 0.0301649 Test Loss: 0.0361735
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0217567
	speed: 0.1252s/iter; left time: 2594.8327s
	iters: 200, epoch: 8 | loss: 0.0212575
	speed: 0.0566s/iter; left time: 1168.7912s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.55s
Steps: 224 | Train Loss: 0.0221981 Vali Loss: 0.0303818 Test Loss: 0.0366595
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0209937
	speed: 0.1061s/iter; left time: 2176.4208s
	iters: 200, epoch: 9 | loss: 0.0226185
	speed: 0.0535s/iter; left time: 1092.3557s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:12.06s
Steps: 224 | Train Loss: 0.0220167 Vali Loss: 0.0303453 Test Loss: 0.0365737
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0213579
	speed: 0.1082s/iter; left time: 2194.6800s
	iters: 200, epoch: 10 | loss: 0.0205298
	speed: 0.0425s/iter; left time: 857.6942s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.94s
Steps: 224 | Train Loss: 0.0218319 Vali Loss: 0.0301455 Test Loss: 0.0364236
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0205914
	speed: 0.1483s/iter; left time: 2975.4447s
	iters: 200, epoch: 11 | loss: 0.0229521
	speed: 0.0510s/iter; left time: 1018.9159s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.02s
Steps: 224 | Train Loss: 0.0216898 Vali Loss: 0.0301673 Test Loss: 0.0366581
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0213532
	speed: 0.1105s/iter; left time: 2192.2680s
	iters: 200, epoch: 12 | loss: 0.0208601
	speed: 0.0536s/iter; left time: 1057.8349s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:12.29s
Steps: 224 | Train Loss: 0.0215192 Vali Loss: 0.0302230 Test Loss: 0.0368246
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0199397
	speed: 0.1140s/iter; left time: 2236.7315s
	iters: 200, epoch: 13 | loss: 0.0213505
	speed: 0.0566s/iter; left time: 1105.2538s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.79s
Steps: 224 | Train Loss: 0.0213826 Vali Loss: 0.0304040 Test Loss: 0.0372023
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0217223
	speed: 0.1183s/iter; left time: 2293.1308s
	iters: 200, epoch: 14 | loss: 0.0203427
	speed: 0.0478s/iter; left time: 921.3369s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.27s
Steps: 224 | Train Loss: 0.0212423 Vali Loss: 0.0303967 Test Loss: 0.0372141
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0200363
	speed: 0.1387s/iter; left time: 2658.2310s
	iters: 200, epoch: 15 | loss: 0.0214020
	speed: 0.0548s/iter; left time: 1045.4599s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.41s
Steps: 224 | Train Loss: 0.0211565 Vali Loss: 0.0301792 Test Loss: 0.0372579
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0227665
	speed: 0.1230s/iter; left time: 2330.6739s
	iters: 200, epoch: 16 | loss: 0.0229693
	speed: 0.0443s/iter; left time: 834.7340s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.36s
Steps: 224 | Train Loss: 0.0210283 Vali Loss: 0.0303737 Test Loss: 0.0374546
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03566562011837959, rmse:0.1888534426689148, mae:0.12909182906150818, rse:0.6687682271003723
Intermediate time for DE and pred_len 96: 00h:04m:38.76s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0404512
	speed: 0.0849s/iter; left time: 1884.2158s
	iters: 200, epoch: 1 | loss: 0.0355846
	speed: 0.0574s/iter; left time: 1268.2577s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.17s
Steps: 223 | Train Loss: 0.0402154 Vali Loss: 0.0383989 Test Loss: 0.0446866
Validation loss decreased (inf --> 0.038399).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0304991
	speed: 0.1510s/iter; left time: 3318.3208s
	iters: 200, epoch: 2 | loss: 0.0254042
	speed: 0.0690s/iter; left time: 1508.7007s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.10s
Steps: 223 | Train Loss: 0.0286390 Vali Loss: 0.0326475 Test Loss: 0.0383843
Validation loss decreased (0.038399 --> 0.032647).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0274383
	speed: 0.1799s/iter; left time: 3913.8558s
	iters: 200, epoch: 3 | loss: 0.0261717
	speed: 0.0693s/iter; left time: 1499.8781s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.76s
Steps: 223 | Train Loss: 0.0262391 Vali Loss: 0.0323455 Test Loss: 0.0382562
Validation loss decreased (0.032647 --> 0.032346).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0245347
	speed: 0.1978s/iter; left time: 4258.7947s
	iters: 200, epoch: 4 | loss: 0.0272657
	speed: 0.0649s/iter; left time: 1390.4488s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.48s
Steps: 223 | Train Loss: 0.0256516 Vali Loss: 0.0320062 Test Loss: 0.0384216
Validation loss decreased (0.032346 --> 0.032006).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0242917
	speed: 0.1065s/iter; left time: 2269.4284s
	iters: 200, epoch: 5 | loss: 0.0264873
	speed: 0.0371s/iter; left time: 786.0712s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.62s
Steps: 223 | Train Loss: 0.0252095 Vali Loss: 0.0319972 Test Loss: 0.0383190
Validation loss decreased (0.032006 --> 0.031997).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0232972
	speed: 0.1191s/iter; left time: 2512.3451s
	iters: 200, epoch: 6 | loss: 0.0272545
	speed: 0.0593s/iter; left time: 1245.5091s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.41s
Steps: 223 | Train Loss: 0.0248804 Vali Loss: 0.0321177 Test Loss: 0.0387783
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0248502
	speed: 0.1626s/iter; left time: 3391.9986s
	iters: 200, epoch: 7 | loss: 0.0246590
	speed: 0.0609s/iter; left time: 1264.0768s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.44s
Steps: 223 | Train Loss: 0.0245486 Vali Loss: 0.0322575 Test Loss: 0.0385280
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0231809
	speed: 0.1776s/iter; left time: 3664.7994s
	iters: 200, epoch: 8 | loss: 0.0264457
	speed: 0.0693s/iter; left time: 1422.6680s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:16.45s
Steps: 223 | Train Loss: 0.0242934 Vali Loss: 0.0320401 Test Loss: 0.0383450
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0242314
	speed: 0.1477s/iter; left time: 3015.4758s
	iters: 200, epoch: 9 | loss: 0.0211270
	speed: 0.0601s/iter; left time: 1220.9300s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.65s
Steps: 223 | Train Loss: 0.0240388 Vali Loss: 0.0323531 Test Loss: 0.0390620
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0227715
	speed: 0.1534s/iter; left time: 3098.5266s
	iters: 200, epoch: 10 | loss: 0.0230594
	speed: 0.0654s/iter; left time: 1314.7389s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.52s
Steps: 223 | Train Loss: 0.0237923 Vali Loss: 0.0326520 Test Loss: 0.0393335
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0234806
	speed: 0.1480s/iter; left time: 2955.7649s
	iters: 200, epoch: 11 | loss: 0.0218085
	speed: 0.0751s/iter; left time: 1493.1195s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.41s
Steps: 223 | Train Loss: 0.0235347 Vali Loss: 0.0327545 Test Loss: 0.0397263
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0224282
	speed: 0.1723s/iter; left time: 3403.4856s
	iters: 200, epoch: 12 | loss: 0.0245247
	speed: 0.0573s/iter; left time: 1126.1386s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.05s
Steps: 223 | Train Loss: 0.0233189 Vali Loss: 0.0326866 Test Loss: 0.0398961
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0245513
	speed: 0.1618s/iter; left time: 3160.0306s
	iters: 200, epoch: 13 | loss: 0.0234690
	speed: 0.0645s/iter; left time: 1253.2803s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.69s
Steps: 223 | Train Loss: 0.0231075 Vali Loss: 0.0328178 Test Loss: 0.0398631
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0202346
	speed: 0.1602s/iter; left time: 3091.2178s
	iters: 200, epoch: 14 | loss: 0.0251649
	speed: 0.0634s/iter; left time: 1217.6993s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.31s
Steps: 223 | Train Loss: 0.0229071 Vali Loss: 0.0329766 Test Loss: 0.0403753
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0229254
	speed: 0.1855s/iter; left time: 3538.8579s
	iters: 200, epoch: 15 | loss: 0.0261855
	speed: 0.0613s/iter; left time: 1163.3658s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.69s
Steps: 223 | Train Loss: 0.0227360 Vali Loss: 0.0331558 Test Loss: 0.0409875
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03831901401281357, rmse:0.19575242698192596, mae:0.13659459352493286, rse:0.6933708786964417
Intermediate time for DE and pred_len 168: 00h:05m:44.54sIntermediate time for DE: 00h:29m:15.85s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0269724
	speed: 0.0949s/iter; left time: 2117.0566s
	iters: 200, epoch: 1 | loss: 0.0243362
	speed: 0.0577s/iter; left time: 1280.6094s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.06s
Steps: 224 | Train Loss: 0.0302129 Vali Loss: 0.0295490 Test Loss: 0.0403864
Validation loss decreased (inf --> 0.029549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0150994
	speed: 0.1301s/iter; left time: 2873.2971s
	iters: 200, epoch: 2 | loss: 0.0153803
	speed: 0.0772s/iter; left time: 1696.6466s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:16.26s
Steps: 224 | Train Loss: 0.0160300 Vali Loss: 0.0200448 Test Loss: 0.0257564
Validation loss decreased (0.029549 --> 0.020045).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0125600
	speed: 0.1311s/iter; left time: 2865.6311s
	iters: 200, epoch: 3 | loss: 0.0146680
	speed: 0.0579s/iter; left time: 1259.8559s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.43s
Steps: 224 | Train Loss: 0.0141722 Vali Loss: 0.0194474 Test Loss: 0.0255129
Validation loss decreased (0.020045 --> 0.019447).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0126545
	speed: 0.1327s/iter; left time: 2869.7229s
	iters: 200, epoch: 4 | loss: 0.0144309
	speed: 0.0618s/iter; left time: 1330.4901s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.65s
Steps: 224 | Train Loss: 0.0138278 Vali Loss: 0.0195728 Test Loss: 0.0255898
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0136685
	speed: 0.1314s/iter; left time: 2813.2953s
	iters: 200, epoch: 5 | loss: 0.0130324
	speed: 0.0590s/iter; left time: 1256.9042s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.64s
Steps: 224 | Train Loss: 0.0136225 Vali Loss: 0.0192595 Test Loss: 0.0253750
Validation loss decreased (0.019447 --> 0.019259).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0141169
	speed: 0.1540s/iter; left time: 3262.9077s
	iters: 200, epoch: 6 | loss: 0.0152996
	speed: 0.0685s/iter; left time: 1443.1657s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.94s
Steps: 224 | Train Loss: 0.0134702 Vali Loss: 0.0192517 Test Loss: 0.0253149
Validation loss decreased (0.019259 --> 0.019252).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0136902
	speed: 0.1234s/iter; left time: 2586.8724s
	iters: 200, epoch: 7 | loss: 0.0145498
	speed: 0.0653s/iter; left time: 1361.1872s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.39s
Steps: 224 | Train Loss: 0.0133439 Vali Loss: 0.0191847 Test Loss: 0.0253538
Validation loss decreased (0.019252 --> 0.019185).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0131529
	speed: 0.1294s/iter; left time: 2682.9253s
	iters: 200, epoch: 8 | loss: 0.0136596
	speed: 0.0565s/iter; left time: 1165.3310s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:13.61s
Steps: 224 | Train Loss: 0.0132458 Vali Loss: 0.0190764 Test Loss: 0.0249816
Validation loss decreased (0.019185 --> 0.019076).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0127635
	speed: 0.1341s/iter; left time: 2749.5369s
	iters: 200, epoch: 9 | loss: 0.0152654
	speed: 0.0700s/iter; left time: 1428.7750s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0131349 Vali Loss: 0.0190671 Test Loss: 0.0250864
Validation loss decreased (0.019076 --> 0.019067).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0148076
	speed: 0.1325s/iter; left time: 2687.5516s
	iters: 200, epoch: 10 | loss: 0.0125041
	speed: 0.0629s/iter; left time: 1269.6300s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:13.74s
Steps: 224 | Train Loss: 0.0130521 Vali Loss: 0.0188532 Test Loss: 0.0251634
Validation loss decreased (0.019067 --> 0.018853).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0137696
	speed: 0.1191s/iter; left time: 2389.7092s
	iters: 200, epoch: 11 | loss: 0.0129565
	speed: 0.0569s/iter; left time: 1136.0052s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:13.57s
Steps: 224 | Train Loss: 0.0129698 Vali Loss: 0.0189545 Test Loss: 0.0249062
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0138540
	speed: 0.1267s/iter; left time: 2514.1986s
	iters: 200, epoch: 12 | loss: 0.0117907
	speed: 0.0545s/iter; left time: 1075.3879s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.13s
Steps: 224 | Train Loss: 0.0128797 Vali Loss: 0.0189448 Test Loss: 0.0250207
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0122733
	speed: 0.1497s/iter; left time: 2935.8357s
	iters: 200, epoch: 13 | loss: 0.0124052
	speed: 0.0596s/iter; left time: 1162.8773s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.95s
Steps: 224 | Train Loss: 0.0128237 Vali Loss: 0.0189629 Test Loss: 0.0248485
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0136241
	speed: 0.1196s/iter; left time: 2319.5275s
	iters: 200, epoch: 14 | loss: 0.0113933
	speed: 0.0644s/iter; left time: 1241.4276s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:13.78s
Steps: 224 | Train Loss: 0.0127703 Vali Loss: 0.0189413 Test Loss: 0.0249125
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0105021
	speed: 0.1229s/iter; left time: 2355.1425s
	iters: 200, epoch: 15 | loss: 0.0112538
	speed: 0.0582s/iter; left time: 1109.7729s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.84s
Steps: 224 | Train Loss: 0.0127224 Vali Loss: 0.0189495 Test Loss: 0.0250717
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0118816
	speed: 0.1369s/iter; left time: 2592.8825s
	iters: 200, epoch: 16 | loss: 0.0133852
	speed: 0.0708s/iter; left time: 1333.7023s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0126632 Vali Loss: 0.0187300 Test Loss: 0.0250755
Validation loss decreased (0.018853 --> 0.018730).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0128408
	speed: 0.1243s/iter; left time: 2326.6923s
	iters: 200, epoch: 17 | loss: 0.0137415
	speed: 0.0612s/iter; left time: 1139.6783s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.06s
Steps: 224 | Train Loss: 0.0126192 Vali Loss: 0.0188007 Test Loss: 0.0249625
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0120534
	speed: 0.1170s/iter; left time: 2164.2999s
	iters: 200, epoch: 18 | loss: 0.0132773
	speed: 0.0579s/iter; left time: 1064.2629s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:13.56s
Steps: 224 | Train Loss: 0.0126237 Vali Loss: 0.0187780 Test Loss: 0.0249065
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0123758
	speed: 0.1237s/iter; left time: 2260.2447s
	iters: 200, epoch: 19 | loss: 0.0131285
	speed: 0.0468s/iter; left time: 849.6184s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0125494 Vali Loss: 0.0189852 Test Loss: 0.0251082
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0104999
	speed: 0.1079s/iter; left time: 1946.6551s
	iters: 200, epoch: 20 | loss: 0.0119633
	speed: 0.0584s/iter; left time: 1048.6901s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:13.76s
Steps: 224 | Train Loss: 0.0125140 Vali Loss: 0.0189457 Test Loss: 0.0251339
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0133592
	speed: 0.1363s/iter; left time: 2428.5024s
	iters: 200, epoch: 21 | loss: 0.0120427
	speed: 0.0692s/iter; left time: 1227.1416s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:14.69s
Steps: 224 | Train Loss: 0.0124908 Vali Loss: 0.0188245 Test Loss: 0.0249186
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0118607
	speed: 0.1304s/iter; left time: 2295.3449s
	iters: 200, epoch: 22 | loss: 0.0109531
	speed: 0.0607s/iter; left time: 1061.7371s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:14.56s
Steps: 224 | Train Loss: 0.0124526 Vali Loss: 0.0187356 Test Loss: 0.0249374
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0119522
	speed: 0.1434s/iter; left time: 2491.7680s
	iters: 200, epoch: 23 | loss: 0.0112567
	speed: 0.0722s/iter; left time: 1247.4973s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:16.07s
Steps: 224 | Train Loss: 0.0124514 Vali Loss: 0.0188555 Test Loss: 0.0249920
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0119894
	speed: 0.1292s/iter; left time: 2216.1683s
	iters: 200, epoch: 24 | loss: 0.0123275
	speed: 0.0445s/iter; left time: 758.9499s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.01s
Steps: 224 | Train Loss: 0.0124463 Vali Loss: 0.0188186 Test Loss: 0.0249083
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0132149
	speed: 0.1291s/iter; left time: 2184.7322s
	iters: 200, epoch: 25 | loss: 0.0138823
	speed: 0.0669s/iter; left time: 1125.0219s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:14.41s
Steps: 224 | Train Loss: 0.0124279 Vali Loss: 0.0187712 Test Loss: 0.0249708
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0122586
	speed: 0.1518s/iter; left time: 2534.7762s
	iters: 200, epoch: 26 | loss: 0.0116505
	speed: 0.0620s/iter; left time: 1029.8992s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:14.47s
Steps: 224 | Train Loss: 0.0123840 Vali Loss: 0.0188168 Test Loss: 0.0250552
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025075480341911316, rmse:0.15835238993167877, mae:0.10364750027656555, rse:0.5462708473205566
Intermediate time for GB and pred_len 24: 00h:08m:36.83s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0330599
	speed: 0.0721s/iter; left time: 1608.6119s
	iters: 200, epoch: 1 | loss: 0.0320975
	speed: 0.0488s/iter; left time: 1083.7458s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.77s
Steps: 224 | Train Loss: 0.0326172 Vali Loss: 0.0341243 Test Loss: 0.0486324
Validation loss decreased (inf --> 0.034124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0248736
	speed: 0.1356s/iter; left time: 2994.4345s
	iters: 200, epoch: 2 | loss: 0.0204750
	speed: 0.0480s/iter; left time: 1055.6716s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.47s
Steps: 224 | Train Loss: 0.0233874 Vali Loss: 0.0292890 Test Loss: 0.0413262
Validation loss decreased (0.034124 --> 0.029289).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0213269
	speed: 0.1554s/iter; left time: 3395.9949s
	iters: 200, epoch: 3 | loss: 0.0210294
	speed: 0.0511s/iter; left time: 1111.1576s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.65s
Steps: 224 | Train Loss: 0.0218675 Vali Loss: 0.0292476 Test Loss: 0.0413741
Validation loss decreased (0.029289 --> 0.029248).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0207670
	speed: 0.1219s/iter; left time: 2636.4919s
	iters: 200, epoch: 4 | loss: 0.0213264
	speed: 0.0487s/iter; left time: 1048.5725s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.18s
Steps: 224 | Train Loss: 0.0215076 Vali Loss: 0.0292306 Test Loss: 0.0416261
Validation loss decreased (0.029248 --> 0.029231).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0218179
	speed: 0.1079s/iter; left time: 2309.6949s
	iters: 200, epoch: 5 | loss: 0.0186270
	speed: 0.0542s/iter; left time: 1154.9270s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:12.33s
Steps: 224 | Train Loss: 0.0212008 Vali Loss: 0.0290131 Test Loss: 0.0415289
Validation loss decreased (0.029231 --> 0.029013).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0219785
	speed: 0.1077s/iter; left time: 2280.8785s
	iters: 200, epoch: 6 | loss: 0.0216234
	speed: 0.0547s/iter; left time: 1153.5454s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.45s
Steps: 224 | Train Loss: 0.0209583 Vali Loss: 0.0289114 Test Loss: 0.0414900
Validation loss decreased (0.029013 --> 0.028911).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0219029
	speed: 0.1349s/iter; left time: 2827.5189s
	iters: 200, epoch: 7 | loss: 0.0201141
	speed: 0.0520s/iter; left time: 1084.6765s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.79s
Steps: 224 | Train Loss: 0.0207239 Vali Loss: 0.0289981 Test Loss: 0.0413217
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0213522
	speed: 0.1377s/iter; left time: 2855.3276s
	iters: 200, epoch: 8 | loss: 0.0198995
	speed: 0.0517s/iter; left time: 1066.8311s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0205090 Vali Loss: 0.0290755 Test Loss: 0.0419447
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0203818
	speed: 0.1119s/iter; left time: 2294.0607s
	iters: 200, epoch: 9 | loss: 0.0208378
	speed: 0.0504s/iter; left time: 1029.2805s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:13.07s
Steps: 224 | Train Loss: 0.0202890 Vali Loss: 0.0291642 Test Loss: 0.0433464
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0215469
	speed: 0.0802s/iter; left time: 1627.7250s
	iters: 200, epoch: 10 | loss: 0.0189829
	speed: 0.0403s/iter; left time: 813.6639s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.80s
Steps: 224 | Train Loss: 0.0201078 Vali Loss: 0.0291582 Test Loss: 0.0431275
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0196008
	speed: 0.1197s/iter; left time: 2401.1102s
	iters: 200, epoch: 11 | loss: 0.0204214
	speed: 0.0534s/iter; left time: 1066.5709s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.55s
Steps: 224 | Train Loss: 0.0199237 Vali Loss: 0.0290428 Test Loss: 0.0433948
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0214353
	speed: 0.1452s/iter; left time: 2880.7847s
	iters: 200, epoch: 12 | loss: 0.0202651
	speed: 0.0460s/iter; left time: 908.0462s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.33s
Steps: 224 | Train Loss: 0.0197674 Vali Loss: 0.0287947 Test Loss: 0.0423261
Validation loss decreased (0.028911 --> 0.028795).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0199370
	speed: 0.1579s/iter; left time: 3097.2591s
	iters: 200, epoch: 13 | loss: 0.0198088
	speed: 0.0503s/iter; left time: 980.7151s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.20s
Steps: 224 | Train Loss: 0.0195824 Vali Loss: 0.0293069 Test Loss: 0.0439301
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0197234
	speed: 0.1392s/iter; left time: 2699.0323s
	iters: 200, epoch: 14 | loss: 0.0186938
	speed: 0.0530s/iter; left time: 1022.9801s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.91s
Steps: 224 | Train Loss: 0.0194025 Vali Loss: 0.0294660 Test Loss: 0.0436790
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0176121
	speed: 0.1200s/iter; left time: 2299.3362s
	iters: 200, epoch: 15 | loss: 0.0187093
	speed: 0.0555s/iter; left time: 1058.0709s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.26s
Steps: 224 | Train Loss: 0.0192549 Vali Loss: 0.0296301 Test Loss: 0.0443228
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0197526
	speed: 0.1209s/iter; left time: 2289.9882s
	iters: 200, epoch: 16 | loss: 0.0209090
	speed: 0.0619s/iter; left time: 1166.0985s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:13.32s
Steps: 224 | Train Loss: 0.0191137 Vali Loss: 0.0298030 Test Loss: 0.0447214
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0185755
	speed: 0.1009s/iter; left time: 1888.2981s
	iters: 200, epoch: 17 | loss: 0.0183995
	speed: 0.0401s/iter; left time: 745.7428s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.86s
Steps: 224 | Train Loss: 0.0189747 Vali Loss: 0.0297888 Test Loss: 0.0445576
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0186117
	speed: 0.1168s/iter; left time: 2160.6665s
	iters: 200, epoch: 18 | loss: 0.0184859
	speed: 0.0502s/iter; left time: 922.6528s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.29s
Steps: 224 | Train Loss: 0.0188568 Vali Loss: 0.0300322 Test Loss: 0.0449636
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0194068
	speed: 0.1304s/iter; left time: 2382.0724s
	iters: 200, epoch: 19 | loss: 0.0204162
	speed: 0.0452s/iter; left time: 821.4111s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.19s
Steps: 224 | Train Loss: 0.0187836 Vali Loss: 0.0299262 Test Loss: 0.0444477
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0171403
	speed: 0.1235s/iter; left time: 2229.1043s
	iters: 200, epoch: 20 | loss: 0.0184043
	speed: 0.0503s/iter; left time: 902.0645s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.99s
Steps: 224 | Train Loss: 0.0186674 Vali Loss: 0.0300881 Test Loss: 0.0449346
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0191293
	speed: 0.1142s/iter; left time: 2035.0315s
	iters: 200, epoch: 21 | loss: 0.0157105
	speed: 0.0595s/iter; left time: 1054.7874s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:13.43s
Steps: 224 | Train Loss: 0.0186050 Vali Loss: 0.0299886 Test Loss: 0.0451011
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0181225
	speed: 0.1128s/iter; left time: 1984.6494s
	iters: 200, epoch: 22 | loss: 0.0193367
	speed: 0.0533s/iter; left time: 931.7766s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:12.27s
Steps: 224 | Train Loss: 0.0185242 Vali Loss: 0.0302375 Test Loss: 0.0453603
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.042326126247644424, rmse:0.20573315024375916, mae:0.14367079734802246, rse:0.711453914642334
Intermediate time for GB and pred_len 96: 00h:06m:35.78s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0324556
	speed: 0.0669s/iter; left time: 1484.2263s
	iters: 200, epoch: 1 | loss: 0.0294266
	speed: 0.0447s/iter; left time: 986.8875s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.19s
Steps: 223 | Train Loss: 0.0334026 Vali Loss: 0.0353121 Test Loss: 0.0505240
Validation loss decreased (inf --> 0.035312).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0253777
	speed: 0.1231s/iter; left time: 2704.9071s
	iters: 200, epoch: 2 | loss: 0.0229065
	speed: 0.0490s/iter; left time: 1072.6404s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.65s
Steps: 223 | Train Loss: 0.0249163 Vali Loss: 0.0309957 Test Loss: 0.0438974
Validation loss decreased (0.035312 --> 0.030996).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0244064
	speed: 0.1089s/iter; left time: 2368.8973s
	iters: 200, epoch: 3 | loss: 0.0227683
	speed: 0.0548s/iter; left time: 1186.7974s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.06s
Steps: 223 | Train Loss: 0.0233406 Vali Loss: 0.0306889 Test Loss: 0.0435962
Validation loss decreased (0.030996 --> 0.030689).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0229893
	speed: 0.1143s/iter; left time: 2461.5903s
	iters: 200, epoch: 4 | loss: 0.0252356
	speed: 0.0499s/iter; left time: 1069.7177s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.37s
Steps: 223 | Train Loss: 0.0229192 Vali Loss: 0.0309550 Test Loss: 0.0438111
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0214661
	speed: 0.1358s/iter; left time: 2894.1252s
	iters: 200, epoch: 5 | loss: 0.0242698
	speed: 0.0500s/iter; left time: 1060.6659s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.02s
Steps: 223 | Train Loss: 0.0225604 Vali Loss: 0.0310903 Test Loss: 0.0442144
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0217058
	speed: 0.1231s/iter; left time: 2595.5265s
	iters: 200, epoch: 6 | loss: 0.0224381
	speed: 0.0541s/iter; left time: 1136.1254s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.50s
Steps: 223 | Train Loss: 0.0222235 Vali Loss: 0.0310295 Test Loss: 0.0448184
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0219715
	speed: 0.1057s/iter; left time: 2205.3009s
	iters: 200, epoch: 7 | loss: 0.0198097
	speed: 0.0564s/iter; left time: 1170.4516s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:12.31s
Steps: 223 | Train Loss: 0.0219527 Vali Loss: 0.0310001 Test Loss: 0.0459959
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0215335
	speed: 0.1103s/iter; left time: 2276.4955s
	iters: 200, epoch: 8 | loss: 0.0237119
	speed: 0.0499s/iter; left time: 1024.1760s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.27s
Steps: 223 | Train Loss: 0.0217264 Vali Loss: 0.0306654 Test Loss: 0.0454366
Validation loss decreased (0.030689 --> 0.030665).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0217619
	speed: 0.1486s/iter; left time: 3034.0733s
	iters: 200, epoch: 9 | loss: 0.0194218
	speed: 0.0505s/iter; left time: 1026.0671s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.60s
Steps: 223 | Train Loss: 0.0215284 Vali Loss: 0.0308548 Test Loss: 0.0461860
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0203193
	speed: 0.1241s/iter; left time: 2505.8855s
	iters: 200, epoch: 10 | loss: 0.0218020
	speed: 0.0512s/iter; left time: 1029.4043s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.38s
Steps: 223 | Train Loss: 0.0213034 Vali Loss: 0.0310266 Test Loss: 0.0474695
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0209533
	speed: 0.1086s/iter; left time: 2168.0828s
	iters: 200, epoch: 11 | loss: 0.0206968
	speed: 0.0610s/iter; left time: 1211.4503s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.48s
Steps: 223 | Train Loss: 0.0211460 Vali Loss: 0.0307943 Test Loss: 0.0460785
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0194066
	speed: 0.1100s/iter; left time: 2172.6223s
	iters: 200, epoch: 12 | loss: 0.0205669
	speed: 0.0468s/iter; left time: 919.2826s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.11s
Steps: 223 | Train Loss: 0.0209543 Vali Loss: 0.0309621 Test Loss: 0.0466941
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0209157
	speed: 0.1305s/iter; left time: 2547.7339s
	iters: 200, epoch: 13 | loss: 0.0217956
	speed: 0.0357s/iter; left time: 693.6325s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.87s
Steps: 223 | Train Loss: 0.0207500 Vali Loss: 0.0310574 Test Loss: 0.0467395
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0201685
	speed: 0.0900s/iter; left time: 1737.1115s
	iters: 200, epoch: 14 | loss: 0.0209625
	speed: 0.0554s/iter; left time: 1063.2732s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.09s
Steps: 223 | Train Loss: 0.0206069 Vali Loss: 0.0311464 Test Loss: 0.0473922
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0213707
	speed: 0.1168s/iter; left time: 2228.1034s
	iters: 200, epoch: 15 | loss: 0.0221779
	speed: 0.0542s/iter; left time: 1028.2778s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.75s
Steps: 223 | Train Loss: 0.0204338 Vali Loss: 0.0315270 Test Loss: 0.0482186
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0207527
	speed: 0.1145s/iter; left time: 2159.6316s
	iters: 200, epoch: 16 | loss: 0.0220013
	speed: 0.0549s/iter; left time: 1029.4716s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.21s
Steps: 223 | Train Loss: 0.0202920 Vali Loss: 0.0313826 Test Loss: 0.0471232
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0202375
	speed: 0.1286s/iter; left time: 2396.3411s
	iters: 200, epoch: 17 | loss: 0.0214163
	speed: 0.0499s/iter; left time: 923.9435s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.79s
Steps: 223 | Train Loss: 0.0201838 Vali Loss: 0.0314722 Test Loss: 0.0471828
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0205100
	speed: 0.1199s/iter; left time: 2207.4392s
	iters: 200, epoch: 18 | loss: 0.0198990
	speed: 0.0499s/iter; left time: 913.4533s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.50s
Steps: 223 | Train Loss: 0.0200635 Vali Loss: 0.0314998 Test Loss: 0.0473011
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.045436594635248184, rmse:0.21315860748291016, mae:0.1511395126581192, rse:0.7390515208244324
Intermediate time for GB and pred_len 168: 00h:05m:17.05sIntermediate time for GB: 00h:20m:29.67s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0296890
	speed: 0.0636s/iter; left time: 1418.9647s
	iters: 200, epoch: 1 | loss: 0.0237544
	speed: 0.0316s/iter; left time: 702.1954s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0329008 Vali Loss: 0.0190733 Test Loss: 0.0246103
Validation loss decreased (inf --> 0.019073).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0116199
	speed: 0.0752s/iter; left time: 1659.3678s
	iters: 200, epoch: 2 | loss: 0.0107149
	speed: 0.0344s/iter; left time: 756.0972s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.47s
Steps: 224 | Train Loss: 0.0124929 Vali Loss: 0.0097106 Test Loss: 0.0120963
Validation loss decreased (0.019073 --> 0.009711).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0093019
	speed: 0.0783s/iter; left time: 1712.0487s
	iters: 200, epoch: 3 | loss: 0.0094715
	speed: 0.0379s/iter; left time: 824.7608s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.0097760 Vali Loss: 0.0089975 Test Loss: 0.0112857
Validation loss decreased (0.009711 --> 0.008997).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0086354
	speed: 0.0812s/iter; left time: 1755.5133s
	iters: 200, epoch: 4 | loss: 0.0091337
	speed: 0.0316s/iter; left time: 679.5160s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.0090991 Vali Loss: 0.0086354 Test Loss: 0.0108668
Validation loss decreased (0.008997 --> 0.008635).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0083218
	speed: 0.0765s/iter; left time: 1638.3038s
	iters: 200, epoch: 5 | loss: 0.0086437
	speed: 0.0295s/iter; left time: 628.8241s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.44s
Steps: 224 | Train Loss: 0.0086944 Vali Loss: 0.0083791 Test Loss: 0.0106129
Validation loss decreased (0.008635 --> 0.008379).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0074544
	speed: 0.0730s/iter; left time: 1546.9106s
	iters: 200, epoch: 6 | loss: 0.0082814
	speed: 0.0334s/iter; left time: 704.7319s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.68s
Steps: 224 | Train Loss: 0.0084254 Vali Loss: 0.0082155 Test Loss: 0.0103570
Validation loss decreased (0.008379 --> 0.008215).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0101399
	speed: 0.0800s/iter; left time: 1677.0133s
	iters: 200, epoch: 7 | loss: 0.0085558
	speed: 0.0337s/iter; left time: 703.1976s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0082341 Vali Loss: 0.0081511 Test Loss: 0.0103137
Validation loss decreased (0.008215 --> 0.008151).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0085888
	speed: 0.0762s/iter; left time: 1579.7588s
	iters: 200, epoch: 8 | loss: 0.0073330
	speed: 0.0305s/iter; left time: 629.3303s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.22s
Steps: 224 | Train Loss: 0.0080856 Vali Loss: 0.0080615 Test Loss: 0.0102863
Validation loss decreased (0.008151 --> 0.008062).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0083045
	speed: 0.0765s/iter; left time: 1567.9369s
	iters: 200, epoch: 9 | loss: 0.0074788
	speed: 0.0336s/iter; left time: 686.4912s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.53s
Steps: 224 | Train Loss: 0.0079546 Vali Loss: 0.0079857 Test Loss: 0.0101347
Validation loss decreased (0.008062 --> 0.007986).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0087893
	speed: 0.0782s/iter; left time: 1586.2101s
	iters: 200, epoch: 10 | loss: 0.0075799
	speed: 0.0296s/iter; left time: 598.4523s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.32s
Steps: 224 | Train Loss: 0.0078699 Vali Loss: 0.0079657 Test Loss: 0.0100636
Validation loss decreased (0.007986 --> 0.007966).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0083630
	speed: 0.0793s/iter; left time: 1590.1206s
	iters: 200, epoch: 11 | loss: 0.0083637
	speed: 0.0298s/iter; left time: 594.8909s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.07s
Steps: 224 | Train Loss: 0.0078086 Vali Loss: 0.0079774 Test Loss: 0.0101389
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0080166
	speed: 0.0788s/iter; left time: 1563.7166s
	iters: 200, epoch: 12 | loss: 0.0074236
	speed: 0.0315s/iter; left time: 622.4686s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.34s
Steps: 224 | Train Loss: 0.0077407 Vali Loss: 0.0078617 Test Loss: 0.0100172
Validation loss decreased (0.007966 --> 0.007862).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0070259
	speed: 0.0766s/iter; left time: 1501.5707s
	iters: 200, epoch: 13 | loss: 0.0064969
	speed: 0.0277s/iter; left time: 539.7558s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.41s
Steps: 224 | Train Loss: 0.0076735 Vali Loss: 0.0078890 Test Loss: 0.0099257
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0083835
	speed: 0.0809s/iter; left time: 1568.3910s
	iters: 200, epoch: 14 | loss: 0.0070978
	speed: 0.0352s/iter; left time: 679.4157s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0076318 Vali Loss: 0.0078510 Test Loss: 0.0099501
Validation loss decreased (0.007862 --> 0.007851).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0073405
	speed: 0.0712s/iter; left time: 1364.7115s
	iters: 200, epoch: 15 | loss: 0.0070576
	speed: 0.0322s/iter; left time: 613.4928s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.22s
Steps: 224 | Train Loss: 0.0075842 Vali Loss: 0.0077827 Test Loss: 0.0098846
Validation loss decreased (0.007851 --> 0.007783).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0066532
	speed: 0.0744s/iter; left time: 1409.1273s
	iters: 200, epoch: 16 | loss: 0.0075404
	speed: 0.0338s/iter; left time: 636.8557s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0075499 Vali Loss: 0.0078112 Test Loss: 0.0098918
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0072845
	speed: 0.0728s/iter; left time: 1362.5500s
	iters: 200, epoch: 17 | loss: 0.0075278
	speed: 0.0364s/iter; left time: 678.4131s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.69s
Steps: 224 | Train Loss: 0.0075029 Vali Loss: 0.0077626 Test Loss: 0.0098836
Validation loss decreased (0.007783 --> 0.007763).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0070151
	speed: 0.0572s/iter; left time: 1057.5788s
	iters: 200, epoch: 18 | loss: 0.0067206
	speed: 0.0233s/iter; left time: 428.7176s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.39s
Steps: 224 | Train Loss: 0.0074731 Vali Loss: 0.0077108 Test Loss: 0.0098255
Validation loss decreased (0.007763 --> 0.007711).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0076519
	speed: 0.0546s/iter; left time: 996.6237s
	iters: 200, epoch: 19 | loss: 0.0072590
	speed: 0.0332s/iter; left time: 604.0107s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.17s
Steps: 224 | Train Loss: 0.0074561 Vali Loss: 0.0077372 Test Loss: 0.0098622
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0074429
	speed: 0.0819s/iter; left time: 1477.1287s
	iters: 200, epoch: 20 | loss: 0.0081411
	speed: 0.0297s/iter; left time: 532.3863s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0074083 Vali Loss: 0.0077439 Test Loss: 0.0098159
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0075138
	speed: 0.0783s/iter; left time: 1394.8427s
	iters: 200, epoch: 21 | loss: 0.0077157
	speed: 0.0315s/iter; left time: 558.3217s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0073987 Vali Loss: 0.0077213 Test Loss: 0.0098094
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0079712
	speed: 0.0855s/iter; left time: 1504.2407s
	iters: 200, epoch: 22 | loss: 0.0067386
	speed: 0.0331s/iter; left time: 579.6989s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.27s
Steps: 224 | Train Loss: 0.0073739 Vali Loss: 0.0076907 Test Loss: 0.0097665
Validation loss decreased (0.007711 --> 0.007691).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0069302
	speed: 0.0891s/iter; left time: 1547.8979s
	iters: 200, epoch: 23 | loss: 0.0073624
	speed: 0.0408s/iter; left time: 705.4595s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0073590 Vali Loss: 0.0077081 Test Loss: 0.0097860
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0074125
	speed: 0.1093s/iter; left time: 1873.7194s
	iters: 200, epoch: 24 | loss: 0.0077528
	speed: 0.0396s/iter; left time: 675.9697s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.39s
Steps: 224 | Train Loss: 0.0073373 Vali Loss: 0.0077147 Test Loss: 0.0097757
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0084801
	speed: 0.0980s/iter; left time: 1659.2641s
	iters: 200, epoch: 25 | loss: 0.0073303
	speed: 0.0413s/iter; left time: 695.2205s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.34s
Steps: 224 | Train Loss: 0.0073261 Vali Loss: 0.0076876 Test Loss: 0.0097680
Validation loss decreased (0.007691 --> 0.007688).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0075227
	speed: 0.0986s/iter; left time: 1647.3918s
	iters: 200, epoch: 26 | loss: 0.0073098
	speed: 0.0392s/iter; left time: 650.0628s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.11s
Steps: 224 | Train Loss: 0.0073206 Vali Loss: 0.0077104 Test Loss: 0.0097499
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0066695
	speed: 0.1103s/iter; left time: 1816.6040s
	iters: 200, epoch: 27 | loss: 0.0084324
	speed: 0.0460s/iter; left time: 753.1385s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.67s
Steps: 224 | Train Loss: 0.0072957 Vali Loss: 0.0077138 Test Loss: 0.0097647
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0059264
	speed: 0.0959s/iter; left time: 1557.9681s
	iters: 200, epoch: 28 | loss: 0.0072996
	speed: 0.0393s/iter; left time: 634.7760s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0072941 Vali Loss: 0.0076749 Test Loss: 0.0097210
Validation loss decreased (0.007688 --> 0.007675).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0069776
	speed: 0.1001s/iter; left time: 1603.9535s
	iters: 200, epoch: 29 | loss: 0.0073290
	speed: 0.0380s/iter; left time: 604.7992s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.05s
Steps: 224 | Train Loss: 0.0072689 Vali Loss: 0.0076519 Test Loss: 0.0097318
Validation loss decreased (0.007675 --> 0.007652).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0072907
	speed: 0.0996s/iter; left time: 1573.9871s
	iters: 200, epoch: 30 | loss: 0.0072649
	speed: 0.0371s/iter; left time: 582.5170s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.51s
Steps: 224 | Train Loss: 0.0072635 Vali Loss: 0.0076725 Test Loss: 0.0097222
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0075929
	speed: 0.0966s/iter; left time: 1505.1194s
	iters: 200, epoch: 31 | loss: 0.0085643
	speed: 0.0465s/iter; left time: 720.4831s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.84s
Steps: 224 | Train Loss: 0.0072595 Vali Loss: 0.0076283 Test Loss: 0.0097321
Validation loss decreased (0.007652 --> 0.007628).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0068163
	speed: 0.1045s/iter; left time: 1604.8593s
	iters: 200, epoch: 32 | loss: 0.0068024
	speed: 0.0427s/iter; left time: 650.7120s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:10.22s
Steps: 224 | Train Loss: 0.0072530 Vali Loss: 0.0076806 Test Loss: 0.0097346
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0077122
	speed: 0.0897s/iter; left time: 1357.2723s
	iters: 200, epoch: 33 | loss: 0.0074561
	speed: 0.0445s/iter; left time: 668.2823s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.0072397 Vali Loss: 0.0076467 Test Loss: 0.0097170
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0078902
	speed: 0.0899s/iter; left time: 1339.7985s
	iters: 200, epoch: 34 | loss: 0.0068785
	speed: 0.0484s/iter; left time: 716.8394s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:10.16s
Steps: 224 | Train Loss: 0.0072408 Vali Loss: 0.0076447 Test Loss: 0.0097050
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0074193
	speed: 0.0870s/iter; left time: 1277.6801s
	iters: 200, epoch: 35 | loss: 0.0073635
	speed: 0.0471s/iter; left time: 686.4820s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0072479 Vali Loss: 0.0076825 Test Loss: 0.0097164
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0075246
	speed: 0.1072s/iter; left time: 1549.8557s
	iters: 200, epoch: 36 | loss: 0.0068101
	speed: 0.0490s/iter; left time: 704.1861s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:10.88s
Steps: 224 | Train Loss: 0.0072440 Vali Loss: 0.0076385 Test Loss: 0.0097149
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0068397
	speed: 0.0899s/iter; left time: 1279.9625s
	iters: 200, epoch: 37 | loss: 0.0073553
	speed: 0.0465s/iter; left time: 657.1650s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:10.06s
Steps: 224 | Train Loss: 0.0072382 Vali Loss: 0.0076576 Test Loss: 0.0097067
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0065189
	speed: 0.0923s/iter; left time: 1293.8674s
	iters: 200, epoch: 38 | loss: 0.0077119
	speed: 0.0504s/iter; left time: 701.5504s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:10.46s
Steps: 224 | Train Loss: 0.0072418 Vali Loss: 0.0076496 Test Loss: 0.0097053
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0072017
	speed: 0.0923s/iter; left time: 1272.2152s
	iters: 200, epoch: 39 | loss: 0.0068445
	speed: 0.0508s/iter; left time: 694.8471s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:10.68s
Steps: 224 | Train Loss: 0.0072241 Vali Loss: 0.0076411 Test Loss: 0.0097058
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0064202
	speed: 0.1032s/iter; left time: 1400.2378s
	iters: 200, epoch: 40 | loss: 0.0071409
	speed: 0.0560s/iter; left time: 754.1648s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0072160 Vali Loss: 0.0076559 Test Loss: 0.0097114
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0072009
	speed: 0.0931s/iter; left time: 1241.8648s
	iters: 200, epoch: 41 | loss: 0.0074637
	speed: 0.0449s/iter; left time: 594.5727s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:10.01s
Steps: 224 | Train Loss: 0.0072244 Vali Loss: 0.0076395 Test Loss: 0.0096962
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.00973209086805582, rmse:0.09865135699510574, mae:0.060730285942554474, rse:0.29031902551651
Intermediate time for ES and pred_len 24: 00h:08m:40.03s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0309228
	speed: 0.0551s/iter; left time: 1229.7799s
	iters: 200, epoch: 1 | loss: 0.0244755
	speed: 0.0362s/iter; left time: 804.7248s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0342055 Vali Loss: 0.0226442 Test Loss: 0.0286723
Validation loss decreased (inf --> 0.022644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0189586
	speed: 0.1378s/iter; left time: 3041.1119s
	iters: 200, epoch: 2 | loss: 0.0158069
	speed: 0.0503s/iter; left time: 1104.7825s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:12.51s
Steps: 224 | Train Loss: 0.0182901 Vali Loss: 0.0165065 Test Loss: 0.0204272
Validation loss decreased (0.022644 --> 0.016506).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0157190
	speed: 0.1254s/iter; left time: 2740.7390s
	iters: 200, epoch: 3 | loss: 0.0146123
	speed: 0.0405s/iter; left time: 881.5793s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.09s
Steps: 224 | Train Loss: 0.0157535 Vali Loss: 0.0156040 Test Loss: 0.0193479
Validation loss decreased (0.016506 --> 0.015604).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0148218
	speed: 0.1281s/iter; left time: 2770.4105s
	iters: 200, epoch: 4 | loss: 0.0146640
	speed: 0.0447s/iter; left time: 962.2575s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.05s
Steps: 224 | Train Loss: 0.0150019 Vali Loss: 0.0154184 Test Loss: 0.0190234
Validation loss decreased (0.015604 --> 0.015418).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0142901
	speed: 0.1242s/iter; left time: 2657.7461s
	iters: 200, epoch: 5 | loss: 0.0133076
	speed: 0.0255s/iter; left time: 543.5870s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.53s
Steps: 224 | Train Loss: 0.0145813 Vali Loss: 0.0150859 Test Loss: 0.0186584
Validation loss decreased (0.015418 --> 0.015086).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0143639
	speed: 0.0724s/iter; left time: 1533.7826s
	iters: 200, epoch: 6 | loss: 0.0143160
	speed: 0.0385s/iter; left time: 811.2298s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.12s
Steps: 224 | Train Loss: 0.0142854 Vali Loss: 0.0149837 Test Loss: 0.0185050
Validation loss decreased (0.015086 --> 0.014984).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0144117
	speed: 0.1519s/iter; left time: 3183.2084s
	iters: 200, epoch: 7 | loss: 0.0131367
	speed: 0.0630s/iter; left time: 1314.4052s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.43s
Steps: 224 | Train Loss: 0.0140586 Vali Loss: 0.0148926 Test Loss: 0.0182597
Validation loss decreased (0.014984 --> 0.014893).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0140473
	speed: 0.1388s/iter; left time: 2878.0148s
	iters: 200, epoch: 8 | loss: 0.0135981
	speed: 0.0693s/iter; left time: 1429.8117s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:13.84s
Steps: 224 | Train Loss: 0.0139104 Vali Loss: 0.0148134 Test Loss: 0.0183719
Validation loss decreased (0.014893 --> 0.014813).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0138677
	speed: 0.1296s/iter; left time: 2658.1521s
	iters: 200, epoch: 9 | loss: 0.0129254
	speed: 0.0649s/iter; left time: 1324.7005s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:13.65s
Steps: 224 | Train Loss: 0.0137508 Vali Loss: 0.0147350 Test Loss: 0.0181817
Validation loss decreased (0.014813 --> 0.014735).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0146253
	speed: 0.1554s/iter; left time: 3152.8680s
	iters: 200, epoch: 10 | loss: 0.0145938
	speed: 0.0609s/iter; left time: 1228.8994s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.62s
Steps: 224 | Train Loss: 0.0136046 Vali Loss: 0.0147417 Test Loss: 0.0182025
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0133169
	speed: 0.1644s/iter; left time: 3297.8493s
	iters: 200, epoch: 11 | loss: 0.0142514
	speed: 0.0533s/iter; left time: 1063.3108s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.82s
Steps: 224 | Train Loss: 0.0134796 Vali Loss: 0.0147851 Test Loss: 0.0181727
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0135381
	speed: 0.1606s/iter; left time: 3186.6268s
	iters: 200, epoch: 12 | loss: 0.0134822
	speed: 0.0533s/iter; left time: 1051.1577s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.27s
Steps: 224 | Train Loss: 0.0133539 Vali Loss: 0.0147297 Test Loss: 0.0181911
Validation loss decreased (0.014735 --> 0.014730).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0121429
	speed: 0.1758s/iter; left time: 3446.9937s
	iters: 200, epoch: 13 | loss: 0.0133668
	speed: 0.0495s/iter; left time: 965.4897s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.84s
Steps: 224 | Train Loss: 0.0132528 Vali Loss: 0.0148262 Test Loss: 0.0182404
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0116928
	speed: 0.1594s/iter; left time: 3091.4192s
	iters: 200, epoch: 14 | loss: 0.0132391
	speed: 0.0477s/iter; left time: 920.4998s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:13.19s
Steps: 224 | Train Loss: 0.0131951 Vali Loss: 0.0147897 Test Loss: 0.0182665
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0122485
	speed: 0.1298s/iter; left time: 2487.5700s
	iters: 200, epoch: 15 | loss: 0.0145092
	speed: 0.0621s/iter; left time: 1184.8316s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.01s
Steps: 224 | Train Loss: 0.0130912 Vali Loss: 0.0149205 Test Loss: 0.0182158
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0130883
	speed: 0.1501s/iter; left time: 2843.5236s
	iters: 200, epoch: 16 | loss: 0.0134652
	speed: 0.0628s/iter; left time: 1183.2257s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:13.74s
Steps: 224 | Train Loss: 0.0129957 Vali Loss: 0.0149039 Test Loss: 0.0183016
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0127407
	speed: 0.1116s/iter; left time: 2089.2602s
	iters: 200, epoch: 17 | loss: 0.0138984
	speed: 0.0422s/iter; left time: 785.0125s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0129110 Vali Loss: 0.0149141 Test Loss: 0.0182459
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0134658
	speed: 0.1244s/iter; left time: 2300.0877s
	iters: 200, epoch: 18 | loss: 0.0132504
	speed: 0.0451s/iter; left time: 829.0458s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0128538 Vali Loss: 0.0148301 Test Loss: 0.0181864
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0130002
	speed: 0.0592s/iter; left time: 1082.3587s
	iters: 200, epoch: 19 | loss: 0.0141721
	speed: 0.0367s/iter; left time: 667.5381s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.16s
Steps: 224 | Train Loss: 0.0127877 Vali Loss: 0.0150252 Test Loss: 0.0182931
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0118381
	speed: 0.0907s/iter; left time: 1636.6244s
	iters: 200, epoch: 20 | loss: 0.0125709
	speed: 0.0567s/iter; left time: 1016.9838s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.42s
Steps: 224 | Train Loss: 0.0127468 Vali Loss: 0.0150428 Test Loss: 0.0182738
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0119616
	speed: 0.0973s/iter; left time: 1734.3317s
	iters: 200, epoch: 21 | loss: 0.0113186
	speed: 0.0446s/iter; left time: 790.8293s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0126835 Vali Loss: 0.0149792 Test Loss: 0.0182552
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0137008
	speed: 0.1025s/iter; left time: 1804.5472s
	iters: 200, epoch: 22 | loss: 0.0129450
	speed: 0.0455s/iter; left time: 796.5745s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.26s
Steps: 224 | Train Loss: 0.0126265 Vali Loss: 0.0150438 Test Loss: 0.0182974
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01819109171628952, rmse:0.1348743587732315, mae:0.08794556558132172, rse:0.39622026681900024
Intermediate time for ES and pred_len 96: 00h:06m:40.79s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0327703
	speed: 0.0641s/iter; left time: 1422.7227s
	iters: 200, epoch: 1 | loss: 0.0277364
	speed: 0.0435s/iter; left time: 961.3649s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.58s
Steps: 223 | Train Loss: 0.0350410 Vali Loss: 0.0238507 Test Loss: 0.0296973
Validation loss decreased (inf --> 0.023851).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0199245
	speed: 0.1145s/iter; left time: 2517.2741s
	iters: 200, epoch: 2 | loss: 0.0166473
	speed: 0.0448s/iter; left time: 979.4956s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.94s
Steps: 223 | Train Loss: 0.0197155 Vali Loss: 0.0186296 Test Loss: 0.0224006
Validation loss decreased (0.023851 --> 0.018630).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0183971
	speed: 0.1097s/iter; left time: 2387.2392s
	iters: 200, epoch: 3 | loss: 0.0177713
	speed: 0.0326s/iter; left time: 706.2489s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.59s
Steps: 223 | Train Loss: 0.0172167 Vali Loss: 0.0177712 Test Loss: 0.0211671
Validation loss decreased (0.018630 --> 0.017771).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0174361
	speed: 0.0605s/iter; left time: 1302.7380s
	iters: 200, epoch: 4 | loss: 0.0157802
	speed: 0.0393s/iter; left time: 842.2135s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.19s
Steps: 223 | Train Loss: 0.0164956 Vali Loss: 0.0173551 Test Loss: 0.0206725
Validation loss decreased (0.017771 --> 0.017355).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0168731
	speed: 0.1029s/iter; left time: 2191.6926s
	iters: 200, epoch: 5 | loss: 0.0152332
	speed: 0.0509s/iter; left time: 1079.3175s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.40s
Steps: 223 | Train Loss: 0.0160609 Vali Loss: 0.0171954 Test Loss: 0.0203742
Validation loss decreased (0.017355 --> 0.017195).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0153892
	speed: 0.0991s/iter; left time: 2089.3214s
	iters: 200, epoch: 6 | loss: 0.0156782
	speed: 0.0510s/iter; left time: 1069.8379s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.79s
Steps: 223 | Train Loss: 0.0157492 Vali Loss: 0.0170438 Test Loss: 0.0202812
Validation loss decreased (0.017195 --> 0.017044).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0157425
	speed: 0.1027s/iter; left time: 2142.8339s
	iters: 200, epoch: 7 | loss: 0.0153941
	speed: 0.0518s/iter; left time: 1075.4837s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.14s
Steps: 223 | Train Loss: 0.0154863 Vali Loss: 0.0169180 Test Loss: 0.0201942
Validation loss decreased (0.017044 --> 0.016918).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0142000
	speed: 0.1121s/iter; left time: 2313.0750s
	iters: 200, epoch: 8 | loss: 0.0152045
	speed: 0.0420s/iter; left time: 861.6695s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.21s
Steps: 223 | Train Loss: 0.0152446 Vali Loss: 0.0170044 Test Loss: 0.0203218
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0152434
	speed: 0.1320s/iter; left time: 2695.3751s
	iters: 200, epoch: 9 | loss: 0.0145945
	speed: 0.0453s/iter; left time: 920.8837s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.00s
Steps: 223 | Train Loss: 0.0150549 Vali Loss: 0.0169346 Test Loss: 0.0202678
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0148309
	speed: 0.1180s/iter; left time: 2382.4281s
	iters: 200, epoch: 10 | loss: 0.0151564
	speed: 0.0451s/iter; left time: 906.0058s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.86s
Steps: 223 | Train Loss: 0.0148671 Vali Loss: 0.0169728 Test Loss: 0.0202405
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0145157
	speed: 0.1124s/iter; left time: 2244.3829s
	iters: 200, epoch: 11 | loss: 0.0137834
	speed: 0.0430s/iter; left time: 854.6198s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.72s
Steps: 223 | Train Loss: 0.0147031 Vali Loss: 0.0170753 Test Loss: 0.0201891
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0135146
	speed: 0.0886s/iter; left time: 1750.1451s
	iters: 200, epoch: 12 | loss: 0.0152712
	speed: 0.0567s/iter; left time: 1114.4220s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.58s
Steps: 223 | Train Loss: 0.0145602 Vali Loss: 0.0170106 Test Loss: 0.0202370
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0140620
	speed: 0.0938s/iter; left time: 1831.6130s
	iters: 200, epoch: 13 | loss: 0.0136154
	speed: 0.0531s/iter; left time: 1031.5584s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.51s
Steps: 223 | Train Loss: 0.0143957 Vali Loss: 0.0172204 Test Loss: 0.0203622
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0139850
	speed: 0.0885s/iter; left time: 1707.6003s
	iters: 200, epoch: 14 | loss: 0.0148465
	speed: 0.0415s/iter; left time: 797.6370s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.10s
Steps: 223 | Train Loss: 0.0142812 Vali Loss: 0.0173684 Test Loss: 0.0203415
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0141903
	speed: 0.1223s/iter; left time: 2332.8992s
	iters: 200, epoch: 15 | loss: 0.0156419
	speed: 0.0487s/iter; left time: 924.5823s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.86s
Steps: 223 | Train Loss: 0.0141361 Vali Loss: 0.0175488 Test Loss: 0.0205400
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0146647
	speed: 0.1135s/iter; left time: 2140.0844s
	iters: 200, epoch: 16 | loss: 0.0141779
	speed: 0.0412s/iter; left time: 772.9944s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.22s
Steps: 223 | Train Loss: 0.0140371 Vali Loss: 0.0176834 Test Loss: 0.0205687
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0134907
	speed: 0.1038s/iter; left time: 1933.7283s
	iters: 200, epoch: 17 | loss: 0.0134168
	speed: 0.0383s/iter; left time: 708.9371s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.83s
Steps: 223 | Train Loss: 0.0139591 Vali Loss: 0.0176696 Test Loss: 0.0204780
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0201941579580307, rmse:0.14210614562034607, mae:0.09476298838853836, rse:0.41749510169029236
Intermediate time for ES and pred_len 168: 00h:04m:25.17sIntermediate time for ES: 00h:19m:45.99s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0163190
	speed: 0.0544s/iter; left time: 1214.2560s
	iters: 200, epoch: 1 | loss: 0.0146600
	speed: 0.0416s/iter; left time: 924.5395s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0202520 Vali Loss: 0.0160400 Test Loss: 0.0191508
Validation loss decreased (inf --> 0.016040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0066351
	speed: 0.0951s/iter; left time: 2100.3451s
	iters: 200, epoch: 2 | loss: 0.0067104
	speed: 0.0354s/iter; left time: 778.4421s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0081940 Vali Loss: 0.0096639 Test Loss: 0.0110337
Validation loss decreased (0.016040 --> 0.009664).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0066599
	speed: 0.0950s/iter; left time: 2075.5629s
	iters: 200, epoch: 3 | loss: 0.0061675
	speed: 0.0255s/iter; left time: 553.9086s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.38s
Steps: 224 | Train Loss: 0.0066374 Vali Loss: 0.0091936 Test Loss: 0.0107437
Validation loss decreased (0.009664 --> 0.009194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0064794
	speed: 0.0533s/iter; left time: 1153.0197s
	iters: 200, epoch: 4 | loss: 0.0069979
	speed: 0.0311s/iter; left time: 668.7697s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.50s
Steps: 224 | Train Loss: 0.0062819 Vali Loss: 0.0089752 Test Loss: 0.0104317
Validation loss decreased (0.009194 --> 0.008975).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0059530
	speed: 0.0819s/iter; left time: 1753.4147s
	iters: 200, epoch: 5 | loss: 0.0070641
	speed: 0.0386s/iter; left time: 822.9779s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.83s
Steps: 224 | Train Loss: 0.0060674 Vali Loss: 0.0087049 Test Loss: 0.0102102
Validation loss decreased (0.008975 --> 0.008705).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0063576
	speed: 0.0819s/iter; left time: 1735.2260s
	iters: 200, epoch: 6 | loss: 0.0049777
	speed: 0.0347s/iter; left time: 731.9350s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.22s
Steps: 224 | Train Loss: 0.0059176 Vali Loss: 0.0086892 Test Loss: 0.0103117
Validation loss decreased (0.008705 --> 0.008689).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0069176
	speed: 0.0806s/iter; left time: 1689.9213s
	iters: 200, epoch: 7 | loss: 0.0063449
	speed: 0.0346s/iter; left time: 721.5283s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0057757 Vali Loss: 0.0085956 Test Loss: 0.0101283
Validation loss decreased (0.008689 --> 0.008596).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0059064
	speed: 0.0844s/iter; left time: 1750.4521s
	iters: 200, epoch: 8 | loss: 0.0056319
	speed: 0.0388s/iter; left time: 800.0644s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.64s
Steps: 224 | Train Loss: 0.0057092 Vali Loss: 0.0085681 Test Loss: 0.0100957
Validation loss decreased (0.008596 --> 0.008568).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0048203
	speed: 0.0826s/iter; left time: 1694.0421s
	iters: 200, epoch: 9 | loss: 0.0059386
	speed: 0.0349s/iter; left time: 713.1985s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.13s
Steps: 224 | Train Loss: 0.0056026 Vali Loss: 0.0084239 Test Loss: 0.0101090
Validation loss decreased (0.008568 --> 0.008424).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0058560
	speed: 0.0812s/iter; left time: 1647.4570s
	iters: 200, epoch: 10 | loss: 0.0055602
	speed: 0.0341s/iter; left time: 688.8113s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.49s
Steps: 224 | Train Loss: 0.0055465 Vali Loss: 0.0083629 Test Loss: 0.0101492
Validation loss decreased (0.008424 --> 0.008363).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0054779
	speed: 0.0782s/iter; left time: 1568.5426s
	iters: 200, epoch: 11 | loss: 0.0054597
	speed: 0.0343s/iter; left time: 685.1674s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0054899 Vali Loss: 0.0084630 Test Loss: 0.0102342
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0050498
	speed: 0.0802s/iter; left time: 1590.8331s
	iters: 200, epoch: 12 | loss: 0.0049490
	speed: 0.0385s/iter; left time: 759.0275s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.63s
Steps: 224 | Train Loss: 0.0054395 Vali Loss: 0.0083584 Test Loss: 0.0100740
Validation loss decreased (0.008363 --> 0.008358).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0054406
	speed: 0.0856s/iter; left time: 1678.9852s
	iters: 200, epoch: 13 | loss: 0.0047616
	speed: 0.0369s/iter; left time: 720.7773s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.42s
Steps: 224 | Train Loss: 0.0054074 Vali Loss: 0.0084354 Test Loss: 0.0101401
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0050504
	speed: 0.0825s/iter; left time: 1598.9079s
	iters: 200, epoch: 14 | loss: 0.0054030
	speed: 0.0330s/iter; left time: 636.0145s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.18s
Steps: 224 | Train Loss: 0.0053647 Vali Loss: 0.0083279 Test Loss: 0.0101184
Validation loss decreased (0.008358 --> 0.008328).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0053471
	speed: 0.0844s/iter; left time: 1616.8035s
	iters: 200, epoch: 15 | loss: 0.0043377
	speed: 0.0384s/iter; left time: 732.3532s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.70s
Steps: 224 | Train Loss: 0.0053162 Vali Loss: 0.0083566 Test Loss: 0.0100685
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0049260
	speed: 0.0829s/iter; left time: 1570.2516s
	iters: 200, epoch: 16 | loss: 0.0048694
	speed: 0.0360s/iter; left time: 679.1593s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.64s
Steps: 224 | Train Loss: 0.0052947 Vali Loss: 0.0083633 Test Loss: 0.0101274
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0060960
	speed: 0.0845s/iter; left time: 1580.8268s
	iters: 200, epoch: 17 | loss: 0.0050376
	speed: 0.0379s/iter; left time: 705.5866s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.77s
Steps: 224 | Train Loss: 0.0052817 Vali Loss: 0.0083467 Test Loss: 0.0100814
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0048779
	speed: 0.0791s/iter; left time: 1463.4473s
	iters: 200, epoch: 18 | loss: 0.0047544
	speed: 0.0250s/iter; left time: 460.1482s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.71s
Steps: 224 | Train Loss: 0.0052451 Vali Loss: 0.0082610 Test Loss: 0.0100459
Validation loss decreased (0.008328 --> 0.008261).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0045703
	speed: 0.0535s/iter; left time: 977.4847s
	iters: 200, epoch: 19 | loss: 0.0048963
	speed: 0.0239s/iter; left time: 433.8940s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.87s
Steps: 224 | Train Loss: 0.0052210 Vali Loss: 0.0083092 Test Loss: 0.0100771
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0050457
	speed: 0.0817s/iter; left time: 1473.6391s
	iters: 200, epoch: 20 | loss: 0.0050213
	speed: 0.0384s/iter; left time: 688.5427s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0051960 Vali Loss: 0.0082870 Test Loss: 0.0100884
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0052502
	speed: 0.0800s/iter; left time: 1426.4232s
	iters: 200, epoch: 21 | loss: 0.0049596
	speed: 0.0381s/iter; left time: 674.7705s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.81s
Steps: 224 | Train Loss: 0.0051845 Vali Loss: 0.0082839 Test Loss: 0.0100520
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0050836
	speed: 0.0856s/iter; left time: 1507.1230s
	iters: 200, epoch: 22 | loss: 0.0041651
	speed: 0.0347s/iter; left time: 607.1565s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.86s
Steps: 224 | Train Loss: 0.0051848 Vali Loss: 0.0083158 Test Loss: 0.0100871
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0051514
	speed: 0.0892s/iter; left time: 1549.4638s
	iters: 200, epoch: 23 | loss: 0.0056497
	speed: 0.0379s/iter; left time: 655.1541s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.05s
Steps: 224 | Train Loss: 0.0051422 Vali Loss: 0.0083156 Test Loss: 0.0100756
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0049192
	speed: 0.0876s/iter; left time: 1502.2883s
	iters: 200, epoch: 24 | loss: 0.0047177
	speed: 0.0404s/iter; left time: 689.4526s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.24s
Steps: 224 | Train Loss: 0.0051442 Vali Loss: 0.0083113 Test Loss: 0.0101006
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0050956
	speed: 0.0833s/iter; left time: 1409.0926s
	iters: 200, epoch: 25 | loss: 0.0054086
	speed: 0.0394s/iter; left time: 663.3180s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.79s
Steps: 224 | Train Loss: 0.0051337 Vali Loss: 0.0082635 Test Loss: 0.0101114
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0049215
	speed: 0.0808s/iter; left time: 1350.0991s
	iters: 200, epoch: 26 | loss: 0.0042607
	speed: 0.0419s/iter; left time: 695.2608s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.69s
Steps: 224 | Train Loss: 0.0051240 Vali Loss: 0.0082871 Test Loss: 0.0101289
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0053276
	speed: 0.0892s/iter; left time: 1469.0890s
	iters: 200, epoch: 27 | loss: 0.0058882
	speed: 0.0383s/iter; left time: 626.7117s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.80s
Steps: 224 | Train Loss: 0.0051055 Vali Loss: 0.0082980 Test Loss: 0.0100792
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0057416
	speed: 0.0973s/iter; left time: 1581.1841s
	iters: 200, epoch: 28 | loss: 0.0043777
	speed: 0.0423s/iter; left time: 683.0535s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.45s
Steps: 224 | Train Loss: 0.0050962 Vali Loss: 0.0083100 Test Loss: 0.0101125
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010045873932540417, rmse:0.10022910684347153, mae:0.058125320822000504, rse:0.38668110966682434
Intermediate time for FR and pred_len 24: 00h:05m:41.44s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0192468
	speed: 0.0735s/iter; left time: 1638.7207s
	iters: 200, epoch: 1 | loss: 0.0168081
	speed: 0.0560s/iter; left time: 1243.0840s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.35s
Steps: 224 | Train Loss: 0.0214459 Vali Loss: 0.0186825 Test Loss: 0.0227955
Validation loss decreased (inf --> 0.018682).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0140202
	speed: 0.1517s/iter; left time: 3349.0851s
	iters: 200, epoch: 2 | loss: 0.0098686
	speed: 0.0633s/iter; left time: 1390.2830s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.33s
Steps: 224 | Train Loss: 0.0122427 Vali Loss: 0.0151879 Test Loss: 0.0189364
Validation loss decreased (0.018682 --> 0.015188).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0105417
	speed: 0.1200s/iter; left time: 2622.8552s
	iters: 200, epoch: 3 | loss: 0.0104323
	speed: 0.0569s/iter; left time: 1238.6915s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.65s
Steps: 224 | Train Loss: 0.0107077 Vali Loss: 0.0143052 Test Loss: 0.0187372
Validation loss decreased (0.015188 --> 0.014305).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0098304
	speed: 0.1205s/iter; left time: 2607.0778s
	iters: 200, epoch: 4 | loss: 0.0106838
	speed: 0.0509s/iter; left time: 1096.5264s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:12.80s
Steps: 224 | Train Loss: 0.0102742 Vali Loss: 0.0140303 Test Loss: 0.0184560
Validation loss decreased (0.014305 --> 0.014030).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0104062
	speed: 0.1245s/iter; left time: 2665.6016s
	iters: 200, epoch: 5 | loss: 0.0088304
	speed: 0.0395s/iter; left time: 841.8861s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.19s
Steps: 224 | Train Loss: 0.0099902 Vali Loss: 0.0139883 Test Loss: 0.0185109
Validation loss decreased (0.014030 --> 0.013988).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0112083
	speed: 0.0879s/iter; left time: 1862.5477s
	iters: 200, epoch: 6 | loss: 0.0089282
	speed: 0.0497s/iter; left time: 1046.9285s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.43s
Steps: 224 | Train Loss: 0.0097728 Vali Loss: 0.0139388 Test Loss: 0.0186560
Validation loss decreased (0.013988 --> 0.013939).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0108884
	speed: 0.1485s/iter; left time: 3112.5526s
	iters: 200, epoch: 7 | loss: 0.0092326
	speed: 0.0659s/iter; left time: 1373.4391s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.58s
Steps: 224 | Train Loss: 0.0096038 Vali Loss: 0.0141724 Test Loss: 0.0186877
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0100623
	speed: 0.1268s/iter; left time: 2628.0025s
	iters: 200, epoch: 8 | loss: 0.0087844
	speed: 0.0665s/iter; left time: 1372.4295s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.08s
Steps: 224 | Train Loss: 0.0094615 Vali Loss: 0.0140696 Test Loss: 0.0183964
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0090472
	speed: 0.1424s/iter; left time: 2921.2276s
	iters: 200, epoch: 9 | loss: 0.0091278
	speed: 0.0658s/iter; left time: 1342.5450s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0093288 Vali Loss: 0.0139739 Test Loss: 0.0187636
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0093390
	speed: 0.1413s/iter; left time: 2866.3405s
	iters: 200, epoch: 10 | loss: 0.0084434
	speed: 0.0487s/iter; left time: 983.0949s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:12.18s
Steps: 224 | Train Loss: 0.0091933 Vali Loss: 0.0140088 Test Loss: 0.0184228
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0094005
	speed: 0.1756s/iter; left time: 3522.1266s
	iters: 200, epoch: 11 | loss: 0.0085185
	speed: 0.0541s/iter; left time: 1079.1116s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:12.06s
Steps: 224 | Train Loss: 0.0090669 Vali Loss: 0.0143414 Test Loss: 0.0190096
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0090827
	speed: 0.1775s/iter; left time: 3520.4966s
	iters: 200, epoch: 12 | loss: 0.0082314
	speed: 0.0644s/iter; left time: 1270.9345s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.97s
Steps: 224 | Train Loss: 0.0089487 Vali Loss: 0.0141372 Test Loss: 0.0194590
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0093521
	speed: 0.1630s/iter; left time: 3197.0117s
	iters: 200, epoch: 13 | loss: 0.0087221
	speed: 0.0472s/iter; left time: 921.5198s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.90s
Steps: 224 | Train Loss: 0.0088474 Vali Loss: 0.0141513 Test Loss: 0.0195888
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0090534
	speed: 0.1495s/iter; left time: 2899.1199s
	iters: 200, epoch: 14 | loss: 0.0085698
	speed: 0.0510s/iter; left time: 983.7746s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:13.84s
Steps: 224 | Train Loss: 0.0087251 Vali Loss: 0.0144129 Test Loss: 0.0194788
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0078854
	speed: 0.1578s/iter; left time: 3024.7998s
	iters: 200, epoch: 15 | loss: 0.0094088
	speed: 0.0638s/iter; left time: 1215.7399s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.26s
Steps: 224 | Train Loss: 0.0086403 Vali Loss: 0.0144602 Test Loss: 0.0199399
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0091333
	speed: 0.1343s/iter; left time: 2544.7052s
	iters: 200, epoch: 16 | loss: 0.0093283
	speed: 0.0640s/iter; left time: 1206.0336s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.92s
Steps: 224 | Train Loss: 0.0085441 Vali Loss: 0.0146382 Test Loss: 0.0203037
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01865600049495697, rmse:0.1365869641304016, mae:0.0842278003692627, rse:0.5283547043800354
Intermediate time for FR and pred_len 96: 00h:05m:25.57s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0217671
	speed: 0.0760s/iter; left time: 1687.2711s
	iters: 200, epoch: 1 | loss: 0.0174734
	speed: 0.0483s/iter; left time: 1066.8366s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.88s
Steps: 223 | Train Loss: 0.0221774 Vali Loss: 0.0196754 Test Loss: 0.0230590
Validation loss decreased (inf --> 0.019675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0151478
	speed: 0.1619s/iter; left time: 3558.6095s
	iters: 200, epoch: 2 | loss: 0.0122771
	speed: 0.0515s/iter; left time: 1126.7788s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.92s
Steps: 223 | Train Loss: 0.0134631 Vali Loss: 0.0164465 Test Loss: 0.0201141
Validation loss decreased (0.019675 --> 0.016447).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0134099
	speed: 0.1432s/iter; left time: 3114.7897s
	iters: 200, epoch: 3 | loss: 0.0106679
	speed: 0.0515s/iter; left time: 1114.2820s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:12.70s
Steps: 223 | Train Loss: 0.0118243 Vali Loss: 0.0154997 Test Loss: 0.0201013
Validation loss decreased (0.016447 --> 0.015500).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0110507
	speed: 0.1313s/iter; left time: 2826.7481s
	iters: 200, epoch: 4 | loss: 0.0124329
	speed: 0.0604s/iter; left time: 1294.3673s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.61s
Steps: 223 | Train Loss: 0.0113176 Vali Loss: 0.0154131 Test Loss: 0.0202327
Validation loss decreased (0.015500 --> 0.015413).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0114767
	speed: 0.1510s/iter; left time: 3217.0880s
	iters: 200, epoch: 5 | loss: 0.0113688
	speed: 0.0515s/iter; left time: 1092.2614s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.68s
Steps: 223 | Train Loss: 0.0110176 Vali Loss: 0.0152929 Test Loss: 0.0205191
Validation loss decreased (0.015413 --> 0.015293).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0099502
	speed: 0.1506s/iter; left time: 3174.9071s
	iters: 200, epoch: 6 | loss: 0.0114028
	speed: 0.0469s/iter; left time: 984.0613s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.07s
Steps: 223 | Train Loss: 0.0108221 Vali Loss: 0.0151385 Test Loss: 0.0205659
Validation loss decreased (0.015293 --> 0.015139).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0116266
	speed: 0.1398s/iter; left time: 2915.7130s
	iters: 200, epoch: 7 | loss: 0.0108079
	speed: 0.0568s/iter; left time: 1178.8676s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.92s
Steps: 223 | Train Loss: 0.0106779 Vali Loss: 0.0152505 Test Loss: 0.0202467
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0092505
	speed: 0.1495s/iter; left time: 3085.2713s
	iters: 200, epoch: 8 | loss: 0.0118105
	speed: 0.0542s/iter; left time: 1114.0854s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:12.92s
Steps: 223 | Train Loss: 0.0105538 Vali Loss: 0.0151836 Test Loss: 0.0212055
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0112282
	speed: 0.0479s/iter; left time: 977.9044s
	iters: 200, epoch: 9 | loss: 0.0087360
	speed: 0.0239s/iter; left time: 485.5004s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.69s
Steps: 223 | Train Loss: 0.0104307 Vali Loss: 0.0151765 Test Loss: 0.0207481
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0098023
	speed: 0.0868s/iter; left time: 1752.7006s
	iters: 200, epoch: 10 | loss: 0.0097993
	speed: 0.0284s/iter; left time: 570.1199s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.83s
Steps: 223 | Train Loss: 0.0103014 Vali Loss: 0.0152652 Test Loss: 0.0218221
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0115547
	speed: 0.0619s/iter; left time: 1235.7968s
	iters: 200, epoch: 11 | loss: 0.0088405
	speed: 0.0471s/iter; left time: 936.0981s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.06s
Steps: 223 | Train Loss: 0.0101679 Vali Loss: 0.0155769 Test Loss: 0.0223729
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0094300
	speed: 0.1061s/iter; left time: 2095.8478s
	iters: 200, epoch: 12 | loss: 0.0104352
	speed: 0.0447s/iter; left time: 878.0499s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.18s
Steps: 223 | Train Loss: 0.0100577 Vali Loss: 0.0154377 Test Loss: 0.0223074
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0102223
	speed: 0.1029s/iter; left time: 2008.5873s
	iters: 200, epoch: 13 | loss: 0.0098616
	speed: 0.0493s/iter; left time: 958.5676s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.79s
Steps: 223 | Train Loss: 0.0098909 Vali Loss: 0.0153592 Test Loss: 0.0219094
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0099257
	speed: 0.0966s/iter; left time: 1864.1323s
	iters: 200, epoch: 14 | loss: 0.0105992
	speed: 0.0382s/iter; left time: 734.4563s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.96s
Steps: 223 | Train Loss: 0.0097699 Vali Loss: 0.0154899 Test Loss: 0.0228119
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0090252
	speed: 0.1321s/iter; left time: 2520.5384s
	iters: 200, epoch: 15 | loss: 0.0107843
	speed: 0.0378s/iter; left time: 717.9941s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.50s
Steps: 223 | Train Loss: 0.0096513 Vali Loss: 0.0157378 Test Loss: 0.0234815
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0110678
	speed: 0.1335s/iter; left time: 2516.6332s
	iters: 200, epoch: 16 | loss: 0.0095977
	speed: 0.0327s/iter; left time: 612.7315s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.54s
Steps: 223 | Train Loss: 0.0095612 Vali Loss: 0.0156056 Test Loss: 0.0231728
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020565837621688843, rmse:0.143407940864563, mae:0.0905294120311737, rse:0.5554324984550476
Intermediate time for FR and pred_len 168: 00h:04m:36.80sIntermediate time for FR: 00h:15m:43.82s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0337719
	speed: 0.0748s/iter; left time: 1667.5996s
	iters: 200, epoch: 1 | loss: 0.0257990
	speed: 0.0368s/iter; left time: 816.2001s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.75s
Steps: 224 | Train Loss: 0.0372998 Vali Loss: 0.0199048 Test Loss: 0.0213673
Validation loss decreased (inf --> 0.019905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0146027
	speed: 0.0806s/iter; left time: 1778.8062s
	iters: 200, epoch: 2 | loss: 0.0115269
	speed: 0.0412s/iter; left time: 906.2576s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.11s
Steps: 224 | Train Loss: 0.0142875 Vali Loss: 0.0105368 Test Loss: 0.0117939
Validation loss decreased (0.019905 --> 0.010537).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0094670
	speed: 0.0772s/iter; left time: 1686.9764s
	iters: 200, epoch: 3 | loss: 0.0109080
	speed: 0.0407s/iter; left time: 884.3749s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.80s
Steps: 224 | Train Loss: 0.0111489 Vali Loss: 0.0099324 Test Loss: 0.0110654
Validation loss decreased (0.010537 --> 0.009932).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0104475
	speed: 0.0932s/iter; left time: 2015.7451s
	iters: 200, epoch: 4 | loss: 0.0092308
	speed: 0.0391s/iter; left time: 840.8819s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.14s
Steps: 224 | Train Loss: 0.0104576 Vali Loss: 0.0096689 Test Loss: 0.0106889
Validation loss decreased (0.009932 --> 0.009669).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0101719
	speed: 0.0785s/iter; left time: 1679.2972s
	iters: 200, epoch: 5 | loss: 0.0100693
	speed: 0.0479s/iter; left time: 1020.8139s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0100438 Vali Loss: 0.0094782 Test Loss: 0.0104772
Validation loss decreased (0.009669 --> 0.009478).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0088217
	speed: 0.0747s/iter; left time: 1581.6100s
	iters: 200, epoch: 6 | loss: 0.0084346
	speed: 0.0410s/iter; left time: 864.8501s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.46s
Steps: 224 | Train Loss: 0.0098076 Vali Loss: 0.0093499 Test Loss: 0.0103677
Validation loss decreased (0.009478 --> 0.009350).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0102884
	speed: 0.0907s/iter; left time: 1900.0656s
	iters: 200, epoch: 7 | loss: 0.0085527
	speed: 0.0388s/iter; left time: 809.9692s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.39s
Steps: 224 | Train Loss: 0.0096329 Vali Loss: 0.0092716 Test Loss: 0.0102219
Validation loss decreased (0.009350 --> 0.009272).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0093430
	speed: 0.0819s/iter; left time: 1698.3422s
	iters: 200, epoch: 8 | loss: 0.0086638
	speed: 0.0461s/iter; left time: 950.3896s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0094812 Vali Loss: 0.0092745 Test Loss: 0.0102459
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0080648
	speed: 0.0765s/iter; left time: 1569.9152s
	iters: 200, epoch: 9 | loss: 0.0098493
	speed: 0.0400s/iter; left time: 816.5297s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.70s
Steps: 224 | Train Loss: 0.0093521 Vali Loss: 0.0092073 Test Loss: 0.0102064
Validation loss decreased (0.009272 --> 0.009207).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0094067
	speed: 0.0931s/iter; left time: 1888.5345s
	iters: 200, epoch: 10 | loss: 0.0087228
	speed: 0.0409s/iter; left time: 825.9592s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0092702 Vali Loss: 0.0091450 Test Loss: 0.0101353
Validation loss decreased (0.009207 --> 0.009145).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0100116
	speed: 0.0836s/iter; left time: 1677.2674s
	iters: 200, epoch: 11 | loss: 0.0076847
	speed: 0.0422s/iter; left time: 843.2451s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0092088 Vali Loss: 0.0092084 Test Loss: 0.0101961
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0085566
	speed: 0.0746s/iter; left time: 1479.5862s
	iters: 200, epoch: 12 | loss: 0.0099394
	speed: 0.0425s/iter; left time: 839.3870s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.07s
Steps: 224 | Train Loss: 0.0091057 Vali Loss: 0.0090851 Test Loss: 0.0100833
Validation loss decreased (0.009145 --> 0.009085).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0082878
	speed: 0.0950s/iter; left time: 1862.9662s
	iters: 200, epoch: 13 | loss: 0.0094125
	speed: 0.0318s/iter; left time: 619.6207s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0090499 Vali Loss: 0.0091029 Test Loss: 0.0100914
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0104545
	speed: 0.0967s/iter; left time: 1875.6651s
	iters: 200, epoch: 14 | loss: 0.0091111
	speed: 0.0315s/iter; left time: 607.8311s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.34s
Steps: 224 | Train Loss: 0.0089776 Vali Loss: 0.0090998 Test Loss: 0.0100945
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0089378
	speed: 0.0834s/iter; left time: 1598.7685s
	iters: 200, epoch: 15 | loss: 0.0082186
	speed: 0.0445s/iter; left time: 849.0974s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.11s
Steps: 224 | Train Loss: 0.0089379 Vali Loss: 0.0090437 Test Loss: 0.0100269
Validation loss decreased (0.009085 --> 0.009044).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0095094
	speed: 0.0925s/iter; left time: 1752.9039s
	iters: 200, epoch: 16 | loss: 0.0091797
	speed: 0.0321s/iter; left time: 604.0603s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0088961 Vali Loss: 0.0090957 Test Loss: 0.0100385
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0103442
	speed: 0.1009s/iter; left time: 1887.7796s
	iters: 200, epoch: 17 | loss: 0.0105167
	speed: 0.0336s/iter; left time: 625.6839s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.78s
Steps: 224 | Train Loss: 0.0088648 Vali Loss: 0.0090046 Test Loss: 0.0099948
Validation loss decreased (0.009044 --> 0.009005).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0080705
	speed: 0.0915s/iter; left time: 1692.4111s
	iters: 200, epoch: 18 | loss: 0.0091674
	speed: 0.0391s/iter; left time: 719.6138s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0088095 Vali Loss: 0.0089891 Test Loss: 0.0100064
Validation loss decreased (0.009005 --> 0.008989).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0084524
	speed: 0.0606s/iter; left time: 1107.5950s
	iters: 200, epoch: 19 | loss: 0.0092970
	speed: 0.0235s/iter; left time: 426.1623s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.94s
Steps: 224 | Train Loss: 0.0087701 Vali Loss: 0.0090202 Test Loss: 0.0099850
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0084774
	speed: 0.0609s/iter; left time: 1099.1839s
	iters: 200, epoch: 20 | loss: 0.0082826
	speed: 0.0336s/iter; left time: 602.8586s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.25s
Steps: 224 | Train Loss: 0.0087392 Vali Loss: 0.0089616 Test Loss: 0.0099696
Validation loss decreased (0.008989 --> 0.008962).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0093423
	speed: 0.0820s/iter; left time: 1461.7483s
	iters: 200, epoch: 21 | loss: 0.0084285
	speed: 0.0325s/iter; left time: 576.5965s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0087088 Vali Loss: 0.0089967 Test Loss: 0.0099756
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0086534
	speed: 0.0827s/iter; left time: 1455.2713s
	iters: 200, epoch: 22 | loss: 0.0072769
	speed: 0.0370s/iter; left time: 647.6512s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0086855 Vali Loss: 0.0090156 Test Loss: 0.0100246
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0082621
	speed: 0.0840s/iter; left time: 1460.0945s
	iters: 200, epoch: 23 | loss: 0.0077030
	speed: 0.0341s/iter; left time: 589.3892s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0086702 Vali Loss: 0.0090501 Test Loss: 0.0100442
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0095401
	speed: 0.0838s/iter; left time: 1436.8825s
	iters: 200, epoch: 24 | loss: 0.0083708
	speed: 0.0341s/iter; left time: 581.6863s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.11s
Steps: 224 | Train Loss: 0.0086297 Vali Loss: 0.0089953 Test Loss: 0.0100381
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0075658
	speed: 0.0879s/iter; left time: 1488.5287s
	iters: 200, epoch: 25 | loss: 0.0090909
	speed: 0.0342s/iter; left time: 574.8488s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.13s
Steps: 224 | Train Loss: 0.0086283 Vali Loss: 0.0089546 Test Loss: 0.0100080
Validation loss decreased (0.008962 --> 0.008955).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0093857
	speed: 0.0850s/iter; left time: 1420.1487s
	iters: 200, epoch: 26 | loss: 0.0090390
	speed: 0.0339s/iter; left time: 563.3276s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0086089 Vali Loss: 0.0089541 Test Loss: 0.0099845
Validation loss decreased (0.008955 --> 0.008954).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0090468
	speed: 0.0846s/iter; left time: 1394.1454s
	iters: 200, epoch: 27 | loss: 0.0093831
	speed: 0.0336s/iter; left time: 550.6140s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.24s
Steps: 224 | Train Loss: 0.0085981 Vali Loss: 0.0089757 Test Loss: 0.0099962
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0089399
	speed: 0.0845s/iter; left time: 1373.9456s
	iters: 200, epoch: 28 | loss: 0.0079743
	speed: 0.0332s/iter; left time: 537.0184s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0085586 Vali Loss: 0.0089295 Test Loss: 0.0099634
Validation loss decreased (0.008954 --> 0.008930).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0084361
	speed: 0.0865s/iter; left time: 1386.4688s
	iters: 200, epoch: 29 | loss: 0.0077757
	speed: 0.0327s/iter; left time: 520.3649s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0085565 Vali Loss: 0.0089361 Test Loss: 0.0100059
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0087085
	speed: 0.0845s/iter; left time: 1335.0557s
	iters: 200, epoch: 30 | loss: 0.0095842
	speed: 0.0333s/iter; left time: 522.8796s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0085303 Vali Loss: 0.0089562 Test Loss: 0.0099901
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0080835
	speed: 0.0831s/iter; left time: 1295.4918s
	iters: 200, epoch: 31 | loss: 0.0094568
	speed: 0.0363s/iter; left time: 561.2539s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.55s
Steps: 224 | Train Loss: 0.0085279 Vali Loss: 0.0089598 Test Loss: 0.0100058
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0082462
	speed: 0.0837s/iter; left time: 1284.7822s
	iters: 200, epoch: 32 | loss: 0.0096425
	speed: 0.0333s/iter; left time: 508.7048s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.28s
Steps: 224 | Train Loss: 0.0085532 Vali Loss: 0.0089628 Test Loss: 0.0099933
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0080213
	speed: 0.0783s/iter; left time: 1184.3373s
	iters: 200, epoch: 33 | loss: 0.0084753
	speed: 0.0342s/iter; left time: 514.7524s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.12s
Steps: 224 | Train Loss: 0.0085203 Vali Loss: 0.0089441 Test Loss: 0.0099886
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0096172
	speed: 0.0823s/iter; left time: 1226.4733s
	iters: 200, epoch: 34 | loss: 0.0091738
	speed: 0.0327s/iter; left time: 484.3545s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.23s
Steps: 224 | Train Loss: 0.0085164 Vali Loss: 0.0089387 Test Loss: 0.0099906
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0081549
	speed: 0.0832s/iter; left time: 1221.5979s
	iters: 200, epoch: 35 | loss: 0.0083837
	speed: 0.0349s/iter; left time: 509.2585s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.52s
Steps: 224 | Train Loss: 0.0085096 Vali Loss: 0.0089591 Test Loss: 0.0099931
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0085839
	speed: 0.0843s/iter; left time: 1219.0877s
	iters: 200, epoch: 36 | loss: 0.0085593
	speed: 0.0347s/iter; left time: 498.7204s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.78s
Steps: 224 | Train Loss: 0.0085119 Vali Loss: 0.0089610 Test Loss: 0.0099651
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0082230
	speed: 0.0865s/iter; left time: 1231.4378s
	iters: 200, epoch: 37 | loss: 0.0077552
	speed: 0.0340s/iter; left time: 480.2208s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.93s
Steps: 224 | Train Loss: 0.0084972 Vali Loss: 0.0089316 Test Loss: 0.0099725
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0084324
	speed: 0.0802s/iter; left time: 1123.7365s
	iters: 200, epoch: 38 | loss: 0.0086269
	speed: 0.0355s/iter; left time: 493.6280s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.49s
Steps: 224 | Train Loss: 0.0084884 Vali Loss: 0.0089388 Test Loss: 0.0099787
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009963399730622768, rmse:0.09981682896614075, mae:0.058140531182289124, rse:0.37715864181518555
Intermediate time for IT and pred_len 24: 00h:07m:49.35s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0371732
	speed: 0.0425s/iter; left time: 948.1996s
	iters: 200, epoch: 1 | loss: 0.0287763
	speed: 0.0208s/iter; left time: 462.7846s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.58s
Steps: 224 | Train Loss: 0.0390735 Vali Loss: 0.0230477 Test Loss: 0.0248180
Validation loss decreased (inf --> 0.023048).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0210800
	speed: 0.0513s/iter; left time: 1132.7785s
	iters: 200, epoch: 2 | loss: 0.0182079
	speed: 0.0208s/iter; left time: 456.3942s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0211989 Vali Loss: 0.0170225 Test Loss: 0.0186545
Validation loss decreased (0.023048 --> 0.017022).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0189358
	speed: 0.0490s/iter; left time: 1070.6179s
	iters: 200, epoch: 3 | loss: 0.0172008
	speed: 0.0224s/iter; left time: 486.7154s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0180473 Vali Loss: 0.0164983 Test Loss: 0.0179922
Validation loss decreased (0.017022 --> 0.016498).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0170671
	speed: 0.0470s/iter; left time: 1016.7012s
	iters: 200, epoch: 4 | loss: 0.0164635
	speed: 0.0209s/iter; left time: 450.8112s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0173269 Vali Loss: 0.0162273 Test Loss: 0.0178494
Validation loss decreased (0.016498 --> 0.016227).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0185882
	speed: 0.0486s/iter; left time: 1041.1875s
	iters: 200, epoch: 5 | loss: 0.0157344
	speed: 0.0214s/iter; left time: 456.8292s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0169245 Vali Loss: 0.0159996 Test Loss: 0.0178206
Validation loss decreased (0.016227 --> 0.016000).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0168839
	speed: 0.0491s/iter; left time: 1039.8157s
	iters: 200, epoch: 6 | loss: 0.0167227
	speed: 0.0238s/iter; left time: 501.6362s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.41s
Steps: 224 | Train Loss: 0.0166422 Vali Loss: 0.0158670 Test Loss: 0.0176874
Validation loss decreased (0.016000 --> 0.015867).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0173547
	speed: 0.0503s/iter; left time: 1054.3527s
	iters: 200, epoch: 7 | loss: 0.0157185
	speed: 0.0225s/iter; left time: 470.3101s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.37s
Steps: 224 | Train Loss: 0.0164024 Vali Loss: 0.0159056 Test Loss: 0.0178127
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0160923
	speed: 0.0510s/iter; left time: 1057.1580s
	iters: 200, epoch: 8 | loss: 0.0145047
	speed: 0.0210s/iter; left time: 432.8760s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0161933 Vali Loss: 0.0157249 Test Loss: 0.0177374
Validation loss decreased (0.015867 --> 0.015725).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0155673
	speed: 0.0488s/iter; left time: 1000.0195s
	iters: 200, epoch: 9 | loss: 0.0142138
	speed: 0.0216s/iter; left time: 440.9310s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0159982 Vali Loss: 0.0157612 Test Loss: 0.0176047
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0145641
	speed: 0.0471s/iter; left time: 954.8946s
	iters: 200, epoch: 10 | loss: 0.0170093
	speed: 0.0212s/iter; left time: 428.3900s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0158333 Vali Loss: 0.0156579 Test Loss: 0.0177839
Validation loss decreased (0.015725 --> 0.015658).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0164054
	speed: 0.0537s/iter; left time: 1078.2749s
	iters: 200, epoch: 11 | loss: 0.0158935
	speed: 0.0214s/iter; left time: 426.6837s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0157068 Vali Loss: 0.0157430 Test Loss: 0.0176609
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0162831
	speed: 0.0501s/iter; left time: 993.9899s
	iters: 200, epoch: 12 | loss: 0.0157943
	speed: 0.0214s/iter; left time: 421.9097s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.39s
Steps: 224 | Train Loss: 0.0155495 Vali Loss: 0.0157374 Test Loss: 0.0176193
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0154624
	speed: 0.0490s/iter; left time: 960.3477s
	iters: 200, epoch: 13 | loss: 0.0158125
	speed: 0.0212s/iter; left time: 414.2353s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0154042 Vali Loss: 0.0157997 Test Loss: 0.0179022
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0144169
	speed: 0.0494s/iter; left time: 958.7619s
	iters: 200, epoch: 14 | loss: 0.0150392
	speed: 0.0209s/iter; left time: 403.6563s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0152836 Vali Loss: 0.0156491 Test Loss: 0.0178490
Validation loss decreased (0.015658 --> 0.015649).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0151338
	speed: 0.0492s/iter; left time: 942.6435s
	iters: 200, epoch: 15 | loss: 0.0155342
	speed: 0.0226s/iter; left time: 430.5565s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.35s
Steps: 224 | Train Loss: 0.0152057 Vali Loss: 0.0156826 Test Loss: 0.0177711
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0172772
	speed: 0.0478s/iter; left time: 906.2072s
	iters: 200, epoch: 16 | loss: 0.0152490
	speed: 0.0219s/iter; left time: 413.2578s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0150662 Vali Loss: 0.0157058 Test Loss: 0.0177606
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0153979
	speed: 0.0515s/iter; left time: 964.5141s
	iters: 200, epoch: 17 | loss: 0.0151868
	speed: 0.0223s/iter; left time: 415.8438s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.34s
Steps: 224 | Train Loss: 0.0149973 Vali Loss: 0.0157220 Test Loss: 0.0178153
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0147232
	speed: 0.0501s/iter; left time: 926.7080s
	iters: 200, epoch: 18 | loss: 0.0165930
	speed: 0.0214s/iter; left time: 393.0901s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.29s
Steps: 224 | Train Loss: 0.0148880 Vali Loss: 0.0157485 Test Loss: 0.0178049
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0133762
	speed: 0.0474s/iter; left time: 866.3181s
	iters: 200, epoch: 19 | loss: 0.0149687
	speed: 0.0217s/iter; left time: 394.4318s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0148254 Vali Loss: 0.0157007 Test Loss: 0.0178293
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0147325
	speed: 0.0480s/iter; left time: 866.2290s
	iters: 200, epoch: 20 | loss: 0.0156527
	speed: 0.0211s/iter; left time: 379.4896s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0147292 Vali Loss: 0.0156710 Test Loss: 0.0177907
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0145474
	speed: 0.0470s/iter; left time: 837.6363s
	iters: 200, epoch: 21 | loss: 0.0122341
	speed: 0.0216s/iter; left time: 383.3445s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0146501 Vali Loss: 0.0157059 Test Loss: 0.0178243
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0147194
	speed: 0.0479s/iter; left time: 843.2110s
	iters: 200, epoch: 22 | loss: 0.0152239
	speed: 0.0237s/iter; left time: 414.0171s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.43s
Steps: 224 | Train Loss: 0.0146113 Vali Loss: 0.0157876 Test Loss: 0.0178172
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0141952
	speed: 0.0502s/iter; left time: 871.9619s
	iters: 200, epoch: 23 | loss: 0.0136017
	speed: 0.0213s/iter; left time: 367.6173s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0145538 Vali Loss: 0.0157679 Test Loss: 0.0178681
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0145188
	speed: 0.0495s/iter; left time: 848.8626s
	iters: 200, epoch: 24 | loss: 0.0136532
	speed: 0.0211s/iter; left time: 359.7698s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0144843 Vali Loss: 0.0157702 Test Loss: 0.0179332
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01784895919263363, rmse:0.13359999656677246, mae:0.08161764591932297, rse:0.5051559805870056
Intermediate time for IT and pred_len 96: 00h:02m:59.38s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0369255
	speed: 0.0507s/iter; left time: 1126.5050s
	iters: 200, epoch: 1 | loss: 0.0297755
	speed: 0.0213s/iter; left time: 470.9769s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.47s
Steps: 223 | Train Loss: 0.0397611 Vali Loss: 0.0237945 Test Loss: 0.0251291
Validation loss decreased (inf --> 0.023794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0209399
	speed: 0.0473s/iter; left time: 1038.6170s
	iters: 200, epoch: 2 | loss: 0.0188481
	speed: 0.0235s/iter; left time: 514.5731s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.37s
Steps: 223 | Train Loss: 0.0225348 Vali Loss: 0.0185233 Test Loss: 0.0195790
Validation loss decreased (0.023794 --> 0.018523).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0206072
	speed: 0.0531s/iter; left time: 1156.0818s
	iters: 200, epoch: 3 | loss: 0.0186305
	speed: 0.0253s/iter; left time: 548.5064s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.85s
Steps: 223 | Train Loss: 0.0193464 Vali Loss: 0.0180038 Test Loss: 0.0191504
Validation loss decreased (0.018523 --> 0.018004).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0191462
	speed: 0.0498s/iter; left time: 1071.2509s
	iters: 200, epoch: 4 | loss: 0.0204389
	speed: 0.0212s/iter; left time: 453.2919s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.02s
Steps: 223 | Train Loss: 0.0186470 Vali Loss: 0.0178889 Test Loss: 0.0193618
Validation loss decreased (0.018004 --> 0.017889).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0174371
	speed: 0.0489s/iter; left time: 1042.8023s
	iters: 200, epoch: 5 | loss: 0.0175992
	speed: 0.0217s/iter; left time: 459.9728s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0182212 Vali Loss: 0.0175770 Test Loss: 0.0193352
Validation loss decreased (0.017889 --> 0.017577).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0169263
	speed: 0.0493s/iter; left time: 1040.2883s
	iters: 200, epoch: 6 | loss: 0.0189777
	speed: 0.0212s/iter; left time: 445.3449s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0178814 Vali Loss: 0.0174025 Test Loss: 0.0192189
Validation loss decreased (0.017577 --> 0.017402).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0178873
	speed: 0.0535s/iter; left time: 1116.6465s
	iters: 200, epoch: 7 | loss: 0.0182649
	speed: 0.0214s/iter; left time: 444.1022s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.22s
Steps: 223 | Train Loss: 0.0176283 Vali Loss: 0.0174294 Test Loss: 0.0193924
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0176257
	speed: 0.0517s/iter; left time: 1067.7889s
	iters: 200, epoch: 8 | loss: 0.0169084
	speed: 0.0236s/iter; left time: 484.9721s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.68s
Steps: 223 | Train Loss: 0.0173846 Vali Loss: 0.0173592 Test Loss: 0.0194279
Validation loss decreased (0.017402 --> 0.017359).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0171479
	speed: 0.0499s/iter; left time: 1018.8378s
	iters: 200, epoch: 9 | loss: 0.0163122
	speed: 0.0213s/iter; left time: 433.0551s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0171772 Vali Loss: 0.0172226 Test Loss: 0.0193564
Validation loss decreased (0.017359 --> 0.017223).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0160433
	speed: 0.0534s/iter; left time: 1078.1602s
	iters: 200, epoch: 10 | loss: 0.0175120
	speed: 0.0233s/iter; left time: 469.1493s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.65s
Steps: 223 | Train Loss: 0.0169679 Vali Loss: 0.0173008 Test Loss: 0.0195370
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0176645
	speed: 0.0538s/iter; left time: 1074.1828s
	iters: 200, epoch: 11 | loss: 0.0154894
	speed: 0.0289s/iter; left time: 573.4385s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.12s
Steps: 223 | Train Loss: 0.0167844 Vali Loss: 0.0172710 Test Loss: 0.0197374
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0156374
	speed: 0.0547s/iter; left time: 1079.7601s
	iters: 200, epoch: 12 | loss: 0.0162350
	speed: 0.0235s/iter; left time: 462.2320s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.61s
Steps: 223 | Train Loss: 0.0165962 Vali Loss: 0.0172021 Test Loss: 0.0195468
Validation loss decreased (0.017223 --> 0.017202).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0160061
	speed: 0.0610s/iter; left time: 1190.6081s
	iters: 200, epoch: 13 | loss: 0.0165230
	speed: 0.0243s/iter; left time: 471.3065s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.47s
Steps: 223 | Train Loss: 0.0164414 Vali Loss: 0.0171890 Test Loss: 0.0197550
Validation loss decreased (0.017202 --> 0.017189).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0159156
	speed: 0.0548s/iter; left time: 1057.5153s
	iters: 200, epoch: 14 | loss: 0.0163138
	speed: 0.0287s/iter; left time: 550.2985s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.47s
Steps: 223 | Train Loss: 0.0162846 Vali Loss: 0.0172921 Test Loss: 0.0197784
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0160599
	speed: 0.0602s/iter; left time: 1148.8767s
	iters: 200, epoch: 15 | loss: 0.0180776
	speed: 0.0250s/iter; left time: 474.6625s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.85s
Steps: 223 | Train Loss: 0.0161662 Vali Loss: 0.0172911 Test Loss: 0.0196204
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0166016
	speed: 0.0722s/iter; left time: 1361.6496s
	iters: 200, epoch: 16 | loss: 0.0168872
	speed: 0.0244s/iter; left time: 458.4343s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.00s
Steps: 223 | Train Loss: 0.0160063 Vali Loss: 0.0173133 Test Loss: 0.0197688
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0163692
	speed: 0.0502s/iter; left time: 935.2129s
	iters: 200, epoch: 17 | loss: 0.0158019
	speed: 0.0263s/iter; left time: 488.0951s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.14s
Steps: 223 | Train Loss: 0.0159090 Vali Loss: 0.0172856 Test Loss: 0.0198253
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0144021
	speed: 0.0576s/iter; left time: 1060.1217s
	iters: 200, epoch: 18 | loss: 0.0162366
	speed: 0.0235s/iter; left time: 429.8685s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.57s
Steps: 223 | Train Loss: 0.0158164 Vali Loss: 0.0173659 Test Loss: 0.0198755
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0145723
	speed: 0.0532s/iter; left time: 968.1630s
	iters: 200, epoch: 19 | loss: 0.0150361
	speed: 0.0277s/iter; left time: 501.7882s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.31s
Steps: 223 | Train Loss: 0.0157038 Vali Loss: 0.0173463 Test Loss: 0.0198465
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0164767
	speed: 0.0564s/iter; left time: 1013.8309s
	iters: 200, epoch: 20 | loss: 0.0145590
	speed: 0.0258s/iter; left time: 460.2691s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.02s
Steps: 223 | Train Loss: 0.0156102 Vali Loss: 0.0173839 Test Loss: 0.0200144
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0158374
	speed: 0.0604s/iter; left time: 1072.4078s
	iters: 200, epoch: 21 | loss: 0.0149751
	speed: 0.0270s/iter; left time: 475.7056s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.07s
Steps: 223 | Train Loss: 0.0155649 Vali Loss: 0.0173720 Test Loss: 0.0198600
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0163231
	speed: 0.0707s/iter; left time: 1239.2860s
	iters: 200, epoch: 22 | loss: 0.0162265
	speed: 0.0241s/iter; left time: 420.4306s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.25s
Steps: 223 | Train Loss: 0.0154726 Vali Loss: 0.0174812 Test Loss: 0.0200674
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0139256
	speed: 0.0547s/iter; left time: 945.5040s
	iters: 200, epoch: 23 | loss: 0.0155654
	speed: 0.0296s/iter; left time: 508.8566s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.83s
Steps: 223 | Train Loss: 0.0154203 Vali Loss: 0.0175127 Test Loss: 0.0199061
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019755041226744652, rmse:0.14055262506008148, mae:0.08749067783355713, rse:0.5319384932518005
Intermediate time for IT and pred_len 168: 00h:03m:14.98sIntermediate time for IT: 00h:14m:03.71sTotal time: 01h:39m:19.06s