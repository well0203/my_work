
=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1367688
	speed: 0.0628s/iter; left time: 1400.2306s
	iters: 200, epoch: 1 | loss: 0.1245904
	speed: 0.0345s/iter; left time: 765.3702s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.41s
Steps: 224 | Train Loss: 0.1417825 Vali Loss: 0.1297619 Test Loss: 0.1346998
Validation loss decreased (inf --> 0.129762).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0874328
	speed: 0.0635s/iter; left time: 1401.7784s
	iters: 200, epoch: 2 | loss: 0.0836909
	speed: 0.0345s/iter; left time: 757.1710s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0895919 Vali Loss: 0.0937259 Test Loss: 0.0950073
Validation loss decreased (0.129762 --> 0.093726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0783313
	speed: 0.0633s/iter; left time: 1384.1834s
	iters: 200, epoch: 3 | loss: 0.0797411
	speed: 0.0345s/iter; left time: 749.7392s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0798404 Vali Loss: 0.0909569 Test Loss: 0.0923144
Validation loss decreased (0.093726 --> 0.090957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0808882
	speed: 0.0628s/iter; left time: 1359.2269s
	iters: 200, epoch: 4 | loss: 0.0815994
	speed: 0.0345s/iter; left time: 742.2717s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0774217 Vali Loss: 0.0891894 Test Loss: 0.0911084
Validation loss decreased (0.090957 --> 0.089189).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0768369
	speed: 0.0632s/iter; left time: 1352.9602s
	iters: 200, epoch: 5 | loss: 0.0743422
	speed: 0.0344s/iter; left time: 733.7521s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0758960 Vali Loss: 0.0885748 Test Loss: 0.0902168
Validation loss decreased (0.089189 --> 0.088575).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0834458
	speed: 0.0628s/iter; left time: 1329.6335s
	iters: 200, epoch: 6 | loss: 0.0734622
	speed: 0.0346s/iter; left time: 729.5017s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0749218 Vali Loss: 0.0881808 Test Loss: 0.0901664
Validation loss decreased (0.088575 --> 0.088181).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0725648
	speed: 0.0633s/iter; left time: 1326.1223s
	iters: 200, epoch: 7 | loss: 0.0770377
	speed: 0.0345s/iter; left time: 719.9851s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0741599 Vali Loss: 0.0878329 Test Loss: 0.0895589
Validation loss decreased (0.088181 --> 0.087833).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0711806
	speed: 0.0636s/iter; left time: 1317.6002s
	iters: 200, epoch: 8 | loss: 0.0732410
	speed: 0.0345s/iter; left time: 712.5090s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0736808 Vali Loss: 0.0885085 Test Loss: 0.0895575
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0778364
	speed: 0.0624s/iter; left time: 1279.5035s
	iters: 200, epoch: 9 | loss: 0.0757419
	speed: 0.0347s/iter; left time: 707.5286s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0733049 Vali Loss: 0.0876978 Test Loss: 0.0892725
Validation loss decreased (0.087833 --> 0.087698).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0761590
	speed: 0.0636s/iter; left time: 1289.7004s
	iters: 200, epoch: 10 | loss: 0.0707892
	speed: 0.0345s/iter; left time: 696.8224s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0727617 Vali Loss: 0.0874244 Test Loss: 0.0888162
Validation loss decreased (0.087698 --> 0.087424).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0676915
	speed: 0.0635s/iter; left time: 1274.3989s
	iters: 200, epoch: 11 | loss: 0.0720713
	speed: 0.0345s/iter; left time: 689.6313s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0725552 Vali Loss: 0.0870095 Test Loss: 0.0886139
Validation loss decreased (0.087424 --> 0.087009).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0712213
	speed: 0.0647s/iter; left time: 1283.4834s
	iters: 200, epoch: 12 | loss: 0.0730992
	speed: 0.0350s/iter; left time: 691.6769s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0722883 Vali Loss: 0.0866656 Test Loss: 0.0887256
Validation loss decreased (0.087009 --> 0.086666).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0674988
	speed: 0.0642s/iter; left time: 1259.2798s
	iters: 200, epoch: 13 | loss: 0.0707361
	speed: 0.0351s/iter; left time: 685.0543s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0719704 Vali Loss: 0.0869405 Test Loss: 0.0882807
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0707829
	speed: 0.0645s/iter; left time: 1250.1434s
	iters: 200, epoch: 14 | loss: 0.0731093
	speed: 0.0345s/iter; left time: 665.6738s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0718117 Vali Loss: 0.0862150 Test Loss: 0.0881431
Validation loss decreased (0.086666 --> 0.086215).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0719475
	speed: 0.0639s/iter; left time: 1223.7001s
	iters: 200, epoch: 15 | loss: 0.0660407
	speed: 0.0345s/iter; left time: 658.3238s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0716887 Vali Loss: 0.0862614 Test Loss: 0.0880773
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0720187
	speed: 0.0624s/iter; left time: 1181.7610s
	iters: 200, epoch: 16 | loss: 0.0700876
	speed: 0.0345s/iter; left time: 650.7287s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0715163 Vali Loss: 0.0862754 Test Loss: 0.0883428
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0736424
	speed: 0.0628s/iter; left time: 1175.3796s
	iters: 200, epoch: 17 | loss: 0.0725535
	speed: 0.0350s/iter; left time: 651.3524s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0714457 Vali Loss: 0.0860176 Test Loss: 0.0878601
Validation loss decreased (0.086215 --> 0.086018).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0720800
	speed: 0.0662s/iter; left time: 1224.6140s
	iters: 200, epoch: 18 | loss: 0.0806113
	speed: 0.0350s/iter; left time: 644.4131s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0713567 Vali Loss: 0.0858511 Test Loss: 0.0880465
Validation loss decreased (0.086018 --> 0.085851).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0661596
	speed: 0.0644s/iter; left time: 1177.2278s
	iters: 200, epoch: 19 | loss: 0.0682769
	speed: 0.0350s/iter; left time: 636.6683s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0712430 Vali Loss: 0.0859923 Test Loss: 0.0881765
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0680708
	speed: 0.0637s/iter; left time: 1148.6941s
	iters: 200, epoch: 20 | loss: 0.0721421
	speed: 0.0351s/iter; left time: 629.6177s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0710715 Vali Loss: 0.0858214 Test Loss: 0.0879637
Validation loss decreased (0.085851 --> 0.085821).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0671154
	speed: 0.0645s/iter; left time: 1149.0170s
	iters: 200, epoch: 21 | loss: 0.0730100
	speed: 0.0350s/iter; left time: 619.7909s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0709879 Vali Loss: 0.0858328 Test Loss: 0.0878991
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0640760
	speed: 0.0634s/iter; left time: 1114.8550s
	iters: 200, epoch: 22 | loss: 0.0681176
	speed: 0.0351s/iter; left time: 613.5744s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0709690 Vali Loss: 0.0858622 Test Loss: 0.0879610
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0712698
	speed: 0.0636s/iter; left time: 1104.4965s
	iters: 200, epoch: 23 | loss: 0.0667570
	speed: 0.0351s/iter; left time: 605.8411s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0708771 Vali Loss: 0.0858069 Test Loss: 0.0878305
Validation loss decreased (0.085821 --> 0.085807).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0693972
	speed: 0.0651s/iter; left time: 1115.8562s
	iters: 200, epoch: 24 | loss: 0.0692556
	speed: 0.0351s/iter; left time: 597.9210s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0708486 Vali Loss: 0.0856658 Test Loss: 0.0877898
Validation loss decreased (0.085807 --> 0.085666).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0699250
	speed: 0.0645s/iter; left time: 1091.0211s
	iters: 200, epoch: 25 | loss: 0.0798727
	speed: 0.0351s/iter; left time: 590.2684s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0708131 Vali Loss: 0.0857214 Test Loss: 0.0877753
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0697506
	speed: 0.0649s/iter; left time: 1084.2420s
	iters: 200, epoch: 26 | loss: 0.0687230
	speed: 0.0351s/iter; left time: 581.9424s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0707461 Vali Loss: 0.0856136 Test Loss: 0.0875972
Validation loss decreased (0.085666 --> 0.085614).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0745587
	speed: 0.0651s/iter; left time: 1073.4175s
	iters: 200, epoch: 27 | loss: 0.0744420
	speed: 0.0351s/iter; left time: 574.2806s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0706360 Vali Loss: 0.0857599 Test Loss: 0.0877222
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0682002
	speed: 0.0640s/iter; left time: 1040.4624s
	iters: 200, epoch: 28 | loss: 0.0733372
	speed: 0.0351s/iter; left time: 567.0398s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0706084 Vali Loss: 0.0856512 Test Loss: 0.0877045
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0717218
	speed: 0.0634s/iter; left time: 1016.2640s
	iters: 200, epoch: 29 | loss: 0.0664676
	speed: 0.0347s/iter; left time: 553.4060s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0706563 Vali Loss: 0.0856150 Test Loss: 0.0877161
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0762165
	speed: 0.0641s/iter; left time: 1012.6755s
	iters: 200, epoch: 30 | loss: 0.0719173
	speed: 0.0351s/iter; left time: 551.5048s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0705385 Vali Loss: 0.0856017 Test Loss: 0.0877515
Validation loss decreased (0.085614 --> 0.085602).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0697288
	speed: 0.0657s/iter; left time: 1024.1216s
	iters: 200, epoch: 31 | loss: 0.0669441
	speed: 0.0351s/iter; left time: 543.4688s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0705516 Vali Loss: 0.0855314 Test Loss: 0.0876253
Validation loss decreased (0.085602 --> 0.085531).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0652949
	speed: 0.0647s/iter; left time: 993.4007s
	iters: 200, epoch: 32 | loss: 0.0733190
	speed: 0.0351s/iter; left time: 535.4359s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.11s
Steps: 224 | Train Loss: 0.0705164 Vali Loss: 0.0855905 Test Loss: 0.0876133
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0756751
	speed: 0.0634s/iter; left time: 960.0686s
	iters: 200, epoch: 33 | loss: 0.0652215
	speed: 0.0350s/iter; left time: 526.3089s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0705262 Vali Loss: 0.0855893 Test Loss: 0.0876473
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0703901
	speed: 0.0640s/iter; left time: 954.4139s
	iters: 200, epoch: 34 | loss: 0.0733109
	speed: 0.0351s/iter; left time: 520.2931s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0704702 Vali Loss: 0.0856044 Test Loss: 0.0876274
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0708346
	speed: 0.0647s/iter; left time: 949.6245s
	iters: 200, epoch: 35 | loss: 0.0658687
	speed: 0.0351s/iter; left time: 512.4510s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0704458 Vali Loss: 0.0855822 Test Loss: 0.0876436
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0695963
	speed: 0.0641s/iter; left time: 927.1935s
	iters: 200, epoch: 36 | loss: 0.0763912
	speed: 0.0350s/iter; left time: 502.9948s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0704712 Vali Loss: 0.0856099 Test Loss: 0.0876519
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0776208
	speed: 0.0651s/iter; left time: 926.7347s
	iters: 200, epoch: 37 | loss: 0.0732721
	speed: 0.0350s/iter; left time: 495.3567s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.0704133 Vali Loss: 0.0856230 Test Loss: 0.0876302
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0693206
	speed: 0.0647s/iter; left time: 906.4526s
	iters: 200, epoch: 38 | loss: 0.0663587
	speed: 0.0351s/iter; left time: 487.7315s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0704773 Vali Loss: 0.0855760 Test Loss: 0.0876636
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0746389
	speed: 0.0641s/iter; left time: 884.4819s
	iters: 200, epoch: 39 | loss: 0.0675292
	speed: 0.0350s/iter; left time: 479.7489s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0703812 Vali Loss: 0.0855172 Test Loss: 0.0876569
Validation loss decreased (0.085531 --> 0.085517).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0679469
	speed: 0.0652s/iter; left time: 884.0008s
	iters: 200, epoch: 40 | loss: 0.0760854
	speed: 0.0351s/iter; left time: 472.2906s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.08s
Steps: 224 | Train Loss: 0.0703983 Vali Loss: 0.0856338 Test Loss: 0.0876461
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0657282
	speed: 0.0642s/iter; left time: 856.6081s
	iters: 200, epoch: 41 | loss: 0.0685808
	speed: 0.0351s/iter; left time: 464.3759s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0704297 Vali Loss: 0.0854791 Test Loss: 0.0876108
Validation loss decreased (0.085517 --> 0.085479).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0685432
	speed: 0.0645s/iter; left time: 846.5376s
	iters: 200, epoch: 42 | loss: 0.0772268
	speed: 0.0350s/iter; left time: 456.1898s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0704295 Vali Loss: 0.0856170 Test Loss: 0.0876517
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0754281
	speed: 0.0636s/iter; left time: 820.4934s
	iters: 200, epoch: 43 | loss: 0.0719534
	speed: 0.0351s/iter; left time: 448.4070s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0704678 Vali Loss: 0.0855464 Test Loss: 0.0876139
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0648393
	speed: 0.0643s/iter; left time: 814.3549s
	iters: 200, epoch: 44 | loss: 0.0716240
	speed: 0.0350s/iter; left time: 440.3264s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.0703761 Vali Loss: 0.0855283 Test Loss: 0.0876206
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0702064
	speed: 0.0641s/iter; left time: 797.7895s
	iters: 200, epoch: 45 | loss: 0.0723583
	speed: 0.0350s/iter; left time: 432.4051s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0703306 Vali Loss: 0.0855358 Test Loss: 0.0876488
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0701229
	speed: 0.0640s/iter; left time: 782.3163s
	iters: 200, epoch: 46 | loss: 0.0754933
	speed: 0.0350s/iter; left time: 424.7951s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0703833 Vali Loss: 0.0855528 Test Loss: 0.0876253
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0710274
	speed: 0.0636s/iter; left time: 763.3012s
	iters: 200, epoch: 47 | loss: 0.0696812
	speed: 0.0350s/iter; left time: 416.8242s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0702940 Vali Loss: 0.0855598 Test Loss: 0.0876733
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0711155
	speed: 0.0637s/iter; left time: 750.0359s
	iters: 200, epoch: 48 | loss: 0.0701874
	speed: 0.0350s/iter; left time: 408.8671s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0703315 Vali Loss: 0.0855006 Test Loss: 0.0876410
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0714043
	speed: 0.0633s/iter; left time: 731.4278s
	iters: 200, epoch: 49 | loss: 0.0752779
	speed: 0.0351s/iter; left time: 401.4423s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0703117 Vali Loss: 0.0853899 Test Loss: 0.0876294
Validation loss decreased (0.085479 --> 0.085390).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0675540
	speed: 0.0640s/iter; left time: 724.8751s
	iters: 200, epoch: 50 | loss: 0.0672784
	speed: 0.0346s/iter; left time: 388.1034s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0703544 Vali Loss: 0.0856176 Test Loss: 0.0876256
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0672196
	speed: 0.0634s/iter; left time: 703.6005s
	iters: 200, epoch: 51 | loss: 0.0705316
	speed: 0.0350s/iter; left time: 385.2054s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0703640 Vali Loss: 0.0855282 Test Loss: 0.0876138
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0726501
	speed: 0.0631s/iter; left time: 686.5334s
	iters: 200, epoch: 52 | loss: 0.0750476
	speed: 0.0349s/iter; left time: 376.5507s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0702915 Vali Loss: 0.0854718 Test Loss: 0.0876108
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0707266
	speed: 0.0647s/iter; left time: 689.6367s
	iters: 200, epoch: 53 | loss: 0.0753433
	speed: 0.0350s/iter; left time: 369.5965s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0703226 Vali Loss: 0.0855451 Test Loss: 0.0876203
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0707714
	speed: 0.0643s/iter; left time: 670.5706s
	iters: 200, epoch: 54 | loss: 0.0693999
	speed: 0.0351s/iter; left time: 362.2076s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:08.11s
Steps: 224 | Train Loss: 0.0702514 Vali Loss: 0.0855230 Test Loss: 0.0876223
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0683633
	speed: 0.0641s/iter; left time: 653.6339s
	iters: 200, epoch: 55 | loss: 0.0732801
	speed: 0.0351s/iter; left time: 354.3989s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0703378 Vali Loss: 0.0854774 Test Loss: 0.0876248
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0726792
	speed: 0.0639s/iter; left time: 637.5809s
	iters: 200, epoch: 56 | loss: 0.0682346
	speed: 0.0350s/iter; left time: 346.2214s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0703922 Vali Loss: 0.0854243 Test Loss: 0.0876170
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0713991
	speed: 0.0637s/iter; left time: 621.7716s
	iters: 200, epoch: 57 | loss: 0.0715152
	speed: 0.0351s/iter; left time: 338.7991s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0703222 Vali Loss: 0.0855278 Test Loss: 0.0876308
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0724774
	speed: 0.0642s/iter; left time: 611.7987s
	iters: 200, epoch: 58 | loss: 0.0744438
	speed: 0.0350s/iter; left time: 330.5905s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0703177 Vali Loss: 0.0855277 Test Loss: 0.0876161
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0699353
	speed: 0.0631s/iter; left time: 587.1480s
	iters: 200, epoch: 59 | loss: 0.0727263
	speed: 0.0351s/iter; left time: 322.8710s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0702569 Vali Loss: 0.0854934 Test Loss: 0.0876463
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02089524082839489, rmse:0.1445518583059311, mae:0.08762942254543304, rse:0.5101435780525208
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1392107
	speed: 0.0367s/iter; left time: 819.2585s
	iters: 200, epoch: 1 | loss: 0.1223771
	speed: 0.0351s/iter; left time: 778.8864s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.1422910 Vali Loss: 0.1295708 Test Loss: 0.1351053
Validation loss decreased (inf --> 0.129571).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0875246
	speed: 0.0641s/iter; left time: 1414.8089s
	iters: 200, epoch: 2 | loss: 0.0827769
	speed: 0.0346s/iter; left time: 760.8563s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0894109 Vali Loss: 0.0936834 Test Loss: 0.0941651
Validation loss decreased (0.129571 --> 0.093683).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0772660
	speed: 0.0643s/iter; left time: 1404.3236s
	iters: 200, epoch: 3 | loss: 0.0733927
	speed: 0.0350s/iter; left time: 761.1847s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0796623 Vali Loss: 0.0904186 Test Loss: 0.0915907
Validation loss decreased (0.093683 --> 0.090419).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0783105
	speed: 0.0636s/iter; left time: 1375.9841s
	iters: 200, epoch: 4 | loss: 0.0769419
	speed: 0.0347s/iter; left time: 747.5143s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0773948 Vali Loss: 0.0894107 Test Loss: 0.0908844
Validation loss decreased (0.090419 --> 0.089411).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0744560
	speed: 0.0657s/iter; left time: 1406.5184s
	iters: 200, epoch: 5 | loss: 0.0756037
	speed: 0.0349s/iter; left time: 742.9610s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0760975 Vali Loss: 0.0888506 Test Loss: 0.0901179
Validation loss decreased (0.089411 --> 0.088851).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0701576
	speed: 0.0640s/iter; left time: 1356.6075s
	iters: 200, epoch: 6 | loss: 0.0759827
	speed: 0.0350s/iter; left time: 738.6457s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0751048 Vali Loss: 0.0878141 Test Loss: 0.0899050
Validation loss decreased (0.088851 --> 0.087814).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0718560
	speed: 0.0642s/iter; left time: 1344.5501s
	iters: 200, epoch: 7 | loss: 0.0740832
	speed: 0.0350s/iter; left time: 730.9573s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0743345 Vali Loss: 0.0880151 Test Loss: 0.0895214
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0741832
	speed: 0.0634s/iter; left time: 1314.3061s
	iters: 200, epoch: 8 | loss: 0.0740128
	speed: 0.0350s/iter; left time: 722.0658s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0737370 Vali Loss: 0.0874614 Test Loss: 0.0890989
Validation loss decreased (0.087814 --> 0.087461).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0691896
	speed: 0.0642s/iter; left time: 1317.2019s
	iters: 200, epoch: 9 | loss: 0.0766630
	speed: 0.0350s/iter; left time: 714.6621s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0733119 Vali Loss: 0.0871451 Test Loss: 0.0889235
Validation loss decreased (0.087461 --> 0.087145).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0766472
	speed: 0.0641s/iter; left time: 1300.4002s
	iters: 200, epoch: 10 | loss: 0.0736008
	speed: 0.0350s/iter; left time: 707.1504s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0729019 Vali Loss: 0.0868081 Test Loss: 0.0888383
Validation loss decreased (0.087145 --> 0.086808).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0757230
	speed: 0.0642s/iter; left time: 1287.6677s
	iters: 200, epoch: 11 | loss: 0.0731116
	speed: 0.0350s/iter; left time: 699.1572s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0726183 Vali Loss: 0.0872676 Test Loss: 0.0886142
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0696218
	speed: 0.0628s/iter; left time: 1245.7935s
	iters: 200, epoch: 12 | loss: 0.0717855
	speed: 0.0346s/iter; left time: 682.2855s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0723210 Vali Loss: 0.0864866 Test Loss: 0.0882929
Validation loss decreased (0.086808 --> 0.086487).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0699662
	speed: 0.0642s/iter; left time: 1259.0415s
	iters: 200, epoch: 13 | loss: 0.0678303
	speed: 0.0350s/iter; left time: 682.5925s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0721329 Vali Loss: 0.0864594 Test Loss: 0.0883254
Validation loss decreased (0.086487 --> 0.086459).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0744527
	speed: 0.0644s/iter; left time: 1249.1821s
	iters: 200, epoch: 14 | loss: 0.0712838
	speed: 0.0350s/iter; left time: 675.9706s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0718629 Vali Loss: 0.0865285 Test Loss: 0.0879603
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0717863
	speed: 0.0633s/iter; left time: 1213.9027s
	iters: 200, epoch: 15 | loss: 0.0759115
	speed: 0.0347s/iter; left time: 660.9964s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0717239 Vali Loss: 0.0863706 Test Loss: 0.0881227
Validation loss decreased (0.086459 --> 0.086371).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0746718
	speed: 0.0629s/iter; left time: 1191.8480s
	iters: 200, epoch: 16 | loss: 0.0667765
	speed: 0.0345s/iter; left time: 650.2938s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0715664 Vali Loss: 0.0860702 Test Loss: 0.0879821
Validation loss decreased (0.086371 --> 0.086070).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0709616
	speed: 0.0637s/iter; left time: 1192.5170s
	iters: 200, epoch: 17 | loss: 0.0683452
	speed: 0.0350s/iter; left time: 652.3987s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0713874 Vali Loss: 0.0860104 Test Loss: 0.0880817
Validation loss decreased (0.086070 --> 0.086010).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0693563
	speed: 0.0640s/iter; left time: 1182.8188s
	iters: 200, epoch: 18 | loss: 0.0700895
	speed: 0.0351s/iter; left time: 645.0936s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0712817 Vali Loss: 0.0859047 Test Loss: 0.0879939
Validation loss decreased (0.086010 --> 0.085905).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0706147
	speed: 0.0658s/iter; left time: 1203.0016s
	iters: 200, epoch: 19 | loss: 0.0703915
	speed: 0.0351s/iter; left time: 637.3017s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0711656 Vali Loss: 0.0858420 Test Loss: 0.0879358
Validation loss decreased (0.085905 --> 0.085842).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0707204
	speed: 0.0643s/iter; left time: 1161.1114s
	iters: 200, epoch: 20 | loss: 0.0687749
	speed: 0.0347s/iter; left time: 622.8740s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0711148 Vali Loss: 0.0861993 Test Loss: 0.0881098
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0706116
	speed: 0.0628s/iter; left time: 1119.3175s
	iters: 200, epoch: 21 | loss: 0.0679988
	speed: 0.0346s/iter; left time: 612.4378s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0709843 Vali Loss: 0.0860575 Test Loss: 0.0881536
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0746522
	speed: 0.0635s/iter; left time: 1117.3407s
	iters: 200, epoch: 22 | loss: 0.0689951
	speed: 0.0351s/iter; left time: 613.2882s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0709407 Vali Loss: 0.0859087 Test Loss: 0.0879257
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0744749
	speed: 0.0639s/iter; left time: 1109.7295s
	iters: 200, epoch: 23 | loss: 0.0743252
	speed: 0.0350s/iter; left time: 605.2843s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0709424 Vali Loss: 0.0857921 Test Loss: 0.0877810
Validation loss decreased (0.085842 --> 0.085792).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0665782
	speed: 0.0639s/iter; left time: 1095.9036s
	iters: 200, epoch: 24 | loss: 0.0703265
	speed: 0.0350s/iter; left time: 596.9037s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0707643 Vali Loss: 0.0856805 Test Loss: 0.0881121
Validation loss decreased (0.085792 --> 0.085680).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0697950
	speed: 0.0659s/iter; left time: 1114.5497s
	iters: 200, epoch: 25 | loss: 0.0696788
	speed: 0.0350s/iter; left time: 589.0380s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0707121 Vali Loss: 0.0857703 Test Loss: 0.0879429
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0674330
	speed: 0.0638s/iter; left time: 1066.3491s
	iters: 200, epoch: 26 | loss: 0.0725871
	speed: 0.0350s/iter; left time: 580.9678s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0707476 Vali Loss: 0.0856222 Test Loss: 0.0878290
Validation loss decreased (0.085680 --> 0.085622).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0723486
	speed: 0.0643s/iter; left time: 1058.7603s
	iters: 200, epoch: 27 | loss: 0.0718315
	speed: 0.0351s/iter; left time: 574.1262s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0706553 Vali Loss: 0.0857146 Test Loss: 0.0879704
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0654385
	speed: 0.0635s/iter; left time: 1032.2765s
	iters: 200, epoch: 28 | loss: 0.0727765
	speed: 0.0348s/iter; left time: 561.7094s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0706182 Vali Loss: 0.0855102 Test Loss: 0.0878463
Validation loss decreased (0.085622 --> 0.085510).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0711899
	speed: 0.0637s/iter; left time: 1020.7695s
	iters: 200, epoch: 29 | loss: 0.0700434
	speed: 0.0350s/iter; left time: 558.2588s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0705729 Vali Loss: 0.0858183 Test Loss: 0.0878769
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0739872
	speed: 0.0634s/iter; left time: 1002.3237s
	iters: 200, epoch: 30 | loss: 0.0765059
	speed: 0.0350s/iter; left time: 549.3831s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0705351 Vali Loss: 0.0855984 Test Loss: 0.0878054
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0739572
	speed: 0.0632s/iter; left time: 984.7762s
	iters: 200, epoch: 31 | loss: 0.0708882
	speed: 0.0350s/iter; left time: 542.0791s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0705233 Vali Loss: 0.0855951 Test Loss: 0.0878898
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0687875
	speed: 0.0635s/iter; left time: 975.6175s
	iters: 200, epoch: 32 | loss: 0.0646325
	speed: 0.0350s/iter; left time: 534.1425s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0705301 Vali Loss: 0.0855611 Test Loss: 0.0877873
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0695308
	speed: 0.0636s/iter; left time: 962.5616s
	iters: 200, epoch: 33 | loss: 0.0709703
	speed: 0.0350s/iter; left time: 526.0878s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0704562 Vali Loss: 0.0856102 Test Loss: 0.0878550
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0721221
	speed: 0.0635s/iter; left time: 946.1815s
	iters: 200, epoch: 34 | loss: 0.0697934
	speed: 0.0350s/iter; left time: 518.7476s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0704322 Vali Loss: 0.0856775 Test Loss: 0.0878189
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0723047
	speed: 0.0633s/iter; left time: 929.7682s
	iters: 200, epoch: 35 | loss: 0.0704416
	speed: 0.0346s/iter; left time: 505.3163s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0704091 Vali Loss: 0.0855530 Test Loss: 0.0878015
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0697463
	speed: 0.0639s/iter; left time: 923.6397s
	iters: 200, epoch: 36 | loss: 0.0740611
	speed: 0.0351s/iter; left time: 503.5750s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0704309 Vali Loss: 0.0854530 Test Loss: 0.0877506
Validation loss decreased (0.085510 --> 0.085453).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0669694
	speed: 0.0643s/iter; left time: 914.7893s
	iters: 200, epoch: 37 | loss: 0.0725200
	speed: 0.0351s/iter; left time: 495.8601s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0703749 Vali Loss: 0.0856628 Test Loss: 0.0877849
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0704496
	speed: 0.0636s/iter; left time: 891.0638s
	iters: 200, epoch: 38 | loss: 0.0702864
	speed: 0.0347s/iter; left time: 482.4047s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0703885 Vali Loss: 0.0855724 Test Loss: 0.0878162
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0651617
	speed: 0.0632s/iter; left time: 871.0702s
	iters: 200, epoch: 39 | loss: 0.0684052
	speed: 0.0351s/iter; left time: 480.1610s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0703234 Vali Loss: 0.0856100 Test Loss: 0.0878053
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0719843
	speed: 0.0638s/iter; left time: 865.9075s
	iters: 200, epoch: 40 | loss: 0.0726390
	speed: 0.0350s/iter; left time: 471.5732s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0703533 Vali Loss: 0.0855090 Test Loss: 0.0878113
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0710737
	speed: 0.0637s/iter; left time: 849.2821s
	iters: 200, epoch: 41 | loss: 0.0723475
	speed: 0.0350s/iter; left time: 463.7678s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0703102 Vali Loss: 0.0855023 Test Loss: 0.0877571
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0698876
	speed: 0.0629s/iter; left time: 825.2851s
	iters: 200, epoch: 42 | loss: 0.0711496
	speed: 0.0345s/iter; left time: 449.2065s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0702633 Vali Loss: 0.0856002 Test Loss: 0.0877695
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0757993
	speed: 0.0627s/iter; left time: 808.1306s
	iters: 200, epoch: 43 | loss: 0.0712027
	speed: 0.0346s/iter; left time: 442.3844s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0702882 Vali Loss: 0.0853861 Test Loss: 0.0877757
Validation loss decreased (0.085453 --> 0.085386).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0706222
	speed: 0.0645s/iter; left time: 817.0567s
	iters: 200, epoch: 44 | loss: 0.0712676
	speed: 0.0351s/iter; left time: 440.7956s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0703147 Vali Loss: 0.0855626 Test Loss: 0.0877548
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0697095
	speed: 0.0635s/iter; left time: 790.6435s
	iters: 200, epoch: 45 | loss: 0.0717822
	speed: 0.0350s/iter; left time: 432.5111s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0703315 Vali Loss: 0.0854310 Test Loss: 0.0877551
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0681447
	speed: 0.0637s/iter; left time: 778.3059s
	iters: 200, epoch: 46 | loss: 0.0663517
	speed: 0.0350s/iter; left time: 424.7718s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0702682 Vali Loss: 0.0855846 Test Loss: 0.0877398
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0777841
	speed: 0.0632s/iter; left time: 757.8800s
	iters: 200, epoch: 47 | loss: 0.0680706
	speed: 0.0351s/iter; left time: 417.3099s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0702969 Vali Loss: 0.0854859 Test Loss: 0.0877611
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0757864
	speed: 0.0640s/iter; left time: 754.0087s
	iters: 200, epoch: 48 | loss: 0.0718232
	speed: 0.0351s/iter; left time: 409.4529s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0703018 Vali Loss: 0.0854713 Test Loss: 0.0877413
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0736973
	speed: 0.0635s/iter; left time: 733.4895s
	iters: 200, epoch: 49 | loss: 0.0686348
	speed: 0.0351s/iter; left time: 401.3596s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0703128 Vali Loss: 0.0855502 Test Loss: 0.0877463
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0714738
	speed: 0.0635s/iter; left time: 718.7358s
	iters: 200, epoch: 50 | loss: 0.0690084
	speed: 0.0349s/iter; left time: 391.4718s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0702437 Vali Loss: 0.0855177 Test Loss: 0.0877286
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0728555
	speed: 0.0636s/iter; left time: 706.0794s
	iters: 200, epoch: 51 | loss: 0.0691143
	speed: 0.0350s/iter; left time: 385.2018s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0702183 Vali Loss: 0.0855559 Test Loss: 0.0877540
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0702601
	speed: 0.0633s/iter; left time: 688.6613s
	iters: 200, epoch: 52 | loss: 0.0702171
	speed: 0.0345s/iter; left time: 371.9635s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0702743 Vali Loss: 0.0855097 Test Loss: 0.0877607
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0725170
	speed: 0.0625s/iter; left time: 665.3974s
	iters: 200, epoch: 53 | loss: 0.0697442
	speed: 0.0350s/iter; left time: 369.8652s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0702812 Vali Loss: 0.0855764 Test Loss: 0.0877520
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.020985262468457222, rmse:0.14486290514469147, mae:0.08777573704719543, rse:0.5112412571907043
Intermediate time for DE and pred_len 24: 00h:18m:39.66s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1482347
	speed: 0.0555s/iter; left time: 1236.5948s
	iters: 200, epoch: 1 | loss: 0.1378018
	speed: 0.0349s/iter; left time: 774.7081s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.36s
Steps: 224 | Train Loss: 0.1484325 Vali Loss: 0.1405515 Test Loss: 0.1490075
Validation loss decreased (inf --> 0.140551).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1195954
	speed: 0.0657s/iter; left time: 1450.0514s
	iters: 200, epoch: 2 | loss: 0.1069368
	speed: 0.0350s/iter; left time: 768.2523s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.1145010 Vali Loss: 0.1213328 Test Loss: 0.1295046
Validation loss decreased (0.140551 --> 0.121333).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1037384
	speed: 0.0653s/iter; left time: 1426.7104s
	iters: 200, epoch: 3 | loss: 0.1071076
	speed: 0.0349s/iter; left time: 758.7190s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.1064909 Vali Loss: 0.1196142 Test Loss: 0.1285274
Validation loss decreased (0.121333 --> 0.119614).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1046638
	speed: 0.0655s/iter; left time: 1417.1729s
	iters: 200, epoch: 4 | loss: 0.1002790
	speed: 0.0349s/iter; left time: 752.2742s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1044976 Vali Loss: 0.1190749 Test Loss: 0.1282010
Validation loss decreased (0.119614 --> 0.119075).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1033227
	speed: 0.0668s/iter; left time: 1430.7280s
	iters: 200, epoch: 5 | loss: 0.0970878
	speed: 0.0350s/iter; left time: 744.7806s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.1033116 Vali Loss: 0.1186551 Test Loss: 0.1275626
Validation loss decreased (0.119075 --> 0.118655).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1100062
	speed: 0.0664s/iter; left time: 1407.0752s
	iters: 200, epoch: 6 | loss: 0.1083277
	speed: 0.0349s/iter; left time: 736.3467s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.1024692 Vali Loss: 0.1179186 Test Loss: 0.1264673
Validation loss decreased (0.118655 --> 0.117919).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1021854
	speed: 0.0656s/iter; left time: 1373.9547s
	iters: 200, epoch: 7 | loss: 0.0952686
	speed: 0.0349s/iter; left time: 728.0350s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.1016764 Vali Loss: 0.1185184 Test Loss: 0.1276702
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0995753
	speed: 0.0638s/iter; left time: 1322.7426s
	iters: 200, epoch: 8 | loss: 0.0976494
	speed: 0.0349s/iter; left time: 719.4735s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.1011224 Vali Loss: 0.1183860 Test Loss: 0.1271428
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1000763
	speed: 0.0640s/iter; left time: 1312.9803s
	iters: 200, epoch: 9 | loss: 0.1019372
	speed: 0.0349s/iter; left time: 713.2668s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.1005771 Vali Loss: 0.1178224 Test Loss: 0.1268350
Validation loss decreased (0.117919 --> 0.117822).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1002124
	speed: 0.0653s/iter; left time: 1325.4450s
	iters: 200, epoch: 10 | loss: 0.0973505
	speed: 0.0349s/iter; left time: 704.5446s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.1000270 Vali Loss: 0.1172706 Test Loss: 0.1271694
Validation loss decreased (0.117822 --> 0.117271).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0969001
	speed: 0.0675s/iter; left time: 1354.8926s
	iters: 200, epoch: 11 | loss: 0.1031166
	speed: 0.0349s/iter; left time: 697.3719s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0997477 Vali Loss: 0.1172982 Test Loss: 0.1272332
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1018357
	speed: 0.0652s/iter; left time: 1292.8790s
	iters: 200, epoch: 12 | loss: 0.0972093
	speed: 0.0349s/iter; left time: 689.5129s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0992934 Vali Loss: 0.1170973 Test Loss: 0.1279319
Validation loss decreased (0.117271 --> 0.117097).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0960486
	speed: 0.0648s/iter; left time: 1271.1910s
	iters: 200, epoch: 13 | loss: 0.0997497
	speed: 0.0349s/iter; left time: 681.4889s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0989598 Vali Loss: 0.1168318 Test Loss: 0.1276354
Validation loss decreased (0.117097 --> 0.116832).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0996718
	speed: 0.0652s/iter; left time: 1264.1271s
	iters: 200, epoch: 14 | loss: 0.0947404
	speed: 0.0349s/iter; left time: 673.7995s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0986475 Vali Loss: 0.1169735 Test Loss: 0.1274173
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0974905
	speed: 0.0648s/iter; left time: 1242.4220s
	iters: 200, epoch: 15 | loss: 0.0981231
	speed: 0.0349s/iter; left time: 665.5419s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0983453 Vali Loss: 0.1166716 Test Loss: 0.1279067
Validation loss decreased (0.116832 --> 0.116672).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1014924
	speed: 0.0669s/iter; left time: 1267.4986s
	iters: 200, epoch: 16 | loss: 0.1034701
	speed: 0.0349s/iter; left time: 658.2055s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0980670 Vali Loss: 0.1167677 Test Loss: 0.1272575
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0973124
	speed: 0.0644s/iter; left time: 1205.7622s
	iters: 200, epoch: 17 | loss: 0.0980472
	speed: 0.0350s/iter; left time: 650.8323s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0978883 Vali Loss: 0.1168754 Test Loss: 0.1276267
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0963466
	speed: 0.0644s/iter; left time: 1190.3490s
	iters: 200, epoch: 18 | loss: 0.0919128
	speed: 0.0349s/iter; left time: 642.5161s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0976455 Vali Loss: 0.1169622 Test Loss: 0.1281606
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0941686
	speed: 0.0644s/iter; left time: 1175.8828s
	iters: 200, epoch: 19 | loss: 0.0953647
	speed: 0.0349s/iter; left time: 634.7007s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0973529 Vali Loss: 0.1170276 Test Loss: 0.1279060
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0978062
	speed: 0.0641s/iter; left time: 1156.8529s
	iters: 200, epoch: 20 | loss: 0.1034515
	speed: 0.0349s/iter; left time: 626.7534s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0972285 Vali Loss: 0.1168277 Test Loss: 0.1283830
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0988373
	speed: 0.0639s/iter; left time: 1137.9045s
	iters: 200, epoch: 21 | loss: 0.0931606
	speed: 0.0349s/iter; left time: 618.1408s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0970570 Vali Loss: 0.1168306 Test Loss: 0.1278056
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0968445
	speed: 0.0641s/iter; left time: 1128.0690s
	iters: 200, epoch: 22 | loss: 0.0998393
	speed: 0.0350s/iter; left time: 612.0873s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0969466 Vali Loss: 0.1167267 Test Loss: 0.1278561
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0969927
	speed: 0.0635s/iter; left time: 1102.3828s
	iters: 200, epoch: 23 | loss: 0.1014693
	speed: 0.0349s/iter; left time: 603.2847s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0967281 Vali Loss: 0.1169685 Test Loss: 0.1281257
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.1025194
	speed: 0.0652s/iter; left time: 1118.5924s
	iters: 200, epoch: 24 | loss: 0.0958392
	speed: 0.0349s/iter; left time: 595.8070s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.0965891 Vali Loss: 0.1168502 Test Loss: 0.1280141
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0956000
	speed: 0.0642s/iter; left time: 1087.1668s
	iters: 200, epoch: 25 | loss: 0.0918060
	speed: 0.0349s/iter; left time: 587.5898s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0964858 Vali Loss: 0.1168534 Test Loss: 0.1277497
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.037491124123334885, rmse:0.1936262547969818, mae:0.12790675461292267, rse:0.6856697201728821
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1453957
	speed: 0.0365s/iter; left time: 814.5013s
	iters: 200, epoch: 1 | loss: 0.1340858
	speed: 0.0349s/iter; left time: 774.7121s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1494136 Vali Loss: 0.1402564 Test Loss: 0.1483569
Validation loss decreased (inf --> 0.140256).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1099396
	speed: 0.0653s/iter; left time: 1441.4807s
	iters: 200, epoch: 2 | loss: 0.1089450
	speed: 0.0350s/iter; left time: 768.1244s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.1142612 Vali Loss: 0.1222496 Test Loss: 0.1299090
Validation loss decreased (0.140256 --> 0.122250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1056904
	speed: 0.0648s/iter; left time: 1415.0327s
	iters: 200, epoch: 3 | loss: 0.1076379
	speed: 0.0349s/iter; left time: 758.5977s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.1065370 Vali Loss: 0.1204718 Test Loss: 0.1293942
Validation loss decreased (0.122250 --> 0.120472).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1011825
	speed: 0.0651s/iter; left time: 1408.1162s
	iters: 200, epoch: 4 | loss: 0.1051529
	speed: 0.0349s/iter; left time: 751.5707s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1047850 Vali Loss: 0.1190891 Test Loss: 0.1283439
Validation loss decreased (0.120472 --> 0.119089).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1018035
	speed: 0.0652s/iter; left time: 1395.1045s
	iters: 200, epoch: 5 | loss: 0.0959603
	speed: 0.0349s/iter; left time: 742.8024s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.1035709 Vali Loss: 0.1188063 Test Loss: 0.1279118
Validation loss decreased (0.119089 --> 0.118806).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0992174
	speed: 0.0642s/iter; left time: 1359.4596s
	iters: 200, epoch: 6 | loss: 0.1054772
	speed: 0.0349s/iter; left time: 735.9433s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.1025895 Vali Loss: 0.1180930 Test Loss: 0.1277300
Validation loss decreased (0.118806 --> 0.118093).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1013398
	speed: 0.0650s/iter; left time: 1362.2456s
	iters: 200, epoch: 7 | loss: 0.0996996
	speed: 0.0349s/iter; left time: 727.1248s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1018984 Vali Loss: 0.1179579 Test Loss: 0.1278235
Validation loss decreased (0.118093 --> 0.117958).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1006072
	speed: 0.0675s/iter; left time: 1400.2892s
	iters: 200, epoch: 8 | loss: 0.0998495
	speed: 0.0349s/iter; left time: 721.0691s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1011631 Vali Loss: 0.1176284 Test Loss: 0.1280497
Validation loss decreased (0.117958 --> 0.117628).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0995732
	speed: 0.0659s/iter; left time: 1351.6445s
	iters: 200, epoch: 9 | loss: 0.0970091
	speed: 0.0350s/iter; left time: 713.3435s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1004982 Vali Loss: 0.1173580 Test Loss: 0.1289639
Validation loss decreased (0.117628 --> 0.117358).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1010281
	speed: 0.0653s/iter; left time: 1324.5542s
	iters: 200, epoch: 10 | loss: 0.0961296
	speed: 0.0349s/iter; left time: 704.6938s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0999256 Vali Loss: 0.1177550 Test Loss: 0.1276098
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1018762
	speed: 0.0645s/iter; left time: 1293.0266s
	iters: 200, epoch: 11 | loss: 0.0979215
	speed: 0.0349s/iter; left time: 697.1027s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0992263 Vali Loss: 0.1176204 Test Loss: 0.1281647
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0985747
	speed: 0.0642s/iter; left time: 1274.5039s
	iters: 200, epoch: 12 | loss: 0.1021433
	speed: 0.0349s/iter; left time: 688.0161s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0986819 Vali Loss: 0.1175718 Test Loss: 0.1288873
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1029676
	speed: 0.0642s/iter; left time: 1259.5668s
	iters: 200, epoch: 13 | loss: 0.0993051
	speed: 0.0349s/iter; left time: 681.6927s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0982463 Vali Loss: 0.1174938 Test Loss: 0.1275150
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0970475
	speed: 0.0647s/iter; left time: 1254.4670s
	iters: 200, epoch: 14 | loss: 0.0948543
	speed: 0.0349s/iter; left time: 673.4752s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0978403 Vali Loss: 0.1172675 Test Loss: 0.1285813
Validation loss decreased (0.117358 --> 0.117267).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0957331
	speed: 0.0650s/iter; left time: 1246.3146s
	iters: 200, epoch: 15 | loss: 0.0929094
	speed: 0.0350s/iter; left time: 666.7605s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0973781 Vali Loss: 0.1176463 Test Loss: 0.1286512
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1026521
	speed: 0.0644s/iter; left time: 1220.0673s
	iters: 200, epoch: 16 | loss: 0.1015639
	speed: 0.0350s/iter; left time: 659.0913s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0970437 Vali Loss: 0.1176449 Test Loss: 0.1301728
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0968726
	speed: 0.0640s/iter; left time: 1198.7500s
	iters: 200, epoch: 17 | loss: 0.0935973
	speed: 0.0349s/iter; left time: 648.8111s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0967689 Vali Loss: 0.1177664 Test Loss: 0.1295637
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0874706
	speed: 0.0639s/iter; left time: 1181.7644s
	iters: 200, epoch: 18 | loss: 0.0967437
	speed: 0.0349s/iter; left time: 642.8254s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0964619 Vali Loss: 0.1176769 Test Loss: 0.1294305
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0988394
	speed: 0.0645s/iter; left time: 1178.4609s
	iters: 200, epoch: 19 | loss: 0.0924114
	speed: 0.0349s/iter; left time: 634.9000s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0962537 Vali Loss: 0.1178822 Test Loss: 0.1303212
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.1004734
	speed: 0.0646s/iter; left time: 1166.5721s
	iters: 200, epoch: 20 | loss: 0.0981680
	speed: 0.0349s/iter; left time: 627.0613s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0959195 Vali Loss: 0.1175593 Test Loss: 0.1291494
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0966209
	speed: 0.0642s/iter; left time: 1144.7604s
	iters: 200, epoch: 21 | loss: 0.0967935
	speed: 0.0349s/iter; left time: 619.0208s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0957571 Vali Loss: 0.1175417 Test Loss: 0.1290626
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0940960
	speed: 0.0648s/iter; left time: 1139.8663s
	iters: 200, epoch: 22 | loss: 0.0918512
	speed: 0.0349s/iter; left time: 611.4818s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0955669 Vali Loss: 0.1178742 Test Loss: 0.1291731
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0918518
	speed: 0.0645s/iter; left time: 1120.5052s
	iters: 200, epoch: 23 | loss: 0.0954803
	speed: 0.0349s/iter; left time: 603.4711s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0954497 Vali Loss: 0.1179387 Test Loss: 0.1295711
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0978012
	speed: 0.0643s/iter; left time: 1102.6532s
	iters: 200, epoch: 24 | loss: 0.0950696
	speed: 0.0349s/iter; left time: 595.8032s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0952225 Vali Loss: 0.1179368 Test Loss: 0.1301759
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03774594888091087, rmse:0.19428317248821259, mae:0.1285812258720398, rse:0.687995970249176
Intermediate time for DE and pred_len 96: 00h:08m:20.01s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1507415
	speed: 0.0565s/iter; left time: 1253.2475s
	iters: 200, epoch: 1 | loss: 0.1394623
	speed: 0.0353s/iter; left time: 780.3412s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.29s
Steps: 223 | Train Loss: 0.1507555 Vali Loss: 0.1426712 Test Loss: 0.1519588
Validation loss decreased (inf --> 0.142671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1239280
	speed: 0.0646s/iter; left time: 1420.2945s
	iters: 200, epoch: 2 | loss: 0.1124039
	speed: 0.0352s/iter; left time: 769.6760s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.1201247 Vali Loss: 0.1261942 Test Loss: 0.1356402
Validation loss decreased (0.142671 --> 0.126194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1163913
	speed: 0.0657s/iter; left time: 1429.3826s
	iters: 200, epoch: 3 | loss: 0.1123442
	speed: 0.0353s/iter; left time: 763.7746s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1126438 Vali Loss: 0.1250066 Test Loss: 0.1347315
Validation loss decreased (0.126194 --> 0.125007).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1090862
	speed: 0.0653s/iter; left time: 1405.7824s
	iters: 200, epoch: 4 | loss: 0.1161309
	speed: 0.0352s/iter; left time: 755.0383s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.1107866 Vali Loss: 0.1232045 Test Loss: 0.1346235
Validation loss decreased (0.125007 --> 0.123204).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1066427
	speed: 0.0651s/iter; left time: 1387.8638s
	iters: 200, epoch: 5 | loss: 0.1132237
	speed: 0.0353s/iter; left time: 748.4983s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.1096003 Vali Loss: 0.1234181 Test Loss: 0.1344385
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1043037
	speed: 0.0655s/iter; left time: 1380.7604s
	iters: 200, epoch: 6 | loss: 0.1133910
	speed: 0.0354s/iter; left time: 743.1362s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.1086403 Vali Loss: 0.1231625 Test Loss: 0.1348926
Validation loss decreased (0.123204 --> 0.123162).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1089526
	speed: 0.0661s/iter; left time: 1378.2731s
	iters: 200, epoch: 7 | loss: 0.1089387
	speed: 0.0353s/iter; left time: 733.0994s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1077927 Vali Loss: 0.1226179 Test Loss: 0.1336366
Validation loss decreased (0.123162 --> 0.122618).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1039010
	speed: 0.0656s/iter; left time: 1354.2406s
	iters: 200, epoch: 8 | loss: 0.1120105
	speed: 0.0352s/iter; left time: 723.4505s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1070246 Vali Loss: 0.1223381 Test Loss: 0.1333994
Validation loss decreased (0.122618 --> 0.122338).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1057785
	speed: 0.0652s/iter; left time: 1331.8512s
	iters: 200, epoch: 9 | loss: 0.0990716
	speed: 0.0353s/iter; left time: 718.0876s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1064019 Vali Loss: 0.1225220 Test Loss: 0.1338606
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1033412
	speed: 0.0658s/iter; left time: 1327.9691s
	iters: 200, epoch: 10 | loss: 0.1036346
	speed: 0.0353s/iter; left time: 709.8865s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.1057795 Vali Loss: 0.1224171 Test Loss: 0.1343879
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1061738
	speed: 0.0662s/iter; left time: 1321.8669s
	iters: 200, epoch: 11 | loss: 0.1002536
	speed: 0.0353s/iter; left time: 700.9812s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.1053096 Vali Loss: 0.1229281 Test Loss: 0.1340355
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1030056
	speed: 0.0662s/iter; left time: 1306.6333s
	iters: 200, epoch: 12 | loss: 0.1087899
	speed: 0.0354s/iter; left time: 695.0067s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.1048512 Vali Loss: 0.1225468 Test Loss: 0.1339203
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1101046
	speed: 0.0663s/iter; left time: 1294.6883s
	iters: 200, epoch: 13 | loss: 0.1058030
	speed: 0.0355s/iter; left time: 689.6808s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.15s
Steps: 223 | Train Loss: 0.1043782 Vali Loss: 0.1226395 Test Loss: 0.1338739
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0977369
	speed: 0.0666s/iter; left time: 1286.3567s
	iters: 200, epoch: 14 | loss: 0.1103711
	speed: 0.0354s/iter; left time: 680.1147s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.1040082 Vali Loss: 0.1224431 Test Loss: 0.1337946
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1058028
	speed: 0.0662s/iter; left time: 1262.5629s
	iters: 200, epoch: 15 | loss: 0.1130442
	speed: 0.0353s/iter; left time: 669.9407s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.1035960 Vali Loss: 0.1227261 Test Loss: 0.1344341
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1064806
	speed: 0.0661s/iter; left time: 1246.9260s
	iters: 200, epoch: 16 | loss: 0.1113944
	speed: 0.0353s/iter; left time: 662.4881s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.1032039 Vali Loss: 0.1225822 Test Loss: 0.1335773
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.1022041
	speed: 0.0658s/iter; left time: 1226.8881s
	iters: 200, epoch: 17 | loss: 0.1060120
	speed: 0.0352s/iter; left time: 653.0047s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1029293 Vali Loss: 0.1228268 Test Loss: 0.1333598
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1026201
	speed: 0.0646s/iter; left time: 1189.0348s
	iters: 200, epoch: 18 | loss: 0.1053459
	speed: 0.0354s/iter; left time: 647.4385s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1026233 Vali Loss: 0.1227413 Test Loss: 0.1338267
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.039008963853120804, rmse:0.1975068747997284, mae:0.13339932262897491, rse:0.6995851993560791
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1544944
	speed: 0.0373s/iter; left time: 827.3811s
	iters: 200, epoch: 1 | loss: 0.1355311
	speed: 0.0354s/iter; left time: 781.2764s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.1520427 Vali Loss: 0.1427960 Test Loss: 0.1520984
Validation loss decreased (inf --> 0.142796).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1182963
	speed: 0.0708s/iter; left time: 1555.6418s
	iters: 200, epoch: 2 | loss: 0.1188139
	speed: 0.0353s/iter; left time: 772.7556s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.1200457 Vali Loss: 0.1262973 Test Loss: 0.1363670
Validation loss decreased (0.142796 --> 0.126297).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1161436
	speed: 0.0676s/iter; left time: 1470.4189s
	iters: 200, epoch: 3 | loss: 0.1097982
	speed: 0.0353s/iter; left time: 765.4191s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.1127010 Vali Loss: 0.1251050 Test Loss: 0.1347768
Validation loss decreased (0.126297 --> 0.125105).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1086838
	speed: 0.0672s/iter; left time: 1447.5902s
	iters: 200, epoch: 4 | loss: 0.1126017
	speed: 0.0354s/iter; left time: 757.8176s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.1107704 Vali Loss: 0.1242438 Test Loss: 0.1353610
Validation loss decreased (0.125105 --> 0.124244).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1123698
	speed: 0.0679s/iter; left time: 1446.9317s
	iters: 200, epoch: 5 | loss: 0.1103449
	speed: 0.0354s/iter; left time: 751.1190s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.1094124 Vali Loss: 0.1243619 Test Loss: 0.1337075
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1061258
	speed: 0.0664s/iter; left time: 1399.4721s
	iters: 200, epoch: 6 | loss: 0.1109948
	speed: 0.0354s/iter; left time: 741.8815s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.11s
Steps: 223 | Train Loss: 0.1085605 Vali Loss: 0.1231010 Test Loss: 0.1342797
Validation loss decreased (0.124244 --> 0.123101).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1108833
	speed: 0.0689s/iter; left time: 1437.7100s
	iters: 200, epoch: 7 | loss: 0.1095173
	speed: 0.0353s/iter; left time: 732.1155s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.1077194 Vali Loss: 0.1238700 Test Loss: 0.1350289
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1087225
	speed: 0.0656s/iter; left time: 1353.1610s
	iters: 200, epoch: 8 | loss: 0.1082283
	speed: 0.0352s/iter; left time: 723.2254s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.1069829 Vali Loss: 0.1235352 Test Loss: 0.1347286
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1044433
	speed: 0.0665s/iter; left time: 1356.8686s
	iters: 200, epoch: 9 | loss: 0.1087776
	speed: 0.0353s/iter; left time: 716.2507s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.1062971 Vali Loss: 0.1230259 Test Loss: 0.1345029
Validation loss decreased (0.123101 --> 0.123026).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1045399
	speed: 0.0660s/iter; left time: 1333.8079s
	iters: 200, epoch: 10 | loss: 0.1105393
	speed: 0.0352s/iter; left time: 707.4243s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1056225 Vali Loss: 0.1232725 Test Loss: 0.1349387
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1027120
	speed: 0.0652s/iter; left time: 1302.6396s
	iters: 200, epoch: 11 | loss: 0.1093096
	speed: 0.0352s/iter; left time: 699.2146s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1050379 Vali Loss: 0.1236330 Test Loss: 0.1350731
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1042112
	speed: 0.0656s/iter; left time: 1295.8879s
	iters: 200, epoch: 12 | loss: 0.1065711
	speed: 0.0352s/iter; left time: 691.4895s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1045088 Vali Loss: 0.1236756 Test Loss: 0.1343073
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1077220
	speed: 0.0653s/iter; left time: 1275.4218s
	iters: 200, epoch: 13 | loss: 0.1064898
	speed: 0.0352s/iter; left time: 684.4217s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1040355 Vali Loss: 0.1237444 Test Loss: 0.1347824
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.1031265
	speed: 0.0656s/iter; left time: 1266.7221s
	iters: 200, epoch: 14 | loss: 0.1016434
	speed: 0.0352s/iter; left time: 675.1814s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1035480 Vali Loss: 0.1237950 Test Loss: 0.1351177
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1026230
	speed: 0.0650s/iter; left time: 1240.5683s
	iters: 200, epoch: 15 | loss: 0.1009728
	speed: 0.0353s/iter; left time: 670.1371s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.1030570 Vali Loss: 0.1239436 Test Loss: 0.1357483
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1040640
	speed: 0.0653s/iter; left time: 1232.1764s
	iters: 200, epoch: 16 | loss: 0.1080976
	speed: 0.0352s/iter; left time: 661.0556s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.1027642 Vali Loss: 0.1238374 Test Loss: 0.1346043
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0998133
	speed: 0.0650s/iter; left time: 1211.1566s
	iters: 200, epoch: 17 | loss: 0.1025198
	speed: 0.0352s/iter; left time: 653.0224s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1024307 Vali Loss: 0.1237371 Test Loss: 0.1349805
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.1031220
	speed: 0.0652s/iter; left time: 1200.4195s
	iters: 200, epoch: 18 | loss: 0.1065352
	speed: 0.0352s/iter; left time: 643.8827s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.1021159 Vali Loss: 0.1244268 Test Loss: 0.1352319
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.1081941
	speed: 0.0648s/iter; left time: 1177.7916s
	iters: 200, epoch: 19 | loss: 0.0990949
	speed: 0.0353s/iter; left time: 637.8277s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1018482 Vali Loss: 0.1244729 Test Loss: 0.1345668
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.039633940905332565, rmse:0.19908274710178375, mae:0.13450299203395844, rse:0.7051671147346497
Intermediate time for DE and pred_len 168: 00h:06m:28.03s
Intermediate time for DE: 00h:33m:27.71s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1247611
	speed: 0.0558s/iter; left time: 1244.1610s
	iters: 200, epoch: 1 | loss: 0.1143526
	speed: 0.0347s/iter; left time: 770.7951s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.1303075 Vali Loss: 0.1216880 Test Loss: 0.1408380
Validation loss decreased (inf --> 0.121688).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0842563
	speed: 0.0633s/iter; left time: 1397.0355s
	iters: 200, epoch: 2 | loss: 0.0819014
	speed: 0.0347s/iter; left time: 762.2064s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0865726 Vali Loss: 0.0919034 Test Loss: 0.1031424
Validation loss decreased (0.121688 --> 0.091903).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0737688
	speed: 0.0640s/iter; left time: 1398.7147s
	iters: 200, epoch: 3 | loss: 0.0824103
	speed: 0.0346s/iter; left time: 753.4211s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0793790 Vali Loss: 0.0899726 Test Loss: 0.1024645
Validation loss decreased (0.091903 --> 0.089973).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0745010
	speed: 0.0638s/iter; left time: 1380.5545s
	iters: 200, epoch: 4 | loss: 0.0775107
	speed: 0.0346s/iter; left time: 745.1328s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0779003 Vali Loss: 0.0899798 Test Loss: 0.1021317
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0760180
	speed: 0.0632s/iter; left time: 1351.9856s
	iters: 200, epoch: 5 | loss: 0.0761515
	speed: 0.0347s/iter; left time: 739.1832s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0769876 Vali Loss: 0.0892471 Test Loss: 0.1017458
Validation loss decreased (0.089973 --> 0.089247).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0797190
	speed: 0.0651s/iter; left time: 1379.9193s
	iters: 200, epoch: 6 | loss: 0.0811191
	speed: 0.0346s/iter; left time: 729.4924s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0762330 Vali Loss: 0.0888480 Test Loss: 0.1014709
Validation loss decreased (0.089247 --> 0.088848).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0748599
	speed: 0.0634s/iter; left time: 1329.1301s
	iters: 200, epoch: 7 | loss: 0.0804287
	speed: 0.0346s/iter; left time: 722.0763s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0756670 Vali Loss: 0.0888771 Test Loss: 0.1014206
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0729555
	speed: 0.0628s/iter; left time: 1301.0260s
	iters: 200, epoch: 8 | loss: 0.0766028
	speed: 0.0346s/iter; left time: 714.6211s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0751839 Vali Loss: 0.0885889 Test Loss: 0.1005207
Validation loss decreased (0.088848 --> 0.088589).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738455
	speed: 0.0640s/iter; left time: 1313.1392s
	iters: 200, epoch: 9 | loss: 0.0790517
	speed: 0.0347s/iter; left time: 707.5212s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0748482 Vali Loss: 0.0887364 Test Loss: 0.1007120
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0808676
	speed: 0.0633s/iter; left time: 1283.8025s
	iters: 200, epoch: 10 | loss: 0.0732426
	speed: 0.0346s/iter; left time: 698.6471s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0745424 Vali Loss: 0.0878483 Test Loss: 0.1010135
Validation loss decreased (0.088589 --> 0.087848).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0775793
	speed: 0.0641s/iter; left time: 1285.4172s
	iters: 200, epoch: 11 | loss: 0.0736117
	speed: 0.0349s/iter; left time: 697.2037s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0742537 Vali Loss: 0.0881625 Test Loss: 0.1001913
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0777474
	speed: 0.0634s/iter; left time: 1257.3928s
	iters: 200, epoch: 12 | loss: 0.0713382
	speed: 0.0346s/iter; left time: 682.9296s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0739927 Vali Loss: 0.0879092 Test Loss: 0.1006771
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0727023
	speed: 0.0635s/iter; left time: 1244.7479s
	iters: 200, epoch: 13 | loss: 0.0719952
	speed: 0.0346s/iter; left time: 675.9491s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0738306 Vali Loss: 0.0878730 Test Loss: 0.1001283
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0774384
	speed: 0.0628s/iter; left time: 1216.7017s
	iters: 200, epoch: 14 | loss: 0.0698902
	speed: 0.0346s/iter; left time: 666.5774s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0736871 Vali Loss: 0.0878024 Test Loss: 0.0998933
Validation loss decreased (0.087848 --> 0.087802).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0668057
	speed: 0.0631s/iter; left time: 1209.3785s
	iters: 200, epoch: 15 | loss: 0.0690141
	speed: 0.0346s/iter; left time: 659.7332s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0734897 Vali Loss: 0.0879864 Test Loss: 0.0999247
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0698143
	speed: 0.0629s/iter; left time: 1190.8123s
	iters: 200, epoch: 16 | loss: 0.0734518
	speed: 0.0346s/iter; left time: 651.4518s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0733458 Vali Loss: 0.0874913 Test Loss: 0.1001951
Validation loss decreased (0.087802 --> 0.087491).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0736844
	speed: 0.0640s/iter; left time: 1197.4207s
	iters: 200, epoch: 17 | loss: 0.0768669
	speed: 0.0348s/iter; left time: 646.9735s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0732595 Vali Loss: 0.0875177 Test Loss: 0.0997549
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0741299
	speed: 0.0640s/iter; left time: 1183.0326s
	iters: 200, epoch: 18 | loss: 0.0742703
	speed: 0.0350s/iter; left time: 642.9208s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0731418 Vali Loss: 0.0874550 Test Loss: 0.0996348
Validation loss decreased (0.087491 --> 0.087455).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0699841
	speed: 0.0642s/iter; left time: 1172.9832s
	iters: 200, epoch: 19 | loss: 0.0730995
	speed: 0.0349s/iter; left time: 634.9522s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0730212 Vali Loss: 0.0877180 Test Loss: 0.0997454
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0643637
	speed: 0.0643s/iter; left time: 1160.1479s
	iters: 200, epoch: 20 | loss: 0.0709331
	speed: 0.0350s/iter; left time: 628.2237s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0728930 Vali Loss: 0.0877011 Test Loss: 0.0996751
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0751462
	speed: 0.0637s/iter; left time: 1134.3896s
	iters: 200, epoch: 21 | loss: 0.0707488
	speed: 0.0349s/iter; left time: 619.0375s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0728144 Vali Loss: 0.0874716 Test Loss: 0.0995260
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0719383
	speed: 0.0637s/iter; left time: 1120.6512s
	iters: 200, epoch: 22 | loss: 0.0672770
	speed: 0.0347s/iter; left time: 607.0741s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0727698 Vali Loss: 0.0873257 Test Loss: 0.0995231
Validation loss decreased (0.087455 --> 0.087326).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0714904
	speed: 0.0639s/iter; left time: 1109.9431s
	iters: 200, epoch: 23 | loss: 0.0683171
	speed: 0.0349s/iter; left time: 603.0585s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0726941 Vali Loss: 0.0873660 Test Loss: 0.0995859
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0714073
	speed: 0.0647s/iter; left time: 1109.3182s
	iters: 200, epoch: 24 | loss: 0.0715693
	speed: 0.0347s/iter; left time: 592.3035s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0726770 Vali Loss: 0.0874997 Test Loss: 0.0994603
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0732493
	speed: 0.0636s/iter; left time: 1076.2132s
	iters: 200, epoch: 25 | loss: 0.0759301
	speed: 0.0348s/iter; left time: 585.4095s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0726538 Vali Loss: 0.0872884 Test Loss: 0.0994575
Validation loss decreased (0.087326 --> 0.087288).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0728130
	speed: 0.0644s/iter; left time: 1074.8188s
	iters: 200, epoch: 26 | loss: 0.0702365
	speed: 0.0348s/iter; left time: 577.6189s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0725412 Vali Loss: 0.0874340 Test Loss: 0.0995555
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0715932
	speed: 0.0643s/iter; left time: 1059.7496s
	iters: 200, epoch: 27 | loss: 0.0756999
	speed: 0.0348s/iter; left time: 570.1676s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0725176 Vali Loss: 0.0873506 Test Loss: 0.0995875
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0779321
	speed: 0.0645s/iter; left time: 1047.8914s
	iters: 200, epoch: 28 | loss: 0.0751987
	speed: 0.0348s/iter; left time: 562.0167s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0724977 Vali Loss: 0.0874352 Test Loss: 0.0996355
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0739681
	speed: 0.0635s/iter; left time: 1018.1905s
	iters: 200, epoch: 29 | loss: 0.0670358
	speed: 0.0349s/iter; left time: 555.4734s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0724848 Vali Loss: 0.0873351 Test Loss: 0.0994455
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0750490
	speed: 0.0636s/iter; left time: 1005.8042s
	iters: 200, epoch: 30 | loss: 0.0703685
	speed: 0.0348s/iter; left time: 546.9924s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0724388 Vali Loss: 0.0873482 Test Loss: 0.0995752
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0659054
	speed: 0.0642s/iter; left time: 1000.2697s
	iters: 200, epoch: 31 | loss: 0.0735366
	speed: 0.0347s/iter; left time: 536.6502s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0723950 Vali Loss: 0.0873012 Test Loss: 0.0995835
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0729537
	speed: 0.0638s/iter; left time: 979.4407s
	iters: 200, epoch: 32 | loss: 0.0747104
	speed: 0.0347s/iter; left time: 528.8939s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0724255 Vali Loss: 0.0871513 Test Loss: 0.0994224
Validation loss decreased (0.087288 --> 0.087151).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0718319
	speed: 0.0641s/iter; left time: 969.5907s
	iters: 200, epoch: 33 | loss: 0.0706718
	speed: 0.0350s/iter; left time: 525.7025s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0723458 Vali Loss: 0.0873818 Test Loss: 0.0996012
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0731219
	speed: 0.0642s/iter; left time: 956.6806s
	iters: 200, epoch: 34 | loss: 0.0744082
	speed: 0.0349s/iter; left time: 516.6815s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0723610 Vali Loss: 0.0873346 Test Loss: 0.0995087
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0775548
	speed: 0.0644s/iter; left time: 946.3281s
	iters: 200, epoch: 35 | loss: 0.0756403
	speed: 0.0348s/iter; left time: 506.9288s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0722907 Vali Loss: 0.0872204 Test Loss: 0.0994593
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0693678
	speed: 0.0644s/iter; left time: 931.7252s
	iters: 200, epoch: 36 | loss: 0.0769135
	speed: 0.0348s/iter; left time: 500.3790s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0722630 Vali Loss: 0.0873873 Test Loss: 0.0995016
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0758929
	speed: 0.0639s/iter; left time: 909.2940s
	iters: 200, epoch: 37 | loss: 0.0711693
	speed: 0.0349s/iter; left time: 492.7357s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0722736 Vali Loss: 0.0873873 Test Loss: 0.0995036
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0748579
	speed: 0.0636s/iter; left time: 890.5803s
	iters: 200, epoch: 38 | loss: 0.0678177
	speed: 0.0349s/iter; left time: 485.7531s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0723373 Vali Loss: 0.0872301 Test Loss: 0.0994893
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0759173
	speed: 0.0643s/iter; left time: 887.1000s
	iters: 200, epoch: 39 | loss: 0.0677600
	speed: 0.0349s/iter; left time: 477.9075s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0722983 Vali Loss: 0.0873828 Test Loss: 0.0995040
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0664773
	speed: 0.0641s/iter; left time: 869.5366s
	iters: 200, epoch: 40 | loss: 0.0749151
	speed: 0.0348s/iter; left time: 468.5489s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0722886 Vali Loss: 0.0873415 Test Loss: 0.0994757
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0701831
	speed: 0.0634s/iter; left time: 846.3775s
	iters: 200, epoch: 41 | loss: 0.0715847
	speed: 0.0348s/iter; left time: 461.1482s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0722711 Vali Loss: 0.0873553 Test Loss: 0.0995072
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0718809
	speed: 0.0640s/iter; left time: 839.9377s
	iters: 200, epoch: 42 | loss: 0.0766828
	speed: 0.0348s/iter; left time: 453.4579s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0722978 Vali Loss: 0.0871924 Test Loss: 0.0994866
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.024902237579226494, rmse:0.1578044295310974, mae:0.09942235052585602, rse:0.5443805456161499
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1294022
	speed: 0.0366s/iter; left time: 815.8341s
	iters: 200, epoch: 1 | loss: 0.1100414
	speed: 0.0348s/iter; left time: 773.3734s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1292062 Vali Loss: 0.1214272 Test Loss: 0.1407624
Validation loss decreased (inf --> 0.121427).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0821685
	speed: 0.0641s/iter; left time: 1414.7766s
	iters: 200, epoch: 2 | loss: 0.0775632
	speed: 0.0347s/iter; left time: 762.8234s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0862068 Vali Loss: 0.0915956 Test Loss: 0.1032231
Validation loss decreased (0.121427 --> 0.091596).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0783461
	speed: 0.0655s/iter; left time: 1431.7536s
	iters: 200, epoch: 3 | loss: 0.0811940
	speed: 0.0345s/iter; left time: 751.2520s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0792170 Vali Loss: 0.0905060 Test Loss: 0.1026404
Validation loss decreased (0.091596 --> 0.090506).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0764677
	speed: 0.0641s/iter; left time: 1385.6705s
	iters: 200, epoch: 4 | loss: 0.0736082
	speed: 0.0350s/iter; left time: 753.3879s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0779272 Vali Loss: 0.0898439 Test Loss: 0.1022563
Validation loss decreased (0.090506 --> 0.089844).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0765094
	speed: 0.0648s/iter; left time: 1386.1139s
	iters: 200, epoch: 5 | loss: 0.0694353
	speed: 0.0349s/iter; left time: 744.3044s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0769795 Vali Loss: 0.0891885 Test Loss: 0.1018237
Validation loss decreased (0.089844 --> 0.089189).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0713069
	speed: 0.0642s/iter; left time: 1359.7395s
	iters: 200, epoch: 6 | loss: 0.0752044
	speed: 0.0349s/iter; left time: 735.5427s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0762907 Vali Loss: 0.0893766 Test Loss: 0.1015955
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0740957
	speed: 0.0640s/iter; left time: 1340.8557s
	iters: 200, epoch: 7 | loss: 0.0764063
	speed: 0.0348s/iter; left time: 726.4902s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0757188 Vali Loss: 0.0887840 Test Loss: 0.1008570
Validation loss decreased (0.089189 --> 0.088784).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0771523
	speed: 0.0656s/iter; left time: 1360.2810s
	iters: 200, epoch: 8 | loss: 0.0754328
	speed: 0.0347s/iter; left time: 715.2777s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0752649 Vali Loss: 0.0886348 Test Loss: 0.1005910
Validation loss decreased (0.088784 --> 0.088635).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0779897
	speed: 0.0644s/iter; left time: 1321.5204s
	iters: 200, epoch: 9 | loss: 0.0770550
	speed: 0.0349s/iter; left time: 712.7659s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0748893 Vali Loss: 0.0889522 Test Loss: 0.1009389
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0761693
	speed: 0.0643s/iter; left time: 1304.1839s
	iters: 200, epoch: 10 | loss: 0.0766291
	speed: 0.0348s/iter; left time: 703.1150s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0745797 Vali Loss: 0.0884298 Test Loss: 0.1007179
Validation loss decreased (0.088635 --> 0.088430).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0719477
	speed: 0.0646s/iter; left time: 1295.5196s
	iters: 200, epoch: 11 | loss: 0.0769291
	speed: 0.0347s/iter; left time: 692.1272s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0742787 Vali Loss: 0.0886163 Test Loss: 0.1001683
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0740210
	speed: 0.0639s/iter; left time: 1268.5145s
	iters: 200, epoch: 12 | loss: 0.0742159
	speed: 0.0348s/iter; left time: 686.0535s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0740577 Vali Loss: 0.0879692 Test Loss: 0.1004901
Validation loss decreased (0.088430 --> 0.087969).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0732761
	speed: 0.0639s/iter; left time: 1253.5710s
	iters: 200, epoch: 13 | loss: 0.0700531
	speed: 0.0349s/iter; left time: 680.4345s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0738108 Vali Loss: 0.0882454 Test Loss: 0.1005620
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0684145
	speed: 0.0638s/iter; left time: 1236.3197s
	iters: 200, epoch: 14 | loss: 0.0773976
	speed: 0.0348s/iter; left time: 671.3657s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0735779 Vali Loss: 0.0877776 Test Loss: 0.1004058
Validation loss decreased (0.087969 --> 0.087778).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0761139
	speed: 0.0649s/iter; left time: 1243.6362s
	iters: 200, epoch: 15 | loss: 0.0705998
	speed: 0.0348s/iter; left time: 663.0881s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0734446 Vali Loss: 0.0877527 Test Loss: 0.0998809
Validation loss decreased (0.087778 --> 0.087753).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0744571
	speed: 0.0638s/iter; left time: 1208.7728s
	iters: 200, epoch: 16 | loss: 0.0772809
	speed: 0.0349s/iter; left time: 657.0304s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0732838 Vali Loss: 0.0875569 Test Loss: 0.0996925
Validation loss decreased (0.087753 --> 0.087557).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0727495
	speed: 0.0639s/iter; left time: 1195.6310s
	iters: 200, epoch: 17 | loss: 0.0665621
	speed: 0.0348s/iter; left time: 648.4276s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0731827 Vali Loss: 0.0876051 Test Loss: 0.0996813
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0726492
	speed: 0.0641s/iter; left time: 1185.7530s
	iters: 200, epoch: 18 | loss: 0.0750291
	speed: 0.0349s/iter; left time: 641.6867s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0730682 Vali Loss: 0.0875404 Test Loss: 0.0999407
Validation loss decreased (0.087557 --> 0.087540).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0730098
	speed: 0.0647s/iter; left time: 1182.0659s
	iters: 200, epoch: 19 | loss: 0.0705551
	speed: 0.0348s/iter; left time: 631.8838s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0729243 Vali Loss: 0.0874838 Test Loss: 0.0997166
Validation loss decreased (0.087540 --> 0.087484).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0755711
	speed: 0.0639s/iter; left time: 1152.8097s
	iters: 200, epoch: 20 | loss: 0.0745831
	speed: 0.0345s/iter; left time: 619.8625s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0728972 Vali Loss: 0.0875051 Test Loss: 0.0995769
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0715922
	speed: 0.0639s/iter; left time: 1139.4025s
	iters: 200, epoch: 21 | loss: 0.0721797
	speed: 0.0348s/iter; left time: 617.2905s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0727267 Vali Loss: 0.0874295 Test Loss: 0.0997128
Validation loss decreased (0.087484 --> 0.087430).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0712320
	speed: 0.0641s/iter; left time: 1127.1981s
	iters: 200, epoch: 22 | loss: 0.0738316
	speed: 0.0349s/iter; left time: 610.3731s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0727076 Vali Loss: 0.0874886 Test Loss: 0.0997229
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0712695
	speed: 0.0633s/iter; left time: 1100.1265s
	iters: 200, epoch: 23 | loss: 0.0734331
	speed: 0.0348s/iter; left time: 600.3232s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0726605 Vali Loss: 0.0873657 Test Loss: 0.0994976
Validation loss decreased (0.087430 --> 0.087366).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0750479
	speed: 0.0639s/iter; left time: 1095.6060s
	iters: 200, epoch: 24 | loss: 0.0773794
	speed: 0.0349s/iter; left time: 594.3260s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0725569 Vali Loss: 0.0873323 Test Loss: 0.0994945
Validation loss decreased (0.087366 --> 0.087332).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0760816
	speed: 0.0639s/iter; left time: 1080.9921s
	iters: 200, epoch: 25 | loss: 0.0709737
	speed: 0.0349s/iter; left time: 586.7352s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0725265 Vali Loss: 0.0873971 Test Loss: 0.0997336
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0730899
	speed: 0.0637s/iter; left time: 1064.1483s
	iters: 200, epoch: 26 | loss: 0.0703386
	speed: 0.0348s/iter; left time: 578.4166s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0724307 Vali Loss: 0.0873005 Test Loss: 0.0994930
Validation loss decreased (0.087332 --> 0.087300).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0776443
	speed: 0.0635s/iter; left time: 1046.7604s
	iters: 200, epoch: 27 | loss: 0.0700019
	speed: 0.0349s/iter; left time: 571.4085s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0723723 Vali Loss: 0.0873162 Test Loss: 0.0995671
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0728972
	speed: 0.0630s/iter; left time: 1024.0821s
	iters: 200, epoch: 28 | loss: 0.0704893
	speed: 0.0348s/iter; left time: 562.5983s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0723526 Vali Loss: 0.0874381 Test Loss: 0.0995070
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0719698
	speed: 0.0637s/iter; left time: 1021.6506s
	iters: 200, epoch: 29 | loss: 0.0737825
	speed: 0.0349s/iter; left time: 555.3853s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0723145 Vali Loss: 0.0872210 Test Loss: 0.0994940
Validation loss decreased (0.087300 --> 0.087221).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0719350
	speed: 0.0646s/iter; left time: 1021.0514s
	iters: 200, epoch: 30 | loss: 0.0680640
	speed: 0.0349s/iter; left time: 547.8738s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0723107 Vali Loss: 0.0873842 Test Loss: 0.0995497
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0712590
	speed: 0.0639s/iter; left time: 995.7126s
	iters: 200, epoch: 31 | loss: 0.0753886
	speed: 0.0351s/iter; left time: 543.1662s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0722937 Vali Loss: 0.0872571 Test Loss: 0.0995097
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0728941
	speed: 0.0638s/iter; left time: 980.0293s
	iters: 200, epoch: 32 | loss: 0.0735612
	speed: 0.0349s/iter; left time: 532.3796s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0722469 Vali Loss: 0.0872312 Test Loss: 0.0996675
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0726290
	speed: 0.0635s/iter; left time: 961.6007s
	iters: 200, epoch: 33 | loss: 0.0751589
	speed: 0.0349s/iter; left time: 525.1849s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0722370 Vali Loss: 0.0873351 Test Loss: 0.0995702
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0691960
	speed: 0.0635s/iter; left time: 946.1783s
	iters: 200, epoch: 34 | loss: 0.0734838
	speed: 0.0350s/iter; left time: 517.7410s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0722115 Vali Loss: 0.0873230 Test Loss: 0.0995916
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0694353
	speed: 0.0639s/iter; left time: 937.6417s
	iters: 200, epoch: 35 | loss: 0.0798021
	speed: 0.0348s/iter; left time: 508.0222s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0722289 Vali Loss: 0.0873763 Test Loss: 0.0996190
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0709907
	speed: 0.0638s/iter; left time: 922.1747s
	iters: 200, epoch: 36 | loss: 0.0716150
	speed: 0.0348s/iter; left time: 499.9332s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0721395 Vali Loss: 0.0874136 Test Loss: 0.0995644
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0730195
	speed: 0.0633s/iter; left time: 901.1820s
	iters: 200, epoch: 37 | loss: 0.0703072
	speed: 0.0348s/iter; left time: 492.5953s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0721677 Vali Loss: 0.0873755 Test Loss: 0.0996328
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0705547
	speed: 0.0639s/iter; left time: 894.9312s
	iters: 200, epoch: 38 | loss: 0.0721194
	speed: 0.0349s/iter; left time: 485.1501s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0721829 Vali Loss: 0.0873100 Test Loss: 0.0995601
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0740595
	speed: 0.0640s/iter; left time: 883.1529s
	iters: 200, epoch: 39 | loss: 0.0759868
	speed: 0.0347s/iter; left time: 475.0633s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0721212 Vali Loss: 0.0872104 Test Loss: 0.0995649
Validation loss decreased (0.087221 --> 0.087210).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0714033
	speed: 0.0633s/iter; left time: 859.0234s
	iters: 200, epoch: 40 | loss: 0.0775736
	speed: 0.0350s/iter; left time: 470.7843s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0721288 Vali Loss: 0.0872514 Test Loss: 0.0995313
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0671455
	speed: 0.0642s/iter; left time: 856.3591s
	iters: 200, epoch: 41 | loss: 0.0723835
	speed: 0.0349s/iter; left time: 461.7330s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0721268 Vali Loss: 0.0872710 Test Loss: 0.0995070
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0769761
	speed: 0.0639s/iter; left time: 838.7137s
	iters: 200, epoch: 42 | loss: 0.0741773
	speed: 0.0350s/iter; left time: 455.5866s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0721263 Vali Loss: 0.0873013 Test Loss: 0.0995426
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0737671
	speed: 0.0642s/iter; left time: 827.4074s
	iters: 200, epoch: 43 | loss: 0.0743199
	speed: 0.0349s/iter; left time: 446.3217s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0721220 Vali Loss: 0.0872798 Test Loss: 0.0995181
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0705272
	speed: 0.0637s/iter; left time: 806.8180s
	iters: 200, epoch: 44 | loss: 0.0677232
	speed: 0.0348s/iter; left time: 437.4343s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0721261 Vali Loss: 0.0872802 Test Loss: 0.0995224
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0704778
	speed: 0.0637s/iter; left time: 792.6969s
	iters: 200, epoch: 45 | loss: 0.0697315
	speed: 0.0348s/iter; left time: 429.6348s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0721031 Vali Loss: 0.0872046 Test Loss: 0.0995535
Validation loss decreased (0.087210 --> 0.087205).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0701408
	speed: 0.0641s/iter; left time: 782.7890s
	iters: 200, epoch: 46 | loss: 0.0692527
	speed: 0.0347s/iter; left time: 420.3872s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0720786 Vali Loss: 0.0872790 Test Loss: 0.0995581
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0739510
	speed: 0.0636s/iter; left time: 762.9644s
	iters: 200, epoch: 47 | loss: 0.0746403
	speed: 0.0347s/iter; left time: 412.9681s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0720801 Vali Loss: 0.0872303 Test Loss: 0.0995519
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0728113
	speed: 0.0638s/iter; left time: 751.0546s
	iters: 200, epoch: 48 | loss: 0.0714614
	speed: 0.0350s/iter; left time: 408.2624s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720379 Vali Loss: 0.0872027 Test Loss: 0.0995157
Validation loss decreased (0.087205 --> 0.087203).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0716667
	speed: 0.0644s/iter; left time: 743.8222s
	iters: 200, epoch: 49 | loss: 0.0703278
	speed: 0.0348s/iter; left time: 398.6068s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720567 Vali Loss: 0.0872355 Test Loss: 0.0995463
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0738860
	speed: 0.0640s/iter; left time: 724.4079s
	iters: 200, epoch: 50 | loss: 0.0701296
	speed: 0.0349s/iter; left time: 391.7908s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720803 Vali Loss: 0.0873472 Test Loss: 0.0995371
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0700471
	speed: 0.0636s/iter; left time: 706.5781s
	iters: 200, epoch: 51 | loss: 0.0730366
	speed: 0.0347s/iter; left time: 381.4985s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0720552 Vali Loss: 0.0871913 Test Loss: 0.0995232
Validation loss decreased (0.087203 --> 0.087191).  Saving model ...
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0715506
	speed: 0.0639s/iter; left time: 695.4474s
	iters: 200, epoch: 52 | loss: 0.0788366
	speed: 0.0348s/iter; left time: 375.4280s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0720206 Vali Loss: 0.0872680 Test Loss: 0.0995176
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0734903
	speed: 0.0643s/iter; left time: 684.5959s
	iters: 200, epoch: 53 | loss: 0.0793007
	speed: 0.0349s/iter; left time: 368.0538s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0720622 Vali Loss: 0.0872800 Test Loss: 0.0995366
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0712500
	speed: 0.0634s/iter; left time: 661.1482s
	iters: 200, epoch: 54 | loss: 0.0738263
	speed: 0.0348s/iter; left time: 359.3661s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0720450 Vali Loss: 0.0871872 Test Loss: 0.0995247
Validation loss decreased (0.087191 --> 0.087187).  Saving model ...
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0750317
	speed: 0.0639s/iter; left time: 652.5881s
	iters: 200, epoch: 55 | loss: 0.0706412
	speed: 0.0348s/iter; left time: 351.9051s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0720524 Vali Loss: 0.0873139 Test Loss: 0.0995383
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0734314
	speed: 0.0638s/iter; left time: 636.8701s
	iters: 200, epoch: 56 | loss: 0.0661391
	speed: 0.0349s/iter; left time: 344.4797s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0720490 Vali Loss: 0.0872193 Test Loss: 0.0995244
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0745966
	speed: 0.0640s/iter; left time: 624.8213s
	iters: 200, epoch: 57 | loss: 0.0707790
	speed: 0.0346s/iter; left time: 334.0096s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0720485 Vali Loss: 0.0872726 Test Loss: 0.0995388
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0686515
	speed: 0.0636s/iter; left time: 606.3552s
	iters: 200, epoch: 58 | loss: 0.0735711
	speed: 0.0347s/iter; left time: 327.6014s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0720425 Vali Loss: 0.0873438 Test Loss: 0.0995281
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0719042
	speed: 0.0633s/iter; left time: 589.0766s
	iters: 200, epoch: 59 | loss: 0.0699061
	speed: 0.0348s/iter; left time: 320.8892s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0720623 Vali Loss: 0.0872118 Test Loss: 0.0995263
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0748541
	speed: 0.0638s/iter; left time: 579.6535s
	iters: 200, epoch: 60 | loss: 0.0702347
	speed: 0.0347s/iter; left time: 311.5461s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0720553 Vali Loss: 0.0872779 Test Loss: 0.0995289
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0715567
	speed: 0.0638s/iter; left time: 565.5470s
	iters: 200, epoch: 61 | loss: 0.0686040
	speed: 0.0347s/iter; left time: 303.7046s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0720097 Vali Loss: 0.0872293 Test Loss: 0.0995297
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0671754
	speed: 0.0635s/iter; left time: 548.6304s
	iters: 200, epoch: 62 | loss: 0.0716106
	speed: 0.0348s/iter; left time: 296.6809s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0720588 Vali Loss: 0.0872945 Test Loss: 0.0995347
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0733839
	speed: 0.0634s/iter; left time: 533.6843s
	iters: 200, epoch: 63 | loss: 0.0701204
	speed: 0.0349s/iter; left time: 290.2111s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0719997 Vali Loss: 0.0872096 Test Loss: 0.0995342
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0736200
	speed: 0.0638s/iter; left time: 522.5718s
	iters: 200, epoch: 64 | loss: 0.0726243
	speed: 0.0348s/iter; left time: 281.8172s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0720378 Vali Loss: 0.0870822 Test Loss: 0.0995322
Validation loss decreased (0.087187 --> 0.087082).  Saving model ...
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0737420
	speed: 0.0646s/iter; left time: 514.4248s
	iters: 200, epoch: 65 | loss: 0.0728158
	speed: 0.0350s/iter; left time: 274.9991s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0720535 Vali Loss: 0.0872863 Test Loss: 0.0995258
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0738135
	speed: 0.0633s/iter; left time: 490.0502s
	iters: 200, epoch: 66 | loss: 0.0672279
	speed: 0.0350s/iter; left time: 267.4594s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0720467 Vali Loss: 0.0873255 Test Loss: 0.0995291
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0702585
	speed: 0.0634s/iter; left time: 476.4806s
	iters: 200, epoch: 67 | loss: 0.0712751
	speed: 0.0350s/iter; left time: 259.8081s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0719875 Vali Loss: 0.0872351 Test Loss: 0.0995178
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0701834
	speed: 0.0636s/iter; left time: 464.1901s
	iters: 200, epoch: 68 | loss: 0.0745251
	speed: 0.0350s/iter; left time: 251.7083s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720706 Vali Loss: 0.0872722 Test Loss: 0.0995202
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0687376
	speed: 0.0638s/iter; left time: 450.8925s
	iters: 200, epoch: 69 | loss: 0.0743411
	speed: 0.0345s/iter; left time: 240.4222s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0720265 Vali Loss: 0.0873333 Test Loss: 0.0995157
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0683332
	speed: 0.0636s/iter; left time: 435.2781s
	iters: 200, epoch: 70 | loss: 0.0714080
	speed: 0.0350s/iter; left time: 235.9815s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720460 Vali Loss: 0.0872303 Test Loss: 0.0995237
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.595044557171442e-08
	iters: 100, epoch: 71 | loss: 0.0679881
	speed: 0.0640s/iter; left time: 424.0507s
	iters: 200, epoch: 71 | loss: 0.0746943
	speed: 0.0348s/iter; left time: 227.0885s
-------------------------------------------------------------------------------------
Epoch: 71
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0720076 Vali Loss: 0.0872077 Test Loss: 0.0995299
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.735540101454298e-08
	iters: 100, epoch: 72 | loss: 0.0696613
	speed: 0.0637s/iter; left time: 407.5976s
	iters: 200, epoch: 72 | loss: 0.0704112
	speed: 0.0349s/iter; left time: 219.7776s
-------------------------------------------------------------------------------------
Epoch: 72
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720320 Vali Loss: 0.0873409 Test Loss: 0.0995243
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.961986091308869e-08
	iters: 100, epoch: 73 | loss: 0.0660415
	speed: 0.0639s/iter; left time: 394.3002s
	iters: 200, epoch: 73 | loss: 0.0716211
	speed: 0.0349s/iter; left time: 211.7188s
-------------------------------------------------------------------------------------
Epoch: 73
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0720218 Vali Loss: 0.0872789 Test Loss: 0.0995323
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.265787482177981e-08
	iters: 100, epoch: 74 | loss: 0.0706911
	speed: 0.0640s/iter; left time: 380.5219s
	iters: 200, epoch: 74 | loss: 0.0775421
	speed: 0.0352s/iter; left time: 205.6176s
-------------------------------------------------------------------------------------
Epoch: 74
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0720320 Vali Loss: 0.0872372 Test Loss: 0.0995224
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02484327182173729, rmse:0.1576174795627594, mae:0.09953224658966064, rse:0.5437356233596802
Intermediate time for GB and pred_len 24: 00h:19m:15.51s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1368649
	speed: 0.0554s/iter; left time: 1234.6488s
	iters: 200, epoch: 1 | loss: 0.1319336
	speed: 0.0348s/iter; left time: 773.6002s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.26s
Steps: 224 | Train Loss: 0.1355056 Vali Loss: 0.1317134 Test Loss: 0.1549273
Validation loss decreased (inf --> 0.131713).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1101865
	speed: 0.0658s/iter; left time: 1452.8023s
	iters: 200, epoch: 2 | loss: 0.1015781
	speed: 0.0349s/iter; left time: 767.3224s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.1090339 Vali Loss: 0.1182640 Test Loss: 0.1402453
Validation loss decreased (0.131713 --> 0.118264).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1019381
	speed: 0.0643s/iter; left time: 1406.1548s
	iters: 200, epoch: 3 | loss: 0.1028636
	speed: 0.0348s/iter; left time: 757.6439s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.1039787 Vali Loss: 0.1176117 Test Loss: 0.1411680
Validation loss decreased (0.118264 --> 0.117612).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1016131
	speed: 0.0666s/iter; left time: 1440.7773s
	iters: 200, epoch: 4 | loss: 0.1025104
	speed: 0.0348s/iter; left time: 749.3780s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.1026030 Vali Loss: 0.1165771 Test Loss: 0.1399828
Validation loss decreased (0.117612 --> 0.116577).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1020755
	speed: 0.0639s/iter; left time: 1366.8705s
	iters: 200, epoch: 5 | loss: 0.0942004
	speed: 0.0348s/iter; left time: 740.8848s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.1014609 Vali Loss: 0.1165077 Test Loss: 0.1414991
Validation loss decreased (0.116577 --> 0.116508).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1025276
	speed: 0.0648s/iter; left time: 1373.1437s
	iters: 200, epoch: 6 | loss: 0.1029382
	speed: 0.0348s/iter; left time: 733.6579s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.1005378 Vali Loss: 0.1160497 Test Loss: 0.1398813
Validation loss decreased (0.116508 --> 0.116050).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1035333
	speed: 0.0643s/iter; left time: 1347.0922s
	iters: 200, epoch: 7 | loss: 0.0968630
	speed: 0.0348s/iter; left time: 725.8403s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0997119 Vali Loss: 0.1159672 Test Loss: 0.1391855
Validation loss decreased (0.116050 --> 0.115967).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1007003
	speed: 0.0631s/iter; left time: 1307.9745s
	iters: 200, epoch: 8 | loss: 0.0977097
	speed: 0.0348s/iter; left time: 717.8939s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0988782 Vali Loss: 0.1170164 Test Loss: 0.1406159
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0989300
	speed: 0.0641s/iter; left time: 1314.0850s
	iters: 200, epoch: 9 | loss: 0.0987533
	speed: 0.0348s/iter; left time: 711.2099s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0981571 Vali Loss: 0.1171109 Test Loss: 0.1431257
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0996781
	speed: 0.0636s/iter; left time: 1290.0351s
	iters: 200, epoch: 10 | loss: 0.0938317
	speed: 0.0348s/iter; left time: 703.3430s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0975499 Vali Loss: 0.1171131 Test Loss: 0.1413700
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0966019
	speed: 0.0648s/iter; left time: 1299.9283s
	iters: 200, epoch: 11 | loss: 0.0990978
	speed: 0.0348s/iter; left time: 694.8137s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0969347 Vali Loss: 0.1170274 Test Loss: 0.1427449
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1012876
	speed: 0.0646s/iter; left time: 1280.6423s
	iters: 200, epoch: 12 | loss: 0.0973939
	speed: 0.0348s/iter; left time: 687.4680s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0964552 Vali Loss: 0.1163485 Test Loss: 0.1403130
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0965584
	speed: 0.0634s/iter; left time: 1244.4086s
	iters: 200, epoch: 13 | loss: 0.0978759
	speed: 0.0348s/iter; left time: 679.6502s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0960863 Vali Loss: 0.1174094 Test Loss: 0.1429162
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0961191
	speed: 0.0655s/iter; left time: 1270.0212s
	iters: 200, epoch: 14 | loss: 0.0933269
	speed: 0.0353s/iter; left time: 681.7616s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.14s
Steps: 224 | Train Loss: 0.0955543 Vali Loss: 0.1173004 Test Loss: 0.1413187
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0903248
	speed: 0.0648s/iter; left time: 1242.7000s
	iters: 200, epoch: 15 | loss: 0.0932759
	speed: 0.0349s/iter; left time: 664.6042s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0952487 Vali Loss: 0.1174274 Test Loss: 0.1424316
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0980628
	speed: 0.0643s/iter; left time: 1218.5882s
	iters: 200, epoch: 16 | loss: 0.0997342
	speed: 0.0353s/iter; left time: 664.8363s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.13s
Steps: 224 | Train Loss: 0.0949437 Vali Loss: 0.1175647 Test Loss: 0.1428966
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0929104
	speed: 0.0666s/iter; left time: 1245.6502s
	iters: 200, epoch: 17 | loss: 0.0939656
	speed: 0.0352s/iter; left time: 656.0859s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.0946952 Vali Loss: 0.1172830 Test Loss: 0.1419807
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04162506014108658, rmse:0.20402219891548157, mae:0.13918548822402954, rse:0.7055371999740601
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1341442
	speed: 0.0374s/iter; left time: 834.2353s
	iters: 200, epoch: 1 | loss: 0.1214196
	speed: 0.0352s/iter; left time: 780.9744s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.15s
Steps: 224 | Train Loss: 0.1354141 Vali Loss: 0.1306381 Test Loss: 0.1532616
Validation loss decreased (inf --> 0.130638).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1061506
	speed: 0.0676s/iter; left time: 1491.4995s
	iters: 200, epoch: 2 | loss: 0.1015642
	speed: 0.0351s/iter; left time: 771.7400s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.11s
Steps: 224 | Train Loss: 0.1090903 Vali Loss: 0.1179282 Test Loss: 0.1399687
Validation loss decreased (0.130638 --> 0.117928).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1033960
	speed: 0.0667s/iter; left time: 1458.3606s
	iters: 200, epoch: 3 | loss: 0.1050560
	speed: 0.0351s/iter; left time: 763.6208s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.1041172 Vali Loss: 0.1176966 Test Loss: 0.1399309
Validation loss decreased (0.117928 --> 0.117697).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0971541
	speed: 0.0711s/iter; left time: 1538.1264s
	iters: 200, epoch: 4 | loss: 0.1045809
	speed: 0.0352s/iter; left time: 757.4364s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.1028417 Vali Loss: 0.1172740 Test Loss: 0.1405992
Validation loss decreased (0.117697 --> 0.117274).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0983329
	speed: 0.0662s/iter; left time: 1416.0438s
	iters: 200, epoch: 5 | loss: 0.1046617
	speed: 0.0353s/iter; left time: 751.0190s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.10s
Steps: 224 | Train Loss: 0.1018973 Vali Loss: 0.1172741 Test Loss: 0.1405071
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0947971
	speed: 0.0661s/iter; left time: 1400.4396s
	iters: 200, epoch: 6 | loss: 0.1064766
	speed: 0.0352s/iter; left time: 741.0099s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.10s
Steps: 224 | Train Loss: 0.1011226 Vali Loss: 0.1168439 Test Loss: 0.1397677
Validation loss decreased (0.117274 --> 0.116844).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0962860
	speed: 0.0659s/iter; left time: 1380.9897s
	iters: 200, epoch: 7 | loss: 0.0969255
	speed: 0.0351s/iter; left time: 732.9566s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.09s
Steps: 224 | Train Loss: 0.1002986 Vali Loss: 0.1166861 Test Loss: 0.1398334
Validation loss decreased (0.116844 --> 0.116686).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0994120
	speed: 0.0673s/iter; left time: 1394.4946s
	iters: 200, epoch: 8 | loss: 0.0989460
	speed: 0.0351s/iter; left time: 724.9789s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.20s
Steps: 224 | Train Loss: 0.0996260 Vali Loss: 0.1169189 Test Loss: 0.1393265
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0979606
	speed: 0.0655s/iter; left time: 1343.2435s
	iters: 200, epoch: 9 | loss: 0.1020230
	speed: 0.0352s/iter; left time: 717.6583s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.14s
Steps: 224 | Train Loss: 0.0990757 Vali Loss: 0.1167031 Test Loss: 0.1406324
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0977345
	speed: 0.0664s/iter; left time: 1346.3870s
	iters: 200, epoch: 10 | loss: 0.0989595
	speed: 0.0350s/iter; left time: 706.5714s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0984879 Vali Loss: 0.1169406 Test Loss: 0.1403176
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0949658
	speed: 0.0658s/iter; left time: 1320.7527s
	iters: 200, epoch: 11 | loss: 0.0942378
	speed: 0.0350s/iter; left time: 698.9650s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0980638 Vali Loss: 0.1169103 Test Loss: 0.1412480
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0967921
	speed: 0.0652s/iter; left time: 1292.5768s
	iters: 200, epoch: 12 | loss: 0.1010688
	speed: 0.0350s/iter; left time: 690.3093s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.02s
Steps: 224 | Train Loss: 0.0976295 Vali Loss: 0.1171023 Test Loss: 0.1417844
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0940424
	speed: 0.0652s/iter; left time: 1279.0231s
	iters: 200, epoch: 13 | loss: 0.0925433
	speed: 0.0351s/iter; left time: 683.9504s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0971849 Vali Loss: 0.1174168 Test Loss: 0.1420580
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0973356
	speed: 0.0647s/iter; left time: 1254.7673s
	iters: 200, epoch: 14 | loss: 0.0963790
	speed: 0.0349s/iter; left time: 673.0846s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0968083 Vali Loss: 0.1169749 Test Loss: 0.1419740
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0981661
	speed: 0.0649s/iter; left time: 1244.3622s
	iters: 200, epoch: 15 | loss: 0.0942422
	speed: 0.0349s/iter; left time: 665.1590s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0964964 Vali Loss: 0.1174841 Test Loss: 0.1431663
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0933076
	speed: 0.0658s/iter; left time: 1245.5415s
	iters: 200, epoch: 16 | loss: 0.0971909
	speed: 0.0349s/iter; left time: 656.9222s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0962417 Vali Loss: 0.1168250 Test Loss: 0.1426309
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0938393
	speed: 0.0647s/iter; left time: 1210.1833s
	iters: 200, epoch: 17 | loss: 0.0952472
	speed: 0.0348s/iter; left time: 647.9401s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0959215 Vali Loss: 0.1170430 Test Loss: 0.1408603
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04170362278819084, rmse:0.2042146474123001, mae:0.139833465218544, rse:0.7062026858329773
Intermediate time for GB and pred_len 96: 00h:05m:53.14s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1350723
	speed: 0.0527s/iter; left time: 1170.6034s
	iters: 200, epoch: 1 | loss: 0.1271851
	speed: 0.0360s/iter; left time: 795.8425s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.40s
Steps: 223 | Train Loss: 0.1370788 Vali Loss: 0.1339603 Test Loss: 0.1580056
Validation loss decreased (inf --> 0.133960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1142252
	speed: 0.0650s/iter; left time: 1428.2764s
	iters: 200, epoch: 2 | loss: 0.1071705
	speed: 0.0352s/iter; left time: 771.1759s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.1134985 Vali Loss: 0.1227696 Test Loss: 0.1473785
Validation loss decreased (0.133960 --> 0.122770).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1099929
	speed: 0.0664s/iter; left time: 1444.4058s
	iters: 200, epoch: 3 | loss: 0.1064361
	speed: 0.0352s/iter; left time: 762.3494s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.16s
Steps: 223 | Train Loss: 0.1086618 Vali Loss: 0.1216080 Test Loss: 0.1464609
Validation loss decreased (0.122770 --> 0.121608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1087356
	speed: 0.0647s/iter; left time: 1393.1307s
	iters: 200, epoch: 4 | loss: 0.1129826
	speed: 0.0352s/iter; left time: 753.7193s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.1071192 Vali Loss: 0.1217823 Test Loss: 0.1464874
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1034026
	speed: 0.0643s/iter; left time: 1369.7788s
	iters: 200, epoch: 5 | loss: 0.1095601
	speed: 0.0352s/iter; left time: 746.5759s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.1057389 Vali Loss: 0.1211913 Test Loss: 0.1467036
Validation loss decreased (0.121608 --> 0.121191).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1024049
	speed: 0.0649s/iter; left time: 1368.0309s
	iters: 200, epoch: 6 | loss: 0.1049406
	speed: 0.0352s/iter; left time: 739.3499s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.1045543 Vali Loss: 0.1217408 Test Loss: 0.1483685
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1023685
	speed: 0.0635s/iter; left time: 1325.5652s
	iters: 200, epoch: 7 | loss: 0.0984707
	speed: 0.0352s/iter; left time: 731.3103s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.1035728 Vali Loss: 0.1217344 Test Loss: 0.1492728
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1017310
	speed: 0.0651s/iter; left time: 1344.0573s
	iters: 200, epoch: 8 | loss: 0.1068790
	speed: 0.0353s/iter; left time: 724.2956s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.1027208 Vali Loss: 0.1218432 Test Loss: 0.1475727
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1029130
	speed: 0.0652s/iter; left time: 1331.2002s
	iters: 200, epoch: 9 | loss: 0.0979883
	speed: 0.0352s/iter; left time: 714.6539s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.1020829 Vali Loss: 0.1217830 Test Loss: 0.1499628
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0992078
	speed: 0.0639s/iter; left time: 1290.4150s
	iters: 200, epoch: 10 | loss: 0.1015885
	speed: 0.0352s/iter; left time: 706.4269s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.1014156 Vali Loss: 0.1225091 Test Loss: 0.1514542
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1001842
	speed: 0.0637s/iter; left time: 1272.7056s
	iters: 200, epoch: 11 | loss: 0.0997025
	speed: 0.0352s/iter; left time: 698.6270s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.1008091 Vali Loss: 0.1216951 Test Loss: 0.1483363
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0969195
	speed: 0.0637s/iter; left time: 1257.3692s
	iters: 200, epoch: 12 | loss: 0.1000460
	speed: 0.0352s/iter; left time: 691.6470s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.1002690 Vali Loss: 0.1222479 Test Loss: 0.1495636
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1010885
	speed: 0.0633s/iter; left time: 1236.6747s
	iters: 200, epoch: 13 | loss: 0.1027193
	speed: 0.0351s/iter; left time: 682.5335s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0998652 Vali Loss: 0.1220233 Test Loss: 0.1502681
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0981189
	speed: 0.0650s/iter; left time: 1253.8337s
	iters: 200, epoch: 14 | loss: 0.0994089
	speed: 0.0353s/iter; left time: 678.6085s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0994364 Vali Loss: 0.1225578 Test Loss: 0.1513837
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.1023321
	speed: 0.0644s/iter; left time: 1227.9761s
	iters: 200, epoch: 15 | loss: 0.1032972
	speed: 0.0351s/iter; left time: 667.0994s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0990828 Vali Loss: 0.1228028 Test Loss: 0.1514718
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04451335221529007, rmse:0.21098187565803528, mae:0.1467035859823227, rse:0.731504499912262
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1345446
	speed: 0.0403s/iter; left time: 895.2149s
	iters: 200, epoch: 1 | loss: 0.1272192
	speed: 0.0363s/iter; left time: 801.5192s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.51s
Steps: 223 | Train Loss: 0.1373576 Vali Loss: 0.1342064 Test Loss: 0.1581632
Validation loss decreased (inf --> 0.134206).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1134878
	speed: 0.0663s/iter; left time: 1457.3118s
	iters: 200, epoch: 2 | loss: 0.1108844
	speed: 0.0351s/iter; left time: 768.8363s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1132910 Vali Loss: 0.1233612 Test Loss: 0.1481872
Validation loss decreased (0.134206 --> 0.123361).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1113022
	speed: 0.0662s/iter; left time: 1440.4657s
	iters: 200, epoch: 3 | loss: 0.1082540
	speed: 0.0360s/iter; left time: 779.5798s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.12s
Steps: 223 | Train Loss: 0.1087626 Vali Loss: 0.1223666 Test Loss: 0.1467507
Validation loss decreased (0.123361 --> 0.122367).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1096119
	speed: 0.0676s/iter; left time: 1456.1337s
	iters: 200, epoch: 4 | loss: 0.1078516
	speed: 0.0352s/iter; left time: 753.7685s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.1072762 Vali Loss: 0.1222670 Test Loss: 0.1473828
Validation loss decreased (0.122367 --> 0.122267).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1074537
	speed: 0.0667s/iter; left time: 1421.4816s
	iters: 200, epoch: 5 | loss: 0.1054640
	speed: 0.0353s/iter; left time: 749.0800s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.1057186 Vali Loss: 0.1218859 Test Loss: 0.1465276
Validation loss decreased (0.122267 --> 0.121886).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1062931
	speed: 0.0656s/iter; left time: 1383.5166s
	iters: 200, epoch: 6 | loss: 0.1022995
	speed: 0.0352s/iter; left time: 739.0795s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1044480 Vali Loss: 0.1219488 Test Loss: 0.1476138
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1007487
	speed: 0.0651s/iter; left time: 1359.1230s
	iters: 200, epoch: 7 | loss: 0.1070287
	speed: 0.0353s/iter; left time: 733.4055s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.1035077 Vali Loss: 0.1217108 Test Loss: 0.1468497
Validation loss decreased (0.121886 --> 0.121711).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1016237
	speed: 0.0663s/iter; left time: 1367.4301s
	iters: 200, epoch: 8 | loss: 0.1010307
	speed: 0.0351s/iter; left time: 721.9355s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.1026994 Vali Loss: 0.1222955 Test Loss: 0.1479983
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1011974
	speed: 0.0652s/iter; left time: 1330.5172s
	iters: 200, epoch: 9 | loss: 0.1042520
	speed: 0.0353s/iter; left time: 717.5599s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.1019803 Vali Loss: 0.1226025 Test Loss: 0.1500250
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0998199
	speed: 0.0646s/iter; left time: 1303.9361s
	iters: 200, epoch: 10 | loss: 0.1032624
	speed: 0.0352s/iter; left time: 706.6309s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.1012618 Vali Loss: 0.1232424 Test Loss: 0.1511443
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1019999
	speed: 0.0647s/iter; left time: 1291.8289s
	iters: 200, epoch: 11 | loss: 0.1031724
	speed: 0.0352s/iter; left time: 698.7574s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.1005646 Vali Loss: 0.1225561 Test Loss: 0.1496281
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1002238
	speed: 0.0654s/iter; left time: 1292.4244s
	iters: 200, epoch: 12 | loss: 0.0998397
	speed: 0.0353s/iter; left time: 693.8179s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0999939 Vali Loss: 0.1233360 Test Loss: 0.1489431
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1030586
	speed: 0.0655s/iter; left time: 1278.9109s
	iters: 200, epoch: 13 | loss: 0.1004540
	speed: 0.0354s/iter; left time: 688.3262s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0993963 Vali Loss: 0.1238692 Test Loss: 0.1506494
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0976809
	speed: 0.0663s/iter; left time: 1280.0108s
	iters: 200, epoch: 14 | loss: 0.0994988
	speed: 0.0354s/iter; left time: 679.0797s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0990119 Vali Loss: 0.1232814 Test Loss: 0.1509458
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0972044
	speed: 0.0653s/iter; left time: 1245.5241s
	iters: 200, epoch: 15 | loss: 0.1007163
	speed: 0.0352s/iter; left time: 667.2888s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0985824 Vali Loss: 0.1235543 Test Loss: 0.1504480
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.1012219
	speed: 0.0649s/iter; left time: 1223.5909s
	iters: 200, epoch: 16 | loss: 0.0998645
	speed: 0.0354s/iter; left time: 664.1654s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0982247 Vali Loss: 0.1236940 Test Loss: 0.1515266
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0975052
	speed: 0.0646s/iter; left time: 1203.0937s
	iters: 200, epoch: 17 | loss: 0.0969503
	speed: 0.0352s/iter; left time: 652.1685s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0978876 Vali Loss: 0.1239806 Test Loss: 0.1516184
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.044920217245817184, rmse:0.21194389462471008, mae:0.1468495875597, rse:0.734839916229248
Intermediate time for GB and pred_len 168: 00h:05m:34.71s
Intermediate time for GB: 00h:30m:43.37s

=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1298670
	speed: 0.0415s/iter; left time: 925.1134s
	iters: 200, epoch: 1 | loss: 0.1123726
	speed: 0.0216s/iter; left time: 480.4370s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.31s
Steps: 224 | Train Loss: 0.1356300 Vali Loss: 0.0979842 Test Loss: 0.1105413
Validation loss decreased (inf --> 0.097984).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0737654
	speed: 0.0425s/iter; left time: 938.7700s
	iters: 200, epoch: 2 | loss: 0.0692282
	speed: 0.0218s/iter; left time: 478.3500s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0770465 Vali Loss: 0.0648699 Test Loss: 0.0713267
Validation loss decreased (0.097984 --> 0.064870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0633628
	speed: 0.0425s/iter; left time: 928.2808s
	iters: 200, epoch: 3 | loss: 0.0653490
	speed: 0.0215s/iter; left time: 468.1188s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0655215 Vali Loss: 0.0602665 Test Loss: 0.0663078
Validation loss decreased (0.064870 --> 0.060267).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0622144
	speed: 0.0423s/iter; left time: 914.6301s
	iters: 200, epoch: 4 | loss: 0.0639108
	speed: 0.0218s/iter; left time: 468.3008s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0624059 Vali Loss: 0.0590331 Test Loss: 0.0655046
Validation loss decreased (0.060267 --> 0.059033).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0597853
	speed: 0.0424s/iter; left time: 906.5143s
	iters: 200, epoch: 5 | loss: 0.0606989
	speed: 0.0214s/iter; left time: 456.8188s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0604129 Vali Loss: 0.0572534 Test Loss: 0.0634984
Validation loss decreased (0.059033 --> 0.057253).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0565692
	speed: 0.0425s/iter; left time: 900.4499s
	iters: 200, epoch: 6 | loss: 0.0577320
	speed: 0.0215s/iter; left time: 452.8372s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0591839 Vali Loss: 0.0567175 Test Loss: 0.0627465
Validation loss decreased (0.057253 --> 0.056717).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0643436
	speed: 0.0439s/iter; left time: 920.9720s
	iters: 200, epoch: 7 | loss: 0.0603589
	speed: 0.0215s/iter; left time: 447.9992s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0582673 Vali Loss: 0.0561868 Test Loss: 0.0623379
Validation loss decreased (0.056717 --> 0.056187).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0601041
	speed: 0.0428s/iter; left time: 888.0656s
	iters: 200, epoch: 8 | loss: 0.0537687
	speed: 0.0216s/iter; left time: 445.8277s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0575629 Vali Loss: 0.0555081 Test Loss: 0.0619841
Validation loss decreased (0.056187 --> 0.055508).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0580762
	speed: 0.0425s/iter; left time: 871.5189s
	iters: 200, epoch: 9 | loss: 0.0556999
	speed: 0.0216s/iter; left time: 440.7055s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0568983 Vali Loss: 0.0552543 Test Loss: 0.0613716
Validation loss decreased (0.055508 --> 0.055254).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0595903
	speed: 0.0458s/iter; left time: 929.6966s
	iters: 200, epoch: 10 | loss: 0.0543491
	speed: 0.0214s/iter; left time: 432.2333s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0564607 Vali Loss: 0.0551281 Test Loss: 0.0614527
Validation loss decreased (0.055254 --> 0.055128).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0582845
	speed: 0.0424s/iter; left time: 850.2137s
	iters: 200, epoch: 11 | loss: 0.0565036
	speed: 0.0218s/iter; left time: 435.3924s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0559774 Vali Loss: 0.0546737 Test Loss: 0.0609168
Validation loss decreased (0.055128 --> 0.054674).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0554969
	speed: 0.0420s/iter; left time: 832.4733s
	iters: 200, epoch: 12 | loss: 0.0551604
	speed: 0.0214s/iter; left time: 423.1634s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0556352 Vali Loss: 0.0545354 Test Loss: 0.0609479
Validation loss decreased (0.054674 --> 0.054535).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0534320
	speed: 0.0419s/iter; left time: 820.9269s
	iters: 200, epoch: 13 | loss: 0.0509334
	speed: 0.0214s/iter; left time: 417.7691s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0552956 Vali Loss: 0.0544649 Test Loss: 0.0605663
Validation loss decreased (0.054535 --> 0.054465).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0569654
	speed: 0.0422s/iter; left time: 817.9739s
	iters: 200, epoch: 14 | loss: 0.0535476
	speed: 0.0214s/iter; left time: 413.3862s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0550428 Vali Loss: 0.0541201 Test Loss: 0.0604142
Validation loss decreased (0.054465 --> 0.054120).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0538801
	speed: 0.0420s/iter; left time: 805.3141s
	iters: 200, epoch: 15 | loss: 0.0547211
	speed: 0.0214s/iter; left time: 408.2548s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0548103 Vali Loss: 0.0540373 Test Loss: 0.0603104
Validation loss decreased (0.054120 --> 0.054037).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0519740
	speed: 0.0420s/iter; left time: 795.2942s
	iters: 200, epoch: 16 | loss: 0.0552315
	speed: 0.0214s/iter; left time: 403.0866s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0545696 Vali Loss: 0.0540554 Test Loss: 0.0603579
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0531541
	speed: 0.0414s/iter; left time: 774.3167s
	iters: 200, epoch: 17 | loss: 0.0551341
	speed: 0.0214s/iter; left time: 399.0773s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0544336 Vali Loss: 0.0536491 Test Loss: 0.0599721
Validation loss decreased (0.054037 --> 0.053649).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0536914
	speed: 0.0424s/iter; left time: 784.8796s
	iters: 200, epoch: 18 | loss: 0.0528644
	speed: 0.0214s/iter; left time: 394.0977s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0543115 Vali Loss: 0.0535106 Test Loss: 0.0598589
Validation loss decreased (0.053649 --> 0.053511).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0545141
	speed: 0.0417s/iter; left time: 762.2365s
	iters: 200, epoch: 19 | loss: 0.0527273
	speed: 0.0214s/iter; left time: 389.3125s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0541158 Vali Loss: 0.0536582 Test Loss: 0.0598251
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0546011
	speed: 0.0414s/iter; left time: 747.1655s
	iters: 200, epoch: 20 | loss: 0.0573375
	speed: 0.0215s/iter; left time: 385.4801s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0539415 Vali Loss: 0.0535942 Test Loss: 0.0599157
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0545147
	speed: 0.0415s/iter; left time: 740.1909s
	iters: 200, epoch: 21 | loss: 0.0549585
	speed: 0.0214s/iter; left time: 379.5519s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0538274 Vali Loss: 0.0534529 Test Loss: 0.0598036
Validation loss decreased (0.053511 --> 0.053453).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0553077
	speed: 0.0421s/iter; left time: 740.9730s
	iters: 200, epoch: 22 | loss: 0.0515996
	speed: 0.0214s/iter; left time: 375.1851s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0537420 Vali Loss: 0.0532791 Test Loss: 0.0596330
Validation loss decreased (0.053453 --> 0.053279).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0529407
	speed: 0.0424s/iter; left time: 736.2075s
	iters: 200, epoch: 23 | loss: 0.0524024
	speed: 0.0214s/iter; left time: 369.6820s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0536276 Vali Loss: 0.0534068 Test Loss: 0.0596825
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0540160
	speed: 0.0415s/iter; left time: 711.4182s
	iters: 200, epoch: 24 | loss: 0.0539657
	speed: 0.0214s/iter; left time: 365.1341s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0535633 Vali Loss: 0.0532834 Test Loss: 0.0595174
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0576103
	speed: 0.0412s/iter; left time: 697.8098s
	iters: 200, epoch: 25 | loss: 0.0518737
	speed: 0.0214s/iter; left time: 360.7308s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0534328 Vali Loss: 0.0533031 Test Loss: 0.0596040
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0532881
	speed: 0.0419s/iter; left time: 700.1183s
	iters: 200, epoch: 26 | loss: 0.0546579
	speed: 0.0214s/iter; left time: 355.9847s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0534073 Vali Loss: 0.0533640 Test Loss: 0.0595210
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0513663
	speed: 0.0416s/iter; left time: 685.9145s
	iters: 200, epoch: 27 | loss: 0.0566319
	speed: 0.0214s/iter; left time: 350.4075s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0533159 Vali Loss: 0.0533430 Test Loss: 0.0594933
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0499575
	speed: 0.0414s/iter; left time: 672.8622s
	iters: 200, epoch: 28 | loss: 0.0530464
	speed: 0.0214s/iter; left time: 345.4976s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0532951 Vali Loss: 0.0531354 Test Loss: 0.0594555
Validation loss decreased (0.053279 --> 0.053135).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0519671
	speed: 0.0419s/iter; left time: 672.1155s
	iters: 200, epoch: 29 | loss: 0.0520967
	speed: 0.0214s/iter; left time: 340.8831s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0532587 Vali Loss: 0.0530812 Test Loss: 0.0593866
Validation loss decreased (0.053135 --> 0.053081).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0520738
	speed: 0.0419s/iter; left time: 661.8670s
	iters: 200, epoch: 30 | loss: 0.0531664
	speed: 0.0214s/iter; left time: 336.5991s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0532055 Vali Loss: 0.0530917 Test Loss: 0.0593216
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0540286
	speed: 0.0413s/iter; left time: 643.5799s
	iters: 200, epoch: 31 | loss: 0.0566464
	speed: 0.0214s/iter; left time: 331.5279s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0531638 Vali Loss: 0.0529826 Test Loss: 0.0593910
Validation loss decreased (0.053081 --> 0.052983).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0526562
	speed: 0.0419s/iter; left time: 642.9197s
	iters: 200, epoch: 32 | loss: 0.0515179
	speed: 0.0214s/iter; left time: 326.5281s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0530721 Vali Loss: 0.0531143 Test Loss: 0.0594014
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0543895
	speed: 0.0417s/iter; left time: 630.7297s
	iters: 200, epoch: 33 | loss: 0.0532493
	speed: 0.0214s/iter; left time: 321.3934s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0531146 Vali Loss: 0.0529428 Test Loss: 0.0592363
Validation loss decreased (0.052983 --> 0.052943).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0551238
	speed: 0.0419s/iter; left time: 624.0518s
	iters: 200, epoch: 34 | loss: 0.0514019
	speed: 0.0214s/iter; left time: 316.8016s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0530357 Vali Loss: 0.0529991 Test Loss: 0.0592847
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0537152
	speed: 0.0423s/iter; left time: 621.6852s
	iters: 200, epoch: 35 | loss: 0.0518303
	speed: 0.0214s/iter; left time: 311.8670s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0530443 Vali Loss: 0.0530798 Test Loss: 0.0592918
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0553218
	speed: 0.0414s/iter; left time: 598.5321s
	iters: 200, epoch: 36 | loss: 0.0520547
	speed: 0.0214s/iter; left time: 307.0458s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0530445 Vali Loss: 0.0529497 Test Loss: 0.0592279
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0513291
	speed: 0.0418s/iter; left time: 594.7580s
	iters: 200, epoch: 37 | loss: 0.0541513
	speed: 0.0215s/iter; left time: 303.4763s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0529879 Vali Loss: 0.0529939 Test Loss: 0.0592844
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0505443
	speed: 0.0414s/iter; left time: 580.7580s
	iters: 200, epoch: 38 | loss: 0.0543361
	speed: 0.0214s/iter; left time: 297.5637s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0529520 Vali Loss: 0.0529140 Test Loss: 0.0591908
Validation loss decreased (0.052943 --> 0.052914).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0533418
	speed: 0.0423s/iter; left time: 583.4322s
	iters: 200, epoch: 39 | loss: 0.0524147
	speed: 0.0214s/iter; left time: 293.5692s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0529510 Vali Loss: 0.0529290 Test Loss: 0.0592367
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0498722
	speed: 0.0417s/iter; left time: 565.8636s
	iters: 200, epoch: 40 | loss: 0.0535404
	speed: 0.0214s/iter; left time: 288.1348s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0529404 Vali Loss: 0.0529907 Test Loss: 0.0593157
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0529301
	speed: 0.0413s/iter; left time: 551.5026s
	iters: 200, epoch: 41 | loss: 0.0534077
	speed: 0.0214s/iter; left time: 283.6082s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0529699 Vali Loss: 0.0529282 Test Loss: 0.0591911
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0561879
	speed: 0.0416s/iter; left time: 546.1652s
	iters: 200, epoch: 42 | loss: 0.0530915
	speed: 0.0214s/iter; left time: 279.1084s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0528961 Vali Loss: 0.0529526 Test Loss: 0.0591979
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0507365
	speed: 0.0415s/iter; left time: 535.1932s
	iters: 200, epoch: 43 | loss: 0.0523150
	speed: 0.0214s/iter; left time: 273.8283s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0529152 Vali Loss: 0.0529601 Test Loss: 0.0592044
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0551199
	speed: 0.0412s/iter; left time: 521.8868s
	iters: 200, epoch: 44 | loss: 0.0540401
	speed: 0.0214s/iter; left time: 269.2089s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0528878 Vali Loss: 0.0529594 Test Loss: 0.0591871
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0514586
	speed: 0.0414s/iter; left time: 514.9899s
	iters: 200, epoch: 45 | loss: 0.0563003
	speed: 0.0214s/iter; left time: 264.6977s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0528507 Vali Loss: 0.0529300 Test Loss: 0.0591909
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0518282
	speed: 0.0424s/iter; left time: 518.3305s
	iters: 200, epoch: 46 | loss: 0.0541125
	speed: 0.0291s/iter; left time: 352.3199s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.02s
Steps: 224 | Train Loss: 0.0528566 Vali Loss: 0.0529993 Test Loss: 0.0592228
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0548774
	speed: 0.0644s/iter; left time: 772.8957s
	iters: 200, epoch: 47 | loss: 0.0509543
	speed: 0.0302s/iter; left time: 358.7023s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.86s
Steps: 224 | Train Loss: 0.0528889 Vali Loss: 0.0529689 Test Loss: 0.0591520
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0550609
	speed: 0.0623s/iter; left time: 733.8610s
	iters: 200, epoch: 48 | loss: 0.0504436
	speed: 0.0286s/iter; left time: 334.3810s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.67s
Steps: 224 | Train Loss: 0.0528672 Vali Loss: 0.0529224 Test Loss: 0.0591862
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009746785275638103, rmse:0.0987258106470108, mae:0.05919082462787628, rse:0.29053810238838196
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1293662
	speed: 0.0318s/iter; left time: 709.4411s
	iters: 200, epoch: 1 | loss: 0.1084518
	speed: 0.0289s/iter; left time: 641.7149s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.83s
Steps: 224 | Train Loss: 0.1345529 Vali Loss: 0.0963300 Test Loss: 0.1083074
Validation loss decreased (inf --> 0.096330).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0789599
	speed: 0.0652s/iter; left time: 1439.4350s
	iters: 200, epoch: 2 | loss: 0.0650750
	speed: 0.0287s/iter; left time: 631.2391s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.72s
Steps: 224 | Train Loss: 0.0765589 Vali Loss: 0.0644628 Test Loss: 0.0710606
Validation loss decreased (0.096330 --> 0.064463).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0675499
	speed: 0.0652s/iter; left time: 1425.6710s
	iters: 200, epoch: 3 | loss: 0.0669633
	speed: 0.0291s/iter; left time: 633.2917s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.82s
Steps: 224 | Train Loss: 0.0658001 Vali Loss: 0.0607895 Test Loss: 0.0672820
Validation loss decreased (0.064463 --> 0.060790).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0629823
	speed: 0.0656s/iter; left time: 1418.6444s
	iters: 200, epoch: 4 | loss: 0.0621647
	speed: 0.0294s/iter; left time: 632.2061s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.96s
Steps: 224 | Train Loss: 0.0626464 Vali Loss: 0.0587480 Test Loss: 0.0651175
Validation loss decreased (0.060790 --> 0.058748).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0635245
	speed: 0.0677s/iter; left time: 1450.1443s
	iters: 200, epoch: 5 | loss: 0.0605056
	speed: 0.0298s/iter; left time: 634.8703s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.95s
Steps: 224 | Train Loss: 0.0606723 Vali Loss: 0.0572892 Test Loss: 0.0640903
Validation loss decreased (0.058748 --> 0.057289).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0567591
	speed: 0.0640s/iter; left time: 1355.6710s
	iters: 200, epoch: 6 | loss: 0.0588183
	speed: 0.0277s/iter; left time: 584.6913s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.64s
Steps: 224 | Train Loss: 0.0593251 Vali Loss: 0.0569096 Test Loss: 0.0635448
Validation loss decreased (0.057289 --> 0.056910).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0578025
	speed: 0.0652s/iter; left time: 1365.5753s
	iters: 200, epoch: 7 | loss: 0.0593312
	speed: 0.0290s/iter; left time: 604.8559s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.84s
Steps: 224 | Train Loss: 0.0583814 Vali Loss: 0.0562718 Test Loss: 0.0629522
Validation loss decreased (0.056910 --> 0.056272).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0578907
	speed: 0.0652s/iter; left time: 1352.3167s
	iters: 200, epoch: 8 | loss: 0.0588079
	speed: 0.0288s/iter; left time: 593.4093s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.81s
Steps: 224 | Train Loss: 0.0575537 Vali Loss: 0.0556826 Test Loss: 0.0618967
Validation loss decreased (0.056272 --> 0.055683).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0617650
	speed: 0.0658s/iter; left time: 1349.5814s
	iters: 200, epoch: 9 | loss: 0.0534514
	speed: 0.0297s/iter; left time: 606.5149s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.89s
Steps: 224 | Train Loss: 0.0570048 Vali Loss: 0.0552326 Test Loss: 0.0617484
Validation loss decreased (0.055683 --> 0.055233).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0555236
	speed: 0.0649s/iter; left time: 1316.9155s
	iters: 200, epoch: 10 | loss: 0.0538077
	speed: 0.0296s/iter; left time: 597.9421s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.81s
Steps: 224 | Train Loss: 0.0564032 Vali Loss: 0.0549955 Test Loss: 0.0614280
Validation loss decreased (0.055233 --> 0.054996).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0555907
	speed: 0.0657s/iter; left time: 1318.1450s
	iters: 200, epoch: 11 | loss: 0.0555988
	speed: 0.0303s/iter; left time: 604.8530s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.05s
Steps: 224 | Train Loss: 0.0560193 Vali Loss: 0.0549655 Test Loss: 0.0613595
Validation loss decreased (0.054996 --> 0.054965).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0571024
	speed: 0.0640s/iter; left time: 1269.6588s
	iters: 200, epoch: 12 | loss: 0.0571437
	speed: 0.0281s/iter; left time: 553.8344s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.42s
Steps: 224 | Train Loss: 0.0556331 Vali Loss: 0.0542642 Test Loss: 0.0607060
Validation loss decreased (0.054965 --> 0.054264).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0581487
	speed: 0.0424s/iter; left time: 831.8920s
	iters: 200, epoch: 13 | loss: 0.0553184
	speed: 0.0215s/iter; left time: 418.8839s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0552673 Vali Loss: 0.0543863 Test Loss: 0.0610524
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0572586
	speed: 0.0413s/iter; left time: 801.2507s
	iters: 200, epoch: 14 | loss: 0.0559977
	speed: 0.0215s/iter; left time: 413.9933s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0550050 Vali Loss: 0.0541198 Test Loss: 0.0608031
Validation loss decreased (0.054264 --> 0.054120).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0553904
	speed: 0.0426s/iter; left time: 816.1232s
	iters: 200, epoch: 15 | loss: 0.0553633
	speed: 0.0215s/iter; left time: 409.0780s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0547834 Vali Loss: 0.0540436 Test Loss: 0.0606437
Validation loss decreased (0.054120 --> 0.054044).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0587407
	speed: 0.0419s/iter; left time: 792.7311s
	iters: 200, epoch: 16 | loss: 0.0548178
	speed: 0.0215s/iter; left time: 404.2766s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0545800 Vali Loss: 0.0537979 Test Loss: 0.0604315
Validation loss decreased (0.054044 --> 0.053798).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0535629
	speed: 0.0417s/iter; left time: 780.6646s
	iters: 200, epoch: 17 | loss: 0.0531620
	speed: 0.0215s/iter; left time: 400.3677s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0544193 Vali Loss: 0.0537036 Test Loss: 0.0601052
Validation loss decreased (0.053798 --> 0.053704).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0549918
	speed: 0.0418s/iter; left time: 773.0078s
	iters: 200, epoch: 18 | loss: 0.0571273
	speed: 0.0215s/iter; left time: 395.0622s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0541914 Vali Loss: 0.0537891 Test Loss: 0.0603252
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0533558
	speed: 0.0414s/iter; left time: 757.0526s
	iters: 200, epoch: 19 | loss: 0.0556851
	speed: 0.0214s/iter; left time: 389.5046s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0540281 Vali Loss: 0.0535258 Test Loss: 0.0600036
Validation loss decreased (0.053704 --> 0.053526).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0534450
	speed: 0.0425s/iter; left time: 766.9382s
	iters: 200, epoch: 20 | loss: 0.0529109
	speed: 0.0221s/iter; left time: 395.7722s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0539696 Vali Loss: 0.0535217 Test Loss: 0.0600964
Validation loss decreased (0.053526 --> 0.053522).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0576730
	speed: 0.0432s/iter; left time: 769.2263s
	iters: 200, epoch: 21 | loss: 0.0562272
	speed: 0.0221s/iter; left time: 392.4941s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0538568 Vali Loss: 0.0534423 Test Loss: 0.0600823
Validation loss decreased (0.053522 --> 0.053442).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0584354
	speed: 0.0442s/iter; left time: 777.9576s
	iters: 200, epoch: 22 | loss: 0.0571613
	speed: 0.0225s/iter; left time: 393.5681s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0537330 Vali Loss: 0.0532508 Test Loss: 0.0599182
Validation loss decreased (0.053442 --> 0.053251).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0563859
	speed: 0.0434s/iter; left time: 754.4608s
	iters: 200, epoch: 23 | loss: 0.0520345
	speed: 0.0222s/iter; left time: 383.8561s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0536130 Vali Loss: 0.0533164 Test Loss: 0.0597778
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0567659
	speed: 0.0421s/iter; left time: 722.7890s
	iters: 200, epoch: 24 | loss: 0.0521040
	speed: 0.0215s/iter; left time: 366.4917s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0535649 Vali Loss: 0.0533078 Test Loss: 0.0597867
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0589507
	speed: 0.0411s/iter; left time: 696.2132s
	iters: 200, epoch: 25 | loss: 0.0548259
	speed: 0.0215s/iter; left time: 361.5470s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0534987 Vali Loss: 0.0532403 Test Loss: 0.0597370
Validation loss decreased (0.053251 --> 0.053240).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0520487
	speed: 0.0413s/iter; left time: 690.3747s
	iters: 200, epoch: 26 | loss: 0.0558275
	speed: 0.0215s/iter; left time: 356.3530s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0534454 Vali Loss: 0.0532098 Test Loss: 0.0596481
Validation loss decreased (0.053240 --> 0.053210).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0561691
	speed: 0.0413s/iter; left time: 680.4006s
	iters: 200, epoch: 27 | loss: 0.0522081
	speed: 0.0215s/iter; left time: 351.5475s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0533647 Vali Loss: 0.0530668 Test Loss: 0.0596505
Validation loss decreased (0.053210 --> 0.053067).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0550688
	speed: 0.0424s/iter; left time: 688.9829s
	iters: 200, epoch: 28 | loss: 0.0555525
	speed: 0.0214s/iter; left time: 345.9128s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0532714 Vali Loss: 0.0531859 Test Loss: 0.0597596
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0558985
	speed: 0.0411s/iter; left time: 659.2092s
	iters: 200, epoch: 29 | loss: 0.0521408
	speed: 0.0214s/iter; left time: 341.6088s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0532727 Vali Loss: 0.0530185 Test Loss: 0.0596468
Validation loss decreased (0.053067 --> 0.053018).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0537556
	speed: 0.0424s/iter; left time: 670.5603s
	iters: 200, epoch: 30 | loss: 0.0534977
	speed: 0.0218s/iter; left time: 342.7489s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0531877 Vali Loss: 0.0531073 Test Loss: 0.0596250
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0550343
	speed: 0.0417s/iter; left time: 649.7372s
	iters: 200, epoch: 31 | loss: 0.0521811
	speed: 0.0215s/iter; left time: 332.5729s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0531241 Vali Loss: 0.0531039 Test Loss: 0.0596747
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0539435
	speed: 0.0410s/iter; left time: 630.3320s
	iters: 200, epoch: 32 | loss: 0.0491288
	speed: 0.0215s/iter; left time: 327.7883s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0531421 Vali Loss: 0.0530996 Test Loss: 0.0596391
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0556729
	speed: 0.0426s/iter; left time: 645.3928s
	iters: 200, epoch: 33 | loss: 0.0493943
	speed: 0.0214s/iter; left time: 322.2376s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0531437 Vali Loss: 0.0530059 Test Loss: 0.0595869
Validation loss decreased (0.053018 --> 0.053006).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0569810
	speed: 0.0419s/iter; left time: 624.5279s
	iters: 200, epoch: 34 | loss: 0.0548855
	speed: 0.0215s/iter; left time: 318.4691s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0530963 Vali Loss: 0.0529684 Test Loss: 0.0595935
Validation loss decreased (0.053006 --> 0.052968).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0478047
	speed: 0.0416s/iter; left time: 610.6880s
	iters: 200, epoch: 35 | loss: 0.0539466
	speed: 0.0215s/iter; left time: 313.8541s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0530745 Vali Loss: 0.0529274 Test Loss: 0.0595120
Validation loss decreased (0.052968 --> 0.052927).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0559533
	speed: 0.0414s/iter; left time: 599.0636s
	iters: 200, epoch: 36 | loss: 0.0502705
	speed: 0.0216s/iter; left time: 309.5817s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0530489 Vali Loss: 0.0529619 Test Loss: 0.0595732
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0493505
	speed: 0.0426s/iter; left time: 606.0205s
	iters: 200, epoch: 37 | loss: 0.0535447
	speed: 0.0215s/iter; left time: 303.3882s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0529914 Vali Loss: 0.0528805 Test Loss: 0.0595912
Validation loss decreased (0.052927 --> 0.052880).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0518180
	speed: 0.0434s/iter; left time: 607.7462s
	iters: 200, epoch: 38 | loss: 0.0555135
	speed: 0.0215s/iter; left time: 299.1126s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0529215 Vali Loss: 0.0529901 Test Loss: 0.0595285
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0510964
	speed: 0.0413s/iter; left time: 569.6215s
	iters: 200, epoch: 39 | loss: 0.0501677
	speed: 0.0215s/iter; left time: 293.7533s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0529102 Vali Loss: 0.0529945 Test Loss: 0.0595707
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0501363
	speed: 0.0417s/iter; left time: 564.9890s
	iters: 200, epoch: 40 | loss: 0.0531555
	speed: 0.0214s/iter; left time: 287.9995s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0529804 Vali Loss: 0.0529899 Test Loss: 0.0595702
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0537074
	speed: 0.0425s/iter; left time: 566.4713s
	iters: 200, epoch: 41 | loss: 0.0501498
	speed: 0.0219s/iter; left time: 289.6408s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0529319 Vali Loss: 0.0529200 Test Loss: 0.0594739
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0506166
	speed: 0.0432s/iter; left time: 566.6907s
	iters: 200, epoch: 42 | loss: 0.0538463
	speed: 0.0217s/iter; left time: 282.8186s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0528967 Vali Loss: 0.0529337 Test Loss: 0.0594169
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0551537
	speed: 0.0412s/iter; left time: 531.4690s
	iters: 200, epoch: 43 | loss: 0.0541291
	speed: 0.0215s/iter; left time: 274.4972s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0528578 Vali Loss: 0.0529309 Test Loss: 0.0595201
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0572280
	speed: 0.0413s/iter; left time: 523.6465s
	iters: 200, epoch: 44 | loss: 0.0526779
	speed: 0.0215s/iter; left time: 270.4047s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0528968 Vali Loss: 0.0529269 Test Loss: 0.0594907
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0542270
	speed: 0.0411s/iter; left time: 510.9956s
	iters: 200, epoch: 45 | loss: 0.0519096
	speed: 0.0215s/iter; left time: 265.0313s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0528364 Vali Loss: 0.0528504 Test Loss: 0.0594572
Validation loss decreased (0.052880 --> 0.052850).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0567479
	speed: 0.0413s/iter; left time: 504.6692s
	iters: 200, epoch: 46 | loss: 0.0533641
	speed: 0.0214s/iter; left time: 259.9578s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0529016 Vali Loss: 0.0528505 Test Loss: 0.0594816
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0534554
	speed: 0.0414s/iter; left time: 497.0698s
	iters: 200, epoch: 47 | loss: 0.0475648
	speed: 0.0214s/iter; left time: 254.7002s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0529094 Vali Loss: 0.0529142 Test Loss: 0.0594686
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0500164
	speed: 0.0409s/iter; left time: 482.0654s
	iters: 200, epoch: 48 | loss: 0.0512429
	speed: 0.0214s/iter; left time: 250.3545s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0528236 Vali Loss: 0.0529287 Test Loss: 0.0594930
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0520317
	speed: 0.0410s/iter; left time: 473.6480s
	iters: 200, epoch: 49 | loss: 0.0548631
	speed: 0.0215s/iter; left time: 246.0004s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0528925 Vali Loss: 0.0528737 Test Loss: 0.0594869
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0503222
	speed: 0.0416s/iter; left time: 471.1628s
	iters: 200, epoch: 50 | loss: 0.0584875
	speed: 0.0215s/iter; left time: 241.1656s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0529061 Vali Loss: 0.0528876 Test Loss: 0.0594881
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0538329
	speed: 0.0412s/iter; left time: 457.4212s
	iters: 200, epoch: 51 | loss: 0.0508686
	speed: 0.0214s/iter; left time: 235.8725s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0529147 Vali Loss: 0.0528679 Test Loss: 0.0594729
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0548518
	speed: 0.0410s/iter; left time: 446.1536s
	iters: 200, epoch: 52 | loss: 0.0500622
	speed: 0.0215s/iter; left time: 231.1965s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0528688 Vali Loss: 0.0529081 Test Loss: 0.0595482
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0533494
	speed: 0.0410s/iter; left time: 436.8176s
	iters: 200, epoch: 53 | loss: 0.0526474
	speed: 0.0214s/iter; left time: 226.2530s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0528629 Vali Loss: 0.0528537 Test Loss: 0.0594607
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0490567
	speed: 0.0410s/iter; left time: 427.4118s
	iters: 200, epoch: 54 | loss: 0.0554540
	speed: 0.0215s/iter; left time: 221.6911s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0528439 Vali Loss: 0.0528962 Test Loss: 0.0594534
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0542135
	speed: 0.0409s/iter; left time: 417.3109s
	iters: 200, epoch: 55 | loss: 0.0503127
	speed: 0.0214s/iter; left time: 216.6996s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0528382 Vali Loss: 0.0529034 Test Loss: 0.0594242
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009812770411372185, rmse:0.09905942529439926, mae:0.0594572052359581, rse:0.2915199100971222
Intermediate time for ES and pred_len 24: 00h:11m:48.08s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1332297
	speed: 0.0417s/iter; left time: 930.1454s
	iters: 200, epoch: 1 | loss: 0.1161591
	speed: 0.0217s/iter; left time: 481.6512s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.1391611 Vali Loss: 0.1071773 Test Loss: 0.1206285
Validation loss decreased (inf --> 0.107177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0941705
	speed: 0.0435s/iter; left time: 959.3545s
	iters: 200, epoch: 2 | loss: 0.0863278
	speed: 0.0217s/iter; left time: 476.7819s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0945481 Vali Loss: 0.0842169 Test Loss: 0.0952008
Validation loss decreased (0.107177 --> 0.084217).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0853028
	speed: 0.0435s/iter; left time: 949.6591s
	iters: 200, epoch: 3 | loss: 0.0818383
	speed: 0.0217s/iter; left time: 471.7924s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0852690 Vali Loss: 0.0808030 Test Loss: 0.0915490
Validation loss decreased (0.084217 --> 0.080803).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0816073
	speed: 0.0435s/iter; left time: 941.9031s
	iters: 200, epoch: 4 | loss: 0.0809784
	speed: 0.0216s/iter; left time: 465.8425s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0822740 Vali Loss: 0.0797453 Test Loss: 0.0898073
Validation loss decreased (0.080803 --> 0.079745).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0792374
	speed: 0.0441s/iter; left time: 944.8809s
	iters: 200, epoch: 5 | loss: 0.0757089
	speed: 0.0217s/iter; left time: 461.5888s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0803611 Vali Loss: 0.0778018 Test Loss: 0.0881068
Validation loss decreased (0.079745 --> 0.077802).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0795092
	speed: 0.0436s/iter; left time: 924.4390s
	iters: 200, epoch: 6 | loss: 0.0789749
	speed: 0.0217s/iter; left time: 457.2166s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0788301 Vali Loss: 0.0771582 Test Loss: 0.0877509
Validation loss decreased (0.077802 --> 0.077158).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0790475
	speed: 0.0460s/iter; left time: 964.5120s
	iters: 200, epoch: 7 | loss: 0.0745670
	speed: 0.0220s/iter; left time: 459.0860s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0777580 Vali Loss: 0.0771757 Test Loss: 0.0872566
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0777936
	speed: 0.0441s/iter; left time: 913.3973s
	iters: 200, epoch: 8 | loss: 0.0750555
	speed: 0.0217s/iter; left time: 447.6335s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0770578 Vali Loss: 0.0767780 Test Loss: 0.0872838
Validation loss decreased (0.077158 --> 0.076778).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0780691
	speed: 0.0451s/iter; left time: 924.7646s
	iters: 200, epoch: 9 | loss: 0.0749124
	speed: 0.0217s/iter; left time: 441.9864s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0764970 Vali Loss: 0.0762103 Test Loss: 0.0868660
Validation loss decreased (0.076778 --> 0.076210).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0785373
	speed: 0.0436s/iter; left time: 883.4298s
	iters: 200, epoch: 10 | loss: 0.0794437
	speed: 0.0217s/iter; left time: 437.1872s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0760310 Vali Loss: 0.0769392 Test Loss: 0.0869758
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0762078
	speed: 0.0428s/iter; left time: 859.6081s
	iters: 200, epoch: 11 | loss: 0.0778385
	speed: 0.0216s/iter; left time: 432.1209s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0756567 Vali Loss: 0.0762321 Test Loss: 0.0867211
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0756245
	speed: 0.0442s/iter; left time: 876.4685s
	iters: 200, epoch: 12 | loss: 0.0754605
	speed: 0.0221s/iter; left time: 435.4239s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0753354 Vali Loss: 0.0762274 Test Loss: 0.0863326
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0720821
	speed: 0.0442s/iter; left time: 867.0172s
	iters: 200, epoch: 13 | loss: 0.0751733
	speed: 0.0220s/iter; left time: 429.5314s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0749704 Vali Loss: 0.0764599 Test Loss: 0.0865470
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0714084
	speed: 0.0442s/iter; left time: 857.2234s
	iters: 200, epoch: 14 | loss: 0.0755144
	speed: 0.0221s/iter; left time: 425.5546s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0747233 Vali Loss: 0.0763372 Test Loss: 0.0863980
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0716580
	speed: 0.0439s/iter; left time: 841.8246s
	iters: 200, epoch: 15 | loss: 0.0775909
	speed: 0.0222s/iter; left time: 422.4600s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0744484 Vali Loss: 0.0765933 Test Loss: 0.0861666
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0736896
	speed: 0.0439s/iter; left time: 832.1675s
	iters: 200, epoch: 16 | loss: 0.0758602
	speed: 0.0220s/iter; left time: 415.1615s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0742457 Vali Loss: 0.0764040 Test Loss: 0.0862437
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0725069
	speed: 0.0442s/iter; left time: 827.3303s
	iters: 200, epoch: 17 | loss: 0.0767296
	speed: 0.0219s/iter; left time: 406.9407s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0740250 Vali Loss: 0.0760664 Test Loss: 0.0861376
Validation loss decreased (0.076210 --> 0.076066).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0756056
	speed: 0.0444s/iter; left time: 821.8125s
	iters: 200, epoch: 18 | loss: 0.0748916
	speed: 0.0221s/iter; left time: 406.4201s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0738281 Vali Loss: 0.0759807 Test Loss: 0.0860244
Validation loss decreased (0.076066 --> 0.075981).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0731047
	speed: 0.0447s/iter; left time: 816.4096s
	iters: 200, epoch: 19 | loss: 0.0784042
	speed: 0.0216s/iter; left time: 392.8607s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0736200 Vali Loss: 0.0764765 Test Loss: 0.0861464
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0727690
	speed: 0.0444s/iter; left time: 801.0104s
	iters: 200, epoch: 20 | loss: 0.0742854
	speed: 0.0220s/iter; left time: 394.4140s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0734715 Vali Loss: 0.0762892 Test Loss: 0.0858324
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0738453
	speed: 0.0442s/iter; left time: 786.9141s
	iters: 200, epoch: 21 | loss: 0.0691860
	speed: 0.0220s/iter; left time: 389.0158s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0733689 Vali Loss: 0.0761795 Test Loss: 0.0859565
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0759191
	speed: 0.0436s/iter; left time: 767.1634s
	iters: 200, epoch: 22 | loss: 0.0734370
	speed: 0.0216s/iter; left time: 378.2755s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0732245 Vali Loss: 0.0762098 Test Loss: 0.0859345
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0716394
	speed: 0.0438s/iter; left time: 761.2500s
	iters: 200, epoch: 23 | loss: 0.0756265
	speed: 0.0220s/iter; left time: 380.0267s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0731301 Vali Loss: 0.0761251 Test Loss: 0.0857689
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0742317
	speed: 0.0442s/iter; left time: 757.6276s
	iters: 200, epoch: 24 | loss: 0.0704160
	speed: 0.0220s/iter; left time: 374.7274s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0730227 Vali Loss: 0.0763680 Test Loss: 0.0857616
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0700089
	speed: 0.0437s/iter; left time: 739.1891s
	iters: 200, epoch: 25 | loss: 0.0757303
	speed: 0.0221s/iter; left time: 372.4202s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0729131 Vali Loss: 0.0763017 Test Loss: 0.0859688
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0696479
	speed: 0.0443s/iter; left time: 740.0703s
	iters: 200, epoch: 26 | loss: 0.0717671
	speed: 0.0220s/iter; left time: 365.9918s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0728213 Vali Loss: 0.0761310 Test Loss: 0.0858499
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0723027
	speed: 0.0443s/iter; left time: 729.3346s
	iters: 200, epoch: 27 | loss: 0.0721262
	speed: 0.0220s/iter; left time: 360.5154s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0727642 Vali Loss: 0.0762699 Test Loss: 0.0858156
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0749497
	speed: 0.0437s/iter; left time: 710.9215s
	iters: 200, epoch: 28 | loss: 0.0732277
	speed: 0.0222s/iter; left time: 358.9055s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0727659 Vali Loss: 0.0766016 Test Loss: 0.0858246
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018519887700676918, rmse:0.1360877901315689, mae:0.08602438867092133, rse:0.39978498220443726
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1364289
	speed: 0.0239s/iter; left time: 533.9565s
	iters: 200, epoch: 1 | loss: 0.1157521
	speed: 0.0220s/iter; left time: 488.9055s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.1400037 Vali Loss: 0.1071459 Test Loss: 0.1205795
Validation loss decreased (inf --> 0.107146).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0934064
	speed: 0.0444s/iter; left time: 979.6636s
	iters: 200, epoch: 2 | loss: 0.0874522
	speed: 0.0222s/iter; left time: 487.3257s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0941851 Vali Loss: 0.0842902 Test Loss: 0.0953378
Validation loss decreased (0.107146 --> 0.084290).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0808377
	speed: 0.0458s/iter; left time: 1000.3210s
	iters: 200, epoch: 3 | loss: 0.0814818
	speed: 0.0220s/iter; left time: 479.0067s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0852042 Vali Loss: 0.0804398 Test Loss: 0.0912278
Validation loss decreased (0.084290 --> 0.080440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0785727
	speed: 0.0444s/iter; left time: 959.2951s
	iters: 200, epoch: 4 | loss: 0.0764470
	speed: 0.0220s/iter; left time: 472.6305s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0821069 Vali Loss: 0.0790448 Test Loss: 0.0897176
Validation loss decreased (0.080440 --> 0.079045).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0797067
	speed: 0.0443s/iter; left time: 948.8321s
	iters: 200, epoch: 5 | loss: 0.0774974
	speed: 0.0221s/iter; left time: 470.0037s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0802850 Vali Loss: 0.0777845 Test Loss: 0.0883287
Validation loss decreased (0.079045 --> 0.077784).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0815331
	speed: 0.0448s/iter; left time: 947.8551s
	iters: 200, epoch: 6 | loss: 0.0785194
	speed: 0.0217s/iter; left time: 456.8133s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0790606 Vali Loss: 0.0768606 Test Loss: 0.0875707
Validation loss decreased (0.077784 --> 0.076861).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0752414
	speed: 0.0441s/iter; left time: 924.7015s
	iters: 200, epoch: 7 | loss: 0.0835284
	speed: 0.0220s/iter; left time: 459.0263s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0780382 Vali Loss: 0.0763432 Test Loss: 0.0872044
Validation loss decreased (0.076861 --> 0.076343).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0805481
	speed: 0.0446s/iter; left time: 924.5303s
	iters: 200, epoch: 8 | loss: 0.0737994
	speed: 0.0220s/iter; left time: 454.0217s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0772798 Vali Loss: 0.0775445 Test Loss: 0.0873029
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0717554
	speed: 0.0440s/iter; left time: 901.7004s
	iters: 200, epoch: 9 | loss: 0.0795396
	speed: 0.0220s/iter; left time: 449.9882s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0766658 Vali Loss: 0.0762876 Test Loss: 0.0868978
Validation loss decreased (0.076343 --> 0.076288).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0765349
	speed: 0.0466s/iter; left time: 946.1368s
	iters: 200, epoch: 10 | loss: 0.0771625
	speed: 0.0220s/iter; left time: 444.6658s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.18s
Steps: 224 | Train Loss: 0.0761583 Vali Loss: 0.0772299 Test Loss: 0.0867038
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0756112
	speed: 0.0443s/iter; left time: 889.2690s
	iters: 200, epoch: 11 | loss: 0.0756049
	speed: 0.0220s/iter; left time: 438.8375s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0757773 Vali Loss: 0.0769829 Test Loss: 0.0866484
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0710362
	speed: 0.0437s/iter; left time: 867.7980s
	iters: 200, epoch: 12 | loss: 0.0768368
	speed: 0.0217s/iter; left time: 428.3425s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0753701 Vali Loss: 0.0770634 Test Loss: 0.0865114
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0729874
	speed: 0.0430s/iter; left time: 843.6619s
	iters: 200, epoch: 13 | loss: 0.0761825
	speed: 0.0217s/iter; left time: 422.5762s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0751306 Vali Loss: 0.0765685 Test Loss: 0.0862346
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0740429
	speed: 0.0428s/iter; left time: 830.2993s
	iters: 200, epoch: 14 | loss: 0.0755326
	speed: 0.0220s/iter; left time: 423.7912s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0747906 Vali Loss: 0.0765621 Test Loss: 0.0862255
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0729103
	speed: 0.0441s/iter; left time: 845.9604s
	iters: 200, epoch: 15 | loss: 0.0782577
	speed: 0.0216s/iter; left time: 411.6848s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0744873 Vali Loss: 0.0768213 Test Loss: 0.0861763
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0729717
	speed: 0.0439s/iter; left time: 832.0039s
	iters: 200, epoch: 16 | loss: 0.0731197
	speed: 0.0220s/iter; left time: 414.6705s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0742818 Vali Loss: 0.0768293 Test Loss: 0.0860981
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0708489
	speed: 0.0437s/iter; left time: 817.7381s
	iters: 200, epoch: 17 | loss: 0.0760538
	speed: 0.0219s/iter; left time: 407.8905s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0741524 Vali Loss: 0.0769240 Test Loss: 0.0859786
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0739125
	speed: 0.0434s/iter; left time: 802.4670s
	iters: 200, epoch: 18 | loss: 0.0764256
	speed: 0.0218s/iter; left time: 400.7382s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0739181 Vali Loss: 0.0766715 Test Loss: 0.0856658
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0719711
	speed: 0.0437s/iter; left time: 798.6670s
	iters: 200, epoch: 19 | loss: 0.0718806
	speed: 0.0220s/iter; left time: 399.3887s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0737924 Vali Loss: 0.0768021 Test Loss: 0.0859819
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01872049644589424, rmse:0.1368228644132614, mae:0.08689781278371811, rse:0.4019443988800049
Intermediate time for ES and pred_len 96: 00h:05m:20.37s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1371511
	speed: 0.0431s/iter; left time: 957.0872s
	iters: 200, epoch: 1 | loss: 0.1227827
	speed: 0.0219s/iter; left time: 484.2198s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.1408815 Vali Loss: 0.1098873 Test Loss: 0.1227970
Validation loss decreased (inf --> 0.109887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0982690
	speed: 0.0436s/iter; left time: 957.6706s
	iters: 200, epoch: 2 | loss: 0.0899111
	speed: 0.0220s/iter; left time: 480.8654s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0986082 Vali Loss: 0.0894303 Test Loss: 0.1008918
Validation loss decreased (0.109887 --> 0.089430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0925034
	speed: 0.0459s/iter; left time: 998.0934s
	iters: 200, epoch: 3 | loss: 0.0911533
	speed: 0.0220s/iter; left time: 475.6061s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0898377 Vali Loss: 0.0864183 Test Loss: 0.0965754
Validation loss decreased (0.089430 --> 0.086418).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0891801
	speed: 0.0461s/iter; left time: 991.5692s
	iters: 200, epoch: 4 | loss: 0.0856469
	speed: 0.0219s/iter; left time: 468.8974s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0869450 Vali Loss: 0.0846574 Test Loss: 0.0945920
Validation loss decreased (0.086418 --> 0.084657).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0867344
	speed: 0.0451s/iter; left time: 961.4708s
	iters: 200, epoch: 5 | loss: 0.0823247
	speed: 0.0222s/iter; left time: 470.5653s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0850013 Vali Loss: 0.0836166 Test Loss: 0.0936938
Validation loss decreased (0.084657 --> 0.083617).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0818506
	speed: 0.0461s/iter; left time: 971.8492s
	iters: 200, epoch: 6 | loss: 0.0827280
	speed: 0.0221s/iter; left time: 463.8366s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0836792 Vali Loss: 0.0826987 Test Loss: 0.0931292
Validation loss decreased (0.083617 --> 0.082699).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0840494
	speed: 0.0443s/iter; left time: 924.1657s
	iters: 200, epoch: 7 | loss: 0.0833823
	speed: 0.0221s/iter; left time: 457.8718s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0827394 Vali Loss: 0.0826297 Test Loss: 0.0929716
Validation loss decreased (0.082699 --> 0.082630).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0779127
	speed: 0.0441s/iter; left time: 909.9998s
	iters: 200, epoch: 8 | loss: 0.0823919
	speed: 0.0221s/iter; left time: 454.6208s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0819783 Vali Loss: 0.0829825 Test Loss: 0.0930039
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0815135
	speed: 0.0439s/iter; left time: 896.0783s
	iters: 200, epoch: 9 | loss: 0.0792302
	speed: 0.0221s/iter; left time: 448.2927s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0814724 Vali Loss: 0.0823861 Test Loss: 0.0924516
Validation loss decreased (0.082630 --> 0.082386).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0806117
	speed: 0.0449s/iter; left time: 907.1549s
	iters: 200, epoch: 10 | loss: 0.0819467
	speed: 0.0221s/iter; left time: 443.2070s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0809605 Vali Loss: 0.0830070 Test Loss: 0.0925872
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0803210
	speed: 0.0443s/iter; left time: 884.0139s
	iters: 200, epoch: 11 | loss: 0.0776389
	speed: 0.0221s/iter; left time: 439.3498s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0805181 Vali Loss: 0.0824888 Test Loss: 0.0920700
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0784427
	speed: 0.0445s/iter; left time: 879.3256s
	iters: 200, epoch: 12 | loss: 0.0817352
	speed: 0.0221s/iter; left time: 433.5261s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0801262 Vali Loss: 0.0825620 Test Loss: 0.0920309
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0784058
	speed: 0.0444s/iter; left time: 866.6500s
	iters: 200, epoch: 13 | loss: 0.0791594
	speed: 0.0221s/iter; left time: 428.7736s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0797856 Vali Loss: 0.0826020 Test Loss: 0.0922435
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0787506
	speed: 0.0445s/iter; left time: 857.9827s
	iters: 200, epoch: 14 | loss: 0.0820662
	speed: 0.0220s/iter; left time: 423.0954s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0795397 Vali Loss: 0.0828208 Test Loss: 0.0920756
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0799818
	speed: 0.0444s/iter; left time: 846.2871s
	iters: 200, epoch: 15 | loss: 0.0836569
	speed: 0.0222s/iter; left time: 421.5801s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0791791 Vali Loss: 0.0830119 Test Loss: 0.0925421
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0803613
	speed: 0.0445s/iter; left time: 838.8854s
	iters: 200, epoch: 16 | loss: 0.0813428
	speed: 0.0221s/iter; left time: 414.1652s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0789562 Vali Loss: 0.0830018 Test Loss: 0.0920970
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0776634
	speed: 0.0437s/iter; left time: 814.4495s
	iters: 200, epoch: 17 | loss: 0.0778937
	speed: 0.0223s/iter; left time: 414.1436s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0787209 Vali Loss: 0.0829465 Test Loss: 0.0920361
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0758516
	speed: 0.0439s/iter; left time: 807.3381s
	iters: 200, epoch: 18 | loss: 0.0807445
	speed: 0.0221s/iter; left time: 404.5505s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0785428 Vali Loss: 0.0829375 Test Loss: 0.0922001
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0786880
	speed: 0.0433s/iter; left time: 787.0556s
	iters: 200, epoch: 19 | loss: 0.0784285
	speed: 0.0221s/iter; left time: 399.3803s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0783526 Vali Loss: 0.0831563 Test Loss: 0.0923600
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020858457311987877, rmse:0.14442457258701324, mae:0.0924515426158905, rse:0.42430639266967773
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1416378
	speed: 0.0240s/iter; left time: 533.2813s
	iters: 200, epoch: 1 | loss: 0.1206775
	speed: 0.0221s/iter; left time: 487.9725s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.1433732 Vali Loss: 0.1106227 Test Loss: 0.1235818
Validation loss decreased (inf --> 0.110623).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0965256
	speed: 0.0476s/iter; left time: 1045.4600s
	iters: 200, epoch: 2 | loss: 0.0879358
	speed: 0.0221s/iter; left time: 483.2525s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0986671 Vali Loss: 0.0892200 Test Loss: 0.1002943
Validation loss decreased (0.110623 --> 0.089220).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0900791
	speed: 0.0452s/iter; left time: 984.1647s
	iters: 200, epoch: 3 | loss: 0.0855783
	speed: 0.0222s/iter; left time: 480.0283s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0895850 Vali Loss: 0.0860697 Test Loss: 0.0960548
Validation loss decreased (0.089220 --> 0.086070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0842056
	speed: 0.0446s/iter; left time: 960.3908s
	iters: 200, epoch: 4 | loss: 0.0830727
	speed: 0.0221s/iter; left time: 474.4935s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0864703 Vali Loss: 0.0838934 Test Loss: 0.0944798
Validation loss decreased (0.086070 --> 0.083893).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0832796
	speed: 0.0447s/iter; left time: 952.0413s
	iters: 200, epoch: 5 | loss: 0.0871448
	speed: 0.0219s/iter; left time: 465.3861s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0844791 Vali Loss: 0.0831082 Test Loss: 0.0936069
Validation loss decreased (0.083893 --> 0.083108).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0846262
	speed: 0.0445s/iter; left time: 938.9771s
	iters: 200, epoch: 6 | loss: 0.0852027
	speed: 0.0221s/iter; left time: 464.2929s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0834561 Vali Loss: 0.0830709 Test Loss: 0.0935564
Validation loss decreased (0.083108 --> 0.083071).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0847440
	speed: 0.0455s/iter; left time: 949.1190s
	iters: 200, epoch: 7 | loss: 0.0831410
	speed: 0.0220s/iter; left time: 457.6692s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0826277 Vali Loss: 0.0826569 Test Loss: 0.0930395
Validation loss decreased (0.083071 --> 0.082657).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0808602
	speed: 0.0440s/iter; left time: 908.6797s
	iters: 200, epoch: 8 | loss: 0.0827895
	speed: 0.0221s/iter; left time: 453.6333s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0819853 Vali Loss: 0.0825806 Test Loss: 0.0925253
Validation loss decreased (0.082657 --> 0.082581).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0802193
	speed: 0.0442s/iter; left time: 903.1668s
	iters: 200, epoch: 9 | loss: 0.0813650
	speed: 0.0221s/iter; left time: 448.7456s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0814423 Vali Loss: 0.0826175 Test Loss: 0.0924374
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0803851
	speed: 0.0437s/iter; left time: 881.6238s
	iters: 200, epoch: 10 | loss: 0.0843623
	speed: 0.0221s/iter; left time: 444.4712s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0809958 Vali Loss: 0.0825905 Test Loss: 0.0925625
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0784597
	speed: 0.0438s/iter; left time: 874.7353s
	iters: 200, epoch: 11 | loss: 0.0814741
	speed: 0.0222s/iter; left time: 441.6201s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0805374 Vali Loss: 0.0820461 Test Loss: 0.0924563
Validation loss decreased (0.082581 --> 0.082046).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0822926
	speed: 0.0447s/iter; left time: 883.5980s
	iters: 200, epoch: 12 | loss: 0.0823805
	speed: 0.0219s/iter; left time: 429.7727s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0801536 Vali Loss: 0.0823830 Test Loss: 0.0922299
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0833190
	speed: 0.0434s/iter; left time: 847.9632s
	iters: 200, epoch: 13 | loss: 0.0803181
	speed: 0.0221s/iter; left time: 429.7390s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0798562 Vali Loss: 0.0828258 Test Loss: 0.0923265
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0816601
	speed: 0.0444s/iter; left time: 857.0395s
	iters: 200, epoch: 14 | loss: 0.0748084
	speed: 0.0221s/iter; left time: 425.1065s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0794810 Vali Loss: 0.0823014 Test Loss: 0.0921245
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0809139
	speed: 0.0435s/iter; left time: 830.8637s
	iters: 200, epoch: 15 | loss: 0.0805807
	speed: 0.0218s/iter; left time: 414.6326s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0792117 Vali Loss: 0.0821576 Test Loss: 0.0920450
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0775555
	speed: 0.0438s/iter; left time: 825.4251s
	iters: 200, epoch: 16 | loss: 0.0795938
	speed: 0.0218s/iter; left time: 409.1957s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0789975 Vali Loss: 0.0824763 Test Loss: 0.0922513
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0802612
	speed: 0.0435s/iter; left time: 810.9450s
	iters: 200, epoch: 17 | loss: 0.0768068
	speed: 0.0219s/iter; left time: 405.3431s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0787426 Vali Loss: 0.0821692 Test Loss: 0.0918640
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0813671
	speed: 0.0435s/iter; left time: 799.9900s
	iters: 200, epoch: 18 | loss: 0.0809227
	speed: 0.0224s/iter; left time: 410.9748s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0786182 Vali Loss: 0.0820150 Test Loss: 0.0919387
Validation loss decreased (0.082046 --> 0.082015).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0761748
	speed: 0.0454s/iter; left time: 826.1178s
	iters: 200, epoch: 19 | loss: 0.0772933
	speed: 0.0218s/iter; left time: 394.1588s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0783593 Vali Loss: 0.0820760 Test Loss: 0.0920268
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0808013
	speed: 0.0443s/iter; left time: 795.3875s
	iters: 200, epoch: 20 | loss: 0.0756472
	speed: 0.0222s/iter; left time: 397.0049s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0782636 Vali Loss: 0.0823677 Test Loss: 0.0921934
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0758733
	speed: 0.0436s/iter; left time: 772.7565s
	iters: 200, epoch: 21 | loss: 0.0818431
	speed: 0.0222s/iter; left time: 391.3264s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0780603 Vali Loss: 0.0821686 Test Loss: 0.0919804
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0801528
	speed: 0.0439s/iter; left time: 769.1960s
	iters: 200, epoch: 22 | loss: 0.0809199
	speed: 0.0221s/iter; left time: 385.2474s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0779162 Vali Loss: 0.0819730 Test Loss: 0.0918904
Validation loss decreased (0.082015 --> 0.081973).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0790167
	speed: 0.0444s/iter; left time: 768.0712s
	iters: 200, epoch: 23 | loss: 0.0766708
	speed: 0.0222s/iter; left time: 382.3631s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0778633 Vali Loss: 0.0820230 Test Loss: 0.0918854
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0778143
	speed: 0.0439s/iter; left time: 748.9760s
	iters: 200, epoch: 24 | loss: 0.0770918
	speed: 0.0221s/iter; left time: 374.4659s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0777084 Vali Loss: 0.0823111 Test Loss: 0.0919581
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0791645
	speed: 0.0433s/iter; left time: 729.8076s
	iters: 200, epoch: 25 | loss: 0.0791114
	speed: 0.0222s/iter; left time: 372.6255s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0776045 Vali Loss: 0.0821355 Test Loss: 0.0919659
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0763448
	speed: 0.0433s/iter; left time: 719.9132s
	iters: 200, epoch: 26 | loss: 0.0797044
	speed: 0.0220s/iter; left time: 363.4543s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0774850 Vali Loss: 0.0822134 Test Loss: 0.0920656
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0781592
	speed: 0.0437s/iter; left time: 716.9720s
	iters: 200, epoch: 27 | loss: 0.0789439
	speed: 0.0222s/iter; left time: 362.6885s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0774893 Vali Loss: 0.0823164 Test Loss: 0.0920151
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0792652
	speed: 0.0437s/iter; left time: 706.6205s
	iters: 200, epoch: 28 | loss: 0.0782811
	speed: 0.0221s/iter; left time: 355.4597s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0774097 Vali Loss: 0.0823641 Test Loss: 0.0919414
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0776437
	speed: 0.0438s/iter; left time: 699.1514s
	iters: 200, epoch: 29 | loss: 0.0749454
	speed: 0.0221s/iter; left time: 350.0125s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0773713 Vali Loss: 0.0820460 Test Loss: 0.0919861
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0779056
	speed: 0.0440s/iter; left time: 692.3035s
	iters: 200, epoch: 30 | loss: 0.0780373
	speed: 0.0223s/iter; left time: 347.9065s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0773109 Vali Loss: 0.0820088 Test Loss: 0.0918328
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0740423
	speed: 0.0436s/iter; left time: 676.0932s
	iters: 200, epoch: 31 | loss: 0.0736742
	speed: 0.0219s/iter; left time: 338.0665s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0772445 Vali Loss: 0.0823042 Test Loss: 0.0919686
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0764585
	speed: 0.0434s/iter; left time: 662.7398s
	iters: 200, epoch: 32 | loss: 0.0738416
	speed: 0.0220s/iter; left time: 333.6083s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0771388 Vali Loss: 0.0822374 Test Loss: 0.0918902
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020912274718284607, rmse:0.14461076259613037, mae:0.09189040958881378, rse:0.4248534142971039
Intermediate time for ES and pred_len 168: 00h:05m:49.05s
Intermediate time for ES: 00h:22m:57.49s

=== Starting experiments for country: FR ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0922521
	speed: 0.0425s/iter; left time: 947.8985s
	iters: 200, epoch: 1 | loss: 0.0812449
	speed: 0.0215s/iter; left time: 476.5259s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.27s
Steps: 224 | Train Loss: 0.0996994 Vali Loss: 0.0825629 Test Loss: 0.0893525
Validation loss decreased (inf --> 0.082563).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0520459
	speed: 0.0423s/iter; left time: 933.5048s
	iters: 200, epoch: 2 | loss: 0.0500034
	speed: 0.0215s/iter; left time: 472.2770s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0567640 Vali Loss: 0.0583316 Test Loss: 0.0614145
Validation loss decreased (0.082563 --> 0.058332).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0495024
	speed: 0.0437s/iter; left time: 955.2372s
	iters: 200, epoch: 3 | loss: 0.0475531
	speed: 0.0215s/iter; left time: 467.4622s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0492882 Vali Loss: 0.0560770 Test Loss: 0.0598704
Validation loss decreased (0.058332 --> 0.056077).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0476345
	speed: 0.0428s/iter; left time: 926.7450s
	iters: 200, epoch: 4 | loss: 0.0488735
	speed: 0.0215s/iter; left time: 462.8029s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0474713 Vali Loss: 0.0546836 Test Loss: 0.0583130
Validation loss decreased (0.056077 --> 0.054684).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0449141
	speed: 0.0428s/iter; left time: 915.3990s
	iters: 200, epoch: 5 | loss: 0.0493240
	speed: 0.0215s/iter; left time: 457.4908s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0462544 Vali Loss: 0.0537629 Test Loss: 0.0576841
Validation loss decreased (0.054684 --> 0.053763).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0468459
	speed: 0.0429s/iter; left time: 909.4078s
	iters: 200, epoch: 6 | loss: 0.0431960
	speed: 0.0215s/iter; left time: 452.6527s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0453632 Vali Loss: 0.0533166 Test Loss: 0.0578590
Validation loss decreased (0.053763 --> 0.053317).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0491544
	speed: 0.0449s/iter; left time: 940.4948s
	iters: 200, epoch: 7 | loss: 0.0457480
	speed: 0.0214s/iter; left time: 447.2324s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0447199 Vali Loss: 0.0527121 Test Loss: 0.0568390
Validation loss decreased (0.053317 --> 0.052712).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0443586
	speed: 0.0419s/iter; left time: 869.0640s
	iters: 200, epoch: 8 | loss: 0.0445202
	speed: 0.0215s/iter; left time: 443.7007s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0441812 Vali Loss: 0.0527890 Test Loss: 0.0566774
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0408554
	speed: 0.0425s/iter; left time: 872.2932s
	iters: 200, epoch: 9 | loss: 0.0461555
	speed: 0.0215s/iter; left time: 438.3208s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0437338 Vali Loss: 0.0520447 Test Loss: 0.0563787
Validation loss decreased (0.052712 --> 0.052045).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0437757
	speed: 0.0417s/iter; left time: 846.6063s
	iters: 200, epoch: 10 | loss: 0.0445507
	speed: 0.0215s/iter; left time: 433.1371s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0433935 Vali Loss: 0.0518005 Test Loss: 0.0563349
Validation loss decreased (0.052045 --> 0.051801).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0438122
	speed: 0.0417s/iter; left time: 837.0607s
	iters: 200, epoch: 11 | loss: 0.0429363
	speed: 0.0215s/iter; left time: 428.3583s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0430161 Vali Loss: 0.0522235 Test Loss: 0.0565345
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0411467
	speed: 0.0417s/iter; left time: 826.2400s
	iters: 200, epoch: 12 | loss: 0.0405442
	speed: 0.0215s/iter; left time: 424.6075s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0428260 Vali Loss: 0.0518053 Test Loss: 0.0561477
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0412936
	speed: 0.0417s/iter; left time: 818.5467s
	iters: 200, epoch: 13 | loss: 0.0395719
	speed: 0.0215s/iter; left time: 419.5744s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0425413 Vali Loss: 0.0517742 Test Loss: 0.0559564
Validation loss decreased (0.051801 --> 0.051774).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0403675
	speed: 0.0423s/iter; left time: 820.5047s
	iters: 200, epoch: 14 | loss: 0.0414157
	speed: 0.0214s/iter; left time: 413.5845s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0424343 Vali Loss: 0.0514468 Test Loss: 0.0557802
Validation loss decreased (0.051774 --> 0.051447).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0426468
	speed: 0.0421s/iter; left time: 807.7905s
	iters: 200, epoch: 15 | loss: 0.0391918
	speed: 0.0215s/iter; left time: 409.2574s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0421790 Vali Loss: 0.0513702 Test Loss: 0.0555155
Validation loss decreased (0.051447 --> 0.051370).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0403348
	speed: 0.0428s/iter; left time: 810.4751s
	iters: 200, epoch: 16 | loss: 0.0393993
	speed: 0.0215s/iter; left time: 404.3074s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0420683 Vali Loss: 0.0514457 Test Loss: 0.0555897
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0450992
	speed: 0.0425s/iter; left time: 795.9175s
	iters: 200, epoch: 17 | loss: 0.0421486
	speed: 0.0214s/iter; left time: 398.9217s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0419303 Vali Loss: 0.0512448 Test Loss: 0.0554233
Validation loss decreased (0.051370 --> 0.051245).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0403684
	speed: 0.0429s/iter; left time: 794.1835s
	iters: 200, epoch: 18 | loss: 0.0409335
	speed: 0.0215s/iter; left time: 395.0408s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0417574 Vali Loss: 0.0510831 Test Loss: 0.0553910
Validation loss decreased (0.051245 --> 0.051083).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0401357
	speed: 0.0430s/iter; left time: 785.6362s
	iters: 200, epoch: 19 | loss: 0.0408954
	speed: 0.0215s/iter; left time: 391.0297s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0416991 Vali Loss: 0.0510762 Test Loss: 0.0553376
Validation loss decreased (0.051083 --> 0.051076).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0409482
	speed: 0.0433s/iter; left time: 781.9704s
	iters: 200, epoch: 20 | loss: 0.0409341
	speed: 0.0215s/iter; left time: 386.5835s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0416068 Vali Loss: 0.0510023 Test Loss: 0.0553288
Validation loss decreased (0.051076 --> 0.051002).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0404203
	speed: 0.0427s/iter; left time: 761.7496s
	iters: 200, epoch: 21 | loss: 0.0410889
	speed: 0.0215s/iter; left time: 381.5824s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0415698 Vali Loss: 0.0508564 Test Loss: 0.0550962
Validation loss decreased (0.051002 --> 0.050856).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0403117
	speed: 0.0424s/iter; left time: 746.4463s
	iters: 200, epoch: 22 | loss: 0.0373952
	speed: 0.0215s/iter; left time: 376.8222s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0414609 Vali Loss: 0.0509924 Test Loss: 0.0551219
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0411772
	speed: 0.0429s/iter; left time: 744.8622s
	iters: 200, epoch: 23 | loss: 0.0424629
	speed: 0.0216s/iter; left time: 372.4648s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0414060 Vali Loss: 0.0508895 Test Loss: 0.0551569
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0405278
	speed: 0.0424s/iter; left time: 727.3471s
	iters: 200, epoch: 24 | loss: 0.0411978
	speed: 0.0215s/iter; left time: 367.0061s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0412959 Vali Loss: 0.0509129 Test Loss: 0.0550991
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0425501
	speed: 0.0426s/iter; left time: 721.2167s
	iters: 200, epoch: 25 | loss: 0.0411540
	speed: 0.0216s/iter; left time: 362.9162s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0412592 Vali Loss: 0.0508587 Test Loss: 0.0550704
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0394458
	speed: 0.0423s/iter; left time: 706.3543s
	iters: 200, epoch: 26 | loss: 0.0386719
	speed: 0.0216s/iter; left time: 357.8155s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0412041 Vali Loss: 0.0508418 Test Loss: 0.0550752
Validation loss decreased (0.050856 --> 0.050842).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0422570
	speed: 0.0426s/iter; left time: 701.2355s
	iters: 200, epoch: 27 | loss: 0.0422133
	speed: 0.0216s/iter; left time: 353.6023s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0411766 Vali Loss: 0.0507948 Test Loss: 0.0549831
Validation loss decreased (0.050842 --> 0.050795).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0433984
	speed: 0.0430s/iter; left time: 699.3788s
	iters: 200, epoch: 28 | loss: 0.0385938
	speed: 0.0215s/iter; left time: 347.6195s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0411127 Vali Loss: 0.0508499 Test Loss: 0.0549632
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0416224
	speed: 0.0421s/iter; left time: 674.7613s
	iters: 200, epoch: 29 | loss: 0.0386376
	speed: 0.0215s/iter; left time: 342.5243s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0410932 Vali Loss: 0.0508310 Test Loss: 0.0549747
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0433105
	speed: 0.0421s/iter; left time: 665.7271s
	iters: 200, epoch: 30 | loss: 0.0391017
	speed: 0.0215s/iter; left time: 338.0739s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0410636 Vali Loss: 0.0507713 Test Loss: 0.0549669
Validation loss decreased (0.050795 --> 0.050771).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0414751
	speed: 0.0430s/iter; left time: 670.4624s
	iters: 200, epoch: 31 | loss: 0.0422406
	speed: 0.0215s/iter; left time: 332.7900s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0410644 Vali Loss: 0.0506221 Test Loss: 0.0549534
Validation loss decreased (0.050771 --> 0.050622).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0418209
	speed: 0.0424s/iter; left time: 651.7325s
	iters: 200, epoch: 32 | loss: 0.0422630
	speed: 0.0215s/iter; left time: 327.3840s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0410220 Vali Loss: 0.0507005 Test Loss: 0.0549489
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0426691
	speed: 0.0424s/iter; left time: 641.4093s
	iters: 200, epoch: 33 | loss: 0.0416015
	speed: 0.0215s/iter; left time: 323.0782s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0409873 Vali Loss: 0.0507150 Test Loss: 0.0549289
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0416027
	speed: 0.0418s/iter; left time: 622.5068s
	iters: 200, epoch: 34 | loss: 0.0409058
	speed: 0.0216s/iter; left time: 319.4551s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0409342 Vali Loss: 0.0506125 Test Loss: 0.0549289
Validation loss decreased (0.050622 --> 0.050613).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0403508
	speed: 0.0426s/iter; left time: 625.2090s
	iters: 200, epoch: 35 | loss: 0.0405536
	speed: 0.0215s/iter; left time: 313.8623s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0408995 Vali Loss: 0.0507281 Test Loss: 0.0549348
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0392013
	speed: 0.0421s/iter; left time: 609.1346s
	iters: 200, epoch: 36 | loss: 0.0411728
	speed: 0.0215s/iter; left time: 308.4275s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0408982 Vali Loss: 0.0506589 Test Loss: 0.0548898
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0416915
	speed: 0.0423s/iter; left time: 601.5837s
	iters: 200, epoch: 37 | loss: 0.0390842
	speed: 0.0215s/iter; left time: 304.4565s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0408846 Vali Loss: 0.0507030 Test Loss: 0.0549103
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0409159
	speed: 0.0423s/iter; left time: 593.3613s
	iters: 200, epoch: 38 | loss: 0.0409505
	speed: 0.0215s/iter; left time: 299.5674s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0409132 Vali Loss: 0.0506096 Test Loss: 0.0548936
Validation loss decreased (0.050613 --> 0.050610).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0411741
	speed: 0.0427s/iter; left time: 588.1627s
	iters: 200, epoch: 39 | loss: 0.0376427
	speed: 0.0215s/iter; left time: 294.4152s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0409005 Vali Loss: 0.0506769 Test Loss: 0.0549118
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0395384
	speed: 0.0424s/iter; left time: 574.6687s
	iters: 200, epoch: 40 | loss: 0.0426256
	speed: 0.0215s/iter; left time: 289.2541s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0409154 Vali Loss: 0.0506234 Test Loss: 0.0548656
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0414726
	speed: 0.0421s/iter; left time: 562.0373s
	iters: 200, epoch: 41 | loss: 0.0398386
	speed: 0.0215s/iter; left time: 285.0984s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0408911 Vali Loss: 0.0507312 Test Loss: 0.0548805
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0405780
	speed: 0.0422s/iter; left time: 553.3428s
	iters: 200, epoch: 42 | loss: 0.0422252
	speed: 0.0215s/iter; left time: 280.1046s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0408209 Vali Loss: 0.0506364 Test Loss: 0.0548718
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0415202
	speed: 0.0419s/iter; left time: 539.9324s
	iters: 200, epoch: 43 | loss: 0.0395535
	speed: 0.0215s/iter; left time: 275.3785s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0408415 Vali Loss: 0.0506668 Test Loss: 0.0549047
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0404969
	speed: 0.0420s/iter; left time: 532.7165s
	iters: 200, epoch: 44 | loss: 0.0420321
	speed: 0.0215s/iter; left time: 270.7686s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0407556 Vali Loss: 0.0506703 Test Loss: 0.0548576
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0391747
	speed: 0.0419s/iter; left time: 521.5592s
	iters: 200, epoch: 45 | loss: 0.0422009
	speed: 0.0217s/iter; left time: 267.6746s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0408116 Vali Loss: 0.0506479 Test Loss: 0.0548571
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0392307
	speed: 0.0425s/iter; left time: 519.7234s
	iters: 200, epoch: 46 | loss: 0.0397813
	speed: 0.0216s/iter; left time: 261.3716s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0408009 Vali Loss: 0.0506997 Test Loss: 0.0548701
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0399628
	speed: 0.0427s/iter; left time: 511.7138s
	iters: 200, epoch: 47 | loss: 0.0388421
	speed: 0.0216s/iter; left time: 256.4808s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0408245 Vali Loss: 0.0506524 Test Loss: 0.0548776
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0390960
	speed: 0.0423s/iter; left time: 498.5000s
	iters: 200, epoch: 48 | loss: 0.0420657
	speed: 0.0215s/iter; left time: 250.7819s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0407882 Vali Loss: 0.0506609 Test Loss: 0.0548543
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010016716085374355, rmse:0.10008354485034943, mae:0.054893556982278824, rse:0.3861195147037506
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0940180
	speed: 0.0231s/iter; left time: 515.0449s
	iters: 200, epoch: 1 | loss: 0.0811646
	speed: 0.0226s/iter; left time: 502.8198s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0985810 Vali Loss: 0.0815797 Test Loss: 0.0878834
Validation loss decreased (inf --> 0.081580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0547407
	speed: 0.0418s/iter; left time: 923.6693s
	iters: 200, epoch: 2 | loss: 0.0527672
	speed: 0.0214s/iter; left time: 471.2093s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0564906 Vali Loss: 0.0584410 Test Loss: 0.0619229
Validation loss decreased (0.081580 --> 0.058441).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0509167
	speed: 0.0423s/iter; left time: 923.3342s
	iters: 200, epoch: 3 | loss: 0.0542123
	speed: 0.0216s/iter; left time: 469.8124s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0495092 Vali Loss: 0.0563004 Test Loss: 0.0599003
Validation loss decreased (0.058441 --> 0.056300).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0503906
	speed: 0.0417s/iter; left time: 902.1710s
	iters: 200, epoch: 4 | loss: 0.0471535
	speed: 0.0215s/iter; left time: 462.6715s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0475974 Vali Loss: 0.0549461 Test Loss: 0.0588412
Validation loss decreased (0.056300 --> 0.054946).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0476107
	speed: 0.0422s/iter; left time: 904.3479s
	iters: 200, epoch: 5 | loss: 0.0449724
	speed: 0.0215s/iter; left time: 457.5166s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0462843 Vali Loss: 0.0539974 Test Loss: 0.0577919
Validation loss decreased (0.054946 --> 0.053997).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0439290
	speed: 0.0416s/iter; left time: 880.4346s
	iters: 200, epoch: 6 | loss: 0.0464236
	speed: 0.0214s/iter; left time: 452.1872s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0454219 Vali Loss: 0.0535343 Test Loss: 0.0576241
Validation loss decreased (0.053997 --> 0.053534).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0494572
	speed: 0.0415s/iter; left time: 870.2077s
	iters: 200, epoch: 7 | loss: 0.0432118
	speed: 0.0215s/iter; left time: 447.8330s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0447667 Vali Loss: 0.0527882 Test Loss: 0.0570822
Validation loss decreased (0.053534 --> 0.052788).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0438109
	speed: 0.0419s/iter; left time: 868.5354s
	iters: 200, epoch: 8 | loss: 0.0465241
	speed: 0.0215s/iter; left time: 443.4673s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0442507 Vali Loss: 0.0526180 Test Loss: 0.0566874
Validation loss decreased (0.052788 --> 0.052618).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0438274
	speed: 0.0417s/iter; left time: 855.1131s
	iters: 200, epoch: 9 | loss: 0.0437961
	speed: 0.0214s/iter; left time: 437.4264s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0438381 Vali Loss: 0.0523469 Test Loss: 0.0564449
Validation loss decreased (0.052618 --> 0.052347).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0446142
	speed: 0.0419s/iter; left time: 849.1826s
	iters: 200, epoch: 10 | loss: 0.0449577
	speed: 0.0215s/iter; left time: 433.1350s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0435067 Vali Loss: 0.0523818 Test Loss: 0.0562804
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0418613
	speed: 0.0417s/iter; left time: 837.2890s
	iters: 200, epoch: 11 | loss: 0.0410403
	speed: 0.0214s/iter; left time: 428.1490s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0431693 Vali Loss: 0.0520130 Test Loss: 0.0562456
Validation loss decreased (0.052347 --> 0.052013).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0410794
	speed: 0.0424s/iter; left time: 840.4497s
	iters: 200, epoch: 12 | loss: 0.0447178
	speed: 0.0217s/iter; left time: 428.7528s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0429229 Vali Loss: 0.0518238 Test Loss: 0.0557078
Validation loss decreased (0.052013 --> 0.051824).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0441225
	speed: 0.0422s/iter; left time: 828.1300s
	iters: 200, epoch: 13 | loss: 0.0456641
	speed: 0.0215s/iter; left time: 420.0370s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0426047 Vali Loss: 0.0517077 Test Loss: 0.0557766
Validation loss decreased (0.051824 --> 0.051708).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0459377
	speed: 0.0423s/iter; left time: 819.4231s
	iters: 200, epoch: 14 | loss: 0.0429569
	speed: 0.0215s/iter; left time: 413.7814s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0424634 Vali Loss: 0.0515609 Test Loss: 0.0555726
Validation loss decreased (0.051708 --> 0.051561).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0418947
	speed: 0.0423s/iter; left time: 810.7354s
	iters: 200, epoch: 15 | loss: 0.0403961
	speed: 0.0215s/iter; left time: 410.1931s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0422723 Vali Loss: 0.0516485 Test Loss: 0.0555203
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0437004
	speed: 0.0418s/iter; left time: 792.5764s
	iters: 200, epoch: 16 | loss: 0.0413640
	speed: 0.0215s/iter; left time: 405.2794s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0421250 Vali Loss: 0.0515568 Test Loss: 0.0554397
Validation loss decreased (0.051561 --> 0.051557).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0406406
	speed: 0.0418s/iter; left time: 782.4832s
	iters: 200, epoch: 17 | loss: 0.0441466
	speed: 0.0215s/iter; left time: 400.0906s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0420131 Vali Loss: 0.0512235 Test Loss: 0.0554602
Validation loss decreased (0.051557 --> 0.051224).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0433222
	speed: 0.0416s/iter; left time: 769.9233s
	iters: 200, epoch: 18 | loss: 0.0430924
	speed: 0.0214s/iter; left time: 394.3941s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0418719 Vali Loss: 0.0512055 Test Loss: 0.0552408
Validation loss decreased (0.051224 --> 0.051205).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0426369
	speed: 0.0416s/iter; left time: 760.6100s
	iters: 200, epoch: 19 | loss: 0.0433245
	speed: 0.0218s/iter; left time: 396.1219s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0417454 Vali Loss: 0.0513827 Test Loss: 0.0552300
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0394716
	speed: 0.0410s/iter; left time: 740.5760s
	iters: 200, epoch: 20 | loss: 0.0419463
	speed: 0.0215s/iter; left time: 385.3625s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0416507 Vali Loss: 0.0510610 Test Loss: 0.0551008
Validation loss decreased (0.051205 --> 0.051061).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0443189
	speed: 0.0418s/iter; left time: 744.1442s
	iters: 200, epoch: 21 | loss: 0.0422500
	speed: 0.0215s/iter; left time: 381.1960s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0415985 Vali Loss: 0.0510450 Test Loss: 0.0550852
Validation loss decreased (0.051061 --> 0.051045).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0415483
	speed: 0.0424s/iter; left time: 746.0996s
	iters: 200, epoch: 22 | loss: 0.0417514
	speed: 0.0215s/iter; left time: 376.6143s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0414773 Vali Loss: 0.0510601 Test Loss: 0.0551181
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0409127
	speed: 0.0417s/iter; left time: 723.8984s
	iters: 200, epoch: 23 | loss: 0.0378122
	speed: 0.0215s/iter; left time: 372.0310s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0414204 Vali Loss: 0.0511174 Test Loss: 0.0549930
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0404224
	speed: 0.0419s/iter; left time: 718.4501s
	iters: 200, epoch: 24 | loss: 0.0383398
	speed: 0.0215s/iter; left time: 366.5949s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0413695 Vali Loss: 0.0510455 Test Loss: 0.0550411
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0420883
	speed: 0.0420s/iter; left time: 711.4346s
	iters: 200, epoch: 25 | loss: 0.0421899
	speed: 0.0215s/iter; left time: 361.5762s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0413075 Vali Loss: 0.0509951 Test Loss: 0.0549542
Validation loss decreased (0.051045 --> 0.050995).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0420696
	speed: 0.0420s/iter; left time: 700.7044s
	iters: 200, epoch: 26 | loss: 0.0436400
	speed: 0.0215s/iter; left time: 357.0766s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0412557 Vali Loss: 0.0510270 Test Loss: 0.0549796
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0397224
	speed: 0.0415s/iter; left time: 683.3222s
	iters: 200, epoch: 27 | loss: 0.0414697
	speed: 0.0215s/iter; left time: 352.2999s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0411798 Vali Loss: 0.0510181 Test Loss: 0.0549279
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0402837
	speed: 0.0416s/iter; left time: 676.6137s
	iters: 200, epoch: 28 | loss: 0.0395990
	speed: 0.0217s/iter; left time: 350.0390s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0411676 Vali Loss: 0.0508765 Test Loss: 0.0548455
Validation loss decreased (0.050995 --> 0.050877).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0431604
	speed: 0.0423s/iter; left time: 678.0381s
	iters: 200, epoch: 29 | loss: 0.0448217
	speed: 0.0215s/iter; left time: 342.5062s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0411104 Vali Loss: 0.0509340 Test Loss: 0.0548963
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0396297
	speed: 0.0419s/iter; left time: 662.2532s
	iters: 200, epoch: 30 | loss: 0.0401898
	speed: 0.0215s/iter; left time: 338.2775s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0410535 Vali Loss: 0.0508783 Test Loss: 0.0548398
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0424194
	speed: 0.0419s/iter; left time: 652.6878s
	iters: 200, epoch: 31 | loss: 0.0421256
	speed: 0.0215s/iter; left time: 333.3608s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0410388 Vali Loss: 0.0509510 Test Loss: 0.0549230
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0403462
	speed: 0.0419s/iter; left time: 643.4572s
	iters: 200, epoch: 32 | loss: 0.0405740
	speed: 0.0215s/iter; left time: 328.1391s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0410345 Vali Loss: 0.0509338 Test Loss: 0.0548709
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0424508
	speed: 0.0412s/iter; left time: 623.5558s
	iters: 200, epoch: 33 | loss: 0.0424387
	speed: 0.0215s/iter; left time: 322.5280s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0410337 Vali Loss: 0.0508014 Test Loss: 0.0548693
Validation loss decreased (0.050877 --> 0.050801).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0425914
	speed: 0.0418s/iter; left time: 622.6931s
	iters: 200, epoch: 34 | loss: 0.0439500
	speed: 0.0215s/iter; left time: 318.5976s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0409841 Vali Loss: 0.0508157 Test Loss: 0.0548066
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0389932
	speed: 0.0415s/iter; left time: 609.1774s
	iters: 200, epoch: 35 | loss: 0.0397014
	speed: 0.0214s/iter; left time: 312.7479s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0410068 Vali Loss: 0.0508392 Test Loss: 0.0548442
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0464640
	speed: 0.0411s/iter; left time: 594.7469s
	iters: 200, epoch: 36 | loss: 0.0403094
	speed: 0.0214s/iter; left time: 307.7822s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0409958 Vali Loss: 0.0508789 Test Loss: 0.0548256
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0416844
	speed: 0.0413s/iter; left time: 588.2420s
	iters: 200, epoch: 37 | loss: 0.0424580
	speed: 0.0217s/iter; left time: 306.1681s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0409988 Vali Loss: 0.0508576 Test Loss: 0.0548103
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0412942
	speed: 0.0411s/iter; left time: 575.6771s
	iters: 200, epoch: 38 | loss: 0.0398131
	speed: 0.0215s/iter; left time: 298.6743s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.97s
Steps: 224 | Train Loss: 0.0409599 Vali Loss: 0.0508449 Test Loss: 0.0548017
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0384120
	speed: 0.0418s/iter; left time: 575.8292s
	iters: 200, epoch: 39 | loss: 0.0388602
	speed: 0.0216s/iter; left time: 295.7443s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0409116 Vali Loss: 0.0508882 Test Loss: 0.0547815
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0404700
	speed: 0.0424s/iter; left time: 575.6196s
	iters: 200, epoch: 40 | loss: 0.0422975
	speed: 0.0215s/iter; left time: 289.4939s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0409106 Vali Loss: 0.0508732 Test Loss: 0.0547946
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0435542
	speed: 0.0420s/iter; left time: 559.7524s
	iters: 200, epoch: 41 | loss: 0.0390764
	speed: 0.0215s/iter; left time: 284.8769s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0409192 Vali Loss: 0.0507594 Test Loss: 0.0547728
Validation loss decreased (0.050801 --> 0.050759).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0391905
	speed: 0.0419s/iter; left time: 549.8152s
	iters: 200, epoch: 42 | loss: 0.0429931
	speed: 0.0215s/iter; left time: 279.7507s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408616 Vali Loss: 0.0507772 Test Loss: 0.0547837
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0392766
	speed: 0.0415s/iter; left time: 535.4667s
	iters: 200, epoch: 43 | loss: 0.0411831
	speed: 0.0215s/iter; left time: 275.1775s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408704 Vali Loss: 0.0508098 Test Loss: 0.0547636
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0396020
	speed: 0.0413s/iter; left time: 523.3345s
	iters: 200, epoch: 44 | loss: 0.0393277
	speed: 0.0215s/iter; left time: 269.8332s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0408363 Vali Loss: 0.0508037 Test Loss: 0.0547695
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0387644
	speed: 0.0413s/iter; left time: 513.7123s
	iters: 200, epoch: 45 | loss: 0.0421335
	speed: 0.0215s/iter; left time: 265.0958s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0408626 Vali Loss: 0.0506989 Test Loss: 0.0547564
Validation loss decreased (0.050759 --> 0.050699).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0406405
	speed: 0.0419s/iter; left time: 512.6697s
	iters: 200, epoch: 46 | loss: 0.0428052
	speed: 0.0217s/iter; left time: 263.0141s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0408595 Vali Loss: 0.0507874 Test Loss: 0.0547676
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0410502
	speed: 0.0421s/iter; left time: 505.5465s
	iters: 200, epoch: 47 | loss: 0.0448898
	speed: 0.0214s/iter; left time: 255.0083s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408573 Vali Loss: 0.0507810 Test Loss: 0.0547585
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0398445
	speed: 0.0415s/iter; left time: 489.0927s
	iters: 200, epoch: 48 | loss: 0.0420685
	speed: 0.0216s/iter; left time: 252.1517s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0408299 Vali Loss: 0.0508557 Test Loss: 0.0547524
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0405456
	speed: 0.0420s/iter; left time: 485.2478s
	iters: 200, epoch: 49 | loss: 0.0427208
	speed: 0.0215s/iter; left time: 246.4626s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0408837 Vali Loss: 0.0507540 Test Loss: 0.0547544
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0361435
	speed: 0.0422s/iter; left time: 477.6179s
	iters: 200, epoch: 50 | loss: 0.0382484
	speed: 0.0216s/iter; left time: 242.2424s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0408478 Vali Loss: 0.0506820 Test Loss: 0.0547631
Validation loss decreased (0.050699 --> 0.050682).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0445019
	speed: 0.0425s/iter; left time: 471.6133s
	iters: 200, epoch: 51 | loss: 0.0388521
	speed: 0.0215s/iter; left time: 236.5868s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0408830 Vali Loss: 0.0507521 Test Loss: 0.0547523
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0406499
	speed: 0.0416s/iter; left time: 452.9308s
	iters: 200, epoch: 52 | loss: 0.0429437
	speed: 0.0215s/iter; left time: 231.4715s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0408319 Vali Loss: 0.0507899 Test Loss: 0.0547480
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0416919
	speed: 0.0412s/iter; left time: 438.9077s
	iters: 200, epoch: 53 | loss: 0.0413610
	speed: 0.0214s/iter; left time: 226.3599s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0408248 Vali Loss: 0.0508078 Test Loss: 0.0547522
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0437568
	speed: 0.0412s/iter; left time: 429.8241s
	iters: 200, epoch: 54 | loss: 0.0390082
	speed: 0.0216s/iter; left time: 223.0394s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0408348 Vali Loss: 0.0507491 Test Loss: 0.0547398
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0412294
	speed: 0.0414s/iter; left time: 422.3950s
	iters: 200, epoch: 55 | loss: 0.0422725
	speed: 0.0215s/iter; left time: 217.2040s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0408018 Vali Loss: 0.0506723 Test Loss: 0.0547446
Validation loss decreased (0.050682 --> 0.050672).  Saving model ...
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0357394
	speed: 0.0421s/iter; left time: 420.0608s
	iters: 200, epoch: 56 | loss: 0.0403160
	speed: 0.0215s/iter; left time: 212.8144s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0408179 Vali Loss: 0.0507600 Test Loss: 0.0547436
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0411189
	speed: 0.0426s/iter; left time: 415.9175s
	iters: 200, epoch: 57 | loss: 0.0414192
	speed: 0.0216s/iter; left time: 208.1917s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0407903 Vali Loss: 0.0507926 Test Loss: 0.0547505
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0448384
	speed: 0.0417s/iter; left time: 397.6587s
	iters: 200, epoch: 58 | loss: 0.0411332
	speed: 0.0215s/iter; left time: 202.6416s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0407991 Vali Loss: 0.0506882 Test Loss: 0.0547508
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0408990
	speed: 0.0418s/iter; left time: 388.9810s
	iters: 200, epoch: 59 | loss: 0.0420822
	speed: 0.0215s/iter; left time: 198.0568s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0407626 Vali Loss: 0.0507821 Test Loss: 0.0547550
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0430488
	speed: 0.0419s/iter; left time: 380.6301s
	iters: 200, epoch: 60 | loss: 0.0396329
	speed: 0.0215s/iter; left time: 193.1168s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0408477 Vali Loss: 0.0507961 Test Loss: 0.0547467
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0413525
	speed: 0.0415s/iter; left time: 368.0602s
	iters: 200, epoch: 61 | loss: 0.0401741
	speed: 0.0214s/iter; left time: 187.7093s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408173 Vali Loss: 0.0507987 Test Loss: 0.0547463
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0387825
	speed: 0.0415s/iter; left time: 358.2815s
	iters: 200, epoch: 62 | loss: 0.0394390
	speed: 0.0215s/iter; left time: 183.7663s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0407836 Vali Loss: 0.0507470 Test Loss: 0.0547525
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0403911
	speed: 0.0421s/iter; left time: 354.4683s
	iters: 200, epoch: 63 | loss: 0.0425924
	speed: 0.0215s/iter; left time: 178.6744s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0408110 Vali Loss: 0.0508126 Test Loss: 0.0547508
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0444756
	speed: 0.0411s/iter; left time: 336.8800s
	iters: 200, epoch: 64 | loss: 0.0423716
	speed: 0.0216s/iter; left time: 174.9172s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0407980 Vali Loss: 0.0507530 Test Loss: 0.0547486
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0426044
	speed: 0.0415s/iter; left time: 330.1787s
	iters: 200, epoch: 65 | loss: 0.0408079
	speed: 0.0215s/iter; left time: 168.9455s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0408118 Vali Loss: 0.0507080 Test Loss: 0.0547459
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009919346310198307, rmse:0.09959591180086136, mae:0.05474460497498512, rse:0.38423827290534973
Intermediate time for FR and pred_len 24: 00h:12m:08.47s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0983297
	speed: 0.0384s/iter; left time: 855.7373s
	iters: 200, epoch: 1 | loss: 0.0873794
	speed: 0.0216s/iter; left time: 480.5010s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.26s
Steps: 224 | Train Loss: 0.1030776 Vali Loss: 0.0901118 Test Loss: 0.0987749
Validation loss decreased (inf --> 0.090112).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0738971
	speed: 0.0431s/iter; left time: 951.6776s
	iters: 200, epoch: 2 | loss: 0.0630338
	speed: 0.0217s/iter; left time: 476.7463s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0707665 Vali Loss: 0.0750541 Test Loss: 0.0844004
Validation loss decreased (0.090112 --> 0.075054).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0650598
	speed: 0.0435s/iter; left time: 949.9409s
	iters: 200, epoch: 3 | loss: 0.0631248
	speed: 0.0217s/iter; left time: 471.7754s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0642128 Vali Loss: 0.0723514 Test Loss: 0.0823486
Validation loss decreased (0.075054 --> 0.072351).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0607355
	speed: 0.0440s/iter; left time: 950.7292s
	iters: 200, epoch: 4 | loss: 0.0640049
	speed: 0.0216s/iter; left time: 465.5957s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0623594 Vali Loss: 0.0713185 Test Loss: 0.0813607
Validation loss decreased (0.072351 --> 0.071319).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0619086
	speed: 0.0435s/iter; left time: 931.5489s
	iters: 200, epoch: 5 | loss: 0.0585843
	speed: 0.0220s/iter; left time: 468.9614s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0611954 Vali Loss: 0.0714547 Test Loss: 0.0812930
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0645285
	speed: 0.0431s/iter; left time: 912.7486s
	iters: 200, epoch: 6 | loss: 0.0585685
	speed: 0.0216s/iter; left time: 455.3244s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0603605 Vali Loss: 0.0708528 Test Loss: 0.0804025
Validation loss decreased (0.071319 --> 0.070853).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0626411
	speed: 0.0446s/iter; left time: 933.7562s
	iters: 200, epoch: 7 | loss: 0.0578498
	speed: 0.0217s/iter; left time: 451.5953s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0597481 Vali Loss: 0.0707155 Test Loss: 0.0805117
Validation loss decreased (0.070853 --> 0.070716).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0617545
	speed: 0.0435s/iter; left time: 901.0683s
	iters: 200, epoch: 8 | loss: 0.0570553
	speed: 0.0217s/iter; left time: 446.8854s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0593218 Vali Loss: 0.0705569 Test Loss: 0.0800213
Validation loss decreased (0.070716 --> 0.070557).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0579642
	speed: 0.0434s/iter; left time: 890.5296s
	iters: 200, epoch: 9 | loss: 0.0584911
	speed: 0.0217s/iter; left time: 442.0614s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0589101 Vali Loss: 0.0703659 Test Loss: 0.0803864
Validation loss decreased (0.070557 --> 0.070366).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0590099
	speed: 0.0434s/iter; left time: 880.5747s
	iters: 200, epoch: 10 | loss: 0.0567615
	speed: 0.0217s/iter; left time: 438.3126s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0585553 Vali Loss: 0.0703196 Test Loss: 0.0800212
Validation loss decreased (0.070366 --> 0.070320).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0599887
	speed: 0.0446s/iter; left time: 894.9401s
	iters: 200, epoch: 11 | loss: 0.0570798
	speed: 0.0217s/iter; left time: 432.5625s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0582727 Vali Loss: 0.0701688 Test Loss: 0.0800953
Validation loss decreased (0.070320 --> 0.070169).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0576352
	speed: 0.0434s/iter; left time: 861.7227s
	iters: 200, epoch: 12 | loss: 0.0568199
	speed: 0.0217s/iter; left time: 428.4385s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0579524 Vali Loss: 0.0703713 Test Loss: 0.0804924
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0579580
	speed: 0.0433s/iter; left time: 850.0240s
	iters: 200, epoch: 13 | loss: 0.0583147
	speed: 0.0218s/iter; left time: 425.3726s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0577693 Vali Loss: 0.0704499 Test Loss: 0.0805893
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0565304
	speed: 0.0428s/iter; left time: 830.3617s
	iters: 200, epoch: 14 | loss: 0.0569390
	speed: 0.0217s/iter; left time: 418.5213s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0574804 Vali Loss: 0.0702373 Test Loss: 0.0797039
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0535891
	speed: 0.0431s/iter; left time: 826.8398s
	iters: 200, epoch: 15 | loss: 0.0597033
	speed: 0.0217s/iter; left time: 414.0854s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0573015 Vali Loss: 0.0701684 Test Loss: 0.0799846
Validation loss decreased (0.070169 --> 0.070168).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0587517
	speed: 0.0440s/iter; left time: 833.5395s
	iters: 200, epoch: 16 | loss: 0.0592023
	speed: 0.0216s/iter; left time: 407.2412s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0571309 Vali Loss: 0.0702232 Test Loss: 0.0806227
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0566779
	speed: 0.0436s/iter; left time: 815.7265s
	iters: 200, epoch: 17 | loss: 0.0592846
	speed: 0.0216s/iter; left time: 402.1471s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0569611 Vali Loss: 0.0698579 Test Loss: 0.0801451
Validation loss decreased (0.070168 --> 0.069858).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0570536
	speed: 0.0444s/iter; left time: 821.9055s
	iters: 200, epoch: 18 | loss: 0.0556913
	speed: 0.0217s/iter; left time: 398.4210s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0567850 Vali Loss: 0.0699912 Test Loss: 0.0802466
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0593845
	speed: 0.0436s/iter; left time: 796.4150s
	iters: 200, epoch: 19 | loss: 0.0588323
	speed: 0.0217s/iter; left time: 393.5087s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0567055 Vali Loss: 0.0699999 Test Loss: 0.0801822
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0558082
	speed: 0.0427s/iter; left time: 770.2813s
	iters: 200, epoch: 20 | loss: 0.0583261
	speed: 0.0216s/iter; left time: 387.7001s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0564659 Vali Loss: 0.0700179 Test Loss: 0.0798926
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0592596
	speed: 0.0426s/iter; left time: 758.5438s
	iters: 200, epoch: 21 | loss: 0.0513039
	speed: 0.0216s/iter; left time: 383.3980s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0563980 Vali Loss: 0.0699883 Test Loss: 0.0799807
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0577759
	speed: 0.0442s/iter; left time: 778.3173s
	iters: 200, epoch: 22 | loss: 0.0578416
	speed: 0.0216s/iter; left time: 378.5637s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0562179 Vali Loss: 0.0699354 Test Loss: 0.0799568
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0544326
	speed: 0.0434s/iter; left time: 754.8422s
	iters: 200, epoch: 23 | loss: 0.0578180
	speed: 0.0217s/iter; left time: 375.3395s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0561494 Vali Loss: 0.0698742 Test Loss: 0.0802392
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0568733
	speed: 0.0430s/iter; left time: 736.5739s
	iters: 200, epoch: 24 | loss: 0.0529017
	speed: 0.0217s/iter; left time: 369.3269s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0560583 Vali Loss: 0.0699539 Test Loss: 0.0801342
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0557823
	speed: 0.0424s/iter; left time: 717.9630s
	iters: 200, epoch: 25 | loss: 0.0551363
	speed: 0.0216s/iter; left time: 363.9401s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0560021 Vali Loss: 0.0699088 Test Loss: 0.0804561
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0538700
	speed: 0.0429s/iter; left time: 716.0849s
	iters: 200, epoch: 26 | loss: 0.0609172
	speed: 0.0216s/iter; left time: 358.8777s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0559135 Vali Loss: 0.0698714 Test Loss: 0.0803807
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0539667
	speed: 0.0423s/iter; left time: 697.6702s
	iters: 200, epoch: 27 | loss: 0.0567633
	speed: 0.0216s/iter; left time: 354.4264s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0558816 Vali Loss: 0.0698992 Test Loss: 0.0803587
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018861200660467148, rmse:0.13733609020709991, mae:0.08014506101608276, rse:0.5312525033950806
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1032781
	speed: 0.0231s/iter; left time: 516.0998s
	iters: 200, epoch: 1 | loss: 0.0894776
	speed: 0.0216s/iter; left time: 479.2667s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.1047901 Vali Loss: 0.0910749 Test Loss: 0.0999701
Validation loss decreased (inf --> 0.091075).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0712828
	speed: 0.0468s/iter; left time: 1033.9531s
	iters: 200, epoch: 2 | loss: 0.0676155
	speed: 0.0217s/iter; left time: 477.3642s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0711220 Vali Loss: 0.0756139 Test Loss: 0.0835577
Validation loss decreased (0.091075 --> 0.075614).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0628007
	speed: 0.0441s/iter; left time: 963.9997s
	iters: 200, epoch: 3 | loss: 0.0555193
	speed: 0.0217s/iter; left time: 472.5423s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0647038 Vali Loss: 0.0731150 Test Loss: 0.0823915
Validation loss decreased (0.075614 --> 0.073115).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0636035
	speed: 0.0430s/iter; left time: 930.1500s
	iters: 200, epoch: 4 | loss: 0.0652026
	speed: 0.0217s/iter; left time: 467.7325s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0626577 Vali Loss: 0.0717546 Test Loss: 0.0811954
Validation loss decreased (0.073115 --> 0.071755).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0632059
	speed: 0.0425s/iter; left time: 910.4904s
	iters: 200, epoch: 5 | loss: 0.0579741
	speed: 0.0217s/iter; left time: 462.7122s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0615232 Vali Loss: 0.0715645 Test Loss: 0.0811813
Validation loss decreased (0.071755 --> 0.071564).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0582235
	speed: 0.0437s/iter; left time: 925.8519s
	iters: 200, epoch: 6 | loss: 0.0580052
	speed: 0.0217s/iter; left time: 457.0189s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0607924 Vali Loss: 0.0712702 Test Loss: 0.0806161
Validation loss decreased (0.071564 --> 0.071270).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0606383
	speed: 0.0433s/iter; left time: 908.3003s
	iters: 200, epoch: 7 | loss: 0.0575075
	speed: 0.0217s/iter; left time: 452.4672s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0601940 Vali Loss: 0.0708291 Test Loss: 0.0806453
Validation loss decreased (0.071270 --> 0.070829).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0588592
	speed: 0.0428s/iter; left time: 888.2033s
	iters: 200, epoch: 8 | loss: 0.0603692
	speed: 0.0217s/iter; left time: 448.2453s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0596949 Vali Loss: 0.0709005 Test Loss: 0.0803103
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0615383
	speed: 0.0433s/iter; left time: 887.9445s
	iters: 200, epoch: 9 | loss: 0.0605315
	speed: 0.0220s/iter; left time: 448.3224s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0592601 Vali Loss: 0.0706775 Test Loss: 0.0795777
Validation loss decreased (0.070829 --> 0.070678).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0565319
	speed: 0.0430s/iter; left time: 872.0712s
	iters: 200, epoch: 10 | loss: 0.0625511
	speed: 0.0217s/iter; left time: 438.1494s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0588624 Vali Loss: 0.0705330 Test Loss: 0.0799241
Validation loss decreased (0.070678 --> 0.070533).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0603376
	speed: 0.0435s/iter; left time: 872.4423s
	iters: 200, epoch: 11 | loss: 0.0558318
	speed: 0.0217s/iter; left time: 433.1744s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0584514 Vali Loss: 0.0705527 Test Loss: 0.0801024
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0569655
	speed: 0.0424s/iter; left time: 841.4143s
	iters: 200, epoch: 12 | loss: 0.0550287
	speed: 0.0217s/iter; left time: 427.3621s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0582022 Vali Loss: 0.0704530 Test Loss: 0.0802243
Validation loss decreased (0.070533 --> 0.070453).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0553624
	speed: 0.0430s/iter; left time: 843.6581s
	iters: 200, epoch: 13 | loss: 0.0517322
	speed: 0.0217s/iter; left time: 424.3350s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0579518 Vali Loss: 0.0704887 Test Loss: 0.0800117
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0581793
	speed: 0.0444s/iter; left time: 860.1556s
	iters: 200, epoch: 14 | loss: 0.0584791
	speed: 0.0220s/iter; left time: 424.5262s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0576507 Vali Loss: 0.0705824 Test Loss: 0.0800150
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0578372
	speed: 0.0435s/iter; left time: 832.8330s
	iters: 200, epoch: 15 | loss: 0.0582060
	speed: 0.0221s/iter; left time: 420.5084s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0574322 Vali Loss: 0.0704745 Test Loss: 0.0797117
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0524944
	speed: 0.0435s/iter; left time: 823.0660s
	iters: 200, epoch: 16 | loss: 0.0564282
	speed: 0.0221s/iter; left time: 415.9251s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0572118 Vali Loss: 0.0703373 Test Loss: 0.0801632
Validation loss decreased (0.070453 --> 0.070337).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0578217
	speed: 0.0444s/iter; left time: 831.5576s
	iters: 200, epoch: 17 | loss: 0.0534884
	speed: 0.0220s/iter; left time: 410.0354s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0569978 Vali Loss: 0.0703569 Test Loss: 0.0804921
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0571577
	speed: 0.0441s/iter; left time: 815.6317s
	iters: 200, epoch: 18 | loss: 0.0606384
	speed: 0.0220s/iter; left time: 404.6775s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0568611 Vali Loss: 0.0703310 Test Loss: 0.0799506
Validation loss decreased (0.070337 --> 0.070331).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0588245
	speed: 0.0442s/iter; left time: 808.0324s
	iters: 200, epoch: 19 | loss: 0.0577377
	speed: 0.0220s/iter; left time: 399.0943s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0567295 Vali Loss: 0.0702524 Test Loss: 0.0801056
Validation loss decreased (0.070331 --> 0.070252).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0559638
	speed: 0.0454s/iter; left time: 818.4913s
	iters: 200, epoch: 20 | loss: 0.0549757
	speed: 0.0216s/iter; left time: 388.3422s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.21s
Steps: 224 | Train Loss: 0.0566067 Vali Loss: 0.0703415 Test Loss: 0.0802463
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0549327
	speed: 0.0446s/iter; left time: 794.7913s
	iters: 200, epoch: 21 | loss: 0.0608082
	speed: 0.0216s/iter; left time: 383.6225s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0564841 Vali Loss: 0.0702290 Test Loss: 0.0805072
Validation loss decreased (0.070252 --> 0.070229).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0592940
	speed: 0.0443s/iter; left time: 779.7626s
	iters: 200, epoch: 22 | loss: 0.0558173
	speed: 0.0216s/iter; left time: 378.0718s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0563649 Vali Loss: 0.0702395 Test Loss: 0.0803802
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0558129
	speed: 0.0431s/iter; left time: 749.0281s
	iters: 200, epoch: 23 | loss: 0.0593890
	speed: 0.0215s/iter; left time: 371.1769s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0562945 Vali Loss: 0.0703073 Test Loss: 0.0803660
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0532952
	speed: 0.0431s/iter; left time: 739.8801s
	iters: 200, epoch: 24 | loss: 0.0554837
	speed: 0.0216s/iter; left time: 367.8331s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0562333 Vali Loss: 0.0703218 Test Loss: 0.0802923
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0542953
	speed: 0.0435s/iter; left time: 736.1684s
	iters: 200, epoch: 25 | loss: 0.0565853
	speed: 0.0218s/iter; left time: 367.4335s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0560876 Vali Loss: 0.0701977 Test Loss: 0.0802869
Validation loss decreased (0.070229 --> 0.070198).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0535866
	speed: 0.0444s/iter; left time: 742.1888s
	iters: 200, epoch: 26 | loss: 0.0557473
	speed: 0.0216s/iter; left time: 359.1860s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0560681 Vali Loss: 0.0702118 Test Loss: 0.0804627
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0606934
	speed: 0.0437s/iter; left time: 719.5641s
	iters: 200, epoch: 27 | loss: 0.0583474
	speed: 0.0217s/iter; left time: 354.6906s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0559604 Vali Loss: 0.0702397 Test Loss: 0.0805286
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0589630
	speed: 0.0433s/iter; left time: 703.7252s
	iters: 200, epoch: 28 | loss: 0.0527305
	speed: 0.0216s/iter; left time: 348.8420s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0559436 Vali Loss: 0.0702620 Test Loss: 0.0804100
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0570246
	speed: 0.0432s/iter; left time: 692.2432s
	iters: 200, epoch: 29 | loss: 0.0549005
	speed: 0.0215s/iter; left time: 343.1147s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0558244 Vali Loss: 0.0701727 Test Loss: 0.0805837
Validation loss decreased (0.070198 --> 0.070173).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0535036
	speed: 0.0433s/iter; left time: 685.0157s
	iters: 200, epoch: 30 | loss: 0.0551645
	speed: 0.0216s/iter; left time: 339.6563s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0558304 Vali Loss: 0.0702336 Test Loss: 0.0805002
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0563684
	speed: 0.0435s/iter; left time: 678.4751s
	iters: 200, epoch: 31 | loss: 0.0534183
	speed: 0.0216s/iter; left time: 335.0982s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0557455 Vali Loss: 0.0702535 Test Loss: 0.0807959
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0550654
	speed: 0.0432s/iter; left time: 663.7461s
	iters: 200, epoch: 32 | loss: 0.0573682
	speed: 0.0216s/iter; left time: 329.1743s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0557698 Vali Loss: 0.0701754 Test Loss: 0.0805221
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0573631
	speed: 0.0438s/iter; left time: 662.1867s
	iters: 200, epoch: 33 | loss: 0.0551623
	speed: 0.0217s/iter; left time: 325.8215s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0557085 Vali Loss: 0.0701568 Test Loss: 0.0806537
Validation loss decreased (0.070173 --> 0.070157).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0532169
	speed: 0.0440s/iter; left time: 655.7614s
	iters: 200, epoch: 34 | loss: 0.0594344
	speed: 0.0216s/iter; left time: 320.0651s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0556768 Vali Loss: 0.0701958 Test Loss: 0.0807552
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0556454
	speed: 0.0437s/iter; left time: 642.0102s
	iters: 200, epoch: 35 | loss: 0.0524563
	speed: 0.0216s/iter; left time: 315.0750s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0556534 Vali Loss: 0.0702344 Test Loss: 0.0806114
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0558845
	speed: 0.0435s/iter; left time: 628.5348s
	iters: 200, epoch: 36 | loss: 0.0558818
	speed: 0.0216s/iter; left time: 309.7534s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0556243 Vali Loss: 0.0702542 Test Loss: 0.0806097
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0586675
	speed: 0.0439s/iter; left time: 625.3746s
	iters: 200, epoch: 37 | loss: 0.0590788
	speed: 0.0218s/iter; left time: 308.4060s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0556311 Vali Loss: 0.0702658 Test Loss: 0.0807087
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0518341
	speed: 0.0437s/iter; left time: 613.0300s
	iters: 200, epoch: 38 | loss: 0.0564199
	speed: 0.0217s/iter; left time: 302.4222s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0556050 Vali Loss: 0.0701945 Test Loss: 0.0806469
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0538694
	speed: 0.0434s/iter; left time: 598.8646s
	iters: 200, epoch: 39 | loss: 0.0558340
	speed: 0.0216s/iter; left time: 295.9991s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0555526 Vali Loss: 0.0701788 Test Loss: 0.0806311
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0528037
	speed: 0.0431s/iter; left time: 584.4127s
	iters: 200, epoch: 40 | loss: 0.0563718
	speed: 0.0216s/iter; left time: 291.3819s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0555443 Vali Loss: 0.0701902 Test Loss: 0.0807230
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0537868
	speed: 0.0433s/iter; left time: 577.6882s
	iters: 200, epoch: 41 | loss: 0.0518138
	speed: 0.0216s/iter; left time: 285.5869s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0555225 Vali Loss: 0.0701703 Test Loss: 0.0806849
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0544420
	speed: 0.0431s/iter; left time: 565.0525s
	iters: 200, epoch: 42 | loss: 0.0537285
	speed: 0.0218s/iter; left time: 284.3549s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0554823 Vali Loss: 0.0701914 Test Loss: 0.0806764
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0557889
	speed: 0.0433s/iter; left time: 558.7477s
	iters: 200, epoch: 43 | loss: 0.0549040
	speed: 0.0217s/iter; left time: 277.7320s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0555147 Vali Loss: 0.0701696 Test Loss: 0.0807534
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019456075504422188, rmse:0.13948503136634827, mae:0.08065373450517654, rse:0.5395652055740356
Intermediate time for FR and pred_len 96: 00h:07m:46.12s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1047884
	speed: 0.0392s/iter; left time: 870.5918s
	iters: 200, epoch: 1 | loss: 0.0905137
	speed: 0.0219s/iter; left time: 484.9882s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.31s
Steps: 223 | Train Loss: 0.1047934 Vali Loss: 0.0926547 Test Loss: 0.1004540
Validation loss decreased (inf --> 0.092655).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0788349
	speed: 0.0436s/iter; left time: 957.8971s
	iters: 200, epoch: 2 | loss: 0.0704296
	speed: 0.0219s/iter; left time: 478.1683s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0745576 Vali Loss: 0.0787413 Test Loss: 0.0877721
Validation loss decreased (0.092655 --> 0.078741).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0726744
	speed: 0.0461s/iter; left time: 1003.8582s
	iters: 200, epoch: 3 | loss: 0.0646740
	speed: 0.0218s/iter; left time: 472.4849s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.04s
Steps: 223 | Train Loss: 0.0679738 Vali Loss: 0.0758159 Test Loss: 0.0870918
Validation loss decreased (0.078741 --> 0.075816).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0661758
	speed: 0.0438s/iter; left time: 942.9623s
	iters: 200, epoch: 4 | loss: 0.0691870
	speed: 0.0230s/iter; left time: 493.3638s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.20s
Steps: 223 | Train Loss: 0.0661650 Vali Loss: 0.0754182 Test Loss: 0.0868940
Validation loss decreased (0.075816 --> 0.075418).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0674820
	speed: 0.0446s/iter; left time: 950.9199s
	iters: 200, epoch: 5 | loss: 0.0653155
	speed: 0.0219s/iter; left time: 464.1784s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0651712 Vali Loss: 0.0750074 Test Loss: 0.0866200
Validation loss decreased (0.075418 --> 0.075007).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0616626
	speed: 0.0441s/iter; left time: 930.8986s
	iters: 200, epoch: 6 | loss: 0.0650689
	speed: 0.0219s/iter; left time: 459.2325s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.07s
Steps: 223 | Train Loss: 0.0644060 Vali Loss: 0.0744523 Test Loss: 0.0859786
Validation loss decreased (0.075007 --> 0.074452).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0669554
	speed: 0.0444s/iter; left time: 926.1003s
	iters: 200, epoch: 7 | loss: 0.0649517
	speed: 0.0219s/iter; left time: 454.5492s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0638422 Vali Loss: 0.0745442 Test Loss: 0.0857981
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0588743
	speed: 0.0445s/iter; left time: 918.5246s
	iters: 200, epoch: 8 | loss: 0.0675873
	speed: 0.0221s/iter; left time: 452.9249s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0633962 Vali Loss: 0.0744216 Test Loss: 0.0862436
Validation loss decreased (0.074452 --> 0.074422).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0661422
	speed: 0.0476s/iter; left time: 971.3270s
	iters: 200, epoch: 9 | loss: 0.0585471
	speed: 0.0220s/iter; left time: 447.0930s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0630006 Vali Loss: 0.0740434 Test Loss: 0.0856501
Validation loss decreased (0.074422 --> 0.074043).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0613344
	speed: 0.0447s/iter; left time: 902.4052s
	iters: 200, epoch: 10 | loss: 0.0612494
	speed: 0.0219s/iter; left time: 440.8069s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0626160 Vali Loss: 0.0743081 Test Loss: 0.0863929
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0670712
	speed: 0.0439s/iter; left time: 875.9893s
	iters: 200, epoch: 11 | loss: 0.0583281
	speed: 0.0219s/iter; left time: 435.6848s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0622482 Vali Loss: 0.0741598 Test Loss: 0.0864162
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0608478
	speed: 0.0440s/iter; left time: 868.2588s
	iters: 200, epoch: 12 | loss: 0.0624133
	speed: 0.0220s/iter; left time: 432.7427s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0619888 Vali Loss: 0.0738946 Test Loss: 0.0866426
Validation loss decreased (0.074043 --> 0.073895).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0636746
	speed: 0.0450s/iter; left time: 879.3674s
	iters: 200, epoch: 13 | loss: 0.0627672
	speed: 0.0219s/iter; left time: 426.1501s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0616880 Vali Loss: 0.0738143 Test Loss: 0.0860346
Validation loss decreased (0.073895 --> 0.073814).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0624642
	speed: 0.0443s/iter; left time: 854.8143s
	iters: 200, epoch: 14 | loss: 0.0638702
	speed: 0.0219s/iter; left time: 420.3429s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0613845 Vali Loss: 0.0736747 Test Loss: 0.0871212
Validation loss decreased (0.073814 --> 0.073675).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0590320
	speed: 0.0445s/iter; left time: 849.5554s
	iters: 200, epoch: 15 | loss: 0.0655731
	speed: 0.0220s/iter; left time: 417.2130s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0611519 Vali Loss: 0.0736324 Test Loss: 0.0870632
Validation loss decreased (0.073675 --> 0.073632).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0640928
	speed: 0.0650s/iter; left time: 1225.0424s
	iters: 200, epoch: 16 | loss: 0.0616290
	speed: 0.0218s/iter; left time: 409.4145s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0609798 Vali Loss: 0.0734827 Test Loss: 0.0866049
Validation loss decreased (0.073632 --> 0.073483).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0604246
	speed: 0.0441s/iter; left time: 822.2732s
	iters: 200, epoch: 17 | loss: 0.0624319
	speed: 0.0218s/iter; left time: 404.3525s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0607425 Vali Loss: 0.0735642 Test Loss: 0.0867476
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0618308
	speed: 0.0427s/iter; left time: 786.8634s
	iters: 200, epoch: 18 | loss: 0.0607101
	speed: 0.0219s/iter; left time: 400.1761s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0605658 Vali Loss: 0.0736799 Test Loss: 0.0873466
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0592976
	speed: 0.0436s/iter; left time: 792.9547s
	iters: 200, epoch: 19 | loss: 0.0594642
	speed: 0.0219s/iter; left time: 396.5093s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0603905 Vali Loss: 0.0734560 Test Loss: 0.0871987
Validation loss decreased (0.073483 --> 0.073456).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0620754
	speed: 0.0485s/iter; left time: 871.3446s
	iters: 200, epoch: 20 | loss: 0.0573160
	speed: 0.0219s/iter; left time: 391.9100s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0602677 Vali Loss: 0.0735216 Test Loss: 0.0873157
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0580598
	speed: 0.0437s/iter; left time: 775.6477s
	iters: 200, epoch: 21 | loss: 0.0585812
	speed: 0.0220s/iter; left time: 388.1318s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0600737 Vali Loss: 0.0736293 Test Loss: 0.0872346
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0590039
	speed: 0.0437s/iter; left time: 765.1823s
	iters: 200, epoch: 22 | loss: 0.0674177
	speed: 0.0218s/iter; left time: 379.9848s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0599695 Vali Loss: 0.0734638 Test Loss: 0.0870055
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0582113
	speed: 0.0427s/iter; left time: 737.6877s
	iters: 200, epoch: 23 | loss: 0.0604661
	speed: 0.0218s/iter; left time: 375.6889s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0599225 Vali Loss: 0.0735764 Test Loss: 0.0871852
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0626521
	speed: 0.0431s/iter; left time: 735.4977s
	iters: 200, epoch: 24 | loss: 0.0589243
	speed: 0.0219s/iter; left time: 370.8873s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0598028 Vali Loss: 0.0733565 Test Loss: 0.0873794
Validation loss decreased (0.073456 --> 0.073357).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0609070
	speed: 0.0433s/iter; left time: 728.8259s
	iters: 200, epoch: 25 | loss: 0.0620830
	speed: 0.0218s/iter; left time: 365.4698s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0597322 Vali Loss: 0.0734481 Test Loss: 0.0877511
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0621876
	speed: 0.0435s/iter; left time: 723.9194s
	iters: 200, epoch: 26 | loss: 0.0597988
	speed: 0.0231s/iter; left time: 381.1991s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.32s
Steps: 223 | Train Loss: 0.0596620 Vali Loss: 0.0735329 Test Loss: 0.0874375
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0575571
	speed: 0.0474s/iter; left time: 777.1925s
	iters: 200, epoch: 27 | loss: 0.0595516
	speed: 0.0233s/iter; left time: 380.2412s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.45s
Steps: 223 | Train Loss: 0.0595835 Vali Loss: 0.0735385 Test Loss: 0.0872694
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0571845
	speed: 0.0468s/iter; left time: 757.1358s
	iters: 200, epoch: 28 | loss: 0.0591345
	speed: 0.0230s/iter; left time: 370.6224s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.40s
Steps: 223 | Train Loss: 0.0595673 Vali Loss: 0.0735461 Test Loss: 0.0874079
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0607052
	speed: 0.0465s/iter; left time: 741.5111s
	iters: 200, epoch: 29 | loss: 0.0591063
	speed: 0.0231s/iter; left time: 366.5983s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.44s
Steps: 223 | Train Loss: 0.0594623 Vali Loss: 0.0735023 Test Loss: 0.0872798
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0604437
	speed: 0.0472s/iter; left time: 742.1106s
	iters: 200, epoch: 30 | loss: 0.0607099
	speed: 0.0231s/iter; left time: 361.5767s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.35s
Steps: 223 | Train Loss: 0.0594588 Vali Loss: 0.0735614 Test Loss: 0.0872892
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0565619
	speed: 0.0474s/iter; left time: 735.9722s
	iters: 200, epoch: 31 | loss: 0.0581741
	speed: 0.0219s/iter; left time: 338.0559s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.28s
Steps: 223 | Train Loss: 0.0593974 Vali Loss: 0.0736041 Test Loss: 0.0871876
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0587226
	speed: 0.0429s/iter; left time: 655.0997s
	iters: 200, epoch: 32 | loss: 0.0621920
	speed: 0.0227s/iter; left time: 344.9602s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0593082 Vali Loss: 0.0735738 Test Loss: 0.0873199
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0554282
	speed: 0.0444s/iter; left time: 669.5626s
	iters: 200, epoch: 33 | loss: 0.0604258
	speed: 0.0220s/iter; left time: 328.6217s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0593511 Vali Loss: 0.0736037 Test Loss: 0.0871515
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0592100
	speed: 0.0434s/iter; left time: 644.7742s
	iters: 200, epoch: 34 | loss: 0.0617456
	speed: 0.0219s/iter; left time: 322.9407s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0593144 Vali Loss: 0.0734652 Test Loss: 0.0874648
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021824315190315247, rmse:0.14773054420948029, mae:0.08737940341234207, rse:0.5721744298934937
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1030251
	speed: 0.0237s/iter; left time: 527.1668s
	iters: 200, epoch: 1 | loss: 0.0873107
	speed: 0.0219s/iter; left time: 483.3621s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.1060435 Vali Loss: 0.0924741 Test Loss: 0.1004310
Validation loss decreased (inf --> 0.092474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0753420
	speed: 0.0446s/iter; left time: 980.5810s
	iters: 200, epoch: 2 | loss: 0.0722338
	speed: 0.0219s/iter; left time: 479.0159s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0746925 Vali Loss: 0.0789645 Test Loss: 0.0883745
Validation loss decreased (0.092474 --> 0.078965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0748482
	speed: 0.0438s/iter; left time: 953.5283s
	iters: 200, epoch: 3 | loss: 0.0639371
	speed: 0.0219s/iter; left time: 473.5125s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0683263 Vali Loss: 0.0765230 Test Loss: 0.0874017
Validation loss decreased (0.078965 --> 0.076523).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0649893
	speed: 0.0435s/iter; left time: 936.2423s
	iters: 200, epoch: 4 | loss: 0.0676690
	speed: 0.0219s/iter; left time: 468.3478s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0665618 Vali Loss: 0.0752665 Test Loss: 0.0865758
Validation loss decreased (0.076523 --> 0.075266).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0637639
	speed: 0.0436s/iter; left time: 929.9842s
	iters: 200, epoch: 5 | loss: 0.0627055
	speed: 0.0219s/iter; left time: 464.2274s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.07s
Steps: 223 | Train Loss: 0.0654805 Vali Loss: 0.0751391 Test Loss: 0.0866270
Validation loss decreased (0.075266 --> 0.075139).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0607501
	speed: 0.0438s/iter; left time: 924.1653s
	iters: 200, epoch: 6 | loss: 0.0692497
	speed: 0.0227s/iter; left time: 475.5758s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0646013 Vali Loss: 0.0746873 Test Loss: 0.0865874
Validation loss decreased (0.075139 --> 0.074687).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0634956
	speed: 0.0484s/iter; left time: 1010.2585s
	iters: 200, epoch: 7 | loss: 0.0679322
	speed: 0.0219s/iter; left time: 454.9211s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0640746 Vali Loss: 0.0748270 Test Loss: 0.0862303
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0644977
	speed: 0.0425s/iter; left time: 878.0276s
	iters: 200, epoch: 8 | loss: 0.0633362
	speed: 0.0219s/iter; left time: 448.8586s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.05s
Steps: 223 | Train Loss: 0.0635260 Vali Loss: 0.0745034 Test Loss: 0.0873248
Validation loss decreased (0.074687 --> 0.074503).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0667399
	speed: 0.0437s/iter; left time: 892.5737s
	iters: 200, epoch: 9 | loss: 0.0659375
	speed: 0.0218s/iter; left time: 443.1858s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.04s
Steps: 223 | Train Loss: 0.0631061 Vali Loss: 0.0743013 Test Loss: 0.0870588
Validation loss decreased (0.074503 --> 0.074301).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0633721
	speed: 0.0435s/iter; left time: 879.2894s
	iters: 200, epoch: 10 | loss: 0.0638513
	speed: 0.0218s/iter; left time: 438.6158s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0628241 Vali Loss: 0.0743637 Test Loss: 0.0876514
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0634327
	speed: 0.0424s/iter; left time: 845.9228s
	iters: 200, epoch: 11 | loss: 0.0602419
	speed: 0.0219s/iter; left time: 435.2160s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.06s
Steps: 223 | Train Loss: 0.0623999 Vali Loss: 0.0743283 Test Loss: 0.0879305
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0590030
	speed: 0.0425s/iter; left time: 839.7887s
	iters: 200, epoch: 12 | loss: 0.0654228
	speed: 0.0219s/iter; left time: 429.3092s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.05s
Steps: 223 | Train Loss: 0.0621592 Vali Loss: 0.0739127 Test Loss: 0.0869534
Validation loss decreased (0.074301 --> 0.073913).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0614395
	speed: 0.0433s/iter; left time: 846.3625s
	iters: 200, epoch: 13 | loss: 0.0617297
	speed: 0.0221s/iter; left time: 429.3154s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0618787 Vali Loss: 0.0739848 Test Loss: 0.0876936
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0613653
	speed: 0.0429s/iter; left time: 828.9427s
	iters: 200, epoch: 14 | loss: 0.0604087
	speed: 0.0219s/iter; left time: 420.8314s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0615930 Vali Loss: 0.0742752 Test Loss: 0.0876290
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0601074
	speed: 0.0429s/iter; left time: 817.6393s
	iters: 200, epoch: 15 | loss: 0.0587391
	speed: 0.0219s/iter; left time: 416.0708s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.05s
Steps: 223 | Train Loss: 0.0614255 Vali Loss: 0.0740568 Test Loss: 0.0875472
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0572025
	speed: 0.0430s/iter; left time: 810.4544s
	iters: 200, epoch: 16 | loss: 0.0580056
	speed: 0.0220s/iter; left time: 412.3394s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0612101 Vali Loss: 0.0742002 Test Loss: 0.0879717
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0624616
	speed: 0.0433s/iter; left time: 806.9121s
	iters: 200, epoch: 17 | loss: 0.0583068
	speed: 0.0218s/iter; left time: 404.7940s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.04s
Steps: 223 | Train Loss: 0.0609643 Vali Loss: 0.0740941 Test Loss: 0.0877149
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0642678
	speed: 0.0425s/iter; left time: 783.3063s
	iters: 200, epoch: 18 | loss: 0.0621655
	speed: 0.0219s/iter; left time: 400.8279s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.07s
Steps: 223 | Train Loss: 0.0608562 Vali Loss: 0.0742891 Test Loss: 0.0880853
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0588711
	speed: 0.0429s/iter; left time: 781.0086s
	iters: 200, epoch: 19 | loss: 0.0606055
	speed: 0.0219s/iter; left time: 395.7317s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.05s
Steps: 223 | Train Loss: 0.0606920 Vali Loss: 0.0741619 Test Loss: 0.0881231
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0604822
	speed: 0.0427s/iter; left time: 766.8363s
	iters: 200, epoch: 20 | loss: 0.0585233
	speed: 0.0219s/iter; left time: 390.6918s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.05s
Steps: 223 | Train Loss: 0.0605764 Vali Loss: 0.0740427 Test Loss: 0.0882085
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0645385
	speed: 0.0433s/iter; left time: 767.8030s
	iters: 200, epoch: 21 | loss: 0.0592120
	speed: 0.0220s/iter; left time: 388.1284s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0604268 Vali Loss: 0.0741126 Test Loss: 0.0880485
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0602419
	speed: 0.0432s/iter; left time: 757.4638s
	iters: 200, epoch: 22 | loss: 0.0623940
	speed: 0.0218s/iter; left time: 380.2970s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.07s
Steps: 223 | Train Loss: 0.0602788 Vali Loss: 0.0741272 Test Loss: 0.0879747
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021077584475278854, rmse:0.14518120884895325, mae:0.08695334941148758, rse:0.5623005628585815
Intermediate time for FR and pred_len 168: 00h:06m:22.98s
Intermediate time for FR: 00h:26m:17.57s

=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1374330
	speed: 0.0387s/iter; left time: 862.9607s
	iters: 200, epoch: 1 | loss: 0.1158889
	speed: 0.0215s/iter; left time: 478.1446s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.28s
Steps: 224 | Train Loss: 0.1433002 Vali Loss: 0.0977289 Test Loss: 0.1001484
Validation loss decreased (inf --> 0.097729).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0775924
	speed: 0.0432s/iter; left time: 952.8440s
	iters: 200, epoch: 2 | loss: 0.0677988
	speed: 0.0215s/iter; left time: 472.4879s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0783026 Vali Loss: 0.0629715 Test Loss: 0.0662288
Validation loss decreased (0.097729 --> 0.062971).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0624642
	speed: 0.0422s/iter; left time: 922.7846s
	iters: 200, epoch: 3 | loss: 0.0655993
	speed: 0.0216s/iter; left time: 469.8026s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0658234 Vali Loss: 0.0603904 Test Loss: 0.0630145
Validation loss decreased (0.062971 --> 0.060390).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0631800
	speed: 0.0434s/iter; left time: 939.1106s
	iters: 200, epoch: 4 | loss: 0.0595277
	speed: 0.0215s/iter; left time: 463.4448s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0628593 Vali Loss: 0.0585107 Test Loss: 0.0609076
Validation loss decreased (0.060390 --> 0.058511).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0594525
	speed: 0.0423s/iter; left time: 905.9711s
	iters: 200, epoch: 5 | loss: 0.0608826
	speed: 0.0215s/iter; left time: 458.7495s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0610891 Vali Loss: 0.0580950 Test Loss: 0.0601172
Validation loss decreased (0.058511 --> 0.058095).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0573971
	speed: 0.0420s/iter; left time: 889.7540s
	iters: 200, epoch: 6 | loss: 0.0560708
	speed: 0.0215s/iter; left time: 452.7179s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0600967 Vali Loss: 0.0572676 Test Loss: 0.0596117
Validation loss decreased (0.058095 --> 0.057268).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0608855
	speed: 0.0440s/iter; left time: 921.4481s
	iters: 200, epoch: 7 | loss: 0.0570359
	speed: 0.0215s/iter; left time: 448.9311s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0591829 Vali Loss: 0.0568020 Test Loss: 0.0589726
Validation loss decreased (0.057268 --> 0.056802).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0575192
	speed: 0.0431s/iter; left time: 892.6632s
	iters: 200, epoch: 8 | loss: 0.0575466
	speed: 0.0223s/iter; left time: 460.9618s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0585594 Vali Loss: 0.0562999 Test Loss: 0.0586725
Validation loss decreased (0.056802 --> 0.056300).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0555504
	speed: 0.0503s/iter; left time: 1032.0147s
	iters: 200, epoch: 9 | loss: 0.0592853
	speed: 0.0221s/iter; left time: 451.8805s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0579470 Vali Loss: 0.0564453 Test Loss: 0.0588011
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0576661
	speed: 0.0455s/iter; left time: 923.5975s
	iters: 200, epoch: 10 | loss: 0.0568854
	speed: 0.0225s/iter; left time: 453.6648s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.33s
Steps: 224 | Train Loss: 0.0575693 Vali Loss: 0.0561655 Test Loss: 0.0585279
Validation loss decreased (0.056300 --> 0.056166).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0594519
	speed: 0.0458s/iter; left time: 918.5862s
	iters: 200, epoch: 11 | loss: 0.0520067
	speed: 0.0216s/iter; left time: 431.0233s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.22s
Steps: 224 | Train Loss: 0.0571156 Vali Loss: 0.0558879 Test Loss: 0.0580664
Validation loss decreased (0.056166 --> 0.055888).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0538387
	speed: 0.0429s/iter; left time: 850.0227s
	iters: 200, epoch: 12 | loss: 0.0570092
	speed: 0.0215s/iter; left time: 424.9661s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0567892 Vali Loss: 0.0556625 Test Loss: 0.0577564
Validation loss decreased (0.055888 --> 0.055663).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0555708
	speed: 0.0446s/iter; left time: 874.8027s
	iters: 200, epoch: 13 | loss: 0.0566810
	speed: 0.0215s/iter; left time: 419.2879s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0565807 Vali Loss: 0.0555824 Test Loss: 0.0578818
Validation loss decreased (0.055663 --> 0.055582).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0610963
	speed: 0.0430s/iter; left time: 834.2712s
	iters: 200, epoch: 14 | loss: 0.0550782
	speed: 0.0215s/iter; left time: 414.8392s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0562441 Vali Loss: 0.0554863 Test Loss: 0.0576335
Validation loss decreased (0.055582 --> 0.055486).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0569684
	speed: 0.0439s/iter; left time: 840.9450s
	iters: 200, epoch: 15 | loss: 0.0562406
	speed: 0.0215s/iter; left time: 409.2596s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0559479 Vali Loss: 0.0552672 Test Loss: 0.0574207
Validation loss decreased (0.055486 --> 0.055267).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0571631
	speed: 0.0423s/iter; left time: 800.5171s
	iters: 200, epoch: 16 | loss: 0.0558663
	speed: 0.0216s/iter; left time: 406.8374s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0558095 Vali Loss: 0.0551484 Test Loss: 0.0572730
Validation loss decreased (0.055267 --> 0.055148).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0583936
	speed: 0.0422s/iter; left time: 790.5099s
	iters: 200, epoch: 17 | loss: 0.0574635
	speed: 0.0215s/iter; left time: 399.8954s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0557455 Vali Loss: 0.0550383 Test Loss: 0.0572293
Validation loss decreased (0.055148 --> 0.055038).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0537376
	speed: 0.0428s/iter; left time: 792.0817s
	iters: 200, epoch: 18 | loss: 0.0576277
	speed: 0.0215s/iter; left time: 395.0748s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0555075 Vali Loss: 0.0550554 Test Loss: 0.0572817
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0551231
	speed: 0.0418s/iter; left time: 763.7701s
	iters: 200, epoch: 19 | loss: 0.0589218
	speed: 0.0216s/iter; left time: 392.1273s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0553814 Vali Loss: 0.0549142 Test Loss: 0.0571010
Validation loss decreased (0.055038 --> 0.054914).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0545368
	speed: 0.0424s/iter; left time: 765.5982s
	iters: 200, epoch: 20 | loss: 0.0538168
	speed: 0.0215s/iter; left time: 385.7878s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0551741 Vali Loss: 0.0548667 Test Loss: 0.0570449
Validation loss decreased (0.054914 --> 0.054867).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0563235
	speed: 0.0423s/iter; left time: 753.9084s
	iters: 200, epoch: 21 | loss: 0.0539313
	speed: 0.0215s/iter; left time: 380.8809s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0551580 Vali Loss: 0.0548767 Test Loss: 0.0570842
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0526196
	speed: 0.0419s/iter; left time: 736.9703s
	iters: 200, epoch: 22 | loss: 0.0502118
	speed: 0.0215s/iter; left time: 376.7583s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0550031 Vali Loss: 0.0548935 Test Loss: 0.0570054
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0541094
	speed: 0.0419s/iter; left time: 727.3902s
	iters: 200, epoch: 23 | loss: 0.0508736
	speed: 0.0215s/iter; left time: 371.8530s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0548972 Vali Loss: 0.0548363 Test Loss: 0.0570776
Validation loss decreased (0.054867 --> 0.054836).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0583407
	speed: 0.0424s/iter; left time: 727.6081s
	iters: 200, epoch: 24 | loss: 0.0550409
	speed: 0.0215s/iter; left time: 367.2534s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0548103 Vali Loss: 0.0546860 Test Loss: 0.0570549
Validation loss decreased (0.054836 --> 0.054686).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0517474
	speed: 0.0428s/iter; left time: 723.7147s
	iters: 200, epoch: 25 | loss: 0.0576478
	speed: 0.0215s/iter; left time: 361.5128s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0547476 Vali Loss: 0.0545434 Test Loss: 0.0568930
Validation loss decreased (0.054686 --> 0.054543).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0559251
	speed: 0.0426s/iter; left time: 711.4819s
	iters: 200, epoch: 26 | loss: 0.0555410
	speed: 0.0215s/iter; left time: 356.4195s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0546784 Vali Loss: 0.0545894 Test Loss: 0.0568467
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0570185
	speed: 0.0416s/iter; left time: 685.9364s
	iters: 200, epoch: 27 | loss: 0.0575861
	speed: 0.0215s/iter; left time: 352.4023s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0546277 Vali Loss: 0.0546435 Test Loss: 0.0568211
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0563731
	speed: 0.0421s/iter; left time: 683.4429s
	iters: 200, epoch: 28 | loss: 0.0524455
	speed: 0.0215s/iter; left time: 348.0128s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0545354 Vali Loss: 0.0544690 Test Loss: 0.0567674
Validation loss decreased (0.054543 --> 0.054469).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0574244
	speed: 0.0436s/iter; left time: 698.9941s
	iters: 200, epoch: 29 | loss: 0.0525602
	speed: 0.0215s/iter; left time: 342.2197s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0545589 Vali Loss: 0.0544414 Test Loss: 0.0568940
Validation loss decreased (0.054469 --> 0.054441).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0544800
	speed: 0.0423s/iter; left time: 668.6601s
	iters: 200, epoch: 30 | loss: 0.0563679
	speed: 0.0214s/iter; left time: 336.7709s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0544876 Vali Loss: 0.0545130 Test Loss: 0.0568038
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0518920
	speed: 0.0420s/iter; left time: 654.6807s
	iters: 200, epoch: 31 | loss: 0.0554251
	speed: 0.0215s/iter; left time: 332.8139s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0544764 Vali Loss: 0.0544562 Test Loss: 0.0567921
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0543855
	speed: 0.0416s/iter; left time: 639.2368s
	iters: 200, epoch: 32 | loss: 0.0567700
	speed: 0.0215s/iter; left time: 328.3042s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0544112 Vali Loss: 0.0544896 Test Loss: 0.0567369
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0550720
	speed: 0.0417s/iter; left time: 631.5866s
	iters: 200, epoch: 33 | loss: 0.0551676
	speed: 0.0217s/iter; left time: 325.6444s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0544500 Vali Loss: 0.0544095 Test Loss: 0.0567518
Validation loss decreased (0.054441 --> 0.054409).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0567886
	speed: 0.0428s/iter; left time: 637.9667s
	iters: 200, epoch: 34 | loss: 0.0572906
	speed: 0.0215s/iter; left time: 317.8383s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0542808 Vali Loss: 0.0543764 Test Loss: 0.0567341
Validation loss decreased (0.054409 --> 0.054376).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0533894
	speed: 0.0421s/iter; left time: 618.8881s
	iters: 200, epoch: 35 | loss: 0.0561079
	speed: 0.0215s/iter; left time: 312.8561s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0543705 Vali Loss: 0.0544325 Test Loss: 0.0567682
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0552642
	speed: 0.0413s/iter; left time: 597.8618s
	iters: 200, epoch: 36 | loss: 0.0545737
	speed: 0.0216s/iter; left time: 309.5582s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0542740 Vali Loss: 0.0544421 Test Loss: 0.0566902
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0536100
	speed: 0.0419s/iter; left time: 595.9987s
	iters: 200, epoch: 37 | loss: 0.0506984
	speed: 0.0215s/iter; left time: 303.4875s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0543074 Vali Loss: 0.0543864 Test Loss: 0.0567062
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0541290
	speed: 0.0424s/iter; left time: 594.1564s
	iters: 200, epoch: 38 | loss: 0.0560373
	speed: 0.0216s/iter; left time: 300.2096s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0542180 Vali Loss: 0.0543355 Test Loss: 0.0566822
Validation loss decreased (0.054376 --> 0.054335).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0512705
	speed: 0.0437s/iter; left time: 602.9437s
	iters: 200, epoch: 39 | loss: 0.0553241
	speed: 0.0216s/iter; left time: 295.5520s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0542341 Vali Loss: 0.0543868 Test Loss: 0.0566607
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0553307
	speed: 0.0427s/iter; left time: 579.6505s
	iters: 200, epoch: 40 | loss: 0.0515860
	speed: 0.0216s/iter; left time: 290.5556s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0542228 Vali Loss: 0.0544044 Test Loss: 0.0566717
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0563626
	speed: 0.0426s/iter; left time: 568.5501s
	iters: 200, epoch: 41 | loss: 0.0504337
	speed: 0.0216s/iter; left time: 285.9212s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0542287 Vali Loss: 0.0543635 Test Loss: 0.0566482
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0523032
	speed: 0.0426s/iter; left time: 558.5696s
	iters: 200, epoch: 42 | loss: 0.0582025
	speed: 0.0216s/iter; left time: 281.0955s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0542033 Vali Loss: 0.0543002 Test Loss: 0.0566480
Validation loss decreased (0.054335 --> 0.054300).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0522139
	speed: 0.0430s/iter; left time: 554.8457s
	iters: 200, epoch: 43 | loss: 0.0509002
	speed: 0.0216s/iter; left time: 275.7031s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0541778 Vali Loss: 0.0543848 Test Loss: 0.0566356
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0540905
	speed: 0.0426s/iter; left time: 539.3402s
	iters: 200, epoch: 44 | loss: 0.0551286
	speed: 0.0216s/iter; left time: 271.1652s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0542117 Vali Loss: 0.0542866 Test Loss: 0.0566235
Validation loss decreased (0.054300 --> 0.054287).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0567412
	speed: 0.0425s/iter; left time: 528.8247s
	iters: 200, epoch: 45 | loss: 0.0568375
	speed: 0.0215s/iter; left time: 265.2501s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0541866 Vali Loss: 0.0543479 Test Loss: 0.0566406
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0504196
	speed: 0.0422s/iter; left time: 515.7030s
	iters: 200, epoch: 46 | loss: 0.0570223
	speed: 0.0215s/iter; left time: 260.8584s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0541373 Vali Loss: 0.0543584 Test Loss: 0.0566015
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0615442
	speed: 0.0419s/iter; left time: 503.1153s
	iters: 200, epoch: 47 | loss: 0.0499255
	speed: 0.0215s/iter; left time: 256.1592s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0542002 Vali Loss: 0.0543194 Test Loss: 0.0566245
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0552510
	speed: 0.0418s/iter; left time: 491.7875s
	iters: 200, epoch: 48 | loss: 0.0520807
	speed: 0.0215s/iter; left time: 251.3387s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0541524 Vali Loss: 0.0542495 Test Loss: 0.0566311
Validation loss decreased (0.054287 --> 0.054249).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0545694
	speed: 0.0431s/iter; left time: 497.9741s
	iters: 200, epoch: 49 | loss: 0.0505374
	speed: 0.0216s/iter; left time: 246.7688s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0541052 Vali Loss: 0.0543268 Test Loss: 0.0566165
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0538755
	speed: 0.0420s/iter; left time: 475.8218s
	iters: 200, epoch: 50 | loss: 0.0503643
	speed: 0.0215s/iter; left time: 241.6543s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0541240 Vali Loss: 0.0543155 Test Loss: 0.0566461
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0532780
	speed: 0.0421s/iter; left time: 467.4958s
	iters: 200, epoch: 51 | loss: 0.0521176
	speed: 0.0215s/iter; left time: 236.7514s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0542104 Vali Loss: 0.0542844 Test Loss: 0.0566410
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0516743
	speed: 0.0426s/iter; left time: 462.9884s
	iters: 200, epoch: 52 | loss: 0.0522399
	speed: 0.0215s/iter; left time: 231.5602s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0541466 Vali Loss: 0.0543077 Test Loss: 0.0566177
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0549785
	speed: 0.0419s/iter; left time: 446.0280s
	iters: 200, epoch: 53 | loss: 0.0513716
	speed: 0.0214s/iter; left time: 226.3579s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0541321 Vali Loss: 0.0543021 Test Loss: 0.0566411
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0541234
	speed: 0.0416s/iter; left time: 434.0395s
	iters: 200, epoch: 54 | loss: 0.0581750
	speed: 0.0214s/iter; left time: 221.1079s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.96s
Steps: 224 | Train Loss: 0.0541015 Vali Loss: 0.0542947 Test Loss: 0.0566174
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0550104
	speed: 0.0420s/iter; left time: 428.2857s
	iters: 200, epoch: 55 | loss: 0.0567199
	speed: 0.0215s/iter; left time: 217.4224s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0540815 Vali Loss: 0.0543251 Test Loss: 0.0566403
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0526870
	speed: 0.0414s/iter; left time: 412.9114s
	iters: 200, epoch: 56 | loss: 0.0572773
	speed: 0.0215s/iter; left time: 212.3098s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0541013 Vali Loss: 0.0543307 Test Loss: 0.0566290
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0561683
	speed: 0.0421s/iter; left time: 411.0681s
	iters: 200, epoch: 57 | loss: 0.0537422
	speed: 0.0214s/iter; left time: 206.8622s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0541649 Vali Loss: 0.0542578 Test Loss: 0.0566242
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0534977
	speed: 0.0416s/iter; left time: 396.9521s
	iters: 200, epoch: 58 | loss: 0.0546461
	speed: 0.0215s/iter; left time: 202.9552s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0540974 Vali Loss: 0.0542856 Test Loss: 0.0566259
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010082419961690903, rmse:0.10041125118732452, mae:0.05663115531206131, rse:0.3794046938419342
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1339007
	speed: 0.0230s/iter; left time: 513.2802s
	iters: 200, epoch: 1 | loss: 0.1141043
	speed: 0.0214s/iter; left time: 475.1797s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.1399536 Vali Loss: 0.0962337 Test Loss: 0.0982868
Validation loss decreased (inf --> 0.096234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0758613
	speed: 0.0427s/iter; left time: 943.6928s
	iters: 200, epoch: 2 | loss: 0.0685552
	speed: 0.0214s/iter; left time: 471.1924s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0781022 Vali Loss: 0.0632921 Test Loss: 0.0665533
Validation loss decreased (0.096234 --> 0.063292).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0699126
	speed: 0.0418s/iter; left time: 913.8944s
	iters: 200, epoch: 3 | loss: 0.0639520
	speed: 0.0214s/iter; left time: 466.3738s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0657198 Vali Loss: 0.0600900 Test Loss: 0.0626587
Validation loss decreased (0.063292 --> 0.060090).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0661892
	speed: 0.0423s/iter; left time: 914.6747s
	iters: 200, epoch: 4 | loss: 0.0630479
	speed: 0.0229s/iter; left time: 493.4928s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.19s
Steps: 224 | Train Loss: 0.0628259 Vali Loss: 0.0587901 Test Loss: 0.0611407
Validation loss decreased (0.060090 --> 0.058790).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0577873
	speed: 0.0424s/iter; left time: 906.6851s
	iters: 200, epoch: 5 | loss: 0.0615354
	speed: 0.0216s/iter; left time: 460.1393s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0611608 Vali Loss: 0.0579751 Test Loss: 0.0604489
Validation loss decreased (0.058790 --> 0.057975).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0578371
	speed: 0.0431s/iter; left time: 912.0520s
	iters: 200, epoch: 6 | loss: 0.0608955
	speed: 0.0226s/iter; left time: 476.5708s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0600812 Vali Loss: 0.0574840 Test Loss: 0.0594247
Validation loss decreased (0.057975 --> 0.057484).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0610436
	speed: 0.0435s/iter; left time: 911.5468s
	iters: 200, epoch: 7 | loss: 0.0580292
	speed: 0.0217s/iter; left time: 452.0387s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0593069 Vali Loss: 0.0566896 Test Loss: 0.0590364
Validation loss decreased (0.057484 --> 0.056690).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0619234
	speed: 0.0415s/iter; left time: 859.4763s
	iters: 200, epoch: 8 | loss: 0.0609879
	speed: 0.0221s/iter; left time: 455.7840s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0586601 Vali Loss: 0.0566635 Test Loss: 0.0588564
Validation loss decreased (0.056690 --> 0.056664).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0585691
	speed: 0.0458s/iter; left time: 938.8217s
	iters: 200, epoch: 9 | loss: 0.0596622
	speed: 0.0223s/iter; left time: 455.2722s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.16s
Steps: 224 | Train Loss: 0.0580095 Vali Loss: 0.0562204 Test Loss: 0.0584780
Validation loss decreased (0.056664 --> 0.056220).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0566555
	speed: 0.0449s/iter; left time: 910.3337s
	iters: 200, epoch: 10 | loss: 0.0590553
	speed: 0.0216s/iter; left time: 435.1751s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0575709 Vali Loss: 0.0561185 Test Loss: 0.0584787
Validation loss decreased (0.056220 --> 0.056119).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0580545
	speed: 0.0429s/iter; left time: 860.4079s
	iters: 200, epoch: 11 | loss: 0.0536545
	speed: 0.0216s/iter; left time: 430.5494s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0572077 Vali Loss: 0.0559147 Test Loss: 0.0581077
Validation loss decreased (0.056119 --> 0.055915).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0606991
	speed: 0.0431s/iter; left time: 854.4795s
	iters: 200, epoch: 12 | loss: 0.0579197
	speed: 0.0215s/iter; left time: 425.1358s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0568025 Vali Loss: 0.0556031 Test Loss: 0.0580129
Validation loss decreased (0.055915 --> 0.055603).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0552645
	speed: 0.0420s/iter; left time: 824.5466s
	iters: 200, epoch: 13 | loss: 0.0575264
	speed: 0.0215s/iter; left time: 419.5667s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0565975 Vali Loss: 0.0555254 Test Loss: 0.0578121
Validation loss decreased (0.055603 --> 0.055525).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0575443
	speed: 0.0425s/iter; left time: 823.6450s
	iters: 200, epoch: 14 | loss: 0.0548009
	speed: 0.0215s/iter; left time: 414.6678s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0563294 Vali Loss: 0.0552340 Test Loss: 0.0577625
Validation loss decreased (0.055525 --> 0.055234).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0540166
	speed: 0.0424s/iter; left time: 812.8717s
	iters: 200, epoch: 15 | loss: 0.0579367
	speed: 0.0215s/iter; left time: 409.0697s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.03s
Steps: 224 | Train Loss: 0.0561100 Vali Loss: 0.0552688 Test Loss: 0.0576236
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0556957
	speed: 0.0419s/iter; left time: 794.0030s
	iters: 200, epoch: 16 | loss: 0.0567376
	speed: 0.0215s/iter; left time: 404.8856s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0559282 Vali Loss: 0.0551624 Test Loss: 0.0576666
Validation loss decreased (0.055234 --> 0.055162).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0571628
	speed: 0.0421s/iter; left time: 787.8706s
	iters: 200, epoch: 17 | loss: 0.0562587
	speed: 0.0215s/iter; left time: 399.9356s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0557251 Vali Loss: 0.0550474 Test Loss: 0.0573440
Validation loss decreased (0.055162 --> 0.055047).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0599124
	speed: 0.0419s/iter; left time: 774.9591s
	iters: 200, epoch: 18 | loss: 0.0596398
	speed: 0.0215s/iter; left time: 395.4013s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0555403 Vali Loss: 0.0551596 Test Loss: 0.0574187
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0568367
	speed: 0.0420s/iter; left time: 767.4066s
	iters: 200, epoch: 19 | loss: 0.0576186
	speed: 0.0216s/iter; left time: 392.3985s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0553967 Vali Loss: 0.0548926 Test Loss: 0.0574379
Validation loss decreased (0.055047 --> 0.054893).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0516709
	speed: 0.0453s/iter; left time: 816.6746s
	iters: 200, epoch: 20 | loss: 0.0532392
	speed: 0.0215s/iter; left time: 386.4300s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0553269 Vali Loss: 0.0547914 Test Loss: 0.0572598
Validation loss decreased (0.054893 --> 0.054791).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0612929
	speed: 0.0421s/iter; left time: 750.4024s
	iters: 200, epoch: 21 | loss: 0.0586444
	speed: 0.0215s/iter; left time: 381.2295s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0551592 Vali Loss: 0.0546671 Test Loss: 0.0571164
Validation loss decreased (0.054791 --> 0.054667).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0550500
	speed: 0.0422s/iter; left time: 742.9936s
	iters: 200, epoch: 22 | loss: 0.0568175
	speed: 0.0215s/iter; left time: 376.4253s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0550600 Vali Loss: 0.0547517 Test Loss: 0.0573194
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0562241
	speed: 0.0428s/iter; left time: 743.8595s
	iters: 200, epoch: 23 | loss: 0.0562010
	speed: 0.0228s/iter; left time: 393.3129s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.25s
Steps: 224 | Train Loss: 0.0549301 Vali Loss: 0.0546346 Test Loss: 0.0571809
Validation loss decreased (0.054667 --> 0.054635).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0601251
	speed: 0.0428s/iter; left time: 734.4827s
	iters: 200, epoch: 24 | loss: 0.0503643
	speed: 0.0215s/iter; left time: 366.8283s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0549245 Vali Loss: 0.0546147 Test Loss: 0.0570558
Validation loss decreased (0.054635 --> 0.054615).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0540612
	speed: 0.0419s/iter; left time: 709.3509s
	iters: 200, epoch: 25 | loss: 0.0536494
	speed: 0.0215s/iter; left time: 361.3439s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0548452 Vali Loss: 0.0545980 Test Loss: 0.0569985
Validation loss decreased (0.054615 --> 0.054598).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0537542
	speed: 0.0421s/iter; left time: 702.6177s
	iters: 200, epoch: 26 | loss: 0.0526753
	speed: 0.0215s/iter; left time: 357.0427s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0547378 Vali Loss: 0.0545814 Test Loss: 0.0569343
Validation loss decreased (0.054598 --> 0.054581).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0547489
	speed: 0.0419s/iter; left time: 690.7546s
	iters: 200, epoch: 27 | loss: 0.0570755
	speed: 0.0215s/iter; left time: 352.2867s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0547119 Vali Loss: 0.0545830 Test Loss: 0.0570169
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0561430
	speed: 0.0415s/iter; left time: 674.9793s
	iters: 200, epoch: 28 | loss: 0.0547058
	speed: 0.0215s/iter; left time: 347.2899s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0545742 Vali Loss: 0.0545249 Test Loss: 0.0569628
Validation loss decreased (0.054581 --> 0.054525).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0583723
	speed: 0.0422s/iter; left time: 676.5188s
	iters: 200, epoch: 29 | loss: 0.0564685
	speed: 0.0215s/iter; left time: 342.4830s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0545637 Vali Loss: 0.0545397 Test Loss: 0.0569412
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0561986
	speed: 0.0416s/iter; left time: 657.9660s
	iters: 200, epoch: 30 | loss: 0.0567871
	speed: 0.0215s/iter; left time: 337.5733s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0545386 Vali Loss: 0.0545551 Test Loss: 0.0570078
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0525878
	speed: 0.0414s/iter; left time: 645.1905s
	iters: 200, epoch: 31 | loss: 0.0560188
	speed: 0.0215s/iter; left time: 332.4956s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0545423 Vali Loss: 0.0544267 Test Loss: 0.0569337
Validation loss decreased (0.054525 --> 0.054427).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0561851
	speed: 0.0420s/iter; left time: 644.7535s
	iters: 200, epoch: 32 | loss: 0.0548819
	speed: 0.0215s/iter; left time: 328.3451s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0544458 Vali Loss: 0.0544618 Test Loss: 0.0569152
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0567685
	speed: 0.0417s/iter; left time: 631.1441s
	iters: 200, epoch: 33 | loss: 0.0507412
	speed: 0.0215s/iter; left time: 322.9943s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0544456 Vali Loss: 0.0544538 Test Loss: 0.0569001
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0559536
	speed: 0.0415s/iter; left time: 618.2945s
	iters: 200, epoch: 34 | loss: 0.0519906
	speed: 0.0217s/iter; left time: 321.1695s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0544656 Vali Loss: 0.0543858 Test Loss: 0.0568676
Validation loss decreased (0.054427 --> 0.054386).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0530760
	speed: 0.0421s/iter; left time: 618.2376s
	iters: 200, epoch: 35 | loss: 0.0572495
	speed: 0.0214s/iter; left time: 312.3013s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0543739 Vali Loss: 0.0543999 Test Loss: 0.0568235
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0515960
	speed: 0.0415s/iter; left time: 599.8871s
	iters: 200, epoch: 36 | loss: 0.0520151
	speed: 0.0215s/iter; left time: 308.3543s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0543862 Vali Loss: 0.0544744 Test Loss: 0.0568320
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0519809
	speed: 0.0411s/iter; left time: 585.2617s
	iters: 200, epoch: 37 | loss: 0.0528668
	speed: 0.0214s/iter; left time: 302.7780s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0543618 Vali Loss: 0.0543376 Test Loss: 0.0568573
Validation loss decreased (0.054386 --> 0.054338).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0481222
	speed: 0.0415s/iter; left time: 580.9310s
	iters: 200, epoch: 38 | loss: 0.0524703
	speed: 0.0215s/iter; left time: 298.5175s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0543674 Vali Loss: 0.0543297 Test Loss: 0.0567856
Validation loss decreased (0.054338 --> 0.054330).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0495181
	speed: 0.0421s/iter; left time: 580.1197s
	iters: 200, epoch: 39 | loss: 0.0553799
	speed: 0.0216s/iter; left time: 295.4491s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0543520 Vali Loss: 0.0543180 Test Loss: 0.0568032
Validation loss decreased (0.054330 --> 0.054318).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0504843
	speed: 0.0422s/iter; left time: 572.5507s
	iters: 200, epoch: 40 | loss: 0.0588645
	speed: 0.0215s/iter; left time: 289.1693s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0542695 Vali Loss: 0.0543380 Test Loss: 0.0567912
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0527855
	speed: 0.0424s/iter; left time: 565.6425s
	iters: 200, epoch: 41 | loss: 0.0544314
	speed: 0.0216s/iter; left time: 285.3730s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0542629 Vali Loss: 0.0542896 Test Loss: 0.0567976
Validation loss decreased (0.054318 --> 0.054290).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0549833
	speed: 0.0427s/iter; left time: 560.7264s
	iters: 200, epoch: 42 | loss: 0.0532383
	speed: 0.0215s/iter; left time: 279.5005s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0542868 Vali Loss: 0.0543523 Test Loss: 0.0568203
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0568126
	speed: 0.0421s/iter; left time: 542.6577s
	iters: 200, epoch: 43 | loss: 0.0514674
	speed: 0.0215s/iter; left time: 274.9823s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0542430 Vali Loss: 0.0542852 Test Loss: 0.0567927
Validation loss decreased (0.054290 --> 0.054285).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0501885
	speed: 0.0420s/iter; left time: 531.4756s
	iters: 200, epoch: 44 | loss: 0.0552518
	speed: 0.0215s/iter; left time: 270.4604s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0542934 Vali Loss: 0.0543582 Test Loss: 0.0568084
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0562726
	speed: 0.0415s/iter; left time: 515.9442s
	iters: 200, epoch: 45 | loss: 0.0504332
	speed: 0.0215s/iter; left time: 264.9114s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0542283 Vali Loss: 0.0543477 Test Loss: 0.0567937
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0542384
	speed: 0.0414s/iter; left time: 506.4311s
	iters: 200, epoch: 46 | loss: 0.0558192
	speed: 0.0215s/iter; left time: 260.3924s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.01s
Steps: 224 | Train Loss: 0.0542461 Vali Loss: 0.0542401 Test Loss: 0.0567593
Validation loss decreased (0.054285 --> 0.054240).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0504797
	speed: 0.0419s/iter; left time: 502.1016s
	iters: 200, epoch: 47 | loss: 0.0510444
	speed: 0.0215s/iter; left time: 255.4199s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0542229 Vali Loss: 0.0542685 Test Loss: 0.0567701
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0544625
	speed: 0.0417s/iter; left time: 490.3522s
	iters: 200, epoch: 48 | loss: 0.0507336
	speed: 0.0215s/iter; left time: 250.7579s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0542012 Vali Loss: 0.0542531 Test Loss: 0.0567833
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0530913
	speed: 0.0416s/iter; left time: 480.1390s
	iters: 200, epoch: 49 | loss: 0.0551386
	speed: 0.0215s/iter; left time: 246.1235s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0542225 Vali Loss: 0.0543325 Test Loss: 0.0567598
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0575082
	speed: 0.0414s/iter; left time: 469.1199s
	iters: 200, epoch: 50 | loss: 0.0569181
	speed: 0.0215s/iter; left time: 241.6682s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0542435 Vali Loss: 0.0542675 Test Loss: 0.0567403
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0515808
	speed: 0.0416s/iter; left time: 462.1814s
	iters: 200, epoch: 51 | loss: 0.0543517
	speed: 0.0215s/iter; left time: 236.6363s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0541939 Vali Loss: 0.0543161 Test Loss: 0.0567576
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0573124
	speed: 0.0417s/iter; left time: 453.6181s
	iters: 200, epoch: 52 | loss: 0.0572194
	speed: 0.0215s/iter; left time: 231.9103s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.00s
Steps: 224 | Train Loss: 0.0542125 Vali Loss: 0.0542657 Test Loss: 0.0567574
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0548075
	speed: 0.0416s/iter; left time: 443.1604s
	iters: 200, epoch: 53 | loss: 0.0537419
	speed: 0.0215s/iter; left time: 226.5383s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0541289 Vali Loss: 0.0543118 Test Loss: 0.0567842
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0553229
	speed: 0.0416s/iter; left time: 433.7731s
	iters: 200, epoch: 54 | loss: 0.0521511
	speed: 0.0215s/iter; left time: 222.1465s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.99s
Steps: 224 | Train Loss: 0.0541357 Vali Loss: 0.0542761 Test Loss: 0.0567637
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0553007
	speed: 0.0413s/iter; left time: 421.0953s
	iters: 200, epoch: 55 | loss: 0.0530715
	speed: 0.0214s/iter; left time: 216.7450s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.98s
Steps: 224 | Train Loss: 0.0541912 Vali Loss: 0.0542760 Test Loss: 0.0567585
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0504087
	speed: 0.0423s/iter; left time: 422.5515s
	iters: 200, epoch: 56 | loss: 0.0479576
	speed: 0.0215s/iter; left time: 212.3235s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0542497 Vali Loss: 0.0543618 Test Loss: 0.0567582
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010097073391079903, rmse:0.10048419237136841, mae:0.056759271770715714, rse:0.3796803057193756
Intermediate time for IT and pred_len 24: 00h:12m:19.18s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1433646
	speed: 0.0396s/iter; left time: 883.5584s
	iters: 200, epoch: 1 | loss: 0.1212559
	speed: 0.0217s/iter; left time: 482.6808s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.36s
Steps: 224 | Train Loss: 0.1473529 Vali Loss: 0.1059236 Test Loss: 0.1091757
Validation loss decreased (inf --> 0.105924).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0939879
	speed: 0.0447s/iter; left time: 986.7471s
	iters: 200, epoch: 2 | loss: 0.0863891
	speed: 0.0218s/iter; left time: 479.0930s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0960089 Vali Loss: 0.0815498 Test Loss: 0.0867262
Validation loss decreased (0.105924 --> 0.081550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0871378
	speed: 0.0454s/iter; left time: 992.8374s
	iters: 200, epoch: 3 | loss: 0.0831973
	speed: 0.0217s/iter; left time: 472.6139s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0850101 Vali Loss: 0.0794443 Test Loss: 0.0841026
Validation loss decreased (0.081550 --> 0.079444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0812133
	speed: 0.0450s/iter; left time: 973.8450s
	iters: 200, epoch: 4 | loss: 0.0790372
	speed: 0.0216s/iter; left time: 464.3268s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0823363 Vali Loss: 0.0782349 Test Loss: 0.0829694
Validation loss decreased (0.079444 --> 0.078235).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0832534
	speed: 0.0458s/iter; left time: 979.5085s
	iters: 200, epoch: 5 | loss: 0.0769817
	speed: 0.0215s/iter; left time: 458.8911s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0807391 Vali Loss: 0.0775910 Test Loss: 0.0827967
Validation loss decreased (0.078235 --> 0.077591).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0808219
	speed: 0.0448s/iter; left time: 949.2460s
	iters: 200, epoch: 6 | loss: 0.0782687
	speed: 0.0216s/iter; left time: 454.9186s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0796117 Vali Loss: 0.0771666 Test Loss: 0.0820095
Validation loss decreased (0.077591 --> 0.077167).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0812690
	speed: 0.0446s/iter; left time: 934.5929s
	iters: 200, epoch: 7 | loss: 0.0776338
	speed: 0.0218s/iter; left time: 453.9355s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0788419 Vali Loss: 0.0774109 Test Loss: 0.0818435
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0776714
	speed: 0.0450s/iter; left time: 933.4285s
	iters: 200, epoch: 8 | loss: 0.0733576
	speed: 0.0216s/iter; left time: 445.8140s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0782516 Vali Loss: 0.0767141 Test Loss: 0.0815252
Validation loss decreased (0.077167 --> 0.076714).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0766985
	speed: 0.0454s/iter; left time: 930.1062s
	iters: 200, epoch: 9 | loss: 0.0736232
	speed: 0.0217s/iter; left time: 443.0458s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0776290 Vali Loss: 0.0765005 Test Loss: 0.0814253
Validation loss decreased (0.076714 --> 0.076500).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0748372
	speed: 0.0465s/iter; left time: 942.5729s
	iters: 200, epoch: 10 | loss: 0.0812864
	speed: 0.0220s/iter; left time: 443.2530s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.17s
Steps: 224 | Train Loss: 0.0771783 Vali Loss: 0.0761293 Test Loss: 0.0814734
Validation loss decreased (0.076500 --> 0.076129).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0786125
	speed: 0.0457s/iter; left time: 916.0055s
	iters: 200, epoch: 11 | loss: 0.0764634
	speed: 0.0217s/iter; left time: 432.7599s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0767350 Vali Loss: 0.0762045 Test Loss: 0.0813731
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0778665
	speed: 0.0461s/iter; left time: 914.5062s
	iters: 200, epoch: 12 | loss: 0.0785554
	speed: 0.0219s/iter; left time: 431.6292s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.20s
Steps: 224 | Train Loss: 0.0763418 Vali Loss: 0.0763918 Test Loss: 0.0808504
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0762286
	speed: 0.0454s/iter; left time: 890.5104s
	iters: 200, epoch: 13 | loss: 0.0784456
	speed: 0.0216s/iter; left time: 421.6291s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0759782 Vali Loss: 0.0761209 Test Loss: 0.0813225
Validation loss decreased (0.076129 --> 0.076121).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0739343
	speed: 0.0459s/iter; left time: 889.8396s
	iters: 200, epoch: 14 | loss: 0.0739252
	speed: 0.0216s/iter; left time: 416.6262s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0757679 Vali Loss: 0.0759335 Test Loss: 0.0811224
Validation loss decreased (0.076121 --> 0.075933).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0749016
	speed: 0.0454s/iter; left time: 870.4722s
	iters: 200, epoch: 15 | loss: 0.0770666
	speed: 0.0217s/iter; left time: 412.9967s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0754548 Vali Loss: 0.0756607 Test Loss: 0.0810303
Validation loss decreased (0.075933 --> 0.075661).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0806594
	speed: 0.0453s/iter; left time: 857.2411s
	iters: 200, epoch: 16 | loss: 0.0761695
	speed: 0.0216s/iter; left time: 406.5796s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0751871 Vali Loss: 0.0757019 Test Loss: 0.0809847
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0746581
	speed: 0.0446s/iter; left time: 834.3823s
	iters: 200, epoch: 17 | loss: 0.0754967
	speed: 0.0218s/iter; left time: 405.2360s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.14s
Steps: 224 | Train Loss: 0.0749323 Vali Loss: 0.0758358 Test Loss: 0.0809507
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0732008
	speed: 0.0445s/iter; left time: 823.2419s
	iters: 200, epoch: 18 | loss: 0.0779007
	speed: 0.0216s/iter; left time: 397.2237s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0747036 Vali Loss: 0.0759469 Test Loss: 0.0809412
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0724184
	speed: 0.0444s/iter; left time: 811.3415s
	iters: 200, epoch: 19 | loss: 0.0737137
	speed: 0.0216s/iter; left time: 391.6548s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0745281 Vali Loss: 0.0757514 Test Loss: 0.0808921
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0718322
	speed: 0.0444s/iter; left time: 801.2356s
	iters: 200, epoch: 20 | loss: 0.0762629
	speed: 0.0216s/iter; left time: 387.3810s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0743800 Vali Loss: 0.0755283 Test Loss: 0.0808734
Validation loss decreased (0.075661 --> 0.075528).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0759146
	speed: 0.0451s/iter; left time: 803.2794s
	iters: 200, epoch: 21 | loss: 0.0684599
	speed: 0.0215s/iter; left time: 381.7425s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0742292 Vali Loss: 0.0756518 Test Loss: 0.0808270
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0738885
	speed: 0.0440s/iter; left time: 774.9254s
	iters: 200, epoch: 22 | loss: 0.0745332
	speed: 0.0216s/iter; left time: 377.2442s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0740918 Vali Loss: 0.0756381 Test Loss: 0.0808619
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0729938
	speed: 0.0443s/iter; left time: 769.2571s
	iters: 200, epoch: 23 | loss: 0.0732825
	speed: 0.0216s/iter; left time: 372.5277s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0739742 Vali Loss: 0.0756273 Test Loss: 0.0809168
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0743445
	speed: 0.0443s/iter; left time: 760.3355s
	iters: 200, epoch: 24 | loss: 0.0705981
	speed: 0.0216s/iter; left time: 367.6034s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0738092 Vali Loss: 0.0755313 Test Loss: 0.0807313
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0738085
	speed: 0.0440s/iter; left time: 744.3838s
	iters: 200, epoch: 25 | loss: 0.0721504
	speed: 0.0215s/iter; left time: 361.4061s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0737232 Vali Loss: 0.0755362 Test Loss: 0.0807986
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0731233
	speed: 0.0442s/iter; left time: 738.4531s
	iters: 200, epoch: 26 | loss: 0.0758551
	speed: 0.0215s/iter; left time: 356.8143s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0736521 Vali Loss: 0.0756361 Test Loss: 0.0806783
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0743266
	speed: 0.0438s/iter; left time: 720.8751s
	iters: 200, epoch: 27 | loss: 0.0698974
	speed: 0.0215s/iter; left time: 352.4714s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0735762 Vali Loss: 0.0754788 Test Loss: 0.0807603
Validation loss decreased (0.075528 --> 0.075479).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0751837
	speed: 0.0452s/iter; left time: 734.6244s
	iters: 200, epoch: 28 | loss: 0.0731141
	speed: 0.0217s/iter; left time: 350.6079s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.13s
Steps: 224 | Train Loss: 0.0735002 Vali Loss: 0.0754889 Test Loss: 0.0807897
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0751689
	speed: 0.0441s/iter; left time: 706.3757s
	iters: 200, epoch: 29 | loss: 0.0736159
	speed: 0.0216s/iter; left time: 343.3696s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0734566 Vali Loss: 0.0755240 Test Loss: 0.0807610
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0738715
	speed: 0.0441s/iter; left time: 697.2098s
	iters: 200, epoch: 30 | loss: 0.0719647
	speed: 0.0215s/iter; left time: 337.7713s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0733744 Vali Loss: 0.0754651 Test Loss: 0.0807601
Validation loss decreased (0.075479 --> 0.075465).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0729038
	speed: 0.0446s/iter; left time: 694.8872s
	iters: 200, epoch: 31 | loss: 0.0689847
	speed: 0.0215s/iter; left time: 332.8390s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0733588 Vali Loss: 0.0753535 Test Loss: 0.0807255
Validation loss decreased (0.075465 --> 0.075353).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0745260
	speed: 0.0449s/iter; left time: 689.1201s
	iters: 200, epoch: 32 | loss: 0.0766175
	speed: 0.0215s/iter; left time: 328.4274s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0733026 Vali Loss: 0.0754213 Test Loss: 0.0807602
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0729493
	speed: 0.0438s/iter; left time: 662.3797s
	iters: 200, epoch: 33 | loss: 0.0766584
	speed: 0.0215s/iter; left time: 323.7146s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0732236 Vali Loss: 0.0754487 Test Loss: 0.0807684
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0716890
	speed: 0.0443s/iter; left time: 660.8058s
	iters: 200, epoch: 34 | loss: 0.0735889
	speed: 0.0216s/iter; left time: 319.4177s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0732531 Vali Loss: 0.0754548 Test Loss: 0.0806353
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0696270
	speed: 0.0449s/iter; left time: 659.7019s
	iters: 200, epoch: 35 | loss: 0.0766874
	speed: 0.0216s/iter; left time: 315.3485s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0731100 Vali Loss: 0.0755045 Test Loss: 0.0807201
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0703087
	speed: 0.0442s/iter; left time: 638.5704s
	iters: 200, epoch: 36 | loss: 0.0714593
	speed: 0.0216s/iter; left time: 309.9927s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0731055 Vali Loss: 0.0754781 Test Loss: 0.0806610
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0758762
	speed: 0.0444s/iter; left time: 631.4376s
	iters: 200, epoch: 37 | loss: 0.0731670
	speed: 0.0216s/iter; left time: 305.9892s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0731075 Vali Loss: 0.0754173 Test Loss: 0.0806954
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0697639
	speed: 0.0441s/iter; left time: 617.8716s
	iters: 200, epoch: 38 | loss: 0.0755937
	speed: 0.0218s/iter; left time: 303.0889s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0731257 Vali Loss: 0.0754439 Test Loss: 0.0806976
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0759557
	speed: 0.0453s/iter; left time: 624.1583s
	iters: 200, epoch: 39 | loss: 0.0707281
	speed: 0.0216s/iter; left time: 296.0278s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0729984 Vali Loss: 0.0753766 Test Loss: 0.0807144
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0764052
	speed: 0.0443s/iter; left time: 601.1612s
	iters: 200, epoch: 40 | loss: 0.0715780
	speed: 0.0216s/iter; left time: 290.4915s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0729825 Vali Loss: 0.0754518 Test Loss: 0.0807007
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0715062
	speed: 0.0439s/iter; left time: 585.4115s
	iters: 200, epoch: 41 | loss: 0.0701509
	speed: 0.0215s/iter; left time: 284.6419s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0730492 Vali Loss: 0.0754098 Test Loss: 0.0807260
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01877465285360813, rmse:0.13702063262462616, mae:0.0807255357503891, rse:0.518089771270752
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1459661
	speed: 0.0238s/iter; left time: 530.4907s
	iters: 200, epoch: 1 | loss: 0.1247804
	speed: 0.0217s/iter; left time: 481.9811s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.1497117 Vali Loss: 0.1045378 Test Loss: 0.1075363
Validation loss decreased (inf --> 0.104538).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0922936
	speed: 0.0450s/iter; left time: 994.3522s
	iters: 200, epoch: 2 | loss: 0.0891406
	speed: 0.0215s/iter; left time: 473.4116s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0954378 Vali Loss: 0.0816565 Test Loss: 0.0866409
Validation loss decreased (0.104538 --> 0.081656).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0853540
	speed: 0.0439s/iter; left time: 958.4826s
	iters: 200, epoch: 3 | loss: 0.0826844
	speed: 0.0215s/iter; left time: 467.3468s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0847442 Vali Loss: 0.0796094 Test Loss: 0.0843733
Validation loss decreased (0.081656 --> 0.079609).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0833012
	speed: 0.0440s/iter; left time: 950.7788s
	iters: 200, epoch: 4 | loss: 0.0823414
	speed: 0.0215s/iter; left time: 463.4647s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0823746 Vali Loss: 0.0784748 Test Loss: 0.0831609
Validation loss decreased (0.079609 --> 0.078475).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0836823
	speed: 0.0436s/iter; left time: 933.7550s
	iters: 200, epoch: 5 | loss: 0.0796879
	speed: 0.0215s/iter; left time: 458.7642s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.04s
Steps: 224 | Train Loss: 0.0807883 Vali Loss: 0.0778282 Test Loss: 0.0820207
Validation loss decreased (0.078475 --> 0.077828).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0791352
	speed: 0.0451s/iter; left time: 954.7004s
	iters: 200, epoch: 6 | loss: 0.0799545
	speed: 0.0216s/iter; left time: 454.8990s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0796759 Vali Loss: 0.0770614 Test Loss: 0.0820792
Validation loss decreased (0.077828 --> 0.077061).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0798625
	speed: 0.0451s/iter; left time: 944.7145s
	iters: 200, epoch: 7 | loss: 0.0812351
	speed: 0.0216s/iter; left time: 450.1130s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0788559 Vali Loss: 0.0769180 Test Loss: 0.0818045
Validation loss decreased (0.077061 --> 0.076918).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0809850
	speed: 0.0448s/iter; left time: 929.5170s
	iters: 200, epoch: 8 | loss: 0.0805078
	speed: 0.0216s/iter; left time: 444.8003s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0781953 Vali Loss: 0.0767658 Test Loss: 0.0813461
Validation loss decreased (0.076918 --> 0.076766).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0786429
	speed: 0.0449s/iter; left time: 921.5056s
	iters: 200, epoch: 9 | loss: 0.0787557
	speed: 0.0217s/iter; left time: 442.3699s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0777116 Vali Loss: 0.0766431 Test Loss: 0.0813732
Validation loss decreased (0.076766 --> 0.076643).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0710135
	speed: 0.0454s/iter; left time: 921.2600s
	iters: 200, epoch: 10 | loss: 0.0788388
	speed: 0.0216s/iter; left time: 436.6626s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0772423 Vali Loss: 0.0764634 Test Loss: 0.0812182
Validation loss decreased (0.076643 --> 0.076463).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0754263
	speed: 0.0450s/iter; left time: 902.1501s
	iters: 200, epoch: 11 | loss: 0.0782367
	speed: 0.0219s/iter; left time: 436.7478s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0767409 Vali Loss: 0.0766913 Test Loss: 0.0811143
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0721509
	speed: 0.0444s/iter; left time: 879.9076s
	iters: 200, epoch: 12 | loss: 0.0761303
	speed: 0.0217s/iter; left time: 427.5108s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0764047 Vali Loss: 0.0762266 Test Loss: 0.0809278
Validation loss decreased (0.076463 --> 0.076227).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0755092
	speed: 0.0452s/iter; left time: 887.3947s
	iters: 200, epoch: 13 | loss: 0.0821566
	speed: 0.0215s/iter; left time: 419.9382s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0761268 Vali Loss: 0.0763812 Test Loss: 0.0809663
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0770738
	speed: 0.0440s/iter; left time: 852.5639s
	iters: 200, epoch: 14 | loss: 0.0739617
	speed: 0.0216s/iter; left time: 417.2313s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0757809 Vali Loss: 0.0760833 Test Loss: 0.0813010
Validation loss decreased (0.076227 --> 0.076083).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0753371
	speed: 0.0467s/iter; left time: 895.2428s
	iters: 200, epoch: 15 | loss: 0.0721794
	speed: 0.0216s/iter; left time: 412.4271s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0754893 Vali Loss: 0.0766485 Test Loss: 0.0808966
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0714540
	speed: 0.0441s/iter; left time: 835.2408s
	iters: 200, epoch: 16 | loss: 0.0698306
	speed: 0.0216s/iter; left time: 407.0423s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0752596 Vali Loss: 0.0760262 Test Loss: 0.0809308
Validation loss decreased (0.076083 --> 0.076026).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0736729
	speed: 0.0452s/iter; left time: 845.4754s
	iters: 200, epoch: 17 | loss: 0.0726572
	speed: 0.0217s/iter; left time: 403.1827s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0750120 Vali Loss: 0.0761923 Test Loss: 0.0809701
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0712701
	speed: 0.0444s/iter; left time: 821.9156s
	iters: 200, epoch: 18 | loss: 0.0761875
	speed: 0.0216s/iter; left time: 397.8432s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0748339 Vali Loss: 0.0759431 Test Loss: 0.0810259
Validation loss decreased (0.076026 --> 0.075943).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0756008
	speed: 0.0448s/iter; left time: 818.3437s
	iters: 200, epoch: 19 | loss: 0.0748152
	speed: 0.0216s/iter; left time: 392.1397s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0745641 Vali Loss: 0.0760044 Test Loss: 0.0807937
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0730420
	speed: 0.0441s/iter; left time: 795.3639s
	iters: 200, epoch: 20 | loss: 0.0788026
	speed: 0.0217s/iter; left time: 388.7969s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0744072 Vali Loss: 0.0759645 Test Loss: 0.0807254
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0724824
	speed: 0.0442s/iter; left time: 787.9841s
	iters: 200, epoch: 21 | loss: 0.0685167
	speed: 0.0215s/iter; left time: 381.5861s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0742567 Vali Loss: 0.0760825 Test Loss: 0.0808017
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0752234
	speed: 0.0443s/iter; left time: 778.9897s
	iters: 200, epoch: 22 | loss: 0.0743604
	speed: 0.0215s/iter; left time: 376.8833s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0741405 Vali Loss: 0.0760217 Test Loss: 0.0810972
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0794114
	speed: 0.0442s/iter; left time: 767.4136s
	iters: 200, epoch: 23 | loss: 0.0742750
	speed: 0.0216s/iter; left time: 372.4211s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0739611 Vali Loss: 0.0759342 Test Loss: 0.0811735
Validation loss decreased (0.075943 --> 0.075934).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0722461
	speed: 0.0444s/iter; left time: 761.7404s
	iters: 200, epoch: 24 | loss: 0.0766169
	speed: 0.0216s/iter; left time: 368.5625s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0738680 Vali Loss: 0.0759995 Test Loss: 0.0809578
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0729570
	speed: 0.0434s/iter; left time: 734.0077s
	iters: 200, epoch: 25 | loss: 0.0751325
	speed: 0.0215s/iter; left time: 361.7003s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.02s
Steps: 224 | Train Loss: 0.0736850 Vali Loss: 0.0759854 Test Loss: 0.0808261
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0704323
	speed: 0.0440s/iter; left time: 735.3478s
	iters: 200, epoch: 26 | loss: 0.0739287
	speed: 0.0216s/iter; left time: 358.1103s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0736199 Vali Loss: 0.0759113 Test Loss: 0.0809045
Validation loss decreased (0.075934 --> 0.075911).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0719385
	speed: 0.0445s/iter; left time: 732.8572s
	iters: 200, epoch: 27 | loss: 0.0725750
	speed: 0.0217s/iter; left time: 354.6773s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0735830 Vali Loss: 0.0758279 Test Loss: 0.0809759
Validation loss decreased (0.075911 --> 0.075828).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0707296
	speed: 0.0455s/iter; left time: 739.4164s
	iters: 200, epoch: 28 | loss: 0.0734240
	speed: 0.0217s/iter; left time: 350.1680s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.12s
Steps: 224 | Train Loss: 0.0734927 Vali Loss: 0.0758452 Test Loss: 0.0809245
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0731072
	speed: 0.0449s/iter; left time: 719.7978s
	iters: 200, epoch: 29 | loss: 0.0747297
	speed: 0.0217s/iter; left time: 345.7336s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.11s
Steps: 224 | Train Loss: 0.0734539 Vali Loss: 0.0759566 Test Loss: 0.0809012
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0740424
	speed: 0.0447s/iter; left time: 706.4403s
	iters: 200, epoch: 30 | loss: 0.0736557
	speed: 0.0217s/iter; left time: 340.4687s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0733408 Vali Loss: 0.0758856 Test Loss: 0.0808438
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0765026
	speed: 0.0448s/iter; left time: 698.1295s
	iters: 200, epoch: 31 | loss: 0.0730270
	speed: 0.0217s/iter; left time: 336.1496s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0733982 Vali Loss: 0.0760393 Test Loss: 0.0810511
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0693656
	speed: 0.0446s/iter; left time: 684.5233s
	iters: 200, epoch: 32 | loss: 0.0756437
	speed: 0.0216s/iter; left time: 329.2918s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0732387 Vali Loss: 0.0758144 Test Loss: 0.0808302
Validation loss decreased (0.075828 --> 0.075814).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0725168
	speed: 0.0445s/iter; left time: 673.6662s
	iters: 200, epoch: 33 | loss: 0.0727527
	speed: 0.0217s/iter; left time: 326.1156s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.10s
Steps: 224 | Train Loss: 0.0732370 Vali Loss: 0.0758342 Test Loss: 0.0808924
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0726183
	speed: 0.0443s/iter; left time: 660.5687s
	iters: 200, epoch: 34 | loss: 0.0718975
	speed: 0.0215s/iter; left time: 318.6039s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0731928 Vali Loss: 0.0758730 Test Loss: 0.0809621
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0732121
	speed: 0.0443s/iter; left time: 649.8964s
	iters: 200, epoch: 35 | loss: 0.0792854
	speed: 0.0215s/iter; left time: 313.5885s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0731534 Vali Loss: 0.0758523 Test Loss: 0.0808746
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0767604
	speed: 0.0447s/iter; left time: 646.5360s
	iters: 200, epoch: 36 | loss: 0.0714889
	speed: 0.0216s/iter; left time: 310.0072s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.09s
Steps: 224 | Train Loss: 0.0731052 Vali Loss: 0.0759114 Test Loss: 0.0809736
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0725162
	speed: 0.0446s/iter; left time: 635.6777s
	iters: 200, epoch: 37 | loss: 0.0772842
	speed: 0.0216s/iter; left time: 304.9747s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0730758 Vali Loss: 0.0759069 Test Loss: 0.0809573
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0702892
	speed: 0.0442s/iter; left time: 619.5411s
	iters: 200, epoch: 38 | loss: 0.0715920
	speed: 0.0216s/iter; left time: 300.1794s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.06s
Steps: 224 | Train Loss: 0.0730808 Vali Loss: 0.0759352 Test Loss: 0.0809955
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0763620
	speed: 0.0443s/iter; left time: 610.4583s
	iters: 200, epoch: 39 | loss: 0.0723274
	speed: 0.0216s/iter; left time: 295.1773s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.08s
Steps: 224 | Train Loss: 0.0730353 Vali Loss: 0.0758699 Test Loss: 0.0809455
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0750282
	speed: 0.0440s/iter; left time: 596.3260s
	iters: 200, epoch: 40 | loss: 0.0713875
	speed: 0.0215s/iter; left time: 289.5588s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.05s
Steps: 224 | Train Loss: 0.0730155 Vali Loss: 0.0758716 Test Loss: 0.0809301
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0756813
	speed: 0.0441s/iter; left time: 588.3404s
	iters: 200, epoch: 41 | loss: 0.0719113
	speed: 0.0216s/iter; left time: 285.7325s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.07s
Steps: 224 | Train Loss: 0.0730196 Vali Loss: 0.0758215 Test Loss: 0.0809334
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0682350
	speed: 0.0457s/iter; left time: 599.4794s
	iters: 200, epoch: 42 | loss: 0.0718109
	speed: 0.0217s/iter; left time: 282.4141s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.15s
Steps: 224 | Train Loss: 0.0729887 Vali Loss: 0.0758464 Test Loss: 0.0808992
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018875500187277794, rmse:0.13738813996315002, mae:0.0808301791548729, rse:0.5194793939590454
Intermediate time for IT and pred_len 96: 00h:09m:19.35s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1422332
	speed: 0.0399s/iter; left time: 886.8707s
	iters: 200, epoch: 1 | loss: 0.1238884
	speed: 0.0219s/iter; left time: 483.5416s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.38s
Steps: 223 | Train Loss: 0.1487401 Vali Loss: 0.1078035 Test Loss: 0.1103905
Validation loss decreased (inf --> 0.107803).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0940611
	speed: 0.0454s/iter; left time: 998.2888s
	iters: 200, epoch: 2 | loss: 0.0890768
	speed: 0.0219s/iter; left time: 478.0421s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0993934 Vali Loss: 0.0859923 Test Loss: 0.0905826
Validation loss decreased (0.107803 --> 0.085992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0923032
	speed: 0.0459s/iter; left time: 997.6045s
	iters: 200, epoch: 3 | loss: 0.0874902
	speed: 0.0237s/iter; left time: 513.9038s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.36s
Steps: 223 | Train Loss: 0.0890220 Vali Loss: 0.0842793 Test Loss: 0.0879501
Validation loss decreased (0.085992 --> 0.084279).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0876270
	speed: 0.0458s/iter; left time: 985.8983s
	iters: 200, epoch: 4 | loss: 0.0905795
	speed: 0.0219s/iter; left time: 469.1330s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0863606 Vali Loss: 0.0836341 Test Loss: 0.0876986
Validation loss decreased (0.084279 --> 0.083634).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0825929
	speed: 0.0456s/iter; left time: 972.3481s
	iters: 200, epoch: 5 | loss: 0.0831351
	speed: 0.0220s/iter; left time: 465.6625s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0848012 Vali Loss: 0.0826763 Test Loss: 0.0874410
Validation loss decreased (0.083634 --> 0.082676).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0816155
	speed: 0.0463s/iter; left time: 977.2034s
	iters: 200, epoch: 6 | loss: 0.0854807
	speed: 0.0218s/iter; left time: 457.2756s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0836772 Vali Loss: 0.0822454 Test Loss: 0.0871060
Validation loss decreased (0.082676 --> 0.082245).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0834205
	speed: 0.0473s/iter; left time: 987.2922s
	iters: 200, epoch: 7 | loss: 0.0846652
	speed: 0.0221s/iter; left time: 458.6449s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0827792 Vali Loss: 0.0820543 Test Loss: 0.0869830
Validation loss decreased (0.082245 --> 0.082054).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0821114
	speed: 0.0456s/iter; left time: 940.2727s
	iters: 200, epoch: 8 | loss: 0.0795568
	speed: 0.0221s/iter; left time: 453.9705s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0820239 Vali Loss: 0.0822160 Test Loss: 0.0872677
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0793278
	speed: 0.0458s/iter; left time: 935.4193s
	iters: 200, epoch: 9 | loss: 0.0779528
	speed: 0.0220s/iter; left time: 447.4413s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.18s
Steps: 223 | Train Loss: 0.0814570 Vali Loss: 0.0815587 Test Loss: 0.0868244
Validation loss decreased (0.082054 --> 0.081559).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0797524
	speed: 0.0465s/iter; left time: 938.7565s
	iters: 200, epoch: 10 | loss: 0.0822584
	speed: 0.0220s/iter; left time: 442.9091s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0809885 Vali Loss: 0.0817687 Test Loss: 0.0867201
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0819538
	speed: 0.0453s/iter; left time: 904.9837s
	iters: 200, epoch: 11 | loss: 0.0759394
	speed: 0.0220s/iter; left time: 437.3079s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0805481 Vali Loss: 0.0817018 Test Loss: 0.0869889
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0789934
	speed: 0.0452s/iter; left time: 893.5277s
	iters: 200, epoch: 12 | loss: 0.0801707
	speed: 0.0219s/iter; left time: 430.5363s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0801772 Vali Loss: 0.0817279 Test Loss: 0.0872964
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0786303
	speed: 0.0449s/iter; left time: 876.7168s
	iters: 200, epoch: 13 | loss: 0.0803329
	speed: 0.0219s/iter; left time: 425.8500s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0798334 Vali Loss: 0.0814555 Test Loss: 0.0870952
Validation loss decreased (0.081559 --> 0.081455).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0780716
	speed: 0.0458s/iter; left time: 884.1649s
	iters: 200, epoch: 14 | loss: 0.0795619
	speed: 0.0220s/iter; left time: 421.4865s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0794957 Vali Loss: 0.0816452 Test Loss: 0.0867981
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0795415
	speed: 0.0450s/iter; left time: 858.0287s
	iters: 200, epoch: 15 | loss: 0.0837863
	speed: 0.0219s/iter; left time: 414.8105s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0792260 Vali Loss: 0.0814669 Test Loss: 0.0866738
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0800886
	speed: 0.0447s/iter; left time: 841.9538s
	iters: 200, epoch: 16 | loss: 0.0797749
	speed: 0.0218s/iter; left time: 409.0825s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0790012 Vali Loss: 0.0815702 Test Loss: 0.0869253
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0799048
	speed: 0.0444s/iter; left time: 828.0382s
	iters: 200, epoch: 17 | loss: 0.0763827
	speed: 0.0220s/iter; left time: 407.6016s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0787813 Vali Loss: 0.0814374 Test Loss: 0.0867984
Validation loss decreased (0.081455 --> 0.081437).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0748992
	speed: 0.0459s/iter; left time: 844.7253s
	iters: 200, epoch: 18 | loss: 0.0801806
	speed: 0.0220s/iter; left time: 402.6889s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0785796 Vali Loss: 0.0816491 Test Loss: 0.0868996
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0780893
	speed: 0.0453s/iter; left time: 824.0955s
	iters: 200, epoch: 19 | loss: 0.0778928
	speed: 0.0219s/iter; left time: 396.1936s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0783676 Vali Loss: 0.0812692 Test Loss: 0.0866233
Validation loss decreased (0.081437 --> 0.081269).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0799072
	speed: 0.0459s/iter; left time: 824.4706s
	iters: 200, epoch: 20 | loss: 0.0745044
	speed: 0.0220s/iter; left time: 393.8355s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0780941 Vali Loss: 0.0815039 Test Loss: 0.0868427
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0801952
	speed: 0.0448s/iter; left time: 794.7760s
	iters: 200, epoch: 21 | loss: 0.0782417
	speed: 0.0220s/iter; left time: 388.7993s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0779266 Vali Loss: 0.0813523 Test Loss: 0.0868977
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0801301
	speed: 0.0447s/iter; left time: 782.8674s
	iters: 200, epoch: 22 | loss: 0.0788175
	speed: 0.0219s/iter; left time: 381.9170s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0777915 Vali Loss: 0.0812905 Test Loss: 0.0869912
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0740311
	speed: 0.0447s/iter; left time: 773.8720s
	iters: 200, epoch: 23 | loss: 0.0786226
	speed: 0.0220s/iter; left time: 378.5962s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0777073 Vali Loss: 0.0813419 Test Loss: 0.0869643
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0794018
	speed: 0.0445s/iter; left time: 760.4558s
	iters: 200, epoch: 24 | loss: 0.0760033
	speed: 0.0220s/iter; left time: 373.6216s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0775662 Vali Loss: 0.0813689 Test Loss: 0.0866420
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0771687
	speed: 0.0445s/iter; left time: 750.2550s
	iters: 200, epoch: 25 | loss: 0.0770259
	speed: 0.0219s/iter; left time: 367.4685s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0774627 Vali Loss: 0.0812513 Test Loss: 0.0867676
Validation loss decreased (0.081269 --> 0.081251).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0801990
	speed: 0.0474s/iter; left time: 788.5953s
	iters: 200, epoch: 26 | loss: 0.0770016
	speed: 0.0220s/iter; left time: 363.8711s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0772641 Vali Loss: 0.0813442 Test Loss: 0.0867389
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0746478
	speed: 0.0451s/iter; left time: 739.3783s
	iters: 200, epoch: 27 | loss: 0.0811946
	speed: 0.0220s/iter; left time: 358.1568s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0771851 Vali Loss: 0.0813397 Test Loss: 0.0868592
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0765276
	speed: 0.0449s/iter; left time: 726.9303s
	iters: 200, epoch: 28 | loss: 0.0778756
	speed: 0.0222s/iter; left time: 357.0485s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.21s
Steps: 223 | Train Loss: 0.0771561 Vali Loss: 0.0812759 Test Loss: 0.0867207
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0758748
	speed: 0.0447s/iter; left time: 712.9911s
	iters: 200, epoch: 29 | loss: 0.0761895
	speed: 0.0219s/iter; left time: 347.0289s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.0770699 Vali Loss: 0.0811767 Test Loss: 0.0867977
Validation loss decreased (0.081251 --> 0.081177).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0772767
	speed: 0.0451s/iter; left time: 709.5823s
	iters: 200, epoch: 30 | loss: 0.0799395
	speed: 0.0219s/iter; left time: 342.8088s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0770043 Vali Loss: 0.0813326 Test Loss: 0.0865817
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0787377
	speed: 0.0459s/iter; left time: 711.6382s
	iters: 200, epoch: 31 | loss: 0.0790349
	speed: 0.0219s/iter; left time: 337.3552s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.23s
Steps: 223 | Train Loss: 0.0769014 Vali Loss: 0.0812479 Test Loss: 0.0867099
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0753271
	speed: 0.0443s/iter; left time: 677.0274s
	iters: 200, epoch: 32 | loss: 0.0772528
	speed: 0.0219s/iter; left time: 333.3321s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0768442 Vali Loss: 0.0812564 Test Loss: 0.0866655
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0767389
	speed: 0.0446s/iter; left time: 672.2992s
	iters: 200, epoch: 33 | loss: 0.0774172
	speed: 0.0219s/iter; left time: 328.0475s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0767227 Vali Loss: 0.0813379 Test Loss: 0.0866511
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0754764
	speed: 0.0442s/iter; left time: 655.3952s
	iters: 200, epoch: 34 | loss: 0.0783910
	speed: 0.0219s/iter; left time: 322.1314s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0767627 Vali Loss: 0.0813302 Test Loss: 0.0867717
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0773165
	speed: 0.0438s/iter; left time: 639.9556s
	iters: 200, epoch: 35 | loss: 0.0745113
	speed: 0.0219s/iter; left time: 318.2154s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0767981 Vali Loss: 0.0813389 Test Loss: 0.0866733
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0755355
	speed: 0.0438s/iter; left time: 629.9587s
	iters: 200, epoch: 36 | loss: 0.0780581
	speed: 0.0219s/iter; left time: 312.6311s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0767315 Vali Loss: 0.0813711 Test Loss: 0.0866041
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0764991
	speed: 0.0449s/iter; left time: 636.6586s
	iters: 200, epoch: 37 | loss: 0.0770552
	speed: 0.0218s/iter; left time: 307.1707s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0767122 Vali Loss: 0.0813273 Test Loss: 0.0865649
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0769197
	speed: 0.0441s/iter; left time: 614.9343s
	iters: 200, epoch: 38 | loss: 0.0761648
	speed: 0.0220s/iter; left time: 304.8882s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0765907 Vali Loss: 0.0812972 Test Loss: 0.0866962
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0768745
	speed: 0.0440s/iter; left time: 603.7136s
	iters: 200, epoch: 39 | loss: 0.0779365
	speed: 0.0218s/iter; left time: 297.7301s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0765878 Vali Loss: 0.0812177 Test Loss: 0.0865234
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02091139554977417, rmse:0.14460772275924683, mae:0.08679766952991486, rse:0.5472854971885681
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1444802
	speed: 0.0241s/iter; left time: 535.4018s
	iters: 200, epoch: 1 | loss: 0.1274032
	speed: 0.0221s/iter; left time: 489.4469s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.17s
Steps: 223 | Train Loss: 0.1514145 Vali Loss: 0.1083492 Test Loss: 0.1111078
Validation loss decreased (inf --> 0.108349).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0961300
	speed: 0.0452s/iter; left time: 994.0226s
	iters: 200, epoch: 2 | loss: 0.0944361
	speed: 0.0221s/iter; left time: 483.8187s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0995450 Vali Loss: 0.0859833 Test Loss: 0.0903506
Validation loss decreased (0.108349 --> 0.085983).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0907044
	speed: 0.0451s/iter; left time: 981.6929s
	iters: 200, epoch: 3 | loss: 0.0892267
	speed: 0.0219s/iter; left time: 473.2063s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0890871 Vali Loss: 0.0844950 Test Loss: 0.0889018
Validation loss decreased (0.085983 --> 0.084495).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0917593
	speed: 0.0441s/iter; left time: 949.8181s
	iters: 200, epoch: 4 | loss: 0.0846317
	speed: 0.0219s/iter; left time: 468.5970s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0866461 Vali Loss: 0.0837718 Test Loss: 0.0880020
Validation loss decreased (0.084495 --> 0.083772).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0876566
	speed: 0.0447s/iter; left time: 952.4333s
	iters: 200, epoch: 5 | loss: 0.0873978
	speed: 0.0219s/iter; left time: 463.4345s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0851161 Vali Loss: 0.0829871 Test Loss: 0.0874617
Validation loss decreased (0.083772 --> 0.082987).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0838045
	speed: 0.0454s/iter; left time: 957.7707s
	iters: 200, epoch: 6 | loss: 0.0822688
	speed: 0.0219s/iter; left time: 459.2941s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0838960 Vali Loss: 0.0824548 Test Loss: 0.0872725
Validation loss decreased (0.082987 --> 0.082455).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0808098
	speed: 0.0438s/iter; left time: 913.7085s
	iters: 200, epoch: 7 | loss: 0.0848828
	speed: 0.0218s/iter; left time: 453.6563s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0829809 Vali Loss: 0.0823142 Test Loss: 0.0876282
Validation loss decreased (0.082455 --> 0.082314).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0803695
	speed: 0.0448s/iter; left time: 925.1910s
	iters: 200, epoch: 8 | loss: 0.0818768
	speed: 0.0218s/iter; left time: 448.7989s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0822305 Vali Loss: 0.0820228 Test Loss: 0.0876478
Validation loss decreased (0.082314 --> 0.082023).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0808091
	speed: 0.0456s/iter; left time: 930.3121s
	iters: 200, epoch: 9 | loss: 0.0799001
	speed: 0.0219s/iter; left time: 445.4990s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0816215 Vali Loss: 0.0818808 Test Loss: 0.0880365
Validation loss decreased (0.082023 --> 0.081881).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0800510
	speed: 0.0455s/iter; left time: 918.6607s
	iters: 200, epoch: 10 | loss: 0.0785952
	speed: 0.0221s/iter; left time: 444.0308s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0809574 Vali Loss: 0.0814812 Test Loss: 0.0875988
Validation loss decreased (0.081881 --> 0.081481).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0783685
	speed: 0.0446s/iter; left time: 891.5125s
	iters: 200, epoch: 11 | loss: 0.0788870
	speed: 0.0219s/iter; left time: 434.9833s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0805099 Vali Loss: 0.0819037 Test Loss: 0.0877739
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0827774
	speed: 0.0436s/iter; left time: 860.1043s
	iters: 200, epoch: 12 | loss: 0.0778639
	speed: 0.0221s/iter; left time: 433.8886s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0800791 Vali Loss: 0.0813280 Test Loss: 0.0874974
Validation loss decreased (0.081481 --> 0.081328).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0845484
	speed: 0.0449s/iter; left time: 876.4750s
	iters: 200, epoch: 13 | loss: 0.0799853
	speed: 0.0219s/iter; left time: 424.5954s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0797862 Vali Loss: 0.0816054 Test Loss: 0.0877575
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0744464
	speed: 0.0436s/iter; left time: 840.9424s
	iters: 200, epoch: 14 | loss: 0.0774216
	speed: 0.0219s/iter; left time: 420.0801s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0794795 Vali Loss: 0.0813056 Test Loss: 0.0879064
Validation loss decreased (0.081328 --> 0.081306).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0788057
	speed: 0.0447s/iter; left time: 852.6139s
	iters: 200, epoch: 15 | loss: 0.0765797
	speed: 0.0218s/iter; left time: 414.6648s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0791673 Vali Loss: 0.0811152 Test Loss: 0.0876386
Validation loss decreased (0.081306 --> 0.081115).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0807921
	speed: 0.0450s/iter; left time: 849.1001s
	iters: 200, epoch: 16 | loss: 0.0774815
	speed: 0.0222s/iter; left time: 416.4579s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0789532 Vali Loss: 0.0814593 Test Loss: 0.0876136
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0804251
	speed: 0.0456s/iter; left time: 848.9204s
	iters: 200, epoch: 17 | loss: 0.0788879
	speed: 0.0222s/iter; left time: 412.0817s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.19s
Steps: 223 | Train Loss: 0.0786518 Vali Loss: 0.0810290 Test Loss: 0.0878293
Validation loss decreased (0.081115 --> 0.081029).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0764076
	speed: 0.0448s/iter; left time: 824.6721s
	iters: 200, epoch: 18 | loss: 0.0798518
	speed: 0.0234s/iter; left time: 428.9303s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.26s
Steps: 223 | Train Loss: 0.0784339 Vali Loss: 0.0813855 Test Loss: 0.0877684
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0794611
	speed: 0.0441s/iter; left time: 802.4188s
	iters: 200, epoch: 19 | loss: 0.0837121
	speed: 0.0219s/iter; left time: 396.3212s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0782367 Vali Loss: 0.0811109 Test Loss: 0.0873743
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0762909
	speed: 0.0444s/iter; left time: 798.4217s
	iters: 200, epoch: 20 | loss: 0.0755530
	speed: 0.0220s/iter; left time: 392.5188s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0780520 Vali Loss: 0.0808757 Test Loss: 0.0875620
Validation loss decreased (0.081029 --> 0.080876).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0770825
	speed: 0.0461s/iter; left time: 817.8213s
	iters: 200, epoch: 21 | loss: 0.0790791
	speed: 0.0221s/iter; left time: 389.9578s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0779281 Vali Loss: 0.0809141 Test Loss: 0.0877328
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0814656
	speed: 0.0444s/iter; left time: 777.7307s
	iters: 200, epoch: 22 | loss: 0.0752154
	speed: 0.0219s/iter; left time: 381.4119s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.10s
Steps: 223 | Train Loss: 0.0777684 Vali Loss: 0.0808672 Test Loss: 0.0874537
Validation loss decreased (0.080876 --> 0.080867).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0779211
	speed: 0.0452s/iter; left time: 781.5449s
	iters: 200, epoch: 23 | loss: 0.0796038
	speed: 0.0220s/iter; left time: 378.4807s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.16s
Steps: 223 | Train Loss: 0.0776365 Vali Loss: 0.0809816 Test Loss: 0.0873867
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0783439
	speed: 0.0448s/iter; left time: 765.5439s
	iters: 200, epoch: 24 | loss: 0.0807758
	speed: 0.0219s/iter; left time: 372.1311s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0774527 Vali Loss: 0.0811040 Test Loss: 0.0876076
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0785841
	speed: 0.0441s/iter; left time: 743.5228s
	iters: 200, epoch: 25 | loss: 0.0787244
	speed: 0.0219s/iter; left time: 366.8210s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0773704 Vali Loss: 0.0811864 Test Loss: 0.0875936
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0794276
	speed: 0.0444s/iter; left time: 738.7969s
	iters: 200, epoch: 26 | loss: 0.0776701
	speed: 0.0219s/iter; left time: 362.1007s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0773006 Vali Loss: 0.0809925 Test Loss: 0.0875052
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0782279
	speed: 0.0442s/iter; left time: 725.4448s
	iters: 200, epoch: 27 | loss: 0.0763521
	speed: 0.0219s/iter; left time: 357.3852s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0772246 Vali Loss: 0.0810984 Test Loss: 0.0875920
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0755223
	speed: 0.0438s/iter; left time: 709.3821s
	iters: 200, epoch: 28 | loss: 0.0771596
	speed: 0.0219s/iter; left time: 351.9475s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0770989 Vali Loss: 0.0811485 Test Loss: 0.0874630
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0731708
	speed: 0.0437s/iter; left time: 696.9609s
	iters: 200, epoch: 29 | loss: 0.0795308
	speed: 0.0219s/iter; left time: 347.3375s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.09s
Steps: 223 | Train Loss: 0.0770529 Vali Loss: 0.0810510 Test Loss: 0.0875364
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0786274
	speed: 0.0446s/iter; left time: 701.9616s
	iters: 200, epoch: 30 | loss: 0.0785061
	speed: 0.0219s/iter; left time: 342.7089s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.08s
Steps: 223 | Train Loss: 0.0769746 Vali Loss: 0.0807405 Test Loss: 0.0872839
Validation loss decreased (0.080867 --> 0.080740).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0808271
	speed: 0.0451s/iter; left time: 699.4594s
	iters: 200, epoch: 31 | loss: 0.0768587
	speed: 0.0219s/iter; left time: 337.5492s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0768951 Vali Loss: 0.0808292 Test Loss: 0.0875573
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0766787
	speed: 0.0441s/iter; left time: 674.3648s
	iters: 200, epoch: 32 | loss: 0.0756252
	speed: 0.0219s/iter; left time: 332.8262s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0769027 Vali Loss: 0.0808887 Test Loss: 0.0874944
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0792284
	speed: 0.0452s/iter; left time: 680.9605s
	iters: 200, epoch: 33 | loss: 0.0765715
	speed: 0.0221s/iter; left time: 330.3268s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.15s
Steps: 223 | Train Loss: 0.0768116 Vali Loss: 0.0809315 Test Loss: 0.0875360
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0758336
	speed: 0.0443s/iter; left time: 657.1175s
	iters: 200, epoch: 34 | loss: 0.0781302
	speed: 0.0219s/iter; left time: 322.9201s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.12s
Steps: 223 | Train Loss: 0.0767849 Vali Loss: 0.0809789 Test Loss: 0.0873896
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0783587
	speed: 0.0449s/iter; left time: 656.8868s
	iters: 200, epoch: 35 | loss: 0.0773312
	speed: 0.0219s/iter; left time: 317.9779s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0767631 Vali Loss: 0.0808629 Test Loss: 0.0875003
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0750958
	speed: 0.0448s/iter; left time: 645.2777s
	iters: 200, epoch: 36 | loss: 0.0749962
	speed: 0.0219s/iter; left time: 312.5821s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.13s
Steps: 223 | Train Loss: 0.0766440 Vali Loss: 0.0809243 Test Loss: 0.0875456
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0753721
	speed: 0.0448s/iter; left time: 635.1870s
	iters: 200, epoch: 37 | loss: 0.0806005
	speed: 0.0219s/iter; left time: 307.8118s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.11s
Steps: 223 | Train Loss: 0.0765910 Vali Loss: 0.0810046 Test Loss: 0.0874726
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0762249
	speed: 0.0452s/iter; left time: 631.2253s
	iters: 200, epoch: 38 | loss: 0.0791740
	speed: 0.0219s/iter; left time: 303.4837s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0765436 Vali Loss: 0.0810213 Test Loss: 0.0875532
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0809940
	speed: 0.0451s/iter; left time: 619.1145s
	iters: 200, epoch: 39 | loss: 0.0743899
	speed: 0.0219s/iter; left time: 299.0953s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0765826 Vali Loss: 0.0808245 Test Loss: 0.0874972
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0759105
	speed: 0.0447s/iter; left time: 603.4081s
	iters: 200, epoch: 40 | loss: 0.0807009
	speed: 0.0222s/iter; left time: 297.5493s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.14s
Steps: 223 | Train Loss: 0.0765790 Vali Loss: 0.0809569 Test Loss: 0.0876428
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020960209891200066, rmse:0.14477641880512238, mae:0.08728384971618652, rse:0.5479239225387573
Intermediate time for IT and pred_len 168: 00h:09m:00.38s
Intermediate time for IT: 00h:30m:38.90s
Total time: 02h:24m:05.06s
