
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0331299
	speed: 0.0657s/iter; left time: 1465.1125s
	iters: 200, epoch: 1 | loss: 0.0287433
	speed: 0.0315s/iter; left time: 700.3793s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0354802 Vali Loss: 0.0319702 Test Loss: 0.0360805
Validation loss decreased (inf --> 0.031970).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0159255
	speed: 0.0610s/iter; left time: 1347.4296s
	iters: 200, epoch: 2 | loss: 0.0169086
	speed: 0.0319s/iter; left time: 701.1664s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.48s
Steps: 224 | Train Loss: 0.0172425 Vali Loss: 0.0207260 Test Loss: 0.0221175
Validation loss decreased (0.031970 --> 0.020726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0144151
	speed: 0.0622s/iter; left time: 1359.3172s
	iters: 200, epoch: 3 | loss: 0.0146772
	speed: 0.0320s/iter; left time: 696.8309s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.42s
Steps: 224 | Train Loss: 0.0146521 Vali Loss: 0.0201139 Test Loss: 0.0216509
Validation loss decreased (0.020726 --> 0.020114).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0158383
	speed: 0.0583s/iter; left time: 1261.4494s
	iters: 200, epoch: 4 | loss: 0.0160625
	speed: 0.0314s/iter; left time: 676.9700s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.28s
Steps: 224 | Train Loss: 0.0140296 Vali Loss: 0.0195571 Test Loss: 0.0211821
Validation loss decreased (0.020114 --> 0.019557).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0142890
	speed: 0.0591s/iter; left time: 1265.1663s
	iters: 200, epoch: 5 | loss: 0.0131326
	speed: 0.0320s/iter; left time: 681.5912s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.38s
Steps: 224 | Train Loss: 0.0136609 Vali Loss: 0.0193199 Test Loss: 0.0209985
Validation loss decreased (0.019557 --> 0.019320).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0164826
	speed: 0.0625s/iter; left time: 1323.6880s
	iters: 200, epoch: 6 | loss: 0.0126204
	speed: 0.0320s/iter; left time: 673.5597s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.40s
Steps: 224 | Train Loss: 0.0134594 Vali Loss: 0.0192443 Test Loss: 0.0211259
Validation loss decreased (0.019320 --> 0.019244).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0128278
	speed: 0.0590s/iter; left time: 1237.1625s
	iters: 200, epoch: 7 | loss: 0.0147099
	speed: 0.0315s/iter; left time: 658.0134s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.36s
Steps: 224 | Train Loss: 0.0132826 Vali Loss: 0.0190823 Test Loss: 0.0211098
Validation loss decreased (0.019244 --> 0.019082).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0118263
	speed: 0.0614s/iter; left time: 1272.7991s
	iters: 200, epoch: 8 | loss: 0.0127398
	speed: 0.0321s/iter; left time: 661.7075s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.46s
Steps: 224 | Train Loss: 0.0131595 Vali Loss: 0.0192576 Test Loss: 0.0208804
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0148438
	speed: 0.0628s/iter; left time: 1288.9137s
	iters: 200, epoch: 9 | loss: 0.0141029
	speed: 0.0326s/iter; left time: 665.4875s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0130791 Vali Loss: 0.0191878 Test Loss: 0.0210775
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0133966
	speed: 0.0628s/iter; left time: 1273.6089s
	iters: 200, epoch: 10 | loss: 0.0124890
	speed: 0.0323s/iter; left time: 652.0915s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0129684 Vali Loss: 0.0189475 Test Loss: 0.0207936
Validation loss decreased (0.019082 --> 0.018948).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0106154
	speed: 0.0622s/iter; left time: 1246.8994s
	iters: 200, epoch: 11 | loss: 0.0129889
	speed: 0.0322s/iter; left time: 643.1578s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0129028 Vali Loss: 0.0188844 Test Loss: 0.0209089
Validation loss decreased (0.018948 --> 0.018884).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0125292
	speed: 0.0593s/iter; left time: 1176.9644s
	iters: 200, epoch: 12 | loss: 0.0131749
	speed: 0.0324s/iter; left time: 640.1780s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.49s
Steps: 224 | Train Loss: 0.0128195 Vali Loss: 0.0188164 Test Loss: 0.0208695
Validation loss decreased (0.018884 --> 0.018816).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0113560
	speed: 0.0647s/iter; left time: 1268.8955s
	iters: 200, epoch: 13 | loss: 0.0122889
	speed: 0.0328s/iter; left time: 639.5063s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.71s
Steps: 224 | Train Loss: 0.0127381 Vali Loss: 0.0188539 Test Loss: 0.0208254
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0127220
	speed: 0.0625s/iter; left time: 1212.3817s
	iters: 200, epoch: 14 | loss: 0.0135412
	speed: 0.0326s/iter; left time: 628.4006s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0127018 Vali Loss: 0.0187021 Test Loss: 0.0206928
Validation loss decreased (0.018816 --> 0.018702).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0127345
	speed: 0.0596s/iter; left time: 1141.2875s
	iters: 200, epoch: 15 | loss: 0.0107379
	speed: 0.0326s/iter; left time: 621.8975s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0126647 Vali Loss: 0.0187818 Test Loss: 0.0208291
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0131628
	speed: 0.0637s/iter; left time: 1206.3047s
	iters: 200, epoch: 16 | loss: 0.0119425
	speed: 0.0328s/iter; left time: 617.5841s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0126147 Vali Loss: 0.0187834 Test Loss: 0.0210146
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0133438
	speed: 0.0625s/iter; left time: 1169.4515s
	iters: 200, epoch: 17 | loss: 0.0122820
	speed: 0.0328s/iter; left time: 611.5424s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0125655 Vali Loss: 0.0185552 Test Loss: 0.0206705
Validation loss decreased (0.018702 --> 0.018555).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0129390
	speed: 0.0667s/iter; left time: 1233.3324s
	iters: 200, epoch: 18 | loss: 0.0157475
	speed: 0.0326s/iter; left time: 598.7965s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0125308 Vali Loss: 0.0186281 Test Loss: 0.0207464
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0110804
	speed: 0.0625s/iter; left time: 1141.9113s
	iters: 200, epoch: 19 | loss: 0.0113313
	speed: 0.0327s/iter; left time: 594.6038s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0125154 Vali Loss: 0.0187080 Test Loss: 0.0210039
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0120892
	speed: 0.0653s/iter; left time: 1178.2013s
	iters: 200, epoch: 20 | loss: 0.0129364
	speed: 0.0327s/iter; left time: 586.8054s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0124660 Vali Loss: 0.0186161 Test Loss: 0.0207673
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0110016
	speed: 0.0632s/iter; left time: 1126.0931s
	iters: 200, epoch: 21 | loss: 0.0132078
	speed: 0.0327s/iter; left time: 579.8587s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0124346 Vali Loss: 0.0186258 Test Loss: 0.0207704
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0102475
	speed: 0.0626s/iter; left time: 1101.2028s
	iters: 200, epoch: 22 | loss: 0.0119495
	speed: 0.0327s/iter; left time: 572.1292s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0124349 Vali Loss: 0.0185870 Test Loss: 0.0208066
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0129670
	speed: 0.0623s/iter; left time: 1081.9585s
	iters: 200, epoch: 23 | loss: 0.0114171
	speed: 0.0326s/iter; left time: 563.5605s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0124044 Vali Loss: 0.0185987 Test Loss: 0.0207789
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0116020
	speed: 0.0598s/iter; left time: 1025.8805s
	iters: 200, epoch: 24 | loss: 0.0120706
	speed: 0.0326s/iter; left time: 556.3573s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0123961 Vali Loss: 0.0185948 Test Loss: 0.0207864
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0124222
	speed: 0.0620s/iter; left time: 1048.5091s
	iters: 200, epoch: 25 | loss: 0.0153793
	speed: 0.0327s/iter; left time: 550.7531s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0123830 Vali Loss: 0.0185996 Test Loss: 0.0207961
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0122711
	speed: 0.0624s/iter; left time: 1042.9224s
	iters: 200, epoch: 26 | loss: 0.0115288
	speed: 0.0327s/iter; left time: 543.5412s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.0123559 Vali Loss: 0.0185369 Test Loss: 0.0206521
Validation loss decreased (0.018555 --> 0.018537).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0131443
	speed: 0.0635s/iter; left time: 1047.0015s
	iters: 200, epoch: 27 | loss: 0.0136372
	speed: 0.0325s/iter; left time: 531.7414s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0123368 Vali Loss: 0.0186206 Test Loss: 0.0208083
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0118613
	speed: 0.0629s/iter; left time: 1022.3025s
	iters: 200, epoch: 28 | loss: 0.0137763
	speed: 0.0327s/iter; left time: 527.8428s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0123275 Vali Loss: 0.0185284 Test Loss: 0.0208035
Validation loss decreased (0.018537 --> 0.018528).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0121510
	speed: 0.0629s/iter; left time: 1008.3339s
	iters: 200, epoch: 29 | loss: 0.0107840
	speed: 0.0327s/iter; left time: 520.7402s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0123369 Vali Loss: 0.0185281 Test Loss: 0.0207493
Validation loss decreased (0.018528 --> 0.018528).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0138683
	speed: 0.0638s/iter; left time: 1008.6006s
	iters: 200, epoch: 30 | loss: 0.0133592
	speed: 0.0328s/iter; left time: 515.5150s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0123014 Vali Loss: 0.0185362 Test Loss: 0.0208496
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0119280
	speed: 0.0629s/iter; left time: 980.6459s
	iters: 200, epoch: 31 | loss: 0.0113524
	speed: 0.0327s/iter; left time: 506.7750s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0123056 Vali Loss: 0.0185103 Test Loss: 0.0208459
Validation loss decreased (0.018528 --> 0.018510).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0114114
	speed: 0.0632s/iter; left time: 970.1332s
	iters: 200, epoch: 32 | loss: 0.0130700
	speed: 0.0328s/iter; left time: 500.6444s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0123037 Vali Loss: 0.0185335 Test Loss: 0.0207588
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0132595
	speed: 0.0622s/iter; left time: 941.8769s
	iters: 200, epoch: 33 | loss: 0.0107495
	speed: 0.0330s/iter; left time: 496.6277s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0122890 Vali Loss: 0.0185438 Test Loss: 0.0208019
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0122293
	speed: 0.0619s/iter; left time: 922.2206s
	iters: 200, epoch: 34 | loss: 0.0126933
	speed: 0.0326s/iter; left time: 482.6458s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.56s
Steps: 224 | Train Loss: 0.0122830 Vali Loss: 0.0185324 Test Loss: 0.0207754
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0129222
	speed: 0.0636s/iter; left time: 934.4588s
	iters: 200, epoch: 35 | loss: 0.0108182
	speed: 0.0328s/iter; left time: 477.7778s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122650 Vali Loss: 0.0185707 Test Loss: 0.0208121
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0125490
	speed: 0.0626s/iter; left time: 904.5542s
	iters: 200, epoch: 36 | loss: 0.0140222
	speed: 0.0327s/iter; left time: 469.8458s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.0122610 Vali Loss: 0.0185492 Test Loss: 0.0208118
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0152776
	speed: 0.0629s/iter; left time: 895.0059s
	iters: 200, epoch: 37 | loss: 0.0121370
	speed: 0.0328s/iter; left time: 463.4520s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0122684 Vali Loss: 0.0185470 Test Loss: 0.0208452
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0121063
	speed: 0.0621s/iter; left time: 870.0876s
	iters: 200, epoch: 38 | loss: 0.0114475
	speed: 0.0329s/iter; left time: 458.3220s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0122699 Vali Loss: 0.0185565 Test Loss: 0.0208614
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0134420
	speed: 0.0625s/iter; left time: 861.6656s
	iters: 200, epoch: 39 | loss: 0.0113555
	speed: 0.0329s/iter; left time: 449.9652s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0122534 Vali Loss: 0.0185123 Test Loss: 0.0208491
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0111702
	speed: 0.0621s/iter; left time: 842.1306s
	iters: 200, epoch: 40 | loss: 0.0136204
	speed: 0.0328s/iter; left time: 441.1218s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0122599 Vali Loss: 0.0185720 Test Loss: 0.0208392
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0110373
	speed: 0.0636s/iter; left time: 848.4213s
	iters: 200, epoch: 41 | loss: 0.0121039
	speed: 0.0328s/iter; left time: 434.0371s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.72s
Steps: 224 | Train Loss: 0.0122421 Vali Loss: 0.0184958 Test Loss: 0.0207846
Validation loss decreased (0.018510 --> 0.018496).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0117363
	speed: 0.0649s/iter; left time: 850.6994s
	iters: 200, epoch: 42 | loss: 0.0141523
	speed: 0.0327s/iter; left time: 426.1461s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122492 Vali Loss: 0.0185481 Test Loss: 0.0208161
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0135011
	speed: 0.0626s/iter; left time: 807.5325s
	iters: 200, epoch: 43 | loss: 0.0126329
	speed: 0.0326s/iter; left time: 417.4636s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.57s
Steps: 224 | Train Loss: 0.0122592 Vali Loss: 0.0185243 Test Loss: 0.0208267
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0100381
	speed: 0.0635s/iter; left time: 804.2160s
	iters: 200, epoch: 44 | loss: 0.0122319
	speed: 0.0327s/iter; left time: 410.9142s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122403 Vali Loss: 0.0185204 Test Loss: 0.0207974
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0127638
	speed: 0.0627s/iter; left time: 779.6829s
	iters: 200, epoch: 45 | loss: 0.0129958
	speed: 0.0327s/iter; left time: 403.1422s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122323 Vali Loss: 0.0185284 Test Loss: 0.0208220
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0121234
	speed: 0.0629s/iter; left time: 769.2778s
	iters: 200, epoch: 46 | loss: 0.0132324
	speed: 0.0326s/iter; left time: 394.8878s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.60s
Steps: 224 | Train Loss: 0.0122421 Vali Loss: 0.0185286 Test Loss: 0.0207993
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0124325
	speed: 0.0627s/iter; left time: 752.8038s
	iters: 200, epoch: 47 | loss: 0.0115689
	speed: 0.0324s/iter; left time: 385.9757s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.51s
Steps: 224 | Train Loss: 0.0122320 Vali Loss: 0.0185471 Test Loss: 0.0208486
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0131577
	speed: 0.0620s/iter; left time: 729.6350s
	iters: 200, epoch: 48 | loss: 0.0117313
	speed: 0.0326s/iter; left time: 380.5471s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0122374 Vali Loss: 0.0185213 Test Loss: 0.0208071
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0126173
	speed: 0.0627s/iter; left time: 724.0895s
	iters: 200, epoch: 49 | loss: 0.0135240
	speed: 0.0326s/iter; left time: 373.3858s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.55s
Steps: 224 | Train Loss: 0.0122360 Vali Loss: 0.0184857 Test Loss: 0.0208153
Validation loss decreased (0.018496 --> 0.018486).  Saving model ...
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0112510
	speed: 0.0600s/iter; left time: 679.7402s
	iters: 200, epoch: 50 | loss: 0.0112302
	speed: 0.0330s/iter; left time: 370.1201s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0122434 Vali Loss: 0.0185543 Test Loss: 0.0208179
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0113205
	speed: 0.0645s/iter; left time: 715.7315s
	iters: 200, epoch: 51 | loss: 0.0120899
	speed: 0.0330s/iter; left time: 363.3289s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0122339 Vali Loss: 0.0185324 Test Loss: 0.0208079
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0130218
	speed: 0.0633s/iter; left time: 688.8629s
	iters: 200, epoch: 52 | loss: 0.0135182
	speed: 0.0330s/iter; left time: 355.7288s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.69s
Steps: 224 | Train Loss: 0.0122330 Vali Loss: 0.0185057 Test Loss: 0.0208085
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0123628
	speed: 0.0630s/iter; left time: 670.8619s
	iters: 200, epoch: 53 | loss: 0.0136013
	speed: 0.0326s/iter; left time: 344.4538s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.61s
Steps: 224 | Train Loss: 0.0122287 Vali Loss: 0.0185395 Test Loss: 0.0208171
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0124737
	speed: 0.0624s/iter; left time: 650.5184s
	iters: 200, epoch: 54 | loss: 0.0119168
	speed: 0.0327s/iter; left time: 337.9597s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:07.62s
Steps: 224 | Train Loss: 0.0122233 Vali Loss: 0.0185316 Test Loss: 0.0208232
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0115388
	speed: 0.0627s/iter; left time: 639.7606s
	iters: 200, epoch: 55 | loss: 0.0133567
	speed: 0.0325s/iter; left time: 328.6390s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:07.54s
Steps: 224 | Train Loss: 0.0122370 Vali Loss: 0.0185180 Test Loss: 0.0208282
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0134816
	speed: 0.0602s/iter; left time: 600.6881s
	iters: 200, epoch: 56 | loss: 0.0113304
	speed: 0.0328s/iter; left time: 323.8331s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:07.58s
Steps: 224 | Train Loss: 0.0122237 Vali Loss: 0.0184812 Test Loss: 0.0208191
Validation loss decreased (0.018486 --> 0.018481).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0127599
	speed: 0.0630s/iter; left time: 615.1459s
	iters: 200, epoch: 57 | loss: 0.0126832
	speed: 0.0330s/iter; left time: 319.0752s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:07.69s
Steps: 224 | Train Loss: 0.0122149 Vali Loss: 0.0185322 Test Loss: 0.0208272
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0128764
	speed: 0.0621s/iter; left time: 591.6943s
	iters: 200, epoch: 58 | loss: 0.0134127
	speed: 0.0328s/iter; left time: 309.1567s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122195 Vali Loss: 0.0185319 Test Loss: 0.0208226
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0128281
	speed: 0.0633s/iter; left time: 589.4851s
	iters: 200, epoch: 59 | loss: 0.0132629
	speed: 0.0328s/iter; left time: 302.2376s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:07.64s
Steps: 224 | Train Loss: 0.0122318 Vali Loss: 0.0185162 Test Loss: 0.0208412
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0120071
	speed: 0.0601s/iter; left time: 546.4069s
	iters: 200, epoch: 60 | loss: 0.0123658
	speed: 0.0326s/iter; left time: 293.2301s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:07.50s
Steps: 224 | Train Loss: 0.0122378 Vali Loss: 0.0185121 Test Loss: 0.0208320
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0136733
	speed: 0.0591s/iter; left time: 523.8553s
	iters: 200, epoch: 61 | loss: 0.0110619
	speed: 0.0328s/iter; left time: 287.0474s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122343 Vali Loss: 0.0185155 Test Loss: 0.0208189
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0118293
	speed: 0.0639s/iter; left time: 551.8756s
	iters: 200, epoch: 62 | loss: 0.0110706
	speed: 0.0328s/iter; left time: 280.4152s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:07.67s
Steps: 224 | Train Loss: 0.0122327 Vali Loss: 0.0185753 Test Loss: 0.0208160
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0124438
	speed: 0.0641s/iter; left time: 539.3103s
	iters: 200, epoch: 63 | loss: 0.0103165
	speed: 0.0327s/iter; left time: 272.0286s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:07.59s
Steps: 224 | Train Loss: 0.0122317 Vali Loss: 0.0185079 Test Loss: 0.0208250
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0115705
	speed: 0.0649s/iter; left time: 531.1956s
	iters: 200, epoch: 64 | loss: 0.0128942
	speed: 0.0327s/iter; left time: 264.5372s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:07.65s
Steps: 224 | Train Loss: 0.0122176 Vali Loss: 0.0185142 Test Loss: 0.0208247
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0127902
	speed: 0.0638s/iter; left time: 508.1859s
	iters: 200, epoch: 65 | loss: 0.0122773
	speed: 0.0327s/iter; left time: 257.0093s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:07.63s
Steps: 224 | Train Loss: 0.0122278 Vali Loss: 0.0184961 Test Loss: 0.0208173
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0115899
	speed: 0.0642s/iter; left time: 497.3096s
	iters: 200, epoch: 66 | loss: 0.0130514
	speed: 0.0330s/iter; left time: 252.0185s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:07.68s
Steps: 224 | Train Loss: 0.0122333 Vali Loss: 0.0185431 Test Loss: 0.0208185
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.020819105207920074, rmse:0.14428827166557312, mae:0.09108439832925797, rse:0.5092132687568665
Intermediate time for DE and pred_len 24: 00h:10m:40.11sIntermediate time for DE: 00h:10m:40.11sTotal time: 00h:10m:40.12s