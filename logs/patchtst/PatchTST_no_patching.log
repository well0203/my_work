=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1185825
	speed: 0.6688s/iter; left time: 2929.8023s
	iters: 200, epoch: 1 | loss: 0.1090781
	speed: 0.6481s/iter; left time: 2774.4317s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:25.38s
Steps: 224 | Train Loss: 0.1187725 Vali Loss: 0.1100739 Test Loss: 0.1098653
Validation loss decreased (inf --> 0.110074).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0894905
	speed: 1.0742s/iter; left time: 4465.5195s
	iters: 200, epoch: 2 | loss: 0.0864838
	speed: 0.6444s/iter; left time: 2614.3216s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:26.19s
Steps: 224 | Train Loss: 0.0909381 Vali Loss: 0.1002815 Test Loss: 0.1011409
Validation loss decreased (0.110074 --> 0.100282).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0831252
	speed: 1.0301s/iter; left time: 4051.2992s
	iters: 200, epoch: 3 | loss: 0.0806472
	speed: 0.6468s/iter; left time: 2479.1589s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:25.18s
Steps: 224 | Train Loss: 0.0837995 Vali Loss: 0.0962656 Test Loss: 0.0981424
Validation loss decreased (0.100282 --> 0.096266).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0774977
	speed: 1.0416s/iter; left time: 3863.3389s
	iters: 200, epoch: 4 | loss: 0.0760295
	speed: 0.6417s/iter; left time: 2315.7849s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:25.62s
Steps: 224 | Train Loss: 0.0802265 Vali Loss: 0.0948865 Test Loss: 0.0951428
Validation loss decreased (0.096266 --> 0.094887).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0776035
	speed: 1.0485s/iter; left time: 3653.8660s
	iters: 200, epoch: 5 | loss: 0.0754470
	speed: 0.6488s/iter; left time: 2196.3046s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:26.27s
Steps: 224 | Train Loss: 0.0781352 Vali Loss: 0.0920579 Test Loss: 0.0930737
Validation loss decreased (0.094887 --> 0.092058).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0768398
	speed: 1.0371s/iter; left time: 3381.9026s
	iters: 200, epoch: 6 | loss: 0.0745844
	speed: 0.6492s/iter; left time: 2052.1100s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:26.35s
Steps: 224 | Train Loss: 0.0772739 Vali Loss: 0.0921749 Test Loss: 0.0929615
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0779816
	speed: 1.0322s/iter; left time: 3134.9141s
	iters: 200, epoch: 7 | loss: 0.0759176
	speed: 0.6528s/iter; left time: 1917.2566s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:26.20s
Steps: 224 | Train Loss: 0.0761425 Vali Loss: 0.0916203 Test Loss: 0.0923960
Validation loss decreased (0.092058 --> 0.091620).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0725002
	speed: 1.0339s/iter; left time: 2908.4458s
	iters: 200, epoch: 8 | loss: 0.0762453
	speed: 0.6654s/iter; left time: 1805.3610s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:26.01s
Steps: 224 | Train Loss: 0.0752119 Vali Loss: 0.0908312 Test Loss: 0.0916540
Validation loss decreased (0.091620 --> 0.090831).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0725041
	speed: 1.0305s/iter; left time: 2667.9906s
	iters: 200, epoch: 9 | loss: 0.0683068
	speed: 0.6454s/iter; left time: 1606.4371s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:24.63s
Steps: 224 | Train Loss: 0.0745990 Vali Loss: 0.0904099 Test Loss: 0.0917372
Validation loss decreased (0.090831 --> 0.090410).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0700386
	speed: 1.0345s/iter; left time: 2446.5496s
	iters: 200, epoch: 10 | loss: 0.0721033
	speed: 0.6512s/iter; left time: 1474.9141s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:25.67s
Steps: 224 | Train Loss: 0.0740525 Vali Loss: 0.0897951 Test Loss: 0.0912578
Validation loss decreased (0.090410 --> 0.089795).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0666174
	speed: 1.0623s/iter; left time: 2274.3769s
	iters: 200, epoch: 11 | loss: 0.0760651
	speed: 0.6506s/iter; left time: 1327.8246s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:27.15s
Steps: 224 | Train Loss: 0.0736123 Vali Loss: 0.0899318 Test Loss: 0.0916627
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0749207
	speed: 1.0237s/iter; left time: 1962.4604s
	iters: 200, epoch: 12 | loss: 0.0740589
	speed: 0.7478s/iter; left time: 1358.7869s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:39.26s
Steps: 224 | Train Loss: 0.0732611 Vali Loss: 0.0894925 Test Loss: 0.0912984
Validation loss decreased (0.089795 --> 0.089493).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0752842
	speed: 1.2674s/iter; left time: 2145.6531s
	iters: 200, epoch: 13 | loss: 0.0713753
	speed: 0.8199s/iter; left time: 1306.1555s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:58.25s
Steps: 224 | Train Loss: 0.0728936 Vali Loss: 0.0895770 Test Loss: 0.0911928
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0732628
	speed: 1.4032s/iter; left time: 2061.2683s
	iters: 200, epoch: 14 | loss: 0.0704660
	speed: 0.7742s/iter; left time: 1059.8824s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:53.68s
Steps: 224 | Train Loss: 0.0725533 Vali Loss: 0.0897301 Test Loss: 0.0914722
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0720317
	speed: 1.3729s/iter; left time: 1709.2980s
	iters: 200, epoch: 15 | loss: 0.0720388
	speed: 0.7695s/iter; left time: 881.1346s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:00.35s
Steps: 224 | Train Loss: 0.0724398 Vali Loss: 0.0893662 Test Loss: 0.0911104
Validation loss decreased (0.089493 --> 0.089366).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0741066
	speed: 1.4951s/iter; left time: 1526.4775s
	iters: 200, epoch: 16 | loss: 0.0676593
	speed: 0.8263s/iter; left time: 761.0263s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:03m:07.78s
Steps: 224 | Train Loss: 0.0721958 Vali Loss: 0.0895748 Test Loss: 0.0918992
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0727639
	speed: 1.3470s/iter; left time: 1073.5445s
	iters: 200, epoch: 17 | loss: 0.0744767
	speed: 0.8282s/iter; left time: 577.2719s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:03m:05.18s
Steps: 224 | Train Loss: 0.0720195 Vali Loss: 0.0894382 Test Loss: 0.0920587
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0706366
	speed: 1.3400s/iter; left time: 767.7954s
	iters: 200, epoch: 18 | loss: 0.0681392
	speed: 0.7862s/iter; left time: 371.8836s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:03m:00.68s
Steps: 224 | Train Loss: 0.0717208 Vali Loss: 0.0891432 Test Loss: 0.0911035
Validation loss decreased (0.089366 --> 0.089143).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0646649
	speed: 1.3424s/iter; left time: 468.4852s
	iters: 200, epoch: 19 | loss: 0.0705285
	speed: 0.8197s/iter; left time: 204.0946s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:03m:02.57s
Steps: 224 | Train Loss: 0.0716752 Vali Loss: 0.0893801 Test Loss: 0.0916932
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0748916
	speed: 1.3266s/iter; left time: 165.8264s
	iters: 200, epoch: 20 | loss: 0.0762143
	speed: 0.9504s/iter; left time: 23.7599s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:03m:13.58s
Steps: 224 | Train Loss: 0.0715203 Vali Loss: 0.0894523 Test Loss: 0.0925765
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021852394565939903, rmse:0.14782555401325226, mae:0.09110347926616669, rse:0.5216968655586243

Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1201662
	speed: 0.6902s/iter; left time: 3023.8023s
	iters: 200, epoch: 1 | loss: 0.1083984
	speed: 0.8199s/iter; left time: 3510.1849s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:51.51s
Steps: 224 | Train Loss: 0.1197711 Vali Loss: 0.1104640 Test Loss: 0.1099900
Validation loss decreased (inf --> 0.110464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0871584
	speed: 1.5188s/iter; left time: 6313.7035s
	iters: 200, epoch: 2 | loss: 0.0852323
	speed: 0.8325s/iter; left time: 3377.4109s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:03m:07.89s
Steps: 224 | Train Loss: 0.0910880 Vali Loss: 0.0981202 Test Loss: 0.1009802
Validation loss decreased (0.110464 --> 0.098120).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0853115
	speed: 1.4874s/iter; left time: 5850.0365s
	iters: 200, epoch: 3 | loss: 0.0795056
	speed: 0.8492s/iter; left time: 3254.9814s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:03m:10.77s
Steps: 224 | Train Loss: 0.0834218 Vali Loss: 0.0952579 Test Loss: 0.0964131
Validation loss decreased (0.098120 --> 0.095258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0764321
	speed: 1.4849s/iter; left time: 5507.3214s
	iters: 200, epoch: 4 | loss: 0.0704273
	speed: 0.8500s/iter; left time: 3067.5528s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:03m:09.02s
Steps: 224 | Train Loss: 0.0803541 Vali Loss: 0.0942130 Test Loss: 0.0944882
Validation loss decreased (0.095258 --> 0.094213).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0812252
	speed: 1.4917s/iter; left time: 5198.6443s
	iters: 200, epoch: 5 | loss: 0.0723357
	speed: 0.8511s/iter; left time: 2880.8499s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:03m:09.99s
Steps: 224 | Train Loss: 0.0780411 Vali Loss: 0.0926510 Test Loss: 0.0935687
Validation loss decreased (0.094213 --> 0.092651).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0705587
	speed: 1.4860s/iter; left time: 4845.7223s
	iters: 200, epoch: 6 | loss: 0.0729282
	speed: 0.8480s/iter; left time: 2680.6743s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:03m:09.33s
Steps: 224 | Train Loss: 0.0770898 Vali Loss: 0.0913223 Test Loss: 0.0926111
Validation loss decreased (0.092651 --> 0.091322).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0752742
	speed: 1.4621s/iter; left time: 4440.5407s
	iters: 200, epoch: 7 | loss: 0.0756757
	speed: 0.8388s/iter; left time: 2463.6334s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:03m:08.41s
Steps: 224 | Train Loss: 0.0762828 Vali Loss: 0.0902402 Test Loss: 0.0915751
Validation loss decreased (0.091322 --> 0.090240).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0777563
	speed: 1.4495s/iter; left time: 4077.5128s
	iters: 200, epoch: 8 | loss: 0.0748446
	speed: 0.8418s/iter; left time: 2283.8057s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:03m:07.98s
Steps: 224 | Train Loss: 0.0754152 Vali Loss: 0.0899461 Test Loss: 0.0914084
Validation loss decreased (0.090240 --> 0.089946).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0721380
	speed: 1.4680s/iter; left time: 3800.5822s
	iters: 200, epoch: 9 | loss: 0.0728657
	speed: 0.8333s/iter; left time: 2074.0374s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:03m:07.14s
Steps: 224 | Train Loss: 0.0746742 Vali Loss: 0.0903633 Test Loss: 0.0908017
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0710530
	speed: 1.4918s/iter; left time: 3528.1873s
	iters: 200, epoch: 10 | loss: 0.0705148
	speed: 0.8472s/iter; left time: 1919.0177s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:03m:11.14s
Steps: 224 | Train Loss: 0.0740754 Vali Loss: 0.0897875 Test Loss: 0.0912357
Validation loss decreased (0.089946 --> 0.089788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0720897
	speed: 1.4902s/iter; left time: 3190.4692s
	iters: 200, epoch: 11 | loss: 0.0687625
	speed: 0.8463s/iter; left time: 1727.3280s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:03m:09.46s
Steps: 224 | Train Loss: 0.0735199 Vali Loss: 0.0899521 Test Loss: 0.0915615
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0725851
	speed: 1.4774s/iter; left time: 2832.1454s
	iters: 200, epoch: 12 | loss: 0.0756204
	speed: 0.8193s/iter; left time: 1488.7527s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:03m:07.48s
Steps: 224 | Train Loss: 0.0731441 Vali Loss: 0.0894233 Test Loss: 0.0906191
Validation loss decreased (0.089788 --> 0.089423).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0718960
	speed: 1.4565s/iter; left time: 2465.8815s
	iters: 200, epoch: 13 | loss: 0.0757970
	speed: 0.8378s/iter; left time: 1334.5497s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:03m:06.85s
Steps: 224 | Train Loss: 0.0727348 Vali Loss: 0.0896581 Test Loss: 0.0914745
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0716447
	speed: 1.5150s/iter; left time: 2225.6009s
	iters: 200, epoch: 14 | loss: 0.0759265
	speed: 0.8626s/iter; left time: 1180.9018s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:03m:10.92s
Steps: 224 | Train Loss: 0.0725364 Vali Loss: 0.0889910 Test Loss: 0.0906905
Validation loss decreased (0.089423 --> 0.088991).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0730583
	speed: 1.5198s/iter; left time: 1892.1442s
	iters: 200, epoch: 15 | loss: 0.0691186
	speed: 0.8478s/iter; left time: 970.6965s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:03m:12.07s
Steps: 224 | Train Loss: 0.0723537 Vali Loss: 0.0896075 Test Loss: 0.0918515
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0712389
	speed: 1.4952s/iter; left time: 1526.6150s
	iters: 200, epoch: 16 | loss: 0.0701750
	speed: 0.8390s/iter; left time: 772.7165s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:03m:09.82s
Steps: 224 | Train Loss: 0.0719971 Vali Loss: 0.0890231 Test Loss: 0.0908993
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0748366
	speed: 1.4536s/iter; left time: 1158.4845s
	iters: 200, epoch: 17 | loss: 0.0762918
	speed: 0.8353s/iter; left time: 582.2337s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:03m:07.85s
Steps: 224 | Train Loss: 0.0718654 Vali Loss: 0.0890983 Test Loss: 0.0911705
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0735894
	speed: 1.4531s/iter; left time: 832.6268s
	iters: 200, epoch: 18 | loss: 0.0716164
	speed: 0.8461s/iter; left time: 400.2154s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:03m:09.21s
Steps: 224 | Train Loss: 0.0716082 Vali Loss: 0.0896960 Test Loss: 0.0908316
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0675492
	speed: 1.4522s/iter; left time: 506.8123s
	iters: 200, epoch: 19 | loss: 0.0709308
	speed: 0.8435s/iter; left time: 210.0197s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:03m:08.09s
Steps: 224 | Train Loss: 0.0714599 Vali Loss: 0.0893303 Test Loss: 0.0912627
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021494006738066673, rmse:0.14660833775997162, mae:0.090690478682518, rse:0.5174011588096619
Intermediate time for DE and pred_len 24: 02h:17m:12.47s


=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1272504
	speed: 0.7387s/iter; left time: 6501.5093s
	iters: 200, epoch: 1 | loss: 0.1262388
	speed: 0.7195s/iter; left time: 6260.4799s
	iters: 300, epoch: 1 | loss: 0.1271427
	speed: 0.7212s/iter; left time: 6203.0701s
	iters: 400, epoch: 1 | loss: 0.1145236
	speed: 0.7224s/iter; left time: 6141.4206s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:20.48s
Steps: 445 | Train Loss: 0.1275961 Vali Loss: 0.1278838 Test Loss: 0.1334434
Validation loss decreased (inf --> 0.127884).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1160311
	speed: 1.5365s/iter; left time: 12838.8919s
	iters: 200, epoch: 2 | loss: 0.1083726
	speed: 0.7219s/iter; left time: 5960.1269s
	iters: 300, epoch: 2 | loss: 0.1066499
	speed: 0.7225s/iter; left time: 5892.7771s
	iters: 400, epoch: 2 | loss: 0.1140636
	speed: 0.7224s/iter; left time: 5819.6871s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.17s
Steps: 445 | Train Loss: 0.1125139 Vali Loss: 0.1221793 Test Loss: 0.1290404
Validation loss decreased (0.127884 --> 0.122179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0946881
	speed: 1.5387s/iter; left time: 12172.4806s
	iters: 200, epoch: 3 | loss: 0.1055842
	speed: 0.7213s/iter; left time: 5633.8327s
	iters: 300, epoch: 3 | loss: 0.1074231
	speed: 0.7219s/iter; left time: 5566.3823s
	iters: 400, epoch: 3 | loss: 0.1057124
	speed: 0.7218s/iter; left time: 5493.7703s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:20.96s
Steps: 445 | Train Loss: 0.1046552 Vali Loss: 0.1206464 Test Loss: 0.1272809
Validation loss decreased (0.122179 --> 0.120646).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0950363
	speed: 1.5373s/iter; left time: 11477.6019s
	iters: 200, epoch: 4 | loss: 0.1030017
	speed: 0.7220s/iter; left time: 5318.2967s
	iters: 300, epoch: 4 | loss: 0.1032499
	speed: 0.7219s/iter; left time: 5245.0436s
	iters: 400, epoch: 4 | loss: 0.0954240
	speed: 0.7225s/iter; left time: 5177.4611s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.14s
Steps: 445 | Train Loss: 0.1031440 Vali Loss: 0.1192677 Test Loss: 0.1269290
Validation loss decreased (0.120646 --> 0.119268).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0991746
	speed: 1.5365s/iter; left time: 10787.5506s
	iters: 200, epoch: 5 | loss: 0.0978521
	speed: 0.7220s/iter; left time: 4996.9610s
	iters: 300, epoch: 5 | loss: 0.0973436
	speed: 0.7220s/iter; left time: 4924.6956s
	iters: 400, epoch: 5 | loss: 0.1026417
	speed: 0.7225s/iter; left time: 4855.6614s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.08s
Steps: 445 | Train Loss: 0.1009454 Vali Loss: 0.1208833 Test Loss: 0.1269294
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1028337
	speed: 1.5347s/iter; left time: 10092.4215s
	iters: 200, epoch: 6 | loss: 0.1016100
	speed: 0.7216s/iter; left time: 4673.0220s
	iters: 300, epoch: 6 | loss: 0.1044808
	speed: 0.7215s/iter; left time: 4600.2230s
	iters: 400, epoch: 6 | loss: 0.0946720
	speed: 0.7219s/iter; left time: 4530.6631s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.00s
Steps: 445 | Train Loss: 0.0995449 Vali Loss: 0.1195087 Test Loss: 0.1262130
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0997079
	speed: 1.5357s/iter; left time: 9415.6264s
	iters: 200, epoch: 7 | loss: 0.0955373
	speed: 0.7222s/iter; left time: 4355.3405s
	iters: 300, epoch: 7 | loss: 0.1011349
	speed: 0.7222s/iter; left time: 4283.2430s
	iters: 400, epoch: 7 | loss: 0.1045052
	speed: 0.7224s/iter; left time: 4212.5914s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.22s
Steps: 445 | Train Loss: 0.0985589 Vali Loss: 0.1194712 Test Loss: 0.1258205
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1073911
	speed: 1.5346s/iter; left time: 8725.4579s
	iters: 200, epoch: 8 | loss: 0.0994071
	speed: 0.7234s/iter; left time: 4040.9197s
	iters: 300, epoch: 8 | loss: 0.0880458
	speed: 0.7223s/iter; left time: 3962.7195s
	iters: 400, epoch: 8 | loss: 0.0978921
	speed: 0.7221s/iter; left time: 3889.0492s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.26s
Steps: 445 | Train Loss: 0.0973770 Vali Loss: 0.1194732 Test Loss: 0.1269184
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0958433
	speed: 1.5360s/iter; left time: 8050.2497s
	iters: 200, epoch: 9 | loss: 0.0924097
	speed: 0.7216s/iter; left time: 3709.7121s
	iters: 300, epoch: 9 | loss: 0.0942280
	speed: 0.7220s/iter; left time: 3639.8386s
	iters: 400, epoch: 9 | loss: 0.0933523
	speed: 0.7219s/iter; left time: 3566.8859s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:21.04s
Steps: 445 | Train Loss: 0.0964851 Vali Loss: 0.1203359 Test Loss: 0.1274325
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.036805927753448486, rmse:0.19184871017932892, mae:0.12692901492118835, rse:0.6793750524520874
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1354789
	speed: 0.7200s/iter; left time: 6336.7880s
	iters: 200, epoch: 1 | loss: 0.1266687
	speed: 0.7222s/iter; left time: 6284.0765s
	iters: 300, epoch: 1 | loss: 0.1210057
	speed: 0.7219s/iter; left time: 6208.7558s
	iters: 400, epoch: 1 | loss: 0.1277771
	speed: 0.7221s/iter; left time: 6138.2777s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.17s
Steps: 445 | Train Loss: 0.1277080 Vali Loss: 0.1273815 Test Loss: 0.1327826
Validation loss decreased (inf --> 0.127381).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1188701
	speed: 1.5375s/iter; left time: 12847.2710s
	iters: 200, epoch: 2 | loss: 0.1095475
	speed: 0.7214s/iter; left time: 5956.1545s
	iters: 300, epoch: 2 | loss: 0.1079173
	speed: 0.7219s/iter; left time: 5887.4142s
	iters: 400, epoch: 2 | loss: 0.0996559
	speed: 0.7218s/iter; left time: 5814.6985s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:20.96s
Steps: 445 | Train Loss: 0.1126215 Vali Loss: 0.1220283 Test Loss: 0.1283479
Validation loss decreased (0.127381 --> 0.122028).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1062080
	speed: 1.5365s/iter; left time: 12155.2301s
	iters: 200, epoch: 3 | loss: 0.1031846
	speed: 0.7215s/iter; left time: 5635.7974s
	iters: 300, epoch: 3 | loss: 0.1049545
	speed: 0.7218s/iter; left time: 5565.9774s
	iters: 400, epoch: 3 | loss: 0.1099224
	speed: 0.7219s/iter; left time: 5494.1028s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:20.99s
Steps: 445 | Train Loss: 0.1043509 Vali Loss: 0.1199946 Test Loss: 0.1280003
Validation loss decreased (0.122028 --> 0.119995).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1152708
	speed: 1.5381s/iter; left time: 11483.2032s
	iters: 200, epoch: 4 | loss: 0.1080654
	speed: 0.7219s/iter; left time: 5317.5317s
	iters: 300, epoch: 4 | loss: 0.0970610
	speed: 0.7220s/iter; left time: 5246.3559s
	iters: 400, epoch: 4 | loss: 0.1028451
	speed: 0.7222s/iter; left time: 5175.5877s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.04s
Steps: 445 | Train Loss: 0.1023464 Vali Loss: 0.1193180 Test Loss: 0.1262316
Validation loss decreased (0.119995 --> 0.119318).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0950648
	speed: 1.5369s/iter; left time: 10790.7521s
	iters: 200, epoch: 5 | loss: 0.0955782
	speed: 0.7220s/iter; left time: 4996.9981s
	iters: 300, epoch: 5 | loss: 0.1001224
	speed: 0.7214s/iter; left time: 4920.9723s
	iters: 400, epoch: 5 | loss: 0.1028963
	speed: 0.7219s/iter; left time: 4851.9663s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:20.96s
Steps: 445 | Train Loss: 0.1006721 Vali Loss: 0.1191591 Test Loss: 0.1264123
Validation loss decreased (0.119318 --> 0.119159).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0937326
	speed: 1.5357s/iter; left time: 10098.8715s
	iters: 200, epoch: 6 | loss: 0.1003050
	speed: 0.7223s/iter; left time: 4677.4648s
	iters: 300, epoch: 6 | loss: 0.1003255
	speed: 0.7219s/iter; left time: 4602.7253s
	iters: 400, epoch: 6 | loss: 0.0967957
	speed: 0.7219s/iter; left time: 4530.6470s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.01s
Steps: 445 | Train Loss: 0.0994850 Vali Loss: 0.1197495 Test Loss: 0.1264345
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0976758
	speed: 1.5364s/iter; left time: 9419.4091s
	iters: 200, epoch: 7 | loss: 0.1007817
	speed: 0.8155s/iter; left time: 4918.3720s
	iters: 300, epoch: 7 | loss: 0.0957605
	speed: 0.7870s/iter; left time: 4667.9280s
	iters: 400, epoch: 7 | loss: 0.1064078
	speed: 0.7834s/iter; left time: 4568.1655s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:47.29s
Steps: 445 | Train Loss: 0.0984539 Vali Loss: 0.1194370 Test Loss: 0.1272272
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0941897
	speed: 1.6716s/iter; left time: 9504.8680s
	iters: 200, epoch: 8 | loss: 0.0919208
	speed: 0.8133s/iter; left time: 4542.9938s
	iters: 300, epoch: 8 | loss: 0.0946216
	speed: 0.7659s/iter; left time: 4201.5473s
	iters: 400, epoch: 8 | loss: 0.1007927
	speed: 0.8078s/iter; left time: 4350.6956s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:53.53s
Steps: 445 | Train Loss: 0.0973713 Vali Loss: 0.1194558 Test Loss: 0.1267165
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0904613
	speed: 1.6573s/iter; left time: 8685.7511s
	iters: 200, epoch: 9 | loss: 0.1046470
	speed: 0.8639s/iter; left time: 4441.0794s
	iters: 300, epoch: 9 | loss: 0.0900418
	speed: 0.7886s/iter; left time: 3975.1266s
	iters: 400, epoch: 9 | loss: 0.0944109
	speed: 0.7790s/iter; left time: 3849.0574s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:55.59s
Steps: 445 | Train Loss: 0.0966232 Vali Loss: 0.1199947 Test Loss: 0.1270730
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0996504
	speed: 1.7031s/iter; left time: 8168.2279s
	iters: 200, epoch: 10 | loss: 0.0991650
	speed: 0.8137s/iter; left time: 3821.1117s
	iters: 300, epoch: 10 | loss: 0.0909482
	speed: 0.7551s/iter; left time: 3470.6274s
	iters: 400, epoch: 10 | loss: 0.0975654
	speed: 0.7995s/iter; left time: 3594.6747s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:53.90s
Steps: 445 | Train Loss: 0.0959425 Vali Loss: 0.1205678 Test Loss: 0.1279655
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03617928549647331, rmse:0.1902085244655609, mae:0.1264123022556305, rse:0.6735668778419495
Intermediate time for DE and pred_len 96: 02h:00m:34.23s


=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1323474
	speed: 0.7929s/iter; left time: 6962.6268s
	iters: 200, epoch: 1 | loss: 0.1267833
	speed: 0.7574s/iter; left time: 6574.7432s
	iters: 300, epoch: 1 | loss: 0.1211254
	speed: 0.8445s/iter; left time: 7246.4880s
	iters: 400, epoch: 1 | loss: 0.1338862
	speed: 0.8348s/iter; left time: 7080.1470s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:58.11s
Steps: 444 | Train Loss: 0.1313489 Vali Loss: 0.1307256 Test Loss: 0.1377980
Validation loss decreased (inf --> 0.130726).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1201358
	speed: 1.7275s/iter; left time: 14401.8579s
	iters: 200, epoch: 2 | loss: 0.1120291
	speed: 0.7890s/iter; left time: 6499.1339s
	iters: 300, epoch: 2 | loss: 0.1164909
	speed: 0.7505s/iter; left time: 6106.4968s
	iters: 400, epoch: 2 | loss: 0.1098423
	speed: 0.7652s/iter; left time: 6149.5147s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:45.72s
Steps: 444 | Train Loss: 0.1179492 Vali Loss: 0.1262635 Test Loss: 0.1381650
Validation loss decreased (0.130726 --> 0.126263).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1120896
	speed: 1.6108s/iter; left time: 12714.0130s
	iters: 200, epoch: 3 | loss: 0.1106812
	speed: 0.7983s/iter; left time: 6220.7623s
	iters: 300, epoch: 3 | loss: 0.1086510
	speed: 0.7894s/iter; left time: 6073.0970s
	iters: 400, epoch: 3 | loss: 0.1112044
	speed: 0.7723s/iter; left time: 5864.3762s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:49.37s
Steps: 444 | Train Loss: 0.1105078 Vali Loss: 0.1238652 Test Loss: 0.1341449
Validation loss decreased (0.126263 --> 0.123865).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1095193
	speed: 1.6585s/iter; left time: 12354.0829s
	iters: 200, epoch: 4 | loss: 0.1061955
	speed: 0.7610s/iter; left time: 5592.4370s
	iters: 300, epoch: 4 | loss: 0.1083736
	speed: 0.7975s/iter; left time: 5781.3086s
	iters: 400, epoch: 4 | loss: 0.1084235
	speed: 0.7995s/iter; left time: 5715.7572s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:46.93s
Steps: 444 | Train Loss: 0.1080334 Vali Loss: 0.1228850 Test Loss: 0.1330794
Validation loss decreased (0.123865 --> 0.122885).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1139325
	speed: 1.6051s/iter; left time: 11243.7493s
	iters: 200, epoch: 5 | loss: 0.1047695
	speed: 0.7548s/iter; left time: 5211.7827s
	iters: 300, epoch: 5 | loss: 0.1123545
	speed: 0.7754s/iter; left time: 5276.4366s
	iters: 400, epoch: 5 | loss: 0.1013108
	speed: 0.7991s/iter; left time: 5357.6747s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:43.24s
Steps: 444 | Train Loss: 0.1064310 Vali Loss: 0.1226485 Test Loss: 0.1330622
Validation loss decreased (0.122885 --> 0.122649).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1077276
	speed: 1.6455s/iter; left time: 10795.9639s
	iters: 200, epoch: 6 | loss: 0.1074295
	speed: 1.1434s/iter; left time: 7387.2178s
	iters: 300, epoch: 6 | loss: 0.1041425
	speed: 0.9319s/iter; left time: 5927.5009s
	iters: 400, epoch: 6 | loss: 0.1138945
	speed: 0.7209s/iter; left time: 4513.6292s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:06m:32.66s
Steps: 444 | Train Loss: 0.1052017 Vali Loss: 0.1236539 Test Loss: 0.1330673
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1010743
	speed: 1.5194s/iter; left time: 9293.8974s
	iters: 200, epoch: 7 | loss: 0.1033607
	speed: 0.7226s/iter; left time: 4347.8844s
	iters: 300, epoch: 7 | loss: 0.1110799
	speed: 0.7227s/iter; left time: 4276.4399s
	iters: 400, epoch: 7 | loss: 0.1081572
	speed: 0.7223s/iter; left time: 4201.7482s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:20.57s
Steps: 444 | Train Loss: 0.1040502 Vali Loss: 0.1236861 Test Loss: 0.1335212
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1046957
	speed: 1.5197s/iter; left time: 8621.3988s
	iters: 200, epoch: 8 | loss: 0.1044276
	speed: 0.7231s/iter; left time: 4029.5970s
	iters: 300, epoch: 8 | loss: 0.1055024
	speed: 0.7224s/iter; left time: 3953.5622s
	iters: 400, epoch: 8 | loss: 0.1003766
	speed: 0.7227s/iter; left time: 3883.2023s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:20.71s
Steps: 444 | Train Loss: 0.1029538 Vali Loss: 0.1238294 Test Loss: 0.1330000
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1021980
	speed: 1.5205s/iter; left time: 7950.8736s
	iters: 200, epoch: 9 | loss: 0.1054295
	speed: 0.7227s/iter; left time: 3706.9255s
	iters: 300, epoch: 9 | loss: 0.1056621
	speed: 0.7232s/iter; left time: 3636.9786s
	iters: 400, epoch: 9 | loss: 0.1022051
	speed: 0.7244s/iter; left time: 3570.7568s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:20.93s
Steps: 444 | Train Loss: 0.1018084 Vali Loss: 0.1242083 Test Loss: 0.1340227
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1013948
	speed: 1.5210s/iter; left time: 7277.9503s
	iters: 200, epoch: 10 | loss: 0.1050889
	speed: 0.7230s/iter; left time: 3387.2987s
	iters: 300, epoch: 10 | loss: 0.0968566
	speed: 0.7228s/iter; left time: 3314.0311s
	iters: 400, epoch: 10 | loss: 0.0990717
	speed: 0.7227s/iter; left time: 3241.4250s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:20.82s
Steps: 444 | Train Loss: 0.1008384 Vali Loss: 0.1238022 Test Loss: 0.1343484
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.038619864732027054, rmse:0.1965193748474121, mae:0.1330622136592865, rse:0.6960874199867249

Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1351206
	speed: 0.7205s/iter; left time: 6327.0167s
	iters: 200, epoch: 1 | loss: 0.1264884
	speed: 0.7247s/iter; left time: 6290.7216s
	iters: 300, epoch: 1 | loss: 0.1326067
	speed: 0.7240s/iter; left time: 6212.7887s
	iters: 400, epoch: 1 | loss: 0.1310080
	speed: 0.7237s/iter; left time: 6137.8992s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.20s
Steps: 444 | Train Loss: 0.1320531 Vali Loss: 0.1302707 Test Loss: 0.1381443
Validation loss decreased (inf --> 0.130271).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1174341
	speed: 1.5347s/iter; left time: 12794.8024s
	iters: 200, epoch: 2 | loss: 0.1231514
	speed: 0.7231s/iter; left time: 5956.2393s
	iters: 300, epoch: 2 | loss: 0.1112126
	speed: 0.7238s/iter; left time: 5889.4567s
	iters: 400, epoch: 2 | loss: 0.1125543
	speed: 0.7232s/iter; left time: 5812.6061s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:20.86s
Steps: 444 | Train Loss: 0.1169409 Vali Loss: 0.1252545 Test Loss: 0.1355810
Validation loss decreased (0.130271 --> 0.125254).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1114167
	speed: 1.5280s/iter; left time: 12060.4471s
	iters: 200, epoch: 3 | loss: 0.1196080
	speed: 0.7223s/iter; left time: 5628.9638s
	iters: 300, epoch: 3 | loss: 0.1120061
	speed: 0.7241s/iter; left time: 5570.7472s
	iters: 400, epoch: 3 | loss: 0.1104744
	speed: 0.7247s/iter; left time: 5502.4460s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:21.16s
Steps: 444 | Train Loss: 0.1102480 Vali Loss: 0.1232311 Test Loss: 0.1332820
Validation loss decreased (0.125254 --> 0.123231).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1072323
	speed: 1.5248s/iter; left time: 11358.5514s
	iters: 200, epoch: 4 | loss: 0.1009570
	speed: 0.7223s/iter; left time: 5308.2820s
	iters: 300, epoch: 4 | loss: 0.1068474
	speed: 0.7225s/iter; left time: 5237.2050s
	iters: 400, epoch: 4 | loss: 0.1071541
	speed: 0.7229s/iter; left time: 5167.7937s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:20.58s
Steps: 444 | Train Loss: 0.1077301 Vali Loss: 0.1226953 Test Loss: 0.1332083
Validation loss decreased (0.123231 --> 0.122695).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1139473
	speed: 1.5266s/iter; left time: 10693.6670s
	iters: 200, epoch: 5 | loss: 0.1062142
	speed: 0.7245s/iter; left time: 5002.6670s
	iters: 300, epoch: 5 | loss: 0.1112900
	speed: 0.7250s/iter; left time: 4933.4487s
	iters: 400, epoch: 5 | loss: 0.1074786
	speed: 0.7248s/iter; left time: 4859.4952s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.41s
Steps: 444 | Train Loss: 0.1059545 Vali Loss: 0.1224413 Test Loss: 0.1318479
Validation loss decreased (0.122695 --> 0.122441).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1032561
	speed: 1.5248s/iter; left time: 10004.2230s
	iters: 200, epoch: 6 | loss: 0.1078574
	speed: 0.7226s/iter; left time: 4669.0155s
	iters: 300, epoch: 6 | loss: 0.1065954
	speed: 0.7228s/iter; left time: 4597.7176s
	iters: 400, epoch: 6 | loss: 0.1065514
	speed: 0.7230s/iter; left time: 4526.4638s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:20.75s
Steps: 444 | Train Loss: 0.1045533 Vali Loss: 0.1234427 Test Loss: 0.1332659
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1110598
	speed: 1.5223s/iter; left time: 9312.0975s
	iters: 200, epoch: 7 | loss: 0.1051400
	speed: 0.7244s/iter; left time: 4358.4916s
	iters: 300, epoch: 7 | loss: 0.1072126
	speed: 0.7232s/iter; left time: 4279.1811s
	iters: 400, epoch: 7 | loss: 0.1033111
	speed: 0.7236s/iter; left time: 4209.2411s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.09s
Steps: 444 | Train Loss: 0.1032575 Vali Loss: 0.1230671 Test Loss: 0.1330562
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1000044
	speed: 1.5205s/iter; left time: 8625.5531s
	iters: 200, epoch: 8 | loss: 0.0969648
	speed: 0.7234s/iter; left time: 4031.7048s
	iters: 300, epoch: 8 | loss: 0.0983744
	speed: 0.7237s/iter; left time: 3960.5615s
	iters: 400, epoch: 8 | loss: 0.1069602
	speed: 0.7238s/iter; left time: 3889.0511s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:20.92s
Steps: 444 | Train Loss: 0.1022502 Vali Loss: 0.1249851 Test Loss: 0.1345664
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0967258
	speed: 1.5203s/iter; left time: 7949.5583s
	iters: 200, epoch: 9 | loss: 0.1009705
	speed: 0.7224s/iter; left time: 3705.1836s
	iters: 300, epoch: 9 | loss: 0.1037303
	speed: 0.7242s/iter; left time: 3642.0735s
	iters: 400, epoch: 9 | loss: 0.1052246
	speed: 0.7237s/iter; left time: 3567.3149s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:20.92s
Steps: 444 | Train Loss: 0.1012265 Vali Loss: 0.1248850 Test Loss: 0.1354963
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1017485
	speed: 1.5209s/iter; left time: 7277.6938s
	iters: 200, epoch: 10 | loss: 0.1012512
	speed: 0.7242s/iter; left time: 3392.8989s
	iters: 300, epoch: 10 | loss: 0.0969197
	speed: 0.7239s/iter; left time: 3319.1205s
	iters: 400, epoch: 10 | loss: 0.1009838
	speed: 0.7236s/iter; left time: 3245.1473s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:21.12s
Steps: 444 | Train Loss: 0.1004789 Vali Loss: 0.1250710 Test Loss: 0.1354092
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.038129281252622604, rmse:0.1952672004699707, mae:0.13184794783592224, rse:0.6916521191596985
Intermediate time for DE and pred_len 168: 02h:07m:50.46s
Intermediate time for DE: 02h:07m:50.46s
Total time: 02h:07m:50.47s

=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1219332
	speed: 0.7428s/iter; left time: 6552.6592s
	iters: 200, epoch: 1 | loss: 0.1024333
	speed: 0.7226s/iter; left time: 6301.5187s
	iters: 300, epoch: 1 | loss: 0.1022332
	speed: 0.7233s/iter; left time: 6235.2077s
	iters: 400, epoch: 1 | loss: 0.1033723
	speed: 0.7239s/iter; left time: 6168.6866s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:22.40s
Steps: 446 | Train Loss: 0.1046786 Vali Loss: 0.0984132 Test Loss: 0.1100580
Validation loss decreased (inf --> 0.098413).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0855073
	speed: 1.5475s/iter; left time: 12960.1579s
	iters: 200, epoch: 2 | loss: 0.0783024
	speed: 0.7216s/iter; left time: 5971.4912s
	iters: 300, epoch: 2 | loss: 0.0844687
	speed: 0.7228s/iter; left time: 5908.5664s
	iters: 400, epoch: 2 | loss: 0.0816016
	speed: 0.7225s/iter; left time: 5833.9064s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.92s
Steps: 446 | Train Loss: 0.0870877 Vali Loss: 0.0947954 Test Loss: 0.1068336
Validation loss decreased (0.098413 --> 0.094795).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0839364
	speed: 1.5469s/iter; left time: 12265.5359s
	iters: 200, epoch: 3 | loss: 0.0807079
	speed: 0.7224s/iter; left time: 5655.3335s
	iters: 300, epoch: 3 | loss: 0.0775501
	speed: 0.7236s/iter; left time: 5592.4222s
	iters: 400, epoch: 3 | loss: 0.0849948
	speed: 0.7234s/iter; left time: 5518.8383s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:22.17s
Steps: 446 | Train Loss: 0.0796255 Vali Loss: 0.0925564 Test Loss: 0.1053773
Validation loss decreased (0.094795 --> 0.092556).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0687476
	speed: 1.5464s/iter; left time: 11571.6041s
	iters: 200, epoch: 4 | loss: 0.0774653
	speed: 0.7223s/iter; left time: 5333.1055s
	iters: 300, epoch: 4 | loss: 0.0766640
	speed: 0.7220s/iter; left time: 5257.9686s
	iters: 400, epoch: 4 | loss: 0.0655040
	speed: 0.7218s/iter; left time: 5184.8716s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.74s
Steps: 446 | Train Loss: 0.0781583 Vali Loss: 0.0926571 Test Loss: 0.1037235
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0765439
	speed: 1.5453s/iter; left time: 10873.9783s
	iters: 200, epoch: 5 | loss: 0.0812892
	speed: 0.7233s/iter; left time: 5017.8689s
	iters: 300, epoch: 5 | loss: 0.0820643
	speed: 0.7223s/iter; left time: 4938.2721s
	iters: 400, epoch: 5 | loss: 0.0802298
	speed: 0.7218s/iter; left time: 4863.0216s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.93s
Steps: 446 | Train Loss: 0.0772478 Vali Loss: 0.0924165 Test Loss: 0.1035370
Validation loss decreased (0.092556 --> 0.092416).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0734272
	speed: 1.5482s/iter; left time: 10204.3907s
	iters: 200, epoch: 6 | loss: 0.0776210
	speed: 0.7229s/iter; left time: 4692.1818s
	iters: 300, epoch: 6 | loss: 0.0754134
	speed: 0.7227s/iter; left time: 4618.8232s
	iters: 400, epoch: 6 | loss: 0.0721301
	speed: 0.7216s/iter; left time: 4539.7981s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.98s
Steps: 446 | Train Loss: 0.0764871 Vali Loss: 0.0915778 Test Loss: 0.1038223
Validation loss decreased (0.092416 --> 0.091578).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0738436
	speed: 1.5477s/iter; left time: 9510.3653s
	iters: 200, epoch: 7 | loss: 0.0760788
	speed: 0.7232s/iter; left time: 4371.6215s
	iters: 300, epoch: 7 | loss: 0.0697793
	speed: 0.7228s/iter; left time: 4297.1047s
	iters: 400, epoch: 7 | loss: 0.0845214
	speed: 0.7221s/iter; left time: 4220.4467s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:22.08s
Steps: 446 | Train Loss: 0.0757022 Vali Loss: 0.0913743 Test Loss: 0.1031549
Validation loss decreased (0.091578 --> 0.091374).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0746214
	speed: 1.5471s/iter; left time: 8817.0034s
	iters: 200, epoch: 8 | loss: 0.0730648
	speed: 0.7206s/iter; left time: 4034.5442s
	iters: 300, epoch: 8 | loss: 0.0785622
	speed: 0.7213s/iter; left time: 3966.2285s
	iters: 400, epoch: 8 | loss: 0.0760245
	speed: 0.7225s/iter; left time: 3900.9451s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.56s
Steps: 446 | Train Loss: 0.0752497 Vali Loss: 0.0912799 Test Loss: 0.1036609
Validation loss decreased (0.091374 --> 0.091280).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0708371
	speed: 1.5466s/iter; left time: 8124.2027s
	iters: 200, epoch: 9 | loss: 0.0793307
	speed: 0.7219s/iter; left time: 3720.1037s
	iters: 300, epoch: 9 | loss: 0.0700741
	speed: 0.7224s/iter; left time: 3650.1153s
	iters: 400, epoch: 9 | loss: 0.0690910
	speed: 0.7228s/iter; left time: 3579.9006s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:21.92s
Steps: 446 | Train Loss: 0.0747273 Vali Loss: 0.0910398 Test Loss: 0.1039238
Validation loss decreased (0.091280 --> 0.091040).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0807302
	speed: 1.5468s/iter; left time: 7435.2732s
	iters: 200, epoch: 10 | loss: 0.0741905
	speed: 0.7217s/iter; left time: 3397.1299s
	iters: 300, epoch: 10 | loss: 0.0719303
	speed: 0.7220s/iter; left time: 3326.1992s
	iters: 400, epoch: 10 | loss: 0.0694591
	speed: 0.7226s/iter; left time: 3256.7041s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:21.84s
Steps: 446 | Train Loss: 0.0745116 Vali Loss: 0.0914712 Test Loss: 0.1038748
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0665877
	speed: 1.5460s/iter; left time: 6742.1649s
	iters: 200, epoch: 11 | loss: 0.0759876
	speed: 0.7226s/iter; left time: 3078.8819s
	iters: 300, epoch: 11 | loss: 0.0824373
	speed: 0.7220s/iter; left time: 3004.2553s
	iters: 400, epoch: 11 | loss: 0.0790424
	speed: 0.7220s/iter; left time: 2932.2004s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:05m:21.85s
Steps: 446 | Train Loss: 0.0740387 Vali Loss: 0.0906129 Test Loss: 0.1030152
Validation loss decreased (0.091040 --> 0.090613).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0771967
	speed: 1.5468s/iter; left time: 6055.5849s
	iters: 200, epoch: 12 | loss: 0.0759658
	speed: 0.7222s/iter; left time: 2755.0613s
	iters: 300, epoch: 12 | loss: 0.0731023
	speed: 0.7231s/iter; left time: 2686.2000s
	iters: 400, epoch: 12 | loss: 0.0742133
	speed: 0.7223s/iter; left time: 2610.9950s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:05m:21.89s
Steps: 446 | Train Loss: 0.0737958 Vali Loss: 0.0908876 Test Loss: 0.1027530
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0764889
	speed: 1.5464s/iter; left time: 5364.3806s
	iters: 200, epoch: 13 | loss: 0.0755783
	speed: 0.7223s/iter; left time: 2433.5778s
	iters: 300, epoch: 13 | loss: 0.0816595
	speed: 0.7225s/iter; left time: 2361.8615s
	iters: 400, epoch: 13 | loss: 0.0731592
	speed: 0.7216s/iter; left time: 2286.7780s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:05m:21.81s
Steps: 446 | Train Loss: 0.0736286 Vali Loss: 0.0908547 Test Loss: 0.1028892
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0695175
	speed: 1.5452s/iter; left time: 4671.1303s
	iters: 200, epoch: 14 | loss: 0.0712242
	speed: 0.7218s/iter; left time: 2109.7876s
	iters: 300, epoch: 14 | loss: 0.0718494
	speed: 0.7219s/iter; left time: 2038.0398s
	iters: 400, epoch: 14 | loss: 0.0740973
	speed: 0.7215s/iter; left time: 1964.7247s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:05m:21.67s
Steps: 446 | Train Loss: 0.0733159 Vali Loss: 0.0907835 Test Loss: 0.1033884
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0703520
	speed: 1.5457s/iter; left time: 3983.2886s
	iters: 200, epoch: 15 | loss: 0.0772918
	speed: 0.7224s/iter; left time: 1789.5017s
	iters: 300, epoch: 15 | loss: 0.0773213
	speed: 0.7221s/iter; left time: 1716.3147s
	iters: 400, epoch: 15 | loss: 0.0743252
	speed: 0.7216s/iter; left time: 1642.9894s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:05m:21.77s
Steps: 446 | Train Loss: 0.0729883 Vali Loss: 0.0908919 Test Loss: 0.1035982
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0702413
	speed: 1.5441s/iter; left time: 3290.5245s
	iters: 200, epoch: 16 | loss: 0.0681836
	speed: 0.7218s/iter; left time: 1465.9052s
	iters: 300, epoch: 16 | loss: 0.0751474
	speed: 0.7223s/iter; left time: 1394.8323s
	iters: 400, epoch: 16 | loss: 0.0667658
	speed: 0.7208s/iter; left time: 1319.8151s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:05m:21.55s
Steps: 446 | Train Loss: 0.0727462 Vali Loss: 0.0909174 Test Loss: 0.1037713
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.0257842019200325, rmse:0.16057460010051727, mae:0.10301516950130463, rse:0.5536574721336365
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1223212
	speed: 0.7204s/iter; left time: 6354.9551s
	iters: 200, epoch: 1 | loss: 0.1109749
	speed: 0.7224s/iter; left time: 6299.6773s
	iters: 300, epoch: 1 | loss: 0.0958279
	speed: 0.7212s/iter; left time: 6217.6521s
	iters: 400, epoch: 1 | loss: 0.1010641
	speed: 0.7221s/iter; left time: 6152.6990s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.89s
Steps: 446 | Train Loss: 0.1056198 Vali Loss: 0.0990690 Test Loss: 0.1104915
Validation loss decreased (inf --> 0.099069).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1048655
	speed: 1.5489s/iter; left time: 12972.3294s
	iters: 200, epoch: 2 | loss: 0.0949212
	speed: 0.7227s/iter; left time: 5980.6024s
	iters: 300, epoch: 2 | loss: 0.0733032
	speed: 0.7224s/iter; left time: 5905.3333s
	iters: 400, epoch: 2 | loss: 0.0826025
	speed: 0.7225s/iter; left time: 5833.9546s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:22.08s
Steps: 446 | Train Loss: 0.0879247 Vali Loss: 0.0949888 Test Loss: 0.1062320
Validation loss decreased (0.099069 --> 0.094989).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0822730
	speed: 1.5470s/iter; left time: 12266.4053s
	iters: 200, epoch: 3 | loss: 0.0822893
	speed: 0.7222s/iter; left time: 5654.1267s
	iters: 300, epoch: 3 | loss: 0.0747745
	speed: 0.7235s/iter; left time: 5591.6972s
	iters: 400, epoch: 3 | loss: 0.0762639
	speed: 0.7225s/iter; left time: 5512.0893s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:21.98s
Steps: 446 | Train Loss: 0.0797090 Vali Loss: 0.0940979 Test Loss: 0.1054173
Validation loss decreased (0.094989 --> 0.094098).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0835317
	speed: 1.5450s/iter; left time: 11560.8813s
	iters: 200, epoch: 4 | loss: 0.0764792
	speed: 0.7211s/iter; left time: 5324.2409s
	iters: 300, epoch: 4 | loss: 0.0818770
	speed: 0.7231s/iter; left time: 5266.6996s
	iters: 400, epoch: 4 | loss: 0.0797776
	speed: 0.7229s/iter; left time: 5192.2628s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.83s
Steps: 446 | Train Loss: 0.0784254 Vali Loss: 0.0924348 Test Loss: 0.1047190
Validation loss decreased (0.094098 --> 0.092435).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0733963
	speed: 1.5472s/iter; left time: 10887.3338s
	iters: 200, epoch: 5 | loss: 0.0847620
	speed: 0.7220s/iter; left time: 5008.7392s
	iters: 300, epoch: 5 | loss: 0.0747245
	speed: 0.7227s/iter; left time: 4940.9523s
	iters: 400, epoch: 5 | loss: 0.0712147
	speed: 0.7224s/iter; left time: 4866.5979s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.81s
Steps: 446 | Train Loss: 0.0772208 Vali Loss: 0.0918992 Test Loss: 0.1033505
Validation loss decreased (0.092435 --> 0.091899).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0869290
	speed: 1.5516s/iter; left time: 10226.3349s
	iters: 200, epoch: 6 | loss: 0.0778094
	speed: 0.7234s/iter; left time: 4695.3109s
	iters: 300, epoch: 6 | loss: 0.0768922
	speed: 0.7221s/iter; left time: 4614.7775s
	iters: 400, epoch: 6 | loss: 0.0721140
	speed: 0.7216s/iter; left time: 4539.8326s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.99s
Steps: 446 | Train Loss: 0.0765315 Vali Loss: 0.0917558 Test Loss: 0.1043687
Validation loss decreased (0.091899 --> 0.091756).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0639233
	speed: 1.5485s/iter; left time: 9515.4773s
	iters: 200, epoch: 7 | loss: 0.0788913
	speed: 0.7219s/iter; left time: 4363.8790s
	iters: 300, epoch: 7 | loss: 0.0695109
	speed: 0.7219s/iter; left time: 4291.7413s
	iters: 400, epoch: 7 | loss: 0.0764161
	speed: 0.7222s/iter; left time: 4221.4773s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.80s
Steps: 446 | Train Loss: 0.0758669 Vali Loss: 0.0917126 Test Loss: 0.1038388
Validation loss decreased (0.091756 --> 0.091713).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0699027
	speed: 1.5469s/iter; left time: 8815.6905s
	iters: 200, epoch: 8 | loss: 0.0763023
	speed: 0.7217s/iter; left time: 4040.8300s
	iters: 300, epoch: 8 | loss: 0.0770946
	speed: 0.7219s/iter; left time: 3969.5348s
	iters: 400, epoch: 8 | loss: 0.0690929
	speed: 0.7225s/iter; left time: 3900.5083s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.74s
Steps: 446 | Train Loss: 0.0753477 Vali Loss: 0.0920663 Test Loss: 0.1040665
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0754340
	speed: 1.5464s/iter; left time: 8123.2628s
	iters: 200, epoch: 9 | loss: 0.0826380
	speed: 0.7222s/iter; left time: 3721.3956s
	iters: 300, epoch: 9 | loss: 0.0806511
	speed: 0.7231s/iter; left time: 3653.5835s
	iters: 400, epoch: 9 | loss: 0.0717999
	speed: 0.7232s/iter; left time: 3581.8181s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:22.07s
Steps: 446 | Train Loss: 0.0747362 Vali Loss: 0.0910829 Test Loss: 0.1043383
Validation loss decreased (0.091713 --> 0.091083).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0763082
	speed: 1.5457s/iter; left time: 7430.2257s
	iters: 200, epoch: 10 | loss: 0.0721856
	speed: 0.7210s/iter; left time: 3393.6484s
	iters: 300, epoch: 10 | loss: 0.0724662
	speed: 0.7207s/iter; left time: 3320.3346s
	iters: 400, epoch: 10 | loss: 0.0727393
	speed: 0.7204s/iter; left time: 3246.8079s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:21.29s
Steps: 446 | Train Loss: 0.0741925 Vali Loss: 0.0911935 Test Loss: 0.1036577
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0745159
	speed: 1.5457s/iter; left time: 6740.8282s
	iters: 200, epoch: 11 | loss: 0.0698466
	speed: 0.7220s/iter; left time: 3076.4633s
	iters: 300, epoch: 11 | loss: 0.0749595
	speed: 0.7227s/iter; left time: 3007.2967s
	iters: 400, epoch: 11 | loss: 0.0744197
	speed: 0.7231s/iter; left time: 2936.3376s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:05m:21.93s
Steps: 446 | Train Loss: 0.0738326 Vali Loss: 0.0908359 Test Loss: 0.1036460
Validation loss decreased (0.091083 --> 0.090836).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0805448
	speed: 1.5485s/iter; left time: 6062.2327s
	iters: 200, epoch: 12 | loss: 0.0708218
	speed: 0.7220s/iter; left time: 2754.2982s
	iters: 300, epoch: 12 | loss: 0.0734646
	speed: 0.7219s/iter; left time: 2681.9264s
	iters: 400, epoch: 12 | loss: 0.0736801
	speed: 0.7221s/iter; left time: 2610.3860s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:05m:21.75s
Steps: 446 | Train Loss: 0.0735385 Vali Loss: 0.0908725 Test Loss: 0.1042555
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0686647
	speed: 1.5462s/iter; left time: 5363.8981s
	iters: 200, epoch: 13 | loss: 0.0808488
	speed: 0.7225s/iter; left time: 2434.1096s
	iters: 300, epoch: 13 | loss: 0.0725826
	speed: 0.7223s/iter; left time: 2361.2400s
	iters: 400, epoch: 13 | loss: 0.0712819
	speed: 0.7222s/iter; left time: 2288.7017s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:05m:21.93s
Steps: 446 | Train Loss: 0.0731788 Vali Loss: 0.0907354 Test Loss: 0.1043515
Validation loss decreased (0.090836 --> 0.090735).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0717573
	speed: 1.5466s/iter; left time: 4675.3653s
	iters: 200, epoch: 14 | loss: 0.0735951
	speed: 0.7229s/iter; left time: 2113.0609s
	iters: 300, epoch: 14 | loss: 0.0756077
	speed: 0.7224s/iter; left time: 2039.3480s
	iters: 400, epoch: 14 | loss: 0.0714499
	speed: 0.7224s/iter; left time: 1967.0534s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:05m:21.96s
Steps: 446 | Train Loss: 0.0729430 Vali Loss: 0.0908874 Test Loss: 0.1040816
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0739358
	speed: 1.5453s/iter; left time: 3982.2669s
	iters: 200, epoch: 15 | loss: 0.0667566
	speed: 0.7221s/iter; left time: 1788.5468s
	iters: 300, epoch: 15 | loss: 0.0775356
	speed: 0.7225s/iter; left time: 1717.3378s
	iters: 400, epoch: 15 | loss: 0.0641175
	speed: 0.7220s/iter; left time: 1643.9046s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:05m:21.84s
Steps: 446 | Train Loss: 0.0729414 Vali Loss: 0.0911770 Test Loss: 0.1036382
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0695575
	speed: 1.5475s/iter; left time: 3297.7072s
	iters: 200, epoch: 16 | loss: 0.0769181
	speed: 0.7226s/iter; left time: 1467.5426s
	iters: 300, epoch: 16 | loss: 0.0736728
	speed: 0.7229s/iter; left time: 1395.8903s
	iters: 400, epoch: 16 | loss: 0.0716758
	speed: 0.7226s/iter; left time: 1323.0942s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:05m:22.01s
Steps: 446 | Train Loss: 0.0724963 Vali Loss: 0.0906650 Test Loss: 0.1038792
Validation loss decreased (0.090735 --> 0.090665).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0723858
	speed: 1.5473s/iter; left time: 2607.2773s
	iters: 200, epoch: 17 | loss: 0.0736733
	speed: 0.7236s/iter; left time: 1146.8453s
	iters: 300, epoch: 17 | loss: 0.0749675
	speed: 0.7249s/iter; left time: 1076.4802s
	iters: 400, epoch: 17 | loss: 0.0736499
	speed: 0.7243s/iter; left time: 1003.1917s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:05m:22.58s
Steps: 446 | Train Loss: 0.0722636 Vali Loss: 0.0908735 Test Loss: 0.1035602
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0724906
	speed: 1.5479s/iter; left time: 1917.9022s
	iters: 200, epoch: 18 | loss: 0.0761817
	speed: 0.7228s/iter; left time: 823.2189s
	iters: 300, epoch: 18 | loss: 0.0695338
	speed: 0.7232s/iter; left time: 751.4221s
	iters: 400, epoch: 18 | loss: 0.0777647
	speed: 0.7234s/iter; left time: 679.2640s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:05m:22.21s
Steps: 446 | Train Loss: 0.0721601 Vali Loss: 0.0911730 Test Loss: 0.1042385
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0764718
	speed: 1.5460s/iter; left time: 1225.9518s
	iters: 200, epoch: 19 | loss: 0.0848267
	speed: 0.7216s/iter; left time: 500.0517s
	iters: 300, epoch: 19 | loss: 0.0749574
	speed: 0.7228s/iter; left time: 428.6100s
	iters: 400, epoch: 19 | loss: 0.0665007
	speed: 0.7233s/iter; left time: 356.6065s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:05m:21.96s
Steps: 446 | Train Loss: 0.0718833 Vali Loss: 0.0906337 Test Loss: 0.1042256
Validation loss decreased (0.090665 --> 0.090634).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0696649
	speed: 1.5500s/iter; left time: 537.8445s
	iters: 200, epoch: 20 | loss: 0.0763954
	speed: 0.7230s/iter; left time: 178.5922s
	iters: 300, epoch: 20 | loss: 0.0783339
	speed: 0.7220s/iter; left time: 106.1271s
	iters: 400, epoch: 20 | loss: 0.0636169
	speed: 0.7220s/iter; left time: 33.9321s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:05m:21.97s
Steps: 446 | Train Loss: 0.0717783 Vali Loss: 0.0908381 Test Loss: 0.1045747
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02680579200387001, rmse:0.16372475028038025, mae:0.10422558337450027, rse:0.5645191073417664
Intermediate time for GB and pred_len 24: 03h:43m:50.34s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1188991
	speed: 0.7446s/iter; left time: 6553.1496s
	iters: 200, epoch: 1 | loss: 0.1258157
	speed: 0.7224s/iter; left time: 6286.0059s
	iters: 300, epoch: 1 | loss: 0.1145033
	speed: 0.7231s/iter; left time: 6219.1056s
	iters: 400, epoch: 1 | loss: 0.1124089
	speed: 0.7245s/iter; left time: 6158.6095s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.82s
Steps: 445 | Train Loss: 0.1194622 Vali Loss: 0.1203057 Test Loss: 0.1409714
Validation loss decreased (inf --> 0.120306).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1060973
	speed: 1.5403s/iter; left time: 12871.0886s
	iters: 200, epoch: 2 | loss: 0.1054947
	speed: 0.7229s/iter; left time: 5967.9163s
	iters: 300, epoch: 2 | loss: 0.1012525
	speed: 0.7234s/iter; left time: 5899.8813s
	iters: 400, epoch: 2 | loss: 0.1048109
	speed: 0.7230s/iter; left time: 5824.1661s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.61s
Steps: 445 | Train Loss: 0.1086014 Vali Loss: 0.1182096 Test Loss: 0.1379317
Validation loss decreased (0.120306 --> 0.118210).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0981685
	speed: 1.5398s/iter; left time: 12181.6903s
	iters: 200, epoch: 3 | loss: 0.0995334
	speed: 0.7231s/iter; left time: 5647.8041s
	iters: 300, epoch: 3 | loss: 0.1025032
	speed: 0.7226s/iter; left time: 5572.1808s
	iters: 400, epoch: 3 | loss: 0.1047765
	speed: 0.7224s/iter; left time: 5498.3824s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:21.41s
Steps: 445 | Train Loss: 0.1029424 Vali Loss: 0.1177070 Test Loss: 0.1377220
Validation loss decreased (0.118210 --> 0.117707).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1033335
	speed: 1.5390s/iter; left time: 11490.0934s
	iters: 200, epoch: 4 | loss: 0.0971359
	speed: 0.7229s/iter; left time: 5324.8843s
	iters: 300, epoch: 4 | loss: 0.1039681
	speed: 0.7233s/iter; left time: 5255.3843s
	iters: 400, epoch: 4 | loss: 0.1018714
	speed: 0.7239s/iter; left time: 5187.7463s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.70s
Steps: 445 | Train Loss: 0.1014575 Vali Loss: 0.1172981 Test Loss: 0.1390135
Validation loss decreased (0.117707 --> 0.117298).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0986772
	speed: 1.5409s/iter; left time: 10818.9697s
	iters: 200, epoch: 5 | loss: 0.1004360
	speed: 0.7234s/iter; left time: 5006.7784s
	iters: 300, epoch: 5 | loss: 0.1021069
	speed: 0.7237s/iter; left time: 4936.3954s
	iters: 400, epoch: 5 | loss: 0.1036617
	speed: 0.7234s/iter; left time: 4862.2465s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.79s
Steps: 445 | Train Loss: 0.1003886 Vali Loss: 0.1174561 Test Loss: 0.1384568
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0893148
	speed: 1.5366s/iter; left time: 10104.4465s
	iters: 200, epoch: 6 | loss: 0.1025511
	speed: 0.7234s/iter; left time: 4684.9832s
	iters: 300, epoch: 6 | loss: 0.0984011
	speed: 0.7235s/iter; left time: 4613.0552s
	iters: 400, epoch: 6 | loss: 0.0908742
	speed: 0.7236s/iter; left time: 4541.4851s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.67s
Steps: 445 | Train Loss: 0.0993284 Vali Loss: 0.1173354 Test Loss: 0.1386353
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0981149
	speed: 1.5366s/iter; left time: 9421.1709s
	iters: 200, epoch: 7 | loss: 0.0987756
	speed: 0.7229s/iter; left time: 4359.9569s
	iters: 300, epoch: 7 | loss: 0.1015742
	speed: 0.7232s/iter; left time: 4289.0558s
	iters: 400, epoch: 7 | loss: 0.1007333
	speed: 0.7240s/iter; left time: 4221.4921s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.65s
Steps: 445 | Train Loss: 0.0982707 Vali Loss: 0.1172025 Test Loss: 0.1396473
Validation loss decreased (0.117298 --> 0.117202).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1011315
	speed: 1.5388s/iter; left time: 8749.6684s
	iters: 200, epoch: 8 | loss: 0.0955999
	speed: 0.7233s/iter; left time: 4040.5444s
	iters: 300, epoch: 8 | loss: 0.0927152
	speed: 0.7240s/iter; left time: 3971.8043s
	iters: 400, epoch: 8 | loss: 0.0963988
	speed: 0.7248s/iter; left time: 3903.8968s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.86s
Steps: 445 | Train Loss: 0.0972631 Vali Loss: 0.1185608 Test Loss: 0.1409663
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0895910
	speed: 1.5364s/iter; left time: 8052.3826s
	iters: 200, epoch: 9 | loss: 0.0927334
	speed: 0.7234s/iter; left time: 3719.0903s
	iters: 300, epoch: 9 | loss: 0.0897258
	speed: 0.7234s/iter; left time: 3646.7180s
	iters: 400, epoch: 9 | loss: 0.0940008
	speed: 0.7225s/iter; left time: 3569.8094s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:21.54s
Steps: 445 | Train Loss: 0.0965216 Vali Loss: 0.1189555 Test Loss: 0.1413811
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0918480
	speed: 1.5356s/iter; left time: 7364.6638s
	iters: 200, epoch: 10 | loss: 0.0968573
	speed: 0.7240s/iter; left time: 3400.0162s
	iters: 300, epoch: 10 | loss: 0.0923992
	speed: 0.7236s/iter; left time: 3325.7325s
	iters: 400, epoch: 10 | loss: 0.0955297
	speed: 0.7225s/iter; left time: 3248.2861s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:21.55s
Steps: 445 | Train Loss: 0.0960486 Vali Loss: 0.1187378 Test Loss: 0.1414807
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0969280
	speed: 1.5363s/iter; left time: 6684.4926s
	iters: 200, epoch: 11 | loss: 0.0978501
	speed: 0.7234s/iter; left time: 3075.0561s
	iters: 300, epoch: 11 | loss: 0.0961718
	speed: 0.7236s/iter; left time: 3003.8390s
	iters: 400, epoch: 11 | loss: 0.0940737
	speed: 0.7234s/iter; left time: 2930.5224s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:05m:21.63s
Steps: 445 | Train Loss: 0.0954538 Vali Loss: 0.1184825 Test Loss: 0.1411882
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0959648
	speed: 1.5368s/iter; left time: 6002.8230s
	iters: 200, epoch: 12 | loss: 0.0974806
	speed: 0.7249s/iter; left time: 2758.9761s
	iters: 300, epoch: 12 | loss: 0.0978784
	speed: 0.7248s/iter; left time: 2686.1036s
	iters: 400, epoch: 12 | loss: 0.0945524
	speed: 0.7234s/iter; left time: 2608.4842s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:05m:21.96s
Steps: 445 | Train Loss: 0.0950015 Vali Loss: 0.1197978 Test Loss: 0.1418782
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04273901507258415, rmse:0.20673416554927826, mae:0.13964734971523285, rse:0.7149155735969543
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1254926
	speed: 0.7222s/iter; left time: 6355.9913s
	iters: 200, epoch: 1 | loss: 0.1262719
	speed: 0.7234s/iter; left time: 6294.6974s
	iters: 300, epoch: 1 | loss: 0.1167267
	speed: 0.7240s/iter; left time: 6227.0697s
	iters: 400, epoch: 1 | loss: 0.1183812
	speed: 0.7247s/iter; left time: 6161.0250s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:22.10s
Steps: 445 | Train Loss: 0.1196558 Vali Loss: 0.1200556 Test Loss: 0.1402801
Validation loss decreased (inf --> 0.120056).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1030922
	speed: 1.5430s/iter; left time: 12893.3993s
	iters: 200, epoch: 2 | loss: 0.0985917
	speed: 0.7234s/iter; left time: 5972.3237s
	iters: 300, epoch: 2 | loss: 0.1057069
	speed: 0.7234s/iter; left time: 5900.1452s
	iters: 400, epoch: 2 | loss: 0.1058126
	speed: 0.7245s/iter; left time: 5836.5640s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.95s
Steps: 445 | Train Loss: 0.1081899 Vali Loss: 0.1177829 Test Loss: 0.1383312
Validation loss decreased (0.120056 --> 0.117783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1002742
	speed: 1.5405s/iter; left time: 12186.7734s
	iters: 200, epoch: 3 | loss: 0.1039969
	speed: 0.7255s/iter; left time: 5667.1247s
	iters: 300, epoch: 3 | loss: 0.1005309
	speed: 0.7254s/iter; left time: 5593.4313s
	iters: 400, epoch: 3 | loss: 0.1030521
	speed: 0.7250s/iter; left time: 5518.0638s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:22.38s
Steps: 445 | Train Loss: 0.1030761 Vali Loss: 0.1180275 Test Loss: 0.1373049
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1052951
	speed: 1.5367s/iter; left time: 11472.9798s
	iters: 200, epoch: 4 | loss: 0.1022347
	speed: 0.7230s/iter; left time: 5325.3389s
	iters: 300, epoch: 4 | loss: 0.1008812
	speed: 0.7238s/iter; left time: 5259.3310s
	iters: 400, epoch: 4 | loss: 0.1062659
	speed: 0.7240s/iter; left time: 5187.8941s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.71s
Steps: 445 | Train Loss: 0.1014761 Vali Loss: 0.1169290 Test Loss: 0.1379385
Validation loss decreased (0.117783 --> 0.116929).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0991823
	speed: 1.5397s/iter; left time: 10810.0152s
	iters: 200, epoch: 5 | loss: 0.0929178
	speed: 0.7227s/iter; left time: 5002.1128s
	iters: 300, epoch: 5 | loss: 0.1054864
	speed: 0.7240s/iter; left time: 4938.2456s
	iters: 400, epoch: 5 | loss: 0.1040119
	speed: 0.7244s/iter; left time: 4868.8670s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.73s
Steps: 445 | Train Loss: 0.1003098 Vali Loss: 0.1167290 Test Loss: 0.1386056
Validation loss decreased (0.116929 --> 0.116729).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0926958
	speed: 1.5393s/iter; left time: 10122.6019s
	iters: 200, epoch: 6 | loss: 0.1062490
	speed: 0.7229s/iter; left time: 4681.2482s
	iters: 300, epoch: 6 | loss: 0.0956498
	speed: 0.7227s/iter; left time: 4607.6209s
	iters: 400, epoch: 6 | loss: 0.0995144
	speed: 0.7229s/iter; left time: 4537.0470s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.44s
Steps: 445 | Train Loss: 0.0992800 Vali Loss: 0.1163871 Test Loss: 0.1386412
Validation loss decreased (0.116729 --> 0.116387).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1018081
	speed: 1.5406s/iter; left time: 9445.4187s
	iters: 200, epoch: 7 | loss: 0.0991227
	speed: 0.7240s/iter; left time: 4366.5497s
	iters: 300, epoch: 7 | loss: 0.0977125
	speed: 0.7238s/iter; left time: 4292.9163s
	iters: 400, epoch: 7 | loss: 0.0994756
	speed: 0.7235s/iter; left time: 4218.4698s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.92s
Steps: 445 | Train Loss: 0.0979095 Vali Loss: 0.1171418 Test Loss: 0.1409759
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0997248
	speed: 1.5390s/iter; left time: 8751.0250s
	iters: 200, epoch: 8 | loss: 0.0984855
	speed: 0.7244s/iter; left time: 4046.3084s
	iters: 300, epoch: 8 | loss: 0.0952011
	speed: 0.7249s/iter; left time: 3977.0155s
	iters: 400, epoch: 8 | loss: 0.0986068
	speed: 0.7247s/iter; left time: 3903.0888s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:22.16s
Steps: 445 | Train Loss: 0.0968288 Vali Loss: 0.1180426 Test Loss: 0.1438864
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0881789
	speed: 1.5394s/iter; left time: 8068.1865s
	iters: 200, epoch: 9 | loss: 0.0972621
	speed: 0.7245s/iter; left time: 3724.7070s
	iters: 300, epoch: 9 | loss: 0.0959186
	speed: 0.7236s/iter; left time: 3647.8426s
	iters: 400, epoch: 9 | loss: 0.0947738
	speed: 0.7235s/iter; left time: 3574.7032s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:21.96s
Steps: 445 | Train Loss: 0.0960087 Vali Loss: 0.1174896 Test Loss: 0.1435654
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0913584
	speed: 1.5394s/iter; left time: 7383.0312s
	iters: 200, epoch: 10 | loss: 0.0958150
	speed: 0.7244s/iter; left time: 3401.7946s
	iters: 300, epoch: 10 | loss: 0.1004794
	speed: 0.7252s/iter; left time: 3332.9557s
	iters: 400, epoch: 10 | loss: 0.1038212
	speed: 0.7248s/iter; left time: 3258.8006s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:22.31s
Steps: 445 | Train Loss: 0.0953744 Vali Loss: 0.1182851 Test Loss: 0.1438330
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0947616
	speed: 1.5396s/iter; left time: 6698.7492s
	iters: 200, epoch: 11 | loss: 0.0908431
	speed: 0.7238s/iter; left time: 3077.0622s
	iters: 300, epoch: 11 | loss: 0.1015153
	speed: 0.7239s/iter; left time: 3004.7084s
	iters: 400, epoch: 11 | loss: 0.0926244
	speed: 0.7240s/iter; left time: 2933.0510s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:05m:21.95s
Steps: 445 | Train Loss: 0.0948551 Vali Loss: 0.1188730 Test Loss: 0.1439124
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04223436862230301, rmse:0.20551002025604248, mae:0.1386411190032959, rse:0.7106822729110718
Intermediate time for GB and pred_len 96: 02h:23m:13.32s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1209692
	speed: 0.7481s/iter; left time: 6569.4818s
	iters: 200, epoch: 1 | loss: 0.1206332
	speed: 0.7251s/iter; left time: 6294.8947s
	iters: 300, epoch: 1 | loss: 0.1155341
	speed: 0.7246s/iter; left time: 6217.6009s
	iters: 400, epoch: 1 | loss: 0.1202467
	speed: 0.7246s/iter; left time: 6145.0712s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.71s
Steps: 444 | Train Loss: 0.1223499 Vali Loss: 0.1237535 Test Loss: 0.1451118
Validation loss decreased (inf --> 0.123753).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1137304
	speed: 1.5257s/iter; left time: 12719.5329s
	iters: 200, epoch: 2 | loss: 0.1117810
	speed: 0.7246s/iter; left time: 5968.6192s
	iters: 300, epoch: 2 | loss: 0.1107004
	speed: 0.7255s/iter; left time: 5903.5073s
	iters: 400, epoch: 2 | loss: 0.1107576
	speed: 0.7258s/iter; left time: 5832.8609s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.71s
Steps: 444 | Train Loss: 0.1128777 Vali Loss: 0.1231070 Test Loss: 0.1448585
Validation loss decreased (0.123753 --> 0.123107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1097860
	speed: 1.5343s/iter; left time: 12110.6074s
	iters: 200, epoch: 3 | loss: 0.1081801
	speed: 0.7247s/iter; left time: 5647.3109s
	iters: 300, epoch: 3 | loss: 0.1044240
	speed: 0.7248s/iter; left time: 5575.9266s
	iters: 400, epoch: 3 | loss: 0.1110005
	speed: 0.7245s/iter; left time: 5501.1829s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:21.61s
Steps: 444 | Train Loss: 0.1070182 Vali Loss: 0.1226600 Test Loss: 0.1445296
Validation loss decreased (0.123107 --> 0.122660).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1096485
	speed: 1.5252s/iter; left time: 11361.1120s
	iters: 200, epoch: 4 | loss: 0.1083038
	speed: 0.7236s/iter; left time: 5317.9377s
	iters: 300, epoch: 4 | loss: 0.1045193
	speed: 0.7234s/iter; left time: 5243.8337s
	iters: 400, epoch: 4 | loss: 0.1044289
	speed: 0.7243s/iter; left time: 5177.8491s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.19s
Steps: 444 | Train Loss: 0.1055371 Vali Loss: 0.1215402 Test Loss: 0.1440945
Validation loss decreased (0.122660 --> 0.121540).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1069118
	speed: 1.5268s/iter; left time: 10695.1331s
	iters: 200, epoch: 5 | loss: 0.1019308
	speed: 0.7249s/iter; left time: 5005.6024s
	iters: 300, epoch: 5 | loss: 0.1098456
	speed: 0.7247s/iter; left time: 4931.6555s
	iters: 400, epoch: 5 | loss: 0.1021107
	speed: 0.7243s/iter; left time: 4856.7626s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.42s
Steps: 444 | Train Loss: 0.1045818 Vali Loss: 0.1210657 Test Loss: 0.1449654
Validation loss decreased (0.121540 --> 0.121066).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0988645
	speed: 1.5272s/iter; left time: 10020.2746s
	iters: 200, epoch: 6 | loss: 0.1031624
	speed: 0.7251s/iter; left time: 4684.8409s
	iters: 300, epoch: 6 | loss: 0.1071069
	speed: 0.7251s/iter; left time: 4612.2815s
	iters: 400, epoch: 6 | loss: 0.1069533
	speed: 0.7244s/iter; left time: 4535.2669s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.64s
Steps: 444 | Train Loss: 0.1034554 Vali Loss: 0.1212313 Test Loss: 0.1448745
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1001030
	speed: 1.5232s/iter; left time: 9317.3897s
	iters: 200, epoch: 7 | loss: 0.1038053
	speed: 0.7252s/iter; left time: 4363.6547s
	iters: 300, epoch: 7 | loss: 0.1049665
	speed: 0.7256s/iter; left time: 4293.2355s
	iters: 400, epoch: 7 | loss: 0.1051885
	speed: 0.7246s/iter; left time: 4215.0431s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.65s
Steps: 444 | Train Loss: 0.1024413 Vali Loss: 0.1220193 Test Loss: 0.1462498
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1033573
	speed: 1.5226s/iter; left time: 8637.6621s
	iters: 200, epoch: 8 | loss: 0.0982038
	speed: 0.7251s/iter; left time: 4041.1710s
	iters: 300, epoch: 8 | loss: 0.1045671
	speed: 0.7249s/iter; left time: 3967.1247s
	iters: 400, epoch: 8 | loss: 0.0941683
	speed: 0.7256s/iter; left time: 3898.3905s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.71s
Steps: 444 | Train Loss: 0.1014237 Vali Loss: 0.1226850 Test Loss: 0.1474843
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1033006
	speed: 1.5241s/iter; left time: 7969.5314s
	iters: 200, epoch: 9 | loss: 0.1017545
	speed: 0.7246s/iter; left time: 3716.3876s
	iters: 300, epoch: 9 | loss: 0.1064575
	speed: 0.7243s/iter; left time: 3642.7314s
	iters: 400, epoch: 9 | loss: 0.0985136
	speed: 0.7244s/iter; left time: 3570.3939s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:21.54s
Steps: 444 | Train Loss: 0.1006512 Vali Loss: 0.1233850 Test Loss: 0.1476156
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0993220
	speed: 1.5309s/iter; left time: 7325.5054s
	iters: 200, epoch: 10 | loss: 0.1046809
	speed: 0.7269s/iter; left time: 3405.6689s
	iters: 300, epoch: 10 | loss: 0.0983487
	speed: 0.7264s/iter; left time: 3330.6441s
	iters: 400, epoch: 10 | loss: 0.0988853
	speed: 0.7264s/iter; left time: 3257.9064s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:22.42s
Steps: 444 | Train Loss: 0.0996934 Vali Loss: 0.1239554 Test Loss: 0.1500023
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04448096826672554, rmse:0.21090511977672577, mae:0.14496536552906036, rse:0.7312383055686951
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1302179
	speed: 0.7245s/iter; left time: 6361.7874s
	iters: 200, epoch: 1 | loss: 0.1236320
	speed: 0.7277s/iter; left time: 6317.5133s
	iters: 300, epoch: 1 | loss: 0.1180836
	speed: 0.7278s/iter; left time: 6244.9009s
	iters: 400, epoch: 1 | loss: 0.1188810
	speed: 0.7262s/iter; left time: 6158.9643s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:22.63s
Steps: 444 | Train Loss: 0.1229862 Vali Loss: 0.1237203 Test Loss: 0.1452080
Validation loss decreased (inf --> 0.123720).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1125070
	speed: 1.5423s/iter; left time: 12858.5650s
	iters: 200, epoch: 2 | loss: 0.1139582
	speed: 0.7271s/iter; left time: 5989.4949s
	iters: 300, epoch: 2 | loss: 0.1070397
	speed: 0.7271s/iter; left time: 5916.1598s
	iters: 400, epoch: 2 | loss: 0.1052255
	speed: 0.7275s/iter; left time: 5846.8359s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:22.59s
Steps: 444 | Train Loss: 0.1118856 Vali Loss: 0.1231725 Test Loss: 0.1444469
Validation loss decreased (0.123720 --> 0.123173).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1071244
	speed: 1.5433s/iter; left time: 12181.2249s
	iters: 200, epoch: 3 | loss: 0.1071742
	speed: 0.7276s/iter; left time: 5669.8628s
	iters: 300, epoch: 3 | loss: 0.1038239
	speed: 0.7267s/iter; left time: 5590.6446s
	iters: 400, epoch: 3 | loss: 0.1081721
	speed: 0.7259s/iter; left time: 5511.5122s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:22.41s
Steps: 444 | Train Loss: 0.1066517 Vali Loss: 0.1217080 Test Loss: 0.1440828
Validation loss decreased (0.123173 --> 0.121708).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1037679
	speed: 1.5392s/iter; left time: 11465.2021s
	iters: 200, epoch: 4 | loss: 0.0980872
	speed: 0.7250s/iter; left time: 5327.9109s
	iters: 300, epoch: 4 | loss: 0.1007395
	speed: 0.7254s/iter; left time: 5258.1201s
	iters: 400, epoch: 4 | loss: 0.1037688
	speed: 0.7254s/iter; left time: 5186.1416s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.93s
Steps: 444 | Train Loss: 0.1055548 Vali Loss: 0.1222974 Test Loss: 0.1450494
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1093248
	speed: 1.5252s/iter; left time: 10684.2335s
	iters: 200, epoch: 5 | loss: 0.1046760
	speed: 0.7238s/iter; left time: 4997.6258s
	iters: 300, epoch: 5 | loss: 0.1080670
	speed: 0.7237s/iter; left time: 4924.6665s
	iters: 400, epoch: 5 | loss: 0.1031750
	speed: 0.7236s/iter; left time: 4851.6571s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.12s
Steps: 444 | Train Loss: 0.1041867 Vali Loss: 0.1221491 Test Loss: 0.1456396
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1056967
	speed: 1.5258s/iter; left time: 10010.6303s
	iters: 200, epoch: 6 | loss: 0.1109439
	speed: 0.7242s/iter; left time: 4678.8370s
	iters: 300, epoch: 6 | loss: 0.1039544
	speed: 0.7256s/iter; left time: 4615.4154s
	iters: 400, epoch: 6 | loss: 0.1036479
	speed: 0.7251s/iter; left time: 4539.6301s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.66s
Steps: 444 | Train Loss: 0.1026235 Vali Loss: 0.1229029 Test Loss: 0.1473666
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1077523
	speed: 1.5272s/iter; left time: 9341.7808s
	iters: 200, epoch: 7 | loss: 0.1001811
	speed: 0.7238s/iter; left time: 4354.8739s
	iters: 300, epoch: 7 | loss: 0.1044028
	speed: 0.7240s/iter; left time: 4283.9003s
	iters: 400, epoch: 7 | loss: 0.1003266
	speed: 0.7263s/iter; left time: 4224.9988s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.71s
Steps: 444 | Train Loss: 0.1013702 Vali Loss: 0.1239985 Test Loss: 0.1484034
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0990335
	speed: 1.5341s/iter; left time: 8702.7152s
	iters: 200, epoch: 8 | loss: 0.1003062
	speed: 0.7279s/iter; left time: 4056.5230s
	iters: 300, epoch: 8 | loss: 0.0976104
	speed: 0.7272s/iter; left time: 3980.0496s
	iters: 400, epoch: 8 | loss: 0.1021295
	speed: 0.7270s/iter; left time: 3906.0954s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:22.82s
Steps: 444 | Train Loss: 0.1003801 Vali Loss: 0.1252040 Test Loss: 0.1493507
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04388834163546562, rmse:0.2094954401254654, mae:0.14408287405967712, rse:0.7263507843017578
Intermediate time for GB and pred_len 168: 01h:52m:15.37s
Intermediate time for GB: 07h:59m:19.03s
Total time: 07h:59m:19.03s

=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1029446
	speed: 0.5130s/iter; left time: 2247.2404s
	iters: 200, epoch: 1 | loss: 0.0990795
	speed: 0.4651s/iter; left time: 1991.2373s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:46.26s
Steps: 224 | Train Loss: 0.1079208 Vali Loss: 0.0759579 Test Loss: 0.0847905
Validation loss decreased (inf --> 0.075958).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0776041
	speed: 0.9138s/iter; left time: 3798.5559s
	iters: 200, epoch: 2 | loss: 0.0662459
	speed: 0.4663s/iter; left time: 1891.7080s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:49.94s
Steps: 224 | Train Loss: 0.0756754 Vali Loss: 0.0681889 Test Loss: 0.0746097
Validation loss decreased (0.075958 --> 0.068189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0684085
	speed: 0.8864s/iter; left time: 3486.3620s
	iters: 200, epoch: 3 | loss: 0.0653357
	speed: 0.4730s/iter; left time: 1813.0152s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:47.36s
Steps: 224 | Train Loss: 0.0677710 Vali Loss: 0.0649290 Test Loss: 0.0719882
Validation loss decreased (0.068189 --> 0.064929).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0651796
	speed: 0.8669s/iter; left time: 3215.2448s
	iters: 200, epoch: 4 | loss: 0.0659340
	speed: 0.4748s/iter; left time: 1713.4052s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:46.58s
Steps: 224 | Train Loss: 0.0651402 Vali Loss: 0.0636680 Test Loss: 0.0708732
Validation loss decreased (0.064929 --> 0.063668).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0599553
	speed: 0.8757s/iter; left time: 3051.9186s
	iters: 200, epoch: 5 | loss: 0.0627105
	speed: 0.4733s/iter; left time: 1602.2809s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:47.22s
Steps: 224 | Train Loss: 0.0625719 Vali Loss: 0.0618946 Test Loss: 0.0692723
Validation loss decreased (0.063668 --> 0.061895).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0587988
	speed: 0.7268s/iter; left time: 2369.9770s
	iters: 200, epoch: 6 | loss: 0.0571924
	speed: 0.4101s/iter; left time: 1296.1887s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:33.01s
Steps: 224 | Train Loss: 0.0606071 Vali Loss: 0.0595530 Test Loss: 0.0669068
Validation loss decreased (0.061895 --> 0.059553).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0607307
	speed: 0.7002s/iter; left time: 2126.5190s
	iters: 200, epoch: 7 | loss: 0.0586838
	speed: 0.4155s/iter; left time: 1220.4534s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:33.06s
Steps: 224 | Train Loss: 0.0592641 Vali Loss: 0.0591412 Test Loss: 0.0664582
Validation loss decreased (0.059553 --> 0.059141).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0567253
	speed: 0.7093s/iter; left time: 1995.2450s
	iters: 200, epoch: 8 | loss: 0.0580647
	speed: 0.4175s/iter; left time: 1132.7368s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:33.52s
Steps: 224 | Train Loss: 0.0582934 Vali Loss: 0.0591095 Test Loss: 0.0662979
Validation loss decreased (0.059141 --> 0.059110).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0610105
	speed: 0.7011s/iter; left time: 1815.0298s
	iters: 200, epoch: 9 | loss: 0.0524651
	speed: 0.4154s/iter; left time: 1034.0471s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:33.54s
Steps: 224 | Train Loss: 0.0575675 Vali Loss: 0.0583953 Test Loss: 0.0656035
Validation loss decreased (0.059110 --> 0.058395).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0585550
	speed: 0.7002s/iter; left time: 1656.0559s
	iters: 200, epoch: 10 | loss: 0.0530401
	speed: 0.4159s/iter; left time: 942.0187s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:33.48s
Steps: 224 | Train Loss: 0.0571272 Vali Loss: 0.0575555 Test Loss: 0.0649217
Validation loss decreased (0.058395 --> 0.057555).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0531184
	speed: 0.7277s/iter; left time: 1558.1031s
	iters: 200, epoch: 11 | loss: 0.0544947
	speed: 0.3943s/iter; left time: 804.8646s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:29.84s
Steps: 224 | Train Loss: 0.0566428 Vali Loss: 0.0574256 Test Loss: 0.0651745
Validation loss decreased (0.057555 --> 0.057426).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0586503
	speed: 0.7934s/iter; left time: 1521.0381s
	iters: 200, epoch: 12 | loss: 0.0599026
	speed: 0.4468s/iter; left time: 811.7756s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:40.21s
Steps: 224 | Train Loss: 0.0562778 Vali Loss: 0.0575190 Test Loss: 0.0651269
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0554091
	speed: 0.8892s/iter; left time: 1505.3692s
	iters: 200, epoch: 13 | loss: 0.0555284
	speed: 0.4425s/iter; left time: 704.9628s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:40.66s
Steps: 224 | Train Loss: 0.0558332 Vali Loss: 0.0575139 Test Loss: 0.0649289
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0546675
	speed: 0.8115s/iter; left time: 1192.1205s
	iters: 200, epoch: 14 | loss: 0.0538944
	speed: 0.4502s/iter; left time: 616.3436s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:41.16s
Steps: 224 | Train Loss: 0.0555734 Vali Loss: 0.0573127 Test Loss: 0.0645391
Validation loss decreased (0.057426 --> 0.057313).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0518334
	speed: 0.8015s/iter; left time: 997.8246s
	iters: 200, epoch: 15 | loss: 0.0562424
	speed: 0.4553s/iter; left time: 521.2724s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:41.96s
Steps: 224 | Train Loss: 0.0554358 Vali Loss: 0.0570852 Test Loss: 0.0642410
Validation loss decreased (0.057313 --> 0.057085).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0567232
	speed: 0.8106s/iter; left time: 827.6014s
	iters: 200, epoch: 16 | loss: 0.0532635
	speed: 0.4531s/iter; left time: 417.2761s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:41.59s
Steps: 224 | Train Loss: 0.0551189 Vali Loss: 0.0569095 Test Loss: 0.0640773
Validation loss decreased (0.057085 --> 0.056909).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0566243
	speed: 0.8134s/iter; left time: 648.2597s
	iters: 200, epoch: 17 | loss: 0.0531764
	speed: 0.4506s/iter; left time: 314.0935s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:42.29s
Steps: 224 | Train Loss: 0.0549043 Vali Loss: 0.0567856 Test Loss: 0.0639867
Validation loss decreased (0.056909 --> 0.056786).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0531949
	speed: 0.8984s/iter; left time: 514.7581s
	iters: 200, epoch: 18 | loss: 0.0508188
	speed: 0.4556s/iter; left time: 215.5000s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:50.09s
Steps: 224 | Train Loss: 0.0545764 Vali Loss: 0.0564090 Test Loss: 0.0634984
Validation loss decreased (0.056786 --> 0.056409).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0523050
	speed: 0.8457s/iter; left time: 295.1415s
	iters: 200, epoch: 19 | loss: 0.0540444
	speed: 0.4468s/iter; left time: 111.2544s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:41.00s
Steps: 224 | Train Loss: 0.0545186 Vali Loss: 0.0565756 Test Loss: 0.0637340
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0527570
	speed: 0.8920s/iter; left time: 111.5052s
	iters: 200, epoch: 20 | loss: 0.0542966
	speed: 0.4556s/iter; left time: 11.3908s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:42.46s
Steps: 224 | Train Loss: 0.0543701 Vali Loss: 0.0568146 Test Loss: 0.0637774
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010762921534478664, rmse:0.1037444993853569, mae:0.06349841505289078, rse:0.3053075075149536
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1032665
	speed: 0.4565s/iter; left time: 1999.9374s
	iters: 200, epoch: 1 | loss: 0.0991914
	speed: 0.4504s/iter; left time: 1928.2830s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:41.57s
Steps: 224 | Train Loss: 0.1096127 Vali Loss: 0.0768486 Test Loss: 0.0859218
Validation loss decreased (inf --> 0.076849).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0739522
	speed: 0.8021s/iter; left time: 3334.4136s
	iters: 200, epoch: 2 | loss: 0.0696664
	speed: 0.4547s/iter; left time: 1844.6928s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:40.95s
Steps: 224 | Train Loss: 0.0758878 Vali Loss: 0.0693194 Test Loss: 0.0760165
Validation loss decreased (0.076849 --> 0.069319).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0686753
	speed: 0.8329s/iter; left time: 3275.9790s
	iters: 200, epoch: 3 | loss: 0.0651648
	speed: 0.4527s/iter; left time: 1735.1894s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:41.65s
Steps: 224 | Train Loss: 0.0674712 Vali Loss: 0.0642719 Test Loss: 0.0714982
Validation loss decreased (0.069319 --> 0.064272).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0618553
	speed: 0.8213s/iter; left time: 3046.1647s
	iters: 200, epoch: 4 | loss: 0.0630430
	speed: 0.4461s/iter; left time: 1610.1316s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:40.66s
Steps: 224 | Train Loss: 0.0647203 Vali Loss: 0.0636634 Test Loss: 0.0706875
Validation loss decreased (0.064272 --> 0.063663).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0618326
	speed: 0.8265s/iter; left time: 2880.4149s
	iters: 200, epoch: 5 | loss: 0.0637024
	speed: 0.4418s/iter; left time: 1495.3550s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:39.85s
Steps: 224 | Train Loss: 0.0622671 Vali Loss: 0.0612872 Test Loss: 0.0688221
Validation loss decreased (0.063663 --> 0.061287).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0615858
	speed: 0.7996s/iter; left time: 2607.3391s
	iters: 200, epoch: 6 | loss: 0.0575338
	speed: 0.4339s/iter; left time: 1371.6939s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:38.19s
Steps: 224 | Train Loss: 0.0604503 Vali Loss: 0.0591435 Test Loss: 0.0662856
Validation loss decreased (0.061287 --> 0.059143).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0611197
	speed: 0.6582s/iter; left time: 1998.8895s
	iters: 200, epoch: 7 | loss: 0.0593193
	speed: 0.4431s/iter; left time: 1301.2635s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:34.88s
Steps: 224 | Train Loss: 0.0589661 Vali Loss: 0.0588702 Test Loss: 0.0661415
Validation loss decreased (0.059143 --> 0.058870).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0578592
	speed: 0.8135s/iter; left time: 2288.3704s
	iters: 200, epoch: 8 | loss: 0.0538578
	speed: 0.4504s/iter; left time: 1221.8475s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:41.38s
Steps: 224 | Train Loss: 0.0580438 Vali Loss: 0.0579257 Test Loss: 0.0652300
Validation loss decreased (0.058870 --> 0.057926).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0591956
	speed: 0.8046s/iter; left time: 2083.1901s
	iters: 200, epoch: 9 | loss: 0.0582842
	speed: 0.4428s/iter; left time: 1102.0574s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:40.67s
Steps: 224 | Train Loss: 0.0573978 Vali Loss: 0.0580860 Test Loss: 0.0652464
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0573916
	speed: 0.8014s/iter; left time: 1895.1967s
	iters: 200, epoch: 10 | loss: 0.0535634
	speed: 0.4453s/iter; left time: 1008.6529s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:41.13s
Steps: 224 | Train Loss: 0.0568957 Vali Loss: 0.0578221 Test Loss: 0.0650002
Validation loss decreased (0.057926 --> 0.057822).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0559630
	speed: 0.8002s/iter; left time: 1713.1513s
	iters: 200, epoch: 11 | loss: 0.0524693
	speed: 0.4573s/iter; left time: 933.3707s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:41.89s
Steps: 224 | Train Loss: 0.0564283 Vali Loss: 0.0570378 Test Loss: 0.0641107
Validation loss decreased (0.057822 --> 0.057038).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0554577
	speed: 0.8079s/iter; left time: 1548.8350s
	iters: 200, epoch: 12 | loss: 0.0555868
	speed: 0.4505s/iter; left time: 818.4885s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:41.57s
Steps: 224 | Train Loss: 0.0559803 Vali Loss: 0.0570644 Test Loss: 0.0641625
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0542900
	speed: 0.8066s/iter; left time: 1365.6425s
	iters: 200, epoch: 13 | loss: 0.0591467
	speed: 0.4448s/iter; left time: 708.4925s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:40.06s
Steps: 224 | Train Loss: 0.0557331 Vali Loss: 0.0568308 Test Loss: 0.0637137
Validation loss decreased (0.057038 --> 0.056831).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0526479
	speed: 0.7983s/iter; left time: 1172.7316s
	iters: 200, epoch: 14 | loss: 0.0584162
	speed: 0.4526s/iter; left time: 619.6040s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:41.35s
Steps: 224 | Train Loss: 0.0552549 Vali Loss: 0.0565104 Test Loss: 0.0632669
Validation loss decreased (0.056831 --> 0.056510).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0575271
	speed: 0.8076s/iter; left time: 1005.4123s
	iters: 200, epoch: 15 | loss: 0.0553147
	speed: 0.4536s/iter; left time: 519.4191s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:41.62s
Steps: 224 | Train Loss: 0.0550015 Vali Loss: 0.0562629 Test Loss: 0.0633010
Validation loss decreased (0.056510 --> 0.056263).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0567195
	speed: 0.7877s/iter; left time: 804.2652s
	iters: 200, epoch: 16 | loss: 0.0545197
	speed: 0.4524s/iter; left time: 416.6628s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:40.94s
Steps: 224 | Train Loss: 0.0547239 Vali Loss: 0.0562044 Test Loss: 0.0631984
Validation loss decreased (0.056263 --> 0.056204).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0529404
	speed: 0.8306s/iter; left time: 661.9819s
	iters: 200, epoch: 17 | loss: 0.0550891
	speed: 0.4498s/iter; left time: 313.5057s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:41.12s
Steps: 224 | Train Loss: 0.0546247 Vali Loss: 0.0562394 Test Loss: 0.0631969
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0533830
	speed: 0.8159s/iter; left time: 467.5074s
	iters: 200, epoch: 18 | loss: 0.0568826
	speed: 0.4441s/iter; left time: 210.0669s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:41.47s
Steps: 224 | Train Loss: 0.0543704 Vali Loss: 0.0562169 Test Loss: 0.0630499
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0529612
	speed: 0.8206s/iter; left time: 286.3728s
	iters: 200, epoch: 19 | loss: 0.0535058
	speed: 0.4438s/iter; left time: 110.4981s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:41.06s
Steps: 224 | Train Loss: 0.0541535 Vali Loss: 0.0560991 Test Loss: 0.0629003
Validation loss decreased (0.056204 --> 0.056099).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0550337
	speed: 0.8179s/iter; left time: 102.2405s
	iters: 200, epoch: 20 | loss: 0.0525426
	speed: 0.4436s/iter; left time: 11.0898s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:40.56s
Steps: 224 | Train Loss: 0.0540673 Vali Loss: 0.0558894 Test Loss: 0.0629101
Validation loss decreased (0.056099 --> 0.055889).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010615193285048008, rmse:0.10303006321191788, mae:0.06291008740663528, rse:0.3032050132751465
Intermediate time for ES and pred_len 24: 01h:24m:09.67s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1167136
	speed: 0.5732s/iter; left time: 2511.1870s
	iters: 200, epoch: 1 | loss: 0.1113692
	speed: 0.5014s/iter; left time: 2146.3245s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:57.53s
Steps: 224 | Train Loss: 0.1193400 Vali Loss: 0.0932128 Test Loss: 0.1051226
Validation loss decreased (inf --> 0.093213).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0965767
	speed: 1.0636s/iter; left time: 4421.3832s
	iters: 200, epoch: 2 | loss: 0.0921089
	speed: 0.4886s/iter; left time: 1982.0838s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:50.03s
Steps: 224 | Train Loss: 0.0958194 Vali Loss: 0.0890634 Test Loss: 0.1001628
Validation loss decreased (0.093213 --> 0.089063).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0885787
	speed: 1.0772s/iter; left time: 4236.6150s
	iters: 200, epoch: 3 | loss: 0.0812848
	speed: 0.4157s/iter; left time: 1593.4597s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:42.02s
Steps: 224 | Train Loss: 0.0874869 Vali Loss: 0.0854821 Test Loss: 0.0969783
Validation loss decreased (0.089063 --> 0.085482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0780477
	speed: 0.8447s/iter; left time: 3132.8415s
	iters: 200, epoch: 4 | loss: 0.0860942
	speed: 0.4363s/iter; left time: 1574.7726s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:37.76s
Steps: 224 | Train Loss: 0.0843778 Vali Loss: 0.0840356 Test Loss: 0.0956189
Validation loss decreased (0.085482 --> 0.084036).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0798992
	speed: 0.8033s/iter; left time: 2799.4977s
	iters: 200, epoch: 5 | loss: 0.0824614
	speed: 0.4347s/iter; left time: 1471.5854s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:37.34s
Steps: 224 | Train Loss: 0.0819452 Vali Loss: 0.0823933 Test Loss: 0.0941767
Validation loss decreased (0.084036 --> 0.082393).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0841987
	speed: 0.8143s/iter; left time: 2655.3528s
	iters: 200, epoch: 6 | loss: 0.0801335
	speed: 0.4309s/iter; left time: 1362.1667s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:36.84s
Steps: 224 | Train Loss: 0.0802385 Vali Loss: 0.0811689 Test Loss: 0.0923504
Validation loss decreased (0.082393 --> 0.081169).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0780803
	speed: 0.8040s/iter; left time: 2441.7309s
	iters: 200, epoch: 7 | loss: 0.0759986
	speed: 0.4337s/iter; left time: 1273.7300s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:37.75s
Steps: 224 | Train Loss: 0.0790918 Vali Loss: 0.0804617 Test Loss: 0.0916002
Validation loss decreased (0.081169 --> 0.080462).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0782464
	speed: 0.8205s/iter; left time: 2307.9918s
	iters: 200, epoch: 8 | loss: 0.0784367
	speed: 0.4088s/iter; left time: 1109.0191s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:34.28s
Steps: 224 | Train Loss: 0.0785034 Vali Loss: 0.0805083 Test Loss: 0.0913763
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0807393
	speed: 0.7322s/iter; left time: 1895.5514s
	iters: 200, epoch: 9 | loss: 0.0811604
	speed: 0.5012s/iter; left time: 1247.5488s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:45.83s
Steps: 224 | Train Loss: 0.0779705 Vali Loss: 0.0798951 Test Loss: 0.0900216
Validation loss decreased (0.080462 --> 0.079895).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0756566
	speed: 1.0467s/iter; left time: 2475.5094s
	iters: 200, epoch: 10 | loss: 0.0751782
	speed: 0.4870s/iter; left time: 1103.1316s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:49.90s
Steps: 224 | Train Loss: 0.0775467 Vali Loss: 0.0799544 Test Loss: 0.0909356
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0762294
	speed: 1.1025s/iter; left time: 2360.4065s
	iters: 200, epoch: 11 | loss: 0.0776403
	speed: 0.4896s/iter; left time: 999.1973s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:49.48s
Steps: 224 | Train Loss: 0.0771461 Vali Loss: 0.0800384 Test Loss: 0.0909417
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0725788
	speed: 1.1216s/iter; left time: 2150.1800s
	iters: 200, epoch: 12 | loss: 0.0784077
	speed: 0.4886s/iter; left time: 887.8594s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:49.65s
Steps: 224 | Train Loss: 0.0770552 Vali Loss: 0.0795305 Test Loss: 0.0905157
Validation loss decreased (0.079895 --> 0.079530).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0751376
	speed: 1.0553s/iter; left time: 1786.6563s
	iters: 200, epoch: 13 | loss: 0.0745936
	speed: 0.4881s/iter; left time: 777.5122s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:51.96s
Steps: 224 | Train Loss: 0.0765096 Vali Loss: 0.0795917 Test Loss: 0.0900794
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0789997
	speed: 1.0465s/iter; left time: 1537.3353s
	iters: 200, epoch: 14 | loss: 0.0775031
	speed: 0.4905s/iter; left time: 671.5171s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:50.32s
Steps: 224 | Train Loss: 0.0762570 Vali Loss: 0.0796025 Test Loss: 0.0899796
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0772134
	speed: 1.0341s/iter; left time: 1287.4291s
	iters: 200, epoch: 15 | loss: 0.0754506
	speed: 0.4856s/iter; left time: 556.0556s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:49.36s
Steps: 224 | Train Loss: 0.0759657 Vali Loss: 0.0796881 Test Loss: 0.0905825
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0784081
	speed: 1.0985s/iter; left time: 1121.5476s
	iters: 200, epoch: 16 | loss: 0.0749004
	speed: 0.4880s/iter; left time: 449.4128s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:49.94s
Steps: 224 | Train Loss: 0.0758571 Vali Loss: 0.0794466 Test Loss: 0.0900384
Validation loss decreased (0.079530 --> 0.079447).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0745344
	speed: 1.0670s/iter; left time: 850.3707s
	iters: 200, epoch: 17 | loss: 0.0735723
	speed: 0.4804s/iter; left time: 334.8635s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:48.85s
Steps: 224 | Train Loss: 0.0758652 Vali Loss: 0.0793460 Test Loss: 0.0899469
Validation loss decreased (0.079447 --> 0.079346).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0782885
	speed: 1.1356s/iter; left time: 650.7249s
	iters: 200, epoch: 18 | loss: 0.0724042
	speed: 0.4802s/iter; left time: 227.1509s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:58.16s
Steps: 224 | Train Loss: 0.0757748 Vali Loss: 0.0797755 Test Loss: 0.0904603
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0740940
	speed: 0.9596s/iter; left time: 334.8881s
	iters: 200, epoch: 19 | loss: 0.0751040
	speed: 0.4870s/iter; left time: 121.2635s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:50.39s
Steps: 224 | Train Loss: 0.0754512 Vali Loss: 0.0795362 Test Loss: 0.0902340
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0780370
	speed: 1.0876s/iter; left time: 135.9448s
	iters: 200, epoch: 20 | loss: 0.0721612
	speed: 0.4931s/iter; left time: 12.3270s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:53.23s
Steps: 224 | Train Loss: 0.0752366 Vali Loss: 0.0792375 Test Loss: 0.0893325
Validation loss decreased (0.079346 --> 0.079237).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01933741569519043, rmse:0.13905903697013855, mae:0.08933248370885849, rse:0.408513605594635
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1175029
	speed: 0.4969s/iter; left time: 2176.9747s
	iters: 200, epoch: 1 | loss: 0.1092772
	speed: 0.4844s/iter; left time: 2073.5567s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:49.83s
Steps: 224 | Train Loss: 0.1195248 Vali Loss: 0.0929825 Test Loss: 0.1053775
Validation loss decreased (inf --> 0.092982).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0965189
	speed: 0.7942s/iter; left time: 3301.3091s
	iters: 200, epoch: 2 | loss: 0.0899113
	speed: 0.4066s/iter; left time: 1649.5792s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:31.41s
Steps: 224 | Train Loss: 0.0952994 Vali Loss: 0.0893233 Test Loss: 0.0999092
Validation loss decreased (0.092982 --> 0.089323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0902880
	speed: 0.7064s/iter; left time: 2778.4136s
	iters: 200, epoch: 3 | loss: 0.0883282
	speed: 0.4052s/iter; left time: 1553.1792s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:30.93s
Steps: 224 | Train Loss: 0.0874066 Vali Loss: 0.0870304 Test Loss: 0.0975766
Validation loss decreased (0.089323 --> 0.087030).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818710
	speed: 0.9545s/iter; left time: 3540.1097s
	iters: 200, epoch: 4 | loss: 0.0860198
	speed: 0.5055s/iter; left time: 1824.3106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:52.88s
Steps: 224 | Train Loss: 0.0844759 Vali Loss: 0.0830518 Test Loss: 0.0937686
Validation loss decreased (0.087030 --> 0.083052).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0836892
	speed: 1.0574s/iter; left time: 3685.0145s
	iters: 200, epoch: 5 | loss: 0.0815450
	speed: 0.4916s/iter; left time: 1664.2050s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:50.74s
Steps: 224 | Train Loss: 0.0822521 Vali Loss: 0.0822913 Test Loss: 0.0928820
Validation loss decreased (0.083052 --> 0.082291).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0788935
	speed: 1.0826s/iter; left time: 3530.3985s
	iters: 200, epoch: 6 | loss: 0.0808163
	speed: 0.4917s/iter; left time: 1554.2701s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:51.02s
Steps: 224 | Train Loss: 0.0806715 Vali Loss: 0.0811825 Test Loss: 0.0923603
Validation loss decreased (0.082291 --> 0.081183).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0814950
	speed: 1.0298s/iter; left time: 3127.6365s
	iters: 200, epoch: 7 | loss: 0.0773085
	speed: 0.4963s/iter; left time: 1457.6886s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:51.88s
Steps: 224 | Train Loss: 0.0794067 Vali Loss: 0.0805480 Test Loss: 0.0913771
Validation loss decreased (0.081183 --> 0.080548).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0803885
	speed: 1.0399s/iter; left time: 2925.3448s
	iters: 200, epoch: 8 | loss: 0.0785220
	speed: 0.4887s/iter; left time: 1325.9762s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:50.70s
Steps: 224 | Train Loss: 0.0787849 Vali Loss: 0.0801221 Test Loss: 0.0910448
Validation loss decreased (0.080548 --> 0.080122).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0760399
	speed: 1.0432s/iter; left time: 2700.8632s
	iters: 200, epoch: 9 | loss: 0.0757184
	speed: 0.4936s/iter; left time: 1228.6351s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:50.63s
Steps: 224 | Train Loss: 0.0782524 Vali Loss: 0.0802404 Test Loss: 0.0910217
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0788515
	speed: 1.0142s/iter; left time: 2398.6699s
	iters: 200, epoch: 10 | loss: 0.0783852
	speed: 0.4860s/iter; left time: 1100.7099s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:48.21s
Steps: 224 | Train Loss: 0.0777956 Vali Loss: 0.0795742 Test Loss: 0.0900392
Validation loss decreased (0.080122 --> 0.079574).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0826291
	speed: 1.0262s/iter; left time: 2197.0803s
	iters: 200, epoch: 11 | loss: 0.0776902
	speed: 0.4880s/iter; left time: 996.0175s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:49.05s
Steps: 224 | Train Loss: 0.0774411 Vali Loss: 0.0799839 Test Loss: 0.0907601
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0772021
	speed: 1.0350s/iter; left time: 1984.0153s
	iters: 200, epoch: 12 | loss: 0.0790357
	speed: 0.4834s/iter; left time: 878.3672s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:48.53s
Steps: 224 | Train Loss: 0.0772629 Vali Loss: 0.0799252 Test Loss: 0.0908321
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0783965
	speed: 1.0267s/iter; left time: 1738.1460s
	iters: 200, epoch: 13 | loss: 0.0748329
	speed: 0.4849s/iter; left time: 772.4102s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:50.12s
Steps: 224 | Train Loss: 0.0767687 Vali Loss: 0.0793242 Test Loss: 0.0899927
Validation loss decreased (0.079574 --> 0.079324).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0743536
	speed: 1.0402s/iter; left time: 1528.1090s
	iters: 200, epoch: 14 | loss: 0.0781949
	speed: 0.4869s/iter; left time: 666.6023s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:49.41s
Steps: 224 | Train Loss: 0.0764331 Vali Loss: 0.0792248 Test Loss: 0.0899387
Validation loss decreased (0.079324 --> 0.079225).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0768853
	speed: 1.0584s/iter; left time: 1317.6845s
	iters: 200, epoch: 15 | loss: 0.0764216
	speed: 0.4843s/iter; left time: 554.5598s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:50.96s
Steps: 224 | Train Loss: 0.0762905 Vali Loss: 0.0792417 Test Loss: 0.0896885
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0778881
	speed: 0.9706s/iter; left time: 991.0271s
	iters: 200, epoch: 16 | loss: 0.0733138
	speed: 0.4080s/iter; left time: 375.7268s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:35.11s
Steps: 224 | Train Loss: 0.0760286 Vali Loss: 0.0794188 Test Loss: 0.0900215
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0781714
	speed: 0.7645s/iter; left time: 609.3397s
	iters: 200, epoch: 17 | loss: 0.0724908
	speed: 0.4317s/iter; left time: 300.8970s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:35.67s
Steps: 224 | Train Loss: 0.0757489 Vali Loss: 0.0794565 Test Loss: 0.0899036
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0768087
	speed: 0.7905s/iter; left time: 452.9751s
	iters: 200, epoch: 18 | loss: 0.0740070
	speed: 0.4274s/iter; left time: 202.1574s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:35.27s
Steps: 224 | Train Loss: 0.0755602 Vali Loss: 0.0792832 Test Loss: 0.0895367
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0743845
	speed: 0.7755s/iter; left time: 270.6541s
	iters: 200, epoch: 19 | loss: 0.0774982
	speed: 0.4331s/iter; left time: 107.8537s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:37.02s
Steps: 224 | Train Loss: 0.0752978 Vali Loss: 0.0791737 Test Loss: 0.0895495
Validation loss decreased (0.079225 --> 0.079174).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0772385
	speed: 0.7690s/iter; left time: 96.1282s
	iters: 200, epoch: 20 | loss: 0.0751759
	speed: 0.4284s/iter; left time: 10.7107s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:35.88s
Steps: 224 | Train Loss: 0.0751847 Vali Loss: 0.0793495 Test Loss: 0.0897298
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019314749166369438, rmse:0.138977512717247, mae:0.08954952657222748, rse:0.4082740843296051
Intermediate time for ES and pred_len 96: 01h:36m:13.29s


=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1201173
	speed: 0.7111s/iter; left time: 3101.1487s
	iters: 200, epoch: 1 | loss: 0.1138434
	speed: 0.6604s/iter; left time: 2814.0197s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:25.49s
Steps: 223 | Train Loss: 0.1220068 Vali Loss: 0.0970707 Test Loss: 0.1094999
Validation loss decreased (inf --> 0.097071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1008289
	speed: 1.6564s/iter; left time: 6854.0219s
	iters: 200, epoch: 2 | loss: 0.1012299
	speed: 0.6524s/iter; left time: 2634.5740s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:23.27s
Steps: 223 | Train Loss: 0.1000176 Vali Loss: 0.0960066 Test Loss: 0.1077563
Validation loss decreased (0.097071 --> 0.096007).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0943796
	speed: 1.7192s/iter; left time: 6730.6263s
	iters: 200, epoch: 3 | loss: 0.0926010
	speed: 0.4183s/iter; left time: 1595.6286s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:55.62s
Steps: 223 | Train Loss: 0.0923409 Vali Loss: 0.0916715 Test Loss: 0.1024567
Validation loss decreased (0.096007 --> 0.091671).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0869269
	speed: 0.6933s/iter; left time: 2559.7672s
	iters: 200, epoch: 4 | loss: 0.0863417
	speed: 0.4156s/iter; left time: 1492.6637s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:33.09s
Steps: 223 | Train Loss: 0.0893949 Vali Loss: 0.0878021 Test Loss: 0.0989605
Validation loss decreased (0.091671 --> 0.087802).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0880632
	speed: 0.9452s/iter; left time: 3278.8800s
	iters: 200, epoch: 5 | loss: 0.0863833
	speed: 0.6888s/iter; left time: 2320.4983s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:29.27s
Steps: 223 | Train Loss: 0.0864631 Vali Loss: 0.0870810 Test Loss: 0.0986551
Validation loss decreased (0.087802 --> 0.087081).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839308
	speed: 1.6958s/iter; left time: 5504.5040s
	iters: 200, epoch: 6 | loss: 0.0883309
	speed: 0.6981s/iter; left time: 2196.1714s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:37.09s
Steps: 223 | Train Loss: 0.0851007 Vali Loss: 0.0862161 Test Loss: 0.0979620
Validation loss decreased (0.087081 --> 0.086216).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0842098
	speed: 1.8780s/iter; left time: 5677.1173s
	iters: 200, epoch: 7 | loss: 0.0835176
	speed: 0.6941s/iter; left time: 2028.9199s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:33.44s
Steps: 223 | Train Loss: 0.0840701 Vali Loss: 0.0861444 Test Loss: 0.0979294
Validation loss decreased (0.086216 --> 0.086144).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0840583
	speed: 1.7061s/iter; left time: 4777.0697s
	iters: 200, epoch: 8 | loss: 0.0805856
	speed: 0.6846s/iter; left time: 1848.4187s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:30.87s
Steps: 223 | Train Loss: 0.0834117 Vali Loss: 0.0861725 Test Loss: 0.0979781
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0820462
	speed: 1.7008s/iter; left time: 4383.0155s
	iters: 200, epoch: 9 | loss: 0.0842395
	speed: 0.6563s/iter; left time: 1625.6047s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:26.52s
Steps: 223 | Train Loss: 0.0827916 Vali Loss: 0.0858114 Test Loss: 0.0976006
Validation loss decreased (0.086144 --> 0.085811).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0807762
	speed: 1.5393s/iter; left time: 3623.4624s
	iters: 200, epoch: 10 | loss: 0.0826545
	speed: 0.6599s/iter; left time: 1487.4871s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:32.04s
Steps: 223 | Train Loss: 0.0823522 Vali Loss: 0.0853876 Test Loss: 0.0961035
Validation loss decreased (0.085811 --> 0.085388).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0830523
	speed: 1.7080s/iter; left time: 3639.6812s
	iters: 200, epoch: 11 | loss: 0.0849956
	speed: 0.6753s/iter; left time: 1371.5652s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:30.04s
Steps: 223 | Train Loss: 0.0822309 Vali Loss: 0.0851900 Test Loss: 0.0968313
Validation loss decreased (0.085388 --> 0.085190).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0789915
	speed: 1.6375s/iter; left time: 3124.3156s
	iters: 200, epoch: 12 | loss: 0.0828379
	speed: 0.6439s/iter; left time: 1164.2260s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:22.47s
Steps: 223 | Train Loss: 0.0816741 Vali Loss: 0.0854409 Test Loss: 0.0967536
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0807976
	speed: 1.7666s/iter; left time: 2976.7785s
	iters: 200, epoch: 13 | loss: 0.0790383
	speed: 0.6352s/iter; left time: 1006.7540s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:21.85s
Steps: 223 | Train Loss: 0.0815751 Vali Loss: 0.0853703 Test Loss: 0.0967650
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0829430
	speed: 1.7659s/iter; left time: 2581.8026s
	iters: 200, epoch: 14 | loss: 0.0840117
	speed: 0.6337s/iter; left time: 863.1319s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:21.25s
Steps: 223 | Train Loss: 0.0814808 Vali Loss: 0.0852086 Test Loss: 0.0960664
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0865231
	speed: 0.7276s/iter; left time: 901.5446s
	iters: 200, epoch: 15 | loss: 0.0799231
	speed: 0.4125s/iter; left time: 469.8516s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:33.82s
Steps: 223 | Train Loss: 0.0812662 Vali Loss: 0.0851957 Test Loss: 0.0961628
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0814724
	speed: 0.8771s/iter; left time: 891.1158s
	iters: 200, epoch: 16 | loss: 0.0759782
	speed: 0.4690s/iter; left time: 429.6496s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:44.96s
Steps: 223 | Train Loss: 0.0807269 Vali Loss: 0.0849759 Test Loss: 0.0957775
Validation loss decreased (0.085190 --> 0.084976).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0790517
	speed: 0.9085s/iter; left time: 720.4513s
	iters: 200, epoch: 17 | loss: 0.0825272
	speed: 0.4616s/iter; left time: 319.8957s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:45.05s
Steps: 223 | Train Loss: 0.0804840 Vali Loss: 0.0851645 Test Loss: 0.0962809
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0811116
	speed: 0.9178s/iter; left time: 523.1179s
	iters: 200, epoch: 18 | loss: 0.0861766
	speed: 0.4723s/iter; left time: 221.9654s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:50.16s
Steps: 223 | Train Loss: 0.0806337 Vali Loss: 0.0847186 Test Loss: 0.0953869
Validation loss decreased (0.084976 --> 0.084719).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800357
	speed: 0.8841s/iter; left time: 306.7877s
	iters: 200, epoch: 19 | loss: 0.0805173
	speed: 0.4655s/iter; left time: 114.9869s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:44.54s
Steps: 223 | Train Loss: 0.0804246 Vali Loss: 0.0848673 Test Loss: 0.0960263
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0810287
	speed: 0.8621s/iter; left time: 106.8955s
	iters: 200, epoch: 20 | loss: 0.0821864
	speed: 0.4441s/iter; left time: 10.6585s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:44.74s
Steps: 223 | Train Loss: 0.0802869 Vali Loss: 0.0846076 Test Loss: 0.0955830
Validation loss decreased (0.084719 --> 0.084608).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02158721722662449, rmse:0.1469258964061737, mae:0.09558301419019699, rse:0.43165504932403564
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1190949
	speed: 0.6440s/iter; left time: 2808.3127s
	iters: 200, epoch: 1 | loss: 0.1149573
	speed: 0.6736s/iter; left time: 2870.0368s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:27.51s
Steps: 223 | Train Loss: 0.1237161 Vali Loss: 0.0974902 Test Loss: 0.1097186
Validation loss decreased (inf --> 0.097490).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1017616
	speed: 1.8254s/iter; left time: 7553.5539s
	iters: 200, epoch: 2 | loss: 0.0937457
	speed: 0.6415s/iter; left time: 2590.5308s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:25.30s
Steps: 223 | Train Loss: 0.0998200 Vali Loss: 0.0933207 Test Loss: 0.1053617
Validation loss decreased (0.097490 --> 0.093321).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0931459
	speed: 1.7956s/iter; left time: 7029.7712s
	iters: 200, epoch: 3 | loss: 0.0905714
	speed: 0.6450s/iter; left time: 2460.7407s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:26.14s
Steps: 223 | Train Loss: 0.0922401 Vali Loss: 0.0912229 Test Loss: 0.1028882
Validation loss decreased (0.093321 --> 0.091223).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0932125
	speed: 1.8387s/iter; left time: 6788.6578s
	iters: 200, epoch: 4 | loss: 0.0871020
	speed: 0.6738s/iter; left time: 2420.1444s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:28.00s
Steps: 223 | Train Loss: 0.0894587 Vali Loss: 0.0897735 Test Loss: 0.1027882
Validation loss decreased (0.091223 --> 0.089773).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0888882
	speed: 1.9546s/iter; left time: 6780.6402s
	iters: 200, epoch: 5 | loss: 0.0867240
	speed: 0.6559s/iter; left time: 2209.8780s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:30.15s
Steps: 223 | Train Loss: 0.0867611 Vali Loss: 0.0873882 Test Loss: 0.0993024
Validation loss decreased (0.089773 --> 0.087388).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0855773
	speed: 1.9836s/iter; left time: 6438.6789s
	iters: 200, epoch: 6 | loss: 0.0867043
	speed: 0.6771s/iter; left time: 2130.1595s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:32.78s
Steps: 223 | Train Loss: 0.0852469 Vali Loss: 0.0863633 Test Loss: 0.0987250
Validation loss decreased (0.087388 --> 0.086363).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0850454
	speed: 1.9813s/iter; left time: 5989.4599s
	iters: 200, epoch: 7 | loss: 0.0862091
	speed: 0.6710s/iter; left time: 1961.2235s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:32.77s
Steps: 223 | Train Loss: 0.0843249 Vali Loss: 0.0871426 Test Loss: 0.0993244
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0871101
	speed: 2.0516s/iter; left time: 5744.5826s
	iters: 200, epoch: 8 | loss: 0.0850631
	speed: 0.6395s/iter; left time: 1726.7067s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:28.59s
Steps: 223 | Train Loss: 0.0836867 Vali Loss: 0.0866393 Test Loss: 0.0988438
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0841584
	speed: 2.0382s/iter; left time: 5252.4473s
	iters: 200, epoch: 9 | loss: 0.0833049
	speed: 0.6657s/iter; left time: 1648.8162s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:30.05s
Steps: 223 | Train Loss: 0.0833859 Vali Loss: 0.0859983 Test Loss: 0.0977135
Validation loss decreased (0.086363 --> 0.085998).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0851300
	speed: 2.0290s/iter; left time: 4776.1719s
	iters: 200, epoch: 10 | loss: 0.0818470
	speed: 0.6747s/iter; left time: 1520.7157s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:30.79s
Steps: 223 | Train Loss: 0.0826597 Vali Loss: 0.0854817 Test Loss: 0.0972199
Validation loss decreased (0.085998 --> 0.085482).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0829688
	speed: 1.8350s/iter; left time: 3910.4128s
	iters: 200, epoch: 11 | loss: 0.0837023
	speed: 0.4334s/iter; left time: 880.2849s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:40.33s
Steps: 223 | Train Loss: 0.0825377 Vali Loss: 0.0860413 Test Loss: 0.0972846
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0797202
	speed: 1.0414s/iter; left time: 1986.9859s
	iters: 200, epoch: 12 | loss: 0.0830613
	speed: 0.7048s/iter; left time: 1274.2768s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:34.03s
Steps: 223 | Train Loss: 0.0823943 Vali Loss: 0.0853766 Test Loss: 0.0963799
Validation loss decreased (0.085482 --> 0.085377).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0850847
	speed: 2.1037s/iter; left time: 3544.7043s
	iters: 200, epoch: 13 | loss: 0.0788418
	speed: 0.6912s/iter; left time: 1095.6067s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:33.07s
Steps: 223 | Train Loss: 0.0817176 Vali Loss: 0.0864874 Test Loss: 0.0979733
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0820731
	speed: 2.0547s/iter; left time: 3003.9664s
	iters: 200, epoch: 14 | loss: 0.0797177
	speed: 0.6924s/iter; left time: 943.0915s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:34.97s
Steps: 223 | Train Loss: 0.0815327 Vali Loss: 0.0858428 Test Loss: 0.0972124
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0800128
	speed: 2.0553s/iter; left time: 2546.4984s
	iters: 200, epoch: 15 | loss: 0.0818097
	speed: 0.6800s/iter; left time: 774.4638s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:33.16s
Steps: 223 | Train Loss: 0.0814261 Vali Loss: 0.0853859 Test Loss: 0.0963020
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0797769
	speed: 2.0439s/iter; left time: 2076.5820s
	iters: 200, epoch: 16 | loss: 0.0812480
	speed: 0.6847s/iter; left time: 627.1669s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:02m:33.31s
Steps: 223 | Train Loss: 0.0811830 Vali Loss: 0.0854322 Test Loss: 0.0962062
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0812291
	speed: 2.0615s/iter; left time: 1634.7519s
	iters: 200, epoch: 17 | loss: 0.0802803
	speed: 0.6581s/iter; left time: 456.0760s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:02m:32.75s
Steps: 223 | Train Loss: 0.0809164 Vali Loss: 0.0858576 Test Loss: 0.0971119
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021762611344456673, rmse:0.14752155542373657, mae:0.09637989103794098, rse:0.4334050714969635
Intermediate time for ES and pred_len 168: 02h:18m:42.71s


=== Starting experiments for country: FR ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0766317
	speed: 0.1594s/iter; left time: 704.8764s
	iters: 200, epoch: 1 | loss: 0.0695265
	speed: 0.1316s/iter; left time: 568.5292s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:30.51s
Steps: 226 | Train Loss: 0.0817155 Vali Loss: 0.0705644 Test Loss: 0.0732726
Validation loss decreased (inf --> 0.070564).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0562303
	speed: 0.2236s/iter; left time: 938.0175s
	iters: 200, epoch: 2 | loss: 0.0503308
	speed: 0.1293s/iter; left time: 529.4164s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:29.42s
Steps: 226 | Train Loss: 0.0548762 Vali Loss: 0.0606296 Test Loss: 0.0633584
Validation loss decreased (0.070564 --> 0.060630).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0513493
	speed: 0.2205s/iter; left time: 875.1299s
	iters: 200, epoch: 3 | loss: 0.0548947
	speed: 0.1285s/iter; left time: 497.1762s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:29.22s
Steps: 226 | Train Loss: 0.0505532 Vali Loss: 0.0587098 Test Loss: 0.0624320
Validation loss decreased (0.060630 --> 0.058710).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0527826
	speed: 0.2214s/iter; left time: 828.5555s
	iters: 200, epoch: 4 | loss: 0.0514440
	speed: 0.1308s/iter; left time: 476.5446s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.41s
Steps: 226 | Train Loss: 0.0490150 Vali Loss: 0.0584218 Test Loss: 0.0620288
Validation loss decreased (0.058710 --> 0.058422).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0478798
	speed: 0.2201s/iter; left time: 773.9429s
	iters: 200, epoch: 5 | loss: 0.0479713
	speed: 0.1288s/iter; left time: 440.2405s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:29.33s
Steps: 226 | Train Loss: 0.0479430 Vali Loss: 0.0563894 Test Loss: 0.0599632
Validation loss decreased (0.058422 --> 0.056389).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0510816
	speed: 0.2214s/iter; left time: 728.4802s
	iters: 200, epoch: 6 | loss: 0.0462048
	speed: 0.1288s/iter; left time: 410.8427s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:29.50s
Steps: 226 | Train Loss: 0.0474372 Vali Loss: 0.0566435 Test Loss: 0.0606992
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0459774
	speed: 0.2215s/iter; left time: 679.0356s
	iters: 200, epoch: 7 | loss: 0.0513296
	speed: 0.1256s/iter; left time: 372.4693s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.97s
Steps: 226 | Train Loss: 0.0469073 Vali Loss: 0.0559441 Test Loss: 0.0600186
Validation loss decreased (0.056389 --> 0.055944).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0457944
	speed: 0.2160s/iter; left time: 613.3527s
	iters: 200, epoch: 8 | loss: 0.0448213
	speed: 0.1306s/iter; left time: 357.7047s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.20s
Steps: 226 | Train Loss: 0.0464634 Vali Loss: 0.0558273 Test Loss: 0.0593858
Validation loss decreased (0.055944 --> 0.055827).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0463735
	speed: 0.2207s/iter; left time: 576.7132s
	iters: 200, epoch: 9 | loss: 0.0489007
	speed: 0.1280s/iter; left time: 321.7713s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:29.29s
Steps: 226 | Train Loss: 0.0461754 Vali Loss: 0.0556516 Test Loss: 0.0595443
Validation loss decreased (0.055827 --> 0.055652).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0466776
	speed: 0.2180s/iter; left time: 520.3154s
	iters: 200, epoch: 10 | loss: 0.0459872
	speed: 0.1278s/iter; left time: 292.3615s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:29.21s
Steps: 226 | Train Loss: 0.0457334 Vali Loss: 0.0548611 Test Loss: 0.0585909
Validation loss decreased (0.055652 --> 0.054861).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0433881
	speed: 0.2203s/iter; left time: 476.1144s
	iters: 200, epoch: 11 | loss: 0.0430847
	speed: 0.1303s/iter; left time: 268.5118s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:29.64s
Steps: 226 | Train Loss: 0.0453992 Vali Loss: 0.0553987 Test Loss: 0.0589465
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0467320
	speed: 0.2355s/iter; left time: 455.6640s
	iters: 200, epoch: 12 | loss: 0.0414491
	speed: 0.1276s/iter; left time: 234.2293s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:29.63s
Steps: 226 | Train Loss: 0.0452521 Vali Loss: 0.0548284 Test Loss: 0.0586648
Validation loss decreased (0.054861 --> 0.054828).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0455686
	speed: 0.2175s/iter; left time: 371.7388s
	iters: 200, epoch: 13 | loss: 0.0478617
	speed: 0.1292s/iter; left time: 207.9196s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:29.07s
Steps: 226 | Train Loss: 0.0450395 Vali Loss: 0.0549135 Test Loss: 0.0585464
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0442970
	speed: 0.2223s/iter; left time: 329.6137s
	iters: 200, epoch: 14 | loss: 0.0503605
	speed: 0.1325s/iter; left time: 183.2741s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:29.95s
Steps: 226 | Train Loss: 0.0447735 Vali Loss: 0.0546823 Test Loss: 0.0583076
Validation loss decreased (0.054828 --> 0.054682).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0424463
	speed: 0.2271s/iter; left time: 285.4459s
	iters: 200, epoch: 15 | loss: 0.0444540
	speed: 0.1271s/iter; left time: 147.1046s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:29.16s
Steps: 226 | Train Loss: 0.0446773 Vali Loss: 0.0546821 Test Loss: 0.0582906
Validation loss decreased (0.054682 --> 0.054682).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0437147
	speed: 0.2197s/iter; left time: 226.5216s
	iters: 200, epoch: 16 | loss: 0.0457383
	speed: 0.1265s/iter; left time: 117.7277s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:29.24s
Steps: 226 | Train Loss: 0.0444284 Vali Loss: 0.0544112 Test Loss: 0.0578407
Validation loss decreased (0.054682 --> 0.054411).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0409016
	speed: 0.2172s/iter; left time: 174.8492s
	iters: 200, epoch: 17 | loss: 0.0478386
	speed: 0.1298s/iter; left time: 91.5071s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:29.49s
Steps: 226 | Train Loss: 0.0443060 Vali Loss: 0.0542591 Test Loss: 0.0578918
Validation loss decreased (0.054411 --> 0.054259).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0443076
	speed: 0.2171s/iter; left time: 125.7041s
	iters: 200, epoch: 18 | loss: 0.0450188
	speed: 0.1293s/iter; left time: 61.9451s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:29.22s
Steps: 226 | Train Loss: 0.0441691 Vali Loss: 0.0540334 Test Loss: 0.0580545
Validation loss decreased (0.054259 --> 0.054033).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0454062
	speed: 0.2185s/iter; left time: 77.1218s
	iters: 200, epoch: 19 | loss: 0.0424051
	speed: 0.1292s/iter; left time: 32.6869s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:29.50s
Steps: 226 | Train Loss: 0.0440228 Vali Loss: 0.0539079 Test Loss: 0.0574121
Validation loss decreased (0.054033 --> 0.053908).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0425628
	speed: 0.2249s/iter; left time: 28.5604s
	iters: 200, epoch: 20 | loss: 0.0424072
	speed: 0.1289s/iter; left time: 3.4791s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:29.57s
Steps: 226 | Train Loss: 0.0439709 Vali Loss: 0.0540611 Test Loss: 0.0577443
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010757667943835258, rmse:0.10371917486190796, mae:0.057412099093198776, rse:0.4001457095146179
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0778962
	speed: 0.1302s/iter; left time: 575.4611s
	iters: 200, epoch: 1 | loss: 0.0747243
	speed: 0.1281s/iter; left time: 553.6014s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.17s
Steps: 226 | Train Loss: 0.0831907 Vali Loss: 0.0704090 Test Loss: 0.0729090
Validation loss decreased (inf --> 0.070409).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0543477
	speed: 0.2208s/iter; left time: 926.2374s
	iters: 200, epoch: 2 | loss: 0.0524221
	speed: 0.1277s/iter; left time: 523.0096s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:29.06s
Steps: 226 | Train Loss: 0.0553467 Vali Loss: 0.0607321 Test Loss: 0.0636736
Validation loss decreased (0.070409 --> 0.060732).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0470920
	speed: 0.2191s/iter; left time: 869.6660s
	iters: 200, epoch: 3 | loss: 0.0494604
	speed: 0.1267s/iter; left time: 490.1457s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:29.01s
Steps: 226 | Train Loss: 0.0507888 Vali Loss: 0.0581976 Test Loss: 0.0614593
Validation loss decreased (0.060732 --> 0.058198).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0472974
	speed: 0.2199s/iter; left time: 823.1736s
	iters: 200, epoch: 4 | loss: 0.0468269
	speed: 0.1290s/iter; left time: 469.9367s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.37s
Steps: 226 | Train Loss: 0.0489967 Vali Loss: 0.0577703 Test Loss: 0.0621285
Validation loss decreased (0.058198 --> 0.057770).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0490690
	speed: 0.2222s/iter; left time: 781.3646s
	iters: 200, epoch: 5 | loss: 0.0480625
	speed: 0.1290s/iter; left time: 440.8649s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:29.28s
Steps: 226 | Train Loss: 0.0481537 Vali Loss: 0.0568581 Test Loss: 0.0606220
Validation loss decreased (0.057770 --> 0.056858).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0454466
	speed: 0.2245s/iter; left time: 738.7034s
	iters: 200, epoch: 6 | loss: 0.0472364
	speed: 0.1300s/iter; left time: 414.7907s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:29.66s
Steps: 226 | Train Loss: 0.0473543 Vali Loss: 0.0561352 Test Loss: 0.0599884
Validation loss decreased (0.056858 --> 0.056135).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0457151
	speed: 0.2253s/iter; left time: 690.5855s
	iters: 200, epoch: 7 | loss: 0.0485219
	speed: 0.1273s/iter; left time: 377.4637s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:29.23s
Steps: 226 | Train Loss: 0.0469531 Vali Loss: 0.0555767 Test Loss: 0.0595131
Validation loss decreased (0.056135 --> 0.055577).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0456666
	speed: 0.2198s/iter; left time: 624.1087s
	iters: 200, epoch: 8 | loss: 0.0436416
	speed: 0.1267s/iter; left time: 347.0364s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.02s
Steps: 226 | Train Loss: 0.0464396 Vali Loss: 0.0560706 Test Loss: 0.0598718
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0451892
	speed: 0.2140s/iter; left time: 559.1509s
	iters: 200, epoch: 9 | loss: 0.0475388
	speed: 0.1279s/iter; left time: 321.3787s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.83s
Steps: 226 | Train Loss: 0.0460145 Vali Loss: 0.0551534 Test Loss: 0.0584895
Validation loss decreased (0.055577 --> 0.055153).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0418452
	speed: 0.2255s/iter; left time: 538.1840s
	iters: 200, epoch: 10 | loss: 0.0461544
	speed: 0.1294s/iter; left time: 295.8721s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:29.55s
Steps: 226 | Train Loss: 0.0457849 Vali Loss: 0.0551798 Test Loss: 0.0594885
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0420638
	speed: 0.2259s/iter; left time: 488.2519s
	iters: 200, epoch: 11 | loss: 0.0461470
	speed: 0.1284s/iter; left time: 264.6157s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:29.36s
Steps: 226 | Train Loss: 0.0454104 Vali Loss: 0.0548973 Test Loss: 0.0588777
Validation loss decreased (0.055153 --> 0.054897).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0470574
	speed: 0.2291s/iter; left time: 443.3602s
	iters: 200, epoch: 12 | loss: 0.0454375
	speed: 0.1288s/iter; left time: 236.2726s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:29.46s
Steps: 226 | Train Loss: 0.0451413 Vali Loss: 0.0549472 Test Loss: 0.0585421
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0454469
	speed: 0.2142s/iter; left time: 366.1507s
	iters: 200, epoch: 13 | loss: 0.0446453
	speed: 0.1260s/iter; left time: 202.6874s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.90s
Steps: 226 | Train Loss: 0.0450150 Vali Loss: 0.0546606 Test Loss: 0.0587026
Validation loss decreased (0.054897 --> 0.054661).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0417745
	speed: 0.2182s/iter; left time: 323.5572s
	iters: 200, epoch: 14 | loss: 0.0470195
	speed: 0.1297s/iter; left time: 179.3597s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:29.25s
Steps: 226 | Train Loss: 0.0447190 Vali Loss: 0.0546096 Test Loss: 0.0580985
Validation loss decreased (0.054661 --> 0.054610).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0412011
	speed: 0.2209s/iter; left time: 277.6884s
	iters: 200, epoch: 15 | loss: 0.0458716
	speed: 0.1267s/iter; left time: 146.6169s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.73s
Steps: 226 | Train Loss: 0.0445536 Vali Loss: 0.0544069 Test Loss: 0.0583128
Validation loss decreased (0.054610 --> 0.054407).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0444622
	speed: 0.2213s/iter; left time: 228.1786s
	iters: 200, epoch: 16 | loss: 0.0436480
	speed: 0.1282s/iter; left time: 119.3827s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:29.16s
Steps: 226 | Train Loss: 0.0444886 Vali Loss: 0.0541725 Test Loss: 0.0580277
Validation loss decreased (0.054407 --> 0.054172).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0422892
	speed: 0.2222s/iter; left time: 178.8709s
	iters: 200, epoch: 17 | loss: 0.0470878
	speed: 0.1280s/iter; left time: 90.2340s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:29.43s
Steps: 226 | Train Loss: 0.0442781 Vali Loss: 0.0540447 Test Loss: 0.0577816
Validation loss decreased (0.054172 --> 0.054045).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0428621
	speed: 0.2221s/iter; left time: 128.6126s
	iters: 200, epoch: 18 | loss: 0.0420758
	speed: 0.1283s/iter; left time: 61.4677s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:29.21s
Steps: 226 | Train Loss: 0.0441897 Vali Loss: 0.0538316 Test Loss: 0.0574501
Validation loss decreased (0.054045 --> 0.053832).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0450100
	speed: 0.2262s/iter; left time: 79.8356s
	iters: 200, epoch: 19 | loss: 0.0438370
	speed: 0.1301s/iter; left time: 32.9164s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:29.64s
Steps: 226 | Train Loss: 0.0440705 Vali Loss: 0.0542827 Test Loss: 0.0579725
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0456248
	speed: 0.2326s/iter; left time: 29.5355s
	iters: 200, epoch: 20 | loss: 0.0453012
	speed: 0.1281s/iter; left time: 3.4594s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:29.80s
Steps: 226 | Train Loss: 0.0439894 Vali Loss: 0.0539670 Test Loss: 0.0578357
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010744874365627766, rmse:0.10365748405456543, mae:0.057450130581855774, rse:0.3999077081680298
Intermediate time for FR and pred_len 24: 00h:23m:39.45s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0821435
	speed: 0.1545s/iter; left time: 679.7485s
	iters: 200, epoch: 1 | loss: 0.0831200
	speed: 0.1290s/iter; left time: 554.7620s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.47s
Steps: 225 | Train Loss: 0.0913107 Vali Loss: 0.0835734 Test Loss: 0.0922536
Validation loss decreased (inf --> 0.083573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0678073
	speed: 0.2200s/iter; left time: 918.6109s
	iters: 200, epoch: 2 | loss: 0.0694359
	speed: 0.1323s/iter; left time: 539.0511s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:29.51s
Steps: 225 | Train Loss: 0.0713360 Vali Loss: 0.0779968 Test Loss: 0.0871771
Validation loss decreased (0.083573 --> 0.077997).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0693156
	speed: 0.2307s/iter; left time: 911.5833s
	iters: 200, epoch: 3 | loss: 0.0701405
	speed: 0.1332s/iter; left time: 512.7959s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:30.04s
Steps: 225 | Train Loss: 0.0673879 Vali Loss: 0.0758549 Test Loss: 0.0862915
Validation loss decreased (0.077997 --> 0.075855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0674907
	speed: 0.2312s/iter; left time: 861.4394s
	iters: 200, epoch: 4 | loss: 0.0651132
	speed: 0.1320s/iter; left time: 478.5976s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.88s
Steps: 225 | Train Loss: 0.0659649 Vali Loss: 0.0749174 Test Loss: 0.0851213
Validation loss decreased (0.075855 --> 0.074917).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0647665
	speed: 0.2353s/iter; left time: 823.8602s
	iters: 200, epoch: 5 | loss: 0.0680801
	speed: 0.1313s/iter; left time: 446.5514s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:29.94s
Steps: 225 | Train Loss: 0.0647660 Vali Loss: 0.0744220 Test Loss: 0.0845276
Validation loss decreased (0.074917 --> 0.074422).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0638947
	speed: 0.2260s/iter; left time: 740.4066s
	iters: 200, epoch: 6 | loss: 0.0613103
	speed: 0.1293s/iter; left time: 410.6680s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:29.40s
Steps: 225 | Train Loss: 0.0637174 Vali Loss: 0.0733305 Test Loss: 0.0838157
Validation loss decreased (0.074422 --> 0.073331).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0639387
	speed: 0.2250s/iter; left time: 686.4712s
	iters: 200, epoch: 7 | loss: 0.0675600
	speed: 0.1322s/iter; left time: 390.1876s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:29.76s
Steps: 225 | Train Loss: 0.0629273 Vali Loss: 0.0727968 Test Loss: 0.0837717
Validation loss decreased (0.073331 --> 0.072797).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0639801
	speed: 0.2265s/iter; left time: 639.9718s
	iters: 200, epoch: 8 | loss: 0.0635716
	speed: 0.1335s/iter; left time: 363.8814s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.93s
Steps: 225 | Train Loss: 0.0625018 Vali Loss: 0.0732585 Test Loss: 0.0833542
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0613126
	speed: 0.2306s/iter; left time: 599.6642s
	iters: 200, epoch: 9 | loss: 0.0657632
	speed: 0.1333s/iter; left time: 333.2796s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:30.36s
Steps: 225 | Train Loss: 0.0620127 Vali Loss: 0.0723178 Test Loss: 0.0833246
Validation loss decreased (0.072797 --> 0.072318).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0602790
	speed: 0.2521s/iter; left time: 599.0509s
	iters: 200, epoch: 10 | loss: 0.0600664
	speed: 0.1314s/iter; left time: 299.0723s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:30.65s
Steps: 225 | Train Loss: 0.0616372 Vali Loss: 0.0726278 Test Loss: 0.0831672
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0597956
	speed: 0.2272s/iter; left time: 488.7564s
	iters: 200, epoch: 11 | loss: 0.0623358
	speed: 0.1313s/iter; left time: 269.2965s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:29.38s
Steps: 225 | Train Loss: 0.0612253 Vali Loss: 0.0724789 Test Loss: 0.0828953
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0646971
	speed: 0.2234s/iter; left time: 430.1962s
	iters: 200, epoch: 12 | loss: 0.0596059
	speed: 0.1309s/iter; left time: 239.0566s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:29.43s
Steps: 225 | Train Loss: 0.0609990 Vali Loss: 0.0719485 Test Loss: 0.0828231
Validation loss decreased (0.072318 --> 0.071948).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0582323
	speed: 0.2297s/iter; left time: 390.7735s
	iters: 200, epoch: 13 | loss: 0.0634934
	speed: 0.1343s/iter; left time: 215.0912s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:30.37s
Steps: 225 | Train Loss: 0.0607619 Vali Loss: 0.0720306 Test Loss: 0.0829450
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0619525
	speed: 0.2277s/iter; left time: 336.1307s
	iters: 200, epoch: 14 | loss: 0.0590660
	speed: 0.1288s/iter; left time: 177.2074s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:29.32s
Steps: 225 | Train Loss: 0.0605827 Vali Loss: 0.0714336 Test Loss: 0.0823739
Validation loss decreased (0.071948 --> 0.071434).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0587442
	speed: 0.2352s/iter; left time: 294.2492s
	iters: 200, epoch: 15 | loss: 0.0619651
	speed: 0.1357s/iter; left time: 156.2264s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:30.52s
Steps: 225 | Train Loss: 0.0603027 Vali Loss: 0.0718620 Test Loss: 0.0827420
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0584721
	speed: 0.2438s/iter; left time: 250.1415s
	iters: 200, epoch: 16 | loss: 0.0555041
	speed: 0.1298s/iter; left time: 120.2323s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:30.02s
Steps: 225 | Train Loss: 0.0602388 Vali Loss: 0.0716047 Test Loss: 0.0822622
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0603823
	speed: 0.2270s/iter; left time: 181.8549s
	iters: 200, epoch: 17 | loss: 0.0582806
	speed: 0.1320s/iter; left time: 92.5492s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:29.70s
Steps: 225 | Train Loss: 0.0599569 Vali Loss: 0.0717798 Test Loss: 0.0822858
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0589450
	speed: 0.2184s/iter; left time: 125.7864s
	iters: 200, epoch: 18 | loss: 0.0634137
	speed: 0.1286s/iter; left time: 61.2225s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:29.28s
Steps: 225 | Train Loss: 0.0598509 Vali Loss: 0.0716802 Test Loss: 0.0823941
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0584398
	speed: 0.2293s/iter; left time: 80.4760s
	iters: 200, epoch: 19 | loss: 0.0588430
	speed: 0.1327s/iter; left time: 33.3070s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:29.98s
Steps: 225 | Train Loss: 0.0596980 Vali Loss: 0.0715777 Test Loss: 0.0823717
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020205451175570488, rmse:0.14214588701725006, mae:0.08237384259700775, rse:0.549858033657074
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0894169
	speed: 0.1355s/iter; left time: 596.4210s
	iters: 200, epoch: 1 | loss: 0.0878222
	speed: 0.1323s/iter; left time: 568.9114s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:30.13s
Steps: 225 | Train Loss: 0.0921728 Vali Loss: 0.0833592 Test Loss: 0.0920192
Validation loss decreased (inf --> 0.083359).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0669506
	speed: 0.2316s/iter; left time: 967.1961s
	iters: 200, epoch: 2 | loss: 0.0688249
	speed: 0.1379s/iter; left time: 562.2376s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:30.68s
Steps: 225 | Train Loss: 0.0714438 Vali Loss: 0.0777502 Test Loss: 0.0868886
Validation loss decreased (0.083359 --> 0.077750).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0638473
	speed: 0.2275s/iter; left time: 898.6594s
	iters: 200, epoch: 3 | loss: 0.0689979
	speed: 0.1291s/iter; left time: 497.1331s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:29.42s
Steps: 225 | Train Loss: 0.0672572 Vali Loss: 0.0760684 Test Loss: 0.0863736
Validation loss decreased (0.077750 --> 0.076068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0672900
	speed: 0.2176s/iter; left time: 810.6828s
	iters: 200, epoch: 4 | loss: 0.0639855
	speed: 0.1278s/iter; left time: 463.2600s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.98s
Steps: 225 | Train Loss: 0.0658523 Vali Loss: 0.0749936 Test Loss: 0.0854241
Validation loss decreased (0.076068 --> 0.074994).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0626215
	speed: 0.2190s/iter; left time: 766.5479s
	iters: 200, epoch: 5 | loss: 0.0626608
	speed: 0.1280s/iter; left time: 435.2641s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:29.04s
Steps: 225 | Train Loss: 0.0646476 Vali Loss: 0.0739110 Test Loss: 0.0846380
Validation loss decreased (0.074994 --> 0.073911).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0641698
	speed: 0.2408s/iter; left time: 788.9978s
	iters: 200, epoch: 6 | loss: 0.0627856
	speed: 0.1388s/iter; left time: 440.8869s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.55s
Steps: 225 | Train Loss: 0.0639034 Vali Loss: 0.0747545 Test Loss: 0.0855872
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0652396
	speed: 0.2333s/iter; left time: 711.9271s
	iters: 200, epoch: 7 | loss: 0.0667626
	speed: 0.1315s/iter; left time: 387.9225s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:29.77s
Steps: 225 | Train Loss: 0.0631427 Vali Loss: 0.0732717 Test Loss: 0.0834854
Validation loss decreased (0.073911 --> 0.073272).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0631166
	speed: 0.2220s/iter; left time: 627.4747s
	iters: 200, epoch: 8 | loss: 0.0626838
	speed: 0.1296s/iter; left time: 353.2473s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.34s
Steps: 225 | Train Loss: 0.0625255 Vali Loss: 0.0733401 Test Loss: 0.0836931
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0613080
	speed: 0.2264s/iter; left time: 588.7666s
	iters: 200, epoch: 9 | loss: 0.0632498
	speed: 0.1335s/iter; left time: 333.8383s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:29.98s
Steps: 225 | Train Loss: 0.0621014 Vali Loss: 0.0734221 Test Loss: 0.0835117
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0624017
	speed: 0.2320s/iter; left time: 551.2138s
	iters: 200, epoch: 10 | loss: 0.0701763
	speed: 0.1306s/iter; left time: 297.2850s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:29.73s
Steps: 225 | Train Loss: 0.0616782 Vali Loss: 0.0723835 Test Loss: 0.0828523
Validation loss decreased (0.073272 --> 0.072383).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0656709
	speed: 0.2371s/iter; left time: 510.0696s
	iters: 200, epoch: 11 | loss: 0.0620192
	speed: 0.1364s/iter; left time: 279.7289s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:30.79s
Steps: 225 | Train Loss: 0.0613649 Vali Loss: 0.0728863 Test Loss: 0.0833074
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0611714
	speed: 0.2154s/iter; left time: 414.8459s
	iters: 200, epoch: 12 | loss: 0.0589759
	speed: 0.1288s/iter; left time: 235.1587s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:29.04s
Steps: 225 | Train Loss: 0.0611654 Vali Loss: 0.0720310 Test Loss: 0.0828215
Validation loss decreased (0.072383 --> 0.072031).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0601530
	speed: 0.2293s/iter; left time: 390.0917s
	iters: 200, epoch: 13 | loss: 0.0627939
	speed: 0.1299s/iter; left time: 207.9448s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:30.13s
Steps: 225 | Train Loss: 0.0608504 Vali Loss: 0.0722075 Test Loss: 0.0826092
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0604201
	speed: 0.2315s/iter; left time: 341.7533s
	iters: 200, epoch: 14 | loss: 0.0634251
	speed: 0.1313s/iter; left time: 180.6880s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:29.70s
Steps: 225 | Train Loss: 0.0606327 Vali Loss: 0.0726777 Test Loss: 0.0831189
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0640372
	speed: 0.2379s/iter; left time: 297.5685s
	iters: 200, epoch: 15 | loss: 0.0630407
	speed: 0.1352s/iter; left time: 155.5890s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:30.79s
Steps: 225 | Train Loss: 0.0604669 Vali Loss: 0.0721378 Test Loss: 0.0825559
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0591577
	speed: 0.2499s/iter; left time: 256.4079s
	iters: 200, epoch: 16 | loss: 0.0630949
	speed: 0.1303s/iter; left time: 120.6814s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:30.05s
Steps: 225 | Train Loss: 0.0602721 Vali Loss: 0.0723365 Test Loss: 0.0823819
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0585780
	speed: 0.2232s/iter; left time: 178.7965s
	iters: 200, epoch: 17 | loss: 0.0607349
	speed: 0.1285s/iter; left time: 90.0727s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:29.10s
Steps: 225 | Train Loss: 0.0601261 Vali Loss: 0.0719406 Test Loss: 0.0822569
Validation loss decreased (0.072031 --> 0.071941).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0573446
	speed: 0.2356s/iter; left time: 135.7109s
	iters: 200, epoch: 18 | loss: 0.0599148
	speed: 0.1314s/iter; left time: 62.5375s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:29.67s
Steps: 225 | Train Loss: 0.0599890 Vali Loss: 0.0719018 Test Loss: 0.0822290
Validation loss decreased (0.071941 --> 0.071902).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0560430
	speed: 0.2310s/iter; left time: 81.0980s
	iters: 200, epoch: 19 | loss: 0.0599572
	speed: 0.1354s/iter; left time: 33.9758s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:30.13s
Steps: 225 | Train Loss: 0.0598794 Vali Loss: 0.0721454 Test Loss: 0.0823054
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0642339
	speed: 0.2471s/iter; left time: 31.1371s
	iters: 200, epoch: 20 | loss: 0.0639723
	speed: 0.1287s/iter; left time: 3.3475s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:29.57s
Steps: 225 | Train Loss: 0.0597939 Vali Loss: 0.0717466 Test Loss: 0.0819931
Validation loss decreased (0.071902 --> 0.071747).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019991254433989525, rmse:0.14139042794704437, mae:0.08199303597211838, rse:0.5469357967376709
Intermediate time for FR and pred_len 96: 00h:23m:48.64s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0916881
	speed: 0.1560s/iter; left time: 686.5020s
	iters: 200, epoch: 1 | loss: 0.0869237
	speed: 0.1299s/iter; left time: 558.7424s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.70s
Steps: 225 | Train Loss: 0.0946456 Vali Loss: 0.0873302 Test Loss: 0.0960933
Validation loss decreased (inf --> 0.087330).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0765944
	speed: 0.2283s/iter; left time: 953.3026s
	iters: 200, epoch: 2 | loss: 0.0703099
	speed: 0.1304s/iter; left time: 531.6284s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:29.74s
Steps: 225 | Train Loss: 0.0755584 Vali Loss: 0.0817829 Test Loss: 0.0917741
Validation loss decreased (0.087330 --> 0.081783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0746351
	speed: 0.2314s/iter; left time: 914.1378s
	iters: 200, epoch: 3 | loss: 0.0698561
	speed: 0.1303s/iter; left time: 501.7055s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:29.53s
Steps: 225 | Train Loss: 0.0723485 Vali Loss: 0.0802219 Test Loss: 0.0911483
Validation loss decreased (0.081783 --> 0.080222).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0729910
	speed: 0.2407s/iter; left time: 896.8529s
	iters: 200, epoch: 4 | loss: 0.0687222
	speed: 0.1320s/iter; left time: 478.6431s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.99s
Steps: 225 | Train Loss: 0.0707458 Vali Loss: 0.0792043 Test Loss: 0.0905273
Validation loss decreased (0.080222 --> 0.079204).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0712522
	speed: 0.2426s/iter; left time: 849.1715s
	iters: 200, epoch: 5 | loss: 0.0685331
	speed: 0.1376s/iter; left time: 468.0457s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:30.85s
Steps: 225 | Train Loss: 0.0694804 Vali Loss: 0.0787229 Test Loss: 0.0898371
Validation loss decreased (0.079204 --> 0.078723).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0689771
	speed: 0.2448s/iter; left time: 802.0766s
	iters: 200, epoch: 6 | loss: 0.0695027
	speed: 0.1285s/iter; left time: 408.1601s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:29.07s
Steps: 225 | Train Loss: 0.0686404 Vali Loss: 0.0781113 Test Loss: 0.0888023
Validation loss decreased (0.078723 --> 0.078111).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0682323
	speed: 0.2350s/iter; left time: 717.0457s
	iters: 200, epoch: 7 | loss: 0.0699818
	speed: 0.1299s/iter; left time: 383.3049s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:29.94s
Steps: 225 | Train Loss: 0.0679058 Vali Loss: 0.0782345 Test Loss: 0.0895413
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0707153
	speed: 0.2300s/iter; left time: 649.8795s
	iters: 200, epoch: 8 | loss: 0.0695843
	speed: 0.1323s/iter; left time: 360.5899s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.95s
Steps: 225 | Train Loss: 0.0674135 Vali Loss: 0.0771264 Test Loss: 0.0888884
Validation loss decreased (0.078111 --> 0.077126).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0653303
	speed: 0.2277s/iter; left time: 592.3061s
	iters: 200, epoch: 9 | loss: 0.0724449
	speed: 0.1330s/iter; left time: 332.6720s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:30.07s
Steps: 225 | Train Loss: 0.0669095 Vali Loss: 0.0773865 Test Loss: 0.0887160
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0634143
	speed: 0.2379s/iter; left time: 565.1939s
	iters: 200, epoch: 10 | loss: 0.0633310
	speed: 0.1394s/iter; left time: 317.1841s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:31.14s
Steps: 225 | Train Loss: 0.0665528 Vali Loss: 0.0775114 Test Loss: 0.0891376
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0642596
	speed: 0.2275s/iter; left time: 489.4264s
	iters: 200, epoch: 11 | loss: 0.0683906
	speed: 0.1276s/iter; left time: 261.6182s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:29.03s
Steps: 225 | Train Loss: 0.0662428 Vali Loss: 0.0768049 Test Loss: 0.0883481
Validation loss decreased (0.077126 --> 0.076805).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0624630
	speed: 0.2224s/iter; left time: 428.3307s
	iters: 200, epoch: 12 | loss: 0.0640266
	speed: 0.1273s/iter; left time: 232.4838s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:29.06s
Steps: 225 | Train Loss: 0.0660178 Vali Loss: 0.0770547 Test Loss: 0.0880818
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0683184
	speed: 0.2192s/iter; left time: 372.8130s
	iters: 200, epoch: 13 | loss: 0.0646703
	speed: 0.1305s/iter; left time: 208.9174s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:29.52s
Steps: 225 | Train Loss: 0.0657393 Vali Loss: 0.0767636 Test Loss: 0.0878029
Validation loss decreased (0.076805 --> 0.076764).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0680823
	speed: 0.2324s/iter; left time: 343.0095s
	iters: 200, epoch: 14 | loss: 0.0666962
	speed: 0.1327s/iter; left time: 182.5558s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:29.85s
Steps: 225 | Train Loss: 0.0655135 Vali Loss: 0.0769423 Test Loss: 0.0880894
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0665233
	speed: 0.2246s/iter; left time: 281.0342s
	iters: 200, epoch: 15 | loss: 0.0659037
	speed: 0.1345s/iter; left time: 154.8287s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:30.31s
Steps: 225 | Train Loss: 0.0653375 Vali Loss: 0.0765706 Test Loss: 0.0880015
Validation loss decreased (0.076764 --> 0.076571).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0669951
	speed: 0.2355s/iter; left time: 241.6049s
	iters: 200, epoch: 16 | loss: 0.0666725
	speed: 0.1388s/iter; left time: 128.5453s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:30.74s
Steps: 225 | Train Loss: 0.0651356 Vali Loss: 0.0767214 Test Loss: 0.0881702
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0642989
	speed: 0.2467s/iter; left time: 197.5974s
	iters: 200, epoch: 17 | loss: 0.0637477
	speed: 0.1343s/iter; left time: 94.1531s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:30.53s
Steps: 225 | Train Loss: 0.0649981 Vali Loss: 0.0762711 Test Loss: 0.0878609
Validation loss decreased (0.076571 --> 0.076271).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0646516
	speed: 0.2447s/iter; left time: 140.9559s
	iters: 200, epoch: 18 | loss: 0.0679890
	speed: 0.1346s/iter; left time: 64.0479s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:30.47s
Steps: 225 | Train Loss: 0.0648507 Vali Loss: 0.0767555 Test Loss: 0.0878701
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0642924
	speed: 0.2296s/iter; left time: 80.5763s
	iters: 200, epoch: 19 | loss: 0.0647242
	speed: 0.1311s/iter; left time: 32.9061s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:29.71s
Steps: 225 | Train Loss: 0.0647024 Vali Loss: 0.0764668 Test Loss: 0.0877801
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0624535
	speed: 0.2363s/iter; left time: 29.7705s
	iters: 200, epoch: 20 | loss: 0.0675110
	speed: 0.1368s/iter; left time: 3.5563s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:30.79s
Steps: 225 | Train Loss: 0.0646263 Vali Loss: 0.0767285 Test Loss: 0.0880821
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02186432108283043, rmse:0.147865891456604, mae:0.08786085247993469, rse:0.5726985931396484
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0919613
	speed: 0.1358s/iter; left time: 597.7374s
	iters: 200, epoch: 1 | loss: 0.0867113
	speed: 0.1342s/iter; left time: 577.1577s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:30.35s
Steps: 225 | Train Loss: 0.0940161 Vali Loss: 0.0871972 Test Loss: 0.0960238
Validation loss decreased (inf --> 0.087197).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0713059
	speed: 0.2526s/iter; left time: 1054.7877s
	iters: 200, epoch: 2 | loss: 0.0714525
	speed: 0.1323s/iter; left time: 539.3826s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:30.07s
Steps: 225 | Train Loss: 0.0757864 Vali Loss: 0.0823225 Test Loss: 0.0925486
Validation loss decreased (0.087197 --> 0.082323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0671578
	speed: 0.2375s/iter; left time: 938.2541s
	iters: 200, epoch: 3 | loss: 0.0709672
	speed: 0.1327s/iter; left time: 511.0544s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:30.16s
Steps: 225 | Train Loss: 0.0723406 Vali Loss: 0.0810314 Test Loss: 0.0920664
Validation loss decreased (0.082323 --> 0.081031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0700649
	speed: 0.2308s/iter; left time: 859.8207s
	iters: 200, epoch: 4 | loss: 0.0703632
	speed: 0.1333s/iter; left time: 483.2822s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:30.08s
Steps: 225 | Train Loss: 0.0707206 Vali Loss: 0.0790750 Test Loss: 0.0903970
Validation loss decreased (0.081031 --> 0.079075).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0656126
	speed: 0.2482s/iter; left time: 869.1222s
	iters: 200, epoch: 5 | loss: 0.0692182
	speed: 0.1333s/iter; left time: 453.2203s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:30.34s
Steps: 225 | Train Loss: 0.0694477 Vali Loss: 0.0789509 Test Loss: 0.0901828
Validation loss decreased (0.079075 --> 0.078951).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0686687
	speed: 0.2328s/iter; left time: 762.7674s
	iters: 200, epoch: 6 | loss: 0.0678676
	speed: 0.1305s/iter; left time: 414.3539s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:29.92s
Steps: 225 | Train Loss: 0.0686255 Vali Loss: 0.0783217 Test Loss: 0.0896430
Validation loss decreased (0.078951 --> 0.078322).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0661045
	speed: 0.2638s/iter; left time: 804.9863s
	iters: 200, epoch: 7 | loss: 0.0682785
	speed: 0.1376s/iter; left time: 406.1562s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:30.81s
Steps: 225 | Train Loss: 0.0678917 Vali Loss: 0.0783234 Test Loss: 0.0887447
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0683451
	speed: 0.2095s/iter; left time: 591.9777s
	iters: 200, epoch: 8 | loss: 0.0687753
	speed: 0.1242s/iter; left time: 338.6357s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.14s
Steps: 225 | Train Loss: 0.0673855 Vali Loss: 0.0778848 Test Loss: 0.0888012
Validation loss decreased (0.078322 --> 0.077885).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0657038
	speed: 0.2074s/iter; left time: 539.5108s
	iters: 200, epoch: 9 | loss: 0.0665707
	speed: 0.1242s/iter; left time: 310.6456s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.14s
Steps: 225 | Train Loss: 0.0668863 Vali Loss: 0.0776036 Test Loss: 0.0886073
Validation loss decreased (0.077885 --> 0.077604).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0667441
	speed: 0.2228s/iter; left time: 529.2991s
	iters: 200, epoch: 10 | loss: 0.0633583
	speed: 0.1245s/iter; left time: 283.4328s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.22s
Steps: 225 | Train Loss: 0.0664838 Vali Loss: 0.0774441 Test Loss: 0.0883286
Validation loss decreased (0.077604 --> 0.077444).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0627698
	speed: 0.2068s/iter; left time: 444.8338s
	iters: 200, epoch: 11 | loss: 0.0660751
	speed: 0.1249s/iter; left time: 256.2509s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.25s
Steps: 225 | Train Loss: 0.0662418 Vali Loss: 0.0770156 Test Loss: 0.0887772
Validation loss decreased (0.077444 --> 0.077016).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0683075
	speed: 0.2137s/iter; left time: 411.6625s
	iters: 200, epoch: 12 | loss: 0.0689828
	speed: 0.1246s/iter; left time: 227.5600s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.22s
Steps: 225 | Train Loss: 0.0658903 Vali Loss: 0.0768637 Test Loss: 0.0878356
Validation loss decreased (0.077016 --> 0.076864).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0688406
	speed: 0.2060s/iter; left time: 350.4884s
	iters: 200, epoch: 13 | loss: 0.0636687
	speed: 0.1243s/iter; left time: 199.0626s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.15s
Steps: 225 | Train Loss: 0.0656338 Vali Loss: 0.0767962 Test Loss: 0.0876834
Validation loss decreased (0.076864 --> 0.076796).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0652549
	speed: 0.2430s/iter; left time: 358.6146s
	iters: 200, epoch: 14 | loss: 0.0669380
	speed: 0.1244s/iter; left time: 171.1623s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.15s
Steps: 225 | Train Loss: 0.0654096 Vali Loss: 0.0768992 Test Loss: 0.0880054
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0605805
	speed: 0.2051s/iter; left time: 256.5708s
	iters: 200, epoch: 15 | loss: 0.0669335
	speed: 0.1242s/iter; left time: 142.9222s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.10s
Steps: 225 | Train Loss: 0.0652253 Vali Loss: 0.0767318 Test Loss: 0.0878261
Validation loss decreased (0.076796 --> 0.076732).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0649559
	speed: 0.2810s/iter; left time: 288.3519s
	iters: 200, epoch: 16 | loss: 0.0645573
	speed: 0.1239s/iter; left time: 114.7353s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.07s
Steps: 225 | Train Loss: 0.0650691 Vali Loss: 0.0766515 Test Loss: 0.0880999
Validation loss decreased (0.076732 --> 0.076652).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0705975
	speed: 0.2069s/iter; left time: 165.6977s
	iters: 200, epoch: 17 | loss: 0.0659833
	speed: 0.1246s/iter; left time: 87.3566s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.29s
Steps: 225 | Train Loss: 0.0648604 Vali Loss: 0.0765938 Test Loss: 0.0877360
Validation loss decreased (0.076652 --> 0.076594).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0670262
	speed: 0.2088s/iter; left time: 120.2704s
	iters: 200, epoch: 18 | loss: 0.0629649
	speed: 0.1242s/iter; left time: 59.1317s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:28.20s
Steps: 225 | Train Loss: 0.0647039 Vali Loss: 0.0767391 Test Loss: 0.0876653
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0651461
	speed: 0.2065s/iter; left time: 72.4737s
	iters: 200, epoch: 19 | loss: 0.0666738
	speed: 0.1247s/iter; left time: 31.2913s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.29s
Steps: 225 | Train Loss: 0.0646175 Vali Loss: 0.0765972 Test Loss: 0.0876592
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0639071
	speed: 0.2063s/iter; left time: 25.9905s
	iters: 200, epoch: 20 | loss: 0.0667633
	speed: 0.1248s/iter; left time: 3.2448s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:28.25s
Steps: 225 | Train Loss: 0.0645528 Vali Loss: 0.0764963 Test Loss: 0.0876327
Validation loss decreased (0.076594 --> 0.076496).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021848367527127266, rmse:0.14781193435192108, mae:0.08763277530670166, rse:0.5724896192550659
Intermediate time for FR and pred_len 168: 00h:24m:15.00s
Intermediate time for FR: 01h:11m:43.09s

=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1121790
	speed: 0.1485s/iter; left time: 656.3155s
	iters: 200, epoch: 1 | loss: 0.1071127
	speed: 0.1232s/iter; left time: 532.5449s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:28.25s
Steps: 226 | Train Loss: 0.1183522 Vali Loss: 0.0811168 Test Loss: 0.0823932
Validation loss decreased (inf --> 0.081117).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0740139
	speed: 0.2044s/iter; left time: 857.5001s
	iters: 200, epoch: 2 | loss: 0.0693383
	speed: 0.1233s/iter; left time: 504.8703s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.08s
Steps: 226 | Train Loss: 0.0758895 Vali Loss: 0.0661073 Test Loss: 0.0684309
Validation loss decreased (0.081117 --> 0.066107).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0692373
	speed: 0.2102s/iter; left time: 834.3075s
	iters: 200, epoch: 3 | loss: 0.0680119
	speed: 0.1235s/iter; left time: 477.7236s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.11s
Steps: 226 | Train Loss: 0.0688669 Vali Loss: 0.0632555 Test Loss: 0.0659584
Validation loss decreased (0.066107 --> 0.063256).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0691024
	speed: 0.2072s/iter; left time: 775.4327s
	iters: 200, epoch: 4 | loss: 0.0713159
	speed: 0.1235s/iter; left time: 449.9605s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.16s
Steps: 226 | Train Loss: 0.0659160 Vali Loss: 0.0616597 Test Loss: 0.0638568
Validation loss decreased (0.063256 --> 0.061660).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0636145
	speed: 0.2046s/iter; left time: 719.5598s
	iters: 200, epoch: 5 | loss: 0.0682091
	speed: 0.1239s/iter; left time: 423.2400s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.14s
Steps: 226 | Train Loss: 0.0640215 Vali Loss: 0.0601045 Test Loss: 0.0630680
Validation loss decreased (0.061660 --> 0.060105).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0645924
	speed: 0.2080s/iter; left time: 684.6706s
	iters: 200, epoch: 6 | loss: 0.0623100
	speed: 0.1244s/iter; left time: 396.8996s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.29s
Steps: 226 | Train Loss: 0.0623804 Vali Loss: 0.0589569 Test Loss: 0.0620875
Validation loss decreased (0.060105 --> 0.058957).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0597447
	speed: 0.2059s/iter; left time: 631.1167s
	iters: 200, epoch: 7 | loss: 0.0645506
	speed: 0.1241s/iter; left time: 368.0582s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.24s
Steps: 226 | Train Loss: 0.0614329 Vali Loss: 0.0588587 Test Loss: 0.0619362
Validation loss decreased (0.058957 --> 0.058859).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0571509
	speed: 0.2078s/iter; left time: 589.9646s
	iters: 200, epoch: 8 | loss: 0.0552820
	speed: 0.1242s/iter; left time: 340.1500s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.26s
Steps: 226 | Train Loss: 0.0606643 Vali Loss: 0.0580877 Test Loss: 0.0607174
Validation loss decreased (0.058859 --> 0.058088).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0629100
	speed: 0.2072s/iter; left time: 541.3866s
	iters: 200, epoch: 9 | loss: 0.0620225
	speed: 0.1241s/iter; left time: 311.9142s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.29s
Steps: 226 | Train Loss: 0.0599683 Vali Loss: 0.0578587 Test Loss: 0.0605800
Validation loss decreased (0.058088 --> 0.057859).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0574319
	speed: 0.2074s/iter; left time: 495.0400s
	iters: 200, epoch: 10 | loss: 0.0602710
	speed: 0.1243s/iter; left time: 284.1922s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.28s
Steps: 226 | Train Loss: 0.0595075 Vali Loss: 0.0576037 Test Loss: 0.0601031
Validation loss decreased (0.057859 --> 0.057604).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0606948
	speed: 0.2064s/iter; left time: 446.0991s
	iters: 200, epoch: 11 | loss: 0.0578572
	speed: 0.1242s/iter; left time: 255.9500s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.22s
Steps: 226 | Train Loss: 0.0590668 Vali Loss: 0.0575622 Test Loss: 0.0603818
Validation loss decreased (0.057604 --> 0.057562).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0614702
	speed: 0.2109s/iter; left time: 408.0815s
	iters: 200, epoch: 12 | loss: 0.0576249
	speed: 0.1240s/iter; left time: 227.5818s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.19s
Steps: 226 | Train Loss: 0.0588322 Vali Loss: 0.0570690 Test Loss: 0.0595613
Validation loss decreased (0.057562 --> 0.057069).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0536879
	speed: 0.2054s/iter; left time: 350.9909s
	iters: 200, epoch: 13 | loss: 0.0548065
	speed: 0.1238s/iter; left time: 199.2683s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.16s
Steps: 226 | Train Loss: 0.0584687 Vali Loss: 0.0568619 Test Loss: 0.0593011
Validation loss decreased (0.057069 --> 0.056862).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0570590
	speed: 0.2051s/iter; left time: 304.2340s
	iters: 200, epoch: 14 | loss: 0.0629808
	speed: 0.1233s/iter; left time: 170.4929s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.01s
Steps: 226 | Train Loss: 0.0580641 Vali Loss: 0.0568366 Test Loss: 0.0590742
Validation loss decreased (0.056862 --> 0.056837).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0571397
	speed: 0.2038s/iter; left time: 256.1308s
	iters: 200, epoch: 15 | loss: 0.0618289
	speed: 0.1230s/iter; left time: 142.3411s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.97s
Steps: 226 | Train Loss: 0.0577726 Vali Loss: 0.0567835 Test Loss: 0.0589230
Validation loss decreased (0.056837 --> 0.056783).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0589630
	speed: 0.2039s/iter; left time: 210.1841s
	iters: 200, epoch: 16 | loss: 0.0573150
	speed: 0.1231s/iter; left time: 114.5785s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:27.99s
Steps: 226 | Train Loss: 0.0576216 Vali Loss: 0.0564624 Test Loss: 0.0587323
Validation loss decreased (0.056783 --> 0.056462).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0625905
	speed: 0.2044s/iter; left time: 164.5188s
	iters: 200, epoch: 17 | loss: 0.0577565
	speed: 0.1232s/iter; left time: 86.8267s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.01s
Steps: 226 | Train Loss: 0.0573842 Vali Loss: 0.0568271 Test Loss: 0.0590868
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0595494
	speed: 0.2032s/iter; left time: 117.6542s
	iters: 200, epoch: 18 | loss: 0.0563744
	speed: 0.1231s/iter; left time: 58.9491s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:27.99s
Steps: 226 | Train Loss: 0.0572813 Vali Loss: 0.0563119 Test Loss: 0.0589350
Validation loss decreased (0.056462 --> 0.056312).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0563603
	speed: 0.2111s/iter; left time: 74.5156s
	iters: 200, epoch: 19 | loss: 0.0545016
	speed: 0.1231s/iter; left time: 31.1419s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.00s
Steps: 226 | Train Loss: 0.0570930 Vali Loss: 0.0561932 Test Loss: 0.0585328
Validation loss decreased (0.056312 --> 0.056193).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0566096
	speed: 0.2045s/iter; left time: 25.9745s
	iters: 200, epoch: 20 | loss: 0.0562457
	speed: 0.1232s/iter; left time: 3.3262s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:27.99s
Steps: 226 | Train Loss: 0.0569631 Vali Loss: 0.0565658 Test Loss: 0.0586333
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010333484970033169, rmse:0.10165374726057053, mae:0.05853284150362015, rse:0.38409945368766785
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1148740
	speed: 0.1241s/iter; left time: 548.5404s
	iters: 200, epoch: 1 | loss: 0.1035100
	speed: 0.1231s/iter; left time: 531.7546s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:27.96s
Steps: 226 | Train Loss: 0.1211798 Vali Loss: 0.0813818 Test Loss: 0.0824983
Validation loss decreased (inf --> 0.081382).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0743233
	speed: 0.2036s/iter; left time: 854.1455s
	iters: 200, epoch: 2 | loss: 0.0723142
	speed: 0.1233s/iter; left time: 504.8830s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:27.97s
Steps: 226 | Train Loss: 0.0766999 Vali Loss: 0.0664761 Test Loss: 0.0689256
Validation loss decreased (0.081382 --> 0.066476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0662167
	speed: 0.2042s/iter; left time: 810.5253s
	iters: 200, epoch: 3 | loss: 0.0662025
	speed: 0.1231s/iter; left time: 476.3511s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.96s
Steps: 226 | Train Loss: 0.0688360 Vali Loss: 0.0637087 Test Loss: 0.0665311
Validation loss decreased (0.066476 --> 0.063709).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0641758
	speed: 0.2029s/iter; left time: 759.5616s
	iters: 200, epoch: 4 | loss: 0.0634328
	speed: 0.1232s/iter; left time: 448.7891s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:27.95s
Steps: 226 | Train Loss: 0.0661288 Vali Loss: 0.0619317 Test Loss: 0.0649719
Validation loss decreased (0.063709 --> 0.061932).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0694065
	speed: 0.2036s/iter; left time: 716.1528s
	iters: 200, epoch: 5 | loss: 0.0643803
	speed: 0.1230s/iter; left time: 420.1641s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:27.89s
Steps: 226 | Train Loss: 0.0639748 Vali Loss: 0.0606104 Test Loss: 0.0633659
Validation loss decreased (0.061932 --> 0.060610).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0637849
	speed: 0.2024s/iter; left time: 666.0609s
	iters: 200, epoch: 6 | loss: 0.0608316
	speed: 0.1231s/iter; left time: 392.8231s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:27.91s
Steps: 226 | Train Loss: 0.0624958 Vali Loss: 0.0588577 Test Loss: 0.0615097
Validation loss decreased (0.060610 --> 0.058858).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0591928
	speed: 0.2033s/iter; left time: 623.0883s
	iters: 200, epoch: 7 | loss: 0.0583320
	speed: 0.1233s/iter; left time: 365.6925s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:27.98s
Steps: 226 | Train Loss: 0.0614027 Vali Loss: 0.0586346 Test Loss: 0.0618780
Validation loss decreased (0.058858 --> 0.058635).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0588122
	speed: 0.2059s/iter; left time: 584.6852s
	iters: 200, epoch: 8 | loss: 0.0603447
	speed: 0.1233s/iter; left time: 337.5825s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:27.99s
Steps: 226 | Train Loss: 0.0605622 Vali Loss: 0.0581572 Test Loss: 0.0613240
Validation loss decreased (0.058635 --> 0.058157).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0627868
	speed: 0.2067s/iter; left time: 540.1944s
	iters: 200, epoch: 9 | loss: 0.0602490
	speed: 0.1235s/iter; left time: 310.4578s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.09s
Steps: 226 | Train Loss: 0.0599007 Vali Loss: 0.0575575 Test Loss: 0.0602312
Validation loss decreased (0.058157 --> 0.057558).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0568765
	speed: 0.2092s/iter; left time: 499.3861s
	iters: 200, epoch: 10 | loss: 0.0624954
	speed: 0.1240s/iter; left time: 283.6920s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.25s
Steps: 226 | Train Loss: 0.0593471 Vali Loss: 0.0574005 Test Loss: 0.0601187
Validation loss decreased (0.057558 --> 0.057400).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0596192
	speed: 0.2111s/iter; left time: 456.0823s
	iters: 200, epoch: 11 | loss: 0.0592127
	speed: 0.1240s/iter; left time: 255.4822s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.15s
Steps: 226 | Train Loss: 0.0590144 Vali Loss: 0.0572044 Test Loss: 0.0598468
Validation loss decreased (0.057400 --> 0.057204).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0615893
	speed: 0.2488s/iter; left time: 481.3734s
	iters: 200, epoch: 12 | loss: 0.0559695
	speed: 0.1233s/iter; left time: 226.2720s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.07s
Steps: 226 | Train Loss: 0.0584624 Vali Loss: 0.0569848 Test Loss: 0.0595079
Validation loss decreased (0.057204 --> 0.056985).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0584085
	speed: 0.2060s/iter; left time: 352.1014s
	iters: 200, epoch: 13 | loss: 0.0579237
	speed: 0.1232s/iter; left time: 198.3044s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.05s
Steps: 226 | Train Loss: 0.0582000 Vali Loss: 0.0570694 Test Loss: 0.0599025
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0592260
	speed: 0.2046s/iter; left time: 303.4499s
	iters: 200, epoch: 14 | loss: 0.0572892
	speed: 0.1232s/iter; left time: 170.3585s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.02s
Steps: 226 | Train Loss: 0.0580283 Vali Loss: 0.0570102 Test Loss: 0.0598739
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0573419
	speed: 0.2042s/iter; left time: 256.6187s
	iters: 200, epoch: 15 | loss: 0.0580359
	speed: 0.1232s/iter; left time: 142.5573s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.99s
Steps: 226 | Train Loss: 0.0577937 Vali Loss: 0.0566747 Test Loss: 0.0594992
Validation loss decreased (0.056985 --> 0.056675).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0595963
	speed: 0.2052s/iter; left time: 211.5397s
	iters: 200, epoch: 16 | loss: 0.0581507
	speed: 0.1232s/iter; left time: 114.7433s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:27.96s
Steps: 226 | Train Loss: 0.0575645 Vali Loss: 0.0563853 Test Loss: 0.0590242
Validation loss decreased (0.056675 --> 0.056385).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0537569
	speed: 0.2030s/iter; left time: 163.3863s
	iters: 200, epoch: 17 | loss: 0.0591558
	speed: 0.1232s/iter; left time: 86.8790s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:27.96s
Steps: 226 | Train Loss: 0.0572866 Vali Loss: 0.0562514 Test Loss: 0.0589677
Validation loss decreased (0.056385 --> 0.056251).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0616697
	speed: 0.2047s/iter; left time: 118.5172s
	iters: 200, epoch: 18 | loss: 0.0598275
	speed: 0.1234s/iter; left time: 59.1119s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:28.08s
Steps: 226 | Train Loss: 0.0571565 Vali Loss: 0.0560796 Test Loss: 0.0589612
Validation loss decreased (0.056251 --> 0.056080).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0564034
	speed: 0.2039s/iter; left time: 71.9723s
	iters: 200, epoch: 19 | loss: 0.0553540
	speed: 0.1234s/iter; left time: 31.2220s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.02s
Steps: 226 | Train Loss: 0.0570096 Vali Loss: 0.0560311 Test Loss: 0.0588667
Validation loss decreased (0.056080 --> 0.056031).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0543480
	speed: 0.2057s/iter; left time: 26.1271s
	iters: 200, epoch: 20 | loss: 0.0582589
	speed: 0.1231s/iter; left time: 3.3244s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:28.00s
Steps: 226 | Train Loss: 0.0568625 Vali Loss: 0.0558932 Test Loss: 0.0588943
Validation loss decreased (0.056031 --> 0.055893).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010509154759347439, rmse:0.10251417011022568, mae:0.058894332498311996, rse:0.38735058903694153
Intermediate time for IT and pred_len 24: 00h:22m:16.27s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1246291
	speed: 0.1502s/iter; left time: 661.2296s
	iters: 200, epoch: 1 | loss: 0.1170714
	speed: 0.1238s/iter; left time: 532.5747s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:28.34s
Steps: 225 | Train Loss: 0.1307737 Vali Loss: 0.0961518 Test Loss: 0.0997427
Validation loss decreased (inf --> 0.096152).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0948495
	speed: 0.2148s/iter; left time: 896.9106s
	iters: 200, epoch: 2 | loss: 0.0954342
	speed: 0.1237s/iter; left time: 504.1970s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.02s
Steps: 225 | Train Loss: 0.0978327 Vali Loss: 0.0849951 Test Loss: 0.0893700
Validation loss decreased (0.096152 --> 0.084995).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0911742
	speed: 0.2054s/iter; left time: 811.6634s
	iters: 200, epoch: 3 | loss: 0.0884128
	speed: 0.1237s/iter; left time: 476.2466s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.99s
Steps: 225 | Train Loss: 0.0892406 Vali Loss: 0.0825536 Test Loss: 0.0875067
Validation loss decreased (0.084995 --> 0.082554).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0867200
	speed: 0.2058s/iter; left time: 766.8796s
	iters: 200, epoch: 4 | loss: 0.0846905
	speed: 0.1239s/iter; left time: 449.1484s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.05s
Steps: 225 | Train Loss: 0.0855845 Vali Loss: 0.0808799 Test Loss: 0.0862431
Validation loss decreased (0.082554 --> 0.080880).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0797206
	speed: 0.2094s/iter; left time: 733.1353s
	iters: 200, epoch: 5 | loss: 0.0888789
	speed: 0.1238s/iter; left time: 421.2037s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.16s
Steps: 225 | Train Loss: 0.0834375 Vali Loss: 0.0790271 Test Loss: 0.0843552
Validation loss decreased (0.080880 --> 0.079027).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0826562
	speed: 0.2102s/iter; left time: 688.7716s
	iters: 200, epoch: 6 | loss: 0.0778374
	speed: 0.1240s/iter; left time: 393.7166s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.16s
Steps: 225 | Train Loss: 0.0821521 Vali Loss: 0.0782054 Test Loss: 0.0836802
Validation loss decreased (0.079027 --> 0.078205).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0799794
	speed: 0.2217s/iter; left time: 676.3642s
	iters: 200, epoch: 7 | loss: 0.0788258
	speed: 0.1239s/iter; left time: 365.7743s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.11s
Steps: 225 | Train Loss: 0.0813023 Vali Loss: 0.0782941 Test Loss: 0.0837826
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0789111
	speed: 0.2070s/iter; left time: 585.0643s
	iters: 200, epoch: 8 | loss: 0.0816973
	speed: 0.1240s/iter; left time: 338.0102s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.08s
Steps: 225 | Train Loss: 0.0806553 Vali Loss: 0.0778118 Test Loss: 0.0829287
Validation loss decreased (0.078205 --> 0.077812).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0801560
	speed: 0.2108s/iter; left time: 548.3920s
	iters: 200, epoch: 9 | loss: 0.0835952
	speed: 0.1246s/iter; left time: 311.6152s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.23s
Steps: 225 | Train Loss: 0.0801367 Vali Loss: 0.0776850 Test Loss: 0.0827472
Validation loss decreased (0.077812 --> 0.077685).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0809377
	speed: 0.2122s/iter; left time: 504.1102s
	iters: 200, epoch: 10 | loss: 0.0785008
	speed: 0.1244s/iter; left time: 283.1045s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.16s
Steps: 225 | Train Loss: 0.0797318 Vali Loss: 0.0775685 Test Loss: 0.0825838
Validation loss decreased (0.077685 --> 0.077569).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0773143
	speed: 0.2090s/iter; left time: 449.5153s
	iters: 200, epoch: 11 | loss: 0.0786918
	speed: 0.1238s/iter; left time: 253.8170s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:27.97s
Steps: 225 | Train Loss: 0.0793911 Vali Loss: 0.0773214 Test Loss: 0.0821988
Validation loss decreased (0.077569 --> 0.077321).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0843383
	speed: 0.2057s/iter; left time: 396.2053s
	iters: 200, epoch: 12 | loss: 0.0793643
	speed: 0.1236s/iter; left time: 225.7655s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.02s
Steps: 225 | Train Loss: 0.0790657 Vali Loss: 0.0772528 Test Loss: 0.0820618
Validation loss decreased (0.077321 --> 0.077253).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0776302
	speed: 0.2073s/iter; left time: 352.5856s
	iters: 200, epoch: 13 | loss: 0.0800399
	speed: 0.1238s/iter; left time: 198.1393s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:27.99s
Steps: 225 | Train Loss: 0.0787998 Vali Loss: 0.0769798 Test Loss: 0.0813489
Validation loss decreased (0.077253 --> 0.076980).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0797844
	speed: 0.2163s/iter; left time: 319.2716s
	iters: 200, epoch: 14 | loss: 0.0793766
	speed: 0.1239s/iter; left time: 170.5063s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.15s
Steps: 225 | Train Loss: 0.0785462 Vali Loss: 0.0769688 Test Loss: 0.0817476
Validation loss decreased (0.076980 --> 0.076969).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0755080
	speed: 0.2114s/iter; left time: 264.5179s
	iters: 200, epoch: 15 | loss: 0.0763225
	speed: 0.1237s/iter; left time: 142.3853s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.00s
Steps: 225 | Train Loss: 0.0783976 Vali Loss: 0.0769022 Test Loss: 0.0815266
Validation loss decreased (0.076969 --> 0.076902).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0759583
	speed: 0.2252s/iter; left time: 231.1064s
	iters: 200, epoch: 16 | loss: 0.0809015
	speed: 0.1237s/iter; left time: 114.5102s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.00s
Steps: 225 | Train Loss: 0.0782896 Vali Loss: 0.0767670 Test Loss: 0.0815434
Validation loss decreased (0.076902 --> 0.076767).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0807900
	speed: 0.2069s/iter; left time: 165.7560s
	iters: 200, epoch: 17 | loss: 0.0796471
	speed: 0.1236s/iter; left time: 86.6729s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.05s
Steps: 225 | Train Loss: 0.0780911 Vali Loss: 0.0765583 Test Loss: 0.0813489
Validation loss decreased (0.076767 --> 0.076558).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0750794
	speed: 0.2082s/iter; left time: 119.9227s
	iters: 200, epoch: 18 | loss: 0.0804618
	speed: 0.1238s/iter; left time: 58.9253s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:27.97s
Steps: 225 | Train Loss: 0.0778818 Vali Loss: 0.0766912 Test Loss: 0.0816509
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0737888
	speed: 0.2070s/iter; left time: 72.6420s
	iters: 200, epoch: 19 | loss: 0.0769352
	speed: 0.1236s/iter; left time: 31.0254s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.05s
Steps: 225 | Train Loss: 0.0777152 Vali Loss: 0.0764046 Test Loss: 0.0812570
Validation loss decreased (0.076558 --> 0.076405).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0773344
	speed: 0.2066s/iter; left time: 26.0332s
	iters: 200, epoch: 20 | loss: 0.0809498
	speed: 0.1237s/iter; left time: 3.2171s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:27.97s
Steps: 225 | Train Loss: 0.0776153 Vali Loss: 0.0764732 Test Loss: 0.0810120
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018536528572440147, rmse:0.13614891469478607, mae:0.08125697821378708, rse:0.5147936940193176
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1274510
	speed: 0.1244s/iter; left time: 547.5407s
	iters: 200, epoch: 1 | loss: 0.1164847
	speed: 0.1235s/iter; left time: 531.1899s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:27.93s
Steps: 225 | Train Loss: 0.1317651 Vali Loss: 0.0965845 Test Loss: 0.1001872
Validation loss decreased (inf --> 0.096585).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0931384
	speed: 0.2059s/iter; left time: 859.8003s
	iters: 200, epoch: 2 | loss: 0.0937748
	speed: 0.1237s/iter; left time: 504.3990s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.05s
Steps: 225 | Train Loss: 0.0983610 Vali Loss: 0.0854578 Test Loss: 0.0899371
Validation loss decreased (0.096585 --> 0.085458).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0879004
	speed: 0.2064s/iter; left time: 815.6114s
	iters: 200, epoch: 3 | loss: 0.0821228
	speed: 0.1238s/iter; left time: 476.9309s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.97s
Steps: 225 | Train Loss: 0.0891939 Vali Loss: 0.0823376 Test Loss: 0.0874421
Validation loss decreased (0.085458 --> 0.082338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0863800
	speed: 0.2064s/iter; left time: 769.2313s
	iters: 200, epoch: 4 | loss: 0.0839542
	speed: 0.1237s/iter; left time: 448.7139s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:27.97s
Steps: 225 | Train Loss: 0.0857099 Vali Loss: 0.0812594 Test Loss: 0.0861944
Validation loss decreased (0.082338 --> 0.081259).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0866721
	speed: 0.2086s/iter; left time: 730.2604s
	iters: 200, epoch: 5 | loss: 0.0816669
	speed: 0.1237s/iter; left time: 420.6107s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.03s
Steps: 225 | Train Loss: 0.0838621 Vali Loss: 0.0807487 Test Loss: 0.0857736
Validation loss decreased (0.081259 --> 0.080749).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839811
	speed: 0.2056s/iter; left time: 673.5906s
	iters: 200, epoch: 6 | loss: 0.0856897
	speed: 0.1236s/iter; left time: 392.5398s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.01s
Steps: 225 | Train Loss: 0.0824806 Vali Loss: 0.0787402 Test Loss: 0.0840767
Validation loss decreased (0.080749 --> 0.078740).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0824418
	speed: 0.2073s/iter; left time: 632.4306s
	iters: 200, epoch: 7 | loss: 0.0837693
	speed: 0.1236s/iter; left time: 364.8143s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.02s
Steps: 225 | Train Loss: 0.0817001 Vali Loss: 0.0782434 Test Loss: 0.0841690
Validation loss decreased (0.078740 --> 0.078243).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0798583
	speed: 0.2053s/iter; left time: 580.1476s
	iters: 200, epoch: 8 | loss: 0.0807079
	speed: 0.1237s/iter; left time: 337.1205s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.03s
Steps: 225 | Train Loss: 0.0809182 Vali Loss: 0.0780490 Test Loss: 0.0831145
Validation loss decreased (0.078243 --> 0.078049).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0792143
	speed: 0.2077s/iter; left time: 540.2567s
	iters: 200, epoch: 9 | loss: 0.0885995
	speed: 0.1240s/iter; left time: 310.1126s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.05s
Steps: 225 | Train Loss: 0.0805063 Vali Loss: 0.0778816 Test Loss: 0.0831148
Validation loss decreased (0.078049 --> 0.077882).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0826082
	speed: 0.2055s/iter; left time: 488.1716s
	iters: 200, epoch: 10 | loss: 0.0805768
	speed: 0.1239s/iter; left time: 282.1076s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.08s
Steps: 225 | Train Loss: 0.0798953 Vali Loss: 0.0776451 Test Loss: 0.0828241
Validation loss decreased (0.077882 --> 0.077645).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0783376
	speed: 0.2062s/iter; left time: 443.5818s
	iters: 200, epoch: 11 | loss: 0.0749998
	speed: 0.1243s/iter; left time: 254.9602s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.11s
Steps: 225 | Train Loss: 0.0794778 Vali Loss: 0.0775692 Test Loss: 0.0823288
Validation loss decreased (0.077645 --> 0.077569).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0794503
	speed: 0.2062s/iter; left time: 397.2318s
	iters: 200, epoch: 12 | loss: 0.0762411
	speed: 0.1248s/iter; left time: 227.7985s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.22s
Steps: 225 | Train Loss: 0.0791353 Vali Loss: 0.0772091 Test Loss: 0.0826240
Validation loss decreased (0.077569 --> 0.077209).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0795701
	speed: 0.2074s/iter; left time: 352.7250s
	iters: 200, epoch: 13 | loss: 0.0782318
	speed: 0.1243s/iter; left time: 198.9789s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.16s
Steps: 225 | Train Loss: 0.0788803 Vali Loss: 0.0770195 Test Loss: 0.0825596
Validation loss decreased (0.077209 --> 0.077020).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0823900
	speed: 0.2073s/iter; left time: 305.9652s
	iters: 200, epoch: 14 | loss: 0.0794970
	speed: 0.1244s/iter; left time: 171.1606s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.26s
Steps: 225 | Train Loss: 0.0786027 Vali Loss: 0.0769410 Test Loss: 0.0823892
Validation loss decreased (0.077020 --> 0.076941).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0766661
	speed: 0.2087s/iter; left time: 261.0253s
	iters: 200, epoch: 15 | loss: 0.0806809
	speed: 0.1242s/iter; left time: 142.9195s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.13s
Steps: 225 | Train Loss: 0.0783255 Vali Loss: 0.0767500 Test Loss: 0.0819774
Validation loss decreased (0.076941 --> 0.076750).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0756244
	speed: 0.2075s/iter; left time: 212.9265s
	iters: 200, epoch: 16 | loss: 0.0810186
	speed: 0.1237s/iter; left time: 114.5891s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.03s
Steps: 225 | Train Loss: 0.0781282 Vali Loss: 0.0768651 Test Loss: 0.0821056
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0807884
	speed: 0.2031s/iter; left time: 162.7110s
	iters: 200, epoch: 17 | loss: 0.0767048
	speed: 0.1235s/iter; left time: 86.5940s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:27.93s
Steps: 225 | Train Loss: 0.0778863 Vali Loss: 0.0768578 Test Loss: 0.0821329
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0774752
	speed: 0.2075s/iter; left time: 119.5412s
	iters: 200, epoch: 18 | loss: 0.0812058
	speed: 0.1238s/iter; left time: 58.9159s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:28.10s
Steps: 225 | Train Loss: 0.0777132 Vali Loss: 0.0766468 Test Loss: 0.0820385
Validation loss decreased (0.076750 --> 0.076647).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0832625
	speed: 0.2046s/iter; left time: 71.8297s
	iters: 200, epoch: 19 | loss: 0.0773597
	speed: 0.1242s/iter; left time: 31.1691s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.03s
Steps: 225 | Train Loss: 0.0775751 Vali Loss: 0.0764721 Test Loss: 0.0817944
Validation loss decreased (0.076647 --> 0.076472).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0786291
	speed: 0.2056s/iter; left time: 25.9106s
	iters: 200, epoch: 20 | loss: 0.0785749
	speed: 0.1248s/iter; left time: 3.2458s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:28.23s
Steps: 225 | Train Loss: 0.0774495 Vali Loss: 0.0764009 Test Loss: 0.0816955
Validation loss decreased (0.076472 --> 0.076401).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018820010125637054, rmse:0.13718603551387787, mae:0.08169551938772202, rse:0.5187152028083801
Intermediate time for IT and pred_len 96: 00h:22m:26.00s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1274062
	speed: 0.1487s/iter; left time: 654.5295s
	iters: 200, epoch: 1 | loss: 0.1201956
	speed: 0.1255s/iter; left time: 539.6477s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:28.45s
Steps: 225 | Train Loss: 0.1337667 Vali Loss: 0.0992412 Test Loss: 0.1025607
Validation loss decreased (inf --> 0.099241).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0999286
	speed: 0.2093s/iter; left time: 874.2423s
	iters: 200, epoch: 2 | loss: 0.0971880
	speed: 0.1240s/iter; left time: 505.4933s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.16s
Steps: 225 | Train Loss: 0.1026157 Vali Loss: 0.0904709 Test Loss: 0.0948137
Validation loss decreased (0.099241 --> 0.090471).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0945068
	speed: 0.2068s/iter; left time: 817.0345s
	iters: 200, epoch: 3 | loss: 0.0920321
	speed: 0.1240s/iter; left time: 477.4222s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.15s
Steps: 225 | Train Loss: 0.0944772 Vali Loss: 0.0859233 Test Loss: 0.0916047
Validation loss decreased (0.090471 --> 0.085923).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0924504
	speed: 0.2065s/iter; left time: 769.5238s
	iters: 200, epoch: 4 | loss: 0.0887412
	speed: 0.1243s/iter; left time: 450.5452s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.12s
Steps: 225 | Train Loss: 0.0908827 Vali Loss: 0.0868275 Test Loss: 0.0906128
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0887746
	speed: 0.2071s/iter; left time: 724.9291s
	iters: 200, epoch: 5 | loss: 0.0888827
	speed: 0.1252s/iter; left time: 425.7346s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.36s
Steps: 225 | Train Loss: 0.0887758 Vali Loss: 0.0842572 Test Loss: 0.0898299
Validation loss decreased (0.085923 --> 0.084257).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0897459
	speed: 0.2071s/iter; left time: 678.5198s
	iters: 200, epoch: 6 | loss: 0.0841771
	speed: 0.1247s/iter; left time: 396.0306s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.21s
Steps: 225 | Train Loss: 0.0874938 Vali Loss: 0.0833510 Test Loss: 0.0876509
Validation loss decreased (0.084257 --> 0.083351).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0841005
	speed: 0.2065s/iter; left time: 629.8886s
	iters: 200, epoch: 7 | loss: 0.0883561
	speed: 0.1246s/iter; left time: 367.6888s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.24s
Steps: 225 | Train Loss: 0.0864298 Vali Loss: 0.0829024 Test Loss: 0.0872512
Validation loss decreased (0.083351 --> 0.082902).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0864878
	speed: 0.2065s/iter; left time: 583.5700s
	iters: 200, epoch: 8 | loss: 0.0836292
	speed: 0.1244s/iter; left time: 339.0295s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.20s
Steps: 225 | Train Loss: 0.0858088 Vali Loss: 0.0824455 Test Loss: 0.0869225
Validation loss decreased (0.082902 --> 0.082446).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0883054
	speed: 0.2067s/iter; left time: 537.6703s
	iters: 200, epoch: 9 | loss: 0.0835050
	speed: 0.1243s/iter; left time: 310.7687s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.16s
Steps: 225 | Train Loss: 0.0852685 Vali Loss: 0.0827654 Test Loss: 0.0869103
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0833669
	speed: 0.2058s/iter; left time: 489.0270s
	iters: 200, epoch: 10 | loss: 0.0865522
	speed: 0.1248s/iter; left time: 283.9595s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.28s
Steps: 225 | Train Loss: 0.0848592 Vali Loss: 0.0819396 Test Loss: 0.0861626
Validation loss decreased (0.082446 --> 0.081940).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0845838
	speed: 0.2060s/iter; left time: 443.1676s
	iters: 200, epoch: 11 | loss: 0.0861566
	speed: 0.1244s/iter; left time: 255.2260s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.11s
Steps: 225 | Train Loss: 0.0845001 Vali Loss: 0.0820744 Test Loss: 0.0859507
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0851333
	speed: 0.2081s/iter; left time: 400.7558s
	iters: 200, epoch: 12 | loss: 0.0838776
	speed: 0.1247s/iter; left time: 227.7526s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.36s
Steps: 225 | Train Loss: 0.0842150 Vali Loss: 0.0822200 Test Loss: 0.0856628
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0833532
	speed: 0.2085s/iter; left time: 354.6808s
	iters: 200, epoch: 13 | loss: 0.0793798
	speed: 0.1250s/iter; left time: 200.0957s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.38s
Steps: 225 | Train Loss: 0.0838517 Vali Loss: 0.0816093 Test Loss: 0.0854676
Validation loss decreased (0.081940 --> 0.081609).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0838834
	speed: 0.2074s/iter; left time: 306.1636s
	iters: 200, epoch: 14 | loss: 0.0833073
	speed: 0.1246s/iter; left time: 171.4563s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.24s
Steps: 225 | Train Loss: 0.0836320 Vali Loss: 0.0817205 Test Loss: 0.0854512
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0802528
	speed: 0.2063s/iter; left time: 258.0424s
	iters: 200, epoch: 15 | loss: 0.0804740
	speed: 0.1245s/iter; left time: 143.2631s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.28s
Steps: 225 | Train Loss: 0.0834320 Vali Loss: 0.0816327 Test Loss: 0.0855313
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0829816
	speed: 0.2053s/iter; left time: 210.6108s
	iters: 200, epoch: 16 | loss: 0.0838366
	speed: 0.1250s/iter; left time: 115.7589s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.30s
Steps: 225 | Train Loss: 0.0831726 Vali Loss: 0.0816667 Test Loss: 0.0854638
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0814890
	speed: 0.2073s/iter; left time: 166.0414s
	iters: 200, epoch: 17 | loss: 0.0822350
	speed: 0.1256s/iter; left time: 88.0553s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.39s
Steps: 225 | Train Loss: 0.0829919 Vali Loss: 0.0820202 Test Loss: 0.0856585
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0839811
	speed: 0.2077s/iter; left time: 119.6551s
	iters: 200, epoch: 18 | loss: 0.0843205
	speed: 0.1256s/iter; left time: 59.7820s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:28.44s
Steps: 225 | Train Loss: 0.0828663 Vali Loss: 0.0817814 Test Loss: 0.0856330
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0196785070002079, rmse:0.1402800977230072, mae:0.08546759188175201, rse:0.5309070944786072
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1252874
	speed: 0.1258s/iter; left time: 553.5807s
	iters: 200, epoch: 1 | loss: 0.1240589
	speed: 0.1251s/iter; left time: 537.8463s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:28.28s
Steps: 225 | Train Loss: 0.1343383 Vali Loss: 0.0994309 Test Loss: 0.1027002
Validation loss decreased (inf --> 0.099431).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1012369
	speed: 0.2111s/iter; left time: 881.4227s
	iters: 200, epoch: 2 | loss: 0.0978683
	speed: 0.1247s/iter; left time: 508.3698s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.34s
Steps: 225 | Train Loss: 0.1025567 Vali Loss: 0.0899358 Test Loss: 0.0946148
Validation loss decreased (0.099431 --> 0.089936).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0953144
	speed: 0.2091s/iter; left time: 825.9906s
	iters: 200, epoch: 3 | loss: 0.0942210
	speed: 0.1250s/iter; left time: 481.4110s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.28s
Steps: 225 | Train Loss: 0.0939962 Vali Loss: 0.0862187 Test Loss: 0.0924182
Validation loss decreased (0.089936 --> 0.086219).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0886576
	speed: 0.2070s/iter; left time: 771.3484s
	iters: 200, epoch: 4 | loss: 0.0866066
	speed: 0.1250s/iter; left time: 453.1968s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.30s
Steps: 225 | Train Loss: 0.0907466 Vali Loss: 0.0852378 Test Loss: 0.0902182
Validation loss decreased (0.086219 --> 0.085238).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0886593
	speed: 0.2072s/iter; left time: 725.5006s
	iters: 200, epoch: 5 | loss: 0.0915526
	speed: 0.1247s/iter; left time: 424.1730s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.28s
Steps: 225 | Train Loss: 0.0887809 Vali Loss: 0.0845530 Test Loss: 0.0897828
Validation loss decreased (0.085238 --> 0.084553).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0855750
	speed: 0.2105s/iter; left time: 689.7385s
	iters: 200, epoch: 6 | loss: 0.0881630
	speed: 0.1254s/iter; left time: 398.3924s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.45s
Steps: 225 | Train Loss: 0.0876069 Vali Loss: 0.0839415 Test Loss: 0.0886852
Validation loss decreased (0.084553 --> 0.083941).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0855649
	speed: 0.2094s/iter; left time: 638.9149s
	iters: 200, epoch: 7 | loss: 0.0861583
	speed: 0.1251s/iter; left time: 369.2505s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.36s
Steps: 225 | Train Loss: 0.0867376 Vali Loss: 0.0830761 Test Loss: 0.0885835
Validation loss decreased (0.083941 --> 0.083076).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0900731
	speed: 0.2115s/iter; left time: 597.7728s
	iters: 200, epoch: 8 | loss: 0.0837901
	speed: 0.1249s/iter; left time: 340.4302s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.38s
Steps: 225 | Train Loss: 0.0862249 Vali Loss: 0.0828923 Test Loss: 0.0886307
Validation loss decreased (0.083076 --> 0.082892).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0850363
	speed: 0.2107s/iter; left time: 548.1492s
	iters: 200, epoch: 9 | loss: 0.0847476
	speed: 0.1255s/iter; left time: 313.9175s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.44s
Steps: 225 | Train Loss: 0.0856819 Vali Loss: 0.0822114 Test Loss: 0.0875634
Validation loss decreased (0.082892 --> 0.082211).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0865811
	speed: 0.2078s/iter; left time: 493.7087s
	iters: 200, epoch: 10 | loss: 0.0885911
	speed: 0.1250s/iter; left time: 284.5643s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.26s
Steps: 225 | Train Loss: 0.0852687 Vali Loss: 0.0822291 Test Loss: 0.0871013
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0820281
	speed: 0.2088s/iter; left time: 449.0294s
	iters: 200, epoch: 11 | loss: 0.0828203
	speed: 0.1248s/iter; left time: 255.9540s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.36s
Steps: 225 | Train Loss: 0.0847809 Vali Loss: 0.0817572 Test Loss: 0.0870292
Validation loss decreased (0.082211 --> 0.081757).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0821820
	speed: 0.2064s/iter; left time: 397.4723s
	iters: 200, epoch: 12 | loss: 0.0837839
	speed: 0.1249s/iter; left time: 228.0093s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.28s
Steps: 225 | Train Loss: 0.0845500 Vali Loss: 0.0819127 Test Loss: 0.0866175
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0802262
	speed: 0.2076s/iter; left time: 353.1202s
	iters: 200, epoch: 13 | loss: 0.0826065
	speed: 0.1251s/iter; left time: 200.2906s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.40s
Steps: 225 | Train Loss: 0.0842274 Vali Loss: 0.0817468 Test Loss: 0.0864959
Validation loss decreased (0.081757 --> 0.081747).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0841475
	speed: 0.2083s/iter; left time: 307.4843s
	iters: 200, epoch: 14 | loss: 0.0823566
	speed: 0.1249s/iter; left time: 171.9246s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.26s
Steps: 225 | Train Loss: 0.0840051 Vali Loss: 0.0814703 Test Loss: 0.0864162
Validation loss decreased (0.081747 --> 0.081470).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0832792
	speed: 0.2078s/iter; left time: 259.9452s
	iters: 200, epoch: 15 | loss: 0.0832064
	speed: 0.1246s/iter; left time: 143.4210s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.29s
Steps: 225 | Train Loss: 0.0837586 Vali Loss: 0.0815400 Test Loss: 0.0859518
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0816924
	speed: 0.2051s/iter; left time: 210.4502s
	iters: 200, epoch: 16 | loss: 0.0879495
	speed: 0.1248s/iter; left time: 115.6038s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.19s
Steps: 225 | Train Loss: 0.0834792 Vali Loss: 0.0814463 Test Loss: 0.0862716
Validation loss decreased (0.081470 --> 0.081446).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0814074
	speed: 0.2072s/iter; left time: 165.9816s
	iters: 200, epoch: 17 | loss: 0.0830946
	speed: 0.1248s/iter; left time: 87.4988s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.27s
Steps: 225 | Train Loss: 0.0833982 Vali Loss: 0.0813847 Test Loss: 0.0859058
Validation loss decreased (0.081446 --> 0.081385).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0828545
	speed: 0.2064s/iter; left time: 118.8758s
	iters: 200, epoch: 18 | loss: 0.0824811
	speed: 0.1247s/iter; left time: 59.3641s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:28.23s
Steps: 225 | Train Loss: 0.0832192 Vali Loss: 0.0813554 Test Loss: 0.0859548
Validation loss decreased (0.081385 --> 0.081355).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0864082
	speed: 0.2073s/iter; left time: 72.7458s
	iters: 200, epoch: 19 | loss: 0.0809942
	speed: 0.1252s/iter; left time: 31.4293s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.34s
Steps: 225 | Train Loss: 0.0830247 Vali Loss: 0.0809955 Test Loss: 0.0858491
Validation loss decreased (0.081355 --> 0.080996).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0841437
	speed: 0.2081s/iter; left time: 26.2232s
	iters: 200, epoch: 20 | loss: 0.0797103
	speed: 0.1254s/iter; left time: 3.2606s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:28.42s
Steps: 225 | Train Loss: 0.0828929 Vali Loss: 0.0811498 Test Loss: 0.0856923
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020069275051355362, rmse:0.14166606962680817, mae:0.08584906160831451, rse:0.5361524224281311
Intermediate time for IT and pred_len 168: 00h:21m:19.68s
Intermediate time for IT: 01h:06m:01.95s
Total time: 02h:17m:45.04s
