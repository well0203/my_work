
=== Starting experiments for country: DE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0260697
	speed: 0.6588s/iter; left time: 2886.1990s
	iters: 200, epoch: 1 | loss: 0.0226197
	speed: 0.6370s/iter; left time: 2726.8262s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:02m:22.87s
Steps: 224 | Train Loss: 0.0264336 Vali Loss: 0.0252878 Test Loss: 0.0268633
Validation loss decreased (inf --> 0.025288).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0169845
	speed: 1.0193s/iter; left time: 4237.0523s
	iters: 200, epoch: 2 | loss: 0.0164148
	speed: 0.6412s/iter; left time: 2601.3497s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:02m:23.44s
Steps: 224 | Train Loss: 0.0174810 Vali Loss: 0.0230596 Test Loss: 0.0241275
Validation loss decreased (0.025288 --> 0.023060).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0151019
	speed: 1.0193s/iter; left time: 4009.0890s
	iters: 200, epoch: 3 | loss: 0.0159202
	speed: 0.6415s/iter; left time: 2459.0574s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:02m:23.49s
Steps: 224 | Train Loss: 0.0157841 Vali Loss: 0.0217520 Test Loss: 0.0237190
Validation loss decreased (0.023060 --> 0.021752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0143405
	speed: 1.0187s/iter; left time: 3778.3897s
	iters: 200, epoch: 4 | loss: 0.0146519
	speed: 0.6403s/iter; left time: 2311.0133s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:02m:23.35s
Steps: 224 | Train Loss: 0.0149145 Vali Loss: 0.0211180 Test Loss: 0.0227146
Validation loss decreased (0.021752 --> 0.021118).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0138595
	speed: 1.0210s/iter; left time: 3558.1533s
	iters: 200, epoch: 5 | loss: 0.0137615
	speed: 0.6416s/iter; left time: 2171.9392s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:02m:23.50s
Steps: 224 | Train Loss: 0.0143542 Vali Loss: 0.0204248 Test Loss: 0.0224354
Validation loss decreased (0.021118 --> 0.020425).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0139675
	speed: 1.0177s/iter; left time: 3318.6345s
	iters: 200, epoch: 6 | loss: 0.0130971
	speed: 0.6411s/iter; left time: 2026.5771s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:02m:23.52s
Steps: 224 | Train Loss: 0.0141514 Vali Loss: 0.0209303 Test Loss: 0.0226694
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0136732
	speed: 1.0213s/iter; left time: 3101.5674s
	iters: 200, epoch: 7 | loss: 0.0139990
	speed: 0.6420s/iter; left time: 1885.6039s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:02m:23.61s
Steps: 224 | Train Loss: 0.0137967 Vali Loss: 0.0202653 Test Loss: 0.0221296
Validation loss decreased (0.020425 --> 0.020265).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0119280
	speed: 1.0194s/iter; left time: 2867.6396s
	iters: 200, epoch: 8 | loss: 0.0139392
	speed: 0.6416s/iter; left time: 1740.6284s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:02m:23.56s
Steps: 224 | Train Loss: 0.0135108 Vali Loss: 0.0204270 Test Loss: 0.0220210
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0132262
	speed: 1.0188s/iter; left time: 2637.7649s
	iters: 200, epoch: 9 | loss: 0.0119706
	speed: 0.6409s/iter; left time: 1595.1928s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:02m:23.66s
Steps: 224 | Train Loss: 0.0134475 Vali Loss: 0.0198315 Test Loss: 0.0221825
Validation loss decreased (0.020265 --> 0.019832).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0126166
	speed: 1.0196s/iter; left time: 2411.3822s
	iters: 200, epoch: 10 | loss: 0.0121419
	speed: 0.6417s/iter; left time: 1453.4828s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:02m:23.47s
Steps: 224 | Train Loss: 0.0131525 Vali Loss: 0.0197556 Test Loss: 0.0219017
Validation loss decreased (0.019832 --> 0.019756).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0105351
	speed: 1.0181s/iter; left time: 2179.8383s
	iters: 200, epoch: 11 | loss: 0.0138581
	speed: 0.6413s/iter; left time: 1308.9589s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:02m:23.55s
Steps: 224 | Train Loss: 0.0130410 Vali Loss: 0.0201910 Test Loss: 0.0224620
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0142836
	speed: 1.0174s/iter; left time: 1950.4219s
	iters: 200, epoch: 12 | loss: 0.0137541
	speed: 0.6403s/iter; left time: 1163.3357s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:02m:23.30s
Steps: 224 | Train Loss: 0.0129711 Vali Loss: 0.0199388 Test Loss: 0.0222619
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0135022
	speed: 1.0184s/iter; left time: 1724.2212s
	iters: 200, epoch: 13 | loss: 0.0121987
	speed: 0.6409s/iter; left time: 1020.8900s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:02m:23.39s
Steps: 224 | Train Loss: 0.0128181 Vali Loss: 0.0200258 Test Loss: 0.0221268
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0135145
	speed: 1.0158s/iter; left time: 1492.2002s
	iters: 200, epoch: 14 | loss: 0.0123531
	speed: 0.6404s/iter; left time: 876.7295s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:02m:23.33s
Steps: 224 | Train Loss: 0.0127739 Vali Loss: 0.0203425 Test Loss: 0.0229596
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0126478
	speed: 1.0167s/iter; left time: 1265.7383s
	iters: 200, epoch: 15 | loss: 0.0129051
	speed: 0.6406s/iter; left time: 733.5056s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:02m:23.32s
Steps: 224 | Train Loss: 0.0126882 Vali Loss: 0.0199901 Test Loss: 0.0218327
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021901745349168777, rmse:0.14799238741397858, mae:0.09500051289796829, rse:0.5222856402397156
Intermediate time for DE and pred_len 24: 00h:41m:49.32s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0302059
	speed: 0.7298s/iter; left time: 6422.8837s
	iters: 200, epoch: 1 | loss: 0.0298152
	speed: 0.7214s/iter; left time: 6276.6156s
	iters: 300, epoch: 1 | loss: 0.0319153
	speed: 0.7223s/iter; left time: 6212.4672s
	iters: 400, epoch: 1 | loss: 0.0246839
	speed: 0.7227s/iter; left time: 6143.3740s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.48s
Steps: 445 | Train Loss: 0.0307763 Vali Loss: 0.0329600 Test Loss: 0.0369852
Validation loss decreased (inf --> 0.032960).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0275542
	speed: 1.5378s/iter; left time: 12850.2656s
	iters: 200, epoch: 2 | loss: 0.0238474
	speed: 0.7231s/iter; left time: 5970.1049s
	iters: 300, epoch: 2 | loss: 0.0248203
	speed: 0.7225s/iter; left time: 5892.5758s
	iters: 400, epoch: 2 | loss: 0.0270211
	speed: 0.7236s/iter; left time: 5829.1719s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.51s
Steps: 445 | Train Loss: 0.0260601 Vali Loss: 0.0319481 Test Loss: 0.0365307
Validation loss decreased (0.032960 --> 0.031948).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0193737
	speed: 1.5504s/iter; left time: 12264.9685s
	iters: 200, epoch: 3 | loss: 0.0231539
	speed: 0.7247s/iter; left time: 5660.8554s
	iters: 300, epoch: 3 | loss: 0.0245521
	speed: 0.7232s/iter; left time: 5576.6042s
	iters: 400, epoch: 3 | loss: 0.0235652
	speed: 0.7251s/iter; left time: 5518.3615s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:22.20s
Steps: 445 | Train Loss: 0.0234424 Vali Loss: 0.0306345 Test Loss: 0.0354226
Validation loss decreased (0.031948 --> 0.030634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0204264
	speed: 1.5467s/iter; left time: 11547.7607s
	iters: 200, epoch: 4 | loss: 0.0231104
	speed: 0.7237s/iter; left time: 5330.9265s
	iters: 300, epoch: 4 | loss: 0.0226001
	speed: 0.7244s/iter; left time: 5263.2164s
	iters: 400, epoch: 4 | loss: 0.0200202
	speed: 0.7235s/iter; left time: 5184.7825s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.81s
Steps: 445 | Train Loss: 0.0227452 Vali Loss: 0.0307144 Test Loss: 0.0355179
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0212215
	speed: 1.5373s/iter; left time: 10793.6920s
	iters: 200, epoch: 5 | loss: 0.0210776
	speed: 0.7230s/iter; left time: 5003.5454s
	iters: 300, epoch: 5 | loss: 0.0211146
	speed: 0.7248s/iter; left time: 4944.0634s
	iters: 400, epoch: 5 | loss: 0.0224722
	speed: 0.7253s/iter; left time: 4874.7811s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:22.19s
Steps: 445 | Train Loss: 0.0221151 Vali Loss: 0.0308423 Test Loss: 0.0353491
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0235711
	speed: 1.5481s/iter; left time: 10180.3677s
	iters: 200, epoch: 6 | loss: 0.0218183
	speed: 0.7271s/iter; left time: 4708.8982s
	iters: 300, epoch: 6 | loss: 0.0227409
	speed: 0.7239s/iter; left time: 4615.6164s
	iters: 400, epoch: 6 | loss: 0.0197609
	speed: 0.7252s/iter; left time: 4551.3310s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:22.56s
Steps: 445 | Train Loss: 0.0216648 Vali Loss: 0.0307544 Test Loss: 0.0352945
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0218547
	speed: 1.5446s/iter; left time: 9469.8890s
	iters: 200, epoch: 7 | loss: 0.0216096
	speed: 0.7217s/iter; left time: 4352.7518s
	iters: 300, epoch: 7 | loss: 0.0213850
	speed: 0.7209s/iter; left time: 4275.5458s
	iters: 400, epoch: 7 | loss: 0.0228879
	speed: 0.7209s/iter; left time: 4203.2765s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:21.22s
Steps: 445 | Train Loss: 0.0211638 Vali Loss: 0.0311796 Test Loss: 0.0351215
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0246490
	speed: 1.5320s/iter; left time: 8710.8820s
	iters: 200, epoch: 8 | loss: 0.0213583
	speed: 0.7204s/iter; left time: 4024.3399s
	iters: 300, epoch: 8 | loss: 0.0169613
	speed: 0.7210s/iter; left time: 3955.3070s
	iters: 400, epoch: 8 | loss: 0.0203024
	speed: 0.7208s/iter; left time: 3881.9840s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:20.49s
Steps: 445 | Train Loss: 0.0207130 Vali Loss: 0.0311741 Test Loss: 0.0354104
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03542259708046913, rmse:0.1882089227437973, mae:0.13172055780887604, rse:0.6664858460426331
Intermediate time for DE and pred_len 96: 00h:49m:59.51s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0324691
	speed: 0.7440s/iter; left time: 6532.7714s
	iters: 200, epoch: 1 | loss: 0.0306387
	speed: 0.7225s/iter; left time: 6272.2330s
	iters: 300, epoch: 1 | loss: 0.0280163
	speed: 0.7225s/iter; left time: 6199.3975s
	iters: 400, epoch: 1 | loss: 0.0342149
	speed: 0.7221s/iter; left time: 6123.8226s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:20.89s
Steps: 444 | Train Loss: 0.0324338 Vali Loss: 0.0342096 Test Loss: 0.0389256
Validation loss decreased (inf --> 0.034210).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0269492
	speed: 1.5276s/iter; left time: 12735.4590s
	iters: 200, epoch: 2 | loss: 0.0258793
	speed: 0.7218s/iter; left time: 5945.6438s
	iters: 300, epoch: 2 | loss: 0.0273381
	speed: 0.7222s/iter; left time: 5876.4437s
	iters: 400, epoch: 2 | loss: 0.0242763
	speed: 0.7233s/iter; left time: 5813.1601s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:20.72s
Steps: 444 | Train Loss: 0.0278843 Vali Loss: 0.0326882 Test Loss: 0.0386646
Validation loss decreased (0.034210 --> 0.032688).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0259864
	speed: 1.5337s/iter; left time: 12105.3527s
	iters: 200, epoch: 3 | loss: 0.0251305
	speed: 0.7225s/iter; left time: 5630.0814s
	iters: 300, epoch: 3 | loss: 0.0246578
	speed: 0.7221s/iter; left time: 5554.8505s
	iters: 400, epoch: 3 | loss: 0.0257822
	speed: 0.7228s/iter; left time: 5488.2795s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:20.53s
Steps: 444 | Train Loss: 0.0253866 Vali Loss: 0.0320830 Test Loss: 0.0384211
Validation loss decreased (0.032688 --> 0.032083).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0251047
	speed: 1.5417s/iter; left time: 11484.2302s
	iters: 200, epoch: 4 | loss: 0.0242919
	speed: 0.7223s/iter; left time: 5308.2162s
	iters: 300, epoch: 4 | loss: 0.0242367
	speed: 0.7222s/iter; left time: 5235.0003s
	iters: 400, epoch: 4 | loss: 0.0245224
	speed: 0.7220s/iter; left time: 5161.6806s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:20.46s
Steps: 444 | Train Loss: 0.0246121 Vali Loss: 0.0318599 Test Loss: 0.0375914
Validation loss decreased (0.032083 --> 0.031860).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0264515
	speed: 1.5376s/iter; left time: 10771.1388s
	iters: 200, epoch: 5 | loss: 0.0233539
	speed: 0.7229s/iter; left time: 4991.9156s
	iters: 300, epoch: 5 | loss: 0.0253562
	speed: 0.7224s/iter; left time: 4916.0267s
	iters: 400, epoch: 5 | loss: 0.0226150
	speed: 0.7221s/iter; left time: 4841.9755s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:20.59s
Steps: 444 | Train Loss: 0.0239584 Vali Loss: 0.0322509 Test Loss: 0.0383392
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0239505
	speed: 1.5238s/iter; left time: 9997.5308s
	iters: 200, epoch: 6 | loss: 0.0250145
	speed: 0.7239s/iter; left time: 4677.0523s
	iters: 300, epoch: 6 | loss: 0.0223557
	speed: 0.7237s/iter; left time: 4603.2522s
	iters: 400, epoch: 6 | loss: 0.0271521
	speed: 0.7234s/iter; left time: 4528.9557s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.02s
Steps: 444 | Train Loss: 0.0235787 Vali Loss: 0.0321315 Test Loss: 0.0383225
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0222819
	speed: 1.5223s/iter; left time: 9312.1745s
	iters: 200, epoch: 7 | loss: 0.0233028
	speed: 0.7230s/iter; left time: 4350.1178s
	iters: 300, epoch: 7 | loss: 0.0265391
	speed: 0.7236s/iter; left time: 4281.2955s
	iters: 400, epoch: 7 | loss: 0.0239813
	speed: 0.7231s/iter; left time: 4206.2023s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:20.94s
Steps: 444 | Train Loss: 0.0230404 Vali Loss: 0.0324665 Test Loss: 0.0378922
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0231855
	speed: 1.5267s/iter; left time: 8660.7795s
	iters: 200, epoch: 8 | loss: 0.0225013
	speed: 0.7242s/iter; left time: 4035.8492s
	iters: 300, epoch: 8 | loss: 0.0232989
	speed: 0.7234s/iter; left time: 3959.4316s
	iters: 400, epoch: 8 | loss: 0.0216201
	speed: 0.7240s/iter; left time: 3890.0196s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.34s
Steps: 444 | Train Loss: 0.0225703 Vali Loss: 0.0328092 Test Loss: 0.0384778
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0221798
	speed: 1.5256s/iter; left time: 7977.2167s
	iters: 200, epoch: 9 | loss: 0.0239219
	speed: 0.7234s/iter; left time: 3710.1478s
	iters: 300, epoch: 9 | loss: 0.0235307
	speed: 0.7237s/iter; left time: 3639.7235s
	iters: 400, epoch: 9 | loss: 0.0219622
	speed: 0.7234s/iter; left time: 3565.5671s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:21.03s
Steps: 444 | Train Loss: 0.0222273 Vali Loss: 0.0331927 Test Loss: 0.0387550
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.037591367959976196, rmse:0.193884938955307, mae:0.13648755848407745, rse:0.6867560148239136
Intermediate time for DE and pred_len 168: 00h:56m:02.33s
Intermediate time for DE: 02h:27m:51.16s

=== Starting experiments for country: GB ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0289166
	speed: 0.7436s/iter; left time: 6559.7012s
	iters: 200, epoch: 1 | loss: 0.0202293
	speed: 0.7209s/iter; left time: 6286.9572s
	iters: 300, epoch: 1 | loss: 0.0206892
	speed: 0.7211s/iter; left time: 6216.8743s
	iters: 400, epoch: 1 | loss: 0.0226693
	speed: 0.7200s/iter; left time: 6135.2609s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.38s
Steps: 446 | Train Loss: 0.0212843 Vali Loss: 0.0216887 Test Loss: 0.0277117
Validation loss decreased (inf --> 0.021689).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0158360
	speed: 1.5439s/iter; left time: 12929.8499s
	iters: 200, epoch: 2 | loss: 0.0135614
	speed: 0.7208s/iter; left time: 5964.3511s
	iters: 300, epoch: 2 | loss: 0.0150534
	speed: 0.7208s/iter; left time: 5892.8308s
	iters: 400, epoch: 2 | loss: 0.0144419
	speed: 0.7207s/iter; left time: 5819.4490s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.23s
Steps: 446 | Train Loss: 0.0164231 Vali Loss: 0.0205662 Test Loss: 0.0265328
Validation loss decreased (0.021689 --> 0.020566).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0148300
	speed: 1.6666s/iter; left time: 13214.3622s
	iters: 200, epoch: 3 | loss: 0.0151173
	speed: 0.7212s/iter; left time: 5645.9661s
	iters: 300, epoch: 3 | loss: 0.0132256
	speed: 0.7204s/iter; left time: 5567.7178s
	iters: 400, epoch: 3 | loss: 0.0163189
	speed: 0.7207s/iter; left time: 5498.3149s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:33.37s
Steps: 446 | Train Loss: 0.0142952 Vali Loss: 0.0201830 Test Loss: 0.0264994
Validation loss decreased (0.020566 --> 0.020183).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0111746
	speed: 1.5462s/iter; left time: 11570.4260s
	iters: 200, epoch: 4 | loss: 0.0134375
	speed: 0.7212s/iter; left time: 5324.3309s
	iters: 300, epoch: 4 | loss: 0.0131227
	speed: 0.7204s/iter; left time: 5246.3204s
	iters: 400, epoch: 4 | loss: 0.0098728
	speed: 0.7203s/iter; left time: 5174.0813s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.15s
Steps: 446 | Train Loss: 0.0139439 Vali Loss: 0.0203256 Test Loss: 0.0254370
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0136044
	speed: 1.5432s/iter; left time: 10859.2062s
	iters: 200, epoch: 5 | loss: 0.0145468
	speed: 0.7220s/iter; left time: 5008.5411s
	iters: 300, epoch: 5 | loss: 0.0146856
	speed: 0.7202s/iter; left time: 4924.0024s
	iters: 400, epoch: 5 | loss: 0.0142690
	speed: 0.7362s/iter; left time: 4959.4601s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:22.84s
Steps: 446 | Train Loss: 0.0137362 Vali Loss: 0.0201708 Test Loss: 0.0258583
Validation loss decreased (0.020183 --> 0.020171).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0127196
	speed: 1.5433s/iter; left time: 10172.1509s
	iters: 200, epoch: 6 | loss: 0.0135240
	speed: 0.7203s/iter; left time: 4675.6953s
	iters: 300, epoch: 6 | loss: 0.0136991
	speed: 0.7202s/iter; left time: 4602.7816s
	iters: 400, epoch: 6 | loss: 0.0113744
	speed: 0.7204s/iter; left time: 4531.8315s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.05s
Steps: 446 | Train Loss: 0.0135565 Vali Loss: 0.0196171 Test Loss: 0.0257270
Validation loss decreased (0.020171 --> 0.019617).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0126710
	speed: 1.5451s/iter; left time: 9494.6011s
	iters: 200, epoch: 7 | loss: 0.0130240
	speed: 0.7200s/iter; left time: 4352.1379s
	iters: 300, epoch: 7 | loss: 0.0109849
	speed: 0.7204s/iter; left time: 4282.6498s
	iters: 400, epoch: 7 | loss: 0.0159441
	speed: 0.7204s/iter; left time: 4210.5659s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:20.99s
Steps: 446 | Train Loss: 0.0133061 Vali Loss: 0.0198284 Test Loss: 0.0254155
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0134848
	speed: 1.5634s/iter; left time: 8909.8779s
	iters: 200, epoch: 8 | loss: 0.0118706
	speed: 0.7215s/iter; left time: 4039.5559s
	iters: 300, epoch: 8 | loss: 0.0141404
	speed: 0.7213s/iter; left time: 3966.3329s
	iters: 400, epoch: 8 | loss: 0.0131802
	speed: 0.7227s/iter; left time: 3901.6261s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:23.46s
Steps: 446 | Train Loss: 0.0132346 Vali Loss: 0.0200575 Test Loss: 0.0259631
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0118793
	speed: 1.5455s/iter; left time: 8118.7179s
	iters: 200, epoch: 9 | loss: 0.0153380
	speed: 0.7216s/iter; left time: 3718.1533s
	iters: 300, epoch: 9 | loss: 0.0114176
	speed: 0.7240s/iter; left time: 3658.3251s
	iters: 400, epoch: 9 | loss: 0.0105651
	speed: 0.7404s/iter; left time: 3667.2201s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:23.77s
Steps: 446 | Train Loss: 0.0131461 Vali Loss: 0.0199061 Test Loss: 0.0258524
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0160117
	speed: 1.5474s/iter; left time: 7438.5272s
	iters: 200, epoch: 10 | loss: 0.0124742
	speed: 0.7240s/iter; left time: 3407.8560s
	iters: 300, epoch: 10 | loss: 0.0121242
	speed: 0.7218s/iter; left time: 3325.4090s
	iters: 400, epoch: 10 | loss: 0.0108839
	speed: 0.7218s/iter; left time: 3253.2345s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:05m:21.90s
Steps: 446 | Train Loss: 0.0129824 Vali Loss: 0.0199416 Test Loss: 0.0261237
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0101929
	speed: 1.5477s/iter; left time: 6749.5673s
	iters: 200, epoch: 11 | loss: 0.0126501
	speed: 0.7222s/iter; left time: 3077.1050s
	iters: 300, epoch: 11 | loss: 0.0161592
	speed: 0.7216s/iter; left time: 3002.5468s
	iters: 400, epoch: 11 | loss: 0.0145134
	speed: 0.7215s/iter; left time: 2929.8459s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:05m:21.67s
Steps: 446 | Train Loss: 0.0128602 Vali Loss: 0.0197561 Test Loss: 0.0259045
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02572702430188656, rmse:0.16039645671844482, mae:0.1057143285870552, rse:0.5530432462692261
Intermediate time for GB and pred_len 24: 01h:08m:52.29s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0258529
	speed: 0.7502s/iter; left time: 6602.5246s
	iters: 200, epoch: 1 | loss: 0.0296054
	speed: 0.7227s/iter; left time: 6288.5118s
	iters: 300, epoch: 1 | loss: 0.0254370
	speed: 0.7248s/iter; left time: 6234.0843s
	iters: 400, epoch: 1 | loss: 0.0238283
	speed: 0.7244s/iter; left time: 6158.1998s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:22.24s
Steps: 445 | Train Loss: 0.0269416 Vali Loss: 0.0298205 Test Loss: 0.0422618
Validation loss decreased (inf --> 0.029821).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0215586
	speed: 1.5449s/iter; left time: 12908.9473s
	iters: 200, epoch: 2 | loss: 0.0228470
	speed: 0.7232s/iter; left time: 5971.0812s
	iters: 300, epoch: 2 | loss: 0.0210400
	speed: 0.7229s/iter; left time: 5896.3574s
	iters: 400, epoch: 2 | loss: 0.0219924
	speed: 0.7239s/iter; left time: 5831.6937s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.62s
Steps: 445 | Train Loss: 0.0233876 Vali Loss: 0.0290359 Test Loss: 0.0406784
Validation loss decreased (0.029821 --> 0.029036).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0199911
	speed: 1.5437s/iter; left time: 12212.1002s
	iters: 200, epoch: 3 | loss: 0.0198404
	speed: 0.7229s/iter; left time: 5646.7477s
	iters: 300, epoch: 3 | loss: 0.0207614
	speed: 0.7229s/iter; left time: 5574.2629s
	iters: 400, epoch: 3 | loss: 0.0233237
	speed: 0.7242s/iter; left time: 5511.6014s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:21.71s
Steps: 445 | Train Loss: 0.0216473 Vali Loss: 0.0290370 Test Loss: 0.0400350
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0204558
	speed: 1.5390s/iter; left time: 11490.4566s
	iters: 200, epoch: 4 | loss: 0.0195280
	speed: 0.7244s/iter; left time: 5335.8198s
	iters: 300, epoch: 4 | loss: 0.0223034
	speed: 0.7239s/iter; left time: 5259.7417s
	iters: 400, epoch: 4 | loss: 0.0215147
	speed: 0.7265s/iter; left time: 5205.9723s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:22.14s
Steps: 445 | Train Loss: 0.0212032 Vali Loss: 0.0285863 Test Loss: 0.0402990
Validation loss decreased (0.029036 --> 0.028586).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0201620
	speed: 1.5445s/iter; left time: 10844.0707s
	iters: 200, epoch: 5 | loss: 0.0204964
	speed: 0.7254s/iter; left time: 5020.8222s
	iters: 300, epoch: 5 | loss: 0.0218803
	speed: 0.7253s/iter; left time: 4946.9658s
	iters: 400, epoch: 5 | loss: 0.0219664
	speed: 0.7261s/iter; left time: 4880.2238s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:22.69s
Steps: 445 | Train Loss: 0.0207783 Vali Loss: 0.0292571 Test Loss: 0.0418711
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0179712
	speed: 1.5431s/iter; left time: 10147.2277s
	iters: 200, epoch: 6 | loss: 0.0215801
	speed: 0.7254s/iter; left time: 4698.0081s
	iters: 300, epoch: 6 | loss: 0.0200419
	speed: 0.7261s/iter; left time: 4629.5624s
	iters: 400, epoch: 6 | loss: 0.0165364
	speed: 0.7260s/iter; left time: 4556.2920s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:22.78s
Steps: 445 | Train Loss: 0.0203742 Vali Loss: 0.0292893 Test Loss: 0.0417165
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0195728
	speed: 1.5451s/iter; left time: 9472.9812s
	iters: 200, epoch: 7 | loss: 0.0203875
	speed: 0.7257s/iter; left time: 4376.7265s
	iters: 300, epoch: 7 | loss: 0.0214673
	speed: 0.7257s/iter; left time: 4304.3257s
	iters: 400, epoch: 7 | loss: 0.0215163
	speed: 0.7255s/iter; left time: 4230.4574s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:22.54s
Steps: 445 | Train Loss: 0.0200647 Vali Loss: 0.0294887 Test Loss: 0.0427642
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0213490
	speed: 1.5342s/iter; left time: 8723.2094s
	iters: 200, epoch: 8 | loss: 0.0187555
	speed: 0.7205s/iter; left time: 4024.8666s
	iters: 300, epoch: 8 | loss: 0.0184164
	speed: 0.7202s/iter; left time: 3950.8156s
	iters: 400, epoch: 8 | loss: 0.0192565
	speed: 0.7198s/iter; left time: 3876.8855s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:20.37s
Steps: 445 | Train Loss: 0.0196747 Vali Loss: 0.0301925 Test Loss: 0.0437775
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0174150
	speed: 1.5324s/iter; left time: 8031.4636s
	iters: 200, epoch: 9 | loss: 0.0179154
	speed: 0.7217s/iter; left time: 3710.0932s
	iters: 300, epoch: 9 | loss: 0.0173499
	speed: 0.7204s/iter; left time: 3631.3070s
	iters: 400, epoch: 9 | loss: 0.0182475
	speed: 0.7198s/iter; left time: 3556.3908s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:05m:20.50s
Steps: 445 | Train Loss: 0.0193972 Vali Loss: 0.0300176 Test Loss: 0.0431081
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0402989462018013, rmse:0.20074597001075745, mae:0.14150388538837433, rse:0.6942076086997986
Intermediate time for GB and pred_len 96: 00h:56m:15.92s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=64, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0269608
	speed: 0.7469s/iter; left time: 6558.6765s
	iters: 200, epoch: 1 | loss: 0.0274164
	speed: 0.7241s/iter; left time: 6285.5526s
	iters: 300, epoch: 1 | loss: 0.0256406
	speed: 0.7243s/iter; left time: 6215.2647s
	iters: 400, epoch: 1 | loss: 0.0278278
	speed: 0.7259s/iter; left time: 6156.4625s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:05m:21.81s
Steps: 444 | Train Loss: 0.0281285 Vali Loss: 0.0310864 Test Loss: 0.0435887
Validation loss decreased (inf --> 0.031086).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0241208
	speed: 1.5286s/iter; left time: 12744.1454s
	iters: 200, epoch: 2 | loss: 0.0249518
	speed: 0.7239s/iter; left time: 5962.6101s
	iters: 300, epoch: 2 | loss: 0.0251283
	speed: 0.7240s/iter; left time: 5891.1163s
	iters: 400, epoch: 2 | loss: 0.0236740
	speed: 0.7249s/iter; left time: 5826.0042s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:05m:21.37s
Steps: 444 | Train Loss: 0.0248076 Vali Loss: 0.0308314 Test Loss: 0.0430559
Validation loss decreased (0.031086 --> 0.030831).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0237497
	speed: 1.5279s/iter; left time: 12060.0242s
	iters: 200, epoch: 3 | loss: 0.0228141
	speed: 0.7230s/iter; left time: 5634.0080s
	iters: 300, epoch: 3 | loss: 0.0217565
	speed: 0.7225s/iter; left time: 5558.0465s
	iters: 400, epoch: 3 | loss: 0.0244880
	speed: 0.7240s/iter; left time: 5497.2140s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:05m:20.88s
Steps: 444 | Train Loss: 0.0229355 Vali Loss: 0.0306573 Test Loss: 0.0430532
Validation loss decreased (0.030831 --> 0.030657).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0244858
	speed: 1.5291s/iter; left time: 11390.0229s
	iters: 200, epoch: 4 | loss: 0.0243690
	speed: 0.7233s/iter; left time: 5315.1716s
	iters: 300, epoch: 4 | loss: 0.0219046
	speed: 0.7231s/iter; left time: 5241.8854s
	iters: 400, epoch: 4 | loss: 0.0218012
	speed: 0.7234s/iter; left time: 5171.4778s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:05m:21.01s
Steps: 444 | Train Loss: 0.0225335 Vali Loss: 0.0309076 Test Loss: 0.0431541
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0233454
	speed: 1.5234s/iter; left time: 10671.7008s
	iters: 200, epoch: 5 | loss: 0.0209921
	speed: 0.7244s/iter; left time: 5001.8062s
	iters: 300, epoch: 5 | loss: 0.0242191
	speed: 0.7246s/iter; left time: 4930.8705s
	iters: 400, epoch: 5 | loss: 0.0218035
	speed: 0.7235s/iter; left time: 4851.3240s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:05m:21.29s
Steps: 444 | Train Loss: 0.0221094 Vali Loss: 0.0308309 Test Loss: 0.0438321
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0201289
	speed: 1.5211s/iter; left time: 9979.7247s
	iters: 200, epoch: 6 | loss: 0.0211403
	speed: 0.7243s/iter; left time: 4679.6269s
	iters: 300, epoch: 6 | loss: 0.0226115
	speed: 0.7240s/iter; left time: 4605.5747s
	iters: 400, epoch: 6 | loss: 0.0225834
	speed: 0.7233s/iter; left time: 4528.5164s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:05m:21.10s
Steps: 444 | Train Loss: 0.0215733 Vali Loss: 0.0318337 Test Loss: 0.0450657
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0199800
	speed: 1.5210s/iter; left time: 9304.2040s
	iters: 200, epoch: 7 | loss: 0.0212566
	speed: 0.7234s/iter; left time: 4352.5687s
	iters: 300, epoch: 7 | loss: 0.0221269
	speed: 0.7239s/iter; left time: 4283.1790s
	iters: 400, epoch: 7 | loss: 0.0223966
	speed: 0.7233s/iter; left time: 4207.1786s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:05m:20.98s
Steps: 444 | Train Loss: 0.0211381 Vali Loss: 0.0319989 Test Loss: 0.0451651
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0211825
	speed: 1.5210s/iter; left time: 8628.6157s
	iters: 200, epoch: 8 | loss: 0.0198315
	speed: 0.7238s/iter; left time: 4033.7783s
	iters: 300, epoch: 8 | loss: 0.0216954
	speed: 0.7241s/iter; left time: 3962.9642s
	iters: 400, epoch: 8 | loss: 0.0182057
	speed: 0.7237s/iter; left time: 3888.3024s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:05m:21.14s
Steps: 444 | Train Loss: 0.0208608 Vali Loss: 0.0317588 Test Loss: 0.0450449
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04305318742990494, rmse:0.2074926197528839, mae:0.14702880382537842, rse:0.7194067239761353
Intermediate time for GB and pred_len 168: 00h:49m:51.13s
Intermediate time for GB: 02h:54m:59.34s


=== Starting experiments for country: ES ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0195191
	speed: 0.4042s/iter; left time: 1770.9342s
	iters: 200, epoch: 1 | loss: 0.0178518
	speed: 0.3824s/iter; left time: 1637.2300s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:25.82s
Steps: 224 | Train Loss: 0.0215666 Vali Loss: 0.0120246 Test Loss: 0.0154649
Validation loss decreased (inf --> 0.012025).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0110951
	speed: 0.6152s/iter; left time: 2557.2214s
	iters: 200, epoch: 2 | loss: 0.0089168
	speed: 0.3846s/iter; left time: 1560.2988s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:26.09s
Steps: 224 | Train Loss: 0.0114667 Vali Loss: 0.0099340 Test Loss: 0.0124430
Validation loss decreased (0.012025 --> 0.009934).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0094385
	speed: 0.6159s/iter; left time: 2422.2452s
	iters: 200, epoch: 3 | loss: 0.0097403
	speed: 0.3849s/iter; left time: 1475.3067s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:26.32s
Steps: 224 | Train Loss: 0.0097346 Vali Loss: 0.0092674 Test Loss: 0.0117505
Validation loss decreased (0.009934 --> 0.009267).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0102117
	speed: 0.6164s/iter; left time: 2286.2182s
	iters: 200, epoch: 4 | loss: 0.0096852
	speed: 0.3853s/iter; left time: 1390.6134s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:26.31s
Steps: 224 | Train Loss: 0.0093477 Vali Loss: 0.0093860 Test Loss: 0.0117003
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0082508
	speed: 0.6137s/iter; left time: 2138.6477s
	iters: 200, epoch: 5 | loss: 0.0086889
	speed: 0.3851s/iter; left time: 1303.6718s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:26.20s
Steps: 224 | Train Loss: 0.0089759 Vali Loss: 0.0091834 Test Loss: 0.0113511
Validation loss decreased (0.009267 --> 0.009183).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0088070
	speed: 0.6185s/iter; left time: 2017.0525s
	iters: 200, epoch: 6 | loss: 0.0080614
	speed: 0.3859s/iter; left time: 1219.7309s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:26.47s
Steps: 224 | Train Loss: 0.0088026 Vali Loss: 0.0089738 Test Loss: 0.0113156
Validation loss decreased (0.009183 --> 0.008974).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0104345
	speed: 0.6165s/iter; left time: 1872.4005s
	iters: 200, epoch: 7 | loss: 0.0085016
	speed: 0.3847s/iter; left time: 1129.7651s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:26.23s
Steps: 224 | Train Loss: 0.0085589 Vali Loss: 0.0093118 Test Loss: 0.0118977
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0077006
	speed: 0.6140s/iter; left time: 1727.0964s
	iters: 200, epoch: 8 | loss: 0.0082233
	speed: 0.3851s/iter; left time: 1044.7248s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:26.23s
Steps: 224 | Train Loss: 0.0083394 Vali Loss: 0.0090055 Test Loss: 0.0112410
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0093437
	speed: 0.6147s/iter; left time: 1591.5033s
	iters: 200, epoch: 9 | loss: 0.0070935
	speed: 0.3854s/iter; left time: 959.1466s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:26.32s
Steps: 224 | Train Loss: 0.0082570 Vali Loss: 0.0089743 Test Loss: 0.0114231
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0086219
	speed: 0.6158s/iter; left time: 1456.4752s
	iters: 200, epoch: 10 | loss: 0.0070904
	speed: 0.3851s/iter; left time: 872.1611s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:26.29s
Steps: 224 | Train Loss: 0.0081209 Vali Loss: 0.0091072 Test Loss: 0.0116036
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0070862
	speed: 0.6136s/iter; left time: 1313.7240s
	iters: 200, epoch: 11 | loss: 0.0075065
	speed: 0.3846s/iter; left time: 784.9996s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:26.16s
Steps: 224 | Train Loss: 0.0080325 Vali Loss: 0.0087324 Test Loss: 0.0110522
Validation loss decreased (0.008974 --> 0.008732).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0087495
	speed: 0.6165s/iter; left time: 1181.8267s
	iters: 200, epoch: 12 | loss: 0.0090640
	speed: 0.3854s/iter; left time: 700.3547s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:26.38s
Steps: 224 | Train Loss: 0.0078615 Vali Loss: 0.0089089 Test Loss: 0.0114960
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0075404
	speed: 0.6154s/iter; left time: 1041.8771s
	iters: 200, epoch: 13 | loss: 0.0070684
	speed: 0.3857s/iter; left time: 614.4491s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:26.43s
Steps: 224 | Train Loss: 0.0078251 Vali Loss: 0.0085859 Test Loss: 0.0108104
Validation loss decreased (0.008732 --> 0.008586).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0074663
	speed: 0.6153s/iter; left time: 903.9059s
	iters: 200, epoch: 14 | loss: 0.0073172
	speed: 0.3853s/iter; left time: 527.5139s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:26.29s
Steps: 224 | Train Loss: 0.0077326 Vali Loss: 0.0087050 Test Loss: 0.0109574
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0067719
	speed: 0.6149s/iter; left time: 765.5087s
	iters: 200, epoch: 15 | loss: 0.0082704
	speed: 0.3850s/iter; left time: 440.7763s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:26.24s
Steps: 224 | Train Loss: 0.0077182 Vali Loss: 0.0086332 Test Loss: 0.0109099
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0083347
	speed: 0.6141s/iter; left time: 627.0389s
	iters: 200, epoch: 16 | loss: 0.0074337
	speed: 0.3847s/iter; left time: 354.3510s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:26.24s
Steps: 224 | Train Loss: 0.0076103 Vali Loss: 0.0084655 Test Loss: 0.0106939
Validation loss decreased (0.008586 --> 0.008465).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0079523
	speed: 0.6166s/iter; left time: 491.4670s
	iters: 200, epoch: 17 | loss: 0.0069271
	speed: 0.3854s/iter; left time: 268.5952s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:26.34s
Steps: 224 | Train Loss: 0.0075618 Vali Loss: 0.0085241 Test Loss: 0.0107415
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0064623
	speed: 0.6138s/iter; left time: 351.6913s
	iters: 200, epoch: 18 | loss: 0.0071695
	speed: 0.3850s/iter; left time: 182.1209s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:26.23s
Steps: 224 | Train Loss: 0.0075162 Vali Loss: 0.0084254 Test Loss: 0.0107176
Validation loss decreased (0.008465 --> 0.008425).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0068357
	speed: 0.6156s/iter; left time: 214.8378s
	iters: 200, epoch: 19 | loss: 0.0076776
	speed: 0.3851s/iter; left time: 95.8788s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:26.35s
Steps: 224 | Train Loss: 0.0074895 Vali Loss: 0.0083774 Test Loss: 0.0105521
Validation loss decreased (0.008425 --> 0.008377).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0070090
	speed: 0.6147s/iter; left time: 76.8408s
	iters: 200, epoch: 20 | loss: 0.0075570
	speed: 0.3853s/iter; left time: 9.6322s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:26.32s
Steps: 224 | Train Loss: 0.0074361 Vali Loss: 0.0085109 Test Loss: 0.0108376
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010552062653005123, rmse:0.10272323340177536, mae:0.06482216715812683, rse:0.3023020625114441
Intermediate time for ES and pred_len 24: 00h:33m:36.49s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0249440
	speed: 0.4099s/iter; left time: 1795.8819s
	iters: 200, epoch: 1 | loss: 0.0234317
	speed: 0.3855s/iter; left time: 1650.5231s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:26.63s
Steps: 224 | Train Loss: 0.0261810 Vali Loss: 0.0183967 Test Loss: 0.0231636
Validation loss decreased (inf --> 0.018397).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0182221
	speed: 0.6192s/iter; left time: 2573.8588s
	iters: 200, epoch: 2 | loss: 0.0175976
	speed: 0.3862s/iter; left time: 1566.9375s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:26.52s
Steps: 224 | Train Loss: 0.0182359 Vali Loss: 0.0179768 Test Loss: 0.0219282
Validation loss decreased (0.018397 --> 0.017977).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0167149
	speed: 0.6254s/iter; left time: 2459.5806s
	iters: 200, epoch: 3 | loss: 0.0136638
	speed: 0.3861s/iter; left time: 1479.7868s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:26.51s
Steps: 224 | Train Loss: 0.0162843 Vali Loss: 0.0168971 Test Loss: 0.0206574
Validation loss decreased (0.017977 --> 0.016897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0145439
	speed: 0.6241s/iter; left time: 2314.8453s
	iters: 200, epoch: 4 | loss: 0.0169107
	speed: 0.3873s/iter; left time: 1397.7654s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:26.67s
Steps: 224 | Train Loss: 0.0158333 Vali Loss: 0.0171990 Test Loss: 0.0215210
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0149616
	speed: 0.6182s/iter; left time: 2154.3923s
	iters: 200, epoch: 5 | loss: 0.0149911
	speed: 0.3860s/iter; left time: 1306.6464s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:26.48s
Steps: 224 | Train Loss: 0.0153089 Vali Loss: 0.0167449 Test Loss: 0.0209905
Validation loss decreased (0.016897 --> 0.016745).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0163790
	speed: 0.6190s/iter; left time: 2018.5800s
	iters: 200, epoch: 6 | loss: 0.0151860
	speed: 0.3860s/iter; left time: 1220.2362s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:26.43s
Steps: 224 | Train Loss: 0.0149298 Vali Loss: 0.0167596 Test Loss: 0.0204989
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0149499
	speed: 0.6177s/iter; left time: 1876.0995s
	iters: 200, epoch: 7 | loss: 0.0139030
	speed: 0.3860s/iter; left time: 1133.5509s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:26.50s
Steps: 224 | Train Loss: 0.0147117 Vali Loss: 0.0164430 Test Loss: 0.0204639
Validation loss decreased (0.016745 --> 0.016443).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0149081
	speed: 0.6195s/iter; left time: 1742.7102s
	iters: 200, epoch: 8 | loss: 0.0145743
	speed: 0.3871s/iter; left time: 1050.1298s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:26.68s
Steps: 224 | Train Loss: 0.0144592 Vali Loss: 0.0162204 Test Loss: 0.0197561
Validation loss decreased (0.016443 --> 0.016220).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0146681
	speed: 0.6221s/iter; left time: 1610.6571s
	iters: 200, epoch: 9 | loss: 0.0153187
	speed: 0.3870s/iter; left time: 963.2005s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:26.87s
Steps: 224 | Train Loss: 0.0141569 Vali Loss: 0.0162054 Test Loss: 0.0199452
Validation loss decreased (0.016220 --> 0.016205).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0139688
	speed: 0.6195s/iter; left time: 1465.0114s
	iters: 200, epoch: 10 | loss: 0.0133341
	speed: 0.3869s/iter; left time: 876.3994s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:26.65s
Steps: 224 | Train Loss: 0.0139821 Vali Loss: 0.0161435 Test Loss: 0.0199820
Validation loss decreased (0.016205 --> 0.016143).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0135381
	speed: 0.6234s/iter; left time: 1334.6407s
	iters: 200, epoch: 11 | loss: 0.0139865
	speed: 0.3870s/iter; left time: 789.8287s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:26.66s
Steps: 224 | Train Loss: 0.0138574 Vali Loss: 0.0160936 Test Loss: 0.0197122
Validation loss decreased (0.016143 --> 0.016094).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0125272
	speed: 0.6243s/iter; left time: 1196.7041s
	iters: 200, epoch: 12 | loss: 0.0144413
	speed: 0.3869s/iter; left time: 702.9611s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:26.71s
Steps: 224 | Train Loss: 0.0137525 Vali Loss: 0.0159956 Test Loss: 0.0195931
Validation loss decreased (0.016094 --> 0.015996).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0131212
	speed: 0.6196s/iter; left time: 1048.9764s
	iters: 200, epoch: 13 | loss: 0.0132859
	speed: 0.3867s/iter; left time: 615.9539s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:26.60s
Steps: 224 | Train Loss: 0.0135558 Vali Loss: 0.0160421 Test Loss: 0.0197650
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0144332
	speed: 0.6183s/iter; left time: 908.3111s
	iters: 200, epoch: 14 | loss: 0.0137474
	speed: 0.3865s/iter; left time: 529.0750s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:26.59s
Steps: 224 | Train Loss: 0.0134872 Vali Loss: 0.0159760 Test Loss: 0.0194968
Validation loss decreased (0.015996 --> 0.015976).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0140534
	speed: 0.6310s/iter; left time: 785.5979s
	iters: 200, epoch: 15 | loss: 0.0133048
	speed: 0.3865s/iter; left time: 442.5672s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:26.58s
Steps: 224 | Train Loss: 0.0133434 Vali Loss: 0.0161070 Test Loss: 0.0195973
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0139255
	speed: 0.6179s/iter; left time: 630.9237s
	iters: 200, epoch: 16 | loss: 0.0130007
	speed: 0.3865s/iter; left time: 355.9775s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:26.56s
Steps: 224 | Train Loss: 0.0132606 Vali Loss: 0.0160394 Test Loss: 0.0196379
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0132931
	speed: 0.6170s/iter; left time: 491.7486s
	iters: 200, epoch: 17 | loss: 0.0127927
	speed: 0.3865s/iter; left time: 269.4080s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:26.54s
Steps: 224 | Train Loss: 0.0131573 Vali Loss: 0.0160593 Test Loss: 0.0194815
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0141886
	speed: 0.6195s/iter; left time: 354.9520s
	iters: 200, epoch: 18 | loss: 0.0120912
	speed: 0.3865s/iter; left time: 182.8058s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:26.62s
Steps: 224 | Train Loss: 0.0130748 Vali Loss: 0.0159712 Test Loss: 0.0192531
Validation loss decreased (0.015976 --> 0.015971).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0124319
	speed: 0.6217s/iter; left time: 216.9876s
	iters: 200, epoch: 19 | loss: 0.0126571
	speed: 0.3864s/iter; left time: 96.2177s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:26.56s
Steps: 224 | Train Loss: 0.0130525 Vali Loss: 0.0161250 Test Loss: 0.0195972
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0134002
	speed: 0.6169s/iter; left time: 77.1063s
	iters: 200, epoch: 20 | loss: 0.0123817
	speed: 0.3864s/iter; left time: 9.6610s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:26.49s
Steps: 224 | Train Loss: 0.0129701 Vali Loss: 0.0160416 Test Loss: 0.0196599
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019253108650445938, rmse:0.13875557482242584, mae:0.09227865189313889, rse:0.4076220989227295
Intermediate time for ES and pred_len 96: 00h:33m:50.69s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0265592
	speed: 0.4121s/iter; left time: 1797.1768s
	iters: 200, epoch: 1 | loss: 0.0243586
	speed: 0.3863s/iter; left time: 1646.0049s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:26.49s
Steps: 223 | Train Loss: 0.0273594 Vali Loss: 0.0200295 Test Loss: 0.0249285
Validation loss decreased (inf --> 0.020029).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0208427
	speed: 0.6233s/iter; left time: 2579.4055s
	iters: 200, epoch: 2 | loss: 0.0210364
	speed: 0.3870s/iter; left time: 1562.7388s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:26.26s
Steps: 223 | Train Loss: 0.0197896 Vali Loss: 0.0199548 Test Loss: 0.0237666
Validation loss decreased (0.020029 --> 0.019955).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0188704
	speed: 0.6194s/iter; left time: 2425.0667s
	iters: 200, epoch: 3 | loss: 0.0189737
	speed: 0.4546s/iter; left time: 1734.3145s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:38.46s
Steps: 223 | Train Loss: 0.0180211 Vali Loss: 0.0194267 Test Loss: 0.0233839
Validation loss decreased (0.019955 --> 0.019427).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0169618
	speed: 0.6717s/iter; left time: 2479.9897s
	iters: 200, epoch: 4 | loss: 0.0167444
	speed: 0.3879s/iter; left time: 1393.2231s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:26.34s
Steps: 223 | Train Loss: 0.0175879 Vali Loss: 0.0195176 Test Loss: 0.0237317
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0181750
	speed: 0.6117s/iter; left time: 2122.1175s
	iters: 200, epoch: 5 | loss: 0.0167845
	speed: 0.3865s/iter; left time: 1302.2230s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:26.24s
Steps: 223 | Train Loss: 0.0169361 Vali Loss: 0.0191335 Test Loss: 0.0237855
Validation loss decreased (0.019427 --> 0.019134).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0157064
	speed: 0.6156s/iter; left time: 1998.3674s
	iters: 200, epoch: 6 | loss: 0.0180538
	speed: 0.3872s/iter; left time: 1218.2526s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:01m:26.37s
Steps: 223 | Train Loss: 0.0165787 Vali Loss: 0.0187295 Test Loss: 0.0231191
Validation loss decreased (0.019134 --> 0.018730).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0166475
	speed: 0.6146s/iter; left time: 1857.8465s
	iters: 200, epoch: 7 | loss: 0.0160672
	speed: 0.3876s/iter; left time: 1132.9038s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:01m:26.36s
Steps: 223 | Train Loss: 0.0161585 Vali Loss: 0.0183947 Test Loss: 0.0226610
Validation loss decreased (0.018730 --> 0.018395).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0160268
	speed: 0.6201s/iter; left time: 1736.2209s
	iters: 200, epoch: 8 | loss: 0.0145470
	speed: 0.3877s/iter; left time: 1046.9027s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:01m:26.44s
Steps: 223 | Train Loss: 0.0159654 Vali Loss: 0.0184937 Test Loss: 0.0224739
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0150325
	speed: 0.6130s/iter; left time: 1579.7983s
	iters: 200, epoch: 9 | loss: 0.0163261
	speed: 0.3872s/iter; left time: 959.0034s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:01m:26.33s
Steps: 223 | Train Loss: 0.0157438 Vali Loss: 0.0181651 Test Loss: 0.0220128
Validation loss decreased (0.018395 --> 0.018165).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0151650
	speed: 0.6155s/iter; left time: 1448.9577s
	iters: 200, epoch: 10 | loss: 0.0157046
	speed: 0.3872s/iter; left time: 872.7710s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:01m:26.32s
Steps: 223 | Train Loss: 0.0156164 Vali Loss: 0.0180622 Test Loss: 0.0219389
Validation loss decreased (0.018165 --> 0.018062).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0162252
	speed: 0.6160s/iter; left time: 1312.6739s
	iters: 200, epoch: 11 | loss: 0.0161423
	speed: 0.3889s/iter; left time: 789.9386s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:01m:26.58s
Steps: 223 | Train Loss: 0.0155445 Vali Loss: 0.0180314 Test Loss: 0.0215321
Validation loss decreased (0.018062 --> 0.018031).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0150040
	speed: 0.6144s/iter; left time: 1172.2758s
	iters: 200, epoch: 12 | loss: 0.0156210
	speed: 0.3867s/iter; left time: 699.1137s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:01m:26.26s
Steps: 223 | Train Loss: 0.0154035 Vali Loss: 0.0182018 Test Loss: 0.0220669
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0149252
	speed: 0.6289s/iter; left time: 1059.6735s
	iters: 200, epoch: 13 | loss: 0.0144699
	speed: 0.3877s/iter; left time: 614.4462s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:01m:26.99s
Steps: 223 | Train Loss: 0.0152830 Vali Loss: 0.0180043 Test Loss: 0.0217210
Validation loss decreased (0.018031 --> 0.018004).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0155531
	speed: 0.6258s/iter; left time: 914.8969s
	iters: 200, epoch: 14 | loss: 0.0156407
	speed: 0.3872s/iter; left time: 527.3925s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:01m:26.32s
Steps: 223 | Train Loss: 0.0151557 Vali Loss: 0.0180213 Test Loss: 0.0216910
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0166781
	speed: 0.6134s/iter; left time: 759.9576s
	iters: 200, epoch: 15 | loss: 0.0160159
	speed: 0.3876s/iter; left time: 441.4967s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:01m:26.46s
Steps: 223 | Train Loss: 0.0150411 Vali Loss: 0.0179539 Test Loss: 0.0217073
Validation loss decreased (0.018004 --> 0.017954).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0152969
	speed: 0.6217s/iter; left time: 631.6563s
	iters: 200, epoch: 16 | loss: 0.0135630
	speed: 0.3873s/iter; left time: 354.7550s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:01m:26.38s
Steps: 223 | Train Loss: 0.0149140 Vali Loss: 0.0178565 Test Loss: 0.0215013
Validation loss decreased (0.017954 --> 0.017857).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0140472
	speed: 0.6166s/iter; left time: 488.9443s
	iters: 200, epoch: 17 | loss: 0.0152880
	speed: 0.3877s/iter; left time: 268.6528s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:01m:26.42s
Steps: 223 | Train Loss: 0.0148222 Vali Loss: 0.0179699 Test Loss: 0.0216110
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0148507
	speed: 0.6148s/iter; left time: 350.4527s
	iters: 200, epoch: 18 | loss: 0.0164600
	speed: 0.3875s/iter; left time: 182.1439s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:01m:26.40s
Steps: 223 | Train Loss: 0.0147455 Vali Loss: 0.0178199 Test Loss: 0.0213912
Validation loss decreased (0.017857 --> 0.017820).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0149923
	speed: 0.6140s/iter; left time: 213.0419s
	iters: 200, epoch: 19 | loss: 0.0143576
	speed: 0.3861s/iter; left time: 95.3724s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:01m:26.13s
Steps: 223 | Train Loss: 0.0146880 Vali Loss: 0.0179486 Test Loss: 0.0216664
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0145650
	speed: 0.6127s/iter; left time: 75.9769s
	iters: 200, epoch: 20 | loss: 0.0149989
	speed: 0.3875s/iter; left time: 9.2989s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:01m:26.38s
Steps: 223 | Train Loss: 0.0146028 Vali Loss: 0.0178162 Test Loss: 0.0213934
Validation loss decreased (0.017820 --> 0.017816).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02139340527355671, rmse:0.14626485109329224, mae:0.0981053039431572, rse:0.4297129511833191
Intermediate time for ES and pred_len 168: 00h:33m:58.22s
Intermediate time for ES: 01h:41m:25.40s

=== Starting experiments for country: FR ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0130487
	speed: 0.1511s/iter; left time: 667.9956s
	iters: 200, epoch: 1 | loss: 0.0103617
	speed: 0.1239s/iter; left time: 535.5428s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:28.58s
Steps: 226 | Train Loss: 0.0144769 Vali Loss: 0.0124056 Test Loss: 0.0141598
Validation loss decreased (inf --> 0.012406).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0082445
	speed: 0.2080s/iter; left time: 872.4846s
	iters: 200, epoch: 2 | loss: 0.0071333
	speed: 0.1251s/iter; left time: 512.1418s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.41s
Steps: 226 | Train Loss: 0.0077434 Vali Loss: 0.0100425 Test Loss: 0.0115160
Validation loss decreased (0.012406 --> 0.010043).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0076254
	speed: 0.2073s/iter; left time: 822.8809s
	iters: 200, epoch: 3 | loss: 0.0089435
	speed: 0.1243s/iter; left time: 480.7884s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.23s
Steps: 226 | Train Loss: 0.0069315 Vali Loss: 0.0095908 Test Loss: 0.0110281
Validation loss decreased (0.010043 --> 0.009591).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0076805
	speed: 0.2106s/iter; left time: 788.1548s
	iters: 200, epoch: 4 | loss: 0.0075063
	speed: 0.1373s/iter; left time: 500.1599s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.94s
Steps: 226 | Train Loss: 0.0067137 Vali Loss: 0.0104638 Test Loss: 0.0117844
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0064084
	speed: 0.2057s/iter; left time: 723.6193s
	iters: 200, epoch: 5 | loss: 0.0064071
	speed: 0.1242s/iter; left time: 424.2606s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.23s
Steps: 226 | Train Loss: 0.0065286 Vali Loss: 0.0098535 Test Loss: 0.0114410
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0075900
	speed: 0.2256s/iter; left time: 742.4972s
	iters: 200, epoch: 6 | loss: 0.0057913
	speed: 0.1456s/iter; left time: 464.6230s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:32.86s
Steps: 226 | Train Loss: 0.0063824 Vali Loss: 0.0095019 Test Loss: 0.0113460
Validation loss decreased (0.009591 --> 0.009502).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0057422
	speed: 0.2129s/iter; left time: 652.6132s
	iters: 200, epoch: 7 | loss: 0.0076545
	speed: 0.1399s/iter; left time: 414.7238s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:30.86s
Steps: 226 | Train Loss: 0.0062955 Vali Loss: 0.0095683 Test Loss: 0.0111601
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0058789
	speed: 0.2228s/iter; left time: 632.5032s
	iters: 200, epoch: 8 | loss: 0.0063653
	speed: 0.1526s/iter; left time: 417.8945s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:31.10s
Steps: 226 | Train Loss: 0.0061740 Vali Loss: 0.0094667 Test Loss: 0.0111329
Validation loss decreased (0.009502 --> 0.009467).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0066320
	speed: 0.2072s/iter; left time: 541.3679s
	iters: 200, epoch: 9 | loss: 0.0070459
	speed: 0.1247s/iter; left time: 313.3430s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.32s
Steps: 226 | Train Loss: 0.0061295 Vali Loss: 0.0097573 Test Loss: 0.0115309
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0059691
	speed: 0.2076s/iter; left time: 495.5522s
	iters: 200, epoch: 10 | loss: 0.0064003
	speed: 0.1263s/iter; left time: 288.8035s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.61s
Steps: 226 | Train Loss: 0.0060785 Vali Loss: 0.0093925 Test Loss: 0.0109733
Validation loss decreased (0.009467 --> 0.009392).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0051292
	speed: 0.2070s/iter; left time: 447.3410s
	iters: 200, epoch: 11 | loss: 0.0055100
	speed: 0.1249s/iter; left time: 257.3534s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.33s
Steps: 226 | Train Loss: 0.0059735 Vali Loss: 0.0093449 Test Loss: 0.0110144
Validation loss decreased (0.009392 --> 0.009345).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0065305
	speed: 0.2079s/iter; left time: 402.3041s
	iters: 200, epoch: 12 | loss: 0.0048937
	speed: 0.1461s/iter; left time: 268.0112s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:31.06s
Steps: 226 | Train Loss: 0.0059678 Vali Loss: 0.0093493 Test Loss: 0.0110368
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0058089
	speed: 0.2213s/iter; left time: 378.1262s
	iters: 200, epoch: 13 | loss: 0.0065166
	speed: 0.1265s/iter; left time: 203.4598s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.72s
Steps: 226 | Train Loss: 0.0059069 Vali Loss: 0.0092951 Test Loss: 0.0108905
Validation loss decreased (0.009345 --> 0.009295).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0052859
	speed: 0.2086s/iter; left time: 309.4225s
	iters: 200, epoch: 14 | loss: 0.0075063
	speed: 0.1247s/iter; left time: 172.4812s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.46s
Steps: 226 | Train Loss: 0.0058505 Vali Loss: 0.0094139 Test Loss: 0.0109936
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0054630
	speed: 0.2260s/iter; left time: 284.1288s
	iters: 200, epoch: 15 | loss: 0.0058545
	speed: 0.1600s/iter; left time: 185.0958s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:34.47s
Steps: 226 | Train Loss: 0.0058097 Vali Loss: 0.0093261 Test Loss: 0.0109611
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0058441
	speed: 0.2423s/iter; left time: 249.8441s
	iters: 200, epoch: 16 | loss: 0.0062263
	speed: 0.1243s/iter; left time: 115.7596s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:29.58s
Steps: 226 | Train Loss: 0.0057721 Vali Loss: 0.0094083 Test Loss: 0.0108882
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0048290
	speed: 0.2103s/iter; left time: 169.2988s
	iters: 200, epoch: 17 | loss: 0.0069202
	speed: 0.1346s/iter; left time: 94.8587s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:29.89s
Steps: 226 | Train Loss: 0.0057287 Vali Loss: 0.0092327 Test Loss: 0.0108260
Validation loss decreased (0.009295 --> 0.009233).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0057634
	speed: 0.2301s/iter; left time: 133.2105s
	iters: 200, epoch: 18 | loss: 0.0056466
	speed: 0.1279s/iter; left time: 61.2775s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:29.59s
Steps: 226 | Train Loss: 0.0056984 Vali Loss: 0.0091110 Test Loss: 0.0108564
Validation loss decreased (0.009233 --> 0.009111).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0059800
	speed: 0.2070s/iter; left time: 73.0712s
	iters: 200, epoch: 19 | loss: 0.0052861
	speed: 0.1275s/iter; left time: 32.2481s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:29.03s
Steps: 226 | Train Loss: 0.0056953 Vali Loss: 0.0092817 Test Loss: 0.0107927
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0051276
	speed: 0.2104s/iter; left time: 26.7178s
	iters: 200, epoch: 20 | loss: 0.0055541
	speed: 0.1244s/iter; left time: 3.3599s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:28.27s
Steps: 226 | Train Loss: 0.0056517 Vali Loss: 0.0092387 Test Loss: 0.0107835
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010856376960873604, rmse:0.10419394075870514, mae:0.05993499606847763, rse:0.4019773304462433
Intermediate time for FR and pred_len 24: 00h:11m:45.54s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0147024
	speed: 0.1615s/iter; left time: 710.7157s
	iters: 200, epoch: 1 | loss: 0.0152049
	speed: 0.1252s/iter; left time: 538.5728s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:29.52s
Steps: 225 | Train Loss: 0.0179286 Vali Loss: 0.0170811 Test Loss: 0.0214118
Validation loss decreased (inf --> 0.017081).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0113892
	speed: 0.2080s/iter; left time: 868.7265s
	iters: 200, epoch: 2 | loss: 0.0127477
	speed: 0.1268s/iter; left time: 516.9425s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.53s
Steps: 225 | Train Loss: 0.0126357 Vali Loss: 0.0162430 Test Loss: 0.0203346
Validation loss decreased (0.017081 --> 0.016243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0126674
	speed: 0.2114s/iter; left time: 835.3086s
	iters: 200, epoch: 3 | loss: 0.0123108
	speed: 0.1280s/iter; left time: 492.8921s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.78s
Steps: 225 | Train Loss: 0.0118050 Vali Loss: 0.0156507 Test Loss: 0.0206055
Validation loss decreased (0.016243 --> 0.015651).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0113491
	speed: 0.2127s/iter; left time: 792.5417s
	iters: 200, epoch: 4 | loss: 0.0114844
	speed: 0.1349s/iter; left time: 489.2137s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:30.19s
Steps: 225 | Train Loss: 0.0113757 Vali Loss: 0.0151757 Test Loss: 0.0200848
Validation loss decreased (0.015651 --> 0.015176).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0102961
	speed: 0.2545s/iter; left time: 890.8570s
	iters: 200, epoch: 5 | loss: 0.0125940
	speed: 0.1501s/iter; left time: 510.5007s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.25s
Steps: 225 | Train Loss: 0.0109752 Vali Loss: 0.0154549 Test Loss: 0.0202221
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0110599
	speed: 0.2136s/iter; left time: 699.6178s
	iters: 200, epoch: 6 | loss: 0.0100994
	speed: 0.1244s/iter; left time: 395.0562s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.14s
Steps: 225 | Train Loss: 0.0107455 Vali Loss: 0.0151377 Test Loss: 0.0201709
Validation loss decreased (0.015176 --> 0.015138).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0105998
	speed: 0.2094s/iter; left time: 638.7615s
	iters: 200, epoch: 7 | loss: 0.0122199
	speed: 0.1248s/iter; left time: 368.3685s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.46s
Steps: 225 | Train Loss: 0.0105227 Vali Loss: 0.0148822 Test Loss: 0.0197665
Validation loss decreased (0.015138 --> 0.014882).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0108822
	speed: 0.2089s/iter; left time: 590.2478s
	iters: 200, epoch: 8 | loss: 0.0109945
	speed: 0.1273s/iter; left time: 346.9206s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.65s
Steps: 225 | Train Loss: 0.0104018 Vali Loss: 0.0152280 Test Loss: 0.0200418
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0099946
	speed: 0.2095s/iter; left time: 545.0218s
	iters: 200, epoch: 9 | loss: 0.0108894
	speed: 0.1280s/iter; left time: 320.0787s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.72s
Steps: 225 | Train Loss: 0.0102055 Vali Loss: 0.0145973 Test Loss: 0.0200153
Validation loss decreased (0.014882 --> 0.014597).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0097942
	speed: 0.2070s/iter; left time: 491.7504s
	iters: 200, epoch: 10 | loss: 0.0097672
	speed: 0.1247s/iter; left time: 283.8064s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.24s
Steps: 225 | Train Loss: 0.0101035 Vali Loss: 0.0149185 Test Loss: 0.0200497
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0092038
	speed: 0.2128s/iter; left time: 457.8325s
	iters: 200, epoch: 11 | loss: 0.0101169
	speed: 0.1456s/iter; left time: 298.7179s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.45s
Steps: 225 | Train Loss: 0.0099663 Vali Loss: 0.0148763 Test Loss: 0.0202064
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0103183
	speed: 0.2160s/iter; left time: 416.0914s
	iters: 200, epoch: 12 | loss: 0.0095475
	speed: 0.1247s/iter; left time: 227.6537s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.20s
Steps: 225 | Train Loss: 0.0099111 Vali Loss: 0.0151120 Test Loss: 0.0204279
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0087962
	speed: 0.2208s/iter; left time: 375.5851s
	iters: 200, epoch: 13 | loss: 0.0110409
	speed: 0.1251s/iter; left time: 200.2070s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:29.51s
Steps: 225 | Train Loss: 0.0098284 Vali Loss: 0.0149348 Test Loss: 0.0203463
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0095532
	speed: 0.2086s/iter; left time: 307.9121s
	iters: 200, epoch: 14 | loss: 0.0089391
	speed: 0.1255s/iter; left time: 172.7448s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.30s
Steps: 225 | Train Loss: 0.0097749 Vali Loss: 0.0147762 Test Loss: 0.0201790
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020015263929963112, rmse:0.14147530496120453, mae:0.08575939387083054, rse:0.5472640991210938
Intermediate time for FR and pred_len 96: 00h:08m:14.62s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0181483
	speed: 0.1552s/iter; left time: 683.1972s
	iters: 200, epoch: 1 | loss: 0.0172763
	speed: 0.1303s/iter; left time: 560.4937s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:30.38s
Steps: 225 | Train Loss: 0.0193621 Vali Loss: 0.0185368 Test Loss: 0.0225658
Validation loss decreased (inf --> 0.018537).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0141904
	speed: 0.2654s/iter; left time: 1108.4793s
	iters: 200, epoch: 2 | loss: 0.0126614
	speed: 0.1431s/iter; left time: 583.2256s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.60s
Steps: 225 | Train Loss: 0.0141230 Vali Loss: 0.0176849 Test Loss: 0.0215894
Validation loss decreased (0.018537 --> 0.017685).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0135257
	speed: 0.2088s/iter; left time: 824.8487s
	iters: 200, epoch: 3 | loss: 0.0123185
	speed: 0.1307s/iter; left time: 503.4348s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:29.40s
Steps: 225 | Train Loss: 0.0133672 Vali Loss: 0.0172216 Test Loss: 0.0222378
Validation loss decreased (0.017685 --> 0.017222).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0143941
	speed: 0.2297s/iter; left time: 855.8799s
	iters: 200, epoch: 4 | loss: 0.0125045
	speed: 0.1250s/iter; left time: 453.3433s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.91s
Steps: 225 | Train Loss: 0.0131145 Vali Loss: 0.0170706 Test Loss: 0.0219320
Validation loss decreased (0.017222 --> 0.017071).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0133954
	speed: 0.2088s/iter; left time: 731.0332s
	iters: 200, epoch: 5 | loss: 0.0122464
	speed: 0.1249s/iter; left time: 424.6466s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.36s
Steps: 225 | Train Loss: 0.0126029 Vali Loss: 0.0168675 Test Loss: 0.0215498
Validation loss decreased (0.017071 --> 0.016867).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0133064
	speed: 0.2094s/iter; left time: 686.1242s
	iters: 200, epoch: 6 | loss: 0.0123626
	speed: 0.1260s/iter; left time: 400.1645s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.59s
Steps: 225 | Train Loss: 0.0122548 Vali Loss: 0.0168818 Test Loss: 0.0217501
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0121893
	speed: 0.2145s/iter; left time: 654.5186s
	iters: 200, epoch: 7 | loss: 0.0128906
	speed: 0.1524s/iter; left time: 449.8610s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:32.60s
Steps: 225 | Train Loss: 0.0119784 Vali Loss: 0.0164041 Test Loss: 0.0216603
Validation loss decreased (0.016867 --> 0.016404).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0129033
	speed: 0.2547s/iter; left time: 719.7606s
	iters: 200, epoch: 8 | loss: 0.0126196
	speed: 0.1518s/iter; left time: 413.8278s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:34.38s
Steps: 225 | Train Loss: 0.0118114 Vali Loss: 0.0167039 Test Loss: 0.0221317
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0110283
	speed: 0.2490s/iter; left time: 647.7105s
	iters: 200, epoch: 9 | loss: 0.0131031
	speed: 0.1565s/iter; left time: 391.3209s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:34.86s
Steps: 225 | Train Loss: 0.0116214 Vali Loss: 0.0164882 Test Loss: 0.0220004
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0106390
	speed: 0.2500s/iter; left time: 593.9144s
	iters: 200, epoch: 10 | loss: 0.0103403
	speed: 0.1589s/iter; left time: 361.6155s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:35.14s
Steps: 225 | Train Loss: 0.0115014 Vali Loss: 0.0163617 Test Loss: 0.0219452
Validation loss decreased (0.016404 --> 0.016362).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0104352
	speed: 0.2496s/iter; left time: 536.9433s
	iters: 200, epoch: 11 | loss: 0.0120406
	speed: 0.1359s/iter; left time: 278.7026s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.69s
Steps: 225 | Train Loss: 0.0114241 Vali Loss: 0.0164061 Test Loss: 0.0221639
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0100976
	speed: 0.2467s/iter; left time: 475.1387s
	iters: 200, epoch: 12 | loss: 0.0108029
	speed: 0.1561s/iter; left time: 285.0334s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:34.70s
Steps: 225 | Train Loss: 0.0113432 Vali Loss: 0.0163061 Test Loss: 0.0218783
Validation loss decreased (0.016362 --> 0.016306).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0123946
	speed: 0.2500s/iter; left time: 425.2854s
	iters: 200, epoch: 13 | loss: 0.0106203
	speed: 0.1513s/iter; left time: 242.2793s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:34.24s
Steps: 225 | Train Loss: 0.0112463 Vali Loss: 0.0164862 Test Loss: 0.0220891
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0120560
	speed: 0.2524s/iter; left time: 372.4722s
	iters: 200, epoch: 14 | loss: 0.0114261
	speed: 0.1545s/iter; left time: 212.6083s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:34.93s
Steps: 225 | Train Loss: 0.0111975 Vali Loss: 0.0162412 Test Loss: 0.0219959
Validation loss decreased (0.016306 --> 0.016241).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0116879
	speed: 0.2476s/iter; left time: 309.7735s
	iters: 200, epoch: 15 | loss: 0.0111726
	speed: 0.1573s/iter; left time: 181.0654s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:34.17s
Steps: 225 | Train Loss: 0.0111193 Vali Loss: 0.0163175 Test Loss: 0.0220602
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0120678
	speed: 0.2222s/iter; left time: 227.9839s
	iters: 200, epoch: 16 | loss: 0.0114807
	speed: 0.1461s/iter; left time: 135.2911s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:32.41s
Steps: 225 | Train Loss: 0.0110744 Vali Loss: 0.0163514 Test Loss: 0.0223251
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0109318
	speed: 0.2225s/iter; left time: 178.2290s
	iters: 200, epoch: 17 | loss: 0.0104629
	speed: 0.1409s/iter; left time: 98.7463s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:30.74s
Steps: 225 | Train Loss: 0.0110372 Vali Loss: 0.0163676 Test Loss: 0.0223826
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0106376
	speed: 0.2519s/iter; left time: 145.1035s
	iters: 200, epoch: 18 | loss: 0.0119821
	speed: 0.1519s/iter; left time: 72.3177s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:34.25s
Steps: 225 | Train Loss: 0.0109769 Vali Loss: 0.0163234 Test Loss: 0.0221871
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0107207
	speed: 0.2497s/iter; left time: 87.6505s
	iters: 200, epoch: 19 | loss: 0.0112138
	speed: 0.1565s/iter; left time: 39.2718s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:34.74s
Steps: 225 | Train Loss: 0.0109562 Vali Loss: 0.0162882 Test Loss: 0.0222033
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021995939314365387, rmse:0.14831027388572693, mae:0.09114450216293335, rse:0.5744197368621826
Intermediate time for FR and pred_len 168: 00h:12m:19.17s
Intermediate time for FR: 00h:32m:19.33s

=== Starting experiments for country: IT ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0243448
	speed: 0.1652s/iter; left time: 730.3256s
	iters: 200, epoch: 1 | loss: 0.0229790
	speed: 0.1383s/iter; left time: 597.7161s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:32.21s
Steps: 226 | Train Loss: 0.0268654 Vali Loss: 0.0144127 Test Loss: 0.0152149
Validation loss decreased (inf --> 0.014413).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0126385
	speed: 0.2473s/iter; left time: 1037.3901s
	iters: 200, epoch: 2 | loss: 0.0113061
	speed: 0.1563s/iter; left time: 640.1219s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.77s
Steps: 226 | Train Loss: 0.0135024 Vali Loss: 0.0112989 Test Loss: 0.0123300
Validation loss decreased (0.014413 --> 0.011299).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0124331
	speed: 0.2475s/iter; left time: 982.1816s
	iters: 200, epoch: 3 | loss: 0.0116472
	speed: 0.1517s/iter; left time: 587.0119s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.22s
Steps: 226 | Train Loss: 0.0119030 Vali Loss: 0.0106734 Test Loss: 0.0116822
Validation loss decreased (0.011299 --> 0.010673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0122854
	speed: 0.2498s/iter; left time: 934.8984s
	iters: 200, epoch: 4 | loss: 0.0143051
	speed: 0.1539s/iter; left time: 560.5195s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.85s
Steps: 226 | Train Loss: 0.0113319 Vali Loss: 0.0102620 Test Loss: 0.0112144
Validation loss decreased (0.010673 --> 0.010262).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0109653
	speed: 0.2424s/iter; left time: 852.5450s
	iters: 200, epoch: 5 | loss: 0.0132881
	speed: 0.1341s/iter; left time: 458.1996s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.18s
Steps: 226 | Train Loss: 0.0110240 Vali Loss: 0.0102972 Test Loss: 0.0114048
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0113125
	speed: 0.2372s/iter; left time: 780.5652s
	iters: 200, epoch: 6 | loss: 0.0103211
	speed: 0.1491s/iter; left time: 475.6809s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.66s
Steps: 226 | Train Loss: 0.0106692 Vali Loss: 0.0098025 Test Loss: 0.0108670
Validation loss decreased (0.010262 --> 0.009803).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0103765
	speed: 0.2515s/iter; left time: 770.8376s
	iters: 200, epoch: 7 | loss: 0.0112636
	speed: 0.1509s/iter; left time: 447.3094s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.23s
Steps: 226 | Train Loss: 0.0105300 Vali Loss: 0.0100033 Test Loss: 0.0109814
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0091729
	speed: 0.2492s/iter; left time: 707.4627s
	iters: 200, epoch: 8 | loss: 0.0084527
	speed: 0.1539s/iter; left time: 421.4469s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:34.61s
Steps: 226 | Train Loss: 0.0103527 Vali Loss: 0.0097033 Test Loss: 0.0107587
Validation loss decreased (0.009803 --> 0.009703).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0116518
	speed: 0.2507s/iter; left time: 655.1436s
	iters: 200, epoch: 9 | loss: 0.0105640
	speed: 0.1459s/iter; left time: 366.6337s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:33.55s
Steps: 226 | Train Loss: 0.0102292 Vali Loss: 0.0098548 Test Loss: 0.0106564
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0098734
	speed: 0.2224s/iter; left time: 530.9787s
	iters: 200, epoch: 10 | loss: 0.0098391
	speed: 0.1463s/iter; left time: 334.6955s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:32.04s
Steps: 226 | Train Loss: 0.0101449 Vali Loss: 0.0096761 Test Loss: 0.0105900
Validation loss decreased (0.009703 --> 0.009676).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0102106
	speed: 0.2506s/iter; left time: 541.5407s
	iters: 200, epoch: 11 | loss: 0.0102552
	speed: 0.1512s/iter; left time: 311.7200s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:34.48s
Steps: 226 | Train Loss: 0.0100208 Vali Loss: 0.0097775 Test Loss: 0.0107950
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0108097
	speed: 0.2487s/iter; left time: 481.2249s
	iters: 200, epoch: 12 | loss: 0.0104917
	speed: 0.1492s/iter; left time: 273.8000s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:34.06s
Steps: 226 | Train Loss: 0.0099346 Vali Loss: 0.0096047 Test Loss: 0.0106282
Validation loss decreased (0.009676 --> 0.009605).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0085579
	speed: 0.2551s/iter; left time: 435.9056s
	iters: 200, epoch: 13 | loss: 0.0086822
	speed: 0.1517s/iter; left time: 244.1550s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:34.90s
Steps: 226 | Train Loss: 0.0098653 Vali Loss: 0.0094783 Test Loss: 0.0103315
Validation loss decreased (0.009605 --> 0.009478).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0097914
	speed: 0.2312s/iter; left time: 342.8554s
	iters: 200, epoch: 14 | loss: 0.0113469
	speed: 0.1332s/iter; left time: 184.2712s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:30.74s
Steps: 226 | Train Loss: 0.0097909 Vali Loss: 0.0093775 Test Loss: 0.0103079
Validation loss decreased (0.009478 --> 0.009378).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0094810
	speed: 0.2434s/iter; left time: 305.9598s
	iters: 200, epoch: 15 | loss: 0.0113624
	speed: 0.1544s/iter; left time: 178.6267s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:34.40s
Steps: 226 | Train Loss: 0.0097382 Vali Loss: 0.0095560 Test Loss: 0.0104357
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0104041
	speed: 0.2474s/iter; left time: 255.0742s
	iters: 200, epoch: 16 | loss: 0.0091918
	speed: 0.1518s/iter; left time: 141.2844s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:34.14s
Steps: 226 | Train Loss: 0.0096565 Vali Loss: 0.0094822 Test Loss: 0.0103096
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0116628
	speed: 0.2490s/iter; left time: 200.4124s
	iters: 200, epoch: 17 | loss: 0.0094893
	speed: 0.1560s/iter; left time: 109.9833s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:34.84s
Steps: 226 | Train Loss: 0.0096267 Vali Loss: 0.0093537 Test Loss: 0.0103266
Validation loss decreased (0.009378 --> 0.009354).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0102649
	speed: 0.2432s/iter; left time: 140.7853s
	iters: 200, epoch: 18 | loss: 0.0087708
	speed: 0.1254s/iter; left time: 60.0802s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:30.78s
Steps: 226 | Train Loss: 0.0095806 Vali Loss: 0.0094264 Test Loss: 0.0103736
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0095868
	speed: 0.2412s/iter; left time: 85.1284s
	iters: 200, epoch: 19 | loss: 0.0085493
	speed: 0.1495s/iter; left time: 37.8120s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:33.97s
Steps: 226 | Train Loss: 0.0095211 Vali Loss: 0.0093145 Test Loss: 0.0102482
Validation loss decreased (0.009354 --> 0.009315).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0096340
	speed: 0.2552s/iter; left time: 32.4072s
	iters: 200, epoch: 20 | loss: 0.0095999
	speed: 0.1497s/iter; left time: 4.0422s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:34.21s
Steps: 226 | Train Loss: 0.0094857 Vali Loss: 0.0093332 Test Loss: 0.0101544
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01024822797626257, rmse:0.10123353451490402, mae:0.06074071303009987, rse:0.3825116753578186
Intermediate time for IT and pred_len 24: 00h:13m:18.33s

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0301183
	speed: 0.1775s/iter; left time: 781.3073s
	iters: 200, epoch: 1 | loss: 0.0269664
	speed: 0.1485s/iter; left time: 638.4962s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.53s
Steps: 225 | Train Loss: 0.0326885 Vali Loss: 0.0203707 Test Loss: 0.0221248
Validation loss decreased (inf --> 0.020371).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0204590
	speed: 0.2157s/iter; left time: 900.9065s
	iters: 200, epoch: 2 | loss: 0.0222128
	speed: 0.1453s/iter; left time: 592.3631s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.61s
Steps: 225 | Train Loss: 0.0220685 Vali Loss: 0.0182516 Test Loss: 0.0199305
Validation loss decreased (0.020371 --> 0.018252).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0205928
	speed: 0.2522s/iter; left time: 996.4412s
	iters: 200, epoch: 3 | loss: 0.0205219
	speed: 0.1523s/iter; left time: 586.5661s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.54s
Steps: 225 | Train Loss: 0.0198721 Vali Loss: 0.0179414 Test Loss: 0.0205862
Validation loss decreased (0.018252 --> 0.017941).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0193388
	speed: 0.2520s/iter; left time: 938.9891s
	iters: 200, epoch: 4 | loss: 0.0188175
	speed: 0.1491s/iter; left time: 540.5583s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.08s
Steps: 225 | Train Loss: 0.0187379 Vali Loss: 0.0167647 Test Loss: 0.0192748
Validation loss decreased (0.017941 --> 0.016765).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0167888
	speed: 0.2547s/iter; left time: 891.7298s
	iters: 200, epoch: 5 | loss: 0.0216136
	speed: 0.1527s/iter; left time: 519.1987s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.82s
Steps: 225 | Train Loss: 0.0183412 Vali Loss: 0.0168859 Test Loss: 0.0193811
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0184630
	speed: 0.2234s/iter; left time: 731.8184s
	iters: 200, epoch: 6 | loss: 0.0157104
	speed: 0.1400s/iter; left time: 444.6285s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:30.50s
Steps: 225 | Train Loss: 0.0180643 Vali Loss: 0.0164044 Test Loss: 0.0186259
Validation loss decreased (0.016765 --> 0.016404).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0171250
	speed: 0.2491s/iter; left time: 759.9347s
	iters: 200, epoch: 7 | loss: 0.0176361
	speed: 0.1562s/iter; left time: 460.9156s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.68s
Steps: 225 | Train Loss: 0.0178018 Vali Loss: 0.0165095 Test Loss: 0.0187795
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0174236
	speed: 0.2480s/iter; left time: 700.8354s
	iters: 200, epoch: 8 | loss: 0.0183114
	speed: 0.1521s/iter; left time: 414.5438s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:34.28s
Steps: 225 | Train Loss: 0.0176159 Vali Loss: 0.0161470 Test Loss: 0.0184036
Validation loss decreased (0.016404 --> 0.016147).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0173728
	speed: 0.2541s/iter; left time: 660.8742s
	iters: 200, epoch: 9 | loss: 0.0183281
	speed: 0.1540s/iter; left time: 385.1839s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:34.84s
Steps: 225 | Train Loss: 0.0174204 Vali Loss: 0.0161837 Test Loss: 0.0187648
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0181503
	speed: 0.2255s/iter; left time: 535.7545s
	iters: 200, epoch: 10 | loss: 0.0167253
	speed: 0.1254s/iter; left time: 285.3379s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.62s
Steps: 225 | Train Loss: 0.0172617 Vali Loss: 0.0161325 Test Loss: 0.0182937
Validation loss decreased (0.016147 --> 0.016133).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0158237
	speed: 0.2069s/iter; left time: 445.0600s
	iters: 200, epoch: 11 | loss: 0.0169237
	speed: 0.1247s/iter; left time: 255.7746s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.30s
Steps: 225 | Train Loss: 0.0171310 Vali Loss: 0.0159683 Test Loss: 0.0182468
Validation loss decreased (0.016133 --> 0.015968).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0191050
	speed: 0.2079s/iter; left time: 400.3237s
	iters: 200, epoch: 12 | loss: 0.0163762
	speed: 0.1247s/iter; left time: 227.6119s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.23s
Steps: 225 | Train Loss: 0.0169672 Vali Loss: 0.0160046 Test Loss: 0.0183137
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0166489
	speed: 0.2086s/iter; left time: 354.8625s
	iters: 200, epoch: 13 | loss: 0.0174182
	speed: 0.1259s/iter; left time: 201.5010s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.49s
Steps: 225 | Train Loss: 0.0168844 Vali Loss: 0.0159117 Test Loss: 0.0182683
Validation loss decreased (0.015968 --> 0.015912).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0170752
	speed: 0.2103s/iter; left time: 310.3465s
	iters: 200, epoch: 14 | loss: 0.0175392
	speed: 0.1259s/iter; left time: 173.2446s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.50s
Steps: 225 | Train Loss: 0.0167426 Vali Loss: 0.0160454 Test Loss: 0.0181828
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0162328
	speed: 0.2060s/iter; left time: 257.6706s
	iters: 200, epoch: 15 | loss: 0.0161093
	speed: 0.1258s/iter; left time: 144.8526s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.38s
Steps: 225 | Train Loss: 0.0166730 Vali Loss: 0.0160248 Test Loss: 0.0183523
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0154793
	speed: 0.2082s/iter; left time: 213.6553s
	iters: 200, epoch: 16 | loss: 0.0169243
	speed: 0.1252s/iter; left time: 115.9249s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.46s
Steps: 225 | Train Loss: 0.0165999 Vali Loss: 0.0159579 Test Loss: 0.0183164
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0168139
	speed: 0.2085s/iter; left time: 167.0029s
	iters: 200, epoch: 17 | loss: 0.0175394
	speed: 0.1245s/iter; left time: 87.2637s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.24s
Steps: 225 | Train Loss: 0.0165133 Vali Loss: 0.0158993 Test Loss: 0.0181488
Validation loss decreased (0.015912 --> 0.015899).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0155911
	speed: 0.2067s/iter; left time: 119.0761s
	iters: 200, epoch: 18 | loss: 0.0171316
	speed: 0.1251s/iter; left time: 59.5527s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:28.30s
Steps: 225 | Train Loss: 0.0164482 Vali Loss: 0.0158756 Test Loss: 0.0183023
Validation loss decreased (0.015899 --> 0.015876).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0157789
	speed: 0.2100s/iter; left time: 73.6933s
	iters: 200, epoch: 19 | loss: 0.0163923
	speed: 0.1257s/iter; left time: 31.5412s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:28.48s
Steps: 225 | Train Loss: 0.0163893 Vali Loss: 0.0159697 Test Loss: 0.0182470
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0163167
	speed: 0.2079s/iter; left time: 26.1928s
	iters: 200, epoch: 20 | loss: 0.0180438
	speed: 0.1258s/iter; left time: 3.2699s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:28.41s
Steps: 225 | Train Loss: 0.0163222 Vali Loss: 0.0159263 Test Loss: 0.0181796
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018302302807569504, rmse:0.13528600335121155, mae:0.08310361206531525, rse:0.5115309357643127
Intermediate time for IT and pred_len 96: 00h:12m:14.02s

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='no_patching_IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.2, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=128, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : no_patching_IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0310567
	speed: 0.1518s/iter; left time: 667.9006s
	iters: 200, epoch: 1 | loss: 0.0283692
	speed: 0.1260s/iter; left time: 541.8447s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:28.83s
Steps: 225 | Train Loss: 0.0341425 Vali Loss: 0.0216124 Test Loss: 0.0231160
Validation loss decreased (inf --> 0.021612).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0225683
	speed: 0.2125s/iter; left time: 887.2381s
	iters: 200, epoch: 2 | loss: 0.0218985
	speed: 0.1263s/iter; left time: 514.7070s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:28.53s
Steps: 225 | Train Loss: 0.0238823 Vali Loss: 0.0200806 Test Loss: 0.0214945
Validation loss decreased (0.021612 --> 0.020081).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0211665
	speed: 0.2094s/iter; left time: 827.2427s
	iters: 200, epoch: 3 | loss: 0.0211268
	speed: 0.1260s/iter; left time: 485.1794s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:28.52s
Steps: 225 | Train Loss: 0.0216721 Vali Loss: 0.0187043 Test Loss: 0.0206154
Validation loss decreased (0.020081 --> 0.018704).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0219336
	speed: 0.2095s/iter; left time: 780.7758s
	iters: 200, epoch: 4 | loss: 0.0206096
	speed: 0.1255s/iter; left time: 455.2306s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:28.44s
Steps: 225 | Train Loss: 0.0207172 Vali Loss: 0.0189361 Test Loss: 0.0205644
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0207074
	speed: 0.2112s/iter; left time: 739.3942s
	iters: 200, epoch: 5 | loss: 0.0205898
	speed: 0.1256s/iter; left time: 427.1883s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:28.52s
Steps: 225 | Train Loss: 0.0202865 Vali Loss: 0.0184972 Test Loss: 0.0207886
Validation loss decreased (0.018704 --> 0.018497).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0206845
	speed: 0.2087s/iter; left time: 683.6828s
	iters: 200, epoch: 6 | loss: 0.0188039
	speed: 0.1255s/iter; left time: 398.4385s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.38s
Steps: 225 | Train Loss: 0.0199052 Vali Loss: 0.0181741 Test Loss: 0.0200713
Validation loss decreased (0.018497 --> 0.018174).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0188000
	speed: 0.2122s/iter; left time: 647.4822s
	iters: 200, epoch: 7 | loss: 0.0204586
	speed: 0.1259s/iter; left time: 371.6542s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.63s
Steps: 225 | Train Loss: 0.0196300 Vali Loss: 0.0178590 Test Loss: 0.0197266
Validation loss decreased (0.018174 --> 0.017859).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0192003
	speed: 0.2116s/iter; left time: 598.0552s
	iters: 200, epoch: 8 | loss: 0.0189526
	speed: 0.1258s/iter; left time: 342.8997s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:28.49s
Steps: 225 | Train Loss: 0.0193939 Vali Loss: 0.0182576 Test Loss: 0.0201084
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0203683
	speed: 0.2093s/iter; left time: 544.4171s
	iters: 200, epoch: 9 | loss: 0.0183637
	speed: 0.1261s/iter; left time: 315.4629s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:28.66s
Steps: 225 | Train Loss: 0.0191739 Vali Loss: 0.0178613 Test Loss: 0.0197537
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0180912
	speed: 0.2116s/iter; left time: 502.8547s
	iters: 200, epoch: 10 | loss: 0.0195543
	speed: 0.1260s/iter; left time: 286.7414s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:28.56s
Steps: 225 | Train Loss: 0.0190360 Vali Loss: 0.0177946 Test Loss: 0.0196573
Validation loss decreased (0.017859 --> 0.017795).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0182367
	speed: 0.2107s/iter; left time: 453.1540s
	iters: 200, epoch: 11 | loss: 0.0190966
	speed: 0.1260s/iter; left time: 258.5183s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:28.52s
Steps: 225 | Train Loss: 0.0189143 Vali Loss: 0.0179626 Test Loss: 0.0195450
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0194587
	speed: 0.2092s/iter; left time: 402.8617s
	iters: 200, epoch: 12 | loss: 0.0180350
	speed: 0.1257s/iter; left time: 229.4437s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:28.56s
Steps: 225 | Train Loss: 0.0188081 Vali Loss: 0.0177290 Test Loss: 0.0194388
Validation loss decreased (0.017795 --> 0.017729).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0183054
	speed: 0.2124s/iter; left time: 361.3455s
	iters: 200, epoch: 13 | loss: 0.0174135
	speed: 0.1257s/iter; left time: 201.1698s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:28.55s
Steps: 225 | Train Loss: 0.0186785 Vali Loss: 0.0178206 Test Loss: 0.0194642
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0184357
	speed: 0.2086s/iter; left time: 307.8606s
	iters: 200, epoch: 14 | loss: 0.0191077
	speed: 0.1255s/iter; left time: 172.6878s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:28.49s
Steps: 225 | Train Loss: 0.0186044 Vali Loss: 0.0177682 Test Loss: 0.0196619
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0174899
	speed: 0.2093s/iter; left time: 261.7776s
	iters: 200, epoch: 15 | loss: 0.0180370
	speed: 0.1257s/iter; left time: 144.6639s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:28.56s
Steps: 225 | Train Loss: 0.0185151 Vali Loss: 0.0177840 Test Loss: 0.0194913
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0185360
	speed: 0.2119s/iter; left time: 217.3935s
	iters: 200, epoch: 16 | loss: 0.0188540
	speed: 0.1260s/iter; left time: 116.6756s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:28.65s
Steps: 225 | Train Loss: 0.0184078 Vali Loss: 0.0178775 Test Loss: 0.0197945
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0178400
	speed: 0.2105s/iter; left time: 168.6005s
	iters: 200, epoch: 17 | loss: 0.0181476
	speed: 0.1261s/iter; left time: 88.3857s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:28.57s
Steps: 225 | Train Loss: 0.0183320 Vali Loss: 0.0178545 Test Loss: 0.0195108
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : no_patching_IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019438760355114937, rmse:0.1394229531288147, mae:0.08769001066684723, rse:0.5276631116867065
Intermediate time for IT and pred_len 168: 00h:09m:45.11s
Intermediate time for IT: 00h:35m:17.46s
Total time: 02h:49m:02.19s
