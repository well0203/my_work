
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1461562
	speed: 0.0870s/iter; left time: 1939.9968s
	iters: 200, epoch: 1 | loss: 0.1378466
	speed: 0.0681s/iter; left time: 1512.6238s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.69s
Steps: 224 | Train Loss: 0.1492350 Vali Loss: 0.1491234 Test Loss: 0.1573499
Validation loss decreased (inf --> 0.149123).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0934312
	speed: 0.1174s/iter; left time: 2592.4927s
	iters: 200, epoch: 2 | loss: 0.0790701
	speed: 0.0682s/iter; left time: 1498.1839s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0957774 Vali Loss: 0.0962578 Test Loss: 0.0969347
Validation loss decreased (0.149123 --> 0.096258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0799299
	speed: 0.1177s/iter; left time: 2571.7666s
	iters: 200, epoch: 3 | loss: 0.0831469
	speed: 0.0682s/iter; left time: 1483.5663s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.47s
Steps: 224 | Train Loss: 0.0800204 Vali Loss: 0.0912525 Test Loss: 0.0925209
Validation loss decreased (0.096258 --> 0.091253).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0719650
	speed: 0.1174s/iter; left time: 2538.3949s
	iters: 200, epoch: 4 | loss: 0.0779148
	speed: 0.0682s/iter; left time: 1467.8905s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0767896 Vali Loss: 0.0894866 Test Loss: 0.0911194
Validation loss decreased (0.091253 --> 0.089487).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0700634
	speed: 0.1163s/iter; left time: 2489.1998s
	iters: 200, epoch: 5 | loss: 0.0721898
	speed: 0.0682s/iter; left time: 1452.4432s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0751648 Vali Loss: 0.0887144 Test Loss: 0.0904107
Validation loss decreased (0.089487 --> 0.088714).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0749286
	speed: 0.1160s/iter; left time: 2458.0185s
	iters: 200, epoch: 6 | loss: 0.0738826
	speed: 0.0681s/iter; left time: 1436.0335s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0741185 Vali Loss: 0.0878579 Test Loss: 0.0896857
Validation loss decreased (0.088714 --> 0.087858).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0773617
	speed: 0.1159s/iter; left time: 2428.6779s
	iters: 200, epoch: 7 | loss: 0.0697817
	speed: 0.0682s/iter; left time: 1422.8361s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0732767 Vali Loss: 0.0878588 Test Loss: 0.0896681
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0730642
	speed: 0.1162s/iter; left time: 2409.5194s
	iters: 200, epoch: 8 | loss: 0.0692202
	speed: 0.0682s/iter; left time: 1407.1454s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0726633 Vali Loss: 0.0872458 Test Loss: 0.0892158
Validation loss decreased (0.087858 --> 0.087246).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0729467
	speed: 0.1163s/iter; left time: 2385.3545s
	iters: 200, epoch: 9 | loss: 0.0744857
	speed: 0.0681s/iter; left time: 1390.5363s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0721623 Vali Loss: 0.0872867 Test Loss: 0.0896076
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0656316
	speed: 0.1169s/iter; left time: 2370.6480s
	iters: 200, epoch: 10 | loss: 0.0678511
	speed: 0.0681s/iter; left time: 1374.2560s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.39s
Steps: 224 | Train Loss: 0.0717752 Vali Loss: 0.0871055 Test Loss: 0.0893893
Validation loss decreased (0.087246 --> 0.087106).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0707091
	speed: 0.1165s/iter; left time: 2336.5772s
	iters: 200, epoch: 11 | loss: 0.0774499
	speed: 0.0682s/iter; left time: 1360.7911s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0715148 Vali Loss: 0.0870615 Test Loss: 0.0894800
Validation loss decreased (0.087106 --> 0.087061).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0717980
	speed: 0.1170s/iter; left time: 2321.4775s
	iters: 200, epoch: 12 | loss: 0.0725807
	speed: 0.0682s/iter; left time: 1345.7667s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0711614 Vali Loss: 0.0869605 Test Loss: 0.0890957
Validation loss decreased (0.087061 --> 0.086960).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0668585
	speed: 0.1175s/iter; left time: 2305.2279s
	iters: 200, epoch: 13 | loss: 0.0692727
	speed: 0.0681s/iter; left time: 1329.0050s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0709143 Vali Loss: 0.0864946 Test Loss: 0.0891141
Validation loss decreased (0.086960 --> 0.086495).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0735727
	speed: 0.1174s/iter; left time: 2277.1140s
	iters: 200, epoch: 14 | loss: 0.0707164
	speed: 0.0682s/iter; left time: 1314.7134s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0707176 Vali Loss: 0.0864244 Test Loss: 0.0890591
Validation loss decreased (0.086495 --> 0.086424).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0733102
	speed: 0.1170s/iter; left time: 2243.1031s
	iters: 200, epoch: 15 | loss: 0.0694377
	speed: 0.0682s/iter; left time: 1299.6779s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0704899 Vali Loss: 0.0864086 Test Loss: 0.0890507
Validation loss decreased (0.086424 --> 0.086409).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0683793
	speed: 0.1172s/iter; left time: 2219.2491s
	iters: 200, epoch: 16 | loss: 0.0738790
	speed: 0.0682s/iter; left time: 1284.0455s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0703185 Vali Loss: 0.0864727 Test Loss: 0.0892115
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0669841
	speed: 0.1164s/iter; left time: 2178.4624s
	iters: 200, epoch: 17 | loss: 0.0688473
	speed: 0.0682s/iter; left time: 1270.1758s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0701495 Vali Loss: 0.0867436 Test Loss: 0.0892003
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0703127
	speed: 0.1166s/iter; left time: 2157.1552s
	iters: 200, epoch: 18 | loss: 0.0680623
	speed: 0.0682s/iter; left time: 1253.8854s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0700702 Vali Loss: 0.0863745 Test Loss: 0.0892077
Validation loss decreased (0.086409 --> 0.086374).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0690351
	speed: 0.1182s/iter; left time: 2158.8575s
	iters: 200, epoch: 19 | loss: 0.0699728
	speed: 0.0685s/iter; left time: 1244.1439s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0698759 Vali Loss: 0.0863962 Test Loss: 0.0891723
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0747989
	speed: 0.1163s/iter; left time: 2099.3134s
	iters: 200, epoch: 20 | loss: 0.0701621
	speed: 0.0681s/iter; left time: 1222.6404s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.47s
Steps: 224 | Train Loss: 0.0698077 Vali Loss: 0.0862366 Test Loss: 0.0890738
Validation loss decreased (0.086374 --> 0.086237).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0651559
	speed: 0.1188s/iter; left time: 2117.8094s
	iters: 200, epoch: 21 | loss: 0.0728592
	speed: 0.0682s/iter; left time: 1208.8412s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0696717 Vali Loss: 0.0862255 Test Loss: 0.0889388
Validation loss decreased (0.086237 --> 0.086225).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0660903
	speed: 0.1169s/iter; left time: 2057.1570s
	iters: 200, epoch: 22 | loss: 0.0671541
	speed: 0.0682s/iter; left time: 1193.7144s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0695768 Vali Loss: 0.0863444 Test Loss: 0.0891108
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0654175
	speed: 0.1160s/iter; left time: 2015.2371s
	iters: 200, epoch: 23 | loss: 0.0723482
	speed: 0.0681s/iter; left time: 1176.3975s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:15.39s
Steps: 224 | Train Loss: 0.0695305 Vali Loss: 0.0861597 Test Loss: 0.0890979
Validation loss decreased (0.086225 --> 0.086160).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0697307
	speed: 0.1174s/iter; left time: 2013.1403s
	iters: 200, epoch: 24 | loss: 0.0650538
	speed: 0.0682s/iter; left time: 1162.0344s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0694439 Vali Loss: 0.0862999 Test Loss: 0.0889981
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0687164
	speed: 0.1167s/iter; left time: 1974.7961s
	iters: 200, epoch: 25 | loss: 0.0703700
	speed: 0.0682s/iter; left time: 1147.1364s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0694621 Vali Loss: 0.0863222 Test Loss: 0.0891119
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0651680
	speed: 0.1168s/iter; left time: 1950.1423s
	iters: 200, epoch: 26 | loss: 0.0651452
	speed: 0.0683s/iter; left time: 1134.6086s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0693130 Vali Loss: 0.0863219 Test Loss: 0.0892911
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0680985
	speed: 0.1161s/iter; left time: 1913.5918s
	iters: 200, epoch: 27 | loss: 0.0710439
	speed: 0.0682s/iter; left time: 1117.5937s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0692731 Vali Loss: 0.0861376 Test Loss: 0.0890480
Validation loss decreased (0.086160 --> 0.086138).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0662021
	speed: 0.1180s/iter; left time: 1917.0443s
	iters: 200, epoch: 28 | loss: 0.0719197
	speed: 0.0681s/iter; left time: 1100.6756s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0692632 Vali Loss: 0.0861789 Test Loss: 0.0889845
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0666632
	speed: 0.1166s/iter; left time: 1868.4072s
	iters: 200, epoch: 29 | loss: 0.0693237
	speed: 0.0682s/iter; left time: 1086.7873s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0691389 Vali Loss: 0.0861610 Test Loss: 0.0891781
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0710969
	speed: 0.1165s/iter; left time: 1841.6270s
	iters: 200, epoch: 30 | loss: 0.0695848
	speed: 0.0682s/iter; left time: 1071.3898s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0692292 Vali Loss: 0.0863213 Test Loss: 0.0891762
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0700110
	speed: 0.1158s/iter; left time: 1804.9240s
	iters: 200, epoch: 31 | loss: 0.0660521
	speed: 0.0683s/iter; left time: 1057.4247s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0691260 Vali Loss: 0.0860816 Test Loss: 0.0891049
Validation loss decreased (0.086138 --> 0.086082).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0688812
	speed: 0.1164s/iter; left time: 1787.8197s
	iters: 200, epoch: 32 | loss: 0.0697777
	speed: 0.0682s/iter; left time: 1041.0817s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0691065 Vali Loss: 0.0862049 Test Loss: 0.0891521
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0682049
	speed: 0.1170s/iter; left time: 1770.2912s
	iters: 200, epoch: 33 | loss: 0.0652785
	speed: 0.0682s/iter; left time: 1025.1237s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0689881 Vali Loss: 0.0863302 Test Loss: 0.0892339
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0697649
	speed: 0.1185s/iter; left time: 1767.0506s
	iters: 200, epoch: 34 | loss: 0.0742545
	speed: 0.0683s/iter; left time: 1011.9585s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0690200 Vali Loss: 0.0862837 Test Loss: 0.0892433
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0694564
	speed: 0.1176s/iter; left time: 1727.2184s
	iters: 200, epoch: 35 | loss: 0.0653591
	speed: 0.0682s/iter; left time: 994.6846s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0689881 Vali Loss: 0.0861455 Test Loss: 0.0891630
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0664618
	speed: 0.1166s/iter; left time: 1685.7674s
	iters: 200, epoch: 36 | loss: 0.0715217
	speed: 0.0682s/iter; left time: 979.2260s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0689417 Vali Loss: 0.0861939 Test Loss: 0.0891584
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0691396
	speed: 0.1169s/iter; left time: 1663.9450s
	iters: 200, epoch: 37 | loss: 0.0702624
	speed: 0.0682s/iter; left time: 963.9357s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0689000 Vali Loss: 0.0863010 Test Loss: 0.0891434
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0753347
	speed: 0.1163s/iter; left time: 1630.1800s
	iters: 200, epoch: 38 | loss: 0.0695233
	speed: 0.0682s/iter; left time: 948.6529s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0689737 Vali Loss: 0.0862217 Test Loss: 0.0891257
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0725676
	speed: 0.1169s/iter; left time: 1612.2869s
	iters: 200, epoch: 39 | loss: 0.0694272
	speed: 0.0681s/iter; left time: 932.8229s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0688931 Vali Loss: 0.0861030 Test Loss: 0.0891194
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0669012
	speed: 0.1167s/iter; left time: 1583.0745s
	iters: 200, epoch: 40 | loss: 0.0678386
	speed: 0.0682s/iter; left time: 918.0057s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0689278 Vali Loss: 0.0861022 Test Loss: 0.0891052
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0652631
	speed: 0.1166s/iter; left time: 1555.1809s
	iters: 200, epoch: 41 | loss: 0.0645099
	speed: 0.0681s/iter; left time: 902.1476s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0689060 Vali Loss: 0.0861354 Test Loss: 0.0891289
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021332554519176483, rmse:0.14605668187141418, mae:0.08910492062568665, rse:0.5154542922973633
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1481339
	speed: 0.0695s/iter; left time: 1549.3538s
	iters: 200, epoch: 1 | loss: 0.1375552
	speed: 0.0681s/iter; left time: 1512.1521s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.1479610 Vali Loss: 0.1469265 Test Loss: 0.1552719
Validation loss decreased (inf --> 0.146926).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0865266
	speed: 0.1168s/iter; left time: 2579.1506s
	iters: 200, epoch: 2 | loss: 0.0838551
	speed: 0.0682s/iter; left time: 1498.0163s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0964700 Vali Loss: 0.0967222 Test Loss: 0.0970902
Validation loss decreased (0.146926 --> 0.096722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0791053
	speed: 0.1175s/iter; left time: 2567.7102s
	iters: 200, epoch: 3 | loss: 0.0794358
	speed: 0.0682s/iter; left time: 1483.8585s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0806912 Vali Loss: 0.0917135 Test Loss: 0.0933135
Validation loss decreased (0.096722 --> 0.091714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0691623
	speed: 0.1166s/iter; left time: 2521.8402s
	iters: 200, epoch: 4 | loss: 0.0749935
	speed: 0.0681s/iter; left time: 1465.7443s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0772206 Vali Loss: 0.0896696 Test Loss: 0.0914560
Validation loss decreased (0.091714 --> 0.089670).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0780290
	speed: 0.1169s/iter; left time: 2502.3026s
	iters: 200, epoch: 5 | loss: 0.0737418
	speed: 0.0681s/iter; left time: 1451.2782s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0753263 Vali Loss: 0.0887567 Test Loss: 0.0905667
Validation loss decreased (0.089670 --> 0.088757).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0728102
	speed: 0.1166s/iter; left time: 2470.7172s
	iters: 200, epoch: 6 | loss: 0.0751472
	speed: 0.0681s/iter; left time: 1435.7969s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0740903 Vali Loss: 0.0880040 Test Loss: 0.0901668
Validation loss decreased (0.088757 --> 0.088004).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0700100
	speed: 0.1165s/iter; left time: 2441.6990s
	iters: 200, epoch: 7 | loss: 0.0719608
	speed: 0.0682s/iter; left time: 1422.7946s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0733094 Vali Loss: 0.0876565 Test Loss: 0.0895658
Validation loss decreased (0.088004 --> 0.087656).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0736883
	speed: 0.1163s/iter; left time: 2411.0395s
	iters: 200, epoch: 8 | loss: 0.0753195
	speed: 0.0681s/iter; left time: 1404.8808s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0726421 Vali Loss: 0.0870508 Test Loss: 0.0893122
Validation loss decreased (0.087656 --> 0.087051).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0736136
	speed: 0.1163s/iter; left time: 2385.7227s
	iters: 200, epoch: 9 | loss: 0.0743958
	speed: 0.0681s/iter; left time: 1390.3959s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0721928 Vali Loss: 0.0869639 Test Loss: 0.0890566
Validation loss decreased (0.087051 --> 0.086964).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0751010
	speed: 0.1164s/iter; left time: 2360.5034s
	iters: 200, epoch: 10 | loss: 0.0675038
	speed: 0.0681s/iter; left time: 1374.8824s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0717584 Vali Loss: 0.0868287 Test Loss: 0.0892483
Validation loss decreased (0.086964 --> 0.086829).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0670119
	speed: 0.1167s/iter; left time: 2341.7488s
	iters: 200, epoch: 11 | loss: 0.0717888
	speed: 0.0681s/iter; left time: 1359.3382s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0714888 Vali Loss: 0.0868792 Test Loss: 0.0891389
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0712271
	speed: 0.1159s/iter; left time: 2299.0788s
	iters: 200, epoch: 12 | loss: 0.0672809
	speed: 0.0681s/iter; left time: 1343.3915s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0712019 Vali Loss: 0.0867305 Test Loss: 0.0890825
Validation loss decreased (0.086829 --> 0.086731).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0719725
	speed: 0.1167s/iter; left time: 2289.5881s
	iters: 200, epoch: 13 | loss: 0.0728667
	speed: 0.0681s/iter; left time: 1328.3740s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0709423 Vali Loss: 0.0863669 Test Loss: 0.0889514
Validation loss decreased (0.086731 --> 0.086367).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0692876
	speed: 0.1167s/iter; left time: 2262.4731s
	iters: 200, epoch: 14 | loss: 0.0697647
	speed: 0.0681s/iter; left time: 1313.3432s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0707196 Vali Loss: 0.0867283 Test Loss: 0.0890393
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0662864
	speed: 0.1161s/iter; left time: 2224.9158s
	iters: 200, epoch: 15 | loss: 0.0771343
	speed: 0.0682s/iter; left time: 1299.8610s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0705296 Vali Loss: 0.0863529 Test Loss: 0.0889915
Validation loss decreased (0.086367 --> 0.086353).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0746282
	speed: 0.1165s/iter; left time: 2206.4443s
	iters: 200, epoch: 16 | loss: 0.0754090
	speed: 0.0680s/iter; left time: 1282.0729s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0703587 Vali Loss: 0.0864495 Test Loss: 0.0889058
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0699291
	speed: 0.1157s/iter; left time: 2166.3741s
	iters: 200, epoch: 17 | loss: 0.0712281
	speed: 0.0681s/iter; left time: 1268.2378s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0701812 Vali Loss: 0.0863386 Test Loss: 0.0889277
Validation loss decreased (0.086353 --> 0.086339).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0725383
	speed: 0.1164s/iter; left time: 2153.0135s
	iters: 200, epoch: 18 | loss: 0.0666652
	speed: 0.0681s/iter; left time: 1252.5904s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0700965 Vali Loss: 0.0862578 Test Loss: 0.0888635
Validation loss decreased (0.086339 --> 0.086258).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0668497
	speed: 0.1165s/iter; left time: 2129.1404s
	iters: 200, epoch: 19 | loss: 0.0658489
	speed: 0.0681s/iter; left time: 1237.0469s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0699537 Vali Loss: 0.0863137 Test Loss: 0.0890127
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0738967
	speed: 0.1177s/iter; left time: 2123.9244s
	iters: 200, epoch: 20 | loss: 0.0694792
	speed: 0.0685s/iter; left time: 1229.8839s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0698415 Vali Loss: 0.0861164 Test Loss: 0.0890737
Validation loss decreased (0.086258 --> 0.086116).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0683504
	speed: 0.1182s/iter; left time: 2106.3686s
	iters: 200, epoch: 21 | loss: 0.0662834
	speed: 0.0681s/iter; left time: 1206.9446s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:15.50s
Steps: 224 | Train Loss: 0.0697480 Vali Loss: 0.0862716 Test Loss: 0.0891779
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0703220
	speed: 0.1164s/iter; left time: 2047.8510s
	iters: 200, epoch: 22 | loss: 0.0745794
	speed: 0.0681s/iter; left time: 1191.2855s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0696553 Vali Loss: 0.0863418 Test Loss: 0.0890533
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0711524
	speed: 0.1162s/iter; left time: 2019.3311s
	iters: 200, epoch: 23 | loss: 0.0714321
	speed: 0.0681s/iter; left time: 1176.8547s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0695627 Vali Loss: 0.0861240 Test Loss: 0.0890432
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0750200
	speed: 0.1159s/iter; left time: 1987.3924s
	iters: 200, epoch: 24 | loss: 0.0680464
	speed: 0.0681s/iter; left time: 1160.8120s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0695156 Vali Loss: 0.0861897 Test Loss: 0.0889316
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0634025
	speed: 0.1160s/iter; left time: 1963.0234s
	iters: 200, epoch: 25 | loss: 0.0649181
	speed: 0.0681s/iter; left time: 1145.2621s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0694371 Vali Loss: 0.0860986 Test Loss: 0.0890105
Validation loss decreased (0.086116 --> 0.086099).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0696129
	speed: 0.1165s/iter; left time: 1945.9701s
	iters: 200, epoch: 26 | loss: 0.0687395
	speed: 0.0681s/iter; left time: 1130.1663s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0693808 Vali Loss: 0.0860134 Test Loss: 0.0890921
Validation loss decreased (0.086099 --> 0.086013).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0684652
	speed: 0.1167s/iter; left time: 1923.3255s
	iters: 200, epoch: 27 | loss: 0.0704379
	speed: 0.0681s/iter; left time: 1115.2019s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0692557 Vali Loss: 0.0860665 Test Loss: 0.0890185
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0660548
	speed: 0.1157s/iter; left time: 1880.1403s
	iters: 200, epoch: 28 | loss: 0.0695759
	speed: 0.0681s/iter; left time: 1099.9803s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0692245 Vali Loss: 0.0860535 Test Loss: 0.0891044
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0729185
	speed: 0.1158s/iter; left time: 1855.9955s
	iters: 200, epoch: 29 | loss: 0.0718815
	speed: 0.0681s/iter; left time: 1084.6080s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0692287 Vali Loss: 0.0860219 Test Loss: 0.0890628
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0671238
	speed: 0.1159s/iter; left time: 1831.8557s
	iters: 200, epoch: 30 | loss: 0.0673873
	speed: 0.0681s/iter; left time: 1069.6373s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0692022 Vali Loss: 0.0860136 Test Loss: 0.0890284
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0704793
	speed: 0.1178s/iter; left time: 1835.7009s
	iters: 200, epoch: 31 | loss: 0.0718422
	speed: 0.0684s/iter; left time: 1058.9754s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0691225 Vali Loss: 0.0860802 Test Loss: 0.0890919
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725498
	speed: 0.1185s/iter; left time: 1819.2180s
	iters: 200, epoch: 32 | loss: 0.0676495
	speed: 0.0681s/iter; left time: 1039.4135s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0691134 Vali Loss: 0.0860155 Test Loss: 0.0890442
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0670726
	speed: 0.1166s/iter; left time: 1764.2981s
	iters: 200, epoch: 33 | loss: 0.0635491
	speed: 0.0682s/iter; left time: 1025.1332s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0691029 Vali Loss: 0.0859950 Test Loss: 0.0890772
Validation loss decreased (0.086013 --> 0.085995).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0719834
	speed: 0.1168s/iter; left time: 1741.3619s
	iters: 200, epoch: 34 | loss: 0.0686517
	speed: 0.0682s/iter; left time: 1009.6711s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0690270 Vali Loss: 0.0861514 Test Loss: 0.0890609
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0703810
	speed: 0.1165s/iter; left time: 1711.0968s
	iters: 200, epoch: 35 | loss: 0.0672738
	speed: 0.0682s/iter; left time: 994.4350s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0690094 Vali Loss: 0.0860701 Test Loss: 0.0889734
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0648728
	speed: 0.1180s/iter; left time: 1705.8382s
	iters: 200, epoch: 36 | loss: 0.0674613
	speed: 0.0688s/iter; left time: 988.7094s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:15.59s
Steps: 224 | Train Loss: 0.0689744 Vali Loss: 0.0859692 Test Loss: 0.0889376
Validation loss decreased (0.085995 --> 0.085969).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0744139
	speed: 0.1181s/iter; left time: 1682.0318s
	iters: 200, epoch: 37 | loss: 0.0644355
	speed: 0.0682s/iter; left time: 963.9878s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0689775 Vali Loss: 0.0860912 Test Loss: 0.0890521
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0704839
	speed: 0.1166s/iter; left time: 1633.4715s
	iters: 200, epoch: 38 | loss: 0.0659875
	speed: 0.0682s/iter; left time: 948.3701s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0689991 Vali Loss: 0.0860307 Test Loss: 0.0890244
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0652285
	speed: 0.1163s/iter; left time: 1603.7897s
	iters: 200, epoch: 39 | loss: 0.0635228
	speed: 0.0682s/iter; left time: 932.9123s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0689129 Vali Loss: 0.0860817 Test Loss: 0.0890117
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0707843
	speed: 0.1163s/iter; left time: 1576.9634s
	iters: 200, epoch: 40 | loss: 0.0744735
	speed: 0.0682s/iter; left time: 917.7465s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0688853 Vali Loss: 0.0859151 Test Loss: 0.0890057
Validation loss decreased (0.085969 --> 0.085915).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0651298
	speed: 0.1174s/iter; left time: 1566.6230s
	iters: 200, epoch: 41 | loss: 0.0705316
	speed: 0.0685s/iter; left time: 906.9125s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0688910 Vali Loss: 0.0860872 Test Loss: 0.0890310
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0715486
	speed: 0.1173s/iter; left time: 1537.9944s
	iters: 200, epoch: 42 | loss: 0.0710283
	speed: 0.0681s/iter; left time: 886.7271s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0688885 Vali Loss: 0.0859699 Test Loss: 0.0890445
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0740932
	speed: 0.1165s/iter; left time: 1501.5440s
	iters: 200, epoch: 43 | loss: 0.0689263
	speed: 0.0682s/iter; left time: 871.9792s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0688816 Vali Loss: 0.0860015 Test Loss: 0.0890182
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0642701
	speed: 0.1166s/iter; left time: 1476.6701s
	iters: 200, epoch: 44 | loss: 0.0692235
	speed: 0.0684s/iter; left time: 859.5330s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0688794 Vali Loss: 0.0860575 Test Loss: 0.0890519
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0663138
	speed: 0.1179s/iter; left time: 1466.8916s
	iters: 200, epoch: 45 | loss: 0.0658265
	speed: 0.0682s/iter; left time: 842.2911s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0688699 Vali Loss: 0.0860186 Test Loss: 0.0890270
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0702913
	speed: 0.1172s/iter; left time: 1431.8558s
	iters: 200, epoch: 46 | loss: 0.0666724
	speed: 0.0684s/iter; left time: 828.9335s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0688977 Vali Loss: 0.0860817 Test Loss: 0.0890611
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0673764
	speed: 0.1164s/iter; left time: 1396.2169s
	iters: 200, epoch: 47 | loss: 0.0681927
	speed: 0.0682s/iter; left time: 810.8225s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0688601 Vali Loss: 0.0859702 Test Loss: 0.0890412
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0663044
	speed: 0.1161s/iter; left time: 1367.3692s
	iters: 200, epoch: 48 | loss: 0.0695243
	speed: 0.0681s/iter; left time: 794.9524s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0687945 Vali Loss: 0.0859358 Test Loss: 0.0890456
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0653680
	speed: 0.1171s/iter; left time: 1352.6229s
	iters: 200, epoch: 49 | loss: 0.0728765
	speed: 0.0684s/iter; left time: 782.9867s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0688531 Vali Loss: 0.0860522 Test Loss: 0.0890502
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0683106
	speed: 0.1173s/iter; left time: 1328.5994s
	iters: 200, epoch: 50 | loss: 0.0671068
	speed: 0.0683s/iter; left time: 767.0708s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0688381 Vali Loss: 0.0860414 Test Loss: 0.0890929
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021220816299319267, rmse:0.14567366242408752, mae:0.08900570124387741, rse:0.5141025185585022
Intermediate time for DE and pred_len 24: 00h:28m:14.77s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1553198
	speed: 0.0894s/iter; left time: 1993.5704s
	iters: 200, epoch: 1 | loss: 0.1476482
	speed: 0.0686s/iter; left time: 1523.5674s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.82s
Steps: 224 | Train Loss: 0.1587726 Vali Loss: 0.1620284 Test Loss: 0.1741853
Validation loss decreased (inf --> 0.162028).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1152195
	speed: 0.1189s/iter; left time: 2625.1259s
	iters: 200, epoch: 2 | loss: 0.1058429
	speed: 0.0687s/iter; left time: 1509.1123s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.1189176 Vali Loss: 0.1228653 Test Loss: 0.1296490
Validation loss decreased (0.162028 --> 0.122865).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1058418
	speed: 0.1196s/iter; left time: 2614.5310s
	iters: 200, epoch: 3 | loss: 0.1070150
	speed: 0.0686s/iter; left time: 1492.3288s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.62s
Steps: 224 | Train Loss: 0.1064492 Vali Loss: 0.1198202 Test Loss: 0.1269938
Validation loss decreased (0.122865 --> 0.119820).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1012271
	speed: 0.1207s/iter; left time: 2611.6478s
	iters: 200, epoch: 4 | loss: 0.0987478
	speed: 0.0686s/iter; left time: 1476.6372s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.1033720 Vali Loss: 0.1182980 Test Loss: 0.1268990
Validation loss decreased (0.119820 --> 0.118298).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1041800
	speed: 0.1203s/iter; left time: 2573.9606s
	iters: 200, epoch: 5 | loss: 0.0997182
	speed: 0.0686s/iter; left time: 1461.1075s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.61s
Steps: 224 | Train Loss: 0.1016296 Vali Loss: 0.1186564 Test Loss: 0.1272689
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0994423
	speed: 0.1177s/iter; left time: 2492.6164s
	iters: 200, epoch: 6 | loss: 0.1013170
	speed: 0.0686s/iter; left time: 1445.1050s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.1003724 Vali Loss: 0.1183913 Test Loss: 0.1269911
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0949351
	speed: 0.1187s/iter; left time: 2488.1407s
	iters: 200, epoch: 7 | loss: 0.1020790
	speed: 0.0686s/iter; left time: 1430.6857s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.64s
Steps: 224 | Train Loss: 0.0993798 Vali Loss: 0.1190878 Test Loss: 0.1270349
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0977151
	speed: 0.1187s/iter; left time: 2460.3847s
	iters: 200, epoch: 8 | loss: 0.0957019
	speed: 0.0685s/iter; left time: 1414.2560s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0985318 Vali Loss: 0.1188884 Test Loss: 0.1277997
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0936474
	speed: 0.1172s/iter; left time: 2403.2456s
	iters: 200, epoch: 9 | loss: 0.0981991
	speed: 0.0686s/iter; left time: 1400.0790s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0976707 Vali Loss: 0.1194609 Test Loss: 0.1275967
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0972934
	speed: 0.1186s/iter; left time: 2406.3673s
	iters: 200, epoch: 10 | loss: 0.0945473
	speed: 0.0685s/iter; left time: 1383.2447s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0969444 Vali Loss: 0.1195559 Test Loss: 0.1284629
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0940746
	speed: 0.1174s/iter; left time: 2355.8651s
	iters: 200, epoch: 11 | loss: 0.0956078
	speed: 0.0685s/iter; left time: 1367.2871s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0961737 Vali Loss: 0.1201853 Test Loss: 0.1291677
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0987268
	speed: 0.1186s/iter; left time: 2353.6459s
	iters: 200, epoch: 12 | loss: 0.0970581
	speed: 0.0686s/iter; left time: 1354.0385s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0955070 Vali Loss: 0.1205458 Test Loss: 0.1305023
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0955645
	speed: 0.1199s/iter; left time: 2351.4552s
	iters: 200, epoch: 13 | loss: 0.0935065
	speed: 0.0688s/iter; left time: 1343.4033s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.0948097 Vali Loss: 0.1206527 Test Loss: 0.1302494
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0937597
	speed: 0.1196s/iter; left time: 2318.3649s
	iters: 200, epoch: 14 | loss: 0.0950699
	speed: 0.0687s/iter; left time: 1325.8962s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.66s
Steps: 224 | Train Loss: 0.0941970 Vali Loss: 0.1206340 Test Loss: 0.1308207
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03608657419681549, rmse:0.1899646669626236, mae:0.12689906358718872, rse:0.6727032661437988
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1584245
	speed: 0.0702s/iter; left time: 1566.2615s
	iters: 200, epoch: 1 | loss: 0.1467351
	speed: 0.0685s/iter; left time: 1520.1897s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.1586937 Vali Loss: 0.1618374 Test Loss: 0.1740249
Validation loss decreased (inf --> 0.161837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1216307
	speed: 0.1204s/iter; left time: 2658.2494s
	iters: 200, epoch: 2 | loss: 0.1122305
	speed: 0.0686s/iter; left time: 1507.3866s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.1201242 Vali Loss: 0.1231106 Test Loss: 0.1303863
Validation loss decreased (0.161837 --> 0.123111).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1122966
	speed: 0.1206s/iter; left time: 2635.8908s
	iters: 200, epoch: 3 | loss: 0.1102855
	speed: 0.0690s/iter; left time: 1500.6184s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.1063538 Vali Loss: 0.1198373 Test Loss: 0.1280635
Validation loss decreased (0.123111 --> 0.119837).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1058941
	speed: 0.1215s/iter; left time: 2628.3113s
	iters: 200, epoch: 4 | loss: 0.1058972
	speed: 0.0693s/iter; left time: 1491.1055s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.74s
Steps: 224 | Train Loss: 0.1034576 Vali Loss: 0.1186996 Test Loss: 0.1267959
Validation loss decreased (0.119837 --> 0.118700).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1032637
	speed: 0.1213s/iter; left time: 2596.4239s
	iters: 200, epoch: 5 | loss: 0.0977947
	speed: 0.0689s/iter; left time: 1467.2466s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.62s
Steps: 224 | Train Loss: 0.1017239 Vali Loss: 0.1180575 Test Loss: 0.1264388
Validation loss decreased (0.118700 --> 0.118057).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1026086
	speed: 0.1203s/iter; left time: 2547.2596s
	iters: 200, epoch: 6 | loss: 0.1012904
	speed: 0.0688s/iter; left time: 1451.0542s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.63s
Steps: 224 | Train Loss: 0.1004415 Vali Loss: 0.1183241 Test Loss: 0.1264702
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0958061
	speed: 0.1198s/iter; left time: 2509.7809s
	iters: 200, epoch: 7 | loss: 0.0977835
	speed: 0.0686s/iter; left time: 1431.3901s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.62s
Steps: 224 | Train Loss: 0.0993413 Vali Loss: 0.1187937 Test Loss: 0.1269252
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0999358
	speed: 0.1198s/iter; left time: 2484.6183s
	iters: 200, epoch: 8 | loss: 0.0953013
	speed: 0.0685s/iter; left time: 1412.3509s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0984381 Vali Loss: 0.1188546 Test Loss: 0.1268269
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1026255
	speed: 0.1182s/iter; left time: 2424.0537s
	iters: 200, epoch: 9 | loss: 0.0962968
	speed: 0.0685s/iter; left time: 1398.1546s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0976047 Vali Loss: 0.1191079 Test Loss: 0.1277792
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0980087
	speed: 0.1189s/iter; left time: 2411.6126s
	iters: 200, epoch: 10 | loss: 0.0934485
	speed: 0.0686s/iter; left time: 1384.2603s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0967829 Vali Loss: 0.1193806 Test Loss: 0.1285394
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0947366
	speed: 0.1187s/iter; left time: 2380.3778s
	iters: 200, epoch: 11 | loss: 0.0951942
	speed: 0.0684s/iter; left time: 1366.1913s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.0961140 Vali Loss: 0.1194274 Test Loss: 0.1278090
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0942025
	speed: 0.1182s/iter; left time: 2344.6639s
	iters: 200, epoch: 12 | loss: 0.0922594
	speed: 0.0685s/iter; left time: 1351.1374s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0954150 Vali Loss: 0.1197382 Test Loss: 0.1294381
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0935657
	speed: 0.1185s/iter; left time: 2323.2796s
	iters: 200, epoch: 13 | loss: 0.0939974
	speed: 0.0685s/iter; left time: 1337.6053s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.0947779 Vali Loss: 0.1200896 Test Loss: 0.1289643
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0945294
	speed: 0.1196s/iter; left time: 2319.0838s
	iters: 200, epoch: 14 | loss: 0.0924002
	speed: 0.0691s/iter; left time: 1331.9483s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.0942263 Vali Loss: 0.1200542 Test Loss: 0.1291798
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0901726
	speed: 0.1184s/iter; left time: 2269.0467s
	iters: 200, epoch: 15 | loss: 0.0943275
	speed: 0.0685s/iter; left time: 1305.9293s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0936829 Vali Loss: 0.1200363 Test Loss: 0.1297049
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.036072153598070145, rmse:0.18992669880390167, mae:0.12643878161907196, rse:0.6725688576698303
Intermediate time for DE and pred_len 96: 00h:09m:17.83s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1549753
	speed: 0.0902s/iter; left time: 2002.2874s
	iters: 200, epoch: 1 | loss: 0.1490488
	speed: 0.0690s/iter; left time: 1525.3051s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.90s
Steps: 223 | Train Loss: 0.1608003 Vali Loss: 0.1642570 Test Loss: 0.1773680
Validation loss decreased (inf --> 0.164257).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1214390
	speed: 0.1193s/iter; left time: 2622.3446s
	iters: 200, epoch: 2 | loss: 0.1186189
	speed: 0.0694s/iter; left time: 1517.2573s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.82s
Steps: 223 | Train Loss: 0.1239646 Vali Loss: 0.1269783 Test Loss: 0.1358851
Validation loss decreased (0.164257 --> 0.126978).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1172384
	speed: 0.1224s/iter; left time: 2663.5086s
	iters: 200, epoch: 3 | loss: 0.1076551
	speed: 0.0691s/iter; left time: 1497.2145s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.68s
Steps: 223 | Train Loss: 0.1123203 Vali Loss: 0.1241126 Test Loss: 0.1345313
Validation loss decreased (0.126978 --> 0.124113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1120366
	speed: 0.1222s/iter; left time: 2630.9343s
	iters: 200, epoch: 4 | loss: 0.1102021
	speed: 0.0710s/iter; left time: 1521.1182s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.85s
Steps: 223 | Train Loss: 0.1094738 Vali Loss: 0.1237527 Test Loss: 0.1338149
Validation loss decreased (0.124113 --> 0.123753).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1105729
	speed: 0.1208s/iter; left time: 2574.8094s
	iters: 200, epoch: 5 | loss: 0.1061440
	speed: 0.0692s/iter; left time: 1468.5090s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.68s
Steps: 223 | Train Loss: 0.1077770 Vali Loss: 0.1238218 Test Loss: 0.1339873
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1095262
	speed: 0.1194s/iter; left time: 2517.6188s
	iters: 200, epoch: 6 | loss: 0.1042345
	speed: 0.0691s/iter; left time: 1451.1546s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.59s
Steps: 223 | Train Loss: 0.1063676 Vali Loss: 0.1235585 Test Loss: 0.1348094
Validation loss decreased (0.123753 --> 0.123558).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1005648
	speed: 0.1203s/iter; left time: 2509.2368s
	iters: 200, epoch: 7 | loss: 0.1043318
	speed: 0.0692s/iter; left time: 1436.6421s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.1052716 Vali Loss: 0.1240842 Test Loss: 0.1343348
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1054658
	speed: 0.1199s/iter; left time: 2474.3814s
	iters: 200, epoch: 8 | loss: 0.1059599
	speed: 0.0693s/iter; left time: 1423.1761s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.1042885 Vali Loss: 0.1244867 Test Loss: 0.1349613
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1038408
	speed: 0.1191s/iter; left time: 2431.4259s
	iters: 200, epoch: 9 | loss: 0.1002405
	speed: 0.0691s/iter; left time: 1403.3931s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.58s
Steps: 223 | Train Loss: 0.1032768 Vali Loss: 0.1248526 Test Loss: 0.1349830
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0949917
	speed: 0.1200s/iter; left time: 2424.1421s
	iters: 200, epoch: 10 | loss: 0.1013010
	speed: 0.0691s/iter; left time: 1388.8820s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.60s
Steps: 223 | Train Loss: 0.1024455 Vali Loss: 0.1252553 Test Loss: 0.1358568
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1012795
	speed: 0.1207s/iter; left time: 2410.1695s
	iters: 200, epoch: 11 | loss: 0.1041970
	speed: 0.0691s/iter; left time: 1372.8264s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.1017006 Vali Loss: 0.1258108 Test Loss: 0.1355357
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0993979
	speed: 0.1187s/iter; left time: 2344.6987s
	iters: 200, epoch: 12 | loss: 0.1057732
	speed: 0.0691s/iter; left time: 1358.4099s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.59s
Steps: 223 | Train Loss: 0.1009501 Vali Loss: 0.1261189 Test Loss: 0.1361108
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1020337
	speed: 0.1192s/iter; left time: 2328.0625s
	iters: 200, epoch: 13 | loss: 0.0951053
	speed: 0.0692s/iter; left time: 1343.7230s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.1002808 Vali Loss: 0.1269347 Test Loss: 0.1376551
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0966744
	speed: 0.1189s/iter; left time: 2294.7735s
	iters: 200, epoch: 14 | loss: 0.1020604
	speed: 0.0692s/iter; left time: 1328.3051s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.59s
Steps: 223 | Train Loss: 0.0994902 Vali Loss: 0.1274046 Test Loss: 0.1371823
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0936168
	speed: 0.1190s/iter; left time: 2270.1035s
	iters: 200, epoch: 15 | loss: 0.0942707
	speed: 0.0692s/iter; left time: 1312.5595s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.0989118 Vali Loss: 0.1278043 Test Loss: 0.1380977
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0972000
	speed: 0.1190s/iter; left time: 2244.6240s
	iters: 200, epoch: 16 | loss: 0.1007343
	speed: 0.0691s/iter; left time: 1296.1303s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.0983926 Vali Loss: 0.1279984 Test Loss: 0.1382564
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03949786722660065, rmse:0.19874070584774017, mae:0.1348094493150711, rse:0.7039555311203003
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1588997
	speed: 0.0746s/iter; left time: 1656.7000s
	iters: 200, epoch: 1 | loss: 0.1519462
	speed: 0.0692s/iter; left time: 1530.3420s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:16.02s
Steps: 223 | Train Loss: 0.1616140 Vali Loss: 0.1641594 Test Loss: 0.1773060
Validation loss decreased (inf --> 0.164159).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1188093
	speed: 0.1200s/iter; left time: 2638.3913s
	iters: 200, epoch: 2 | loss: 0.1157238
	speed: 0.0692s/iter; left time: 1513.1084s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.1240953 Vali Loss: 0.1277020 Test Loss: 0.1362368
Validation loss decreased (0.164159 --> 0.127702).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1087447
	speed: 0.1214s/iter; left time: 2640.9385s
	iters: 200, epoch: 3 | loss: 0.1102369
	speed: 0.0692s/iter; left time: 1498.9873s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.69s
Steps: 223 | Train Loss: 0.1123339 Vali Loss: 0.1243157 Test Loss: 0.1344908
Validation loss decreased (0.127702 --> 0.124316).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1040820
	speed: 0.1211s/iter; left time: 2607.6138s
	iters: 200, epoch: 4 | loss: 0.1147634
	speed: 0.0691s/iter; left time: 1481.7361s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.1095129 Vali Loss: 0.1235023 Test Loss: 0.1340304
Validation loss decreased (0.124316 --> 0.123502).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1062547
	speed: 0.1199s/iter; left time: 2554.4991s
	iters: 200, epoch: 5 | loss: 0.1056936
	speed: 0.0691s/iter; left time: 1464.8847s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.61s
Steps: 223 | Train Loss: 0.1076909 Vali Loss: 0.1228546 Test Loss: 0.1347191
Validation loss decreased (0.123502 --> 0.122855).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1069995
	speed: 0.1212s/iter; left time: 2556.1518s
	iters: 200, epoch: 6 | loss: 0.1051202
	speed: 0.0692s/iter; left time: 1451.3977s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.67s
Steps: 223 | Train Loss: 0.1062499 Vali Loss: 0.1232824 Test Loss: 0.1350140
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1089477
	speed: 0.1197s/iter; left time: 2497.3162s
	iters: 200, epoch: 7 | loss: 0.1064909
	speed: 0.0691s/iter; left time: 1434.7903s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.1049699 Vali Loss: 0.1233181 Test Loss: 0.1350354
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1094153
	speed: 0.1181s/iter; left time: 2437.8416s
	iters: 200, epoch: 8 | loss: 0.1034480
	speed: 0.0691s/iter; left time: 1419.8368s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.59s
Steps: 223 | Train Loss: 0.1039009 Vali Loss: 0.1239157 Test Loss: 0.1360014
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1056654
	speed: 0.1205s/iter; left time: 2459.8758s
	iters: 200, epoch: 9 | loss: 0.1067714
	speed: 0.0691s/iter; left time: 1403.6037s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.71s
Steps: 223 | Train Loss: 0.1028753 Vali Loss: 0.1241723 Test Loss: 0.1362410
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1025408
	speed: 0.1186s/iter; left time: 2394.6312s
	iters: 200, epoch: 10 | loss: 0.1066732
	speed: 0.0691s/iter; left time: 1388.5267s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.59s
Steps: 223 | Train Loss: 0.1018622 Vali Loss: 0.1249785 Test Loss: 0.1366130
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0992114
	speed: 0.1194s/iter; left time: 2384.6691s
	iters: 200, epoch: 11 | loss: 0.0965374
	speed: 0.0694s/iter; left time: 1378.8144s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.71s
Steps: 223 | Train Loss: 0.1008964 Vali Loss: 0.1254471 Test Loss: 0.1377246
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1030749
	speed: 0.1204s/iter; left time: 2378.5863s
	iters: 200, epoch: 12 | loss: 0.1003793
	speed: 0.0694s/iter; left time: 1364.0399s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.71s
Steps: 223 | Train Loss: 0.1000783 Vali Loss: 0.1260959 Test Loss: 0.1375503
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1018916
	speed: 0.1194s/iter; left time: 2330.8392s
	iters: 200, epoch: 13 | loss: 0.0990939
	speed: 0.0691s/iter; left time: 1342.6949s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.58s
Steps: 223 | Train Loss: 0.0993299 Vali Loss: 0.1267395 Test Loss: 0.1381821
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0967322
	speed: 0.1191s/iter; left time: 2298.5401s
	iters: 200, epoch: 14 | loss: 0.0990912
	speed: 0.0691s/iter; left time: 1327.2921s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.0985874 Vali Loss: 0.1270754 Test Loss: 0.1382004
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0972180
	speed: 0.1186s/iter; left time: 2263.4286s
	iters: 200, epoch: 15 | loss: 0.0954075
	speed: 0.0692s/iter; left time: 1312.4922s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.60s
Steps: 223 | Train Loss: 0.0980638 Vali Loss: 0.1273433 Test Loss: 0.1388922
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03948056325316429, rmse:0.19869716465473175, mae:0.13471922278404236, rse:0.7038013339042664
Intermediate time for DE and pred_len 168: 00h:10m:01.92sIntermediate time for DE: 00h:47m:34.52s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1333680
	speed: 0.0888s/iter; left time: 1980.9873s
	iters: 200, epoch: 1 | loss: 0.1306122
	speed: 0.0683s/iter; left time: 1515.7879s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.71s
Steps: 224 | Train Loss: 0.1369647 Vali Loss: 0.1359312 Test Loss: 0.1559038
Validation loss decreased (inf --> 0.135931).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0914119
	speed: 0.1171s/iter; left time: 2584.8234s
	iters: 200, epoch: 2 | loss: 0.0847467
	speed: 0.0681s/iter; left time: 1496.7916s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0923135 Vali Loss: 0.0929183 Test Loss: 0.1049555
Validation loss decreased (0.135931 --> 0.092918).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0800922
	speed: 0.1174s/iter; left time: 2565.4313s
	iters: 200, epoch: 3 | loss: 0.0858246
	speed: 0.0681s/iter; left time: 1480.4954s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.39s
Steps: 224 | Train Loss: 0.0791665 Vali Loss: 0.0912677 Test Loss: 0.1042033
Validation loss decreased (0.092918 --> 0.091268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0731348
	speed: 0.1169s/iter; left time: 2528.4876s
	iters: 200, epoch: 4 | loss: 0.0773949
	speed: 0.0681s/iter; left time: 1466.4106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0772773 Vali Loss: 0.0907929 Test Loss: 0.1035567
Validation loss decreased (0.091268 --> 0.090793).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0722893
	speed: 0.1167s/iter; left time: 2498.1122s
	iters: 200, epoch: 5 | loss: 0.0714369
	speed: 0.0681s/iter; left time: 1450.4836s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0761371 Vali Loss: 0.0896728 Test Loss: 0.1029171
Validation loss decreased (0.090793 --> 0.089673).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0774925
	speed: 0.1166s/iter; left time: 2468.8454s
	iters: 200, epoch: 6 | loss: 0.0720026
	speed: 0.0681s/iter; left time: 1435.3303s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0753417 Vali Loss: 0.0894101 Test Loss: 0.1027032
Validation loss decreased (0.089673 --> 0.089410).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0786619
	speed: 0.1173s/iter; left time: 2457.3267s
	iters: 200, epoch: 7 | loss: 0.0714008
	speed: 0.0681s/iter; left time: 1420.4751s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.47s
Steps: 224 | Train Loss: 0.0747525 Vali Loss: 0.0894637 Test Loss: 0.1024739
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0758944
	speed: 0.1173s/iter; left time: 2431.3588s
	iters: 200, epoch: 8 | loss: 0.0728859
	speed: 0.0681s/iter; left time: 1405.4593s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0743224 Vali Loss: 0.0890427 Test Loss: 0.1023517
Validation loss decreased (0.089410 --> 0.089043).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0774943
	speed: 0.1169s/iter; left time: 2396.5468s
	iters: 200, epoch: 9 | loss: 0.0751756
	speed: 0.0681s/iter; left time: 1389.0086s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0738270 Vali Loss: 0.0888496 Test Loss: 0.1026962
Validation loss decreased (0.089043 --> 0.088850).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0729855
	speed: 0.1173s/iter; left time: 2378.8617s
	iters: 200, epoch: 10 | loss: 0.0749506
	speed: 0.0681s/iter; left time: 1374.4904s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0735145 Vali Loss: 0.0884768 Test Loss: 0.1022387
Validation loss decreased (0.088850 --> 0.088477).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0703702
	speed: 0.1176s/iter; left time: 2359.1218s
	iters: 200, epoch: 11 | loss: 0.0753163
	speed: 0.0683s/iter; left time: 1362.9266s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.47s
Steps: 224 | Train Loss: 0.0731616 Vali Loss: 0.0884949 Test Loss: 0.1025441
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0697689
	speed: 0.1169s/iter; left time: 2319.5251s
	iters: 200, epoch: 12 | loss: 0.0717288
	speed: 0.0681s/iter; left time: 1343.7840s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0729910 Vali Loss: 0.0885811 Test Loss: 0.1023816
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0769481
	speed: 0.1164s/iter; left time: 2283.3286s
	iters: 200, epoch: 13 | loss: 0.0731467
	speed: 0.0683s/iter; left time: 1332.7806s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.50s
Steps: 224 | Train Loss: 0.0726464 Vali Loss: 0.0884182 Test Loss: 0.1019948
Validation loss decreased (0.088477 --> 0.088418).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0727538
	speed: 0.1170s/iter; left time: 2269.4322s
	iters: 200, epoch: 14 | loss: 0.0745294
	speed: 0.0680s/iter; left time: 1311.8460s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0724863 Vali Loss: 0.0884307 Test Loss: 0.1020039
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0743532
	speed: 0.1165s/iter; left time: 2231.7804s
	iters: 200, epoch: 15 | loss: 0.0696489
	speed: 0.0683s/iter; left time: 1301.7067s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0722417 Vali Loss: 0.0881380 Test Loss: 0.1021411
Validation loss decreased (0.088418 --> 0.088138).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0769881
	speed: 0.1170s/iter; left time: 2216.1289s
	iters: 200, epoch: 16 | loss: 0.0698817
	speed: 0.0680s/iter; left time: 1282.0659s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0721133 Vali Loss: 0.0881289 Test Loss: 0.1024259
Validation loss decreased (0.088138 --> 0.088129).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0659922
	speed: 0.1169s/iter; left time: 2188.1816s
	iters: 200, epoch: 17 | loss: 0.0688582
	speed: 0.0683s/iter; left time: 1270.8752s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0719713 Vali Loss: 0.0882590 Test Loss: 0.1025742
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0732577
	speed: 0.1169s/iter; left time: 2161.5882s
	iters: 200, epoch: 18 | loss: 0.0694320
	speed: 0.0681s/iter; left time: 1252.2084s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0717804 Vali Loss: 0.0882470 Test Loss: 0.1023746
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0679316
	speed: 0.1165s/iter; left time: 2127.4974s
	iters: 200, epoch: 19 | loss: 0.0690580
	speed: 0.0681s/iter; left time: 1237.2576s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0716955 Vali Loss: 0.0879507 Test Loss: 0.1025331
Validation loss decreased (0.088129 --> 0.087951).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0747656
	speed: 0.1189s/iter; left time: 2144.7055s
	iters: 200, epoch: 20 | loss: 0.0723538
	speed: 0.0683s/iter; left time: 1225.3035s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0715595 Vali Loss: 0.0880102 Test Loss: 0.1024311
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0675295
	speed: 0.1172s/iter; left time: 2088.5393s
	iters: 200, epoch: 21 | loss: 0.0754626
	speed: 0.0683s/iter; left time: 1210.4040s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0714036 Vali Loss: 0.0880359 Test Loss: 0.1027101
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0747559
	speed: 0.1183s/iter; left time: 2081.4978s
	iters: 200, epoch: 22 | loss: 0.0735652
	speed: 0.0686s/iter; left time: 1199.7925s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0714004 Vali Loss: 0.0880514 Test Loss: 0.1024467
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0726551
	speed: 0.1188s/iter; left time: 2064.5593s
	iters: 200, epoch: 23 | loss: 0.0736888
	speed: 0.0685s/iter; left time: 1183.3531s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0712337 Vali Loss: 0.0878681 Test Loss: 0.1021830
Validation loss decreased (0.087951 --> 0.087868).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0731569
	speed: 0.1173s/iter; left time: 2011.1946s
	iters: 200, epoch: 24 | loss: 0.0654764
	speed: 0.0682s/iter; left time: 1163.4008s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0711718 Vali Loss: 0.0880312 Test Loss: 0.1023722
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0753586
	speed: 0.1162s/iter; left time: 1966.9141s
	iters: 200, epoch: 25 | loss: 0.0715960
	speed: 0.0683s/iter; left time: 1149.0157s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:15.49s
Steps: 224 | Train Loss: 0.0711529 Vali Loss: 0.0877999 Test Loss: 0.1024489
Validation loss decreased (0.087868 --> 0.087800).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0729085
	speed: 0.1171s/iter; left time: 1955.7698s
	iters: 200, epoch: 26 | loss: 0.0663390
	speed: 0.0681s/iter; left time: 1130.9998s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0709616 Vali Loss: 0.0879779 Test Loss: 0.1026313
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0700807
	speed: 0.1165s/iter; left time: 1919.8403s
	iters: 200, epoch: 27 | loss: 0.0744579
	speed: 0.0681s/iter; left time: 1115.0183s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0710200 Vali Loss: 0.0879474 Test Loss: 0.1024743
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0730878
	speed: 0.1156s/iter; left time: 1878.7285s
	iters: 200, epoch: 28 | loss: 0.0696250
	speed: 0.0681s/iter; left time: 1099.6188s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:15.39s
Steps: 224 | Train Loss: 0.0708943 Vali Loss: 0.0878046 Test Loss: 0.1025338
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0729829
	speed: 0.1160s/iter; left time: 1859.3250s
	iters: 200, epoch: 29 | loss: 0.0762085
	speed: 0.0681s/iter; left time: 1084.8104s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0708806 Vali Loss: 0.0878422 Test Loss: 0.1025320
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0690114
	speed: 0.1164s/iter; left time: 1840.2345s
	iters: 200, epoch: 30 | loss: 0.0681642
	speed: 0.0681s/iter; left time: 1069.1820s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0708473 Vali Loss: 0.0879095 Test Loss: 0.1024646
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0675929
	speed: 0.1159s/iter; left time: 1805.7393s
	iters: 200, epoch: 31 | loss: 0.0703068
	speed: 0.0683s/iter; left time: 1057.6975s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0707743 Vali Loss: 0.0877124 Test Loss: 0.1025452
Validation loss decreased (0.087800 --> 0.087712).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0713335
	speed: 0.1181s/iter; left time: 1813.2451s
	iters: 200, epoch: 32 | loss: 0.0659095
	speed: 0.0681s/iter; left time: 1038.5443s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0708065 Vali Loss: 0.0878161 Test Loss: 0.1026590
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0685042
	speed: 0.1154s/iter; left time: 1746.8283s
	iters: 200, epoch: 33 | loss: 0.0746160
	speed: 0.0682s/iter; left time: 1025.0143s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0707395 Vali Loss: 0.0878438 Test Loss: 0.1025891
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0687872
	speed: 0.1167s/iter; left time: 1739.5423s
	iters: 200, epoch: 34 | loss: 0.0705506
	speed: 0.0681s/iter; left time: 1008.0078s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0707021 Vali Loss: 0.0877845 Test Loss: 0.1025829
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0705029
	speed: 0.1164s/iter; left time: 1710.0465s
	iters: 200, epoch: 35 | loss: 0.0674875
	speed: 0.0681s/iter; left time: 993.0985s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0707380 Vali Loss: 0.0878009 Test Loss: 0.1025980
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0722462
	speed: 0.1161s/iter; left time: 1678.9166s
	iters: 200, epoch: 36 | loss: 0.0744660
	speed: 0.0681s/iter; left time: 977.9857s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0707073 Vali Loss: 0.0878338 Test Loss: 0.1025811
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0681205
	speed: 0.1160s/iter; left time: 1652.0876s
	iters: 200, epoch: 37 | loss: 0.0667671
	speed: 0.0681s/iter; left time: 962.6867s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0706651 Vali Loss: 0.0877007 Test Loss: 0.1025965
Validation loss decreased (0.087712 --> 0.087701).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0699443
	speed: 0.1170s/iter; left time: 1639.0840s
	iters: 200, epoch: 38 | loss: 0.0756920
	speed: 0.0681s/iter; left time: 947.3254s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0705406 Vali Loss: 0.0878251 Test Loss: 0.1026505
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0680239
	speed: 0.1161s/iter; left time: 1600.7003s
	iters: 200, epoch: 39 | loss: 0.0739465
	speed: 0.0683s/iter; left time: 935.4841s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.45s
Steps: 224 | Train Loss: 0.0705888 Vali Loss: 0.0879452 Test Loss: 0.1026051
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0695183
	speed: 0.1158s/iter; left time: 1571.4075s
	iters: 200, epoch: 40 | loss: 0.0666538
	speed: 0.0681s/iter; left time: 917.2073s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0706275 Vali Loss: 0.0877649 Test Loss: 0.1026028
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0692699
	speed: 0.1162s/iter; left time: 1549.9471s
	iters: 200, epoch: 41 | loss: 0.0674599
	speed: 0.0685s/iter; left time: 906.4750s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0706151 Vali Loss: 0.0878319 Test Loss: 0.1026039
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0714812
	speed: 0.1163s/iter; left time: 1525.8277s
	iters: 200, epoch: 42 | loss: 0.0698971
	speed: 0.0681s/iter; left time: 886.1202s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0706012 Vali Loss: 0.0877543 Test Loss: 0.1026634
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0722987
	speed: 0.1180s/iter; left time: 1521.8007s
	iters: 200, epoch: 43 | loss: 0.0705802
	speed: 0.0681s/iter; left time: 871.2431s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0705847 Vali Loss: 0.0877952 Test Loss: 0.1026460
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0699486
	speed: 0.1177s/iter; left time: 1490.5583s
	iters: 200, epoch: 44 | loss: 0.0705507
	speed: 0.0682s/iter; left time: 857.1900s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0705450 Vali Loss: 0.0878588 Test Loss: 0.1026352
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0747878
	speed: 0.1161s/iter; left time: 1444.6048s
	iters: 200, epoch: 45 | loss: 0.0717317
	speed: 0.0682s/iter; left time: 841.6014s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:15.42s
Steps: 224 | Train Loss: 0.0705373 Vali Loss: 0.0876339 Test Loss: 0.1025996
Validation loss decreased (0.087701 --> 0.087634).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0752051
	speed: 0.1168s/iter; left time: 1427.5335s
	iters: 200, epoch: 46 | loss: 0.0732657
	speed: 0.0683s/iter; left time: 827.7650s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0705972 Vali Loss: 0.0877636 Test Loss: 0.1026519
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0670457
	speed: 0.1167s/iter; left time: 1400.1929s
	iters: 200, epoch: 47 | loss: 0.0690192
	speed: 0.0682s/iter; left time: 810.9715s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0705293 Vali Loss: 0.0877585 Test Loss: 0.1026266
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0698591
	speed: 0.1162s/iter; left time: 1368.0350s
	iters: 200, epoch: 48 | loss: 0.0677563
	speed: 0.0681s/iter; left time: 794.9300s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:15.39s
Steps: 224 | Train Loss: 0.0705553 Vali Loss: 0.0878443 Test Loss: 0.1026310
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0700425
	speed: 0.1159s/iter; left time: 1338.1389s
	iters: 200, epoch: 49 | loss: 0.0663642
	speed: 0.0683s/iter; left time: 781.7459s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0705249 Vali Loss: 0.0877746 Test Loss: 0.1026161
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0729307
	speed: 0.1162s/iter; left time: 1316.4437s
	iters: 200, epoch: 50 | loss: 0.0685636
	speed: 0.0683s/iter; left time: 767.1826s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:15.44s
Steps: 224 | Train Loss: 0.0705094 Vali Loss: 0.0878694 Test Loss: 0.1026199
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0732157
	speed: 0.1163s/iter; left time: 1291.0775s
	iters: 200, epoch: 51 | loss: 0.0650010
	speed: 0.0682s/iter; left time: 749.8043s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:15.41s
Steps: 224 | Train Loss: 0.0705308 Vali Loss: 0.0877515 Test Loss: 0.1026408
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0707113
	speed: 0.1155s/iter; left time: 1256.6665s
	iters: 200, epoch: 52 | loss: 0.0763716
	speed: 0.0681s/iter; left time: 733.4052s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:15.38s
Steps: 224 | Train Loss: 0.0705010 Vali Loss: 0.0877244 Test Loss: 0.1026250
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0712100
	speed: 0.1159s/iter; left time: 1235.0412s
	iters: 200, epoch: 53 | loss: 0.0675191
	speed: 0.0681s/iter; left time: 718.5530s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:15.40s
Steps: 224 | Train Loss: 0.0705063 Vali Loss: 0.0877397 Test Loss: 0.1026659
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0707961
	speed: 0.1174s/iter; left time: 1224.0732s
	iters: 200, epoch: 54 | loss: 0.0701372
	speed: 0.0685s/iter; left time: 707.8437s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0704876 Vali Loss: 0.0878127 Test Loss: 0.1026263
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0696509
	speed: 0.1187s/iter; left time: 1211.0421s
	iters: 200, epoch: 55 | loss: 0.0660280
	speed: 0.0685s/iter; left time: 692.6424s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:15.63s
Steps: 224 | Train Loss: 0.0704608 Vali Loss: 0.0878102 Test Loss: 0.1026641
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02609824575483799, rmse:0.16154950857162476, mae:0.10259955376386642, rse:0.5573000311851501
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1350485
	speed: 0.0704s/iter; left time: 1569.2453s
	iters: 200, epoch: 1 | loss: 0.1283367
	speed: 0.0686s/iter; left time: 1523.3137s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.1371332 Vali Loss: 0.1359186 Test Loss: 0.1564243
Validation loss decreased (inf --> 0.135919).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0985610
	speed: 0.1199s/iter; left time: 2648.1026s
	iters: 200, epoch: 2 | loss: 0.0824623
	speed: 0.0685s/iter; left time: 1504.5974s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0930008 Vali Loss: 0.0932679 Test Loss: 0.1046689
Validation loss decreased (0.135919 --> 0.093268).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804342
	speed: 0.1198s/iter; left time: 2618.8854s
	iters: 200, epoch: 3 | loss: 0.0779750
	speed: 0.0685s/iter; left time: 1490.5161s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0793289 Vali Loss: 0.0914860 Test Loss: 0.1031895
Validation loss decreased (0.093268 --> 0.091486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0806159
	speed: 0.1188s/iter; left time: 2570.4593s
	iters: 200, epoch: 4 | loss: 0.0749596
	speed: 0.0685s/iter; left time: 1474.1067s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0774207 Vali Loss: 0.0906169 Test Loss: 0.1029897
Validation loss decreased (0.091486 --> 0.090617).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0734674
	speed: 0.1187s/iter; left time: 2540.1744s
	iters: 200, epoch: 5 | loss: 0.0709467
	speed: 0.0682s/iter; left time: 1453.7432s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.50s
Steps: 224 | Train Loss: 0.0763811 Vali Loss: 0.0900442 Test Loss: 0.1027449
Validation loss decreased (0.090617 --> 0.090044).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0769009
	speed: 0.1191s/iter; left time: 2522.2977s
	iters: 200, epoch: 6 | loss: 0.0798781
	speed: 0.0687s/iter; left time: 1447.9987s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.62s
Steps: 224 | Train Loss: 0.0755034 Vali Loss: 0.0893161 Test Loss: 0.1025999
Validation loss decreased (0.090044 --> 0.089316).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0748013
	speed: 0.1195s/iter; left time: 2503.5218s
	iters: 200, epoch: 7 | loss: 0.0699343
	speed: 0.0685s/iter; left time: 1428.1544s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0749898 Vali Loss: 0.0891517 Test Loss: 0.1022313
Validation loss decreased (0.089316 --> 0.089152).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0731926
	speed: 0.1191s/iter; left time: 2469.1667s
	iters: 200, epoch: 8 | loss: 0.0763248
	speed: 0.0681s/iter; left time: 1406.0134s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.51s
Steps: 224 | Train Loss: 0.0744346 Vali Loss: 0.0888427 Test Loss: 0.1025807
Validation loss decreased (0.089152 --> 0.088843).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0749135
	speed: 0.1190s/iter; left time: 2439.6769s
	iters: 200, epoch: 9 | loss: 0.0725394
	speed: 0.0686s/iter; left time: 1399.2083s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0740005 Vali Loss: 0.0889117 Test Loss: 0.1022311
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0735895
	speed: 0.1182s/iter; left time: 2398.2413s
	iters: 200, epoch: 10 | loss: 0.0685794
	speed: 0.0685s/iter; left time: 1381.8185s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0736818 Vali Loss: 0.0882763 Test Loss: 0.1021831
Validation loss decreased (0.088843 --> 0.088276).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0686587
	speed: 0.1188s/iter; left time: 2383.4469s
	iters: 200, epoch: 11 | loss: 0.0753800
	speed: 0.0685s/iter; left time: 1366.8125s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0733869 Vali Loss: 0.0885128 Test Loss: 0.1024305
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0699067
	speed: 0.1183s/iter; left time: 2347.2859s
	iters: 200, epoch: 12 | loss: 0.0729937
	speed: 0.0685s/iter; left time: 1352.1502s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0730673 Vali Loss: 0.0883502 Test Loss: 0.1023613
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0723066
	speed: 0.1181s/iter; left time: 2317.2114s
	iters: 200, epoch: 13 | loss: 0.0696954
	speed: 0.0685s/iter; left time: 1337.5893s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0728639 Vali Loss: 0.0880580 Test Loss: 0.1021787
Validation loss decreased (0.088276 --> 0.088058).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0684518
	speed: 0.1194s/iter; left time: 2315.5890s
	iters: 200, epoch: 14 | loss: 0.0723450
	speed: 0.0685s/iter; left time: 1321.6037s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0726623 Vali Loss: 0.0878234 Test Loss: 0.1023084
Validation loss decreased (0.088058 --> 0.087823).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0754770
	speed: 0.1187s/iter; left time: 2273.9481s
	iters: 200, epoch: 15 | loss: 0.0705056
	speed: 0.0685s/iter; left time: 1305.0393s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0723844 Vali Loss: 0.0882556 Test Loss: 0.1023628
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0741688
	speed: 0.1181s/iter; left time: 2237.4073s
	iters: 200, epoch: 16 | loss: 0.0731742
	speed: 0.0687s/iter; left time: 1293.9790s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.60s
Steps: 224 | Train Loss: 0.0722727 Vali Loss: 0.0880262 Test Loss: 0.1020618
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0704471
	speed: 0.1202s/iter; left time: 2249.0798s
	iters: 200, epoch: 17 | loss: 0.0648888
	speed: 0.0688s/iter; left time: 1281.3249s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:18.98s
Steps: 224 | Train Loss: 0.0721046 Vali Loss: 0.0878210 Test Loss: 0.1022013
Validation loss decreased (0.087823 --> 0.087821).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0698321
	speed: 0.3378s/iter; left time: 6246.4706s
	iters: 200, epoch: 18 | loss: 0.0738711
	speed: 0.0691s/iter; left time: 1271.8617s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:16.22s
Steps: 224 | Train Loss: 0.0719306 Vali Loss: 0.0880854 Test Loss: 0.1021067
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0720899
	speed: 0.1193s/iter; left time: 2178.8884s
	iters: 200, epoch: 19 | loss: 0.0801290
	speed: 0.0685s/iter; left time: 1244.6685s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:15.60s
Steps: 224 | Train Loss: 0.0718406 Vali Loss: 0.0880833 Test Loss: 0.1023844
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0720547
	speed: 0.1183s/iter; left time: 2135.5429s
	iters: 200, epoch: 20 | loss: 0.0702580
	speed: 0.0683s/iter; left time: 1225.7391s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.52s
Steps: 224 | Train Loss: 0.0717006 Vali Loss: 0.0878402 Test Loss: 0.1021511
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0730690
	speed: 0.1192s/iter; left time: 2124.3285s
	iters: 200, epoch: 21 | loss: 0.0687931
	speed: 0.0683s/iter; left time: 1210.8138s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.0716337 Vali Loss: 0.0878857 Test Loss: 0.1023159
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0694852
	speed: 0.1197s/iter; left time: 2106.9395s
	iters: 200, epoch: 22 | loss: 0.0696693
	speed: 0.0685s/iter; left time: 1198.5063s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:15.61s
Steps: 224 | Train Loss: 0.0714591 Vali Loss: 0.0878322 Test Loss: 0.1021257
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0696523
	speed: 0.1184s/iter; left time: 2057.1705s
	iters: 200, epoch: 23 | loss: 0.0666929
	speed: 0.0687s/iter; left time: 1186.2567s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0714148 Vali Loss: 0.0878777 Test Loss: 0.1024495
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0707410
	speed: 0.1182s/iter; left time: 2027.5832s
	iters: 200, epoch: 24 | loss: 0.0696989
	speed: 0.0686s/iter; left time: 1168.7189s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.0713207 Vali Loss: 0.0879480 Test Loss: 0.1023523
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0666071
	speed: 0.1201s/iter; left time: 2033.0903s
	iters: 200, epoch: 25 | loss: 0.0697921
	speed: 0.0686s/iter; left time: 1154.5325s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:15.62s
Steps: 224 | Train Loss: 0.0712574 Vali Loss: 0.0878814 Test Loss: 0.1024345
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0692760
	speed: 0.1190s/iter; left time: 1986.8559s
	iters: 200, epoch: 26 | loss: 0.0700209
	speed: 0.0682s/iter; left time: 1132.8665s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0711826 Vali Loss: 0.0878382 Test Loss: 0.1024064
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0691675
	speed: 0.1180s/iter; left time: 1944.3105s
	iters: 200, epoch: 27 | loss: 0.0724144
	speed: 0.0686s/iter; left time: 1123.7788s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0711065 Vali Loss: 0.0878209 Test Loss: 0.1023688
Validation loss decreased (0.087821 --> 0.087821).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0745372
	speed: 0.1227s/iter; left time: 1994.7667s
	iters: 200, epoch: 28 | loss: 0.0677864
	speed: 0.0685s/iter; left time: 1107.1991s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:15.61s
Steps: 224 | Train Loss: 0.0710921 Vali Loss: 0.0877655 Test Loss: 0.1024723
Validation loss decreased (0.087821 --> 0.087765).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0683585
	speed: 0.1193s/iter; left time: 1912.0059s
	iters: 200, epoch: 29 | loss: 0.0687528
	speed: 0.0683s/iter; left time: 1088.0542s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0710071 Vali Loss: 0.0878820 Test Loss: 0.1025295
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0688418
	speed: 0.1184s/iter; left time: 1872.0666s
	iters: 200, epoch: 30 | loss: 0.0696204
	speed: 0.0684s/iter; left time: 1074.3598s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.0709781 Vali Loss: 0.0878687 Test Loss: 0.1024631
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0681575
	speed: 0.1190s/iter; left time: 1853.9655s
	iters: 200, epoch: 31 | loss: 0.0685834
	speed: 0.0681s/iter; left time: 1054.3868s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0709512 Vali Loss: 0.0877548 Test Loss: 0.1024851
Validation loss decreased (0.087765 --> 0.087755).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0706097
	speed: 0.1185s/iter; left time: 1819.6040s
	iters: 200, epoch: 32 | loss: 0.0708976
	speed: 0.0684s/iter; left time: 1043.1416s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0709215 Vali Loss: 0.0878163 Test Loss: 0.1024806
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0749903
	speed: 0.1187s/iter; left time: 1796.5819s
	iters: 200, epoch: 33 | loss: 0.0708938
	speed: 0.0694s/iter; left time: 1043.9415s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:15.67s
Steps: 224 | Train Loss: 0.0708929 Vali Loss: 0.0878683 Test Loss: 0.1023930
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0706175
	speed: 0.1176s/iter; left time: 1753.4913s
	iters: 200, epoch: 34 | loss: 0.0725679
	speed: 0.0681s/iter; left time: 1008.2804s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:15.47s
Steps: 224 | Train Loss: 0.0708099 Vali Loss: 0.0878590 Test Loss: 0.1025046
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0732726
	speed: 0.1176s/iter; left time: 1726.7687s
	iters: 200, epoch: 35 | loss: 0.0754984
	speed: 0.0681s/iter; left time: 993.2986s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:16.92s
Steps: 224 | Train Loss: 0.0708670 Vali Loss: 0.0877823 Test Loss: 0.1024617
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0774366
	speed: 0.2177s/iter; left time: 3147.5712s
	iters: 200, epoch: 36 | loss: 0.0740482
	speed: 0.0682s/iter; left time: 978.7392s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:16.04s
Steps: 224 | Train Loss: 0.0708381 Vali Loss: 0.0878741 Test Loss: 0.1024432
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0760511
	speed: 0.1696s/iter; left time: 2415.1887s
	iters: 200, epoch: 37 | loss: 0.0682933
	speed: 0.1863s/iter; left time: 2633.1164s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:35.32s
Steps: 224 | Train Loss: 0.0707611 Vali Loss: 0.0878462 Test Loss: 0.1025407
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0697511
	speed: 0.1913s/iter; left time: 2680.5915s
	iters: 200, epoch: 38 | loss: 0.0706254
	speed: 0.0718s/iter; left time: 998.8826s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:15.93s
Steps: 224 | Train Loss: 0.0708227 Vali Loss: 0.0878476 Test Loss: 0.1025691
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0684740
	speed: 0.1177s/iter; left time: 1622.8936s
	iters: 200, epoch: 39 | loss: 0.0708653
	speed: 0.0680s/iter; left time: 931.4243s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.46s
Steps: 224 | Train Loss: 0.0707966 Vali Loss: 0.0878813 Test Loss: 0.1024478
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0717423
	speed: 0.1179s/iter; left time: 1599.3272s
	iters: 200, epoch: 40 | loss: 0.0685868
	speed: 0.0680s/iter; left time: 915.0396s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:15.48s
Steps: 224 | Train Loss: 0.0707911 Vali Loss: 0.0877578 Test Loss: 0.1024289
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0677724
	speed: 0.1179s/iter; left time: 1573.0796s
	iters: 200, epoch: 41 | loss: 0.0708079
	speed: 0.0687s/iter; left time: 910.0566s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.0707299 Vali Loss: 0.0878519 Test Loss: 0.1024545
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025986187160015106, rmse:0.1612023115158081, mae:0.10248507559299469, rse:0.5561022758483887
Intermediate time for GB and pred_len 24: 00h:30m:54.01s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1405991
	speed: 0.0894s/iter; left time: 1994.2111s
	iters: 200, epoch: 1 | loss: 0.1340275
	speed: 0.0687s/iter; left time: 1524.5582s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.81s
Steps: 224 | Train Loss: 0.1448432 Vali Loss: 0.1478213 Test Loss: 0.1730928
Validation loss decreased (inf --> 0.147821).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1138117
	speed: 0.1213s/iter; left time: 2678.6025s
	iters: 200, epoch: 2 | loss: 0.1045887
	speed: 0.0686s/iter; left time: 1507.6504s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.60s
Steps: 224 | Train Loss: 0.1130604 Vali Loss: 0.1190637 Test Loss: 0.1405119
Validation loss decreased (0.147821 --> 0.119064).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1055495
	speed: 0.1203s/iter; left time: 2627.9081s
	iters: 200, epoch: 3 | loss: 0.0997061
	speed: 0.0686s/iter; left time: 1492.3047s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.1032594 Vali Loss: 0.1175504 Test Loss: 0.1404777
Validation loss decreased (0.119064 --> 0.117550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0996446
	speed: 0.1195s/iter; left time: 2583.9106s
	iters: 200, epoch: 4 | loss: 0.1002228
	speed: 0.0687s/iter; left time: 1479.2544s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.1012278 Vali Loss: 0.1170777 Test Loss: 0.1409550
Validation loss decreased (0.117550 --> 0.117078).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1005896
	speed: 0.1204s/iter; left time: 2577.1258s
	iters: 200, epoch: 5 | loss: 0.1019444
	speed: 0.0705s/iter; left time: 1501.2868s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.88s
Steps: 224 | Train Loss: 0.0999217 Vali Loss: 0.1165160 Test Loss: 0.1420076
Validation loss decreased (0.117078 --> 0.116516).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0982100
	speed: 0.1232s/iter; left time: 2609.0948s
	iters: 200, epoch: 6 | loss: 0.1017919
	speed: 0.0685s/iter; left time: 1444.9723s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.65s
Steps: 224 | Train Loss: 0.0987352 Vali Loss: 0.1165895 Test Loss: 0.1424067
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0939507
	speed: 0.1228s/iter; left time: 2573.0127s
	iters: 200, epoch: 7 | loss: 0.1043875
	speed: 0.0686s/iter; left time: 1430.6316s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.66s
Steps: 224 | Train Loss: 0.0976624 Vali Loss: 0.1166685 Test Loss: 0.1426034
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0960657
	speed: 0.1201s/iter; left time: 2490.8351s
	iters: 200, epoch: 8 | loss: 0.0936981
	speed: 0.0686s/iter; left time: 1415.1463s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.54s
Steps: 224 | Train Loss: 0.0965947 Vali Loss: 0.1169973 Test Loss: 0.1427235
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0966231
	speed: 0.1194s/iter; left time: 2448.7314s
	iters: 200, epoch: 9 | loss: 0.0959772
	speed: 0.0687s/iter; left time: 1401.3378s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0956147 Vali Loss: 0.1171770 Test Loss: 0.1436713
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0897570
	speed: 0.1188s/iter; left time: 2410.0226s
	iters: 200, epoch: 10 | loss: 0.0925299
	speed: 0.0685s/iter; left time: 1382.5087s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.55s
Steps: 224 | Train Loss: 0.0947032 Vali Loss: 0.1173011 Test Loss: 0.1430885
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0937624
	speed: 0.1179s/iter; left time: 2365.5809s
	iters: 200, epoch: 11 | loss: 0.0942345
	speed: 0.0687s/iter; left time: 1371.6999s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0939199 Vali Loss: 0.1177284 Test Loss: 0.1446626
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0962773
	speed: 0.1184s/iter; left time: 2348.8117s
	iters: 200, epoch: 12 | loss: 0.0923434
	speed: 0.0687s/iter; left time: 1355.4154s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.53s
Steps: 224 | Train Loss: 0.0932281 Vali Loss: 0.1179432 Test Loss: 0.1441796
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0915588
	speed: 0.1190s/iter; left time: 2334.1176s
	iters: 200, epoch: 13 | loss: 0.0947063
	speed: 0.0685s/iter; left time: 1336.9325s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.56s
Steps: 224 | Train Loss: 0.0925696 Vali Loss: 0.1184001 Test Loss: 0.1446941
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0948453
	speed: 0.1207s/iter; left time: 2340.5900s
	iters: 200, epoch: 14 | loss: 0.0923975
	speed: 0.0688s/iter; left time: 1327.2040s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.68s
Steps: 224 | Train Loss: 0.0918646 Vali Loss: 0.1180691 Test Loss: 0.1447409
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0889596
	speed: 0.1223s/iter; left time: 2343.2314s
	iters: 200, epoch: 15 | loss: 0.0921152
	speed: 0.0687s/iter; left time: 1309.3565s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.57s
Steps: 224 | Train Loss: 0.0913107 Vali Loss: 0.1185684 Test Loss: 0.1451798
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04291575402021408, rmse:0.20716117322444916, mae:0.14200760424137115, rse:0.7163922190666199
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1487318
	speed: 0.0704s/iter; left time: 1570.4113s
	iters: 200, epoch: 1 | loss: 0.1370086
	speed: 0.0686s/iter; left time: 1522.9221s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.58s
Steps: 224 | Train Loss: 0.1440499 Vali Loss: 0.1468293 Test Loss: 0.1719950
Validation loss decreased (inf --> 0.146829).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1138063
	speed: 0.1286s/iter; left time: 2838.4423s
	iters: 200, epoch: 2 | loss: 0.1064841
	speed: 0.1335s/iter; left time: 2934.2487s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:23.05s
Steps: 224 | Train Loss: 0.1139268 Vali Loss: 0.1199203 Test Loss: 0.1413460
Validation loss decreased (0.146829 --> 0.119920).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1038082
	speed: 0.1272s/iter; left time: 2780.0861s
	iters: 200, epoch: 3 | loss: 0.1057726
	speed: 0.0703s/iter; left time: 1529.3331s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:16.10s
Steps: 224 | Train Loss: 0.1035078 Vali Loss: 0.1172815 Test Loss: 0.1411853
Validation loss decreased (0.119920 --> 0.117282).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1052683
	speed: 0.2809s/iter; left time: 6075.1382s
	iters: 200, epoch: 4 | loss: 0.0991758
	speed: 0.2453s/iter; left time: 5281.7273s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:49.55s
Steps: 224 | Train Loss: 0.1012741 Vali Loss: 0.1170539 Test Loss: 0.1416775
Validation loss decreased (0.117282 --> 0.117054).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1004815
	speed: 0.8175s/iter; left time: 17498.1451s
	iters: 200, epoch: 5 | loss: 0.0980172
	speed: 0.2404s/iter; left time: 5122.3728s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:56.31s
Steps: 224 | Train Loss: 0.0997677 Vali Loss: 0.1162018 Test Loss: 0.1421025
Validation loss decreased (0.117054 --> 0.116202).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0961827
	speed: 0.8096s/iter; left time: 17147.9534s
	iters: 200, epoch: 6 | loss: 0.0999542
	speed: 0.2562s/iter; left time: 5400.9579s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:59.70s
Steps: 224 | Train Loss: 0.0984421 Vali Loss: 0.1164734 Test Loss: 0.1426005
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0981211
	speed: 0.6218s/iter; left time: 13030.5121s
	iters: 200, epoch: 7 | loss: 0.0941548
	speed: 0.0852s/iter; left time: 1776.4255s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:23.08s
Steps: 224 | Train Loss: 0.0972705 Vali Loss: 0.1162785 Test Loss: 0.1422600
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0962675
	speed: 0.1340s/iter; left time: 2778.7869s
	iters: 200, epoch: 8 | loss: 0.0931595
	speed: 0.0697s/iter; left time: 1438.0531s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.91s
Steps: 224 | Train Loss: 0.0962770 Vali Loss: 0.1164722 Test Loss: 0.1422352
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0926272
	speed: 0.1242s/iter; left time: 2546.9365s
	iters: 200, epoch: 9 | loss: 0.0948652
	speed: 0.0695s/iter; left time: 1418.0947s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.88s
Steps: 224 | Train Loss: 0.0952981 Vali Loss: 0.1172631 Test Loss: 0.1434910
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0920814
	speed: 0.1228s/iter; left time: 2491.7438s
	iters: 200, epoch: 10 | loss: 0.0969522
	speed: 0.0693s/iter; left time: 1398.8327s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.78s
Steps: 224 | Train Loss: 0.0944917 Vali Loss: 0.1168175 Test Loss: 0.1432077
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0946180
	speed: 0.1229s/iter; left time: 2465.5769s
	iters: 200, epoch: 11 | loss: 0.0920481
	speed: 0.0695s/iter; left time: 1387.4037s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.81s
Steps: 224 | Train Loss: 0.0936815 Vali Loss: 0.1166289 Test Loss: 0.1433958
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0943805
	speed: 0.1222s/iter; left time: 2423.8897s
	iters: 200, epoch: 12 | loss: 0.0935987
	speed: 0.0692s/iter; left time: 1364.9152s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.74s
Steps: 224 | Train Loss: 0.0930455 Vali Loss: 0.1179340 Test Loss: 0.1440605
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0935798
	speed: 0.1215s/iter; left time: 2383.7646s
	iters: 200, epoch: 13 | loss: 0.0908417
	speed: 0.0690s/iter; left time: 1347.2970s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.72s
Steps: 224 | Train Loss: 0.0923338 Vali Loss: 0.1177619 Test Loss: 0.1443216
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0884786
	speed: 0.1203s/iter; left time: 2333.2899s
	iters: 200, epoch: 14 | loss: 0.0921750
	speed: 0.0691s/iter; left time: 1333.2349s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.69s
Steps: 224 | Train Loss: 0.0917843 Vali Loss: 0.1178600 Test Loss: 0.1436017
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0891715
	speed: 0.1201s/iter; left time: 2301.0858s
	iters: 200, epoch: 15 | loss: 0.0895614
	speed: 0.0689s/iter; left time: 1313.2524s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.63s
Steps: 224 | Train Loss: 0.0912016 Vali Loss: 0.1195128 Test Loss: 0.1452190
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04321127384901047, rmse:0.20787321031093597, mae:0.14210249483585358, rse:0.718854546546936
Intermediate time for GB and pred_len 96: 00h:14m:10.38s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1382906
	speed: 0.0873s/iter; left time: 1939.0829s
	iters: 200, epoch: 1 | loss: 0.1395264
	speed: 0.0694s/iter; left time: 1534.8267s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.96s
Steps: 223 | Train Loss: 0.1463332 Vali Loss: 0.1503430 Test Loss: 0.1766358
Validation loss decreased (inf --> 0.150343).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1166224
	speed: 0.1210s/iter; left time: 2659.6390s
	iters: 200, epoch: 2 | loss: 0.1143445
	speed: 0.0693s/iter; left time: 1515.5847s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.72s
Steps: 223 | Train Loss: 0.1172942 Vali Loss: 0.1232760 Test Loss: 0.1470696
Validation loss decreased (0.150343 --> 0.123276).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1106884
	speed: 0.1217s/iter; left time: 2647.4163s
	iters: 200, epoch: 3 | loss: 0.1059793
	speed: 0.0693s/iter; left time: 1500.6390s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.67s
Steps: 223 | Train Loss: 0.1077958 Vali Loss: 0.1214558 Test Loss: 0.1481016
Validation loss decreased (0.123276 --> 0.121456).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1101232
	speed: 0.1220s/iter; left time: 2625.9509s
	iters: 200, epoch: 4 | loss: 0.1033802
	speed: 0.0693s/iter; left time: 1485.2224s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.68s
Steps: 223 | Train Loss: 0.1054731 Vali Loss: 0.1212433 Test Loss: 0.1480350
Validation loss decreased (0.121456 --> 0.121243).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1055346
	speed: 0.1208s/iter; left time: 2573.2861s
	iters: 200, epoch: 5 | loss: 0.1031732
	speed: 0.0692s/iter; left time: 1467.1504s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.1035302 Vali Loss: 0.1213536 Test Loss: 0.1497387
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1046123
	speed: 0.1209s/iter; left time: 2549.2983s
	iters: 200, epoch: 6 | loss: 0.1001897
	speed: 0.0691s/iter; left time: 1450.8671s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.68s
Steps: 223 | Train Loss: 0.1017962 Vali Loss: 0.1209992 Test Loss: 0.1488341
Validation loss decreased (0.121243 --> 0.120999).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0978718
	speed: 0.1242s/iter; left time: 2591.1679s
	iters: 200, epoch: 7 | loss: 0.0973325
	speed: 0.0692s/iter; left time: 1437.3664s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.70s
Steps: 223 | Train Loss: 0.1003711 Vali Loss: 0.1218036 Test Loss: 0.1504623
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0989455
	speed: 0.1191s/iter; left time: 2458.1201s
	iters: 200, epoch: 8 | loss: 0.1002991
	speed: 0.0693s/iter; left time: 1422.6369s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.62s
Steps: 223 | Train Loss: 0.0990875 Vali Loss: 0.1218348 Test Loss: 0.1500351
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0976945
	speed: 0.1187s/iter; left time: 2422.8535s
	iters: 200, epoch: 9 | loss: 0.0966081
	speed: 0.0691s/iter; left time: 1404.1817s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.58s
Steps: 223 | Train Loss: 0.0978859 Vali Loss: 0.1225475 Test Loss: 0.1525755
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0926314
	speed: 0.1191s/iter; left time: 2405.5362s
	iters: 200, epoch: 10 | loss: 0.0951924
	speed: 0.0691s/iter; left time: 1389.1117s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.58s
Steps: 223 | Train Loss: 0.0968670 Vali Loss: 0.1221416 Test Loss: 0.1514783
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0938441
	speed: 0.1191s/iter; left time: 2378.9691s
	iters: 200, epoch: 11 | loss: 0.0952162
	speed: 0.0695s/iter; left time: 1380.9519s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.0958730 Vali Loss: 0.1224927 Test Loss: 0.1522670
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0958836
	speed: 0.1193s/iter; left time: 2355.6395s
	iters: 200, epoch: 12 | loss: 0.0952033
	speed: 0.0692s/iter; left time: 1360.0403s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.0949836 Vali Loss: 0.1231256 Test Loss: 0.1527645
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0955233
	speed: 0.1200s/iter; left time: 2343.5379s
	iters: 200, epoch: 13 | loss: 0.0914457
	speed: 0.0693s/iter; left time: 1346.2415s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.66s
Steps: 223 | Train Loss: 0.0941686 Vali Loss: 0.1234475 Test Loss: 0.1532591
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0911015
	speed: 0.1193s/iter; left time: 2301.7760s
	iters: 200, epoch: 14 | loss: 0.0922876
	speed: 0.0691s/iter; left time: 1327.0114s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.58s
Steps: 223 | Train Loss: 0.0934280 Vali Loss: 0.1233402 Test Loss: 0.1538700
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0898075
	speed: 0.1189s/iter; left time: 2267.6586s
	iters: 200, epoch: 15 | loss: 0.0903602
	speed: 0.0692s/iter; left time: 1313.0621s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.59s
Steps: 223 | Train Loss: 0.0927919 Vali Loss: 0.1235200 Test Loss: 0.1532498
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0931074
	speed: 0.1192s/iter; left time: 2247.1640s
	iters: 200, epoch: 16 | loss: 0.0941772
	speed: 0.0691s/iter; left time: 1296.6019s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:15.62s
Steps: 223 | Train Loss: 0.0921870 Vali Loss: 0.1240861 Test Loss: 0.1538316
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04635089635848999, rmse:0.21529258787631989, mae:0.14883416891098022, rse:0.7464503049850464
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1435386
	speed: 0.0709s/iter; left time: 1574.5806s
	iters: 200, epoch: 1 | loss: 0.1412452
	speed: 0.0693s/iter; left time: 1531.2761s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.1469587 Vali Loss: 0.1503619 Test Loss: 0.1767886
Validation loss decreased (inf --> 0.150362).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1120439
	speed: 0.1237s/iter; left time: 2717.7933s
	iters: 200, epoch: 2 | loss: 0.1109545
	speed: 0.0697s/iter; left time: 1525.2592s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.67s
Steps: 223 | Train Loss: 0.1172456 Vali Loss: 0.1231335 Test Loss: 0.1470964
Validation loss decreased (0.150362 --> 0.123134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1074619
	speed: 0.1203s/iter; left time: 2618.0072s
	iters: 200, epoch: 3 | loss: 0.1085829
	speed: 0.0693s/iter; left time: 1499.8180s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.1079589 Vali Loss: 0.1217438 Test Loss: 0.1472394
Validation loss decreased (0.123134 --> 0.121744).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1029040
	speed: 0.1198s/iter; left time: 2579.2513s
	iters: 200, epoch: 4 | loss: 0.1092405
	speed: 0.0693s/iter; left time: 1484.4616s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.1056315 Vali Loss: 0.1210526 Test Loss: 0.1478875
Validation loss decreased (0.121744 --> 0.121053).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1050835
	speed: 0.1224s/iter; left time: 2608.6936s
	iters: 200, epoch: 5 | loss: 0.1013691
	speed: 0.0692s/iter; left time: 1467.3739s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.61s
Steps: 223 | Train Loss: 0.1037747 Vali Loss: 0.1207483 Test Loss: 0.1486701
Validation loss decreased (0.121053 --> 0.120748).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1023986
	speed: 0.1197s/iter; left time: 2524.9708s
	iters: 200, epoch: 6 | loss: 0.1022196
	speed: 0.0693s/iter; left time: 1454.8751s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.1021649 Vali Loss: 0.1210408 Test Loss: 0.1488155
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1028455
	speed: 0.1203s/iter; left time: 2509.4943s
	iters: 200, epoch: 7 | loss: 0.1001752
	speed: 0.0692s/iter; left time: 1437.5203s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.69s
Steps: 223 | Train Loss: 0.1008448 Vali Loss: 0.1212449 Test Loss: 0.1488863
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1033451
	speed: 0.1190s/iter; left time: 2456.3905s
	iters: 200, epoch: 8 | loss: 0.0971676
	speed: 0.0694s/iter; left time: 1424.6566s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.66s
Steps: 223 | Train Loss: 0.0996199 Vali Loss: 0.1219015 Test Loss: 0.1491982
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0990058
	speed: 0.1190s/iter; left time: 2428.9481s
	iters: 200, epoch: 9 | loss: 0.1007090
	speed: 0.0694s/iter; left time: 1409.2702s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.0985102 Vali Loss: 0.1213971 Test Loss: 0.1493594
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0975233
	speed: 0.1187s/iter; left time: 2397.7097s
	iters: 200, epoch: 10 | loss: 0.0986166
	speed: 0.0694s/iter; left time: 1394.2341s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.66s
Steps: 223 | Train Loss: 0.0975176 Vali Loss: 0.1219288 Test Loss: 0.1506020
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0978751
	speed: 0.1197s/iter; left time: 2391.2975s
	iters: 200, epoch: 11 | loss: 0.0927297
	speed: 0.0694s/iter; left time: 1378.0695s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.0966755 Vali Loss: 0.1223882 Test Loss: 0.1509488
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0987984
	speed: 0.1190s/iter; left time: 2349.5385s
	iters: 200, epoch: 12 | loss: 0.0944003
	speed: 0.0693s/iter; left time: 1361.8936s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.64s
Steps: 223 | Train Loss: 0.0959382 Vali Loss: 0.1223772 Test Loss: 0.1499679
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0941867
	speed: 0.1187s/iter; left time: 2317.9481s
	iters: 200, epoch: 13 | loss: 0.0910453
	speed: 0.0693s/iter; left time: 1346.0385s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:15.63s
Steps: 223 | Train Loss: 0.0952061 Vali Loss: 0.1230551 Test Loss: 0.1518901
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0943975
	speed: 0.1193s/iter; left time: 2302.1516s
	iters: 200, epoch: 14 | loss: 0.0946359
	speed: 0.0693s/iter; left time: 1331.5176s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.65s
Steps: 223 | Train Loss: 0.0946333 Vali Loss: 0.1231219 Test Loss: 0.1512958
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0915139
	speed: 0.1197s/iter; left time: 2283.2056s
	iters: 200, epoch: 15 | loss: 0.0912506
	speed: 0.0693s/iter; left time: 1315.7765s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.70s
Steps: 223 | Train Loss: 0.0940620 Vali Loss: 0.1231321 Test Loss: 0.1521490
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.046182967722415924, rmse:0.21490222215652466, mae:0.14867003262043, rse:0.7450969219207764
Intermediate time for GB and pred_len 168: 00h:10m:00.72sIntermediate time for GB: 00h:55m:05.11s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1529711
	speed: 0.0596s/iter; left time: 1329.7049s
	iters: 200, epoch: 1 | loss: 0.1360108
	speed: 0.0421s/iter; left time: 935.5135s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.88s
Steps: 224 | Train Loss: 0.1550293 Vali Loss: 0.1393889 Test Loss: 0.1681391
Validation loss decreased (inf --> 0.139389).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0734895
	speed: 0.0764s/iter; left time: 1687.5220s
	iters: 200, epoch: 2 | loss: 0.0732423
	speed: 0.0421s/iter; left time: 925.2124s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0805362 Vali Loss: 0.0644472 Test Loss: 0.0716057
Validation loss decreased (0.139389 --> 0.064447).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0670037
	speed: 0.0765s/iter; left time: 1670.8438s
	iters: 200, epoch: 3 | loss: 0.0633987
	speed: 0.0421s/iter; left time: 915.5253s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0639687 Vali Loss: 0.0604835 Test Loss: 0.0676901
Validation loss decreased (0.064447 --> 0.060484).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0613006
	speed: 0.0761s/iter; left time: 1646.4538s
	iters: 200, epoch: 4 | loss: 0.0589914
	speed: 0.0422s/iter; left time: 907.8062s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0607848 Vali Loss: 0.0584154 Test Loss: 0.0650347
Validation loss decreased (0.060484 --> 0.058415).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0590660
	speed: 0.0762s/iter; left time: 1631.6562s
	iters: 200, epoch: 5 | loss: 0.0541014
	speed: 0.0421s/iter; left time: 897.2125s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0585594 Vali Loss: 0.0570394 Test Loss: 0.0637940
Validation loss decreased (0.058415 --> 0.057039).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0569912
	speed: 0.0761s/iter; left time: 1611.4262s
	iters: 200, epoch: 6 | loss: 0.0541913
	speed: 0.0421s/iter; left time: 887.0130s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0571212 Vali Loss: 0.0560755 Test Loss: 0.0628937
Validation loss decreased (0.057039 --> 0.056075).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0585085
	speed: 0.0759s/iter; left time: 1591.1244s
	iters: 200, epoch: 7 | loss: 0.0523225
	speed: 0.0421s/iter; left time: 879.0383s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0562777 Vali Loss: 0.0558876 Test Loss: 0.0626064
Validation loss decreased (0.056075 --> 0.055888).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0545201
	speed: 0.0761s/iter; left time: 1577.9117s
	iters: 200, epoch: 8 | loss: 0.0590803
	speed: 0.0420s/iter; left time: 867.6134s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0555750 Vali Loss: 0.0552337 Test Loss: 0.0619180
Validation loss decreased (0.055888 --> 0.055234).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0534203
	speed: 0.0769s/iter; left time: 1577.3118s
	iters: 200, epoch: 9 | loss: 0.0581229
	speed: 0.0421s/iter; left time: 858.7538s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0550523 Vali Loss: 0.0547637 Test Loss: 0.0615436
Validation loss decreased (0.055234 --> 0.054764).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0546895
	speed: 0.0768s/iter; left time: 1557.8429s
	iters: 200, epoch: 10 | loss: 0.0517974
	speed: 0.0421s/iter; left time: 850.1216s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0545337 Vali Loss: 0.0549140 Test Loss: 0.0615433
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0547254
	speed: 0.0753s/iter; left time: 1510.6060s
	iters: 200, epoch: 11 | loss: 0.0556244
	speed: 0.0420s/iter; left time: 839.0256s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0541035 Vali Loss: 0.0542901 Test Loss: 0.0609592
Validation loss decreased (0.054764 --> 0.054290).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0526986
	speed: 0.0749s/iter; left time: 1484.9537s
	iters: 200, epoch: 12 | loss: 0.0537033
	speed: 0.0421s/iter; left time: 830.4634s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0538599 Vali Loss: 0.0542014 Test Loss: 0.0608091
Validation loss decreased (0.054290 --> 0.054201).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0556784
	speed: 0.0758s/iter; left time: 1487.0728s
	iters: 200, epoch: 13 | loss: 0.0531932
	speed: 0.0421s/iter; left time: 821.9467s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0536762 Vali Loss: 0.0541160 Test Loss: 0.0608011
Validation loss decreased (0.054201 --> 0.054116).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0536481
	speed: 0.0760s/iter; left time: 1474.4599s
	iters: 200, epoch: 14 | loss: 0.0535595
	speed: 0.0422s/iter; left time: 814.6818s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0534330 Vali Loss: 0.0540443 Test Loss: 0.0607316
Validation loss decreased (0.054116 --> 0.054044).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0523399
	speed: 0.0756s/iter; left time: 1449.4713s
	iters: 200, epoch: 15 | loss: 0.0528310
	speed: 0.0420s/iter; left time: 801.5816s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0531772 Vali Loss: 0.0539118 Test Loss: 0.0605432
Validation loss decreased (0.054044 --> 0.053912).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0517506
	speed: 0.0768s/iter; left time: 1455.2459s
	iters: 200, epoch: 16 | loss: 0.0502353
	speed: 0.0419s/iter; left time: 789.2888s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0530458 Vali Loss: 0.0537179 Test Loss: 0.0605205
Validation loss decreased (0.053912 --> 0.053718).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0516205
	speed: 0.0748s/iter; left time: 1400.1206s
	iters: 200, epoch: 17 | loss: 0.0487740
	speed: 0.0419s/iter; left time: 780.3893s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0528856 Vali Loss: 0.0536976 Test Loss: 0.0603235
Validation loss decreased (0.053718 --> 0.053698).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0495635
	speed: 0.0745s/iter; left time: 1376.9593s
	iters: 200, epoch: 18 | loss: 0.0475049
	speed: 0.0419s/iter; left time: 771.4959s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0527332 Vali Loss: 0.0535530 Test Loss: 0.0601319
Validation loss decreased (0.053698 --> 0.053553).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0542793
	speed: 0.0751s/iter; left time: 1372.8692s
	iters: 200, epoch: 19 | loss: 0.0542914
	speed: 0.0419s/iter; left time: 761.9379s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0526262 Vali Loss: 0.0534551 Test Loss: 0.0600646
Validation loss decreased (0.053553 --> 0.053455).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0502990
	speed: 0.0747s/iter; left time: 1348.6633s
	iters: 200, epoch: 20 | loss: 0.0520770
	speed: 0.0419s/iter; left time: 751.9214s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0525189 Vali Loss: 0.0534990 Test Loss: 0.0601889
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0514833
	speed: 0.0742s/iter; left time: 1322.9144s
	iters: 200, epoch: 21 | loss: 0.0518561
	speed: 0.0419s/iter; left time: 743.0023s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0523950 Vali Loss: 0.0533594 Test Loss: 0.0600421
Validation loss decreased (0.053455 --> 0.053359).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0482492
	speed: 0.0751s/iter; left time: 1321.4273s
	iters: 200, epoch: 22 | loss: 0.0523444
	speed: 0.0418s/iter; left time: 731.3011s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0523219 Vali Loss: 0.0532337 Test Loss: 0.0598630
Validation loss decreased (0.053359 --> 0.053234).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0495374
	speed: 0.0742s/iter; left time: 1289.0237s
	iters: 200, epoch: 23 | loss: 0.0533514
	speed: 0.0419s/iter; left time: 723.5867s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0522467 Vali Loss: 0.0533042 Test Loss: 0.0599243
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0537487
	speed: 0.0740s/iter; left time: 1269.3511s
	iters: 200, epoch: 24 | loss: 0.0510432
	speed: 0.0419s/iter; left time: 713.5077s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0522055 Vali Loss: 0.0532749 Test Loss: 0.0598150
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0508326
	speed: 0.0740s/iter; left time: 1252.8814s
	iters: 200, epoch: 25 | loss: 0.0547152
	speed: 0.0419s/iter; left time: 704.1299s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0521477 Vali Loss: 0.0531669 Test Loss: 0.0598374
Validation loss decreased (0.053234 --> 0.053167).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0478256
	speed: 0.0753s/iter; left time: 1257.8698s
	iters: 200, epoch: 26 | loss: 0.0542118
	speed: 0.0419s/iter; left time: 695.2766s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0520078 Vali Loss: 0.0532341 Test Loss: 0.0598802
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0524855
	speed: 0.0745s/iter; left time: 1227.8457s
	iters: 200, epoch: 27 | loss: 0.0518160
	speed: 0.0419s/iter; left time: 685.8340s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0520100 Vali Loss: 0.0530923 Test Loss: 0.0596831
Validation loss decreased (0.053167 --> 0.053092).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0535040
	speed: 0.0744s/iter; left time: 1209.1036s
	iters: 200, epoch: 28 | loss: 0.0530858
	speed: 0.0419s/iter; left time: 676.6691s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0519409 Vali Loss: 0.0530335 Test Loss: 0.0596972
Validation loss decreased (0.053092 --> 0.053034).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0497071
	speed: 0.0748s/iter; left time: 1199.3714s
	iters: 200, epoch: 29 | loss: 0.0555924
	speed: 0.0419s/iter; left time: 666.9074s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0519867 Vali Loss: 0.0531298 Test Loss: 0.0597869
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0511343
	speed: 0.0743s/iter; left time: 1174.7319s
	iters: 200, epoch: 30 | loss: 0.0550379
	speed: 0.0418s/iter; left time: 657.1449s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0519589 Vali Loss: 0.0530690 Test Loss: 0.0597366
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0516089
	speed: 0.0742s/iter; left time: 1156.6521s
	iters: 200, epoch: 31 | loss: 0.0502292
	speed: 0.0418s/iter; left time: 647.8643s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0518643 Vali Loss: 0.0530980 Test Loss: 0.0596929
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0494124
	speed: 0.0739s/iter; left time: 1135.3118s
	iters: 200, epoch: 32 | loss: 0.0510262
	speed: 0.0419s/iter; left time: 638.8566s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0517700 Vali Loss: 0.0531316 Test Loss: 0.0597132
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0485354
	speed: 0.0741s/iter; left time: 1121.3862s
	iters: 200, epoch: 33 | loss: 0.0532829
	speed: 0.0419s/iter; left time: 630.3779s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0518294 Vali Loss: 0.0531285 Test Loss: 0.0597745
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0523017
	speed: 0.0740s/iter; left time: 1103.3919s
	iters: 200, epoch: 34 | loss: 0.0521809
	speed: 0.0419s/iter; left time: 620.3057s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0517885 Vali Loss: 0.0531236 Test Loss: 0.0595324
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0526446
	speed: 0.0743s/iter; left time: 1091.8115s
	iters: 200, epoch: 35 | loss: 0.0531692
	speed: 0.0419s/iter; left time: 610.8797s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0517643 Vali Loss: 0.0528842 Test Loss: 0.0594883
Validation loss decreased (0.053034 --> 0.052884).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0511099
	speed: 0.0750s/iter; left time: 1084.8478s
	iters: 200, epoch: 36 | loss: 0.0518669
	speed: 0.0419s/iter; left time: 601.3534s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0517620 Vali Loss: 0.0530359 Test Loss: 0.0596728
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0513136
	speed: 0.0747s/iter; left time: 1063.3120s
	iters: 200, epoch: 37 | loss: 0.0500350
	speed: 0.0419s/iter; left time: 592.5705s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0517964 Vali Loss: 0.0530424 Test Loss: 0.0596265
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0505333
	speed: 0.0748s/iter; left time: 1048.5269s
	iters: 200, epoch: 38 | loss: 0.0558573
	speed: 0.0419s/iter; left time: 582.8466s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0517588 Vali Loss: 0.0529814 Test Loss: 0.0595264
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0490988
	speed: 0.0739s/iter; left time: 1018.3320s
	iters: 200, epoch: 39 | loss: 0.0539161
	speed: 0.0418s/iter; left time: 572.6839s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0517282 Vali Loss: 0.0530113 Test Loss: 0.0595206
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0515784
	speed: 0.0745s/iter; left time: 1010.0002s
	iters: 200, epoch: 40 | loss: 0.0517620
	speed: 0.0418s/iter; left time: 563.0598s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0516523 Vali Loss: 0.0530574 Test Loss: 0.0596935
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0514502
	speed: 0.0742s/iter; left time: 989.3825s
	iters: 200, epoch: 41 | loss: 0.0488613
	speed: 0.0419s/iter; left time: 554.6997s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0516880 Vali Loss: 0.0528703 Test Loss: 0.0594812
Validation loss decreased (0.052884 --> 0.052870).  Saving model ...
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0496368
	speed: 0.0750s/iter; left time: 983.8314s
	iters: 200, epoch: 42 | loss: 0.0539314
	speed: 0.0418s/iter; left time: 544.2283s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0516577 Vali Loss: 0.0529605 Test Loss: 0.0594789
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0520530
	speed: 0.0736s/iter; left time: 949.4889s
	iters: 200, epoch: 43 | loss: 0.0479843
	speed: 0.0419s/iter; left time: 535.4067s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0516277 Vali Loss: 0.0529979 Test Loss: 0.0595466
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0522960
	speed: 0.0744s/iter; left time: 942.7700s
	iters: 200, epoch: 44 | loss: 0.0505055
	speed: 0.0418s/iter; left time: 525.8456s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0516367 Vali Loss: 0.0529722 Test Loss: 0.0595264
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0533356
	speed: 0.0746s/iter; left time: 929.0001s
	iters: 200, epoch: 45 | loss: 0.0502352
	speed: 0.0419s/iter; left time: 516.7945s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0515927 Vali Loss: 0.0530458 Test Loss: 0.0596104
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0517692
	speed: 0.0746s/iter; left time: 911.5233s
	iters: 200, epoch: 46 | loss: 0.0498136
	speed: 0.0418s/iter; left time: 507.0403s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0516503 Vali Loss: 0.0529150 Test Loss: 0.0594626
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0508997
	speed: 0.0740s/iter; left time: 887.9165s
	iters: 200, epoch: 47 | loss: 0.0512915
	speed: 0.0418s/iter; left time: 497.5828s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0516404 Vali Loss: 0.0531144 Test Loss: 0.0597561
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0517852
	speed: 0.0739s/iter; left time: 870.2552s
	iters: 200, epoch: 48 | loss: 0.0506876
	speed: 0.0419s/iter; left time: 488.5519s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0516248 Vali Loss: 0.0530044 Test Loss: 0.0595320
EarlyStopping counter: 7 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0547697
	speed: 0.0741s/iter; left time: 855.5929s
	iters: 200, epoch: 49 | loss: 0.0555677
	speed: 0.0420s/iter; left time: 480.3530s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0516264 Vali Loss: 0.0528984 Test Loss: 0.0594791
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0482547
	speed: 0.0742s/iter; left time: 840.1247s
	iters: 200, epoch: 50 | loss: 0.0517692
	speed: 0.0418s/iter; left time: 469.5902s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0516105 Vali Loss: 0.0528318 Test Loss: 0.0594671
Validation loss decreased (0.052870 --> 0.052832).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0545435
	speed: 0.0746s/iter; left time: 828.3088s
	iters: 200, epoch: 51 | loss: 0.0500720
	speed: 0.0418s/iter; left time: 459.9548s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0516374 Vali Loss: 0.0529633 Test Loss: 0.0595131
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0499847
	speed: 0.0750s/iter; left time: 816.1339s
	iters: 200, epoch: 52 | loss: 0.0503403
	speed: 0.0419s/iter; left time: 451.2977s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0516169 Vali Loss: 0.0529436 Test Loss: 0.0595761
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0509274
	speed: 0.0744s/iter; left time: 792.6976s
	iters: 200, epoch: 53 | loss: 0.0516314
	speed: 0.0419s/iter; left time: 441.6514s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0516119 Vali Loss: 0.0528572 Test Loss: 0.0594418
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0558771
	speed: 0.0739s/iter; left time: 770.8764s
	iters: 200, epoch: 54 | loss: 0.0494262
	speed: 0.0419s/iter; left time: 432.3469s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0516379 Vali Loss: 0.0529400 Test Loss: 0.0595203
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0516943
	speed: 0.0738s/iter; left time: 753.2285s
	iters: 200, epoch: 55 | loss: 0.0511932
	speed: 0.0418s/iter; left time: 422.4987s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0515673 Vali Loss: 0.0529744 Test Loss: 0.0596210
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0525783
	speed: 0.0742s/iter; left time: 740.6482s
	iters: 200, epoch: 56 | loss: 0.0492389
	speed: 0.0421s/iter; left time: 415.5411s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0516370 Vali Loss: 0.0529574 Test Loss: 0.0595281
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0545935
	speed: 0.0746s/iter; left time: 727.7998s
	iters: 200, epoch: 57 | loss: 0.0523759
	speed: 0.0420s/iter; left time: 405.2712s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0516061 Vali Loss: 0.0529795 Test Loss: 0.0595364
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0511875
	speed: 0.0751s/iter; left time: 715.6339s
	iters: 200, epoch: 58 | loss: 0.0533470
	speed: 0.0419s/iter; left time: 394.7721s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0515821 Vali Loss: 0.0529342 Test Loss: 0.0595035
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0510884
	speed: 0.0738s/iter; left time: 687.2696s
	iters: 200, epoch: 59 | loss: 0.0499370
	speed: 0.0419s/iter; left time: 385.4459s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0515440 Vali Loss: 0.0529809 Test Loss: 0.0596370
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0486272
	speed: 0.0737s/iter; left time: 669.5302s
	iters: 200, epoch: 60 | loss: 0.0515719
	speed: 0.0418s/iter; left time: 375.9111s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0516205 Vali Loss: 0.0529591 Test Loss: 0.0596179
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009799639694392681, rmse:0.09899313002824783, mae:0.05946708470582962, rse:0.29132479429244995
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1476018
	speed: 0.0434s/iter; left time: 967.3401s
	iters: 200, epoch: 1 | loss: 0.1437213
	speed: 0.0418s/iter; left time: 928.1022s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.1531461 Vali Loss: 0.1377213 Test Loss: 0.1661581
Validation loss decreased (inf --> 0.137721).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0746912
	speed: 0.0756s/iter; left time: 1669.1042s
	iters: 200, epoch: 2 | loss: 0.0647650
	speed: 0.0418s/iter; left time: 919.5158s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0809738 Vali Loss: 0.0644596 Test Loss: 0.0714945
Validation loss decreased (0.137721 --> 0.064460).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0640776
	speed: 0.0745s/iter; left time: 1627.5040s
	iters: 200, epoch: 3 | loss: 0.0653341
	speed: 0.0419s/iter; left time: 910.8863s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0643923 Vali Loss: 0.0610661 Test Loss: 0.0680844
Validation loss decreased (0.064460 --> 0.061066).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0614698
	speed: 0.0750s/iter; left time: 1622.1674s
	iters: 200, epoch: 4 | loss: 0.0615958
	speed: 0.0420s/iter; left time: 904.0663s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0611753 Vali Loss: 0.0585783 Test Loss: 0.0655559
Validation loss decreased (0.061066 --> 0.058578).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0570497
	speed: 0.0744s/iter; left time: 1592.0999s
	iters: 200, epoch: 5 | loss: 0.0569669
	speed: 0.0418s/iter; left time: 891.5242s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0590486 Vali Loss: 0.0571490 Test Loss: 0.0639000
Validation loss decreased (0.058578 --> 0.057149).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0563935
	speed: 0.0741s/iter; left time: 1569.2281s
	iters: 200, epoch: 6 | loss: 0.0545689
	speed: 0.0418s/iter; left time: 881.2645s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0574238 Vali Loss: 0.0563478 Test Loss: 0.0633337
Validation loss decreased (0.057149 --> 0.056348).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0543616
	speed: 0.0742s/iter; left time: 1554.6276s
	iters: 200, epoch: 7 | loss: 0.0533362
	speed: 0.0419s/iter; left time: 873.9551s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0563506 Vali Loss: 0.0555214 Test Loss: 0.0626752
Validation loss decreased (0.056348 --> 0.055521).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0559180
	speed: 0.0741s/iter; left time: 1536.6109s
	iters: 200, epoch: 8 | loss: 0.0533546
	speed: 0.0418s/iter; left time: 863.1065s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0556354 Vali Loss: 0.0550512 Test Loss: 0.0623097
Validation loss decreased (0.055521 --> 0.055051).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0521461
	speed: 0.0744s/iter; left time: 1525.2461s
	iters: 200, epoch: 9 | loss: 0.0539520
	speed: 0.0419s/iter; left time: 854.1595s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0550924 Vali Loss: 0.0547789 Test Loss: 0.0615542
Validation loss decreased (0.055051 --> 0.054779).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0549681
	speed: 0.0745s/iter; left time: 1510.4364s
	iters: 200, epoch: 10 | loss: 0.0536708
	speed: 0.0418s/iter; left time: 844.7181s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0546157 Vali Loss: 0.0545722 Test Loss: 0.0614398
Validation loss decreased (0.054779 --> 0.054572).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0526006
	speed: 0.0746s/iter; left time: 1497.1449s
	iters: 200, epoch: 11 | loss: 0.0524122
	speed: 0.0419s/iter; left time: 836.6517s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0542620 Vali Loss: 0.0542749 Test Loss: 0.0611336
Validation loss decreased (0.054572 --> 0.054275).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0543727
	speed: 0.0744s/iter; left time: 1476.5967s
	iters: 200, epoch: 12 | loss: 0.0528240
	speed: 0.0418s/iter; left time: 825.2651s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0538929 Vali Loss: 0.0541811 Test Loss: 0.0609238
Validation loss decreased (0.054275 --> 0.054181).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0580260
	speed: 0.0746s/iter; left time: 1462.7228s
	iters: 200, epoch: 13 | loss: 0.0543900
	speed: 0.0418s/iter; left time: 816.3593s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0536706 Vali Loss: 0.0540516 Test Loss: 0.0607060
Validation loss decreased (0.054181 --> 0.054052).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0565432
	speed: 0.0740s/iter; left time: 1433.8208s
	iters: 200, epoch: 14 | loss: 0.0505316
	speed: 0.0418s/iter; left time: 805.6353s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0535040 Vali Loss: 0.0538637 Test Loss: 0.0606829
Validation loss decreased (0.054052 --> 0.053864).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0581060
	speed: 0.0741s/iter; left time: 1420.0279s
	iters: 200, epoch: 15 | loss: 0.0532165
	speed: 0.0418s/iter; left time: 796.5252s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0531955 Vali Loss: 0.0537251 Test Loss: 0.0603922
Validation loss decreased (0.053864 --> 0.053725).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0522039
	speed: 0.0742s/iter; left time: 1404.7267s
	iters: 200, epoch: 16 | loss: 0.0557981
	speed: 0.0418s/iter; left time: 788.2662s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0530805 Vali Loss: 0.0535555 Test Loss: 0.0602422
Validation loss decreased (0.053725 --> 0.053556).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0513855
	speed: 0.0741s/iter; left time: 1387.5643s
	iters: 200, epoch: 17 | loss: 0.0546825
	speed: 0.0418s/iter; left time: 778.9856s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0529455 Vali Loss: 0.0536849 Test Loss: 0.0604115
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0556174
	speed: 0.0737s/iter; left time: 1362.4725s
	iters: 200, epoch: 18 | loss: 0.0520927
	speed: 0.0418s/iter; left time: 769.4816s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0527236 Vali Loss: 0.0535271 Test Loss: 0.0601175
Validation loss decreased (0.053556 --> 0.053527).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0525549
	speed: 0.0744s/iter; left time: 1359.2558s
	iters: 200, epoch: 19 | loss: 0.0489624
	speed: 0.0418s/iter; left time: 759.3568s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0527059 Vali Loss: 0.0535655 Test Loss: 0.0602358
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0496512
	speed: 0.0737s/iter; left time: 1330.0334s
	iters: 200, epoch: 20 | loss: 0.0536459
	speed: 0.0419s/iter; left time: 751.7442s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0525997 Vali Loss: 0.0534788 Test Loss: 0.0601111
Validation loss decreased (0.053527 --> 0.053479).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0562994
	speed: 0.0744s/iter; left time: 1326.1666s
	iters: 200, epoch: 21 | loss: 0.0519681
	speed: 0.0418s/iter; left time: 741.5935s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0524832 Vali Loss: 0.0533591 Test Loss: 0.0600647
Validation loss decreased (0.053479 --> 0.053359).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0498014
	speed: 0.0740s/iter; left time: 1302.2149s
	iters: 200, epoch: 22 | loss: 0.0511340
	speed: 0.0418s/iter; left time: 731.8372s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0524015 Vali Loss: 0.0533194 Test Loss: 0.0599013
Validation loss decreased (0.053359 --> 0.053319).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0511480
	speed: 0.0752s/iter; left time: 1307.2778s
	iters: 200, epoch: 23 | loss: 0.0547260
	speed: 0.0426s/iter; left time: 736.6553s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.73s
Steps: 224 | Train Loss: 0.0523454 Vali Loss: 0.0532531 Test Loss: 0.0598640
Validation loss decreased (0.053319 --> 0.053253).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0494056
	speed: 0.0741s/iter; left time: 1270.1937s
	iters: 200, epoch: 24 | loss: 0.0505622
	speed: 0.0418s/iter; left time: 712.1494s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0522534 Vali Loss: 0.0532340 Test Loss: 0.0598475
Validation loss decreased (0.053253 --> 0.053234).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0507696
	speed: 0.0740s/iter; left time: 1252.1243s
	iters: 200, epoch: 25 | loss: 0.0518188
	speed: 0.0417s/iter; left time: 702.0969s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0521564 Vali Loss: 0.0531983 Test Loss: 0.0597164
Validation loss decreased (0.053234 --> 0.053198).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0543133
	speed: 0.0739s/iter; left time: 1234.9556s
	iters: 200, epoch: 26 | loss: 0.0491244
	speed: 0.0418s/iter; left time: 694.0445s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0521741 Vali Loss: 0.0532081 Test Loss: 0.0597476
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0529002
	speed: 0.0736s/iter; left time: 1212.4261s
	iters: 200, epoch: 27 | loss: 0.0531516
	speed: 0.0418s/iter; left time: 684.0623s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0520485 Vali Loss: 0.0532592 Test Loss: 0.0598365
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0536259
	speed: 0.0738s/iter; left time: 1199.2121s
	iters: 200, epoch: 28 | loss: 0.0525920
	speed: 0.0418s/iter; left time: 675.0238s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0520732 Vali Loss: 0.0530898 Test Loss: 0.0597077
Validation loss decreased (0.053198 --> 0.053090).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0543261
	speed: 0.0741s/iter; left time: 1187.1689s
	iters: 200, epoch: 29 | loss: 0.0550454
	speed: 0.0418s/iter; left time: 665.9708s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0519956 Vali Loss: 0.0531452 Test Loss: 0.0597517
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0523805
	speed: 0.0735s/iter; left time: 1162.1472s
	iters: 200, epoch: 30 | loss: 0.0516562
	speed: 0.0418s/iter; left time: 656.2511s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0519390 Vali Loss: 0.0532631 Test Loss: 0.0597923
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0534631
	speed: 0.0739s/iter; left time: 1152.0264s
	iters: 200, epoch: 31 | loss: 0.0478987
	speed: 0.0418s/iter; left time: 646.6618s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0519516 Vali Loss: 0.0530886 Test Loss: 0.0596565
Validation loss decreased (0.053090 --> 0.053089).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0525212
	speed: 0.0745s/iter; left time: 1143.6131s
	iters: 200, epoch: 32 | loss: 0.0448811
	speed: 0.0419s/iter; left time: 638.7264s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0519044 Vali Loss: 0.0531356 Test Loss: 0.0596514
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0543640
	speed: 0.0737s/iter; left time: 1115.7017s
	iters: 200, epoch: 33 | loss: 0.0521232
	speed: 0.0418s/iter; left time: 629.0340s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0518768 Vali Loss: 0.0530850 Test Loss: 0.0596694
Validation loss decreased (0.053089 --> 0.053085).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0533725
	speed: 0.0742s/iter; left time: 1106.4521s
	iters: 200, epoch: 34 | loss: 0.0530695
	speed: 0.0418s/iter; left time: 619.5560s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0518850 Vali Loss: 0.0531215 Test Loss: 0.0596977
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0490373
	speed: 0.0737s/iter; left time: 1082.1185s
	iters: 200, epoch: 35 | loss: 0.0513428
	speed: 0.0418s/iter; left time: 609.4521s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0518383 Vali Loss: 0.0530350 Test Loss: 0.0596393
Validation loss decreased (0.053085 --> 0.053035).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0535707
	speed: 0.0742s/iter; left time: 1072.6000s
	iters: 200, epoch: 36 | loss: 0.0524036
	speed: 0.0418s/iter; left time: 600.4129s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0517890 Vali Loss: 0.0530882 Test Loss: 0.0596071
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0524593
	speed: 0.0737s/iter; left time: 1049.1655s
	iters: 200, epoch: 37 | loss: 0.0530749
	speed: 0.0418s/iter; left time: 590.8150s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0517949 Vali Loss: 0.0530463 Test Loss: 0.0596028
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0532010
	speed: 0.0738s/iter; left time: 1033.7296s
	iters: 200, epoch: 38 | loss: 0.0495975
	speed: 0.0418s/iter; left time: 582.1612s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0517682 Vali Loss: 0.0529934 Test Loss: 0.0595207
Validation loss decreased (0.053035 --> 0.052993).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0499899
	speed: 0.0740s/iter; left time: 1020.9604s
	iters: 200, epoch: 39 | loss: 0.0538907
	speed: 0.0418s/iter; left time: 572.7981s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0517210 Vali Loss: 0.0530056 Test Loss: 0.0595864
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0525996
	speed: 0.0738s/iter; left time: 1000.8883s
	iters: 200, epoch: 40 | loss: 0.0529549
	speed: 0.0419s/iter; left time: 564.1836s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0517723 Vali Loss: 0.0530561 Test Loss: 0.0595950
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0519737
	speed: 0.0736s/iter; left time: 981.2992s
	iters: 200, epoch: 41 | loss: 0.0519630
	speed: 0.0417s/iter; left time: 552.7312s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.51s
Steps: 224 | Train Loss: 0.0517834 Vali Loss: 0.0530609 Test Loss: 0.0596149
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0509723
	speed: 0.0745s/iter; left time: 977.7813s
	iters: 200, epoch: 42 | loss: 0.0524476
	speed: 0.0544s/iter; left time: 708.4600s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:12.03s
Steps: 224 | Train Loss: 0.0518105 Vali Loss: 0.0530046 Test Loss: 0.0595797
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0503187
	speed: 0.1446s/iter; left time: 1863.8645s
	iters: 200, epoch: 43 | loss: 0.0504047
	speed: 0.0854s/iter; left time: 1092.4084s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:19.29s
Steps: 224 | Train Loss: 0.0516899 Vali Loss: 0.0529767 Test Loss: 0.0595138
Validation loss decreased (0.052993 --> 0.052977).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0527615
	speed: 0.1431s/iter; left time: 1812.5550s
	iters: 200, epoch: 44 | loss: 0.0524022
	speed: 0.0886s/iter; left time: 1113.5591s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:19.16s
Steps: 224 | Train Loss: 0.0517289 Vali Loss: 0.0530944 Test Loss: 0.0597356
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0513969
	speed: 0.1463s/iter; left time: 1820.3994s
	iters: 200, epoch: 45 | loss: 0.0538382
	speed: 0.0826s/iter; left time: 1020.2987s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:19.45s
Steps: 224 | Train Loss: 0.0517787 Vali Loss: 0.0529584 Test Loss: 0.0594981
Validation loss decreased (0.052977 --> 0.052958).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0507074
	speed: 0.1467s/iter; left time: 1792.9198s
	iters: 200, epoch: 46 | loss: 0.0531654
	speed: 0.0863s/iter; left time: 1046.5562s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:19.48s
Steps: 224 | Train Loss: 0.0517703 Vali Loss: 0.0530363 Test Loss: 0.0595716
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0526433
	speed: 0.1428s/iter; left time: 1712.7029s
	iters: 200, epoch: 47 | loss: 0.0482868
	speed: 0.0886s/iter; left time: 1054.3679s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:19.20s
Steps: 224 | Train Loss: 0.0516642 Vali Loss: 0.0530231 Test Loss: 0.0595973
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0503860
	speed: 0.1457s/iter; left time: 1715.0696s
	iters: 200, epoch: 48 | loss: 0.0495362
	speed: 0.0832s/iter; left time: 970.8828s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:19.51s
Steps: 224 | Train Loss: 0.0516952 Vali Loss: 0.0530382 Test Loss: 0.0595692
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0528319
	speed: 0.1448s/iter; left time: 1672.3772s
	iters: 200, epoch: 49 | loss: 0.0522983
	speed: 0.0861s/iter; left time: 986.2765s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:19.33s
Steps: 224 | Train Loss: 0.0517189 Vali Loss: 0.0530699 Test Loss: 0.0596293
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0519786
	speed: 0.1439s/iter; left time: 1629.4182s
	iters: 200, epoch: 50 | loss: 0.0511020
	speed: 0.0886s/iter; left time: 994.1350s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:19.22s
Steps: 224 | Train Loss: 0.0516822 Vali Loss: 0.0529885 Test Loss: 0.0594989
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0557232
	speed: 0.1467s/iter; left time: 1628.4150s
	iters: 200, epoch: 51 | loss: 0.0520977
	speed: 0.0824s/iter; left time: 906.3230s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:19.39s
Steps: 224 | Train Loss: 0.0516774 Vali Loss: 0.0530646 Test Loss: 0.0595811
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0513555
	speed: 0.1452s/iter; left time: 1578.9646s
	iters: 200, epoch: 52 | loss: 0.0545720
	speed: 0.0716s/iter; left time: 771.2946s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:17.84s
Steps: 224 | Train Loss: 0.0517186 Vali Loss: 0.0529541 Test Loss: 0.0595378
Validation loss decreased (0.052958 --> 0.052954).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0548120
	speed: 0.1379s/iter; left time: 1468.8587s
	iters: 200, epoch: 53 | loss: 0.0506285
	speed: 0.0885s/iter; left time: 934.3739s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:18.77s
Steps: 224 | Train Loss: 0.0516620 Vali Loss: 0.0529870 Test Loss: 0.0596300
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0522626
	speed: 0.1423s/iter; left time: 1484.1139s
	iters: 200, epoch: 54 | loss: 0.0501850
	speed: 0.0875s/iter; left time: 903.4580s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:19.05s
Steps: 224 | Train Loss: 0.0517069 Vali Loss: 0.0530255 Test Loss: 0.0595458
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0548283
	speed: 0.1429s/iter; left time: 1458.1575s
	iters: 200, epoch: 55 | loss: 0.0515203
	speed: 0.0821s/iter; left time: 829.7827s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:19.58s
Steps: 224 | Train Loss: 0.0517627 Vali Loss: 0.0529545 Test Loss: 0.0594461
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0473725
	speed: 0.1991s/iter; left time: 1987.2282s
	iters: 200, epoch: 56 | loss: 0.0474448
	speed: 0.1268s/iter; left time: 1252.9267s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:27.83s
Steps: 224 | Train Loss: 0.0516708 Vali Loss: 0.0529323 Test Loss: 0.0594687
Validation loss decreased (0.052954 --> 0.052932).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0475008
	speed: 0.2073s/iter; left time: 2022.5499s
	iters: 200, epoch: 57 | loss: 0.0523390
	speed: 0.1267s/iter; left time: 1223.1788s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:27.66s
Steps: 224 | Train Loss: 0.0516606 Vali Loss: 0.0529457 Test Loss: 0.0595112
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0514652
	speed: 0.0937s/iter; left time: 893.5721s
	iters: 200, epoch: 58 | loss: 0.0510385
	speed: 0.0419s/iter; left time: 394.7933s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0516258 Vali Loss: 0.0530078 Test Loss: 0.0594691
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0523517
	speed: 0.0745s/iter; left time: 693.8714s
	iters: 200, epoch: 59 | loss: 0.0503257
	speed: 0.0419s/iter; left time: 385.6757s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0516860 Vali Loss: 0.0529880 Test Loss: 0.0595234
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0493156
	speed: 0.0738s/iter; left time: 670.6898s
	iters: 200, epoch: 60 | loss: 0.0500680
	speed: 0.0418s/iter; left time: 375.9259s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0516414 Vali Loss: 0.0530047 Test Loss: 0.0595303
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0520709
	speed: 0.0737s/iter; left time: 652.8748s
	iters: 200, epoch: 61 | loss: 0.0485221
	speed: 0.0430s/iter; left time: 376.4587s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0516731 Vali Loss: 0.0530099 Test Loss: 0.0595771
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0494203
	speed: 0.0783s/iter; left time: 676.1625s
	iters: 200, epoch: 62 | loss: 0.0503813
	speed: 0.0434s/iter; left time: 370.8054s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:10.05s
Steps: 224 | Train Loss: 0.0516423 Vali Loss: 0.0530357 Test Loss: 0.0595844
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0526378
	speed: 0.0798s/iter; left time: 671.5980s
	iters: 200, epoch: 63 | loss: 0.0479659
	speed: 0.0433s/iter; left time: 359.6551s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0516823 Vali Loss: 0.0529699 Test Loss: 0.0594978
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0508766
	speed: 0.0800s/iter; left time: 655.4513s
	iters: 200, epoch: 64 | loss: 0.0505792
	speed: 0.0438s/iter; left time: 353.9328s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.0516600 Vali Loss: 0.0530094 Test Loss: 0.0595359
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0496024
	speed: 0.0792s/iter; left time: 630.9550s
	iters: 200, epoch: 65 | loss: 0.0513106
	speed: 0.0437s/iter; left time: 343.9337s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0516431 Vali Loss: 0.0529733 Test Loss: 0.0594781
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0553750
	speed: 0.0802s/iter; left time: 620.7282s
	iters: 200, epoch: 66 | loss: 0.0515449
	speed: 0.0441s/iter; left time: 336.6179s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.0517339 Vali Loss: 0.0529650 Test Loss: 0.0594281
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.00978555716574192, rmse:0.09892197698354721, mae:0.05946873873472214, rse:0.291115403175354
Intermediate time for ES and pred_len 24: 00h:27m:52.50s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1586270
	speed: 0.0609s/iter; left time: 1358.5171s
	iters: 200, epoch: 1 | loss: 0.1450784
	speed: 0.0443s/iter; left time: 983.2057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.47s
Steps: 224 | Train Loss: 0.1628915 Vali Loss: 0.1497857 Test Loss: 0.1802254
Validation loss decreased (inf --> 0.149786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0918277
	speed: 0.0842s/iter; left time: 1859.3174s
	iters: 200, epoch: 2 | loss: 0.0816794
	speed: 0.0447s/iter; left time: 983.4612s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.23s
Steps: 224 | Train Loss: 0.0973313 Vali Loss: 0.0838464 Test Loss: 0.0949164
Validation loss decreased (0.149786 --> 0.083846).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0829089
	speed: 0.0812s/iter; left time: 1775.2768s
	iters: 200, epoch: 3 | loss: 0.0840276
	speed: 0.0423s/iter; left time: 919.7388s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0835588 Vali Loss: 0.0806199 Test Loss: 0.0917724
Validation loss decreased (0.083846 --> 0.080620).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0808573
	speed: 0.0795s/iter; left time: 1718.6657s
	iters: 200, epoch: 4 | loss: 0.0771366
	speed: 0.0432s/iter; left time: 929.0178s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.90s
Steps: 224 | Train Loss: 0.0804146 Vali Loss: 0.0785956 Test Loss: 0.0899684
Validation loss decreased (0.080620 --> 0.078596).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0811141
	speed: 0.0808s/iter; left time: 1729.7450s
	iters: 200, epoch: 5 | loss: 0.0803113
	speed: 0.0432s/iter; left time: 919.8680s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0785678 Vali Loss: 0.0775166 Test Loss: 0.0890404
Validation loss decreased (0.078596 --> 0.077517).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0755782
	speed: 0.0802s/iter; left time: 1697.9951s
	iters: 200, epoch: 6 | loss: 0.0813857
	speed: 0.0430s/iter; left time: 906.3293s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.90s
Steps: 224 | Train Loss: 0.0773221 Vali Loss: 0.0770633 Test Loss: 0.0883174
Validation loss decreased (0.077517 --> 0.077063).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0746969
	speed: 0.0807s/iter; left time: 1690.2621s
	iters: 200, epoch: 7 | loss: 0.0766782
	speed: 0.0432s/iter; left time: 901.3679s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0764304 Vali Loss: 0.0768258 Test Loss: 0.0879041
Validation loss decreased (0.077063 --> 0.076826).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0754822
	speed: 0.0839s/iter; left time: 1739.1228s
	iters: 200, epoch: 8 | loss: 0.0759594
	speed: 0.0433s/iter; left time: 892.5464s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0758011 Vali Loss: 0.0766668 Test Loss: 0.0877922
Validation loss decreased (0.076826 --> 0.076667).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0726592
	speed: 0.0867s/iter; left time: 1777.7424s
	iters: 200, epoch: 9 | loss: 0.0735152
	speed: 0.0432s/iter; left time: 882.2720s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0752415 Vali Loss: 0.0766290 Test Loss: 0.0876217
Validation loss decreased (0.076667 --> 0.076629).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0743559
	speed: 0.0794s/iter; left time: 1610.5306s
	iters: 200, epoch: 10 | loss: 0.0777107
	speed: 0.0439s/iter; left time: 885.8302s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0747904 Vali Loss: 0.0761793 Test Loss: 0.0872853
Validation loss decreased (0.076629 --> 0.076179).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0745435
	speed: 0.0863s/iter; left time: 1730.5839s
	iters: 200, epoch: 11 | loss: 0.0774285
	speed: 0.0434s/iter; left time: 866.4561s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0744887 Vali Loss: 0.0758530 Test Loss: 0.0868568
Validation loss decreased (0.076179 --> 0.075853).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0747768
	speed: 0.0824s/iter; left time: 1635.5455s
	iters: 200, epoch: 12 | loss: 0.0704287
	speed: 0.0432s/iter; left time: 852.9351s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.0741229 Vali Loss: 0.0759289 Test Loss: 0.0864838
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0732824
	speed: 0.0816s/iter; left time: 1601.0958s
	iters: 200, epoch: 13 | loss: 0.0723793
	speed: 0.0432s/iter; left time: 843.4408s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0738578 Vali Loss: 0.0760315 Test Loss: 0.0870588
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0701876
	speed: 0.0790s/iter; left time: 1532.5645s
	iters: 200, epoch: 14 | loss: 0.0745867
	speed: 0.0440s/iter; left time: 849.2533s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0736512 Vali Loss: 0.0758688 Test Loss: 0.0869034
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0756198
	speed: 0.0778s/iter; left time: 1490.6806s
	iters: 200, epoch: 15 | loss: 0.0735717
	speed: 0.0440s/iter; left time: 838.4463s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0732935 Vali Loss: 0.0758132 Test Loss: 0.0868040
Validation loss decreased (0.075853 --> 0.075813).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0714306
	speed: 0.0801s/iter; left time: 1517.3447s
	iters: 200, epoch: 16 | loss: 0.0736407
	speed: 0.0432s/iter; left time: 812.9986s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0731359 Vali Loss: 0.0755762 Test Loss: 0.0866504
Validation loss decreased (0.075813 --> 0.075576).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0714845
	speed: 0.1059s/iter; left time: 1982.6248s
	iters: 200, epoch: 17 | loss: 0.0719373
	speed: 0.0435s/iter; left time: 809.4978s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0729409 Vali Loss: 0.0758209 Test Loss: 0.0867814
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0735483
	speed: 0.0798s/iter; left time: 1475.8235s
	iters: 200, epoch: 18 | loss: 0.0718875
	speed: 0.0433s/iter; left time: 797.1745s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0727708 Vali Loss: 0.0758975 Test Loss: 0.0866312
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0726891
	speed: 0.0794s/iter; left time: 1450.2026s
	iters: 200, epoch: 19 | loss: 0.0692141
	speed: 0.0434s/iter; left time: 789.3982s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.00s
Steps: 224 | Train Loss: 0.0727016 Vali Loss: 0.0755487 Test Loss: 0.0864635
Validation loss decreased (0.075576 --> 0.075549).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0737528
	speed: 0.0862s/iter; left time: 1556.2331s
	iters: 200, epoch: 20 | loss: 0.0728427
	speed: 0.0439s/iter; left time: 788.5115s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0724692 Vali Loss: 0.0755976 Test Loss: 0.0864065
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0726215
	speed: 0.0788s/iter; left time: 1404.9209s
	iters: 200, epoch: 21 | loss: 0.0720892
	speed: 0.0431s/iter; left time: 763.1984s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.0724086 Vali Loss: 0.0755949 Test Loss: 0.0864117
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0723771
	speed: 0.0784s/iter; left time: 1380.1135s
	iters: 200, epoch: 22 | loss: 0.0696119
	speed: 0.0434s/iter; left time: 759.8976s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0722944 Vali Loss: 0.0755619 Test Loss: 0.0864713
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0689607
	speed: 0.0802s/iter; left time: 1392.7066s
	iters: 200, epoch: 23 | loss: 0.0684920
	speed: 0.0435s/iter; left time: 752.2158s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0722183 Vali Loss: 0.0756311 Test Loss: 0.0865839
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0713682
	speed: 0.0802s/iter; left time: 1375.7347s
	iters: 200, epoch: 24 | loss: 0.0739676
	speed: 0.0434s/iter; left time: 739.8116s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.0721205 Vali Loss: 0.0753485 Test Loss: 0.0863606
Validation loss decreased (0.075549 --> 0.075348).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0724736
	speed: 0.0805s/iter; left time: 1363.2252s
	iters: 200, epoch: 25 | loss: 0.0702187
	speed: 0.0436s/iter; left time: 733.6587s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.06s
Steps: 224 | Train Loss: 0.0720138 Vali Loss: 0.0755377 Test Loss: 0.0865106
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0746010
	speed: 0.0790s/iter; left time: 1318.5786s
	iters: 200, epoch: 26 | loss: 0.0682516
	speed: 0.0439s/iter; left time: 729.6063s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0719424 Vali Loss: 0.0755066 Test Loss: 0.0864553
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0756939
	speed: 0.0788s/iter; left time: 1297.7518s
	iters: 200, epoch: 27 | loss: 0.0694480
	speed: 0.0431s/iter; left time: 706.5795s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0719031 Vali Loss: 0.0754957 Test Loss: 0.0865196
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0707726
	speed: 0.0786s/iter; left time: 1278.0298s
	iters: 200, epoch: 28 | loss: 0.0729235
	speed: 0.0432s/iter; left time: 697.0378s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0718348 Vali Loss: 0.0756311 Test Loss: 0.0866816
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0716222
	speed: 0.0825s/iter; left time: 1321.7298s
	iters: 200, epoch: 29 | loss: 0.0678281
	speed: 0.0435s/iter; left time: 692.9117s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.91s
Steps: 224 | Train Loss: 0.0718101 Vali Loss: 0.0753566 Test Loss: 0.0863243
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0712663
	speed: 0.0787s/iter; left time: 1243.0862s
	iters: 200, epoch: 30 | loss: 0.0745299
	speed: 0.0442s/iter; left time: 693.6122s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:10.00s
Steps: 224 | Train Loss: 0.0718021 Vali Loss: 0.0753349 Test Loss: 0.0863798
Validation loss decreased (0.075348 --> 0.075335).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0724587
	speed: 0.0914s/iter; left time: 1423.6349s
	iters: 200, epoch: 31 | loss: 0.0724711
	speed: 0.0432s/iter; left time: 668.3824s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.00s
Steps: 224 | Train Loss: 0.0716330 Vali Loss: 0.0754693 Test Loss: 0.0865439
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0730980
	speed: 0.0812s/iter; left time: 1247.6069s
	iters: 200, epoch: 32 | loss: 0.0705433
	speed: 0.0439s/iter; left time: 669.1235s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0716719 Vali Loss: 0.0754019 Test Loss: 0.0864273
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0715316
	speed: 0.0783s/iter; left time: 1184.4293s
	iters: 200, epoch: 33 | loss: 0.0711717
	speed: 0.0436s/iter; left time: 654.9326s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0715782 Vali Loss: 0.0754586 Test Loss: 0.0865546
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0697430
	speed: 0.0785s/iter; left time: 1169.7244s
	iters: 200, epoch: 34 | loss: 0.0722043
	speed: 0.0435s/iter; left time: 644.8645s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0716041 Vali Loss: 0.0755848 Test Loss: 0.0867919
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0753731
	speed: 0.0797s/iter; left time: 1170.0707s
	iters: 200, epoch: 35 | loss: 0.0724049
	speed: 0.0431s/iter; left time: 629.0536s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:10.05s
Steps: 224 | Train Loss: 0.0716068 Vali Loss: 0.0754728 Test Loss: 0.0866043
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0714311
	speed: 0.0792s/iter; left time: 1144.7564s
	iters: 200, epoch: 36 | loss: 0.0718317
	speed: 0.0433s/iter; left time: 621.5976s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.0714898 Vali Loss: 0.0754767 Test Loss: 0.0865963
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0701757
	speed: 0.0813s/iter; left time: 1156.8416s
	iters: 200, epoch: 37 | loss: 0.0718206
	speed: 0.0439s/iter; left time: 620.6708s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0715510 Vali Loss: 0.0754377 Test Loss: 0.0864953
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0731241
	speed: 0.0784s/iter; left time: 1098.6226s
	iters: 200, epoch: 38 | loss: 0.0693968
	speed: 0.0438s/iter; left time: 608.7576s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:10.00s
Steps: 224 | Train Loss: 0.0715072 Vali Loss: 0.0754432 Test Loss: 0.0865382
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0723001
	speed: 0.0799s/iter; left time: 1101.7771s
	iters: 200, epoch: 39 | loss: 0.0704393
	speed: 0.0432s/iter; left time: 591.3525s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:10.07s
Steps: 224 | Train Loss: 0.0714562 Vali Loss: 0.0755303 Test Loss: 0.0867850
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0707888
	speed: 0.0814s/iter; left time: 1104.0422s
	iters: 200, epoch: 40 | loss: 0.0684797
	speed: 0.0439s/iter; left time: 591.1543s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:10.11s
Steps: 224 | Train Loss: 0.0714900 Vali Loss: 0.0754403 Test Loss: 0.0864604
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01853589527308941, rmse:0.13614659011363983, mae:0.086379773914814, rse:0.39995771646499634
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1595100
	speed: 0.0460s/iter; left time: 1026.6767s
	iters: 200, epoch: 1 | loss: 0.1464803
	speed: 0.0435s/iter; left time: 966.7590s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.14s
Steps: 224 | Train Loss: 0.1623900 Vali Loss: 0.1494924 Test Loss: 0.1800590
Validation loss decreased (inf --> 0.149492).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0974927
	speed: 0.0972s/iter; left time: 2146.4310s
	iters: 200, epoch: 2 | loss: 0.0831096
	speed: 0.0442s/iter; left time: 972.0529s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.13s
Steps: 224 | Train Loss: 0.0989482 Vali Loss: 0.0836564 Test Loss: 0.0951239
Validation loss decreased (0.149492 --> 0.083656).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0859427
	speed: 0.0882s/iter; left time: 1926.3782s
	iters: 200, epoch: 3 | loss: 0.0827934
	speed: 0.0432s/iter; left time: 940.1842s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.85s
Steps: 224 | Train Loss: 0.0840580 Vali Loss: 0.0804858 Test Loss: 0.0919310
Validation loss decreased (0.083656 --> 0.080486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0809943
	speed: 0.0853s/iter; left time: 1844.2546s
	iters: 200, epoch: 4 | loss: 0.0824453
	speed: 0.0485s/iter; left time: 1044.8925s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.68s
Steps: 224 | Train Loss: 0.0809367 Vali Loss: 0.0787052 Test Loss: 0.0902697
Validation loss decreased (0.080486 --> 0.078705).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0784219
	speed: 0.0865s/iter; left time: 1852.5851s
	iters: 200, epoch: 5 | loss: 0.0777955
	speed: 0.0441s/iter; left time: 938.7147s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.38s
Steps: 224 | Train Loss: 0.0786152 Vali Loss: 0.0776663 Test Loss: 0.0886390
Validation loss decreased (0.078705 --> 0.077666).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0771296
	speed: 0.0928s/iter; left time: 1965.7520s
	iters: 200, epoch: 6 | loss: 0.0751691
	speed: 0.0476s/iter; left time: 1003.7735s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.36s
Steps: 224 | Train Loss: 0.0773966 Vali Loss: 0.0769601 Test Loss: 0.0882143
Validation loss decreased (0.077666 --> 0.076960).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0770102
	speed: 0.0869s/iter; left time: 1820.4239s
	iters: 200, epoch: 7 | loss: 0.0743075
	speed: 0.0467s/iter; left time: 974.1946s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.52s
Steps: 224 | Train Loss: 0.0765820 Vali Loss: 0.0765978 Test Loss: 0.0877772
Validation loss decreased (0.076960 --> 0.076598).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0752847
	speed: 0.0853s/iter; left time: 1767.8104s
	iters: 200, epoch: 8 | loss: 0.0798416
	speed: 0.0458s/iter; left time: 944.6182s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.77s
Steps: 224 | Train Loss: 0.0758869 Vali Loss: 0.0762154 Test Loss: 0.0875819
Validation loss decreased (0.076598 --> 0.076215).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0779041
	speed: 0.0852s/iter; left time: 1747.8906s
	iters: 200, epoch: 9 | loss: 0.0767852
	speed: 0.0475s/iter; left time: 969.5431s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.50s
Steps: 224 | Train Loss: 0.0753483 Vali Loss: 0.0761540 Test Loss: 0.0874702
Validation loss decreased (0.076215 --> 0.076154).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0750211
	speed: 0.0876s/iter; left time: 1777.6915s
	iters: 200, epoch: 10 | loss: 0.0759499
	speed: 0.0439s/iter; left time: 886.0987s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.25s
Steps: 224 | Train Loss: 0.0748687 Vali Loss: 0.0757517 Test Loss: 0.0869395
Validation loss decreased (0.076154 --> 0.075752).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0746947
	speed: 0.0864s/iter; left time: 1733.4514s
	iters: 200, epoch: 11 | loss: 0.0727347
	speed: 0.0441s/iter; left time: 879.8236s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.48s
Steps: 224 | Train Loss: 0.0744353 Vali Loss: 0.0759637 Test Loss: 0.0869859
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0743605
	speed: 0.0840s/iter; left time: 1665.7074s
	iters: 200, epoch: 12 | loss: 0.0748632
	speed: 0.0430s/iter; left time: 847.8780s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.26s
Steps: 224 | Train Loss: 0.0740608 Vali Loss: 0.0756004 Test Loss: 0.0868234
Validation loss decreased (0.075752 --> 0.075600).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0698201
	speed: 0.1110s/iter; left time: 2177.4018s
	iters: 200, epoch: 13 | loss: 0.0715147
	speed: 0.0495s/iter; left time: 965.4046s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.50s
Steps: 224 | Train Loss: 0.0737650 Vali Loss: 0.0755211 Test Loss: 0.0866745
Validation loss decreased (0.075600 --> 0.075521).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0690998
	speed: 0.0907s/iter; left time: 1757.6743s
	iters: 200, epoch: 14 | loss: 0.0740039
	speed: 0.0427s/iter; left time: 822.8919s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.57s
Steps: 224 | Train Loss: 0.0734863 Vali Loss: 0.0755634 Test Loss: 0.0866108
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0747141
	speed: 0.0898s/iter; left time: 1721.8217s
	iters: 200, epoch: 15 | loss: 0.0715218
	speed: 0.0449s/iter; left time: 856.3445s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.33s
Steps: 224 | Train Loss: 0.0732544 Vali Loss: 0.0754703 Test Loss: 0.0863815
Validation loss decreased (0.075521 --> 0.075470).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0757171
	speed: 0.1318s/iter; left time: 2496.1738s
	iters: 200, epoch: 16 | loss: 0.0741671
	speed: 0.0439s/iter; left time: 826.9063s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.52s
Steps: 224 | Train Loss: 0.0730401 Vali Loss: 0.0754147 Test Loss: 0.0865284
Validation loss decreased (0.075470 --> 0.075415).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0738392
	speed: 0.0886s/iter; left time: 1658.1517s
	iters: 200, epoch: 17 | loss: 0.0738164
	speed: 0.0532s/iter; left time: 990.5307s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.22s
Steps: 224 | Train Loss: 0.0727451 Vali Loss: 0.0753884 Test Loss: 0.0866636
Validation loss decreased (0.075415 --> 0.075388).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0709763
	speed: 0.0946s/iter; left time: 1749.5390s
	iters: 200, epoch: 18 | loss: 0.0730822
	speed: 0.0481s/iter; left time: 884.0656s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.17s
Steps: 224 | Train Loss: 0.0725751 Vali Loss: 0.0753965 Test Loss: 0.0865688
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0742952
	speed: 0.0884s/iter; left time: 1614.6894s
	iters: 200, epoch: 19 | loss: 0.0760767
	speed: 0.0481s/iter; left time: 874.2227s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.80s
Steps: 224 | Train Loss: 0.0724123 Vali Loss: 0.0755017 Test Loss: 0.0866896
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0718111
	speed: 0.0877s/iter; left time: 1582.9746s
	iters: 200, epoch: 20 | loss: 0.0710565
	speed: 0.0445s/iter; left time: 797.8902s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.69s
Steps: 224 | Train Loss: 0.0723087 Vali Loss: 0.0754631 Test Loss: 0.0866524
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0719257
	speed: 0.0792s/iter; left time: 1412.1959s
	iters: 200, epoch: 21 | loss: 0.0696810
	speed: 0.0440s/iter; left time: 780.2878s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0721695 Vali Loss: 0.0753144 Test Loss: 0.0863799
Validation loss decreased (0.075388 --> 0.075314).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0725704
	speed: 0.0797s/iter; left time: 1402.1948s
	iters: 200, epoch: 22 | loss: 0.0757288
	speed: 0.0451s/iter; left time: 789.4212s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0720685 Vali Loss: 0.0754024 Test Loss: 0.0867224
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0705284
	speed: 0.0779s/iter; left time: 1353.3379s
	iters: 200, epoch: 23 | loss: 0.0728130
	speed: 0.0435s/iter; left time: 750.8516s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0718940 Vali Loss: 0.0753721 Test Loss: 0.0865993
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0695775
	speed: 0.0795s/iter; left time: 1364.1229s
	iters: 200, epoch: 24 | loss: 0.0694624
	speed: 0.0442s/iter; left time: 754.1921s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.07s
Steps: 224 | Train Loss: 0.0718041 Vali Loss: 0.0755413 Test Loss: 0.0868192
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0702295
	speed: 0.0801s/iter; left time: 1355.2470s
	iters: 200, epoch: 25 | loss: 0.0673121
	speed: 0.0441s/iter; left time: 741.3721s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.05s
Steps: 224 | Train Loss: 0.0717452 Vali Loss: 0.0753333 Test Loss: 0.0865029
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0699733
	speed: 0.0797s/iter; left time: 1330.2455s
	iters: 200, epoch: 26 | loss: 0.0694492
	speed: 0.0441s/iter; left time: 732.8181s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.11s
Steps: 224 | Train Loss: 0.0716570 Vali Loss: 0.0753502 Test Loss: 0.0866323
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0750768
	speed: 0.0805s/iter; left time: 1326.4382s
	iters: 200, epoch: 27 | loss: 0.0676697
	speed: 0.0434s/iter; left time: 711.0155s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0715888 Vali Loss: 0.0753193 Test Loss: 0.0866331
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0697221
	speed: 0.0787s/iter; left time: 1279.2560s
	iters: 200, epoch: 28 | loss: 0.0742003
	speed: 0.0445s/iter; left time: 718.5614s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.05s
Steps: 224 | Train Loss: 0.0714908 Vali Loss: 0.0753599 Test Loss: 0.0865416
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0737176
	speed: 0.0802s/iter; left time: 1286.2247s
	iters: 200, epoch: 29 | loss: 0.0728098
	speed: 0.0435s/iter; left time: 692.9588s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.11s
Steps: 224 | Train Loss: 0.0714532 Vali Loss: 0.0753859 Test Loss: 0.0867439
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0677266
	speed: 0.0799s/iter; left time: 1263.2798s
	iters: 200, epoch: 30 | loss: 0.0682861
	speed: 0.0440s/iter; left time: 691.6303s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0713848 Vali Loss: 0.0754361 Test Loss: 0.0865617
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0686235
	speed: 0.0793s/iter; left time: 1235.7145s
	iters: 200, epoch: 31 | loss: 0.0683744
	speed: 0.0431s/iter; left time: 667.1399s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0713562 Vali Loss: 0.0753999 Test Loss: 0.0868126
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018505122512578964, rmse:0.1360335350036621, mae:0.08637991547584534, rse:0.39962559938430786
Intermediate time for ES and pred_len 96: 00h:15m:23.53s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1582002
	speed: 0.0627s/iter; left time: 1392.8210s
	iters: 200, epoch: 1 | loss: 0.1504422
	speed: 0.0426s/iter; left time: 941.7732s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.94s
Steps: 223 | Train Loss: 0.1638853 Vali Loss: 0.1523434 Test Loss: 0.1819368
Validation loss decreased (inf --> 0.152343).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0989957
	speed: 0.0782s/iter; left time: 1719.1541s
	iters: 200, epoch: 2 | loss: 0.0933139
	speed: 0.0427s/iter; left time: 933.3875s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.76s
Steps: 223 | Train Loss: 0.1013221 Vali Loss: 0.0892732 Test Loss: 0.1013731
Validation loss decreased (0.152343 --> 0.089273).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0939221
	speed: 0.0775s/iter; left time: 1685.8470s
	iters: 200, epoch: 3 | loss: 0.0870873
	speed: 0.0426s/iter; left time: 922.7571s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0888086 Vali Loss: 0.0861637 Test Loss: 0.0980787
Validation loss decreased (0.089273 --> 0.086164).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0854114
	speed: 0.0776s/iter; left time: 1670.6925s
	iters: 200, epoch: 4 | loss: 0.0838073
	speed: 0.0426s/iter; left time: 912.5106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.73s
Steps: 223 | Train Loss: 0.0857859 Vali Loss: 0.0842218 Test Loss: 0.0960832
Validation loss decreased (0.086164 --> 0.084222).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0821497
	speed: 0.0772s/iter; left time: 1645.1318s
	iters: 200, epoch: 5 | loss: 0.0822526
	speed: 0.0426s/iter; left time: 902.6846s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0838813 Vali Loss: 0.0834715 Test Loss: 0.0949565
Validation loss decreased (0.084222 --> 0.083471).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0830588
	speed: 0.0779s/iter; left time: 1642.6264s
	iters: 200, epoch: 6 | loss: 0.0822484
	speed: 0.0425s/iter; left time: 892.9373s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.75s
Steps: 223 | Train Loss: 0.0827285 Vali Loss: 0.0832899 Test Loss: 0.0945786
Validation loss decreased (0.083471 --> 0.083290).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0846333
	speed: 0.0770s/iter; left time: 1606.7264s
	iters: 200, epoch: 7 | loss: 0.0803458
	speed: 0.0426s/iter; left time: 884.0972s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0819744 Vali Loss: 0.0828027 Test Loss: 0.0940958
Validation loss decreased (0.083290 --> 0.082803).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0823168
	speed: 0.0771s/iter; left time: 1591.3274s
	iters: 200, epoch: 8 | loss: 0.0828552
	speed: 0.0426s/iter; left time: 875.5362s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0813660 Vali Loss: 0.0828556 Test Loss: 0.0939133
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0780621
	speed: 0.0768s/iter; left time: 1567.9788s
	iters: 200, epoch: 9 | loss: 0.0816576
	speed: 0.0427s/iter; left time: 867.6342s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.78s
Steps: 223 | Train Loss: 0.0808007 Vali Loss: 0.0826950 Test Loss: 0.0937721
Validation loss decreased (0.082803 --> 0.082695).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0775661
	speed: 0.0964s/iter; left time: 1947.1080s
	iters: 200, epoch: 10 | loss: 0.0774189
	speed: 0.0426s/iter; left time: 856.2542s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.82s
Steps: 223 | Train Loss: 0.0802986 Vali Loss: 0.0825369 Test Loss: 0.0934516
Validation loss decreased (0.082695 --> 0.082537).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0796763
	speed: 0.0781s/iter; left time: 1560.4622s
	iters: 200, epoch: 11 | loss: 0.0782240
	speed: 0.0429s/iter; left time: 852.5089s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.83s
Steps: 223 | Train Loss: 0.0798780 Vali Loss: 0.0824189 Test Loss: 0.0934367
Validation loss decreased (0.082537 --> 0.082419).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0813513
	speed: 0.0784s/iter; left time: 1548.8565s
	iters: 200, epoch: 12 | loss: 0.0797516
	speed: 0.0426s/iter; left time: 837.5143s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.78s
Steps: 223 | Train Loss: 0.0794918 Vali Loss: 0.0824583 Test Loss: 0.0934083
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0798676
	speed: 0.0767s/iter; left time: 1498.4231s
	iters: 200, epoch: 13 | loss: 0.0763271
	speed: 0.0427s/iter; left time: 828.7557s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0791038 Vali Loss: 0.0821107 Test Loss: 0.0937554
Validation loss decreased (0.082419 --> 0.082111).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0794068
	speed: 0.0782s/iter; left time: 1509.0850s
	iters: 200, epoch: 14 | loss: 0.0772176
	speed: 0.0429s/iter; left time: 824.3264s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.88s
Steps: 223 | Train Loss: 0.0787783 Vali Loss: 0.0821921 Test Loss: 0.0937325
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0795014
	speed: 0.0776s/iter; left time: 1479.8416s
	iters: 200, epoch: 15 | loss: 0.0759366
	speed: 0.0426s/iter; left time: 808.6619s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.74s
Steps: 223 | Train Loss: 0.0784788 Vali Loss: 0.0824661 Test Loss: 0.0939714
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786937
	speed: 0.0771s/iter; left time: 1452.9907s
	iters: 200, epoch: 16 | loss: 0.0787571
	speed: 0.0426s/iter; left time: 798.9364s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.76s
Steps: 223 | Train Loss: 0.0782784 Vali Loss: 0.0822087 Test Loss: 0.0945132
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0774266
	speed: 0.0768s/iter; left time: 1430.4289s
	iters: 200, epoch: 17 | loss: 0.0766618
	speed: 0.0426s/iter; left time: 788.8493s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0780505 Vali Loss: 0.0822913 Test Loss: 0.0946241
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0793561
	speed: 0.0764s/iter; left time: 1405.9621s
	iters: 200, epoch: 18 | loss: 0.0766027
	speed: 0.0427s/iter; left time: 781.6684s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.74s
Steps: 223 | Train Loss: 0.0778071 Vali Loss: 0.0824921 Test Loss: 0.0951358
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0807288
	speed: 0.0761s/iter; left time: 1383.5080s
	iters: 200, epoch: 19 | loss: 0.0765183
	speed: 0.0426s/iter; left time: 771.2372s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0776330 Vali Loss: 0.0822682 Test Loss: 0.0952981
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0763897
	speed: 0.0766s/iter; left time: 1375.7542s
	iters: 200, epoch: 20 | loss: 0.0792303
	speed: 0.0426s/iter; left time: 760.7483s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0775091 Vali Loss: 0.0822907 Test Loss: 0.0952427
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0762942
	speed: 0.0763s/iter; left time: 1354.1459s
	iters: 200, epoch: 21 | loss: 0.0771212
	speed: 0.0426s/iter; left time: 750.9135s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0773324 Vali Loss: 0.0822556 Test Loss: 0.0953331
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0753811
	speed: 0.0762s/iter; left time: 1335.6703s
	iters: 200, epoch: 22 | loss: 0.0768200
	speed: 0.0426s/iter; left time: 741.4790s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0772267 Vali Loss: 0.0820854 Test Loss: 0.0957104
Validation loss decreased (0.082111 --> 0.082085).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0765416
	speed: 0.0770s/iter; left time: 1332.0961s
	iters: 200, epoch: 23 | loss: 0.0776889
	speed: 0.0426s/iter; left time: 732.1593s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0770907 Vali Loss: 0.0822180 Test Loss: 0.0957075
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0802181
	speed: 0.0778s/iter; left time: 1327.7908s
	iters: 200, epoch: 24 | loss: 0.0708010
	speed: 0.0428s/iter; left time: 725.5914s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.86s
Steps: 223 | Train Loss: 0.0769400 Vali Loss: 0.0820887 Test Loss: 0.0957013
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0785841
	speed: 0.0768s/iter; left time: 1293.5946s
	iters: 200, epoch: 25 | loss: 0.0719926
	speed: 0.0426s/iter; left time: 713.7501s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0768448 Vali Loss: 0.0822283 Test Loss: 0.0959574
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0766644
	speed: 0.0760s/iter; left time: 1263.3435s
	iters: 200, epoch: 26 | loss: 0.0741731
	speed: 0.0425s/iter; left time: 702.8940s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0767627 Vali Loss: 0.0821415 Test Loss: 0.0960435
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0779996
	speed: 0.0758s/iter; left time: 1244.1082s
	iters: 200, epoch: 27 | loss: 0.0773505
	speed: 0.0426s/iter; left time: 694.1549s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0766876 Vali Loss: 0.0821087 Test Loss: 0.0960073
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0762004
	speed: 0.0762s/iter; left time: 1233.6128s
	iters: 200, epoch: 28 | loss: 0.0732721
	speed: 0.0426s/iter; left time: 684.3079s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0766399 Vali Loss: 0.0821509 Test Loss: 0.0961446
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0777855
	speed: 0.0757s/iter; left time: 1207.1792s
	iters: 200, epoch: 29 | loss: 0.0782245
	speed: 0.0425s/iter; left time: 674.0474s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0765682 Vali Loss: 0.0822768 Test Loss: 0.0963000
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0783652
	speed: 0.0757s/iter; left time: 1191.0149s
	iters: 200, epoch: 30 | loss: 0.0760999
	speed: 0.0426s/iter; left time: 665.4889s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0765361 Vali Loss: 0.0823724 Test Loss: 0.0966561
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0737685
	speed: 0.0761s/iter; left time: 1179.6887s
	iters: 200, epoch: 31 | loss: 0.0757145
	speed: 0.0426s/iter; left time: 656.4695s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0764457 Vali Loss: 0.0821356 Test Loss: 0.0963666
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0770690
	speed: 0.0760s/iter; left time: 1162.2512s
	iters: 200, epoch: 32 | loss: 0.0798712
	speed: 0.0426s/iter; left time: 646.8957s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0763819 Vali Loss: 0.0822384 Test Loss: 0.0966226
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021373990923166275, rmse:0.14619846642017365, mae:0.09571041911840439, rse:0.4295179545879364
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1623213
	speed: 0.0443s/iter; left time: 983.0044s
	iters: 200, epoch: 1 | loss: 0.1507847
	speed: 0.0424s/iter; left time: 937.8931s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.1635632 Vali Loss: 0.1513731 Test Loss: 0.1804650
Validation loss decreased (inf --> 0.151373).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0967694
	speed: 0.0798s/iter; left time: 1753.0825s
	iters: 200, epoch: 2 | loss: 0.0900421
	speed: 0.0425s/iter; left time: 929.6121s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.1009800 Vali Loss: 0.0887405 Test Loss: 0.1008240
Validation loss decreased (0.151373 --> 0.088740).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0906517
	speed: 0.1047s/iter; left time: 2278.7332s
	iters: 200, epoch: 3 | loss: 0.0844556
	speed: 0.0425s/iter; left time: 921.3390s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0886283 Vali Loss: 0.0860639 Test Loss: 0.0981020
Validation loss decreased (0.088740 --> 0.086064).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0862825
	speed: 0.0946s/iter; left time: 2036.0942s
	iters: 200, epoch: 4 | loss: 0.0867988
	speed: 0.0424s/iter; left time: 909.2479s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0857093 Vali Loss: 0.0843615 Test Loss: 0.0962627
Validation loss decreased (0.086064 --> 0.084361).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0855029
	speed: 0.0833s/iter; left time: 1775.0499s
	iters: 200, epoch: 5 | loss: 0.0834127
	speed: 0.0425s/iter; left time: 901.1619s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0839361 Vali Loss: 0.0838893 Test Loss: 0.0956411
Validation loss decreased (0.084361 --> 0.083889).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0834710
	speed: 0.0783s/iter; left time: 1651.8429s
	iters: 200, epoch: 6 | loss: 0.0811198
	speed: 0.0425s/iter; left time: 891.7014s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0828296 Vali Loss: 0.0837776 Test Loss: 0.0951267
Validation loss decreased (0.083889 --> 0.083778).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0861155
	speed: 0.0770s/iter; left time: 1605.6841s
	iters: 200, epoch: 7 | loss: 0.0855570
	speed: 0.0425s/iter; left time: 882.7584s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0820855 Vali Loss: 0.0831758 Test Loss: 0.0944226
Validation loss decreased (0.083778 --> 0.083176).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0832355
	speed: 0.0770s/iter; left time: 1589.2364s
	iters: 200, epoch: 8 | loss: 0.0795388
	speed: 0.0425s/iter; left time: 873.1991s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0814745 Vali Loss: 0.0831434 Test Loss: 0.0941327
Validation loss decreased (0.083176 --> 0.083143).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0795199
	speed: 0.0766s/iter; left time: 1563.0382s
	iters: 200, epoch: 9 | loss: 0.0825877
	speed: 0.0425s/iter; left time: 862.7033s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0809013 Vali Loss: 0.0832683 Test Loss: 0.0939217
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0840776
	speed: 0.0758s/iter; left time: 1530.1837s
	iters: 200, epoch: 10 | loss: 0.0821245
	speed: 0.0425s/iter; left time: 854.9921s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0804636 Vali Loss: 0.0829914 Test Loss: 0.0936194
Validation loss decreased (0.083143 --> 0.082991).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0797929
	speed: 0.0770s/iter; left time: 1538.2168s
	iters: 200, epoch: 11 | loss: 0.0799730
	speed: 0.0425s/iter; left time: 844.1887s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0800309 Vali Loss: 0.0829647 Test Loss: 0.0932871
Validation loss decreased (0.082991 --> 0.082965).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0810702
	speed: 0.0768s/iter; left time: 1515.7670s
	iters: 200, epoch: 12 | loss: 0.0835351
	speed: 0.0425s/iter; left time: 835.8600s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0796978 Vali Loss: 0.0829677 Test Loss: 0.0933932
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0758945
	speed: 0.0757s/iter; left time: 1479.0157s
	iters: 200, epoch: 13 | loss: 0.0817818
	speed: 0.0425s/iter; left time: 825.0099s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0793328 Vali Loss: 0.0829195 Test Loss: 0.0931888
Validation loss decreased (0.082965 --> 0.082920).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0800635
	speed: 0.0772s/iter; left time: 1490.3276s
	iters: 200, epoch: 14 | loss: 0.0825971
	speed: 0.0426s/iter; left time: 817.4157s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0789841 Vali Loss: 0.0826235 Test Loss: 0.0933784
Validation loss decreased (0.082920 --> 0.082624).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0811006
	speed: 0.0766s/iter; left time: 1461.9138s
	iters: 200, epoch: 15 | loss: 0.0775294
	speed: 0.0425s/iter; left time: 806.5005s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0787673 Vali Loss: 0.0826715 Test Loss: 0.0933170
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0789641
	speed: 0.0757s/iter; left time: 1428.3418s
	iters: 200, epoch: 16 | loss: 0.0824256
	speed: 0.0425s/iter; left time: 797.5231s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0785044 Vali Loss: 0.0825806 Test Loss: 0.0933613
Validation loss decreased (0.082624 --> 0.082581).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0765666
	speed: 0.0785s/iter; left time: 1461.7693s
	iters: 200, epoch: 17 | loss: 0.0772372
	speed: 0.0425s/iter; left time: 788.3513s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0781951 Vali Loss: 0.0824544 Test Loss: 0.0936698
Validation loss decreased (0.082581 --> 0.082454).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0735902
	speed: 0.0769s/iter; left time: 1415.0900s
	iters: 200, epoch: 18 | loss: 0.0794902
	speed: 0.0425s/iter; left time: 777.5588s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0779698 Vali Loss: 0.0825212 Test Loss: 0.0938011
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0772863
	speed: 0.0757s/iter; left time: 1377.1688s
	iters: 200, epoch: 19 | loss: 0.0747855
	speed: 0.0425s/iter; left time: 769.3198s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0777663 Vali Loss: 0.0825519 Test Loss: 0.0940492
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0817482
	speed: 0.0752s/iter; left time: 1350.6536s
	iters: 200, epoch: 20 | loss: 0.0781768
	speed: 0.0425s/iter; left time: 758.9742s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0776105 Vali Loss: 0.0823942 Test Loss: 0.0938594
Validation loss decreased (0.082454 --> 0.082394).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0749328
	speed: 0.0770s/iter; left time: 1366.7279s
	iters: 200, epoch: 21 | loss: 0.0789955
	speed: 0.0425s/iter; left time: 749.0346s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0774189 Vali Loss: 0.0823355 Test Loss: 0.0942890
Validation loss decreased (0.082394 --> 0.082336).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0805455
	speed: 0.0782s/iter; left time: 1369.4373s
	iters: 200, epoch: 22 | loss: 0.0754221
	speed: 0.0425s/iter; left time: 741.0549s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0773240 Vali Loss: 0.0822265 Test Loss: 0.0943614
Validation loss decreased (0.082336 --> 0.082226).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0787228
	speed: 0.0766s/iter; left time: 1324.1679s
	iters: 200, epoch: 23 | loss: 0.0742987
	speed: 0.0425s/iter; left time: 731.1060s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0772184 Vali Loss: 0.0823955 Test Loss: 0.0947567
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0775053
	speed: 0.0755s/iter; left time: 1289.7837s
	iters: 200, epoch: 24 | loss: 0.0773024
	speed: 0.0425s/iter; left time: 720.7688s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0770285 Vali Loss: 0.0822210 Test Loss: 0.0943585
Validation loss decreased (0.082226 --> 0.082221).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0765192
	speed: 0.0774s/iter; left time: 1304.1396s
	iters: 200, epoch: 25 | loss: 0.0779399
	speed: 0.0425s/iter; left time: 711.6443s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0769189 Vali Loss: 0.0821099 Test Loss: 0.0946129
Validation loss decreased (0.082221 --> 0.082110).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0753684
	speed: 0.0765s/iter; left time: 1271.9256s
	iters: 200, epoch: 26 | loss: 0.0782473
	speed: 0.0425s/iter; left time: 702.6278s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0768195 Vali Loss: 0.0822617 Test Loss: 0.0949533
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0764916
	speed: 0.0759s/iter; left time: 1244.3974s
	iters: 200, epoch: 27 | loss: 0.0755978
	speed: 0.0425s/iter; left time: 692.9470s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0767680 Vali Loss: 0.0822143 Test Loss: 0.0950215
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0734486
	speed: 0.0756s/iter; left time: 1222.4507s
	iters: 200, epoch: 28 | loss: 0.0753237
	speed: 0.0425s/iter; left time: 683.8366s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0767142 Vali Loss: 0.0821859 Test Loss: 0.0945747
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0775932
	speed: 0.0753s/iter; left time: 1201.2036s
	iters: 200, epoch: 29 | loss: 0.0780666
	speed: 0.0425s/iter; left time: 673.9516s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0765791 Vali Loss: 0.0820457 Test Loss: 0.0951564
Validation loss decreased (0.082110 --> 0.082046).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0747046
	speed: 0.0762s/iter; left time: 1199.6400s
	iters: 200, epoch: 30 | loss: 0.0805135
	speed: 0.0425s/iter; left time: 665.2047s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0765586 Vali Loss: 0.0822913 Test Loss: 0.0951025
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0762359
	speed: 0.0764s/iter; left time: 1185.5860s
	iters: 200, epoch: 31 | loss: 0.0755212
	speed: 0.0426s/iter; left time: 655.8050s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0764912 Vali Loss: 0.0820334 Test Loss: 0.0949782
Validation loss decreased (0.082046 --> 0.082033).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0777004
	speed: 0.0774s/iter; left time: 1183.8726s
	iters: 200, epoch: 32 | loss: 0.0789844
	speed: 0.0425s/iter; left time: 645.8433s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0763796 Vali Loss: 0.0821568 Test Loss: 0.0956396
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0738203
	speed: 0.0753s/iter; left time: 1133.8288s
	iters: 200, epoch: 33 | loss: 0.0756400
	speed: 0.0425s/iter; left time: 636.0645s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0763773 Vali Loss: 0.0821474 Test Loss: 0.0955317
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0754073
	speed: 0.0756s/iter; left time: 1121.8630s
	iters: 200, epoch: 34 | loss: 0.0707455
	speed: 0.0424s/iter; left time: 625.6582s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0763250 Vali Loss: 0.0821367 Test Loss: 0.0955293
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0779735
	speed: 0.0761s/iter; left time: 1113.0678s
	iters: 200, epoch: 35 | loss: 0.0737309
	speed: 0.0425s/iter; left time: 617.1891s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0762472 Vali Loss: 0.0820737 Test Loss: 0.0954533
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0777511
	speed: 0.0757s/iter; left time: 1089.2019s
	iters: 200, epoch: 36 | loss: 0.0743867
	speed: 0.0425s/iter; left time: 607.7874s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0762374 Vali Loss: 0.0821034 Test Loss: 0.0954588
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0752488
	speed: 0.0754s/iter; left time: 1069.0803s
	iters: 200, epoch: 37 | loss: 0.0746293
	speed: 0.0425s/iter; left time: 597.4920s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0762136 Vali Loss: 0.0821561 Test Loss: 0.0956381
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0745010
	speed: 0.0755s/iter; left time: 1053.0512s
	iters: 200, epoch: 38 | loss: 0.0772252
	speed: 0.0425s/iter; left time: 589.0239s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0762028 Vali Loss: 0.0821295 Test Loss: 0.0955146
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0767802
	speed: 0.0757s/iter; left time: 1038.6736s
	iters: 200, epoch: 39 | loss: 0.0752683
	speed: 0.0426s/iter; left time: 579.8641s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0761856 Vali Loss: 0.0820946 Test Loss: 0.0955351
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0760245
	speed: 0.0756s/iter; left time: 1021.2602s
	iters: 200, epoch: 40 | loss: 0.0747323
	speed: 0.0425s/iter; left time: 569.1966s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0761252 Vali Loss: 0.0821186 Test Loss: 0.0957213
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0742132
	speed: 0.0755s/iter; left time: 1002.3750s
	iters: 200, epoch: 41 | loss: 0.0766348
	speed: 0.0425s/iter; left time: 559.5432s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0760819 Vali Loss: 0.0822180 Test Loss: 0.0961468
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021038100123405457, rmse:0.14504516124725342, mae:0.09497818350791931, rse:0.42612963914871216
Intermediate time for ES and pred_len 168: 00h:14m:49.56sIntermediate time for ES: 00h:58m:05.59s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1121947
	speed: 0.0616s/iter; left time: 1374.4072s
	iters: 200, epoch: 1 | loss: 0.1003998
	speed: 0.0419s/iter; left time: 930.0531s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.81s
Steps: 224 | Train Loss: 0.1124252 Vali Loss: 0.1140230 Test Loss: 0.1257952
Validation loss decreased (inf --> 0.114023).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0552393
	speed: 0.0758s/iter; left time: 1672.7063s
	iters: 200, epoch: 2 | loss: 0.0489163
	speed: 0.0419s/iter; left time: 920.0890s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0612217 Vali Loss: 0.0596655 Test Loss: 0.0627740
Validation loss decreased (0.114023 --> 0.059665).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0480090
	speed: 0.0751s/iter; left time: 1642.0388s
	iters: 200, epoch: 3 | loss: 0.0485542
	speed: 0.0419s/iter; left time: 911.6539s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0487076 Vali Loss: 0.0571585 Test Loss: 0.0603112
Validation loss decreased (0.059665 --> 0.057158).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0447154
	speed: 0.0762s/iter; left time: 1648.6851s
	iters: 200, epoch: 4 | loss: 0.0429314
	speed: 0.0419s/iter; left time: 902.9101s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0464313 Vali Loss: 0.0554574 Test Loss: 0.0589497
Validation loss decreased (0.057158 --> 0.055457).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0423501
	speed: 0.0769s/iter; left time: 1645.4209s
	iters: 200, epoch: 5 | loss: 0.0467467
	speed: 0.0419s/iter; left time: 892.0272s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0449963 Vali Loss: 0.0544936 Test Loss: 0.0579954
Validation loss decreased (0.055457 --> 0.054494).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0428498
	speed: 0.0767s/iter; left time: 1624.9825s
	iters: 200, epoch: 6 | loss: 0.0431722
	speed: 0.0419s/iter; left time: 882.9913s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0438708 Vali Loss: 0.0535841 Test Loss: 0.0572606
Validation loss decreased (0.054494 --> 0.053584).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0450463
	speed: 0.0750s/iter; left time: 1571.3184s
	iters: 200, epoch: 7 | loss: 0.0422882
	speed: 0.0419s/iter; left time: 873.1714s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0432172 Vali Loss: 0.0532738 Test Loss: 0.0568294
Validation loss decreased (0.053584 --> 0.053274).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0423689
	speed: 0.0750s/iter; left time: 1555.0621s
	iters: 200, epoch: 8 | loss: 0.0431759
	speed: 0.0418s/iter; left time: 863.2603s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0426508 Vali Loss: 0.0527346 Test Loss: 0.0564877
Validation loss decreased (0.053274 --> 0.052735).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0423538
	speed: 0.0751s/iter; left time: 1539.7498s
	iters: 200, epoch: 9 | loss: 0.0434452
	speed: 0.0418s/iter; left time: 853.9411s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0422342 Vali Loss: 0.0526336 Test Loss: 0.0563798
Validation loss decreased (0.052735 --> 0.052634).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0398495
	speed: 0.0748s/iter; left time: 1517.5962s
	iters: 200, epoch: 10 | loss: 0.0404127
	speed: 0.0419s/iter; left time: 845.1454s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0419349 Vali Loss: 0.0524291 Test Loss: 0.0560434
Validation loss decreased (0.052634 --> 0.052429).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0450116
	speed: 0.0759s/iter; left time: 1522.7725s
	iters: 200, epoch: 11 | loss: 0.0409348
	speed: 0.0419s/iter; left time: 835.8467s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0416426 Vali Loss: 0.0523388 Test Loss: 0.0560597
Validation loss decreased (0.052429 --> 0.052339).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0402090
	speed: 0.0752s/iter; left time: 1491.2999s
	iters: 200, epoch: 12 | loss: 0.0399124
	speed: 0.0419s/iter; left time: 826.9813s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0414412 Vali Loss: 0.0522899 Test Loss: 0.0560075
Validation loss decreased (0.052339 --> 0.052290).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0402795
	speed: 0.0752s/iter; left time: 1474.5507s
	iters: 200, epoch: 13 | loss: 0.0442635
	speed: 0.0419s/iter; left time: 816.8372s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0412266 Vali Loss: 0.0521753 Test Loss: 0.0559162
Validation loss decreased (0.052290 --> 0.052175).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0446919
	speed: 0.0757s/iter; left time: 1467.3655s
	iters: 200, epoch: 14 | loss: 0.0414494
	speed: 0.0418s/iter; left time: 806.5237s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0410329 Vali Loss: 0.0520798 Test Loss: 0.0556257
Validation loss decreased (0.052175 --> 0.052080).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0421744
	speed: 0.0752s/iter; left time: 1440.4107s
	iters: 200, epoch: 15 | loss: 0.0421534
	speed: 0.0418s/iter; left time: 797.2709s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0408562 Vali Loss: 0.0522112 Test Loss: 0.0558546
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0408129
	speed: 0.0745s/iter; left time: 1410.9069s
	iters: 200, epoch: 16 | loss: 0.0392103
	speed: 0.0419s/iter; left time: 788.7272s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0407342 Vali Loss: 0.0521150 Test Loss: 0.0556049
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0377135
	speed: 0.0743s/iter; left time: 1390.6428s
	iters: 200, epoch: 17 | loss: 0.0385958
	speed: 0.0419s/iter; left time: 779.2561s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0406220 Vali Loss: 0.0520192 Test Loss: 0.0556480
Validation loss decreased (0.052080 --> 0.052019).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0409500
	speed: 0.0752s/iter; left time: 1390.7876s
	iters: 200, epoch: 18 | loss: 0.0358631
	speed: 0.0419s/iter; left time: 770.1107s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0404933 Vali Loss: 0.0520228 Test Loss: 0.0554515
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0379888
	speed: 0.0744s/iter; left time: 1359.0458s
	iters: 200, epoch: 19 | loss: 0.0403270
	speed: 0.0418s/iter; left time: 759.4074s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0404586 Vali Loss: 0.0519224 Test Loss: 0.0554611
Validation loss decreased (0.052019 --> 0.051922).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0409930
	speed: 0.0752s/iter; left time: 1356.5940s
	iters: 200, epoch: 20 | loss: 0.0405406
	speed: 0.0418s/iter; left time: 749.5649s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0403426 Vali Loss: 0.0520369 Test Loss: 0.0555618
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0371660
	speed: 0.0744s/iter; left time: 1326.5618s
	iters: 200, epoch: 21 | loss: 0.0402139
	speed: 0.0419s/iter; left time: 742.1534s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0402404 Vali Loss: 0.0519488 Test Loss: 0.0553637
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0398164
	speed: 0.0742s/iter; left time: 1304.9531s
	iters: 200, epoch: 22 | loss: 0.0436726
	speed: 0.0418s/iter; left time: 731.1433s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0401827 Vali Loss: 0.0519050 Test Loss: 0.0553965
Validation loss decreased (0.051922 --> 0.051905).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0383529
	speed: 0.0755s/iter; left time: 1312.1832s
	iters: 200, epoch: 23 | loss: 0.0441570
	speed: 0.0418s/iter; left time: 721.9769s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0400947 Vali Loss: 0.0519855 Test Loss: 0.0553256
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0421799
	speed: 0.0747s/iter; left time: 1280.7122s
	iters: 200, epoch: 24 | loss: 0.0399955
	speed: 0.0419s/iter; left time: 714.2296s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0400648 Vali Loss: 0.0518750 Test Loss: 0.0554042
Validation loss decreased (0.051905 --> 0.051875).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0394646
	speed: 0.0755s/iter; left time: 1278.0270s
	iters: 200, epoch: 25 | loss: 0.0383344
	speed: 0.0418s/iter; left time: 703.8966s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0400411 Vali Loss: 0.0519205 Test Loss: 0.0554544
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0413884
	speed: 0.0747s/iter; left time: 1247.6525s
	iters: 200, epoch: 26 | loss: 0.0399774
	speed: 0.0418s/iter; left time: 694.4407s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0399985 Vali Loss: 0.0519550 Test Loss: 0.0554619
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0379206
	speed: 0.0743s/iter; left time: 1223.5739s
	iters: 200, epoch: 27 | loss: 0.0381168
	speed: 0.0418s/iter; left time: 685.0295s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0399392 Vali Loss: 0.0518430 Test Loss: 0.0552859
Validation loss decreased (0.051875 --> 0.051843).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0418810
	speed: 0.0751s/iter; left time: 1220.8654s
	iters: 200, epoch: 28 | loss: 0.0435387
	speed: 0.0418s/iter; left time: 675.3219s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0399106 Vali Loss: 0.0518326 Test Loss: 0.0552616
Validation loss decreased (0.051843 --> 0.051833).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0398603
	speed: 0.0751s/iter; left time: 1203.2948s
	iters: 200, epoch: 29 | loss: 0.0391199
	speed: 0.0418s/iter; left time: 666.2721s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0398559 Vali Loss: 0.0517640 Test Loss: 0.0552997
Validation loss decreased (0.051833 --> 0.051764).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0415632
	speed: 0.0750s/iter; left time: 1184.8973s
	iters: 200, epoch: 30 | loss: 0.0422339
	speed: 0.0419s/iter; left time: 657.5951s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0398787 Vali Loss: 0.0519103 Test Loss: 0.0553084
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0399636
	speed: 0.0751s/iter; left time: 1169.8527s
	iters: 200, epoch: 31 | loss: 0.0369008
	speed: 0.0419s/iter; left time: 648.5113s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0398472 Vali Loss: 0.0518308 Test Loss: 0.0553513
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0412430
	speed: 0.0745s/iter; left time: 1144.2156s
	iters: 200, epoch: 32 | loss: 0.0370305
	speed: 0.0419s/iter; left time: 639.0005s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0398461 Vali Loss: 0.0517918 Test Loss: 0.0553053
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0375985
	speed: 0.0746s/iter; left time: 1128.6510s
	iters: 200, epoch: 33 | loss: 0.0408965
	speed: 0.0419s/iter; left time: 629.4461s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0397410 Vali Loss: 0.0518667 Test Loss: 0.0553178
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0425997
	speed: 0.0745s/iter; left time: 1111.3305s
	iters: 200, epoch: 34 | loss: 0.0426921
	speed: 0.0418s/iter; left time: 619.3543s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0397880 Vali Loss: 0.0518058 Test Loss: 0.0552537
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0403167
	speed: 0.0752s/iter; left time: 1104.1239s
	iters: 200, epoch: 35 | loss: 0.0391564
	speed: 0.0419s/iter; left time: 611.4084s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0397668 Vali Loss: 0.0518420 Test Loss: 0.0553296
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0378390
	speed: 0.0743s/iter; left time: 1074.8417s
	iters: 200, epoch: 36 | loss: 0.0453756
	speed: 0.0419s/iter; left time: 602.2926s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0397611 Vali Loss: 0.0517751 Test Loss: 0.0553614
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0439057
	speed: 0.0750s/iter; left time: 1067.3460s
	iters: 200, epoch: 37 | loss: 0.0392089
	speed: 0.0419s/iter; left time: 591.6651s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0397189 Vali Loss: 0.0518174 Test Loss: 0.0553212
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0399152
	speed: 0.0763s/iter; left time: 1068.7099s
	iters: 200, epoch: 38 | loss: 0.0420879
	speed: 0.0419s/iter; left time: 582.2897s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0397264 Vali Loss: 0.0517921 Test Loss: 0.0552313
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0389435
	speed: 0.0745s/iter; left time: 1027.9415s
	iters: 200, epoch: 39 | loss: 0.0397875
	speed: 0.0419s/iter; left time: 573.4031s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0396921 Vali Loss: 0.0518452 Test Loss: 0.0552375
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01012234017252922, rmse:0.10060983896255493, mae:0.05529971793293953, rse:0.3881499767303467
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1097454
	speed: 0.0434s/iter; left time: 968.2699s
	iters: 200, epoch: 1 | loss: 0.1002832
	speed: 0.0419s/iter; left time: 929.1925s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.1106880 Vali Loss: 0.1126629 Test Loss: 0.1250687
Validation loss decreased (inf --> 0.112663).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0544365
	speed: 0.0749s/iter; left time: 1654.1496s
	iters: 200, epoch: 2 | loss: 0.0556558
	speed: 0.0418s/iter; left time: 918.7284s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0617991 Vali Loss: 0.0603117 Test Loss: 0.0635018
Validation loss decreased (0.112663 --> 0.060312).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0518334
	speed: 0.0751s/iter; left time: 1640.6910s
	iters: 200, epoch: 3 | loss: 0.0479707
	speed: 0.0419s/iter; left time: 910.6689s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0490852 Vali Loss: 0.0573255 Test Loss: 0.0607568
Validation loss decreased (0.060312 --> 0.057326).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0464834
	speed: 0.0750s/iter; left time: 1621.4002s
	iters: 200, epoch: 4 | loss: 0.0456835
	speed: 0.0418s/iter; left time: 900.5722s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0467785 Vali Loss: 0.0556423 Test Loss: 0.0590097
Validation loss decreased (0.057326 --> 0.055642).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0453287
	speed: 0.0748s/iter; left time: 1601.1447s
	iters: 200, epoch: 5 | loss: 0.0429152
	speed: 0.0419s/iter; left time: 892.0913s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0452205 Vali Loss: 0.0545473 Test Loss: 0.0580783
Validation loss decreased (0.055642 --> 0.054547).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0394759
	speed: 0.0765s/iter; left time: 1620.3665s
	iters: 200, epoch: 6 | loss: 0.0427372
	speed: 0.0419s/iter; left time: 882.4276s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0442165 Vali Loss: 0.0534045 Test Loss: 0.0573112
Validation loss decreased (0.054547 --> 0.053404).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0455463
	speed: 0.0749s/iter; left time: 1569.5681s
	iters: 200, epoch: 7 | loss: 0.0445603
	speed: 0.0419s/iter; left time: 874.4966s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0433700 Vali Loss: 0.0530924 Test Loss: 0.0570183
Validation loss decreased (0.053404 --> 0.053092).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0449817
	speed: 0.0751s/iter; left time: 1556.6396s
	iters: 200, epoch: 8 | loss: 0.0429298
	speed: 0.0420s/iter; left time: 865.7288s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0428334 Vali Loss: 0.0531420 Test Loss: 0.0565075
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0423502
	speed: 0.0743s/iter; left time: 1524.5959s
	iters: 200, epoch: 9 | loss: 0.0445846
	speed: 0.0418s/iter; left time: 853.8493s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0424026 Vali Loss: 0.0525870 Test Loss: 0.0563246
Validation loss decreased (0.053092 --> 0.052587).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0425135
	speed: 0.0749s/iter; left time: 1518.9674s
	iters: 200, epoch: 10 | loss: 0.0457547
	speed: 0.0419s/iter; left time: 845.5109s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0419955 Vali Loss: 0.0525711 Test Loss: 0.0565309
Validation loss decreased (0.052587 --> 0.052571).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0431648
	speed: 0.0745s/iter; left time: 1494.6285s
	iters: 200, epoch: 11 | loss: 0.0424161
	speed: 0.0419s/iter; left time: 835.9932s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0417232 Vali Loss: 0.0522938 Test Loss: 0.0558724
Validation loss decreased (0.052571 --> 0.052294).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0447426
	speed: 0.0749s/iter; left time: 1486.5755s
	iters: 200, epoch: 12 | loss: 0.0382844
	speed: 0.0419s/iter; left time: 827.1687s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0414626 Vali Loss: 0.0523507 Test Loss: 0.0559838
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0380325
	speed: 0.0741s/iter; left time: 1454.0632s
	iters: 200, epoch: 13 | loss: 0.0404050
	speed: 0.0419s/iter; left time: 817.2263s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0412239 Vali Loss: 0.0520597 Test Loss: 0.0557181
Validation loss decreased (0.052294 --> 0.052060).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0420314
	speed: 0.0746s/iter; left time: 1446.5701s
	iters: 200, epoch: 14 | loss: 0.0441814
	speed: 0.0418s/iter; left time: 807.0740s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0410656 Vali Loss: 0.0517921 Test Loss: 0.0556048
Validation loss decreased (0.052060 --> 0.051792).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0390570
	speed: 0.0755s/iter; left time: 1447.3233s
	iters: 200, epoch: 15 | loss: 0.0447538
	speed: 0.0419s/iter; left time: 798.8962s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0408988 Vali Loss: 0.0519798 Test Loss: 0.0555771
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0387387
	speed: 0.0742s/iter; left time: 1406.3297s
	iters: 200, epoch: 16 | loss: 0.0386383
	speed: 0.0419s/iter; left time: 789.1697s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0407904 Vali Loss: 0.0519261 Test Loss: 0.0554437
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0408869
	speed: 0.0740s/iter; left time: 1385.1167s
	iters: 200, epoch: 17 | loss: 0.0388287
	speed: 0.0418s/iter; left time: 778.8127s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0407096 Vali Loss: 0.0518903 Test Loss: 0.0554077
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0411886
	speed: 0.0740s/iter; left time: 1368.3384s
	iters: 200, epoch: 18 | loss: 0.0390267
	speed: 0.0419s/iter; left time: 770.6575s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0405676 Vali Loss: 0.0518208 Test Loss: 0.0553516
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0415021
	speed: 0.0747s/iter; left time: 1364.7439s
	iters: 200, epoch: 19 | loss: 0.0406355
	speed: 0.0419s/iter; left time: 761.4943s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0404403 Vali Loss: 0.0518093 Test Loss: 0.0553732
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0448347
	speed: 0.0742s/iter; left time: 1339.4886s
	iters: 200, epoch: 20 | loss: 0.0391173
	speed: 0.0419s/iter; left time: 752.3747s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0403546 Vali Loss: 0.0517789 Test Loss: 0.0553628
Validation loss decreased (0.051792 --> 0.051779).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0398589
	speed: 0.0749s/iter; left time: 1333.9295s
	iters: 200, epoch: 21 | loss: 0.0381496
	speed: 0.0418s/iter; left time: 741.4750s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0402457 Vali Loss: 0.0518312 Test Loss: 0.0552614
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0385531
	speed: 0.0744s/iter; left time: 1308.5965s
	iters: 200, epoch: 22 | loss: 0.0400891
	speed: 0.0419s/iter; left time: 732.6646s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0401808 Vali Loss: 0.0517388 Test Loss: 0.0554081
Validation loss decreased (0.051779 --> 0.051739).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0384819
	speed: 0.0749s/iter; left time: 1300.4983s
	iters: 200, epoch: 23 | loss: 0.0368943
	speed: 0.0418s/iter; left time: 722.7025s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0401281 Vali Loss: 0.0517458 Test Loss: 0.0554174
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0401000
	speed: 0.0740s/iter; left time: 1268.9119s
	iters: 200, epoch: 24 | loss: 0.0394788
	speed: 0.0418s/iter; left time: 713.4735s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0401284 Vali Loss: 0.0517721 Test Loss: 0.0554288
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0411244
	speed: 0.0742s/iter; left time: 1255.8286s
	iters: 200, epoch: 25 | loss: 0.0381236
	speed: 0.0419s/iter; left time: 704.1363s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0400445 Vali Loss: 0.0515828 Test Loss: 0.0552302
Validation loss decreased (0.051739 --> 0.051583).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0426891
	speed: 0.0745s/iter; left time: 1244.0759s
	iters: 200, epoch: 26 | loss: 0.0411633
	speed: 0.0420s/iter; left time: 696.7170s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0399843 Vali Loss: 0.0516705 Test Loss: 0.0553208
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0387271
	speed: 0.0741s/iter; left time: 1220.1777s
	iters: 200, epoch: 27 | loss: 0.0394193
	speed: 0.0418s/iter; left time: 685.3459s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0399810 Vali Loss: 0.0517005 Test Loss: 0.0552868
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0415462
	speed: 0.0742s/iter; left time: 1206.3162s
	iters: 200, epoch: 28 | loss: 0.0391410
	speed: 0.0418s/iter; left time: 675.3667s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0399579 Vali Loss: 0.0515849 Test Loss: 0.0552142
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0436352
	speed: 0.0745s/iter; left time: 1194.7335s
	iters: 200, epoch: 29 | loss: 0.0375349
	speed: 0.0419s/iter; left time: 667.0952s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0398951 Vali Loss: 0.0516627 Test Loss: 0.0551619
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0356513
	speed: 0.0740s/iter; left time: 1169.8539s
	iters: 200, epoch: 30 | loss: 0.0385870
	speed: 0.0419s/iter; left time: 657.7856s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0398974 Vali Loss: 0.0516312 Test Loss: 0.0551637
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0412497
	speed: 0.0741s/iter; left time: 1153.7925s
	iters: 200, epoch: 31 | loss: 0.0410214
	speed: 0.0419s/iter; left time: 647.9484s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0398423 Vali Loss: 0.0515021 Test Loss: 0.0551850
Validation loss decreased (0.051583 --> 0.051502).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0411650
	speed: 0.0746s/iter; left time: 1145.7192s
	iters: 200, epoch: 32 | loss: 0.0411897
	speed: 0.0419s/iter; left time: 638.6201s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0398447 Vali Loss: 0.0516524 Test Loss: 0.0552015
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0414264
	speed: 0.0740s/iter; left time: 1120.0349s
	iters: 200, epoch: 33 | loss: 0.0373195
	speed: 0.0418s/iter; left time: 628.1793s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0398136 Vali Loss: 0.0515943 Test Loss: 0.0551456
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0420447
	speed: 0.0739s/iter; left time: 1102.4725s
	iters: 200, epoch: 34 | loss: 0.0418415
	speed: 0.0419s/iter; left time: 620.0623s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0397582 Vali Loss: 0.0515836 Test Loss: 0.0551158
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0439957
	speed: 0.0738s/iter; left time: 1083.5330s
	iters: 200, epoch: 35 | loss: 0.0377602
	speed: 0.0418s/iter; left time: 609.9313s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0398037 Vali Loss: 0.0516123 Test Loss: 0.0551900
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0440431
	speed: 0.0744s/iter; left time: 1075.2332s
	iters: 200, epoch: 36 | loss: 0.0373870
	speed: 0.0419s/iter; left time: 601.3410s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0397717 Vali Loss: 0.0515656 Test Loss: 0.0551841
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0430282
	speed: 0.0740s/iter; left time: 1053.7770s
	iters: 200, epoch: 37 | loss: 0.0413177
	speed: 0.0418s/iter; left time: 590.7529s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0397954 Vali Loss: 0.0515806 Test Loss: 0.0551719
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0357447
	speed: 0.0741s/iter; left time: 1038.3779s
	iters: 200, epoch: 38 | loss: 0.0371809
	speed: 0.0419s/iter; left time: 582.5323s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0397360 Vali Loss: 0.0515720 Test Loss: 0.0551558
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0388872
	speed: 0.0741s/iter; left time: 1021.1464s
	iters: 200, epoch: 39 | loss: 0.0369145
	speed: 0.0419s/iter; left time: 573.2722s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0397296 Vali Loss: 0.0516767 Test Loss: 0.0551596
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0407941
	speed: 0.0740s/iter; left time: 1003.7769s
	iters: 200, epoch: 40 | loss: 0.0428946
	speed: 0.0419s/iter; left time: 564.1471s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0397577 Vali Loss: 0.0515838 Test Loss: 0.0551644
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0428438
	speed: 0.0740s/iter; left time: 986.6249s
	iters: 200, epoch: 41 | loss: 0.0403244
	speed: 0.0419s/iter; left time: 554.7694s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0397225 Vali Loss: 0.0517354 Test Loss: 0.0551707
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010068370029330254, rmse:0.10034126788377762, mae:0.05518501251935959, rse:0.3871138393878937
Intermediate time for FR and pred_len 24: 00h:15m:43.59s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1153915
	speed: 0.0624s/iter; left time: 1391.7446s
	iters: 200, epoch: 1 | loss: 0.1060928
	speed: 0.0421s/iter; left time: 935.7581s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.89s
Steps: 224 | Train Loss: 0.1190758 Vali Loss: 0.1222350 Test Loss: 0.1367866
Validation loss decreased (inf --> 0.122235).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0703590
	speed: 0.0772s/iter; left time: 1704.1421s
	iters: 200, epoch: 2 | loss: 0.0631227
	speed: 0.0422s/iter; left time: 927.1204s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0741752 Vali Loss: 0.0765218 Test Loss: 0.0841672
Validation loss decreased (0.122235 --> 0.076522).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0638842
	speed: 0.0775s/iter; left time: 1693.0687s
	iters: 200, epoch: 3 | loss: 0.0638510
	speed: 0.0422s/iter; left time: 918.6860s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0637024 Vali Loss: 0.0740111 Test Loss: 0.0829004
Validation loss decreased (0.076522 --> 0.074011).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0599669
	speed: 0.0774s/iter; left time: 1673.1504s
	iters: 200, epoch: 4 | loss: 0.0602428
	speed: 0.0422s/iter; left time: 907.7448s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0613726 Vali Loss: 0.0729702 Test Loss: 0.0828571
Validation loss decreased (0.074011 --> 0.072970).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0608108
	speed: 0.0765s/iter; left time: 1637.6600s
	iters: 200, epoch: 5 | loss: 0.0596332
	speed: 0.0421s/iter; left time: 897.8885s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0599371 Vali Loss: 0.0722665 Test Loss: 0.0831574
Validation loss decreased (0.072970 --> 0.072266).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0591320
	speed: 0.0770s/iter; left time: 1630.0226s
	iters: 200, epoch: 6 | loss: 0.0609036
	speed: 0.0422s/iter; left time: 889.8677s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0590100 Vali Loss: 0.0717653 Test Loss: 0.0822677
Validation loss decreased (0.072266 --> 0.071765).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0570013
	speed: 0.0778s/iter; left time: 1630.2538s
	iters: 200, epoch: 7 | loss: 0.0558092
	speed: 0.0423s/iter; left time: 881.5445s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0583290 Vali Loss: 0.0718643 Test Loss: 0.0817473
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0584184
	speed: 0.0772s/iter; left time: 1601.3778s
	iters: 200, epoch: 8 | loss: 0.0561043
	speed: 0.0422s/iter; left time: 870.5535s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.74s
Steps: 224 | Train Loss: 0.0577498 Vali Loss: 0.0716929 Test Loss: 0.0819808
Validation loss decreased (0.071765 --> 0.071693).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0547079
	speed: 0.0776s/iter; left time: 1590.5815s
	iters: 200, epoch: 9 | loss: 0.0589732
	speed: 0.0422s/iter; left time: 861.0019s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0572604 Vali Loss: 0.0716615 Test Loss: 0.0817608
Validation loss decreased (0.071693 --> 0.071662).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0549507
	speed: 0.0771s/iter; left time: 1563.3897s
	iters: 200, epoch: 10 | loss: 0.0595628
	speed: 0.0421s/iter; left time: 850.5176s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0569233 Vali Loss: 0.0713719 Test Loss: 0.0818009
Validation loss decreased (0.071662 --> 0.071372).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0583551
	speed: 0.0763s/iter; left time: 1531.2724s
	iters: 200, epoch: 11 | loss: 0.0565592
	speed: 0.0422s/iter; left time: 842.2938s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0565333 Vali Loss: 0.0717262 Test Loss: 0.0822539
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0552871
	speed: 0.0763s/iter; left time: 1513.4371s
	iters: 200, epoch: 12 | loss: 0.0534210
	speed: 0.0422s/iter; left time: 833.0360s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0562415 Vali Loss: 0.0716062 Test Loss: 0.0821118
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0572377
	speed: 0.0761s/iter; left time: 1491.5899s
	iters: 200, epoch: 13 | loss: 0.0547919
	speed: 0.0422s/iter; left time: 822.9085s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0560026 Vali Loss: 0.0715299 Test Loss: 0.0820022
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0594103
	speed: 0.0772s/iter; left time: 1496.0266s
	iters: 200, epoch: 14 | loss: 0.0563948
	speed: 0.0424s/iter; left time: 818.5080s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.74s
Steps: 224 | Train Loss: 0.0557053 Vali Loss: 0.0715743 Test Loss: 0.0825353
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0562952
	speed: 0.0766s/iter; left time: 1468.4562s
	iters: 200, epoch: 15 | loss: 0.0543950
	speed: 0.0422s/iter; left time: 805.1294s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0554924 Vali Loss: 0.0715357 Test Loss: 0.0822632
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0568288
	speed: 0.0767s/iter; left time: 1453.3149s
	iters: 200, epoch: 16 | loss: 0.0553723
	speed: 0.0422s/iter; left time: 795.4848s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0552482 Vali Loss: 0.0717300 Test Loss: 0.0825441
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0568050
	speed: 0.0768s/iter; left time: 1437.3798s
	iters: 200, epoch: 17 | loss: 0.0549970
	speed: 0.0422s/iter; left time: 786.3956s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0550776 Vali Loss: 0.0714888 Test Loss: 0.0823092
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0559789
	speed: 0.0767s/iter; left time: 1419.1503s
	iters: 200, epoch: 18 | loss: 0.0549825
	speed: 0.0421s/iter; left time: 774.1720s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0549379 Vali Loss: 0.0716566 Test Loss: 0.0824809
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0559283
	speed: 0.0768s/iter; left time: 1403.8936s
	iters: 200, epoch: 19 | loss: 0.0576035
	speed: 0.0421s/iter; left time: 765.1507s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.75s
Steps: 224 | Train Loss: 0.0547359 Vali Loss: 0.0717991 Test Loss: 0.0826052
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0550359
	speed: 0.0766s/iter; left time: 1381.6697s
	iters: 200, epoch: 20 | loss: 0.0536892
	speed: 0.0422s/iter; left time: 756.7837s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0545703 Vali Loss: 0.0716234 Test Loss: 0.0824642
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019618265330791473, rmse:0.14006522297859192, mae:0.08180088549852371, rse:0.5418094992637634
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1183382
	speed: 0.0437s/iter; left time: 974.3214s
	iters: 200, epoch: 1 | loss: 0.1067132
	speed: 0.0421s/iter; left time: 935.1136s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.1185646 Vali Loss: 0.1221652 Test Loss: 0.1369242
Validation loss decreased (inf --> 0.122165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0710205
	speed: 0.0773s/iter; left time: 1707.0127s
	iters: 200, epoch: 2 | loss: 0.0608164
	speed: 0.0421s/iter; left time: 926.3223s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0749036 Vali Loss: 0.0765365 Test Loss: 0.0847675
Validation loss decreased (0.122165 --> 0.076536).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0649917
	speed: 0.0764s/iter; left time: 1668.8608s
	iters: 200, epoch: 3 | loss: 0.0605547
	speed: 0.0421s/iter; left time: 916.4090s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0638909 Vali Loss: 0.0741018 Test Loss: 0.0832592
Validation loss decreased (0.076536 --> 0.074102).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0593064
	speed: 0.0761s/iter; left time: 1647.0304s
	iters: 200, epoch: 4 | loss: 0.0614190
	speed: 0.0421s/iter; left time: 905.8797s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0614330 Vali Loss: 0.0730869 Test Loss: 0.0835192
Validation loss decreased (0.074102 --> 0.073087).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0564989
	speed: 0.0767s/iter; left time: 1642.1587s
	iters: 200, epoch: 5 | loss: 0.0585219
	speed: 0.0421s/iter; left time: 897.7183s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0599615 Vali Loss: 0.0721415 Test Loss: 0.0823667
Validation loss decreased (0.073087 --> 0.072142).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0572291
	speed: 0.0759s/iter; left time: 1608.0054s
	iters: 200, epoch: 6 | loss: 0.0590202
	speed: 0.0422s/iter; left time: 888.8761s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0590873 Vali Loss: 0.0719854 Test Loss: 0.0822540
Validation loss decreased (0.072142 --> 0.071985).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0584348
	speed: 0.0762s/iter; left time: 1597.6538s
	iters: 200, epoch: 7 | loss: 0.0593594
	speed: 0.0422s/iter; left time: 879.6564s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0583521 Vali Loss: 0.0719110 Test Loss: 0.0827368
Validation loss decreased (0.071985 --> 0.071911).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0565943
	speed: 0.0763s/iter; left time: 1581.1418s
	iters: 200, epoch: 8 | loss: 0.0581434
	speed: 0.0422s/iter; left time: 869.9349s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0577961 Vali Loss: 0.0715724 Test Loss: 0.0823652
Validation loss decreased (0.071911 --> 0.071572).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0559165
	speed: 0.0762s/iter; left time: 1562.1366s
	iters: 200, epoch: 9 | loss: 0.0555138
	speed: 0.0421s/iter; left time: 860.1257s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0573474 Vali Loss: 0.0714440 Test Loss: 0.0819069
Validation loss decreased (0.071572 --> 0.071444).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0537653
	speed: 0.0892s/iter; left time: 1808.9242s
	iters: 200, epoch: 10 | loss: 0.0534346
	speed: 0.0422s/iter; left time: 851.2254s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0569286 Vali Loss: 0.0715755 Test Loss: 0.0818373
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0572650
	speed: 0.0752s/iter; left time: 1509.2995s
	iters: 200, epoch: 11 | loss: 0.0564079
	speed: 0.0422s/iter; left time: 842.0089s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0565144 Vali Loss: 0.0715929 Test Loss: 0.0819250
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0553930
	speed: 0.0754s/iter; left time: 1495.0413s
	iters: 200, epoch: 12 | loss: 0.0512815
	speed: 0.0421s/iter; left time: 831.1557s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0562026 Vali Loss: 0.0716908 Test Loss: 0.0820340
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0598023
	speed: 0.0754s/iter; left time: 1477.9890s
	iters: 200, epoch: 13 | loss: 0.0541688
	speed: 0.0421s/iter; left time: 821.8251s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0559420 Vali Loss: 0.0715412 Test Loss: 0.0819712
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0563550
	speed: 0.0755s/iter; left time: 1464.3693s
	iters: 200, epoch: 14 | loss: 0.0574557
	speed: 0.0422s/iter; left time: 813.4812s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0556303 Vali Loss: 0.0716937 Test Loss: 0.0818968
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0598165
	speed: 0.0754s/iter; left time: 1445.4423s
	iters: 200, epoch: 15 | loss: 0.0571043
	speed: 0.0421s/iter; left time: 803.5626s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0553934 Vali Loss: 0.0717617 Test Loss: 0.0820680
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0545634
	speed: 0.0752s/iter; left time: 1424.8424s
	iters: 200, epoch: 16 | loss: 0.0518719
	speed: 0.0421s/iter; left time: 793.8982s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0552036 Vali Loss: 0.0718749 Test Loss: 0.0818940
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0536293
	speed: 0.0756s/iter; left time: 1414.3057s
	iters: 200, epoch: 17 | loss: 0.0532682
	speed: 0.0421s/iter; left time: 783.4398s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0549504 Vali Loss: 0.0719338 Test Loss: 0.0821902
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0550838
	speed: 0.0757s/iter; left time: 1400.5497s
	iters: 200, epoch: 18 | loss: 0.0541445
	speed: 0.0422s/iter; left time: 775.9720s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0547627 Vali Loss: 0.0717970 Test Loss: 0.0820770
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0564983
	speed: 0.0757s/iter; left time: 1382.5145s
	iters: 200, epoch: 19 | loss: 0.0564426
	speed: 0.0421s/iter; left time: 765.0521s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0546047 Vali Loss: 0.0719225 Test Loss: 0.0821915
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019422350451350212, rmse:0.139364093542099, mae:0.08190689235925674, rse:0.5390973091125488
Intermediate time for FR and pred_len 96: 00h:07m:54.66s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1155179
	speed: 0.0637s/iter; left time: 1413.8900s
	iters: 200, epoch: 1 | loss: 0.1100524
	speed: 0.0425s/iter; left time: 940.3430s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.93s
Steps: 223 | Train Loss: 0.1203775 Vali Loss: 0.1246447 Test Loss: 0.1390694
Validation loss decreased (inf --> 0.124645).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0748355
	speed: 0.0768s/iter; left time: 1688.8321s
	iters: 200, epoch: 2 | loss: 0.0722877
	speed: 0.0426s/iter; left time: 931.1336s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.74s
Steps: 223 | Train Loss: 0.0777110 Vali Loss: 0.0800677 Test Loss: 0.0888488
Validation loss decreased (0.124645 --> 0.080068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0673887
	speed: 0.0769s/iter; left time: 1673.5104s
	iters: 200, epoch: 3 | loss: 0.0638294
	speed: 0.0426s/iter; left time: 921.4403s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0680442 Vali Loss: 0.0776311 Test Loss: 0.0878397
Validation loss decreased (0.080068 --> 0.077631).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0655597
	speed: 0.0765s/iter; left time: 1648.0794s
	iters: 200, epoch: 4 | loss: 0.0643643
	speed: 0.0426s/iter; left time: 912.3251s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0657154 Vali Loss: 0.0768263 Test Loss: 0.0878044
Validation loss decreased (0.077631 --> 0.076826).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0671170
	speed: 0.0771s/iter; left time: 1642.3895s
	iters: 200, epoch: 5 | loss: 0.0653071
	speed: 0.0426s/iter; left time: 903.7616s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0642069 Vali Loss: 0.0759690 Test Loss: 0.0875316
Validation loss decreased (0.076826 --> 0.075969).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0666012
	speed: 0.0772s/iter; left time: 1627.9053s
	iters: 200, epoch: 6 | loss: 0.0617591
	speed: 0.0426s/iter; left time: 893.7971s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.75s
Steps: 223 | Train Loss: 0.0632363 Vali Loss: 0.0758135 Test Loss: 0.0876818
Validation loss decreased (0.075969 --> 0.075813).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0585363
	speed: 0.0764s/iter; left time: 1593.3725s
	iters: 200, epoch: 7 | loss: 0.0633577
	speed: 0.0426s/iter; left time: 883.8353s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0625940 Vali Loss: 0.0755322 Test Loss: 0.0875475
Validation loss decreased (0.075813 --> 0.075532).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0626959
	speed: 0.0771s/iter; left time: 1592.1634s
	iters: 200, epoch: 8 | loss: 0.0624156
	speed: 0.0425s/iter; left time: 873.9450s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.73s
Steps: 223 | Train Loss: 0.0619335 Vali Loss: 0.0756845 Test Loss: 0.0881885
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0658133
	speed: 0.0755s/iter; left time: 1540.5036s
	iters: 200, epoch: 9 | loss: 0.0612553
	speed: 0.0426s/iter; left time: 865.0256s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0614354 Vali Loss: 0.0754083 Test Loss: 0.0879239
Validation loss decreased (0.075532 --> 0.075408).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0571346
	speed: 0.0772s/iter; left time: 1558.3133s
	iters: 200, epoch: 10 | loss: 0.0608960
	speed: 0.0426s/iter; left time: 855.4101s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0609741 Vali Loss: 0.0752998 Test Loss: 0.0884806
Validation loss decreased (0.075408 --> 0.075300).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0601922
	speed: 0.0769s/iter; left time: 1535.2761s
	iters: 200, epoch: 11 | loss: 0.0642126
	speed: 0.0426s/iter; left time: 846.1209s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0605561 Vali Loss: 0.0755705 Test Loss: 0.0886884
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0595557
	speed: 0.0753s/iter; left time: 1486.7759s
	iters: 200, epoch: 12 | loss: 0.0635985
	speed: 0.0426s/iter; left time: 836.7248s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0601814 Vali Loss: 0.0755608 Test Loss: 0.0883276
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0604448
	speed: 0.0757s/iter; left time: 1477.2736s
	iters: 200, epoch: 13 | loss: 0.0586777
	speed: 0.0426s/iter; left time: 826.6970s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0598141 Vali Loss: 0.0753468 Test Loss: 0.0888019
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0574171
	speed: 0.0758s/iter; left time: 1462.6341s
	iters: 200, epoch: 14 | loss: 0.0605751
	speed: 0.0426s/iter; left time: 817.8952s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0595079 Vali Loss: 0.0756135 Test Loss: 0.0885193
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0583936
	speed: 0.0757s/iter; left time: 1444.8969s
	iters: 200, epoch: 15 | loss: 0.0582936
	speed: 0.0426s/iter; left time: 807.6200s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0591883 Vali Loss: 0.0754839 Test Loss: 0.0893167
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0576946
	speed: 0.0756s/iter; left time: 1424.6166s
	iters: 200, epoch: 16 | loss: 0.0599246
	speed: 0.0426s/iter; left time: 798.9218s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0589706 Vali Loss: 0.0754589 Test Loss: 0.0887578
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0570811
	speed: 0.0755s/iter; left time: 1407.5508s
	iters: 200, epoch: 17 | loss: 0.0559282
	speed: 0.0426s/iter; left time: 788.9323s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0587052 Vali Loss: 0.0757231 Test Loss: 0.0894269
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0592673
	speed: 0.0761s/iter; left time: 1401.6157s
	iters: 200, epoch: 18 | loss: 0.0587642
	speed: 0.0426s/iter; left time: 779.3803s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0584797 Vali Loss: 0.0757971 Test Loss: 0.0895223
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0581048
	speed: 0.0771s/iter; left time: 1402.8565s
	iters: 200, epoch: 19 | loss: 0.0556847
	speed: 0.0430s/iter; left time: 776.8796s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.85s
Steps: 223 | Train Loss: 0.0583845 Vali Loss: 0.0757172 Test Loss: 0.0894682
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0584915
	speed: 0.0764s/iter; left time: 1372.8196s
	iters: 200, epoch: 20 | loss: 0.0591433
	speed: 0.0425s/iter; left time: 759.4908s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0581833 Vali Loss: 0.0757980 Test Loss: 0.0896036
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02110251970589161, rmse:0.1452670693397522, mae:0.08848056942224503, rse:0.5626330971717834
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1188243
	speed: 0.0442s/iter; left time: 980.8067s
	iters: 200, epoch: 1 | loss: 0.1097503
	speed: 0.0425s/iter; left time: 939.6903s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.1206074 Vali Loss: 0.1249007 Test Loss: 0.1393432
Validation loss decreased (inf --> 0.124901).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0710360
	speed: 0.0765s/iter; left time: 1680.9727s
	iters: 200, epoch: 2 | loss: 0.0703140
	speed: 0.0425s/iter; left time: 929.9508s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0782399 Vali Loss: 0.0799150 Test Loss: 0.0890377
Validation loss decreased (0.124901 --> 0.079915).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0686920
	speed: 0.0771s/iter; left time: 1676.4317s
	iters: 200, epoch: 3 | loss: 0.0669794
	speed: 0.0426s/iter; left time: 921.8695s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0680045 Vali Loss: 0.0777030 Test Loss: 0.0883915
Validation loss decreased (0.079915 --> 0.077703).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0687920
	speed: 0.0768s/iter; left time: 1654.5862s
	iters: 200, epoch: 4 | loss: 0.0625754
	speed: 0.0425s/iter; left time: 911.3704s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0655856 Vali Loss: 0.0768370 Test Loss: 0.0883045
Validation loss decreased (0.077703 --> 0.076837).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0662790
	speed: 0.0766s/iter; left time: 1632.5732s
	iters: 200, epoch: 5 | loss: 0.0664349
	speed: 0.0425s/iter; left time: 901.3628s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0642683 Vali Loss: 0.0762139 Test Loss: 0.0878965
Validation loss decreased (0.076837 --> 0.076214).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0642509
	speed: 0.0764s/iter; left time: 1611.4528s
	iters: 200, epoch: 6 | loss: 0.0635850
	speed: 0.0426s/iter; left time: 893.1740s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0633435 Vali Loss: 0.0759457 Test Loss: 0.0877568
Validation loss decreased (0.076214 --> 0.075946).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0607359
	speed: 0.0762s/iter; left time: 1589.6072s
	iters: 200, epoch: 7 | loss: 0.0600543
	speed: 0.0425s/iter; left time: 883.1923s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0624938 Vali Loss: 0.0757794 Test Loss: 0.0877522
Validation loss decreased (0.075946 --> 0.075779).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0640830
	speed: 0.0764s/iter; left time: 1577.2283s
	iters: 200, epoch: 8 | loss: 0.0560839
	speed: 0.0425s/iter; left time: 873.3305s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0618970 Vali Loss: 0.0753602 Test Loss: 0.0876144
Validation loss decreased (0.075779 --> 0.075360).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0622873
	speed: 0.0765s/iter; left time: 1561.7475s
	iters: 200, epoch: 9 | loss: 0.0610187
	speed: 0.0425s/iter; left time: 863.4189s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0613768 Vali Loss: 0.0755588 Test Loss: 0.0880555
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0610971
	speed: 0.0764s/iter; left time: 1543.7533s
	iters: 200, epoch: 10 | loss: 0.0619647
	speed: 0.0425s/iter; left time: 854.0016s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0608380 Vali Loss: 0.0755213 Test Loss: 0.0878433
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0598250
	speed: 0.0752s/iter; left time: 1502.5919s
	iters: 200, epoch: 11 | loss: 0.0568953
	speed: 0.0424s/iter; left time: 843.3894s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.65s
Steps: 223 | Train Loss: 0.0604825 Vali Loss: 0.0753327 Test Loss: 0.0883517
Validation loss decreased (0.075360 --> 0.075333).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0650479
	speed: 0.0766s/iter; left time: 1511.9582s
	iters: 200, epoch: 12 | loss: 0.0589150
	speed: 0.0425s/iter; left time: 835.9401s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0600851 Vali Loss: 0.0752878 Test Loss: 0.0881361
Validation loss decreased (0.075333 --> 0.075288).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0590905
	speed: 0.0767s/iter; left time: 1496.7399s
	iters: 200, epoch: 13 | loss: 0.0612453
	speed: 0.0426s/iter; left time: 827.3764s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0597502 Vali Loss: 0.0754289 Test Loss: 0.0883999
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0635281
	speed: 0.0756s/iter; left time: 1459.6066s
	iters: 200, epoch: 14 | loss: 0.0579555
	speed: 0.0425s/iter; left time: 816.5466s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0594261 Vali Loss: 0.0753699 Test Loss: 0.0886773
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0597168
	speed: 0.0755s/iter; left time: 1440.9881s
	iters: 200, epoch: 15 | loss: 0.0604776
	speed: 0.0426s/iter; left time: 807.5723s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0591478 Vali Loss: 0.0751815 Test Loss: 0.0885951
Validation loss decreased (0.075288 --> 0.075181).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0589496
	speed: 0.0765s/iter; left time: 1442.7705s
	iters: 200, epoch: 16 | loss: 0.0610695
	speed: 0.0425s/iter; left time: 797.2114s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0589543 Vali Loss: 0.0751560 Test Loss: 0.0883089
Validation loss decreased (0.075181 --> 0.075156).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0550328
	speed: 0.0768s/iter; left time: 1431.0088s
	iters: 200, epoch: 17 | loss: 0.0588443
	speed: 0.0425s/iter; left time: 788.2971s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0587267 Vali Loss: 0.0753057 Test Loss: 0.0887895
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0589852
	speed: 0.0756s/iter; left time: 1392.1435s
	iters: 200, epoch: 18 | loss: 0.0540140
	speed: 0.0424s/iter; left time: 777.2582s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0585811 Vali Loss: 0.0752828 Test Loss: 0.0889161
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0613710
	speed: 0.0759s/iter; left time: 1380.8301s
	iters: 200, epoch: 19 | loss: 0.0610498
	speed: 0.0425s/iter; left time: 768.5218s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0583974 Vali Loss: 0.0751852 Test Loss: 0.0891550
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0590157
	speed: 0.0758s/iter; left time: 1362.3051s
	iters: 200, epoch: 20 | loss: 0.0577403
	speed: 0.0426s/iter; left time: 760.1266s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0581863 Vali Loss: 0.0754698 Test Loss: 0.0890949
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0588164
	speed: 0.0754s/iter; left time: 1338.3577s
	iters: 200, epoch: 21 | loss: 0.0568125
	speed: 0.0426s/iter; left time: 750.6408s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0580332 Vali Loss: 0.0751449 Test Loss: 0.0890774
Validation loss decreased (0.075156 --> 0.075145).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0591515
	speed: 0.0766s/iter; left time: 1341.7912s
	iters: 200, epoch: 22 | loss: 0.0634039
	speed: 0.0426s/iter; left time: 741.5917s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0579535 Vali Loss: 0.0754300 Test Loss: 0.0893191
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0592452
	speed: 0.0773s/iter; left time: 1336.1128s
	iters: 200, epoch: 23 | loss: 0.0575206
	speed: 0.0424s/iter; left time: 729.6740s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0578123 Vali Loss: 0.0751504 Test Loss: 0.0893139
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0615129
	speed: 0.0764s/iter; left time: 1303.9488s
	iters: 200, epoch: 24 | loss: 0.0616597
	speed: 0.0425s/iter; left time: 721.8551s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0577369 Vali Loss: 0.0753552 Test Loss: 0.0894956
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0577549
	speed: 0.0755s/iter; left time: 1271.8893s
	iters: 200, epoch: 25 | loss: 0.0567556
	speed: 0.0425s/iter; left time: 712.4959s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0577064 Vali Loss: 0.0753523 Test Loss: 0.0895203
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0556293
	speed: 0.0756s/iter; left time: 1256.2181s
	iters: 200, epoch: 26 | loss: 0.0592692
	speed: 0.0425s/iter; left time: 702.9587s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0575957 Vali Loss: 0.0752099 Test Loss: 0.0895419
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0605084
	speed: 0.0758s/iter; left time: 1243.0994s
	iters: 200, epoch: 27 | loss: 0.0537401
	speed: 0.0426s/iter; left time: 693.8953s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0574944 Vali Loss: 0.0752354 Test Loss: 0.0897313
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0553524
	speed: 0.0754s/iter; left time: 1219.6317s
	iters: 200, epoch: 28 | loss: 0.0644381
	speed: 0.0425s/iter; left time: 683.2132s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0574452 Vali Loss: 0.0751127 Test Loss: 0.0895886
Validation loss decreased (0.075145 --> 0.075113).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0528446
	speed: 0.0765s/iter; left time: 1220.0697s
	iters: 200, epoch: 29 | loss: 0.0540518
	speed: 0.0425s/iter; left time: 674.2099s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0573492 Vali Loss: 0.0753453 Test Loss: 0.0897618
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0544832
	speed: 0.0762s/iter; left time: 1198.7870s
	iters: 200, epoch: 30 | loss: 0.0593685
	speed: 0.0425s/iter; left time: 664.9390s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.71s
Steps: 223 | Train Loss: 0.0573188 Vali Loss: 0.0752593 Test Loss: 0.0897383
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0577189
	speed: 0.0758s/iter; left time: 1176.2468s
	iters: 200, epoch: 31 | loss: 0.0564524
	speed: 0.0425s/iter; left time: 654.6093s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0572871 Vali Loss: 0.0752722 Test Loss: 0.0897646
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0579591
	speed: 0.0754s/iter; left time: 1152.6390s
	iters: 200, epoch: 32 | loss: 0.0566821
	speed: 0.0425s/iter; left time: 646.1195s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0572057 Vali Loss: 0.0752317 Test Loss: 0.0898037
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0567452
	speed: 0.0757s/iter; left time: 1140.8596s
	iters: 200, epoch: 33 | loss: 0.0603444
	speed: 0.0425s/iter; left time: 636.3376s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0571794 Vali Loss: 0.0752111 Test Loss: 0.0897663
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0596642
	speed: 0.0764s/iter; left time: 1133.3197s
	iters: 200, epoch: 34 | loss: 0.0565170
	speed: 0.0425s/iter; left time: 626.2768s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0571641 Vali Loss: 0.0751075 Test Loss: 0.0896395
Validation loss decreased (0.075113 --> 0.075107).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0565159
	speed: 0.0762s/iter; left time: 1114.6455s
	iters: 200, epoch: 35 | loss: 0.0543115
	speed: 0.0424s/iter; left time: 616.1375s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0571129 Vali Loss: 0.0751775 Test Loss: 0.0898111
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0575157
	speed: 0.0756s/iter; left time: 1087.8771s
	iters: 200, epoch: 36 | loss: 0.0590963
	speed: 0.0424s/iter; left time: 606.7198s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0570837 Vali Loss: 0.0752165 Test Loss: 0.0898423
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0554018
	speed: 0.0762s/iter; left time: 1079.6209s
	iters: 200, epoch: 37 | loss: 0.0596231
	speed: 0.0426s/iter; left time: 599.0353s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0571097 Vali Loss: 0.0752624 Test Loss: 0.0898242
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0621724
	speed: 0.0756s/iter; left time: 1055.0102s
	iters: 200, epoch: 38 | loss: 0.0594966
	speed: 0.0425s/iter; left time: 589.2088s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0570916 Vali Loss: 0.0752899 Test Loss: 0.0897771
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0557170
	speed: 0.0754s/iter; left time: 1035.0082s
	iters: 200, epoch: 39 | loss: 0.0557038
	speed: 0.0425s/iter; left time: 579.5831s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0571168 Vali Loss: 0.0751440 Test Loss: 0.0898458
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0548218
	speed: 0.0757s/iter; left time: 1022.1383s
	iters: 200, epoch: 40 | loss: 0.0535119
	speed: 0.0425s/iter; left time: 569.0838s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0570778 Vali Loss: 0.0753414 Test Loss: 0.0898209
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0595047
	speed: 0.0753s/iter; left time: 1000.4601s
	iters: 200, epoch: 41 | loss: 0.0574232
	speed: 0.0425s/iter; left time: 560.1403s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0569935 Vali Loss: 0.0752454 Test Loss: 0.0898885
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0572772
	speed: 0.0754s/iter; left time: 984.8854s
	iters: 200, epoch: 42 | loss: 0.0556398
	speed: 0.0425s/iter; left time: 551.1102s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0570608 Vali Loss: 0.0753064 Test Loss: 0.0898839
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0548267
	speed: 0.0755s/iter; left time: 968.4376s
	iters: 200, epoch: 43 | loss: 0.0530517
	speed: 0.0426s/iter; left time: 541.8752s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0569894 Vali Loss: 0.0752069 Test Loss: 0.0898459
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0569659
	speed: 0.0756s/iter; left time: 953.2257s
	iters: 200, epoch: 44 | loss: 0.0594817
	speed: 0.0425s/iter; left time: 531.6506s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0569357 Vali Loss: 0.0752656 Test Loss: 0.0899255
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.022022612392902374, rmse:0.1484001725912094, mae:0.08963943272829056, rse:0.5747678875923157
Intermediate time for FR and pred_len 168: 00h:12m:50.76sIntermediate time for FR: 00h:36m:29.00s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1668762
	speed: 0.0632s/iter; left time: 1410.1924s
	iters: 200, epoch: 1 | loss: 0.1487154
	speed: 0.0419s/iter; left time: 929.4824s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.84s
Steps: 224 | Train Loss: 0.1647057 Vali Loss: 0.1381319 Test Loss: 0.1453384
Validation loss decreased (inf --> 0.138132).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0744973
	speed: 0.0743s/iter; left time: 1640.0870s
	iters: 200, epoch: 2 | loss: 0.0702725
	speed: 0.0419s/iter; left time: 920.5090s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0845355 Vali Loss: 0.0634649 Test Loss: 0.0669909
Validation loss decreased (0.138132 --> 0.063465).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0651665
	speed: 0.0744s/iter; left time: 1626.7381s
	iters: 200, epoch: 3 | loss: 0.0628549
	speed: 0.0419s/iter; left time: 911.2587s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0646237 Vali Loss: 0.0603763 Test Loss: 0.0639257
Validation loss decreased (0.063465 --> 0.060376).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0586132
	speed: 0.0749s/iter; left time: 1620.0159s
	iters: 200, epoch: 4 | loss: 0.0582620
	speed: 0.0420s/iter; left time: 903.6294s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0615983 Vali Loss: 0.0585471 Test Loss: 0.0621628
Validation loss decreased (0.060376 --> 0.058547).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0539563
	speed: 0.0746s/iter; left time: 1597.0395s
	iters: 200, epoch: 5 | loss: 0.0590897
	speed: 0.0419s/iter; left time: 891.8719s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0596819 Vali Loss: 0.0576238 Test Loss: 0.0609692
Validation loss decreased (0.058547 --> 0.057624).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0563761
	speed: 0.0749s/iter; left time: 1586.8317s
	iters: 200, epoch: 6 | loss: 0.0547008
	speed: 0.0418s/iter; left time: 881.5183s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0583187 Vali Loss: 0.0567941 Test Loss: 0.0601914
Validation loss decreased (0.057624 --> 0.056794).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0598481
	speed: 0.0750s/iter; left time: 1572.1981s
	iters: 200, epoch: 7 | loss: 0.0572359
	speed: 0.0419s/iter; left time: 873.4171s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0573916 Vali Loss: 0.0562816 Test Loss: 0.0596388
Validation loss decreased (0.056794 --> 0.056282).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0574251
	speed: 0.0748s/iter; left time: 1551.1427s
	iters: 200, epoch: 8 | loss: 0.0573186
	speed: 0.0419s/iter; left time: 863.5662s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0567434 Vali Loss: 0.0557669 Test Loss: 0.0591180
Validation loss decreased (0.056282 --> 0.055767).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0559022
	speed: 0.0743s/iter; left time: 1524.8342s
	iters: 200, epoch: 9 | loss: 0.0584287
	speed: 0.0419s/iter; left time: 854.7080s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0562328 Vali Loss: 0.0554319 Test Loss: 0.0587576
Validation loss decreased (0.055767 --> 0.055432).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0546298
	speed: 0.0744s/iter; left time: 1509.0385s
	iters: 200, epoch: 10 | loss: 0.0570061
	speed: 0.0419s/iter; left time: 845.1574s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0557634 Vali Loss: 0.0553139 Test Loss: 0.0584507
Validation loss decreased (0.055432 --> 0.055314).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0569785
	speed: 0.0745s/iter; left time: 1495.5312s
	iters: 200, epoch: 11 | loss: 0.0548771
	speed: 0.0418s/iter; left time: 834.8738s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0553908 Vali Loss: 0.0551920 Test Loss: 0.0583368
Validation loss decreased (0.055314 --> 0.055192).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0560274
	speed: 0.0755s/iter; left time: 1497.3163s
	iters: 200, epoch: 12 | loss: 0.0540077
	speed: 0.0419s/iter; left time: 826.0287s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0550622 Vali Loss: 0.0551127 Test Loss: 0.0582354
Validation loss decreased (0.055192 --> 0.055113).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0538228
	speed: 0.0747s/iter; left time: 1464.8836s
	iters: 200, epoch: 13 | loss: 0.0569437
	speed: 0.0419s/iter; left time: 817.2700s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0548389 Vali Loss: 0.0549542 Test Loss: 0.0579587
Validation loss decreased (0.055113 --> 0.054954).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0516178
	speed: 0.0745s/iter; left time: 1444.1845s
	iters: 200, epoch: 14 | loss: 0.0514003
	speed: 0.0419s/iter; left time: 807.5810s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0545595 Vali Loss: 0.0548756 Test Loss: 0.0579918
Validation loss decreased (0.054954 --> 0.054876).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0533713
	speed: 0.0750s/iter; left time: 1436.6809s
	iters: 200, epoch: 15 | loss: 0.0543369
	speed: 0.0418s/iter; left time: 797.7377s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0544265 Vali Loss: 0.0548448 Test Loss: 0.0579394
Validation loss decreased (0.054876 --> 0.054845).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0529609
	speed: 0.0745s/iter; left time: 1410.7601s
	iters: 200, epoch: 16 | loss: 0.0552985
	speed: 0.0419s/iter; left time: 788.8037s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0542592 Vali Loss: 0.0548368 Test Loss: 0.0579324
Validation loss decreased (0.054845 --> 0.054837).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0501005
	speed: 0.0750s/iter; left time: 1404.2534s
	iters: 200, epoch: 17 | loss: 0.0501565
	speed: 0.0419s/iter; left time: 779.5288s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0540546 Vali Loss: 0.0547614 Test Loss: 0.0578513
Validation loss decreased (0.054837 --> 0.054761).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0539889
	speed: 0.0746s/iter; left time: 1379.7234s
	iters: 200, epoch: 18 | loss: 0.0508451
	speed: 0.0419s/iter; left time: 770.2156s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0539890 Vali Loss: 0.0546531 Test Loss: 0.0577155
Validation loss decreased (0.054761 --> 0.054653).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0549342
	speed: 0.0755s/iter; left time: 1378.6877s
	iters: 200, epoch: 19 | loss: 0.0539790
	speed: 0.0419s/iter; left time: 760.4746s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0539062 Vali Loss: 0.0547521 Test Loss: 0.0577877
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0521993
	speed: 0.0742s/iter; left time: 1338.0701s
	iters: 200, epoch: 20 | loss: 0.0564071
	speed: 0.0418s/iter; left time: 750.8693s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0538328 Vali Loss: 0.0545932 Test Loss: 0.0576081
Validation loss decreased (0.054653 --> 0.054593).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0518346
	speed: 0.0741s/iter; left time: 1320.5455s
	iters: 200, epoch: 21 | loss: 0.0492195
	speed: 0.0419s/iter; left time: 741.7154s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0536230 Vali Loss: 0.0545515 Test Loss: 0.0576098
Validation loss decreased (0.054593 --> 0.054552).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0529903
	speed: 0.0752s/iter; left time: 1323.5637s
	iters: 200, epoch: 22 | loss: 0.0542470
	speed: 0.0419s/iter; left time: 732.3690s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0536617 Vali Loss: 0.0544110 Test Loss: 0.0575890
Validation loss decreased (0.054552 --> 0.054411).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0522088
	speed: 0.0746s/iter; left time: 1295.2877s
	iters: 200, epoch: 23 | loss: 0.0597315
	speed: 0.0419s/iter; left time: 723.3989s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0535213 Vali Loss: 0.0544596 Test Loss: 0.0575021
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0541264
	speed: 0.0743s/iter; left time: 1273.4573s
	iters: 200, epoch: 24 | loss: 0.0508696
	speed: 0.0419s/iter; left time: 713.8482s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0534724 Vali Loss: 0.0544801 Test Loss: 0.0575809
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0501939
	speed: 0.0744s/iter; left time: 1258.4504s
	iters: 200, epoch: 25 | loss: 0.0537891
	speed: 0.0419s/iter; left time: 704.2031s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0534406 Vali Loss: 0.0544176 Test Loss: 0.0574616
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0505069
	speed: 0.0743s/iter; left time: 1240.5247s
	iters: 200, epoch: 26 | loss: 0.0531720
	speed: 0.0418s/iter; left time: 694.4466s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0533208 Vali Loss: 0.0544965 Test Loss: 0.0575467
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0493177
	speed: 0.0745s/iter; left time: 1228.0542s
	iters: 200, epoch: 27 | loss: 0.0498824
	speed: 0.0418s/iter; left time: 685.0864s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0533288 Vali Loss: 0.0544455 Test Loss: 0.0574507
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0525627
	speed: 0.0736s/iter; left time: 1196.7454s
	iters: 200, epoch: 28 | loss: 0.0504644
	speed: 0.0418s/iter; left time: 675.7472s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0532673 Vali Loss: 0.0544091 Test Loss: 0.0574716
Validation loss decreased (0.054411 --> 0.054409).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0531574
	speed: 0.0747s/iter; left time: 1196.7584s
	iters: 200, epoch: 29 | loss: 0.0548535
	speed: 0.0418s/iter; left time: 665.3913s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0532243 Vali Loss: 0.0543962 Test Loss: 0.0574245
Validation loss decreased (0.054409 --> 0.054396).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0528839
	speed: 0.0749s/iter; left time: 1183.9542s
	iters: 200, epoch: 30 | loss: 0.0549718
	speed: 0.0419s/iter; left time: 657.6614s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0532229 Vali Loss: 0.0543955 Test Loss: 0.0574266
Validation loss decreased (0.054396 --> 0.054395).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0496521
	speed: 0.0744s/iter; left time: 1159.5301s
	iters: 200, epoch: 31 | loss: 0.0537042
	speed: 0.0418s/iter; left time: 647.6665s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0531766 Vali Loss: 0.0543635 Test Loss: 0.0573991
Validation loss decreased (0.054395 --> 0.054363).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0555401
	speed: 0.0743s/iter; left time: 1140.3479s
	iters: 200, epoch: 32 | loss: 0.0543907
	speed: 0.0418s/iter; left time: 638.1366s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0531708 Vali Loss: 0.0543848 Test Loss: 0.0573410
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0553831
	speed: 0.0738s/iter; left time: 1117.4445s
	iters: 200, epoch: 33 | loss: 0.0529029
	speed: 0.0419s/iter; left time: 629.6553s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0531169 Vali Loss: 0.0544931 Test Loss: 0.0574164
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0566949
	speed: 0.0743s/iter; left time: 1107.9614s
	iters: 200, epoch: 34 | loss: 0.0510905
	speed: 0.0418s/iter; left time: 619.4739s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0530960 Vali Loss: 0.0544281 Test Loss: 0.0574047
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0519415
	speed: 0.0739s/iter; left time: 1085.4541s
	iters: 200, epoch: 35 | loss: 0.0507861
	speed: 0.0418s/iter; left time: 609.8787s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0531171 Vali Loss: 0.0543847 Test Loss: 0.0573662
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0498729
	speed: 0.0737s/iter; left time: 1065.9495s
	iters: 200, epoch: 36 | loss: 0.0518879
	speed: 0.0418s/iter; left time: 600.9679s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0530941 Vali Loss: 0.0544304 Test Loss: 0.0573629
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0537743
	speed: 0.0737s/iter; left time: 1049.4746s
	iters: 200, epoch: 37 | loss: 0.0551615
	speed: 0.0418s/iter; left time: 591.5337s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0530242 Vali Loss: 0.0544074 Test Loss: 0.0573354
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0526531
	speed: 0.0735s/iter; left time: 1030.5877s
	iters: 200, epoch: 38 | loss: 0.0578634
	speed: 0.0418s/iter; left time: 582.0774s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0530546 Vali Loss: 0.0543200 Test Loss: 0.0573338
Validation loss decreased (0.054363 --> 0.054320).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0526937
	speed: 0.0746s/iter; left time: 1028.3645s
	iters: 200, epoch: 39 | loss: 0.0528568
	speed: 0.0418s/iter; left time: 572.5874s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0530138 Vali Loss: 0.0542319 Test Loss: 0.0573226
Validation loss decreased (0.054320 --> 0.054232).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0563120
	speed: 0.0744s/iter; left time: 1009.9058s
	iters: 200, epoch: 40 | loss: 0.0510091
	speed: 0.0418s/iter; left time: 562.9300s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0529836 Vali Loss: 0.0543886 Test Loss: 0.0573441
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0574817
	speed: 0.0749s/iter; left time: 998.7108s
	iters: 200, epoch: 41 | loss: 0.0560694
	speed: 0.0418s/iter; left time: 553.9175s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0530532 Vali Loss: 0.0543912 Test Loss: 0.0573497
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0537718
	speed: 0.0740s/iter; left time: 970.0687s
	iters: 200, epoch: 42 | loss: 0.0548852
	speed: 0.0418s/iter; left time: 544.3394s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0529759 Vali Loss: 0.0543679 Test Loss: 0.0573329
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0538681
	speed: 0.0739s/iter; left time: 952.8693s
	iters: 200, epoch: 43 | loss: 0.0495705
	speed: 0.0418s/iter; left time: 534.9789s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0529634 Vali Loss: 0.0542869 Test Loss: 0.0573246
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0502725
	speed: 0.0748s/iter; left time: 947.7138s
	iters: 200, epoch: 44 | loss: 0.0535956
	speed: 0.0419s/iter; left time: 526.2463s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0529778 Vali Loss: 0.0542852 Test Loss: 0.0573048
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0540188
	speed: 0.0736s/iter; left time: 916.5252s
	iters: 200, epoch: 45 | loss: 0.0544035
	speed: 0.0418s/iter; left time: 516.6321s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0529316 Vali Loss: 0.0543632 Test Loss: 0.0573138
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0547294
	speed: 0.0752s/iter; left time: 919.0130s
	iters: 200, epoch: 46 | loss: 0.0530386
	speed: 0.0419s/iter; left time: 507.4683s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0529451 Vali Loss: 0.0543928 Test Loss: 0.0573512
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0528816
	speed: 0.0743s/iter; left time: 891.8318s
	iters: 200, epoch: 47 | loss: 0.0518007
	speed: 0.0419s/iter; left time: 497.9292s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0529247 Vali Loss: 0.0543985 Test Loss: 0.0573596
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0547840
	speed: 0.0751s/iter; left time: 884.6809s
	iters: 200, epoch: 48 | loss: 0.0521973
	speed: 0.0419s/iter; left time: 488.5531s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0529457 Vali Loss: 0.0543617 Test Loss: 0.0573151
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0564644
	speed: 0.0737s/iter; left time: 851.5835s
	iters: 200, epoch: 49 | loss: 0.0526863
	speed: 0.0418s/iter; left time: 478.6633s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0529025 Vali Loss: 0.0543118 Test Loss: 0.0572813
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01028256956487894, rmse:0.10140300542116165, mae:0.05732264369726181, rse:0.383152037858963
Use GPU: cuda:0
>>>>>>>start training : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1616639
	speed: 0.0433s/iter; left time: 966.2199s
	iters: 200, epoch: 1 | loss: 0.1476239
	speed: 0.0418s/iter; left time: 927.3862s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.1636449 Vali Loss: 0.1371539 Test Loss: 0.1445717
Validation loss decreased (inf --> 0.137154).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0788116
	speed: 0.0744s/iter; left time: 1641.4583s
	iters: 200, epoch: 2 | loss: 0.0667151
	speed: 0.0419s/iter; left time: 919.8399s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0861281 Vali Loss: 0.0642575 Test Loss: 0.0675583
Validation loss decreased (0.137154 --> 0.064257).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0629694
	speed: 0.0742s/iter; left time: 1620.8953s
	iters: 200, epoch: 3 | loss: 0.0626399
	speed: 0.0419s/iter; left time: 910.8908s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0657113 Vali Loss: 0.0612823 Test Loss: 0.0645098
Validation loss decreased (0.064257 --> 0.061282).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0575715
	speed: 0.0747s/iter; left time: 1615.8757s
	iters: 200, epoch: 4 | loss: 0.0583651
	speed: 0.0418s/iter; left time: 900.9541s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0623427 Vali Loss: 0.0592041 Test Loss: 0.0625285
Validation loss decreased (0.061282 --> 0.059204).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582681
	speed: 0.0746s/iter; left time: 1596.8355s
	iters: 200, epoch: 5 | loss: 0.0600793
	speed: 0.0419s/iter; left time: 892.4960s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0600875 Vali Loss: 0.0575578 Test Loss: 0.0608771
Validation loss decreased (0.059204 --> 0.057558).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0581085
	speed: 0.0745s/iter; left time: 1579.0175s
	iters: 200, epoch: 6 | loss: 0.0590649
	speed: 0.0418s/iter; left time: 882.0444s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0586191 Vali Loss: 0.0568939 Test Loss: 0.0597674
Validation loss decreased (0.057558 --> 0.056894).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0588938
	speed: 0.0745s/iter; left time: 1561.6143s
	iters: 200, epoch: 7 | loss: 0.0554931
	speed: 0.0418s/iter; left time: 872.2843s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0575254 Vali Loss: 0.0565976 Test Loss: 0.0593791
Validation loss decreased (0.056894 --> 0.056598).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0574277
	speed: 0.0746s/iter; left time: 1547.6722s
	iters: 200, epoch: 8 | loss: 0.0596510
	speed: 0.0419s/iter; left time: 864.0850s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0567334 Vali Loss: 0.0560192 Test Loss: 0.0589414
Validation loss decreased (0.056598 --> 0.056019).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0523476
	speed: 0.0747s/iter; left time: 1533.0372s
	iters: 200, epoch: 9 | loss: 0.0539958
	speed: 0.0419s/iter; left time: 854.1976s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0562151 Vali Loss: 0.0557441 Test Loss: 0.0587535
Validation loss decreased (0.056019 --> 0.055744).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0577841
	speed: 0.0745s/iter; left time: 1510.8485s
	iters: 200, epoch: 10 | loss: 0.0528773
	speed: 0.0418s/iter; left time: 844.3316s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0557223 Vali Loss: 0.0554646 Test Loss: 0.0585298
Validation loss decreased (0.055744 --> 0.055465).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0538761
	speed: 0.0747s/iter; left time: 1498.1527s
	iters: 200, epoch: 11 | loss: 0.0553195
	speed: 0.0419s/iter; left time: 835.7565s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0553937 Vali Loss: 0.0552108 Test Loss: 0.0581949
Validation loss decreased (0.055465 --> 0.055211).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0535571
	speed: 0.0750s/iter; left time: 1488.3766s
	iters: 200, epoch: 12 | loss: 0.0548535
	speed: 0.0418s/iter; left time: 825.5009s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0550495 Vali Loss: 0.0551921 Test Loss: 0.0583735
Validation loss decreased (0.055211 --> 0.055192).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0553481
	speed: 0.0747s/iter; left time: 1464.5915s
	iters: 200, epoch: 13 | loss: 0.0544968
	speed: 0.0418s/iter; left time: 815.6076s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0547886 Vali Loss: 0.0551847 Test Loss: 0.0580902
Validation loss decreased (0.055192 --> 0.055185).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0511046
	speed: 0.0746s/iter; left time: 1445.9497s
	iters: 200, epoch: 14 | loss: 0.0555087
	speed: 0.0419s/iter; left time: 807.3034s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0545514 Vali Loss: 0.0548709 Test Loss: 0.0578461
Validation loss decreased (0.055185 --> 0.054871).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0580758
	speed: 0.0745s/iter; left time: 1428.6298s
	iters: 200, epoch: 15 | loss: 0.0566910
	speed: 0.0418s/iter; left time: 797.2411s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0544231 Vali Loss: 0.0549199 Test Loss: 0.0578442
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0568407
	speed: 0.0738s/iter; left time: 1397.4190s
	iters: 200, epoch: 16 | loss: 0.0580707
	speed: 0.0418s/iter; left time: 787.6308s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.53s
Steps: 224 | Train Loss: 0.0542265 Vali Loss: 0.0546896 Test Loss: 0.0577216
Validation loss decreased (0.054871 --> 0.054690).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0518764
	speed: 0.0747s/iter; left time: 1397.8150s
	iters: 200, epoch: 17 | loss: 0.0532458
	speed: 0.0418s/iter; left time: 778.9748s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0540888 Vali Loss: 0.0546941 Test Loss: 0.0577168
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0508079
	speed: 0.0741s/iter; left time: 1370.3762s
	iters: 200, epoch: 18 | loss: 0.0514931
	speed: 0.0418s/iter; left time: 769.3329s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0539316 Vali Loss: 0.0545755 Test Loss: 0.0576704
Validation loss decreased (0.054690 --> 0.054575).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0519903
	speed: 0.0746s/iter; left time: 1362.6380s
	iters: 200, epoch: 19 | loss: 0.0483813
	speed: 0.0418s/iter; left time: 759.7713s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0537805 Vali Loss: 0.0545462 Test Loss: 0.0575867
Validation loss decreased (0.054575 --> 0.054546).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0535914
	speed: 0.0748s/iter; left time: 1349.5709s
	iters: 200, epoch: 20 | loss: 0.0546892
	speed: 0.0418s/iter; left time: 750.6857s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0536743 Vali Loss: 0.0544524 Test Loss: 0.0574283
Validation loss decreased (0.054546 --> 0.054452).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0540178
	speed: 0.0747s/iter; left time: 1331.5933s
	iters: 200, epoch: 21 | loss: 0.0522899
	speed: 0.0419s/iter; left time: 741.6669s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0536213 Vali Loss: 0.0543808 Test Loss: 0.0575519
Validation loss decreased (0.054452 --> 0.054381).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0546879
	speed: 0.0746s/iter; left time: 1313.4636s
	iters: 200, epoch: 22 | loss: 0.0504863
	speed: 0.0418s/iter; left time: 731.8208s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0535170 Vali Loss: 0.0543309 Test Loss: 0.0574142
Validation loss decreased (0.054381 --> 0.054331).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0541547
	speed: 0.0765s/iter; left time: 1329.3613s
	iters: 200, epoch: 23 | loss: 0.0524183
	speed: 0.0418s/iter; left time: 722.7461s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0534375 Vali Loss: 0.0543097 Test Loss: 0.0573499
Validation loss decreased (0.054331 --> 0.054310).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0576624
	speed: 0.0764s/iter; left time: 1309.7861s
	iters: 200, epoch: 24 | loss: 0.0513303
	speed: 0.0419s/iter; left time: 713.5872s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0534079 Vali Loss: 0.0543459 Test Loss: 0.0574013
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0521893
	speed: 0.0838s/iter; left time: 1418.1088s
	iters: 200, epoch: 25 | loss: 0.0516139
	speed: 0.0419s/iter; left time: 704.3194s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.50s
Steps: 224 | Train Loss: 0.0533243 Vali Loss: 0.0543876 Test Loss: 0.0573955
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0501922
	speed: 0.0741s/iter; left time: 1237.2528s
	iters: 200, epoch: 26 | loss: 0.0541352
	speed: 0.0418s/iter; left time: 693.2968s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0532546 Vali Loss: 0.0541978 Test Loss: 0.0573019
Validation loss decreased (0.054310 --> 0.054198).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0493153
	speed: 0.0856s/iter; left time: 1410.4585s
	iters: 200, epoch: 27 | loss: 0.0526472
	speed: 0.0418s/iter; left time: 685.2621s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0532697 Vali Loss: 0.0542148 Test Loss: 0.0573098
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0514517
	speed: 0.0740s/iter; left time: 1203.2562s
	iters: 200, epoch: 28 | loss: 0.0499882
	speed: 0.0419s/iter; left time: 676.1339s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0531714 Vali Loss: 0.0542701 Test Loss: 0.0573346
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0573119
	speed: 0.0740s/iter; left time: 1186.0142s
	iters: 200, epoch: 29 | loss: 0.0558033
	speed: 0.0418s/iter; left time: 666.3228s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0531370 Vali Loss: 0.0542226 Test Loss: 0.0572494
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0516919
	speed: 0.0740s/iter; left time: 1168.7904s
	iters: 200, epoch: 30 | loss: 0.0497717
	speed: 0.0419s/iter; left time: 657.8128s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0531310 Vali Loss: 0.0541556 Test Loss: 0.0572202
Validation loss decreased (0.054198 --> 0.054156).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0527075
	speed: 0.0747s/iter; left time: 1163.9633s
	iters: 200, epoch: 31 | loss: 0.0537404
	speed: 0.0418s/iter; left time: 646.9480s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0530956 Vali Loss: 0.0541769 Test Loss: 0.0571595
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0533048
	speed: 0.0738s/iter; left time: 1133.7672s
	iters: 200, epoch: 32 | loss: 0.0556948
	speed: 0.0418s/iter; left time: 638.2621s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0530611 Vali Loss: 0.0541787 Test Loss: 0.0571991
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0510798
	speed: 0.0739s/iter; left time: 1118.2675s
	iters: 200, epoch: 33 | loss: 0.0523759
	speed: 0.0418s/iter; left time: 628.9161s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0531029 Vali Loss: 0.0541814 Test Loss: 0.0571673
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0522886
	speed: 0.0739s/iter; left time: 1101.8744s
	iters: 200, epoch: 34 | loss: 0.0541572
	speed: 0.0419s/iter; left time: 619.8374s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0530245 Vali Loss: 0.0540877 Test Loss: 0.0571120
Validation loss decreased (0.054156 --> 0.054088).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0515421
	speed: 0.0744s/iter; left time: 1092.5634s
	iters: 200, epoch: 35 | loss: 0.0513102
	speed: 0.0418s/iter; left time: 610.3254s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0529863 Vali Loss: 0.0541510 Test Loss: 0.0571679
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0522429
	speed: 0.0739s/iter; left time: 1068.3731s
	iters: 200, epoch: 36 | loss: 0.0521231
	speed: 0.0419s/iter; left time: 601.1973s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0530019 Vali Loss: 0.0541704 Test Loss: 0.0571422
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0513952
	speed: 0.0741s/iter; left time: 1054.2933s
	iters: 200, epoch: 37 | loss: 0.0474398
	speed: 0.0419s/iter; left time: 591.9197s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0529754 Vali Loss: 0.0540476 Test Loss: 0.0571175
Validation loss decreased (0.054088 --> 0.054048).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0502229
	speed: 0.0745s/iter; left time: 1044.6058s
	iters: 200, epoch: 38 | loss: 0.0529533
	speed: 0.0419s/iter; left time: 582.7175s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0529339 Vali Loss: 0.0542359 Test Loss: 0.0571858
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0542917
	speed: 0.0740s/iter; left time: 1019.8536s
	iters: 200, epoch: 39 | loss: 0.0531940
	speed: 0.0419s/iter; left time: 573.0090s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0529129 Vali Loss: 0.0540209 Test Loss: 0.0571142
Validation loss decreased (0.054048 --> 0.054021).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0547552
	speed: 0.0745s/iter; left time: 1010.3311s
	iters: 200, epoch: 40 | loss: 0.0557019
	speed: 0.0418s/iter; left time: 562.9143s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0529163 Vali Loss: 0.0540310 Test Loss: 0.0571155
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0534431
	speed: 0.0740s/iter; left time: 986.6784s
	iters: 200, epoch: 41 | loss: 0.0568288
	speed: 0.0419s/iter; left time: 554.3730s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0528946 Vali Loss: 0.0540863 Test Loss: 0.0571200
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0536664
	speed: 0.0740s/iter; left time: 970.1198s
	iters: 200, epoch: 42 | loss: 0.0512080
	speed: 0.0419s/iter; left time: 545.1456s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0529005 Vali Loss: 0.0540332 Test Loss: 0.0570927
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0552242
	speed: 0.0744s/iter; left time: 958.8215s
	iters: 200, epoch: 43 | loss: 0.0507111
	speed: 0.0419s/iter; left time: 535.7786s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0528627 Vali Loss: 0.0541517 Test Loss: 0.0571203
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0526871
	speed: 0.0738s/iter; left time: 934.8897s
	iters: 200, epoch: 44 | loss: 0.0537241
	speed: 0.0418s/iter; left time: 525.5206s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0529090 Vali Loss: 0.0540866 Test Loss: 0.0571252
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0587728
	speed: 0.0741s/iter; left time: 921.8914s
	iters: 200, epoch: 45 | loss: 0.0491216
	speed: 0.0418s/iter; left time: 516.4630s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0528336 Vali Loss: 0.0541069 Test Loss: 0.0571408
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0522368
	speed: 0.0740s/iter; left time: 903.8769s
	iters: 200, epoch: 46 | loss: 0.0523553
	speed: 0.0419s/iter; left time: 507.4014s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0528736 Vali Loss: 0.0540359 Test Loss: 0.0571018
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0527549
	speed: 0.0742s/iter; left time: 889.9456s
	iters: 200, epoch: 47 | loss: 0.0514552
	speed: 0.0418s/iter; left time: 497.5837s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0528191 Vali Loss: 0.0540452 Test Loss: 0.0571226
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0518987
	speed: 0.0739s/iter; left time: 870.1079s
	iters: 200, epoch: 48 | loss: 0.0528718
	speed: 0.0418s/iter; left time: 488.4445s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0528364 Vali Loss: 0.0541071 Test Loss: 0.0571336
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0543009
	speed: 0.0739s/iter; left time: 853.3450s
	iters: 200, epoch: 49 | loss: 0.0517853
	speed: 0.0418s/iter; left time: 478.8228s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0528222 Vali Loss: 0.0540462 Test Loss: 0.0571074
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_24_IT_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.0101736169308424, rmse:0.10086435079574585, mae:0.05711417645215988, rse:0.38111668825149536
Intermediate time for IT and pred_len 24: 00h:19m:12.11s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1709637
	speed: 0.0628s/iter; left time: 1401.4907s
	iters: 200, epoch: 1 | loss: 0.1590622
	speed: 0.0423s/iter; left time: 940.0663s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.1731405 Vali Loss: 0.1467602 Test Loss: 0.1548989
Validation loss decreased (inf --> 0.146760).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0915521
	speed: 0.0775s/iter; left time: 1709.9081s
	iters: 200, epoch: 2 | loss: 0.0813664
	speed: 0.0423s/iter; left time: 928.5343s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.1010438 Vali Loss: 0.0820178 Test Loss: 0.0875869
Validation loss decreased (0.146760 --> 0.082018).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0834640
	speed: 0.0785s/iter; left time: 1714.7168s
	iters: 200, epoch: 3 | loss: 0.0890686
	speed: 0.0423s/iter; left time: 919.0786s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0845064 Vali Loss: 0.0791088 Test Loss: 0.0851409
Validation loss decreased (0.082018 --> 0.079109).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0819988
	speed: 0.0766s/iter; left time: 1657.1573s
	iters: 200, epoch: 4 | loss: 0.0786908
	speed: 0.0422s/iter; left time: 908.1363s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0813391 Vali Loss: 0.0774892 Test Loss: 0.0833235
Validation loss decreased (0.079109 --> 0.077489).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0812265
	speed: 0.0802s/iter; left time: 1716.1672s
	iters: 200, epoch: 5 | loss: 0.0782264
	speed: 0.0422s/iter; left time: 898.4396s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0792095 Vali Loss: 0.0765936 Test Loss: 0.0825124
Validation loss decreased (0.077489 --> 0.076594).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0764224
	speed: 0.0775s/iter; left time: 1642.2676s
	iters: 200, epoch: 6 | loss: 0.0783107
	speed: 0.0422s/iter; left time: 889.2412s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0779074 Vali Loss: 0.0763852 Test Loss: 0.0820518
Validation loss decreased (0.076594 --> 0.076385).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0758527
	speed: 0.0768s/iter; left time: 1610.0296s
	iters: 200, epoch: 7 | loss: 0.0771271
	speed: 0.0422s/iter; left time: 881.1937s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.70s
Steps: 224 | Train Loss: 0.0769735 Vali Loss: 0.0758655 Test Loss: 0.0815309
Validation loss decreased (0.076385 --> 0.075866).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0826955
	speed: 0.0767s/iter; left time: 1589.9065s
	iters: 200, epoch: 8 | loss: 0.0760676
	speed: 0.0421s/iter; left time: 869.4995s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0762410 Vali Loss: 0.0755869 Test Loss: 0.0812099
Validation loss decreased (0.075866 --> 0.075587).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0707286
	speed: 0.0770s/iter; left time: 1578.7741s
	iters: 200, epoch: 9 | loss: 0.0743069
	speed: 0.0421s/iter; left time: 859.8166s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0756071 Vali Loss: 0.0752984 Test Loss: 0.0811832
Validation loss decreased (0.075587 --> 0.075298).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0766918
	speed: 0.0773s/iter; left time: 1567.9840s
	iters: 200, epoch: 10 | loss: 0.0728842
	speed: 0.0421s/iter; left time: 850.7283s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0751414 Vali Loss: 0.0754443 Test Loss: 0.0811766
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0736202
	speed: 0.0761s/iter; left time: 1526.8073s
	iters: 200, epoch: 11 | loss: 0.0760152
	speed: 0.0422s/iter; left time: 842.1549s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0747158 Vali Loss: 0.0752145 Test Loss: 0.0808049
Validation loss decreased (0.075298 --> 0.075215).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0720106
	speed: 0.0768s/iter; left time: 1524.2798s
	iters: 200, epoch: 12 | loss: 0.0731059
	speed: 0.0421s/iter; left time: 831.7771s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0743176 Vali Loss: 0.0752223 Test Loss: 0.0806497
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0700952
	speed: 0.0765s/iter; left time: 1500.3928s
	iters: 200, epoch: 13 | loss: 0.0709079
	speed: 0.0421s/iter; left time: 821.9443s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0739965 Vali Loss: 0.0750111 Test Loss: 0.0804848
Validation loss decreased (0.075215 --> 0.075011).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0717369
	speed: 0.0764s/iter; left time: 1481.0720s
	iters: 200, epoch: 14 | loss: 0.0706455
	speed: 0.0422s/iter; left time: 813.0598s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0735995 Vali Loss: 0.0751630 Test Loss: 0.0805996
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0726589
	speed: 0.0753s/iter; left time: 1442.9068s
	iters: 200, epoch: 15 | loss: 0.0723697
	speed: 0.0422s/iter; left time: 803.7816s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0733330 Vali Loss: 0.0750874 Test Loss: 0.0805799
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0707894
	speed: 0.0762s/iter; left time: 1443.0990s
	iters: 200, epoch: 16 | loss: 0.0748958
	speed: 0.0422s/iter; left time: 795.2376s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0730366 Vali Loss: 0.0752258 Test Loss: 0.0806013
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0713298
	speed: 0.0759s/iter; left time: 1420.6176s
	iters: 200, epoch: 17 | loss: 0.0706481
	speed: 0.0422s/iter; left time: 785.3704s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0728366 Vali Loss: 0.0750299 Test Loss: 0.0805444
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0766651
	speed: 0.0759s/iter; left time: 1403.4191s
	iters: 200, epoch: 18 | loss: 0.0755578
	speed: 0.0422s/iter; left time: 776.0706s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0726392 Vali Loss: 0.0750070 Test Loss: 0.0803575
Validation loss decreased (0.075011 --> 0.075007).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0721044
	speed: 0.0761s/iter; left time: 1389.8956s
	iters: 200, epoch: 19 | loss: 0.0752852
	speed: 0.0422s/iter; left time: 767.0278s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0724808 Vali Loss: 0.0749559 Test Loss: 0.0802967
Validation loss decreased (0.075007 --> 0.074956).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0686410
	speed: 0.0765s/iter; left time: 1380.9826s
	iters: 200, epoch: 20 | loss: 0.0692698
	speed: 0.0422s/iter; left time: 757.2277s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0722542 Vali Loss: 0.0750252 Test Loss: 0.0803124
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0693305
	speed: 0.0768s/iter; left time: 1369.0937s
	iters: 200, epoch: 21 | loss: 0.0740962
	speed: 0.0422s/iter; left time: 747.0830s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0721057 Vali Loss: 0.0750124 Test Loss: 0.0803431
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0718964
	speed: 0.0764s/iter; left time: 1344.5747s
	iters: 200, epoch: 22 | loss: 0.0750140
	speed: 0.0422s/iter; left time: 739.1659s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0719894 Vali Loss: 0.0749805 Test Loss: 0.0802566
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0679527
	speed: 0.0761s/iter; left time: 1321.8060s
	iters: 200, epoch: 23 | loss: 0.0706710
	speed: 0.0422s/iter; left time: 728.9515s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0718464 Vali Loss: 0.0750409 Test Loss: 0.0802397
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0731610
	speed: 0.0756s/iter; left time: 1297.0458s
	iters: 200, epoch: 24 | loss: 0.0708685
	speed: 0.0422s/iter; left time: 719.1724s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0716813 Vali Loss: 0.0750071 Test Loss: 0.0803240
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0706737
	speed: 0.0760s/iter; left time: 1285.8573s
	iters: 200, epoch: 25 | loss: 0.0705063
	speed: 0.0422s/iter; left time: 710.0282s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0716176 Vali Loss: 0.0749813 Test Loss: 0.0803697
EarlyStopping counter: 6 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0735623
	speed: 0.0765s/iter; left time: 1278.3694s
	iters: 200, epoch: 26 | loss: 0.0690790
	speed: 0.0421s/iter; left time: 699.0347s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0715137 Vali Loss: 0.0749541 Test Loss: 0.0802607
Validation loss decreased (0.074956 --> 0.074954).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0726354
	speed: 0.0771s/iter; left time: 1270.4747s
	iters: 200, epoch: 27 | loss: 0.0705061
	speed: 0.0422s/iter; left time: 690.4923s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.70s
Steps: 224 | Train Loss: 0.0714466 Vali Loss: 0.0750012 Test Loss: 0.0802674
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0757946
	speed: 0.0758s/iter; left time: 1232.4026s
	iters: 200, epoch: 28 | loss: 0.0710962
	speed: 0.0422s/iter; left time: 682.0408s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0714014 Vali Loss: 0.0750562 Test Loss: 0.0802803
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0731476
	speed: 0.0760s/iter; left time: 1217.4944s
	iters: 200, epoch: 29 | loss: 0.0687728
	speed: 0.0421s/iter; left time: 671.3422s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0712709 Vali Loss: 0.0749656 Test Loss: 0.0802395
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0708239
	speed: 0.0754s/iter; left time: 1192.3866s
	iters: 200, epoch: 30 | loss: 0.0733953
	speed: 0.0422s/iter; left time: 662.8391s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0712485 Vali Loss: 0.0751104 Test Loss: 0.0802817
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0703984
	speed: 0.0761s/iter; left time: 1185.9316s
	iters: 200, epoch: 31 | loss: 0.0692999
	speed: 0.0422s/iter; left time: 653.5690s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0711721 Vali Loss: 0.0750923 Test Loss: 0.0802622
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0759123
	speed: 0.0762s/iter; left time: 1170.1991s
	iters: 200, epoch: 32 | loss: 0.0721979
	speed: 0.0422s/iter; left time: 643.4837s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0711303 Vali Loss: 0.0749914 Test Loss: 0.0802187
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0675400
	speed: 0.0756s/iter; left time: 1143.3427s
	iters: 200, epoch: 33 | loss: 0.0712444
	speed: 0.0423s/iter; left time: 635.4187s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0710815 Vali Loss: 0.0750909 Test Loss: 0.0803081
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0708706
	speed: 0.0757s/iter; left time: 1128.5315s
	iters: 200, epoch: 34 | loss: 0.0726558
	speed: 0.0422s/iter; left time: 624.4773s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0710599 Vali Loss: 0.0749457 Test Loss: 0.0802050
Validation loss decreased (0.074954 --> 0.074946).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0705489
	speed: 0.0765s/iter; left time: 1123.9537s
	iters: 200, epoch: 35 | loss: 0.0747192
	speed: 0.0422s/iter; left time: 615.7086s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0710360 Vali Loss: 0.0750625 Test Loss: 0.0802698
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0733743
	speed: 0.0758s/iter; left time: 1096.4568s
	iters: 200, epoch: 36 | loss: 0.0699492
	speed: 0.0422s/iter; left time: 605.8864s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0709659 Vali Loss: 0.0749656 Test Loss: 0.0802171
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0723512
	speed: 0.0760s/iter; left time: 1081.4515s
	iters: 200, epoch: 37 | loss: 0.0751660
	speed: 0.0422s/iter; left time: 596.7870s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0709697 Vali Loss: 0.0749879 Test Loss: 0.0802169
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0702403
	speed: 0.0759s/iter; left time: 1063.1375s
	iters: 200, epoch: 38 | loss: 0.0739042
	speed: 0.0422s/iter; left time: 586.5137s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0709164 Vali Loss: 0.0750351 Test Loss: 0.0802318
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0726668
	speed: 0.0754s/iter; left time: 1039.7809s
	iters: 200, epoch: 39 | loss: 0.0694377
	speed: 0.0421s/iter; left time: 576.5764s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0709209 Vali Loss: 0.0750078 Test Loss: 0.0802350
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0712593
	speed: 0.0752s/iter; left time: 1019.8353s
	iters: 200, epoch: 40 | loss: 0.0750139
	speed: 0.0422s/iter; left time: 568.1095s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0708410 Vali Loss: 0.0750490 Test Loss: 0.0802376
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0708972
	speed: 0.0760s/iter; left time: 1013.7989s
	iters: 200, epoch: 41 | loss: 0.0737602
	speed: 0.0421s/iter; left time: 558.0150s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0708548 Vali Loss: 0.0750213 Test Loss: 0.0802427
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0709119
	speed: 0.0753s/iter; left time: 988.0675s
	iters: 200, epoch: 42 | loss: 0.0701031
	speed: 0.0422s/iter; left time: 548.6801s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0708338 Vali Loss: 0.0750549 Test Loss: 0.0802160
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0709096
	speed: 0.0755s/iter; left time: 973.0272s
	iters: 200, epoch: 43 | loss: 0.0690312
	speed: 0.0421s/iter; left time: 538.9894s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0708735 Vali Loss: 0.0750550 Test Loss: 0.0802526
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0671204
	speed: 0.0757s/iter; left time: 958.5804s
	iters: 200, epoch: 44 | loss: 0.0687659
	speed: 0.0422s/iter; left time: 529.9900s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0708380 Vali Loss: 0.0750403 Test Loss: 0.0802399
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018426574766635895, rmse:0.13574452698230743, mae:0.08020501583814621, rse:0.5132646560668945
Use GPU: cuda:0
>>>>>>>start training : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1690528
	speed: 0.0439s/iter; left time: 978.1898s
	iters: 200, epoch: 1 | loss: 0.1593371
	speed: 0.0422s/iter; left time: 936.4705s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.1715413 Vali Loss: 0.1460627 Test Loss: 0.1542718
Validation loss decreased (inf --> 0.146063).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0974870
	speed: 0.0763s/iter; left time: 1685.3289s
	iters: 200, epoch: 2 | loss: 0.0848063
	speed: 0.0422s/iter; left time: 927.0640s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.1027044 Vali Loss: 0.0821888 Test Loss: 0.0880603
Validation loss decreased (0.146063 --> 0.082189).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0870626
	speed: 0.0764s/iter; left time: 1668.8168s
	iters: 200, epoch: 3 | loss: 0.0844888
	speed: 0.0422s/iter; left time: 917.8942s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0846875 Vali Loss: 0.0790373 Test Loss: 0.0849046
Validation loss decreased (0.082189 --> 0.079037).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0827117
	speed: 0.0764s/iter; left time: 1652.0138s
	iters: 200, epoch: 4 | loss: 0.0803005
	speed: 0.0422s/iter; left time: 907.7757s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0816715 Vali Loss: 0.0771680 Test Loss: 0.0833144
Validation loss decreased (0.079037 --> 0.077168).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0789151
	speed: 0.0766s/iter; left time: 1639.4496s
	iters: 200, epoch: 5 | loss: 0.0748166
	speed: 0.0422s/iter; left time: 898.8182s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0794953 Vali Loss: 0.0765681 Test Loss: 0.0823561
Validation loss decreased (0.077168 --> 0.076568).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0762038
	speed: 0.0764s/iter; left time: 1617.1734s
	iters: 200, epoch: 6 | loss: 0.0740378
	speed: 0.0421s/iter; left time: 888.2729s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0782446 Vali Loss: 0.0759999 Test Loss: 0.0817863
Validation loss decreased (0.076568 --> 0.076000).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0763244
	speed: 0.0767s/iter; left time: 1606.8378s
	iters: 200, epoch: 7 | loss: 0.0782034
	speed: 0.0421s/iter; left time: 878.7562s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0771933 Vali Loss: 0.0759410 Test Loss: 0.0814095
Validation loss decreased (0.076000 --> 0.075941).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0747644
	speed: 0.0763s/iter; left time: 1582.0210s
	iters: 200, epoch: 8 | loss: 0.0761208
	speed: 0.0422s/iter; left time: 871.5295s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0764373 Vali Loss: 0.0757183 Test Loss: 0.0811260
Validation loss decreased (0.075941 --> 0.075718).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0750381
	speed: 0.0765s/iter; left time: 1569.2628s
	iters: 200, epoch: 9 | loss: 0.0731351
	speed: 0.0422s/iter; left time: 860.9791s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0757711 Vali Loss: 0.0755833 Test Loss: 0.0808182
Validation loss decreased (0.075718 --> 0.075583).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0783068
	speed: 0.0761s/iter; left time: 1543.9719s
	iters: 200, epoch: 10 | loss: 0.0743017
	speed: 0.0422s/iter; left time: 851.5920s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0753262 Vali Loss: 0.0755877 Test Loss: 0.0805964
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0771382
	speed: 0.0756s/iter; left time: 1516.5527s
	iters: 200, epoch: 11 | loss: 0.0740948
	speed: 0.0422s/iter; left time: 842.0409s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0747834 Vali Loss: 0.0756617 Test Loss: 0.0803652
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0786360
	speed: 0.0756s/iter; left time: 1499.9003s
	iters: 200, epoch: 12 | loss: 0.0729992
	speed: 0.0422s/iter; left time: 832.2774s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0743543 Vali Loss: 0.0755620 Test Loss: 0.0802146
Validation loss decreased (0.075583 --> 0.075562).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0725833
	speed: 0.0765s/iter; left time: 1499.4473s
	iters: 200, epoch: 13 | loss: 0.0697948
	speed: 0.0422s/iter; left time: 823.9641s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.67s
Steps: 224 | Train Loss: 0.0740273 Vali Loss: 0.0755412 Test Loss: 0.0800680
Validation loss decreased (0.075562 --> 0.075541).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0740454
	speed: 0.0764s/iter; left time: 1480.4458s
	iters: 200, epoch: 14 | loss: 0.0752891
	speed: 0.0422s/iter; left time: 813.3803s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0736795 Vali Loss: 0.0755513 Test Loss: 0.0800328
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0793785
	speed: 0.0758s/iter; left time: 1452.8962s
	iters: 200, epoch: 15 | loss: 0.0747355
	speed: 0.0422s/iter; left time: 804.0020s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0733939 Vali Loss: 0.0753872 Test Loss: 0.0796960
Validation loss decreased (0.075541 --> 0.075387).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0686066
	speed: 0.0764s/iter; left time: 1447.3942s
	iters: 200, epoch: 16 | loss: 0.0700632
	speed: 0.0422s/iter; left time: 795.1604s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0730653 Vali Loss: 0.0757043 Test Loss: 0.0799135
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0754684
	speed: 0.0754s/iter; left time: 1410.9061s
	iters: 200, epoch: 17 | loss: 0.0724376
	speed: 0.0421s/iter; left time: 784.5095s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0728220 Vali Loss: 0.0758647 Test Loss: 0.0800363
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0696758
	speed: 0.0754s/iter; left time: 1394.1991s
	iters: 200, epoch: 18 | loss: 0.0764009
	speed: 0.0422s/iter; left time: 776.8827s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0725893 Vali Loss: 0.0754318 Test Loss: 0.0797931
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0728003
	speed: 0.0752s/iter; left time: 1374.6866s
	iters: 200, epoch: 19 | loss: 0.0710235
	speed: 0.0421s/iter; left time: 765.6123s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0723859 Vali Loss: 0.0757423 Test Loss: 0.0799313
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0743600
	speed: 0.0755s/iter; left time: 1362.9587s
	iters: 200, epoch: 20 | loss: 0.0744077
	speed: 0.0422s/iter; left time: 757.2049s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0721254 Vali Loss: 0.0756425 Test Loss: 0.0798354
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0732355
	speed: 0.0757s/iter; left time: 1348.4602s
	iters: 200, epoch: 21 | loss: 0.0718889
	speed: 0.0422s/iter; left time: 747.5099s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0720353 Vali Loss: 0.0757102 Test Loss: 0.0798239
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0769786
	speed: 0.0757s/iter; left time: 1331.8141s
	iters: 200, epoch: 22 | loss: 0.0750980
	speed: 0.0422s/iter; left time: 737.8685s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0719278 Vali Loss: 0.0756645 Test Loss: 0.0797868
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0732628
	speed: 0.0757s/iter; left time: 1315.6078s
	iters: 200, epoch: 23 | loss: 0.0671167
	speed: 0.0422s/iter; left time: 728.6210s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0717096 Vali Loss: 0.0756078 Test Loss: 0.0796641
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0737137
	speed: 0.0758s/iter; left time: 1299.6338s
	iters: 200, epoch: 24 | loss: 0.0736793
	speed: 0.0421s/iter; left time: 718.0437s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0714802 Vali Loss: 0.0756013 Test Loss: 0.0797363
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0705145
	speed: 0.0755s/iter; left time: 1277.6675s
	iters: 200, epoch: 25 | loss: 0.0737963
	speed: 0.0421s/iter; left time: 708.8848s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.62s
Steps: 224 | Train Loss: 0.0715292 Vali Loss: 0.0757246 Test Loss: 0.0798351
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_96_IT_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018040161579847336, rmse:0.1343136727809906, mae:0.07969599217176437, rse:0.5078544616699219
Intermediate time for IT and pred_len 96: 00h:13m:47.75s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_336_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1685084
	speed: 0.0612s/iter; left time: 1358.8251s
	iters: 200, epoch: 1 | loss: 0.1568417
	speed: 0.0426s/iter; left time: 941.2468s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.94s
Steps: 223 | Train Loss: 0.1736281 Vali Loss: 0.1484829 Test Loss: 0.1557589
Validation loss decreased (inf --> 0.148483).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0974766
	speed: 0.1101s/iter; left time: 2418.9825s
	iters: 200, epoch: 2 | loss: 0.0909598
	speed: 0.0427s/iter; left time: 933.3097s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.75s
Steps: 223 | Train Loss: 0.1043616 Vali Loss: 0.0868721 Test Loss: 0.0920455
Validation loss decreased (0.148483 --> 0.086872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0907705
	speed: 0.0781s/iter; left time: 1698.4357s
	iters: 200, epoch: 3 | loss: 0.0903725
	speed: 0.0426s/iter; left time: 922.0367s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0891924 Vali Loss: 0.0843571 Test Loss: 0.0895865
Validation loss decreased (0.086872 --> 0.084357).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0856451
	speed: 0.0786s/iter; left time: 1691.3843s
	iters: 200, epoch: 4 | loss: 0.0856527
	speed: 0.0426s/iter; left time: 911.9780s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0858986 Vali Loss: 0.0823978 Test Loss: 0.0877564
Validation loss decreased (0.084357 --> 0.082398).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0821580
	speed: 0.0772s/iter; left time: 1646.0170s
	iters: 200, epoch: 5 | loss: 0.0865016
	speed: 0.0426s/iter; left time: 902.8520s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0836854 Vali Loss: 0.0821022 Test Loss: 0.0869493
Validation loss decreased (0.082398 --> 0.082102).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0820099
	speed: 0.0771s/iter; left time: 1626.0144s
	iters: 200, epoch: 6 | loss: 0.0806738
	speed: 0.0426s/iter; left time: 893.6441s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0824466 Vali Loss: 0.0818127 Test Loss: 0.0865573
Validation loss decreased (0.082102 --> 0.081813).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0782823
	speed: 0.0763s/iter; left time: 1591.4388s
	iters: 200, epoch: 7 | loss: 0.0790035
	speed: 0.0426s/iter; left time: 883.9690s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0815521 Vali Loss: 0.0815402 Test Loss: 0.0861961
Validation loss decreased (0.081813 --> 0.081540).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0853935
	speed: 0.0768s/iter; left time: 1584.1711s
	iters: 200, epoch: 8 | loss: 0.0811640
	speed: 0.0426s/iter; left time: 874.1804s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0807243 Vali Loss: 0.0813643 Test Loss: 0.0859200
Validation loss decreased (0.081540 --> 0.081364).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0786720
	speed: 0.0764s/iter; left time: 1560.1609s
	iters: 200, epoch: 9 | loss: 0.0794805
	speed: 0.0426s/iter; left time: 865.6102s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0800110 Vali Loss: 0.0811726 Test Loss: 0.0858258
Validation loss decreased (0.081364 --> 0.081173).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0747472
	speed: 0.0768s/iter; left time: 1550.7885s
	iters: 200, epoch: 10 | loss: 0.0790480
	speed: 0.0426s/iter; left time: 855.0391s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0794431 Vali Loss: 0.0812832 Test Loss: 0.0858309
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0785402
	speed: 0.0763s/iter; left time: 1523.1569s
	iters: 200, epoch: 11 | loss: 0.0822288
	speed: 0.0426s/iter; left time: 845.5117s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.73s
Steps: 223 | Train Loss: 0.0789551 Vali Loss: 0.0812124 Test Loss: 0.0858182
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0803159
	speed: 0.0760s/iter; left time: 1501.7685s
	iters: 200, epoch: 12 | loss: 0.0763940
	speed: 0.0426s/iter; left time: 836.7640s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0784845 Vali Loss: 0.0816927 Test Loss: 0.0861263
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0770830
	speed: 0.0756s/iter; left time: 1475.6543s
	iters: 200, epoch: 13 | loss: 0.0745756
	speed: 0.0426s/iter; left time: 826.9298s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0780846 Vali Loss: 0.0811105 Test Loss: 0.0860111
Validation loss decreased (0.081173 --> 0.081111).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0754176
	speed: 0.0782s/iter; left time: 1510.2850s
	iters: 200, epoch: 14 | loss: 0.0782623
	speed: 0.0426s/iter; left time: 817.6929s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0777484 Vali Loss: 0.0813321 Test Loss: 0.0858601
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0782674
	speed: 0.0761s/iter; left time: 1452.0951s
	iters: 200, epoch: 15 | loss: 0.0810125
	speed: 0.0425s/iter; left time: 807.5335s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0774745 Vali Loss: 0.0815115 Test Loss: 0.0860015
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0776845
	speed: 0.0762s/iter; left time: 1435.8855s
	iters: 200, epoch: 16 | loss: 0.0781795
	speed: 0.0426s/iter; left time: 798.2390s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0771345 Vali Loss: 0.0815269 Test Loss: 0.0859353
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0737727
	speed: 0.0763s/iter; left time: 1421.3241s
	iters: 200, epoch: 17 | loss: 0.0730831
	speed: 0.0426s/iter; left time: 788.8262s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0769411 Vali Loss: 0.0812567 Test Loss: 0.0857312
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0752616
	speed: 0.0754s/iter; left time: 1388.9115s
	iters: 200, epoch: 18 | loss: 0.0719897
	speed: 0.0425s/iter; left time: 778.9948s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0767019 Vali Loss: 0.0813096 Test Loss: 0.0859496
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0768243
	speed: 0.0760s/iter; left time: 1382.7631s
	iters: 200, epoch: 19 | loss: 0.0735799
	speed: 0.0425s/iter; left time: 769.5933s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0765290 Vali Loss: 0.0812752 Test Loss: 0.0859788
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0761607
	speed: 0.0761s/iter; left time: 1367.2224s
	iters: 200, epoch: 20 | loss: 0.0744282
	speed: 0.0426s/iter; left time: 760.5971s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0762922 Vali Loss: 0.0812472 Test Loss: 0.0858141
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0799511
	speed: 0.0759s/iter; left time: 1346.6839s
	iters: 200, epoch: 21 | loss: 0.0779543
	speed: 0.0426s/iter; left time: 751.0341s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0761807 Vali Loss: 0.0814064 Test Loss: 0.0856810
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0768406
	speed: 0.0777s/iter; left time: 1360.9688s
	iters: 200, epoch: 22 | loss: 0.0725928
	speed: 0.0431s/iter; left time: 750.6392s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.85s
Steps: 223 | Train Loss: 0.0759702 Vali Loss: 0.0813204 Test Loss: 0.0858513
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0737765
	speed: 0.0780s/iter; left time: 1348.2847s
	iters: 200, epoch: 23 | loss: 0.0740322
	speed: 0.0425s/iter; left time: 731.6244s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.72s
Steps: 223 | Train Loss: 0.0758253 Vali Loss: 0.0816101 Test Loss: 0.0858746
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019910652190446854, rmse:0.14110511541366577, mae:0.08601111173629761, rse:0.5340294241905212
Use GPU: cuda:0
>>>>>>>start training : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1738360
	speed: 0.0442s/iter; left time: 981.7278s
	iters: 200, epoch: 1 | loss: 0.1570505
	speed: 0.0425s/iter; left time: 939.9690s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.1732006 Vali Loss: 0.1485402 Test Loss: 0.1558604
Validation loss decreased (inf --> 0.148540).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0986272
	speed: 0.0770s/iter; left time: 1691.7702s
	iters: 200, epoch: 2 | loss: 0.0931965
	speed: 0.0425s/iter; left time: 929.7190s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.1054054 Vali Loss: 0.0868926 Test Loss: 0.0923197
Validation loss decreased (0.148540 --> 0.086893).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0888634
	speed: 0.0772s/iter; left time: 1678.5131s
	iters: 200, epoch: 3 | loss: 0.0917304
	speed: 0.0425s/iter; left time: 919.9971s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0895569 Vali Loss: 0.0843855 Test Loss: 0.0898747
Validation loss decreased (0.086893 --> 0.084385).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0846417
	speed: 0.0771s/iter; left time: 1659.5696s
	iters: 200, epoch: 4 | loss: 0.0825565
	speed: 0.0425s/iter; left time: 910.3070s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0864843 Vali Loss: 0.0826916 Test Loss: 0.0881381
Validation loss decreased (0.084385 --> 0.082692).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0862233
	speed: 0.0766s/iter; left time: 1632.0659s
	iters: 200, epoch: 5 | loss: 0.0826791
	speed: 0.0425s/iter; left time: 902.3981s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0839479 Vali Loss: 0.0819256 Test Loss: 0.0870442
Validation loss decreased (0.082692 --> 0.081926).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0812812
	speed: 0.0769s/iter; left time: 1620.5324s
	iters: 200, epoch: 6 | loss: 0.0846281
	speed: 0.0426s/iter; left time: 893.7004s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.70s
Steps: 223 | Train Loss: 0.0825281 Vali Loss: 0.0813871 Test Loss: 0.0863121
Validation loss decreased (0.081926 --> 0.081387).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0798724
	speed: 0.0772s/iter; left time: 1609.8902s
	iters: 200, epoch: 7 | loss: 0.0788262
	speed: 0.0425s/iter; left time: 883.0556s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0815098 Vali Loss: 0.0816422 Test Loss: 0.0858767
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0786085
	speed: 0.0763s/iter; left time: 1574.0331s
	iters: 200, epoch: 8 | loss: 0.0805364
	speed: 0.0425s/iter; left time: 872.9836s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0807263 Vali Loss: 0.0811599 Test Loss: 0.0855367
Validation loss decreased (0.081387 --> 0.081160).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0814225
	speed: 0.0767s/iter; left time: 1565.8337s
	iters: 200, epoch: 9 | loss: 0.0816666
	speed: 0.0425s/iter; left time: 863.4519s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0800378 Vali Loss: 0.0809861 Test Loss: 0.0854724
Validation loss decreased (0.081160 --> 0.080986).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0825524
	speed: 0.0765s/iter; left time: 1543.9701s
	iters: 200, epoch: 10 | loss: 0.0778407
	speed: 0.0425s/iter; left time: 854.9402s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.68s
Steps: 223 | Train Loss: 0.0794228 Vali Loss: 0.0812544 Test Loss: 0.0852757
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0800575
	speed: 0.0757s/iter; left time: 1511.8930s
	iters: 200, epoch: 11 | loss: 0.0771785
	speed: 0.0425s/iter; left time: 844.6290s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0787776 Vali Loss: 0.0813259 Test Loss: 0.0853913
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0784340
	speed: 0.0757s/iter; left time: 1495.1569s
	iters: 200, epoch: 12 | loss: 0.0783378
	speed: 0.0425s/iter; left time: 835.1028s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0783605 Vali Loss: 0.0813706 Test Loss: 0.0855518
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0815431
	speed: 0.0757s/iter; left time: 1478.1764s
	iters: 200, epoch: 13 | loss: 0.0804912
	speed: 0.0425s/iter; left time: 825.3705s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0779481 Vali Loss: 0.0812705 Test Loss: 0.0853575
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0739288
	speed: 0.0757s/iter; left time: 1461.2092s
	iters: 200, epoch: 14 | loss: 0.0797356
	speed: 0.0425s/iter; left time: 816.8442s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0775050 Vali Loss: 0.0813125 Test Loss: 0.0853628
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0769799
	speed: 0.0760s/iter; left time: 1449.5217s
	iters: 200, epoch: 15 | loss: 0.0748191
	speed: 0.0425s/iter; left time: 807.1497s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0771534 Vali Loss: 0.0813744 Test Loss: 0.0854055
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0790950
	speed: 0.0761s/iter; left time: 1435.8119s
	iters: 200, epoch: 16 | loss: 0.0787604
	speed: 0.0425s/iter; left time: 796.3417s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0768260 Vali Loss: 0.0812937 Test Loss: 0.0853267
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0749521
	speed: 0.0760s/iter; left time: 1416.8419s
	iters: 200, epoch: 17 | loss: 0.0770926
	speed: 0.0425s/iter; left time: 787.8647s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.0765596 Vali Loss: 0.0813438 Test Loss: 0.0854356
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0787697
	speed: 0.0762s/iter; left time: 1403.4467s
	iters: 200, epoch: 18 | loss: 0.0734112
	speed: 0.0425s/iter; left time: 777.5391s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.67s
Steps: 223 | Train Loss: 0.0762949 Vali Loss: 0.0812519 Test Loss: 0.0853387
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0755710
	speed: 0.0758s/iter; left time: 1378.9938s
	iters: 200, epoch: 19 | loss: 0.0773897
	speed: 0.0425s/iter; left time: 768.9724s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.66s
Steps: 223 | Train Loss: 0.0761299 Vali Loss: 0.0814988 Test Loss: 0.0855493
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_336_168_IT_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019644267857074738, rmse:0.140158012509346, mae:0.08547242730855942, rse:0.5304449796676636
Intermediate time for IT and pred_len 168: 00h:08m:37.41s
Intermediate time for IT: 00h:41m:37.27s
Total time: 03h:58m:51.50s