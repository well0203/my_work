
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1467022
	speed: 0.0903s/iter; left time: 2013.6507s
	iters: 200, epoch: 1 | loss: 0.1380337
	speed: 0.0537s/iter; left time: 1192.4319s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.33s
Steps: 224 | Train Loss: 0.1492598 Vali Loss: 0.1491447 Test Loss: 0.1573455
Validation loss decreased (inf --> 0.149145).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0933916
	speed: 0.1045s/iter; left time: 2307.5250s
	iters: 200, epoch: 2 | loss: 0.0793409
	speed: 0.0644s/iter; left time: 1414.9776s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.29s
Steps: 224 | Train Loss: 0.0958381 Vali Loss: 0.0959918 Test Loss: 0.0965967
Validation loss decreased (0.149145 --> 0.095992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804107
	speed: 0.1139s/iter; left time: 2489.1082s
	iters: 200, epoch: 3 | loss: 0.0822360
	speed: 0.0611s/iter; left time: 1329.1384s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.93s
Steps: 224 | Train Loss: 0.0800409 Vali Loss: 0.0911792 Test Loss: 0.0924903
Validation loss decreased (0.095992 --> 0.091179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0721088
	speed: 0.1270s/iter; left time: 2746.7165s
	iters: 200, epoch: 4 | loss: 0.0784065
	speed: 0.0649s/iter; left time: 1397.3101s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.54s
Steps: 224 | Train Loss: 0.0768202 Vali Loss: 0.0894785 Test Loss: 0.0912090
Validation loss decreased (0.091179 --> 0.089479).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0701359
	speed: 0.1134s/iter; left time: 2428.0638s
	iters: 200, epoch: 5 | loss: 0.0721674
	speed: 0.0620s/iter; left time: 1320.6194s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:13.91s
Steps: 224 | Train Loss: 0.0751275 Vali Loss: 0.0886305 Test Loss: 0.0903440
Validation loss decreased (0.089479 --> 0.088631).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0747568
	speed: 0.1182s/iter; left time: 2503.7273s
	iters: 200, epoch: 6 | loss: 0.0739783
	speed: 0.0629s/iter; left time: 1326.4004s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.95s
Steps: 224 | Train Loss: 0.0740978 Vali Loss: 0.0879776 Test Loss: 0.0896847
Validation loss decreased (0.088631 --> 0.087978).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0773371
	speed: 0.1189s/iter; left time: 2492.4289s
	iters: 200, epoch: 7 | loss: 0.0693570
	speed: 0.0611s/iter; left time: 1273.4767s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.87s
Steps: 224 | Train Loss: 0.0731795 Vali Loss: 0.0878054 Test Loss: 0.0894686
Validation loss decreased (0.087978 --> 0.087805).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0742184
	speed: 0.1158s/iter; left time: 2400.7176s
	iters: 200, epoch: 8 | loss: 0.0694305
	speed: 0.0683s/iter; left time: 1409.8881s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.79s
Steps: 224 | Train Loss: 0.0726620 Vali Loss: 0.0872411 Test Loss: 0.0890743
Validation loss decreased (0.087805 --> 0.087241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0730793
	speed: 0.1263s/iter; left time: 2589.4367s
	iters: 200, epoch: 9 | loss: 0.0740317
	speed: 0.0643s/iter; left time: 1312.2207s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.63s
Steps: 224 | Train Loss: 0.0721427 Vali Loss: 0.0873636 Test Loss: 0.0895516
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0651195
	speed: 0.1141s/iter; left time: 2314.7518s
	iters: 200, epoch: 10 | loss: 0.0683019
	speed: 0.0607s/iter; left time: 1225.0843s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.41s
Steps: 224 | Train Loss: 0.0717890 Vali Loss: 0.0870031 Test Loss: 0.0891616
Validation loss decreased (0.087241 --> 0.087003).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0714403
	speed: 0.1281s/iter; left time: 2570.7942s
	iters: 200, epoch: 11 | loss: 0.0766668
	speed: 0.0669s/iter; left time: 1334.7248s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.47s
Steps: 224 | Train Loss: 0.0714359 Vali Loss: 0.0870827 Test Loss: 0.0894357
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0713613
	speed: 0.1180s/iter; left time: 2340.0001s
	iters: 200, epoch: 12 | loss: 0.0730791
	speed: 0.0669s/iter; left time: 1320.4006s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.05s
Steps: 224 | Train Loss: 0.0711605 Vali Loss: 0.0868916 Test Loss: 0.0890513
Validation loss decreased (0.087003 --> 0.086892).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0658389
	speed: 0.1220s/iter; left time: 2392.2438s
	iters: 200, epoch: 13 | loss: 0.0685006
	speed: 0.0611s/iter; left time: 1192.8802s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.30s
Steps: 224 | Train Loss: 0.0708652 Vali Loss: 0.0865712 Test Loss: 0.0891132
Validation loss decreased (0.086892 --> 0.086571).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0742952
	speed: 0.1090s/iter; left time: 2113.8442s
	iters: 200, epoch: 14 | loss: 0.0701290
	speed: 0.0530s/iter; left time: 1021.3664s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:12.33s
Steps: 224 | Train Loss: 0.0706609 Vali Loss: 0.0864862 Test Loss: 0.0889904
Validation loss decreased (0.086571 --> 0.086486).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0725446
	speed: 0.1215s/iter; left time: 2329.1213s
	iters: 200, epoch: 15 | loss: 0.0695209
	speed: 0.0630s/iter; left time: 1201.9609s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.36s
Steps: 224 | Train Loss: 0.0704827 Vali Loss: 0.0864452 Test Loss: 0.0889387
Validation loss decreased (0.086486 --> 0.086445).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0676632
	speed: 0.1171s/iter; left time: 2218.8193s
	iters: 200, epoch: 16 | loss: 0.0735662
	speed: 0.0613s/iter; left time: 1155.6780s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.07s
Steps: 224 | Train Loss: 0.0703078 Vali Loss: 0.0865087 Test Loss: 0.0890939
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0669014
	speed: 0.1220s/iter; left time: 2283.4225s
	iters: 200, epoch: 17 | loss: 0.0692772
	speed: 0.0706s/iter; left time: 1313.8399s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:15.43s
Steps: 224 | Train Loss: 0.0701388 Vali Loss: 0.0867771 Test Loss: 0.0890331
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0704841
	speed: 0.1218s/iter; left time: 2251.6430s
	iters: 200, epoch: 18 | loss: 0.0685036
	speed: 0.0640s/iter; left time: 1176.5162s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:14.47s
Steps: 224 | Train Loss: 0.0699684 Vali Loss: 0.0864049 Test Loss: 0.0891183
Validation loss decreased (0.086445 --> 0.086405).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0693344
	speed: 0.1241s/iter; left time: 2266.9306s
	iters: 200, epoch: 19 | loss: 0.0699148
	speed: 0.0615s/iter; left time: 1116.7174s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.99s
Steps: 224 | Train Loss: 0.0698359 Vali Loss: 0.0864480 Test Loss: 0.0891146
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0743156
	speed: 0.1281s/iter; left time: 2311.8835s
	iters: 200, epoch: 20 | loss: 0.0695782
	speed: 0.0651s/iter; left time: 1167.6852s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:14.73s
Steps: 224 | Train Loss: 0.0698212 Vali Loss: 0.0862729 Test Loss: 0.0889007
Validation loss decreased (0.086405 --> 0.086273).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0642834
	speed: 0.1203s/iter; left time: 2143.8894s
	iters: 200, epoch: 21 | loss: 0.0729156
	speed: 0.0635s/iter; left time: 1125.0059s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:14.55s
Steps: 224 | Train Loss: 0.0696815 Vali Loss: 0.0863191 Test Loss: 0.0889219
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0668081
	speed: 0.1375s/iter; left time: 2419.6651s
	iters: 200, epoch: 22 | loss: 0.0675850
	speed: 0.0618s/iter; left time: 1081.1897s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:15.61s
Steps: 224 | Train Loss: 0.0696013 Vali Loss: 0.0863717 Test Loss: 0.0890059
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0662554
	speed: 0.1221s/iter; left time: 2120.7497s
	iters: 200, epoch: 23 | loss: 0.0715963
	speed: 0.0647s/iter; left time: 1117.6150s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:14.75s
Steps: 224 | Train Loss: 0.0694505 Vali Loss: 0.0862607 Test Loss: 0.0890646
Validation loss decreased (0.086273 --> 0.086261).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0695211
	speed: 0.1182s/iter; left time: 2027.3491s
	iters: 200, epoch: 24 | loss: 0.0653179
	speed: 0.0682s/iter; left time: 1162.8395s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:14.70s
Steps: 224 | Train Loss: 0.0693793 Vali Loss: 0.0863263 Test Loss: 0.0889909
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0677006
	speed: 0.1197s/iter; left time: 2025.5146s
	iters: 200, epoch: 25 | loss: 0.0705059
	speed: 0.0616s/iter; left time: 1035.6401s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:14.20s
Steps: 224 | Train Loss: 0.0693588 Vali Loss: 0.0863821 Test Loss: 0.0890807
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0654885
	speed: 0.1173s/iter; left time: 1959.6915s
	iters: 200, epoch: 26 | loss: 0.0649945
	speed: 0.0579s/iter; left time: 960.4228s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:13.89s
Steps: 224 | Train Loss: 0.0692742 Vali Loss: 0.0864751 Test Loss: 0.0893381
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0677808
	speed: 0.1336s/iter; left time: 2201.6294s
	iters: 200, epoch: 27 | loss: 0.0714075
	speed: 0.0642s/iter; left time: 1051.2010s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:14.89s
Steps: 224 | Train Loss: 0.0692092 Vali Loss: 0.0862476 Test Loss: 0.0890449
Validation loss decreased (0.086261 --> 0.086248).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0650818
	speed: 0.1274s/iter; left time: 2070.9868s
	iters: 200, epoch: 28 | loss: 0.0720823
	speed: 0.0625s/iter; left time: 1010.1851s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:14.33s
Steps: 224 | Train Loss: 0.0691955 Vali Loss: 0.0863042 Test Loss: 0.0889602
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0675507
	speed: 0.1180s/iter; left time: 1891.2030s
	iters: 200, epoch: 29 | loss: 0.0689953
	speed: 0.0639s/iter; left time: 1017.3948s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:15.26s
Steps: 224 | Train Loss: 0.0691315 Vali Loss: 0.0862055 Test Loss: 0.0891577
Validation loss decreased (0.086248 --> 0.086206).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0723119
	speed: 0.1226s/iter; left time: 1937.4194s
	iters: 200, epoch: 30 | loss: 0.0689444
	speed: 0.0626s/iter; left time: 982.7054s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:14.52s
Steps: 224 | Train Loss: 0.0690726 Vali Loss: 0.0864122 Test Loss: 0.0891799
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0699471
	speed: 0.1186s/iter; left time: 1847.4616s
	iters: 200, epoch: 31 | loss: 0.0650906
	speed: 0.0651s/iter; left time: 1007.7448s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:14.28s
Steps: 224 | Train Loss: 0.0690898 Vali Loss: 0.0861617 Test Loss: 0.0890982
Validation loss decreased (0.086206 --> 0.086162).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0697123
	speed: 0.1163s/iter; left time: 1786.7718s
	iters: 200, epoch: 32 | loss: 0.0689837
	speed: 0.0631s/iter; left time: 961.9738s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:14.37s
Steps: 224 | Train Loss: 0.0690290 Vali Loss: 0.0862783 Test Loss: 0.0891600
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0689367
	speed: 0.1171s/iter; left time: 1772.5168s
	iters: 200, epoch: 33 | loss: 0.0651389
	speed: 0.0605s/iter; left time: 909.3437s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:14.21s
Steps: 224 | Train Loss: 0.0689599 Vali Loss: 0.0864315 Test Loss: 0.0891968
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0703542
	speed: 0.1224s/iter; left time: 1824.3192s
	iters: 200, epoch: 34 | loss: 0.0736774
	speed: 0.0634s/iter; left time: 939.4269s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:14.37s
Steps: 224 | Train Loss: 0.0689449 Vali Loss: 0.0863892 Test Loss: 0.0892073
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0694088
	speed: 0.1182s/iter; left time: 1735.5319s
	iters: 200, epoch: 35 | loss: 0.0643488
	speed: 0.0617s/iter; left time: 899.2282s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:14.23s
Steps: 224 | Train Loss: 0.0689930 Vali Loss: 0.0862459 Test Loss: 0.0891558
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0662179
	speed: 0.1171s/iter; left time: 1694.0721s
	iters: 200, epoch: 36 | loss: 0.0716586
	speed: 0.0661s/iter; left time: 949.0330s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:14.77s
Steps: 224 | Train Loss: 0.0689090 Vali Loss: 0.0862916 Test Loss: 0.0891562
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0689815
	speed: 0.1229s/iter; left time: 1750.2399s
	iters: 200, epoch: 37 | loss: 0.0692148
	speed: 0.0647s/iter; left time: 915.2717s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:14.54s
Steps: 224 | Train Loss: 0.0688933 Vali Loss: 0.0864036 Test Loss: 0.0891469
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0756959
	speed: 0.1145s/iter; left time: 1604.3507s
	iters: 200, epoch: 38 | loss: 0.0706713
	speed: 0.0701s/iter; left time: 975.3422s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:14.90s
Steps: 224 | Train Loss: 0.0689504 Vali Loss: 0.0863323 Test Loss: 0.0891482
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0717678
	speed: 0.1235s/iter; left time: 1702.5360s
	iters: 200, epoch: 39 | loss: 0.0696688
	speed: 0.0723s/iter; left time: 990.0074s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.73s
Steps: 224 | Train Loss: 0.0688292 Vali Loss: 0.0862189 Test Loss: 0.0891291
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0669256
	speed: 0.1226s/iter; left time: 1662.6909s
	iters: 200, epoch: 40 | loss: 0.0677449
	speed: 0.0610s/iter; left time: 821.5207s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:14.32s
Steps: 224 | Train Loss: 0.0688930 Vali Loss: 0.0861876 Test Loss: 0.0891016
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0648098
	speed: 0.1215s/iter; left time: 1620.5321s
	iters: 200, epoch: 41 | loss: 0.0646161
	speed: 0.0675s/iter; left time: 893.8902s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:15.09s
Steps: 224 | Train Loss: 0.0688258 Vali Loss: 0.0862216 Test Loss: 0.0891206
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021291740238666534, rmse:0.1459168940782547, mae:0.08909820020198822, rse:0.5149609446525574
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1485177
	speed: 0.0652s/iter; left time: 1455.1359s
	iters: 200, epoch: 1 | loss: 0.1372107
	speed: 0.0666s/iter; left time: 1478.6920s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.83s
Steps: 224 | Train Loss: 0.1479508 Vali Loss: 0.1469130 Test Loss: 0.1552787
Validation loss decreased (inf --> 0.146913).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0860679
	speed: 0.1206s/iter; left time: 2662.9858s
	iters: 200, epoch: 2 | loss: 0.0842555
	speed: 0.0708s/iter; left time: 1556.7989s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.20s
Steps: 224 | Train Loss: 0.0963806 Vali Loss: 0.0965345 Test Loss: 0.0970062
Validation loss decreased (0.146913 --> 0.096534).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0792745
	speed: 0.1227s/iter; left time: 2681.7584s
	iters: 200, epoch: 3 | loss: 0.0799089
	speed: 0.0656s/iter; left time: 1427.6618s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.0806034 Vali Loss: 0.0915469 Test Loss: 0.0932558
Validation loss decreased (0.096534 --> 0.091547).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0692745
	speed: 0.1270s/iter; left time: 2747.0598s
	iters: 200, epoch: 4 | loss: 0.0753272
	speed: 0.0657s/iter; left time: 1414.3409s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.64s
Steps: 224 | Train Loss: 0.0771334 Vali Loss: 0.0894109 Test Loss: 0.0913275
Validation loss decreased (0.091547 --> 0.089411).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0780892
	speed: 0.1394s/iter; left time: 2983.8755s
	iters: 200, epoch: 5 | loss: 0.0733127
	speed: 0.0657s/iter; left time: 1398.8653s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:15.18s
Steps: 224 | Train Loss: 0.0752457 Vali Loss: 0.0887977 Test Loss: 0.0907949
Validation loss decreased (0.089411 --> 0.088798).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0735669
	speed: 0.1222s/iter; left time: 2587.6680s
	iters: 200, epoch: 6 | loss: 0.0754406
	speed: 0.0612s/iter; left time: 1289.6000s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.58s
Steps: 224 | Train Loss: 0.0741429 Vali Loss: 0.0879942 Test Loss: 0.0900813
Validation loss decreased (0.088798 --> 0.087994).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0708586
	speed: 0.1276s/iter; left time: 2674.5173s
	iters: 200, epoch: 7 | loss: 0.0723750
	speed: 0.0651s/iter; left time: 1357.2684s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.26s
Steps: 224 | Train Loss: 0.0733710 Vali Loss: 0.0877222 Test Loss: 0.0897023
Validation loss decreased (0.087994 --> 0.087722).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0735653
	speed: 0.1242s/iter; left time: 2574.1945s
	iters: 200, epoch: 8 | loss: 0.0752200
	speed: 0.0636s/iter; left time: 1312.6370s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.47s
Steps: 224 | Train Loss: 0.0726825 Vali Loss: 0.0871324 Test Loss: 0.0893786
Validation loss decreased (0.087722 --> 0.087132).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738944
	speed: 0.1187s/iter; left time: 2433.7514s
	iters: 200, epoch: 9 | loss: 0.0740931
	speed: 0.0753s/iter; left time: 1537.1942s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:15.79s
Steps: 224 | Train Loss: 0.0721897 Vali Loss: 0.0869960 Test Loss: 0.0890788
Validation loss decreased (0.087132 --> 0.086996).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0751932
	speed: 0.1246s/iter; left time: 2527.5878s
	iters: 200, epoch: 10 | loss: 0.0673028
	speed: 0.0607s/iter; left time: 1225.8380s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.06s
Steps: 224 | Train Loss: 0.0717408 Vali Loss: 0.0867880 Test Loss: 0.0891405
Validation loss decreased (0.086996 --> 0.086788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0667565
	speed: 0.1173s/iter; left time: 2354.0739s
	iters: 200, epoch: 11 | loss: 0.0711614
	speed: 0.0651s/iter; left time: 1300.3718s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.79s
Steps: 224 | Train Loss: 0.0714507 Vali Loss: 0.0870664 Test Loss: 0.0891779
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0710983
	speed: 0.1188s/iter; left time: 2356.1248s
	iters: 200, epoch: 12 | loss: 0.0680309
	speed: 0.0636s/iter; left time: 1254.3983s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.24s
Steps: 224 | Train Loss: 0.0711380 Vali Loss: 0.0867219 Test Loss: 0.0890017
Validation loss decreased (0.086788 --> 0.086722).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0719549
	speed: 0.1175s/iter; left time: 2305.3756s
	iters: 200, epoch: 13 | loss: 0.0728736
	speed: 0.0645s/iter; left time: 1257.8249s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.44s
Steps: 224 | Train Loss: 0.0709379 Vali Loss: 0.0864662 Test Loss: 0.0890279
Validation loss decreased (0.086722 --> 0.086466).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0695809
	speed: 0.1292s/iter; left time: 2505.4546s
	iters: 200, epoch: 14 | loss: 0.0691624
	speed: 0.0665s/iter; left time: 1283.4243s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:15.18s
Steps: 224 | Train Loss: 0.0707244 Vali Loss: 0.0867192 Test Loss: 0.0890669
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0662107
	speed: 0.1237s/iter; left time: 2370.7466s
	iters: 200, epoch: 15 | loss: 0.0770034
	speed: 0.0616s/iter; left time: 1173.8135s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.0704650 Vali Loss: 0.0864952 Test Loss: 0.0890869
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0746670
	speed: 0.1247s/iter; left time: 2361.5452s
	iters: 200, epoch: 16 | loss: 0.0751349
	speed: 0.0759s/iter; left time: 1429.2607s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:16.03s
Steps: 224 | Train Loss: 0.0703478 Vali Loss: 0.0866213 Test Loss: 0.0890552
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0691212
	speed: 0.1235s/iter; left time: 2311.7996s
	iters: 200, epoch: 17 | loss: 0.0701027
	speed: 0.0636s/iter; left time: 1184.0307s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.73s
Steps: 224 | Train Loss: 0.0701723 Vali Loss: 0.0864791 Test Loss: 0.0890113
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0723499
	speed: 0.1292s/iter; left time: 2388.7984s
	iters: 200, epoch: 18 | loss: 0.0661663
	speed: 0.0671s/iter; left time: 1235.0128s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:15.18s
Steps: 224 | Train Loss: 0.0700250 Vali Loss: 0.0864334 Test Loss: 0.0889767
Validation loss decreased (0.086466 --> 0.086433).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0676247
	speed: 0.1176s/iter; left time: 2147.7944s
	iters: 200, epoch: 19 | loss: 0.0656377
	speed: 0.0666s/iter; left time: 1210.6096s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:15.24s
Steps: 224 | Train Loss: 0.0698972 Vali Loss: 0.0863700 Test Loss: 0.0890557
Validation loss decreased (0.086433 --> 0.086370).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0731429
	speed: 0.1226s/iter; left time: 2212.4024s
	iters: 200, epoch: 20 | loss: 0.0692441
	speed: 0.0647s/iter; left time: 1161.6787s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:15.03s
Steps: 224 | Train Loss: 0.0697965 Vali Loss: 0.0862033 Test Loss: 0.0890447
Validation loss decreased (0.086370 --> 0.086203).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0687015
	speed: 0.1195s/iter; left time: 2129.5666s
	iters: 200, epoch: 21 | loss: 0.0658207
	speed: 0.0667s/iter; left time: 1181.7935s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:14.79s
Steps: 224 | Train Loss: 0.0696816 Vali Loss: 0.0863567 Test Loss: 0.0893161
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0706210
	speed: 0.1209s/iter; left time: 2127.1796s
	iters: 200, epoch: 22 | loss: 0.0746962
	speed: 0.0658s/iter; left time: 1150.5453s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:14.97s
Steps: 224 | Train Loss: 0.0696258 Vali Loss: 0.0863918 Test Loss: 0.0891025
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0717456
	speed: 0.1237s/iter; left time: 2148.6610s
	iters: 200, epoch: 23 | loss: 0.0713271
	speed: 0.0643s/iter; left time: 1110.8147s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:14.69s
Steps: 224 | Train Loss: 0.0695054 Vali Loss: 0.0861524 Test Loss: 0.0890253
Validation loss decreased (0.086203 --> 0.086152).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0754816
	speed: 0.1283s/iter; left time: 2200.7115s
	iters: 200, epoch: 24 | loss: 0.0685918
	speed: 0.0672s/iter; left time: 1145.6831s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:15.70s
Steps: 224 | Train Loss: 0.0694104 Vali Loss: 0.0862667 Test Loss: 0.0890559
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0633278
	speed: 0.1255s/iter; left time: 2124.4145s
	iters: 200, epoch: 25 | loss: 0.0648984
	speed: 0.0642s/iter; left time: 1079.3481s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:14.75s
Steps: 224 | Train Loss: 0.0693590 Vali Loss: 0.0861933 Test Loss: 0.0891097
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0697152
	speed: 0.1212s/iter; left time: 2023.5792s
	iters: 200, epoch: 26 | loss: 0.0684530
	speed: 0.0694s/iter; left time: 1152.1843s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:15.35s
Steps: 224 | Train Loss: 0.0692901 Vali Loss: 0.0861402 Test Loss: 0.0891699
Validation loss decreased (0.086152 --> 0.086140).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0680913
	speed: 0.1331s/iter; left time: 2193.3938s
	iters: 200, epoch: 27 | loss: 0.0710975
	speed: 0.0632s/iter; left time: 1034.3114s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.0692415 Vali Loss: 0.0861493 Test Loss: 0.0890312
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0662386
	speed: 0.1271s/iter; left time: 2065.2750s
	iters: 200, epoch: 28 | loss: 0.0694833
	speed: 0.0650s/iter; left time: 1049.8520s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:15.00s
Steps: 224 | Train Loss: 0.0691602 Vali Loss: 0.0861183 Test Loss: 0.0892049
Validation loss decreased (0.086140 --> 0.086118).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0725555
	speed: 0.1154s/iter; left time: 1849.3496s
	iters: 200, epoch: 29 | loss: 0.0715661
	speed: 0.0627s/iter; left time: 999.0676s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:13.83s
Steps: 224 | Train Loss: 0.0691908 Vali Loss: 0.0860879 Test Loss: 0.0891321
Validation loss decreased (0.086118 --> 0.086088).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0675764
	speed: 0.1272s/iter; left time: 2011.0836s
	iters: 200, epoch: 30 | loss: 0.0685819
	speed: 0.0650s/iter; left time: 1021.1588s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:14.57s
Steps: 224 | Train Loss: 0.0691524 Vali Loss: 0.0860893 Test Loss: 0.0891131
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0705770
	speed: 0.1159s/iter; left time: 1805.2987s
	iters: 200, epoch: 31 | loss: 0.0713090
	speed: 0.0665s/iter; left time: 1029.0939s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:14.72s
Steps: 224 | Train Loss: 0.0691323 Vali Loss: 0.0861251 Test Loss: 0.0891209
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725021
	speed: 0.1186s/iter; left time: 1821.3606s
	iters: 200, epoch: 32 | loss: 0.0674104
	speed: 0.0652s/iter; left time: 994.5420s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:14.93s
Steps: 224 | Train Loss: 0.0690699 Vali Loss: 0.0860819 Test Loss: 0.0890955
Validation loss decreased (0.086088 --> 0.086082).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0671740
	speed: 0.1259s/iter; left time: 1905.3375s
	iters: 200, epoch: 33 | loss: 0.0640508
	speed: 0.0616s/iter; left time: 925.7993s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:14.56s
Steps: 224 | Train Loss: 0.0690287 Vali Loss: 0.0861212 Test Loss: 0.0891954
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0705414
	speed: 0.1307s/iter; left time: 1948.2883s
	iters: 200, epoch: 34 | loss: 0.0681740
	speed: 0.0621s/iter; left time: 920.0541s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:14.28s
Steps: 224 | Train Loss: 0.0689596 Vali Loss: 0.0862194 Test Loss: 0.0890935
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0701695
	speed: 0.1302s/iter; left time: 1912.5552s
	iters: 200, epoch: 35 | loss: 0.0673041
	speed: 0.0624s/iter; left time: 910.7042s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:14.69s
Steps: 224 | Train Loss: 0.0689486 Vali Loss: 0.0861580 Test Loss: 0.0891037
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0642554
	speed: 0.1214s/iter; left time: 1756.2283s
	iters: 200, epoch: 36 | loss: 0.0672532
	speed: 0.0667s/iter; left time: 957.4152s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:15.08s
Steps: 224 | Train Loss: 0.0689205 Vali Loss: 0.0860491 Test Loss: 0.0890471
Validation loss decreased (0.086082 --> 0.086049).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0744950
	speed: 0.1211s/iter; left time: 1724.5193s
	iters: 200, epoch: 37 | loss: 0.0638594
	speed: 0.0706s/iter; left time: 997.5096s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:15.10s
Steps: 224 | Train Loss: 0.0689579 Vali Loss: 0.0861269 Test Loss: 0.0891083
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0700178
	speed: 0.1311s/iter; left time: 1836.4883s
	iters: 200, epoch: 38 | loss: 0.0661885
	speed: 0.0637s/iter; left time: 885.6560s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:14.57s
Steps: 224 | Train Loss: 0.0688744 Vali Loss: 0.0861560 Test Loss: 0.0891225
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0645115
	speed: 0.1226s/iter; left time: 1691.2134s
	iters: 200, epoch: 39 | loss: 0.0643578
	speed: 0.0647s/iter; left time: 886.2718s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:15.07s
Steps: 224 | Train Loss: 0.0689252 Vali Loss: 0.0861439 Test Loss: 0.0890523
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0712911
	speed: 0.1104s/iter; left time: 1497.5038s
	iters: 200, epoch: 40 | loss: 0.0740808
	speed: 0.0612s/iter; left time: 823.6260s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:13.40s
Steps: 224 | Train Loss: 0.0688536 Vali Loss: 0.0859760 Test Loss: 0.0890604
Validation loss decreased (0.086049 --> 0.085976).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0645042
	speed: 0.1182s/iter; left time: 1577.4983s
	iters: 200, epoch: 41 | loss: 0.0700506
	speed: 0.0618s/iter; left time: 818.2988s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:14.44s
Steps: 224 | Train Loss: 0.0688851 Vali Loss: 0.0861665 Test Loss: 0.0890974
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0722492
	speed: 0.1197s/iter; left time: 1569.5650s
	iters: 200, epoch: 42 | loss: 0.0705930
	speed: 0.0649s/iter; left time: 844.8398s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:14.66s
Steps: 224 | Train Loss: 0.0688321 Vali Loss: 0.0860264 Test Loss: 0.0891213
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0742681
	speed: 0.1145s/iter; left time: 1476.4859s
	iters: 200, epoch: 43 | loss: 0.0690211
	speed: 0.0634s/iter; left time: 810.6286s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:14.29s
Steps: 224 | Train Loss: 0.0688786 Vali Loss: 0.0860898 Test Loss: 0.0890831
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0646683
	speed: 0.1189s/iter; left time: 1505.9763s
	iters: 200, epoch: 44 | loss: 0.0692453
	speed: 0.0617s/iter; left time: 775.2567s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:14.39s
Steps: 224 | Train Loss: 0.0688329 Vali Loss: 0.0861044 Test Loss: 0.0890925
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0659040
	speed: 0.1191s/iter; left time: 1482.1277s
	iters: 200, epoch: 45 | loss: 0.0643121
	speed: 0.0673s/iter; left time: 830.6075s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:14.78s
Steps: 224 | Train Loss: 0.0688306 Vali Loss: 0.0860788 Test Loss: 0.0891090
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0707033
	speed: 0.1163s/iter; left time: 1421.9098s
	iters: 200, epoch: 46 | loss: 0.0666583
	speed: 0.0654s/iter; left time: 793.1286s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:14.27s
Steps: 224 | Train Loss: 0.0687669 Vali Loss: 0.0861802 Test Loss: 0.0891388
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0668203
	speed: 0.1172s/iter; left time: 1406.0440s
	iters: 200, epoch: 47 | loss: 0.0678259
	speed: 0.0644s/iter; left time: 765.8547s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:14.29s
Steps: 224 | Train Loss: 0.0687843 Vali Loss: 0.0860328 Test Loss: 0.0891000
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0671443
	speed: 0.1157s/iter; left time: 1362.3901s
	iters: 200, epoch: 48 | loss: 0.0705720
	speed: 0.0625s/iter; left time: 729.8982s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:14.16s
Steps: 224 | Train Loss: 0.0687883 Vali Loss: 0.0860063 Test Loss: 0.0891141
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0660993
	speed: 0.1202s/iter; left time: 1388.6363s
	iters: 200, epoch: 49 | loss: 0.0729448
	speed: 0.0615s/iter; left time: 704.0652s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:14.25s
Steps: 224 | Train Loss: 0.0687500 Vali Loss: 0.0861000 Test Loss: 0.0891243
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0677664
	speed: 0.1220s/iter; left time: 1382.0933s
	iters: 200, epoch: 50 | loss: 0.0669769
	speed: 0.0620s/iter; left time: 695.4890s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:14.43s
Steps: 224 | Train Loss: 0.0687967 Vali Loss: 0.0861120 Test Loss: 0.0891771
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02123580500483513, rmse:0.1457251012325287, mae:0.08906044065952301, rse:0.514284074306488
Intermediate time for DE and pred_len 24: 00h:28m:28.03s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1550613
	speed: 0.0918s/iter; left time: 2046.1321s
	iters: 200, epoch: 1 | loss: 0.1477888
	speed: 0.0609s/iter; left time: 1352.5010s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.63s
Steps: 224 | Train Loss: 0.1587900 Vali Loss: 0.1620391 Test Loss: 0.1741875
Validation loss decreased (inf --> 0.162039).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1160155
	speed: 0.1230s/iter; left time: 2715.6341s
	iters: 200, epoch: 2 | loss: 0.1055968
	speed: 0.0595s/iter; left time: 1308.4480s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.17s
Steps: 224 | Train Loss: 0.1189358 Vali Loss: 0.1230573 Test Loss: 0.1298083
Validation loss decreased (0.162039 --> 0.123057).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1057696
	speed: 0.1193s/iter; left time: 2607.9003s
	iters: 200, epoch: 3 | loss: 0.1068358
	speed: 0.0625s/iter; left time: 1359.5568s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.49s
Steps: 224 | Train Loss: 0.1064453 Vali Loss: 0.1199574 Test Loss: 0.1270489
Validation loss decreased (0.123057 --> 0.119957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1014582
	speed: 0.1170s/iter; left time: 2529.7708s
	iters: 200, epoch: 4 | loss: 0.0987709
	speed: 0.0610s/iter; left time: 1313.8714s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.92s
Steps: 224 | Train Loss: 0.1033780 Vali Loss: 0.1184104 Test Loss: 0.1268103
Validation loss decreased (0.119957 --> 0.118410).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1038326
	speed: 0.1191s/iter; left time: 2548.5747s
	iters: 200, epoch: 5 | loss: 0.0999108
	speed: 0.0627s/iter; left time: 1335.5118s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.19s
Steps: 224 | Train Loss: 0.1016363 Vali Loss: 0.1186604 Test Loss: 0.1271338
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0998692
	speed: 0.1179s/iter; left time: 2496.1830s
	iters: 200, epoch: 6 | loss: 0.1016956
	speed: 0.0675s/iter; left time: 1421.9565s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.86s
Steps: 224 | Train Loss: 0.1003976 Vali Loss: 0.1183543 Test Loss: 0.1267805
Validation loss decreased (0.118410 --> 0.118354).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0950561
	speed: 0.1219s/iter; left time: 2554.0146s
	iters: 200, epoch: 7 | loss: 0.1018301
	speed: 0.0625s/iter; left time: 1303.2725s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.33s
Steps: 224 | Train Loss: 0.0993858 Vali Loss: 0.1191201 Test Loss: 0.1267930
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0975684
	speed: 0.1204s/iter; left time: 2495.3410s
	iters: 200, epoch: 8 | loss: 0.0958021
	speed: 0.0616s/iter; left time: 1270.5590s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.44s
Steps: 224 | Train Loss: 0.0985251 Vali Loss: 0.1189736 Test Loss: 0.1276529
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0942768
	speed: 0.1198s/iter; left time: 2456.6172s
	iters: 200, epoch: 9 | loss: 0.0987583
	speed: 0.0621s/iter; left time: 1267.7918s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.10s
Steps: 224 | Train Loss: 0.0976029 Vali Loss: 0.1196053 Test Loss: 0.1274840
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0960662
	speed: 0.1189s/iter; left time: 2411.5015s
	iters: 200, epoch: 10 | loss: 0.0947696
	speed: 0.0602s/iter; left time: 1214.2401s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:13.85s
Steps: 224 | Train Loss: 0.0968994 Vali Loss: 0.1194730 Test Loss: 0.1282073
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0937361
	speed: 0.1197s/iter; left time: 2401.7439s
	iters: 200, epoch: 11 | loss: 0.0961174
	speed: 0.0638s/iter; left time: 1272.9462s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.42s
Steps: 224 | Train Loss: 0.0961025 Vali Loss: 0.1201492 Test Loss: 0.1287695
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0976077
	speed: 0.1170s/iter; left time: 2321.6890s
	iters: 200, epoch: 12 | loss: 0.0968714
	speed: 0.0627s/iter; left time: 1237.7807s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.44s
Steps: 224 | Train Loss: 0.0954843 Vali Loss: 0.1202374 Test Loss: 0.1301523
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0951096
	speed: 0.1188s/iter; left time: 2329.8803s
	iters: 200, epoch: 13 | loss: 0.0931655
	speed: 0.0623s/iter; left time: 1216.0413s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.75s
Steps: 224 | Train Loss: 0.0946925 Vali Loss: 0.1202413 Test Loss: 0.1300704
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0932792
	speed: 0.1170s/iter; left time: 2268.3231s
	iters: 200, epoch: 14 | loss: 0.0952017
	speed: 0.0647s/iter; left time: 1247.3452s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.28s
Steps: 224 | Train Loss: 0.0941036 Vali Loss: 0.1202730 Test Loss: 0.1306375
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0893586
	speed: 0.1108s/iter; left time: 2123.6694s
	iters: 200, epoch: 15 | loss: 0.0917358
	speed: 0.0629s/iter; left time: 1199.1307s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.57s
Steps: 224 | Train Loss: 0.0935348 Vali Loss: 0.1209930 Test Loss: 0.1316901
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0920206
	speed: 0.1114s/iter; left time: 2109.2493s
	iters: 200, epoch: 16 | loss: 0.0893951
	speed: 0.0652s/iter; left time: 1229.2859s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.49s
Steps: 224 | Train Loss: 0.0930603 Vali Loss: 0.1205535 Test Loss: 0.1314782
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03634786978363991, rmse:0.19065117835998535, mae:0.12678050994873047, rse:0.6751343607902527
Use GPU: cuda:0
>>>>>>>start training : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1646978
	speed: 0.0637s/iter; left time: 1420.0581s
	iters: 200, epoch: 1 | loss: 0.1596227
	speed: 0.0590s/iter; left time: 1310.4214s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.69s
Steps: 224 | Train Loss: 0.1592930 Vali Loss: 0.1618121 Test Loss: 0.1739579
Validation loss decreased (inf --> 0.161812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1183173
	speed: 0.1594s/iter; left time: 3518.8065s
	iters: 200, epoch: 2 | loss: 0.1138795
	speed: 0.0632s/iter; left time: 1389.7509s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.73s
Steps: 224 | Train Loss: 0.1198862 Vali Loss: 0.1227517 Test Loss: 0.1297694
Validation loss decreased (0.161812 --> 0.122752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1076060
	speed: 0.1977s/iter; left time: 4319.5669s
	iters: 200, epoch: 3 | loss: 0.1004281
	speed: 0.0621s/iter; left time: 1350.6828s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.61s
Steps: 224 | Train Loss: 0.1062988 Vali Loss: 0.1194519 Test Loss: 0.1273959
Validation loss decreased (0.122752 --> 0.119452).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1068373
	speed: 0.1258s/iter; left time: 2720.5628s
	iters: 200, epoch: 4 | loss: 0.1038922
	speed: 0.0604s/iter; left time: 1300.2606s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.1036002 Vali Loss: 0.1188033 Test Loss: 0.1266809
Validation loss decreased (0.119452 --> 0.118803).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0981667
	speed: 0.1467s/iter; left time: 3140.8554s
	iters: 200, epoch: 5 | loss: 0.1001305
	speed: 0.0616s/iter; left time: 1311.6357s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.58s
Steps: 224 | Train Loss: 0.1017561 Vali Loss: 0.1185325 Test Loss: 0.1270410
Validation loss decreased (0.118803 --> 0.118533).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1016373
	speed: 0.1250s/iter; left time: 2647.0195s
	iters: 200, epoch: 6 | loss: 0.0977255
	speed: 0.0577s/iter; left time: 1215.8852s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:13.51s
Steps: 224 | Train Loss: 0.1004691 Vali Loss: 0.1189096 Test Loss: 0.1266581
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1057052
	speed: 0.0970s/iter; left time: 2032.3471s
	iters: 200, epoch: 7 | loss: 0.0980047
	speed: 0.0622s/iter; left time: 1297.9537s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.26s
Steps: 224 | Train Loss: 0.0994334 Vali Loss: 0.1192198 Test Loss: 0.1271698
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0998428
	speed: 0.1158s/iter; left time: 2400.9244s
	iters: 200, epoch: 8 | loss: 0.0941586
	speed: 0.0610s/iter; left time: 1258.5817s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.00s
Steps: 224 | Train Loss: 0.0984135 Vali Loss: 0.1194942 Test Loss: 0.1277537
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0962894
	speed: 0.1166s/iter; left time: 2390.5837s
	iters: 200, epoch: 9 | loss: 0.0965957
	speed: 0.0635s/iter; left time: 1296.2333s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.65s
Steps: 224 | Train Loss: 0.0975901 Vali Loss: 0.1195832 Test Loss: 0.1275134
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0941738
	speed: 0.1190s/iter; left time: 2413.7280s
	iters: 200, epoch: 10 | loss: 0.0928220
	speed: 0.0617s/iter; left time: 1245.4608s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.18s
Steps: 224 | Train Loss: 0.0966882 Vali Loss: 0.1200024 Test Loss: 0.1288202
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0951017
	speed: 0.1171s/iter; left time: 2349.3524s
	iters: 200, epoch: 11 | loss: 0.0957812
	speed: 0.0625s/iter; left time: 1247.9137s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:13.97s
Steps: 224 | Train Loss: 0.0959330 Vali Loss: 0.1206276 Test Loss: 0.1287879
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0955243
	speed: 0.1259s/iter; left time: 2497.9523s
	iters: 200, epoch: 12 | loss: 0.0936859
	speed: 0.0590s/iter; left time: 1164.5081s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.65s
Steps: 224 | Train Loss: 0.0952509 Vali Loss: 0.1204279 Test Loss: 0.1292543
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0911372
	speed: 0.1204s/iter; left time: 2361.3235s
	iters: 200, epoch: 13 | loss: 0.0944463
	speed: 0.0616s/iter; left time: 1201.4982s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.14s
Steps: 224 | Train Loss: 0.0944741 Vali Loss: 0.1204605 Test Loss: 0.1296869
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0935038
	speed: 0.1406s/iter; left time: 2725.7105s
	iters: 200, epoch: 14 | loss: 0.0967305
	speed: 0.0632s/iter; left time: 1218.4680s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.41s
Steps: 224 | Train Loss: 0.0937822 Vali Loss: 0.1207107 Test Loss: 0.1295574
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0885421
	speed: 0.1195s/iter; left time: 2290.8513s
	iters: 200, epoch: 15 | loss: 0.0946899
	speed: 0.0614s/iter; left time: 1169.9544s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.92s
Steps: 224 | Train Loss: 0.0932084 Vali Loss: 0.1205535 Test Loss: 0.1298851
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_96_DE_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03631800040602684, rmse:0.1905728280544281, mae:0.12704099714756012, rse:0.6748569011688232
Intermediate time for DE and pred_len 96: 00h:10m:03.62s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1548019
	speed: 0.0900s/iter; left time: 1997.2662s
	iters: 200, epoch: 1 | loss: 0.1487349
	speed: 0.0641s/iter; left time: 1416.7502s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.73s
Steps: 223 | Train Loss: 0.1608134 Vali Loss: 0.1642606 Test Loss: 0.1773646
Validation loss decreased (inf --> 0.164261).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1214235
	speed: 0.1301s/iter; left time: 2859.2738s
	iters: 200, epoch: 2 | loss: 0.1186251
	speed: 0.0639s/iter; left time: 1397.0875s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.43s
Steps: 223 | Train Loss: 0.1239817 Vali Loss: 0.1269845 Test Loss: 0.1359027
Validation loss decreased (0.164261 --> 0.126984).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1170573
	speed: 0.1141s/iter; left time: 2481.2579s
	iters: 200, epoch: 3 | loss: 0.1074152
	speed: 0.0626s/iter; left time: 1355.8968s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.49s
Steps: 223 | Train Loss: 0.1123392 Vali Loss: 0.1241037 Test Loss: 0.1344680
Validation loss decreased (0.126984 --> 0.124104).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1116649
	speed: 0.1166s/iter; left time: 2510.2576s
	iters: 200, epoch: 4 | loss: 0.1098954
	speed: 0.0645s/iter; left time: 1381.7144s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.54s
Steps: 223 | Train Loss: 0.1095220 Vali Loss: 0.1238564 Test Loss: 0.1336398
Validation loss decreased (0.124104 --> 0.123856).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1103088
	speed: 0.1269s/iter; left time: 2703.5435s
	iters: 200, epoch: 5 | loss: 0.1059337
	speed: 0.0687s/iter; left time: 1456.5354s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.90s
Steps: 223 | Train Loss: 0.1077120 Vali Loss: 0.1238542 Test Loss: 0.1340634
Validation loss decreased (0.123856 --> 0.123854).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1093670
	speed: 0.1218s/iter; left time: 2568.9181s
	iters: 200, epoch: 6 | loss: 0.1044136
	speed: 0.0621s/iter; left time: 1302.6403s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.38s
Steps: 223 | Train Loss: 0.1062742 Vali Loss: 0.1234706 Test Loss: 0.1347027
Validation loss decreased (0.123854 --> 0.123471).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1005224
	speed: 0.1344s/iter; left time: 2804.3978s
	iters: 200, epoch: 7 | loss: 0.1047263
	speed: 0.0653s/iter; left time: 1356.3209s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:15.13s
Steps: 223 | Train Loss: 0.1051898 Vali Loss: 0.1239938 Test Loss: 0.1345310
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1043732
	speed: 0.1196s/iter; left time: 2468.3045s
	iters: 200, epoch: 8 | loss: 0.1046246
	speed: 0.0656s/iter; left time: 1346.6641s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.40s
Steps: 223 | Train Loss: 0.1041525 Vali Loss: 0.1243894 Test Loss: 0.1351599
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1036047
	speed: 0.1211s/iter; left time: 2471.9111s
	iters: 200, epoch: 9 | loss: 0.1000770
	speed: 0.0635s/iter; left time: 1289.7583s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.26s
Steps: 223 | Train Loss: 0.1031845 Vali Loss: 0.1245980 Test Loss: 0.1351988
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0945465
	speed: 0.1207s/iter; left time: 2436.4615s
	iters: 200, epoch: 10 | loss: 0.1016872
	speed: 0.0691s/iter; left time: 1387.7228s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.82s
Steps: 223 | Train Loss: 0.1024096 Vali Loss: 0.1248682 Test Loss: 0.1363112
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.1013406
	speed: 0.1286s/iter; left time: 2567.6965s
	iters: 200, epoch: 11 | loss: 0.1035435
	speed: 0.0634s/iter; left time: 1258.9571s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.43s
Steps: 223 | Train Loss: 0.1016130 Vali Loss: 0.1255188 Test Loss: 0.1362312
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0993369
	speed: 0.1206s/iter; left time: 2381.9857s
	iters: 200, epoch: 12 | loss: 0.1056814
	speed: 0.0647s/iter; left time: 1270.3699s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.43s
Steps: 223 | Train Loss: 0.1009609 Vali Loss: 0.1256741 Test Loss: 0.1363840
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1032659
	speed: 0.1047s/iter; left time: 2044.6814s
	iters: 200, epoch: 13 | loss: 0.0941548
	speed: 0.0645s/iter; left time: 1253.0465s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.15s
Steps: 223 | Train Loss: 0.1002403 Vali Loss: 0.1265315 Test Loss: 0.1380129
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0971907
	speed: 0.1131s/iter; left time: 2183.1087s
	iters: 200, epoch: 14 | loss: 0.1011847
	speed: 0.0609s/iter; left time: 1169.5128s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:13.70s
Steps: 223 | Train Loss: 0.0995397 Vali Loss: 0.1270013 Test Loss: 0.1374407
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0925344
	speed: 0.1130s/iter; left time: 2155.2259s
	iters: 200, epoch: 15 | loss: 0.0943704
	speed: 0.0592s/iter; left time: 1123.6044s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.57s
Steps: 223 | Train Loss: 0.0989645 Vali Loss: 0.1275917 Test Loss: 0.1384556
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0975892
	speed: 0.1249s/iter; left time: 2355.3288s
	iters: 200, epoch: 16 | loss: 0.0999596
	speed: 0.0650s/iter; left time: 1218.4199s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.73s
Steps: 223 | Train Loss: 0.0984323 Vali Loss: 0.1276390 Test Loss: 0.1387271
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03956723213195801, rmse:0.19891513884067535, mae:0.13470256328582764, rse:0.7045734524726868
Use GPU: cuda:0
>>>>>>>start training : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1586475
	speed: 0.0734s/iter; left time: 1629.1728s
	iters: 200, epoch: 1 | loss: 0.1522224
	speed: 0.0604s/iter; left time: 1335.7264s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.89s
Steps: 223 | Train Loss: 0.1616155 Vali Loss: 0.1641567 Test Loss: 0.1773076
Validation loss decreased (inf --> 0.164157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1187496
	speed: 0.1229s/iter; left time: 2701.4037s
	iters: 200, epoch: 2 | loss: 0.1157281
	speed: 0.0619s/iter; left time: 1354.7425s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.41s
Steps: 223 | Train Loss: 0.1241101 Vali Loss: 0.1277330 Test Loss: 0.1362454
Validation loss decreased (0.164157 --> 0.127733).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1088427
	speed: 0.1266s/iter; left time: 2755.2666s
	iters: 200, epoch: 3 | loss: 0.1101429
	speed: 0.0649s/iter; left time: 1405.2115s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.14s
Steps: 223 | Train Loss: 0.1123035 Vali Loss: 0.1245199 Test Loss: 0.1350362
Validation loss decreased (0.127733 --> 0.124520).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1039694
	speed: 0.1212s/iter; left time: 2609.4458s
	iters: 200, epoch: 4 | loss: 0.1144476
	speed: 0.0671s/iter; left time: 1439.0140s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.68s
Steps: 223 | Train Loss: 0.1094969 Vali Loss: 0.1235680 Test Loss: 0.1340981
Validation loss decreased (0.124520 --> 0.123568).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1059165
	speed: 0.1318s/iter; left time: 2808.1327s
	iters: 200, epoch: 5 | loss: 0.1059672
	speed: 0.0597s/iter; left time: 1265.9863s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:13.71s
Steps: 223 | Train Loss: 0.1077130 Vali Loss: 0.1228737 Test Loss: 0.1347752
Validation loss decreased (0.123568 --> 0.122874).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1075763
	speed: 0.6559s/iter; left time: 13829.7229s
	iters: 200, epoch: 6 | loss: 0.1046234
	speed: 0.0626s/iter; left time: 1314.4396s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.68s
Steps: 223 | Train Loss: 0.1062918 Vali Loss: 0.1232371 Test Loss: 0.1351631
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1086531
	speed: 0.1190s/iter; left time: 2483.6645s
	iters: 200, epoch: 7 | loss: 0.1062272
	speed: 0.0617s/iter; left time: 1281.0854s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.26s
Steps: 223 | Train Loss: 0.1050808 Vali Loss: 0.1232536 Test Loss: 0.1345480
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1097154
	speed: 0.1315s/iter; left time: 2713.5906s
	iters: 200, epoch: 8 | loss: 0.1039724
	speed: 0.0662s/iter; left time: 1359.5898s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.51s
Steps: 223 | Train Loss: 0.1040496 Vali Loss: 0.1236265 Test Loss: 0.1358001
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1069149
	speed: 0.1200s/iter; left time: 2450.3506s
	iters: 200, epoch: 9 | loss: 0.1070597
	speed: 0.0624s/iter; left time: 1268.5459s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.23s
Steps: 223 | Train Loss: 0.1030779 Vali Loss: 0.1237163 Test Loss: 0.1358926
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1037227
	speed: 0.1221s/iter; left time: 2465.3465s
	iters: 200, epoch: 10 | loss: 0.1070804
	speed: 0.0662s/iter; left time: 1330.9168s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.46s
Steps: 223 | Train Loss: 0.1020539 Vali Loss: 0.1243779 Test Loss: 0.1360747
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0994673
	speed: 0.1200s/iter; left time: 2396.6688s
	iters: 200, epoch: 11 | loss: 0.0967816
	speed: 0.0633s/iter; left time: 1257.5238s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.47s
Steps: 223 | Train Loss: 0.1011504 Vali Loss: 0.1246540 Test Loss: 0.1372310
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.1035772
	speed: 0.1201s/iter; left time: 2372.0802s
	iters: 200, epoch: 12 | loss: 0.1003781
	speed: 0.0617s/iter; left time: 1212.7039s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.11s
Steps: 223 | Train Loss: 0.1002424 Vali Loss: 0.1252042 Test Loss: 0.1371934
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.1011443
	speed: 0.1219s/iter; left time: 2379.8992s
	iters: 200, epoch: 13 | loss: 0.0993868
	speed: 0.0643s/iter; left time: 1249.1093s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.49s
Steps: 223 | Train Loss: 0.0994014 Vali Loss: 0.1259811 Test Loss: 0.1378808
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0967515
	speed: 0.1230s/iter; left time: 2374.0353s
	iters: 200, epoch: 14 | loss: 0.0992444
	speed: 0.0632s/iter; left time: 1213.7142s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.21s
Steps: 223 | Train Loss: 0.0987232 Vali Loss: 0.1261198 Test Loss: 0.1377028
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0974795
	speed: 0.1363s/iter; left time: 2601.1929s
	iters: 200, epoch: 15 | loss: 0.0960967
	speed: 0.0625s/iter; left time: 1186.2121s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.72s
Steps: 223 | Train Loss: 0.0980965 Vali Loss: 0.1264970 Test Loss: 0.1387069
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_168_DE_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.039511777460575104, rmse:0.19877569377422333, mae:0.13477523624897003, rse:0.7040795087814331
Intermediate time for DE and pred_len 168: 00h:10m:48.50sIntermediate time for DE: 00h:49m:20.15s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1337681
	speed: 0.0868s/iter; left time: 1936.7579s
	iters: 200, epoch: 1 | loss: 0.1301103
	speed: 0.0636s/iter; left time: 1411.7999s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.1369913 Vali Loss: 0.1359314 Test Loss: 0.1558871
Validation loss decreased (inf --> 0.135931).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0913649
	speed: 0.1162s/iter; left time: 2564.3709s
	iters: 200, epoch: 2 | loss: 0.0844155
	speed: 0.0601s/iter; left time: 1320.9655s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:13.87s
Steps: 224 | Train Loss: 0.0923259 Vali Loss: 0.0929204 Test Loss: 0.1050857
Validation loss decreased (0.135931 --> 0.092920).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0808693
	speed: 0.1155s/iter; left time: 2523.8923s
	iters: 200, epoch: 3 | loss: 0.0861732
	speed: 0.0605s/iter; left time: 1315.7404s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.74s
Steps: 224 | Train Loss: 0.0791791 Vali Loss: 0.0913382 Test Loss: 0.1042468
Validation loss decreased (0.092920 --> 0.091338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0733298
	speed: 0.1205s/iter; left time: 2606.2407s
	iters: 200, epoch: 4 | loss: 0.0772558
	speed: 0.0639s/iter; left time: 1375.5051s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.34s
Steps: 224 | Train Loss: 0.0773386 Vali Loss: 0.0909781 Test Loss: 0.1037574
Validation loss decreased (0.091338 --> 0.090978).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0725079
	speed: 0.1203s/iter; left time: 2574.9434s
	iters: 200, epoch: 5 | loss: 0.0707540
	speed: 0.0652s/iter; left time: 1389.6711s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.87s
Steps: 224 | Train Loss: 0.0761784 Vali Loss: 0.0895637 Test Loss: 0.1028150
Validation loss decreased (0.090978 --> 0.089564).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0770092
	speed: 0.1210s/iter; left time: 2562.1927s
	iters: 200, epoch: 6 | loss: 0.0714131
	speed: 0.0623s/iter; left time: 1313.1808s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.57s
Steps: 224 | Train Loss: 0.0753703 Vali Loss: 0.0893661 Test Loss: 0.1025691
Validation loss decreased (0.089564 --> 0.089366).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0798632
	speed: 0.1213s/iter; left time: 2541.0455s
	iters: 200, epoch: 7 | loss: 0.0708998
	speed: 0.0592s/iter; left time: 1233.9054s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.29s
Steps: 224 | Train Loss: 0.0748158 Vali Loss: 0.0894289 Test Loss: 0.1025083
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0749726
	speed: 0.1195s/iter; left time: 2477.4520s
	iters: 200, epoch: 8 | loss: 0.0733200
	speed: 0.0602s/iter; left time: 1241.1869s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.04s
Steps: 224 | Train Loss: 0.0743430 Vali Loss: 0.0890287 Test Loss: 0.1023971
Validation loss decreased (0.089366 --> 0.089029).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0791299
	speed: 0.1165s/iter; left time: 2389.3066s
	iters: 200, epoch: 9 | loss: 0.0748995
	speed: 0.0623s/iter; left time: 1271.5261s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.09s
Steps: 224 | Train Loss: 0.0738968 Vali Loss: 0.0888048 Test Loss: 0.1026755
Validation loss decreased (0.089029 --> 0.088805).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0725861
	speed: 0.1188s/iter; left time: 2409.0052s
	iters: 200, epoch: 10 | loss: 0.0756589
	speed: 0.0672s/iter; left time: 1355.7924s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.91s
Steps: 224 | Train Loss: 0.0735116 Vali Loss: 0.0885439 Test Loss: 0.1022316
Validation loss decreased (0.088805 --> 0.088544).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0702687
	speed: 0.1201s/iter; left time: 2409.4605s
	iters: 200, epoch: 11 | loss: 0.0753673
	speed: 0.0609s/iter; left time: 1215.7053s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.01s
Steps: 224 | Train Loss: 0.0731713 Vali Loss: 0.0884424 Test Loss: 0.1024115
Validation loss decreased (0.088544 --> 0.088442).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0696664
	speed: 0.1160s/iter; left time: 2300.1433s
	iters: 200, epoch: 12 | loss: 0.0712836
	speed: 0.0667s/iter; left time: 1316.7395s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.08s
Steps: 224 | Train Loss: 0.0729458 Vali Loss: 0.0885137 Test Loss: 0.1023535
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0772517
	speed: 0.1169s/iter; left time: 2292.0473s
	iters: 200, epoch: 13 | loss: 0.0727321
	speed: 0.0613s/iter; left time: 1195.2042s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.06s
Steps: 224 | Train Loss: 0.0727253 Vali Loss: 0.0882543 Test Loss: 0.1018357
Validation loss decreased (0.088442 --> 0.088254).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0730511
	speed: 0.1200s/iter; left time: 2325.9716s
	iters: 200, epoch: 14 | loss: 0.0743207
	speed: 0.0668s/iter; left time: 1288.7007s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.81s
Steps: 224 | Train Loss: 0.0724939 Vali Loss: 0.0883527 Test Loss: 0.1019900
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0745256
	speed: 0.1176s/iter; left time: 2254.6487s
	iters: 200, epoch: 15 | loss: 0.0704399
	speed: 0.0627s/iter; left time: 1196.2686s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.40s
Steps: 224 | Train Loss: 0.0722996 Vali Loss: 0.0880289 Test Loss: 0.1020303
Validation loss decreased (0.088254 --> 0.088029).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0770125
	speed: 0.1233s/iter; left time: 2334.9534s
	iters: 200, epoch: 16 | loss: 0.0694815
	speed: 0.0654s/iter; left time: 1233.0219s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.56s
Steps: 224 | Train Loss: 0.0721522 Vali Loss: 0.0880209 Test Loss: 0.1023730
Validation loss decreased (0.088029 --> 0.088021).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0658797
	speed: 0.1162s/iter; left time: 2175.6583s
	iters: 200, epoch: 17 | loss: 0.0695038
	speed: 0.0625s/iter; left time: 1163.3805s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.31s
Steps: 224 | Train Loss: 0.0719564 Vali Loss: 0.0880820 Test Loss: 0.1024347
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0731994
	speed: 0.1171s/iter; left time: 2165.5143s
	iters: 200, epoch: 18 | loss: 0.0695477
	speed: 0.0593s/iter; left time: 1089.8425s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:13.88s
Steps: 224 | Train Loss: 0.0718094 Vali Loss: 0.0881291 Test Loss: 0.1022878
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0677946
	speed: 0.1246s/iter; left time: 2277.1222s
	iters: 200, epoch: 19 | loss: 0.0691350
	speed: 0.0628s/iter; left time: 1140.5862s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.33s
Steps: 224 | Train Loss: 0.0717229 Vali Loss: 0.0878378 Test Loss: 0.1025048
Validation loss decreased (0.088021 --> 0.087838).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0751754
	speed: 0.1232s/iter; left time: 2222.6911s
	iters: 200, epoch: 20 | loss: 0.0717342
	speed: 0.0619s/iter; left time: 1110.3601s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:14.15s
Steps: 224 | Train Loss: 0.0715432 Vali Loss: 0.0879541 Test Loss: 0.1023896
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0683073
	speed: 0.1249s/iter; left time: 2224.9614s
	iters: 200, epoch: 21 | loss: 0.0753092
	speed: 0.0660s/iter; left time: 1169.0402s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:14.62s
Steps: 224 | Train Loss: 0.0714210 Vali Loss: 0.0878884 Test Loss: 0.1025704
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0739669
	speed: 0.1205s/iter; left time: 2121.0634s
	iters: 200, epoch: 22 | loss: 0.0735120
	speed: 0.0614s/iter; left time: 1074.5335s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:14.06s
Steps: 224 | Train Loss: 0.0713990 Vali Loss: 0.0879366 Test Loss: 0.1023931
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0725404
	speed: 0.1126s/iter; left time: 1955.3926s
	iters: 200, epoch: 23 | loss: 0.0742865
	speed: 0.0624s/iter; left time: 1078.6649s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:14.20s
Steps: 224 | Train Loss: 0.0712040 Vali Loss: 0.0877694 Test Loss: 0.1021546
Validation loss decreased (0.087838 --> 0.087769).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0733356
	speed: 0.1168s/iter; left time: 2003.7803s
	iters: 200, epoch: 24 | loss: 0.0658376
	speed: 0.0609s/iter; left time: 1037.4820s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:14.04s
Steps: 224 | Train Loss: 0.0712310 Vali Loss: 0.0878737 Test Loss: 0.1022747
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0756377
	speed: 0.1149s/iter; left time: 1944.4751s
	iters: 200, epoch: 25 | loss: 0.0714636
	speed: 0.0594s/iter; left time: 999.1545s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:14.63s
Steps: 224 | Train Loss: 0.0711283 Vali Loss: 0.0876985 Test Loss: 0.1023861
Validation loss decreased (0.087769 --> 0.087698).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0730481
	speed: 0.1188s/iter; left time: 1983.7603s
	iters: 200, epoch: 26 | loss: 0.0673774
	speed: 0.0593s/iter; left time: 983.8889s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:14.10s
Steps: 224 | Train Loss: 0.0710204 Vali Loss: 0.0878645 Test Loss: 0.1025371
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0692971
	speed: 0.1137s/iter; left time: 1874.2166s
	iters: 200, epoch: 27 | loss: 0.0748941
	speed: 0.0652s/iter; left time: 1067.0693s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:14.42s
Steps: 224 | Train Loss: 0.0709922 Vali Loss: 0.0878092 Test Loss: 0.1024434
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0731720
	speed: 0.1200s/iter; left time: 1950.9543s
	iters: 200, epoch: 28 | loss: 0.0709607
	speed: 0.0603s/iter; left time: 974.2112s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:13.87s
Steps: 224 | Train Loss: 0.0709522 Vali Loss: 0.0876303 Test Loss: 0.1024348
Validation loss decreased (0.087698 --> 0.087630).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0729126
	speed: 0.1211s/iter; left time: 1941.7161s
	iters: 200, epoch: 29 | loss: 0.0757939
	speed: 0.0651s/iter; left time: 1037.0487s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:14.78s
Steps: 224 | Train Loss: 0.0709114 Vali Loss: 0.0877213 Test Loss: 0.1024486
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0686514
	speed: 0.1102s/iter; left time: 1742.4861s
	iters: 200, epoch: 30 | loss: 0.0682729
	speed: 0.0625s/iter; left time: 981.5230s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:14.46s
Steps: 224 | Train Loss: 0.0708208 Vali Loss: 0.0877651 Test Loss: 0.1023511
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0680746
	speed: 0.1151s/iter; left time: 1792.9372s
	iters: 200, epoch: 31 | loss: 0.0703695
	speed: 0.0627s/iter; left time: 970.6050s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:14.27s
Steps: 224 | Train Loss: 0.0707644 Vali Loss: 0.0875608 Test Loss: 0.1024484
Validation loss decreased (0.087630 --> 0.087561).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0712823
	speed: 0.1163s/iter; left time: 1786.0487s
	iters: 200, epoch: 32 | loss: 0.0645696
	speed: 0.0600s/iter; left time: 915.7315s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:13.96s
Steps: 224 | Train Loss: 0.0707321 Vali Loss: 0.0877208 Test Loss: 0.1026194
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0686052
	speed: 0.1112s/iter; left time: 1682.6177s
	iters: 200, epoch: 33 | loss: 0.0751981
	speed: 0.0646s/iter; left time: 971.2918s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:14.44s
Steps: 224 | Train Loss: 0.0707160 Vali Loss: 0.0876859 Test Loss: 0.1025198
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0700265
	speed: 0.1214s/iter; left time: 1810.5830s
	iters: 200, epoch: 34 | loss: 0.0709091
	speed: 0.0608s/iter; left time: 899.7408s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:13.81s
Steps: 224 | Train Loss: 0.0706691 Vali Loss: 0.0876336 Test Loss: 0.1025292
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0714695
	speed: 0.1110s/iter; left time: 1630.1832s
	iters: 200, epoch: 35 | loss: 0.0675804
	speed: 0.0599s/iter; left time: 872.9738s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:13.45s
Steps: 224 | Train Loss: 0.0706608 Vali Loss: 0.0876634 Test Loss: 0.1025143
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0716697
	speed: 0.0947s/iter; left time: 1369.7271s
	iters: 200, epoch: 36 | loss: 0.0745230
	speed: 0.0517s/iter; left time: 742.6140s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0706338 Vali Loss: 0.0876844 Test Loss: 0.1025104
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0692014
	speed: 0.1217s/iter; left time: 1733.2740s
	iters: 200, epoch: 37 | loss: 0.0667195
	speed: 0.0626s/iter; left time: 885.5367s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:14.19s
Steps: 224 | Train Loss: 0.0706335 Vali Loss: 0.0875388 Test Loss: 0.1025336
Validation loss decreased (0.087561 --> 0.087539).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0696882
	speed: 0.1181s/iter; left time: 1655.2586s
	iters: 200, epoch: 38 | loss: 0.0767173
	speed: 0.0610s/iter; left time: 849.0377s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:13.91s
Steps: 224 | Train Loss: 0.0705597 Vali Loss: 0.0876549 Test Loss: 0.1025695
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0688473
	speed: 0.0950s/iter; left time: 1309.3053s
	iters: 200, epoch: 39 | loss: 0.0736877
	speed: 0.0520s/iter; left time: 711.9096s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0705348 Vali Loss: 0.0877679 Test Loss: 0.1025379
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0706787
	speed: 0.1153s/iter; left time: 1563.5974s
	iters: 200, epoch: 40 | loss: 0.0669279
	speed: 0.0599s/iter; left time: 807.0008s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:13.19s
Steps: 224 | Train Loss: 0.0705901 Vali Loss: 0.0876181 Test Loss: 0.1025662
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0689001
	speed: 0.1126s/iter; left time: 1502.0343s
	iters: 200, epoch: 41 | loss: 0.0677012
	speed: 0.0592s/iter; left time: 784.0345s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:13.64s
Steps: 224 | Train Loss: 0.0705525 Vali Loss: 0.0876695 Test Loss: 0.1025416
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0700784
	speed: 0.1085s/iter; left time: 1423.8183s
	iters: 200, epoch: 42 | loss: 0.0700355
	speed: 0.0524s/iter; left time: 681.8888s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:13.10s
Steps: 224 | Train Loss: 0.0705240 Vali Loss: 0.0876143 Test Loss: 0.1026173
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0726577
	speed: 0.0937s/iter; left time: 1208.0978s
	iters: 200, epoch: 43 | loss: 0.0706721
	speed: 0.0666s/iter; left time: 852.6060s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:13.62s
Steps: 224 | Train Loss: 0.0705564 Vali Loss: 0.0876295 Test Loss: 0.1025662
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0696796
	speed: 0.1180s/iter; left time: 1494.3399s
	iters: 200, epoch: 44 | loss: 0.0707281
	speed: 0.0618s/iter; left time: 777.1145s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:14.01s
Steps: 224 | Train Loss: 0.0704933 Vali Loss: 0.0876881 Test Loss: 0.1025814
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0757044
	speed: 0.1182s/iter; left time: 1470.5980s
	iters: 200, epoch: 45 | loss: 0.0726157
	speed: 0.0622s/iter; left time: 767.3434s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:14.21s
Steps: 224 | Train Loss: 0.0705575 Vali Loss: 0.0874810 Test Loss: 0.1025429
Validation loss decreased (0.087539 --> 0.087481).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0742189
	speed: 0.2277s/iter; left time: 2782.1286s
	iters: 200, epoch: 46 | loss: 0.0736142
	speed: 0.0627s/iter; left time: 760.4872s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:14.15s
Steps: 224 | Train Loss: 0.0705232 Vali Loss: 0.0875848 Test Loss: 0.1025821
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0672498
	speed: 0.1024s/iter; left time: 1228.8916s
	iters: 200, epoch: 47 | loss: 0.0682913
	speed: 0.0521s/iter; left time: 620.0541s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0704723 Vali Loss: 0.0876123 Test Loss: 0.1025846
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0696902
	speed: 0.0933s/iter; left time: 1098.1261s
	iters: 200, epoch: 48 | loss: 0.0676515
	speed: 0.0520s/iter; left time: 607.0762s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0705277 Vali Loss: 0.0876810 Test Loss: 0.1025829
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0700386
	speed: 0.0922s/iter; left time: 1064.3500s
	iters: 200, epoch: 49 | loss: 0.0666300
	speed: 0.0611s/iter; left time: 699.8407s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:13.04s
Steps: 224 | Train Loss: 0.0704845 Vali Loss: 0.0876203 Test Loss: 0.1025853
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0734844
	speed: 0.1189s/iter; left time: 1346.1992s
	iters: 200, epoch: 50 | loss: 0.0679541
	speed: 0.0615s/iter; left time: 690.6651s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:14.34s
Steps: 224 | Train Loss: 0.0704916 Vali Loss: 0.0877179 Test Loss: 0.1025884
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0736447
	speed: 0.1181s/iter; left time: 1310.7513s
	iters: 200, epoch: 51 | loss: 0.0654428
	speed: 0.0587s/iter; left time: 646.0817s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:13.99s
Steps: 224 | Train Loss: 0.0705029 Vali Loss: 0.0875974 Test Loss: 0.1025916
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0700766
	speed: 0.1123s/iter; left time: 1221.1836s
	iters: 200, epoch: 52 | loss: 0.0760974
	speed: 0.0532s/iter; left time: 573.0622s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:12.38s
Steps: 224 | Train Loss: 0.0704561 Vali Loss: 0.0875556 Test Loss: 0.1025784
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0712552
	speed: 0.0947s/iter; left time: 1008.3603s
	iters: 200, epoch: 53 | loss: 0.0681484
	speed: 0.0526s/iter; left time: 555.5226s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:12.02s
Steps: 224 | Train Loss: 0.0704864 Vali Loss: 0.0875903 Test Loss: 0.1026226
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0698976
	speed: 0.0951s/iter; left time: 991.3998s
	iters: 200, epoch: 54 | loss: 0.0694280
	speed: 0.0522s/iter; left time: 539.4355s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:12.04s
Steps: 224 | Train Loss: 0.0705067 Vali Loss: 0.0876638 Test Loss: 0.1025732
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0714906
	speed: 0.1149s/iter; left time: 1172.4986s
	iters: 200, epoch: 55 | loss: 0.0664937
	speed: 0.0600s/iter; left time: 606.7241s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:13.75s
Steps: 224 | Train Loss: 0.0704601 Vali Loss: 0.0876570 Test Loss: 0.1026139
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.026038529351353645, rmse:0.1613645851612091, mae:0.10254285484552383, rse:0.5566620826721191
Use GPU: cuda:0
>>>>>>>start training : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1340888
	speed: 0.0660s/iter; left time: 1471.4037s
	iters: 200, epoch: 1 | loss: 0.1284338
	speed: 0.0603s/iter; left time: 1338.4338s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.93s
Steps: 224 | Train Loss: 0.1371192 Vali Loss: 0.1359184 Test Loss: 0.1564447
Validation loss decreased (inf --> 0.135918).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0986784
	speed: 0.4945s/iter; left time: 10917.3591s
	iters: 200, epoch: 2 | loss: 0.0827210
	speed: 0.0647s/iter; left time: 1422.2700s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.07s
Steps: 224 | Train Loss: 0.0929912 Vali Loss: 0.0933088 Test Loss: 0.1047612
Validation loss decreased (0.135918 --> 0.093309).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0803287
	speed: 0.1140s/iter; left time: 2491.7140s
	iters: 200, epoch: 3 | loss: 0.0777847
	speed: 0.0617s/iter; left time: 1342.2615s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.87s
Steps: 224 | Train Loss: 0.0793267 Vali Loss: 0.0914609 Test Loss: 0.1030556
Validation loss decreased (0.093309 --> 0.091461).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0806357
	speed: 0.1081s/iter; left time: 2337.6324s
	iters: 200, epoch: 4 | loss: 0.0757164
	speed: 0.0641s/iter; left time: 1379.0303s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.36s
Steps: 224 | Train Loss: 0.0774351 Vali Loss: 0.0906578 Test Loss: 0.1030808
Validation loss decreased (0.091461 --> 0.090658).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0742374
	speed: 0.5220s/iter; left time: 11172.5059s
	iters: 200, epoch: 5 | loss: 0.0708531
	speed: 0.0615s/iter; left time: 1310.6161s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.0764426 Vali Loss: 0.0899601 Test Loss: 0.1026692
Validation loss decreased (0.090658 --> 0.089960).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0776469
	speed: 0.1158s/iter; left time: 2451.7164s
	iters: 200, epoch: 6 | loss: 0.0802776
	speed: 0.0611s/iter; left time: 1287.1407s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.07s
Steps: 224 | Train Loss: 0.0755150 Vali Loss: 0.0892671 Test Loss: 0.1024971
Validation loss decreased (0.089960 --> 0.089267).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0744159
	speed: 0.1243s/iter; left time: 2604.1160s
	iters: 200, epoch: 7 | loss: 0.0703802
	speed: 0.0622s/iter; left time: 1297.3166s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.0749787 Vali Loss: 0.0892036 Test Loss: 0.1022584
Validation loss decreased (0.089267 --> 0.089204).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0728884
	speed: 0.1180s/iter; left time: 2447.3257s
	iters: 200, epoch: 8 | loss: 0.0763242
	speed: 0.0635s/iter; left time: 1309.7281s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.46s
Steps: 224 | Train Loss: 0.0744411 Vali Loss: 0.0888207 Test Loss: 0.1025281
Validation loss decreased (0.089204 --> 0.088821).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0749100
	speed: 0.1223s/iter; left time: 2507.3213s
	iters: 200, epoch: 9 | loss: 0.0729593
	speed: 0.0610s/iter; left time: 1244.6008s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.20s
Steps: 224 | Train Loss: 0.0740723 Vali Loss: 0.0889069 Test Loss: 0.1022433
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0736462
	speed: 0.1156s/iter; left time: 2344.9781s
	iters: 200, epoch: 10 | loss: 0.0683928
	speed: 0.0614s/iter; left time: 1238.5355s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.00s
Steps: 224 | Train Loss: 0.0736698 Vali Loss: 0.0882708 Test Loss: 0.1022037
Validation loss decreased (0.088821 --> 0.088271).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0685093
	speed: 0.1216s/iter; left time: 2438.8077s
	iters: 200, epoch: 11 | loss: 0.0748501
	speed: 0.0592s/iter; left time: 1181.8721s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.41s
Steps: 224 | Train Loss: 0.0733367 Vali Loss: 0.0885927 Test Loss: 0.1025729
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0694412
	speed: 0.1136s/iter; left time: 2252.9359s
	iters: 200, epoch: 12 | loss: 0.0729200
	speed: 0.0605s/iter; left time: 1194.4188s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.83s
Steps: 224 | Train Loss: 0.0730160 Vali Loss: 0.0883027 Test Loss: 0.1023279
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0722981
	speed: 0.1082s/iter; left time: 2122.8684s
	iters: 200, epoch: 13 | loss: 0.0708375
	speed: 0.0544s/iter; left time: 1061.1002s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.82s
Steps: 224 | Train Loss: 0.0727724 Vali Loss: 0.0881370 Test Loss: 0.1023577
Validation loss decreased (0.088271 --> 0.088137).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0679360
	speed: 0.3480s/iter; left time: 6747.4344s
	iters: 200, epoch: 14 | loss: 0.0720937
	speed: 0.0607s/iter; left time: 1171.7815s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.18s
Steps: 224 | Train Loss: 0.0726295 Vali Loss: 0.0878316 Test Loss: 0.1023786
Validation loss decreased (0.088137 --> 0.087832).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0757486
	speed: 0.1148s/iter; left time: 2200.2165s
	iters: 200, epoch: 15 | loss: 0.0714281
	speed: 0.0594s/iter; left time: 1131.9726s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:13.89s
Steps: 224 | Train Loss: 0.0723702 Vali Loss: 0.0882032 Test Loss: 0.1025239
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0744029
	speed: 0.1153s/iter; left time: 2184.6316s
	iters: 200, epoch: 16 | loss: 0.0732896
	speed: 0.0634s/iter; left time: 1194.2174s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.18s
Steps: 224 | Train Loss: 0.0722303 Vali Loss: 0.0879967 Test Loss: 0.1022053
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0708814
	speed: 0.1167s/iter; left time: 2183.4234s
	iters: 200, epoch: 17 | loss: 0.0643175
	speed: 0.0611s/iter; left time: 1136.8506s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:14.23s
Steps: 224 | Train Loss: 0.0720519 Vali Loss: 0.0878360 Test Loss: 0.1024031
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0691474
	speed: 0.1158s/iter; left time: 2141.6789s
	iters: 200, epoch: 18 | loss: 0.0731347
	speed: 0.0641s/iter; left time: 1178.8225s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:14.42s
Steps: 224 | Train Loss: 0.0717889 Vali Loss: 0.0880502 Test Loss: 0.1021411
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0713383
	speed: 0.1194s/iter; left time: 2180.5338s
	iters: 200, epoch: 19 | loss: 0.0802521
	speed: 0.0602s/iter; left time: 1093.1500s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:14.02s
Steps: 224 | Train Loss: 0.0717140 Vali Loss: 0.0880324 Test Loss: 0.1025808
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0718002
	speed: 0.1141s/iter; left time: 2058.5406s
	iters: 200, epoch: 20 | loss: 0.0694699
	speed: 0.0658s/iter; left time: 1181.4011s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.0716252 Vali Loss: 0.0878140 Test Loss: 0.1023368
Validation loss decreased (0.087832 --> 0.087814).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0732282
	speed: 0.1218s/iter; left time: 2171.3306s
	iters: 200, epoch: 21 | loss: 0.0687660
	speed: 0.0594s/iter; left time: 1052.6726s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:13.98s
Steps: 224 | Train Loss: 0.0715591 Vali Loss: 0.0878166 Test Loss: 0.1024134
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0704203
	speed: 0.1146s/iter; left time: 2017.2312s
	iters: 200, epoch: 22 | loss: 0.0698574
	speed: 0.0555s/iter; left time: 970.6852s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:13.20s
Steps: 224 | Train Loss: 0.0714010 Vali Loss: 0.0878006 Test Loss: 0.1022703
Validation loss decreased (0.087814 --> 0.087801).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0693955
	speed: 0.2618s/iter; left time: 4549.0035s
	iters: 200, epoch: 23 | loss: 0.0668513
	speed: 0.0634s/iter; left time: 1095.2904s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:14.22s
Steps: 224 | Train Loss: 0.0713579 Vali Loss: 0.0878292 Test Loss: 0.1025530
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0714743
	speed: 0.1161s/iter; left time: 1991.3234s
	iters: 200, epoch: 24 | loss: 0.0696637
	speed: 0.0607s/iter; left time: 1034.2725s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:14.09s
Steps: 224 | Train Loss: 0.0712420 Vali Loss: 0.0878795 Test Loss: 0.1024655
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0674481
	speed: 0.1051s/iter; left time: 1778.2076s
	iters: 200, epoch: 25 | loss: 0.0701551
	speed: 0.0517s/iter; left time: 870.3101s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:12.02s
Steps: 224 | Train Loss: 0.0711827 Vali Loss: 0.0878567 Test Loss: 0.1025342
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0699493
	speed: 0.0942s/iter; left time: 1573.0250s
	iters: 200, epoch: 26 | loss: 0.0704517
	speed: 0.0522s/iter; left time: 865.7694s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0711286 Vali Loss: 0.0878145 Test Loss: 0.1025468
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0690658
	speed: 0.1034s/iter; left time: 1704.1756s
	iters: 200, epoch: 27 | loss: 0.0724766
	speed: 0.0617s/iter; left time: 1009.6469s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:14.09s
Steps: 224 | Train Loss: 0.0710852 Vali Loss: 0.0877976 Test Loss: 0.1023908
Validation loss decreased (0.087801 --> 0.087798).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0726968
	speed: 0.1150s/iter; left time: 1869.2111s
	iters: 200, epoch: 28 | loss: 0.0673573
	speed: 0.0635s/iter; left time: 1026.0186s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:14.24s
Steps: 224 | Train Loss: 0.0710127 Vali Loss: 0.0877014 Test Loss: 0.1025226
Validation loss decreased (0.087798 --> 0.087701).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0690880
	speed: 0.1155s/iter; left time: 1851.7290s
	iters: 200, epoch: 29 | loss: 0.0689618
	speed: 0.0634s/iter; left time: 1009.7858s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:14.02s
Steps: 224 | Train Loss: 0.0709411 Vali Loss: 0.0878401 Test Loss: 0.1026098
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0678539
	speed: 0.1140s/iter; left time: 1801.9069s
	iters: 200, epoch: 30 | loss: 0.0694931
	speed: 0.0602s/iter; left time: 945.9111s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:13.92s
Steps: 224 | Train Loss: 0.0709095 Vali Loss: 0.0877920 Test Loss: 0.1025607
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0682457
	speed: 0.1101s/iter; left time: 1715.7674s
	iters: 200, epoch: 31 | loss: 0.0681491
	speed: 0.0523s/iter; left time: 809.6913s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:12.38s
Steps: 224 | Train Loss: 0.0708165 Vali Loss: 0.0876857 Test Loss: 0.1025284
Validation loss decreased (0.087701 --> 0.087686).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0699011
	speed: 0.1130s/iter; left time: 1734.9976s
	iters: 200, epoch: 32 | loss: 0.0707282
	speed: 0.0611s/iter; left time: 932.5047s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:14.05s
Steps: 224 | Train Loss: 0.0708926 Vali Loss: 0.0877611 Test Loss: 0.1025761
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0750260
	speed: 0.1159s/iter; left time: 1754.2271s
	iters: 200, epoch: 33 | loss: 0.0712225
	speed: 0.0630s/iter; left time: 946.5637s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:14.18s
Steps: 224 | Train Loss: 0.0708430 Vali Loss: 0.0878547 Test Loss: 0.1025163
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0709231
	speed: 0.1142s/iter; left time: 1702.8946s
	iters: 200, epoch: 34 | loss: 0.0734632
	speed: 0.0636s/iter; left time: 941.3821s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:14.11s
Steps: 224 | Train Loss: 0.0707557 Vali Loss: 0.0878187 Test Loss: 0.1025741
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0741756
	speed: 0.1175s/iter; left time: 1726.0605s
	iters: 200, epoch: 35 | loss: 0.0756165
	speed: 0.0613s/iter; left time: 894.7392s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:14.01s
Steps: 224 | Train Loss: 0.0707925 Vali Loss: 0.0877389 Test Loss: 0.1025545
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0762861
	speed: 0.1141s/iter; left time: 1650.5060s
	iters: 200, epoch: 36 | loss: 0.0745686
	speed: 0.0672s/iter; left time: 964.8825s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:14.73s
Steps: 224 | Train Loss: 0.0706969 Vali Loss: 0.0878429 Test Loss: 0.1024922
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0752780
	speed: 0.1237s/iter; left time: 1761.3536s
	iters: 200, epoch: 37 | loss: 0.0681149
	speed: 0.0646s/iter; left time: 913.4594s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:14.44s
Steps: 224 | Train Loss: 0.0706726 Vali Loss: 0.0878174 Test Loss: 0.1026253
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0696197
	speed: 0.1222s/iter; left time: 1711.6998s
	iters: 200, epoch: 38 | loss: 0.0708822
	speed: 0.0643s/iter; left time: 893.9755s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:14.24s
Steps: 224 | Train Loss: 0.0706715 Vali Loss: 0.0877813 Test Loss: 0.1026189
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0691303
	speed: 0.1161s/iter; left time: 1600.8219s
	iters: 200, epoch: 39 | loss: 0.0709607
	speed: 0.0619s/iter; left time: 847.2887s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:14.32s
Steps: 224 | Train Loss: 0.0706529 Vali Loss: 0.0878448 Test Loss: 0.1025701
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0710506
	speed: 0.1200s/iter; left time: 1627.5560s
	iters: 200, epoch: 40 | loss: 0.0685172
	speed: 0.0627s/iter; left time: 844.4490s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:14.56s
Steps: 224 | Train Loss: 0.0706797 Vali Loss: 0.0877237 Test Loss: 0.1025156
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0680695
	speed: 0.1158s/iter; left time: 1545.4338s
	iters: 200, epoch: 41 | loss: 0.0707226
	speed: 0.0626s/iter; left time: 829.1798s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:14.24s
Steps: 224 | Train Loss: 0.0706761 Vali Loss: 0.0877903 Test Loss: 0.1025302
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_24_GB_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02596805803477764, rmse:0.16114607453346252, mae:0.1025284007191658, rse:0.5559083223342896
Intermediate time for GB and pred_len 24: 00h:30m:33.98s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1406689
	speed: 0.0823s/iter; left time: 1835.0206s
	iters: 200, epoch: 1 | loss: 0.1337222
	speed: 0.0619s/iter; left time: 1374.8378s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:13.94s
Steps: 224 | Train Loss: 0.1448316 Vali Loss: 0.1478217 Test Loss: 0.1731035
Validation loss decreased (inf --> 0.147822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1138583
	speed: 0.1278s/iter; left time: 2820.4656s
	iters: 200, epoch: 2 | loss: 0.1043878
	speed: 0.0633s/iter; left time: 1390.6418s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.41s
Steps: 224 | Train Loss: 0.1130484 Vali Loss: 0.1190484 Test Loss: 0.1404722
Validation loss decreased (0.147822 --> 0.119048).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1049010
	speed: 0.1213s/iter; left time: 2650.0037s
	iters: 200, epoch: 3 | loss: 0.0996536
	speed: 0.0649s/iter; left time: 1412.1218s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.70s
Steps: 224 | Train Loss: 0.1032481 Vali Loss: 0.1175735 Test Loss: 0.1405436
Validation loss decreased (0.119048 --> 0.117573).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0995604
	speed: 0.1199s/iter; left time: 2594.3313s
	iters: 200, epoch: 4 | loss: 0.1006075
	speed: 0.0658s/iter; left time: 1417.3907s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.1012283 Vali Loss: 0.1169945 Test Loss: 0.1409361
Validation loss decreased (0.117573 --> 0.116995).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1010126
	speed: 0.1221s/iter; left time: 2613.1633s
	iters: 200, epoch: 5 | loss: 0.1020785
	speed: 0.0628s/iter; left time: 1338.2504s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.14s
Steps: 224 | Train Loss: 0.0999265 Vali Loss: 0.1165816 Test Loss: 0.1420393
Validation loss decreased (0.116995 --> 0.116582).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0985006
	speed: 0.1318s/iter; left time: 2792.6654s
	iters: 200, epoch: 6 | loss: 0.1023615
	speed: 0.0626s/iter; left time: 1319.5779s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.49s
Steps: 224 | Train Loss: 0.0988150 Vali Loss: 0.1164725 Test Loss: 0.1419193
Validation loss decreased (0.116582 --> 0.116472).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0936005
	speed: 0.1236s/iter; left time: 2591.0371s
	iters: 200, epoch: 7 | loss: 0.1041656
	speed: 0.0631s/iter; left time: 1315.2322s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.35s
Steps: 224 | Train Loss: 0.0977622 Vali Loss: 0.1164984 Test Loss: 0.1426636
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0965147
	speed: 0.1247s/iter; left time: 2585.0378s
	iters: 200, epoch: 8 | loss: 0.0945425
	speed: 0.0637s/iter; left time: 1314.1464s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.85s
Steps: 224 | Train Loss: 0.0968455 Vali Loss: 0.1165157 Test Loss: 0.1424598
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0966142
	speed: 0.1144s/iter; left time: 2346.4920s
	iters: 200, epoch: 9 | loss: 0.0961041
	speed: 0.0605s/iter; left time: 1235.5437s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.08s
Steps: 224 | Train Loss: 0.0958037 Vali Loss: 0.1168818 Test Loss: 0.1435367
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0900782
	speed: 0.1233s/iter; left time: 2500.5987s
	iters: 200, epoch: 10 | loss: 0.0928683
	speed: 0.0619s/iter; left time: 1249.8912s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.35s
Steps: 224 | Train Loss: 0.0950237 Vali Loss: 0.1168693 Test Loss: 0.1427697
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0930412
	speed: 0.1195s/iter; left time: 2398.1426s
	iters: 200, epoch: 11 | loss: 0.0950651
	speed: 0.0608s/iter; left time: 1212.7976s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.22s
Steps: 224 | Train Loss: 0.0941731 Vali Loss: 0.1173024 Test Loss: 0.1442032
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0968957
	speed: 0.1238s/iter; left time: 2455.4159s
	iters: 200, epoch: 12 | loss: 0.0931910
	speed: 0.0682s/iter; left time: 1345.9021s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.29s
Steps: 224 | Train Loss: 0.0934533 Vali Loss: 0.1175537 Test Loss: 0.1439120
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0920408
	speed: 0.1144s/iter; left time: 2243.8479s
	iters: 200, epoch: 13 | loss: 0.0944622
	speed: 0.0595s/iter; left time: 1160.8346s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:13.88s
Steps: 224 | Train Loss: 0.0928211 Vali Loss: 0.1180769 Test Loss: 0.1442586
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0956941
	speed: 0.1216s/iter; left time: 2356.9536s
	iters: 200, epoch: 14 | loss: 0.0928700
	speed: 0.0644s/iter; left time: 1242.9461s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.72s
Steps: 224 | Train Loss: 0.0922051 Vali Loss: 0.1175812 Test Loss: 0.1443594
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0883551
	speed: 0.1157s/iter; left time: 2217.1026s
	iters: 200, epoch: 15 | loss: 0.0926333
	speed: 0.0611s/iter; left time: 1165.3831s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.18s
Steps: 224 | Train Loss: 0.0916389 Vali Loss: 0.1180225 Test Loss: 0.1446331
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0901917
	speed: 0.1191s/iter; left time: 2256.7343s
	iters: 200, epoch: 16 | loss: 0.0919948
	speed: 0.0651s/iter; left time: 1226.9013s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.48s
Steps: 224 | Train Loss: 0.0911649 Vali Loss: 0.1185595 Test Loss: 0.1457173
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04354952275753021, rmse:0.20868521928787231, mae:0.14191927015781403, rse:0.7216625809669495
Use GPU: cuda:0
>>>>>>>start training : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1456753
	speed: 0.0659s/iter; left time: 1469.7148s
	iters: 200, epoch: 1 | loss: 0.1401336
	speed: 0.0608s/iter; left time: 1350.7358s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.38s
Steps: 224 | Train Loss: 0.1450534 Vali Loss: 0.1476693 Test Loss: 0.1731948
Validation loss decreased (inf --> 0.147669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1121303
	speed: 0.1188s/iter; left time: 2623.2381s
	iters: 200, epoch: 2 | loss: 0.1097031
	speed: 0.0653s/iter; left time: 1434.9295s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.53s
Steps: 224 | Train Loss: 0.1142875 Vali Loss: 0.1189107 Test Loss: 0.1412798
Validation loss decreased (0.147669 --> 0.118911).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1073427
	speed: 0.1252s/iter; left time: 2735.8081s
	iters: 200, epoch: 3 | loss: 0.1005311
	speed: 0.0646s/iter; left time: 1405.5552s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:14.39s
Steps: 224 | Train Loss: 0.1034565 Vali Loss: 0.1175246 Test Loss: 0.1412851
Validation loss decreased (0.118911 --> 0.117525).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1021812
	speed: 0.1231s/iter; left time: 2661.5713s
	iters: 200, epoch: 4 | loss: 0.0990468
	speed: 0.0681s/iter; left time: 1466.2073s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.03s
Steps: 224 | Train Loss: 0.1013426 Vali Loss: 0.1167549 Test Loss: 0.1418313
Validation loss decreased (0.117525 --> 0.116755).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0974963
	speed: 0.1285s/iter; left time: 2750.3261s
	iters: 200, epoch: 5 | loss: 0.1008517
	speed: 0.0612s/iter; left time: 1303.3755s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.64s
Steps: 224 | Train Loss: 0.0997085 Vali Loss: 0.1166128 Test Loss: 0.1418357
Validation loss decreased (0.116755 --> 0.116613).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1000176
	speed: 0.1211s/iter; left time: 2564.6748s
	iters: 200, epoch: 6 | loss: 0.0948140
	speed: 0.0629s/iter; left time: 1325.1433s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.66s
Steps: 224 | Train Loss: 0.0984699 Vali Loss: 0.1163163 Test Loss: 0.1417426
Validation loss decreased (0.116613 --> 0.116316).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0972994
	speed: 0.1253s/iter; left time: 2626.4984s
	iters: 200, epoch: 7 | loss: 0.0936878
	speed: 0.0621s/iter; left time: 1295.2678s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:13.94s
Steps: 224 | Train Loss: 0.0972406 Vali Loss: 0.1165814 Test Loss: 0.1420426
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0935553
	speed: 0.1152s/iter; left time: 2388.6651s
	iters: 200, epoch: 8 | loss: 0.0962930
	speed: 0.0593s/iter; left time: 1223.8064s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:13.71s
Steps: 224 | Train Loss: 0.0962139 Vali Loss: 0.1169551 Test Loss: 0.1428138
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0923287
	speed: 0.1271s/iter; left time: 2605.7781s
	iters: 200, epoch: 9 | loss: 0.0975701
	speed: 0.0617s/iter; left time: 1259.4792s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0952119 Vali Loss: 0.1167024 Test Loss: 0.1424034
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0950940
	speed: 0.1159s/iter; left time: 2351.4774s
	iters: 200, epoch: 10 | loss: 0.0920952
	speed: 0.0621s/iter; left time: 1253.1777s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.04s
Steps: 224 | Train Loss: 0.0942552 Vali Loss: 0.1169274 Test Loss: 0.1425461
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0946459
	speed: 0.1159s/iter; left time: 2324.9014s
	iters: 200, epoch: 11 | loss: 0.0923537
	speed: 0.0617s/iter; left time: 1230.9541s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.37s
Steps: 224 | Train Loss: 0.0934874 Vali Loss: 0.1180461 Test Loss: 0.1432987
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0927330
	speed: 0.1171s/iter; left time: 2322.3413s
	iters: 200, epoch: 12 | loss: 0.0926669
	speed: 0.0603s/iter; left time: 1189.5500s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.08s
Steps: 224 | Train Loss: 0.0927273 Vali Loss: 0.1177090 Test Loss: 0.1433754
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0888391
	speed: 0.1198s/iter; left time: 2349.1330s
	iters: 200, epoch: 13 | loss: 0.0915669
	speed: 0.0620s/iter; left time: 1209.4511s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.60s
Steps: 224 | Train Loss: 0.0920820 Vali Loss: 0.1174937 Test Loss: 0.1429974
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0890915
	speed: 0.1174s/iter; left time: 2276.3188s
	iters: 200, epoch: 14 | loss: 0.0909410
	speed: 0.0654s/iter; left time: 1261.0575s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.42s
Steps: 224 | Train Loss: 0.0915154 Vali Loss: 0.1185164 Test Loss: 0.1435190
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0897911
	speed: 0.1260s/iter; left time: 2414.0831s
	iters: 200, epoch: 15 | loss: 0.0919447
	speed: 0.0621s/iter; left time: 1183.5365s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.18s
Steps: 224 | Train Loss: 0.0909746 Vali Loss: 0.1183434 Test Loss: 0.1438548
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0908882
	speed: 0.1226s/iter; left time: 2322.4420s
	iters: 200, epoch: 16 | loss: 0.0895689
	speed: 0.0648s/iter; left time: 1221.5282s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.67s
Steps: 224 | Train Loss: 0.0904027 Vali Loss: 0.1184962 Test Loss: 0.1438918
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_96_GB_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04310917481780052, rmse:0.20762749016284943, mae:0.14174264669418335, rse:0.7180048227310181
Intermediate time for GB and pred_len 96: 00h:10m:06.01s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_336_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1386354
	speed: 0.0880s/iter; left time: 1954.5939s
	iters: 200, epoch: 1 | loss: 0.1395205
	speed: 0.0622s/iter; left time: 1374.6064s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:14.27s
Steps: 223 | Train Loss: 0.1463431 Vali Loss: 0.1503382 Test Loss: 0.1766342
Validation loss decreased (inf --> 0.150338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1167225
	speed: 0.1238s/iter; left time: 2720.3149s
	iters: 200, epoch: 2 | loss: 0.1144232
	speed: 0.0615s/iter; left time: 1346.0305s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:14.09s
Steps: 223 | Train Loss: 0.1172889 Vali Loss: 0.1233330 Test Loss: 0.1472234
Validation loss decreased (0.150338 --> 0.123333).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1107266
	speed: 0.1324s/iter; left time: 2879.8867s
	iters: 200, epoch: 3 | loss: 0.1062191
	speed: 0.0599s/iter; left time: 1297.4117s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:13.87s
Steps: 223 | Train Loss: 0.1077707 Vali Loss: 0.1215602 Test Loss: 0.1480374
Validation loss decreased (0.123333 --> 0.121560).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1096353
	speed: 0.1180s/iter; left time: 2541.3469s
	iters: 200, epoch: 4 | loss: 0.1031461
	speed: 0.0618s/iter; left time: 1325.3404s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:13.89s
Steps: 223 | Train Loss: 0.1054061 Vali Loss: 0.1210068 Test Loss: 0.1477708
Validation loss decreased (0.121560 --> 0.121007).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1060579
	speed: 0.1300s/iter; left time: 2769.6155s
	iters: 200, epoch: 5 | loss: 0.1032196
	speed: 0.0641s/iter; left time: 1359.9416s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.31s
Steps: 223 | Train Loss: 0.1034220 Vali Loss: 0.1211447 Test Loss: 0.1495119
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1040526
	speed: 0.1126s/iter; left time: 2374.3334s
	iters: 200, epoch: 6 | loss: 0.0999122
	speed: 0.0626s/iter; left time: 1312.8993s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:14.21s
Steps: 223 | Train Loss: 0.1017199 Vali Loss: 0.1208167 Test Loss: 0.1491451
Validation loss decreased (0.121007 --> 0.120817).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0974309
	speed: 0.2539s/iter; left time: 5296.3882s
	iters: 200, epoch: 7 | loss: 0.0973077
	speed: 0.0620s/iter; left time: 1286.9183s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.83s
Steps: 223 | Train Loss: 0.1002500 Vali Loss: 0.1214452 Test Loss: 0.1506692
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0991654
	speed: 0.1158s/iter; left time: 2389.4106s
	iters: 200, epoch: 8 | loss: 0.0999737
	speed: 0.0621s/iter; left time: 1275.1946s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:14.03s
Steps: 223 | Train Loss: 0.0989331 Vali Loss: 0.1217749 Test Loss: 0.1506914
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0970173
	speed: 0.1168s/iter; left time: 2385.1666s
	iters: 200, epoch: 9 | loss: 0.0956019
	speed: 0.0610s/iter; left time: 1238.4166s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:13.90s
Steps: 223 | Train Loss: 0.0976805 Vali Loss: 0.1223509 Test Loss: 0.1528988
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0916557
	speed: 0.1208s/iter; left time: 2440.1846s
	iters: 200, epoch: 10 | loss: 0.0955586
	speed: 0.0649s/iter; left time: 1305.0543s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:14.73s
Steps: 223 | Train Loss: 0.0966453 Vali Loss: 0.1220048 Test Loss: 0.1516780
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0931706
	speed: 0.1219s/iter; left time: 2435.2728s
	iters: 200, epoch: 11 | loss: 0.0948939
	speed: 0.0654s/iter; left time: 1299.9505s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.82s
Steps: 223 | Train Loss: 0.0956451 Vali Loss: 0.1224576 Test Loss: 0.1529393
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0946385
	speed: 0.1221s/iter; left time: 2410.7887s
	iters: 200, epoch: 12 | loss: 0.0961585
	speed: 0.0651s/iter; left time: 1279.2240s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:14.58s
Steps: 223 | Train Loss: 0.0948170 Vali Loss: 0.1230200 Test Loss: 0.1536463
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0947491
	speed: 0.1241s/iter; left time: 2423.2855s
	iters: 200, epoch: 13 | loss: 0.0919266
	speed: 0.0669s/iter; left time: 1298.6261s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.73s
Steps: 223 | Train Loss: 0.0940334 Vali Loss: 0.1228369 Test Loss: 0.1537511
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0905955
	speed: 0.1192s/iter; left time: 2300.1595s
	iters: 200, epoch: 14 | loss: 0.0925452
	speed: 0.0628s/iter; left time: 1206.4564s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.19s
Steps: 223 | Train Loss: 0.0933891 Vali Loss: 0.1232879 Test Loss: 0.1543309
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0899824
	speed: 0.1203s/iter; left time: 2295.9351s
	iters: 200, epoch: 15 | loss: 0.0903571
	speed: 0.0671s/iter; left time: 1272.9507s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:15.05s
Steps: 223 | Train Loss: 0.0927193 Vali Loss: 0.1231269 Test Loss: 0.1540274
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0921509
	speed: 0.1258s/iter; left time: 2372.2649s
	iters: 200, epoch: 16 | loss: 0.0940645
	speed: 0.0643s/iter; left time: 1206.9445s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:14.61s
Steps: 223 | Train Loss: 0.0921280 Vali Loss: 0.1235844 Test Loss: 0.1547213
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04644313454627991, rmse:0.2155066877603531, mae:0.14914505183696747, rse:0.7471926212310791
Use GPU: cuda:0
>>>>>>>start training : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1437372
	speed: 0.0673s/iter; left time: 1493.9628s
	iters: 200, epoch: 1 | loss: 0.1413468
	speed: 0.0677s/iter; left time: 1496.8269s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:15.07s
Steps: 223 | Train Loss: 0.1469574 Vali Loss: 0.1503597 Test Loss: 0.1767833
Validation loss decreased (inf --> 0.150360).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1121952
	speed: 0.1252s/iter; left time: 2752.2562s
	iters: 200, epoch: 2 | loss: 0.1107133
	speed: 0.0656s/iter; left time: 1435.0905s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:15.07s
Steps: 223 | Train Loss: 0.1172488 Vali Loss: 0.1230871 Test Loss: 0.1470359
Validation loss decreased (0.150360 --> 0.123087).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1074790
	speed: 0.1303s/iter; left time: 2835.3943s
	iters: 200, epoch: 3 | loss: 0.1082936
	speed: 0.0663s/iter; left time: 1436.2480s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:15.02s
Steps: 223 | Train Loss: 0.1079106 Vali Loss: 0.1219156 Test Loss: 0.1472393
Validation loss decreased (0.123087 --> 0.121916).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1024566
	speed: 0.1436s/iter; left time: 3091.1476s
	iters: 200, epoch: 4 | loss: 0.1093854
	speed: 0.0644s/iter; left time: 1379.7064s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:15.22s
Steps: 223 | Train Loss: 0.1056144 Vali Loss: 0.1214643 Test Loss: 0.1478963
Validation loss decreased (0.121916 --> 0.121464).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1043837
	speed: 0.1290s/iter; left time: 2749.3949s
	iters: 200, epoch: 5 | loss: 0.1008662
	speed: 0.0652s/iter; left time: 1383.2057s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:14.61s
Steps: 223 | Train Loss: 0.1037652 Vali Loss: 0.1209340 Test Loss: 0.1483610
Validation loss decreased (0.121464 --> 0.120934).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1018177
	speed: 0.1411s/iter; left time: 2974.7250s
	iters: 200, epoch: 6 | loss: 0.1021051
	speed: 0.0659s/iter; left time: 1382.5867s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:15.15s
Steps: 223 | Train Loss: 0.1021854 Vali Loss: 0.1211857 Test Loss: 0.1487773
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1033683
	speed: 0.1272s/iter; left time: 2654.0381s
	iters: 200, epoch: 7 | loss: 0.1002985
	speed: 0.0643s/iter; left time: 1335.6376s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:14.49s
Steps: 223 | Train Loss: 0.1008956 Vali Loss: 0.1210550 Test Loss: 0.1488046
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1034819
	speed: 0.1314s/iter; left time: 2712.5176s
	iters: 200, epoch: 8 | loss: 0.0974347
	speed: 0.0658s/iter; left time: 1351.3618s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:15.33s
Steps: 223 | Train Loss: 0.0997048 Vali Loss: 0.1213903 Test Loss: 0.1492843
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0996106
	speed: 0.1230s/iter; left time: 2512.2240s
	iters: 200, epoch: 9 | loss: 0.1009926
	speed: 0.0628s/iter; left time: 1275.8184s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:14.70s
Steps: 223 | Train Loss: 0.0987894 Vali Loss: 0.1212850 Test Loss: 0.1499267
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0979183
	speed: 0.1241s/iter; left time: 2507.0290s
	iters: 200, epoch: 10 | loss: 0.0985871
	speed: 0.0715s/iter; left time: 1436.7471s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:15.11s
Steps: 223 | Train Loss: 0.0978428 Vali Loss: 0.1210372 Test Loss: 0.1496313
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0980109
	speed: 0.1308s/iter; left time: 2613.0649s
	iters: 200, epoch: 11 | loss: 0.0930352
	speed: 0.0656s/iter; left time: 1303.9303s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:14.89s
Steps: 223 | Train Loss: 0.0970727 Vali Loss: 0.1218514 Test Loss: 0.1515267
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0990410
	speed: 0.1305s/iter; left time: 2577.7301s
	iters: 200, epoch: 12 | loss: 0.0954193
	speed: 0.0647s/iter; left time: 1271.3441s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:15.13s
Steps: 223 | Train Loss: 0.0962643 Vali Loss: 0.1218991 Test Loss: 0.1503961
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0943987
	speed: 0.1291s/iter; left time: 2520.3068s
	iters: 200, epoch: 13 | loss: 0.0911834
	speed: 0.0662s/iter; left time: 1286.5144s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:14.64s
Steps: 223 | Train Loss: 0.0956385 Vali Loss: 0.1226010 Test Loss: 0.1523950
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0947586
	speed: 0.1243s/iter; left time: 2398.2863s
	iters: 200, epoch: 14 | loss: 0.0958324
	speed: 0.0632s/iter; left time: 1214.2662s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:14.69s
Steps: 223 | Train Loss: 0.0950461 Vali Loss: 0.1226071 Test Loss: 0.1518613
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0910238
	speed: 0.1231s/iter; left time: 2349.0728s
	iters: 200, epoch: 15 | loss: 0.0908302
	speed: 0.0648s/iter; left time: 1229.0392s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:14.49s
Steps: 223 | Train Loss: 0.0944825 Vali Loss: 0.1224583 Test Loss: 0.1519933
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_336_168_GB_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04599538445472717, rmse:0.21446534991264343, mae:0.14836086332798004, rse:0.7435821890830994
Intermediate time for GB and pred_len 168: 00h:10m:17.81sIntermediate time for GB: 00h:50m:57.80s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1526842
	speed: 0.0681s/iter; left time: 1518.4879s
	iters: 200, epoch: 1 | loss: 0.1366305
	speed: 0.0420s/iter; left time: 932.0445s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.22s
Steps: 224 | Train Loss: 0.1550454 Vali Loss: 0.1393994 Test Loss: 0.1681718
Validation loss decreased (inf --> 0.139399).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0732484
	speed: 0.0851s/iter; left time: 1879.1590s
	iters: 200, epoch: 2 | loss: 0.0723599
	speed: 0.0406s/iter; left time: 892.2791s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.40s
Steps: 224 | Train Loss: 0.0805116 Vali Loss: 0.0647224 Test Loss: 0.0717992
Validation loss decreased (0.139399 --> 0.064722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0670712
	speed: 0.0849s/iter; left time: 1854.6991s
	iters: 200, epoch: 3 | loss: 0.0631713
	speed: 0.0443s/iter; left time: 964.6185s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.29s
Steps: 224 | Train Loss: 0.0640164 Vali Loss: 0.0604511 Test Loss: 0.0675387
Validation loss decreased (0.064722 --> 0.060451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615953
	speed: 0.0781s/iter; left time: 1690.2095s
	iters: 200, epoch: 4 | loss: 0.0594863
	speed: 0.0435s/iter; left time: 935.9823s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0607313 Vali Loss: 0.0585351 Test Loss: 0.0652289
Validation loss decreased (0.060451 --> 0.058535).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582284
	speed: 0.0858s/iter; left time: 1836.2986s
	iters: 200, epoch: 5 | loss: 0.0548869
	speed: 0.0421s/iter; left time: 896.7199s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.71s
Steps: 224 | Train Loss: 0.0586365 Vali Loss: 0.0571023 Test Loss: 0.0640453
Validation loss decreased (0.058535 --> 0.057102).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0568549
	speed: 0.0847s/iter; left time: 1793.2508s
	iters: 200, epoch: 6 | loss: 0.0545233
	speed: 0.0405s/iter; left time: 853.2172s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.73s
Steps: 224 | Train Loss: 0.0572533 Vali Loss: 0.0562853 Test Loss: 0.0630265
Validation loss decreased (0.057102 --> 0.056285).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0588305
	speed: 0.0827s/iter; left time: 1733.9496s
	iters: 200, epoch: 7 | loss: 0.0523065
	speed: 0.0436s/iter; left time: 909.5397s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.90s
Steps: 224 | Train Loss: 0.0561701 Vali Loss: 0.0557691 Test Loss: 0.0625740
Validation loss decreased (0.056285 --> 0.055769).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0549896
	speed: 0.0830s/iter; left time: 1720.4482s
	iters: 200, epoch: 8 | loss: 0.0590127
	speed: 0.0445s/iter; left time: 918.4676s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.17s
Steps: 224 | Train Loss: 0.0555243 Vali Loss: 0.0552860 Test Loss: 0.0622382
Validation loss decreased (0.055769 --> 0.055286).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0538663
	speed: 0.0826s/iter; left time: 1693.3977s
	iters: 200, epoch: 9 | loss: 0.0581174
	speed: 0.0429s/iter; left time: 875.4240s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0549856 Vali Loss: 0.0547778 Test Loss: 0.0615789
Validation loss decreased (0.055286 --> 0.054778).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0544842
	speed: 0.0819s/iter; left time: 1662.3420s
	iters: 200, epoch: 10 | loss: 0.0509822
	speed: 0.0405s/iter; left time: 817.1400s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.41s
Steps: 224 | Train Loss: 0.0545583 Vali Loss: 0.0547986 Test Loss: 0.0614929
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0541769
	speed: 0.0797s/iter; left time: 1597.8702s
	iters: 200, epoch: 11 | loss: 0.0549371
	speed: 0.0467s/iter; left time: 932.7180s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.06s
Steps: 224 | Train Loss: 0.0541390 Vali Loss: 0.0542580 Test Loss: 0.0609762
Validation loss decreased (0.054778 --> 0.054258).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0538365
	speed: 0.0842s/iter; left time: 1670.9352s
	iters: 200, epoch: 12 | loss: 0.0529875
	speed: 0.0420s/iter; left time: 829.1106s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.70s
Steps: 224 | Train Loss: 0.0538779 Vali Loss: 0.0541497 Test Loss: 0.0608541
Validation loss decreased (0.054258 --> 0.054150).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0556539
	speed: 0.0810s/iter; left time: 1588.2831s
	iters: 200, epoch: 13 | loss: 0.0526646
	speed: 0.0424s/iter; left time: 827.6131s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.70s
Steps: 224 | Train Loss: 0.0536023 Vali Loss: 0.0540321 Test Loss: 0.0606161
Validation loss decreased (0.054150 --> 0.054032).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0543625
	speed: 0.0915s/iter; left time: 1774.7627s
	iters: 200, epoch: 14 | loss: 0.0530023
	speed: 0.0417s/iter; left time: 804.2679s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0533630 Vali Loss: 0.0541184 Test Loss: 0.0608187
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0521512
	speed: 0.0854s/iter; left time: 1635.8629s
	iters: 200, epoch: 15 | loss: 0.0521281
	speed: 0.0435s/iter; left time: 828.4169s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.29s
Steps: 224 | Train Loss: 0.0531000 Vali Loss: 0.0539720 Test Loss: 0.0605283
Validation loss decreased (0.054032 --> 0.053972).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0509178
	speed: 0.0848s/iter; left time: 1606.6008s
	iters: 200, epoch: 16 | loss: 0.0512274
	speed: 0.0407s/iter; left time: 767.7655s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0529989 Vali Loss: 0.0536041 Test Loss: 0.0602776
Validation loss decreased (0.053972 --> 0.053604).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0513468
	speed: 0.0831s/iter; left time: 1555.7148s
	iters: 200, epoch: 17 | loss: 0.0483066
	speed: 0.0442s/iter; left time: 823.7338s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.22s
Steps: 224 | Train Loss: 0.0528339 Vali Loss: 0.0536399 Test Loss: 0.0601474
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0508105
	speed: 0.0831s/iter; left time: 1536.0928s
	iters: 200, epoch: 18 | loss: 0.0472548
	speed: 0.0416s/iter; left time: 764.9147s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0526830 Vali Loss: 0.0535131 Test Loss: 0.0600573
Validation loss decreased (0.053604 --> 0.053513).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0543427
	speed: 0.0817s/iter; left time: 1493.4324s
	iters: 200, epoch: 19 | loss: 0.0539975
	speed: 0.0411s/iter; left time: 747.2832s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0526239 Vali Loss: 0.0534467 Test Loss: 0.0600467
Validation loss decreased (0.053513 --> 0.053447).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0512956
	speed: 0.0878s/iter; left time: 1585.2084s
	iters: 200, epoch: 20 | loss: 0.0518979
	speed: 0.0417s/iter; left time: 748.0036s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.89s
Steps: 224 | Train Loss: 0.0524580 Vali Loss: 0.0534504 Test Loss: 0.0601290
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0516894
	speed: 0.0837s/iter; left time: 1491.1235s
	iters: 200, epoch: 21 | loss: 0.0514001
	speed: 0.0381s/iter; left time: 675.8246s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.35s
Steps: 224 | Train Loss: 0.0523597 Vali Loss: 0.0533231 Test Loss: 0.0599976
Validation loss decreased (0.053447 --> 0.053323).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0483420
	speed: 0.0778s/iter; left time: 1368.3083s
	iters: 200, epoch: 22 | loss: 0.0524221
	speed: 0.0422s/iter; left time: 738.8334s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.69s
Steps: 224 | Train Loss: 0.0522725 Vali Loss: 0.0532108 Test Loss: 0.0598633
Validation loss decreased (0.053323 --> 0.053211).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0503389
	speed: 0.0824s/iter; left time: 1432.3379s
	iters: 200, epoch: 23 | loss: 0.0539414
	speed: 0.0392s/iter; left time: 676.5949s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.22s
Steps: 224 | Train Loss: 0.0522263 Vali Loss: 0.0532671 Test Loss: 0.0599022
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0542046
	speed: 0.0819s/iter; left time: 1404.7074s
	iters: 200, epoch: 24 | loss: 0.0510984
	speed: 0.0481s/iter; left time: 819.9433s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.62s
Steps: 224 | Train Loss: 0.0521891 Vali Loss: 0.0531939 Test Loss: 0.0597542
Validation loss decreased (0.053211 --> 0.053194).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0514270
	speed: 0.0842s/iter; left time: 1425.6329s
	iters: 200, epoch: 25 | loss: 0.0550747
	speed: 0.0415s/iter; left time: 698.4389s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.95s
Steps: 224 | Train Loss: 0.0520553 Vali Loss: 0.0530766 Test Loss: 0.0597279
Validation loss decreased (0.053194 --> 0.053077).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0486141
	speed: 0.0884s/iter; left time: 1476.3846s
	iters: 200, epoch: 26 | loss: 0.0538085
	speed: 0.0405s/iter; left time: 671.6769s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.39s
Steps: 224 | Train Loss: 0.0519923 Vali Loss: 0.0531875 Test Loss: 0.0597662
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0524277
	speed: 0.0848s/iter; left time: 1397.6267s
	iters: 200, epoch: 27 | loss: 0.0521245
	speed: 0.0506s/iter; left time: 828.5849s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.59s
Steps: 224 | Train Loss: 0.0520323 Vali Loss: 0.0530715 Test Loss: 0.0596598
Validation loss decreased (0.053077 --> 0.053071).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0528489
	speed: 0.0850s/iter; left time: 1380.9317s
	iters: 200, epoch: 28 | loss: 0.0528272
	speed: 0.0409s/iter; left time: 660.1304s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0519045 Vali Loss: 0.0530310 Test Loss: 0.0596944
Validation loss decreased (0.053071 --> 0.053031).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0494530
	speed: 0.0845s/iter; left time: 1354.6052s
	iters: 200, epoch: 29 | loss: 0.0549773
	speed: 0.0410s/iter; left time: 652.7166s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.44s
Steps: 224 | Train Loss: 0.0518919 Vali Loss: 0.0531214 Test Loss: 0.0597658
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0509516
	speed: 0.0798s/iter; left time: 1260.9276s
	iters: 200, epoch: 30 | loss: 0.0541899
	speed: 0.0447s/iter; left time: 701.3109s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0518665 Vali Loss: 0.0530275 Test Loss: 0.0596586
Validation loss decreased (0.053031 --> 0.053028).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0517120
	speed: 0.0885s/iter; left time: 1378.5857s
	iters: 200, epoch: 31 | loss: 0.0504429
	speed: 0.0408s/iter; left time: 631.8840s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.42s
Steps: 224 | Train Loss: 0.0518409 Vali Loss: 0.0530472 Test Loss: 0.0595775
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0496667
	speed: 0.0892s/iter; left time: 1369.1160s
	iters: 200, epoch: 32 | loss: 0.0514431
	speed: 0.0418s/iter; left time: 637.7443s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0518175 Vali Loss: 0.0530794 Test Loss: 0.0596468
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0489944
	speed: 0.0878s/iter; left time: 1328.4504s
	iters: 200, epoch: 33 | loss: 0.0532939
	speed: 0.0358s/iter; left time: 538.8636s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.07s
Steps: 224 | Train Loss: 0.0517973 Vali Loss: 0.0530503 Test Loss: 0.0596521
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0528417
	speed: 0.0792s/iter; left time: 1180.3704s
	iters: 200, epoch: 34 | loss: 0.0519611
	speed: 0.0347s/iter; left time: 514.2950s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.18s
Steps: 224 | Train Loss: 0.0517021 Vali Loss: 0.0530652 Test Loss: 0.0594816
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0530752
	speed: 0.0673s/iter; left time: 988.2457s
	iters: 200, epoch: 35 | loss: 0.0518166
	speed: 0.0405s/iter; left time: 591.1199s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.00s
Steps: 224 | Train Loss: 0.0517347 Vali Loss: 0.0528620 Test Loss: 0.0595123
Validation loss decreased (0.053028 --> 0.052862).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0506464
	speed: 0.0825s/iter; left time: 1192.5993s
	iters: 200, epoch: 36 | loss: 0.0517927
	speed: 0.0448s/iter; left time: 642.9858s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.90s
Steps: 224 | Train Loss: 0.0516731 Vali Loss: 0.0529967 Test Loss: 0.0596204
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0519233
	speed: 0.0816s/iter; left time: 1161.9877s
	iters: 200, epoch: 37 | loss: 0.0506047
	speed: 0.0415s/iter; left time: 586.6041s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0516810 Vali Loss: 0.0530068 Test Loss: 0.0595802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0507490
	speed: 0.0815s/iter; left time: 1142.5379s
	iters: 200, epoch: 38 | loss: 0.0562936
	speed: 0.0411s/iter; left time: 571.5725s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.85s
Steps: 224 | Train Loss: 0.0516737 Vali Loss: 0.0529319 Test Loss: 0.0594970
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0492359
	speed: 0.0808s/iter; left time: 1113.8060s
	iters: 200, epoch: 39 | loss: 0.0538159
	speed: 0.0367s/iter; left time: 502.3495s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.61s
Steps: 224 | Train Loss: 0.0516829 Vali Loss: 0.0529696 Test Loss: 0.0594831
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0513327
	speed: 0.0864s/iter; left time: 1172.4806s
	iters: 200, epoch: 40 | loss: 0.0514433
	speed: 0.0433s/iter; left time: 583.6175s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0516562 Vali Loss: 0.0530150 Test Loss: 0.0596243
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0518598
	speed: 0.0883s/iter; left time: 1178.2670s
	iters: 200, epoch: 41 | loss: 0.0497989
	speed: 0.0446s/iter; left time: 590.7311s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:10.33s
Steps: 224 | Train Loss: 0.0516688 Vali Loss: 0.0528681 Test Loss: 0.0594650
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0497980
	speed: 0.0918s/iter; left time: 1203.6731s
	iters: 200, epoch: 42 | loss: 0.0535568
	speed: 0.0408s/iter; left time: 530.6514s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.81s
Steps: 224 | Train Loss: 0.0516297 Vali Loss: 0.0529409 Test Loss: 0.0594555
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0522472
	speed: 0.0834s/iter; left time: 1075.0919s
	iters: 200, epoch: 43 | loss: 0.0489027
	speed: 0.0410s/iter; left time: 524.6396s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0516606 Vali Loss: 0.0529695 Test Loss: 0.0595177
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0520200
	speed: 0.0826s/iter; left time: 1047.0329s
	iters: 200, epoch: 44 | loss: 0.0508248
	speed: 0.0396s/iter; left time: 497.4344s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.46s
Steps: 224 | Train Loss: 0.0515849 Vali Loss: 0.0529528 Test Loss: 0.0595244
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0524924
	speed: 0.0930s/iter; left time: 1157.2754s
	iters: 200, epoch: 45 | loss: 0.0509926
	speed: 0.0432s/iter; left time: 533.8607s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0515887 Vali Loss: 0.0530027 Test Loss: 0.0595490
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009823016822338104, rmse:0.09911113232374191, mae:0.05951228737831116, rse:0.2916720509529114
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1579360
	speed: 0.0444s/iter; left time: 990.6785s
	iters: 200, epoch: 1 | loss: 0.1345574
	speed: 0.0430s/iter; left time: 954.1261s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.1544287 Vali Loss: 0.1378902 Test Loss: 0.1664125
Validation loss decreased (inf --> 0.137890).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0723953
	speed: 0.0883s/iter; left time: 1949.5147s
	iters: 200, epoch: 2 | loss: 0.0673680
	speed: 0.0446s/iter; left time: 980.1433s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0807752 Vali Loss: 0.0640944 Test Loss: 0.0714371
Validation loss decreased (0.137890 --> 0.064094).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0664814
	speed: 0.0860s/iter; left time: 1880.0046s
	iters: 200, epoch: 3 | loss: 0.0602823
	speed: 0.0450s/iter; left time: 979.1418s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.59s
Steps: 224 | Train Loss: 0.0644568 Vali Loss: 0.0613151 Test Loss: 0.0682127
Validation loss decreased (0.064094 --> 0.061315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0619137
	speed: 0.0819s/iter; left time: 1770.3818s
	iters: 200, epoch: 4 | loss: 0.0629501
	speed: 0.0432s/iter; left time: 931.0676s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.51s
Steps: 224 | Train Loss: 0.0613793 Vali Loss: 0.0588372 Test Loss: 0.0659621
Validation loss decreased (0.061315 --> 0.058837).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0599205
	speed: 0.0830s/iter; left time: 1777.0601s
	iters: 200, epoch: 5 | loss: 0.0566143
	speed: 0.0407s/iter; left time: 866.5265s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.63s
Steps: 224 | Train Loss: 0.0592500 Vali Loss: 0.0577281 Test Loss: 0.0648115
Validation loss decreased (0.058837 --> 0.057728).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0587412
	speed: 0.0864s/iter; left time: 1830.7289s
	iters: 200, epoch: 6 | loss: 0.0555555
	speed: 0.0451s/iter; left time: 951.0571s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.51s
Steps: 224 | Train Loss: 0.0577187 Vali Loss: 0.0565377 Test Loss: 0.0634899
Validation loss decreased (0.057728 --> 0.056538).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0582398
	speed: 0.0837s/iter; left time: 1753.2665s
	iters: 200, epoch: 7 | loss: 0.0569732
	speed: 0.0422s/iter; left time: 879.2017s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.88s
Steps: 224 | Train Loss: 0.0565804 Vali Loss: 0.0560253 Test Loss: 0.0630894
Validation loss decreased (0.056538 --> 0.056025).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0576674
	speed: 0.0909s/iter; left time: 1883.8288s
	iters: 200, epoch: 8 | loss: 0.0565004
	speed: 0.0446s/iter; left time: 921.0757s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.32s
Steps: 224 | Train Loss: 0.0557787 Vali Loss: 0.0554661 Test Loss: 0.0624663
Validation loss decreased (0.056025 --> 0.055466).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0545671
	speed: 0.0857s/iter; left time: 1758.3944s
	iters: 200, epoch: 9 | loss: 0.0577309
	speed: 0.0401s/iter; left time: 818.3560s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0551741 Vali Loss: 0.0550627 Test Loss: 0.0620055
Validation loss decreased (0.055466 --> 0.055063).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0536375
	speed: 0.0934s/iter; left time: 1894.3084s
	iters: 200, epoch: 10 | loss: 0.0555455
	speed: 0.0419s/iter; left time: 845.0102s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.90s
Steps: 224 | Train Loss: 0.0547537 Vali Loss: 0.0550868 Test Loss: 0.0618774
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0518436
	speed: 0.0824s/iter; left time: 1652.8163s
	iters: 200, epoch: 11 | loss: 0.0547084
	speed: 0.0402s/iter; left time: 803.2530s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0543565 Vali Loss: 0.0546177 Test Loss: 0.0611843
Validation loss decreased (0.055063 --> 0.054618).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0567422
	speed: 0.0819s/iter; left time: 1624.4642s
	iters: 200, epoch: 12 | loss: 0.0523581
	speed: 0.0406s/iter; left time: 801.3395s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0540275 Vali Loss: 0.0544829 Test Loss: 0.0609822
Validation loss decreased (0.054618 --> 0.054483).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0552673
	speed: 0.0934s/iter; left time: 1832.0096s
	iters: 200, epoch: 13 | loss: 0.0510562
	speed: 0.0427s/iter; left time: 833.2123s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.00s
Steps: 224 | Train Loss: 0.0537494 Vali Loss: 0.0542448 Test Loss: 0.0610533
Validation loss decreased (0.054483 --> 0.054245).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0562548
	speed: 0.0845s/iter; left time: 1637.9687s
	iters: 200, epoch: 14 | loss: 0.0558280
	speed: 0.0453s/iter; left time: 873.9444s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.16s
Steps: 224 | Train Loss: 0.0534659 Vali Loss: 0.0541800 Test Loss: 0.0609532
Validation loss decreased (0.054245 --> 0.054180).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0524575
	speed: 0.0852s/iter; left time: 1632.8022s
	iters: 200, epoch: 15 | loss: 0.0552186
	speed: 0.0449s/iter; left time: 855.7383s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.18s
Steps: 224 | Train Loss: 0.0533038 Vali Loss: 0.0540752 Test Loss: 0.0606174
Validation loss decreased (0.054180 --> 0.054075).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0530639
	speed: 0.0843s/iter; left time: 1596.5949s
	iters: 200, epoch: 16 | loss: 0.0518307
	speed: 0.0441s/iter; left time: 831.6998s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.46s
Steps: 224 | Train Loss: 0.0531068 Vali Loss: 0.0539237 Test Loss: 0.0606197
Validation loss decreased (0.054075 --> 0.053924).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0549129
	speed: 0.0886s/iter; left time: 1659.2402s
	iters: 200, epoch: 17 | loss: 0.0486911
	speed: 0.0400s/iter; left time: 744.4586s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.76s
Steps: 224 | Train Loss: 0.0529943 Vali Loss: 0.0538352 Test Loss: 0.0604584
Validation loss decreased (0.053924 --> 0.053835).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0533815
	speed: 0.0850s/iter; left time: 1572.3390s
	iters: 200, epoch: 18 | loss: 0.0563068
	speed: 0.0398s/iter; left time: 732.7079s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.28s
Steps: 224 | Train Loss: 0.0528632 Vali Loss: 0.0536740 Test Loss: 0.0603638
Validation loss decreased (0.053835 --> 0.053674).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0529857
	speed: 0.0795s/iter; left time: 1452.3419s
	iters: 200, epoch: 19 | loss: 0.0518051
	speed: 0.0486s/iter; left time: 883.8542s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.23s
Steps: 224 | Train Loss: 0.0526865 Vali Loss: 0.0534223 Test Loss: 0.0601238
Validation loss decreased (0.053674 --> 0.053422).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0509609
	speed: 0.0830s/iter; left time: 1497.1041s
	iters: 200, epoch: 20 | loss: 0.0505578
	speed: 0.0406s/iter; left time: 728.8171s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.43s
Steps: 224 | Train Loss: 0.0526346 Vali Loss: 0.0535342 Test Loss: 0.0601085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0515755
	speed: 0.0888s/iter; left time: 1583.2278s
	iters: 200, epoch: 21 | loss: 0.0507104
	speed: 0.0417s/iter; left time: 738.2416s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0525259 Vali Loss: 0.0534651 Test Loss: 0.0600710
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0511437
	speed: 0.0794s/iter; left time: 1397.9087s
	iters: 200, epoch: 22 | loss: 0.0498561
	speed: 0.0432s/iter; left time: 755.9867s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.84s
Steps: 224 | Train Loss: 0.0524205 Vali Loss: 0.0534762 Test Loss: 0.0601843
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0535026
	speed: 0.0890s/iter; left time: 1546.8646s
	iters: 200, epoch: 23 | loss: 0.0500406
	speed: 0.0405s/iter; left time: 700.3767s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.61s
Steps: 224 | Train Loss: 0.0523597 Vali Loss: 0.0534131 Test Loss: 0.0600998
Validation loss decreased (0.053422 --> 0.053413).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0492497
	speed: 0.0785s/iter; left time: 1347.0030s
	iters: 200, epoch: 24 | loss: 0.0506229
	speed: 0.0436s/iter; left time: 744.1614s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0522823 Vali Loss: 0.0532963 Test Loss: 0.0599198
Validation loss decreased (0.053413 --> 0.053296).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0521318
	speed: 0.0809s/iter; left time: 1369.7682s
	iters: 200, epoch: 25 | loss: 0.0511510
	speed: 0.0442s/iter; left time: 743.6639s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.74s
Steps: 224 | Train Loss: 0.0522033 Vali Loss: 0.0533299 Test Loss: 0.0599659
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0504086
	speed: 0.0829s/iter; left time: 1384.3899s
	iters: 200, epoch: 26 | loss: 0.0505698
	speed: 0.0412s/iter; left time: 684.0452s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0521587 Vali Loss: 0.0533623 Test Loss: 0.0599633
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0529970
	speed: 0.0831s/iter; left time: 1369.8767s
	iters: 200, epoch: 27 | loss: 0.0493081
	speed: 0.0436s/iter; left time: 714.5892s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0521429 Vali Loss: 0.0534271 Test Loss: 0.0600620
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0561010
	speed: 0.0825s/iter; left time: 1340.0657s
	iters: 200, epoch: 28 | loss: 0.0526673
	speed: 0.0401s/iter; left time: 647.1800s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.27s
Steps: 224 | Train Loss: 0.0520879 Vali Loss: 0.0532309 Test Loss: 0.0596975
Validation loss decreased (0.053296 --> 0.053231).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0538653
	speed: 0.0842s/iter; left time: 1349.4212s
	iters: 200, epoch: 29 | loss: 0.0507462
	speed: 0.0468s/iter; left time: 745.4107s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.14s
Steps: 224 | Train Loss: 0.0520182 Vali Loss: 0.0532914 Test Loss: 0.0598624
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0564779
	speed: 0.0806s/iter; left time: 1274.6242s
	iters: 200, epoch: 30 | loss: 0.0513206
	speed: 0.0418s/iter; left time: 655.8018s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0519411 Vali Loss: 0.0531523 Test Loss: 0.0597022
Validation loss decreased (0.053231 --> 0.053152).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0504823
	speed: 0.0817s/iter; left time: 1272.3396s
	iters: 200, epoch: 31 | loss: 0.0540285
	speed: 0.0415s/iter; left time: 642.5807s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:09.51s
Steps: 224 | Train Loss: 0.0519207 Vali Loss: 0.0531699 Test Loss: 0.0596743
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0498894
	speed: 0.0875s/iter; left time: 1343.2484s
	iters: 200, epoch: 32 | loss: 0.0540251
	speed: 0.0425s/iter; left time: 648.0445s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:10.24s
Steps: 224 | Train Loss: 0.0519015 Vali Loss: 0.0531963 Test Loss: 0.0597262
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0543305
	speed: 0.0823s/iter; left time: 1246.1795s
	iters: 200, epoch: 33 | loss: 0.0495824
	speed: 0.0404s/iter; left time: 607.6332s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.65s
Steps: 224 | Train Loss: 0.0518915 Vali Loss: 0.0531901 Test Loss: 0.0596950
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0508410
	speed: 0.0820s/iter; left time: 1222.6111s
	iters: 200, epoch: 34 | loss: 0.0491989
	speed: 0.0406s/iter; left time: 600.9594s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:09.42s
Steps: 224 | Train Loss: 0.0518669 Vali Loss: 0.0531966 Test Loss: 0.0597255
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0490082
	speed: 0.0797s/iter; left time: 1170.7997s
	iters: 200, epoch: 35 | loss: 0.0526008
	speed: 0.0495s/iter; left time: 722.4384s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:10.54s
Steps: 224 | Train Loss: 0.0518020 Vali Loss: 0.0531861 Test Loss: 0.0596925
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0554945
	speed: 0.0862s/iter; left time: 1247.0802s
	iters: 200, epoch: 36 | loss: 0.0519463
	speed: 0.0430s/iter; left time: 617.7702s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0518643 Vali Loss: 0.0531078 Test Loss: 0.0596932
Validation loss decreased (0.053152 --> 0.053108).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0496504
	speed: 0.0806s/iter; left time: 1147.5936s
	iters: 200, epoch: 37 | loss: 0.0498719
	speed: 0.0414s/iter; left time: 585.4804s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0518462 Vali Loss: 0.0531845 Test Loss: 0.0596469
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0510170
	speed: 0.0845s/iter; left time: 1184.7688s
	iters: 200, epoch: 38 | loss: 0.0542504
	speed: 0.0422s/iter; left time: 587.1840s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0518217 Vali Loss: 0.0531203 Test Loss: 0.0596973
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0488454
	speed: 0.0795s/iter; left time: 1096.8707s
	iters: 200, epoch: 39 | loss: 0.0506440
	speed: 0.0415s/iter; left time: 568.2084s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0517673 Vali Loss: 0.0530957 Test Loss: 0.0596440
Validation loss decreased (0.053108 --> 0.053096).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0500557
	speed: 0.0848s/iter; left time: 1150.5938s
	iters: 200, epoch: 40 | loss: 0.0513093
	speed: 0.0422s/iter; left time: 568.1823s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.0517291 Vali Loss: 0.0530914 Test Loss: 0.0595172
Validation loss decreased (0.053096 --> 0.053091).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0547261
	speed: 0.0810s/iter; left time: 1080.0076s
	iters: 200, epoch: 41 | loss: 0.0481549
	speed: 0.0424s/iter; left time: 561.0602s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0517457 Vali Loss: 0.0530916 Test Loss: 0.0596419
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0524280
	speed: 0.0806s/iter; left time: 1057.0548s
	iters: 200, epoch: 42 | loss: 0.0527511
	speed: 0.0408s/iter; left time: 530.7902s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0517541 Vali Loss: 0.0532012 Test Loss: 0.0597727
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0527208
	speed: 0.0780s/iter; left time: 1005.1934s
	iters: 200, epoch: 43 | loss: 0.0518980
	speed: 0.0401s/iter; left time: 512.8750s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0517267 Vali Loss: 0.0529711 Test Loss: 0.0595133
Validation loss decreased (0.053091 --> 0.052971).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0536714
	speed: 0.0845s/iter; left time: 1070.4162s
	iters: 200, epoch: 44 | loss: 0.0551635
	speed: 0.0455s/iter; left time: 571.5990s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:09.89s
Steps: 224 | Train Loss: 0.0517666 Vali Loss: 0.0530981 Test Loss: 0.0596632
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0518254
	speed: 0.0874s/iter; left time: 1087.7683s
	iters: 200, epoch: 45 | loss: 0.0512678
	speed: 0.0440s/iter; left time: 542.7042s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:10.12s
Steps: 224 | Train Loss: 0.0516751 Vali Loss: 0.0531732 Test Loss: 0.0596597
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0521856
	speed: 0.0824s/iter; left time: 1007.4416s
	iters: 200, epoch: 46 | loss: 0.0487361
	speed: 0.0415s/iter; left time: 503.2892s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0516208 Vali Loss: 0.0530561 Test Loss: 0.0595802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0530450
	speed: 0.0803s/iter; left time: 963.0454s
	iters: 200, epoch: 47 | loss: 0.0445639
	speed: 0.0447s/iter; left time: 531.6315s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:09.73s
Steps: 224 | Train Loss: 0.0516959 Vali Loss: 0.0531059 Test Loss: 0.0596224
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0539990
	speed: 0.0801s/iter; left time: 942.4670s
	iters: 200, epoch: 48 | loss: 0.0513229
	speed: 0.0412s/iter; left time: 481.1925s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0516967 Vali Loss: 0.0530909 Test Loss: 0.0596255
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0525027
	speed: 0.0794s/iter; left time: 917.0219s
	iters: 200, epoch: 49 | loss: 0.0530085
	speed: 0.0415s/iter; left time: 475.0324s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0516743 Vali Loss: 0.0531389 Test Loss: 0.0596946
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0477419
	speed: 0.0875s/iter; left time: 991.4611s
	iters: 200, epoch: 50 | loss: 0.0513889
	speed: 0.0468s/iter; left time: 524.8854s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:10.39s
Steps: 224 | Train Loss: 0.0516918 Vali Loss: 0.0530067 Test Loss: 0.0595521
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0530295
	speed: 0.0846s/iter; left time: 938.7186s
	iters: 200, epoch: 51 | loss: 0.0510417
	speed: 0.0416s/iter; left time: 457.9914s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:09.50s
Steps: 224 | Train Loss: 0.0516617 Vali Loss: 0.0531040 Test Loss: 0.0595510
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0517732
	speed: 0.0883s/iter; left time: 960.0125s
	iters: 200, epoch: 52 | loss: 0.0523332
	speed: 0.0393s/iter; left time: 423.4077s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:09.36s
Steps: 224 | Train Loss: 0.0517148 Vali Loss: 0.0530957 Test Loss: 0.0596316
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0531154
	speed: 0.0845s/iter; left time: 900.6116s
	iters: 200, epoch: 53 | loss: 0.0505686
	speed: 0.0470s/iter; left time: 496.3713s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:10.07s
Steps: 224 | Train Loss: 0.0516867 Vali Loss: 0.0530429 Test Loss: 0.0595754
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.00980827771127224, rmse:0.09903674572706223, mae:0.059513285756111145, rse:0.29145318269729614
Intermediate time for ES and pred_len 24: 00h:20m:51.02s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1583152
	speed: 0.0683s/iter; left time: 1522.9335s
	iters: 200, epoch: 1 | loss: 0.1448403
	speed: 0.0413s/iter; left time: 915.8240s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.93s
Steps: 224 | Train Loss: 0.1628648 Vali Loss: 0.1497765 Test Loss: 0.1801975
Validation loss decreased (inf --> 0.149776).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0921436
	speed: 0.0857s/iter; left time: 1891.3735s
	iters: 200, epoch: 2 | loss: 0.0816166
	speed: 0.0473s/iter; left time: 1039.6476s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.43s
Steps: 224 | Train Loss: 0.0972727 Vali Loss: 0.0838135 Test Loss: 0.0948474
Validation loss decreased (0.149776 --> 0.083813).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0829061
	speed: 0.1007s/iter; left time: 2200.1447s
	iters: 200, epoch: 3 | loss: 0.0841351
	speed: 0.0466s/iter; left time: 1012.9484s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.01s
Steps: 224 | Train Loss: 0.0835706 Vali Loss: 0.0805995 Test Loss: 0.0918064
Validation loss decreased (0.083813 --> 0.080599).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0807449
	speed: 0.0904s/iter; left time: 1954.3857s
	iters: 200, epoch: 4 | loss: 0.0770914
	speed: 0.0419s/iter; left time: 902.0986s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0804804 Vali Loss: 0.0785825 Test Loss: 0.0897993
Validation loss decreased (0.080599 --> 0.078583).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0813333
	speed: 0.0887s/iter; left time: 1897.6583s
	iters: 200, epoch: 5 | loss: 0.0801107
	speed: 0.0371s/iter; left time: 790.8496s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.46s
Steps: 224 | Train Loss: 0.0785711 Vali Loss: 0.0776296 Test Loss: 0.0890472
Validation loss decreased (0.078583 --> 0.077630).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0758659
	speed: 0.1026s/iter; left time: 2174.1821s
	iters: 200, epoch: 6 | loss: 0.0811755
	speed: 0.0454s/iter; left time: 956.6885s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.60s
Steps: 224 | Train Loss: 0.0773020 Vali Loss: 0.0770908 Test Loss: 0.0882573
Validation loss decreased (0.077630 --> 0.077091).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0749255
	speed: 0.0820s/iter; left time: 1717.9528s
	iters: 200, epoch: 7 | loss: 0.0767308
	speed: 0.0435s/iter; left time: 908.1220s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.17s
Steps: 224 | Train Loss: 0.0764460 Vali Loss: 0.0769096 Test Loss: 0.0878721
Validation loss decreased (0.077091 --> 0.076910).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0756682
	speed: 0.0891s/iter; left time: 1847.9944s
	iters: 200, epoch: 8 | loss: 0.0762002
	speed: 0.0400s/iter; left time: 824.3199s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.31s
Steps: 224 | Train Loss: 0.0758666 Vali Loss: 0.0765788 Test Loss: 0.0876366
Validation loss decreased (0.076910 --> 0.076579).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0734542
	speed: 0.0937s/iter; left time: 1920.8012s
	iters: 200, epoch: 9 | loss: 0.0735278
	speed: 0.0440s/iter; left time: 897.1893s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.27s
Steps: 224 | Train Loss: 0.0753596 Vali Loss: 0.0765925 Test Loss: 0.0876100
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0753230
	speed: 0.0929s/iter; left time: 1884.6420s
	iters: 200, epoch: 10 | loss: 0.0781913
	speed: 0.0390s/iter; left time: 787.2309s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0748802 Vali Loss: 0.0762593 Test Loss: 0.0871955
Validation loss decreased (0.076579 --> 0.076259).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0749062
	speed: 0.0926s/iter; left time: 1858.2121s
	iters: 200, epoch: 11 | loss: 0.0777845
	speed: 0.0419s/iter; left time: 835.3758s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.0745766 Vali Loss: 0.0759519 Test Loss: 0.0867373
Validation loss decreased (0.076259 --> 0.075952).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0746499
	speed: 0.1159s/iter; left time: 2298.3794s
	iters: 200, epoch: 12 | loss: 0.0707181
	speed: 0.0433s/iter; left time: 854.2533s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.49s
Steps: 224 | Train Loss: 0.0741716 Vali Loss: 0.0759469 Test Loss: 0.0867018
Validation loss decreased (0.075952 --> 0.075947).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0738060
	speed: 0.0828s/iter; left time: 1624.7382s
	iters: 200, epoch: 13 | loss: 0.0733494
	speed: 0.0495s/iter; left time: 966.6529s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.79s
Steps: 224 | Train Loss: 0.0739369 Vali Loss: 0.0760515 Test Loss: 0.0871067
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0706884
	speed: 0.0917s/iter; left time: 1777.0635s
	iters: 200, epoch: 14 | loss: 0.0737723
	speed: 0.0430s/iter; left time: 829.6055s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.43s
Steps: 224 | Train Loss: 0.0736894 Vali Loss: 0.0760189 Test Loss: 0.0869981
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0755268
	speed: 0.0980s/iter; left time: 1879.1079s
	iters: 200, epoch: 15 | loss: 0.0732484
	speed: 0.0462s/iter; left time: 881.2240s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.70s
Steps: 224 | Train Loss: 0.0733935 Vali Loss: 0.0757354 Test Loss: 0.0867739
Validation loss decreased (0.075947 --> 0.075735).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0715213
	speed: 0.0892s/iter; left time: 1689.2703s
	iters: 200, epoch: 16 | loss: 0.0740862
	speed: 0.0498s/iter; left time: 939.0913s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.68s
Steps: 224 | Train Loss: 0.0732062 Vali Loss: 0.0755924 Test Loss: 0.0867386
Validation loss decreased (0.075735 --> 0.075592).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0706640
	speed: 0.0946s/iter; left time: 1771.0163s
	iters: 200, epoch: 17 | loss: 0.0721274
	speed: 0.0463s/iter; left time: 861.2339s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.77s
Steps: 224 | Train Loss: 0.0730183 Vali Loss: 0.0758885 Test Loss: 0.0868945
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0740165
	speed: 0.0852s/iter; left time: 1574.7309s
	iters: 200, epoch: 18 | loss: 0.0715243
	speed: 0.0456s/iter; left time: 838.8563s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.17s
Steps: 224 | Train Loss: 0.0728788 Vali Loss: 0.0759454 Test Loss: 0.0867216
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0722490
	speed: 0.0891s/iter; left time: 1628.1780s
	iters: 200, epoch: 19 | loss: 0.0700200
	speed: 0.0436s/iter; left time: 791.4182s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.49s
Steps: 224 | Train Loss: 0.0728002 Vali Loss: 0.0754850 Test Loss: 0.0865807
Validation loss decreased (0.075592 --> 0.075485).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0729250
	speed: 0.0893s/iter; left time: 1612.0808s
	iters: 200, epoch: 20 | loss: 0.0730267
	speed: 0.0443s/iter; left time: 795.1016s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.11s
Steps: 224 | Train Loss: 0.0726108 Vali Loss: 0.0756786 Test Loss: 0.0865085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0720294
	speed: 0.0886s/iter; left time: 1579.0983s
	iters: 200, epoch: 21 | loss: 0.0724624
	speed: 0.0501s/iter; left time: 887.7429s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.85s
Steps: 224 | Train Loss: 0.0724719 Vali Loss: 0.0756035 Test Loss: 0.0865330
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0717145
	speed: 0.0919s/iter; left time: 1617.5390s
	iters: 200, epoch: 22 | loss: 0.0705282
	speed: 0.0462s/iter; left time: 807.7912s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.53s
Steps: 224 | Train Loss: 0.0723564 Vali Loss: 0.0755396 Test Loss: 0.0866191
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0681314
	speed: 0.0899s/iter; left time: 1561.9273s
	iters: 200, epoch: 23 | loss: 0.0691133
	speed: 0.0468s/iter; left time: 808.3357s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.48s
Steps: 224 | Train Loss: 0.0722308 Vali Loss: 0.0756375 Test Loss: 0.0867327
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0723156
	speed: 0.0942s/iter; left time: 1614.8145s
	iters: 200, epoch: 24 | loss: 0.0737724
	speed: 0.0426s/iter; left time: 725.5293s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0722322 Vali Loss: 0.0753499 Test Loss: 0.0864964
Validation loss decreased (0.075485 --> 0.075350).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0734103
	speed: 0.0989s/iter; left time: 1673.8253s
	iters: 200, epoch: 25 | loss: 0.0698764
	speed: 0.0500s/iter; left time: 841.6401s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.31s
Steps: 224 | Train Loss: 0.0721284 Vali Loss: 0.0755213 Test Loss: 0.0866127
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0749125
	speed: 0.0908s/iter; left time: 1515.7036s
	iters: 200, epoch: 26 | loss: 0.0681941
	speed: 0.0448s/iter; left time: 743.6942s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.06s
Steps: 224 | Train Loss: 0.0720451 Vali Loss: 0.0755095 Test Loss: 0.0866491
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0748759
	speed: 0.0885s/iter; left time: 1458.4342s
	iters: 200, epoch: 27 | loss: 0.0692100
	speed: 0.0456s/iter; left time: 747.3604s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.54s
Steps: 224 | Train Loss: 0.0719510 Vali Loss: 0.0755535 Test Loss: 0.0866617
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0701714
	speed: 0.1176s/iter; left time: 1911.0880s
	iters: 200, epoch: 28 | loss: 0.0740284
	speed: 0.0469s/iter; left time: 756.9990s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.38s
Steps: 224 | Train Loss: 0.0718891 Vali Loss: 0.0755887 Test Loss: 0.0867537
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0725884
	speed: 0.0901s/iter; left time: 1444.6852s
	iters: 200, epoch: 29 | loss: 0.0677367
	speed: 0.0464s/iter; left time: 738.4723s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.57s
Steps: 224 | Train Loss: 0.0718561 Vali Loss: 0.0753443 Test Loss: 0.0863624
Validation loss decreased (0.075350 --> 0.075344).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0719654
	speed: 0.0914s/iter; left time: 1444.5727s
	iters: 200, epoch: 30 | loss: 0.0742018
	speed: 0.0470s/iter; left time: 738.3055s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:10.53s
Steps: 224 | Train Loss: 0.0718349 Vali Loss: 0.0753530 Test Loss: 0.0864401
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0718995
	speed: 0.0899s/iter; left time: 1400.9694s
	iters: 200, epoch: 31 | loss: 0.0726714
	speed: 0.0476s/iter; left time: 736.4499s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.54s
Steps: 224 | Train Loss: 0.0716989 Vali Loss: 0.0755160 Test Loss: 0.0866547
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725034
	speed: 0.0886s/iter; left time: 1360.2044s
	iters: 200, epoch: 32 | loss: 0.0703748
	speed: 0.0424s/iter; left time: 647.0707s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.88s
Steps: 224 | Train Loss: 0.0716934 Vali Loss: 0.0754083 Test Loss: 0.0864467
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0715083
	speed: 0.0888s/iter; left time: 1344.3899s
	iters: 200, epoch: 33 | loss: 0.0704834
	speed: 0.0443s/iter; left time: 665.9598s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:10.22s
Steps: 224 | Train Loss: 0.0716789 Vali Loss: 0.0755103 Test Loss: 0.0866822
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0697350
	speed: 0.0921s/iter; left time: 1373.3359s
	iters: 200, epoch: 34 | loss: 0.0721267
	speed: 0.0452s/iter; left time: 669.5111s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:11.14s
Steps: 224 | Train Loss: 0.0716551 Vali Loss: 0.0756040 Test Loss: 0.0869137
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0750437
	speed: 0.0892s/iter; left time: 1309.3622s
	iters: 200, epoch: 35 | loss: 0.0722882
	speed: 0.0448s/iter; left time: 653.2972s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:10.29s
Steps: 224 | Train Loss: 0.0716405 Vali Loss: 0.0754976 Test Loss: 0.0866905
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0708376
	speed: 0.0979s/iter; left time: 1415.4023s
	iters: 200, epoch: 36 | loss: 0.0717003
	speed: 0.0457s/iter; left time: 655.5932s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:10.72s
Steps: 224 | Train Loss: 0.0715762 Vali Loss: 0.0754502 Test Loss: 0.0866363
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0710196
	speed: 0.0846s/iter; left time: 1203.9951s
	iters: 200, epoch: 37 | loss: 0.0715786
	speed: 0.0536s/iter; left time: 757.3926s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:10.35s
Steps: 224 | Train Loss: 0.0715935 Vali Loss: 0.0754666 Test Loss: 0.0865808
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0731768
	speed: 0.0931s/iter; left time: 1305.1641s
	iters: 200, epoch: 38 | loss: 0.0697412
	speed: 0.0454s/iter; left time: 631.0018s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:10.55s
Steps: 224 | Train Loss: 0.0715302 Vali Loss: 0.0754760 Test Loss: 0.0866731
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0720512
	speed: 0.0863s/iter; left time: 1190.6555s
	iters: 200, epoch: 39 | loss: 0.0706587
	speed: 0.0441s/iter; left time: 603.3297s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:10.24s
Steps: 224 | Train Loss: 0.0715180 Vali Loss: 0.0755162 Test Loss: 0.0867972
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0185981597751379, rmse:0.1363750696182251, mae:0.08636235445737839, rse:0.4006288945674896
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1582830
	speed: 0.0530s/iter; left time: 1182.9186s
	iters: 200, epoch: 1 | loss: 0.1536793
	speed: 0.0483s/iter; left time: 1071.4573s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.36s
Steps: 224 | Train Loss: 0.1618317 Vali Loss: 0.1495777 Test Loss: 0.1801662
Validation loss decreased (inf --> 0.149578).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0939178
	speed: 0.0893s/iter; left time: 1970.6435s
	iters: 200, epoch: 2 | loss: 0.0864733
	speed: 0.0444s/iter; left time: 975.3410s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.21s
Steps: 224 | Train Loss: 0.0985453 Vali Loss: 0.0839609 Test Loss: 0.0956050
Validation loss decreased (0.149578 --> 0.083961).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878430
	speed: 0.0928s/iter; left time: 2027.2104s
	iters: 200, epoch: 3 | loss: 0.0782254
	speed: 0.0484s/iter; left time: 1052.9475s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.86s
Steps: 224 | Train Loss: 0.0840291 Vali Loss: 0.0807863 Test Loss: 0.0920472
Validation loss decreased (0.083961 --> 0.080786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836028
	speed: 0.0849s/iter; left time: 1836.3885s
	iters: 200, epoch: 4 | loss: 0.0806706
	speed: 0.0488s/iter; left time: 1050.1849s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.45s
Steps: 224 | Train Loss: 0.0807939 Vali Loss: 0.0788258 Test Loss: 0.0900378
Validation loss decreased (0.080786 --> 0.078826).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0788435
	speed: 0.0867s/iter; left time: 1855.3890s
	iters: 200, epoch: 5 | loss: 0.0807367
	speed: 0.0425s/iter; left time: 905.1309s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.96s
Steps: 224 | Train Loss: 0.0788217 Vali Loss: 0.0780139 Test Loss: 0.0892532
Validation loss decreased (0.078826 --> 0.078014).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0773067
	speed: 0.0857s/iter; left time: 1815.4967s
	iters: 200, epoch: 6 | loss: 0.0772312
	speed: 0.0444s/iter; left time: 936.6744s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.16s
Steps: 224 | Train Loss: 0.0775746 Vali Loss: 0.0777914 Test Loss: 0.0886277
Validation loss decreased (0.078014 --> 0.077791).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0767768
	speed: 0.0880s/iter; left time: 1844.5397s
	iters: 200, epoch: 7 | loss: 0.0746151
	speed: 0.0432s/iter; left time: 901.3391s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.56s
Steps: 224 | Train Loss: 0.0767128 Vali Loss: 0.0770210 Test Loss: 0.0880919
Validation loss decreased (0.077791 --> 0.077021).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0772053
	speed: 0.0963s/iter; left time: 1995.5628s
	iters: 200, epoch: 8 | loss: 0.0728543
	speed: 0.0482s/iter; left time: 994.2795s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.58s
Steps: 224 | Train Loss: 0.0759991 Vali Loss: 0.0769128 Test Loss: 0.0879381
Validation loss decreased (0.077021 --> 0.076913).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0746797
	speed: 0.0937s/iter; left time: 1920.9430s
	iters: 200, epoch: 9 | loss: 0.0793813
	speed: 0.0427s/iter; left time: 870.6895s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.28s
Steps: 224 | Train Loss: 0.0754255 Vali Loss: 0.0765287 Test Loss: 0.0876836
Validation loss decreased (0.076913 --> 0.076529).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0778281
	speed: 0.0922s/iter; left time: 1870.5911s
	iters: 200, epoch: 10 | loss: 0.0760081
	speed: 0.0456s/iter; left time: 919.5671s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.61s
Steps: 224 | Train Loss: 0.0749424 Vali Loss: 0.0765791 Test Loss: 0.0876946
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0761849
	speed: 0.1006s/iter; left time: 2018.7588s
	iters: 200, epoch: 11 | loss: 0.0759281
	speed: 0.0469s/iter; left time: 935.3323s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.63s
Steps: 224 | Train Loss: 0.0745479 Vali Loss: 0.0765141 Test Loss: 0.0871809
Validation loss decreased (0.076529 --> 0.076514).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0740213
	speed: 0.0913s/iter; left time: 1811.0442s
	iters: 200, epoch: 12 | loss: 0.0729842
	speed: 0.0438s/iter; left time: 864.0552s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.20s
Steps: 224 | Train Loss: 0.0742243 Vali Loss: 0.0766330 Test Loss: 0.0873586
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0739172
	speed: 0.0870s/iter; left time: 1706.1184s
	iters: 200, epoch: 13 | loss: 0.0755008
	speed: 0.0434s/iter; left time: 847.5964s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.37s
Steps: 224 | Train Loss: 0.0739385 Vali Loss: 0.0763564 Test Loss: 0.0872647
Validation loss decreased (0.076514 --> 0.076356).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0703849
	speed: 0.0910s/iter; left time: 1764.5157s
	iters: 200, epoch: 14 | loss: 0.0713772
	speed: 0.0459s/iter; left time: 885.6726s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.40s
Steps: 224 | Train Loss: 0.0736357 Vali Loss: 0.0765072 Test Loss: 0.0869802
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0685526
	speed: 0.0962s/iter; left time: 1843.1338s
	iters: 200, epoch: 15 | loss: 0.0744490
	speed: 0.0474s/iter; left time: 902.9878s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.08s
Steps: 224 | Train Loss: 0.0733645 Vali Loss: 0.0765096 Test Loss: 0.0869906
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0745860
	speed: 0.0886s/iter; left time: 1677.7776s
	iters: 200, epoch: 16 | loss: 0.0714565
	speed: 0.0454s/iter; left time: 856.2537s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.31s
Steps: 224 | Train Loss: 0.0731870 Vali Loss: 0.0763907 Test Loss: 0.0867740
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0767808
	speed: 0.0861s/iter; left time: 1612.3771s
	iters: 200, epoch: 17 | loss: 0.0734670
	speed: 0.0432s/iter; left time: 804.2646s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0729853 Vali Loss: 0.0765046 Test Loss: 0.0869768
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0747071
	speed: 0.0856s/iter; left time: 1582.7634s
	iters: 200, epoch: 18 | loss: 0.0728723
	speed: 0.0430s/iter; left time: 791.7137s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.01s
Steps: 224 | Train Loss: 0.0727439 Vali Loss: 0.0765303 Test Loss: 0.0870398
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0708978
	speed: 0.0839s/iter; left time: 1532.6747s
	iters: 200, epoch: 19 | loss: 0.0723809
	speed: 0.0467s/iter; left time: 847.8197s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.13s
Steps: 224 | Train Loss: 0.0725793 Vali Loss: 0.0764471 Test Loss: 0.0870042
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0734421
	speed: 0.0824s/iter; left time: 1487.3049s
	iters: 200, epoch: 20 | loss: 0.0769663
	speed: 0.0424s/iter; left time: 760.5046s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0725307 Vali Loss: 0.0765048 Test Loss: 0.0870345
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0716774
	speed: 0.0871s/iter; left time: 1551.9097s
	iters: 200, epoch: 21 | loss: 0.0718850
	speed: 0.0442s/iter; left time: 784.1540s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.26s
Steps: 224 | Train Loss: 0.0723870 Vali Loss: 0.0766452 Test Loss: 0.0869602
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0720396
	speed: 0.0883s/iter; left time: 1553.2780s
	iters: 200, epoch: 22 | loss: 0.0696126
	speed: 0.0375s/iter; left time: 656.7074s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.38s
Steps: 224 | Train Loss: 0.0722414 Vali Loss: 0.0765089 Test Loss: 0.0867656
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0730018
	speed: 0.0952s/iter; left time: 1653.1416s
	iters: 200, epoch: 23 | loss: 0.0753521
	speed: 0.0440s/iter; left time: 760.4216s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0721670 Vali Loss: 0.0766542 Test Loss: 0.0870228
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018632538616657257, rmse:0.13650105893611908, mae:0.08726463466882706, rse:0.4009990394115448
Intermediate time for ES and pred_len 96: 00h:14m:18.30s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1581242
	speed: 0.0690s/iter; left time: 1531.2754s
	iters: 200, epoch: 1 | loss: 0.1507171
	speed: 0.0398s/iter; left time: 879.5367s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:09.88s
Steps: 223 | Train Loss: 0.1638708 Vali Loss: 0.1523550 Test Loss: 0.1819388
Validation loss decreased (inf --> 0.152355).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0986643
	speed: 0.0910s/iter; left time: 1999.3486s
	iters: 200, epoch: 2 | loss: 0.0934433
	speed: 0.0435s/iter; left time: 950.9447s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.69s
Steps: 223 | Train Loss: 0.1013446 Vali Loss: 0.0890421 Test Loss: 0.1011388
Validation loss decreased (0.152355 --> 0.089042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0940395
	speed: 0.0862s/iter; left time: 1874.5048s
	iters: 200, epoch: 3 | loss: 0.0868575
	speed: 0.0432s/iter; left time: 935.3602s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.11s
Steps: 223 | Train Loss: 0.0888059 Vali Loss: 0.0860402 Test Loss: 0.0980579
Validation loss decreased (0.089042 --> 0.086040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0851304
	speed: 0.0866s/iter; left time: 1865.2572s
	iters: 200, epoch: 4 | loss: 0.0841597
	speed: 0.0455s/iter; left time: 974.9250s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.09s
Steps: 223 | Train Loss: 0.0857711 Vali Loss: 0.0841981 Test Loss: 0.0959112
Validation loss decreased (0.086040 --> 0.084198).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0825492
	speed: 0.0966s/iter; left time: 2058.6584s
	iters: 200, epoch: 5 | loss: 0.0825241
	speed: 0.0511s/iter; left time: 1084.1987s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:13.02s
Steps: 223 | Train Loss: 0.0838901 Vali Loss: 0.0835975 Test Loss: 0.0951364
Validation loss decreased (0.084198 --> 0.083597).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0831312
	speed: 0.0965s/iter; left time: 2034.6380s
	iters: 200, epoch: 6 | loss: 0.0821218
	speed: 0.0493s/iter; left time: 1034.7975s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.86s
Steps: 223 | Train Loss: 0.0827609 Vali Loss: 0.0835203 Test Loss: 0.0949269
Validation loss decreased (0.083597 --> 0.083520).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0847962
	speed: 0.0910s/iter; left time: 1897.8135s
	iters: 200, epoch: 7 | loss: 0.0801695
	speed: 0.0493s/iter; left time: 1022.6852s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.89s
Steps: 223 | Train Loss: 0.0820128 Vali Loss: 0.0828906 Test Loss: 0.0942042
Validation loss decreased (0.083520 --> 0.082891).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0826582
	speed: 0.0957s/iter; left time: 1974.9789s
	iters: 200, epoch: 8 | loss: 0.0829372
	speed: 0.0475s/iter; left time: 975.0409s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.22s
Steps: 223 | Train Loss: 0.0813807 Vali Loss: 0.0829064 Test Loss: 0.0940305
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0785602
	speed: 0.1215s/iter; left time: 2480.4392s
	iters: 200, epoch: 9 | loss: 0.0813846
	speed: 0.0490s/iter; left time: 996.3796s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.31s
Steps: 223 | Train Loss: 0.0808702 Vali Loss: 0.0826419 Test Loss: 0.0939117
Validation loss decreased (0.082891 --> 0.082642).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0784310
	speed: 0.1026s/iter; left time: 2072.6765s
	iters: 200, epoch: 10 | loss: 0.0772360
	speed: 0.0527s/iter; left time: 1058.2349s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.89s
Steps: 223 | Train Loss: 0.0803654 Vali Loss: 0.0824731 Test Loss: 0.0937046
Validation loss decreased (0.082642 --> 0.082473).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0798821
	speed: 0.1056s/iter; left time: 2109.6307s
	iters: 200, epoch: 11 | loss: 0.0784780
	speed: 0.0510s/iter; left time: 1013.7219s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.97s
Steps: 223 | Train Loss: 0.0799386 Vali Loss: 0.0822538 Test Loss: 0.0935915
Validation loss decreased (0.082473 --> 0.082254).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0809544
	speed: 0.1066s/iter; left time: 2105.5385s
	iters: 200, epoch: 12 | loss: 0.0804690
	speed: 0.0628s/iter; left time: 1233.6168s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:13.24s
Steps: 223 | Train Loss: 0.0795472 Vali Loss: 0.0822670 Test Loss: 0.0936214
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0796984
	speed: 0.0995s/iter; left time: 1942.2477s
	iters: 200, epoch: 13 | loss: 0.0766402
	speed: 0.0535s/iter; left time: 1039.2859s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:12.22s
Steps: 223 | Train Loss: 0.0792191 Vali Loss: 0.0818180 Test Loss: 0.0939182
Validation loss decreased (0.082254 --> 0.081818).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0797491
	speed: 0.0959s/iter; left time: 1850.7114s
	iters: 200, epoch: 14 | loss: 0.0768970
	speed: 0.0532s/iter; left time: 1021.6700s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.75s
Steps: 223 | Train Loss: 0.0789267 Vali Loss: 0.0818768 Test Loss: 0.0939726
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0793521
	speed: 0.0918s/iter; left time: 1751.5002s
	iters: 200, epoch: 15 | loss: 0.0760051
	speed: 0.0471s/iter; left time: 893.2814s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.70s
Steps: 223 | Train Loss: 0.0786685 Vali Loss: 0.0820166 Test Loss: 0.0940066
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786998
	speed: 0.1378s/iter; left time: 2597.5615s
	iters: 200, epoch: 16 | loss: 0.0790844
	speed: 0.0503s/iter; left time: 943.1898s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:12.04s
Steps: 223 | Train Loss: 0.0784924 Vali Loss: 0.0818277 Test Loss: 0.0944564
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0776468
	speed: 0.1014s/iter; left time: 1889.8187s
	iters: 200, epoch: 17 | loss: 0.0762781
	speed: 0.0483s/iter; left time: 895.1874s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.89s
Steps: 223 | Train Loss: 0.0782404 Vali Loss: 0.0818648 Test Loss: 0.0947103
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0797928
	speed: 0.1072s/iter; left time: 1974.0414s
	iters: 200, epoch: 18 | loss: 0.0767054
	speed: 0.0471s/iter; left time: 862.3279s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.12s
Steps: 223 | Train Loss: 0.0780503 Vali Loss: 0.0820865 Test Loss: 0.0952556
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800530
	speed: 0.0917s/iter; left time: 1666.9970s
	iters: 200, epoch: 19 | loss: 0.0773672
	speed: 0.0436s/iter; left time: 788.9187s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.24s
Steps: 223 | Train Loss: 0.0779013 Vali Loss: 0.0819001 Test Loss: 0.0952660
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0764023
	speed: 0.0982s/iter; left time: 1763.4802s
	iters: 200, epoch: 20 | loss: 0.0789287
	speed: 0.0463s/iter; left time: 826.4898s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.97s
Steps: 223 | Train Loss: 0.0777259 Vali Loss: 0.0817606 Test Loss: 0.0951863
Validation loss decreased (0.081818 --> 0.081761).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0766384
	speed: 0.0939s/iter; left time: 1665.1161s
	iters: 200, epoch: 21 | loss: 0.0782197
	speed: 0.0423s/iter; left time: 746.9150s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.91s
Steps: 223 | Train Loss: 0.0775856 Vali Loss: 0.0819180 Test Loss: 0.0953271
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0756970
	speed: 0.1006s/iter; left time: 1762.5095s
	iters: 200, epoch: 22 | loss: 0.0782074
	speed: 0.0478s/iter; left time: 832.5172s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.09s
Steps: 223 | Train Loss: 0.0774701 Vali Loss: 0.0816166 Test Loss: 0.0955943
Validation loss decreased (0.081761 --> 0.081617).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0767044
	speed: 0.0984s/iter; left time: 1702.1382s
	iters: 200, epoch: 23 | loss: 0.0780989
	speed: 0.0468s/iter; left time: 804.1738s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.97s
Steps: 223 | Train Loss: 0.0773348 Vali Loss: 0.0818224 Test Loss: 0.0957033
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0800862
	speed: 0.1302s/iter; left time: 2222.1966s
	iters: 200, epoch: 24 | loss: 0.0712628
	speed: 0.0509s/iter; left time: 864.1032s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.14s
Steps: 223 | Train Loss: 0.0772094 Vali Loss: 0.0816642 Test Loss: 0.0957151
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0788048
	speed: 0.0999s/iter; left time: 1683.1477s
	iters: 200, epoch: 25 | loss: 0.0728152
	speed: 0.0486s/iter; left time: 814.4045s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.55s
Steps: 223 | Train Loss: 0.0771515 Vali Loss: 0.0817642 Test Loss: 0.0957897
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0781624
	speed: 0.0958s/iter; left time: 1593.5926s
	iters: 200, epoch: 26 | loss: 0.0739947
	speed: 0.0508s/iter; left time: 839.4016s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.29s
Steps: 223 | Train Loss: 0.0770992 Vali Loss: 0.0816698 Test Loss: 0.0958092
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0785158
	speed: 0.1014s/iter; left time: 1662.9674s
	iters: 200, epoch: 27 | loss: 0.0776058
	speed: 0.0500s/iter; left time: 815.4363s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.12s
Steps: 223 | Train Loss: 0.0770031 Vali Loss: 0.0817289 Test Loss: 0.0957823
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0762650
	speed: 0.0823s/iter; left time: 1331.3772s
	iters: 200, epoch: 28 | loss: 0.0730262
	speed: 0.0514s/iter; left time: 826.4948s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.63s
Steps: 223 | Train Loss: 0.0769375 Vali Loss: 0.0817190 Test Loss: 0.0960716
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0779013
	speed: 0.0821s/iter; left time: 1310.4878s
	iters: 200, epoch: 29 | loss: 0.0780241
	speed: 0.0450s/iter; left time: 712.7738s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.24s
Steps: 223 | Train Loss: 0.0768650 Vali Loss: 0.0818699 Test Loss: 0.0961976
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0775625
	speed: 0.0852s/iter; left time: 1340.6636s
	iters: 200, epoch: 30 | loss: 0.0751118
	speed: 0.0470s/iter; left time: 734.8838s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:10.31s
Steps: 223 | Train Loss: 0.0768085 Vali Loss: 0.0818688 Test Loss: 0.0963391
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0737045
	speed: 0.0859s/iter; left time: 1332.9880s
	iters: 200, epoch: 31 | loss: 0.0770995
	speed: 0.0450s/iter; left time: 692.9576s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.37s
Steps: 223 | Train Loss: 0.0767635 Vali Loss: 0.0816762 Test Loss: 0.0960850
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0781929
	speed: 0.0854s/iter; left time: 1306.2026s
	iters: 200, epoch: 32 | loss: 0.0797998
	speed: 0.0450s/iter; left time: 683.6861s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:10.24s
Steps: 223 | Train Loss: 0.0767546 Vali Loss: 0.0817475 Test Loss: 0.0963959
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02126566879451275, rmse:0.1458275318145752, mae:0.0955943912267685, rse:0.42842817306518555
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1622073
	speed: 0.0469s/iter; left time: 1041.9924s
	iters: 200, epoch: 1 | loss: 0.1511776
	speed: 0.0541s/iter; left time: 1195.4181s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.11s
Steps: 223 | Train Loss: 0.1635544 Vali Loss: 0.1513875 Test Loss: 0.1804619
Validation loss decreased (inf --> 0.151388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0963681
	speed: 0.0938s/iter; left time: 2061.2111s
	iters: 200, epoch: 2 | loss: 0.0897276
	speed: 0.0418s/iter; left time: 914.5884s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.03s
Steps: 223 | Train Loss: 0.1009506 Vali Loss: 0.0887425 Test Loss: 0.1008672
Validation loss decreased (0.151388 --> 0.088743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0909871
	speed: 0.0881s/iter; left time: 1915.6354s
	iters: 200, epoch: 3 | loss: 0.0840339
	speed: 0.0424s/iter; left time: 917.4213s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.83s
Steps: 223 | Train Loss: 0.0886917 Vali Loss: 0.0861339 Test Loss: 0.0982522
Validation loss decreased (0.088743 --> 0.086134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0863238
	speed: 0.0929s/iter; left time: 2000.6408s
	iters: 200, epoch: 4 | loss: 0.0863077
	speed: 0.0461s/iter; left time: 988.7767s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.60s
Steps: 223 | Train Loss: 0.0857665 Vali Loss: 0.0844378 Test Loss: 0.0962862
Validation loss decreased (0.086134 --> 0.084438).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0852887
	speed: 0.0866s/iter; left time: 1846.1988s
	iters: 200, epoch: 5 | loss: 0.0826804
	speed: 0.0438s/iter; left time: 929.7382s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.99s
Steps: 223 | Train Loss: 0.0839180 Vali Loss: 0.0839240 Test Loss: 0.0957661
Validation loss decreased (0.084438 --> 0.083924).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0836342
	speed: 0.0872s/iter; left time: 1837.8660s
	iters: 200, epoch: 6 | loss: 0.0806390
	speed: 0.0447s/iter; left time: 938.4344s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.33s
Steps: 223 | Train Loss: 0.0828160 Vali Loss: 0.0837571 Test Loss: 0.0950037
Validation loss decreased (0.083924 --> 0.083757).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0857420
	speed: 0.0936s/iter; left time: 1952.9342s
	iters: 200, epoch: 7 | loss: 0.0848666
	speed: 0.0497s/iter; left time: 1031.7376s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.92s
Steps: 223 | Train Loss: 0.0820557 Vali Loss: 0.0831144 Test Loss: 0.0942615
Validation loss decreased (0.083757 --> 0.083114).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0834368
	speed: 0.0871s/iter; left time: 1798.6483s
	iters: 200, epoch: 8 | loss: 0.0797058
	speed: 0.0408s/iter; left time: 838.4860s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.55s
Steps: 223 | Train Loss: 0.0814393 Vali Loss: 0.0832333 Test Loss: 0.0942153
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0792525
	speed: 0.0871s/iter; left time: 1778.6133s
	iters: 200, epoch: 9 | loss: 0.0831456
	speed: 0.0457s/iter; left time: 929.4882s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.21s
Steps: 223 | Train Loss: 0.0809265 Vali Loss: 0.0834103 Test Loss: 0.0940458
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0839281
	speed: 0.0955s/iter; left time: 1928.6092s
	iters: 200, epoch: 10 | loss: 0.0820906
	speed: 0.0519s/iter; left time: 1043.0300s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.01s
Steps: 223 | Train Loss: 0.0804400 Vali Loss: 0.0831343 Test Loss: 0.0936590
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0800651
	speed: 0.0867s/iter; left time: 1730.7268s
	iters: 200, epoch: 11 | loss: 0.0795596
	speed: 0.0422s/iter; left time: 838.3625s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.02s
Steps: 223 | Train Loss: 0.0799918 Vali Loss: 0.0829600 Test Loss: 0.0931671
Validation loss decreased (0.083114 --> 0.082960).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0811823
	speed: 0.0876s/iter; left time: 1729.5983s
	iters: 200, epoch: 12 | loss: 0.0830218
	speed: 0.0449s/iter; left time: 881.8297s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.97s
Steps: 223 | Train Loss: 0.0796409 Vali Loss: 0.0829638 Test Loss: 0.0932920
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0763461
	speed: 0.0849s/iter; left time: 1657.9939s
	iters: 200, epoch: 13 | loss: 0.0818228
	speed: 0.0532s/iter; left time: 1033.0197s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.97s
Steps: 223 | Train Loss: 0.0793178 Vali Loss: 0.0828459 Test Loss: 0.0931148
Validation loss decreased (0.082960 --> 0.082846).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0800062
	speed: 0.0951s/iter; left time: 1835.8094s
	iters: 200, epoch: 14 | loss: 0.0819832
	speed: 0.0449s/iter; left time: 863.1070s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.46s
Steps: 223 | Train Loss: 0.0789994 Vali Loss: 0.0825182 Test Loss: 0.0933117
Validation loss decreased (0.082846 --> 0.082518).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0812188
	speed: 0.0865s/iter; left time: 1650.2267s
	iters: 200, epoch: 15 | loss: 0.0769876
	speed: 0.0430s/iter; left time: 816.8974s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.94s
Steps: 223 | Train Loss: 0.0787149 Vali Loss: 0.0826182 Test Loss: 0.0934537
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786891
	speed: 0.0852s/iter; left time: 1606.9210s
	iters: 200, epoch: 16 | loss: 0.0829321
	speed: 0.0415s/iter; left time: 778.4883s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.16s
Steps: 223 | Train Loss: 0.0785222 Vali Loss: 0.0824578 Test Loss: 0.0933246
Validation loss decreased (0.082518 --> 0.082458).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0766105
	speed: 0.1073s/iter; left time: 1999.2513s
	iters: 200, epoch: 17 | loss: 0.0775430
	speed: 0.0511s/iter; left time: 947.2149s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.70s
Steps: 223 | Train Loss: 0.0782164 Vali Loss: 0.0823364 Test Loss: 0.0936304
Validation loss decreased (0.082458 --> 0.082336).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0737783
	speed: 0.0946s/iter; left time: 1741.5178s
	iters: 200, epoch: 18 | loss: 0.0795119
	speed: 0.0477s/iter; left time: 874.2183s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.11s
Steps: 223 | Train Loss: 0.0780388 Vali Loss: 0.0823434 Test Loss: 0.0939227
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0779562
	speed: 0.0911s/iter; left time: 1657.3270s
	iters: 200, epoch: 19 | loss: 0.0744572
	speed: 0.0429s/iter; left time: 775.8304s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.43s
Steps: 223 | Train Loss: 0.0778180 Vali Loss: 0.0823256 Test Loss: 0.0938507
Validation loss decreased (0.082336 --> 0.082326).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0811709
	speed: 0.0984s/iter; left time: 1767.5508s
	iters: 200, epoch: 20 | loss: 0.0786681
	speed: 0.0484s/iter; left time: 863.9501s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.73s
Steps: 223 | Train Loss: 0.0775951 Vali Loss: 0.0823114 Test Loss: 0.0941019
Validation loss decreased (0.082326 --> 0.082311).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0748576
	speed: 0.0857s/iter; left time: 1520.3580s
	iters: 200, epoch: 21 | loss: 0.0787515
	speed: 0.0458s/iter; left time: 808.7476s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.05s
Steps: 223 | Train Loss: 0.0774586 Vali Loss: 0.0820314 Test Loss: 0.0940175
Validation loss decreased (0.082311 --> 0.082031).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0802003
	speed: 0.0939s/iter; left time: 1645.4504s
	iters: 200, epoch: 22 | loss: 0.0754237
	speed: 0.0501s/iter; left time: 872.0149s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.90s
Steps: 223 | Train Loss: 0.0773000 Vali Loss: 0.0820159 Test Loss: 0.0942531
Validation loss decreased (0.082031 --> 0.082016).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0779743
	speed: 0.0921s/iter; left time: 1593.6081s
	iters: 200, epoch: 23 | loss: 0.0747215
	speed: 0.0413s/iter; left time: 710.5980s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.20s
Steps: 223 | Train Loss: 0.0772234 Vali Loss: 0.0822244 Test Loss: 0.0947550
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0775924
	speed: 0.0945s/iter; left time: 1613.5827s
	iters: 200, epoch: 24 | loss: 0.0774336
	speed: 0.0456s/iter; left time: 774.6621s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.47s
Steps: 223 | Train Loss: 0.0770066 Vali Loss: 0.0819901 Test Loss: 0.0946638
Validation loss decreased (0.082016 --> 0.081990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0765772
	speed: 0.0993s/iter; left time: 1673.6861s
	iters: 200, epoch: 25 | loss: 0.0774296
	speed: 0.0435s/iter; left time: 728.8923s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.43s
Steps: 223 | Train Loss: 0.0769184 Vali Loss: 0.0818508 Test Loss: 0.0945564
Validation loss decreased (0.081990 --> 0.081851).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0752274
	speed: 0.0964s/iter; left time: 1602.0068s
	iters: 200, epoch: 26 | loss: 0.0780611
	speed: 0.0514s/iter; left time: 849.1483s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.23s
Steps: 223 | Train Loss: 0.0768677 Vali Loss: 0.0820124 Test Loss: 0.0949415
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0767367
	speed: 0.0907s/iter; left time: 1487.4970s
	iters: 200, epoch: 27 | loss: 0.0761459
	speed: 0.0434s/iter; left time: 707.9326s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.50s
Steps: 223 | Train Loss: 0.0767765 Vali Loss: 0.0820813 Test Loss: 0.0948841
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0743221
	speed: 0.0971s/iter; left time: 1571.7583s
	iters: 200, epoch: 28 | loss: 0.0752958
	speed: 0.0469s/iter; left time: 753.8747s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:10.58s
Steps: 223 | Train Loss: 0.0767860 Vali Loss: 0.0819307 Test Loss: 0.0946716
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0782983
	speed: 0.0881s/iter; left time: 1405.0561s
	iters: 200, epoch: 29 | loss: 0.0778854
	speed: 0.0500s/iter; left time: 793.1490s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:10.77s
Steps: 223 | Train Loss: 0.0766185 Vali Loss: 0.0818122 Test Loss: 0.0950429
Validation loss decreased (0.081851 --> 0.081812).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0740042
	speed: 0.0909s/iter; left time: 1429.8427s
	iters: 200, epoch: 30 | loss: 0.0801981
	speed: 0.0461s/iter; left time: 720.3954s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:10.76s
Steps: 223 | Train Loss: 0.0765305 Vali Loss: 0.0820920 Test Loss: 0.0952042
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0767182
	speed: 0.0905s/iter; left time: 1404.4929s
	iters: 200, epoch: 31 | loss: 0.0758625
	speed: 0.0435s/iter; left time: 669.9613s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.37s
Steps: 223 | Train Loss: 0.0765871 Vali Loss: 0.0818485 Test Loss: 0.0951992
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0781168
	speed: 0.0925s/iter; left time: 1414.7914s
	iters: 200, epoch: 32 | loss: 0.0793877
	speed: 0.0462s/iter; left time: 702.4117s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:10.51s
Steps: 223 | Train Loss: 0.0764493 Vali Loss: 0.0820237 Test Loss: 0.0955673
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0740315
	speed: 0.0979s/iter; left time: 1474.8926s
	iters: 200, epoch: 33 | loss: 0.0757111
	speed: 0.0455s/iter; left time: 680.5888s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:10.38s
Steps: 223 | Train Loss: 0.0763936 Vali Loss: 0.0819379 Test Loss: 0.0954416
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0753173
	speed: 0.0873s/iter; left time: 1296.3399s
	iters: 200, epoch: 34 | loss: 0.0706699
	speed: 0.0499s/iter; left time: 735.3964s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:10.72s
Steps: 223 | Train Loss: 0.0763890 Vali Loss: 0.0819006 Test Loss: 0.0955024
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0773871
	speed: 0.0901s/iter; left time: 1317.8746s
	iters: 200, epoch: 35 | loss: 0.0741799
	speed: 0.0428s/iter; left time: 621.1149s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:10.29s
Steps: 223 | Train Loss: 0.0763201 Vali Loss: 0.0818680 Test Loss: 0.0954335
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0785499
	speed: 0.0981s/iter; left time: 1412.1083s
	iters: 200, epoch: 36 | loss: 0.0738299
	speed: 0.0454s/iter; left time: 649.1353s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:10.89s
Steps: 223 | Train Loss: 0.0762440 Vali Loss: 0.0819575 Test Loss: 0.0954877
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0755313
	speed: 0.0895s/iter; left time: 1268.2819s
	iters: 200, epoch: 37 | loss: 0.0735468
	speed: 0.0457s/iter; left time: 642.5870s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:10.32s
Steps: 223 | Train Loss: 0.0762236 Vali Loss: 0.0820155 Test Loss: 0.0955825
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0732269
	speed: 0.0910s/iter; left time: 1269.8359s
	iters: 200, epoch: 38 | loss: 0.0770698
	speed: 0.0446s/iter; left time: 617.5166s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:10.58s
Steps: 223 | Train Loss: 0.0762167 Vali Loss: 0.0818996 Test Loss: 0.0954762
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0765640
	speed: 0.0972s/iter; left time: 1334.5639s
	iters: 200, epoch: 39 | loss: 0.0754804
	speed: 0.0440s/iter; left time: 600.2140s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:10.16s
Steps: 223 | Train Loss: 0.0761922 Vali Loss: 0.0818792 Test Loss: 0.0953627
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02110309898853302, rmse:0.14526905119419098, mae:0.09504284709692001, rse:0.42678743600845337
Intermediate time for ES and pred_len 168: 00h:16m:59.59sIntermediate time for ES: 00h:52m:08.91s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1116106
	speed: 0.0731s/iter; left time: 1630.2502s
	iters: 200, epoch: 1 | loss: 0.0999537
	speed: 0.0490s/iter; left time: 1088.5594s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.93s
Steps: 224 | Train Loss: 0.1124358 Vali Loss: 0.1140086 Test Loss: 0.1257845
Validation loss decreased (inf --> 0.114009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0549609
	speed: 0.0803s/iter; left time: 1772.3277s
	iters: 200, epoch: 2 | loss: 0.0493058
	speed: 0.0416s/iter; left time: 913.9553s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.58s
Steps: 224 | Train Loss: 0.0611678 Vali Loss: 0.0598257 Test Loss: 0.0630514
Validation loss decreased (0.114009 --> 0.059826).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0481192
	speed: 0.0768s/iter; left time: 1677.9281s
	iters: 200, epoch: 3 | loss: 0.0486705
	speed: 0.0458s/iter; left time: 995.7390s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:09.83s
Steps: 224 | Train Loss: 0.0486903 Vali Loss: 0.0571938 Test Loss: 0.0604145
Validation loss decreased (0.059826 --> 0.057194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0446055
	speed: 0.0879s/iter; left time: 1901.4898s
	iters: 200, epoch: 4 | loss: 0.0433150
	speed: 0.0391s/iter; left time: 841.4111s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0464468 Vali Loss: 0.0553259 Test Loss: 0.0587835
Validation loss decreased (0.057194 --> 0.055326).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0416506
	speed: 0.0851s/iter; left time: 1821.2121s
	iters: 200, epoch: 5 | loss: 0.0478258
	speed: 0.0419s/iter; left time: 893.6254s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.13s
Steps: 224 | Train Loss: 0.0450221 Vali Loss: 0.0544317 Test Loss: 0.0578488
Validation loss decreased (0.055326 --> 0.054432).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0430584
	speed: 0.0833s/iter; left time: 1765.4194s
	iters: 200, epoch: 6 | loss: 0.0435158
	speed: 0.0425s/iter; left time: 895.7074s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.87s
Steps: 224 | Train Loss: 0.0438523 Vali Loss: 0.0536000 Test Loss: 0.0572354
Validation loss decreased (0.054432 --> 0.053600).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0451543
	speed: 0.0899s/iter; left time: 1884.5858s
	iters: 200, epoch: 7 | loss: 0.0420685
	speed: 0.0420s/iter; left time: 876.1993s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0432100 Vali Loss: 0.0533147 Test Loss: 0.0569039
Validation loss decreased (0.053600 --> 0.053315).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0422426
	speed: 0.0832s/iter; left time: 1724.8451s
	iters: 200, epoch: 8 | loss: 0.0431216
	speed: 0.0393s/iter; left time: 811.3644s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0426419 Vali Loss: 0.0527611 Test Loss: 0.0564472
Validation loss decreased (0.053315 --> 0.052761).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0423509
	speed: 0.0839s/iter; left time: 1720.1967s
	iters: 200, epoch: 9 | loss: 0.0432939
	speed: 0.0417s/iter; left time: 850.9443s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.83s
Steps: 224 | Train Loss: 0.0422622 Vali Loss: 0.0525936 Test Loss: 0.0564336
Validation loss decreased (0.052761 --> 0.052594).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0399028
	speed: 0.0858s/iter; left time: 1740.7433s
	iters: 200, epoch: 10 | loss: 0.0399608
	speed: 0.0413s/iter; left time: 834.3315s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0419118 Vali Loss: 0.0523241 Test Loss: 0.0560268
Validation loss decreased (0.052594 --> 0.052324).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0448097
	speed: 0.0837s/iter; left time: 1678.4120s
	iters: 200, epoch: 11 | loss: 0.0413758
	speed: 0.0428s/iter; left time: 855.2557s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.14s
Steps: 224 | Train Loss: 0.0416651 Vali Loss: 0.0522914 Test Loss: 0.0561402
Validation loss decreased (0.052324 --> 0.052291).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0400997
	speed: 0.0846s/iter; left time: 1678.2866s
	iters: 200, epoch: 12 | loss: 0.0403079
	speed: 0.0425s/iter; left time: 838.9230s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.79s
Steps: 224 | Train Loss: 0.0414033 Vali Loss: 0.0523278 Test Loss: 0.0561529
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0406680
	speed: 0.0794s/iter; left time: 1557.5437s
	iters: 200, epoch: 13 | loss: 0.0439693
	speed: 0.0401s/iter; left time: 781.9212s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.36s
Steps: 224 | Train Loss: 0.0411912 Vali Loss: 0.0521584 Test Loss: 0.0558714
Validation loss decreased (0.052291 --> 0.052158).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0443909
	speed: 0.0789s/iter; left time: 1530.1693s
	iters: 200, epoch: 14 | loss: 0.0410335
	speed: 0.0480s/iter; left time: 925.3789s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.06s
Steps: 224 | Train Loss: 0.0410604 Vali Loss: 0.0520966 Test Loss: 0.0557349
Validation loss decreased (0.052158 --> 0.052097).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0426491
	speed: 0.0754s/iter; left time: 1445.4137s
	iters: 200, epoch: 15 | loss: 0.0410878
	speed: 0.0404s/iter; left time: 769.7019s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.23s
Steps: 224 | Train Loss: 0.0408608 Vali Loss: 0.0522173 Test Loss: 0.0559802
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0420199
	speed: 0.0810s/iter; left time: 1533.9565s
	iters: 200, epoch: 16 | loss: 0.0383129
	speed: 0.0430s/iter; left time: 810.6526s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:09.70s
Steps: 224 | Train Loss: 0.0408030 Vali Loss: 0.0520518 Test Loss: 0.0557027
Validation loss decreased (0.052097 --> 0.052052).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0373026
	speed: 0.0807s/iter; left time: 1510.5587s
	iters: 200, epoch: 17 | loss: 0.0383360
	speed: 0.0388s/iter; left time: 722.4399s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:09.16s
Steps: 224 | Train Loss: 0.0406606 Vali Loss: 0.0520363 Test Loss: 0.0557682
Validation loss decreased (0.052052 --> 0.052036).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0412390
	speed: 0.0883s/iter; left time: 1633.5293s
	iters: 200, epoch: 18 | loss: 0.0358473
	speed: 0.0435s/iter; left time: 800.6656s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.55s
Steps: 224 | Train Loss: 0.0405495 Vali Loss: 0.0519978 Test Loss: 0.0555904
Validation loss decreased (0.052036 --> 0.051998).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0373392
	speed: 0.0815s/iter; left time: 1489.3313s
	iters: 200, epoch: 19 | loss: 0.0407665
	speed: 0.0437s/iter; left time: 793.8364s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0404592 Vali Loss: 0.0519362 Test Loss: 0.0555198
Validation loss decreased (0.051998 --> 0.051936).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0412234
	speed: 0.0878s/iter; left time: 1584.3413s
	iters: 200, epoch: 20 | loss: 0.0396656
	speed: 0.0409s/iter; left time: 733.6749s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0403646 Vali Loss: 0.0520998 Test Loss: 0.0556649
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0373310
	speed: 0.0860s/iter; left time: 1532.9719s
	iters: 200, epoch: 21 | loss: 0.0401153
	speed: 0.0408s/iter; left time: 722.6356s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.85s
Steps: 224 | Train Loss: 0.0402911 Vali Loss: 0.0519288 Test Loss: 0.0554669
Validation loss decreased (0.051936 --> 0.051929).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0404831
	speed: 0.0778s/iter; left time: 1368.3653s
	iters: 200, epoch: 22 | loss: 0.0438901
	speed: 0.0410s/iter; left time: 717.0092s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0402111 Vali Loss: 0.0519242 Test Loss: 0.0554432
Validation loss decreased (0.051929 --> 0.051924).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0380333
	speed: 0.0802s/iter; left time: 1393.3173s
	iters: 200, epoch: 23 | loss: 0.0435249
	speed: 0.0424s/iter; left time: 732.0945s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:09.64s
Steps: 224 | Train Loss: 0.0401183 Vali Loss: 0.0519605 Test Loss: 0.0554244
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0405794
	speed: 0.0829s/iter; left time: 1422.1408s
	iters: 200, epoch: 24 | loss: 0.0401202
	speed: 0.0485s/iter; left time: 826.6698s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.18s
Steps: 224 | Train Loss: 0.0400855 Vali Loss: 0.0518724 Test Loss: 0.0554681
Validation loss decreased (0.051924 --> 0.051872).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0394155
	speed: 0.0849s/iter; left time: 1437.1427s
	iters: 200, epoch: 25 | loss: 0.0379388
	speed: 0.0435s/iter; left time: 732.5664s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.12s
Steps: 224 | Train Loss: 0.0400947 Vali Loss: 0.0518481 Test Loss: 0.0554663
Validation loss decreased (0.051872 --> 0.051848).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0417797
	speed: 0.0836s/iter; left time: 1396.9560s
	iters: 200, epoch: 26 | loss: 0.0404329
	speed: 0.0413s/iter; left time: 685.7887s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.83s
Steps: 224 | Train Loss: 0.0400209 Vali Loss: 0.0519860 Test Loss: 0.0555432
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0387534
	speed: 0.0877s/iter; left time: 1445.0761s
	iters: 200, epoch: 27 | loss: 0.0388816
	speed: 0.0454s/iter; left time: 743.6236s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.44s
Steps: 224 | Train Loss: 0.0399715 Vali Loss: 0.0518692 Test Loss: 0.0553300
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0414896
	speed: 0.0907s/iter; left time: 1473.9286s
	iters: 200, epoch: 28 | loss: 0.0427325
	speed: 0.0399s/iter; left time: 644.9325s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.79s
Steps: 224 | Train Loss: 0.0399775 Vali Loss: 0.0519125 Test Loss: 0.0554073
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0402069
	speed: 0.0830s/iter; left time: 1330.2538s
	iters: 200, epoch: 29 | loss: 0.0397794
	speed: 0.0413s/iter; left time: 657.2619s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.48s
Steps: 224 | Train Loss: 0.0399143 Vali Loss: 0.0517919 Test Loss: 0.0553706
Validation loss decreased (0.051848 --> 0.051792).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0404619
	speed: 0.0827s/iter; left time: 1307.7633s
	iters: 200, epoch: 30 | loss: 0.0417322
	speed: 0.0433s/iter; left time: 680.4151s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0398649 Vali Loss: 0.0519664 Test Loss: 0.0553933
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0404604
	speed: 0.0820s/iter; left time: 1278.2334s
	iters: 200, epoch: 31 | loss: 0.0367844
	speed: 0.0424s/iter; left time: 656.5012s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.18s
Steps: 224 | Train Loss: 0.0398406 Vali Loss: 0.0518829 Test Loss: 0.0554485
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0417230
	speed: 0.0806s/iter; left time: 1238.4454s
	iters: 200, epoch: 32 | loss: 0.0367436
	speed: 0.0413s/iter; left time: 630.7389s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:09.48s
Steps: 224 | Train Loss: 0.0398467 Vali Loss: 0.0518404 Test Loss: 0.0554078
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0369080
	speed: 0.0822s/iter; left time: 1244.5143s
	iters: 200, epoch: 33 | loss: 0.0412066
	speed: 0.0407s/iter; left time: 612.4043s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.74s
Steps: 224 | Train Loss: 0.0397875 Vali Loss: 0.0518950 Test Loss: 0.0554227
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0421704
	speed: 0.0893s/iter; left time: 1330.7641s
	iters: 200, epoch: 34 | loss: 0.0425691
	speed: 0.0470s/iter; left time: 696.0755s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:10.84s
Steps: 224 | Train Loss: 0.0397469 Vali Loss: 0.0518491 Test Loss: 0.0554131
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0411076
	speed: 0.0821s/iter; left time: 1206.3435s
	iters: 200, epoch: 35 | loss: 0.0394340
	speed: 0.0436s/iter; left time: 635.7911s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0397841 Vali Loss: 0.0518472 Test Loss: 0.0553956
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0379899
	speed: 0.0822s/iter; left time: 1188.0726s
	iters: 200, epoch: 36 | loss: 0.0464343
	speed: 0.0441s/iter; left time: 633.9267s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0397807 Vali Loss: 0.0518250 Test Loss: 0.0554601
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0436030
	speed: 0.0806s/iter; left time: 1147.6513s
	iters: 200, epoch: 37 | loss: 0.0395444
	speed: 0.0459s/iter; left time: 648.2384s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.82s
Steps: 224 | Train Loss: 0.0398131 Vali Loss: 0.0518522 Test Loss: 0.0554317
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0391678
	speed: 0.0834s/iter; left time: 1168.4927s
	iters: 200, epoch: 38 | loss: 0.0418203
	speed: 0.0425s/iter; left time: 591.3226s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0397366 Vali Loss: 0.0518405 Test Loss: 0.0553314
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0387209
	speed: 0.0808s/iter; left time: 1114.6119s
	iters: 200, epoch: 39 | loss: 0.0396145
	speed: 0.0419s/iter; left time: 573.5658s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:09.56s
Steps: 224 | Train Loss: 0.0397391 Vali Loss: 0.0518850 Test Loss: 0.0553082
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010155079886317253, rmse:0.1007724180817604, mae:0.055370621383190155, rse:0.3887771964073181
Use GPU: cuda:0
>>>>>>>start training : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1094401
	speed: 0.0478s/iter; left time: 1066.2784s
	iters: 200, epoch: 1 | loss: 0.1005816
	speed: 0.0427s/iter; left time: 948.5335s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.17s
Steps: 224 | Train Loss: 0.1106520 Vali Loss: 0.1126437 Test Loss: 0.1250588
Validation loss decreased (inf --> 0.112644).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0544627
	speed: 0.0896s/iter; left time: 1978.1566s
	iters: 200, epoch: 2 | loss: 0.0556115
	speed: 0.0402s/iter; left time: 883.2771s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.81s
Steps: 224 | Train Loss: 0.0617397 Vali Loss: 0.0603577 Test Loss: 0.0636075
Validation loss decreased (0.112644 --> 0.060358).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0505745
	speed: 0.0849s/iter; left time: 1855.9019s
	iters: 200, epoch: 3 | loss: 0.0481833
	speed: 0.0456s/iter; left time: 991.5923s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.26s
Steps: 224 | Train Loss: 0.0490784 Vali Loss: 0.0574146 Test Loss: 0.0607994
Validation loss decreased (0.060358 --> 0.057415).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0464242
	speed: 0.0851s/iter; left time: 1841.3272s
	iters: 200, epoch: 4 | loss: 0.0459194
	speed: 0.0497s/iter; left time: 1068.9775s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.44s
Steps: 224 | Train Loss: 0.0467708 Vali Loss: 0.0557457 Test Loss: 0.0591055
Validation loss decreased (0.057415 --> 0.055746).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0451788
	speed: 0.0828s/iter; left time: 1771.7540s
	iters: 200, epoch: 5 | loss: 0.0424137
	speed: 0.0413s/iter; left time: 879.7402s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.59s
Steps: 224 | Train Loss: 0.0452176 Vali Loss: 0.0545432 Test Loss: 0.0581420
Validation loss decreased (0.055746 --> 0.054543).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0388246
	speed: 0.0846s/iter; left time: 1792.8875s
	iters: 200, epoch: 6 | loss: 0.0420071
	speed: 0.0448s/iter; left time: 944.7384s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0442202 Vali Loss: 0.0532858 Test Loss: 0.0572766
Validation loss decreased (0.054543 --> 0.053286).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0463440
	speed: 0.0793s/iter; left time: 1662.1594s
	iters: 200, epoch: 7 | loss: 0.0442682
	speed: 0.0480s/iter; left time: 1000.1005s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:09.89s
Steps: 224 | Train Loss: 0.0434301 Vali Loss: 0.0530425 Test Loss: 0.0569921
Validation loss decreased (0.053286 --> 0.053043).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0456950
	speed: 0.0847s/iter; left time: 1756.0646s
	iters: 200, epoch: 8 | loss: 0.0421521
	speed: 0.0422s/iter; left time: 870.3308s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:09.77s
Steps: 224 | Train Loss: 0.0428847 Vali Loss: 0.0531325 Test Loss: 0.0566786
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0417287
	speed: 0.0814s/iter; left time: 1668.8229s
	iters: 200, epoch: 9 | loss: 0.0442855
	speed: 0.0415s/iter; left time: 846.2767s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:09.88s
Steps: 224 | Train Loss: 0.0424366 Vali Loss: 0.0526041 Test Loss: 0.0563456
Validation loss decreased (0.053043 --> 0.052604).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0429612
	speed: 0.0842s/iter; left time: 1708.9010s
	iters: 200, epoch: 10 | loss: 0.0458863
	speed: 0.0440s/iter; left time: 887.6207s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:09.83s
Steps: 224 | Train Loss: 0.0420584 Vali Loss: 0.0526172 Test Loss: 0.0566575
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0429619
	speed: 0.0857s/iter; left time: 1718.5403s
	iters: 200, epoch: 11 | loss: 0.0428643
	speed: 0.0415s/iter; left time: 828.2215s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:09.97s
Steps: 224 | Train Loss: 0.0417614 Vali Loss: 0.0522490 Test Loss: 0.0558945
Validation loss decreased (0.052604 --> 0.052249).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0444045
	speed: 0.0870s/iter; left time: 1726.7818s
	iters: 200, epoch: 12 | loss: 0.0396510
	speed: 0.0425s/iter; left time: 838.1007s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.22s
Steps: 224 | Train Loss: 0.0415418 Vali Loss: 0.0523290 Test Loss: 0.0560020
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0381419
	speed: 0.0835s/iter; left time: 1637.5199s
	iters: 200, epoch: 13 | loss: 0.0405829
	speed: 0.0426s/iter; left time: 830.4934s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.07s
Steps: 224 | Train Loss: 0.0413200 Vali Loss: 0.0521626 Test Loss: 0.0557546
Validation loss decreased (0.052249 --> 0.052163).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0425900
	speed: 0.0845s/iter; left time: 1638.8649s
	iters: 200, epoch: 14 | loss: 0.0441515
	speed: 0.0415s/iter; left time: 800.4645s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:09.72s
Steps: 224 | Train Loss: 0.0411346 Vali Loss: 0.0519422 Test Loss: 0.0557106
Validation loss decreased (0.052163 --> 0.051942).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0393237
	speed: 0.0842s/iter; left time: 1613.5220s
	iters: 200, epoch: 15 | loss: 0.0445696
	speed: 0.0413s/iter; left time: 787.4873s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:09.78s
Steps: 224 | Train Loss: 0.0410265 Vali Loss: 0.0520698 Test Loss: 0.0555845
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0392608
	speed: 0.0901s/iter; left time: 1707.1272s
	iters: 200, epoch: 16 | loss: 0.0390381
	speed: 0.0438s/iter; left time: 825.7184s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.44s
Steps: 224 | Train Loss: 0.0408100 Vali Loss: 0.0520630 Test Loss: 0.0554447
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0408467
	speed: 0.0936s/iter; left time: 1752.3016s
	iters: 200, epoch: 17 | loss: 0.0394916
	speed: 0.0443s/iter; left time: 823.9765s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.13s
Steps: 224 | Train Loss: 0.0407442 Vali Loss: 0.0520150 Test Loss: 0.0554374
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0407220
	speed: 0.0818s/iter; left time: 1512.2808s
	iters: 200, epoch: 18 | loss: 0.0391960
	speed: 0.0401s/iter; left time: 736.8595s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:09.55s
Steps: 224 | Train Loss: 0.0405791 Vali Loss: 0.0518669 Test Loss: 0.0553506
Validation loss decreased (0.051942 --> 0.051867).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0418227
	speed: 0.0885s/iter; left time: 1617.1321s
	iters: 200, epoch: 19 | loss: 0.0407169
	speed: 0.0406s/iter; left time: 737.7719s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.52s
Steps: 224 | Train Loss: 0.0405353 Vali Loss: 0.0519316 Test Loss: 0.0553939
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0447454
	speed: 0.0937s/iter; left time: 1690.3551s
	iters: 200, epoch: 20 | loss: 0.0399602
	speed: 0.0442s/iter; left time: 793.7383s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.22s
Steps: 224 | Train Loss: 0.0404139 Vali Loss: 0.0518210 Test Loss: 0.0553704
Validation loss decreased (0.051867 --> 0.051821).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0401816
	speed: 0.0849s/iter; left time: 1512.1515s
	iters: 200, epoch: 21 | loss: 0.0379708
	speed: 0.0418s/iter; left time: 740.2152s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.66s
Steps: 224 | Train Loss: 0.0403843 Vali Loss: 0.0518794 Test Loss: 0.0552368
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0394045
	speed: 0.0823s/iter; left time: 1448.9314s
	iters: 200, epoch: 22 | loss: 0.0403346
	speed: 0.0437s/iter; left time: 763.8933s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.25s
Steps: 224 | Train Loss: 0.0402803 Vali Loss: 0.0517825 Test Loss: 0.0554102
Validation loss decreased (0.051821 --> 0.051782).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0382460
	speed: 0.0841s/iter; left time: 1461.1316s
	iters: 200, epoch: 23 | loss: 0.0375762
	speed: 0.0458s/iter; left time: 791.5249s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.45s
Steps: 224 | Train Loss: 0.0402176 Vali Loss: 0.0517951 Test Loss: 0.0553523
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0401320
	speed: 0.0818s/iter; left time: 1402.8727s
	iters: 200, epoch: 24 | loss: 0.0385567
	speed: 0.0415s/iter; left time: 706.9603s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:09.51s
Steps: 224 | Train Loss: 0.0401603 Vali Loss: 0.0517928 Test Loss: 0.0553305
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0406993
	speed: 0.0819s/iter; left time: 1386.0694s
	iters: 200, epoch: 25 | loss: 0.0390302
	speed: 0.0422s/iter; left time: 709.7140s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:09.77s
Steps: 224 | Train Loss: 0.0401084 Vali Loss: 0.0515937 Test Loss: 0.0551319
Validation loss decreased (0.051782 --> 0.051594).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0428648
	speed: 0.0901s/iter; left time: 1504.2644s
	iters: 200, epoch: 26 | loss: 0.0403279
	speed: 0.0437s/iter; left time: 725.3131s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.87s
Steps: 224 | Train Loss: 0.0400728 Vali Loss: 0.0516763 Test Loss: 0.0551821
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0387913
	speed: 0.0869s/iter; left time: 1431.9084s
	iters: 200, epoch: 27 | loss: 0.0396870
	speed: 0.0425s/iter; left time: 695.9117s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.94s
Steps: 224 | Train Loss: 0.0400329 Vali Loss: 0.0517391 Test Loss: 0.0552157
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0412506
	speed: 0.0830s/iter; left time: 1348.6526s
	iters: 200, epoch: 28 | loss: 0.0388730
	speed: 0.0420s/iter; left time: 678.9759s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:09.71s
Steps: 224 | Train Loss: 0.0399488 Vali Loss: 0.0516464 Test Loss: 0.0551403
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0434460
	speed: 0.0828s/iter; left time: 1326.8247s
	iters: 200, epoch: 29 | loss: 0.0378317
	speed: 0.0453s/iter; left time: 721.2278s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:09.86s
Steps: 224 | Train Loss: 0.0399308 Vali Loss: 0.0517076 Test Loss: 0.0551429
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0363359
	speed: 0.0816s/iter; left time: 1289.9784s
	iters: 200, epoch: 30 | loss: 0.0391354
	speed: 0.0405s/iter; left time: 636.7292s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:09.57s
Steps: 224 | Train Loss: 0.0399297 Vali Loss: 0.0516798 Test Loss: 0.0550891
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0417295
	speed: 0.0832s/iter; left time: 1296.8534s
	iters: 200, epoch: 31 | loss: 0.0409997
	speed: 0.0443s/iter; left time: 685.9202s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.0398885 Vali Loss: 0.0515366 Test Loss: 0.0550938
Validation loss decreased (0.051594 --> 0.051537).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0421586
	speed: 0.0825s/iter; left time: 1266.2138s
	iters: 200, epoch: 32 | loss: 0.0414021
	speed: 0.0451s/iter; left time: 687.7884s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:10.16s
Steps: 224 | Train Loss: 0.0399434 Vali Loss: 0.0517420 Test Loss: 0.0551615
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0417471
	speed: 0.0847s/iter; left time: 1282.4937s
	iters: 200, epoch: 33 | loss: 0.0378959
	speed: 0.0421s/iter; left time: 633.3319s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:09.76s
Steps: 224 | Train Loss: 0.0398366 Vali Loss: 0.0516584 Test Loss: 0.0550776
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0419260
	speed: 0.0857s/iter; left time: 1277.3356s
	iters: 200, epoch: 34 | loss: 0.0400693
	speed: 0.0432s/iter; left time: 640.4589s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:10.08s
Steps: 224 | Train Loss: 0.0398225 Vali Loss: 0.0516691 Test Loss: 0.0550839
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0443570
	speed: 0.0867s/iter; left time: 1273.0395s
	iters: 200, epoch: 35 | loss: 0.0384875
	speed: 0.0408s/iter; left time: 594.5682s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:09.68s
Steps: 224 | Train Loss: 0.0398284 Vali Loss: 0.0516524 Test Loss: 0.0551450
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0444361
	speed: 0.0937s/iter; left time: 1355.6686s
	iters: 200, epoch: 36 | loss: 0.0367514
	speed: 0.0446s/iter; left time: 640.4874s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:10.15s
Steps: 224 | Train Loss: 0.0398057 Vali Loss: 0.0515834 Test Loss: 0.0550931
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0442064
	speed: 0.0804s/iter; left time: 1144.1228s
	iters: 200, epoch: 37 | loss: 0.0412975
	speed: 0.0405s/iter; left time: 572.5004s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:09.33s
Steps: 224 | Train Loss: 0.0398019 Vali Loss: 0.0516367 Test Loss: 0.0551290
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0357967
	speed: 0.0812s/iter; left time: 1137.4933s
	iters: 200, epoch: 38 | loss: 0.0372386
	speed: 0.0426s/iter; left time: 592.1726s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:09.87s
Steps: 224 | Train Loss: 0.0397723 Vali Loss: 0.0515989 Test Loss: 0.0550932
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0391088
	speed: 0.0861s/iter; left time: 1187.1568s
	iters: 200, epoch: 39 | loss: 0.0371802
	speed: 0.0401s/iter; left time: 548.2500s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0397517 Vali Loss: 0.0516996 Test Loss: 0.0550966
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0400200
	speed: 0.0873s/iter; left time: 1183.6570s
	iters: 200, epoch: 40 | loss: 0.0437033
	speed: 0.0424s/iter; left time: 571.3823s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:10.02s
Steps: 224 | Train Loss: 0.0397919 Vali Loss: 0.0516300 Test Loss: 0.0551088
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0427056
	speed: 0.0835s/iter; left time: 1114.4762s
	iters: 200, epoch: 41 | loss: 0.0400225
	speed: 0.0439s/iter; left time: 580.9785s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:09.99s
Steps: 224 | Train Loss: 0.0397633 Vali Loss: 0.0517601 Test Loss: 0.0551124
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_24_FR_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010057547129690647, rmse:0.10028732568025589, mae:0.055093761533498764, rse:0.386905699968338
Intermediate time for FR and pred_len 24: 00h:17m:09.77s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1156252
	speed: 0.0766s/iter; left time: 1707.6842s
	iters: 200, epoch: 1 | loss: 0.1060459
	speed: 0.0419s/iter; left time: 930.1051s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.62s
Steps: 224 | Train Loss: 0.1190825 Vali Loss: 0.1222190 Test Loss: 0.1367768
Validation loss decreased (inf --> 0.122219).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0704846
	speed: 0.0849s/iter; left time: 1873.6859s
	iters: 200, epoch: 2 | loss: 0.0632950
	speed: 0.0404s/iter; left time: 886.7724s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:09.51s
Steps: 224 | Train Loss: 0.0741069 Vali Loss: 0.0766063 Test Loss: 0.0843476
Validation loss decreased (0.122219 --> 0.076606).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0635311
	speed: 0.0925s/iter; left time: 2020.8813s
	iters: 200, epoch: 3 | loss: 0.0638851
	speed: 0.0482s/iter; left time: 1049.4910s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.33s
Steps: 224 | Train Loss: 0.0637177 Vali Loss: 0.0739754 Test Loss: 0.0829573
Validation loss decreased (0.076606 --> 0.073975).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0602097
	speed: 0.0910s/iter; left time: 1967.2376s
	iters: 200, epoch: 4 | loss: 0.0603170
	speed: 0.0448s/iter; left time: 964.5114s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.38s
Steps: 224 | Train Loss: 0.0613591 Vali Loss: 0.0727099 Test Loss: 0.0827149
Validation loss decreased (0.073975 --> 0.072710).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0608542
	speed: 0.0897s/iter; left time: 1920.0526s
	iters: 200, epoch: 5 | loss: 0.0596984
	speed: 0.0456s/iter; left time: 972.4566s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.14s
Steps: 224 | Train Loss: 0.0599456 Vali Loss: 0.0722712 Test Loss: 0.0833736
Validation loss decreased (0.072710 --> 0.072271).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0593878
	speed: 0.0825s/iter; left time: 1747.6393s
	iters: 200, epoch: 6 | loss: 0.0608334
	speed: 0.0389s/iter; left time: 819.1369s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:09.60s
Steps: 224 | Train Loss: 0.0589583 Vali Loss: 0.0716899 Test Loss: 0.0825764
Validation loss decreased (0.072271 --> 0.071690).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0560035
	speed: 0.1058s/iter; left time: 2218.2488s
	iters: 200, epoch: 7 | loss: 0.0553835
	speed: 0.0413s/iter; left time: 862.3158s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.34s
Steps: 224 | Train Loss: 0.0582878 Vali Loss: 0.0717173 Test Loss: 0.0819899
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0581815
	speed: 0.0842s/iter; left time: 1745.3648s
	iters: 200, epoch: 8 | loss: 0.0568370
	speed: 0.0444s/iter; left time: 916.7852s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.13s
Steps: 224 | Train Loss: 0.0577010 Vali Loss: 0.0716664 Test Loss: 0.0823132
Validation loss decreased (0.071690 --> 0.071666).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0548898
	speed: 0.0858s/iter; left time: 1760.3143s
	iters: 200, epoch: 9 | loss: 0.0588697
	speed: 0.0481s/iter; left time: 981.9922s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.51s
Steps: 224 | Train Loss: 0.0572062 Vali Loss: 0.0716870 Test Loss: 0.0822819
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0548872
	speed: 0.0852s/iter; left time: 1727.8135s
	iters: 200, epoch: 10 | loss: 0.0590986
	speed: 0.0439s/iter; left time: 886.2813s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.10s
Steps: 224 | Train Loss: 0.0567653 Vali Loss: 0.0713302 Test Loss: 0.0821311
Validation loss decreased (0.071666 --> 0.071330).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0579021
	speed: 0.0917s/iter; left time: 1838.7550s
	iters: 200, epoch: 11 | loss: 0.0552177
	speed: 0.0473s/iter; left time: 943.4472s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.84s
Steps: 224 | Train Loss: 0.0563869 Vali Loss: 0.0716126 Test Loss: 0.0826249
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0555543
	speed: 0.0831s/iter; left time: 1648.6346s
	iters: 200, epoch: 12 | loss: 0.0536382
	speed: 0.0411s/iter; left time: 812.0181s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:09.74s
Steps: 224 | Train Loss: 0.0560712 Vali Loss: 0.0713404 Test Loss: 0.0824922
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0569652
	speed: 0.0904s/iter; left time: 1772.5409s
	iters: 200, epoch: 13 | loss: 0.0547314
	speed: 0.0422s/iter; left time: 823.6252s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0557423 Vali Loss: 0.0713660 Test Loss: 0.0824726
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0589291
	speed: 0.0859s/iter; left time: 1664.6120s
	iters: 200, epoch: 14 | loss: 0.0563333
	speed: 0.0434s/iter; left time: 837.5259s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0554690 Vali Loss: 0.0713429 Test Loss: 0.0827610
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0554153
	speed: 0.0855s/iter; left time: 1638.9282s
	iters: 200, epoch: 15 | loss: 0.0534402
	speed: 0.0459s/iter; left time: 874.2872s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.45s
Steps: 224 | Train Loss: 0.0552738 Vali Loss: 0.0714421 Test Loss: 0.0823074
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0558507
	speed: 0.0829s/iter; left time: 1571.1195s
	iters: 200, epoch: 16 | loss: 0.0544727
	speed: 0.0433s/iter; left time: 815.6780s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0550275 Vali Loss: 0.0715380 Test Loss: 0.0824943
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0563965
	speed: 0.0871s/iter; left time: 1630.7567s
	iters: 200, epoch: 17 | loss: 0.0557426
	speed: 0.0437s/iter; left time: 813.0041s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.13s
Steps: 224 | Train Loss: 0.0548346 Vali Loss: 0.0713193 Test Loss: 0.0822374
Validation loss decreased (0.071330 --> 0.071319).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0557317
	speed: 0.0891s/iter; left time: 1647.5600s
	iters: 200, epoch: 18 | loss: 0.0546155
	speed: 0.0370s/iter; left time: 681.1831s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.04s
Steps: 224 | Train Loss: 0.0546819 Vali Loss: 0.0714567 Test Loss: 0.0823589
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0554896
	speed: 0.0925s/iter; left time: 1690.3642s
	iters: 200, epoch: 19 | loss: 0.0566898
	speed: 0.0452s/iter; left time: 820.6391s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:10.19s
Steps: 224 | Train Loss: 0.0545064 Vali Loss: 0.0715879 Test Loss: 0.0822342
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0555959
	speed: 0.0859s/iter; left time: 1550.9185s
	iters: 200, epoch: 20 | loss: 0.0549557
	speed: 0.0420s/iter; left time: 752.9943s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:09.86s
Steps: 224 | Train Loss: 0.0543912 Vali Loss: 0.0714636 Test Loss: 0.0820047
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0523533
	speed: 0.0832s/iter; left time: 1482.4622s
	iters: 200, epoch: 21 | loss: 0.0542324
	speed: 0.0470s/iter; left time: 832.3343s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:10.15s
Steps: 224 | Train Loss: 0.0542423 Vali Loss: 0.0715133 Test Loss: 0.0822591
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0547638
	speed: 0.0840s/iter; left time: 1478.2885s
	iters: 200, epoch: 22 | loss: 0.0534443
	speed: 0.0446s/iter; left time: 779.9853s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:10.23s
Steps: 224 | Train Loss: 0.0541305 Vali Loss: 0.0715368 Test Loss: 0.0822879
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0543886
	speed: 0.0893s/iter; left time: 1551.1177s
	iters: 200, epoch: 23 | loss: 0.0536552
	speed: 0.0449s/iter; left time: 776.2454s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.32s
Steps: 224 | Train Loss: 0.0540624 Vali Loss: 0.0716271 Test Loss: 0.0821227
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0565382
	speed: 0.0943s/iter; left time: 1617.3101s
	iters: 200, epoch: 24 | loss: 0.0541424
	speed: 0.0387s/iter; left time: 660.2135s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.53s
Steps: 224 | Train Loss: 0.0539107 Vali Loss: 0.0714931 Test Loss: 0.0822808
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0554970
	speed: 0.0932s/iter; left time: 1577.6101s
	iters: 200, epoch: 25 | loss: 0.0549087
	speed: 0.0416s/iter; left time: 699.3649s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.03s
Steps: 224 | Train Loss: 0.0538984 Vali Loss: 0.0715967 Test Loss: 0.0822921
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0516994
	speed: 0.0864s/iter; left time: 1443.3207s
	iters: 200, epoch: 26 | loss: 0.0525186
	speed: 0.0449s/iter; left time: 744.6487s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:09.98s
Steps: 224 | Train Loss: 0.0537778 Vali Loss: 0.0716958 Test Loss: 0.0822449
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0538938
	speed: 0.0843s/iter; left time: 1389.5754s
	iters: 200, epoch: 27 | loss: 0.0564168
	speed: 0.0519s/iter; left time: 849.1989s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:10.90s
Steps: 224 | Train Loss: 0.0537319 Vali Loss: 0.0715339 Test Loss: 0.0823089
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01963534578680992, rmse:0.14012618362903595, mae:0.0822373777627945, rse:0.5420452952384949
Use GPU: cuda:0
>>>>>>>start training : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1154160
	speed: 0.0542s/iter; left time: 1207.9470s
	iters: 200, epoch: 1 | loss: 0.1075368
	speed: 0.0430s/iter; left time: 953.9838s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.87s
Steps: 224 | Train Loss: 0.1184687 Vali Loss: 0.1218070 Test Loss: 0.1364096
Validation loss decreased (inf --> 0.121807).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0671379
	speed: 0.0876s/iter; left time: 1933.6496s
	iters: 200, epoch: 2 | loss: 0.0653378
	speed: 0.0432s/iter; left time: 950.4774s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:10.02s
Steps: 224 | Train Loss: 0.0744347 Vali Loss: 0.0762421 Test Loss: 0.0846303
Validation loss decreased (0.121807 --> 0.076242).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0609564
	speed: 0.0896s/iter; left time: 1958.7890s
	iters: 200, epoch: 3 | loss: 0.0597287
	speed: 0.0510s/iter; left time: 1109.0941s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.54s
Steps: 224 | Train Loss: 0.0638290 Vali Loss: 0.0739613 Test Loss: 0.0829957
Validation loss decreased (0.076242 --> 0.073961).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0612373
	speed: 0.0926s/iter; left time: 2003.3460s
	iters: 200, epoch: 4 | loss: 0.0595653
	speed: 0.0443s/iter; left time: 953.4288s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.15s
Steps: 224 | Train Loss: 0.0615989 Vali Loss: 0.0728422 Test Loss: 0.0828065
Validation loss decreased (0.073961 --> 0.072842).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0597562
	speed: 0.0879s/iter; left time: 1880.8894s
	iters: 200, epoch: 5 | loss: 0.0553987
	speed: 0.0457s/iter; left time: 973.7747s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.55s
Steps: 224 | Train Loss: 0.0600575 Vali Loss: 0.0720670 Test Loss: 0.0821896
Validation loss decreased (0.072842 --> 0.072067).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0634054
	speed: 0.0940s/iter; left time: 1990.4701s
	iters: 200, epoch: 6 | loss: 0.0571606
	speed: 0.0501s/iter; left time: 1056.2823s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.20s
Steps: 224 | Train Loss: 0.0590135 Vali Loss: 0.0718440 Test Loss: 0.0823829
Validation loss decreased (0.072067 --> 0.071844).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0590718
	speed: 0.0905s/iter; left time: 1896.4982s
	iters: 200, epoch: 7 | loss: 0.0594180
	speed: 0.0462s/iter; left time: 962.6139s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.78s
Steps: 224 | Train Loss: 0.0582545 Vali Loss: 0.0717599 Test Loss: 0.0820033
Validation loss decreased (0.071844 --> 0.071760).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0619572
	speed: 0.0957s/iter; left time: 1983.6688s
	iters: 200, epoch: 8 | loss: 0.0600717
	speed: 0.0487s/iter; left time: 1005.1131s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:10.75s
Steps: 224 | Train Loss: 0.0577964 Vali Loss: 0.0718982 Test Loss: 0.0819674
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0560200
	speed: 0.0851s/iter; left time: 1744.3664s
	iters: 200, epoch: 9 | loss: 0.0540999
	speed: 0.0481s/iter; left time: 982.1445s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.28s
Steps: 224 | Train Loss: 0.0572643 Vali Loss: 0.0718750 Test Loss: 0.0820005
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0550202
	speed: 0.0797s/iter; left time: 1616.3702s
	iters: 200, epoch: 10 | loss: 0.0548419
	speed: 0.0452s/iter; left time: 912.6857s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:10.28s
Steps: 224 | Train Loss: 0.0568043 Vali Loss: 0.0720056 Test Loss: 0.0818854
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0563849
	speed: 0.0917s/iter; left time: 1839.5985s
	iters: 200, epoch: 11 | loss: 0.0559479
	speed: 0.0436s/iter; left time: 870.0137s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.48s
Steps: 224 | Train Loss: 0.0565039 Vali Loss: 0.0718800 Test Loss: 0.0816959
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0566436
	speed: 0.0968s/iter; left time: 1919.4741s
	iters: 200, epoch: 12 | loss: 0.0577709
	speed: 0.0432s/iter; left time: 852.3602s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:10.69s
Steps: 224 | Train Loss: 0.0561187 Vali Loss: 0.0717747 Test Loss: 0.0819871
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0572069
	speed: 0.0928s/iter; left time: 1820.7044s
	iters: 200, epoch: 13 | loss: 0.0562036
	speed: 0.0429s/iter; left time: 836.7277s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:10.33s
Steps: 224 | Train Loss: 0.0558834 Vali Loss: 0.0718664 Test Loss: 0.0820116
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0550445
	speed: 0.0926s/iter; left time: 1794.4635s
	iters: 200, epoch: 14 | loss: 0.0556109
	speed: 0.0453s/iter; left time: 874.2819s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:10.28s
Steps: 224 | Train Loss: 0.0556139 Vali Loss: 0.0718217 Test Loss: 0.0819398
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0537335
	speed: 0.0858s/iter; left time: 1644.5336s
	iters: 200, epoch: 15 | loss: 0.0527605
	speed: 0.0475s/iter; left time: 905.4412s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:10.36s
Steps: 224 | Train Loss: 0.0554120 Vali Loss: 0.0716225 Test Loss: 0.0815059
Validation loss decreased (0.071760 --> 0.071622).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0604739
	speed: 0.0896s/iter; left time: 1696.8159s
	iters: 200, epoch: 16 | loss: 0.0552410
	speed: 0.0439s/iter; left time: 826.5964s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.01s
Steps: 224 | Train Loss: 0.0552135 Vali Loss: 0.0717006 Test Loss: 0.0817680
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0567907
	speed: 0.0885s/iter; left time: 1656.3059s
	iters: 200, epoch: 17 | loss: 0.0579164
	speed: 0.0434s/iter; left time: 807.8701s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:10.15s
Steps: 224 | Train Loss: 0.0550305 Vali Loss: 0.0715534 Test Loss: 0.0811857
Validation loss decreased (0.071622 --> 0.071553).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0576145
	speed: 0.0901s/iter; left time: 1665.5064s
	iters: 200, epoch: 18 | loss: 0.0511277
	speed: 0.0516s/iter; left time: 948.3951s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.02s
Steps: 224 | Train Loss: 0.0548723 Vali Loss: 0.0716544 Test Loss: 0.0812668
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0563549
	speed: 0.0886s/iter; left time: 1618.6615s
	iters: 200, epoch: 19 | loss: 0.0547888
	speed: 0.0428s/iter; left time: 777.0635s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:09.92s
Steps: 224 | Train Loss: 0.0546784 Vali Loss: 0.0715687 Test Loss: 0.0814313
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0552318
	speed: 0.0909s/iter; left time: 1640.6769s
	iters: 200, epoch: 20 | loss: 0.0549999
	speed: 0.0434s/iter; left time: 778.8807s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:10.21s
Steps: 224 | Train Loss: 0.0545594 Vali Loss: 0.0717095 Test Loss: 0.0815305
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0532561
	speed: 0.0835s/iter; left time: 1488.8562s
	iters: 200, epoch: 21 | loss: 0.0591274
	speed: 0.0443s/iter; left time: 784.7755s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:09.54s
Steps: 224 | Train Loss: 0.0544117 Vali Loss: 0.0716369 Test Loss: 0.0813597
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0557993
	speed: 0.0848s/iter; left time: 1492.3391s
	iters: 200, epoch: 22 | loss: 0.0508411
	speed: 0.0423s/iter; left time: 740.4839s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:09.80s
Steps: 224 | Train Loss: 0.0543858 Vali Loss: 0.0716580 Test Loss: 0.0815713
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0556825
	speed: 0.0855s/iter; left time: 1485.4347s
	iters: 200, epoch: 23 | loss: 0.0515426
	speed: 0.0439s/iter; left time: 758.1320s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:10.23s
Steps: 224 | Train Loss: 0.0542970 Vali Loss: 0.0717369 Test Loss: 0.0813571
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0522207
	speed: 0.0876s/iter; left time: 1501.8778s
	iters: 200, epoch: 24 | loss: 0.0535139
	speed: 0.0481s/iter; left time: 820.0395s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:10.63s
Steps: 224 | Train Loss: 0.0541846 Vali Loss: 0.0715603 Test Loss: 0.0812604
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0517692
	speed: 0.0913s/iter; left time: 1544.9733s
	iters: 200, epoch: 25 | loss: 0.0537290
	speed: 0.0494s/iter; left time: 831.5459s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:10.64s
Steps: 224 | Train Loss: 0.0540874 Vali Loss: 0.0717348 Test Loss: 0.0813865
EarlyStopping counter: 8 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0540747
	speed: 0.0857s/iter; left time: 1431.8508s
	iters: 200, epoch: 26 | loss: 0.0552746
	speed: 0.0456s/iter; left time: 757.3590s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:10.17s
Steps: 224 | Train Loss: 0.0540465 Vali Loss: 0.0716443 Test Loss: 0.0814750
EarlyStopping counter: 9 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0510588
	speed: 0.0769s/iter; left time: 1267.6688s
	iters: 200, epoch: 27 | loss: 0.0515561
	speed: 0.0422s/iter; left time: 691.6726s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:09.08s
Steps: 224 | Train Loss: 0.0539529 Vali Loss: 0.0717339 Test Loss: 0.0817004
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_96_FR_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019514502957463264, rmse:0.13969431817531586, mae:0.08118564635515213, rse:0.540374755859375
Intermediate time for FR and pred_len 96: 00h:12m:13.97s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_336_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1153208
	speed: 0.0713s/iter; left time: 1583.2045s
	iters: 200, epoch: 1 | loss: 0.1100991
	speed: 0.0458s/iter; left time: 1011.9282s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.71s
Steps: 223 | Train Loss: 0.1203847 Vali Loss: 0.1246423 Test Loss: 0.1390748
Validation loss decreased (inf --> 0.124642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0745880
	speed: 0.0975s/iter; left time: 2143.0289s
	iters: 200, epoch: 2 | loss: 0.0722736
	speed: 0.0460s/iter; left time: 1006.3636s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.22s
Steps: 223 | Train Loss: 0.0777389 Vali Loss: 0.0799943 Test Loss: 0.0888394
Validation loss decreased (0.124642 --> 0.079994).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0674564
	speed: 0.0900s/iter; left time: 1958.9832s
	iters: 200, epoch: 3 | loss: 0.0637951
	speed: 0.0458s/iter; left time: 991.3770s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:10.52s
Steps: 223 | Train Loss: 0.0680533 Vali Loss: 0.0776140 Test Loss: 0.0879805
Validation loss decreased (0.079994 --> 0.077614).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0654204
	speed: 0.0942s/iter; left time: 2027.7239s
	iters: 200, epoch: 4 | loss: 0.0639187
	speed: 0.0447s/iter; left time: 958.5167s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:10.75s
Steps: 223 | Train Loss: 0.0657068 Vali Loss: 0.0768534 Test Loss: 0.0878971
Validation loss decreased (0.077614 --> 0.076853).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0666997
	speed: 0.0840s/iter; left time: 1789.9652s
	iters: 200, epoch: 5 | loss: 0.0655546
	speed: 0.0410s/iter; left time: 869.2475s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:09.63s
Steps: 223 | Train Loss: 0.0641879 Vali Loss: 0.0760667 Test Loss: 0.0877345
Validation loss decreased (0.076853 --> 0.076067).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0664016
	speed: 0.0996s/iter; left time: 2099.6855s
	iters: 200, epoch: 6 | loss: 0.0615867
	speed: 0.0549s/iter; left time: 1152.0352s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:12.27s
Steps: 223 | Train Loss: 0.0632301 Vali Loss: 0.0757157 Test Loss: 0.0874930
Validation loss decreased (0.076067 --> 0.075716).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0584839
	speed: 0.0988s/iter; left time: 2060.7188s
	iters: 200, epoch: 7 | loss: 0.0630124
	speed: 0.0443s/iter; left time: 919.8699s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:10.50s
Steps: 223 | Train Loss: 0.0625077 Vali Loss: 0.0755675 Test Loss: 0.0875279
Validation loss decreased (0.075716 --> 0.075568).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0630511
	speed: 0.1068s/iter; left time: 2203.6274s
	iters: 200, epoch: 8 | loss: 0.0623851
	speed: 0.0471s/iter; left time: 967.0584s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.34s
Steps: 223 | Train Loss: 0.0618813 Vali Loss: 0.0757895 Test Loss: 0.0882833
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0657311
	speed: 0.0995s/iter; left time: 2032.2665s
	iters: 200, epoch: 9 | loss: 0.0610993
	speed: 0.0470s/iter; left time: 954.3644s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:10.78s
Steps: 223 | Train Loss: 0.0613065 Vali Loss: 0.0753160 Test Loss: 0.0877921
Validation loss decreased (0.075568 --> 0.075316).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0575956
	speed: 0.1355s/iter; left time: 2735.5908s
	iters: 200, epoch: 10 | loss: 0.0608523
	speed: 0.0498s/iter; left time: 1000.7474s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.55s
Steps: 223 | Train Loss: 0.0608570 Vali Loss: 0.0752572 Test Loss: 0.0885264
Validation loss decreased (0.075316 --> 0.075257).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0602005
	speed: 0.0832s/iter; left time: 1661.5405s
	iters: 200, epoch: 11 | loss: 0.0629922
	speed: 0.0459s/iter; left time: 912.7364s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:10.22s
Steps: 223 | Train Loss: 0.0604874 Vali Loss: 0.0755354 Test Loss: 0.0883545
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0592349
	speed: 0.1064s/iter; left time: 2102.0554s
	iters: 200, epoch: 12 | loss: 0.0635952
	speed: 0.0500s/iter; left time: 982.5112s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.09s
Steps: 223 | Train Loss: 0.0600681 Vali Loss: 0.0754909 Test Loss: 0.0881430
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0601584
	speed: 0.1026s/iter; left time: 2004.1682s
	iters: 200, epoch: 13 | loss: 0.0585968
	speed: 0.0528s/iter; left time: 1024.8615s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.48s
Steps: 223 | Train Loss: 0.0596364 Vali Loss: 0.0754418 Test Loss: 0.0889707
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0573724
	speed: 0.1104s/iter; left time: 2130.7880s
	iters: 200, epoch: 14 | loss: 0.0607545
	speed: 0.0493s/iter; left time: 947.4072s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.77s
Steps: 223 | Train Loss: 0.0593828 Vali Loss: 0.0757721 Test Loss: 0.0886866
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0580708
	speed: 0.0962s/iter; left time: 1835.2907s
	iters: 200, epoch: 15 | loss: 0.0588880
	speed: 0.0492s/iter; left time: 933.1188s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:12.06s
Steps: 223 | Train Loss: 0.0590973 Vali Loss: 0.0754703 Test Loss: 0.0889454
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0575878
	speed: 0.0965s/iter; left time: 1820.0360s
	iters: 200, epoch: 16 | loss: 0.0604072
	speed: 0.0482s/iter; left time: 904.0337s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:10.96s
Steps: 223 | Train Loss: 0.0588240 Vali Loss: 0.0754639 Test Loss: 0.0887070
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0572679
	speed: 0.1067s/iter; left time: 1988.7026s
	iters: 200, epoch: 17 | loss: 0.0556697
	speed: 0.0651s/iter; left time: 1207.3066s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:13.49s
Steps: 223 | Train Loss: 0.0585886 Vali Loss: 0.0757347 Test Loss: 0.0891244
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0596313
	speed: 0.1050s/iter; left time: 1932.2893s
	iters: 200, epoch: 18 | loss: 0.0587842
	speed: 0.0433s/iter; left time: 792.7124s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:10.43s
Steps: 223 | Train Loss: 0.0583622 Vali Loss: 0.0758549 Test Loss: 0.0893418
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0568345
	speed: 0.1241s/iter; left time: 2256.4336s
	iters: 200, epoch: 19 | loss: 0.0550314
	speed: 0.0495s/iter; left time: 896.1742s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.63s
Steps: 223 | Train Loss: 0.0582125 Vali Loss: 0.0756776 Test Loss: 0.0891228
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0581905
	speed: 0.1078s/iter; left time: 1936.0585s
	iters: 200, epoch: 20 | loss: 0.0588121
	speed: 0.0467s/iter; left time: 834.1811s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.82s
Steps: 223 | Train Loss: 0.0580326 Vali Loss: 0.0758502 Test Loss: 0.0892652
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021153263747692108, rmse:0.14544162154197693, mae:0.0885264202952385, rse:0.5633091330528259
Use GPU: cuda:0
>>>>>>>start training : FR_336_168_FR_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1190915
	speed: 0.0560s/iter; left time: 1244.3394s
	iters: 200, epoch: 1 | loss: 0.1097881
	speed: 0.0440s/iter; left time: 973.3257s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:10.91s
Steps: 223 | Train Loss: 0.1205956 Vali Loss: 0.1248965 Test Loss: 0.1393289
Validation loss decreased (inf --> 0.124897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0711008
	speed: 0.0881s/iter; left time: 1937.2848s
	iters: 200, epoch: 2 | loss: 0.0703841
	speed: 0.0493s/iter; left time: 1077.8564s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.47s
Steps: 223 | Train Loss: 0.0782206 Vali Loss: 0.0799629 Test Loss: 0.0888531
Validation loss decreased (0.124897 --> 0.079963).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0687007
	speed: 0.0963s/iter; left time: 2094.9945s
	iters: 200, epoch: 3 | loss: 0.0673348
	speed: 0.0526s/iter; left time: 1139.3190s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.89s
Steps: 223 | Train Loss: 0.0680140 Vali Loss: 0.0777647 Test Loss: 0.0882832
Validation loss decreased (0.079963 --> 0.077765).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0688667
	speed: 0.1179s/iter; left time: 2537.8536s
	iters: 200, epoch: 4 | loss: 0.0627218
	speed: 0.0722s/iter; left time: 1548.1897s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:14.62s
Steps: 223 | Train Loss: 0.0656168 Vali Loss: 0.0766561 Test Loss: 0.0883783
Validation loss decreased (0.077765 --> 0.076656).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0656176
	speed: 0.0966s/iter; left time: 2058.1298s
	iters: 200, epoch: 5 | loss: 0.0660023
	speed: 0.0420s/iter; left time: 890.9427s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:10.36s
Steps: 223 | Train Loss: 0.0642845 Vali Loss: 0.0762945 Test Loss: 0.0880121
Validation loss decreased (0.076656 --> 0.076295).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0643106
	speed: 0.1097s/iter; left time: 2313.4567s
	iters: 200, epoch: 6 | loss: 0.0636514
	speed: 0.0501s/iter; left time: 1051.7077s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.79s
Steps: 223 | Train Loss: 0.0633810 Vali Loss: 0.0759921 Test Loss: 0.0878032
Validation loss decreased (0.076295 --> 0.075992).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0605581
	speed: 0.1032s/iter; left time: 2152.1843s
	iters: 200, epoch: 7 | loss: 0.0603610
	speed: 0.0490s/iter; left time: 1017.6314s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.61s
Steps: 223 | Train Loss: 0.0625573 Vali Loss: 0.0758101 Test Loss: 0.0877436
Validation loss decreased (0.075992 --> 0.075810).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0640318
	speed: 0.0831s/iter; left time: 1716.0274s
	iters: 200, epoch: 8 | loss: 0.0560514
	speed: 0.0355s/iter; left time: 728.6163s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.62s
Steps: 223 | Train Loss: 0.0619226 Vali Loss: 0.0752848 Test Loss: 0.0878139
Validation loss decreased (0.075810 --> 0.075285).  Saving model ...
Updating learning rate to 5.904900000000001e-05
/bin/sh: Zeile 1: 58391 Beendet                 python ./PatchTST-main/PatchTST_supervised/run_longExp.py --is_training 1 --root_path "/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/" --data_path "FR_data.csv" --model_id FR_336_168_FR --model "PatchTST" --data "custom" --features M --seq_len 336 --pred_len 168 --e_layers 3 --factor 1 --enc_in 3 --c_out 3 --des 'Exp' --train_epochs 100 --patience 10 --n_heads 16 --d_model 128 --d_ff 256 --dropout 0.2 --fc_dropout 0.2 --overlapping_windows --scaler_type minmax --if_relu --loss_fnc MAE --decomposition 1 --itr 2 --batch_size 128 --learning_rate "0.0001"
