
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_336_24_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1467022
	speed: 0.1228s/iter; left time: 2738.2303s
	iters: 200, epoch: 1 | loss: 0.1380337
	speed: 0.0523s/iter; left time: 1161.8565s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:17.55s
Steps: 224 | Train Loss: 0.1492598 Vali Loss: 0.1491447 Test Loss: 0.1573455
Validation loss decreased (inf --> 0.149145).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0933916
	speed: 0.0933s/iter; left time: 2059.6937s
	iters: 200, epoch: 2 | loss: 0.0793409
	speed: 0.0520s/iter; left time: 1143.6026s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0958381 Vali Loss: 0.0959918 Test Loss: 0.0965967
Validation loss decreased (0.149145 --> 0.095992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0804107
	speed: 0.0927s/iter; left time: 2026.3754s
	iters: 200, epoch: 3 | loss: 0.0822360
	speed: 0.0521s/iter; left time: 1133.9835s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0800409 Vali Loss: 0.0911792 Test Loss: 0.0924903
Validation loss decreased (0.095992 --> 0.091179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0721088
	speed: 0.0919s/iter; left time: 1988.3672s
	iters: 200, epoch: 4 | loss: 0.0784065
	speed: 0.0521s/iter; left time: 1121.0181s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0768202 Vali Loss: 0.0894785 Test Loss: 0.0912090
Validation loss decreased (0.091179 --> 0.089479).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0701359
	speed: 0.0919s/iter; left time: 1968.0610s
	iters: 200, epoch: 5 | loss: 0.0721674
	speed: 0.0520s/iter; left time: 1108.5295s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0751275 Vali Loss: 0.0886305 Test Loss: 0.0903440
Validation loss decreased (0.089479 --> 0.088631).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0747568
	speed: 0.0922s/iter; left time: 1952.3521s
	iters: 200, epoch: 6 | loss: 0.0739783
	speed: 0.0520s/iter; left time: 1095.6697s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.82s
Steps: 224 | Train Loss: 0.0740978 Vali Loss: 0.0879776 Test Loss: 0.0896847
Validation loss decreased (0.088631 --> 0.087978).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0773371
	speed: 0.0916s/iter; left time: 1918.9129s
	iters: 200, epoch: 7 | loss: 0.0693570
	speed: 0.0521s/iter; left time: 1085.8265s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.83s
Steps: 224 | Train Loss: 0.0731795 Vali Loss: 0.0878054 Test Loss: 0.0894686
Validation loss decreased (0.087978 --> 0.087805).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0742184
	speed: 0.0920s/iter; left time: 1907.8917s
	iters: 200, epoch: 8 | loss: 0.0694305
	speed: 0.0520s/iter; left time: 1073.5789s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0726620 Vali Loss: 0.0872411 Test Loss: 0.0890743
Validation loss decreased (0.087805 --> 0.087241).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0730793
	speed: 0.0919s/iter; left time: 1884.5651s
	iters: 200, epoch: 9 | loss: 0.0740317
	speed: 0.0521s/iter; left time: 1063.4557s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0721427 Vali Loss: 0.0873636 Test Loss: 0.0895516
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0651195
	speed: 0.0912s/iter; left time: 1849.6289s
	iters: 200, epoch: 10 | loss: 0.0683019
	speed: 0.0520s/iter; left time: 1049.7642s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.83s
Steps: 224 | Train Loss: 0.0717890 Vali Loss: 0.0870031 Test Loss: 0.0891616
Validation loss decreased (0.087241 --> 0.087003).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0714403
	speed: 0.0917s/iter; left time: 1840.4068s
	iters: 200, epoch: 11 | loss: 0.0766668
	speed: 0.0522s/iter; left time: 1042.2430s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0714359 Vali Loss: 0.0870827 Test Loss: 0.0894357
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0713613
	speed: 0.0918s/iter; left time: 1821.7477s
	iters: 200, epoch: 12 | loss: 0.0730791
	speed: 0.0520s/iter; left time: 1027.2456s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.83s
Steps: 224 | Train Loss: 0.0711605 Vali Loss: 0.0868916 Test Loss: 0.0890513
Validation loss decreased (0.087003 --> 0.086892).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0658389
	speed: 0.0923s/iter; left time: 1810.5726s
	iters: 200, epoch: 13 | loss: 0.0685006
	speed: 0.0522s/iter; left time: 1017.9258s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0708652 Vali Loss: 0.0865712 Test Loss: 0.0891132
Validation loss decreased (0.086892 --> 0.086571).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0742952
	speed: 0.0923s/iter; left time: 1790.4333s
	iters: 200, epoch: 14 | loss: 0.0701290
	speed: 0.0522s/iter; left time: 1007.3169s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0706609 Vali Loss: 0.0864862 Test Loss: 0.0889904
Validation loss decreased (0.086571 --> 0.086486).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0725446
	speed: 0.0918s/iter; left time: 1759.3193s
	iters: 200, epoch: 15 | loss: 0.0695209
	speed: 0.0521s/iter; left time: 994.0532s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0704827 Vali Loss: 0.0864452 Test Loss: 0.0889387
Validation loss decreased (0.086486 --> 0.086445).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0676632
	speed: 0.0926s/iter; left time: 1754.8505s
	iters: 200, epoch: 16 | loss: 0.0735662
	speed: 0.0522s/iter; left time: 983.1992s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0703078 Vali Loss: 0.0865087 Test Loss: 0.0890939
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0669014
	speed: 0.0913s/iter; left time: 1709.1642s
	iters: 200, epoch: 17 | loss: 0.0692772
	speed: 0.0520s/iter; left time: 968.4467s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0701388 Vali Loss: 0.0867771 Test Loss: 0.0890331
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0704841
	speed: 0.0918s/iter; left time: 1698.3764s
	iters: 200, epoch: 18 | loss: 0.0685036
	speed: 0.0520s/iter; left time: 956.4597s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0699684 Vali Loss: 0.0864049 Test Loss: 0.0891183
Validation loss decreased (0.086445 --> 0.086405).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0693344
	speed: 0.0918s/iter; left time: 1677.6074s
	iters: 200, epoch: 19 | loss: 0.0699148
	speed: 0.0520s/iter; left time: 945.3828s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.82s
Steps: 224 | Train Loss: 0.0698359 Vali Loss: 0.0864480 Test Loss: 0.0891146
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0743156
	speed: 0.0915s/iter; left time: 1651.0797s
	iters: 200, epoch: 20 | loss: 0.0695782
	speed: 0.0522s/iter; left time: 935.9140s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0698212 Vali Loss: 0.0862729 Test Loss: 0.0889007
Validation loss decreased (0.086405 --> 0.086273).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0642834
	speed: 0.0928s/iter; left time: 1653.1337s
	iters: 200, epoch: 21 | loss: 0.0729156
	speed: 0.0522s/iter; left time: 924.9015s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0696815 Vali Loss: 0.0863191 Test Loss: 0.0889219
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0668081
	speed: 0.0917s/iter; left time: 1614.1587s
	iters: 200, epoch: 22 | loss: 0.0675850
	speed: 0.0519s/iter; left time: 908.8251s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0696013 Vali Loss: 0.0863717 Test Loss: 0.0890059
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0662554
	speed: 0.0918s/iter; left time: 1595.3221s
	iters: 200, epoch: 23 | loss: 0.0715963
	speed: 0.0523s/iter; left time: 902.7860s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0694505 Vali Loss: 0.0862607 Test Loss: 0.0890646
Validation loss decreased (0.086273 --> 0.086261).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0695211
	speed: 0.0919s/iter; left time: 1576.1074s
	iters: 200, epoch: 24 | loss: 0.0653179
	speed: 0.0521s/iter; left time: 888.1903s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.83s
Steps: 224 | Train Loss: 0.0693793 Vali Loss: 0.0863263 Test Loss: 0.0889909
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0677006
	speed: 0.0917s/iter; left time: 1551.5624s
	iters: 200, epoch: 25 | loss: 0.0705059
	speed: 0.0521s/iter; left time: 876.4930s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0693588 Vali Loss: 0.0863821 Test Loss: 0.0890807
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0654885
	speed: 0.0909s/iter; left time: 1518.4668s
	iters: 200, epoch: 26 | loss: 0.0649945
	speed: 0.0522s/iter; left time: 867.3155s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0692742 Vali Loss: 0.0864751 Test Loss: 0.0893381
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0677808
	speed: 0.0915s/iter; left time: 1507.1605s
	iters: 200, epoch: 27 | loss: 0.0714075
	speed: 0.0521s/iter; left time: 853.5828s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.82s
Steps: 224 | Train Loss: 0.0692092 Vali Loss: 0.0862476 Test Loss: 0.0890449
Validation loss decreased (0.086261 --> 0.086248).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0650818
	speed: 0.0932s/iter; left time: 1515.3784s
	iters: 200, epoch: 28 | loss: 0.0720823
	speed: 0.0523s/iter; left time: 844.7327s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0691955 Vali Loss: 0.0863042 Test Loss: 0.0889602
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0675507
	speed: 0.0913s/iter; left time: 1463.5355s
	iters: 200, epoch: 29 | loss: 0.0689953
	speed: 0.0522s/iter; left time: 832.1837s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0691315 Vali Loss: 0.0862055 Test Loss: 0.0891577
Validation loss decreased (0.086248 --> 0.086206).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0723119
	speed: 0.0921s/iter; left time: 1456.2687s
	iters: 200, epoch: 30 | loss: 0.0689444
	speed: 0.0522s/iter; left time: 819.8923s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0690726 Vali Loss: 0.0864122 Test Loss: 0.0891799
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0699471
	speed: 0.0913s/iter; left time: 1422.4287s
	iters: 200, epoch: 31 | loss: 0.0650906
	speed: 0.0520s/iter; left time: 805.0000s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.82s
Steps: 224 | Train Loss: 0.0690898 Vali Loss: 0.0861617 Test Loss: 0.0890982
Validation loss decreased (0.086206 --> 0.086162).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0697123
	speed: 0.0923s/iter; left time: 1417.4605s
	iters: 200, epoch: 32 | loss: 0.0689837
	speed: 0.0522s/iter; left time: 796.3078s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0690290 Vali Loss: 0.0862783 Test Loss: 0.0891600
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0689367
	speed: 0.0921s/iter; left time: 1393.5575s
	iters: 200, epoch: 33 | loss: 0.0651389
	speed: 0.0521s/iter; left time: 783.5860s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0689599 Vali Loss: 0.0864315 Test Loss: 0.0891968
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0703542
	speed: 0.0922s/iter; left time: 1374.2428s
	iters: 200, epoch: 34 | loss: 0.0736774
	speed: 0.0523s/iter; left time: 774.3701s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0689449 Vali Loss: 0.0863892 Test Loss: 0.0892073
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0694088
	speed: 0.0920s/iter; left time: 1350.4302s
	iters: 200, epoch: 35 | loss: 0.0643488
	speed: 0.0521s/iter; left time: 760.2767s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0689930 Vali Loss: 0.0862459 Test Loss: 0.0891558
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0662179
	speed: 0.0917s/iter; left time: 1326.3345s
	iters: 200, epoch: 36 | loss: 0.0716586
	speed: 0.0522s/iter; left time: 750.1319s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0689090 Vali Loss: 0.0862916 Test Loss: 0.0891562
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0689815
	speed: 0.0918s/iter; left time: 1306.4955s
	iters: 200, epoch: 37 | loss: 0.0692148
	speed: 0.0521s/iter; left time: 736.6002s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0688933 Vali Loss: 0.0864036 Test Loss: 0.0891469
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0756959
	speed: 0.0920s/iter; left time: 1288.5300s
	iters: 200, epoch: 38 | loss: 0.0706713
	speed: 0.0522s/iter; left time: 726.3920s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0689504 Vali Loss: 0.0863323 Test Loss: 0.0891482
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0717678
	speed: 0.0921s/iter; left time: 1269.8383s
	iters: 200, epoch: 39 | loss: 0.0696688
	speed: 0.0523s/iter; left time: 715.6231s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0688292 Vali Loss: 0.0862189 Test Loss: 0.0891291
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0669256
	speed: 0.0917s/iter; left time: 1243.5590s
	iters: 200, epoch: 40 | loss: 0.0677449
	speed: 0.0520s/iter; left time: 700.3289s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0688930 Vali Loss: 0.0861876 Test Loss: 0.0891016
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0648098
	speed: 0.0914s/iter; left time: 1219.2675s
	iters: 200, epoch: 41 | loss: 0.0646161
	speed: 0.0523s/iter; left time: 693.1443s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0688258 Vali Loss: 0.0862216 Test Loss: 0.0891206
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021291740238666534, rmse:0.1459168940782547, mae:0.08909820020198822, rse:0.5149609446525574
Use GPU: cuda:0
>>>>>>>start training : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1485177
	speed: 0.0536s/iter; left time: 1194.7774s
	iters: 200, epoch: 1 | loss: 0.1372107
	speed: 0.0520s/iter; left time: 1155.3213s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.1479508 Vali Loss: 0.1469130 Test Loss: 0.1552787
Validation loss decreased (inf --> 0.146913).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0860679
	speed: 0.0933s/iter; left time: 2058.9109s
	iters: 200, epoch: 2 | loss: 0.0842555
	speed: 0.0523s/iter; left time: 1149.7879s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:11.96s
Steps: 224 | Train Loss: 0.0963806 Vali Loss: 0.0965345 Test Loss: 0.0970062
Validation loss decreased (0.146913 --> 0.096534).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0792745
	speed: 0.0931s/iter; left time: 2033.9156s
	iters: 200, epoch: 3 | loss: 0.0799089
	speed: 0.0524s/iter; left time: 1140.1922s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0806034 Vali Loss: 0.0915469 Test Loss: 0.0932558
Validation loss decreased (0.096534 --> 0.091547).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0692745
	speed: 0.0931s/iter; left time: 2013.9274s
	iters: 200, epoch: 4 | loss: 0.0753272
	speed: 0.0524s/iter; left time: 1129.0058s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:11.97s
Steps: 224 | Train Loss: 0.0771334 Vali Loss: 0.0894109 Test Loss: 0.0913275
Validation loss decreased (0.091547 --> 0.089411).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0780892
	speed: 0.0933s/iter; left time: 1996.3633s
	iters: 200, epoch: 5 | loss: 0.0733127
	speed: 0.0521s/iter; left time: 1110.4064s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0752457 Vali Loss: 0.0887977 Test Loss: 0.0907949
Validation loss decreased (0.089411 --> 0.088798).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0735669
	speed: 0.0927s/iter; left time: 1964.5271s
	iters: 200, epoch: 6 | loss: 0.0754406
	speed: 0.0521s/iter; left time: 1098.1089s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0741429 Vali Loss: 0.0879942 Test Loss: 0.0900813
Validation loss decreased (0.088798 --> 0.087994).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0708586
	speed: 0.0925s/iter; left time: 1939.5686s
	iters: 200, epoch: 7 | loss: 0.0723750
	speed: 0.0520s/iter; left time: 1084.7077s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0733710 Vali Loss: 0.0877222 Test Loss: 0.0897023
Validation loss decreased (0.087994 --> 0.087722).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0735653
	speed: 0.0931s/iter; left time: 1931.0122s
	iters: 200, epoch: 8 | loss: 0.0752200
	speed: 0.0523s/iter; left time: 1079.1748s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:11.94s
Steps: 224 | Train Loss: 0.0726825 Vali Loss: 0.0871324 Test Loss: 0.0893786
Validation loss decreased (0.087722 --> 0.087132).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738944
	speed: 0.0928s/iter; left time: 1903.5217s
	iters: 200, epoch: 9 | loss: 0.0740931
	speed: 0.0521s/iter; left time: 1063.2787s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0721897 Vali Loss: 0.0869960 Test Loss: 0.0890788
Validation loss decreased (0.087132 --> 0.086996).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0751932
	speed: 0.0925s/iter; left time: 1875.5854s
	iters: 200, epoch: 10 | loss: 0.0673028
	speed: 0.0521s/iter; left time: 1052.6095s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0717408 Vali Loss: 0.0867880 Test Loss: 0.0891405
Validation loss decreased (0.086996 --> 0.086788).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0667565
	speed: 0.0930s/iter; left time: 1865.8693s
	iters: 200, epoch: 11 | loss: 0.0711614
	speed: 0.0522s/iter; left time: 1041.6901s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0714507 Vali Loss: 0.0870664 Test Loss: 0.0891779
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0710983
	speed: 0.0923s/iter; left time: 1831.1766s
	iters: 200, epoch: 12 | loss: 0.0680309
	speed: 0.0521s/iter; left time: 1027.6809s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0711380 Vali Loss: 0.0867219 Test Loss: 0.0890017
Validation loss decreased (0.086788 --> 0.086722).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0719549
	speed: 0.0936s/iter; left time: 1836.1844s
	iters: 200, epoch: 13 | loss: 0.0728736
	speed: 0.0522s/iter; left time: 1017.8660s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0709379 Vali Loss: 0.0864662 Test Loss: 0.0890279
Validation loss decreased (0.086722 --> 0.086466).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0695809
	speed: 0.0939s/iter; left time: 1819.8176s
	iters: 200, epoch: 14 | loss: 0.0691624
	speed: 0.0524s/iter; left time: 1010.3812s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:11.92s
Steps: 224 | Train Loss: 0.0707244 Vali Loss: 0.0867192 Test Loss: 0.0890669
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0662107
	speed: 0.0920s/iter; left time: 1763.4149s
	iters: 200, epoch: 15 | loss: 0.0770034
	speed: 0.0523s/iter; left time: 996.6752s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0704650 Vali Loss: 0.0864952 Test Loss: 0.0890869
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0746670
	speed: 0.0919s/iter; left time: 1740.9086s
	iters: 200, epoch: 16 | loss: 0.0751349
	speed: 0.0521s/iter; left time: 981.9128s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0703478 Vali Loss: 0.0866213 Test Loss: 0.0890552
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0691212
	speed: 0.0920s/iter; left time: 1722.2517s
	iters: 200, epoch: 17 | loss: 0.0701027
	speed: 0.0521s/iter; left time: 969.6255s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0701723 Vali Loss: 0.0864791 Test Loss: 0.0890113
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0723499
	speed: 0.0919s/iter; left time: 1700.2176s
	iters: 200, epoch: 18 | loss: 0.0661663
	speed: 0.0517s/iter; left time: 951.0878s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:11.81s
Steps: 224 | Train Loss: 0.0700250 Vali Loss: 0.0864334 Test Loss: 0.0889767
Validation loss decreased (0.086466 --> 0.086433).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0676247
	speed: 0.0937s/iter; left time: 1712.6457s
	iters: 200, epoch: 19 | loss: 0.0656377
	speed: 0.0520s/iter; left time: 945.4837s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:11.85s
Steps: 224 | Train Loss: 0.0698972 Vali Loss: 0.0863700 Test Loss: 0.0890557
Validation loss decreased (0.086433 --> 0.086370).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0731429
	speed: 0.0929s/iter; left time: 1675.8486s
	iters: 200, epoch: 20 | loss: 0.0692441
	speed: 0.0521s/iter; left time: 935.7005s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0697965 Vali Loss: 0.0862033 Test Loss: 0.0890447
Validation loss decreased (0.086370 --> 0.086203).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0687015
	speed: 0.0925s/iter; left time: 1647.6947s
	iters: 200, epoch: 21 | loss: 0.0658207
	speed: 0.0522s/iter; left time: 924.5576s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0696816 Vali Loss: 0.0863567 Test Loss: 0.0893161
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0706210
	speed: 0.0920s/iter; left time: 1619.2148s
	iters: 200, epoch: 22 | loss: 0.0746962
	speed: 0.0521s/iter; left time: 912.0338s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0696258 Vali Loss: 0.0863918 Test Loss: 0.0891025
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0717456
	speed: 0.0924s/iter; left time: 1604.8759s
	iters: 200, epoch: 23 | loss: 0.0713271
	speed: 0.0521s/iter; left time: 899.6638s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0695054 Vali Loss: 0.0861524 Test Loss: 0.0890253
Validation loss decreased (0.086203 --> 0.086152).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0754816
	speed: 0.0929s/iter; left time: 1593.2847s
	iters: 200, epoch: 24 | loss: 0.0685918
	speed: 0.0522s/iter; left time: 889.6944s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0694104 Vali Loss: 0.0862667 Test Loss: 0.0890559
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0633278
	speed: 0.0919s/iter; left time: 1556.0090s
	iters: 200, epoch: 25 | loss: 0.0648984
	speed: 0.0520s/iter; left time: 875.5555s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:11.81s
Steps: 224 | Train Loss: 0.0693590 Vali Loss: 0.0861933 Test Loss: 0.0891097
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0697152
	speed: 0.0922s/iter; left time: 1539.2391s
	iters: 200, epoch: 26 | loss: 0.0684530
	speed: 0.0521s/iter; left time: 864.9047s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0692901 Vali Loss: 0.0861402 Test Loss: 0.0891699
Validation loss decreased (0.086152 --> 0.086140).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0680913
	speed: 0.0929s/iter; left time: 1530.7129s
	iters: 200, epoch: 27 | loss: 0.0710975
	speed: 0.0520s/iter; left time: 851.4128s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0692415 Vali Loss: 0.0861493 Test Loss: 0.0890312
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0662386
	speed: 0.0922s/iter; left time: 1498.0141s
	iters: 200, epoch: 28 | loss: 0.0694833
	speed: 0.0521s/iter; left time: 841.4651s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0691602 Vali Loss: 0.0861183 Test Loss: 0.0892049
Validation loss decreased (0.086140 --> 0.086118).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0725555
	speed: 0.0936s/iter; left time: 1500.0613s
	iters: 200, epoch: 29 | loss: 0.0715661
	speed: 0.0524s/iter; left time: 835.2625s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:11.93s
Steps: 224 | Train Loss: 0.0691908 Vali Loss: 0.0860879 Test Loss: 0.0891321
Validation loss decreased (0.086118 --> 0.086088).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0675764
	speed: 0.0936s/iter; left time: 1478.5720s
	iters: 200, epoch: 30 | loss: 0.0685819
	speed: 0.0521s/iter; left time: 817.8294s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:11.88s
Steps: 224 | Train Loss: 0.0691524 Vali Loss: 0.0860893 Test Loss: 0.0891131
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0705770
	speed: 0.0921s/iter; left time: 1435.6957s
	iters: 200, epoch: 31 | loss: 0.0713090
	speed: 0.0520s/iter; left time: 805.1706s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0691323 Vali Loss: 0.0861251 Test Loss: 0.0891209
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725021
	speed: 0.0919s/iter; left time: 1411.8306s
	iters: 200, epoch: 32 | loss: 0.0674104
	speed: 0.0522s/iter; left time: 796.1711s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0690699 Vali Loss: 0.0860819 Test Loss: 0.0890955
Validation loss decreased (0.086088 --> 0.086082).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0671740
	speed: 0.0930s/iter; left time: 1406.7771s
	iters: 200, epoch: 33 | loss: 0.0640508
	speed: 0.0522s/iter; left time: 784.0085s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0690287 Vali Loss: 0.0861212 Test Loss: 0.0891954
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0705414
	speed: 0.0917s/iter; left time: 1367.8583s
	iters: 200, epoch: 34 | loss: 0.0681740
	speed: 0.0521s/iter; left time: 771.8499s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0689596 Vali Loss: 0.0862194 Test Loss: 0.0890935
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0701695
	speed: 0.0923s/iter; left time: 1354.8329s
	iters: 200, epoch: 35 | loss: 0.0673041
	speed: 0.0521s/iter; left time: 760.3999s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:11.91s
Steps: 224 | Train Loss: 0.0689486 Vali Loss: 0.0861580 Test Loss: 0.0891037
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0642554
	speed: 0.0935s/iter; left time: 1352.7820s
	iters: 200, epoch: 36 | loss: 0.0672532
	speed: 0.0520s/iter; left time: 747.0960s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0689205 Vali Loss: 0.0860491 Test Loss: 0.0890471
Validation loss decreased (0.086082 --> 0.086049).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0744950
	speed: 0.0928s/iter; left time: 1321.7060s
	iters: 200, epoch: 37 | loss: 0.0638594
	speed: 0.0523s/iter; left time: 740.0138s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:11.90s
Steps: 224 | Train Loss: 0.0689579 Vali Loss: 0.0861269 Test Loss: 0.0891083
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0700178
	speed: 0.0924s/iter; left time: 1294.5238s
	iters: 200, epoch: 38 | loss: 0.0661885
	speed: 0.0520s/iter; left time: 723.7910s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0688744 Vali Loss: 0.0861560 Test Loss: 0.0891225
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0645115
	speed: 0.0922s/iter; left time: 1271.8806s
	iters: 200, epoch: 39 | loss: 0.0643578
	speed: 0.0522s/iter; left time: 714.6632s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0689252 Vali Loss: 0.0861439 Test Loss: 0.0890523
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0712911
	speed: 0.0919s/iter; left time: 1246.2058s
	iters: 200, epoch: 40 | loss: 0.0740808
	speed: 0.0520s/iter; left time: 700.5492s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:11.84s
Steps: 224 | Train Loss: 0.0688536 Vali Loss: 0.0859760 Test Loss: 0.0890604
Validation loss decreased (0.086049 --> 0.085976).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0645042
	speed: 0.0949s/iter; left time: 1265.5498s
	iters: 200, epoch: 41 | loss: 0.0700506
	speed: 0.0519s/iter; left time: 687.2646s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:11.79s
Steps: 224 | Train Loss: 0.0688851 Vali Loss: 0.0861665 Test Loss: 0.0890974
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0722492
	speed: 0.0919s/iter; left time: 1204.9191s
	iters: 200, epoch: 42 | loss: 0.0705930
	speed: 0.0520s/iter; left time: 677.1929s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0688321 Vali Loss: 0.0860264 Test Loss: 0.0891213
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0742681
	speed: 0.0919s/iter; left time: 1185.2241s
	iters: 200, epoch: 43 | loss: 0.0690211
	speed: 0.0524s/iter; left time: 669.9280s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0688786 Vali Loss: 0.0860898 Test Loss: 0.0890831
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0646683
	speed: 0.0920s/iter; left time: 1165.0368s
	iters: 200, epoch: 44 | loss: 0.0692453
	speed: 0.0520s/iter; left time: 654.0766s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:11.83s
Steps: 224 | Train Loss: 0.0688329 Vali Loss: 0.0861044 Test Loss: 0.0890925
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0659040
	speed: 0.0919s/iter; left time: 1144.2450s
	iters: 200, epoch: 45 | loss: 0.0643121
	speed: 0.0521s/iter; left time: 643.3371s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0688306 Vali Loss: 0.0860788 Test Loss: 0.0891090
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0707033
	speed: 0.0924s/iter; left time: 1129.4004s
	iters: 200, epoch: 46 | loss: 0.0666583
	speed: 0.0520s/iter; left time: 630.4095s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0687669 Vali Loss: 0.0861802 Test Loss: 0.0891388
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0668203
	speed: 0.0921s/iter; left time: 1104.7161s
	iters: 200, epoch: 47 | loss: 0.0678259
	speed: 0.0520s/iter; left time: 618.7939s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:11.86s
Steps: 224 | Train Loss: 0.0687843 Vali Loss: 0.0860328 Test Loss: 0.0891000
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0671443
	speed: 0.0922s/iter; left time: 1085.1757s
	iters: 200, epoch: 48 | loss: 0.0705720
	speed: 0.0522s/iter; left time: 609.3206s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:11.89s
Steps: 224 | Train Loss: 0.0687883 Vali Loss: 0.0860063 Test Loss: 0.0891141
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0660993
	speed: 0.0924s/iter; left time: 1066.6538s
	iters: 200, epoch: 49 | loss: 0.0729448
	speed: 0.0520s/iter; left time: 595.6376s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:11.83s
Steps: 224 | Train Loss: 0.0687500 Vali Loss: 0.0861000 Test Loss: 0.0891243
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0677664
	speed: 0.0920s/iter; left time: 1041.5790s
	iters: 200, epoch: 50 | loss: 0.0669769
	speed: 0.0520s/iter; left time: 584.2153s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:11.87s
Steps: 224 | Train Loss: 0.0687967 Vali Loss: 0.0861120 Test Loss: 0.0891771
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_336_24_DE_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02123580500483513, rmse:0.1457251012325287, mae:0.08906044065952301, rse:0.514284074306488
Intermediate time for DE and pred_len 24: 00h:22m:10.43s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1454190
	speed: 0.1060s/iter; left time: 2343.0393s
	iters: 200, epoch: 1 | loss: 0.1458661
	speed: 0.0810s/iter; left time: 1782.5835s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.46s
Steps: 222 | Train Loss: 0.1548092 Vali Loss: 0.1579965 Test Loss: 0.1693504
Validation loss decreased (inf --> 0.157997).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1108921
	speed: 0.1399s/iter; left time: 3061.5215s
	iters: 200, epoch: 2 | loss: 0.1092338
	speed: 0.0808s/iter; left time: 1758.6992s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.1152091 Vali Loss: 0.1214901 Test Loss: 0.1276618
Validation loss decreased (0.157997 --> 0.121490).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1038423
	speed: 0.1501s/iter; left time: 3251.0604s
	iters: 200, epoch: 3 | loss: 0.1005785
	speed: 0.0808s/iter; left time: 1742.5413s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.1043968 Vali Loss: 0.1193286 Test Loss: 0.1262590
Validation loss decreased (0.121490 --> 0.119329).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1001219
	speed: 0.1419s/iter; left time: 3042.1401s
	iters: 200, epoch: 4 | loss: 0.1055598
	speed: 0.0809s/iter; left time: 1725.6153s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.18s
Steps: 222 | Train Loss: 0.1018228 Vali Loss: 0.1181283 Test Loss: 0.1252880
Validation loss decreased (0.119329 --> 0.118128).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0935889
	speed: 0.1394s/iter; left time: 2956.1491s
	iters: 200, epoch: 5 | loss: 0.1000896
	speed: 0.0809s/iter; left time: 1707.1809s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.1001162 Vali Loss: 0.1181318 Test Loss: 0.1253805
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0993517
	speed: 0.1377s/iter; left time: 2891.3916s
	iters: 200, epoch: 6 | loss: 0.1011612
	speed: 0.0807s/iter; left time: 1685.7866s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.11s
Steps: 222 | Train Loss: 0.0986901 Vali Loss: 0.1178792 Test Loss: 0.1254846
Validation loss decreased (0.118128 --> 0.117879).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1014253
	speed: 0.1398s/iter; left time: 2903.2043s
	iters: 200, epoch: 7 | loss: 0.0973408
	speed: 0.0807s/iter; left time: 1668.1575s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.12s
Steps: 222 | Train Loss: 0.0973229 Vali Loss: 0.1176305 Test Loss: 0.1256454
Validation loss decreased (0.117879 --> 0.117631).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0960878
	speed: 0.1392s/iter; left time: 2860.8441s
	iters: 200, epoch: 8 | loss: 0.0905648
	speed: 0.0808s/iter; left time: 1651.1960s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.13s
Steps: 222 | Train Loss: 0.0960914 Vali Loss: 0.1177847 Test Loss: 0.1265147
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0934249
	speed: 0.1380s/iter; left time: 2805.6270s
	iters: 200, epoch: 9 | loss: 0.0898847
	speed: 0.0809s/iter; left time: 1635.9969s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0949588 Vali Loss: 0.1184804 Test Loss: 0.1269547
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0914064
	speed: 0.1383s/iter; left time: 2779.6687s
	iters: 200, epoch: 10 | loss: 0.0934437
	speed: 0.0809s/iter; left time: 1618.4008s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.14s
Steps: 222 | Train Loss: 0.0937266 Vali Loss: 0.1183242 Test Loss: 0.1279009
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0910332
	speed: 0.1389s/iter; left time: 2761.5205s
	iters: 200, epoch: 11 | loss: 0.0906390
	speed: 0.0808s/iter; left time: 1598.1977s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.0926955 Vali Loss: 0.1190470 Test Loss: 0.1288897
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0865961
	speed: 0.1382s/iter; left time: 2716.9350s
	iters: 200, epoch: 12 | loss: 0.0923659
	speed: 0.0808s/iter; left time: 1580.6632s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.0917330 Vali Loss: 0.1193468 Test Loss: 0.1290237
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0886916
	speed: 0.1380s/iter; left time: 2682.3713s
	iters: 200, epoch: 13 | loss: 0.0926560
	speed: 0.0809s/iter; left time: 1563.7415s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0908295 Vali Loss: 0.1193039 Test Loss: 0.1281978
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0902207
	speed: 0.1387s/iter; left time: 2665.8168s
	iters: 200, epoch: 14 | loss: 0.0890490
	speed: 0.0808s/iter; left time: 1544.2139s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.0901019 Vali Loss: 0.1200060 Test Loss: 0.1297680
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0905493
	speed: 0.1390s/iter; left time: 2640.8043s
	iters: 200, epoch: 15 | loss: 0.0844494
	speed: 0.0808s/iter; left time: 1526.3635s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0892479 Vali Loss: 0.1205788 Test Loss: 0.1293451
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0887716
	speed: 0.1386s/iter; left time: 2600.8186s
	iters: 200, epoch: 16 | loss: 0.0878107
	speed: 0.0809s/iter; left time: 1509.6764s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:18.14s
Steps: 222 | Train Loss: 0.0886576 Vali Loss: 0.1206160 Test Loss: 0.1295768
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0838581
	speed: 0.1381s/iter; left time: 2560.9219s
	iters: 200, epoch: 17 | loss: 0.0864668
	speed: 0.0809s/iter; left time: 1493.3621s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:18.12s
Steps: 222 | Train Loss: 0.0880864 Vali Loss: 0.1208832 Test Loss: 0.1299632
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03595266863703728, rmse:0.18961189687252045, mae:0.12564539909362793, rse:0.6714540719985962
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1529302
	speed: 0.0823s/iter; left time: 1819.1837s
	iters: 200, epoch: 1 | loss: 0.1456952
	speed: 0.0807s/iter; left time: 1775.4831s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.13s
Steps: 222 | Train Loss: 0.1547636 Vali Loss: 0.1578183 Test Loss: 0.1693984
Validation loss decreased (inf --> 0.157818).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1156026
	speed: 0.1422s/iter; left time: 3110.5332s
	iters: 200, epoch: 2 | loss: 0.1080172
	speed: 0.0806s/iter; left time: 1756.3528s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.1157705 Vali Loss: 0.1214437 Test Loss: 0.1283181
Validation loss decreased (0.157818 --> 0.121444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1046785
	speed: 0.1411s/iter; left time: 3055.6022s
	iters: 200, epoch: 3 | loss: 0.1011220
	speed: 0.0808s/iter; left time: 1741.9018s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.19s
Steps: 222 | Train Loss: 0.1044551 Vali Loss: 0.1195383 Test Loss: 0.1268237
Validation loss decreased (0.121444 --> 0.119538).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0991604
	speed: 0.1420s/iter; left time: 3042.9044s
	iters: 200, epoch: 4 | loss: 0.0966208
	speed: 0.0807s/iter; left time: 1722.6233s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.20s
Steps: 222 | Train Loss: 0.1019964 Vali Loss: 0.1182762 Test Loss: 0.1255367
Validation loss decreased (0.119538 --> 0.118276).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0979637
	speed: 0.1461s/iter; left time: 3099.3415s
	iters: 200, epoch: 5 | loss: 0.0931982
	speed: 0.0807s/iter; left time: 1704.6328s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.22s
Steps: 222 | Train Loss: 0.1001509 Vali Loss: 0.1182702 Test Loss: 0.1250817
Validation loss decreased (0.118276 --> 0.118270).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1015567
	speed: 0.1399s/iter; left time: 2936.0198s
	iters: 200, epoch: 6 | loss: 0.0909793
	speed: 0.0807s/iter; left time: 1686.2146s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0985937 Vali Loss: 0.1180413 Test Loss: 0.1251034
Validation loss decreased (0.118270 --> 0.118041).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0943053
	speed: 0.1410s/iter; left time: 2928.7755s
	iters: 200, epoch: 7 | loss: 0.0968980
	speed: 0.0808s/iter; left time: 1669.9386s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.21s
Steps: 222 | Train Loss: 0.0970384 Vali Loss: 0.1180715 Test Loss: 0.1261100
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0952572
	speed: 0.1399s/iter; left time: 2875.3100s
	iters: 200, epoch: 8 | loss: 0.0973560
	speed: 0.0812s/iter; left time: 1659.3842s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.21s
Steps: 222 | Train Loss: 0.0955456 Vali Loss: 0.1184433 Test Loss: 0.1263607
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0947614
	speed: 0.1394s/iter; left time: 2833.1742s
	iters: 200, epoch: 9 | loss: 0.0937324
	speed: 0.0808s/iter; left time: 1633.9594s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.0941390 Vali Loss: 0.1191633 Test Loss: 0.1275874
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0920048
	speed: 0.1395s/iter; left time: 2803.6539s
	iters: 200, epoch: 10 | loss: 0.0914769
	speed: 0.0809s/iter; left time: 1618.9445s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.19s
Steps: 222 | Train Loss: 0.0928133 Vali Loss: 0.1188206 Test Loss: 0.1281140
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0923302
	speed: 0.1401s/iter; left time: 2784.9030s
	iters: 200, epoch: 11 | loss: 0.0908889
	speed: 0.0807s/iter; left time: 1596.5115s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.19s
Steps: 222 | Train Loss: 0.0917612 Vali Loss: 0.1195217 Test Loss: 0.1288757
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0973572
	speed: 0.1393s/iter; left time: 2737.8168s
	iters: 200, epoch: 12 | loss: 0.0875574
	speed: 0.0807s/iter; left time: 1578.6173s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0908663 Vali Loss: 0.1199547 Test Loss: 0.1287506
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0962057
	speed: 0.1405s/iter; left time: 2731.7486s
	iters: 200, epoch: 13 | loss: 0.0874106
	speed: 0.0806s/iter; left time: 1559.4325s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.0899556 Vali Loss: 0.1201837 Test Loss: 0.1298474
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0878442
	speed: 0.1396s/iter; left time: 2682.5639s
	iters: 200, epoch: 14 | loss: 0.0867968
	speed: 0.0808s/iter; left time: 1544.1649s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.0893488 Vali Loss: 0.1203016 Test Loss: 0.1307302
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0855336
	speed: 0.1405s/iter; left time: 2668.3176s
	iters: 200, epoch: 15 | loss: 0.0859972
	speed: 0.0809s/iter; left time: 1528.1479s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.20s
Steps: 222 | Train Loss: 0.0885958 Vali Loss: 0.1204547 Test Loss: 0.1307303
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0880300
	speed: 0.1401s/iter; left time: 2629.8427s
	iters: 200, epoch: 16 | loss: 0.0898835
	speed: 0.0809s/iter; left time: 1509.6834s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:18.21s
Steps: 222 | Train Loss: 0.0880733 Vali Loss: 0.1205709 Test Loss: 0.1303698
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_DE_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0352337621152401, rmse:0.1877065896987915, mae:0.1251034140586853, rse:0.6647070050239563
Intermediate time for DE and pred_len 96: 00h:12m:23.95s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1567775
	speed: 0.1087s/iter; left time: 2401.5694s
	iters: 200, epoch: 1 | loss: 0.1513248
	speed: 0.0813s/iter; left time: 1789.1971s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.51s
Steps: 222 | Train Loss: 0.1564996 Vali Loss: 0.1594110 Test Loss: 0.1722484
Validation loss decreased (inf --> 0.159411).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1169308
	speed: 0.1407s/iter; left time: 3077.4090s
	iters: 200, epoch: 2 | loss: 0.1121136
	speed: 0.0813s/iter; left time: 1770.5342s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.1197778 Vali Loss: 0.1248173 Test Loss: 0.1331121
Validation loss decreased (0.159411 --> 0.124817).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1040951
	speed: 0.1408s/iter; left time: 3048.7281s
	iters: 200, epoch: 3 | loss: 0.1140926
	speed: 0.0813s/iter; left time: 1752.5344s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.27s
Steps: 222 | Train Loss: 0.1098576 Vali Loss: 0.1228079 Test Loss: 0.1325458
Validation loss decreased (0.124817 --> 0.122808).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1032582
	speed: 0.1414s/iter; left time: 3030.1456s
	iters: 200, epoch: 4 | loss: 0.1121941
	speed: 0.0816s/iter; left time: 1740.1548s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.32s
Steps: 222 | Train Loss: 0.1072469 Vali Loss: 0.1222584 Test Loss: 0.1313323
Validation loss decreased (0.122808 --> 0.122258).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1076371
	speed: 0.1408s/iter; left time: 2987.7798s
	iters: 200, epoch: 5 | loss: 0.1119657
	speed: 0.0813s/iter; left time: 1717.2104s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.27s
Steps: 222 | Train Loss: 0.1051176 Vali Loss: 0.1217997 Test Loss: 0.1318150
Validation loss decreased (0.122258 --> 0.121800).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1028062
	speed: 0.1410s/iter; left time: 2958.8591s
	iters: 200, epoch: 6 | loss: 0.1075840
	speed: 0.0814s/iter; left time: 1701.0314s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.1031791 Vali Loss: 0.1216158 Test Loss: 0.1321796
Validation loss decreased (0.121800 --> 0.121616).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1020667
	speed: 0.1414s/iter; left time: 2936.5526s
	iters: 200, epoch: 7 | loss: 0.0999745
	speed: 0.0814s/iter; left time: 1683.4031s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.1012984 Vali Loss: 0.1222705 Test Loss: 0.1328824
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1024710
	speed: 0.1410s/iter; left time: 2896.9789s
	iters: 200, epoch: 8 | loss: 0.1013188
	speed: 0.0814s/iter; left time: 1664.7842s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0996514 Vali Loss: 0.1231942 Test Loss: 0.1332751
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1011731
	speed: 0.1396s/iter; left time: 2838.1328s
	iters: 200, epoch: 9 | loss: 0.0969350
	speed: 0.0814s/iter; left time: 1645.3640s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.26s
Steps: 222 | Train Loss: 0.0980915 Vali Loss: 0.1237174 Test Loss: 0.1340225
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0941293
	speed: 0.1408s/iter; left time: 2830.0382s
	iters: 200, epoch: 10 | loss: 0.0965152
	speed: 0.0814s/iter; left time: 1627.4495s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0967392 Vali Loss: 0.1234175 Test Loss: 0.1346313
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0937904
	speed: 0.1406s/iter; left time: 2794.5166s
	iters: 200, epoch: 11 | loss: 0.0946716
	speed: 0.0812s/iter; left time: 1606.5533s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0955147 Vali Loss: 0.1240949 Test Loss: 0.1351768
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0918052
	speed: 0.1399s/iter; left time: 2749.6484s
	iters: 200, epoch: 12 | loss: 0.0966095
	speed: 0.0811s/iter; left time: 1586.5761s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.27s
Steps: 222 | Train Loss: 0.0943976 Vali Loss: 0.1244152 Test Loss: 0.1353770
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0908815
	speed: 0.1399s/iter; left time: 2719.8300s
	iters: 200, epoch: 13 | loss: 0.0946134
	speed: 0.0815s/iter; left time: 1576.4029s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.30s
Steps: 222 | Train Loss: 0.0934874 Vali Loss: 0.1243682 Test Loss: 0.1359254
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0948062
	speed: 0.1404s/iter; left time: 2698.6876s
	iters: 200, epoch: 14 | loss: 0.0925005
	speed: 0.0813s/iter; left time: 1553.5215s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.27s
Steps: 222 | Train Loss: 0.0926105 Vali Loss: 0.1244345 Test Loss: 0.1361633
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0930774
	speed: 0.1415s/iter; left time: 2688.0997s
	iters: 200, epoch: 15 | loss: 0.0914964
	speed: 0.0813s/iter; left time: 1535.2321s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.30s
Steps: 222 | Train Loss: 0.0918648 Vali Loss: 0.1247319 Test Loss: 0.1368228
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0891043
	speed: 0.1399s/iter; left time: 2625.6884s
	iters: 200, epoch: 16 | loss: 0.0967203
	speed: 0.0812s/iter; left time: 1516.9319s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:18.25s
Steps: 222 | Train Loss: 0.0910989 Vali Loss: 0.1251153 Test Loss: 0.1371230
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03817787021398544, rmse:0.19539158046245575, mae:0.13217949867248535, rse:0.6920927166938782
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1584320
	speed: 0.0829s/iter; left time: 1832.6007s
	iters: 200, epoch: 1 | loss: 0.1539989
	speed: 0.0812s/iter; left time: 1786.4277s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.25s
Steps: 222 | Train Loss: 0.1572925 Vali Loss: 0.1603549 Test Loss: 0.1732188
Validation loss decreased (inf --> 0.160355).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1229231
	speed: 0.1451s/iter; left time: 3175.2502s
	iters: 200, epoch: 2 | loss: 0.1093951
	speed: 0.0813s/iter; left time: 1771.2960s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.1213124 Vali Loss: 0.1254657 Test Loss: 0.1345205
Validation loss decreased (0.160355 --> 0.125466).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1082131
	speed: 0.1441s/iter; left time: 3120.6045s
	iters: 200, epoch: 3 | loss: 0.1081986
	speed: 0.0813s/iter; left time: 1753.1902s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.33s
Steps: 222 | Train Loss: 0.1101862 Vali Loss: 0.1233200 Test Loss: 0.1328761
Validation loss decreased (0.125466 --> 0.123320).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1075606
	speed: 0.1422s/iter; left time: 3047.8200s
	iters: 200, epoch: 4 | loss: 0.1056124
	speed: 0.0812s/iter; left time: 1732.5695s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.25s
Steps: 222 | Train Loss: 0.1071764 Vali Loss: 0.1220768 Test Loss: 0.1326651
Validation loss decreased (0.123320 --> 0.122077).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1011877
	speed: 0.1426s/iter; left time: 3024.5506s
	iters: 200, epoch: 5 | loss: 0.1052904
	speed: 0.0814s/iter; left time: 1717.5602s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.1050479 Vali Loss: 0.1229597 Test Loss: 0.1319391
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1010514
	speed: 0.1400s/iter; left time: 2939.7290s
	iters: 200, epoch: 6 | loss: 0.1084885
	speed: 0.0813s/iter; left time: 1699.2967s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.28s
Steps: 222 | Train Loss: 0.1031179 Vali Loss: 0.1229192 Test Loss: 0.1332220
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1013987
	speed: 0.1416s/iter; left time: 2940.6401s
	iters: 200, epoch: 7 | loss: 0.1027911
	speed: 0.0813s/iter; left time: 1681.0609s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.33s
Steps: 222 | Train Loss: 0.1015164 Vali Loss: 0.1232137 Test Loss: 0.1343062
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0949016
	speed: 0.1407s/iter; left time: 2891.6230s
	iters: 200, epoch: 8 | loss: 0.1015967
	speed: 0.0813s/iter; left time: 1662.8910s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.0998196 Vali Loss: 0.1241509 Test Loss: 0.1345583
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0980298
	speed: 0.1413s/iter; left time: 2871.6177s
	iters: 200, epoch: 9 | loss: 0.0990568
	speed: 0.0814s/iter; left time: 1645.9629s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.32s
Steps: 222 | Train Loss: 0.0983526 Vali Loss: 0.1248584 Test Loss: 0.1345823
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0965817
	speed: 0.1408s/iter; left time: 2829.6648s
	iters: 200, epoch: 10 | loss: 0.0910069
	speed: 0.0813s/iter; left time: 1625.7889s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.0969771 Vali Loss: 0.1248797 Test Loss: 0.1352504
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0921308
	speed: 0.1422s/iter; left time: 2826.9040s
	iters: 200, epoch: 11 | loss: 0.0946201
	speed: 0.0815s/iter; left time: 1611.3782s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.39s
Steps: 222 | Train Loss: 0.0957095 Vali Loss: 0.1254821 Test Loss: 0.1363082
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0953712
	speed: 0.1419s/iter; left time: 2790.2231s
	iters: 200, epoch: 12 | loss: 0.0938992
	speed: 0.0815s/iter; left time: 1594.4512s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.36s
Steps: 222 | Train Loss: 0.0945926 Vali Loss: 0.1264368 Test Loss: 0.1374227
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0939670
	speed: 0.1418s/iter; left time: 2756.9232s
	iters: 200, epoch: 13 | loss: 0.0957235
	speed: 0.0817s/iter; left time: 1579.5557s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.31s
Steps: 222 | Train Loss: 0.0935417 Vali Loss: 0.1268010 Test Loss: 0.1383561
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0911809
	speed: 0.1416s/iter; left time: 2720.8860s
	iters: 200, epoch: 14 | loss: 0.0954952
	speed: 0.0814s/iter; left time: 1556.4209s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0926690 Vali Loss: 0.1271380 Test Loss: 0.1381323
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_DE_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03783639147877693, rmse:0.19451579451560974, mae:0.1326650083065033, rse:0.688990592956543
Intermediate time for DE and pred_len 168: 00h:11m:24.64sIntermediate time for DE: 00h:45m:59.02s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_24_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1348483
	speed: 0.1062s/iter; left time: 2357.5424s
	iters: 200, epoch: 1 | loss: 0.1235475
	speed: 0.0804s/iter; left time: 1777.8606s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.41s
Steps: 223 | Train Loss: 0.1346395 Vali Loss: 0.1334999 Test Loss: 0.1537496
Validation loss decreased (inf --> 0.133500).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0891610
	speed: 0.1383s/iter; left time: 3038.5504s
	iters: 200, epoch: 2 | loss: 0.0834034
	speed: 0.0801s/iter; left time: 1753.2917s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.07s
Steps: 223 | Train Loss: 0.0898294 Vali Loss: 0.0928724 Test Loss: 0.1040984
Validation loss decreased (0.133500 --> 0.092872).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0818716
	speed: 0.1388s/iter; left time: 3019.7473s
	iters: 200, epoch: 3 | loss: 0.0716305
	speed: 0.0803s/iter; left time: 1738.2825s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0784626 Vali Loss: 0.0912489 Test Loss: 0.1033492
Validation loss decreased (0.092872 --> 0.091249).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0787505
	speed: 0.1394s/iter; left time: 3001.9322s
	iters: 200, epoch: 4 | loss: 0.0758759
	speed: 0.0802s/iter; left time: 1719.4297s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0766306 Vali Loss: 0.0901929 Test Loss: 0.1032344
Validation loss decreased (0.091249 --> 0.090193).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0788459
	speed: 0.1387s/iter; left time: 2955.4293s
	iters: 200, epoch: 5 | loss: 0.0738315
	speed: 0.0802s/iter; left time: 1700.6017s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0755506 Vali Loss: 0.0901071 Test Loss: 0.1029200
Validation loss decreased (0.090193 --> 0.090107).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0759309
	speed: 0.1395s/iter; left time: 2941.6222s
	iters: 200, epoch: 6 | loss: 0.0739040
	speed: 0.0803s/iter; left time: 1684.1430s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.16s
Steps: 223 | Train Loss: 0.0746222 Vali Loss: 0.0896171 Test Loss: 0.1028844
Validation loss decreased (0.090107 --> 0.089617).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0724300
	speed: 0.1397s/iter; left time: 2913.8349s
	iters: 200, epoch: 7 | loss: 0.0740469
	speed: 0.0802s/iter; left time: 1665.8637s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.19s
Steps: 223 | Train Loss: 0.0740470 Vali Loss: 0.0890901 Test Loss: 0.1023908
Validation loss decreased (0.089617 --> 0.089090).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0761165
	speed: 0.1392s/iter; left time: 2873.1964s
	iters: 200, epoch: 8 | loss: 0.0689072
	speed: 0.0802s/iter; left time: 1647.2821s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0734278 Vali Loss: 0.0891402 Test Loss: 0.1023248
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0715905
	speed: 0.1382s/iter; left time: 2821.7113s
	iters: 200, epoch: 9 | loss: 0.0787396
	speed: 0.0803s/iter; left time: 1630.8478s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.11s
Steps: 223 | Train Loss: 0.0729763 Vali Loss: 0.0887639 Test Loss: 0.1022937
Validation loss decreased (0.089090 --> 0.088764).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0738042
	speed: 0.1395s/iter; left time: 2816.8249s
	iters: 200, epoch: 10 | loss: 0.0750337
	speed: 0.0804s/iter; left time: 1614.8759s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.17s
Steps: 223 | Train Loss: 0.0725319 Vali Loss: 0.0888586 Test Loss: 0.1019429
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0752971
	speed: 0.1385s/iter; left time: 2766.3056s
	iters: 200, epoch: 11 | loss: 0.0718730
	speed: 0.0804s/iter; left time: 1598.3852s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.18s
Steps: 223 | Train Loss: 0.0722108 Vali Loss: 0.0887466 Test Loss: 0.1020114
Validation loss decreased (0.088764 --> 0.088747).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0683566
	speed: 0.1395s/iter; left time: 2755.8191s
	iters: 200, epoch: 12 | loss: 0.0716865
	speed: 0.0803s/iter; left time: 1576.7561s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0718465 Vali Loss: 0.0886935 Test Loss: 0.1024904
Validation loss decreased (0.088747 --> 0.088694).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0749665
	speed: 0.1396s/iter; left time: 2726.3606s
	iters: 200, epoch: 13 | loss: 0.0728019
	speed: 0.0802s/iter; left time: 1558.2728s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0715018 Vali Loss: 0.0887555 Test Loss: 0.1022899
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0727171
	speed: 0.1387s/iter; left time: 2676.8611s
	iters: 200, epoch: 14 | loss: 0.0698338
	speed: 0.0802s/iter; left time: 1540.0526s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.13s
Steps: 223 | Train Loss: 0.0712557 Vali Loss: 0.0884080 Test Loss: 0.1021220
Validation loss decreased (0.088694 --> 0.088408).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0738606
	speed: 0.1397s/iter; left time: 2665.5034s
	iters: 200, epoch: 15 | loss: 0.0688558
	speed: 0.0802s/iter; left time: 1522.7529s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0710802 Vali Loss: 0.0886561 Test Loss: 0.1022697
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0734921
	speed: 0.1387s/iter; left time: 2616.1925s
	iters: 200, epoch: 16 | loss: 0.0693150
	speed: 0.0802s/iter; left time: 1505.0634s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0707799 Vali Loss: 0.0886526 Test Loss: 0.1023837
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0721558
	speed: 0.1386s/iter; left time: 2583.4339s
	iters: 200, epoch: 17 | loss: 0.0740197
	speed: 0.0803s/iter; left time: 1487.3542s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0706303 Vali Loss: 0.0882642 Test Loss: 0.1022535
Validation loss decreased (0.088408 --> 0.088264).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0711871
	speed: 0.1388s/iter; left time: 2555.7726s
	iters: 200, epoch: 18 | loss: 0.0816860
	speed: 0.0802s/iter; left time: 1469.2084s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:18.11s
Steps: 223 | Train Loss: 0.0703854 Vali Loss: 0.0883601 Test Loss: 0.1020565
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0741602
	speed: 0.1383s/iter; left time: 2515.3679s
	iters: 200, epoch: 19 | loss: 0.0713896
	speed: 0.0802s/iter; left time: 1451.1069s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:18.17s
Steps: 223 | Train Loss: 0.0702685 Vali Loss: 0.0881388 Test Loss: 0.1022986
Validation loss decreased (0.088264 --> 0.088139).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0719018
	speed: 0.1403s/iter; left time: 2520.0933s
	iters: 200, epoch: 20 | loss: 0.0690474
	speed: 0.0802s/iter; left time: 1433.5442s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:18.16s
Steps: 223 | Train Loss: 0.0700933 Vali Loss: 0.0881721 Test Loss: 0.1021070
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0712346
	speed: 0.1392s/iter; left time: 2470.4293s
	iters: 200, epoch: 21 | loss: 0.0659650
	speed: 0.0801s/iter; left time: 1413.2624s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:18.13s
Steps: 223 | Train Loss: 0.0699631 Vali Loss: 0.0881782 Test Loss: 0.1021644
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0652486
	speed: 0.1388s/iter; left time: 2431.3012s
	iters: 200, epoch: 22 | loss: 0.0682071
	speed: 0.0803s/iter; left time: 1399.0189s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:18.16s
Steps: 223 | Train Loss: 0.0698734 Vali Loss: 0.0880684 Test Loss: 0.1022999
Validation loss decreased (0.088139 --> 0.088068).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0746235
	speed: 0.1391s/iter; left time: 2406.4139s
	iters: 200, epoch: 23 | loss: 0.0693815
	speed: 0.0803s/iter; left time: 1380.4914s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0696701 Vali Loss: 0.0879686 Test Loss: 0.1021321
Validation loss decreased (0.088068 --> 0.087969).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0730705
	speed: 0.1390s/iter; left time: 2373.1870s
	iters: 200, epoch: 24 | loss: 0.0711131
	speed: 0.0803s/iter; left time: 1363.4513s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:18.16s
Steps: 223 | Train Loss: 0.0696299 Vali Loss: 0.0878839 Test Loss: 0.1022739
Validation loss decreased (0.087969 --> 0.087884).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0689954
	speed: 0.1394s/iter; left time: 2349.2926s
	iters: 200, epoch: 25 | loss: 0.0713015
	speed: 0.0802s/iter; left time: 1343.8483s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0695589 Vali Loss: 0.0881440 Test Loss: 0.1023520
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0637646
	speed: 0.1388s/iter; left time: 2307.1585s
	iters: 200, epoch: 26 | loss: 0.0662034
	speed: 0.0804s/iter; left time: 1328.7657s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:18.18s
Steps: 223 | Train Loss: 0.0695231 Vali Loss: 0.0880633 Test Loss: 0.1021806
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0698196
	speed: 0.1379s/iter; left time: 2261.5097s
	iters: 200, epoch: 27 | loss: 0.0658523
	speed: 0.0802s/iter; left time: 1308.2035s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0694681 Vali Loss: 0.0880745 Test Loss: 0.1022816
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0673808
	speed: 0.1387s/iter; left time: 2244.1304s
	iters: 200, epoch: 28 | loss: 0.0676038
	speed: 0.0802s/iter; left time: 1289.0261s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0692791 Vali Loss: 0.0880488 Test Loss: 0.1023436
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0751908
	speed: 0.1378s/iter; left time: 2199.1928s
	iters: 200, epoch: 29 | loss: 0.0731162
	speed: 0.0803s/iter; left time: 1273.4276s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:18.13s
Steps: 223 | Train Loss: 0.0692822 Vali Loss: 0.0880311 Test Loss: 0.1022699
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0660743
	speed: 0.1380s/iter; left time: 2171.2260s
	iters: 200, epoch: 30 | loss: 0.0733489
	speed: 0.0796s/iter; left time: 1244.4959s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:18.06s
Steps: 223 | Train Loss: 0.0692286 Vali Loss: 0.0880953 Test Loss: 0.1023546
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0704500
	speed: 0.1379s/iter; left time: 2138.8533s
	iters: 200, epoch: 31 | loss: 0.0656725
	speed: 0.0801s/iter; left time: 1234.0000s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:18.07s
Steps: 223 | Train Loss: 0.0691443 Vali Loss: 0.0880416 Test Loss: 0.1022984
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0761222
	speed: 0.1380s/iter; left time: 2109.0803s
	iters: 200, epoch: 32 | loss: 0.0687318
	speed: 0.0801s/iter; left time: 1216.4699s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:18.07s
Steps: 223 | Train Loss: 0.0690752 Vali Loss: 0.0879020 Test Loss: 0.1023048
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0661833
	speed: 0.1376s/iter; left time: 2072.8011s
	iters: 200, epoch: 33 | loss: 0.0732448
	speed: 0.0801s/iter; left time: 1198.5257s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.0690798 Vali Loss: 0.0878879 Test Loss: 0.1023647
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0719190
	speed: 0.1375s/iter; left time: 2040.4420s
	iters: 200, epoch: 34 | loss: 0.0688583
	speed: 0.0805s/iter; left time: 1187.4551s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0690935 Vali Loss: 0.0880725 Test Loss: 0.1024172
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025716405361890793, rmse:0.1603633612394333, mae:0.10227393358945847, rse:0.5532081127166748
Use GPU: cuda:0
>>>>>>>start training : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1366708
	speed: 0.0817s/iter; left time: 1813.9799s
	iters: 200, epoch: 1 | loss: 0.1241749
	speed: 0.0801s/iter; left time: 1770.3639s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.1342851 Vali Loss: 0.1348039 Test Loss: 0.1549900
Validation loss decreased (inf --> 0.134804).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0886100
	speed: 0.1390s/iter; left time: 3054.6923s
	iters: 200, epoch: 2 | loss: 0.0809548
	speed: 0.0797s/iter; left time: 1743.9849s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.04s
Steps: 223 | Train Loss: 0.0914494 Vali Loss: 0.0932200 Test Loss: 0.1052101
Validation loss decreased (0.134804 --> 0.093220).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0700615
	speed: 0.1392s/iter; left time: 3028.0525s
	iters: 200, epoch: 3 | loss: 0.0744769
	speed: 0.0801s/iter; left time: 1733.6061s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.17s
Steps: 223 | Train Loss: 0.0786488 Vali Loss: 0.0908873 Test Loss: 0.1033789
Validation loss decreased (0.093220 --> 0.090887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0741743
	speed: 0.1380s/iter; left time: 2972.0448s
	iters: 200, epoch: 4 | loss: 0.0743613
	speed: 0.0795s/iter; left time: 1704.8270s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:17.96s
Steps: 223 | Train Loss: 0.0766186 Vali Loss: 0.0908253 Test Loss: 0.1032803
Validation loss decreased (0.090887 --> 0.090825).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0684796
	speed: 0.1381s/iter; left time: 2941.8794s
	iters: 200, epoch: 5 | loss: 0.0779562
	speed: 0.0799s/iter; left time: 1694.7403s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.02s
Steps: 223 | Train Loss: 0.0753809 Vali Loss: 0.0893297 Test Loss: 0.1028940
Validation loss decreased (0.090825 --> 0.089330).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0696775
	speed: 0.1389s/iter; left time: 2927.9471s
	iters: 200, epoch: 6 | loss: 0.0745337
	speed: 0.0800s/iter; left time: 1679.3151s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.07s
Steps: 223 | Train Loss: 0.0745349 Vali Loss: 0.0894449 Test Loss: 0.1024341
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0785604
	speed: 0.1381s/iter; left time: 2880.6686s
	iters: 200, epoch: 7 | loss: 0.0679719
	speed: 0.0800s/iter; left time: 1660.8839s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.09s
Steps: 223 | Train Loss: 0.0739043 Vali Loss: 0.0892957 Test Loss: 0.1023731
Validation loss decreased (0.089330 --> 0.089296).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0774263
	speed: 0.1385s/iter; left time: 2859.5245s
	iters: 200, epoch: 8 | loss: 0.0668307
	speed: 0.0801s/iter; left time: 1645.6765s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0733547 Vali Loss: 0.0889244 Test Loss: 0.1024472
Validation loss decreased (0.089296 --> 0.088924).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0746945
	speed: 0.1387s/iter; left time: 2831.6787s
	iters: 200, epoch: 9 | loss: 0.0714779
	speed: 0.0800s/iter; left time: 1626.1900s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.0729554 Vali Loss: 0.0887235 Test Loss: 0.1022474
Validation loss decreased (0.088924 --> 0.088724).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0718831
	speed: 0.1401s/iter; left time: 2829.1447s
	iters: 200, epoch: 10 | loss: 0.0704201
	speed: 0.0800s/iter; left time: 1607.2016s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.21s
Steps: 223 | Train Loss: 0.0724501 Vali Loss: 0.0885421 Test Loss: 0.1020218
Validation loss decreased (0.088724 --> 0.088542).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0733186
	speed: 0.1394s/iter; left time: 2784.5216s
	iters: 200, epoch: 11 | loss: 0.0735558
	speed: 0.0800s/iter; left time: 1588.9534s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0721375 Vali Loss: 0.0884050 Test Loss: 0.1017645
Validation loss decreased (0.088542 --> 0.088405).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0722721
	speed: 0.1382s/iter; left time: 2728.4261s
	iters: 200, epoch: 12 | loss: 0.0696643
	speed: 0.0801s/iter; left time: 1573.6468s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.09s
Steps: 223 | Train Loss: 0.0718774 Vali Loss: 0.0883413 Test Loss: 0.1020326
Validation loss decreased (0.088405 --> 0.088341).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0729654
	speed: 0.1392s/iter; left time: 2716.9914s
	iters: 200, epoch: 13 | loss: 0.0749668
	speed: 0.0800s/iter; left time: 1553.0459s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.06s
Steps: 223 | Train Loss: 0.0715923 Vali Loss: 0.0884434 Test Loss: 0.1023562
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0688052
	speed: 0.1381s/iter; left time: 2666.1109s
	iters: 200, epoch: 14 | loss: 0.0697273
	speed: 0.0801s/iter; left time: 1538.4669s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0713526 Vali Loss: 0.0883750 Test Loss: 0.1020522
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0679391
	speed: 0.1384s/iter; left time: 2641.0054s
	iters: 200, epoch: 15 | loss: 0.0700785
	speed: 0.0801s/iter; left time: 1520.3210s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0710252 Vali Loss: 0.0881383 Test Loss: 0.1018744
Validation loss decreased (0.088341 --> 0.088138).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0715094
	speed: 0.1404s/iter; left time: 2646.9341s
	iters: 200, epoch: 16 | loss: 0.0719865
	speed: 0.0802s/iter; left time: 1503.9750s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:18.16s
Steps: 223 | Train Loss: 0.0708653 Vali Loss: 0.0879714 Test Loss: 0.1020792
Validation loss decreased (0.088138 --> 0.087971).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0748008
	speed: 0.1389s/iter; left time: 2588.8541s
	iters: 200, epoch: 17 | loss: 0.0705557
	speed: 0.0800s/iter; left time: 1481.7785s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.0707088 Vali Loss: 0.0880462 Test Loss: 0.1023607
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0679809
	speed: 0.1384s/iter; left time: 2547.2937s
	iters: 200, epoch: 18 | loss: 0.0725685
	speed: 0.0801s/iter; left time: 1466.1961s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0704286 Vali Loss: 0.0880920 Test Loss: 0.1020400
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0667965
	speed: 0.1383s/iter; left time: 2514.7743s
	iters: 200, epoch: 19 | loss: 0.0677409
	speed: 0.0801s/iter; left time: 1448.8163s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0702506 Vali Loss: 0.0880540 Test Loss: 0.1022111
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0685981
	speed: 0.1385s/iter; left time: 2487.7643s
	iters: 200, epoch: 20 | loss: 0.0648524
	speed: 0.0801s/iter; left time: 1431.3251s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0701828 Vali Loss: 0.0880403 Test Loss: 0.1022138
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0684365
	speed: 0.1380s/iter; left time: 2447.5438s
	iters: 200, epoch: 21 | loss: 0.0661878
	speed: 0.0799s/iter; left time: 1410.0784s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:18.03s
Steps: 223 | Train Loss: 0.0699923 Vali Loss: 0.0880152 Test Loss: 0.1020563
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0721140
	speed: 0.1389s/iter; left time: 2433.8766s
	iters: 200, epoch: 22 | loss: 0.0700619
	speed: 0.0801s/iter; left time: 1395.7775s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0698893 Vali Loss: 0.0880357 Test Loss: 0.1022364
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0723281
	speed: 0.1383s/iter; left time: 2391.6151s
	iters: 200, epoch: 23 | loss: 0.0717652
	speed: 0.0801s/iter; left time: 1376.6324s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.0697248 Vali Loss: 0.0880475 Test Loss: 0.1022223
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0668357
	speed: 0.1382s/iter; left time: 2358.5072s
	iters: 200, epoch: 24 | loss: 0.0756700
	speed: 0.0800s/iter; left time: 1358.2168s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:18.11s
Steps: 223 | Train Loss: 0.0696926 Vali Loss: 0.0879637 Test Loss: 0.1021364
Validation loss decreased (0.087971 --> 0.087964).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0724150
	speed: 0.1396s/iter; left time: 2352.7915s
	iters: 200, epoch: 25 | loss: 0.0723249
	speed: 0.0802s/iter; left time: 1343.0970s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0695450 Vali Loss: 0.0879783 Test Loss: 0.1022011
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0680662
	speed: 0.1386s/iter; left time: 2304.0037s
	iters: 200, epoch: 26 | loss: 0.0669919
	speed: 0.0802s/iter; left time: 1326.0343s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:18.13s
Steps: 223 | Train Loss: 0.0695108 Vali Loss: 0.0880587 Test Loss: 0.1021642
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0691096
	speed: 0.1388s/iter; left time: 2276.4538s
	iters: 200, epoch: 27 | loss: 0.0648874
	speed: 0.0801s/iter; left time: 1306.0938s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:18.13s
Steps: 223 | Train Loss: 0.0694146 Vali Loss: 0.0879691 Test Loss: 0.1022430
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0681378
	speed: 0.1389s/iter; left time: 2247.8991s
	iters: 200, epoch: 28 | loss: 0.0642104
	speed: 0.0801s/iter; left time: 1287.5123s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:18.11s
Steps: 223 | Train Loss: 0.0693545 Vali Loss: 0.0879410 Test Loss: 0.1022402
Validation loss decreased (0.087964 --> 0.087941).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0667084
	speed: 0.1392s/iter; left time: 2221.3044s
	iters: 200, epoch: 29 | loss: 0.0688164
	speed: 0.0801s/iter; left time: 1269.8224s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0693225 Vali Loss: 0.0880652 Test Loss: 0.1022794
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0681703
	speed: 0.1385s/iter; left time: 2178.9509s
	iters: 200, epoch: 30 | loss: 0.0693843
	speed: 0.0801s/iter; left time: 1252.3861s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:18.09s
Steps: 223 | Train Loss: 0.0692618 Vali Loss: 0.0880007 Test Loss: 0.1023244
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0670438
	speed: 0.1385s/iter; left time: 2148.6375s
	iters: 200, epoch: 31 | loss: 0.0717225
	speed: 0.0800s/iter; left time: 1233.0719s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:18.09s
Steps: 223 | Train Loss: 0.0691872 Vali Loss: 0.0879294 Test Loss: 0.1023856
Validation loss decreased (0.087941 --> 0.087929).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0682997
	speed: 0.1394s/iter; left time: 2131.2663s
	iters: 200, epoch: 32 | loss: 0.0684763
	speed: 0.0802s/iter; left time: 1217.3402s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0690877 Vali Loss: 0.0880422 Test Loss: 0.1023571
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0701336
	speed: 0.1382s/iter; left time: 2082.1144s
	iters: 200, epoch: 33 | loss: 0.0700182
	speed: 0.0802s/iter; left time: 1200.8834s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:18.14s
Steps: 223 | Train Loss: 0.0690832 Vali Loss: 0.0879702 Test Loss: 0.1022660
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0709029
	speed: 0.1384s/iter; left time: 2054.6799s
	iters: 200, epoch: 34 | loss: 0.0640473
	speed: 0.0802s/iter; left time: 1182.4620s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:18.11s
Steps: 223 | Train Loss: 0.0690259 Vali Loss: 0.0879758 Test Loss: 0.1023446
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0705968
	speed: 0.1383s/iter; left time: 2022.2637s
	iters: 200, epoch: 35 | loss: 0.0717035
	speed: 0.0800s/iter; left time: 1161.9997s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.0689972 Vali Loss: 0.0879484 Test Loss: 0.1023216
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0669579
	speed: 0.1385s/iter; left time: 1993.3011s
	iters: 200, epoch: 36 | loss: 0.0741236
	speed: 0.0801s/iter; left time: 1145.3677s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0689777 Vali Loss: 0.0880503 Test Loss: 0.1023325
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0677079
	speed: 0.1390s/iter; left time: 1970.0005s
	iters: 200, epoch: 37 | loss: 0.0674071
	speed: 0.0803s/iter; left time: 1129.7889s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:18.13s
Steps: 223 | Train Loss: 0.0689180 Vali Loss: 0.0880585 Test Loss: 0.1023927
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0700749
	speed: 0.1387s/iter; left time: 1934.5878s
	iters: 200, epoch: 38 | loss: 0.0709952
	speed: 0.0800s/iter; left time: 1108.6246s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0689011 Vali Loss: 0.0879418 Test Loss: 0.1023480
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0670714
	speed: 0.1392s/iter; left time: 1911.0750s
	iters: 200, epoch: 39 | loss: 0.0700057
	speed: 0.0801s/iter; left time: 1091.5956s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:18.15s
Steps: 223 | Train Loss: 0.0688655 Vali Loss: 0.0879522 Test Loss: 0.1023728
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0683985
	speed: 0.1385s/iter; left time: 1870.5270s
	iters: 200, epoch: 40 | loss: 0.0715017
	speed: 0.0801s/iter; left time: 1073.2453s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:18.11s
Steps: 223 | Train Loss: 0.0688567 Vali Loss: 0.0879054 Test Loss: 0.1023428
Validation loss decreased (0.087929 --> 0.087905).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0670869
	speed: 0.1408s/iter; left time: 1869.5676s
	iters: 200, epoch: 41 | loss: 0.0683611
	speed: 0.0801s/iter; left time: 1055.6140s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0688425 Vali Loss: 0.0879598 Test Loss: 0.1023723
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0749719
	speed: 0.1380s/iter; left time: 1802.5750s
	iters: 200, epoch: 42 | loss: 0.0689353
	speed: 0.0800s/iter; left time: 1036.3447s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:18.06s
Steps: 223 | Train Loss: 0.0687792 Vali Loss: 0.0879433 Test Loss: 0.1024432
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0679562
	speed: 0.1378s/iter; left time: 1768.9955s
	iters: 200, epoch: 43 | loss: 0.0753458
	speed: 0.0800s/iter; left time: 1019.3445s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:18.08s
Steps: 223 | Train Loss: 0.0688359 Vali Loss: 0.0879439 Test Loss: 0.1023748
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0721654
	speed: 0.1376s/iter; left time: 1736.0321s
	iters: 200, epoch: 44 | loss: 0.0668151
	speed: 0.0799s/iter; left time: 1000.2783s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:18.04s
Steps: 223 | Train Loss: 0.0687932 Vali Loss: 0.0879905 Test Loss: 0.1023978
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0727886
	speed: 0.1376s/iter; left time: 1704.9246s
	iters: 200, epoch: 45 | loss: 0.0697393
	speed: 0.0800s/iter; left time: 982.7047s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:18.06s
Steps: 223 | Train Loss: 0.0688187 Vali Loss: 0.0879540 Test Loss: 0.1023846
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0716208
	speed: 0.1375s/iter; left time: 1672.3700s
	iters: 200, epoch: 46 | loss: 0.0696595
	speed: 0.0799s/iter; left time: 963.9866s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:18.04s
Steps: 223 | Train Loss: 0.0687803 Vali Loss: 0.0879580 Test Loss: 0.1024324
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0673338
	speed: 0.1380s/iter; left time: 1648.2307s
	iters: 200, epoch: 47 | loss: 0.0685025
	speed: 0.0799s/iter; left time: 946.1059s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:18.07s
Steps: 223 | Train Loss: 0.0687667 Vali Loss: 0.0880418 Test Loss: 0.1024176
EarlyStopping counter: 7 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0642225
	speed: 0.1379s/iter; left time: 1616.3080s
	iters: 200, epoch: 48 | loss: 0.0709631
	speed: 0.0800s/iter; left time: 929.8183s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:18.07s
Steps: 223 | Train Loss: 0.0687600 Vali Loss: 0.0879649 Test Loss: 0.1024027
EarlyStopping counter: 8 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0651251
	speed: 0.1385s/iter; left time: 1592.5670s
	iters: 200, epoch: 49 | loss: 0.0700690
	speed: 0.0800s/iter; left time: 911.5588s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:18.10s
Steps: 223 | Train Loss: 0.0687423 Vali Loss: 0.0880024 Test Loss: 0.1024056
EarlyStopping counter: 9 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0694808
	speed: 0.1386s/iter; left time: 1562.3954s
	iters: 200, epoch: 50 | loss: 0.0728666
	speed: 0.0801s/iter; left time: 895.3182s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:18.12s
Steps: 223 | Train Loss: 0.0687120 Vali Loss: 0.0880527 Test Loss: 0.1024245
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_24_GB_PatchTST_custom_ftM_sl512_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025694113224744797, rmse:0.1602938324213028, mae:0.10234277695417404, rse:0.5529683232307434
Intermediate time for GB and pred_len 24: 00h:30m:52.65s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_96_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1358091
	speed: 0.1060s/iter; left time: 2342.1521s
	iters: 200, epoch: 1 | loss: 0.1349047
	speed: 0.0807s/iter; left time: 1775.8625s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.37s
Steps: 222 | Train Loss: 0.1414604 Vali Loss: 0.1448565 Test Loss: 0.1698220
Validation loss decreased (inf --> 0.144856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1088362
	speed: 0.1409s/iter; left time: 3082.2045s
	iters: 200, epoch: 2 | loss: 0.1076481
	speed: 0.0808s/iter; left time: 1759.2820s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.1105519 Vali Loss: 0.1171972 Test Loss: 0.1389077
Validation loss decreased (0.144856 --> 0.117197).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0983290
	speed: 0.1403s/iter; left time: 3038.4772s
	iters: 200, epoch: 3 | loss: 0.1036651
	speed: 0.0807s/iter; left time: 1740.3287s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.19s
Steps: 222 | Train Loss: 0.1017730 Vali Loss: 0.1162336 Test Loss: 0.1390613
Validation loss decreased (0.117197 --> 0.116234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1023673
	speed: 0.1401s/iter; left time: 3002.8141s
	iters: 200, epoch: 4 | loss: 0.0994180
	speed: 0.0809s/iter; left time: 1726.7798s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.0996428 Vali Loss: 0.1154969 Test Loss: 0.1391144
Validation loss decreased (0.116234 --> 0.115497).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0971655
	speed: 0.1406s/iter; left time: 2982.7213s
	iters: 200, epoch: 5 | loss: 0.0963834
	speed: 0.0807s/iter; left time: 1702.8590s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0980626 Vali Loss: 0.1158063 Test Loss: 0.1411522
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0982594
	speed: 0.1378s/iter; left time: 2893.0686s
	iters: 200, epoch: 6 | loss: 0.0976275
	speed: 0.0806s/iter; left time: 1683.3708s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.09s
Steps: 222 | Train Loss: 0.0965680 Vali Loss: 0.1155324 Test Loss: 0.1414398
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0927428
	speed: 0.1393s/iter; left time: 2893.1079s
	iters: 200, epoch: 7 | loss: 0.0932568
	speed: 0.0808s/iter; left time: 1669.0278s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.0951679 Vali Loss: 0.1151066 Test Loss: 0.1423663
Validation loss decreased (0.115497 --> 0.115107).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0970360
	speed: 0.1407s/iter; left time: 2890.8038s
	iters: 200, epoch: 8 | loss: 0.0886637
	speed: 0.0807s/iter; left time: 1650.5820s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.11s
Steps: 222 | Train Loss: 0.0936608 Vali Loss: 0.1151603 Test Loss: 0.1438675
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0899512
	speed: 0.1384s/iter; left time: 2812.3019s
	iters: 200, epoch: 9 | loss: 0.0887586
	speed: 0.0805s/iter; left time: 1628.8723s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.08s
Steps: 222 | Train Loss: 0.0923841 Vali Loss: 0.1151062 Test Loss: 0.1445265
Validation loss decreased (0.115107 --> 0.115106).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0902266
	speed: 0.1405s/iter; left time: 2824.7093s
	iters: 200, epoch: 10 | loss: 0.0846719
	speed: 0.0805s/iter; left time: 1610.5972s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.07s
Steps: 222 | Train Loss: 0.0910080 Vali Loss: 0.1150696 Test Loss: 0.1448590
Validation loss decreased (0.115106 --> 0.115070).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0889520
	speed: 0.1400s/iter; left time: 2783.6996s
	iters: 200, epoch: 11 | loss: 0.0883325
	speed: 0.0806s/iter; left time: 1593.8098s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.0897821 Vali Loss: 0.1159446 Test Loss: 0.1465855
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0860249
	speed: 0.1388s/iter; left time: 2729.6262s
	iters: 200, epoch: 12 | loss: 0.0861240
	speed: 0.0805s/iter; left time: 1573.9160s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.06s
Steps: 222 | Train Loss: 0.0884889 Vali Loss: 0.1161465 Test Loss: 0.1472885
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0880837
	speed: 0.1396s/iter; left time: 2712.7592s
	iters: 200, epoch: 13 | loss: 0.0861884
	speed: 0.0806s/iter; left time: 1558.6562s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.09s
Steps: 222 | Train Loss: 0.0875239 Vali Loss: 0.1165294 Test Loss: 0.1474077
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0887766
	speed: 0.1381s/iter; left time: 2654.2521s
	iters: 200, epoch: 14 | loss: 0.0835006
	speed: 0.0807s/iter; left time: 1541.8736s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.10s
Steps: 222 | Train Loss: 0.0865451 Vali Loss: 0.1182222 Test Loss: 0.1485320
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0906235
	speed: 0.1395s/iter; left time: 2649.9562s
	iters: 200, epoch: 15 | loss: 0.0860536
	speed: 0.0808s/iter; left time: 1525.8477s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.0857539 Vali Loss: 0.1185830 Test Loss: 0.1495188
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0864211
	speed: 0.1382s/iter; left time: 2594.7448s
	iters: 200, epoch: 16 | loss: 0.0855064
	speed: 0.0806s/iter; left time: 1504.1109s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:18.08s
Steps: 222 | Train Loss: 0.0849867 Vali Loss: 0.1185916 Test Loss: 0.1497924
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0849342
	speed: 0.1388s/iter; left time: 2575.5074s
	iters: 200, epoch: 17 | loss: 0.0859643
	speed: 0.0808s/iter; left time: 1489.9697s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:18.10s
Steps: 222 | Train Loss: 0.0844976 Vali Loss: 0.1189754 Test Loss: 0.1503125
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0867529
	speed: 0.1384s/iter; left time: 2536.3141s
	iters: 200, epoch: 18 | loss: 0.0841190
	speed: 0.0807s/iter; left time: 1470.2874s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:18.09s
Steps: 222 | Train Loss: 0.0838787 Vali Loss: 0.1192779 Test Loss: 0.1504883
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0843950
	speed: 0.1382s/iter; left time: 2502.7071s
	iters: 200, epoch: 19 | loss: 0.0836716
	speed: 0.0801s/iter; left time: 1442.5115s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:17.98s
Steps: 222 | Train Loss: 0.0833456 Vali Loss: 0.1201275 Test Loss: 0.1502754
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0815062
	speed: 0.1380s/iter; left time: 2467.2989s
	iters: 200, epoch: 20 | loss: 0.0901580
	speed: 0.0806s/iter; left time: 1432.6358s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:18.07s
Steps: 222 | Train Loss: 0.0829971 Vali Loss: 0.1198272 Test Loss: 0.1505910
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04585912451148033, rmse:0.2141474336385727, mae:0.1448589712381363, rse:0.7405516505241394
Use GPU: cuda:0
>>>>>>>start training : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1389547
	speed: 0.0823s/iter; left time: 1818.7680s
	iters: 200, epoch: 1 | loss: 0.1327076
	speed: 0.0808s/iter; left time: 1776.9418s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.15s
Steps: 222 | Train Loss: 0.1421077 Vali Loss: 0.1456874 Test Loss: 0.1706855
Validation loss decreased (inf --> 0.145687).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1122408
	speed: 0.1409s/iter; left time: 3083.2981s
	iters: 200, epoch: 2 | loss: 0.1036625
	speed: 0.0807s/iter; left time: 1758.1235s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.16s
Steps: 222 | Train Loss: 0.1115317 Vali Loss: 0.1174392 Test Loss: 0.1394317
Validation loss decreased (0.145687 --> 0.117439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1019299
	speed: 0.1456s/iter; left time: 3152.2284s
	iters: 200, epoch: 3 | loss: 0.0972814
	speed: 0.0806s/iter; left time: 1737.7109s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.10s
Steps: 222 | Train Loss: 0.1020559 Vali Loss: 0.1162187 Test Loss: 0.1396693
Validation loss decreased (0.117439 --> 0.116219).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0993500
	speed: 0.1412s/iter; left time: 3027.4768s
	iters: 200, epoch: 4 | loss: 0.0995188
	speed: 0.0806s/iter; left time: 1720.0339s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.20s
Steps: 222 | Train Loss: 0.0997396 Vali Loss: 0.1157485 Test Loss: 0.1406896
Validation loss decreased (0.116219 --> 0.115749).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0968165
	speed: 0.1424s/iter; left time: 3019.9645s
	iters: 200, epoch: 5 | loss: 0.1007464
	speed: 0.0807s/iter; left time: 1704.7160s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.19s
Steps: 222 | Train Loss: 0.0979422 Vali Loss: 0.1149712 Test Loss: 0.1407970
Validation loss decreased (0.115749 --> 0.114971).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0946351
	speed: 0.1417s/iter; left time: 2975.4706s
	iters: 200, epoch: 6 | loss: 0.0939036
	speed: 0.0806s/iter; left time: 1683.3310s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.12s
Steps: 222 | Train Loss: 0.0962292 Vali Loss: 0.1152229 Test Loss: 0.1415257
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0939565
	speed: 0.1403s/iter; left time: 2913.3856s
	iters: 200, epoch: 7 | loss: 0.0928832
	speed: 0.0806s/iter; left time: 1665.6967s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.17s
Steps: 222 | Train Loss: 0.0945780 Vali Loss: 0.1153166 Test Loss: 0.1427085
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0905723
	speed: 0.1396s/iter; left time: 2869.2149s
	iters: 200, epoch: 8 | loss: 0.0928991
	speed: 0.0805s/iter; left time: 1646.1694s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.07s
Steps: 222 | Train Loss: 0.0930087 Vali Loss: 0.1158621 Test Loss: 0.1432852
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0974457
	speed: 0.1389s/iter; left time: 2823.7890s
	iters: 200, epoch: 9 | loss: 0.0915007
	speed: 0.0806s/iter; left time: 1629.4493s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.12s
Steps: 222 | Train Loss: 0.0914214 Vali Loss: 0.1161837 Test Loss: 0.1440141
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0934651
	speed: 0.1391s/iter; left time: 2795.6718s
	iters: 200, epoch: 10 | loss: 0.0912926
	speed: 0.0805s/iter; left time: 1609.2786s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.10s
Steps: 222 | Train Loss: 0.0901336 Vali Loss: 0.1175008 Test Loss: 0.1453111
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0854642
	speed: 0.1395s/iter; left time: 2773.6587s
	iters: 200, epoch: 11 | loss: 0.0908249
	speed: 0.0806s/iter; left time: 1593.7774s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.12s
Steps: 222 | Train Loss: 0.0889183 Vali Loss: 0.1184011 Test Loss: 0.1458802
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0828760
	speed: 0.1387s/iter; left time: 2727.2699s
	iters: 200, epoch: 12 | loss: 0.0861469
	speed: 0.0808s/iter; left time: 1579.4885s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.18s
Steps: 222 | Train Loss: 0.0878806 Vali Loss: 0.1183724 Test Loss: 0.1460292
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0887259
	speed: 0.1397s/iter; left time: 2715.6352s
	iters: 200, epoch: 13 | loss: 0.0837332
	speed: 0.0809s/iter; left time: 1563.8496s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.22s
Steps: 222 | Train Loss: 0.0869470 Vali Loss: 0.1185323 Test Loss: 0.1464543
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0832796
	speed: 0.1391s/iter; left time: 2671.9162s
	iters: 200, epoch: 14 | loss: 0.0869908
	speed: 0.0803s/iter; left time: 1534.4878s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.07s
Steps: 222 | Train Loss: 0.0861373 Vali Loss: 0.1191460 Test Loss: 0.1477436
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0838692
	speed: 0.1386s/iter; left time: 2632.5983s
	iters: 200, epoch: 15 | loss: 0.0864395
	speed: 0.0807s/iter; left time: 1524.1324s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.11s
Steps: 222 | Train Loss: 0.0854612 Vali Loss: 0.1197591 Test Loss: 0.1484080
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_96_GB_PatchTST_custom_ftM_sl512_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0425884984433651, rmse:0.2063698172569275, mae:0.14079692959785461, rse:0.7136555910110474
Intermediate time for GB and pred_len 96: 00h:13m:06.20s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_512_168_GB', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=512, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=7, c_out=5, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1398706
	speed: 0.1068s/iter; left time: 2361.2180s
	iters: 200, epoch: 1 | loss: 0.1382439
	speed: 0.0814s/iter; left time: 1791.5511s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.54s
Steps: 222 | Train Loss: 0.1429146 Vali Loss: 0.1471829 Test Loss: 0.1729666
Validation loss decreased (inf --> 0.147183).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1098959
	speed: 0.1408s/iter; left time: 3081.3877s
	iters: 200, epoch: 2 | loss: 0.1087988
	speed: 0.0812s/iter; left time: 1769.1272s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.23s
Steps: 222 | Train Loss: 0.1143142 Vali Loss: 0.1217393 Test Loss: 0.1444807
Validation loss decreased (0.147183 --> 0.121739).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1046128
	speed: 0.1406s/iter; left time: 3044.6341s
	iters: 200, epoch: 3 | loss: 0.1066747
	speed: 0.0816s/iter; left time: 1758.8457s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.26s
Steps: 222 | Train Loss: 0.1060163 Vali Loss: 0.1199054 Test Loss: 0.1455345
Validation loss decreased (0.121739 --> 0.119905).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1033576
	speed: 0.1419s/iter; left time: 3041.1615s
	iters: 200, epoch: 4 | loss: 0.1030032
	speed: 0.0814s/iter; left time: 1737.4647s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.26s
Steps: 222 | Train Loss: 0.1033712 Vali Loss: 0.1203927 Test Loss: 0.1471462
EarlyStopping counter: 1 out of 10
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1010814
	speed: 0.1393s/iter; left time: 2954.4741s
	iters: 200, epoch: 5 | loss: 0.0997352
	speed: 0.0814s/iter; left time: 1718.9563s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.28s
Steps: 222 | Train Loss: 0.1010653 Vali Loss: 0.1205869 Test Loss: 0.1493505
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0962149
	speed: 0.1406s/iter; left time: 2950.9309s
	iters: 200, epoch: 6 | loss: 0.1000016
	speed: 0.0811s/iter; left time: 1694.3372s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.34s
Steps: 222 | Train Loss: 0.0988993 Vali Loss: 0.1206984 Test Loss: 0.1489712
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0959983
	speed: 0.1398s/iter; left time: 2904.1469s
	iters: 200, epoch: 7 | loss: 0.0942835
	speed: 0.0813s/iter; left time: 1679.9238s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.27s
Steps: 222 | Train Loss: 0.0969016 Vali Loss: 0.1214482 Test Loss: 0.1511385
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0948653
	speed: 0.1389s/iter; left time: 2854.4583s
	iters: 200, epoch: 8 | loss: 0.0935265
	speed: 0.0811s/iter; left time: 1658.9569s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.23s
Steps: 222 | Train Loss: 0.0950081 Vali Loss: 0.1208681 Test Loss: 0.1513408
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0944575
	speed: 0.1397s/iter; left time: 2840.0386s
	iters: 200, epoch: 9 | loss: 0.0945373
	speed: 0.0814s/iter; left time: 1646.6899s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0932375 Vali Loss: 0.1216507 Test Loss: 0.1517617
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0912117
	speed: 0.1400s/iter; left time: 2814.2967s
	iters: 200, epoch: 10 | loss: 0.0915381
	speed: 0.0812s/iter; left time: 1623.7370s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.23s
Steps: 222 | Train Loss: 0.0916975 Vali Loss: 0.1230478 Test Loss: 0.1538335
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0911945
	speed: 0.1395s/iter; left time: 2774.2939s
	iters: 200, epoch: 11 | loss: 0.0884001
	speed: 0.0813s/iter; left time: 1607.4538s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.24s
Steps: 222 | Train Loss: 0.0903979 Vali Loss: 0.1235992 Test Loss: 0.1541341
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0880264
	speed: 0.1391s/iter; left time: 2735.3835s
	iters: 200, epoch: 12 | loss: 0.0866772
	speed: 0.0815s/iter; left time: 1594.7638s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.25s
Steps: 222 | Train Loss: 0.0892005 Vali Loss: 0.1242566 Test Loss: 0.1546974
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0874250
	speed: 0.1387s/iter; left time: 2696.3822s
	iters: 200, epoch: 13 | loss: 0.0880191
	speed: 0.0812s/iter; left time: 1570.9311s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.20s
Steps: 222 | Train Loss: 0.0882589 Vali Loss: 0.1245862 Test Loss: 0.1551056
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04369062930345535, rmse:0.20902302861213684, mae:0.14553453028202057, rse:0.7247128486633301
Use GPU: cuda:0
>>>>>>>start training : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1419638
	speed: 0.0828s/iter; left time: 1830.3672s
	iters: 200, epoch: 1 | loss: 0.1385796
	speed: 0.0813s/iter; left time: 1787.9796s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:18.26s
Steps: 222 | Train Loss: 0.1434565 Vali Loss: 0.1476240 Test Loss: 0.1734360
Validation loss decreased (inf --> 0.147624).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1124867
	speed: 0.1419s/iter; left time: 3105.6768s
	iters: 200, epoch: 2 | loss: 0.1091222
	speed: 0.0811s/iter; left time: 1765.8032s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:18.24s
Steps: 222 | Train Loss: 0.1151475 Vali Loss: 0.1221997 Test Loss: 0.1450011
Validation loss decreased (0.147624 --> 0.122200).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1074508
	speed: 0.1404s/iter; left time: 3041.6527s
	iters: 200, epoch: 3 | loss: 0.1105702
	speed: 0.0811s/iter; left time: 1748.8269s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:18.24s
Steps: 222 | Train Loss: 0.1062980 Vali Loss: 0.1204826 Test Loss: 0.1468059
Validation loss decreased (0.122200 --> 0.120483).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1053387
	speed: 0.1405s/iter; left time: 3011.8811s
	iters: 200, epoch: 4 | loss: 0.1039608
	speed: 0.0811s/iter; left time: 1730.4959s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:18.26s
Steps: 222 | Train Loss: 0.1037557 Vali Loss: 0.1203048 Test Loss: 0.1477481
Validation loss decreased (0.120483 --> 0.120305).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1036354
	speed: 0.1408s/iter; left time: 2987.0007s
	iters: 200, epoch: 5 | loss: 0.0983951
	speed: 0.0811s/iter; left time: 1712.7628s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:18.22s
Steps: 222 | Train Loss: 0.1015428 Vali Loss: 0.1195792 Test Loss: 0.1480534
Validation loss decreased (0.120305 --> 0.119579).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0994660
	speed: 0.1418s/iter; left time: 2976.3285s
	iters: 200, epoch: 6 | loss: 0.0961423
	speed: 0.0814s/iter; left time: 1700.4854s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0993276 Vali Loss: 0.1202111 Test Loss: 0.1496725
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0958781
	speed: 0.1395s/iter; left time: 2897.0162s
	iters: 200, epoch: 7 | loss: 0.0959541
	speed: 0.0811s/iter; left time: 1675.8904s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:18.22s
Steps: 222 | Train Loss: 0.0972312 Vali Loss: 0.1203471 Test Loss: 0.1500919
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0944401
	speed: 0.1396s/iter; left time: 2867.4243s
	iters: 200, epoch: 8 | loss: 0.0966303
	speed: 0.0811s/iter; left time: 1658.0043s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:18.19s
Steps: 222 | Train Loss: 0.0954563 Vali Loss: 0.1199050 Test Loss: 0.1506354
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0943413
	speed: 0.1409s/iter; left time: 2863.6914s
	iters: 200, epoch: 9 | loss: 0.0965194
	speed: 0.0815s/iter; left time: 1647.5000s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:18.33s
Steps: 222 | Train Loss: 0.0937926 Vali Loss: 0.1209276 Test Loss: 0.1508951
EarlyStopping counter: 4 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0920365
	speed: 0.1400s/iter; left time: 2815.2283s
	iters: 200, epoch: 10 | loss: 0.0944835
	speed: 0.0811s/iter; left time: 1621.6555s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:18.20s
Steps: 222 | Train Loss: 0.0923184 Vali Loss: 0.1216158 Test Loss: 0.1523672
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0890176
	speed: 0.1395s/iter; left time: 2772.7185s
	iters: 200, epoch: 11 | loss: 0.0903773
	speed: 0.0813s/iter; left time: 1607.6413s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:18.25s
Steps: 222 | Train Loss: 0.0910789 Vali Loss: 0.1217306 Test Loss: 0.1521261
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0872232
	speed: 0.1396s/iter; left time: 2744.6620s
	iters: 200, epoch: 12 | loss: 0.0923500
	speed: 0.0811s/iter; left time: 1586.9446s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:18.24s
Steps: 222 | Train Loss: 0.0899829 Vali Loss: 0.1231703 Test Loss: 0.1537110
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0872186
	speed: 0.1397s/iter; left time: 2714.4259s
	iters: 200, epoch: 13 | loss: 0.0887902
	speed: 0.0811s/iter; left time: 1567.7816s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:18.22s
Steps: 222 | Train Loss: 0.0890337 Vali Loss: 0.1235894 Test Loss: 0.1542339
EarlyStopping counter: 8 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0884640
	speed: 0.1395s/iter; left time: 2681.4181s
	iters: 200, epoch: 14 | loss: 0.0870688
	speed: 0.0810s/iter; left time: 1549.1268s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:18.20s
Steps: 222 | Train Loss: 0.0882041 Vali Loss: 0.1238865 Test Loss: 0.1543076
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0922166
	speed: 0.1408s/iter; left time: 2674.9680s
	iters: 200, epoch: 15 | loss: 0.0888370
	speed: 0.0813s/iter; left time: 1535.7108s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:18.29s
Steps: 222 | Train Loss: 0.0873947 Vali Loss: 0.1243513 Test Loss: 0.1549856
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_512_168_GB_PatchTST_custom_ftM_sl512_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04569704458117485, rmse:0.21376867592334747, mae:0.1480533480644226, rse:0.7411666512489319
Intermediate time for GB and pred_len 168: 00h:10m:36.44sIntermediate time for GB: 00h:54m:35.29s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_24_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1526842
	speed: 0.0609s/iter; left time: 1358.8946s
	iters: 200, epoch: 1 | loss: 0.1366305
	speed: 0.0341s/iter; left time: 757.0499s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.1550454 Vali Loss: 0.1393994 Test Loss: 0.1681718
Validation loss decreased (inf --> 0.139399).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0732484
	speed: 0.0644s/iter; left time: 1422.6868s
	iters: 200, epoch: 2 | loss: 0.0723599
	speed: 0.0342s/iter; left time: 751.8843s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0805116 Vali Loss: 0.0647224 Test Loss: 0.0717992
Validation loss decreased (0.139399 --> 0.064722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0670712
	speed: 0.0665s/iter; left time: 1454.2014s
	iters: 200, epoch: 3 | loss: 0.0631713
	speed: 0.0341s/iter; left time: 742.5281s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0640164 Vali Loss: 0.0604511 Test Loss: 0.0675387
Validation loss decreased (0.064722 --> 0.060451).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0615953
	speed: 0.0642s/iter; left time: 1387.7785s
	iters: 200, epoch: 4 | loss: 0.0594863
	speed: 0.0341s/iter; left time: 734.9610s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0607313 Vali Loss: 0.0585351 Test Loss: 0.0652289
Validation loss decreased (0.060451 --> 0.058535).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0582284
	speed: 0.0640s/iter; left time: 1370.6194s
	iters: 200, epoch: 5 | loss: 0.0548869
	speed: 0.0344s/iter; left time: 733.7277s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0586365 Vali Loss: 0.0571023 Test Loss: 0.0640453
Validation loss decreased (0.058535 --> 0.057102).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0568549
	speed: 0.0643s/iter; left time: 1361.1592s
	iters: 200, epoch: 6 | loss: 0.0545233
	speed: 0.0339s/iter; left time: 714.4159s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0572533 Vali Loss: 0.0562853 Test Loss: 0.0630265
Validation loss decreased (0.057102 --> 0.056285).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0588305
	speed: 0.0646s/iter; left time: 1353.0178s
	iters: 200, epoch: 7 | loss: 0.0523065
	speed: 0.0346s/iter; left time: 721.7980s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0561701 Vali Loss: 0.0557691 Test Loss: 0.0625740
Validation loss decreased (0.056285 --> 0.055769).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0549896
	speed: 0.0646s/iter; left time: 1340.1382s
	iters: 200, epoch: 8 | loss: 0.0590127
	speed: 0.0340s/iter; left time: 702.0055s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0555243 Vali Loss: 0.0552860 Test Loss: 0.0622382
Validation loss decreased (0.055769 --> 0.055286).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0538663
	speed: 0.0661s/iter; left time: 1355.4103s
	iters: 200, epoch: 9 | loss: 0.0581174
	speed: 0.0357s/iter; left time: 728.5238s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0549856 Vali Loss: 0.0547778 Test Loss: 0.0615789
Validation loss decreased (0.055286 --> 0.054778).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0544842
	speed: 0.0644s/iter; left time: 1305.6717s
	iters: 200, epoch: 10 | loss: 0.0509822
	speed: 0.0341s/iter; left time: 687.6872s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0545583 Vali Loss: 0.0547986 Test Loss: 0.0614929
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0541769
	speed: 0.0625s/iter; left time: 1253.8060s
	iters: 200, epoch: 11 | loss: 0.0549371
	speed: 0.0340s/iter; left time: 677.6949s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0541390 Vali Loss: 0.0542580 Test Loss: 0.0609762
Validation loss decreased (0.054778 --> 0.054258).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0538365
	speed: 0.0638s/iter; left time: 1265.0536s
	iters: 200, epoch: 12 | loss: 0.0529875
	speed: 0.0344s/iter; left time: 678.7141s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0538779 Vali Loss: 0.0541497 Test Loss: 0.0608541
Validation loss decreased (0.054258 --> 0.054150).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0556539
	speed: 0.0631s/iter; left time: 1238.1737s
	iters: 200, epoch: 13 | loss: 0.0526646
	speed: 0.0344s/iter; left time: 670.3316s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0536023 Vali Loss: 0.0540321 Test Loss: 0.0606161
Validation loss decreased (0.054150 --> 0.054032).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0543625
	speed: 0.0645s/iter; left time: 1250.2886s
	iters: 200, epoch: 14 | loss: 0.0530023
	speed: 0.0348s/iter; left time: 670.7128s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0533630 Vali Loss: 0.0541184 Test Loss: 0.0608187
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0521512
	speed: 0.0630s/iter; left time: 1208.2481s
	iters: 200, epoch: 15 | loss: 0.0521281
	speed: 0.0344s/iter; left time: 656.0099s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0531000 Vali Loss: 0.0539720 Test Loss: 0.0605283
Validation loss decreased (0.054032 --> 0.053972).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0509178
	speed: 0.0627s/iter; left time: 1187.9921s
	iters: 200, epoch: 16 | loss: 0.0512274
	speed: 0.0337s/iter; left time: 635.2819s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0529989 Vali Loss: 0.0536041 Test Loss: 0.0602776
Validation loss decreased (0.053972 --> 0.053604).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0513468
	speed: 0.0627s/iter; left time: 1173.1582s
	iters: 200, epoch: 17 | loss: 0.0483066
	speed: 0.0340s/iter; left time: 632.2132s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0528339 Vali Loss: 0.0536399 Test Loss: 0.0601474
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0508105
	speed: 0.0629s/iter; left time: 1163.3793s
	iters: 200, epoch: 18 | loss: 0.0472548
	speed: 0.0337s/iter; left time: 620.7620s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0526830 Vali Loss: 0.0535131 Test Loss: 0.0600573
Validation loss decreased (0.053604 --> 0.053513).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0543427
	speed: 0.0631s/iter; left time: 1151.9394s
	iters: 200, epoch: 19 | loss: 0.0539975
	speed: 0.0339s/iter; left time: 615.9884s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0526239 Vali Loss: 0.0534467 Test Loss: 0.0600467
Validation loss decreased (0.053513 --> 0.053447).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0512956
	speed: 0.0633s/iter; left time: 1142.3240s
	iters: 200, epoch: 20 | loss: 0.0518979
	speed: 0.0338s/iter; left time: 605.6957s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0524580 Vali Loss: 0.0534504 Test Loss: 0.0601290
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0516894
	speed: 0.0625s/iter; left time: 1114.1185s
	iters: 200, epoch: 21 | loss: 0.0514001
	speed: 0.0340s/iter; left time: 601.7961s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0523597 Vali Loss: 0.0533231 Test Loss: 0.0599976
Validation loss decreased (0.053447 --> 0.053323).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0483420
	speed: 0.0626s/iter; left time: 1102.2952s
	iters: 200, epoch: 22 | loss: 0.0524221
	speed: 0.0337s/iter; left time: 590.2396s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0522725 Vali Loss: 0.0532108 Test Loss: 0.0598633
Validation loss decreased (0.053323 --> 0.053211).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0503389
	speed: 0.0628s/iter; left time: 1090.2020s
	iters: 200, epoch: 23 | loss: 0.0539414
	speed: 0.0338s/iter; left time: 583.9849s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0522263 Vali Loss: 0.0532671 Test Loss: 0.0599022
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0542046
	speed: 0.0624s/iter; left time: 1070.4008s
	iters: 200, epoch: 24 | loss: 0.0510984
	speed: 0.0338s/iter; left time: 575.7559s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0521891 Vali Loss: 0.0531939 Test Loss: 0.0597542
Validation loss decreased (0.053211 --> 0.053194).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0514270
	speed: 0.0627s/iter; left time: 1060.7629s
	iters: 200, epoch: 25 | loss: 0.0550747
	speed: 0.0337s/iter; left time: 567.1077s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0520553 Vali Loss: 0.0530766 Test Loss: 0.0597279
Validation loss decreased (0.053194 --> 0.053077).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0486141
	speed: 0.0628s/iter; left time: 1048.8454s
	iters: 200, epoch: 26 | loss: 0.0538085
	speed: 0.0338s/iter; left time: 560.6971s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0519923 Vali Loss: 0.0531875 Test Loss: 0.0597662
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0524277
	speed: 0.0620s/iter; left time: 1021.1319s
	iters: 200, epoch: 27 | loss: 0.0521245
	speed: 0.0338s/iter; left time: 553.4254s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0520323 Vali Loss: 0.0530715 Test Loss: 0.0596598
Validation loss decreased (0.053077 --> 0.053071).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0528489
	speed: 0.0631s/iter; left time: 1025.7348s
	iters: 200, epoch: 28 | loss: 0.0528272
	speed: 0.0338s/iter; left time: 546.2785s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0519045 Vali Loss: 0.0530310 Test Loss: 0.0596944
Validation loss decreased (0.053071 --> 0.053031).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0494530
	speed: 0.0629s/iter; left time: 1007.4482s
	iters: 200, epoch: 29 | loss: 0.0549773
	speed: 0.0337s/iter; left time: 537.5443s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0518919 Vali Loss: 0.0531214 Test Loss: 0.0597658
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0509516
	speed: 0.0626s/iter; left time: 990.1646s
	iters: 200, epoch: 30 | loss: 0.0541899
	speed: 0.0339s/iter; left time: 531.9351s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0518665 Vali Loss: 0.0530275 Test Loss: 0.0596586
Validation loss decreased (0.053031 --> 0.053028).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0517120
	speed: 0.0628s/iter; left time: 978.0485s
	iters: 200, epoch: 31 | loss: 0.0504429
	speed: 0.0337s/iter; left time: 521.0384s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0518409 Vali Loss: 0.0530472 Test Loss: 0.0595775
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0496667
	speed: 0.0625s/iter; left time: 960.1056s
	iters: 200, epoch: 32 | loss: 0.0514431
	speed: 0.0342s/iter; left time: 521.5338s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0518175 Vali Loss: 0.0530794 Test Loss: 0.0596468
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0489944
	speed: 0.0622s/iter; left time: 941.2344s
	iters: 200, epoch: 33 | loss: 0.0532939
	speed: 0.0338s/iter; left time: 508.6785s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0517973 Vali Loss: 0.0530503 Test Loss: 0.0596521
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0528417
	speed: 0.0626s/iter; left time: 932.9459s
	iters: 200, epoch: 34 | loss: 0.0519611
	speed: 0.0338s/iter; left time: 500.2054s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0517021 Vali Loss: 0.0530652 Test Loss: 0.0594816
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0530752
	speed: 0.0628s/iter; left time: 922.1408s
	iters: 200, epoch: 35 | loss: 0.0518166
	speed: 0.0339s/iter; left time: 494.1251s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0517347 Vali Loss: 0.0528620 Test Loss: 0.0595123
Validation loss decreased (0.053028 --> 0.052862).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0506464
	speed: 0.0645s/iter; left time: 932.4568s
	iters: 200, epoch: 36 | loss: 0.0517927
	speed: 0.0338s/iter; left time: 484.9614s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0516731 Vali Loss: 0.0529967 Test Loss: 0.0596204
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0519233
	speed: 0.0623s/iter; left time: 887.4264s
	iters: 200, epoch: 37 | loss: 0.0506047
	speed: 0.0340s/iter; left time: 480.4417s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0516810 Vali Loss: 0.0530068 Test Loss: 0.0595802
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0507490
	speed: 0.0625s/iter; left time: 876.1894s
	iters: 200, epoch: 38 | loss: 0.0562936
	speed: 0.0340s/iter; left time: 472.7079s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0516737 Vali Loss: 0.0529319 Test Loss: 0.0594970
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0492359
	speed: 0.0624s/iter; left time: 860.4935s
	iters: 200, epoch: 39 | loss: 0.0538159
	speed: 0.0338s/iter; left time: 462.7992s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0516829 Vali Loss: 0.0529696 Test Loss: 0.0594831
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0513327
	speed: 0.0620s/iter; left time: 841.4094s
	iters: 200, epoch: 40 | loss: 0.0514433
	speed: 0.0338s/iter; left time: 455.5368s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0516562 Vali Loss: 0.0530150 Test Loss: 0.0596243
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0518598
	speed: 0.0629s/iter; left time: 839.1156s
	iters: 200, epoch: 41 | loss: 0.0497989
	speed: 0.0340s/iter; left time: 450.7965s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0516688 Vali Loss: 0.0528681 Test Loss: 0.0594650
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0497980
	speed: 0.0624s/iter; left time: 818.5636s
	iters: 200, epoch: 42 | loss: 0.0535568
	speed: 0.0343s/iter; left time: 446.3473s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0516297 Vali Loss: 0.0529409 Test Loss: 0.0594555
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0522472
	speed: 0.0625s/iter; left time: 805.6177s
	iters: 200, epoch: 43 | loss: 0.0489027
	speed: 0.0339s/iter; left time: 433.5713s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0516606 Vali Loss: 0.0529695 Test Loss: 0.0595177
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0520200
	speed: 0.0623s/iter; left time: 789.8724s
	iters: 200, epoch: 44 | loss: 0.0508248
	speed: 0.0339s/iter; left time: 426.3386s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0515849 Vali Loss: 0.0529528 Test Loss: 0.0595244
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0524924
	speed: 0.0621s/iter; left time: 773.0018s
	iters: 200, epoch: 45 | loss: 0.0509926
	speed: 0.0337s/iter; left time: 415.9272s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0515887 Vali Loss: 0.0530027 Test Loss: 0.0595490
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009823016822338104, rmse:0.09911113232374191, mae:0.05951228737831116, rse:0.2916720509529114
Use GPU: cuda:0
>>>>>>>start training : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28777
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1579360
	speed: 0.0362s/iter; left time: 806.2461s
	iters: 200, epoch: 1 | loss: 0.1345574
	speed: 0.0341s/iter; left time: 756.1026s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.1544287 Vali Loss: 0.1378902 Test Loss: 0.1664125
Validation loss decreased (inf --> 0.137890).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0723953
	speed: 0.0643s/iter; left time: 1420.1447s
	iters: 200, epoch: 2 | loss: 0.0673680
	speed: 0.0338s/iter; left time: 741.8345s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0807752 Vali Loss: 0.0640944 Test Loss: 0.0714371
Validation loss decreased (0.137890 --> 0.064094).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0664814
	speed: 0.0635s/iter; left time: 1388.3982s
	iters: 200, epoch: 3 | loss: 0.0602823
	speed: 0.0342s/iter; left time: 743.4186s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0644568 Vali Loss: 0.0613151 Test Loss: 0.0682127
Validation loss decreased (0.064094 --> 0.061315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0619137
	speed: 0.0636s/iter; left time: 1376.4854s
	iters: 200, epoch: 4 | loss: 0.0629501
	speed: 0.0343s/iter; left time: 739.5180s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0613793 Vali Loss: 0.0588372 Test Loss: 0.0659621
Validation loss decreased (0.061315 --> 0.058837).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0599205
	speed: 0.0638s/iter; left time: 1365.4802s
	iters: 200, epoch: 5 | loss: 0.0566143
	speed: 0.0340s/iter; left time: 724.2309s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0592500 Vali Loss: 0.0577281 Test Loss: 0.0648115
Validation loss decreased (0.058837 --> 0.057728).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0587412
	speed: 0.0641s/iter; left time: 1357.6046s
	iters: 200, epoch: 6 | loss: 0.0555555
	speed: 0.0344s/iter; left time: 724.7994s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0577187 Vali Loss: 0.0565377 Test Loss: 0.0634899
Validation loss decreased (0.057728 --> 0.056538).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0582398
	speed: 0.0631s/iter; left time: 1322.1493s
	iters: 200, epoch: 7 | loss: 0.0569732
	speed: 0.0343s/iter; left time: 714.9028s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0565804 Vali Loss: 0.0560253 Test Loss: 0.0630894
Validation loss decreased (0.056538 --> 0.056025).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0576674
	speed: 0.0637s/iter; left time: 1321.0784s
	iters: 200, epoch: 8 | loss: 0.0565004
	speed: 0.0342s/iter; left time: 704.6413s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0557787 Vali Loss: 0.0554661 Test Loss: 0.0624663
Validation loss decreased (0.056025 --> 0.055466).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0545671
	speed: 0.0638s/iter; left time: 1307.7506s
	iters: 200, epoch: 9 | loss: 0.0577309
	speed: 0.0345s/iter; left time: 703.1860s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0551741 Vali Loss: 0.0550627 Test Loss: 0.0620055
Validation loss decreased (0.055466 --> 0.055063).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0536375
	speed: 0.0641s/iter; left time: 1300.5337s
	iters: 200, epoch: 10 | loss: 0.0555455
	speed: 0.0344s/iter; left time: 693.8047s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0547537 Vali Loss: 0.0550868 Test Loss: 0.0618774
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0518436
	speed: 0.0626s/iter; left time: 1256.4904s
	iters: 200, epoch: 11 | loss: 0.0547084
	speed: 0.0338s/iter; left time: 674.5955s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0543565 Vali Loss: 0.0546177 Test Loss: 0.0611843
Validation loss decreased (0.055063 --> 0.054618).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0567422
	speed: 0.0640s/iter; left time: 1268.7299s
	iters: 200, epoch: 12 | loss: 0.0523581
	speed: 0.0338s/iter; left time: 667.9669s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.83s
Steps: 224 | Train Loss: 0.0540275 Vali Loss: 0.0544829 Test Loss: 0.0609822
Validation loss decreased (0.054618 --> 0.054483).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0552673
	speed: 0.0639s/iter; left time: 1252.5990s
	iters: 200, epoch: 13 | loss: 0.0510562
	speed: 0.0341s/iter; left time: 665.4395s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0537494 Vali Loss: 0.0542448 Test Loss: 0.0610533
Validation loss decreased (0.054483 --> 0.054245).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0562548
	speed: 0.0634s/iter; left time: 1228.8678s
	iters: 200, epoch: 14 | loss: 0.0558280
	speed: 0.0339s/iter; left time: 654.3415s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0534659 Vali Loss: 0.0541800 Test Loss: 0.0609532
Validation loss decreased (0.054245 --> 0.054180).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0524575
	speed: 0.0637s/iter; left time: 1221.5597s
	iters: 200, epoch: 15 | loss: 0.0552186
	speed: 0.0342s/iter; left time: 651.7205s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0533038 Vali Loss: 0.0540752 Test Loss: 0.0606174
Validation loss decreased (0.054180 --> 0.054075).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0530639
	speed: 0.0639s/iter; left time: 1210.1429s
	iters: 200, epoch: 16 | loss: 0.0518307
	speed: 0.0340s/iter; left time: 639.9202s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0531068 Vali Loss: 0.0539237 Test Loss: 0.0606197
Validation loss decreased (0.054075 --> 0.053924).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0549129
	speed: 0.0640s/iter; left time: 1198.4220s
	iters: 200, epoch: 17 | loss: 0.0486911
	speed: 0.0339s/iter; left time: 630.6953s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0529943 Vali Loss: 0.0538352 Test Loss: 0.0604584
Validation loss decreased (0.053924 --> 0.053835).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0533815
	speed: 0.0632s/iter; left time: 1168.3594s
	iters: 200, epoch: 18 | loss: 0.0563068
	speed: 0.0339s/iter; left time: 624.3753s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0528632 Vali Loss: 0.0536740 Test Loss: 0.0603638
Validation loss decreased (0.053835 --> 0.053674).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0529857
	speed: 0.0641s/iter; left time: 1171.2782s
	iters: 200, epoch: 19 | loss: 0.0518051
	speed: 0.0361s/iter; left time: 655.5040s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.13s
Steps: 224 | Train Loss: 0.0526865 Vali Loss: 0.0534223 Test Loss: 0.0601238
Validation loss decreased (0.053674 --> 0.053422).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0509609
	speed: 0.0648s/iter; left time: 1169.1304s
	iters: 200, epoch: 20 | loss: 0.0505578
	speed: 0.0342s/iter; left time: 613.6357s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0526346 Vali Loss: 0.0535342 Test Loss: 0.0601085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0515755
	speed: 0.0631s/iter; left time: 1125.0728s
	iters: 200, epoch: 21 | loss: 0.0507104
	speed: 0.0336s/iter; left time: 595.6313s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0525259 Vali Loss: 0.0534651 Test Loss: 0.0600710
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0511437
	speed: 0.0626s/iter; left time: 1102.4177s
	iters: 200, epoch: 22 | loss: 0.0498561
	speed: 0.0337s/iter; left time: 588.9765s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.75s
Steps: 224 | Train Loss: 0.0524205 Vali Loss: 0.0534762 Test Loss: 0.0601843
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0535026
	speed: 0.0636s/iter; left time: 1104.5741s
	iters: 200, epoch: 23 | loss: 0.0500406
	speed: 0.0343s/iter; left time: 592.1088s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0523597 Vali Loss: 0.0534131 Test Loss: 0.0600998
Validation loss decreased (0.053422 --> 0.053413).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0492497
	speed: 0.0639s/iter; left time: 1096.5966s
	iters: 200, epoch: 24 | loss: 0.0506229
	speed: 0.0339s/iter; left time: 578.1455s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0522823 Vali Loss: 0.0532963 Test Loss: 0.0599198
Validation loss decreased (0.053413 --> 0.053296).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0521318
	speed: 0.0655s/iter; left time: 1108.0073s
	iters: 200, epoch: 25 | loss: 0.0511510
	speed: 0.0344s/iter; left time: 578.6880s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0522033 Vali Loss: 0.0533299 Test Loss: 0.0599659
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0504086
	speed: 0.0631s/iter; left time: 1053.2769s
	iters: 200, epoch: 26 | loss: 0.0505698
	speed: 0.0338s/iter; left time: 560.9527s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0521587 Vali Loss: 0.0533623 Test Loss: 0.0599633
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0529970
	speed: 0.0633s/iter; left time: 1042.1823s
	iters: 200, epoch: 27 | loss: 0.0493081
	speed: 0.0339s/iter; left time: 555.0412s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.84s
Steps: 224 | Train Loss: 0.0521429 Vali Loss: 0.0534271 Test Loss: 0.0600620
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0561010
	speed: 0.0628s/iter; left time: 1019.8882s
	iters: 200, epoch: 28 | loss: 0.0526673
	speed: 0.0338s/iter; left time: 546.3516s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0520879 Vali Loss: 0.0532309 Test Loss: 0.0596975
Validation loss decreased (0.053296 --> 0.053231).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0538653
	speed: 0.0641s/iter; left time: 1027.4060s
	iters: 200, epoch: 29 | loss: 0.0507462
	speed: 0.0343s/iter; left time: 546.1889s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0520182 Vali Loss: 0.0532914 Test Loss: 0.0598624
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0564779
	speed: 0.0626s/iter; left time: 989.2602s
	iters: 200, epoch: 30 | loss: 0.0513206
	speed: 0.0338s/iter; left time: 531.3166s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0519411 Vali Loss: 0.0531523 Test Loss: 0.0597022
Validation loss decreased (0.053231 --> 0.053152).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0504823
	speed: 0.0635s/iter; left time: 989.2336s
	iters: 200, epoch: 31 | loss: 0.0540285
	speed: 0.0338s/iter; left time: 522.4879s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.82s
Steps: 224 | Train Loss: 0.0519207 Vali Loss: 0.0531699 Test Loss: 0.0596743
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0498894
	speed: 0.0639s/iter; left time: 981.5846s
	iters: 200, epoch: 32 | loss: 0.0540251
	speed: 0.0350s/iter; left time: 534.6151s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0519015 Vali Loss: 0.0531963 Test Loss: 0.0597262
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0543305
	speed: 0.0640s/iter; left time: 969.1034s
	iters: 200, epoch: 33 | loss: 0.0495824
	speed: 0.0344s/iter; left time: 517.3150s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0518915 Vali Loss: 0.0531901 Test Loss: 0.0596950
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0508410
	speed: 0.0630s/iter; left time: 939.0433s
	iters: 200, epoch: 34 | loss: 0.0491989
	speed: 0.0337s/iter; left time: 498.7927s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:07.77s
Steps: 224 | Train Loss: 0.0518669 Vali Loss: 0.0531966 Test Loss: 0.0597255
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0490082
	speed: 0.0639s/iter; left time: 939.1057s
	iters: 200, epoch: 35 | loss: 0.0526008
	speed: 0.0341s/iter; left time: 497.2151s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0518020 Vali Loss: 0.0531861 Test Loss: 0.0596925
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0554945
	speed: 0.0623s/iter; left time: 901.4166s
	iters: 200, epoch: 36 | loss: 0.0519463
	speed: 0.0338s/iter; left time: 485.8241s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0518643 Vali Loss: 0.0531078 Test Loss: 0.0596932
Validation loss decreased (0.053152 --> 0.053108).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0496504
	speed: 0.0652s/iter; left time: 928.4305s
	iters: 200, epoch: 37 | loss: 0.0498719
	speed: 0.0340s/iter; left time: 480.8522s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0518462 Vali Loss: 0.0531845 Test Loss: 0.0596469
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0510170
	speed: 0.0629s/iter; left time: 880.7925s
	iters: 200, epoch: 38 | loss: 0.0542504
	speed: 0.0338s/iter; left time: 470.3769s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0518217 Vali Loss: 0.0531203 Test Loss: 0.0596973
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0488454
	speed: 0.0628s/iter; left time: 865.2811s
	iters: 200, epoch: 39 | loss: 0.0506440
	speed: 0.0340s/iter; left time: 465.7097s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.85s
Steps: 224 | Train Loss: 0.0517673 Vali Loss: 0.0530957 Test Loss: 0.0596440
Validation loss decreased (0.053108 --> 0.053096).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0500557
	speed: 0.0645s/iter; left time: 874.3162s
	iters: 200, epoch: 40 | loss: 0.0513093
	speed: 0.0343s/iter; left time: 461.4077s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0517291 Vali Loss: 0.0530914 Test Loss: 0.0595172
Validation loss decreased (0.053096 --> 0.053091).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0547261
	speed: 0.0645s/iter; left time: 859.9562s
	iters: 200, epoch: 41 | loss: 0.0481549
	speed: 0.0336s/iter; left time: 445.3140s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.76s
Steps: 224 | Train Loss: 0.0517457 Vali Loss: 0.0530916 Test Loss: 0.0596419
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0524280
	speed: 0.0636s/iter; left time: 834.1583s
	iters: 200, epoch: 42 | loss: 0.0527511
	speed: 0.0340s/iter; left time: 442.4926s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.87s
Steps: 224 | Train Loss: 0.0517541 Vali Loss: 0.0532012 Test Loss: 0.0597727
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0527208
	speed: 0.0632s/iter; left time: 815.1594s
	iters: 200, epoch: 43 | loss: 0.0518980
	speed: 0.0339s/iter; left time: 433.5156s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0517267 Vali Loss: 0.0529711 Test Loss: 0.0595133
Validation loss decreased (0.053091 --> 0.052971).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0536714
	speed: 0.0631s/iter; left time: 798.7845s
	iters: 200, epoch: 44 | loss: 0.0551635
	speed: 0.0339s/iter; left time: 425.6511s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.80s
Steps: 224 | Train Loss: 0.0517666 Vali Loss: 0.0530981 Test Loss: 0.0596632
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0518254
	speed: 0.0627s/iter; left time: 780.7698s
	iters: 200, epoch: 45 | loss: 0.0512678
	speed: 0.0338s/iter; left time: 417.0747s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0516751 Vali Loss: 0.0531732 Test Loss: 0.0596597
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0521856
	speed: 0.0633s/iter; left time: 773.5642s
	iters: 200, epoch: 46 | loss: 0.0487361
	speed: 0.0343s/iter; left time: 415.3791s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0516208 Vali Loss: 0.0530561 Test Loss: 0.0595802
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0530450
	speed: 0.0633s/iter; left time: 759.7925s
	iters: 200, epoch: 47 | loss: 0.0445639
	speed: 0.0342s/iter; left time: 406.7416s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0516959 Vali Loss: 0.0531059 Test Loss: 0.0596224
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0539990
	speed: 0.0626s/iter; left time: 737.1421s
	iters: 200, epoch: 48 | loss: 0.0513229
	speed: 0.0338s/iter; left time: 394.9133s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.78s
Steps: 224 | Train Loss: 0.0516967 Vali Loss: 0.0530909 Test Loss: 0.0596255
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0525027
	speed: 0.0627s/iter; left time: 724.6279s
	iters: 200, epoch: 49 | loss: 0.0530085
	speed: 0.0339s/iter; left time: 387.6731s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:07.79s
Steps: 224 | Train Loss: 0.0516743 Vali Loss: 0.0531389 Test Loss: 0.0596946
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0477419
	speed: 0.0629s/iter; left time: 712.5456s
	iters: 200, epoch: 50 | loss: 0.0513889
	speed: 0.0344s/iter; left time: 386.1414s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0516918 Vali Loss: 0.0530067 Test Loss: 0.0595521
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0530295
	speed: 0.0628s/iter; left time: 697.4549s
	iters: 200, epoch: 51 | loss: 0.0510417
	speed: 0.0348s/iter; left time: 383.3383s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0516617 Vali Loss: 0.0531040 Test Loss: 0.0595510
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0517732
	speed: 0.0634s/iter; left time: 689.7686s
	iters: 200, epoch: 52 | loss: 0.0523332
	speed: 0.0343s/iter; left time: 369.3020s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0517148 Vali Loss: 0.0530957 Test Loss: 0.0596316
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0531154
	speed: 0.0635s/iter; left time: 676.7211s
	iters: 200, epoch: 53 | loss: 0.0505686
	speed: 0.0338s/iter; left time: 356.9046s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:07.81s
Steps: 224 | Train Loss: 0.0516867 Vali Loss: 0.0530429 Test Loss: 0.0595754
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_24_ES_PatchTST_custom_ftM_sl336_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.00980827771127224, rmse:0.09903674572706223, mae:0.059513285756111145, rse:0.29145318269729614
Intermediate time for ES and pred_len 24: 00h:16m:07.22s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_96_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1583152
	speed: 0.0612s/iter; left time: 1364.4116s
	iters: 200, epoch: 1 | loss: 0.1448403
	speed: 0.0347s/iter; left time: 769.2951s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.30s
Steps: 224 | Train Loss: 0.1628648 Vali Loss: 0.1497765 Test Loss: 0.1801975
Validation loss decreased (inf --> 0.149776).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0921436
	speed: 0.0656s/iter; left time: 1448.2323s
	iters: 200, epoch: 2 | loss: 0.0816166
	speed: 0.0347s/iter; left time: 763.4445s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.04s
Steps: 224 | Train Loss: 0.0972727 Vali Loss: 0.0838135 Test Loss: 0.0948474
Validation loss decreased (0.149776 --> 0.083813).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0829061
	speed: 0.0658s/iter; left time: 1437.4137s
	iters: 200, epoch: 3 | loss: 0.0841351
	speed: 0.0345s/iter; left time: 751.5145s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0835706 Vali Loss: 0.0805995 Test Loss: 0.0918064
Validation loss decreased (0.083813 --> 0.080599).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0807449
	speed: 0.0665s/iter; left time: 1437.7731s
	iters: 200, epoch: 4 | loss: 0.0770914
	speed: 0.0350s/iter; left time: 753.1409s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0804804 Vali Loss: 0.0785825 Test Loss: 0.0897993
Validation loss decreased (0.080599 --> 0.078583).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0813333
	speed: 0.0674s/iter; left time: 1442.3017s
	iters: 200, epoch: 5 | loss: 0.0801107
	speed: 0.0342s/iter; left time: 728.3903s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0785711 Vali Loss: 0.0776296 Test Loss: 0.0890472
Validation loss decreased (0.078583 --> 0.077630).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0758659
	speed: 0.0673s/iter; left time: 1424.6065s
	iters: 200, epoch: 6 | loss: 0.0811755
	speed: 0.0345s/iter; left time: 727.0029s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0773020 Vali Loss: 0.0770908 Test Loss: 0.0882573
Validation loss decreased (0.077630 --> 0.077091).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0749255
	speed: 0.0656s/iter; left time: 1374.6973s
	iters: 200, epoch: 7 | loss: 0.0767308
	speed: 0.0344s/iter; left time: 717.8206s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0764460 Vali Loss: 0.0769096 Test Loss: 0.0878721
Validation loss decreased (0.077091 --> 0.076910).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0756682
	speed: 0.0659s/iter; left time: 1366.1915s
	iters: 200, epoch: 8 | loss: 0.0762002
	speed: 0.0346s/iter; left time: 714.9174s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0758666 Vali Loss: 0.0765788 Test Loss: 0.0876366
Validation loss decreased (0.076910 --> 0.076579).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0734542
	speed: 0.0664s/iter; left time: 1362.4641s
	iters: 200, epoch: 9 | loss: 0.0735278
	speed: 0.0343s/iter; left time: 700.6973s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0753596 Vali Loss: 0.0765925 Test Loss: 0.0876100
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0753230
	speed: 0.0648s/iter; left time: 1315.0359s
	iters: 200, epoch: 10 | loss: 0.0781913
	speed: 0.0352s/iter; left time: 710.0928s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.07s
Steps: 224 | Train Loss: 0.0748802 Vali Loss: 0.0762593 Test Loss: 0.0871955
Validation loss decreased (0.076579 --> 0.076259).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0749062
	speed: 0.0663s/iter; left time: 1329.3207s
	iters: 200, epoch: 11 | loss: 0.0777845
	speed: 0.0346s/iter; left time: 689.6530s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0745766 Vali Loss: 0.0759519 Test Loss: 0.0867373
Validation loss decreased (0.076259 --> 0.075952).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0746499
	speed: 0.0654s/iter; left time: 1297.0991s
	iters: 200, epoch: 12 | loss: 0.0707181
	speed: 0.0344s/iter; left time: 679.4859s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0741716 Vali Loss: 0.0759469 Test Loss: 0.0867018
Validation loss decreased (0.075952 --> 0.075947).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0738060
	speed: 0.0657s/iter; left time: 1288.3863s
	iters: 200, epoch: 13 | loss: 0.0733494
	speed: 0.0344s/iter; left time: 672.1512s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0739369 Vali Loss: 0.0760515 Test Loss: 0.0871067
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0706884
	speed: 0.0645s/iter; left time: 1249.8551s
	iters: 200, epoch: 14 | loss: 0.0737723
	speed: 0.0347s/iter; left time: 668.5379s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0736894 Vali Loss: 0.0760189 Test Loss: 0.0869981
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0755268
	speed: 0.0648s/iter; left time: 1241.5654s
	iters: 200, epoch: 15 | loss: 0.0732484
	speed: 0.0344s/iter; left time: 656.3863s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0733935 Vali Loss: 0.0757354 Test Loss: 0.0867739
Validation loss decreased (0.075947 --> 0.075735).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0715213
	speed: 0.0668s/iter; left time: 1265.6637s
	iters: 200, epoch: 16 | loss: 0.0740862
	speed: 0.0351s/iter; left time: 660.4986s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0732062 Vali Loss: 0.0755924 Test Loss: 0.0867386
Validation loss decreased (0.075735 --> 0.075592).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0706640
	speed: 0.0664s/iter; left time: 1242.7653s
	iters: 200, epoch: 17 | loss: 0.0721274
	speed: 0.0349s/iter; left time: 648.9950s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0730183 Vali Loss: 0.0758885 Test Loss: 0.0868945
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0740165
	speed: 0.0648s/iter; left time: 1199.0903s
	iters: 200, epoch: 18 | loss: 0.0715243
	speed: 0.0344s/iter; left time: 633.6386s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0728788 Vali Loss: 0.0759454 Test Loss: 0.0867216
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0722490
	speed: 0.0652s/iter; left time: 1191.9980s
	iters: 200, epoch: 19 | loss: 0.0700200
	speed: 0.0364s/iter; left time: 661.1964s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.19s
Steps: 224 | Train Loss: 0.0728002 Vali Loss: 0.0754850 Test Loss: 0.0865807
Validation loss decreased (0.075592 --> 0.075485).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0729250
	speed: 0.0663s/iter; left time: 1196.3559s
	iters: 200, epoch: 20 | loss: 0.0730267
	speed: 0.0345s/iter; left time: 619.0560s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.99s
Steps: 224 | Train Loss: 0.0726108 Vali Loss: 0.0756786 Test Loss: 0.0865085
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0720294
	speed: 0.0651s/iter; left time: 1160.8490s
	iters: 200, epoch: 21 | loss: 0.0724624
	speed: 0.0344s/iter; left time: 610.3188s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0724719 Vali Loss: 0.0756035 Test Loss: 0.0865330
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0717145
	speed: 0.0653s/iter; left time: 1149.9067s
	iters: 200, epoch: 22 | loss: 0.0705282
	speed: 0.0351s/iter; left time: 614.1707s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.06s
Steps: 224 | Train Loss: 0.0723564 Vali Loss: 0.0755396 Test Loss: 0.0866191
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0681314
	speed: 0.0642s/iter; left time: 1115.5540s
	iters: 200, epoch: 23 | loss: 0.0691133
	speed: 0.0344s/iter; left time: 595.0144s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0722308 Vali Loss: 0.0756375 Test Loss: 0.0867327
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0723156
	speed: 0.0658s/iter; left time: 1127.7112s
	iters: 200, epoch: 24 | loss: 0.0737724
	speed: 0.0348s/iter; left time: 592.6772s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0722322 Vali Loss: 0.0753499 Test Loss: 0.0864964
Validation loss decreased (0.075485 --> 0.075350).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0734103
	speed: 0.0667s/iter; left time: 1128.6299s
	iters: 200, epoch: 25 | loss: 0.0698764
	speed: 0.0343s/iter; left time: 577.0296s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0721284 Vali Loss: 0.0755213 Test Loss: 0.0866127
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0749125
	speed: 0.0646s/iter; left time: 1079.6370s
	iters: 200, epoch: 26 | loss: 0.0681941
	speed: 0.0342s/iter; left time: 568.3343s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0720451 Vali Loss: 0.0755095 Test Loss: 0.0866491
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0748759
	speed: 0.0645s/iter; left time: 1063.2388s
	iters: 200, epoch: 27 | loss: 0.0692100
	speed: 0.0343s/iter; left time: 561.8338s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0719510 Vali Loss: 0.0755535 Test Loss: 0.0866617
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0701714
	speed: 0.0656s/iter; left time: 1066.7963s
	iters: 200, epoch: 28 | loss: 0.0740284
	speed: 0.0366s/iter; left time: 590.5655s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.25s
Steps: 224 | Train Loss: 0.0718891 Vali Loss: 0.0755887 Test Loss: 0.0867537
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0725884
	speed: 0.0676s/iter; left time: 1083.1938s
	iters: 200, epoch: 29 | loss: 0.0677367
	speed: 0.0343s/iter; left time: 546.9958s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.19s
Steps: 224 | Train Loss: 0.0718561 Vali Loss: 0.0753443 Test Loss: 0.0863624
Validation loss decreased (0.075350 --> 0.075344).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0719654
	speed: 0.0654s/iter; left time: 1033.4551s
	iters: 200, epoch: 30 | loss: 0.0742018
	speed: 0.0342s/iter; left time: 537.5160s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0718349 Vali Loss: 0.0753530 Test Loss: 0.0864401
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0718995
	speed: 0.0646s/iter; left time: 1006.3866s
	iters: 200, epoch: 31 | loss: 0.0726714
	speed: 0.0341s/iter; left time: 528.4695s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0716989 Vali Loss: 0.0755160 Test Loss: 0.0866547
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0725034
	speed: 0.0645s/iter; left time: 991.1844s
	iters: 200, epoch: 32 | loss: 0.0703748
	speed: 0.0347s/iter; left time: 528.7521s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0716934 Vali Loss: 0.0754083 Test Loss: 0.0864467
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0715083
	speed: 0.0648s/iter; left time: 980.6246s
	iters: 200, epoch: 33 | loss: 0.0704834
	speed: 0.0344s/iter; left time: 517.0409s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.93s
Steps: 224 | Train Loss: 0.0716789 Vali Loss: 0.0755103 Test Loss: 0.0866822
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0697350
	speed: 0.0651s/iter; left time: 970.2827s
	iters: 200, epoch: 34 | loss: 0.0721267
	speed: 0.0348s/iter; left time: 515.9512s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0716551 Vali Loss: 0.0756040 Test Loss: 0.0869137
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0750437
	speed: 0.0646s/iter; left time: 948.6420s
	iters: 200, epoch: 35 | loss: 0.0722882
	speed: 0.0343s/iter; left time: 499.5850s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0716405 Vali Loss: 0.0754976 Test Loss: 0.0866905
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0708376
	speed: 0.0649s/iter; left time: 938.6410s
	iters: 200, epoch: 36 | loss: 0.0717003
	speed: 0.0345s/iter; left time: 495.1747s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0715762 Vali Loss: 0.0754502 Test Loss: 0.0866363
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0710196
	speed: 0.0645s/iter; left time: 917.8728s
	iters: 200, epoch: 37 | loss: 0.0715786
	speed: 0.0344s/iter; left time: 485.6077s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0715935 Vali Loss: 0.0754666 Test Loss: 0.0865808
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0731768
	speed: 0.0647s/iter; left time: 906.7087s
	iters: 200, epoch: 38 | loss: 0.0697412
	speed: 0.0345s/iter; left time: 480.2082s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.91s
Steps: 224 | Train Loss: 0.0715302 Vali Loss: 0.0754760 Test Loss: 0.0866731
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0720512
	speed: 0.0647s/iter; left time: 892.7129s
	iters: 200, epoch: 39 | loss: 0.0706587
	speed: 0.0344s/iter; left time: 470.9681s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0715180 Vali Loss: 0.0755162 Test Loss: 0.0867972
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0185981597751379, rmse:0.1363750696182251, mae:0.08636235445737839, rse:0.4006288945674896
Use GPU: cuda:0
>>>>>>>start training : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28705
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1582830
	speed: 0.0364s/iter; left time: 811.6288s
	iters: 200, epoch: 1 | loss: 0.1536793
	speed: 0.0350s/iter; left time: 776.4891s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.1618317 Vali Loss: 0.1495777 Test Loss: 0.1801662
Validation loss decreased (inf --> 0.149578).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0939178
	speed: 0.0683s/iter; left time: 1507.8242s
	iters: 200, epoch: 2 | loss: 0.0864733
	speed: 0.0345s/iter; left time: 758.7742s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0985453 Vali Loss: 0.0839609 Test Loss: 0.0956050
Validation loss decreased (0.149578 --> 0.083961).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0878430
	speed: 0.0662s/iter; left time: 1446.6138s
	iters: 200, epoch: 3 | loss: 0.0782254
	speed: 0.0345s/iter; left time: 751.0563s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:07.97s
Steps: 224 | Train Loss: 0.0840291 Vali Loss: 0.0807863 Test Loss: 0.0920472
Validation loss decreased (0.083961 --> 0.080786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0836028
	speed: 0.0658s/iter; left time: 1423.3504s
	iters: 200, epoch: 4 | loss: 0.0806706
	speed: 0.0342s/iter; left time: 737.0876s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0807939 Vali Loss: 0.0788258 Test Loss: 0.0900378
Validation loss decreased (0.080786 --> 0.078826).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0788435
	speed: 0.0655s/iter; left time: 1401.4825s
	iters: 200, epoch: 5 | loss: 0.0807367
	speed: 0.0340s/iter; left time: 723.4673s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.86s
Steps: 224 | Train Loss: 0.0788217 Vali Loss: 0.0780139 Test Loss: 0.0892532
Validation loss decreased (0.078826 --> 0.078014).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0773067
	speed: 0.0669s/iter; left time: 1415.9893s
	iters: 200, epoch: 6 | loss: 0.0772312
	speed: 0.0345s/iter; left time: 726.9079s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0775746 Vali Loss: 0.0777914 Test Loss: 0.0886277
Validation loss decreased (0.078014 --> 0.077791).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0767768
	speed: 0.0664s/iter; left time: 1390.6157s
	iters: 200, epoch: 7 | loss: 0.0746151
	speed: 0.0342s/iter; left time: 713.6030s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0767128 Vali Loss: 0.0770210 Test Loss: 0.0880919
Validation loss decreased (0.077791 --> 0.077021).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0772053
	speed: 0.0665s/iter; left time: 1377.8853s
	iters: 200, epoch: 8 | loss: 0.0728543
	speed: 0.0343s/iter; left time: 707.0327s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.94s
Steps: 224 | Train Loss: 0.0759991 Vali Loss: 0.0769128 Test Loss: 0.0879381
Validation loss decreased (0.077021 --> 0.076913).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0746797
	speed: 0.0663s/iter; left time: 1359.5577s
	iters: 200, epoch: 9 | loss: 0.0793813
	speed: 0.0342s/iter; left time: 698.7934s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:07.92s
Steps: 224 | Train Loss: 0.0754255 Vali Loss: 0.0765287 Test Loss: 0.0876836
Validation loss decreased (0.076913 --> 0.076529).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0778281
	speed: 0.0659s/iter; left time: 1336.2387s
	iters: 200, epoch: 10 | loss: 0.0760081
	speed: 0.0346s/iter; left time: 697.8025s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0749424 Vali Loss: 0.0765791 Test Loss: 0.0876946
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0761849
	speed: 0.0649s/iter; left time: 1301.6645s
	iters: 200, epoch: 11 | loss: 0.0759281
	speed: 0.0341s/iter; left time: 679.7728s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:07.88s
Steps: 224 | Train Loss: 0.0745479 Vali Loss: 0.0765141 Test Loss: 0.0871809
Validation loss decreased (0.076529 --> 0.076514).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0740213
	speed: 0.0658s/iter; left time: 1304.3973s
	iters: 200, epoch: 12 | loss: 0.0729842
	speed: 0.0345s/iter; left time: 680.1971s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0742243 Vali Loss: 0.0766330 Test Loss: 0.0873586
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0739172
	speed: 0.0656s/iter; left time: 1285.6386s
	iters: 200, epoch: 13 | loss: 0.0755008
	speed: 0.0347s/iter; left time: 677.4612s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:08.01s
Steps: 224 | Train Loss: 0.0739385 Vali Loss: 0.0763564 Test Loss: 0.0872647
Validation loss decreased (0.076514 --> 0.076356).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0703849
	speed: 0.0672s/iter; left time: 1303.7925s
	iters: 200, epoch: 14 | loss: 0.0713772
	speed: 0.0343s/iter; left time: 661.0950s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.00s
Steps: 224 | Train Loss: 0.0736357 Vali Loss: 0.0765072 Test Loss: 0.0869802
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0685526
	speed: 0.0641s/iter; left time: 1229.4245s
	iters: 200, epoch: 15 | loss: 0.0744490
	speed: 0.0343s/iter; left time: 654.4413s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.90s
Steps: 224 | Train Loss: 0.0733645 Vali Loss: 0.0765096 Test Loss: 0.0869906
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0745860
	speed: 0.0650s/iter; left time: 1231.3518s
	iters: 200, epoch: 16 | loss: 0.0714565
	speed: 0.0344s/iter; left time: 647.7390s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.96s
Steps: 224 | Train Loss: 0.0731870 Vali Loss: 0.0763907 Test Loss: 0.0867740
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0767808
	speed: 0.0648s/iter; left time: 1213.3498s
	iters: 200, epoch: 17 | loss: 0.0734670
	speed: 0.0340s/iter; left time: 632.6854s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.89s
Steps: 224 | Train Loss: 0.0729853 Vali Loss: 0.0765046 Test Loss: 0.0869768
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0747071
	speed: 0.0656s/iter; left time: 1212.3278s
	iters: 200, epoch: 18 | loss: 0.0728723
	speed: 0.0343s/iter; left time: 631.1419s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.03s
Steps: 224 | Train Loss: 0.0727439 Vali Loss: 0.0765303 Test Loss: 0.0870398
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0708978
	speed: 0.0658s/iter; left time: 1202.2714s
	iters: 200, epoch: 19 | loss: 0.0723809
	speed: 0.0346s/iter; left time: 629.1745s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.98s
Steps: 224 | Train Loss: 0.0725793 Vali Loss: 0.0764471 Test Loss: 0.0870042
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0734421
	speed: 0.0691s/iter; left time: 1246.2761s
	iters: 200, epoch: 20 | loss: 0.0769663
	speed: 0.0345s/iter; left time: 618.9955s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:08.32s
Steps: 224 | Train Loss: 0.0725307 Vali Loss: 0.0765048 Test Loss: 0.0870345
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0716774
	speed: 0.0658s/iter; left time: 1173.5035s
	iters: 200, epoch: 21 | loss: 0.0718850
	speed: 0.0345s/iter; left time: 612.0994s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.05s
Steps: 224 | Train Loss: 0.0723870 Vali Loss: 0.0766452 Test Loss: 0.0869602
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0720396
	speed: 0.0649s/iter; left time: 1142.3563s
	iters: 200, epoch: 22 | loss: 0.0696126
	speed: 0.0343s/iter; left time: 600.8294s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0722414 Vali Loss: 0.0765089 Test Loss: 0.0867656
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0730018
	speed: 0.0649s/iter; left time: 1127.8702s
	iters: 200, epoch: 23 | loss: 0.0753521
	speed: 0.0343s/iter; left time: 592.2055s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.95s
Steps: 224 | Train Loss: 0.0721670 Vali Loss: 0.0766542 Test Loss: 0.0870228
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_96_ES_PatchTST_custom_ftM_sl336_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018632538616657257, rmse:0.13650105893611908, mae:0.08726463466882706, rse:0.4009990394115448
Intermediate time for ES and pred_len 96: 00h:10m:34.16s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_336_168_ES', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=336, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1581242
	speed: 0.0689s/iter; left time: 1528.7480s
	iters: 200, epoch: 1 | loss: 0.1507171
	speed: 0.0361s/iter; left time: 797.9049s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.56s
Steps: 223 | Train Loss: 0.1638708 Vali Loss: 0.1523550 Test Loss: 0.1819388
Validation loss decreased (inf --> 0.152355).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0986643
	speed: 0.0680s/iter; left time: 1495.1640s
	iters: 200, epoch: 2 | loss: 0.0934433
	speed: 0.0354s/iter; left time: 773.8502s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.1013446 Vali Loss: 0.0890421 Test Loss: 0.1011388
Validation loss decreased (0.152355 --> 0.089042).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0940395
	speed: 0.0664s/iter; left time: 1444.6917s
	iters: 200, epoch: 3 | loss: 0.0868575
	speed: 0.0351s/iter; left time: 760.9128s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0888059 Vali Loss: 0.0860402 Test Loss: 0.0980579
Validation loss decreased (0.089042 --> 0.086040).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0851304
	speed: 0.0673s/iter; left time: 1448.8477s
	iters: 200, epoch: 4 | loss: 0.0841597
	speed: 0.0352s/iter; left time: 753.3763s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0857711 Vali Loss: 0.0841981 Test Loss: 0.0959112
Validation loss decreased (0.086040 --> 0.084198).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0825492
	speed: 0.0667s/iter; left time: 1422.2021s
	iters: 200, epoch: 5 | loss: 0.0825241
	speed: 0.0346s/iter; left time: 734.7796s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.03s
Steps: 223 | Train Loss: 0.0838901 Vali Loss: 0.0835975 Test Loss: 0.0951364
Validation loss decreased (0.084198 --> 0.083597).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0831312
	speed: 0.0664s/iter; left time: 1399.8241s
	iters: 200, epoch: 6 | loss: 0.0821218
	speed: 0.0349s/iter; left time: 731.6440s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0827609 Vali Loss: 0.0835203 Test Loss: 0.0949269
Validation loss decreased (0.083597 --> 0.083520).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0847962
	speed: 0.0669s/iter; left time: 1395.8924s
	iters: 200, epoch: 7 | loss: 0.0801695
	speed: 0.0350s/iter; left time: 725.8276s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0820128 Vali Loss: 0.0828906 Test Loss: 0.0942042
Validation loss decreased (0.083520 --> 0.082891).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0826582
	speed: 0.0661s/iter; left time: 1364.9834s
	iters: 200, epoch: 8 | loss: 0.0829372
	speed: 0.0352s/iter; left time: 722.1369s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0813807 Vali Loss: 0.0829064 Test Loss: 0.0940305
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0785602
	speed: 0.0651s/iter; left time: 1328.5128s
	iters: 200, epoch: 9 | loss: 0.0813846
	speed: 0.0358s/iter; left time: 726.9449s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.0808702 Vali Loss: 0.0826419 Test Loss: 0.0939117
Validation loss decreased (0.082891 --> 0.082642).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0784310
	speed: 0.0666s/iter; left time: 1345.3745s
	iters: 200, epoch: 10 | loss: 0.0772360
	speed: 0.0347s/iter; left time: 696.9522s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0803654 Vali Loss: 0.0824731 Test Loss: 0.0937046
Validation loss decreased (0.082642 --> 0.082473).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0798821
	speed: 0.0671s/iter; left time: 1340.7770s
	iters: 200, epoch: 11 | loss: 0.0784780
	speed: 0.0350s/iter; left time: 695.5121s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.0799386 Vali Loss: 0.0822538 Test Loss: 0.0935915
Validation loss decreased (0.082473 --> 0.082254).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0809544
	speed: 0.0677s/iter; left time: 1336.4860s
	iters: 200, epoch: 12 | loss: 0.0804690
	speed: 0.0349s/iter; left time: 685.9779s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.0795472 Vali Loss: 0.0822670 Test Loss: 0.0936214
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0796984
	speed: 0.0661s/iter; left time: 1289.7716s
	iters: 200, epoch: 13 | loss: 0.0766402
	speed: 0.0346s/iter; left time: 671.4164s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0792191 Vali Loss: 0.0818180 Test Loss: 0.0939182
Validation loss decreased (0.082254 --> 0.081818).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0797491
	speed: 0.0672s/iter; left time: 1296.1919s
	iters: 200, epoch: 14 | loss: 0.0768970
	speed: 0.0350s/iter; left time: 671.4356s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0789267 Vali Loss: 0.0818768 Test Loss: 0.0939726
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0793521
	speed: 0.0655s/iter; left time: 1250.5548s
	iters: 200, epoch: 15 | loss: 0.0760051
	speed: 0.0346s/iter; left time: 657.4043s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0786685 Vali Loss: 0.0820166 Test Loss: 0.0940066
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786998
	speed: 0.0658s/iter; left time: 1240.9156s
	iters: 200, epoch: 16 | loss: 0.0790844
	speed: 0.0347s/iter; left time: 651.7369s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0784924 Vali Loss: 0.0818277 Test Loss: 0.0944564
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0776468
	speed: 0.0665s/iter; left time: 1238.5488s
	iters: 200, epoch: 17 | loss: 0.0762781
	speed: 0.0347s/iter; left time: 642.6656s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0782404 Vali Loss: 0.0818648 Test Loss: 0.0947103
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0797928
	speed: 0.0657s/iter; left time: 1208.8282s
	iters: 200, epoch: 18 | loss: 0.0767054
	speed: 0.0349s/iter; left time: 638.7553s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0780503 Vali Loss: 0.0820865 Test Loss: 0.0952556
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0800530
	speed: 0.0672s/iter; left time: 1222.8283s
	iters: 200, epoch: 19 | loss: 0.0773672
	speed: 0.0348s/iter; left time: 629.5294s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:08.06s
Steps: 223 | Train Loss: 0.0779013 Vali Loss: 0.0819001 Test Loss: 0.0952660
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0764023
	speed: 0.0654s/iter; left time: 1175.2099s
	iters: 200, epoch: 20 | loss: 0.0789287
	speed: 0.0346s/iter; left time: 618.5432s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0777259 Vali Loss: 0.0817606 Test Loss: 0.0951863
Validation loss decreased (0.081818 --> 0.081761).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0766384
	speed: 0.0676s/iter; left time: 1199.6317s
	iters: 200, epoch: 21 | loss: 0.0782197
	speed: 0.0358s/iter; left time: 630.8749s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.24s
Steps: 223 | Train Loss: 0.0775856 Vali Loss: 0.0819180 Test Loss: 0.0953271
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0756970
	speed: 0.0652s/iter; left time: 1142.9382s
	iters: 200, epoch: 22 | loss: 0.0782074
	speed: 0.0346s/iter; left time: 603.2651s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0774701 Vali Loss: 0.0816166 Test Loss: 0.0955943
Validation loss decreased (0.081761 --> 0.081617).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0767044
	speed: 0.0682s/iter; left time: 1179.0716s
	iters: 200, epoch: 23 | loss: 0.0780989
	speed: 0.0353s/iter; left time: 607.7992s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0773348 Vali Loss: 0.0818224 Test Loss: 0.0957033
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0800862
	speed: 0.0649s/iter; left time: 1107.8149s
	iters: 200, epoch: 24 | loss: 0.0712628
	speed: 0.0354s/iter; left time: 600.4993s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:08.15s
Steps: 223 | Train Loss: 0.0772094 Vali Loss: 0.0816642 Test Loss: 0.0957151
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0788048
	speed: 0.0697s/iter; left time: 1174.6549s
	iters: 200, epoch: 25 | loss: 0.0728152
	speed: 0.0392s/iter; left time: 656.0673s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:08.82s
Steps: 223 | Train Loss: 0.0771515 Vali Loss: 0.0817642 Test Loss: 0.0957897
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0781624
	speed: 0.0662s/iter; left time: 1101.1165s
	iters: 200, epoch: 26 | loss: 0.0739947
	speed: 0.0346s/iter; left time: 571.0519s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0770992 Vali Loss: 0.0816698 Test Loss: 0.0958092
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0785158
	speed: 0.0653s/iter; left time: 1070.8971s
	iters: 200, epoch: 27 | loss: 0.0776058
	speed: 0.0345s/iter; left time: 562.8449s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0770031 Vali Loss: 0.0817289 Test Loss: 0.0957823
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0762650
	speed: 0.0649s/iter; left time: 1049.7568s
	iters: 200, epoch: 28 | loss: 0.0730262
	speed: 0.0349s/iter; left time: 560.7453s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0769375 Vali Loss: 0.0817190 Test Loss: 0.0960716
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0779013
	speed: 0.0660s/iter; left time: 1053.8148s
	iters: 200, epoch: 29 | loss: 0.0780241
	speed: 0.0346s/iter; left time: 548.5717s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.99s
Steps: 223 | Train Loss: 0.0768650 Vali Loss: 0.0818699 Test Loss: 0.0961976
EarlyStopping counter: 7 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0775625
	speed: 0.0662s/iter; left time: 1042.0484s
	iters: 200, epoch: 30 | loss: 0.0751118
	speed: 0.0356s/iter; left time: 556.9212s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.16s
Steps: 223 | Train Loss: 0.0768085 Vali Loss: 0.0818688 Test Loss: 0.0963391
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0737045
	speed: 0.0660s/iter; left time: 1023.8356s
	iters: 200, epoch: 31 | loss: 0.0770995
	speed: 0.0350s/iter; left time: 539.7393s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0767635 Vali Loss: 0.0816762 Test Loss: 0.0960850
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0781929
	speed: 0.0657s/iter; left time: 1004.8351s
	iters: 200, epoch: 32 | loss: 0.0797998
	speed: 0.0346s/iter; left time: 525.7411s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0767546 Vali Loss: 0.0817475 Test Loss: 0.0963959
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02126566879451275, rmse:0.1458275318145752, mae:0.0955943912267685, rse:0.42842817306518555
Use GPU: cuda:0
>>>>>>>start training : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28633
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1622073
	speed: 0.0371s/iter; left time: 824.2287s
	iters: 200, epoch: 1 | loss: 0.1511776
	speed: 0.0348s/iter; left time: 770.2011s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.1635544 Vali Loss: 0.1513875 Test Loss: 0.1804619
Validation loss decreased (inf --> 0.151388).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0963681
	speed: 0.0682s/iter; left time: 1497.9875s
	iters: 200, epoch: 2 | loss: 0.0897276
	speed: 0.0349s/iter; left time: 764.6041s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:08.09s
Steps: 223 | Train Loss: 0.1009506 Vali Loss: 0.0887425 Test Loss: 0.1008672
Validation loss decreased (0.151388 --> 0.088743).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0909871
	speed: 0.0707s/iter; left time: 1537.4113s
	iters: 200, epoch: 3 | loss: 0.0840339
	speed: 0.0377s/iter; left time: 815.7440s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:08.59s
Steps: 223 | Train Loss: 0.0886917 Vali Loss: 0.0861339 Test Loss: 0.0982522
Validation loss decreased (0.088743 --> 0.086134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0863238
	speed: 0.0692s/iter; left time: 1489.5158s
	iters: 200, epoch: 4 | loss: 0.0863077
	speed: 0.0350s/iter; left time: 749.3794s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.0857665 Vali Loss: 0.0844378 Test Loss: 0.0962862
Validation loss decreased (0.086134 --> 0.084438).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0852887
	speed: 0.0684s/iter; left time: 1457.8487s
	iters: 200, epoch: 5 | loss: 0.0826804
	speed: 0.0353s/iter; left time: 747.9916s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:08.16s
Steps: 223 | Train Loss: 0.0839180 Vali Loss: 0.0839240 Test Loss: 0.0957661
Validation loss decreased (0.084438 --> 0.083924).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0836342
	speed: 0.0703s/iter; left time: 1482.6421s
	iters: 200, epoch: 6 | loss: 0.0806390
	speed: 0.0373s/iter; left time: 783.4667s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:08.55s
Steps: 223 | Train Loss: 0.0828160 Vali Loss: 0.0837571 Test Loss: 0.0950037
Validation loss decreased (0.083924 --> 0.083757).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0857420
	speed: 0.0682s/iter; left time: 1423.2851s
	iters: 200, epoch: 7 | loss: 0.0848666
	speed: 0.0350s/iter; left time: 727.4349s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0820557 Vali Loss: 0.0831144 Test Loss: 0.0942615
Validation loss decreased (0.083757 --> 0.083114).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0834368
	speed: 0.0696s/iter; left time: 1435.6608s
	iters: 200, epoch: 8 | loss: 0.0797058
	speed: 0.0350s/iter; left time: 719.8850s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:08.21s
Steps: 223 | Train Loss: 0.0814393 Vali Loss: 0.0832333 Test Loss: 0.0942153
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0792525
	speed: 0.0665s/iter; left time: 1357.0644s
	iters: 200, epoch: 9 | loss: 0.0831456
	speed: 0.0354s/iter; left time: 718.8148s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0809265 Vali Loss: 0.0834103 Test Loss: 0.0940458
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0839281
	speed: 0.0671s/iter; left time: 1355.8758s
	iters: 200, epoch: 10 | loss: 0.0820906
	speed: 0.0354s/iter; left time: 711.1119s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:08.13s
Steps: 223 | Train Loss: 0.0804400 Vali Loss: 0.0831343 Test Loss: 0.0936590
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0800651
	speed: 0.0672s/iter; left time: 1342.3950s
	iters: 200, epoch: 11 | loss: 0.0795596
	speed: 0.0351s/iter; left time: 696.7907s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:08.14s
Steps: 223 | Train Loss: 0.0799918 Vali Loss: 0.0829600 Test Loss: 0.0931671
Validation loss decreased (0.083114 --> 0.082960).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0811823
	speed: 0.0679s/iter; left time: 1341.1906s
	iters: 200, epoch: 12 | loss: 0.0830218
	speed: 0.0348s/iter; left time: 684.0976s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0796409 Vali Loss: 0.0829638 Test Loss: 0.0932920
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0763461
	speed: 0.0661s/iter; left time: 1291.0902s
	iters: 200, epoch: 13 | loss: 0.0818228
	speed: 0.0344s/iter; left time: 667.3773s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0793178 Vali Loss: 0.0828459 Test Loss: 0.0931148
Validation loss decreased (0.082960 --> 0.082846).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0800062
	speed: 0.0671s/iter; left time: 1294.3812s
	iters: 200, epoch: 14 | loss: 0.0819832
	speed: 0.0345s/iter; left time: 663.3308s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0789994 Vali Loss: 0.0825182 Test Loss: 0.0933117
Validation loss decreased (0.082846 --> 0.082518).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0812188
	speed: 0.0680s/iter; left time: 1297.1837s
	iters: 200, epoch: 15 | loss: 0.0769876
	speed: 0.0345s/iter; left time: 654.2046s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0787149 Vali Loss: 0.0826182 Test Loss: 0.0934537
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0786891
	speed: 0.0665s/iter; left time: 1254.5914s
	iters: 200, epoch: 16 | loss: 0.0829321
	speed: 0.0346s/iter; left time: 648.0698s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0785222 Vali Loss: 0.0824578 Test Loss: 0.0933246
Validation loss decreased (0.082518 --> 0.082458).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0766105
	speed: 0.0660s/iter; left time: 1228.8647s
	iters: 200, epoch: 17 | loss: 0.0775430
	speed: 0.0345s/iter; left time: 639.5157s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0782164 Vali Loss: 0.0823364 Test Loss: 0.0936304
Validation loss decreased (0.082458 --> 0.082336).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0737783
	speed: 0.0679s/iter; left time: 1249.5334s
	iters: 200, epoch: 18 | loss: 0.0795119
	speed: 0.0345s/iter; left time: 631.7772s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0780388 Vali Loss: 0.0823434 Test Loss: 0.0939227
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0779562
	speed: 0.0664s/iter; left time: 1207.5432s
	iters: 200, epoch: 19 | loss: 0.0744572
	speed: 0.0346s/iter; left time: 625.0926s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0778180 Vali Loss: 0.0823256 Test Loss: 0.0938507
Validation loss decreased (0.082336 --> 0.082326).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0811709
	speed: 0.0665s/iter; left time: 1194.6992s
	iters: 200, epoch: 20 | loss: 0.0786681
	speed: 0.0345s/iter; left time: 615.5700s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.93s
Steps: 223 | Train Loss: 0.0775951 Vali Loss: 0.0823114 Test Loss: 0.0941019
Validation loss decreased (0.082326 --> 0.082311).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0748576
	speed: 0.0672s/iter; left time: 1193.0233s
	iters: 200, epoch: 21 | loss: 0.0787515
	speed: 0.0348s/iter; left time: 613.8924s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:08.05s
Steps: 223 | Train Loss: 0.0774586 Vali Loss: 0.0820314 Test Loss: 0.0940175
Validation loss decreased (0.082311 --> 0.082031).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0802003
	speed: 0.0674s/iter; left time: 1180.7295s
	iters: 200, epoch: 22 | loss: 0.0754237
	speed: 0.0348s/iter; left time: 606.5265s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0773000 Vali Loss: 0.0820159 Test Loss: 0.0942531
Validation loss decreased (0.082031 --> 0.082016).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0779743
	speed: 0.0678s/iter; left time: 1172.8826s
	iters: 200, epoch: 23 | loss: 0.0747215
	speed: 0.0350s/iter; left time: 601.5548s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:08.07s
Steps: 223 | Train Loss: 0.0772234 Vali Loss: 0.0822244 Test Loss: 0.0947550
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0775924
	speed: 0.0665s/iter; left time: 1135.0784s
	iters: 200, epoch: 24 | loss: 0.0774336
	speed: 0.0345s/iter; left time: 585.2632s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.96s
Steps: 223 | Train Loss: 0.0770066 Vali Loss: 0.0819901 Test Loss: 0.0946638
Validation loss decreased (0.082016 --> 0.081990).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0765772
	speed: 0.0670s/iter; left time: 1128.2230s
	iters: 200, epoch: 25 | loss: 0.0774296
	speed: 0.0347s/iter; left time: 580.7599s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0769184 Vali Loss: 0.0818508 Test Loss: 0.0945564
Validation loss decreased (0.081990 --> 0.081851).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0752274
	speed: 0.0670s/iter; left time: 1114.0727s
	iters: 200, epoch: 26 | loss: 0.0780611
	speed: 0.0348s/iter; left time: 574.5183s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0768677 Vali Loss: 0.0820124 Test Loss: 0.0949415
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0767367
	speed: 0.0670s/iter; left time: 1098.4792s
	iters: 200, epoch: 27 | loss: 0.0761459
	speed: 0.0363s/iter; left time: 591.3927s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:08.23s
Steps: 223 | Train Loss: 0.0767765 Vali Loss: 0.0820813 Test Loss: 0.0948841
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0743221
	speed: 0.0684s/iter; left time: 1107.3506s
	iters: 200, epoch: 28 | loss: 0.0752958
	speed: 0.0351s/iter; left time: 564.8987s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:08.21s
Steps: 223 | Train Loss: 0.0767860 Vali Loss: 0.0819307 Test Loss: 0.0946716
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0782983
	speed: 0.0666s/iter; left time: 1063.0058s
	iters: 200, epoch: 29 | loss: 0.0778854
	speed: 0.0357s/iter; left time: 566.2292s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:08.19s
Steps: 223 | Train Loss: 0.0766185 Vali Loss: 0.0818122 Test Loss: 0.0950429
Validation loss decreased (0.081851 --> 0.081812).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0740042
	speed: 0.0673s/iter; left time: 1059.5981s
	iters: 200, epoch: 30 | loss: 0.0801981
	speed: 0.0345s/iter; left time: 538.7677s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.98s
Steps: 223 | Train Loss: 0.0765305 Vali Loss: 0.0820920 Test Loss: 0.0952042
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0767182
	speed: 0.0653s/iter; left time: 1013.0907s
	iters: 200, epoch: 31 | loss: 0.0758625
	speed: 0.0346s/iter; left time: 532.5713s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0765871 Vali Loss: 0.0818485 Test Loss: 0.0951992
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0781168
	speed: 0.0670s/iter; left time: 1024.4357s
	iters: 200, epoch: 32 | loss: 0.0793877
	speed: 0.0352s/iter; left time: 535.2964s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:08.10s
Steps: 223 | Train Loss: 0.0764493 Vali Loss: 0.0820237 Test Loss: 0.0955673
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0740315
	speed: 0.0654s/iter; left time: 985.6079s
	iters: 200, epoch: 33 | loss: 0.0757111
	speed: 0.0347s/iter; left time: 519.9320s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.97s
Steps: 223 | Train Loss: 0.0763936 Vali Loss: 0.0819379 Test Loss: 0.0954416
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0753173
	speed: 0.0657s/iter; left time: 974.7022s
	iters: 200, epoch: 34 | loss: 0.0706699
	speed: 0.0352s/iter; left time: 518.4988s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:08.04s
Steps: 223 | Train Loss: 0.0763890 Vali Loss: 0.0819006 Test Loss: 0.0955024
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0773871
	speed: 0.0655s/iter; left time: 957.2772s
	iters: 200, epoch: 35 | loss: 0.0741799
	speed: 0.0349s/iter; left time: 507.1043s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:08.00s
Steps: 223 | Train Loss: 0.0763201 Vali Loss: 0.0818680 Test Loss: 0.0954335
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0785499
	speed: 0.0652s/iter; left time: 938.3553s
	iters: 200, epoch: 36 | loss: 0.0738299
	speed: 0.0345s/iter; left time: 493.6335s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:07.94s
Steps: 223 | Train Loss: 0.0762440 Vali Loss: 0.0819575 Test Loss: 0.0954877
EarlyStopping counter: 7 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0755313
	speed: 0.0655s/iter; left time: 927.8703s
	iters: 200, epoch: 37 | loss: 0.0735468
	speed: 0.0346s/iter; left time: 487.5966s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:08.01s
Steps: 223 | Train Loss: 0.0762236 Vali Loss: 0.0820155 Test Loss: 0.0955825
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0732269
	speed: 0.0676s/iter; left time: 943.2274s
	iters: 200, epoch: 38 | loss: 0.0770698
	speed: 0.0344s/iter; left time: 476.4420s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:08.02s
Steps: 223 | Train Loss: 0.0762167 Vali Loss: 0.0818996 Test Loss: 0.0954762
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0765640
	speed: 0.0662s/iter; left time: 908.9614s
	iters: 200, epoch: 39 | loss: 0.0754804
	speed: 0.0351s/iter; left time: 478.1954s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:08.08s
Steps: 223 | Train Loss: 0.0761922 Vali Loss: 0.0818792 Test Loss: 0.0953627
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_336_168_ES_PatchTST_custom_ftM_sl336_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02110309898853302, rmse:0.14526905119419098, mae:0.09504284709692001, rse:0.42678743600845337
Intermediate time for ES and pred_len 168: 00h:12m:17.38sIntermediate time for ES: 00h:38m:58.75s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_24_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1181538
	speed: 0.0512s/iter; left time: 1151.7002s
	iters: 200, epoch: 1 | loss: 0.1003178
	speed: 0.0244s/iter; left time: 547.6969s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.12s
Steps: 226 | Train Loss: 0.1170270 Vali Loss: 0.1172993 Test Loss: 0.1302999
Validation loss decreased (inf --> 0.117299).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0619097
	speed: 0.0472s/iter; left time: 1051.0409s
	iters: 200, epoch: 2 | loss: 0.0544771
	speed: 0.0240s/iter; left time: 531.5294s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.68s
Steps: 226 | Train Loss: 0.0654789 Vali Loss: 0.0618007 Test Loss: 0.0638786
Validation loss decreased (0.117299 --> 0.061801).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0528410
	speed: 0.0478s/iter; left time: 1052.9309s
	iters: 200, epoch: 3 | loss: 0.0507370
	speed: 0.0283s/iter; left time: 620.3621s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.07s
Steps: 226 | Train Loss: 0.0510558 Vali Loss: 0.0580366 Test Loss: 0.0603052
Validation loss decreased (0.061801 --> 0.058037).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0520147
	speed: 0.0497s/iter; left time: 1085.1892s
	iters: 200, epoch: 4 | loss: 0.0432217
	speed: 0.0323s/iter; left time: 700.9857s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.88s
Steps: 226 | Train Loss: 0.0484834 Vali Loss: 0.0563872 Test Loss: 0.0588450
Validation loss decreased (0.058037 --> 0.056387).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0448531
	speed: 0.0473s/iter; left time: 1022.4748s
	iters: 200, epoch: 5 | loss: 0.0467714
	speed: 0.0289s/iter; left time: 621.1112s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.39s
Steps: 226 | Train Loss: 0.0468747 Vali Loss: 0.0547840 Test Loss: 0.0575932
Validation loss decreased (0.056387 --> 0.054784).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0465157
	speed: 0.0549s/iter; left time: 1172.4276s
	iters: 200, epoch: 6 | loss: 0.0471361
	speed: 0.0298s/iter; left time: 633.5342s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.88s
Steps: 226 | Train Loss: 0.0456765 Vali Loss: 0.0538354 Test Loss: 0.0568870
Validation loss decreased (0.054784 --> 0.053835).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0464228
	speed: 0.0506s/iter; left time: 1070.3317s
	iters: 200, epoch: 7 | loss: 0.0428562
	speed: 0.0207s/iter; left time: 434.8164s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.52s
Steps: 226 | Train Loss: 0.0448067 Vali Loss: 0.0531672 Test Loss: 0.0561855
Validation loss decreased (0.053835 --> 0.053167).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0414287
	speed: 0.0514s/iter; left time: 1075.8979s
	iters: 200, epoch: 8 | loss: 0.0414663
	speed: 0.0231s/iter; left time: 480.8997s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.19s
Steps: 226 | Train Loss: 0.0441156 Vali Loss: 0.0528043 Test Loss: 0.0558938
Validation loss decreased (0.053167 --> 0.052804).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0396454
	speed: 0.0497s/iter; left time: 1027.8371s
	iters: 200, epoch: 9 | loss: 0.0445222
	speed: 0.0263s/iter; left time: 541.2762s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.91s
Steps: 226 | Train Loss: 0.0437219 Vali Loss: 0.0524473 Test Loss: 0.0555881
Validation loss decreased (0.052804 --> 0.052447).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0465342
	speed: 0.0490s/iter; left time: 1003.1988s
	iters: 200, epoch: 10 | loss: 0.0447787
	speed: 0.0282s/iter; left time: 574.5490s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.37s
Steps: 226 | Train Loss: 0.0433464 Vali Loss: 0.0524429 Test Loss: 0.0555543
Validation loss decreased (0.052447 --> 0.052443).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0463950
	speed: 0.0465s/iter; left time: 941.8945s
	iters: 200, epoch: 11 | loss: 0.0471261
	speed: 0.0262s/iter; left time: 527.7628s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.89s
Steps: 226 | Train Loss: 0.0430885 Vali Loss: 0.0520855 Test Loss: 0.0553389
Validation loss decreased (0.052443 --> 0.052086).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0440239
	speed: 0.0500s/iter; left time: 1000.4495s
	iters: 200, epoch: 12 | loss: 0.0431861
	speed: 0.0253s/iter; left time: 503.8990s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.17s
Steps: 226 | Train Loss: 0.0427594 Vali Loss: 0.0520969 Test Loss: 0.0552671
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0460427
	speed: 0.0483s/iter; left time: 955.3089s
	iters: 200, epoch: 13 | loss: 0.0407886
	speed: 0.0235s/iter; left time: 462.2638s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.66s
Steps: 226 | Train Loss: 0.0425987 Vali Loss: 0.0519302 Test Loss: 0.0550461
Validation loss decreased (0.052086 --> 0.051930).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0436107
	speed: 0.0523s/iter; left time: 1022.8773s
	iters: 200, epoch: 14 | loss: 0.0460468
	speed: 0.0294s/iter; left time: 573.0106s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.05s
Steps: 226 | Train Loss: 0.0424552 Vali Loss: 0.0518532 Test Loss: 0.0550036
Validation loss decreased (0.051930 --> 0.051853).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0402645
	speed: 0.0567s/iter; left time: 1095.9107s
	iters: 200, epoch: 15 | loss: 0.0445272
	speed: 0.0292s/iter; left time: 561.8909s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:07.05s
Steps: 226 | Train Loss: 0.0422743 Vali Loss: 0.0517325 Test Loss: 0.0548619
Validation loss decreased (0.051853 --> 0.051732).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0438543
	speed: 0.0456s/iter; left time: 871.5470s
	iters: 200, epoch: 16 | loss: 0.0432302
	speed: 0.0214s/iter; left time: 406.9359s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.15s
Steps: 226 | Train Loss: 0.0421779 Vali Loss: 0.0516198 Test Loss: 0.0546895
Validation loss decreased (0.051732 --> 0.051620).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0420478
	speed: 0.0502s/iter; left time: 948.6092s
	iters: 200, epoch: 17 | loss: 0.0416950
	speed: 0.0257s/iter; left time: 482.7325s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0420557 Vali Loss: 0.0514453 Test Loss: 0.0546779
Validation loss decreased (0.051620 --> 0.051445).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0412639
	speed: 0.0495s/iter; left time: 923.9595s
	iters: 200, epoch: 18 | loss: 0.0401191
	speed: 0.0261s/iter; left time: 483.6662s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.96s
Steps: 226 | Train Loss: 0.0419732 Vali Loss: 0.0515109 Test Loss: 0.0546205
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0420400
	speed: 0.0477s/iter; left time: 878.9548s
	iters: 200, epoch: 19 | loss: 0.0422216
	speed: 0.0273s/iter; left time: 500.1741s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.50s
Steps: 226 | Train Loss: 0.0418645 Vali Loss: 0.0514373 Test Loss: 0.0545614
Validation loss decreased (0.051445 --> 0.051437).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0434768
	speed: 0.0474s/iter; left time: 862.3987s
	iters: 200, epoch: 20 | loss: 0.0388558
	speed: 0.0210s/iter; left time: 380.7805s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.49s
Steps: 226 | Train Loss: 0.0417754 Vali Loss: 0.0513995 Test Loss: 0.0544768
Validation loss decreased (0.051437 --> 0.051399).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0394034
	speed: 0.0493s/iter; left time: 885.8111s
	iters: 200, epoch: 21 | loss: 0.0404570
	speed: 0.0265s/iter; left time: 473.9557s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0417436 Vali Loss: 0.0513565 Test Loss: 0.0544110
Validation loss decreased (0.051399 --> 0.051356).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0408854
	speed: 0.0488s/iter; left time: 866.0392s
	iters: 200, epoch: 22 | loss: 0.0402349
	speed: 0.0264s/iter; left time: 465.7414s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.13s
Steps: 226 | Train Loss: 0.0416521 Vali Loss: 0.0513761 Test Loss: 0.0544329
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0412479
	speed: 0.0558s/iter; left time: 977.2998s
	iters: 200, epoch: 23 | loss: 0.0419215
	speed: 0.0300s/iter; left time: 522.4368s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.10s
Steps: 226 | Train Loss: 0.0416237 Vali Loss: 0.0514683 Test Loss: 0.0544846
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0403025
	speed: 0.0490s/iter; left time: 847.3580s
	iters: 200, epoch: 24 | loss: 0.0403031
	speed: 0.0186s/iter; left time: 320.7997s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.40s
Steps: 226 | Train Loss: 0.0415419 Vali Loss: 0.0513075 Test Loss: 0.0543513
Validation loss decreased (0.051356 --> 0.051307).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0388115
	speed: 0.0412s/iter; left time: 703.9726s
	iters: 200, epoch: 25 | loss: 0.0417404
	speed: 0.0260s/iter; left time: 441.6500s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.44s
Steps: 226 | Train Loss: 0.0415224 Vali Loss: 0.0511409 Test Loss: 0.0542526
Validation loss decreased (0.051307 --> 0.051141).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0413413
	speed: 0.0429s/iter; left time: 722.6165s
	iters: 200, epoch: 26 | loss: 0.0387699
	speed: 0.0256s/iter; left time: 428.5616s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.62s
Steps: 226 | Train Loss: 0.0415136 Vali Loss: 0.0512980 Test Loss: 0.0542906
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0426343
	speed: 0.0534s/iter; left time: 887.9830s
	iters: 200, epoch: 27 | loss: 0.0408687
	speed: 0.0277s/iter; left time: 458.1653s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.81s
Steps: 226 | Train Loss: 0.0414671 Vali Loss: 0.0512499 Test Loss: 0.0542798
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0407607
	speed: 0.0511s/iter; left time: 837.4815s
	iters: 200, epoch: 28 | loss: 0.0404382
	speed: 0.0244s/iter; left time: 396.8897s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.00s
Steps: 226 | Train Loss: 0.0414232 Vali Loss: 0.0511967 Test Loss: 0.0542340
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0418660
	speed: 0.0486s/iter; left time: 785.9019s
	iters: 200, epoch: 29 | loss: 0.0461494
	speed: 0.0233s/iter; left time: 374.4616s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.94s
Steps: 226 | Train Loss: 0.0414108 Vali Loss: 0.0511942 Test Loss: 0.0542963
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0387321
	speed: 0.0491s/iter; left time: 782.7273s
	iters: 200, epoch: 30 | loss: 0.0443478
	speed: 0.0236s/iter; left time: 373.7893s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.98s
Steps: 226 | Train Loss: 0.0413687 Vali Loss: 0.0511919 Test Loss: 0.0541996
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0386426
	speed: 0.0491s/iter; left time: 772.4493s
	iters: 200, epoch: 31 | loss: 0.0406933
	speed: 0.0250s/iter; left time: 389.7458s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.04s
Steps: 226 | Train Loss: 0.0413150 Vali Loss: 0.0510859 Test Loss: 0.0542480
Validation loss decreased (0.051141 --> 0.051086).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0413825
	speed: 0.0497s/iter; left time: 769.9086s
	iters: 200, epoch: 32 | loss: 0.0430385
	speed: 0.0265s/iter; left time: 407.9187s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.24s
Steps: 226 | Train Loss: 0.0413569 Vali Loss: 0.0511404 Test Loss: 0.0542026
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0414003
	speed: 0.0488s/iter; left time: 744.4190s
	iters: 200, epoch: 33 | loss: 0.0416502
	speed: 0.0220s/iter; left time: 333.4741s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.60s
Steps: 226 | Train Loss: 0.0413078 Vali Loss: 0.0511158 Test Loss: 0.0542135
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0440531
	speed: 0.0431s/iter; left time: 648.1282s
	iters: 200, epoch: 34 | loss: 0.0423279
	speed: 0.0262s/iter; left time: 391.0081s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.82s
Steps: 226 | Train Loss: 0.0413079 Vali Loss: 0.0510071 Test Loss: 0.0541874
Validation loss decreased (0.051086 --> 0.051007).  Saving model ...
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0438803
	speed: 0.0531s/iter; left time: 787.0705s
	iters: 200, epoch: 35 | loss: 0.0389386
	speed: 0.0279s/iter; left time: 410.7558s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.69s
Steps: 226 | Train Loss: 0.0413145 Vali Loss: 0.0511008 Test Loss: 0.0541847
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0472102
	speed: 0.0507s/iter; left time: 740.2141s
	iters: 200, epoch: 36 | loss: 0.0386646
	speed: 0.0298s/iter; left time: 432.5491s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.78s
Steps: 226 | Train Loss: 0.0413326 Vali Loss: 0.0509946 Test Loss: 0.0541957
Validation loss decreased (0.051007 --> 0.050995).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0415711
	speed: 0.0471s/iter; left time: 676.7013s
	iters: 200, epoch: 37 | loss: 0.0403833
	speed: 0.0231s/iter; left time: 330.1552s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.52s
Steps: 226 | Train Loss: 0.0412730 Vali Loss: 0.0510368 Test Loss: 0.0541667
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0435312
	speed: 0.0512s/iter; left time: 723.3549s
	iters: 200, epoch: 38 | loss: 0.0391161
	speed: 0.0284s/iter; left time: 399.3691s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.83s
Steps: 226 | Train Loss: 0.0412630 Vali Loss: 0.0510862 Test Loss: 0.0541457
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0423625
	speed: 0.0543s/iter; left time: 755.9302s
	iters: 200, epoch: 39 | loss: 0.0436461
	speed: 0.0306s/iter; left time: 422.1086s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.21s
Steps: 226 | Train Loss: 0.0412700 Vali Loss: 0.0510823 Test Loss: 0.0541865
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0388188
	speed: 0.0464s/iter; left time: 635.6226s
	iters: 200, epoch: 40 | loss: 0.0421896
	speed: 0.0201s/iter; left time: 273.4797s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.06s
Steps: 226 | Train Loss: 0.0412645 Vali Loss: 0.0511344 Test Loss: 0.0541581
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0416249
	speed: 0.0444s/iter; left time: 597.6767s
	iters: 200, epoch: 41 | loss: 0.0399476
	speed: 0.0208s/iter; left time: 277.8426s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.55s
Steps: 226 | Train Loss: 0.0412606 Vali Loss: 0.0511338 Test Loss: 0.0541512
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0414979
	speed: 0.0523s/iter; left time: 692.3976s
	iters: 200, epoch: 42 | loss: 0.0431815
	speed: 0.0277s/iter; left time: 363.2903s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.45s
Steps: 226 | Train Loss: 0.0412452 Vali Loss: 0.0511097 Test Loss: 0.0541572
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0408163
	speed: 0.0463s/iter; left time: 601.8237s
	iters: 200, epoch: 43 | loss: 0.0406738
	speed: 0.0194s/iter; left time: 250.0092s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.08s
Steps: 226 | Train Loss: 0.0412199 Vali Loss: 0.0510517 Test Loss: 0.0541587
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0390890
	speed: 0.0490s/iter; left time: 626.5797s
	iters: 200, epoch: 44 | loss: 0.0395521
	speed: 0.0295s/iter; left time: 374.1500s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.84s
Steps: 226 | Train Loss: 0.0412448 Vali Loss: 0.0510430 Test Loss: 0.0541468
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0431649
	speed: 0.0496s/iter; left time: 622.6231s
	iters: 200, epoch: 45 | loss: 0.0421387
	speed: 0.0296s/iter; left time: 369.1589s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.53s
Steps: 226 | Train Loss: 0.0412236 Vali Loss: 0.0510134 Test Loss: 0.0541102
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0387131
	speed: 0.0555s/iter; left time: 684.3485s
	iters: 200, epoch: 46 | loss: 0.0402467
	speed: 0.0338s/iter; left time: 412.9548s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.60s
Steps: 226 | Train Loss: 0.0412133 Vali Loss: 0.0508858 Test Loss: 0.0541043
Validation loss decreased (0.050995 --> 0.050886).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0409243
	speed: 0.0519s/iter; left time: 628.6759s
	iters: 200, epoch: 47 | loss: 0.0427487
	speed: 0.0292s/iter; left time: 351.0371s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.81s
Steps: 226 | Train Loss: 0.0411864 Vali Loss: 0.0510773 Test Loss: 0.0541381
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0411739
	speed: 0.0529s/iter; left time: 628.8035s
	iters: 200, epoch: 48 | loss: 0.0400346
	speed: 0.0298s/iter; left time: 350.6919s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.81s
Steps: 226 | Train Loss: 0.0412303 Vali Loss: 0.0510280 Test Loss: 0.0541061
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0392074
	speed: 0.0514s/iter; left time: 599.3333s
	iters: 200, epoch: 49 | loss: 0.0425270
	speed: 0.0232s/iter; left time: 268.0406s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.88s
Steps: 226 | Train Loss: 0.0412285 Vali Loss: 0.0510358 Test Loss: 0.0541527
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0410978
	speed: 0.0429s/iter; left time: 490.1766s
	iters: 200, epoch: 50 | loss: 0.0380185
	speed: 0.0237s/iter; left time: 268.5060s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.29s
Steps: 226 | Train Loss: 0.0411887 Vali Loss: 0.0510428 Test Loss: 0.0541054
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0409625
	speed: 0.0551s/iter; left time: 616.6258s
	iters: 200, epoch: 51 | loss: 0.0422957
	speed: 0.0266s/iter; left time: 295.3196s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:07.16s
Steps: 226 | Train Loss: 0.0412051 Vali Loss: 0.0510952 Test Loss: 0.0541243
EarlyStopping counter: 5 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0445837
	speed: 0.0482s/iter; left time: 528.4640s
	iters: 200, epoch: 52 | loss: 0.0395759
	speed: 0.0237s/iter; left time: 257.6549s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.79s
Steps: 226 | Train Loss: 0.0411853 Vali Loss: 0.0510290 Test Loss: 0.0541174
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0417441
	speed: 0.0433s/iter; left time: 465.5154s
	iters: 200, epoch: 53 | loss: 0.0429232
	speed: 0.0207s/iter; left time: 220.8348s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:04.83s
Steps: 226 | Train Loss: 0.0411807 Vali Loss: 0.0510417 Test Loss: 0.0541382
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0413381
	speed: 0.0488s/iter; left time: 513.9451s
	iters: 200, epoch: 54 | loss: 0.0414263
	speed: 0.0249s/iter; left time: 259.4854s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.20s
Steps: 226 | Train Loss: 0.0412373 Vali Loss: 0.0510291 Test Loss: 0.0541415
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0415313
	speed: 0.0495s/iter; left time: 510.0006s
	iters: 200, epoch: 55 | loss: 0.0427520
	speed: 0.0299s/iter; left time: 305.0956s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.87s
Steps: 226 | Train Loss: 0.0411794 Vali Loss: 0.0510427 Test Loss: 0.0541164
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0402257
	speed: 0.0542s/iter; left time: 546.0304s
	iters: 200, epoch: 56 | loss: 0.0419502
	speed: 0.0322s/iter; left time: 320.7520s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:07.01s
Steps: 226 | Train Loss: 0.0411687 Vali Loss: 0.0510630 Test Loss: 0.0541254
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009846783243119717, rmse:0.09923096001148224, mae:0.0541042760014534, rse:0.38283032178878784
Use GPU: cuda:0
>>>>>>>start training : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1182429
	speed: 0.0258s/iter; left time: 580.9970s
	iters: 200, epoch: 1 | loss: 0.1087598
	speed: 0.0242s/iter; left time: 542.9493s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.86s
Steps: 226 | Train Loss: 0.1173186 Vali Loss: 0.1173352 Test Loss: 0.1300844
Validation loss decreased (inf --> 0.117335).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0651111
	speed: 0.0555s/iter; left time: 1237.0380s
	iters: 200, epoch: 2 | loss: 0.0529706
	speed: 0.0243s/iter; left time: 538.6773s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.52s
Steps: 226 | Train Loss: 0.0664123 Vali Loss: 0.0623895 Test Loss: 0.0646706
Validation loss decreased (0.117335 --> 0.062389).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0472664
	speed: 0.0492s/iter; left time: 1085.5112s
	iters: 200, epoch: 3 | loss: 0.0473599
	speed: 0.0245s/iter; left time: 538.2111s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.96s
Steps: 226 | Train Loss: 0.0515785 Vali Loss: 0.0584495 Test Loss: 0.0607335
Validation loss decreased (0.062389 --> 0.058449).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0478847
	speed: 0.0472s/iter; left time: 1029.1145s
	iters: 200, epoch: 4 | loss: 0.0477668
	speed: 0.0285s/iter; left time: 618.3240s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0488677 Vali Loss: 0.0565804 Test Loss: 0.0591537
Validation loss decreased (0.058449 --> 0.056580).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0465839
	speed: 0.0506s/iter; left time: 1092.4474s
	iters: 200, epoch: 5 | loss: 0.0449112
	speed: 0.0235s/iter; left time: 505.1022s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.21s
Steps: 226 | Train Loss: 0.0472675 Vali Loss: 0.0552322 Test Loss: 0.0579919
Validation loss decreased (0.056580 --> 0.055232).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0488357
	speed: 0.0505s/iter; left time: 1079.7151s
	iters: 200, epoch: 6 | loss: 0.0461491
	speed: 0.0239s/iter; left time: 507.7448s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.62s
Steps: 226 | Train Loss: 0.0460159 Vali Loss: 0.0541305 Test Loss: 0.0573544
Validation loss decreased (0.055232 --> 0.054131).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0451231
	speed: 0.0485s/iter; left time: 1026.0216s
	iters: 200, epoch: 7 | loss: 0.0468216
	speed: 0.0275s/iter; left time: 579.4204s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.34s
Steps: 226 | Train Loss: 0.0450794 Vali Loss: 0.0535126 Test Loss: 0.0566724
Validation loss decreased (0.054131 --> 0.053513).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0442903
	speed: 0.0458s/iter; left time: 958.7857s
	iters: 200, epoch: 8 | loss: 0.0449988
	speed: 0.0257s/iter; left time: 535.4839s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.63s
Steps: 226 | Train Loss: 0.0443544 Vali Loss: 0.0528316 Test Loss: 0.0561518
Validation loss decreased (0.053513 --> 0.052832).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0455078
	speed: 0.0480s/iter; left time: 992.5128s
	iters: 200, epoch: 9 | loss: 0.0443731
	speed: 0.0271s/iter; left time: 558.8277s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.24s
Steps: 226 | Train Loss: 0.0438602 Vali Loss: 0.0526205 Test Loss: 0.0557751
Validation loss decreased (0.052832 --> 0.052621).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0415070
	speed: 0.0528s/iter; left time: 1080.2887s
	iters: 200, epoch: 10 | loss: 0.0402026
	speed: 0.0226s/iter; left time: 459.6664s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0434354 Vali Loss: 0.0523072 Test Loss: 0.0554496
Validation loss decreased (0.052621 --> 0.052307).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0426357
	speed: 0.0524s/iter; left time: 1061.3547s
	iters: 200, epoch: 11 | loss: 0.0414191
	speed: 0.0273s/iter; left time: 549.4708s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.42s
Steps: 226 | Train Loss: 0.0431586 Vali Loss: 0.0521097 Test Loss: 0.0554314
Validation loss decreased (0.052307 --> 0.052110).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0400768
	speed: 0.0488s/iter; left time: 977.7067s
	iters: 200, epoch: 12 | loss: 0.0436677
	speed: 0.0195s/iter; left time: 387.6644s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.42s
Steps: 226 | Train Loss: 0.0429084 Vali Loss: 0.0518410 Test Loss: 0.0551395
Validation loss decreased (0.052110 --> 0.051841).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0407224
	speed: 0.0497s/iter; left time: 982.5913s
	iters: 200, epoch: 13 | loss: 0.0394750
	speed: 0.0295s/iter; left time: 580.2304s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.42s
Steps: 226 | Train Loss: 0.0426601 Vali Loss: 0.0517847 Test Loss: 0.0551147
Validation loss decreased (0.051841 --> 0.051785).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0423878
	speed: 0.0554s/iter; left time: 1083.0515s
	iters: 200, epoch: 14 | loss: 0.0439840
	speed: 0.0218s/iter; left time: 424.4968s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.31s
Steps: 226 | Train Loss: 0.0424838 Vali Loss: 0.0516804 Test Loss: 0.0550191
Validation loss decreased (0.051785 --> 0.051680).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0434851
	speed: 0.0508s/iter; left time: 982.9505s
	iters: 200, epoch: 15 | loss: 0.0416624
	speed: 0.0192s/iter; left time: 368.4748s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.59s
Steps: 226 | Train Loss: 0.0423361 Vali Loss: 0.0515615 Test Loss: 0.0548344
Validation loss decreased (0.051680 --> 0.051562).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0426293
	speed: 0.0509s/iter; left time: 973.3632s
	iters: 200, epoch: 16 | loss: 0.0461580
	speed: 0.0269s/iter; left time: 510.9818s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.64s
Steps: 226 | Train Loss: 0.0422033 Vali Loss: 0.0514735 Test Loss: 0.0548638
Validation loss decreased (0.051562 --> 0.051473).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0383031
	speed: 0.0477s/iter; left time: 900.5786s
	iters: 200, epoch: 17 | loss: 0.0399342
	speed: 0.0239s/iter; left time: 448.0547s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.56s
Steps: 226 | Train Loss: 0.0421454 Vali Loss: 0.0513158 Test Loss: 0.0547536
Validation loss decreased (0.051473 --> 0.051316).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0412194
	speed: 0.0499s/iter; left time: 931.5355s
	iters: 200, epoch: 18 | loss: 0.0429672
	speed: 0.0252s/iter; left time: 467.8597s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0419960 Vali Loss: 0.0514539 Test Loss: 0.0548421
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0393095
	speed: 0.0492s/iter; left time: 906.4209s
	iters: 200, epoch: 19 | loss: 0.0441770
	speed: 0.0209s/iter; left time: 383.7294s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.70s
Steps: 226 | Train Loss: 0.0419091 Vali Loss: 0.0512217 Test Loss: 0.0546638
Validation loss decreased (0.051316 --> 0.051222).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0420669
	speed: 0.0570s/iter; left time: 1037.0022s
	iters: 200, epoch: 20 | loss: 0.0409727
	speed: 0.0306s/iter; left time: 553.8873s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.34s
Steps: 226 | Train Loss: 0.0417591 Vali Loss: 0.0512575 Test Loss: 0.0545752
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0456082
	speed: 0.0517s/iter; left time: 928.8116s
	iters: 200, epoch: 21 | loss: 0.0407613
	speed: 0.0256s/iter; left time: 457.4616s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.33s
Steps: 226 | Train Loss: 0.0417115 Vali Loss: 0.0513524 Test Loss: 0.0546071
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0430730
	speed: 0.0533s/iter; left time: 947.2073s
	iters: 200, epoch: 22 | loss: 0.0423018
	speed: 0.0247s/iter; left time: 436.9308s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.28s
Steps: 226 | Train Loss: 0.0416839 Vali Loss: 0.0512003 Test Loss: 0.0545036
Validation loss decreased (0.051222 --> 0.051200).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0401441
	speed: 0.0477s/iter; left time: 835.3917s
	iters: 200, epoch: 23 | loss: 0.0436835
	speed: 0.0237s/iter; left time: 413.9178s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.56s
Steps: 226 | Train Loss: 0.0416036 Vali Loss: 0.0512747 Test Loss: 0.0545001
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0411001
	speed: 0.0452s/iter; left time: 781.6859s
	iters: 200, epoch: 24 | loss: 0.0383674
	speed: 0.0266s/iter; left time: 457.6856s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.06s
Steps: 226 | Train Loss: 0.0415666 Vali Loss: 0.0512336 Test Loss: 0.0545423
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0430113
	speed: 0.0445s/iter; left time: 759.6149s
	iters: 200, epoch: 25 | loss: 0.0411178
	speed: 0.0244s/iter; left time: 413.5505s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.43s
Steps: 226 | Train Loss: 0.0415223 Vali Loss: 0.0511620 Test Loss: 0.0545256
Validation loss decreased (0.051200 --> 0.051162).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0394535
	speed: 0.0501s/iter; left time: 844.7345s
	iters: 200, epoch: 26 | loss: 0.0408899
	speed: 0.0298s/iter; left time: 499.5723s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.68s
Steps: 226 | Train Loss: 0.0414990 Vali Loss: 0.0510829 Test Loss: 0.0545045
Validation loss decreased (0.051162 --> 0.051083).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0401787
	speed: 0.0518s/iter; left time: 861.5923s
	iters: 200, epoch: 27 | loss: 0.0434536
	speed: 0.0226s/iter; left time: 374.2111s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.94s
Steps: 226 | Train Loss: 0.0414874 Vali Loss: 0.0511563 Test Loss: 0.0544282
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0423668
	speed: 0.0451s/iter; left time: 739.7172s
	iters: 200, epoch: 28 | loss: 0.0422014
	speed: 0.0186s/iter; left time: 303.6844s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.86s
Steps: 226 | Train Loss: 0.0414652 Vali Loss: 0.0510324 Test Loss: 0.0544592
Validation loss decreased (0.051083 --> 0.051032).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0407290
	speed: 0.0492s/iter; left time: 795.3732s
	iters: 200, epoch: 29 | loss: 0.0407079
	speed: 0.0246s/iter; left time: 395.4301s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.97s
Steps: 226 | Train Loss: 0.0413912 Vali Loss: 0.0510565 Test Loss: 0.0544063
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0460965
	speed: 0.0446s/iter; left time: 711.5648s
	iters: 200, epoch: 30 | loss: 0.0401905
	speed: 0.0221s/iter; left time: 350.4307s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.30s
Steps: 226 | Train Loss: 0.0414160 Vali Loss: 0.0510849 Test Loss: 0.0543769
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0401029
	speed: 0.0462s/iter; left time: 725.5853s
	iters: 200, epoch: 31 | loss: 0.0418141
	speed: 0.0265s/iter; left time: 414.2903s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.11s
Steps: 226 | Train Loss: 0.0413730 Vali Loss: 0.0510531 Test Loss: 0.0543816
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0405486
	speed: 0.0467s/iter; left time: 723.0925s
	iters: 200, epoch: 32 | loss: 0.0379125
	speed: 0.0274s/iter; left time: 422.4168s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.17s
Steps: 226 | Train Loss: 0.0413438 Vali Loss: 0.0510413 Test Loss: 0.0543643
EarlyStopping counter: 4 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0401707
	speed: 0.0492s/iter; left time: 751.4719s
	iters: 200, epoch: 33 | loss: 0.0397618
	speed: 0.0252s/iter; left time: 381.5150s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.04s
Steps: 226 | Train Loss: 0.0412806 Vali Loss: 0.0511042 Test Loss: 0.0544257
EarlyStopping counter: 5 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0418254
	speed: 0.0465s/iter; left time: 699.6537s
	iters: 200, epoch: 34 | loss: 0.0396528
	speed: 0.0255s/iter; left time: 381.6757s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.80s
Steps: 226 | Train Loss: 0.0413203 Vali Loss: 0.0510538 Test Loss: 0.0543853
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0423622
	speed: 0.0486s/iter; left time: 719.4765s
	iters: 200, epoch: 35 | loss: 0.0448219
	speed: 0.0281s/iter; left time: 413.1726s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.34s
Steps: 226 | Train Loss: 0.0412818 Vali Loss: 0.0510316 Test Loss: 0.0543432
Validation loss decreased (0.051032 --> 0.051032).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0420344
	speed: 0.0547s/iter; left time: 798.0869s
	iters: 200, epoch: 36 | loss: 0.0410500
	speed: 0.0263s/iter; left time: 381.7396s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.79s
Steps: 226 | Train Loss: 0.0412932 Vali Loss: 0.0510304 Test Loss: 0.0543913
Validation loss decreased (0.051032 --> 0.051030).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0428056
	speed: 0.0535s/iter; left time: 769.0850s
	iters: 200, epoch: 37 | loss: 0.0405213
	speed: 0.0230s/iter; left time: 328.2515s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.05s
Steps: 226 | Train Loss: 0.0412726 Vali Loss: 0.0510981 Test Loss: 0.0543641
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0408890
	speed: 0.0434s/iter; left time: 613.9895s
	iters: 200, epoch: 38 | loss: 0.0412078
	speed: 0.0234s/iter; left time: 328.3063s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.39s
Steps: 226 | Train Loss: 0.0412846 Vali Loss: 0.0510122 Test Loss: 0.0544314
Validation loss decreased (0.051030 --> 0.051012).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0425402
	speed: 0.0501s/iter; left time: 696.6970s
	iters: 200, epoch: 39 | loss: 0.0458580
	speed: 0.0236s/iter; left time: 325.8533s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.03s
Steps: 226 | Train Loss: 0.0412711 Vali Loss: 0.0510318 Test Loss: 0.0543933
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0436337
	speed: 0.0519s/iter; left time: 710.7051s
	iters: 200, epoch: 40 | loss: 0.0391848
	speed: 0.0300s/iter; left time: 407.1539s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.83s
Steps: 226 | Train Loss: 0.0412898 Vali Loss: 0.0510104 Test Loss: 0.0543356
Validation loss decreased (0.051012 --> 0.051010).  Saving model ...
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0438826
	speed: 0.0456s/iter; left time: 614.2154s
	iters: 200, epoch: 41 | loss: 0.0409017
	speed: 0.0187s/iter; left time: 249.5888s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:04.84s
Steps: 226 | Train Loss: 0.0412321 Vali Loss: 0.0510284 Test Loss: 0.0543539
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0392837
	speed: 0.0455s/iter; left time: 602.4075s
	iters: 200, epoch: 42 | loss: 0.0423266
	speed: 0.0228s/iter; left time: 300.0848s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.43s
Steps: 226 | Train Loss: 0.0412172 Vali Loss: 0.0510499 Test Loss: 0.0544103
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0420753
	speed: 0.0577s/iter; left time: 749.9806s
	iters: 200, epoch: 43 | loss: 0.0390433
	speed: 0.0305s/iter; left time: 393.2571s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:07.65s
Steps: 226 | Train Loss: 0.0412348 Vali Loss: 0.0509948 Test Loss: 0.0543997
Validation loss decreased (0.051010 --> 0.050995).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0427173
	speed: 0.0566s/iter; left time: 723.5453s
	iters: 200, epoch: 44 | loss: 0.0422384
	speed: 0.0244s/iter; left time: 309.3547s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.39s
Steps: 226 | Train Loss: 0.0411777 Vali Loss: 0.0510399 Test Loss: 0.0543750
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0430857
	speed: 0.0509s/iter; left time: 638.6249s
	iters: 200, epoch: 45 | loss: 0.0400429
	speed: 0.0284s/iter; left time: 353.2004s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.70s
Steps: 226 | Train Loss: 0.0412277 Vali Loss: 0.0510145 Test Loss: 0.0543994
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0385433
	speed: 0.0490s/iter; left time: 604.5331s
	iters: 200, epoch: 46 | loss: 0.0414090
	speed: 0.0317s/iter; left time: 387.7079s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.75s
Steps: 226 | Train Loss: 0.0412204 Vali Loss: 0.0509589 Test Loss: 0.0543231
Validation loss decreased (0.050995 --> 0.050959).  Saving model ...
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0402943
	speed: 0.0489s/iter; left time: 592.0995s
	iters: 200, epoch: 47 | loss: 0.0385111
	speed: 0.0248s/iter; left time: 298.1152s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.93s
Steps: 226 | Train Loss: 0.0412128 Vali Loss: 0.0509588 Test Loss: 0.0543431
Validation loss decreased (0.050959 --> 0.050959).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0420539
	speed: 0.0471s/iter; left time: 559.4235s
	iters: 200, epoch: 48 | loss: 0.0414722
	speed: 0.0186s/iter; left time: 219.0001s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.11s
Steps: 226 | Train Loss: 0.0411918 Vali Loss: 0.0509552 Test Loss: 0.0543449
Validation loss decreased (0.050959 --> 0.050955).  Saving model ...
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0404456
	speed: 0.0518s/iter; left time: 604.1721s
	iters: 200, epoch: 49 | loss: 0.0390682
	speed: 0.0295s/iter; left time: 340.2690s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.95s
Steps: 226 | Train Loss: 0.0412032 Vali Loss: 0.0510119 Test Loss: 0.0543529
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0413699
	speed: 0.0543s/iter; left time: 620.2605s
	iters: 200, epoch: 50 | loss: 0.0430498
	speed: 0.0252s/iter; left time: 285.3069s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.29s
Steps: 226 | Train Loss: 0.0411565 Vali Loss: 0.0509348 Test Loss: 0.0543352
Validation loss decreased (0.050955 --> 0.050935).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0433248
	speed: 0.0452s/iter; left time: 506.5995s
	iters: 200, epoch: 51 | loss: 0.0433756
	speed: 0.0254s/iter; left time: 281.5670s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.67s
Steps: 226 | Train Loss: 0.0412128 Vali Loss: 0.0509672 Test Loss: 0.0543227
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0455864
	speed: 0.0459s/iter; left time: 503.9862s
	iters: 200, epoch: 52 | loss: 0.0373759
	speed: 0.0268s/iter; left time: 291.5502s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.11s
Steps: 226 | Train Loss: 0.0412307 Vali Loss: 0.0510274 Test Loss: 0.0543177
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0362533
	speed: 0.0469s/iter; left time: 503.7876s
	iters: 200, epoch: 53 | loss: 0.0392829
	speed: 0.0276s/iter; left time: 293.7810s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.99s
Steps: 226 | Train Loss: 0.0412029 Vali Loss: 0.0509258 Test Loss: 0.0543313
Validation loss decreased (0.050935 --> 0.050926).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0384007
	speed: 0.0484s/iter; left time: 509.8368s
	iters: 200, epoch: 54 | loss: 0.0386209
	speed: 0.0294s/iter; left time: 306.2205s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.28s
Steps: 226 | Train Loss: 0.0411951 Vali Loss: 0.0510010 Test Loss: 0.0543542
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0395590
	speed: 0.0477s/iter; left time: 491.3463s
	iters: 200, epoch: 55 | loss: 0.0431799
	speed: 0.0259s/iter; left time: 263.7170s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.00s
Steps: 226 | Train Loss: 0.0411490 Vali Loss: 0.0509527 Test Loss: 0.0543082
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0409292
	speed: 0.0512s/iter; left time: 515.4983s
	iters: 200, epoch: 56 | loss: 0.0384964
	speed: 0.0277s/iter; left time: 276.3543s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.46s
Steps: 226 | Train Loss: 0.0411532 Vali Loss: 0.0508853 Test Loss: 0.0543533
Validation loss decreased (0.050926 --> 0.050885).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0408892
	speed: 0.0503s/iter; left time: 495.1290s
	iters: 200, epoch: 57 | loss: 0.0383844
	speed: 0.0280s/iter; left time: 273.0488s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.32s
Steps: 226 | Train Loss: 0.0412010 Vali Loss: 0.0509888 Test Loss: 0.0543061
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0397936
	speed: 0.0512s/iter; left time: 492.7793s
	iters: 200, epoch: 58 | loss: 0.0405686
	speed: 0.0279s/iter; left time: 265.3963s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.50s
Steps: 226 | Train Loss: 0.0411393 Vali Loss: 0.0508974 Test Loss: 0.0543278
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0416370
	speed: 0.0476s/iter; left time: 447.1507s
	iters: 200, epoch: 59 | loss: 0.0448846
	speed: 0.0263s/iter; left time: 244.4188s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:05.85s
Steps: 226 | Train Loss: 0.0412174 Vali Loss: 0.0509768 Test Loss: 0.0543235
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0410431
	speed: 0.0477s/iter; left time: 437.0455s
	iters: 200, epoch: 60 | loss: 0.0403395
	speed: 0.0270s/iter; left time: 244.6550s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.27s
Steps: 226 | Train Loss: 0.0412172 Vali Loss: 0.0509386 Test Loss: 0.0543214
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0416200
	speed: 0.0455s/iter; left time: 406.6081s
	iters: 200, epoch: 61 | loss: 0.0424872
	speed: 0.0223s/iter; left time: 197.2097s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:05.09s
Steps: 226 | Train Loss: 0.0411801 Vali Loss: 0.0509546 Test Loss: 0.0543453
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0361256
	speed: 0.0446s/iter; left time: 388.9664s
	iters: 200, epoch: 62 | loss: 0.0402691
	speed: 0.0269s/iter; left time: 231.8377s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.95s
Steps: 226 | Train Loss: 0.0411739 Vali Loss: 0.0509681 Test Loss: 0.0543445
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0424508
	speed: 0.0484s/iter; left time: 410.6147s
	iters: 200, epoch: 63 | loss: 0.0425622
	speed: 0.0201s/iter; left time: 168.3736s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.36s
Steps: 226 | Train Loss: 0.0411551 Vali Loss: 0.0509861 Test Loss: 0.0543499
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0397099
	speed: 0.0458s/iter; left time: 378.0383s
	iters: 200, epoch: 64 | loss: 0.0410833
	speed: 0.0263s/iter; left time: 214.7438s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:05.99s
Steps: 226 | Train Loss: 0.0411703 Vali Loss: 0.0509164 Test Loss: 0.0543010
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0404438
	speed: 0.0504s/iter; left time: 404.9438s
	iters: 200, epoch: 65 | loss: 0.0409320
	speed: 0.0250s/iter; left time: 198.4187s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:06.14s
Steps: 226 | Train Loss: 0.0411614 Vali Loss: 0.0509447 Test Loss: 0.0543172
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0451697
	speed: 0.0468s/iter; left time: 365.8001s
	iters: 200, epoch: 66 | loss: 0.0403475
	speed: 0.0238s/iter; left time: 183.2684s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:05.83s
Steps: 226 | Train Loss: 0.0411995 Vali Loss: 0.0509420 Test Loss: 0.0543792
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_24_FR_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.009954087436199188, rmse:0.09977017343044281, mae:0.05435333773493767, rse:0.384910523891449
Intermediate time for FR and pred_len 24: 00h:15m:26.60s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_96_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1220741
	speed: 0.0506s/iter; left time: 1132.7418s
	iters: 200, epoch: 1 | loss: 0.1146931
	speed: 0.0247s/iter; left time: 550.5026s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.99s
Steps: 225 | Train Loss: 0.1229160 Vali Loss: 0.1261277 Test Loss: 0.1432174
Validation loss decreased (inf --> 0.126128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0742138
	speed: 0.0462s/iter; left time: 1025.1202s
	iters: 200, epoch: 2 | loss: 0.0697527
	speed: 0.0254s/iter; left time: 560.4833s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.68s
Steps: 225 | Train Loss: 0.0799607 Vali Loss: 0.0787864 Test Loss: 0.0867982
Validation loss decreased (0.126128 --> 0.078786).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0669011
	speed: 0.0531s/iter; left time: 1165.8389s
	iters: 200, epoch: 3 | loss: 0.0681493
	speed: 0.0295s/iter; left time: 645.3308s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.96s
Steps: 225 | Train Loss: 0.0672110 Vali Loss: 0.0753967 Test Loss: 0.0838328
Validation loss decreased (0.078786 --> 0.075397).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0665823
	speed: 0.0642s/iter; left time: 1395.3642s
	iters: 200, epoch: 4 | loss: 0.0666709
	speed: 0.0319s/iter; left time: 689.7923s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.87s
Steps: 225 | Train Loss: 0.0649054 Vali Loss: 0.0735958 Test Loss: 0.0825490
Validation loss decreased (0.075397 --> 0.073596).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0616264
	speed: 0.0541s/iter; left time: 1163.2913s
	iters: 200, epoch: 5 | loss: 0.0608241
	speed: 0.0308s/iter; left time: 659.9078s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.92s
Steps: 225 | Train Loss: 0.0630447 Vali Loss: 0.0720382 Test Loss: 0.0814225
Validation loss decreased (0.073596 --> 0.072038).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0619600
	speed: 0.0512s/iter; left time: 1089.5306s
	iters: 200, epoch: 6 | loss: 0.0598352
	speed: 0.0283s/iter; left time: 599.0840s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.53s
Steps: 225 | Train Loss: 0.0616488 Vali Loss: 0.0713768 Test Loss: 0.0808180
Validation loss decreased (0.072038 --> 0.071377).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0632396
	speed: 0.0498s/iter; left time: 1047.4369s
	iters: 200, epoch: 7 | loss: 0.0662241
	speed: 0.0253s/iter; left time: 529.2910s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.72s
Steps: 225 | Train Loss: 0.0608829 Vali Loss: 0.0711699 Test Loss: 0.0803994
Validation loss decreased (0.071377 --> 0.071170).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0579971
	speed: 0.0586s/iter; left time: 1220.6730s
	iters: 200, epoch: 8 | loss: 0.0584228
	speed: 0.0273s/iter; left time: 566.5272s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.82s
Steps: 225 | Train Loss: 0.0603736 Vali Loss: 0.0708177 Test Loss: 0.0803240
Validation loss decreased (0.071170 --> 0.070818).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0604323
	speed: 0.0503s/iter; left time: 1035.4719s
	iters: 200, epoch: 9 | loss: 0.0596516
	speed: 0.0285s/iter; left time: 584.8081s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.50s
Steps: 225 | Train Loss: 0.0599084 Vali Loss: 0.0707924 Test Loss: 0.0800577
Validation loss decreased (0.070818 --> 0.070792).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0582479
	speed: 0.0528s/iter; left time: 1075.2759s
	iters: 200, epoch: 10 | loss: 0.0610579
	speed: 0.0278s/iter; left time: 563.9311s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.47s
Steps: 225 | Train Loss: 0.0596372 Vali Loss: 0.0706747 Test Loss: 0.0800745
Validation loss decreased (0.070792 --> 0.070675).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0596562
	speed: 0.0558s/iter; left time: 1124.3311s
	iters: 200, epoch: 11 | loss: 0.0598316
	speed: 0.0301s/iter; left time: 602.6839s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.86s
Steps: 225 | Train Loss: 0.0593520 Vali Loss: 0.0706221 Test Loss: 0.0800105
Validation loss decreased (0.070675 --> 0.070622).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0540255
	speed: 0.0559s/iter; left time: 1114.6240s
	iters: 200, epoch: 12 | loss: 0.0580481
	speed: 0.0296s/iter; left time: 586.1469s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0591023 Vali Loss: 0.0705149 Test Loss: 0.0799026
Validation loss decreased (0.070622 --> 0.070515).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0586757
	speed: 0.0499s/iter; left time: 983.4344s
	iters: 200, epoch: 13 | loss: 0.0574660
	speed: 0.0304s/iter; left time: 595.6808s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.87s
Steps: 225 | Train Loss: 0.0588783 Vali Loss: 0.0703367 Test Loss: 0.0797316
Validation loss decreased (0.070515 --> 0.070337).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0603708
	speed: 0.0524s/iter; left time: 1020.4457s
	iters: 200, epoch: 14 | loss: 0.0608521
	speed: 0.0194s/iter; left time: 375.7931s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.46s
Steps: 225 | Train Loss: 0.0587461 Vali Loss: 0.0703455 Test Loss: 0.0796405
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0571587
	speed: 0.0535s/iter; left time: 1029.8471s
	iters: 200, epoch: 15 | loss: 0.0585860
	speed: 0.0312s/iter; left time: 597.8993s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.94s
Steps: 225 | Train Loss: 0.0585486 Vali Loss: 0.0702861 Test Loss: 0.0797806
Validation loss decreased (0.070337 --> 0.070286).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0569398
	speed: 0.0452s/iter; left time: 860.1652s
	iters: 200, epoch: 16 | loss: 0.0590494
	speed: 0.0310s/iter; left time: 586.0956s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.17s
Steps: 225 | Train Loss: 0.0584513 Vali Loss: 0.0702889 Test Loss: 0.0797580
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0571058
	speed: 0.0610s/iter; left time: 1146.5135s
	iters: 200, epoch: 17 | loss: 0.0555347
	speed: 0.0322s/iter; left time: 601.4344s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.93s
Steps: 225 | Train Loss: 0.0583301 Vali Loss: 0.0702149 Test Loss: 0.0796651
Validation loss decreased (0.070286 --> 0.070215).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0558115
	speed: 0.0539s/iter; left time: 1000.5664s
	iters: 200, epoch: 18 | loss: 0.0614593
	speed: 0.0274s/iter; left time: 506.1362s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.58s
Steps: 225 | Train Loss: 0.0582152 Vali Loss: 0.0701965 Test Loss: 0.0797421
Validation loss decreased (0.070215 --> 0.070197).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0578019
	speed: 0.0522s/iter; left time: 958.7890s
	iters: 200, epoch: 19 | loss: 0.0571534
	speed: 0.0249s/iter; left time: 454.6418s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.08s
Steps: 225 | Train Loss: 0.0581612 Vali Loss: 0.0701740 Test Loss: 0.0796154
Validation loss decreased (0.070197 --> 0.070174).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0603194
	speed: 0.0489s/iter; left time: 886.1364s
	iters: 200, epoch: 20 | loss: 0.0608253
	speed: 0.0273s/iter; left time: 492.8628s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.20s
Steps: 225 | Train Loss: 0.0580238 Vali Loss: 0.0701691 Test Loss: 0.0796968
Validation loss decreased (0.070174 --> 0.070169).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0547900
	speed: 0.0572s/iter; left time: 1023.4929s
	iters: 200, epoch: 21 | loss: 0.0575892
	speed: 0.0322s/iter; left time: 573.1077s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.54s
Steps: 225 | Train Loss: 0.0579985 Vali Loss: 0.0702100 Test Loss: 0.0796268
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0571349
	speed: 0.0518s/iter; left time: 915.5777s
	iters: 200, epoch: 22 | loss: 0.0592960
	speed: 0.0316s/iter; left time: 555.8042s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.79s
Steps: 225 | Train Loss: 0.0579128 Vali Loss: 0.0701129 Test Loss: 0.0797642
Validation loss decreased (0.070169 --> 0.070113).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0567881
	speed: 0.0533s/iter; left time: 930.3161s
	iters: 200, epoch: 23 | loss: 0.0578356
	speed: 0.0288s/iter; left time: 500.0367s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.82s
Steps: 225 | Train Loss: 0.0578414 Vali Loss: 0.0700759 Test Loss: 0.0796640
Validation loss decreased (0.070113 --> 0.070076).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0588220
	speed: 0.0577s/iter; left time: 994.4895s
	iters: 200, epoch: 24 | loss: 0.0592831
	speed: 0.0311s/iter; left time: 532.0358s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.26s
Steps: 225 | Train Loss: 0.0577965 Vali Loss: 0.0700834 Test Loss: 0.0796844
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0585203
	speed: 0.0563s/iter; left time: 957.3886s
	iters: 200, epoch: 25 | loss: 0.0556729
	speed: 0.0304s/iter; left time: 513.2272s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.00s
Steps: 225 | Train Loss: 0.0577600 Vali Loss: 0.0701371 Test Loss: 0.0798421
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0540029
	speed: 0.0559s/iter; left time: 938.3910s
	iters: 200, epoch: 26 | loss: 0.0571991
	speed: 0.0257s/iter; left time: 427.7577s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.68s
Steps: 225 | Train Loss: 0.0577176 Vali Loss: 0.0700682 Test Loss: 0.0797211
Validation loss decreased (0.070076 --> 0.070068).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0591816
	speed: 0.0537s/iter; left time: 889.0366s
	iters: 200, epoch: 27 | loss: 0.0545728
	speed: 0.0280s/iter; left time: 460.2271s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.68s
Steps: 225 | Train Loss: 0.0576992 Vali Loss: 0.0700617 Test Loss: 0.0797237
Validation loss decreased (0.070068 --> 0.070062).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0617053
	speed: 0.0534s/iter; left time: 871.1085s
	iters: 200, epoch: 28 | loss: 0.0574315
	speed: 0.0274s/iter; left time: 444.2636s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.56s
Steps: 225 | Train Loss: 0.0576387 Vali Loss: 0.0700271 Test Loss: 0.0797314
Validation loss decreased (0.070062 --> 0.070027).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0517652
	speed: 0.0552s/iter; left time: 887.9829s
	iters: 200, epoch: 29 | loss: 0.0597316
	speed: 0.0286s/iter; left time: 456.9283s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.99s
Steps: 225 | Train Loss: 0.0576450 Vali Loss: 0.0700293 Test Loss: 0.0797632
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0542691
	speed: 0.0518s/iter; left time: 822.4959s
	iters: 200, epoch: 30 | loss: 0.0595843
	speed: 0.0253s/iter; left time: 399.1545s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.12s
Steps: 225 | Train Loss: 0.0575834 Vali Loss: 0.0700706 Test Loss: 0.0796918
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0550818
	speed: 0.0505s/iter; left time: 790.4459s
	iters: 200, epoch: 31 | loss: 0.0559612
	speed: 0.0271s/iter; left time: 420.6815s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0575502 Vali Loss: 0.0700366 Test Loss: 0.0797195
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0598395
	speed: 0.0529s/iter; left time: 816.2085s
	iters: 200, epoch: 32 | loss: 0.0588521
	speed: 0.0297s/iter; left time: 454.5263s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.98s
Steps: 225 | Train Loss: 0.0575711 Vali Loss: 0.0700139 Test Loss: 0.0796878
Validation loss decreased (0.070027 --> 0.070014).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0565253
	speed: 0.0533s/iter; left time: 810.5258s
	iters: 200, epoch: 33 | loss: 0.0593845
	speed: 0.0256s/iter; left time: 385.8935s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0575217 Vali Loss: 0.0700382 Test Loss: 0.0797146
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0580082
	speed: 0.0488s/iter; left time: 730.6147s
	iters: 200, epoch: 34 | loss: 0.0597742
	speed: 0.0203s/iter; left time: 301.8981s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.49s
Steps: 225 | Train Loss: 0.0575363 Vali Loss: 0.0700428 Test Loss: 0.0797535
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0547218
	speed: 0.0572s/iter; left time: 843.9688s
	iters: 200, epoch: 35 | loss: 0.0592895
	speed: 0.0302s/iter; left time: 442.5034s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.40s
Steps: 225 | Train Loss: 0.0575481 Vali Loss: 0.0700124 Test Loss: 0.0797147
Validation loss decreased (0.070014 --> 0.070012).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0589458
	speed: 0.0492s/iter; left time: 714.6912s
	iters: 200, epoch: 36 | loss: 0.0574722
	speed: 0.0271s/iter; left time: 390.6720s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.13s
Steps: 225 | Train Loss: 0.0574943 Vali Loss: 0.0700254 Test Loss: 0.0796877
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0615762
	speed: 0.0544s/iter; left time: 778.2482s
	iters: 200, epoch: 37 | loss: 0.0569741
	speed: 0.0307s/iter; left time: 436.6697s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.98s
Steps: 225 | Train Loss: 0.0575015 Vali Loss: 0.0700170 Test Loss: 0.0797144
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0595051
	speed: 0.0534s/iter; left time: 751.0762s
	iters: 200, epoch: 38 | loss: 0.0563165
	speed: 0.0305s/iter; left time: 426.4737s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.10s
Steps: 225 | Train Loss: 0.0574755 Vali Loss: 0.0700329 Test Loss: 0.0796785
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0547463
	speed: 0.0601s/iter; left time: 831.9454s
	iters: 200, epoch: 39 | loss: 0.0586968
	speed: 0.0290s/iter; left time: 399.2635s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.21s
Steps: 225 | Train Loss: 0.0574457 Vali Loss: 0.0700329 Test Loss: 0.0797462
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0591344
	speed: 0.0483s/iter; left time: 657.5722s
	iters: 200, epoch: 40 | loss: 0.0548586
	speed: 0.0255s/iter; left time: 345.1851s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.93s
Steps: 225 | Train Loss: 0.0574429 Vali Loss: 0.0700195 Test Loss: 0.0797313
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0567012
	speed: 0.0506s/iter; left time: 678.6717s
	iters: 200, epoch: 41 | loss: 0.0549469
	speed: 0.0301s/iter; left time: 400.3929s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.62s
Steps: 225 | Train Loss: 0.0574303 Vali Loss: 0.0700485 Test Loss: 0.0798056
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0558322
	speed: 0.0493s/iter; left time: 649.7967s
	iters: 200, epoch: 42 | loss: 0.0558083
	speed: 0.0290s/iter; left time: 379.4609s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.47s
Steps: 225 | Train Loss: 0.0574319 Vali Loss: 0.0700218 Test Loss: 0.0797209
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0572975
	speed: 0.0488s/iter; left time: 631.9960s
	iters: 200, epoch: 43 | loss: 0.0564682
	speed: 0.0298s/iter; left time: 383.3347s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.58s
Steps: 225 | Train Loss: 0.0574159 Vali Loss: 0.0700373 Test Loss: 0.0797657
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0559593
	speed: 0.0524s/iter; left time: 666.7368s
	iters: 200, epoch: 44 | loss: 0.0582130
	speed: 0.0252s/iter; left time: 317.8728s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.11s
Steps: 225 | Train Loss: 0.0575009 Vali Loss: 0.0700108 Test Loss: 0.0797607
Validation loss decreased (0.070012 --> 0.070011).  Saving model ...
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0571633
	speed: 0.0543s/iter; left time: 678.7832s
	iters: 200, epoch: 45 | loss: 0.0607090
	speed: 0.0271s/iter; left time: 336.4547s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.82s
Steps: 225 | Train Loss: 0.0573783 Vali Loss: 0.0700036 Test Loss: 0.0797414
Validation loss decreased (0.070011 --> 0.070004).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0591639
	speed: 0.0495s/iter; left time: 607.8419s
	iters: 200, epoch: 46 | loss: 0.0576543
	speed: 0.0278s/iter; left time: 338.9153s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.97s
Steps: 225 | Train Loss: 0.0574136 Vali Loss: 0.0700246 Test Loss: 0.0797608
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0583863
	speed: 0.0452s/iter; left time: 544.7970s
	iters: 200, epoch: 47 | loss: 0.0595122
	speed: 0.0280s/iter; left time: 334.9496s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:05.84s
Steps: 225 | Train Loss: 0.0573917 Vali Loss: 0.0700042 Test Loss: 0.0797391
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0520317
	speed: 0.0527s/iter; left time: 623.2045s
	iters: 200, epoch: 48 | loss: 0.0569255
	speed: 0.0293s/iter; left time: 343.9272s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.75s
Steps: 225 | Train Loss: 0.0574080 Vali Loss: 0.0700144 Test Loss: 0.0796876
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0556890
	speed: 0.0519s/iter; left time: 602.1130s
	iters: 200, epoch: 49 | loss: 0.0603984
	speed: 0.0259s/iter; left time: 298.0578s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.29s
Steps: 225 | Train Loss: 0.0574180 Vali Loss: 0.0700193 Test Loss: 0.0797447
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0552318
	speed: 0.0528s/iter; left time: 600.4019s
	iters: 200, epoch: 50 | loss: 0.0560904
	speed: 0.0289s/iter; left time: 326.2247s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.77s
Steps: 225 | Train Loss: 0.0574346 Vali Loss: 0.0700277 Test Loss: 0.0797751
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0584236
	speed: 0.0511s/iter; left time: 569.8983s
	iters: 200, epoch: 51 | loss: 0.0596774
	speed: 0.0255s/iter; left time: 281.4862s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.30s
Steps: 225 | Train Loss: 0.0573538 Vali Loss: 0.0700491 Test Loss: 0.0797373
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0565288
	speed: 0.0456s/iter; left time: 498.3488s
	iters: 200, epoch: 52 | loss: 0.0591236
	speed: 0.0250s/iter; left time: 270.1462s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.51s
Steps: 225 | Train Loss: 0.0573672 Vali Loss: 0.0700128 Test Loss: 0.0797444
EarlyStopping counter: 7 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0560007
	speed: 0.0509s/iter; left time: 544.5816s
	iters: 200, epoch: 53 | loss: 0.0553082
	speed: 0.0247s/iter; left time: 261.8469s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.07s
Steps: 225 | Train Loss: 0.0573963 Vali Loss: 0.0700233 Test Loss: 0.0797055
EarlyStopping counter: 8 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0592167
	speed: 0.0430s/iter; left time: 450.3846s
	iters: 200, epoch: 54 | loss: 0.0581175
	speed: 0.0195s/iter; left time: 202.6372s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:04.63s
Steps: 225 | Train Loss: 0.0573610 Vali Loss: 0.0700269 Test Loss: 0.0797300
EarlyStopping counter: 9 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0579432
	speed: 0.0521s/iter; left time: 534.3785s
	iters: 200, epoch: 55 | loss: 0.0573726
	speed: 0.0284s/iter; left time: 288.0624s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.83s
Steps: 225 | Train Loss: 0.0573706 Vali Loss: 0.0700055 Test Loss: 0.0796857
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019379083067178726, rmse:0.13920877873897552, mae:0.07974138855934143, rse:0.5384965538978577
Use GPU: cuda:0
>>>>>>>start training : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1284621
	speed: 0.0301s/iter; left time: 673.6003s
	iters: 200, epoch: 1 | loss: 0.1147969
	speed: 0.0293s/iter; left time: 652.9421s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.75s
Steps: 225 | Train Loss: 0.1244091 Vali Loss: 0.1269917 Test Loss: 0.1441622
Validation loss decreased (inf --> 0.126992).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0759071
	speed: 0.0556s/iter; left time: 1232.0012s
	iters: 200, epoch: 2 | loss: 0.0726768
	speed: 0.0306s/iter; left time: 676.0831s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.94s
Steps: 225 | Train Loss: 0.0806701 Vali Loss: 0.0787315 Test Loss: 0.0870802
Validation loss decreased (0.126992 --> 0.078731).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0691525
	speed: 0.0518s/iter; left time: 1138.1042s
	iters: 200, epoch: 3 | loss: 0.0614118
	speed: 0.0302s/iter; left time: 659.7355s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.60s
Steps: 225 | Train Loss: 0.0671516 Vali Loss: 0.0750944 Test Loss: 0.0837143
Validation loss decreased (0.078731 --> 0.075094).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0640854
	speed: 0.0522s/iter; left time: 1134.8101s
	iters: 200, epoch: 4 | loss: 0.0640907
	speed: 0.0267s/iter; left time: 576.8637s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.31s
Steps: 225 | Train Loss: 0.0647488 Vali Loss: 0.0734687 Test Loss: 0.0827292
Validation loss decreased (0.075094 --> 0.073469).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0653637
	speed: 0.0531s/iter; left time: 1142.4148s
	iters: 200, epoch: 5 | loss: 0.0636200
	speed: 0.0277s/iter; left time: 593.6523s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.54s
Steps: 225 | Train Loss: 0.0630474 Vali Loss: 0.0722945 Test Loss: 0.0813779
Validation loss decreased (0.073469 --> 0.072295).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0613186
	speed: 0.0523s/iter; left time: 1113.6826s
	iters: 200, epoch: 6 | loss: 0.0656116
	speed: 0.0230s/iter; left time: 485.9906s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.90s
Steps: 225 | Train Loss: 0.0617380 Vali Loss: 0.0719124 Test Loss: 0.0807780
Validation loss decreased (0.072295 --> 0.071912).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0582949
	speed: 0.0482s/iter; left time: 1015.1316s
	iters: 200, epoch: 7 | loss: 0.0590653
	speed: 0.0243s/iter; left time: 509.8308s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.74s
Steps: 225 | Train Loss: 0.0609772 Vali Loss: 0.0714316 Test Loss: 0.0802214
Validation loss decreased (0.071912 --> 0.071432).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0644874
	speed: 0.0540s/iter; left time: 1123.6149s
	iters: 200, epoch: 8 | loss: 0.0571645
	speed: 0.0250s/iter; left time: 518.0083s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.18s
Steps: 225 | Train Loss: 0.0604138 Vali Loss: 0.0711555 Test Loss: 0.0802579
Validation loss decreased (0.071432 --> 0.071155).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0587581
	speed: 0.0511s/iter; left time: 1053.6666s
	iters: 200, epoch: 9 | loss: 0.0600904
	speed: 0.0257s/iter; left time: 526.2326s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.98s
Steps: 225 | Train Loss: 0.0599643 Vali Loss: 0.0709659 Test Loss: 0.0799562
Validation loss decreased (0.071155 --> 0.070966).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0593112
	speed: 0.0501s/iter; left time: 1021.1228s
	iters: 200, epoch: 10 | loss: 0.0603072
	speed: 0.0285s/iter; left time: 578.1482s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.40s
Steps: 225 | Train Loss: 0.0596653 Vali Loss: 0.0708955 Test Loss: 0.0799527
Validation loss decreased (0.070966 --> 0.070895).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0589053
	speed: 0.0753s/iter; left time: 1518.2250s
	iters: 200, epoch: 11 | loss: 0.0562900
	speed: 0.0291s/iter; left time: 583.6261s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.22s
Steps: 225 | Train Loss: 0.0594109 Vali Loss: 0.0705119 Test Loss: 0.0796882
Validation loss decreased (0.070895 --> 0.070512).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0573642
	speed: 0.0528s/iter; left time: 1052.9812s
	iters: 200, epoch: 12 | loss: 0.0584696
	speed: 0.0276s/iter; left time: 547.7858s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.44s
Steps: 225 | Train Loss: 0.0591482 Vali Loss: 0.0705204 Test Loss: 0.0793874
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0638459
	speed: 0.0578s/iter; left time: 1138.3965s
	iters: 200, epoch: 13 | loss: 0.0607723
	speed: 0.0283s/iter; left time: 554.7798s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.81s
Steps: 225 | Train Loss: 0.0589823 Vali Loss: 0.0704869 Test Loss: 0.0795223
Validation loss decreased (0.070512 --> 0.070487).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0577675
	speed: 0.0509s/iter; left time: 991.3312s
	iters: 200, epoch: 14 | loss: 0.0588133
	speed: 0.0295s/iter; left time: 570.8101s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.71s
Steps: 225 | Train Loss: 0.0587557 Vali Loss: 0.0704164 Test Loss: 0.0794338
Validation loss decreased (0.070487 --> 0.070416).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0598332
	speed: 0.0492s/iter; left time: 947.8349s
	iters: 200, epoch: 15 | loss: 0.0523763
	speed: 0.0297s/iter; left time: 568.7816s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.18s
Steps: 225 | Train Loss: 0.0586058 Vali Loss: 0.0703930 Test Loss: 0.0794698
Validation loss decreased (0.070416 --> 0.070393).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0569543
	speed: 0.0554s/iter; left time: 1053.8308s
	iters: 200, epoch: 16 | loss: 0.0575018
	speed: 0.0263s/iter; left time: 497.3045s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.63s
Steps: 225 | Train Loss: 0.0584718 Vali Loss: 0.0702827 Test Loss: 0.0793067
Validation loss decreased (0.070393 --> 0.070283).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0598423
	speed: 0.0545s/iter; left time: 1024.7249s
	iters: 200, epoch: 17 | loss: 0.0599144
	speed: 0.0320s/iter; left time: 597.9195s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.17s
Steps: 225 | Train Loss: 0.0583535 Vali Loss: 0.0702744 Test Loss: 0.0794939
Validation loss decreased (0.070283 --> 0.070274).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0531501
	speed: 0.0524s/iter; left time: 973.4115s
	iters: 200, epoch: 18 | loss: 0.0583698
	speed: 0.0240s/iter; left time: 443.3663s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.83s
Steps: 225 | Train Loss: 0.0582279 Vali Loss: 0.0703069 Test Loss: 0.0795386
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0582662
	speed: 0.0537s/iter; left time: 986.2555s
	iters: 200, epoch: 19 | loss: 0.0538871
	speed: 0.0289s/iter; left time: 528.2936s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.74s
Steps: 225 | Train Loss: 0.0581021 Vali Loss: 0.0702676 Test Loss: 0.0794995
Validation loss decreased (0.070274 --> 0.070268).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0593301
	speed: 0.0517s/iter; left time: 936.3111s
	iters: 200, epoch: 20 | loss: 0.0557304
	speed: 0.0262s/iter; left time: 473.0830s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.56s
Steps: 225 | Train Loss: 0.0580808 Vali Loss: 0.0702839 Test Loss: 0.0793468
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0583406
	speed: 0.0525s/iter; left time: 939.9182s
	iters: 200, epoch: 21 | loss: 0.0572454
	speed: 0.0188s/iter; left time: 335.3578s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.48s
Steps: 225 | Train Loss: 0.0579334 Vali Loss: 0.0701692 Test Loss: 0.0793286
Validation loss decreased (0.070268 --> 0.070169).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0610274
	speed: 0.0550s/iter; left time: 972.2716s
	iters: 200, epoch: 22 | loss: 0.0577461
	speed: 0.0284s/iter; left time: 499.9411s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.64s
Steps: 225 | Train Loss: 0.0579323 Vali Loss: 0.0701289 Test Loss: 0.0793362
Validation loss decreased (0.070169 --> 0.070129).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0563439
	speed: 0.0517s/iter; left time: 901.9143s
	iters: 200, epoch: 23 | loss: 0.0545914
	speed: 0.0307s/iter; left time: 533.3192s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0578198 Vali Loss: 0.0702303 Test Loss: 0.0793536
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0573807
	speed: 0.0552s/iter; left time: 951.4206s
	iters: 200, epoch: 24 | loss: 0.0569326
	speed: 0.0321s/iter; left time: 549.2525s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.37s
Steps: 225 | Train Loss: 0.0577844 Vali Loss: 0.0701173 Test Loss: 0.0793296
Validation loss decreased (0.070129 --> 0.070117).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0571284
	speed: 0.0541s/iter; left time: 919.4589s
	iters: 200, epoch: 25 | loss: 0.0566554
	speed: 0.0280s/iter; left time: 473.9388s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.47s
Steps: 225 | Train Loss: 0.0577751 Vali Loss: 0.0701227 Test Loss: 0.0793326
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0563635
	speed: 0.0589s/iter; left time: 988.5113s
	iters: 200, epoch: 26 | loss: 0.0566110
	speed: 0.0304s/iter; left time: 506.4226s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.44s
Steps: 225 | Train Loss: 0.0576640 Vali Loss: 0.0701074 Test Loss: 0.0793666
Validation loss decreased (0.070117 --> 0.070107).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0553515
	speed: 0.0546s/iter; left time: 903.8048s
	iters: 200, epoch: 27 | loss: 0.0582195
	speed: 0.0268s/iter; left time: 440.3848s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.43s
Steps: 225 | Train Loss: 0.0576551 Vali Loss: 0.0701082 Test Loss: 0.0793718
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0614190
	speed: 0.0477s/iter; left time: 779.2414s
	iters: 200, epoch: 28 | loss: 0.0561958
	speed: 0.0244s/iter; left time: 396.5185s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.64s
Steps: 225 | Train Loss: 0.0576140 Vali Loss: 0.0701166 Test Loss: 0.0793634
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0606842
	speed: 0.0532s/iter; left time: 856.1724s
	iters: 200, epoch: 29 | loss: 0.0555556
	speed: 0.0203s/iter; left time: 325.2840s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.98s
Steps: 225 | Train Loss: 0.0576270 Vali Loss: 0.0701248 Test Loss: 0.0793313
EarlyStopping counter: 3 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0551578
	speed: 0.0521s/iter; left time: 826.7042s
	iters: 200, epoch: 30 | loss: 0.0541448
	speed: 0.0280s/iter; left time: 442.1567s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.41s
Steps: 225 | Train Loss: 0.0575290 Vali Loss: 0.0701014 Test Loss: 0.0793224
Validation loss decreased (0.070107 --> 0.070101).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0569532
	speed: 0.0501s/iter; left time: 784.1890s
	iters: 200, epoch: 31 | loss: 0.0590402
	speed: 0.0277s/iter; left time: 431.0240s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.48s
Steps: 225 | Train Loss: 0.0575341 Vali Loss: 0.0701293 Test Loss: 0.0792899
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0571844
	speed: 0.0447s/iter; left time: 689.1812s
	iters: 200, epoch: 32 | loss: 0.0565367
	speed: 0.0187s/iter; left time: 286.4098s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0574716 Vali Loss: 0.0701118 Test Loss: 0.0792886
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0614607
	speed: 0.0485s/iter; left time: 737.1822s
	iters: 200, epoch: 33 | loss: 0.0585503
	speed: 0.0253s/iter; left time: 382.1650s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.92s
Steps: 225 | Train Loss: 0.0574797 Vali Loss: 0.0701058 Test Loss: 0.0793323
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0620264
	speed: 0.0463s/iter; left time: 692.9268s
	iters: 200, epoch: 34 | loss: 0.0566741
	speed: 0.0228s/iter; left time: 339.3732s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.18s
Steps: 225 | Train Loss: 0.0574723 Vali Loss: 0.0701067 Test Loss: 0.0793584
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0640683
	speed: 0.0486s/iter; left time: 717.0495s
	iters: 200, epoch: 35 | loss: 0.0572892
	speed: 0.0245s/iter; left time: 358.7730s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.90s
Steps: 225 | Train Loss: 0.0574351 Vali Loss: 0.0700687 Test Loss: 0.0792865
Validation loss decreased (0.070101 --> 0.070069).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0570007
	speed: 0.0449s/iter; left time: 652.3359s
	iters: 200, epoch: 36 | loss: 0.0618043
	speed: 0.0222s/iter; left time: 319.6043s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.14s
Steps: 225 | Train Loss: 0.0574811 Vali Loss: 0.0700867 Test Loss: 0.0792830
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0605867
	speed: 0.0494s/iter; left time: 706.4138s
	iters: 200, epoch: 37 | loss: 0.0583223
	speed: 0.0269s/iter; left time: 382.2192s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.31s
Steps: 225 | Train Loss: 0.0573955 Vali Loss: 0.0701139 Test Loss: 0.0793523
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0590914
	speed: 0.0483s/iter; left time: 679.5609s
	iters: 200, epoch: 38 | loss: 0.0547826
	speed: 0.0215s/iter; left time: 300.0339s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.21s
Steps: 225 | Train Loss: 0.0574274 Vali Loss: 0.0700677 Test Loss: 0.0793074
Validation loss decreased (0.070069 --> 0.070068).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0589866
	speed: 0.0537s/iter; left time: 743.1880s
	iters: 200, epoch: 39 | loss: 0.0568881
	speed: 0.0281s/iter; left time: 385.8270s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.65s
Steps: 225 | Train Loss: 0.0574272 Vali Loss: 0.0700669 Test Loss: 0.0793272
Validation loss decreased (0.070068 --> 0.070067).  Saving model ...
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0543563
	speed: 0.0558s/iter; left time: 760.0782s
	iters: 200, epoch: 40 | loss: 0.0559064
	speed: 0.0312s/iter; left time: 422.6715s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.05s
Steps: 225 | Train Loss: 0.0573883 Vali Loss: 0.0700760 Test Loss: 0.0793200
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0552888
	speed: 0.0556s/iter; left time: 745.0874s
	iters: 200, epoch: 41 | loss: 0.0582908
	speed: 0.0330s/iter; left time: 438.3193s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.63s
Steps: 225 | Train Loss: 0.0573937 Vali Loss: 0.0700766 Test Loss: 0.0793160
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0573349
	speed: 0.0530s/iter; left time: 697.8380s
	iters: 200, epoch: 42 | loss: 0.0566573
	speed: 0.0235s/iter; left time: 307.3896s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.93s
Steps: 225 | Train Loss: 0.0573726 Vali Loss: 0.0700556 Test Loss: 0.0793327
Validation loss decreased (0.070067 --> 0.070056).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0567332
	speed: 0.0516s/iter; left time: 668.2099s
	iters: 200, epoch: 43 | loss: 0.0599545
	speed: 0.0292s/iter; left time: 375.3033s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.70s
Steps: 225 | Train Loss: 0.0574122 Vali Loss: 0.0700747 Test Loss: 0.0793403
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0567316
	speed: 0.0564s/iter; left time: 717.8145s
	iters: 200, epoch: 44 | loss: 0.0537350
	speed: 0.0276s/iter; left time: 348.0495s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.75s
Steps: 225 | Train Loss: 0.0573724 Vali Loss: 0.0700628 Test Loss: 0.0793382
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0551076
	speed: 0.0511s/iter; left time: 638.9937s
	iters: 200, epoch: 45 | loss: 0.0591606
	speed: 0.0308s/iter; left time: 382.3509s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.58s
Steps: 225 | Train Loss: 0.0573695 Vali Loss: 0.0700636 Test Loss: 0.0793459
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0604501
	speed: 0.0471s/iter; left time: 578.1376s
	iters: 200, epoch: 46 | loss: 0.0595160
	speed: 0.0240s/iter; left time: 292.3925s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.66s
Steps: 225 | Train Loss: 0.0574024 Vali Loss: 0.0700707 Test Loss: 0.0793402
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0571790
	speed: 0.0522s/iter; left time: 628.4848s
	iters: 200, epoch: 47 | loss: 0.0627229
	speed: 0.0254s/iter; left time: 303.2714s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0573691 Vali Loss: 0.0700772 Test Loss: 0.0793330
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0578066
	speed: 0.0527s/iter; left time: 622.7475s
	iters: 200, epoch: 48 | loss: 0.0608316
	speed: 0.0285s/iter; left time: 333.8152s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.72s
Steps: 225 | Train Loss: 0.0573581 Vali Loss: 0.0700874 Test Loss: 0.0793788
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0570433
	speed: 0.0465s/iter; left time: 538.8687s
	iters: 200, epoch: 49 | loss: 0.0553163
	speed: 0.0188s/iter; left time: 216.7427s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:04.75s
Steps: 225 | Train Loss: 0.0573690 Vali Loss: 0.0700815 Test Loss: 0.0793844
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0559578
	speed: 0.0503s/iter; left time: 572.5681s
	iters: 200, epoch: 50 | loss: 0.0611283
	speed: 0.0302s/iter; left time: 340.5546s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.93s
Steps: 225 | Train Loss: 0.0573608 Vali Loss: 0.0700669 Test Loss: 0.0792996
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0546972
	speed: 0.0510s/iter; left time: 568.5301s
	iters: 200, epoch: 51 | loss: 0.0589048
	speed: 0.0247s/iter; left time: 273.4462s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.90s
Steps: 225 | Train Loss: 0.0573474 Vali Loss: 0.0700608 Test Loss: 0.0793011
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0557716
	speed: 0.0488s/iter; left time: 532.8271s
	iters: 200, epoch: 52 | loss: 0.0602678
	speed: 0.0254s/iter; left time: 274.5286s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.93s
Steps: 225 | Train Loss: 0.0573041 Vali Loss: 0.0700850 Test Loss: 0.0793761
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_96_FR_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018991485238075256, rmse:0.1378096044063568, mae:0.07933271676301956, rse:0.5330842137336731
Intermediate time for FR and pred_len 96: 00h:14m:24.22s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_168_168_FR', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1272520
	speed: 0.0492s/iter; left time: 1101.5652s
	iters: 200, epoch: 1 | loss: 0.1139134
	speed: 0.0240s/iter; left time: 536.2550s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.92s
Steps: 225 | Train Loss: 0.1276170 Vali Loss: 0.1304395 Test Loss: 0.1474907
Validation loss decreased (inf --> 0.130440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0772742
	speed: 0.0501s/iter; left time: 1111.2304s
	iters: 200, epoch: 2 | loss: 0.0683886
	speed: 0.0213s/iter; left time: 470.3157s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.43s
Steps: 225 | Train Loss: 0.0839309 Vali Loss: 0.0828477 Test Loss: 0.0916202
Validation loss decreased (0.130440 --> 0.082848).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0726576
	speed: 0.0470s/iter; left time: 1030.6752s
	iters: 200, epoch: 3 | loss: 0.0670449
	speed: 0.0214s/iter; left time: 466.5992s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.23s
Steps: 225 | Train Loss: 0.0717557 Vali Loss: 0.0794046 Test Loss: 0.0888894
Validation loss decreased (0.082848 --> 0.079405).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0673546
	speed: 0.0447s/iter; left time: 970.9455s
	iters: 200, epoch: 4 | loss: 0.0745090
	speed: 0.0269s/iter; left time: 581.0832s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.59s
Steps: 225 | Train Loss: 0.0693919 Vali Loss: 0.0777480 Test Loss: 0.0877899
Validation loss decreased (0.079405 --> 0.077748).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0681390
	speed: 0.0503s/iter; left time: 1081.6265s
	iters: 200, epoch: 5 | loss: 0.0653466
	speed: 0.0202s/iter; left time: 433.0355s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.43s
Steps: 225 | Train Loss: 0.0677026 Vali Loss: 0.0764982 Test Loss: 0.0866170
Validation loss decreased (0.077748 --> 0.076498).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0675271
	speed: 0.0541s/iter; left time: 1151.7150s
	iters: 200, epoch: 6 | loss: 0.0634571
	speed: 0.0293s/iter; left time: 620.6307s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:07.03s
Steps: 225 | Train Loss: 0.0665270 Vali Loss: 0.0759238 Test Loss: 0.0860975
Validation loss decreased (0.076498 --> 0.075924).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0627982
	speed: 0.0459s/iter; left time: 966.3228s
	iters: 200, epoch: 7 | loss: 0.0680622
	speed: 0.0213s/iter; left time: 446.3492s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0657958 Vali Loss: 0.0757242 Test Loss: 0.0859290
Validation loss decreased (0.075924 --> 0.075724).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0685889
	speed: 0.0441s/iter; left time: 919.0819s
	iters: 200, epoch: 8 | loss: 0.0655987
	speed: 0.0221s/iter; left time: 458.5884s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.09s
Steps: 225 | Train Loss: 0.0653262 Vali Loss: 0.0755243 Test Loss: 0.0856274
Validation loss decreased (0.075724 --> 0.075524).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0654939
	speed: 0.0492s/iter; left time: 1014.3947s
	iters: 200, epoch: 9 | loss: 0.0621993
	speed: 0.0216s/iter; left time: 443.1129s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:05.69s
Steps: 225 | Train Loss: 0.0648884 Vali Loss: 0.0751519 Test Loss: 0.0856586
Validation loss decreased (0.075524 --> 0.075152).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0643409
	speed: 0.0482s/iter; left time: 982.9063s
	iters: 200, epoch: 10 | loss: 0.0636073
	speed: 0.0191s/iter; left time: 387.8380s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0645998 Vali Loss: 0.0750313 Test Loss: 0.0854118
Validation loss decreased (0.075152 --> 0.075031).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0610782
	speed: 0.0507s/iter; left time: 1020.8416s
	iters: 200, epoch: 11 | loss: 0.0642931
	speed: 0.0244s/iter; left time: 489.6179s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.08s
Steps: 225 | Train Loss: 0.0643136 Vali Loss: 0.0749084 Test Loss: 0.0854673
Validation loss decreased (0.075031 --> 0.074908).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0623670
	speed: 0.0474s/iter; left time: 944.3121s
	iters: 200, epoch: 12 | loss: 0.0672583
	speed: 0.0233s/iter; left time: 461.5854s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:05.35s
Steps: 225 | Train Loss: 0.0640396 Vali Loss: 0.0749552 Test Loss: 0.0856013
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0622854
	speed: 0.0489s/iter; left time: 963.3810s
	iters: 200, epoch: 13 | loss: 0.0659144
	speed: 0.0277s/iter; left time: 542.3553s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0638592 Vali Loss: 0.0748083 Test Loss: 0.0855789
Validation loss decreased (0.074908 --> 0.074808).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0620585
	speed: 0.0479s/iter; left time: 932.4632s
	iters: 200, epoch: 14 | loss: 0.0654317
	speed: 0.0222s/iter; left time: 430.8096s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.26s
Steps: 225 | Train Loss: 0.0636821 Vali Loss: 0.0747042 Test Loss: 0.0855131
Validation loss decreased (0.074808 --> 0.074704).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0631975
	speed: 0.0508s/iter; left time: 977.2015s
	iters: 200, epoch: 15 | loss: 0.0654471
	speed: 0.0243s/iter; left time: 465.9689s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.06s
Steps: 225 | Train Loss: 0.0635583 Vali Loss: 0.0747427 Test Loss: 0.0856473
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0613949
	speed: 0.0538s/iter; left time: 1022.7058s
	iters: 200, epoch: 16 | loss: 0.0665923
	speed: 0.0234s/iter; left time: 442.3252s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.05s
Steps: 225 | Train Loss: 0.0633783 Vali Loss: 0.0747351 Test Loss: 0.0856458
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0659078
	speed: 0.0548s/iter; left time: 1029.4383s
	iters: 200, epoch: 17 | loss: 0.0635712
	speed: 0.0291s/iter; left time: 543.3666s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0632849 Vali Loss: 0.0746098 Test Loss: 0.0856807
Validation loss decreased (0.074704 --> 0.074610).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0638385
	speed: 0.0540s/iter; left time: 1003.2143s
	iters: 200, epoch: 18 | loss: 0.0646904
	speed: 0.0318s/iter; left time: 588.2910s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.06s
Steps: 225 | Train Loss: 0.0632165 Vali Loss: 0.0746178 Test Loss: 0.0858439
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0635223
	speed: 0.0513s/iter; left time: 941.2106s
	iters: 200, epoch: 19 | loss: 0.0610002
	speed: 0.0265s/iter; left time: 483.1220s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.03s
Steps: 225 | Train Loss: 0.0631096 Vali Loss: 0.0746138 Test Loss: 0.0857874
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0613484
	speed: 0.0492s/iter; left time: 892.2471s
	iters: 200, epoch: 20 | loss: 0.0664193
	speed: 0.0285s/iter; left time: 513.5429s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.32s
Steps: 225 | Train Loss: 0.0630244 Vali Loss: 0.0746466 Test Loss: 0.0857259
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0656793
	speed: 0.0478s/iter; left time: 856.4265s
	iters: 200, epoch: 21 | loss: 0.0620232
	speed: 0.0270s/iter; left time: 481.2618s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.21s
Steps: 225 | Train Loss: 0.0629531 Vali Loss: 0.0745882 Test Loss: 0.0856962
Validation loss decreased (0.074610 --> 0.074588).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0627351
	speed: 0.0517s/iter; left time: 914.3328s
	iters: 200, epoch: 22 | loss: 0.0617253
	speed: 0.0257s/iter; left time: 451.8136s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.08s
Steps: 225 | Train Loss: 0.0628690 Vali Loss: 0.0744990 Test Loss: 0.0857268
Validation loss decreased (0.074588 --> 0.074499).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0635282
	speed: 0.0510s/iter; left time: 889.9966s
	iters: 200, epoch: 23 | loss: 0.0617497
	speed: 0.0231s/iter; left time: 400.0864s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.71s
Steps: 225 | Train Loss: 0.0627902 Vali Loss: 0.0745341 Test Loss: 0.0856929
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0596462
	speed: 0.0512s/iter; left time: 882.2671s
	iters: 200, epoch: 24 | loss: 0.0616790
	speed: 0.0272s/iter; left time: 466.0478s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.43s
Steps: 225 | Train Loss: 0.0627450 Vali Loss: 0.0746024 Test Loss: 0.0857222
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0621714
	speed: 0.0543s/iter; left time: 922.7509s
	iters: 200, epoch: 25 | loss: 0.0623515
	speed: 0.0305s/iter; left time: 514.8722s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.94s
Steps: 225 | Train Loss: 0.0626844 Vali Loss: 0.0744575 Test Loss: 0.0859434
Validation loss decreased (0.074499 --> 0.074457).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0606405
	speed: 0.0497s/iter; left time: 833.4542s
	iters: 200, epoch: 26 | loss: 0.0639716
	speed: 0.0273s/iter; left time: 454.5298s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.43s
Steps: 225 | Train Loss: 0.0626402 Vali Loss: 0.0744846 Test Loss: 0.0857622
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0605102
	speed: 0.0492s/iter; left time: 814.8225s
	iters: 200, epoch: 27 | loss: 0.0630375
	speed: 0.0220s/iter; left time: 362.4909s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:05.29s
Steps: 225 | Train Loss: 0.0626157 Vali Loss: 0.0744742 Test Loss: 0.0858825
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0621221
	speed: 0.0460s/iter; left time: 751.6802s
	iters: 200, epoch: 28 | loss: 0.0587539
	speed: 0.0286s/iter; left time: 464.0103s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.43s
Steps: 225 | Train Loss: 0.0625750 Vali Loss: 0.0745418 Test Loss: 0.0858210
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0625541
	speed: 0.0584s/iter; left time: 940.5929s
	iters: 200, epoch: 29 | loss: 0.0623563
	speed: 0.0256s/iter; left time: 408.8591s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.43s
Steps: 225 | Train Loss: 0.0625338 Vali Loss: 0.0744981 Test Loss: 0.0858277
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0661957
	speed: 0.0467s/iter; left time: 740.7239s
	iters: 200, epoch: 30 | loss: 0.0639525
	speed: 0.0234s/iter; left time: 369.6245s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.79s
Steps: 225 | Train Loss: 0.0625691 Vali Loss: 0.0744574 Test Loss: 0.0858844
Validation loss decreased (0.074457 --> 0.074457).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0596946
	speed: 0.0532s/iter; left time: 833.3101s
	iters: 200, epoch: 31 | loss: 0.0621399
	speed: 0.0269s/iter; left time: 418.4542s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.28s
Steps: 225 | Train Loss: 0.0625227 Vali Loss: 0.0745119 Test Loss: 0.0858060
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0618315
	speed: 0.0503s/iter; left time: 775.1976s
	iters: 200, epoch: 32 | loss: 0.0648636
	speed: 0.0241s/iter; left time: 369.4188s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.82s
Steps: 225 | Train Loss: 0.0624774 Vali Loss: 0.0744580 Test Loss: 0.0859242
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0618293
	speed: 0.0489s/iter; left time: 743.9601s
	iters: 200, epoch: 33 | loss: 0.0698456
	speed: 0.0279s/iter; left time: 421.1545s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.47s
Steps: 225 | Train Loss: 0.0624404 Vali Loss: 0.0744743 Test Loss: 0.0858578
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0602348
	speed: 0.0474s/iter; left time: 710.4054s
	iters: 200, epoch: 34 | loss: 0.0632259
	speed: 0.0262s/iter; left time: 389.9239s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.84s
Steps: 225 | Train Loss: 0.0624635 Vali Loss: 0.0745623 Test Loss: 0.0858491
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0614640
	speed: 0.0456s/iter; left time: 672.8144s
	iters: 200, epoch: 35 | loss: 0.0617883
	speed: 0.0226s/iter; left time: 331.6580s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.38s
Steps: 225 | Train Loss: 0.0624872 Vali Loss: 0.0745251 Test Loss: 0.0858337
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0650040
	speed: 0.0510s/iter; left time: 740.1499s
	iters: 200, epoch: 36 | loss: 0.0643411
	speed: 0.0277s/iter; left time: 398.8791s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.38s
Steps: 225 | Train Loss: 0.0624353 Vali Loss: 0.0746154 Test Loss: 0.0858895
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0628083
	speed: 0.0474s/iter; left time: 678.1016s
	iters: 200, epoch: 37 | loss: 0.0638829
	speed: 0.0210s/iter; left time: 298.1996s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.09s
Steps: 225 | Train Loss: 0.0624339 Vali Loss: 0.0744218 Test Loss: 0.0858261
Validation loss decreased (0.074457 --> 0.074422).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0617154
	speed: 0.0473s/iter; left time: 666.3509s
	iters: 200, epoch: 38 | loss: 0.0624265
	speed: 0.0191s/iter; left time: 267.0454s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.03s
Steps: 225 | Train Loss: 0.0623945 Vali Loss: 0.0745134 Test Loss: 0.0858380
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0633624
	speed: 0.0533s/iter; left time: 738.4684s
	iters: 200, epoch: 39 | loss: 0.0634164
	speed: 0.0320s/iter; left time: 440.2722s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:07.37s
Steps: 225 | Train Loss: 0.0623897 Vali Loss: 0.0745301 Test Loss: 0.0859188
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0604515
	speed: 0.0538s/iter; left time: 733.2661s
	iters: 200, epoch: 40 | loss: 0.0654750
	speed: 0.0271s/iter; left time: 366.3431s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.45s
Steps: 225 | Train Loss: 0.0623177 Vali Loss: 0.0744232 Test Loss: 0.0858311
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0626954
	speed: 0.0497s/iter; left time: 666.4850s
	iters: 200, epoch: 41 | loss: 0.0635799
	speed: 0.0300s/iter; left time: 398.7194s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.42s
Steps: 225 | Train Loss: 0.0623073 Vali Loss: 0.0744998 Test Loss: 0.0858700
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0620622
	speed: 0.0491s/iter; left time: 647.1998s
	iters: 200, epoch: 42 | loss: 0.0633982
	speed: 0.0269s/iter; left time: 351.5397s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.29s
Steps: 225 | Train Loss: 0.0623295 Vali Loss: 0.0744531 Test Loss: 0.0858385
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0635427
	speed: 0.0539s/iter; left time: 697.7081s
	iters: 200, epoch: 43 | loss: 0.0640768
	speed: 0.0264s/iter; left time: 339.8718s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.52s
Steps: 225 | Train Loss: 0.0623399 Vali Loss: 0.0745088 Test Loss: 0.0858960
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0627989
	speed: 0.0455s/iter; left time: 578.7728s
	iters: 200, epoch: 44 | loss: 0.0654221
	speed: 0.0256s/iter; left time: 323.1330s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:05.52s
Steps: 225 | Train Loss: 0.0623654 Vali Loss: 0.0744741 Test Loss: 0.0858343
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0631965
	speed: 0.0537s/iter; left time: 671.3306s
	iters: 200, epoch: 45 | loss: 0.0595206
	speed: 0.0276s/iter; left time: 341.8205s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.70s
Steps: 225 | Train Loss: 0.0623582 Vali Loss: 0.0745196 Test Loss: 0.0859488
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0618657
	speed: 0.0501s/iter; left time: 614.9053s
	iters: 200, epoch: 46 | loss: 0.0618082
	speed: 0.0288s/iter; left time: 350.4005s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.18s
Steps: 225 | Train Loss: 0.0623630 Vali Loss: 0.0744667 Test Loss: 0.0858532
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0612222
	speed: 0.0483s/iter; left time: 582.4565s
	iters: 200, epoch: 47 | loss: 0.0634084
	speed: 0.0282s/iter; left time: 336.6874s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.22s
Steps: 225 | Train Loss: 0.0623304 Vali Loss: 0.0743896 Test Loss: 0.0858907
Validation loss decreased (0.074422 --> 0.074390).  Saving model ...
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0600213
	speed: 0.0463s/iter; left time: 547.6210s
	iters: 200, epoch: 48 | loss: 0.0635485
	speed: 0.0218s/iter; left time: 255.9984s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.29s
Steps: 225 | Train Loss: 0.0623316 Vali Loss: 0.0745217 Test Loss: 0.0859320
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0597138
	speed: 0.0468s/iter; left time: 543.1816s
	iters: 200, epoch: 49 | loss: 0.0602840
	speed: 0.0246s/iter; left time: 282.9012s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.70s
Steps: 225 | Train Loss: 0.0622687 Vali Loss: 0.0744689 Test Loss: 0.0859321
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0644672
	speed: 0.0547s/iter; left time: 622.2777s
	iters: 200, epoch: 50 | loss: 0.0601074
	speed: 0.0278s/iter; left time: 313.1249s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:06.57s
Steps: 225 | Train Loss: 0.0623085 Vali Loss: 0.0744889 Test Loss: 0.0859750
EarlyStopping counter: 3 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0590142
	speed: 0.0469s/iter; left time: 522.4444s
	iters: 200, epoch: 51 | loss: 0.0604234
	speed: 0.0206s/iter; left time: 227.9378s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.02s
Steps: 225 | Train Loss: 0.0623346 Vali Loss: 0.0745170 Test Loss: 0.0859061
EarlyStopping counter: 4 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0625177
	speed: 0.0490s/iter; left time: 535.5851s
	iters: 200, epoch: 52 | loss: 0.0613102
	speed: 0.0248s/iter; left time: 268.5424s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0623311 Vali Loss: 0.0744508 Test Loss: 0.0859454
EarlyStopping counter: 5 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0623345
	speed: 0.0513s/iter; left time: 548.7204s
	iters: 200, epoch: 53 | loss: 0.0620558
	speed: 0.0272s/iter; left time: 288.3595s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0623070 Vali Loss: 0.0744105 Test Loss: 0.0859452
EarlyStopping counter: 6 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0626286
	speed: 0.0458s/iter; left time: 479.8098s
	iters: 200, epoch: 54 | loss: 0.0602639
	speed: 0.0213s/iter; left time: 220.5401s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.25s
Steps: 225 | Train Loss: 0.0622840 Vali Loss: 0.0744894 Test Loss: 0.0858701
EarlyStopping counter: 7 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0637947
	speed: 0.0510s/iter; left time: 522.4412s
	iters: 200, epoch: 55 | loss: 0.0634702
	speed: 0.0207s/iter; left time: 209.6936s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:05.61s
Steps: 225 | Train Loss: 0.0623053 Vali Loss: 0.0744373 Test Loss: 0.0858628
EarlyStopping counter: 8 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0606350
	speed: 0.0500s/iter; left time: 501.1912s
	iters: 200, epoch: 56 | loss: 0.0630527
	speed: 0.0237s/iter; left time: 235.5508s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.02s
Steps: 225 | Train Loss: 0.0623080 Vali Loss: 0.0744589 Test Loss: 0.0859321
EarlyStopping counter: 9 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0608659
	speed: 0.0516s/iter; left time: 505.3181s
	iters: 200, epoch: 57 | loss: 0.0651965
	speed: 0.0244s/iter; left time: 236.6058s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:05.90s
Steps: 225 | Train Loss: 0.0622864 Vali Loss: 0.0745124 Test Loss: 0.0859003
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020789824426174164, rmse:0.14418676495552063, mae:0.08589069545269012, rse:0.5584490299224854
Use GPU: cuda:0
>>>>>>>start training : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1283359
	speed: 0.0253s/iter; left time: 567.8639s
	iters: 200, epoch: 1 | loss: 0.1182079
	speed: 0.0241s/iter; left time: 536.7329s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.73s
Steps: 225 | Train Loss: 0.1275120 Vali Loss: 0.1307549 Test Loss: 0.1478369
Validation loss decreased (inf --> 0.130755).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0830578
	speed: 0.0536s/iter; left time: 1188.3188s
	iters: 200, epoch: 2 | loss: 0.0782976
	speed: 0.0232s/iter; left time: 513.0921s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.74s
Steps: 225 | Train Loss: 0.0844567 Vali Loss: 0.0833374 Test Loss: 0.0920598
Validation loss decreased (0.130755 --> 0.083337).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0738854
	speed: 0.0475s/iter; left time: 1042.2190s
	iters: 200, epoch: 3 | loss: 0.0730405
	speed: 0.0205s/iter; left time: 448.3451s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.14s
Steps: 225 | Train Loss: 0.0719282 Vali Loss: 0.0796686 Test Loss: 0.0888616
Validation loss decreased (0.083337 --> 0.079669).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0686242
	speed: 0.0538s/iter; left time: 1168.8054s
	iters: 200, epoch: 4 | loss: 0.0633135
	speed: 0.0308s/iter; left time: 665.8044s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.04s
Steps: 225 | Train Loss: 0.0690934 Vali Loss: 0.0779210 Test Loss: 0.0876197
Validation loss decreased (0.079669 --> 0.077921).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0696057
	speed: 0.0542s/iter; left time: 1166.2125s
	iters: 200, epoch: 5 | loss: 0.0686394
	speed: 0.0275s/iter; left time: 588.7485s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.53s
Steps: 225 | Train Loss: 0.0673277 Vali Loss: 0.0770012 Test Loss: 0.0867868
Validation loss decreased (0.077921 --> 0.077001).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0645938
	speed: 0.0586s/iter; left time: 1247.3115s
	iters: 200, epoch: 6 | loss: 0.0635069
	speed: 0.0252s/iter; left time: 533.0007s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.51s
Steps: 225 | Train Loss: 0.0663026 Vali Loss: 0.0762333 Test Loss: 0.0860183
Validation loss decreased (0.077001 --> 0.076233).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0630857
	speed: 0.0557s/iter; left time: 1172.5905s
	iters: 200, epoch: 7 | loss: 0.0592810
	speed: 0.0300s/iter; left time: 628.8412s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.05s
Steps: 225 | Train Loss: 0.0656490 Vali Loss: 0.0758989 Test Loss: 0.0859655
Validation loss decreased (0.076233 --> 0.075899).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0623031
	speed: 0.0531s/iter; left time: 1106.6912s
	iters: 200, epoch: 8 | loss: 0.0678525
	speed: 0.0237s/iter; left time: 490.8001s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.71s
Steps: 225 | Train Loss: 0.0652322 Vali Loss: 0.0758925 Test Loss: 0.0854810
Validation loss decreased (0.075899 --> 0.075892).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0667703
	speed: 0.0525s/iter; left time: 1080.7308s
	iters: 200, epoch: 9 | loss: 0.0680243
	speed: 0.0266s/iter; left time: 546.2605s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0648445 Vali Loss: 0.0756965 Test Loss: 0.0852528
Validation loss decreased (0.075892 --> 0.075697).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0628252
	speed: 0.0517s/iter; left time: 1053.5825s
	iters: 200, epoch: 10 | loss: 0.0643737
	speed: 0.0204s/iter; left time: 414.1332s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.43s
Steps: 225 | Train Loss: 0.0644856 Vali Loss: 0.0754460 Test Loss: 0.0854238
Validation loss decreased (0.075697 --> 0.075446).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0658455
	speed: 0.0526s/iter; left time: 1060.0858s
	iters: 200, epoch: 11 | loss: 0.0642555
	speed: 0.0284s/iter; left time: 569.6450s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.64s
Steps: 225 | Train Loss: 0.0642728 Vali Loss: 0.0753982 Test Loss: 0.0853674
Validation loss decreased (0.075446 --> 0.075398).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0610631
	speed: 0.0514s/iter; left time: 1023.2376s
	iters: 200, epoch: 12 | loss: 0.0644557
	speed: 0.0273s/iter; left time: 542.0686s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.23s
Steps: 225 | Train Loss: 0.0640375 Vali Loss: 0.0751443 Test Loss: 0.0850488
Validation loss decreased (0.075398 --> 0.075144).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0640642
	speed: 0.0513s/iter; left time: 1010.9889s
	iters: 200, epoch: 13 | loss: 0.0608970
	speed: 0.0247s/iter; left time: 484.5182s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.99s
Steps: 225 | Train Loss: 0.0638459 Vali Loss: 0.0751370 Test Loss: 0.0852346
Validation loss decreased (0.075144 --> 0.075137).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0636537
	speed: 0.0544s/iter; left time: 1059.7232s
	iters: 200, epoch: 14 | loss: 0.0641293
	speed: 0.0259s/iter; left time: 500.9814s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.24s
Steps: 225 | Train Loss: 0.0636891 Vali Loss: 0.0751352 Test Loss: 0.0852650
Validation loss decreased (0.075137 --> 0.075135).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0652704
	speed: 0.0478s/iter; left time: 921.0010s
	iters: 200, epoch: 15 | loss: 0.0603209
	speed: 0.0259s/iter; left time: 496.3842s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.91s
Steps: 225 | Train Loss: 0.0634916 Vali Loss: 0.0751293 Test Loss: 0.0853076
Validation loss decreased (0.075135 --> 0.075129).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0600324
	speed: 0.0561s/iter; left time: 1066.4254s
	iters: 200, epoch: 16 | loss: 0.0660657
	speed: 0.0233s/iter; left time: 441.8419s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.14s
Steps: 225 | Train Loss: 0.0633372 Vali Loss: 0.0751984 Test Loss: 0.0854423
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0680200
	speed: 0.0532s/iter; left time: 1000.0359s
	iters: 200, epoch: 17 | loss: 0.0648509
	speed: 0.0287s/iter; left time: 536.5588s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.60s
Steps: 225 | Train Loss: 0.0632565 Vali Loss: 0.0749803 Test Loss: 0.0854133
Validation loss decreased (0.075129 --> 0.074980).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0647032
	speed: 0.0552s/iter; left time: 1025.1044s
	iters: 200, epoch: 18 | loss: 0.0598428
	speed: 0.0306s/iter; left time: 566.0337s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.00s
Steps: 225 | Train Loss: 0.0631523 Vali Loss: 0.0749387 Test Loss: 0.0854822
Validation loss decreased (0.074980 --> 0.074939).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0668046
	speed: 0.0576s/iter; left time: 1056.8033s
	iters: 200, epoch: 19 | loss: 0.0596661
	speed: 0.0292s/iter; left time: 532.3472s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.86s
Steps: 225 | Train Loss: 0.0630589 Vali Loss: 0.0750222 Test Loss: 0.0852431
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0618846
	speed: 0.0544s/iter; left time: 985.2407s
	iters: 200, epoch: 20 | loss: 0.0643297
	speed: 0.0274s/iter; left time: 493.7162s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.50s
Steps: 225 | Train Loss: 0.0629882 Vali Loss: 0.0749454 Test Loss: 0.0854134
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0642228
	speed: 0.0521s/iter; left time: 932.0568s
	iters: 200, epoch: 21 | loss: 0.0603757
	speed: 0.0299s/iter; left time: 532.6462s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.77s
Steps: 225 | Train Loss: 0.0629317 Vali Loss: 0.0750512 Test Loss: 0.0852952
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0606580
	speed: 0.0556s/iter; left time: 982.8903s
	iters: 200, epoch: 22 | loss: 0.0608251
	speed: 0.0271s/iter; left time: 476.8428s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.63s
Steps: 225 | Train Loss: 0.0628622 Vali Loss: 0.0750110 Test Loss: 0.0853213
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0661985
	speed: 0.0522s/iter; left time: 911.2059s
	iters: 200, epoch: 23 | loss: 0.0606835
	speed: 0.0288s/iter; left time: 499.4319s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.58s
Steps: 225 | Train Loss: 0.0627658 Vali Loss: 0.0750056 Test Loss: 0.0853894
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0657220
	speed: 0.0499s/iter; left time: 859.2146s
	iters: 200, epoch: 24 | loss: 0.0632927
	speed: 0.0215s/iter; left time: 368.2666s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.29s
Steps: 225 | Train Loss: 0.0627181 Vali Loss: 0.0750028 Test Loss: 0.0853932
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0642134
	speed: 0.0522s/iter; left time: 887.1616s
	iters: 200, epoch: 25 | loss: 0.0661637
	speed: 0.0252s/iter; left time: 425.0814s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.39s
Steps: 225 | Train Loss: 0.0626534 Vali Loss: 0.0749225 Test Loss: 0.0854760
Validation loss decreased (0.074939 --> 0.074923).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0633271
	speed: 0.0608s/iter; left time: 1020.3258s
	iters: 200, epoch: 26 | loss: 0.0659848
	speed: 0.0302s/iter; left time: 504.2699s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.55s
Steps: 225 | Train Loss: 0.0625923 Vali Loss: 0.0750195 Test Loss: 0.0855144
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0615869
	speed: 0.0571s/iter; left time: 945.8798s
	iters: 200, epoch: 27 | loss: 0.0625416
	speed: 0.0302s/iter; left time: 496.9428s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.99s
Steps: 225 | Train Loss: 0.0625670 Vali Loss: 0.0749205 Test Loss: 0.0854166
Validation loss decreased (0.074923 --> 0.074920).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0610086
	speed: 0.0563s/iter; left time: 919.6652s
	iters: 200, epoch: 28 | loss: 0.0594363
	speed: 0.0270s/iter; left time: 438.3991s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.70s
Steps: 225 | Train Loss: 0.0625560 Vali Loss: 0.0749292 Test Loss: 0.0854552
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0659877
	speed: 0.0512s/iter; left time: 824.3693s
	iters: 200, epoch: 29 | loss: 0.0670725
	speed: 0.0267s/iter; left time: 427.8664s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.13s
Steps: 225 | Train Loss: 0.0625343 Vali Loss: 0.0749282 Test Loss: 0.0854419
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0629614
	speed: 0.0547s/iter; left time: 867.9643s
	iters: 200, epoch: 30 | loss: 0.0623289
	speed: 0.0320s/iter; left time: 504.3335s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:07.20s
Steps: 225 | Train Loss: 0.0625158 Vali Loss: 0.0750068 Test Loss: 0.0855481
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0619467
	speed: 0.0529s/iter; left time: 827.8931s
	iters: 200, epoch: 31 | loss: 0.0611455
	speed: 0.0338s/iter; left time: 525.0281s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.88s
Steps: 225 | Train Loss: 0.0624699 Vali Loss: 0.0748934 Test Loss: 0.0854585
Validation loss decreased (0.074920 --> 0.074893).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0635809
	speed: 0.0514s/iter; left time: 793.1488s
	iters: 200, epoch: 32 | loss: 0.0642294
	speed: 0.0251s/iter; left time: 384.3642s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.07s
Steps: 225 | Train Loss: 0.0624576 Vali Loss: 0.0749186 Test Loss: 0.0854044
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0611105
	speed: 0.0558s/iter; left time: 847.7393s
	iters: 200, epoch: 33 | loss: 0.0619674
	speed: 0.0229s/iter; left time: 345.4042s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.14s
Steps: 225 | Train Loss: 0.0623846 Vali Loss: 0.0749059 Test Loss: 0.0854875
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0613588
	speed: 0.0480s/iter; left time: 719.3883s
	iters: 200, epoch: 34 | loss: 0.0637927
	speed: 0.0273s/iter; left time: 406.7121s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.25s
Steps: 225 | Train Loss: 0.0623770 Vali Loss: 0.0749009 Test Loss: 0.0855714
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0653247
	speed: 0.0487s/iter; left time: 718.1310s
	iters: 200, epoch: 35 | loss: 0.0641193
	speed: 0.0208s/iter; left time: 304.4126s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.32s
Steps: 225 | Train Loss: 0.0624001 Vali Loss: 0.0749931 Test Loss: 0.0855564
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0618253
	speed: 0.0563s/iter; left time: 817.7947s
	iters: 200, epoch: 36 | loss: 0.0606291
	speed: 0.0273s/iter; left time: 394.3527s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.87s
Steps: 225 | Train Loss: 0.0624052 Vali Loss: 0.0748966 Test Loss: 0.0855036
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0611519
	speed: 0.0557s/iter; left time: 797.2574s
	iters: 200, epoch: 37 | loss: 0.0656925
	speed: 0.0257s/iter; left time: 365.1492s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0623474 Vali Loss: 0.0749378 Test Loss: 0.0855539
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0610135
	speed: 0.0491s/iter; left time: 690.7544s
	iters: 200, epoch: 38 | loss: 0.0591451
	speed: 0.0266s/iter; left time: 371.7748s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.10s
Steps: 225 | Train Loss: 0.0623356 Vali Loss: 0.0747937 Test Loss: 0.0855813
Validation loss decreased (0.074893 --> 0.074794).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0592215
	speed: 0.0573s/iter; left time: 792.9953s
	iters: 200, epoch: 39 | loss: 0.0593245
	speed: 0.0242s/iter; left time: 333.3300s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.38s
Steps: 225 | Train Loss: 0.0623109 Vali Loss: 0.0748570 Test Loss: 0.0854844
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0583931
	speed: 0.0539s/iter; left time: 733.9690s
	iters: 200, epoch: 40 | loss: 0.0640757
	speed: 0.0304s/iter; left time: 410.5886s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.97s
Steps: 225 | Train Loss: 0.0623167 Vali Loss: 0.0748829 Test Loss: 0.0856129
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0629319
	speed: 0.0576s/iter; left time: 771.7637s
	iters: 200, epoch: 41 | loss: 0.0639222
	speed: 0.0299s/iter; left time: 397.9419s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:07.20s
Steps: 225 | Train Loss: 0.0623059 Vali Loss: 0.0749194 Test Loss: 0.0854952
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0605636
	speed: 0.0492s/iter; left time: 648.6852s
	iters: 200, epoch: 42 | loss: 0.0606836
	speed: 0.0221s/iter; left time: 288.7386s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.39s
Steps: 225 | Train Loss: 0.0622782 Vali Loss: 0.0748565 Test Loss: 0.0855952
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0565898
	speed: 0.0493s/iter; left time: 638.6200s
	iters: 200, epoch: 43 | loss: 0.0611770
	speed: 0.0267s/iter; left time: 343.0978s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.00s
Steps: 225 | Train Loss: 0.0622456 Vali Loss: 0.0748971 Test Loss: 0.0854784
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0642892
	speed: 0.0528s/iter; left time: 672.1934s
	iters: 200, epoch: 44 | loss: 0.0683638
	speed: 0.0276s/iter; left time: 348.4717s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.68s
Steps: 225 | Train Loss: 0.0622681 Vali Loss: 0.0748256 Test Loss: 0.0855006
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0622593
	speed: 0.0586s/iter; left time: 732.2586s
	iters: 200, epoch: 45 | loss: 0.0605665
	speed: 0.0210s/iter; left time: 260.8392s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.04s
Steps: 225 | Train Loss: 0.0622936 Vali Loss: 0.0749247 Test Loss: 0.0855703
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0600760
	speed: 0.0542s/iter; left time: 665.7845s
	iters: 200, epoch: 46 | loss: 0.0623929
	speed: 0.0317s/iter; left time: 385.6824s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.22s
Steps: 225 | Train Loss: 0.0622719 Vali Loss: 0.0749354 Test Loss: 0.0855073
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0639851
	speed: 0.0575s/iter; left time: 693.2281s
	iters: 200, epoch: 47 | loss: 0.0602245
	speed: 0.0274s/iter; left time: 327.8524s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.05s
Steps: 225 | Train Loss: 0.0622702 Vali Loss: 0.0748706 Test Loss: 0.0856402
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0641665
	speed: 0.0577s/iter; left time: 682.3878s
	iters: 200, epoch: 48 | loss: 0.0633397
	speed: 0.0325s/iter; left time: 380.8967s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:07.37s
Steps: 225 | Train Loss: 0.0622914 Vali Loss: 0.0749426 Test Loss: 0.0856176
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_168_168_FR_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02059786766767502, rmse:0.1435195654630661, mae:0.08558127284049988, rse:0.5558649301528931
Intermediate time for FR and pred_len 168: 00h:13m:45.48sIntermediate time for FR: 00h:43m:36.30s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_24_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=24, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1722920
	speed: 0.0466s/iter; left time: 1047.7932s
	iters: 200, epoch: 1 | loss: 0.1587587
	speed: 0.0224s/iter; left time: 501.0543s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.51s
Steps: 226 | Train Loss: 0.1734702 Vali Loss: 0.1441364 Test Loss: 0.1518556
Validation loss decreased (inf --> 0.144136).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0838304
	speed: 0.0500s/iter; left time: 1114.3519s
	iters: 200, epoch: 2 | loss: 0.0688653
	speed: 0.0273s/iter; left time: 606.4700s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.07s
Steps: 226 | Train Loss: 0.0924439 Vali Loss: 0.0667544 Test Loss: 0.0691170
Validation loss decreased (0.144136 --> 0.066754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0699428
	speed: 0.0429s/iter; left time: 945.4149s
	iters: 200, epoch: 3 | loss: 0.0663636
	speed: 0.0254s/iter; left time: 557.5768s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.71s
Steps: 226 | Train Loss: 0.0682073 Vali Loss: 0.0617783 Test Loss: 0.0642480
Validation loss decreased (0.066754 --> 0.061778).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0656166
	speed: 0.0501s/iter; left time: 1093.3949s
	iters: 200, epoch: 4 | loss: 0.0616566
	speed: 0.0250s/iter; left time: 543.5565s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.83s
Steps: 226 | Train Loss: 0.0641598 Vali Loss: 0.0599115 Test Loss: 0.0625490
Validation loss decreased (0.061778 --> 0.059912).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0607398
	speed: 0.0443s/iter; left time: 955.7134s
	iters: 200, epoch: 5 | loss: 0.0655872
	speed: 0.0279s/iter; left time: 598.9986s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.00s
Steps: 226 | Train Loss: 0.0618616 Vali Loss: 0.0581040 Test Loss: 0.0608326
Validation loss decreased (0.059912 --> 0.058104).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0637230
	speed: 0.0475s/iter; left time: 1015.6593s
	iters: 200, epoch: 6 | loss: 0.0615989
	speed: 0.0289s/iter; left time: 614.5886s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.39s
Steps: 226 | Train Loss: 0.0603513 Vali Loss: 0.0577327 Test Loss: 0.0602143
Validation loss decreased (0.058104 --> 0.057733).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0560802
	speed: 0.0466s/iter; left time: 984.3494s
	iters: 200, epoch: 7 | loss: 0.0570829
	speed: 0.0317s/iter; left time: 667.4006s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.30s
Steps: 226 | Train Loss: 0.0592524 Vali Loss: 0.0567816 Test Loss: 0.0594649
Validation loss decreased (0.057733 --> 0.056782).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0586033
	speed: 0.0470s/iter; left time: 983.8485s
	iters: 200, epoch: 8 | loss: 0.0537227
	speed: 0.0195s/iter; left time: 406.5318s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.17s
Steps: 226 | Train Loss: 0.0584231 Vali Loss: 0.0563781 Test Loss: 0.0590088
Validation loss decreased (0.056782 --> 0.056378).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0586339
	speed: 0.0498s/iter; left time: 1029.9858s
	iters: 200, epoch: 9 | loss: 0.0584896
	speed: 0.0298s/iter; left time: 614.0062s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.87s
Steps: 226 | Train Loss: 0.0579411 Vali Loss: 0.0559900 Test Loss: 0.0586146
Validation loss decreased (0.056378 --> 0.055990).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0551709
	speed: 0.0517s/iter; left time: 1057.3368s
	iters: 200, epoch: 10 | loss: 0.0587578
	speed: 0.0208s/iter; left time: 424.0340s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.59s
Steps: 226 | Train Loss: 0.0574679 Vali Loss: 0.0560114 Test Loss: 0.0584769
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0585615
	speed: 0.0438s/iter; left time: 885.7086s
	iters: 200, epoch: 11 | loss: 0.0552630
	speed: 0.0261s/iter; left time: 525.8740s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.86s
Steps: 226 | Train Loss: 0.0570903 Vali Loss: 0.0556922 Test Loss: 0.0582576
Validation loss decreased (0.055990 --> 0.055692).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0560762
	speed: 0.0485s/iter; left time: 971.5498s
	iters: 200, epoch: 12 | loss: 0.0558196
	speed: 0.0290s/iter; left time: 577.8554s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.49s
Steps: 226 | Train Loss: 0.0568057 Vali Loss: 0.0554588 Test Loss: 0.0579993
Validation loss decreased (0.055692 --> 0.055459).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0569666
	speed: 0.0505s/iter; left time: 998.4718s
	iters: 200, epoch: 13 | loss: 0.0555747
	speed: 0.0255s/iter; left time: 502.0816s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0565981 Vali Loss: 0.0552518 Test Loss: 0.0578913
Validation loss decreased (0.055459 --> 0.055252).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0558258
	speed: 0.0509s/iter; left time: 996.5387s
	iters: 200, epoch: 14 | loss: 0.0579629
	speed: 0.0196s/iter; left time: 381.3580s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.82s
Steps: 226 | Train Loss: 0.0563426 Vali Loss: 0.0551944 Test Loss: 0.0578140
Validation loss decreased (0.055252 --> 0.055194).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0586618
	speed: 0.0513s/iter; left time: 992.2145s
	iters: 200, epoch: 15 | loss: 0.0583563
	speed: 0.0296s/iter; left time: 568.8735s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.56s
Steps: 226 | Train Loss: 0.0561090 Vali Loss: 0.0550931 Test Loss: 0.0576744
Validation loss decreased (0.055194 --> 0.055093).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0574588
	speed: 0.0494s/iter; left time: 944.9844s
	iters: 200, epoch: 16 | loss: 0.0512447
	speed: 0.0280s/iter; left time: 531.3970s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.17s
Steps: 226 | Train Loss: 0.0560246 Vali Loss: 0.0552220 Test Loss: 0.0576568
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0553269
	speed: 0.0545s/iter; left time: 1028.7640s
	iters: 200, epoch: 17 | loss: 0.0531824
	speed: 0.0291s/iter; left time: 546.4334s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:07.13s
Steps: 226 | Train Loss: 0.0558568 Vali Loss: 0.0548910 Test Loss: 0.0575386
Validation loss decreased (0.055093 --> 0.054891).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0555530
	speed: 0.0485s/iter; left time: 905.6786s
	iters: 200, epoch: 18 | loss: 0.0592249
	speed: 0.0299s/iter; left time: 554.4153s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.47s
Steps: 226 | Train Loss: 0.0557835 Vali Loss: 0.0549858 Test Loss: 0.0574695
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0562326
	speed: 0.0516s/iter; left time: 951.0332s
	iters: 200, epoch: 19 | loss: 0.0540442
	speed: 0.0234s/iter; left time: 429.3311s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.84s
Steps: 226 | Train Loss: 0.0556622 Vali Loss: 0.0548263 Test Loss: 0.0574125
Validation loss decreased (0.054891 --> 0.054826).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0553453
	speed: 0.0493s/iter; left time: 896.8754s
	iters: 200, epoch: 20 | loss: 0.0546516
	speed: 0.0309s/iter; left time: 560.4097s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.89s
Steps: 226 | Train Loss: 0.0555707 Vali Loss: 0.0548711 Test Loss: 0.0573735
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0602217
	speed: 0.0543s/iter; left time: 976.2457s
	iters: 200, epoch: 21 | loss: 0.0515214
	speed: 0.0303s/iter; left time: 542.3735s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.16s
Steps: 226 | Train Loss: 0.0555040 Vali Loss: 0.0547479 Test Loss: 0.0572697
Validation loss decreased (0.054826 --> 0.054748).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0548368
	speed: 0.0490s/iter; left time: 869.7081s
	iters: 200, epoch: 22 | loss: 0.0516110
	speed: 0.0297s/iter; left time: 524.4647s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.42s
Steps: 226 | Train Loss: 0.0554181 Vali Loss: 0.0548270 Test Loss: 0.0573799
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0535216
	speed: 0.0572s/iter; left time: 1001.8378s
	iters: 200, epoch: 23 | loss: 0.0567808
	speed: 0.0306s/iter; left time: 532.5706s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:07.27s
Steps: 226 | Train Loss: 0.0553467 Vali Loss: 0.0547003 Test Loss: 0.0572244
Validation loss decreased (0.054748 --> 0.054700).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0522848
	speed: 0.0513s/iter; left time: 886.9823s
	iters: 200, epoch: 24 | loss: 0.0531534
	speed: 0.0287s/iter; left time: 493.3610s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.74s
Steps: 226 | Train Loss: 0.0552633 Vali Loss: 0.0546938 Test Loss: 0.0571732
Validation loss decreased (0.054700 --> 0.054694).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0584335
	speed: 0.0545s/iter; left time: 931.1691s
	iters: 200, epoch: 25 | loss: 0.0563863
	speed: 0.0304s/iter; left time: 516.6911s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.94s
Steps: 226 | Train Loss: 0.0552093 Vali Loss: 0.0546483 Test Loss: 0.0571411
Validation loss decreased (0.054694 --> 0.054648).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0581013
	speed: 0.0514s/iter; left time: 865.4150s
	iters: 200, epoch: 26 | loss: 0.0515195
	speed: 0.0283s/iter; left time: 473.6914s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.66s
Steps: 226 | Train Loss: 0.0551662 Vali Loss: 0.0545866 Test Loss: 0.0570727
Validation loss decreased (0.054648 --> 0.054587).  Saving model ...
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0555983
	speed: 0.0481s/iter; left time: 799.5362s
	iters: 200, epoch: 27 | loss: 0.0571013
	speed: 0.0303s/iter; left time: 501.4755s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.46s
Steps: 226 | Train Loss: 0.0551253 Vali Loss: 0.0545346 Test Loss: 0.0570563
Validation loss decreased (0.054587 --> 0.054535).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0532165
	speed: 0.0503s/iter; left time: 824.6423s
	iters: 200, epoch: 28 | loss: 0.0537188
	speed: 0.0241s/iter; left time: 393.1815s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.88s
Steps: 226 | Train Loss: 0.0550665 Vali Loss: 0.0546836 Test Loss: 0.0571266
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0546076
	speed: 0.0458s/iter; left time: 740.2816s
	iters: 200, epoch: 29 | loss: 0.0585144
	speed: 0.0245s/iter; left time: 393.8988s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:05.79s
Steps: 226 | Train Loss: 0.0550691 Vali Loss: 0.0546326 Test Loss: 0.0570762
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0592289
	speed: 0.0426s/iter; left time: 679.7488s
	iters: 200, epoch: 30 | loss: 0.0554572
	speed: 0.0330s/iter; left time: 522.2203s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.53s
Steps: 226 | Train Loss: 0.0550708 Vali Loss: 0.0545608 Test Loss: 0.0570226
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0518227
	speed: 0.0511s/iter; left time: 803.5668s
	iters: 200, epoch: 31 | loss: 0.0575283
	speed: 0.0294s/iter; left time: 459.8630s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.65s
Steps: 226 | Train Loss: 0.0550102 Vali Loss: 0.0545234 Test Loss: 0.0570084
Validation loss decreased (0.054535 --> 0.054523).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0551268
	speed: 0.0558s/iter; left time: 864.4731s
	iters: 200, epoch: 32 | loss: 0.0559603
	speed: 0.0302s/iter; left time: 464.1937s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.14s
Steps: 226 | Train Loss: 0.0549271 Vali Loss: 0.0546177 Test Loss: 0.0570088
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0536180
	speed: 0.0521s/iter; left time: 796.1268s
	iters: 200, epoch: 33 | loss: 0.0540531
	speed: 0.0296s/iter; left time: 448.5280s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.71s
Steps: 226 | Train Loss: 0.0549197 Vali Loss: 0.0544921 Test Loss: 0.0569974
Validation loss decreased (0.054523 --> 0.054492).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0579632
	speed: 0.0514s/iter; left time: 773.7752s
	iters: 200, epoch: 34 | loss: 0.0566074
	speed: 0.0262s/iter; left time: 390.8658s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.43s
Steps: 226 | Train Loss: 0.0549317 Vali Loss: 0.0544925 Test Loss: 0.0569959
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0546267
	speed: 0.0516s/iter; left time: 764.8886s
	iters: 200, epoch: 35 | loss: 0.0580821
	speed: 0.0243s/iter; left time: 358.0230s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.22s
Steps: 226 | Train Loss: 0.0549422 Vali Loss: 0.0544724 Test Loss: 0.0569728
Validation loss decreased (0.054492 --> 0.054472).  Saving model ...
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0530931
	speed: 0.0505s/iter; left time: 736.4218s
	iters: 200, epoch: 36 | loss: 0.0523850
	speed: 0.0223s/iter; left time: 322.4283s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.46s
Steps: 226 | Train Loss: 0.0548634 Vali Loss: 0.0546212 Test Loss: 0.0570231
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0563350
	speed: 0.0461s/iter; left time: 662.9176s
	iters: 200, epoch: 37 | loss: 0.0529748
	speed: 0.0329s/iter; left time: 468.6977s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.95s
Steps: 226 | Train Loss: 0.0548978 Vali Loss: 0.0544274 Test Loss: 0.0569539
Validation loss decreased (0.054472 --> 0.054427).  Saving model ...
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0526294
	speed: 0.0495s/iter; left time: 699.7500s
	iters: 200, epoch: 38 | loss: 0.0548050
	speed: 0.0354s/iter; left time: 496.5590s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.89s
Steps: 226 | Train Loss: 0.0548673 Vali Loss: 0.0545272 Test Loss: 0.0569506
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0569979
	speed: 0.0497s/iter; left time: 691.1512s
	iters: 200, epoch: 39 | loss: 0.0576798
	speed: 0.0314s/iter; left time: 434.1015s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.79s
Steps: 226 | Train Loss: 0.0548625 Vali Loss: 0.0545892 Test Loss: 0.0569690
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0517860
	speed: 0.0542s/iter; left time: 741.9817s
	iters: 200, epoch: 40 | loss: 0.0570342
	speed: 0.0272s/iter; left time: 368.9573s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.74s
Steps: 226 | Train Loss: 0.0549097 Vali Loss: 0.0545502 Test Loss: 0.0569394
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0541265
	speed: 0.0490s/iter; left time: 659.3394s
	iters: 200, epoch: 41 | loss: 0.0543137
	speed: 0.0264s/iter; left time: 352.4425s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.08s
Steps: 226 | Train Loss: 0.0548209 Vali Loss: 0.0545009 Test Loss: 0.0569344
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0553848
	speed: 0.0529s/iter; left time: 700.2816s
	iters: 200, epoch: 42 | loss: 0.0538818
	speed: 0.0264s/iter; left time: 347.2702s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.54s
Steps: 226 | Train Loss: 0.0548243 Vali Loss: 0.0544250 Test Loss: 0.0569128
Validation loss decreased (0.054427 --> 0.054425).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0578758
	speed: 0.0505s/iter; left time: 657.2047s
	iters: 200, epoch: 43 | loss: 0.0521547
	speed: 0.0264s/iter; left time: 341.3297s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.29s
Steps: 226 | Train Loss: 0.0548192 Vali Loss: 0.0545450 Test Loss: 0.0569434
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0543596
	speed: 0.0520s/iter; left time: 664.4097s
	iters: 200, epoch: 44 | loss: 0.0613788
	speed: 0.0302s/iter; left time: 383.5083s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.96s
Steps: 226 | Train Loss: 0.0548261 Vali Loss: 0.0545051 Test Loss: 0.0569404
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0508029
	speed: 0.0467s/iter; left time: 586.5224s
	iters: 200, epoch: 45 | loss: 0.0506523
	speed: 0.0215s/iter; left time: 267.8139s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:05.32s
Steps: 226 | Train Loss: 0.0547926 Vali Loss: 0.0544245 Test Loss: 0.0569008
Validation loss decreased (0.054425 --> 0.054424).  Saving model ...
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0520498
	speed: 0.0457s/iter; left time: 563.7957s
	iters: 200, epoch: 46 | loss: 0.0523044
	speed: 0.0221s/iter; left time: 269.7657s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.24s
Steps: 226 | Train Loss: 0.0547682 Vali Loss: 0.0545463 Test Loss: 0.0569156
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0574238
	speed: 0.0451s/iter; left time: 545.7565s
	iters: 200, epoch: 47 | loss: 0.0556269
	speed: 0.0276s/iter; left time: 331.1451s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.11s
Steps: 226 | Train Loss: 0.0547832 Vali Loss: 0.0544947 Test Loss: 0.0569419
EarlyStopping counter: 2 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0618061
	speed: 0.0454s/iter; left time: 539.6410s
	iters: 200, epoch: 48 | loss: 0.0510770
	speed: 0.0298s/iter; left time: 351.2805s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.07s
Steps: 226 | Train Loss: 0.0548322 Vali Loss: 0.0544690 Test Loss: 0.0568793
EarlyStopping counter: 3 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0573816
	speed: 0.0459s/iter; left time: 534.9754s
	iters: 200, epoch: 49 | loss: 0.0587271
	speed: 0.0252s/iter; left time: 291.1689s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:05.76s
Steps: 226 | Train Loss: 0.0547939 Vali Loss: 0.0544452 Test Loss: 0.0569674
EarlyStopping counter: 4 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0538436
	speed: 0.0431s/iter; left time: 492.2387s
	iters: 200, epoch: 50 | loss: 0.0507912
	speed: 0.0268s/iter; left time: 303.6785s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.84s
Steps: 226 | Train Loss: 0.0547728 Vali Loss: 0.0544759 Test Loss: 0.0569447
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0565758
	speed: 0.0428s/iter; left time: 479.3246s
	iters: 200, epoch: 51 | loss: 0.0539639
	speed: 0.0260s/iter; left time: 288.3114s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.37s
Steps: 226 | Train Loss: 0.0547863 Vali Loss: 0.0544789 Test Loss: 0.0569067
EarlyStopping counter: 6 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0600716
	speed: 0.0518s/iter; left time: 568.2397s
	iters: 200, epoch: 52 | loss: 0.0530268
	speed: 0.0310s/iter; left time: 337.3292s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.05s
Steps: 226 | Train Loss: 0.0547739 Vali Loss: 0.0543961 Test Loss: 0.0568873
Validation loss decreased (0.054424 --> 0.054396).  Saving model ...
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0557316
	speed: 0.0501s/iter; left time: 538.2353s
	iters: 200, epoch: 53 | loss: 0.0533673
	speed: 0.0220s/iter; left time: 233.7975s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:05.68s
Steps: 226 | Train Loss: 0.0547588 Vali Loss: 0.0544179 Test Loss: 0.0568861
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0528737
	speed: 0.0453s/iter; left time: 477.1364s
	iters: 200, epoch: 54 | loss: 0.0514013
	speed: 0.0207s/iter; left time: 215.5109s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:05.18s
Steps: 226 | Train Loss: 0.0547772 Vali Loss: 0.0544544 Test Loss: 0.0569195
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0569595
	speed: 0.0494s/iter; left time: 508.9980s
	iters: 200, epoch: 55 | loss: 0.0540732
	speed: 0.0237s/iter; left time: 241.2489s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:06.10s
Steps: 226 | Train Loss: 0.0547515 Vali Loss: 0.0544371 Test Loss: 0.0569214
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0545762
	speed: 0.0452s/iter; left time: 454.9849s
	iters: 200, epoch: 56 | loss: 0.0546318
	speed: 0.0221s/iter; left time: 220.3745s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.25s
Steps: 226 | Train Loss: 0.0547518 Vali Loss: 0.0543805 Test Loss: 0.0568706
Validation loss decreased (0.054396 --> 0.054381).  Saving model ...
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0596362
	speed: 0.0507s/iter; left time: 499.5512s
	iters: 200, epoch: 57 | loss: 0.0530986
	speed: 0.0297s/iter; left time: 289.4891s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.97s
Steps: 226 | Train Loss: 0.0547073 Vali Loss: 0.0545350 Test Loss: 0.0569560
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0566301
	speed: 0.0502s/iter; left time: 483.0940s
	iters: 200, epoch: 58 | loss: 0.0558193
	speed: 0.0268s/iter; left time: 255.3150s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.12s
Steps: 226 | Train Loss: 0.0547780 Vali Loss: 0.0544352 Test Loss: 0.0569023
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0588209
	speed: 0.0423s/iter; left time: 397.2868s
	iters: 200, epoch: 59 | loss: 0.0527758
	speed: 0.0186s/iter; left time: 172.5327s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:04.60s
Steps: 226 | Train Loss: 0.0547590 Vali Loss: 0.0545020 Test Loss: 0.0569208
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0533794
	speed: 0.0433s/iter; left time: 396.5315s
	iters: 200, epoch: 60 | loss: 0.0580118
	speed: 0.0199s/iter; left time: 180.3084s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.07s
Steps: 226 | Train Loss: 0.0547262 Vali Loss: 0.0543509 Test Loss: 0.0568823
Validation loss decreased (0.054381 --> 0.054351).  Saving model ...
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0560286
	speed: 0.0508s/iter; left time: 454.0303s
	iters: 200, epoch: 61 | loss: 0.0526540
	speed: 0.0268s/iter; left time: 236.6701s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:06.64s
Steps: 226 | Train Loss: 0.0547945 Vali Loss: 0.0544580 Test Loss: 0.0569107
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0547675
	speed: 0.0444s/iter; left time: 386.6227s
	iters: 200, epoch: 62 | loss: 0.0543976
	speed: 0.0278s/iter; left time: 239.5605s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:05.96s
Steps: 226 | Train Loss: 0.0547692 Vali Loss: 0.0543560 Test Loss: 0.0568702
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0511734
	speed: 0.0480s/iter; left time: 407.2850s
	iters: 200, epoch: 63 | loss: 0.0591709
	speed: 0.0257s/iter; left time: 215.5234s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.88s
Steps: 226 | Train Loss: 0.0547693 Vali Loss: 0.0545519 Test Loss: 0.0569671
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0564905
	speed: 0.0493s/iter; left time: 407.1880s
	iters: 200, epoch: 64 | loss: 0.0595020
	speed: 0.0235s/iter; left time: 192.1071s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:05.93s
Steps: 226 | Train Loss: 0.0548079 Vali Loss: 0.0545252 Test Loss: 0.0569238
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0577908
	speed: 0.0478s/iter; left time: 384.2557s
	iters: 200, epoch: 65 | loss: 0.0582348
	speed: 0.0254s/iter; left time: 201.7473s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:05.95s
Steps: 226 | Train Loss: 0.0547158 Vali Loss: 0.0544442 Test Loss: 0.0568673
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0521134
	speed: 0.0458s/iter; left time: 357.9288s
	iters: 200, epoch: 66 | loss: 0.0571456
	speed: 0.0281s/iter; left time: 216.4750s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:06.26s
Steps: 226 | Train Loss: 0.0547606 Vali Loss: 0.0544804 Test Loss: 0.0569185
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0545808
	speed: 0.0533s/iter; left time: 404.3548s
	iters: 200, epoch: 67 | loss: 0.0523171
	speed: 0.0185s/iter; left time: 138.7967s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:05.56s
Steps: 226 | Train Loss: 0.0547814 Vali Loss: 0.0545069 Test Loss: 0.0568956
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0553125
	speed: 0.0504s/iter; left time: 370.9870s
	iters: 200, epoch: 68 | loss: 0.0524824
	speed: 0.0286s/iter; left time: 207.2805s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:06.85s
Steps: 226 | Train Loss: 0.0547916 Vali Loss: 0.0544979 Test Loss: 0.0569650
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.0611166119964742e-07
	iters: 100, epoch: 69 | loss: 0.0552361
	speed: 0.0490s/iter; left time: 349.8172s
	iters: 200, epoch: 69 | loss: 0.0531105
	speed: 0.0279s/iter; left time: 196.4785s
-------------------------------------------------------------------------------------
Epoch: 69
Cost time: 00h:00m:06.38s
Steps: 226 | Train Loss: 0.0547940 Vali Loss: 0.0545501 Test Loss: 0.0569191
EarlyStopping counter: 9 out of 10
Updating learning rate to 9.550049507968268e-08
	iters: 100, epoch: 70 | loss: 0.0555499
	speed: 0.0491s/iter; left time: 339.4557s
	iters: 200, epoch: 70 | loss: 0.0586882
	speed: 0.0284s/iter; left time: 193.5308s
-------------------------------------------------------------------------------------
Epoch: 70
Cost time: 00h:00m:06.57s
Steps: 226 | Train Loss: 0.0547468 Vali Loss: 0.0544531 Test Loss: 0.0568987
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010126727633178234, rmse:0.10063164681196213, mae:0.056882333010435104, rse:0.3802374303340912
Use GPU: cuda:0
>>>>>>>start training : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1671183
	speed: 0.0261s/iter; left time: 586.3574s
	iters: 200, epoch: 1 | loss: 0.1493597
	speed: 0.0254s/iter; left time: 569.7711s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.81s
Steps: 226 | Train Loss: 0.1708172 Vali Loss: 0.1430496 Test Loss: 0.1509800
Validation loss decreased (inf --> 0.143050).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0894919
	speed: 0.0462s/iter; left time: 1029.5477s
	iters: 200, epoch: 2 | loss: 0.0741505
	speed: 0.0246s/iter; left time: 546.4297s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.77s
Steps: 226 | Train Loss: 0.0934774 Vali Loss: 0.0673926 Test Loss: 0.0698875
Validation loss decreased (0.143050 --> 0.067393).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0690908
	speed: 0.0469s/iter; left time: 1033.7647s
	iters: 200, epoch: 3 | loss: 0.0651288
	speed: 0.0231s/iter; left time: 506.6904s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.46s
Steps: 226 | Train Loss: 0.0686555 Vali Loss: 0.0616349 Test Loss: 0.0644420
Validation loss decreased (0.067393 --> 0.061635).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0637166
	speed: 0.0464s/iter; left time: 1013.4318s
	iters: 200, epoch: 4 | loss: 0.0618543
	speed: 0.0244s/iter; left time: 530.8369s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.67s
Steps: 226 | Train Loss: 0.0643276 Vali Loss: 0.0595802 Test Loss: 0.0624841
Validation loss decreased (0.061635 --> 0.059580).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0620772
	speed: 0.0497s/iter; left time: 1072.8426s
	iters: 200, epoch: 5 | loss: 0.0610805
	speed: 0.0261s/iter; left time: 560.9989s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.23s
Steps: 226 | Train Loss: 0.0621152 Vali Loss: 0.0583595 Test Loss: 0.0613081
Validation loss decreased (0.059580 --> 0.058359).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0622094
	speed: 0.0528s/iter; left time: 1128.4955s
	iters: 200, epoch: 6 | loss: 0.0586622
	speed: 0.0242s/iter; left time: 515.3650s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.21s
Steps: 226 | Train Loss: 0.0608144 Vali Loss: 0.0577665 Test Loss: 0.0608487
Validation loss decreased (0.058359 --> 0.057767).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0609338
	speed: 0.0520s/iter; left time: 1098.6852s
	iters: 200, epoch: 7 | loss: 0.0570468
	speed: 0.0278s/iter; left time: 585.5105s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:06.43s
Steps: 226 | Train Loss: 0.0597690 Vali Loss: 0.0570377 Test Loss: 0.0599500
Validation loss decreased (0.057767 --> 0.057038).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0550718
	speed: 0.0537s/iter; left time: 1123.7628s
	iters: 200, epoch: 8 | loss: 0.0665458
	speed: 0.0316s/iter; left time: 658.5808s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.35s
Steps: 226 | Train Loss: 0.0589198 Vali Loss: 0.0561305 Test Loss: 0.0592737
Validation loss decreased (0.057038 --> 0.056130).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0612751
	speed: 0.0578s/iter; left time: 1195.5991s
	iters: 200, epoch: 9 | loss: 0.0568842
	speed: 0.0259s/iter; left time: 533.2279s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.70s
Steps: 226 | Train Loss: 0.0583483 Vali Loss: 0.0559387 Test Loss: 0.0588987
Validation loss decreased (0.056130 --> 0.055939).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0585441
	speed: 0.0504s/iter; left time: 1032.3465s
	iters: 200, epoch: 10 | loss: 0.0598325
	speed: 0.0311s/iter; left time: 632.8839s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.85s
Steps: 226 | Train Loss: 0.0578611 Vali Loss: 0.0558667 Test Loss: 0.0586031
Validation loss decreased (0.055939 --> 0.055867).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0586685
	speed: 0.0520s/iter; left time: 1053.2859s
	iters: 200, epoch: 11 | loss: 0.0560532
	speed: 0.0302s/iter; left time: 607.7641s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.89s
Steps: 226 | Train Loss: 0.0575143 Vali Loss: 0.0555754 Test Loss: 0.0584051
Validation loss decreased (0.055867 --> 0.055575).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0553717
	speed: 0.0561s/iter; left time: 1122.0926s
	iters: 200, epoch: 12 | loss: 0.0553700
	speed: 0.0303s/iter; left time: 602.6951s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.95s
Steps: 226 | Train Loss: 0.0572109 Vali Loss: 0.0554275 Test Loss: 0.0582681
Validation loss decreased (0.055575 --> 0.055428).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0546830
	speed: 0.0471s/iter; left time: 932.7866s
	iters: 200, epoch: 13 | loss: 0.0599364
	speed: 0.0243s/iter; left time: 478.1866s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.59s
Steps: 226 | Train Loss: 0.0569612 Vali Loss: 0.0553732 Test Loss: 0.0580842
Validation loss decreased (0.055428 --> 0.055373).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0562301
	speed: 0.0466s/iter; left time: 911.1899s
	iters: 200, epoch: 14 | loss: 0.0562018
	speed: 0.0246s/iter; left time: 479.6203s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.79s
Steps: 226 | Train Loss: 0.0566864 Vali Loss: 0.0550656 Test Loss: 0.0577854
Validation loss decreased (0.055373 --> 0.055066).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0606462
	speed: 0.0469s/iter; left time: 907.4004s
	iters: 200, epoch: 15 | loss: 0.0547147
	speed: 0.0238s/iter; left time: 457.4420s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.56s
Steps: 226 | Train Loss: 0.0564601 Vali Loss: 0.0550560 Test Loss: 0.0578406
Validation loss decreased (0.055066 --> 0.055056).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0586123
	speed: 0.0513s/iter; left time: 979.4401s
	iters: 200, epoch: 16 | loss: 0.0542631
	speed: 0.0231s/iter; left time: 439.9685s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:06.15s
Steps: 226 | Train Loss: 0.0563156 Vali Loss: 0.0549847 Test Loss: 0.0577916
Validation loss decreased (0.055056 --> 0.054985).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0525569
	speed: 0.0496s/iter; left time: 935.9065s
	iters: 200, epoch: 17 | loss: 0.0540291
	speed: 0.0231s/iter; left time: 434.1542s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.58s
Steps: 226 | Train Loss: 0.0561593 Vali Loss: 0.0548957 Test Loss: 0.0575398
Validation loss decreased (0.054985 --> 0.054896).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0549057
	speed: 0.0475s/iter; left time: 887.1360s
	iters: 200, epoch: 18 | loss: 0.0582623
	speed: 0.0250s/iter; left time: 463.6831s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.02s
Steps: 226 | Train Loss: 0.0560078 Vali Loss: 0.0548554 Test Loss: 0.0574899
Validation loss decreased (0.054896 --> 0.054855).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0570154
	speed: 0.0509s/iter; left time: 937.5739s
	iters: 200, epoch: 19 | loss: 0.0589034
	speed: 0.0250s/iter; left time: 457.5117s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.12s
Steps: 226 | Train Loss: 0.0559835 Vali Loss: 0.0548761 Test Loss: 0.0575250
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0533867
	speed: 0.0475s/iter; left time: 864.4540s
	iters: 200, epoch: 20 | loss: 0.0564308
	speed: 0.0233s/iter; left time: 421.5848s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.85s
Steps: 226 | Train Loss: 0.0559020 Vali Loss: 0.0548729 Test Loss: 0.0574068
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0547154
	speed: 0.0516s/iter; left time: 928.5613s
	iters: 200, epoch: 21 | loss: 0.0591372
	speed: 0.0225s/iter; left time: 402.5486s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.72s
Steps: 226 | Train Loss: 0.0557124 Vali Loss: 0.0547077 Test Loss: 0.0573593
Validation loss decreased (0.054855 --> 0.054708).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0538523
	speed: 0.0493s/iter; left time: 874.8137s
	iters: 200, epoch: 22 | loss: 0.0558532
	speed: 0.0250s/iter; left time: 440.5308s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.87s
Steps: 226 | Train Loss: 0.0556812 Vali Loss: 0.0545233 Test Loss: 0.0572733
Validation loss decreased (0.054708 --> 0.054523).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0537412
	speed: 0.0435s/iter; left time: 762.9864s
	iters: 200, epoch: 23 | loss: 0.0565237
	speed: 0.0247s/iter; left time: 430.6117s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.32s
Steps: 226 | Train Loss: 0.0555625 Vali Loss: 0.0545978 Test Loss: 0.0572175
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0569870
	speed: 0.0462s/iter; left time: 798.5345s
	iters: 200, epoch: 24 | loss: 0.0586887
	speed: 0.0263s/iter; left time: 452.4716s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.97s
Steps: 226 | Train Loss: 0.0555227 Vali Loss: 0.0545563 Test Loss: 0.0572211
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0559320
	speed: 0.0506s/iter; left time: 864.7210s
	iters: 200, epoch: 25 | loss: 0.0623908
	speed: 0.0269s/iter; left time: 455.9697s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.52s
Steps: 226 | Train Loss: 0.0554853 Vali Loss: 0.0546439 Test Loss: 0.0572556
EarlyStopping counter: 3 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0572326
	speed: 0.0439s/iter; left time: 739.7119s
	iters: 200, epoch: 26 | loss: 0.0553266
	speed: 0.0240s/iter; left time: 402.5499s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.32s
Steps: 226 | Train Loss: 0.0554122 Vali Loss: 0.0546292 Test Loss: 0.0572165
EarlyStopping counter: 4 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0557066
	speed: 0.0495s/iter; left time: 822.2588s
	iters: 200, epoch: 27 | loss: 0.0552947
	speed: 0.0286s/iter; left time: 473.1441s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.50s
Steps: 226 | Train Loss: 0.0553655 Vali Loss: 0.0545335 Test Loss: 0.0571195
EarlyStopping counter: 5 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0536001
	speed: 0.0491s/iter; left time: 805.8637s
	iters: 200, epoch: 28 | loss: 0.0544457
	speed: 0.0239s/iter; left time: 389.0578s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:05.77s
Steps: 226 | Train Loss: 0.0553575 Vali Loss: 0.0545017 Test Loss: 0.0571133
Validation loss decreased (0.054523 --> 0.054502).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0525365
	speed: 0.0543s/iter; left time: 878.0734s
	iters: 200, epoch: 29 | loss: 0.0512349
	speed: 0.0298s/iter; left time: 479.1219s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:07.08s
Steps: 226 | Train Loss: 0.0552837 Vali Loss: 0.0545020 Test Loss: 0.0571912
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0555779
	speed: 0.0465s/iter; left time: 741.3302s
	iters: 200, epoch: 30 | loss: 0.0550966
	speed: 0.0264s/iter; left time: 418.0493s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:05.77s
Steps: 226 | Train Loss: 0.0552685 Vali Loss: 0.0545906 Test Loss: 0.0571831
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0581115
	speed: 0.0475s/iter; left time: 746.4065s
	iters: 200, epoch: 31 | loss: 0.0507683
	speed: 0.0244s/iter; left time: 381.3370s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.93s
Steps: 226 | Train Loss: 0.0552550 Vali Loss: 0.0545533 Test Loss: 0.0571081
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0543378
	speed: 0.0421s/iter; left time: 651.6769s
	iters: 200, epoch: 32 | loss: 0.0567470
	speed: 0.0265s/iter; left time: 407.4724s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.41s
Steps: 226 | Train Loss: 0.0552130 Vali Loss: 0.0544021 Test Loss: 0.0570437
Validation loss decreased (0.054502 --> 0.054402).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0533559
	speed: 0.0460s/iter; left time: 702.7662s
	iters: 200, epoch: 33 | loss: 0.0527099
	speed: 0.0248s/iter; left time: 375.4562s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.82s
Steps: 226 | Train Loss: 0.0551895 Vali Loss: 0.0543914 Test Loss: 0.0570647
Validation loss decreased (0.054402 --> 0.054391).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0556570
	speed: 0.0515s/iter; left time: 775.0225s
	iters: 200, epoch: 34 | loss: 0.0527466
	speed: 0.0312s/iter; left time: 466.3217s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.75s
Steps: 226 | Train Loss: 0.0552035 Vali Loss: 0.0546156 Test Loss: 0.0571556
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0529002
	speed: 0.0532s/iter; left time: 788.1281s
	iters: 200, epoch: 35 | loss: 0.0546057
	speed: 0.0319s/iter; left time: 469.6390s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:07.00s
Steps: 226 | Train Loss: 0.0551364 Vali Loss: 0.0545817 Test Loss: 0.0571406
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0545301
	speed: 0.0494s/iter; left time: 720.7291s
	iters: 200, epoch: 36 | loss: 0.0542963
	speed: 0.0225s/iter; left time: 326.3125s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.58s
Steps: 226 | Train Loss: 0.0551355 Vali Loss: 0.0544014 Test Loss: 0.0570049
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0592082
	speed: 0.0446s/iter; left time: 641.3640s
	iters: 200, epoch: 37 | loss: 0.0578923
	speed: 0.0233s/iter; left time: 332.8952s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.39s
Steps: 226 | Train Loss: 0.0550899 Vali Loss: 0.0544372 Test Loss: 0.0570175
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0575181
	speed: 0.0439s/iter; left time: 620.9215s
	iters: 200, epoch: 38 | loss: 0.0554402
	speed: 0.0245s/iter; left time: 344.6493s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.56s
Steps: 226 | Train Loss: 0.0551337 Vali Loss: 0.0544084 Test Loss: 0.0569866
EarlyStopping counter: 5 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0539549
	speed: 0.0505s/iter; left time: 703.2806s
	iters: 200, epoch: 39 | loss: 0.0599985
	speed: 0.0298s/iter; left time: 412.0970s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.92s
Steps: 226 | Train Loss: 0.0550835 Vali Loss: 0.0544412 Test Loss: 0.0569934
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0555178
	speed: 0.0540s/iter; left time: 739.5891s
	iters: 200, epoch: 40 | loss: 0.0535621
	speed: 0.0301s/iter; left time: 408.5093s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:07.01s
Steps: 226 | Train Loss: 0.0551042 Vali Loss: 0.0544443 Test Loss: 0.0570305
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0544481
	speed: 0.0544s/iter; left time: 731.8295s
	iters: 200, epoch: 41 | loss: 0.0571609
	speed: 0.0271s/iter; left time: 361.8683s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.53s
Steps: 226 | Train Loss: 0.0550469 Vali Loss: 0.0544577 Test Loss: 0.0570496
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0541435
	speed: 0.0496s/iter; left time: 656.0533s
	iters: 200, epoch: 42 | loss: 0.0584221
	speed: 0.0276s/iter; left time: 361.9071s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:06.41s
Steps: 226 | Train Loss: 0.0550190 Vali Loss: 0.0543569 Test Loss: 0.0569765
Validation loss decreased (0.054391 --> 0.054357).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0570098
	speed: 0.0517s/iter; left time: 672.3974s
	iters: 200, epoch: 43 | loss: 0.0529481
	speed: 0.0281s/iter; left time: 362.5839s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.58s
Steps: 226 | Train Loss: 0.0550399 Vali Loss: 0.0543499 Test Loss: 0.0569851
Validation loss decreased (0.054357 --> 0.054350).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0537824
	speed: 0.0617s/iter; left time: 788.2781s
	iters: 200, epoch: 44 | loss: 0.0584286
	speed: 0.0307s/iter; left time: 389.0526s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:07.14s
Steps: 226 | Train Loss: 0.0549981 Vali Loss: 0.0545196 Test Loss: 0.0570577
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0544152
	speed: 0.0522s/iter; left time: 655.7470s
	iters: 200, epoch: 45 | loss: 0.0531305
	speed: 0.0272s/iter; left time: 339.0872s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:06.58s
Steps: 226 | Train Loss: 0.0550469 Vali Loss: 0.0544084 Test Loss: 0.0569764
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0552234
	speed: 0.0528s/iter; left time: 650.7892s
	iters: 200, epoch: 46 | loss: 0.0589482
	speed: 0.0335s/iter; left time: 409.7884s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:07.50s
Steps: 226 | Train Loss: 0.0550391 Vali Loss: 0.0543831 Test Loss: 0.0569450
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0558735
	speed: 0.0594s/iter; left time: 719.0240s
	iters: 200, epoch: 47 | loss: 0.0562957
	speed: 0.0300s/iter; left time: 359.6862s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:07.28s
Steps: 226 | Train Loss: 0.0550245 Vali Loss: 0.0544049 Test Loss: 0.0569942
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0557008
	speed: 0.0530s/iter; left time: 629.6357s
	iters: 200, epoch: 48 | loss: 0.0573912
	speed: 0.0292s/iter; left time: 344.4651s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.71s
Steps: 226 | Train Loss: 0.0550281 Vali Loss: 0.0544020 Test Loss: 0.0570180
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0546718
	speed: 0.0476s/iter; left time: 554.5971s
	iters: 200, epoch: 49 | loss: 0.0545007
	speed: 0.0293s/iter; left time: 337.9737s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.56s
Steps: 226 | Train Loss: 0.0549733 Vali Loss: 0.0545117 Test Loss: 0.0570557
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0567902
	speed: 0.0509s/iter; left time: 581.8192s
	iters: 200, epoch: 50 | loss: 0.0535607
	speed: 0.0241s/iter; left time: 272.9994s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.82s
Steps: 226 | Train Loss: 0.0549857 Vali Loss: 0.0542776 Test Loss: 0.0569479
Validation loss decreased (0.054350 --> 0.054278).  Saving model ...
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0541929
	speed: 0.0524s/iter; left time: 586.9150s
	iters: 200, epoch: 51 | loss: 0.0532043
	speed: 0.0299s/iter; left time: 331.8213s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.95s
Steps: 226 | Train Loss: 0.0550235 Vali Loss: 0.0544153 Test Loss: 0.0570159
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0517970
	speed: 0.0552s/iter; left time: 605.8079s
	iters: 200, epoch: 52 | loss: 0.0561695
	speed: 0.0317s/iter; left time: 345.0569s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:07.31s
Steps: 226 | Train Loss: 0.0550057 Vali Loss: 0.0544147 Test Loss: 0.0569938
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0564113
	speed: 0.0472s/iter; left time: 507.2525s
	iters: 200, epoch: 53 | loss: 0.0545869
	speed: 0.0295s/iter; left time: 314.0962s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.40s
Steps: 226 | Train Loss: 0.0549994 Vali Loss: 0.0542674 Test Loss: 0.0569478
Validation loss decreased (0.054278 --> 0.054267).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0558922
	speed: 0.0502s/iter; left time: 528.1924s
	iters: 200, epoch: 54 | loss: 0.0500513
	speed: 0.0287s/iter; left time: 299.1153s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.30s
Steps: 226 | Train Loss: 0.0549873 Vali Loss: 0.0543921 Test Loss: 0.0569369
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0583103
	speed: 0.0559s/iter; left time: 575.1348s
	iters: 200, epoch: 55 | loss: 0.0526342
	speed: 0.0314s/iter; left time: 319.8160s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:07.26s
Steps: 226 | Train Loss: 0.0549969 Vali Loss: 0.0544587 Test Loss: 0.0570053
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0560073
	speed: 0.0503s/iter; left time: 506.6557s
	iters: 200, epoch: 56 | loss: 0.0549848
	speed: 0.0284s/iter; left time: 283.0088s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:06.37s
Steps: 226 | Train Loss: 0.0549915 Vali Loss: 0.0544629 Test Loss: 0.0569569
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0586904
	speed: 0.0553s/iter; left time: 544.0501s
	iters: 200, epoch: 57 | loss: 0.0569365
	speed: 0.0310s/iter; left time: 301.7873s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:07.11s
Steps: 226 | Train Loss: 0.0550113 Vali Loss: 0.0543688 Test Loss: 0.0569486
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0548015
	speed: 0.0467s/iter; left time: 449.1191s
	iters: 200, epoch: 58 | loss: 0.0559248
	speed: 0.0306s/iter; left time: 291.4517s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:06.49s
Steps: 226 | Train Loss: 0.0550106 Vali Loss: 0.0544411 Test Loss: 0.0570273
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0563634
	speed: 0.0561s/iter; left time: 526.9429s
	iters: 200, epoch: 59 | loss: 0.0529164
	speed: 0.0298s/iter; left time: 276.8782s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:07.20s
Steps: 226 | Train Loss: 0.0550187 Vali Loss: 0.0543835 Test Loss: 0.0569421
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0513109
	speed: 0.0463s/iter; left time: 424.5147s
	iters: 200, epoch: 60 | loss: 0.0575434
	speed: 0.0301s/iter; left time: 273.0243s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:06.25s
Steps: 226 | Train Loss: 0.0550089 Vali Loss: 0.0544088 Test Loss: 0.0569655
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0525246
	speed: 0.0568s/iter; left time: 507.9152s
	iters: 200, epoch: 61 | loss: 0.0528906
	speed: 0.0336s/iter; left time: 297.3657s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:07.81s
Steps: 226 | Train Loss: 0.0549117 Vali Loss: 0.0544557 Test Loss: 0.0569940
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0564995
	speed: 0.0593s/iter; left time: 516.9842s
	iters: 200, epoch: 62 | loss: 0.0514744
	speed: 0.0296s/iter; left time: 255.1691s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:07.16s
Steps: 226 | Train Loss: 0.0550009 Vali Loss: 0.0542982 Test Loss: 0.0569604
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0603337
	speed: 0.0545s/iter; left time: 462.6180s
	iters: 200, epoch: 63 | loss: 0.0585992
	speed: 0.0264s/iter; left time: 221.6058s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:07.03s
Steps: 226 | Train Loss: 0.0549873 Vali Loss: 0.0543450 Test Loss: 0.0569679
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_24_IT_PatchTST_custom_ftM_sl168_ll48_pl24_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010085921734571457, rmse:0.10042869299650192, mae:0.05694780498743057, rse:0.379470556974411
Intermediate time for IT and pred_len 24: 00h:17m:12.81s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_96_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=96, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1805620
	speed: 0.0519s/iter; left time: 1162.8633s
	iters: 200, epoch: 1 | loss: 0.1604668
	speed: 0.0293s/iter; left time: 654.3453s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.61s
Steps: 225 | Train Loss: 0.1799002 Vali Loss: 0.1531601 Test Loss: 0.1623265
Validation loss decreased (inf --> 0.153160).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1056841
	speed: 0.0474s/iter; left time: 1051.1115s
	iters: 200, epoch: 2 | loss: 0.0949816
	speed: 0.0230s/iter; left time: 507.9639s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.46s
Steps: 225 | Train Loss: 0.1107018 Vali Loss: 0.0847156 Test Loss: 0.0898317
Validation loss decreased (0.153160 --> 0.084716).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0903883
	speed: 0.0451s/iter; left time: 990.5345s
	iters: 200, epoch: 3 | loss: 0.0877064
	speed: 0.0242s/iter; left time: 529.3414s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.53s
Steps: 225 | Train Loss: 0.0886370 Vali Loss: 0.0799162 Test Loss: 0.0851156
Validation loss decreased (0.084716 --> 0.079916).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0849233
	speed: 0.0496s/iter; left time: 1077.2709s
	iters: 200, epoch: 4 | loss: 0.0863226
	speed: 0.0337s/iter; left time: 728.5297s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:07.05s
Steps: 225 | Train Loss: 0.0846948 Vali Loss: 0.0781025 Test Loss: 0.0833411
Validation loss decreased (0.079916 --> 0.078102).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0819032
	speed: 0.0556s/iter; left time: 1194.4493s
	iters: 200, epoch: 5 | loss: 0.0811997
	speed: 0.0303s/iter; left time: 648.5425s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:07.11s
Steps: 225 | Train Loss: 0.0823563 Vali Loss: 0.0769063 Test Loss: 0.0825890
Validation loss decreased (0.078102 --> 0.076906).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839242
	speed: 0.0478s/iter; left time: 1017.8120s
	iters: 200, epoch: 6 | loss: 0.0821715
	speed: 0.0244s/iter; left time: 515.9615s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.82s
Steps: 225 | Train Loss: 0.0809487 Vali Loss: 0.0761848 Test Loss: 0.0819233
Validation loss decreased (0.076906 --> 0.076185).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0793673
	speed: 0.0451s/iter; left time: 948.5124s
	iters: 200, epoch: 7 | loss: 0.0810894
	speed: 0.0228s/iter; left time: 477.5206s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.04s
Steps: 225 | Train Loss: 0.0799971 Vali Loss: 0.0757786 Test Loss: 0.0812300
Validation loss decreased (0.076185 --> 0.075779).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0806313
	speed: 0.0484s/iter; left time: 1007.3201s
	iters: 200, epoch: 8 | loss: 0.0806243
	speed: 0.0210s/iter; left time: 435.2683s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.65s
Steps: 225 | Train Loss: 0.0793282 Vali Loss: 0.0756721 Test Loss: 0.0810366
Validation loss decreased (0.075779 --> 0.075672).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0797274
	speed: 0.0485s/iter; left time: 998.5841s
	iters: 200, epoch: 9 | loss: 0.0800558
	speed: 0.0332s/iter; left time: 681.5667s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.90s
Steps: 225 | Train Loss: 0.0788017 Vali Loss: 0.0751570 Test Loss: 0.0806254
Validation loss decreased (0.075672 --> 0.075157).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0781363
	speed: 0.0529s/iter; left time: 1078.2643s
	iters: 200, epoch: 10 | loss: 0.0821204
	speed: 0.0295s/iter; left time: 598.1759s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.76s
Steps: 225 | Train Loss: 0.0784086 Vali Loss: 0.0748331 Test Loss: 0.0803863
Validation loss decreased (0.075157 --> 0.074833).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0773081
	speed: 0.0506s/iter; left time: 1019.2319s
	iters: 200, epoch: 11 | loss: 0.0769340
	speed: 0.0306s/iter; left time: 613.9480s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.50s
Steps: 225 | Train Loss: 0.0780557 Vali Loss: 0.0748576 Test Loss: 0.0803838
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0739010
	speed: 0.0428s/iter; left time: 852.3341s
	iters: 200, epoch: 12 | loss: 0.0764393
	speed: 0.0192s/iter; left time: 380.1938s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.88s
Steps: 225 | Train Loss: 0.0778147 Vali Loss: 0.0747394 Test Loss: 0.0802362
Validation loss decreased (0.074833 --> 0.074739).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0770929
	speed: 0.0480s/iter; left time: 945.0190s
	iters: 200, epoch: 13 | loss: 0.0768943
	speed: 0.0232s/iter; left time: 454.6449s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:05.88s
Steps: 225 | Train Loss: 0.0775008 Vali Loss: 0.0745214 Test Loss: 0.0799649
Validation loss decreased (0.074739 --> 0.074521).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0770124
	speed: 0.0580s/iter; left time: 1129.6667s
	iters: 200, epoch: 14 | loss: 0.0781280
	speed: 0.0316s/iter; left time: 611.5751s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:07.38s
Steps: 225 | Train Loss: 0.0772693 Vali Loss: 0.0744808 Test Loss: 0.0800061
Validation loss decreased (0.074521 --> 0.074481).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0770420
	speed: 0.0524s/iter; left time: 1008.7737s
	iters: 200, epoch: 15 | loss: 0.0778218
	speed: 0.0299s/iter; left time: 572.4294s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.75s
Steps: 225 | Train Loss: 0.0771457 Vali Loss: 0.0745342 Test Loss: 0.0800457
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0788047
	speed: 0.0590s/iter; left time: 1121.7168s
	iters: 200, epoch: 16 | loss: 0.0733577
	speed: 0.0333s/iter; left time: 630.8500s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:07.79s
Steps: 225 | Train Loss: 0.0768803 Vali Loss: 0.0745147 Test Loss: 0.0799389
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0849317
	speed: 0.0441s/iter; left time: 828.3722s
	iters: 200, epoch: 17 | loss: 0.0769682
	speed: 0.0203s/iter; left time: 379.8736s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:04.80s
Steps: 225 | Train Loss: 0.0767694 Vali Loss: 0.0743689 Test Loss: 0.0799724
Validation loss decreased (0.074481 --> 0.074369).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0740751
	speed: 0.0533s/iter; left time: 989.6025s
	iters: 200, epoch: 18 | loss: 0.0740322
	speed: 0.0317s/iter; left time: 586.0610s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:07.34s
Steps: 225 | Train Loss: 0.0765871 Vali Loss: 0.0741889 Test Loss: 0.0799109
Validation loss decreased (0.074369 --> 0.074189).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0762765
	speed: 0.0469s/iter; left time: 860.5855s
	iters: 200, epoch: 19 | loss: 0.0740567
	speed: 0.0296s/iter; left time: 539.8495s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.31s
Steps: 225 | Train Loss: 0.0764642 Vali Loss: 0.0741447 Test Loss: 0.0797611
Validation loss decreased (0.074189 --> 0.074145).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0760027
	speed: 0.0578s/iter; left time: 1048.1331s
	iters: 200, epoch: 20 | loss: 0.0772175
	speed: 0.0346s/iter; left time: 623.4148s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:07.70s
Steps: 225 | Train Loss: 0.0763880 Vali Loss: 0.0741452 Test Loss: 0.0796693
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0732374
	speed: 0.0528s/iter; left time: 944.8037s
	iters: 200, epoch: 21 | loss: 0.0762790
	speed: 0.0319s/iter; left time: 567.7665s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:07.17s
Steps: 225 | Train Loss: 0.0762697 Vali Loss: 0.0740867 Test Loss: 0.0798120
Validation loss decreased (0.074145 --> 0.074087).  Saving model ...
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0756372
	speed: 0.0530s/iter; left time: 936.4639s
	iters: 200, epoch: 22 | loss: 0.0716529
	speed: 0.0277s/iter; left time: 486.5722s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:06.41s
Steps: 225 | Train Loss: 0.0761757 Vali Loss: 0.0741539 Test Loss: 0.0797682
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0771927
	speed: 0.0468s/iter; left time: 816.5573s
	iters: 200, epoch: 23 | loss: 0.0765624
	speed: 0.0259s/iter; left time: 450.0137s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.99s
Steps: 225 | Train Loss: 0.0761410 Vali Loss: 0.0740627 Test Loss: 0.0797253
Validation loss decreased (0.074087 --> 0.074063).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0768347
	speed: 0.0519s/iter; left time: 894.4645s
	iters: 200, epoch: 24 | loss: 0.0757049
	speed: 0.0296s/iter; left time: 507.4298s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.83s
Steps: 225 | Train Loss: 0.0760581 Vali Loss: 0.0740495 Test Loss: 0.0796765
Validation loss decreased (0.074063 --> 0.074050).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0780853
	speed: 0.0502s/iter; left time: 852.8996s
	iters: 200, epoch: 25 | loss: 0.0782617
	speed: 0.0296s/iter; left time: 499.6110s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:06.55s
Steps: 225 | Train Loss: 0.0759656 Vali Loss: 0.0740208 Test Loss: 0.0797114
Validation loss decreased (0.074050 --> 0.074021).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0729303
	speed: 0.0489s/iter; left time: 820.1862s
	iters: 200, epoch: 26 | loss: 0.0760167
	speed: 0.0202s/iter; left time: 337.5871s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.21s
Steps: 225 | Train Loss: 0.0759042 Vali Loss: 0.0740213 Test Loss: 0.0797527
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0779798
	speed: 0.0469s/iter; left time: 775.9772s
	iters: 200, epoch: 27 | loss: 0.0730974
	speed: 0.0262s/iter; left time: 430.7725s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.25s
Steps: 225 | Train Loss: 0.0758558 Vali Loss: 0.0739786 Test Loss: 0.0797341
Validation loss decreased (0.074021 --> 0.073979).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0789156
	speed: 0.0505s/iter; left time: 825.2561s
	iters: 200, epoch: 28 | loss: 0.0755482
	speed: 0.0335s/iter; left time: 543.8115s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.98s
Steps: 225 | Train Loss: 0.0758470 Vali Loss: 0.0740256 Test Loss: 0.0797478
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0742041
	speed: 0.0517s/iter; left time: 832.5813s
	iters: 200, epoch: 29 | loss: 0.0770120
	speed: 0.0298s/iter; left time: 476.3013s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.73s
Steps: 225 | Train Loss: 0.0757809 Vali Loss: 0.0739312 Test Loss: 0.0796134
Validation loss decreased (0.073979 --> 0.073931).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0743474
	speed: 0.0497s/iter; left time: 788.5267s
	iters: 200, epoch: 30 | loss: 0.0743649
	speed: 0.0284s/iter; left time: 448.4786s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.37s
Steps: 225 | Train Loss: 0.0757547 Vali Loss: 0.0738966 Test Loss: 0.0796489
Validation loss decreased (0.073931 --> 0.073897).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0769657
	speed: 0.0498s/iter; left time: 778.7611s
	iters: 200, epoch: 31 | loss: 0.0767465
	speed: 0.0337s/iter; left time: 523.6463s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:07.00s
Steps: 225 | Train Loss: 0.0757479 Vali Loss: 0.0739233 Test Loss: 0.0796932
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0746304
	speed: 0.0539s/iter; left time: 832.0435s
	iters: 200, epoch: 32 | loss: 0.0737139
	speed: 0.0296s/iter; left time: 452.9490s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0756927 Vali Loss: 0.0739457 Test Loss: 0.0796888
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0774381
	speed: 0.0541s/iter; left time: 822.5513s
	iters: 200, epoch: 33 | loss: 0.0736052
	speed: 0.0303s/iter; left time: 458.0624s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:07.04s
Steps: 225 | Train Loss: 0.0756846 Vali Loss: 0.0738672 Test Loss: 0.0796748
Validation loss decreased (0.073897 --> 0.073867).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0778821
	speed: 0.0536s/iter; left time: 802.0761s
	iters: 200, epoch: 34 | loss: 0.0769082
	speed: 0.0305s/iter; left time: 454.1337s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.91s
Steps: 225 | Train Loss: 0.0755951 Vali Loss: 0.0739160 Test Loss: 0.0796510
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0706455
	speed: 0.0527s/iter; left time: 777.1290s
	iters: 200, epoch: 35 | loss: 0.0743120
	speed: 0.0266s/iter; left time: 390.3753s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:06.43s
Steps: 225 | Train Loss: 0.0756107 Vali Loss: 0.0738675 Test Loss: 0.0796316
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0757184
	speed: 0.0533s/iter; left time: 774.1222s
	iters: 200, epoch: 36 | loss: 0.0789647
	speed: 0.0269s/iter; left time: 388.3819s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.67s
Steps: 225 | Train Loss: 0.0755679 Vali Loss: 0.0738346 Test Loss: 0.0796362
Validation loss decreased (0.073867 --> 0.073835).  Saving model ...
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0823950
	speed: 0.0466s/iter; left time: 666.2990s
	iters: 200, epoch: 37 | loss: 0.0751047
	speed: 0.0229s/iter; left time: 324.5557s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:05.40s
Steps: 225 | Train Loss: 0.0755710 Vali Loss: 0.0738364 Test Loss: 0.0796816
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0771139
	speed: 0.0551s/iter; left time: 775.4749s
	iters: 200, epoch: 38 | loss: 0.0795248
	speed: 0.0294s/iter; left time: 411.1895s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:07.20s
Steps: 225 | Train Loss: 0.0755763 Vali Loss: 0.0738889 Test Loss: 0.0796442
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0755012
	speed: 0.0522s/iter; left time: 722.6248s
	iters: 200, epoch: 39 | loss: 0.0750739
	speed: 0.0235s/iter; left time: 322.4778s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.26s
Steps: 225 | Train Loss: 0.0755440 Vali Loss: 0.0738972 Test Loss: 0.0796942
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0786288
	speed: 0.0462s/iter; left time: 629.4702s
	iters: 200, epoch: 40 | loss: 0.0695698
	speed: 0.0306s/iter; left time: 413.7240s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.41s
Steps: 225 | Train Loss: 0.0755733 Vali Loss: 0.0738691 Test Loss: 0.0796484
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0762501
	speed: 0.0490s/iter; left time: 656.8606s
	iters: 200, epoch: 41 | loss: 0.0711865
	speed: 0.0301s/iter; left time: 399.9307s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.52s
Steps: 225 | Train Loss: 0.0755028 Vali Loss: 0.0738545 Test Loss: 0.0796684
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0734441
	speed: 0.0553s/iter; left time: 728.0576s
	iters: 200, epoch: 42 | loss: 0.0758917
	speed: 0.0311s/iter; left time: 406.3994s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:07.13s
Steps: 225 | Train Loss: 0.0755312 Vali Loss: 0.0737964 Test Loss: 0.0796481
Validation loss decreased (0.073835 --> 0.073796).  Saving model ...
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0733277
	speed: 0.0457s/iter; left time: 591.2522s
	iters: 200, epoch: 43 | loss: 0.0771407
	speed: 0.0282s/iter; left time: 362.7909s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:05.94s
Steps: 225 | Train Loss: 0.0755338 Vali Loss: 0.0738415 Test Loss: 0.0796714
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0747953
	speed: 0.0468s/iter; left time: 595.0386s
	iters: 200, epoch: 44 | loss: 0.0741519
	speed: 0.0303s/iter; left time: 382.1021s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.31s
Steps: 225 | Train Loss: 0.0754940 Vali Loss: 0.0738805 Test Loss: 0.0796630
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0769906
	speed: 0.0448s/iter; left time: 560.1053s
	iters: 200, epoch: 45 | loss: 0.0761429
	speed: 0.0195s/iter; left time: 242.4073s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:04.83s
Steps: 225 | Train Loss: 0.0754916 Vali Loss: 0.0738032 Test Loss: 0.0796840
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0759332
	speed: 0.0460s/iter; left time: 565.0444s
	iters: 200, epoch: 46 | loss: 0.0706540
	speed: 0.0232s/iter; left time: 282.0983s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:05.82s
Steps: 225 | Train Loss: 0.0755041 Vali Loss: 0.0738029 Test Loss: 0.0796604
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0753413
	speed: 0.0510s/iter; left time: 614.8172s
	iters: 200, epoch: 47 | loss: 0.0759820
	speed: 0.0306s/iter; left time: 365.6072s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.69s
Steps: 225 | Train Loss: 0.0754766 Vali Loss: 0.0738504 Test Loss: 0.0796809
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0736977
	speed: 0.0478s/iter; left time: 565.0541s
	iters: 200, epoch: 48 | loss: 0.0774811
	speed: 0.0270s/iter; left time: 316.1788s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:06.24s
Steps: 225 | Train Loss: 0.0754439 Vali Loss: 0.0738729 Test Loss: 0.0796779
EarlyStopping counter: 6 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0742064
	speed: 0.0489s/iter; left time: 567.2492s
	iters: 200, epoch: 49 | loss: 0.0763281
	speed: 0.0277s/iter; left time: 318.2855s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.22s
Steps: 225 | Train Loss: 0.0754684 Vali Loss: 0.0738392 Test Loss: 0.0796467
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0738480
	speed: 0.0457s/iter; left time: 519.6296s
	iters: 200, epoch: 50 | loss: 0.0730180
	speed: 0.0266s/iter; left time: 300.0786s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:05.98s
Steps: 225 | Train Loss: 0.0754635 Vali Loss: 0.0738703 Test Loss: 0.0796760
EarlyStopping counter: 8 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0756818
	speed: 0.0523s/iter; left time: 583.3631s
	iters: 200, epoch: 51 | loss: 0.0794990
	speed: 0.0300s/iter; left time: 331.5179s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:06.88s
Steps: 225 | Train Loss: 0.0754601 Vali Loss: 0.0738453 Test Loss: 0.0796572
EarlyStopping counter: 9 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0704052
	speed: 0.0517s/iter; left time: 564.8042s
	iters: 200, epoch: 52 | loss: 0.0758301
	speed: 0.0205s/iter; left time: 221.6277s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:05.78s
Steps: 225 | Train Loss: 0.0754571 Vali Loss: 0.0738097 Test Loss: 0.0796377
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018305838108062744, rmse:0.13529907166957855, mae:0.07964807003736496, rse:0.5115803480148315
Use GPU: cuda:0
>>>>>>>start training : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1790881
	speed: 0.0210s/iter; left time: 470.0092s
	iters: 200, epoch: 1 | loss: 0.1657722
	speed: 0.0274s/iter; left time: 611.1913s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:05.78s
Steps: 225 | Train Loss: 0.1823005 Vali Loss: 0.1545539 Test Loss: 0.1640103
Validation loss decreased (inf --> 0.154554).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1020215
	speed: 0.0521s/iter; left time: 1154.9627s
	iters: 200, epoch: 2 | loss: 0.0918243
	speed: 0.0305s/iter; left time: 674.0635s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.40s
Steps: 225 | Train Loss: 0.1109366 Vali Loss: 0.0847074 Test Loss: 0.0896899
Validation loss decreased (0.154554 --> 0.084707).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0926616
	speed: 0.0520s/iter; left time: 1141.4641s
	iters: 200, epoch: 3 | loss: 0.0870116
	speed: 0.0296s/iter; left time: 646.0402s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:06.86s
Steps: 225 | Train Loss: 0.0891119 Vali Loss: 0.0801562 Test Loss: 0.0851888
Validation loss decreased (0.084707 --> 0.080156).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0865172
	speed: 0.0562s/iter; left time: 1221.6089s
	iters: 200, epoch: 4 | loss: 0.0807629
	speed: 0.0292s/iter; left time: 632.1566s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.71s
Steps: 225 | Train Loss: 0.0852437 Vali Loss: 0.0786048 Test Loss: 0.0836677
Validation loss decreased (0.080156 --> 0.078605).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0815287
	speed: 0.0492s/iter; left time: 1058.5932s
	iters: 200, epoch: 5 | loss: 0.0852425
	speed: 0.0248s/iter; left time: 531.5487s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:05.93s
Steps: 225 | Train Loss: 0.0826992 Vali Loss: 0.0771317 Test Loss: 0.0825239
Validation loss decreased (0.078605 --> 0.077132).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0855075
	speed: 0.0451s/iter; left time: 959.7671s
	iters: 200, epoch: 6 | loss: 0.0810368
	speed: 0.0259s/iter; left time: 548.6693s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:05.83s
Steps: 225 | Train Loss: 0.0810929 Vali Loss: 0.0765272 Test Loss: 0.0819078
Validation loss decreased (0.077132 --> 0.076527).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0770050
	speed: 0.0461s/iter; left time: 969.9724s
	iters: 200, epoch: 7 | loss: 0.0781120
	speed: 0.0276s/iter; left time: 579.2798s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:05.72s
Steps: 225 | Train Loss: 0.0800917 Vali Loss: 0.0758637 Test Loss: 0.0813290
Validation loss decreased (0.076527 --> 0.075864).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0814507
	speed: 0.0521s/iter; left time: 1085.3334s
	iters: 200, epoch: 8 | loss: 0.0810540
	speed: 0.0334s/iter; left time: 691.5035s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:07.16s
Steps: 225 | Train Loss: 0.0794074 Vali Loss: 0.0757473 Test Loss: 0.0809703
Validation loss decreased (0.075864 --> 0.075747).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0785709
	speed: 0.0549s/iter; left time: 1130.6216s
	iters: 200, epoch: 9 | loss: 0.0773229
	speed: 0.0297s/iter; left time: 607.9262s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.89s
Steps: 225 | Train Loss: 0.0788632 Vali Loss: 0.0751910 Test Loss: 0.0805931
Validation loss decreased (0.075747 --> 0.075191).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0808593
	speed: 0.0521s/iter; left time: 1060.7529s
	iters: 200, epoch: 10 | loss: 0.0760220
	speed: 0.0268s/iter; left time: 543.8240s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.15s
Steps: 225 | Train Loss: 0.0784034 Vali Loss: 0.0749507 Test Loss: 0.0803177
Validation loss decreased (0.075191 --> 0.074951).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0816761
	speed: 0.0510s/iter; left time: 1028.2459s
	iters: 200, epoch: 11 | loss: 0.0758451
	speed: 0.0308s/iter; left time: 617.6004s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.70s
Steps: 225 | Train Loss: 0.0780377 Vali Loss: 0.0748240 Test Loss: 0.0803157
Validation loss decreased (0.074951 --> 0.074824).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0733595
	speed: 0.0603s/iter; left time: 1202.2466s
	iters: 200, epoch: 12 | loss: 0.0775170
	speed: 0.0290s/iter; left time: 575.4367s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:07.18s
Steps: 225 | Train Loss: 0.0777423 Vali Loss: 0.0747157 Test Loss: 0.0800200
Validation loss decreased (0.074824 --> 0.074716).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0778685
	speed: 0.0527s/iter; left time: 1038.8944s
	iters: 200, epoch: 13 | loss: 0.0779369
	speed: 0.0263s/iter; left time: 515.0068s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.55s
Steps: 225 | Train Loss: 0.0774560 Vali Loss: 0.0745607 Test Loss: 0.0800957
Validation loss decreased (0.074716 --> 0.074561).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0752640
	speed: 0.0504s/iter; left time: 980.9766s
	iters: 200, epoch: 14 | loss: 0.0772109
	speed: 0.0243s/iter; left time: 470.7048s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.95s
Steps: 225 | Train Loss: 0.0771855 Vali Loss: 0.0745269 Test Loss: 0.0799434
Validation loss decreased (0.074561 --> 0.074527).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0755306
	speed: 0.0496s/iter; left time: 955.6114s
	iters: 200, epoch: 15 | loss: 0.0763766
	speed: 0.0236s/iter; left time: 452.3277s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:05.82s
Steps: 225 | Train Loss: 0.0770187 Vali Loss: 0.0743560 Test Loss: 0.0797780
Validation loss decreased (0.074527 --> 0.074356).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0805588
	speed: 0.0482s/iter; left time: 917.4913s
	iters: 200, epoch: 16 | loss: 0.0789654
	speed: 0.0208s/iter; left time: 393.3317s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.51s
Steps: 225 | Train Loss: 0.0768375 Vali Loss: 0.0743071 Test Loss: 0.0798205
Validation loss decreased (0.074356 --> 0.074307).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0784135
	speed: 0.0448s/iter; left time: 841.6925s
	iters: 200, epoch: 17 | loss: 0.0752202
	speed: 0.0219s/iter; left time: 409.7830s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:05.08s
Steps: 225 | Train Loss: 0.0767227 Vali Loss: 0.0742462 Test Loss: 0.0797481
Validation loss decreased (0.074307 --> 0.074246).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0782087
	speed: 0.0528s/iter; left time: 981.6482s
	iters: 200, epoch: 18 | loss: 0.0795883
	speed: 0.0280s/iter; left time: 516.6581s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.75s
Steps: 225 | Train Loss: 0.0765944 Vali Loss: 0.0742247 Test Loss: 0.0797466
Validation loss decreased (0.074246 --> 0.074225).  Saving model ...
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0779423
	speed: 0.0543s/iter; left time: 996.7476s
	iters: 200, epoch: 19 | loss: 0.0741632
	speed: 0.0262s/iter; left time: 478.3752s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.56s
Steps: 225 | Train Loss: 0.0764083 Vali Loss: 0.0741696 Test Loss: 0.0796356
Validation loss decreased (0.074225 --> 0.074170).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0784153
	speed: 0.0463s/iter; left time: 840.1191s
	iters: 200, epoch: 20 | loss: 0.0784849
	speed: 0.0253s/iter; left time: 455.2760s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:05.73s
Steps: 225 | Train Loss: 0.0763808 Vali Loss: 0.0740472 Test Loss: 0.0795232
Validation loss decreased (0.074170 --> 0.074047).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0737283
	speed: 0.0501s/iter; left time: 897.6407s
	iters: 200, epoch: 21 | loss: 0.0750930
	speed: 0.0261s/iter; left time: 464.9249s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.12s
Steps: 225 | Train Loss: 0.0762870 Vali Loss: 0.0741221 Test Loss: 0.0796024
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0750439
	speed: 0.0537s/iter; left time: 948.5754s
	iters: 200, epoch: 22 | loss: 0.0800672
	speed: 0.0309s/iter; left time: 543.1002s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.04s
Steps: 225 | Train Loss: 0.0761221 Vali Loss: 0.0740300 Test Loss: 0.0795310
Validation loss decreased (0.074047 --> 0.074030).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0740797
	speed: 0.0544s/iter; left time: 948.6721s
	iters: 200, epoch: 23 | loss: 0.0691196
	speed: 0.0264s/iter; left time: 458.6481s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.38s
Steps: 225 | Train Loss: 0.0760698 Vali Loss: 0.0740356 Test Loss: 0.0795706
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0743738
	speed: 0.0540s/iter; left time: 929.5278s
	iters: 200, epoch: 24 | loss: 0.0797742
	speed: 0.0297s/iter; left time: 508.5131s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:07.09s
Steps: 225 | Train Loss: 0.0760023 Vali Loss: 0.0739953 Test Loss: 0.0795833
Validation loss decreased (0.074030 --> 0.073995).  Saving model ...
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0774466
	speed: 0.0435s/iter; left time: 740.1664s
	iters: 200, epoch: 25 | loss: 0.0778909
	speed: 0.0188s/iter; left time: 317.7568s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:04.45s
Steps: 225 | Train Loss: 0.0759958 Vali Loss: 0.0740413 Test Loss: 0.0795815
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0780001
	speed: 0.0422s/iter; left time: 707.2411s
	iters: 200, epoch: 26 | loss: 0.0763809
	speed: 0.0254s/iter; left time: 423.2670s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:05.58s
Steps: 225 | Train Loss: 0.0758109 Vali Loss: 0.0740130 Test Loss: 0.0795372
EarlyStopping counter: 2 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0759217
	speed: 0.0567s/iter; left time: 937.9791s
	iters: 200, epoch: 27 | loss: 0.0768139
	speed: 0.0304s/iter; left time: 500.3218s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:07.35s
Steps: 225 | Train Loss: 0.0758581 Vali Loss: 0.0739008 Test Loss: 0.0794840
Validation loss decreased (0.073995 --> 0.073901).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0809324
	speed: 0.0438s/iter; left time: 715.3982s
	iters: 200, epoch: 28 | loss: 0.0707953
	speed: 0.0188s/iter; left time: 304.8194s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:04.47s
Steps: 225 | Train Loss: 0.0758429 Vali Loss: 0.0738786 Test Loss: 0.0794998
Validation loss decreased (0.073901 --> 0.073879).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0721506
	speed: 0.0462s/iter; left time: 744.3248s
	iters: 200, epoch: 29 | loss: 0.0742410
	speed: 0.0302s/iter; left time: 483.5339s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.55s
Steps: 225 | Train Loss: 0.0757575 Vali Loss: 0.0739099 Test Loss: 0.0795173
EarlyStopping counter: 1 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0775100
	speed: 0.0636s/iter; left time: 1009.4665s
	iters: 200, epoch: 30 | loss: 0.0723973
	speed: 0.0365s/iter; left time: 575.8351s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:08.64s
Steps: 225 | Train Loss: 0.0757562 Vali Loss: 0.0739307 Test Loss: 0.0795078
EarlyStopping counter: 2 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0801369
	speed: 0.0570s/iter; left time: 892.0156s
	iters: 200, epoch: 31 | loss: 0.0784943
	speed: 0.0268s/iter; left time: 416.8109s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.73s
Steps: 225 | Train Loss: 0.0757115 Vali Loss: 0.0738676 Test Loss: 0.0795069
Validation loss decreased (0.073879 --> 0.073868).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0789659
	speed: 0.0529s/iter; left time: 816.0835s
	iters: 200, epoch: 32 | loss: 0.0737221
	speed: 0.0345s/iter; left time: 528.9748s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:07.42s
Steps: 225 | Train Loss: 0.0756342 Vali Loss: 0.0738669 Test Loss: 0.0795308
Validation loss decreased (0.073868 --> 0.073867).  Saving model ...
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0721539
	speed: 0.0521s/iter; left time: 791.6168s
	iters: 200, epoch: 33 | loss: 0.0724874
	speed: 0.0272s/iter; left time: 410.0313s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:06.14s
Steps: 225 | Train Loss: 0.0755756 Vali Loss: 0.0738196 Test Loss: 0.0794518
Validation loss decreased (0.073867 --> 0.073820).  Saving model ...
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0746614
	speed: 0.0570s/iter; left time: 853.1540s
	iters: 200, epoch: 34 | loss: 0.0746784
	speed: 0.0306s/iter; left time: 454.9447s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.99s
Steps: 225 | Train Loss: 0.0756492 Vali Loss: 0.0738246 Test Loss: 0.0794897
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0766999
	speed: 0.0462s/iter; left time: 681.5345s
	iters: 200, epoch: 35 | loss: 0.0754725
	speed: 0.0255s/iter; left time: 373.9855s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.92s
Steps: 225 | Train Loss: 0.0755886 Vali Loss: 0.0738690 Test Loss: 0.0794683
EarlyStopping counter: 2 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0751653
	speed: 0.0511s/iter; left time: 742.1519s
	iters: 200, epoch: 36 | loss: 0.0764476
	speed: 0.0305s/iter; left time: 440.4251s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:06.99s
Steps: 225 | Train Loss: 0.0755780 Vali Loss: 0.0738295 Test Loss: 0.0794947
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0764202
	speed: 0.0550s/iter; left time: 786.9232s
	iters: 200, epoch: 37 | loss: 0.0727640
	speed: 0.0314s/iter; left time: 446.1023s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:07.06s
Steps: 225 | Train Loss: 0.0755563 Vali Loss: 0.0738518 Test Loss: 0.0794914
EarlyStopping counter: 4 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0752195
	speed: 0.0476s/iter; left time: 670.1916s
	iters: 200, epoch: 38 | loss: 0.0756702
	speed: 0.0291s/iter; left time: 406.6700s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.25s
Steps: 225 | Train Loss: 0.0755056 Vali Loss: 0.0738162 Test Loss: 0.0794783
Validation loss decreased (0.073820 --> 0.073816).  Saving model ...
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0771633
	speed: 0.0480s/iter; left time: 664.7757s
	iters: 200, epoch: 39 | loss: 0.0776391
	speed: 0.0294s/iter; left time: 404.0284s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:06.24s
Steps: 225 | Train Loss: 0.0754969 Vali Loss: 0.0738267 Test Loss: 0.0794866
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0803662
	speed: 0.0568s/iter; left time: 774.3166s
	iters: 200, epoch: 40 | loss: 0.0739795
	speed: 0.0248s/iter; left time: 335.1414s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.63s
Steps: 225 | Train Loss: 0.0754540 Vali Loss: 0.0738386 Test Loss: 0.0794849
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0799819
	speed: 0.0521s/iter; left time: 698.3912s
	iters: 200, epoch: 41 | loss: 0.0724458
	speed: 0.0280s/iter; left time: 372.3934s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:06.56s
Steps: 225 | Train Loss: 0.0755010 Vali Loss: 0.0738616 Test Loss: 0.0794929
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8248003631400751e-06
	iters: 100, epoch: 42 | loss: 0.0770340
	speed: 0.0449s/iter; left time: 592.0953s
	iters: 200, epoch: 42 | loss: 0.0735448
	speed: 0.0283s/iter; left time: 369.4020s
-------------------------------------------------------------------------------------
Epoch: 42
Cost time: 00h:00m:05.98s
Steps: 225 | Train Loss: 0.0755102 Vali Loss: 0.0738463 Test Loss: 0.0794932
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.6423203268260676e-06
	iters: 100, epoch: 43 | loss: 0.0760082
	speed: 0.0485s/iter; left time: 628.2887s
	iters: 200, epoch: 43 | loss: 0.0749146
	speed: 0.0307s/iter; left time: 394.0778s
-------------------------------------------------------------------------------------
Epoch: 43
Cost time: 00h:00m:06.45s
Steps: 225 | Train Loss: 0.0754570 Vali Loss: 0.0737946 Test Loss: 0.0794973
Validation loss decreased (0.073816 --> 0.073795).  Saving model ...
Updating learning rate to 1.4780882941434609e-06
	iters: 100, epoch: 44 | loss: 0.0756610
	speed: 0.0493s/iter; left time: 627.4488s
	iters: 200, epoch: 44 | loss: 0.0774383
	speed: 0.0303s/iter; left time: 383.1854s
-------------------------------------------------------------------------------------
Epoch: 44
Cost time: 00h:00m:06.51s
Steps: 225 | Train Loss: 0.0754674 Vali Loss: 0.0738476 Test Loss: 0.0795091
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.3302794647291146e-06
	iters: 100, epoch: 45 | loss: 0.0734283
	speed: 0.0564s/iter; left time: 704.6256s
	iters: 200, epoch: 45 | loss: 0.0710394
	speed: 0.0351s/iter; left time: 434.7033s
-------------------------------------------------------------------------------------
Epoch: 45
Cost time: 00h:00m:07.87s
Steps: 225 | Train Loss: 0.0754520 Vali Loss: 0.0738455 Test Loss: 0.0795059
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.1972515182562034e-06
	iters: 100, epoch: 46 | loss: 0.0708159
	speed: 0.0521s/iter; left time: 639.9318s
	iters: 200, epoch: 46 | loss: 0.0780994
	speed: 0.0256s/iter; left time: 311.2912s
-------------------------------------------------------------------------------------
Epoch: 46
Cost time: 00h:00m:06.05s
Steps: 225 | Train Loss: 0.0754575 Vali Loss: 0.0738445 Test Loss: 0.0794902
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.077526366430583e-06
	iters: 100, epoch: 47 | loss: 0.0724014
	speed: 0.0518s/iter; left time: 624.2553s
	iters: 200, epoch: 47 | loss: 0.0738643
	speed: 0.0299s/iter; left time: 356.8371s
-------------------------------------------------------------------------------------
Epoch: 47
Cost time: 00h:00m:06.64s
Steps: 225 | Train Loss: 0.0754107 Vali Loss: 0.0738300 Test Loss: 0.0794834
EarlyStopping counter: 4 out of 10
Updating learning rate to 9.697737297875248e-07
	iters: 100, epoch: 48 | loss: 0.0786052
	speed: 0.0486s/iter; left time: 574.9446s
	iters: 200, epoch: 48 | loss: 0.0770917
	speed: 0.0221s/iter; left time: 258.6979s
-------------------------------------------------------------------------------------
Epoch: 48
Cost time: 00h:00m:05.70s
Steps: 225 | Train Loss: 0.0754408 Vali Loss: 0.0738190 Test Loss: 0.0794723
EarlyStopping counter: 5 out of 10
Updating learning rate to 8.727963568087723e-07
	iters: 100, epoch: 49 | loss: 0.0754975
	speed: 0.0450s/iter; left time: 522.3499s
	iters: 200, epoch: 49 | loss: 0.0771508
	speed: 0.0259s/iter; left time: 298.0763s
-------------------------------------------------------------------------------------
Epoch: 49
Cost time: 00h:00m:06.05s
Steps: 225 | Train Loss: 0.0754946 Vali Loss: 0.0738595 Test Loss: 0.0794853
EarlyStopping counter: 6 out of 10
Updating learning rate to 7.855167211278951e-07
	iters: 100, epoch: 50 | loss: 0.0757545
	speed: 0.0557s/iter; left time: 633.3106s
	iters: 200, epoch: 50 | loss: 0.0732413
	speed: 0.0333s/iter; left time: 375.8303s
-------------------------------------------------------------------------------------
Epoch: 50
Cost time: 00h:00m:07.58s
Steps: 225 | Train Loss: 0.0754509 Vali Loss: 0.0738343 Test Loss: 0.0794914
EarlyStopping counter: 7 out of 10
Updating learning rate to 7.069650490151056e-07
	iters: 100, epoch: 51 | loss: 0.0757393
	speed: 0.0489s/iter; left time: 545.3981s
	iters: 200, epoch: 51 | loss: 0.0788999
	speed: 0.0268s/iter; left time: 296.4821s
-------------------------------------------------------------------------------------
Epoch: 51
Cost time: 00h:00m:05.84s
Steps: 225 | Train Loss: 0.0754437 Vali Loss: 0.0738431 Test Loss: 0.0794810
EarlyStopping counter: 8 out of 10
Updating learning rate to 6.36268544113595e-07
	iters: 100, epoch: 52 | loss: 0.0761891
	speed: 0.0492s/iter; left time: 537.5366s
	iters: 200, epoch: 52 | loss: 0.0724254
	speed: 0.0295s/iter; left time: 319.4336s
-------------------------------------------------------------------------------------
Epoch: 52
Cost time: 00h:00m:06.41s
Steps: 225 | Train Loss: 0.0754188 Vali Loss: 0.0738193 Test Loss: 0.0794760
EarlyStopping counter: 9 out of 10
Updating learning rate to 5.726416897022355e-07
	iters: 100, epoch: 53 | loss: 0.0762165
	speed: 0.0516s/iter; left time: 552.3373s
	iters: 200, epoch: 53 | loss: 0.0760677
	speed: 0.0290s/iter; left time: 306.9873s
-------------------------------------------------------------------------------------
Epoch: 53
Cost time: 00h:00m:06.83s
Steps: 225 | Train Loss: 0.0754509 Vali Loss: 0.0737906 Test Loss: 0.0794727
Validation loss decreased (0.073795 --> 0.073791).  Saving model ...
Updating learning rate to 5.15377520732012e-07
	iters: 100, epoch: 54 | loss: 0.0756035
	speed: 0.0538s/iter; left time: 563.9505s
	iters: 200, epoch: 54 | loss: 0.0773814
	speed: 0.0269s/iter; left time: 279.1261s
-------------------------------------------------------------------------------------
Epoch: 54
Cost time: 00h:00m:06.63s
Steps: 225 | Train Loss: 0.0754188 Vali Loss: 0.0738212 Test Loss: 0.0794904
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.6383976865881085e-07
	iters: 100, epoch: 55 | loss: 0.0711235
	speed: 0.0427s/iter; left time: 437.2315s
	iters: 200, epoch: 55 | loss: 0.0735966
	speed: 0.0189s/iter; left time: 192.1089s
-------------------------------------------------------------------------------------
Epoch: 55
Cost time: 00h:00m:04.49s
Steps: 225 | Train Loss: 0.0754077 Vali Loss: 0.0738077 Test Loss: 0.0794723
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.174557917929298e-07
	iters: 100, epoch: 56 | loss: 0.0755664
	speed: 0.0489s/iter; left time: 489.9243s
	iters: 200, epoch: 56 | loss: 0.0748949
	speed: 0.0227s/iter; left time: 225.1873s
-------------------------------------------------------------------------------------
Epoch: 56
Cost time: 00h:00m:05.71s
Steps: 225 | Train Loss: 0.0754186 Vali Loss: 0.0738800 Test Loss: 0.0795176
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.7571021261363677e-07
	iters: 100, epoch: 57 | loss: 0.0737460
	speed: 0.0482s/iter; left time: 472.0786s
	iters: 200, epoch: 57 | loss: 0.0724761
	speed: 0.0295s/iter; left time: 285.9189s
-------------------------------------------------------------------------------------
Epoch: 57
Cost time: 00h:00m:06.54s
Steps: 225 | Train Loss: 0.0754397 Vali Loss: 0.0738223 Test Loss: 0.0794878
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.381391913522731e-07
	iters: 100, epoch: 58 | loss: 0.0727171
	speed: 0.0525s/iter; left time: 502.8817s
	iters: 200, epoch: 58 | loss: 0.0756273
	speed: 0.0307s/iter; left time: 290.5225s
-------------------------------------------------------------------------------------
Epoch: 58
Cost time: 00h:00m:07.19s
Steps: 225 | Train Loss: 0.0754023 Vali Loss: 0.0737841 Test Loss: 0.0794823
Validation loss decreased (0.073791 --> 0.073784).  Saving model ...
Updating learning rate to 3.043252722170458e-07
	iters: 100, epoch: 59 | loss: 0.0730906
	speed: 0.0515s/iter; left time: 481.7092s
	iters: 200, epoch: 59 | loss: 0.0772122
	speed: 0.0287s/iter; left time: 265.2030s
-------------------------------------------------------------------------------------
Epoch: 59
Cost time: 00h:00m:06.35s
Steps: 225 | Train Loss: 0.0754130 Vali Loss: 0.0738190 Test Loss: 0.0794906
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.7389274499534124e-07
	iters: 100, epoch: 60 | loss: 0.0736467
	speed: 0.0475s/iter; left time: 433.2226s
	iters: 200, epoch: 60 | loss: 0.0755759
	speed: 0.0248s/iter; left time: 223.8422s
-------------------------------------------------------------------------------------
Epoch: 60
Cost time: 00h:00m:05.79s
Steps: 225 | Train Loss: 0.0753993 Vali Loss: 0.0738504 Test Loss: 0.0795066
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.465034704958071e-07
	iters: 100, epoch: 61 | loss: 0.0751130
	speed: 0.0498s/iter; left time: 443.0488s
	iters: 200, epoch: 61 | loss: 0.0753030
	speed: 0.0285s/iter; left time: 251.2146s
-------------------------------------------------------------------------------------
Epoch: 61
Cost time: 00h:00m:06.56s
Steps: 225 | Train Loss: 0.0753909 Vali Loss: 0.0738311 Test Loss: 0.0794865
EarlyStopping counter: 3 out of 10
Updating learning rate to 2.218531234462264e-07
	iters: 100, epoch: 62 | loss: 0.0757755
	speed: 0.0534s/iter; left time: 463.0460s
	iters: 200, epoch: 62 | loss: 0.0695692
	speed: 0.0285s/iter; left time: 244.1364s
-------------------------------------------------------------------------------------
Epoch: 62
Cost time: 00h:00m:06.70s
Steps: 225 | Train Loss: 0.0753604 Vali Loss: 0.0738126 Test Loss: 0.0794836
EarlyStopping counter: 4 out of 10
Updating learning rate to 1.9966781110160376e-07
	iters: 100, epoch: 63 | loss: 0.0758435
	speed: 0.0484s/iter; left time: 409.0732s
	iters: 200, epoch: 63 | loss: 0.0769937
	speed: 0.0240s/iter; left time: 200.0368s
-------------------------------------------------------------------------------------
Epoch: 63
Cost time: 00h:00m:05.76s
Steps: 225 | Train Loss: 0.0753878 Vali Loss: 0.0738097 Test Loss: 0.0794762
EarlyStopping counter: 5 out of 10
Updating learning rate to 1.797010299914434e-07
	iters: 100, epoch: 64 | loss: 0.0750599
	speed: 0.0480s/iter; left time: 394.6231s
	iters: 200, epoch: 64 | loss: 0.0738896
	speed: 0.0264s/iter; left time: 214.4440s
-------------------------------------------------------------------------------------
Epoch: 64
Cost time: 00h:00m:05.95s
Steps: 225 | Train Loss: 0.0754262 Vali Loss: 0.0738157 Test Loss: 0.0794868
EarlyStopping counter: 6 out of 10
Updating learning rate to 1.6173092699229907e-07
	iters: 100, epoch: 65 | loss: 0.0800771
	speed: 0.0418s/iter; left time: 334.2490s
	iters: 200, epoch: 65 | loss: 0.0764180
	speed: 0.0190s/iter; left time: 150.1695s
-------------------------------------------------------------------------------------
Epoch: 65
Cost time: 00h:00m:04.60s
Steps: 225 | Train Loss: 0.0754034 Vali Loss: 0.0738054 Test Loss: 0.0794848
EarlyStopping counter: 7 out of 10
Updating learning rate to 1.4555783429306916e-07
	iters: 100, epoch: 66 | loss: 0.0783498
	speed: 0.0497s/iter; left time: 386.6184s
	iters: 200, epoch: 66 | loss: 0.0783960
	speed: 0.0250s/iter; left time: 191.7498s
-------------------------------------------------------------------------------------
Epoch: 66
Cost time: 00h:00m:06.26s
Steps: 225 | Train Loss: 0.0753819 Vali Loss: 0.0738158 Test Loss: 0.0794879
EarlyStopping counter: 8 out of 10
Updating learning rate to 1.3100205086376224e-07
	iters: 100, epoch: 67 | loss: 0.0708528
	speed: 0.0497s/iter; left time: 375.2506s
	iters: 200, epoch: 67 | loss: 0.0710542
	speed: 0.0250s/iter; left time: 186.0742s
-------------------------------------------------------------------------------------
Epoch: 67
Cost time: 00h:00m:05.89s
Steps: 225 | Train Loss: 0.0753369 Vali Loss: 0.0738132 Test Loss: 0.0794802
EarlyStopping counter: 9 out of 10
Updating learning rate to 1.1790184577738603e-07
	iters: 100, epoch: 68 | loss: 0.0730779
	speed: 0.0515s/iter; left time: 376.9654s
	iters: 200, epoch: 68 | loss: 0.0792189
	speed: 0.0301s/iter; left time: 217.4547s
-------------------------------------------------------------------------------------
Epoch: 68
Cost time: 00h:00m:06.88s
Steps: 225 | Train Loss: 0.0754393 Vali Loss: 0.0738283 Test Loss: 0.0794841
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_96_IT_PatchTST_custom_ftM_sl168_ll48_pl96_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01832953467965126, rmse:0.1353866159915924, mae:0.0794823169708252, rse:0.5119113922119141
Intermediate time for IT and pred_len 96: 00h:15m:47.76s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_168_168_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=168, label_len=48, pred_len=168, inverse=False, loss_fnc='MAE', fc_dropout=0.2, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=1, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=7, c_out=3, d_model=128, n_heads=16, e_layers=3, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.2, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=100, batch_size=128, patience=10, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1870383
	speed: 0.0530s/iter; left time: 1187.6223s
	iters: 200, epoch: 1 | loss: 0.1715603
	speed: 0.0222s/iter; left time: 494.7917s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.01s
Steps: 225 | Train Loss: 0.1853553 Vali Loss: 0.1568048 Test Loss: 0.1660703
Validation loss decreased (inf --> 0.156805).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1076143
	speed: 0.0451s/iter; left time: 1000.7689s
	iters: 200, epoch: 2 | loss: 0.0932135
	speed: 0.0239s/iter; left time: 528.0325s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:05.35s
Steps: 225 | Train Loss: 0.1145113 Vali Loss: 0.0890583 Test Loss: 0.0936706
Validation loss decreased (0.156805 --> 0.089058).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0969614
	speed: 0.0477s/iter; left time: 1047.5406s
	iters: 200, epoch: 3 | loss: 0.0886289
	speed: 0.0240s/iter; left time: 524.0215s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.67s
Steps: 225 | Train Loss: 0.0935062 Vali Loss: 0.0845694 Test Loss: 0.0895883
Validation loss decreased (0.089058 --> 0.084569).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0874625
	speed: 0.0533s/iter; left time: 1157.1418s
	iters: 200, epoch: 4 | loss: 0.0900980
	speed: 0.0245s/iter; left time: 530.1249s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:06.10s
Steps: 225 | Train Loss: 0.0895805 Vali Loss: 0.0827342 Test Loss: 0.0878479
Validation loss decreased (0.084569 --> 0.082734).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0844901
	speed: 0.0457s/iter; left time: 982.2682s
	iters: 200, epoch: 5 | loss: 0.0865713
	speed: 0.0191s/iter; left time: 409.6463s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:04.80s
Steps: 225 | Train Loss: 0.0872905 Vali Loss: 0.0817755 Test Loss: 0.0867167
Validation loss decreased (0.082734 --> 0.081776).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0891566
	speed: 0.0503s/iter; left time: 1069.9232s
	iters: 200, epoch: 6 | loss: 0.0812639
	speed: 0.0268s/iter; left time: 568.1440s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.38s
Steps: 225 | Train Loss: 0.0859008 Vali Loss: 0.0814405 Test Loss: 0.0862796
Validation loss decreased (0.081776 --> 0.081441).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0801779
	speed: 0.0553s/iter; left time: 1164.4329s
	iters: 200, epoch: 7 | loss: 0.0839427
	speed: 0.0304s/iter; left time: 637.7103s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.16s
Steps: 225 | Train Loss: 0.0851128 Vali Loss: 0.0811499 Test Loss: 0.0859220
Validation loss decreased (0.081441 --> 0.081150).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0855081
	speed: 0.0531s/iter; left time: 1106.5250s
	iters: 200, epoch: 8 | loss: 0.0827369
	speed: 0.0248s/iter; left time: 513.7592s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:06.29s
Steps: 225 | Train Loss: 0.0844766 Vali Loss: 0.0809494 Test Loss: 0.0854709
Validation loss decreased (0.081150 --> 0.080949).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0828159
	speed: 0.0535s/iter; left time: 1103.0341s
	iters: 200, epoch: 9 | loss: 0.0814609
	speed: 0.0249s/iter; left time: 509.8511s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.02s
Steps: 225 | Train Loss: 0.0839091 Vali Loss: 0.0807725 Test Loss: 0.0852282
Validation loss decreased (0.080949 --> 0.080772).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0850896
	speed: 0.0492s/iter; left time: 1003.0017s
	iters: 200, epoch: 10 | loss: 0.0819488
	speed: 0.0256s/iter; left time: 518.9903s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:06.09s
Steps: 225 | Train Loss: 0.0835141 Vali Loss: 0.0806206 Test Loss: 0.0851980
Validation loss decreased (0.080772 --> 0.080621).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0808780
	speed: 0.0521s/iter; left time: 1050.3959s
	iters: 200, epoch: 11 | loss: 0.0832348
	speed: 0.0334s/iter; left time: 668.7740s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:06.95s
Steps: 225 | Train Loss: 0.0831508 Vali Loss: 0.0803353 Test Loss: 0.0851180
Validation loss decreased (0.080621 --> 0.080335).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0817546
	speed: 0.0523s/iter; left time: 1041.8946s
	iters: 200, epoch: 12 | loss: 0.0817587
	speed: 0.0256s/iter; left time: 507.0842s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:06.19s
Steps: 225 | Train Loss: 0.0828775 Vali Loss: 0.0803466 Test Loss: 0.0849709
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0832407
	speed: 0.0564s/iter; left time: 1111.2775s
	iters: 200, epoch: 13 | loss: 0.0805905
	speed: 0.0290s/iter; left time: 568.4872s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.92s
Steps: 225 | Train Loss: 0.0826251 Vali Loss: 0.0803146 Test Loss: 0.0849297
Validation loss decreased (0.080335 --> 0.080315).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0825088
	speed: 0.0543s/iter; left time: 1057.6136s
	iters: 200, epoch: 14 | loss: 0.0817128
	speed: 0.0258s/iter; left time: 499.2430s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0823843 Vali Loss: 0.0803333 Test Loss: 0.0849445
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0803306
	speed: 0.0517s/iter; left time: 995.6271s
	iters: 200, epoch: 15 | loss: 0.0829988
	speed: 0.0265s/iter; left time: 507.9526s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.63s
Steps: 225 | Train Loss: 0.0821832 Vali Loss: 0.0801801 Test Loss: 0.0849477
Validation loss decreased (0.080315 --> 0.080180).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0843089
	speed: 0.0529s/iter; left time: 1006.9692s
	iters: 200, epoch: 16 | loss: 0.0825813
	speed: 0.0241s/iter; left time: 455.3594s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.83s
Steps: 225 | Train Loss: 0.0819858 Vali Loss: 0.0800799 Test Loss: 0.0849492
Validation loss decreased (0.080180 --> 0.080080).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0866396
	speed: 0.0473s/iter; left time: 888.9542s
	iters: 200, epoch: 17 | loss: 0.0802184
	speed: 0.0297s/iter; left time: 556.3464s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.34s
Steps: 225 | Train Loss: 0.0818580 Vali Loss: 0.0802803 Test Loss: 0.0850842
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0837353
	speed: 0.0507s/iter; left time: 942.5106s
	iters: 200, epoch: 18 | loss: 0.0844034
	speed: 0.0250s/iter; left time: 462.1972s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:06.09s
Steps: 225 | Train Loss: 0.0816901 Vali Loss: 0.0801386 Test Loss: 0.0850110
EarlyStopping counter: 2 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0803253
	speed: 0.0516s/iter; left time: 946.2819s
	iters: 200, epoch: 19 | loss: 0.0813744
	speed: 0.0276s/iter; left time: 503.9801s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:06.52s
Steps: 225 | Train Loss: 0.0815585 Vali Loss: 0.0800813 Test Loss: 0.0849962
EarlyStopping counter: 3 out of 10
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0786014
	speed: 0.0510s/iter; left time: 925.1082s
	iters: 200, epoch: 20 | loss: 0.0859499
	speed: 0.0268s/iter; left time: 483.9495s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.12s
Steps: 225 | Train Loss: 0.0814428 Vali Loss: 0.0799977 Test Loss: 0.0849762
Validation loss decreased (0.080080 --> 0.079998).  Saving model ...
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0815522
	speed: 0.0480s/iter; left time: 859.6618s
	iters: 200, epoch: 21 | loss: 0.0823843
	speed: 0.0241s/iter; left time: 428.7075s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:05.70s
Steps: 225 | Train Loss: 0.0813704 Vali Loss: 0.0800583 Test Loss: 0.0850808
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0800771
	speed: 0.0472s/iter; left time: 834.5372s
	iters: 200, epoch: 22 | loss: 0.0811914
	speed: 0.0278s/iter; left time: 489.3576s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:05.75s
Steps: 225 | Train Loss: 0.0812269 Vali Loss: 0.0800063 Test Loss: 0.0851742
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0807579
	speed: 0.0457s/iter; left time: 797.1149s
	iters: 200, epoch: 23 | loss: 0.0796830
	speed: 0.0249s/iter; left time: 432.0246s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:05.87s
Steps: 225 | Train Loss: 0.0811856 Vali Loss: 0.0799935 Test Loss: 0.0851762
Validation loss decreased (0.079998 --> 0.079993).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0824995
	speed: 0.0489s/iter; left time: 842.3694s
	iters: 200, epoch: 24 | loss: 0.0829436
	speed: 0.0237s/iter; left time: 405.9087s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:05.53s
Steps: 225 | Train Loss: 0.0810849 Vali Loss: 0.0800554 Test Loss: 0.0852059
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0845193
	speed: 0.0484s/iter; left time: 822.2740s
	iters: 200, epoch: 25 | loss: 0.0822650
	speed: 0.0193s/iter; left time: 325.4021s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:05.15s
Steps: 225 | Train Loss: 0.0810041 Vali Loss: 0.0799557 Test Loss: 0.0851858
Validation loss decreased (0.079993 --> 0.079956).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0829754
	speed: 0.0541s/iter; left time: 907.8570s
	iters: 200, epoch: 26 | loss: 0.0842279
	speed: 0.0318s/iter; left time: 529.6312s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:07.35s
Steps: 225 | Train Loss: 0.0809648 Vali Loss: 0.0800002 Test Loss: 0.0852860
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0819412
	speed: 0.0524s/iter; left time: 867.4836s
	iters: 200, epoch: 27 | loss: 0.0816244
	speed: 0.0304s/iter; left time: 500.5583s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.50s
Steps: 225 | Train Loss: 0.0808716 Vali Loss: 0.0799935 Test Loss: 0.0852660
EarlyStopping counter: 2 out of 10
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0802033
	speed: 0.0460s/iter; left time: 750.7496s
	iters: 200, epoch: 28 | loss: 0.0804373
	speed: 0.0320s/iter; left time: 518.9086s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.63s
Steps: 225 | Train Loss: 0.0808384 Vali Loss: 0.0799336 Test Loss: 0.0852661
Validation loss decreased (0.079956 --> 0.079934).  Saving model ...
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0805667
	speed: 0.0523s/iter; left time: 841.6193s
	iters: 200, epoch: 29 | loss: 0.0810601
	speed: 0.0271s/iter; left time: 434.0591s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.20s
Steps: 225 | Train Loss: 0.0808041 Vali Loss: 0.0799064 Test Loss: 0.0853089
Validation loss decreased (0.079934 --> 0.079906).  Saving model ...
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0832688
	speed: 0.0491s/iter; left time: 780.1163s
	iters: 200, epoch: 30 | loss: 0.0829474
	speed: 0.0264s/iter; left time: 416.7273s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.05s
Steps: 225 | Train Loss: 0.0808051 Vali Loss: 0.0798372 Test Loss: 0.0852992
Validation loss decreased (0.079906 --> 0.079837).  Saving model ...
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0778924
	speed: 0.0481s/iter; left time: 752.3475s
	iters: 200, epoch: 31 | loss: 0.0805558
	speed: 0.0266s/iter; left time: 413.0506s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:05.83s
Steps: 225 | Train Loss: 0.0807081 Vali Loss: 0.0799277 Test Loss: 0.0853229
EarlyStopping counter: 1 out of 10
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0875428
	speed: 0.0496s/iter; left time: 764.7145s
	iters: 200, epoch: 32 | loss: 0.0801462
	speed: 0.0224s/iter; left time: 343.4367s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:05.53s
Steps: 225 | Train Loss: 0.0806755 Vali Loss: 0.0800014 Test Loss: 0.0854342
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0822497
	speed: 0.0459s/iter; left time: 697.9711s
	iters: 200, epoch: 33 | loss: 0.0821414
	speed: 0.0190s/iter; left time: 287.6014s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:04.95s
Steps: 225 | Train Loss: 0.0806552 Vali Loss: 0.0800011 Test Loss: 0.0853880
EarlyStopping counter: 3 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0797373
	speed: 0.0487s/iter; left time: 729.9735s
	iters: 200, epoch: 34 | loss: 0.0793358
	speed: 0.0218s/iter; left time: 324.4152s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:05.71s
Steps: 225 | Train Loss: 0.0806553 Vali Loss: 0.0800313 Test Loss: 0.0854301
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0819117
	speed: 0.0466s/iter; left time: 688.0043s
	iters: 200, epoch: 35 | loss: 0.0796660
	speed: 0.0258s/iter; left time: 378.5036s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.96s
Steps: 225 | Train Loss: 0.0806135 Vali Loss: 0.0799569 Test Loss: 0.0854088
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0811039
	speed: 0.0451s/iter; left time: 654.4638s
	iters: 200, epoch: 36 | loss: 0.0808613
	speed: 0.0247s/iter; left time: 355.6067s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.51s
Steps: 225 | Train Loss: 0.0805913 Vali Loss: 0.0799412 Test Loss: 0.0854182
EarlyStopping counter: 6 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0803814
	speed: 0.0495s/iter; left time: 707.6192s
	iters: 200, epoch: 37 | loss: 0.0787124
	speed: 0.0282s/iter; left time: 400.3777s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0805685 Vali Loss: 0.0798584 Test Loss: 0.0854245
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0817339
	speed: 0.0548s/iter; left time: 771.6184s
	iters: 200, epoch: 38 | loss: 0.0800650
	speed: 0.0301s/iter; left time: 420.1460s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:06.77s
Steps: 225 | Train Loss: 0.0805502 Vali Loss: 0.0798705 Test Loss: 0.0854187
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0804477
	speed: 0.0451s/iter; left time: 624.7986s
	iters: 200, epoch: 39 | loss: 0.0821592
	speed: 0.0197s/iter; left time: 270.5023s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:04.90s
Steps: 225 | Train Loss: 0.0805305 Vali Loss: 0.0799363 Test Loss: 0.0854187
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0770451
	speed: 0.0444s/iter; left time: 604.9656s
	iters: 200, epoch: 40 | loss: 0.0820152
	speed: 0.0255s/iter; left time: 345.0640s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:05.79s
Steps: 225 | Train Loss: 0.0805570 Vali Loss: 0.0799209 Test Loss: 0.0854142
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019987324252724648, rmse:0.1413765400648117, mae:0.08529917895793915, rse:0.5350566506385803
Use GPU: cuda:0
>>>>>>>start training : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28801
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1840543
	speed: 0.0283s/iter; left time: 635.0111s
	iters: 200, epoch: 1 | loss: 0.1685224
	speed: 0.0254s/iter; left time: 566.3328s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:06.17s
Steps: 225 | Train Loss: 0.1844982 Vali Loss: 0.1566570 Test Loss: 0.1659417
Validation loss decreased (inf --> 0.156657).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1132285
	speed: 0.0527s/iter; left time: 1167.6067s
	iters: 200, epoch: 2 | loss: 0.1019533
	speed: 0.0264s/iter; left time: 583.7759s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:06.28s
Steps: 225 | Train Loss: 0.1153133 Vali Loss: 0.0894829 Test Loss: 0.0940419
Validation loss decreased (0.156657 --> 0.089483).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0906220
	speed: 0.0489s/iter; left time: 1073.4433s
	iters: 200, epoch: 3 | loss: 0.0922002
	speed: 0.0222s/iter; left time: 484.8751s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:05.37s
Steps: 225 | Train Loss: 0.0941500 Vali Loss: 0.0851695 Test Loss: 0.0901265
Validation loss decreased (0.089483 --> 0.085170).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0905102
	speed: 0.0485s/iter; left time: 1053.2921s
	iters: 200, epoch: 4 | loss: 0.0934588
	speed: 0.0240s/iter; left time: 519.7364s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:05.54s
Steps: 225 | Train Loss: 0.0901883 Vali Loss: 0.0833089 Test Loss: 0.0883095
Validation loss decreased (0.085170 --> 0.083309).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0869687
	speed: 0.0491s/iter; left time: 1054.7985s
	iters: 200, epoch: 5 | loss: 0.0852287
	speed: 0.0283s/iter; left time: 604.6821s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:06.18s
Steps: 225 | Train Loss: 0.0878854 Vali Loss: 0.0824049 Test Loss: 0.0873542
Validation loss decreased (0.083309 --> 0.082405).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0889387
	speed: 0.0529s/iter; left time: 1126.1671s
	iters: 200, epoch: 6 | loss: 0.0888741
	speed: 0.0252s/iter; left time: 533.7237s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:06.33s
Steps: 225 | Train Loss: 0.0863424 Vali Loss: 0.0816884 Test Loss: 0.0865861
Validation loss decreased (0.082405 --> 0.081688).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0891346
	speed: 0.0596s/iter; left time: 1255.0231s
	iters: 200, epoch: 7 | loss: 0.0892126
	speed: 0.0286s/iter; left time: 599.1267s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:07.20s
Steps: 225 | Train Loss: 0.0854523 Vali Loss: 0.0814068 Test Loss: 0.0861835
Validation loss decreased (0.081688 --> 0.081407).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0836080
	speed: 0.0488s/iter; left time: 1016.3865s
	iters: 200, epoch: 8 | loss: 0.0833302
	speed: 0.0244s/iter; left time: 504.8413s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:05.65s
Steps: 225 | Train Loss: 0.0847868 Vali Loss: 0.0812494 Test Loss: 0.0859815
Validation loss decreased (0.081407 --> 0.081249).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0844111
	speed: 0.0481s/iter; left time: 991.9269s
	iters: 200, epoch: 9 | loss: 0.0839203
	speed: 0.0276s/iter; left time: 566.1741s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:06.02s
Steps: 225 | Train Loss: 0.0842783 Vali Loss: 0.0809623 Test Loss: 0.0856916
Validation loss decreased (0.081249 --> 0.080962).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0840827
	speed: 0.0480s/iter; left time: 979.0573s
	iters: 200, epoch: 10 | loss: 0.0833659
	speed: 0.0253s/iter; left time: 512.9400s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:05.66s
Steps: 225 | Train Loss: 0.0837914 Vali Loss: 0.0807498 Test Loss: 0.0853891
Validation loss decreased (0.080962 --> 0.080750).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0844054
	speed: 0.0503s/iter; left time: 1013.0260s
	iters: 200, epoch: 11 | loss: 0.0841210
	speed: 0.0239s/iter; left time: 478.4001s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:05.80s
Steps: 225 | Train Loss: 0.0834776 Vali Loss: 0.0806861 Test Loss: 0.0854105
Validation loss decreased (0.080750 --> 0.080686).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0856243
	speed: 0.0463s/iter; left time: 922.8811s
	iters: 200, epoch: 12 | loss: 0.0814999
	speed: 0.0190s/iter; left time: 376.9476s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:04.69s
Steps: 225 | Train Loss: 0.0831765 Vali Loss: 0.0805396 Test Loss: 0.0852748
Validation loss decreased (0.080686 --> 0.080540).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0823201
	speed: 0.0491s/iter; left time: 966.7401s
	iters: 200, epoch: 13 | loss: 0.0824843
	speed: 0.0291s/iter; left time: 570.6560s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:06.37s
Steps: 225 | Train Loss: 0.0828718 Vali Loss: 0.0806253 Test Loss: 0.0853202
EarlyStopping counter: 1 out of 10
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0857025
	speed: 0.0480s/iter; left time: 935.2010s
	iters: 200, epoch: 14 | loss: 0.0842681
	speed: 0.0264s/iter; left time: 512.2026s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:05.99s
Steps: 225 | Train Loss: 0.0826168 Vali Loss: 0.0805015 Test Loss: 0.0852329
Validation loss decreased (0.080540 --> 0.080502).  Saving model ...
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0803370
	speed: 0.0550s/iter; left time: 1058.3849s
	iters: 200, epoch: 15 | loss: 0.0810816
	speed: 0.0286s/iter; left time: 547.5990s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:06.65s
Steps: 225 | Train Loss: 0.0824204 Vali Loss: 0.0803796 Test Loss: 0.0851721
Validation loss decreased (0.080502 --> 0.080380).  Saving model ...
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0836899
	speed: 0.0481s/iter; left time: 914.3237s
	iters: 200, epoch: 16 | loss: 0.0845447
	speed: 0.0247s/iter; left time: 467.3594s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:05.93s
Steps: 225 | Train Loss: 0.0822336 Vali Loss: 0.0804758 Test Loss: 0.0853276
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0848320
	speed: 0.0542s/iter; left time: 1018.5180s
	iters: 200, epoch: 17 | loss: 0.0789179
	speed: 0.0303s/iter; left time: 566.0520s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:06.92s
Steps: 225 | Train Loss: 0.0820664 Vali Loss: 0.0803697 Test Loss: 0.0852048
Validation loss decreased (0.080380 --> 0.080370).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0851984
	speed: 0.0490s/iter; left time: 909.3852s
	iters: 200, epoch: 18 | loss: 0.0820806
	speed: 0.0269s/iter; left time: 497.3025s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:05.99s
Steps: 225 | Train Loss: 0.0819157 Vali Loss: 0.0804346 Test Loss: 0.0851734
EarlyStopping counter: 1 out of 10
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0839131
	speed: 0.0475s/iter; left time: 872.3472s
	iters: 200, epoch: 19 | loss: 0.0830659
	speed: 0.0198s/iter; left time: 362.2307s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:05.11s
Steps: 225 | Train Loss: 0.0817556 Vali Loss: 0.0803696 Test Loss: 0.0851382
Validation loss decreased (0.080370 --> 0.080370).  Saving model ...
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0845550
	speed: 0.0535s/iter; left time: 968.8931s
	iters: 200, epoch: 20 | loss: 0.0835551
	speed: 0.0266s/iter; left time: 479.6777s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:06.52s
Steps: 225 | Train Loss: 0.0816904 Vali Loss: 0.0804153 Test Loss: 0.0852913
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.6677181699666577e-05
	iters: 100, epoch: 21 | loss: 0.0853033
	speed: 0.0560s/iter; left time: 1002.1862s
	iters: 200, epoch: 21 | loss: 0.0811036
	speed: 0.0253s/iter; left time: 450.2199s
-------------------------------------------------------------------------------------
Epoch: 21
Cost time: 00h:00m:06.44s
Steps: 225 | Train Loss: 0.0815676 Vali Loss: 0.0803861 Test Loss: 0.0852296
EarlyStopping counter: 2 out of 10
Updating learning rate to 1.5009463529699919e-05
	iters: 100, epoch: 22 | loss: 0.0832729
	speed: 0.0571s/iter; left time: 1009.6678s
	iters: 200, epoch: 22 | loss: 0.0833033
	speed: 0.0340s/iter; left time: 597.6241s
-------------------------------------------------------------------------------------
Epoch: 22
Cost time: 00h:00m:07.67s
Steps: 225 | Train Loss: 0.0814544 Vali Loss: 0.0803558 Test Loss: 0.0851281
Validation loss decreased (0.080370 --> 0.080356).  Saving model ...
Updating learning rate to 1.3508517176729929e-05
	iters: 100, epoch: 23 | loss: 0.0812934
	speed: 0.0559s/iter; left time: 975.0119s
	iters: 200, epoch: 23 | loss: 0.0778939
	speed: 0.0267s/iter; left time: 463.0112s
-------------------------------------------------------------------------------------
Epoch: 23
Cost time: 00h:00m:06.60s
Steps: 225 | Train Loss: 0.0813538 Vali Loss: 0.0803401 Test Loss: 0.0851232
Validation loss decreased (0.080356 --> 0.080340).  Saving model ...
Updating learning rate to 1.2157665459056936e-05
	iters: 100, epoch: 24 | loss: 0.0798932
	speed: 0.0542s/iter; left time: 934.5044s
	iters: 200, epoch: 24 | loss: 0.0799176
	speed: 0.0246s/iter; left time: 421.9901s
-------------------------------------------------------------------------------------
Epoch: 24
Cost time: 00h:00m:06.21s
Steps: 225 | Train Loss: 0.0813174 Vali Loss: 0.0803973 Test Loss: 0.0851114
EarlyStopping counter: 1 out of 10
Updating learning rate to 1.0941898913151242e-05
	iters: 100, epoch: 25 | loss: 0.0781831
	speed: 0.0552s/iter; left time: 937.7107s
	iters: 200, epoch: 25 | loss: 0.0801677
	speed: 0.0303s/iter; left time: 512.7122s
-------------------------------------------------------------------------------------
Epoch: 25
Cost time: 00h:00m:07.03s
Steps: 225 | Train Loss: 0.0812149 Vali Loss: 0.0803270 Test Loss: 0.0851396
Validation loss decreased (0.080340 --> 0.080327).  Saving model ...
Updating learning rate to 9.847709021836118e-06
	iters: 100, epoch: 26 | loss: 0.0842388
	speed: 0.0513s/iter; left time: 860.3276s
	iters: 200, epoch: 26 | loss: 0.0848632
	speed: 0.0288s/iter; left time: 479.7731s
-------------------------------------------------------------------------------------
Epoch: 26
Cost time: 00h:00m:06.28s
Steps: 225 | Train Loss: 0.0811977 Vali Loss: 0.0804594 Test Loss: 0.0851851
EarlyStopping counter: 1 out of 10
Updating learning rate to 8.862938119652508e-06
	iters: 100, epoch: 27 | loss: 0.0855992
	speed: 0.0502s/iter; left time: 831.0068s
	iters: 200, epoch: 27 | loss: 0.0824470
	speed: 0.0261s/iter; left time: 429.2898s
-------------------------------------------------------------------------------------
Epoch: 27
Cost time: 00h:00m:06.05s
Steps: 225 | Train Loss: 0.0810765 Vali Loss: 0.0802903 Test Loss: 0.0852222
Validation loss decreased (0.080327 --> 0.080290).  Saving model ...
Updating learning rate to 7.976644307687255e-06
	iters: 100, epoch: 28 | loss: 0.0795919
	speed: 0.0512s/iter; left time: 835.5050s
	iters: 200, epoch: 28 | loss: 0.0814527
	speed: 0.0267s/iter; left time: 432.9729s
-------------------------------------------------------------------------------------
Epoch: 28
Cost time: 00h:00m:06.19s
Steps: 225 | Train Loss: 0.0810530 Vali Loss: 0.0803517 Test Loss: 0.0851737
EarlyStopping counter: 1 out of 10
Updating learning rate to 7.178979876918531e-06
	iters: 100, epoch: 29 | loss: 0.0819565
	speed: 0.0525s/iter; left time: 845.1188s
	iters: 200, epoch: 29 | loss: 0.0810080
	speed: 0.0291s/iter; left time: 465.5991s
-------------------------------------------------------------------------------------
Epoch: 29
Cost time: 00h:00m:06.86s
Steps: 225 | Train Loss: 0.0810184 Vali Loss: 0.0804359 Test Loss: 0.0852643
EarlyStopping counter: 2 out of 10
Updating learning rate to 6.4610818892266776e-06
	iters: 100, epoch: 30 | loss: 0.0857717
	speed: 0.0540s/iter; left time: 857.7606s
	iters: 200, epoch: 30 | loss: 0.0759639
	speed: 0.0271s/iter; left time: 427.2497s
-------------------------------------------------------------------------------------
Epoch: 30
Cost time: 00h:00m:06.47s
Steps: 225 | Train Loss: 0.0809112 Vali Loss: 0.0804278 Test Loss: 0.0852496
EarlyStopping counter: 3 out of 10
Updating learning rate to 5.8149737003040096e-06
	iters: 100, epoch: 31 | loss: 0.0843048
	speed: 0.0494s/iter; left time: 772.7096s
	iters: 200, epoch: 31 | loss: 0.0825789
	speed: 0.0282s/iter; left time: 437.7948s
-------------------------------------------------------------------------------------
Epoch: 31
Cost time: 00h:00m:06.34s
Steps: 225 | Train Loss: 0.0809512 Vali Loss: 0.0802745 Test Loss: 0.0851780
Validation loss decreased (0.080290 --> 0.080275).  Saving model ...
Updating learning rate to 5.23347633027361e-06
	iters: 100, epoch: 32 | loss: 0.0817797
	speed: 0.0573s/iter; left time: 884.3511s
	iters: 200, epoch: 32 | loss: 0.0841645
	speed: 0.0266s/iter; left time: 407.2445s
-------------------------------------------------------------------------------------
Epoch: 32
Cost time: 00h:00m:06.62s
Steps: 225 | Train Loss: 0.0808820 Vali Loss: 0.0804246 Test Loss: 0.0852316
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.710128697246249e-06
	iters: 100, epoch: 33 | loss: 0.0790420
	speed: 0.0505s/iter; left time: 768.1035s
	iters: 200, epoch: 33 | loss: 0.0808264
	speed: 0.0211s/iter; left time: 318.2898s
-------------------------------------------------------------------------------------
Epoch: 33
Cost time: 00h:00m:05.33s
Steps: 225 | Train Loss: 0.0808836 Vali Loss: 0.0803094 Test Loss: 0.0852217
EarlyStopping counter: 2 out of 10
Updating learning rate to 4.239115827521624e-06
	iters: 100, epoch: 34 | loss: 0.0813956
	speed: 0.0495s/iter; left time: 741.3969s
	iters: 200, epoch: 34 | loss: 0.0802785
	speed: 0.0257s/iter; left time: 382.4833s
-------------------------------------------------------------------------------------
Epoch: 34
Cost time: 00h:00m:06.12s
Steps: 225 | Train Loss: 0.0808873 Vali Loss: 0.0803756 Test Loss: 0.0852348
EarlyStopping counter: 3 out of 10
Updating learning rate to 3.815204244769462e-06
	iters: 100, epoch: 35 | loss: 0.0820862
	speed: 0.0477s/iter; left time: 704.0633s
	iters: 200, epoch: 35 | loss: 0.0778505
	speed: 0.0248s/iter; left time: 363.7288s
-------------------------------------------------------------------------------------
Epoch: 35
Cost time: 00h:00m:05.88s
Steps: 225 | Train Loss: 0.0807801 Vali Loss: 0.0803882 Test Loss: 0.0852780
EarlyStopping counter: 4 out of 10
Updating learning rate to 3.4336838202925152e-06
	iters: 100, epoch: 36 | loss: 0.0843533
	speed: 0.0449s/iter; left time: 651.6178s
	iters: 200, epoch: 36 | loss: 0.0829121
	speed: 0.0245s/iter; left time: 353.3805s
-------------------------------------------------------------------------------------
Epoch: 36
Cost time: 00h:00m:05.19s
Steps: 225 | Train Loss: 0.0807507 Vali Loss: 0.0804198 Test Loss: 0.0852077
EarlyStopping counter: 5 out of 10
Updating learning rate to 3.090315438263264e-06
	iters: 100, epoch: 37 | loss: 0.0747861
	speed: 0.0542s/iter; left time: 775.0166s
	iters: 200, epoch: 37 | loss: 0.0831783
	speed: 0.0299s/iter; left time: 424.9247s
-------------------------------------------------------------------------------------
Epoch: 37
Cost time: 00h:00m:06.97s
Steps: 225 | Train Loss: 0.0807784 Vali Loss: 0.0803491 Test Loss: 0.0852391
EarlyStopping counter: 6 out of 10
Updating learning rate to 2.7812838944369375e-06
	iters: 100, epoch: 38 | loss: 0.0808313
	speed: 0.0464s/iter; left time: 653.1537s
	iters: 200, epoch: 38 | loss: 0.0774353
	speed: 0.0224s/iter; left time: 312.4756s
-------------------------------------------------------------------------------------
Epoch: 38
Cost time: 00h:00m:05.50s
Steps: 225 | Train Loss: 0.0807539 Vali Loss: 0.0803463 Test Loss: 0.0851984
EarlyStopping counter: 7 out of 10
Updating learning rate to 2.503155504993244e-06
	iters: 100, epoch: 39 | loss: 0.0803528
	speed: 0.0485s/iter; left time: 672.2164s
	iters: 200, epoch: 39 | loss: 0.0773313
	speed: 0.0223s/iter; left time: 306.0090s
-------------------------------------------------------------------------------------
Epoch: 39
Cost time: 00h:00m:05.32s
Steps: 225 | Train Loss: 0.0807201 Vali Loss: 0.0804620 Test Loss: 0.0852809
EarlyStopping counter: 8 out of 10
Updating learning rate to 2.2528399544939195e-06
	iters: 100, epoch: 40 | loss: 0.0826981
	speed: 0.0494s/iter; left time: 672.8553s
	iters: 200, epoch: 40 | loss: 0.0803929
	speed: 0.0264s/iter; left time: 357.5886s
-------------------------------------------------------------------------------------
Epoch: 40
Cost time: 00h:00m:06.22s
Steps: 225 | Train Loss: 0.0807109 Vali Loss: 0.0804412 Test Loss: 0.0852437
EarlyStopping counter: 9 out of 10
Updating learning rate to 2.0275559590445276e-06
	iters: 100, epoch: 41 | loss: 0.0817502
	speed: 0.0475s/iter; left time: 636.1647s
	iters: 200, epoch: 41 | loss: 0.0825093
	speed: 0.0288s/iter; left time: 382.6000s
-------------------------------------------------------------------------------------
Epoch: 41
Cost time: 00h:00m:05.90s
Steps: 225 | Train Loss: 0.0806799 Vali Loss: 0.0804509 Test Loss: 0.0852655
EarlyStopping counter: 10 out of 10
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_168_168_IT_PatchTST_custom_ftM_sl168_ll48_pl168_dm128_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019877824932336807, rmse:0.14098873734474182, mae:0.08517807722091675, rse:0.5335890054702759
Intermediate time for IT and pred_len 168: 00h:10m:31.71sIntermediate time for IT: 00h:43m:32.29sTotal time: 03h:46m:41.65s