
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_scaler_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_scaler_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0957632
	speed: 0.0809s/iter; left time: 1457.0052s
	iters: 200, epoch: 1 | loss: 0.0817575
	speed: 0.0487s/iter; left time: 873.0459s
	iters: 300, epoch: 1 | loss: 0.0646085
	speed: 0.0488s/iter; left time: 869.1343s
	iters: 400, epoch: 1 | loss: 0.0612782
	speed: 0.0486s/iter; left time: 860.4880s
	iters: 500, epoch: 1 | loss: 0.0484514
	speed: 0.0486s/iter; left time: 857.0282s
	iters: 600, epoch: 1 | loss: 0.0481590
	speed: 0.0486s/iter; left time: 850.8175s
	iters: 700, epoch: 1 | loss: 0.0343953
	speed: 0.0486s/iter; left time: 846.9034s
	iters: 800, epoch: 1 | loss: 0.0335397
	speed: 0.0484s/iter; left time: 838.4272s
	iters: 900, epoch: 1 | loss: 0.0383372
	speed: 0.0487s/iter; left time: 838.5035s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:45.02s
Steps: 906 | Train Loss: 0.0605991 Vali Loss: 0.0236095 Test Loss: 0.0250904
Validation loss decreased (inf --> 0.023610).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0261842
	speed: 0.1050s/iter; left time: 1797.5936s
	iters: 200, epoch: 2 | loss: 0.0226637
	speed: 0.0484s/iter; left time: 823.9906s
	iters: 300, epoch: 2 | loss: 0.0147367
	speed: 0.0485s/iter; left time: 820.7596s
	iters: 400, epoch: 2 | loss: 0.0144873
	speed: 0.0485s/iter; left time: 815.7621s
	iters: 500, epoch: 2 | loss: 0.0160467
	speed: 0.0485s/iter; left time: 810.6326s
	iters: 600, epoch: 2 | loss: 0.0193212
	speed: 0.0485s/iter; left time: 805.6156s
	iters: 700, epoch: 2 | loss: 0.0140467
	speed: 0.0485s/iter; left time: 800.2748s
	iters: 800, epoch: 2 | loss: 0.0140468
	speed: 0.0485s/iter; left time: 796.5617s
	iters: 900, epoch: 2 | loss: 0.0126574
	speed: 0.0484s/iter; left time: 790.0546s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:44.24s
Steps: 906 | Train Loss: 0.0177892 Vali Loss: 0.0124438 Test Loss: 0.0138910
Validation loss decreased (0.023610 --> 0.012444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0111033
	speed: 0.1077s/iter; left time: 1745.3513s
	iters: 200, epoch: 3 | loss: 0.0115581
	speed: 0.0483s/iter; left time: 777.6412s
	iters: 300, epoch: 3 | loss: 0.0118196
	speed: 0.0485s/iter; left time: 776.5214s
	iters: 400, epoch: 3 | loss: 0.0087795
	speed: 0.0485s/iter; left time: 771.5096s
	iters: 500, epoch: 3 | loss: 0.0111346
	speed: 0.0486s/iter; left time: 767.8246s
	iters: 600, epoch: 3 | loss: 0.0131450
	speed: 0.0485s/iter; left time: 761.3012s
	iters: 700, epoch: 3 | loss: 0.0124399
	speed: 0.0486s/iter; left time: 757.8940s
	iters: 800, epoch: 3 | loss: 0.0134451
	speed: 0.0485s/iter; left time: 752.4053s
	iters: 900, epoch: 3 | loss: 0.0096626
	speed: 0.0485s/iter; left time: 746.7146s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:44.18s
Steps: 906 | Train Loss: 0.0118055 Vali Loss: 0.0124286 Test Loss: 0.0138577
Validation loss decreased (0.012444 --> 0.012429).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0127130
	speed: 0.1055s/iter; left time: 1614.2232s
	iters: 200, epoch: 4 | loss: 0.0096245
	speed: 0.0489s/iter; left time: 744.0887s
	iters: 300, epoch: 4 | loss: 0.0105408
	speed: 0.0489s/iter; left time: 739.2215s
	iters: 400, epoch: 4 | loss: 0.0131704
	speed: 0.0488s/iter; left time: 732.1610s
	iters: 500, epoch: 4 | loss: 0.0106625
	speed: 0.0490s/iter; left time: 729.8353s
	iters: 600, epoch: 4 | loss: 0.0090194
	speed: 0.0491s/iter; left time: 726.0906s
	iters: 700, epoch: 4 | loss: 0.0096538
	speed: 0.0481s/iter; left time: 707.3440s
	iters: 800, epoch: 4 | loss: 0.0114234
	speed: 0.0484s/iter; left time: 706.4750s
	iters: 900, epoch: 4 | loss: 0.0113872
	speed: 0.0484s/iter; left time: 701.8622s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:44.42s
Steps: 906 | Train Loss: 0.0106975 Vali Loss: 0.0112019 Test Loss: 0.0123353
Validation loss decreased (0.012429 --> 0.011202).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0091417
	speed: 0.1053s/iter; left time: 1516.3313s
	iters: 200, epoch: 5 | loss: 0.0132211
	speed: 0.0487s/iter; left time: 695.8080s
	iters: 300, epoch: 5 | loss: 0.0108337
	speed: 0.0487s/iter; left time: 691.6340s
	iters: 400, epoch: 5 | loss: 0.0088053
	speed: 0.0488s/iter; left time: 687.3494s
	iters: 500, epoch: 5 | loss: 0.0094521
	speed: 0.0488s/iter; left time: 683.1385s
	iters: 600, epoch: 5 | loss: 0.0083584
	speed: 0.0488s/iter; left time: 678.6959s
	iters: 700, epoch: 5 | loss: 0.0135315
	speed: 0.0488s/iter; left time: 672.9443s
	iters: 800, epoch: 5 | loss: 0.0068324
	speed: 0.0487s/iter; left time: 666.5997s
	iters: 900, epoch: 5 | loss: 0.0104479
	speed: 0.0486s/iter; left time: 660.3837s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:44.42s
Steps: 906 | Train Loss: 0.0097477 Vali Loss: 0.0103169 Test Loss: 0.0118225
Validation loss decreased (0.011202 --> 0.010317).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0084765
	speed: 0.1049s/iter; left time: 1415.5304s
	iters: 200, epoch: 6 | loss: 0.0092567
	speed: 0.0486s/iter; left time: 650.3530s
	iters: 300, epoch: 6 | loss: 0.0127090
	speed: 0.0485s/iter; left time: 644.8357s
	iters: 400, epoch: 6 | loss: 0.0078653
	speed: 0.0486s/iter; left time: 641.3219s
	iters: 500, epoch: 6 | loss: 0.0061968
	speed: 0.0486s/iter; left time: 635.5992s
	iters: 600, epoch: 6 | loss: 0.0094398
	speed: 0.0485s/iter; left time: 630.6005s
	iters: 700, epoch: 6 | loss: 0.0095741
	speed: 0.0486s/iter; left time: 626.1683s
	iters: 800, epoch: 6 | loss: 0.0084911
	speed: 0.0485s/iter; left time: 620.7695s
	iters: 900, epoch: 6 | loss: 0.0074697
	speed: 0.0484s/iter; left time: 613.9940s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:44.26s
Steps: 906 | Train Loss: 0.0089266 Vali Loss: 0.0098866 Test Loss: 0.0116170
Validation loss decreased (0.010317 --> 0.009887).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0078370
	speed: 0.1046s/iter; left time: 1316.9476s
	iters: 200, epoch: 7 | loss: 0.0097201
	speed: 0.0482s/iter; left time: 602.0353s
	iters: 300, epoch: 7 | loss: 0.0068884
	speed: 0.0483s/iter; left time: 598.2411s
	iters: 400, epoch: 7 | loss: 0.0094338
	speed: 0.0483s/iter; left time: 592.7989s
	iters: 500, epoch: 7 | loss: 0.0086338
	speed: 0.0483s/iter; left time: 589.0812s
	iters: 600, epoch: 7 | loss: 0.0053967
	speed: 0.0482s/iter; left time: 582.7840s
	iters: 700, epoch: 7 | loss: 0.0085320
	speed: 0.0483s/iter; left time: 578.3621s
	iters: 800, epoch: 7 | loss: 0.0095296
	speed: 0.0483s/iter; left time: 573.9164s
	iters: 900, epoch: 7 | loss: 0.0069363
	speed: 0.0482s/iter; left time: 567.8871s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:44.01s
Steps: 906 | Train Loss: 0.0083970 Vali Loss: 0.0095849 Test Loss: 0.0113854
Validation loss decreased (0.009887 --> 0.009585).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0068547
	speed: 0.1046s/iter; left time: 1221.3498s
	iters: 200, epoch: 8 | loss: 0.0062880
	speed: 0.0488s/iter; left time: 565.2733s
	iters: 300, epoch: 8 | loss: 0.0063780
	speed: 0.0488s/iter; left time: 559.9106s
	iters: 400, epoch: 8 | loss: 0.0076308
	speed: 0.0489s/iter; left time: 556.0048s
	iters: 500, epoch: 8 | loss: 0.0084253
	speed: 0.0487s/iter; left time: 549.4192s
	iters: 600, epoch: 8 | loss: 0.0079748
	speed: 0.0488s/iter; left time: 545.3736s
	iters: 700, epoch: 8 | loss: 0.0071999
	speed: 0.0487s/iter; left time: 539.6797s
	iters: 800, epoch: 8 | loss: 0.0082351
	speed: 0.0488s/iter; left time: 535.7184s
	iters: 900, epoch: 8 | loss: 0.0076345
	speed: 0.0487s/iter; left time: 529.8313s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:44.48s
Steps: 906 | Train Loss: 0.0078698 Vali Loss: 0.0095649 Test Loss: 0.0113864
Validation loss decreased (0.009585 --> 0.009565).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0054177
	speed: 0.1048s/iter; left time: 1128.5025s
	iters: 200, epoch: 9 | loss: 0.0087093
	speed: 0.0481s/iter; left time: 513.4635s
	iters: 300, epoch: 9 | loss: 0.0088883
	speed: 0.0486s/iter; left time: 513.5006s
	iters: 400, epoch: 9 | loss: 0.0067530
	speed: 0.0487s/iter; left time: 509.9381s
	iters: 500, epoch: 9 | loss: 0.0068062
	speed: 0.0487s/iter; left time: 505.3949s
	iters: 600, epoch: 9 | loss: 0.0070813
	speed: 0.0487s/iter; left time: 500.0157s
	iters: 700, epoch: 9 | loss: 0.0077914
	speed: 0.0487s/iter; left time: 495.3033s
	iters: 800, epoch: 9 | loss: 0.0067969
	speed: 0.0487s/iter; left time: 490.3120s
	iters: 900, epoch: 9 | loss: 0.0065149
	speed: 0.0486s/iter; left time: 484.8901s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:44.31s
Steps: 906 | Train Loss: 0.0073633 Vali Loss: 0.0106109 Test Loss: 0.0119681
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0078787
	speed: 0.1008s/iter; left time: 994.6874s
	iters: 200, epoch: 10 | loss: 0.0073015
	speed: 0.0484s/iter; left time: 472.4272s
	iters: 300, epoch: 10 | loss: 0.0071232
	speed: 0.0482s/iter; left time: 466.2905s
	iters: 400, epoch: 10 | loss: 0.0069564
	speed: 0.0483s/iter; left time: 462.3624s
	iters: 500, epoch: 10 | loss: 0.0055014
	speed: 0.0484s/iter; left time: 458.2573s
	iters: 600, epoch: 10 | loss: 0.0067581
	speed: 0.0483s/iter; left time: 452.2664s
	iters: 700, epoch: 10 | loss: 0.0056662
	speed: 0.0483s/iter; left time: 447.3826s
	iters: 800, epoch: 10 | loss: 0.0064611
	speed: 0.0482s/iter; left time: 441.9085s
	iters: 900, epoch: 10 | loss: 0.0061233
	speed: 0.0481s/iter; left time: 436.2460s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:43.98s
Steps: 906 | Train Loss: 0.0069422 Vali Loss: 0.0097545 Test Loss: 0.0121330
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0067805
	speed: 0.1016s/iter; left time: 910.8243s
	iters: 200, epoch: 11 | loss: 0.0054183
	speed: 0.0486s/iter; left time: 430.7755s
	iters: 300, epoch: 11 | loss: 0.0069844
	speed: 0.0484s/iter; left time: 423.6183s
	iters: 400, epoch: 11 | loss: 0.0054563
	speed: 0.0486s/iter; left time: 421.2761s
	iters: 500, epoch: 11 | loss: 0.0078667
	speed: 0.0486s/iter; left time: 415.9784s
	iters: 600, epoch: 11 | loss: 0.0084661
	speed: 0.0484s/iter; left time: 409.6942s
	iters: 700, epoch: 11 | loss: 0.0064551
	speed: 0.0484s/iter; left time: 404.4055s
	iters: 800, epoch: 11 | loss: 0.0078192
	speed: 0.0486s/iter; left time: 401.8850s
	iters: 900, epoch: 11 | loss: 0.0064657
	speed: 0.0485s/iter; left time: 396.2133s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:44.26s
Steps: 906 | Train Loss: 0.0065644 Vali Loss: 0.0102390 Test Loss: 0.0123357
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0049833
	speed: 0.1017s/iter; left time: 819.2750s
	iters: 200, epoch: 12 | loss: 0.0075870
	speed: 0.0486s/iter; left time: 386.3999s
	iters: 300, epoch: 12 | loss: 0.0057872
	speed: 0.0485s/iter; left time: 380.6715s
	iters: 400, epoch: 12 | loss: 0.0063423
	speed: 0.0483s/iter; left time: 374.7971s
	iters: 500, epoch: 12 | loss: 0.0083102
	speed: 0.0484s/iter; left time: 370.2066s
	iters: 600, epoch: 12 | loss: 0.0066547
	speed: 0.0484s/iter; left time: 365.8611s
	iters: 700, epoch: 12 | loss: 0.0055785
	speed: 0.0484s/iter; left time: 361.1328s
	iters: 800, epoch: 12 | loss: 0.0077896
	speed: 0.0484s/iter; left time: 356.2063s
	iters: 900, epoch: 12 | loss: 0.0061444
	speed: 0.0484s/iter; left time: 350.8553s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:44.18s
Steps: 906 | Train Loss: 0.0062224 Vali Loss: 0.0102077 Test Loss: 0.0127671
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0060006
	speed: 0.1011s/iter; left time: 722.4409s
	iters: 200, epoch: 13 | loss: 0.0065340
	speed: 0.0484s/iter; left time: 340.9649s
	iters: 300, epoch: 13 | loss: 0.0052825
	speed: 0.0485s/iter; left time: 336.8735s
	iters: 400, epoch: 13 | loss: 0.0075953
	speed: 0.0484s/iter; left time: 331.1754s
	iters: 500, epoch: 13 | loss: 0.0046650
	speed: 0.0482s/iter; left time: 325.0557s
	iters: 600, epoch: 13 | loss: 0.0054308
	speed: 0.0476s/iter; left time: 316.2525s
	iters: 700, epoch: 13 | loss: 0.0058771
	speed: 0.0484s/iter; left time: 316.7926s
	iters: 800, epoch: 13 | loss: 0.0050994
	speed: 0.0482s/iter; left time: 311.1338s
	iters: 900, epoch: 13 | loss: 0.0066943
	speed: 0.0482s/iter; left time: 306.3360s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:43.87s
Steps: 906 | Train Loss: 0.0058265 Vali Loss: 0.0103207 Test Loss: 0.0131232
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_scaler_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01137869618833065, rmse:0.10667096823453903, mae:0.06598816812038422, rse:0.40311703085899353
Original data scale mse:1897220.5, rmse:1377.396240234375, mae:889.3832397460938, rse:0.09679288417100906

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.01137869618833065, RMSE: 0.10667096823453903, MAE: 0.06598816812038422, RSE: 0.40311703085899353
Unscaled Metrics - MSE: 1897220.5, RMSE: 1377.396240234375, MAE: 889.3832397460938, RSE: 0.09679288417100906

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_scaler_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_scaler_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1052735
	speed: 0.0805s/iter; left time: 1446.8473s
	iters: 200, epoch: 1 | loss: 0.0845075
	speed: 0.0497s/iter; left time: 888.2199s
	iters: 300, epoch: 1 | loss: 0.0778775
	speed: 0.0501s/iter; left time: 891.4439s
	iters: 400, epoch: 1 | loss: 0.0722261
	speed: 0.0509s/iter; left time: 899.1364s
	iters: 500, epoch: 1 | loss: 0.0733849
	speed: 0.0504s/iter; left time: 885.9382s
	iters: 600, epoch: 1 | loss: 0.0649374
	speed: 0.0507s/iter; left time: 885.8577s
	iters: 700, epoch: 1 | loss: 0.0627303
	speed: 0.0504s/iter; left time: 875.8841s
	iters: 800, epoch: 1 | loss: 0.0568795
	speed: 0.0502s/iter; left time: 867.3952s
	iters: 900, epoch: 1 | loss: 0.0588607
	speed: 0.0503s/iter; left time: 865.0524s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.36s
Steps: 904 | Train Loss: 0.0770370 Vali Loss: 0.0422612 Test Loss: 0.0492609
Validation loss decreased (inf --> 0.042261).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0423253
	speed: 0.1143s/iter; left time: 1951.2053s
	iters: 200, epoch: 2 | loss: 0.0328577
	speed: 0.0512s/iter; left time: 869.3117s
	iters: 300, epoch: 2 | loss: 0.0310498
	speed: 0.0510s/iter; left time: 861.0180s
	iters: 400, epoch: 2 | loss: 0.0267299
	speed: 0.0509s/iter; left time: 854.4213s
	iters: 500, epoch: 2 | loss: 0.0250892
	speed: 0.0509s/iter; left time: 848.5097s
	iters: 600, epoch: 2 | loss: 0.0215443
	speed: 0.0507s/iter; left time: 840.5637s
	iters: 700, epoch: 2 | loss: 0.0228624
	speed: 0.0508s/iter; left time: 837.3714s
	iters: 800, epoch: 2 | loss: 0.0199976
	speed: 0.0507s/iter; left time: 830.6593s
	iters: 900, epoch: 2 | loss: 0.0192713
	speed: 0.0510s/iter; left time: 829.5684s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.25s
Steps: 904 | Train Loss: 0.0281857 Vali Loss: 0.0192857 Test Loss: 0.0213712
Validation loss decreased (0.042261 --> 0.019286).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0187188
	speed: 0.1150s/iter; left time: 1860.2736s
	iters: 200, epoch: 3 | loss: 0.0193838
	speed: 0.0506s/iter; left time: 812.5755s
	iters: 300, epoch: 3 | loss: 0.0201494
	speed: 0.0498s/iter; left time: 795.1681s
	iters: 400, epoch: 3 | loss: 0.0181761
	speed: 0.0499s/iter; left time: 792.0418s
	iters: 500, epoch: 3 | loss: 0.0159714
	speed: 0.0505s/iter; left time: 796.4509s
	iters: 600, epoch: 3 | loss: 0.0182038
	speed: 0.0505s/iter; left time: 791.1482s
	iters: 700, epoch: 3 | loss: 0.0159824
	speed: 0.0504s/iter; left time: 784.4332s
	iters: 800, epoch: 3 | loss: 0.0199805
	speed: 0.0503s/iter; left time: 779.0482s
	iters: 900, epoch: 3 | loss: 0.0154733
	speed: 0.0503s/iter; left time: 773.3523s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:45.77s
Steps: 904 | Train Loss: 0.0183871 Vali Loss: 0.0164777 Test Loss: 0.0187503
Validation loss decreased (0.019286 --> 0.016478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0155618
	speed: 0.1137s/iter; left time: 1735.7656s
	iters: 200, epoch: 4 | loss: 0.0181367
	speed: 0.0505s/iter; left time: 766.3386s
	iters: 300, epoch: 4 | loss: 0.0170885
	speed: 0.0504s/iter; left time: 759.9688s
	iters: 400, epoch: 4 | loss: 0.0159648
	speed: 0.0501s/iter; left time: 749.4519s
	iters: 500, epoch: 4 | loss: 0.0150804
	speed: 0.0506s/iter; left time: 753.1031s
	iters: 600, epoch: 4 | loss: 0.0142211
	speed: 0.0508s/iter; left time: 750.3437s
	iters: 700, epoch: 4 | loss: 0.0189483
	speed: 0.0508s/iter; left time: 745.5344s
	iters: 800, epoch: 4 | loss: 0.0140306
	speed: 0.0502s/iter; left time: 731.9301s
	iters: 900, epoch: 4 | loss: 0.0153686
	speed: 0.0503s/iter; left time: 727.9476s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.90s
Steps: 904 | Train Loss: 0.0166229 Vali Loss: 0.0166674 Test Loss: 0.0183428
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0166662
	speed: 0.1093s/iter; left time: 1569.5393s
	iters: 200, epoch: 5 | loss: 0.0135682
	speed: 0.0497s/iter; left time: 709.4186s
	iters: 300, epoch: 5 | loss: 0.0158774
	speed: 0.0496s/iter; left time: 702.5685s
	iters: 400, epoch: 5 | loss: 0.0165986
	speed: 0.0497s/iter; left time: 699.7198s
	iters: 500, epoch: 5 | loss: 0.0149370
	speed: 0.0496s/iter; left time: 692.7150s
	iters: 600, epoch: 5 | loss: 0.0161001
	speed: 0.0499s/iter; left time: 691.3440s
	iters: 700, epoch: 5 | loss: 0.0142459
	speed: 0.0497s/iter; left time: 684.0442s
	iters: 800, epoch: 5 | loss: 0.0150630
	speed: 0.0498s/iter; left time: 680.3678s
	iters: 900, epoch: 5 | loss: 0.0157289
	speed: 0.0498s/iter; left time: 675.3105s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:45.23s
Steps: 904 | Train Loss: 0.0152686 Vali Loss: 0.0166363 Test Loss: 0.0196131
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0172512
	speed: 0.1103s/iter; left time: 1484.7449s
	iters: 200, epoch: 6 | loss: 0.0152996
	speed: 0.0503s/iter; left time: 672.2461s
	iters: 300, epoch: 6 | loss: 0.0147258
	speed: 0.0502s/iter; left time: 666.0468s
	iters: 400, epoch: 6 | loss: 0.0128632
	speed: 0.0497s/iter; left time: 653.9338s
	iters: 500, epoch: 6 | loss: 0.0138966
	speed: 0.0499s/iter; left time: 651.7620s
	iters: 600, epoch: 6 | loss: 0.0140565
	speed: 0.0501s/iter; left time: 648.7582s
	iters: 700, epoch: 6 | loss: 0.0149950
	speed: 0.0499s/iter; left time: 641.5402s
	iters: 800, epoch: 6 | loss: 0.0133245
	speed: 0.0496s/iter; left time: 633.5508s
	iters: 900, epoch: 6 | loss: 0.0130404
	speed: 0.0497s/iter; left time: 629.4319s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.45s
Steps: 904 | Train Loss: 0.0141668 Vali Loss: 0.0181570 Test Loss: 0.0206778
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0123304
	speed: 0.1111s/iter; left time: 1395.6960s
	iters: 200, epoch: 7 | loss: 0.0136654
	speed: 0.0504s/iter; left time: 628.2651s
	iters: 300, epoch: 7 | loss: 0.0142162
	speed: 0.0506s/iter; left time: 624.9387s
	iters: 400, epoch: 7 | loss: 0.0128690
	speed: 0.0501s/iter; left time: 614.0827s
	iters: 500, epoch: 7 | loss: 0.0128486
	speed: 0.0506s/iter; left time: 614.7757s
	iters: 600, epoch: 7 | loss: 0.0104035
	speed: 0.0504s/iter; left time: 607.4868s
	iters: 700, epoch: 7 | loss: 0.0125170
	speed: 0.0506s/iter; left time: 604.9773s
	iters: 800, epoch: 7 | loss: 0.0103865
	speed: 0.0507s/iter; left time: 600.6022s
	iters: 900, epoch: 7 | loss: 0.0143755
	speed: 0.0504s/iter; left time: 592.3181s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:45.90s
Steps: 904 | Train Loss: 0.0130236 Vali Loss: 0.0173678 Test Loss: 0.0208934
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0150618
	speed: 0.1105s/iter; left time: 1287.8489s
	iters: 200, epoch: 8 | loss: 0.0120275
	speed: 0.0501s/iter; left time: 579.0655s
	iters: 300, epoch: 8 | loss: 0.0121574
	speed: 0.0497s/iter; left time: 569.2083s
	iters: 400, epoch: 8 | loss: 0.0106792
	speed: 0.0497s/iter; left time: 564.0515s
	iters: 500, epoch: 8 | loss: 0.0111393
	speed: 0.0499s/iter; left time: 561.1490s
	iters: 600, epoch: 8 | loss: 0.0108992
	speed: 0.0499s/iter; left time: 556.0449s
	iters: 700, epoch: 8 | loss: 0.0118494
	speed: 0.0498s/iter; left time: 550.6994s
	iters: 800, epoch: 8 | loss: 0.0115658
	speed: 0.0498s/iter; left time: 545.6069s
	iters: 900, epoch: 8 | loss: 0.0098825
	speed: 0.0498s/iter; left time: 540.7533s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:45.35s
Steps: 904 | Train Loss: 0.0118994 Vali Loss: 0.0178741 Test Loss: 0.0224808
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_scaler_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018757950514554977, rmse:0.13695967197418213, mae:0.09164635092020035, rse:0.5178592801094055
Original data scale mse:4011030.25, rmse:2002.755615234375, mae:1317.1807861328125, rse:0.14094209671020508

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.018757950514554977, RMSE: 0.13695967197418213, MAE: 0.09164635092020035, RSE: 0.5178592801094055
Unscaled Metrics - MSE: 4011030.25, RMSE: 2002.755615234375, MAE: 1317.1807861328125, RSE: 0.14094209671020508

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_scaler_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_scaler_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1080960
	speed: 0.0807s/iter; left time: 1448.6037s
	iters: 200, epoch: 1 | loss: 0.0824163
	speed: 0.0517s/iter; left time: 922.5309s
	iters: 300, epoch: 1 | loss: 0.0842993
	speed: 0.0512s/iter; left time: 908.9383s
	iters: 400, epoch: 1 | loss: 0.0736092
	speed: 0.0511s/iter; left time: 900.6010s
	iters: 500, epoch: 1 | loss: 0.0733240
	speed: 0.0499s/iter; left time: 874.6721s
	iters: 600, epoch: 1 | loss: 0.0706275
	speed: 0.0502s/iter; left time: 875.4694s
	iters: 700, epoch: 1 | loss: 0.0656435
	speed: 0.0499s/iter; left time: 865.6878s
	iters: 800, epoch: 1 | loss: 0.0658726
	speed: 0.0495s/iter; left time: 852.7293s
	iters: 900, epoch: 1 | loss: 0.0630696
	speed: 0.0502s/iter; left time: 860.6820s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.26s
Steps: 902 | Train Loss: 0.0786550 Vali Loss: 0.0498637 Test Loss: 0.0583538
Validation loss decreased (inf --> 0.049864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0482759
	speed: 0.1247s/iter; left time: 2125.1491s
	iters: 200, epoch: 2 | loss: 0.0421801
	speed: 0.0517s/iter; left time: 876.3713s
	iters: 300, epoch: 2 | loss: 0.0385429
	speed: 0.0517s/iter; left time: 870.9840s
	iters: 400, epoch: 2 | loss: 0.0367902
	speed: 0.0509s/iter; left time: 851.8933s
	iters: 500, epoch: 2 | loss: 0.0308838
	speed: 0.0505s/iter; left time: 841.0018s
	iters: 600, epoch: 2 | loss: 0.0255439
	speed: 0.0504s/iter; left time: 833.8026s
	iters: 700, epoch: 2 | loss: 0.0225206
	speed: 0.0517s/iter; left time: 850.5914s
	iters: 800, epoch: 2 | loss: 0.0219971
	speed: 0.0516s/iter; left time: 843.5026s
	iters: 900, epoch: 2 | loss: 0.0218719
	speed: 0.0503s/iter; left time: 816.3116s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.54s
Steps: 902 | Train Loss: 0.0340902 Vali Loss: 0.0191990 Test Loss: 0.0217300
Validation loss decreased (0.049864 --> 0.019199).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0235283
	speed: 0.1256s/iter; left time: 2026.2922s
	iters: 200, epoch: 3 | loss: 0.0206867
	speed: 0.0517s/iter; left time: 829.4887s
	iters: 300, epoch: 3 | loss: 0.0206621
	speed: 0.0517s/iter; left time: 823.4673s
	iters: 400, epoch: 3 | loss: 0.0177734
	speed: 0.0517s/iter; left time: 818.3076s
	iters: 500, epoch: 3 | loss: 0.0205937
	speed: 0.0517s/iter; left time: 813.3265s
	iters: 600, epoch: 3 | loss: 0.0205176
	speed: 0.0500s/iter; left time: 782.0579s
	iters: 700, epoch: 3 | loss: 0.0188191
	speed: 0.0503s/iter; left time: 781.3555s
	iters: 800, epoch: 3 | loss: 0.0180016
	speed: 0.0517s/iter; left time: 798.8572s
	iters: 900, epoch: 3 | loss: 0.0204296
	speed: 0.0515s/iter; left time: 790.5516s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:46.67s
Steps: 902 | Train Loss: 0.0200820 Vali Loss: 0.0191245 Test Loss: 0.0210825
Validation loss decreased (0.019199 --> 0.019124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0196903
	speed: 0.1252s/iter; left time: 1906.8443s
	iters: 200, epoch: 4 | loss: 0.0173575
	speed: 0.0517s/iter; left time: 782.0716s
	iters: 300, epoch: 4 | loss: 0.0186932
	speed: 0.0513s/iter; left time: 770.8456s
	iters: 400, epoch: 4 | loss: 0.0181120
	speed: 0.0517s/iter; left time: 772.2122s
	iters: 500, epoch: 4 | loss: 0.0186082
	speed: 0.0517s/iter; left time: 767.3235s
	iters: 600, epoch: 4 | loss: 0.0175178
	speed: 0.0500s/iter; left time: 737.3200s
	iters: 700, epoch: 4 | loss: 0.0184030
	speed: 0.0510s/iter; left time: 746.1875s
	iters: 800, epoch: 4 | loss: 0.0189094
	speed: 0.0515s/iter; left time: 749.1585s
	iters: 900, epoch: 4 | loss: 0.0182288
	speed: 0.0513s/iter; left time: 740.4346s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:46.69s
Steps: 902 | Train Loss: 0.0183361 Vali Loss: 0.0185760 Test Loss: 0.0211089
Validation loss decreased (0.019124 --> 0.018576).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0169285
	speed: 0.1255s/iter; left time: 1798.9083s
	iters: 200, epoch: 5 | loss: 0.0162984
	speed: 0.0507s/iter; left time: 721.2711s
	iters: 300, epoch: 5 | loss: 0.0175885
	speed: 0.0505s/iter; left time: 713.0344s
	iters: 400, epoch: 5 | loss: 0.0168064
	speed: 0.0504s/iter; left time: 707.0160s
	iters: 500, epoch: 5 | loss: 0.0158014
	speed: 0.0510s/iter; left time: 710.8311s
	iters: 600, epoch: 5 | loss: 0.0175041
	speed: 0.0516s/iter; left time: 713.1741s
	iters: 700, epoch: 5 | loss: 0.0175251
	speed: 0.0509s/iter; left time: 699.4839s
	iters: 800, epoch: 5 | loss: 0.0160738
	speed: 0.0505s/iter; left time: 688.6262s
	iters: 900, epoch: 5 | loss: 0.0180332
	speed: 0.0504s/iter; left time: 682.3207s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:46.09s
Steps: 902 | Train Loss: 0.0168270 Vali Loss: 0.0191929 Test Loss: 0.0207321
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0170055
	speed: 0.1237s/iter; left time: 1661.1817s
	iters: 200, epoch: 6 | loss: 0.0187532
	speed: 0.0511s/iter; left time: 681.8065s
	iters: 300, epoch: 6 | loss: 0.0166333
	speed: 0.0517s/iter; left time: 684.0687s
	iters: 400, epoch: 6 | loss: 0.0146327
	speed: 0.0510s/iter; left time: 670.2077s
	iters: 500, epoch: 6 | loss: 0.0151519
	speed: 0.0487s/iter; left time: 634.2786s
	iters: 600, epoch: 6 | loss: 0.0148442
	speed: 0.0512s/iter; left time: 662.2534s
	iters: 700, epoch: 6 | loss: 0.0146263
	speed: 0.0517s/iter; left time: 662.8162s
	iters: 800, epoch: 6 | loss: 0.0176119
	speed: 0.0517s/iter; left time: 658.2691s
	iters: 900, epoch: 6 | loss: 0.0159310
	speed: 0.0514s/iter; left time: 649.3356s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.56s
Steps: 902 | Train Loss: 0.0153580 Vali Loss: 0.0195957 Test Loss: 0.0217750
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0179181
	speed: 0.1220s/iter; left time: 1528.3797s
	iters: 200, epoch: 7 | loss: 0.0150460
	speed: 0.0517s/iter; left time: 642.5987s
	iters: 300, epoch: 7 | loss: 0.0146198
	speed: 0.0517s/iter; left time: 637.9321s
	iters: 400, epoch: 7 | loss: 0.0149516
	speed: 0.0465s/iter; left time: 569.0682s
	iters: 500, epoch: 7 | loss: 0.0124086
	speed: 0.0498s/iter; left time: 603.9657s
	iters: 600, epoch: 7 | loss: 0.0153495
	speed: 0.0518s/iter; left time: 622.5164s
	iters: 700, epoch: 7 | loss: 0.0124983
	speed: 0.0517s/iter; left time: 616.1809s
	iters: 800, epoch: 7 | loss: 0.0126885
	speed: 0.0517s/iter; left time: 611.8553s
	iters: 900, epoch: 7 | loss: 0.0129139
	speed: 0.0512s/iter; left time: 600.8593s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:46.23s
Steps: 902 | Train Loss: 0.0140290 Vali Loss: 0.0201149 Test Loss: 0.0227018
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0139799
	speed: 0.1207s/iter; left time: 1402.8173s
	iters: 200, epoch: 8 | loss: 0.0130178
	speed: 0.0518s/iter; left time: 597.0199s
	iters: 300, epoch: 8 | loss: 0.0146793
	speed: 0.0515s/iter; left time: 588.8790s
	iters: 400, epoch: 8 | loss: 0.0124940
	speed: 0.0517s/iter; left time: 585.5494s
	iters: 500, epoch: 8 | loss: 0.0133813
	speed: 0.0518s/iter; left time: 581.8778s
	iters: 600, epoch: 8 | loss: 0.0127013
	speed: 0.0516s/iter; left time: 574.3011s
	iters: 700, epoch: 8 | loss: 0.0136042
	speed: 0.0517s/iter; left time: 569.8301s
	iters: 800, epoch: 8 | loss: 0.0127588
	speed: 0.0513s/iter; left time: 560.3385s
	iters: 900, epoch: 8 | loss: 0.0109258
	speed: 0.0486s/iter; left time: 525.7427s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:46.59s
Steps: 902 | Train Loss: 0.0127591 Vali Loss: 0.0202601 Test Loss: 0.0218758
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0109588
	speed: 0.1176s/iter; left time: 1260.7772s
	iters: 200, epoch: 9 | loss: 0.0122424
	speed: 0.0492s/iter; left time: 522.4758s
	iters: 300, epoch: 9 | loss: 0.0136600
	speed: 0.0517s/iter; left time: 544.5617s
	iters: 400, epoch: 9 | loss: 0.0114705
	speed: 0.0519s/iter; left time: 540.5563s
	iters: 500, epoch: 9 | loss: 0.0127231
	speed: 0.0517s/iter; left time: 534.0541s
	iters: 600, epoch: 9 | loss: 0.0126706
	speed: 0.0517s/iter; left time: 529.0946s
	iters: 700, epoch: 9 | loss: 0.0122179
	speed: 0.0517s/iter; left time: 523.4351s
	iters: 800, epoch: 9 | loss: 0.0115100
	speed: 0.0518s/iter; left time: 519.4031s
	iters: 900, epoch: 9 | loss: 0.0118221
	speed: 0.0516s/iter; left time: 511.8267s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:46.24s
Steps: 902 | Train Loss: 0.0116011 Vali Loss: 0.0210053 Test Loss: 0.0222173
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_scaler_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021097851917147636, rmse:0.14525099098682404, mae:0.09748273342847824, rse:0.5495890974998474
Original data scale mse:4433544.5, rmse:2105.598388671875, mae:1389.800537109375, rse:0.14831870794296265

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.021097851917147636, RMSE: 0.14525099098682404, MAE: 0.09748273342847824, RSE: 0.5495890974998474
Unscaled Metrics - MSE: 4433544.5, RMSE: 2105.598388671875, MAE: 1389.800537109375, RSE: 0.14831870794296265
