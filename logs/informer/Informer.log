
=== Starting experiments for country: DE ===

=== Starting experiments for pred_len: 24 ===

--- Running model for DE, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_DE_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0844291
	speed: 0.1427s/iter; left time: 2572.1345s
	iters: 200, epoch: 1 | loss: 0.0693888
	speed: 0.0494s/iter; left time: 885.8380s
	iters: 300, epoch: 1 | loss: 0.0655493
	speed: 0.0499s/iter; left time: 890.1312s
	iters: 400, epoch: 1 | loss: 0.0564399
	speed: 0.0496s/iter; left time: 879.7680s
	iters: 500, epoch: 1 | loss: 0.0501456
	speed: 0.0501s/iter; left time: 882.9455s
	iters: 600, epoch: 1 | loss: 0.0479440
	speed: 0.0499s/iter; left time: 873.8236s
	iters: 700, epoch: 1 | loss: 0.0540418
	speed: 0.0497s/iter; left time: 866.1543s
	iters: 800, epoch: 1 | loss: 0.0417317
	speed: 0.0496s/iter; left time: 859.8567s
	iters: 900, epoch: 1 | loss: 0.0365065
	speed: 0.0493s/iter; left time: 848.1437s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:52.17s
Steps: 906 | Train Loss: 0.0620887 Vali Loss: 0.0407531 Test Loss: 0.0445114
Validation loss decreased (inf --> 0.040753).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0251532
	speed: 0.1083s/iter; left time: 1854.3454s
	iters: 200, epoch: 2 | loss: 0.0322412
	speed: 0.0502s/iter; left time: 854.2099s
	iters: 300, epoch: 2 | loss: 0.0245991
	speed: 0.0499s/iter; left time: 844.4689s
	iters: 400, epoch: 2 | loss: 0.0171704
	speed: 0.0499s/iter; left time: 838.3457s
	iters: 500, epoch: 2 | loss: 0.0195076
	speed: 0.0500s/iter; left time: 836.3813s
	iters: 600, epoch: 2 | loss: 0.0165113
	speed: 0.0496s/iter; left time: 823.7032s
	iters: 700, epoch: 2 | loss: 0.0190108
	speed: 0.0496s/iter; left time: 818.9604s
	iters: 800, epoch: 2 | loss: 0.0165992
	speed: 0.0496s/iter; left time: 813.3686s
	iters: 900, epoch: 2 | loss: 0.0153506
	speed: 0.0496s/iter; left time: 809.8884s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:45.41s
Steps: 906 | Train Loss: 0.0211746 Vali Loss: 0.0227766 Test Loss: 0.0249225
Validation loss decreased (0.040753 --> 0.022777).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0191735
	speed: 0.1052s/iter; left time: 1704.4077s
	iters: 200, epoch: 3 | loss: 0.0155110
	speed: 0.0499s/iter; left time: 803.6381s
	iters: 300, epoch: 3 | loss: 0.0156315
	speed: 0.0503s/iter; left time: 804.9803s
	iters: 400, epoch: 3 | loss: 0.0145043
	speed: 0.0496s/iter; left time: 788.9447s
	iters: 500, epoch: 3 | loss: 0.0143492
	speed: 0.0497s/iter; left time: 785.2020s
	iters: 600, epoch: 3 | loss: 0.0139118
	speed: 0.0495s/iter; left time: 777.8266s
	iters: 700, epoch: 3 | loss: 0.0120604
	speed: 0.0496s/iter; left time: 774.9063s
	iters: 800, epoch: 3 | loss: 0.0160756
	speed: 0.0487s/iter; left time: 755.4104s
	iters: 900, epoch: 3 | loss: 0.0143501
	speed: 0.0495s/iter; left time: 762.4773s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:45.15s
Steps: 906 | Train Loss: 0.0150597 Vali Loss: 0.0232971 Test Loss: 0.0252371
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0124714
	speed: 0.1032s/iter; left time: 1579.5266s
	iters: 200, epoch: 4 | loss: 0.0135723
	speed: 0.0499s/iter; left time: 757.9602s
	iters: 300, epoch: 4 | loss: 0.0133752
	speed: 0.0499s/iter; left time: 753.9695s
	iters: 400, epoch: 4 | loss: 0.0128325
	speed: 0.0499s/iter; left time: 748.0100s
	iters: 500, epoch: 4 | loss: 0.0170870
	speed: 0.0499s/iter; left time: 743.4145s
	iters: 600, epoch: 4 | loss: 0.0159228
	speed: 0.0500s/iter; left time: 739.7313s
	iters: 700, epoch: 4 | loss: 0.0160074
	speed: 0.0500s/iter; left time: 734.7973s
	iters: 800, epoch: 4 | loss: 0.0128487
	speed: 0.0500s/iter; left time: 729.5119s
	iters: 900, epoch: 4 | loss: 0.0095744
	speed: 0.0498s/iter; left time: 722.5718s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.44s
Steps: 906 | Train Loss: 0.0137407 Vali Loss: 0.0219377 Test Loss: 0.0240274
Validation loss decreased (0.022777 --> 0.021938).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0123596
	speed: 0.1080s/iter; left time: 1555.5584s
	iters: 200, epoch: 5 | loss: 0.0123557
	speed: 0.0504s/iter; left time: 720.7002s
	iters: 300, epoch: 5 | loss: 0.0114830
	speed: 0.0501s/iter; left time: 711.9341s
	iters: 400, epoch: 5 | loss: 0.0166790
	speed: 0.0503s/iter; left time: 708.9998s
	iters: 500, epoch: 5 | loss: 0.0130099
	speed: 0.0496s/iter; left time: 694.4080s
	iters: 600, epoch: 5 | loss: 0.0162379
	speed: 0.0502s/iter; left time: 697.7440s
	iters: 700, epoch: 5 | loss: 0.0147405
	speed: 0.0502s/iter; left time: 692.5045s
	iters: 800, epoch: 5 | loss: 0.0135671
	speed: 0.0504s/iter; left time: 690.7652s
	iters: 900, epoch: 5 | loss: 0.0163193
	speed: 0.0503s/iter; left time: 684.3252s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:45.74s
Steps: 906 | Train Loss: 0.0126119 Vali Loss: 0.0216679 Test Loss: 0.0243225
Validation loss decreased (0.021938 --> 0.021668).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0116733
	speed: 0.1058s/iter; left time: 1427.9170s
	iters: 200, epoch: 6 | loss: 0.0101081
	speed: 0.0496s/iter; left time: 664.2453s
	iters: 300, epoch: 6 | loss: 0.0103430
	speed: 0.0501s/iter; left time: 666.2620s
	iters: 400, epoch: 6 | loss: 0.0111628
	speed: 0.0495s/iter; left time: 653.5656s
	iters: 500, epoch: 6 | loss: 0.0122635
	speed: 0.0500s/iter; left time: 654.5210s
	iters: 600, epoch: 6 | loss: 0.0087395
	speed: 0.0500s/iter; left time: 649.0961s
	iters: 700, epoch: 6 | loss: 0.0120656
	speed: 0.0501s/iter; left time: 645.6841s
	iters: 800, epoch: 6 | loss: 0.0125768
	speed: 0.0498s/iter; left time: 636.7036s
	iters: 900, epoch: 6 | loss: 0.0099931
	speed: 0.0496s/iter; left time: 629.8804s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.33s
Steps: 906 | Train Loss: 0.0116739 Vali Loss: 0.0211125 Test Loss: 0.0254185
Validation loss decreased (0.021668 --> 0.021113).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0096771
	speed: 0.1062s/iter; left time: 1336.8479s
	iters: 200, epoch: 7 | loss: 0.0094396
	speed: 0.0499s/iter; left time: 623.2537s
	iters: 300, epoch: 7 | loss: 0.0114610
	speed: 0.0496s/iter; left time: 614.8298s
	iters: 400, epoch: 7 | loss: 0.0119442
	speed: 0.0491s/iter; left time: 603.5330s
	iters: 500, epoch: 7 | loss: 0.0132686
	speed: 0.0493s/iter; left time: 600.8634s
	iters: 600, epoch: 7 | loss: 0.0079299
	speed: 0.0478s/iter; left time: 577.4773s
	iters: 700, epoch: 7 | loss: 0.0124909
	speed: 0.0480s/iter; left time: 575.4539s
	iters: 800, epoch: 7 | loss: 0.0076778
	speed: 0.0465s/iter; left time: 552.8320s
	iters: 900, epoch: 7 | loss: 0.0091967
	speed: 0.0422s/iter; left time: 496.8931s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.72s
Steps: 906 | Train Loss: 0.0107831 Vali Loss: 0.0222866 Test Loss: 0.0263801
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0086997
	speed: 0.0981s/iter; left time: 1145.6847s
	iters: 200, epoch: 8 | loss: 0.0115932
	speed: 0.0399s/iter; left time: 461.9744s
	iters: 300, epoch: 8 | loss: 0.0087272
	speed: 0.0488s/iter; left time: 560.3632s
	iters: 400, epoch: 8 | loss: 0.0111578
	speed: 0.0463s/iter; left time: 527.2175s
	iters: 500, epoch: 8 | loss: 0.0074500
	speed: 0.0481s/iter; left time: 542.4308s
	iters: 600, epoch: 8 | loss: 0.0114486
	speed: 0.0416s/iter; left time: 464.6558s
	iters: 700, epoch: 8 | loss: 0.0086220
	speed: 0.0411s/iter; left time: 455.1277s
	iters: 800, epoch: 8 | loss: 0.0097864
	speed: 0.0511s/iter; left time: 561.1245s
	iters: 900, epoch: 8 | loss: 0.0122829
	speed: 0.0441s/iter; left time: 479.5812s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:41.10s
Steps: 906 | Train Loss: 0.0098266 Vali Loss: 0.0233274 Test Loss: 0.0263052
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0102292
	speed: 0.1046s/iter; left time: 1126.3727s
	iters: 200, epoch: 9 | loss: 0.0096972
	speed: 0.0450s/iter; left time: 480.0894s
	iters: 300, epoch: 9 | loss: 0.0081635
	speed: 0.0453s/iter; left time: 479.3784s
	iters: 400, epoch: 9 | loss: 0.0104667
	speed: 0.0503s/iter; left time: 527.2788s
	iters: 500, epoch: 9 | loss: 0.0084879
	speed: 0.0438s/iter; left time: 454.4248s
	iters: 600, epoch: 9 | loss: 0.0097039
	speed: 0.0484s/iter; left time: 496.8385s
	iters: 700, epoch: 9 | loss: 0.0099554
	speed: 0.0495s/iter; left time: 504.0006s
	iters: 800, epoch: 9 | loss: 0.0107502
	speed: 0.0443s/iter; left time: 445.7749s
	iters: 900, epoch: 9 | loss: 0.0077211
	speed: 0.0443s/iter; left time: 441.4584s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:42.41s
Steps: 906 | Train Loss: 0.0090420 Vali Loss: 0.0235619 Test Loss: 0.0281686
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0089565
	speed: 0.1001s/iter; left time: 987.2302s
	iters: 200, epoch: 10 | loss: 0.0086324
	speed: 0.0488s/iter; left time: 476.6851s
	iters: 300, epoch: 10 | loss: 0.0090554
	speed: 0.0433s/iter; left time: 418.2883s
	iters: 400, epoch: 10 | loss: 0.0098368
	speed: 0.0487s/iter; left time: 465.9023s
	iters: 500, epoch: 10 | loss: 0.0081708
	speed: 0.0492s/iter; left time: 465.5845s
	iters: 600, epoch: 10 | loss: 0.0068844
	speed: 0.0465s/iter; left time: 435.7801s
	iters: 700, epoch: 10 | loss: 0.0071657
	speed: 0.0452s/iter; left time: 418.6769s
	iters: 800, epoch: 10 | loss: 0.0073063
	speed: 0.0499s/iter; left time: 457.5685s
	iters: 900, epoch: 10 | loss: 0.0070751
	speed: 0.0434s/iter; left time: 393.2744s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:42.52s
Steps: 906 | Train Loss: 0.0083348 Vali Loss: 0.0225941 Test Loss: 0.0268508
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0080009
	speed: 0.0976s/iter; left time: 874.8162s
	iters: 200, epoch: 11 | loss: 0.0075677
	speed: 0.0495s/iter; left time: 438.4793s
	iters: 300, epoch: 11 | loss: 0.0058150
	speed: 0.0471s/iter; left time: 412.7264s
	iters: 400, epoch: 11 | loss: 0.0062782
	speed: 0.0446s/iter; left time: 386.6124s
	iters: 500, epoch: 11 | loss: 0.0092325
	speed: 0.0475s/iter; left time: 406.2238s
	iters: 600, epoch: 11 | loss: 0.0077828
	speed: 0.0467s/iter; left time: 395.0152s
	iters: 700, epoch: 11 | loss: 0.0077392
	speed: 0.0478s/iter; left time: 399.9426s
	iters: 800, epoch: 11 | loss: 0.0067178
	speed: 0.0462s/iter; left time: 381.7836s
	iters: 900, epoch: 11 | loss: 0.0054118
	speed: 0.0460s/iter; left time: 375.4481s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:42.28s
Steps: 906 | Train Loss: 0.0075969 Vali Loss: 0.0233432 Test Loss: 0.0285462
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_DE_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02549596317112446, rmse:0.15967455506324768, mae:0.10630149394273758, rse:0.5638949871063232
Intermediate time for DE and pred_len 24: 00h:09m:19.20s
=== Starting experiments for pred_len: 96 ===

--- Running model for DE, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_DE_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0908792
	speed: 0.0750s/iter; left time: 1348.1348s
	iters: 200, epoch: 1 | loss: 0.0826019
	speed: 0.0508s/iter; left time: 907.8065s
	iters: 300, epoch: 1 | loss: 0.0739485
	speed: 0.0444s/iter; left time: 788.6712s
	iters: 400, epoch: 1 | loss: 0.0652045
	speed: 0.0461s/iter; left time: 814.3695s
	iters: 500, epoch: 1 | loss: 0.0608115
	speed: 0.0443s/iter; left time: 779.4635s
	iters: 600, epoch: 1 | loss: 0.0582726
	speed: 0.0516s/iter; left time: 902.3502s
	iters: 700, epoch: 1 | loss: 0.0530457
	speed: 0.0436s/iter; left time: 757.0509s
	iters: 800, epoch: 1 | loss: 0.0556172
	speed: 0.0423s/iter; left time: 731.2912s
	iters: 900, epoch: 1 | loss: 0.0533727
	speed: 0.0443s/iter; left time: 761.0885s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.39s
Steps: 904 | Train Loss: 0.0693695 Vali Loss: 0.0569431 Test Loss: 0.0726330
Validation loss decreased (inf --> 0.056943).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0445395
	speed: 0.1197s/iter; left time: 2043.4044s
	iters: 200, epoch: 2 | loss: 0.0347430
	speed: 0.0511s/iter; left time: 867.8837s
	iters: 300, epoch: 2 | loss: 0.0310663
	speed: 0.0486s/iter; left time: 819.5342s
	iters: 400, epoch: 2 | loss: 0.0340965
	speed: 0.0504s/iter; left time: 846.3156s
	iters: 500, epoch: 2 | loss: 0.0340284
	speed: 0.0494s/iter; left time: 823.8322s
	iters: 600, epoch: 2 | loss: 0.0291398
	speed: 0.0512s/iter; left time: 848.4981s
	iters: 700, epoch: 2 | loss: 0.0287280
	speed: 0.0428s/iter; left time: 705.9979s
	iters: 800, epoch: 2 | loss: 0.0285814
	speed: 0.0439s/iter; left time: 719.2027s
	iters: 900, epoch: 2 | loss: 0.0318606
	speed: 0.0492s/iter; left time: 800.0778s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:44.24s
Steps: 904 | Train Loss: 0.0336223 Vali Loss: 0.0370270 Test Loss: 0.0475181
Validation loss decreased (0.056943 --> 0.037027).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0267080
	speed: 0.1167s/iter; left time: 1886.8275s
	iters: 200, epoch: 3 | loss: 0.0226177
	speed: 0.0514s/iter; left time: 825.4768s
	iters: 300, epoch: 3 | loss: 0.0249391
	speed: 0.0453s/iter; left time: 723.7616s
	iters: 400, epoch: 3 | loss: 0.0226962
	speed: 0.0489s/iter; left time: 775.8878s
	iters: 500, epoch: 3 | loss: 0.0232413
	speed: 0.0469s/iter; left time: 739.4723s
	iters: 600, epoch: 3 | loss: 0.0222054
	speed: 0.0441s/iter; left time: 690.6065s
	iters: 700, epoch: 3 | loss: 0.0253964
	speed: 0.0474s/iter; left time: 738.2745s
	iters: 800, epoch: 3 | loss: 0.0199290
	speed: 0.0436s/iter; left time: 674.9476s
	iters: 900, epoch: 3 | loss: 0.0254071
	speed: 0.0483s/iter; left time: 743.2619s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.83s
Steps: 904 | Train Loss: 0.0236946 Vali Loss: 0.0336329 Test Loss: 0.0415587
Validation loss decreased (0.037027 --> 0.033633).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0275110
	speed: 0.1120s/iter; left time: 1709.5452s
	iters: 200, epoch: 4 | loss: 0.0187502
	speed: 0.0423s/iter; left time: 641.2553s
	iters: 300, epoch: 4 | loss: 0.0265851
	speed: 0.0341s/iter; left time: 513.1235s
	iters: 400, epoch: 4 | loss: 0.0211057
	speed: 0.0345s/iter; left time: 516.0901s
	iters: 500, epoch: 4 | loss: 0.0217084
	speed: 0.0399s/iter; left time: 593.4692s
	iters: 600, epoch: 4 | loss: 0.0198707
	speed: 0.0437s/iter; left time: 644.8752s
	iters: 700, epoch: 4 | loss: 0.0226085
	speed: 0.0348s/iter; left time: 510.1822s
	iters: 800, epoch: 4 | loss: 0.0182402
	speed: 0.0353s/iter; left time: 513.8942s
	iters: 900, epoch: 4 | loss: 0.0187977
	speed: 0.0350s/iter; left time: 506.9563s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:35.17s
Steps: 904 | Train Loss: 0.0206394 Vali Loss: 0.0352910 Test Loss: 0.0430563
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0173709
	speed: 0.0985s/iter; left time: 1415.4455s
	iters: 200, epoch: 5 | loss: 0.0166946
	speed: 0.0342s/iter; left time: 488.1990s
	iters: 300, epoch: 5 | loss: 0.0180556
	speed: 0.0351s/iter; left time: 496.6928s
	iters: 400, epoch: 5 | loss: 0.0225047
	speed: 0.0345s/iter; left time: 484.8603s
	iters: 500, epoch: 5 | loss: 0.0165685
	speed: 0.0339s/iter; left time: 473.2486s
	iters: 600, epoch: 5 | loss: 0.0213444
	speed: 0.0334s/iter; left time: 462.5078s
	iters: 700, epoch: 5 | loss: 0.0211287
	speed: 0.0345s/iter; left time: 474.7769s
	iters: 800, epoch: 5 | loss: 0.0154284
	speed: 0.0343s/iter; left time: 468.3148s
	iters: 900, epoch: 5 | loss: 0.0167327
	speed: 0.0347s/iter; left time: 470.5814s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.45s
Steps: 904 | Train Loss: 0.0181818 Vali Loss: 0.0360216 Test Loss: 0.0486139
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0162390
	speed: 0.0993s/iter; left time: 1337.0378s
	iters: 200, epoch: 6 | loss: 0.0149850
	speed: 0.0348s/iter; left time: 465.5123s
	iters: 300, epoch: 6 | loss: 0.0161773
	speed: 0.0377s/iter; left time: 499.4532s
	iters: 400, epoch: 6 | loss: 0.0161455
	speed: 0.0350s/iter; left time: 460.4346s
	iters: 500, epoch: 6 | loss: 0.0159038
	speed: 0.0371s/iter; left time: 484.9915s
	iters: 600, epoch: 6 | loss: 0.0155437
	speed: 0.0375s/iter; left time: 486.3731s
	iters: 700, epoch: 6 | loss: 0.0135126
	speed: 0.0360s/iter; left time: 462.8306s
	iters: 800, epoch: 6 | loss: 0.0161070
	speed: 0.0370s/iter; left time: 472.5303s
	iters: 900, epoch: 6 | loss: 0.0155187
	speed: 0.0366s/iter; left time: 463.9396s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.27s
Steps: 904 | Train Loss: 0.0158869 Vali Loss: 0.0358567 Test Loss: 0.0487426
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0146865
	speed: 0.1068s/iter; left time: 1341.2589s
	iters: 200, epoch: 7 | loss: 0.0132540
	speed: 0.0346s/iter; left time: 430.8277s
	iters: 300, epoch: 7 | loss: 0.0136056
	speed: 0.0371s/iter; left time: 457.8333s
	iters: 400, epoch: 7 | loss: 0.0151962
	speed: 0.0350s/iter; left time: 429.5408s
	iters: 500, epoch: 7 | loss: 0.0126808
	speed: 0.0350s/iter; left time: 425.5842s
	iters: 600, epoch: 7 | loss: 0.0143357
	speed: 0.0384s/iter; left time: 462.6141s
	iters: 700, epoch: 7 | loss: 0.0140345
	speed: 0.0367s/iter; left time: 439.3212s
	iters: 800, epoch: 7 | loss: 0.0124623
	speed: 0.0337s/iter; left time: 399.1144s
	iters: 900, epoch: 7 | loss: 0.0136355
	speed: 0.0375s/iter; left time: 440.9399s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:33.20s
Steps: 904 | Train Loss: 0.0139272 Vali Loss: 0.0363626 Test Loss: 0.0491312
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0122056
	speed: 0.1078s/iter; left time: 1256.2333s
	iters: 200, epoch: 8 | loss: 0.0113194
	speed: 0.0339s/iter; left time: 391.4538s
	iters: 300, epoch: 8 | loss: 0.0139114
	speed: 0.0348s/iter; left time: 398.0912s
	iters: 400, epoch: 8 | loss: 0.0119940
	speed: 0.0375s/iter; left time: 425.5855s
	iters: 500, epoch: 8 | loss: 0.0131242
	speed: 0.0349s/iter; left time: 392.5505s
	iters: 600, epoch: 8 | loss: 0.0141879
	speed: 0.0370s/iter; left time: 412.4413s
	iters: 700, epoch: 8 | loss: 0.0130758
	speed: 0.0368s/iter; left time: 407.2791s
	iters: 800, epoch: 8 | loss: 0.0103310
	speed: 0.0347s/iter; left time: 379.9474s
	iters: 900, epoch: 8 | loss: 0.0104962
	speed: 0.0370s/iter; left time: 401.4193s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.20s
Steps: 904 | Train Loss: 0.0124156 Vali Loss: 0.0373577 Test Loss: 0.0492265
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_DE_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04156292974948883, rmse:0.20386987924575806, mae:0.14678193628787994, rse:0.7219445109367371
Intermediate time for DE and pred_len 96: 00h:05m:58.92s
=== Starting experiments for pred_len: 168 ===

--- Running model for DE, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_DE_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0861944
	speed: 0.1069s/iter; left time: 1917.8637s
	iters: 200, epoch: 1 | loss: 0.0816551
	speed: 0.0668s/iter; left time: 1192.5272s
	iters: 300, epoch: 1 | loss: 0.0688623
	speed: 0.0612s/iter; left time: 1086.2980s
	iters: 400, epoch: 1 | loss: 0.0678409
	speed: 0.0637s/iter; left time: 1124.2229s
	iters: 500, epoch: 1 | loss: 0.0633130
	speed: 0.0704s/iter; left time: 1234.9969s
	iters: 600, epoch: 1 | loss: 0.0644796
	speed: 0.0585s/iter; left time: 1021.1471s
	iters: 700, epoch: 1 | loss: 0.0581975
	speed: 0.0669s/iter; left time: 1159.7102s
	iters: 800, epoch: 1 | loss: 0.0562265
	speed: 0.0696s/iter; left time: 1200.3932s
	iters: 900, epoch: 1 | loss: 0.0581804
	speed: 0.0579s/iter; left time: 992.7731s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:58.85s
Steps: 902 | Train Loss: 0.0709426 Vali Loss: 0.0584743 Test Loss: 0.0763278
Validation loss decreased (inf --> 0.058474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0473072
	speed: 0.2372s/iter; left time: 4042.0005s
	iters: 200, epoch: 2 | loss: 0.0385538
	speed: 0.0639s/iter; left time: 1082.8934s
	iters: 300, epoch: 2 | loss: 0.0370987
	speed: 0.0623s/iter; left time: 1048.9279s
	iters: 400, epoch: 2 | loss: 0.0379711
	speed: 0.0719s/iter; left time: 1203.0546s
	iters: 500, epoch: 2 | loss: 0.0324598
	speed: 0.0607s/iter; left time: 1010.2992s
	iters: 600, epoch: 2 | loss: 0.0304995
	speed: 0.0650s/iter; left time: 1075.7078s
	iters: 700, epoch: 2 | loss: 0.0285279
	speed: 0.0646s/iter; left time: 1061.9442s
	iters: 800, epoch: 2 | loss: 0.0329162
	speed: 0.0602s/iter; left time: 983.4328s
	iters: 900, epoch: 2 | loss: 0.0283897
	speed: 0.0712s/iter; left time: 1155.9906s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:58.96s
Steps: 902 | Train Loss: 0.0370804 Vali Loss: 0.0431616 Test Loss: 0.0524194
Validation loss decreased (0.058474 --> 0.043162).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0306641
	speed: 0.2314s/iter; left time: 3733.8028s
	iters: 200, epoch: 3 | loss: 0.0285753
	speed: 0.0554s/iter; left time: 888.4296s
	iters: 300, epoch: 3 | loss: 0.0272127
	speed: 0.0618s/iter; left time: 984.2828s
	iters: 400, epoch: 3 | loss: 0.0306366
	speed: 0.0478s/iter; left time: 756.5741s
	iters: 500, epoch: 3 | loss: 0.0275743
	speed: 0.0383s/iter; left time: 602.2215s
	iters: 600, epoch: 3 | loss: 0.0266086
	speed: 0.0492s/iter; left time: 770.0451s
	iters: 700, epoch: 3 | loss: 0.0248030
	speed: 0.0595s/iter; left time: 924.1043s
	iters: 800, epoch: 3 | loss: 0.0238694
	speed: 0.0686s/iter; left time: 1058.7800s
	iters: 900, epoch: 3 | loss: 0.0242699
	speed: 0.0580s/iter; left time: 890.3062s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:50.26s
Steps: 902 | Train Loss: 0.0274520 Vali Loss: 0.0379027 Test Loss: 0.0459632
Validation loss decreased (0.043162 --> 0.037903).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0232967
	speed: 0.2251s/iter; left time: 3429.1374s
	iters: 200, epoch: 4 | loss: 0.0210634
	speed: 0.0673s/iter; left time: 1018.4676s
	iters: 300, epoch: 4 | loss: 0.0214336
	speed: 0.0544s/iter; left time: 817.6585s
	iters: 400, epoch: 4 | loss: 0.0200201
	speed: 0.0591s/iter; left time: 882.9815s
	iters: 500, epoch: 4 | loss: 0.0191740
	speed: 0.0609s/iter; left time: 902.8600s
	iters: 600, epoch: 4 | loss: 0.0223153
	speed: 0.0554s/iter; left time: 816.0936s
	iters: 700, epoch: 4 | loss: 0.0197920
	speed: 0.0577s/iter; left time: 844.4934s
	iters: 800, epoch: 4 | loss: 0.0204711
	speed: 0.0554s/iter; left time: 804.8677s
	iters: 900, epoch: 4 | loss: 0.0179707
	speed: 0.0643s/iter; left time: 927.9186s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:53.81s
Steps: 902 | Train Loss: 0.0220058 Vali Loss: 0.0428637 Test Loss: 0.0473708
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0184987
	speed: 0.2127s/iter; left time: 3048.9004s
	iters: 200, epoch: 5 | loss: 0.0188701
	speed: 0.0567s/iter; left time: 807.6322s
	iters: 300, epoch: 5 | loss: 0.0192380
	speed: 0.0575s/iter; left time: 812.2377s
	iters: 400, epoch: 5 | loss: 0.0198872
	speed: 0.0606s/iter; left time: 850.8197s
	iters: 500, epoch: 5 | loss: 0.0168683
	speed: 0.0547s/iter; left time: 762.8055s
	iters: 600, epoch: 5 | loss: 0.0176144
	speed: 0.0613s/iter; left time: 847.7396s
	iters: 700, epoch: 5 | loss: 0.0178311
	speed: 0.0565s/iter; left time: 775.6462s
	iters: 800, epoch: 5 | loss: 0.0204910
	speed: 0.0577s/iter; left time: 786.5932s
	iters: 900, epoch: 5 | loss: 0.0178536
	speed: 0.0523s/iter; left time: 708.2676s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:52.21s
Steps: 902 | Train Loss: 0.0191415 Vali Loss: 0.0384142 Test Loss: 0.0487048
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0186351
	speed: 0.2125s/iter; left time: 2853.5858s
	iters: 200, epoch: 6 | loss: 0.0176800
	speed: 0.0600s/iter; left time: 799.9818s
	iters: 300, epoch: 6 | loss: 0.0170789
	speed: 0.0594s/iter; left time: 786.0428s
	iters: 400, epoch: 6 | loss: 0.0206994
	speed: 0.0566s/iter; left time: 743.8695s
	iters: 500, epoch: 6 | loss: 0.0190296
	speed: 0.0539s/iter; left time: 701.9603s
	iters: 600, epoch: 6 | loss: 0.0164793
	speed: 0.0578s/iter; left time: 747.4678s
	iters: 700, epoch: 6 | loss: 0.0139499
	speed: 0.0585s/iter; left time: 750.8084s
	iters: 800, epoch: 6 | loss: 0.0153553
	speed: 0.0571s/iter; left time: 726.3704s
	iters: 900, epoch: 6 | loss: 0.0163441
	speed: 0.0567s/iter; left time: 716.2719s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:51.82s
Steps: 902 | Train Loss: 0.0168664 Vali Loss: 0.0399395 Test Loss: 0.0500806
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0141258
	speed: 0.2079s/iter; left time: 2604.2335s
	iters: 200, epoch: 7 | loss: 0.0150832
	speed: 0.0543s/iter; left time: 675.0986s
	iters: 300, epoch: 7 | loss: 0.0154001
	speed: 0.0515s/iter; left time: 635.4854s
	iters: 400, epoch: 7 | loss: 0.0129656
	speed: 0.0559s/iter; left time: 683.3631s
	iters: 500, epoch: 7 | loss: 0.0154558
	speed: 0.0582s/iter; left time: 705.4288s
	iters: 600, epoch: 7 | loss: 0.0135689
	speed: 0.0548s/iter; left time: 658.6908s
	iters: 700, epoch: 7 | loss: 0.0144427
	speed: 0.0514s/iter; left time: 613.6999s
	iters: 800, epoch: 7 | loss: 0.0146086
	speed: 0.0567s/iter; left time: 670.1602s
	iters: 900, epoch: 7 | loss: 0.0156404
	speed: 0.0569s/iter; left time: 667.0137s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:50.21s
Steps: 902 | Train Loss: 0.0148521 Vali Loss: 0.0405050 Test Loss: 0.0519974
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0135467
	speed: 0.2082s/iter; left time: 2420.1803s
	iters: 200, epoch: 8 | loss: 0.0147633
	speed: 0.0561s/iter; left time: 646.7043s
	iters: 300, epoch: 8 | loss: 0.0138894
	speed: 0.0584s/iter; left time: 667.0506s
	iters: 400, epoch: 8 | loss: 0.0129612
	speed: 0.0528s/iter; left time: 598.4363s
	iters: 500, epoch: 8 | loss: 0.0127115
	speed: 0.0560s/iter; left time: 628.6022s
	iters: 600, epoch: 8 | loss: 0.0125061
	speed: 0.0585s/iter; left time: 651.3853s
	iters: 700, epoch: 8 | loss: 0.0132125
	speed: 0.0555s/iter; left time: 611.8251s
	iters: 800, epoch: 8 | loss: 0.0115913
	speed: 0.0551s/iter; left time: 602.2714s
	iters: 900, epoch: 8 | loss: 0.0115792
	speed: 0.0537s/iter; left time: 581.9366s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:50.34s
Steps: 902 | Train Loss: 0.0132287 Vali Loss: 0.0421177 Test Loss: 0.0539093
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_DE_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04590200260281563, rmse:0.21424752473831177, mae:0.15394257009029388, rse:0.7590144276618958
Intermediate time for DE and pred_len 168: 00h:09m:31.89sIntermediate time for DE: 00h:24m:50.01s
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_96_24_GB', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_96_24_GB_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0764679
	speed: 0.0622s/iter; left time: 1120.8065s
	iters: 200, epoch: 1 | loss: 0.0657391
	speed: 0.0263s/iter; left time: 471.5337s
	iters: 300, epoch: 1 | loss: 0.0562565
	speed: 0.0266s/iter; left time: 474.1467s
	iters: 400, epoch: 1 | loss: 0.0548274
	speed: 0.0265s/iter; left time: 470.2608s
	iters: 500, epoch: 1 | loss: 0.0477097
	speed: 0.0260s/iter; left time: 458.0102s
	iters: 600, epoch: 1 | loss: 0.0463367
	speed: 0.0260s/iter; left time: 455.9176s
	iters: 700, epoch: 1 | loss: 0.0439485
	speed: 0.0279s/iter; left time: 485.8104s
	iters: 800, epoch: 1 | loss: 0.0382239
	speed: 0.0271s/iter; left time: 469.7998s
	iters: 900, epoch: 1 | loss: 0.0366430
	speed: 0.0320s/iter; left time: 551.9255s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.68s
Steps: 906 | Train Loss: 0.0594367 Vali Loss: 0.0429403 Test Loss: 0.0600197
Validation loss decreased (inf --> 0.042940).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0303652
	speed: 0.1016s/iter; left time: 1738.7253s
	iters: 200, epoch: 2 | loss: 0.0261540
	speed: 0.0343s/iter; left time: 583.0645s
	iters: 300, epoch: 2 | loss: 0.0150766
	speed: 0.0326s/iter; left time: 551.3112s
	iters: 400, epoch: 2 | loss: 0.0167487
	speed: 0.0360s/iter; left time: 606.0696s
	iters: 500, epoch: 2 | loss: 0.0202715
	speed: 0.0336s/iter; left time: 561.2670s
	iters: 600, epoch: 2 | loss: 0.0124757
	speed: 0.0326s/iter; left time: 542.4203s
	iters: 700, epoch: 2 | loss: 0.0234306
	speed: 0.0325s/iter; left time: 536.8086s
	iters: 800, epoch: 2 | loss: 0.0192762
	speed: 0.0339s/iter; left time: 557.0487s
	iters: 900, epoch: 2 | loss: 0.0130124
	speed: 0.0371s/iter; left time: 605.7242s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.11s
Steps: 906 | Train Loss: 0.0197113 Vali Loss: 0.0220081 Test Loss: 0.0308800
Validation loss decreased (0.042940 --> 0.022008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0158460
	speed: 0.1025s/iter; left time: 1661.7703s
	iters: 200, epoch: 3 | loss: 0.0151482
	speed: 0.0334s/iter; left time: 537.9538s
	iters: 300, epoch: 3 | loss: 0.0177428
	speed: 0.0329s/iter; left time: 526.2997s
	iters: 400, epoch: 3 | loss: 0.0127546
	speed: 0.0359s/iter; left time: 571.2037s
	iters: 500, epoch: 3 | loss: 0.0152168
	speed: 0.0336s/iter; left time: 531.5048s
	iters: 600, epoch: 3 | loss: 0.0130471
	speed: 0.0318s/iter; left time: 499.9435s
	iters: 700, epoch: 3 | loss: 0.0149760
	speed: 0.0327s/iter; left time: 510.8295s
	iters: 800, epoch: 3 | loss: 0.0108637
	speed: 0.0325s/iter; left time: 503.8202s
	iters: 900, epoch: 3 | loss: 0.0151149
	speed: 0.0329s/iter; left time: 506.5198s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:30.45s
Steps: 906 | Train Loss: 0.0149118 Vali Loss: 0.0218676 Test Loss: 0.0311270
Validation loss decreased (0.022008 --> 0.021868).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0119106
	speed: 0.1149s/iter; left time: 1758.8284s
	iters: 200, epoch: 4 | loss: 0.0157133
	speed: 0.0332s/iter; left time: 505.2567s
	iters: 300, epoch: 4 | loss: 0.0150046
	speed: 0.0327s/iter; left time: 493.1885s
	iters: 400, epoch: 4 | loss: 0.0168810
	speed: 0.0328s/iter; left time: 492.3720s
	iters: 500, epoch: 4 | loss: 0.0203729
	speed: 0.0368s/iter; left time: 547.9523s
	iters: 600, epoch: 4 | loss: 0.0154422
	speed: 0.0347s/iter; left time: 513.6878s
	iters: 700, epoch: 4 | loss: 0.0118690
	speed: 0.0328s/iter; left time: 481.6657s
	iters: 800, epoch: 4 | loss: 0.0124499
	speed: 0.0328s/iter; left time: 479.6343s
	iters: 900, epoch: 4 | loss: 0.0121385
	speed: 0.0330s/iter; left time: 478.8186s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:30.91s
Steps: 906 | Train Loss: 0.0138662 Vali Loss: 0.0221879 Test Loss: 0.0294972
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0200112
	speed: 0.1002s/iter; left time: 1442.6273s
	iters: 200, epoch: 5 | loss: 0.0109799
	speed: 0.0334s/iter; left time: 476.8437s
	iters: 300, epoch: 5 | loss: 0.0117807
	speed: 0.0333s/iter; left time: 472.6238s
	iters: 400, epoch: 5 | loss: 0.0172931
	speed: 0.0329s/iter; left time: 464.0789s
	iters: 500, epoch: 5 | loss: 0.0109414
	speed: 0.0317s/iter; left time: 443.0067s
	iters: 600, epoch: 5 | loss: 0.0122645
	speed: 0.0343s/iter; left time: 476.0033s
	iters: 700, epoch: 5 | loss: 0.0151734
	speed: 0.0378s/iter; left time: 522.1190s
	iters: 800, epoch: 5 | loss: 0.0145623
	speed: 0.0339s/iter; left time: 464.9881s
	iters: 900, epoch: 5 | loss: 0.0112677
	speed: 0.0324s/iter; left time: 441.1428s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.08s
Steps: 906 | Train Loss: 0.0130095 Vali Loss: 0.0240887 Test Loss: 0.0324934
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0120146
	speed: 0.0978s/iter; left time: 1319.7265s
	iters: 200, epoch: 6 | loss: 0.0134536
	speed: 0.0364s/iter; left time: 487.1294s
	iters: 300, epoch: 6 | loss: 0.0109227
	speed: 0.0348s/iter; left time: 462.4457s
	iters: 400, epoch: 6 | loss: 0.0137217
	speed: 0.0324s/iter; left time: 427.9542s
	iters: 500, epoch: 6 | loss: 0.0131301
	speed: 0.0335s/iter; left time: 438.4563s
	iters: 600, epoch: 6 | loss: 0.0103798
	speed: 0.0325s/iter; left time: 422.7400s
	iters: 700, epoch: 6 | loss: 0.0114151
	speed: 0.0341s/iter; left time: 439.9907s
	iters: 800, epoch: 6 | loss: 0.0096706
	speed: 0.0355s/iter; left time: 453.7663s
	iters: 900, epoch: 6 | loss: 0.0158617
	speed: 0.0332s/iter; left time: 421.6472s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.19s
Steps: 906 | Train Loss: 0.0120912 Vali Loss: 0.0258931 Test Loss: 0.0350914
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0107834
	speed: 0.0948s/iter; left time: 1193.5660s
	iters: 200, epoch: 7 | loss: 0.0110156
	speed: 0.0343s/iter; left time: 427.8659s
	iters: 300, epoch: 7 | loss: 0.0107683
	speed: 0.0339s/iter; left time: 420.1432s
	iters: 400, epoch: 7 | loss: 0.0116925
	speed: 0.0339s/iter; left time: 416.6181s
	iters: 500, epoch: 7 | loss: 0.0104368
	speed: 0.0335s/iter; left time: 408.6290s
	iters: 600, epoch: 7 | loss: 0.0069574
	speed: 0.0320s/iter; left time: 386.8675s
	iters: 700, epoch: 7 | loss: 0.0106184
	speed: 0.0337s/iter; left time: 403.7701s
	iters: 800, epoch: 7 | loss: 0.0090532
	speed: 0.0395s/iter; left time: 468.8837s
	iters: 900, epoch: 7 | loss: 0.0105725
	speed: 0.0353s/iter; left time: 416.0763s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:31.55s
Steps: 906 | Train Loss: 0.0112189 Vali Loss: 0.0227329 Test Loss: 0.0320340
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0106522
	speed: 0.0991s/iter; left time: 1157.1982s
	iters: 200, epoch: 8 | loss: 0.0081547
	speed: 0.0356s/iter; left time: 412.3166s
	iters: 300, epoch: 8 | loss: 0.0101518
	speed: 0.0375s/iter; left time: 430.7536s
	iters: 400, epoch: 8 | loss: 0.0103827
	speed: 0.0348s/iter; left time: 395.7110s
	iters: 500, epoch: 8 | loss: 0.0097602
	speed: 0.0319s/iter; left time: 359.5612s
	iters: 600, epoch: 8 | loss: 0.0106588
	speed: 0.0348s/iter; left time: 388.9154s
	iters: 700, epoch: 8 | loss: 0.0106670
	speed: 0.0316s/iter; left time: 350.3074s
	iters: 800, epoch: 8 | loss: 0.0084209
	speed: 0.0306s/iter; left time: 335.8359s
	iters: 900, epoch: 8 | loss: 0.0084942
	speed: 0.0342s/iter; left time: 372.2045s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:31.14s
Steps: 906 | Train Loss: 0.0102566 Vali Loss: 0.0264436 Test Loss: 0.0365799
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_96_24_GB_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.031130269169807434, rmse:0.17643772065639496, mae:0.12031001597642899, rse:0.6083531379699707
Intermediate time for GB and pred_len 24: 00h:05m:07.85s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_96_96_GB', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_96_96_GB_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0893760
	speed: 0.0890s/iter; left time: 1600.4652s
	iters: 200, epoch: 1 | loss: 0.0699951
	speed: 0.0353s/iter; left time: 631.7274s
	iters: 300, epoch: 1 | loss: 0.0674433
	speed: 0.0370s/iter; left time: 657.6954s
	iters: 400, epoch: 1 | loss: 0.0645395
	speed: 0.0344s/iter; left time: 608.3971s
	iters: 500, epoch: 1 | loss: 0.0576673
	speed: 0.0359s/iter; left time: 631.2129s
	iters: 600, epoch: 1 | loss: 0.0536212
	speed: 0.0369s/iter; left time: 644.6308s
	iters: 700, epoch: 1 | loss: 0.0497722
	speed: 0.0355s/iter; left time: 616.4758s
	iters: 800, epoch: 1 | loss: 0.0523500
	speed: 0.0353s/iter; left time: 610.4711s
	iters: 900, epoch: 1 | loss: 0.0492230
	speed: 0.0374s/iter; left time: 642.6733s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.68s
Steps: 904 | Train Loss: 0.0649915 Vali Loss: 0.0547138 Test Loss: 0.0850027
Validation loss decreased (inf --> 0.054714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0341445
	speed: 0.1066s/iter; left time: 1821.2269s
	iters: 200, epoch: 2 | loss: 0.0328115
	speed: 0.0363s/iter; left time: 617.0372s
	iters: 300, epoch: 2 | loss: 0.0280633
	speed: 0.0364s/iter; left time: 614.5451s
	iters: 400, epoch: 2 | loss: 0.0278533
	speed: 0.0356s/iter; left time: 597.7265s
	iters: 500, epoch: 2 | loss: 0.0259066
	speed: 0.0400s/iter; left time: 666.6249s
	iters: 600, epoch: 2 | loss: 0.0295652
	speed: 0.0410s/iter; left time: 678.9570s
	iters: 700, epoch: 2 | loss: 0.0231918
	speed: 0.0354s/iter; left time: 584.1065s
	iters: 800, epoch: 2 | loss: 0.0256015
	speed: 0.0354s/iter; left time: 579.1183s
	iters: 900, epoch: 2 | loss: 0.0304700
	speed: 0.0352s/iter; left time: 573.0807s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.59s
Steps: 904 | Train Loss: 0.0301226 Vali Loss: 0.0388117 Test Loss: 0.0579192
Validation loss decreased (0.054714 --> 0.038812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0234212
	speed: 0.1133s/iter; left time: 1833.1627s
	iters: 200, epoch: 3 | loss: 0.0262930
	speed: 0.0370s/iter; left time: 594.2860s
	iters: 300, epoch: 3 | loss: 0.0239697
	speed: 0.0393s/iter; left time: 627.1740s
	iters: 400, epoch: 3 | loss: 0.0237850
	speed: 0.0374s/iter; left time: 593.8077s
	iters: 500, epoch: 3 | loss: 0.0224860
	speed: 0.0362s/iter; left time: 570.2314s
	iters: 600, epoch: 3 | loss: 0.0251826
	speed: 0.0397s/iter; left time: 622.6229s
	iters: 700, epoch: 3 | loss: 0.0222447
	speed: 0.0379s/iter; left time: 589.9097s
	iters: 800, epoch: 3 | loss: 0.0206792
	speed: 0.0352s/iter; left time: 544.3801s
	iters: 900, epoch: 3 | loss: 0.0221146
	speed: 0.0379s/iter; left time: 581.9649s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.18s
Steps: 904 | Train Loss: 0.0232364 Vali Loss: 0.0331869 Test Loss: 0.0506150
Validation loss decreased (0.038812 --> 0.033187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0239859
	speed: 0.1201s/iter; left time: 1833.1005s
	iters: 200, epoch: 4 | loss: 0.0222580
	speed: 0.0373s/iter; left time: 565.4085s
	iters: 300, epoch: 4 | loss: 0.0253674
	speed: 0.0373s/iter; left time: 562.4477s
	iters: 400, epoch: 4 | loss: 0.0194161
	speed: 0.0419s/iter; left time: 626.6843s
	iters: 500, epoch: 4 | loss: 0.0188118
	speed: 0.0406s/iter; left time: 603.6536s
	iters: 600, epoch: 4 | loss: 0.0208789
	speed: 0.0347s/iter; left time: 511.8923s
	iters: 700, epoch: 4 | loss: 0.0178792
	speed: 0.0341s/iter; left time: 500.1203s
	iters: 800, epoch: 4 | loss: 0.0212071
	speed: 0.0384s/iter; left time: 559.4364s
	iters: 900, epoch: 4 | loss: 0.0216732
	speed: 0.0377s/iter; left time: 545.2422s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.57s
Steps: 904 | Train Loss: 0.0205480 Vali Loss: 0.0346284 Test Loss: 0.0530353
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0180327
	speed: 0.1114s/iter; left time: 1599.6383s
	iters: 200, epoch: 5 | loss: 0.0200579
	speed: 0.0361s/iter; left time: 515.0310s
	iters: 300, epoch: 5 | loss: 0.0168916
	speed: 0.0371s/iter; left time: 525.8882s
	iters: 400, epoch: 5 | loss: 0.0205630
	speed: 0.0366s/iter; left time: 514.1776s
	iters: 500, epoch: 5 | loss: 0.0182274
	speed: 0.0369s/iter; left time: 515.0482s
	iters: 600, epoch: 5 | loss: 0.0207174
	speed: 0.0364s/iter; left time: 504.4256s
	iters: 700, epoch: 5 | loss: 0.0234901
	speed: 0.0371s/iter; left time: 510.9034s
	iters: 800, epoch: 5 | loss: 0.0209549
	speed: 0.0372s/iter; left time: 508.4176s
	iters: 900, epoch: 5 | loss: 0.0205995
	speed: 0.0345s/iter; left time: 468.4577s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.47s
Steps: 904 | Train Loss: 0.0186726 Vali Loss: 0.0334696 Test Loss: 0.0521068
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0173234
	speed: 0.1222s/iter; left time: 1644.4529s
	iters: 200, epoch: 6 | loss: 0.0156628
	speed: 0.0343s/iter; left time: 458.0558s
	iters: 300, epoch: 6 | loss: 0.0159969
	speed: 0.0371s/iter; left time: 491.6261s
	iters: 400, epoch: 6 | loss: 0.0178492
	speed: 0.0379s/iter; left time: 498.2209s
	iters: 500, epoch: 6 | loss: 0.0150308
	speed: 0.0372s/iter; left time: 486.0870s
	iters: 600, epoch: 6 | loss: 0.0172063
	speed: 0.0357s/iter; left time: 463.3490s
	iters: 700, epoch: 6 | loss: 0.0152361
	speed: 0.0389s/iter; left time: 500.8529s
	iters: 800, epoch: 6 | loss: 0.0163435
	speed: 0.0356s/iter; left time: 454.7557s
	iters: 900, epoch: 6 | loss: 0.0171424
	speed: 0.0365s/iter; left time: 461.8533s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:34.25s
Steps: 904 | Train Loss: 0.0166152 Vali Loss: 0.0380499 Test Loss: 0.0581647
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0139970
	speed: 0.1110s/iter; left time: 1393.2783s
	iters: 200, epoch: 7 | loss: 0.0148535
	speed: 0.0354s/iter; left time: 441.3687s
	iters: 300, epoch: 7 | loss: 0.0137906
	speed: 0.0384s/iter; left time: 474.0033s
	iters: 400, epoch: 7 | loss: 0.0162590
	speed: 0.0375s/iter; left time: 460.1537s
	iters: 500, epoch: 7 | loss: 0.0165481
	speed: 0.0358s/iter; left time: 434.7658s
	iters: 600, epoch: 7 | loss: 0.0164570
	speed: 0.0358s/iter; left time: 432.0143s
	iters: 700, epoch: 7 | loss: 0.0176711
	speed: 0.0408s/iter; left time: 487.8500s
	iters: 800, epoch: 7 | loss: 0.0125647
	speed: 0.0395s/iter; left time: 467.8862s
	iters: 900, epoch: 7 | loss: 0.0137664
	speed: 0.0377s/iter; left time: 443.7280s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.39s
Steps: 904 | Train Loss: 0.0148866 Vali Loss: 0.0356738 Test Loss: 0.0604467
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0133834
	speed: 0.1097s/iter; left time: 1277.9865s
	iters: 200, epoch: 8 | loss: 0.0131127
	speed: 0.0397s/iter; left time: 459.0377s
	iters: 300, epoch: 8 | loss: 0.0137572
	speed: 0.0386s/iter; left time: 441.5802s
	iters: 400, epoch: 8 | loss: 0.0119892
	speed: 0.0371s/iter; left time: 420.7596s
	iters: 500, epoch: 8 | loss: 0.0147413
	speed: 0.0351s/iter; left time: 394.5534s
	iters: 600, epoch: 8 | loss: 0.0135280
	speed: 0.0399s/iter; left time: 445.4019s
	iters: 700, epoch: 8 | loss: 0.0128642
	speed: 0.0363s/iter; left time: 400.7349s
	iters: 800, epoch: 8 | loss: 0.0143640
	speed: 0.0351s/iter; left time: 384.6032s
	iters: 900, epoch: 8 | loss: 0.0136676
	speed: 0.0356s/iter; left time: 385.9814s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:34.00s
Steps: 904 | Train Loss: 0.0132417 Vali Loss: 0.0376644 Test Loss: 0.0605138
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_96_96_GB_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.05061672627925873, rmse:0.22498160600662231, mae:0.1600819081068039, rse:0.7780177593231201
Intermediate time for GB and pred_len 96: 00h:05m:46.56s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_96_168_GB', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_96_168_GB_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0828232
	speed: 0.0940s/iter; left time: 1687.0031s
	iters: 200, epoch: 1 | loss: 0.0749127
	speed: 0.0583s/iter; left time: 1039.7827s
	iters: 300, epoch: 1 | loss: 0.0620970
	speed: 0.0765s/iter; left time: 1356.7755s
	iters: 400, epoch: 1 | loss: 0.0595553
	speed: 0.0761s/iter; left time: 1343.2923s
	iters: 500, epoch: 1 | loss: 0.0616825
	speed: 0.0609s/iter; left time: 1067.5064s
	iters: 600, epoch: 1 | loss: 0.0584624
	speed: 0.0646s/iter; left time: 1126.7998s
	iters: 700, epoch: 1 | loss: 0.0525494
	speed: 0.0737s/iter; left time: 1278.3715s
	iters: 800, epoch: 1 | loss: 0.0509944
	speed: 0.0730s/iter; left time: 1257.7551s
	iters: 900, epoch: 1 | loss: 0.0496514
	speed: 0.0648s/iter; left time: 1110.3270s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:02.92s
Steps: 902 | Train Loss: 0.0657342 Vali Loss: 0.0569065 Test Loss: 0.0867981
Validation loss decreased (inf --> 0.056906).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0415353
	speed: 0.1859s/iter; left time: 3167.8152s
	iters: 200, epoch: 2 | loss: 0.0353375
	speed: 0.0495s/iter; left time: 838.0543s
	iters: 300, epoch: 2 | loss: 0.0351734
	speed: 0.0619s/iter; left time: 1042.4786s
	iters: 400, epoch: 2 | loss: 0.0284817
	speed: 0.0595s/iter; left time: 996.4829s
	iters: 500, epoch: 2 | loss: 0.0283058
	speed: 0.0610s/iter; left time: 1014.1560s
	iters: 600, epoch: 2 | loss: 0.0289276
	speed: 0.0709s/iter; left time: 1172.4229s
	iters: 700, epoch: 2 | loss: 0.0289890
	speed: 0.0597s/iter; left time: 981.7381s
	iters: 800, epoch: 2 | loss: 0.0284246
	speed: 0.0603s/iter; left time: 985.5887s
	iters: 900, epoch: 2 | loss: 0.0308674
	speed: 0.0676s/iter; left time: 1097.9624s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:54.22s
Steps: 902 | Train Loss: 0.0330005 Vali Loss: 0.0403766 Test Loss: 0.0631403
Validation loss decreased (0.056906 --> 0.040377).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0281291
	speed: 0.2374s/iter; left time: 3831.2092s
	iters: 200, epoch: 3 | loss: 0.0253809
	speed: 0.0672s/iter; left time: 1077.3620s
	iters: 300, epoch: 3 | loss: 0.0304348
	speed: 0.0613s/iter; left time: 977.0379s
	iters: 400, epoch: 3 | loss: 0.0270059
	speed: 0.0652s/iter; left time: 1032.7159s
	iters: 500, epoch: 3 | loss: 0.0259681
	speed: 0.0676s/iter; left time: 1063.8254s
	iters: 600, epoch: 3 | loss: 0.0313333
	speed: 0.0629s/iter; left time: 983.2662s
	iters: 700, epoch: 3 | loss: 0.0257676
	speed: 0.0581s/iter; left time: 903.0328s
	iters: 800, epoch: 3 | loss: 0.0252682
	speed: 0.0747s/iter; left time: 1153.7661s
	iters: 900, epoch: 3 | loss: 0.0248985
	speed: 0.0580s/iter; left time: 889.6014s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:58.65s
Steps: 902 | Train Loss: 0.0268744 Vali Loss: 0.0439434 Test Loss: 0.0653365
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0279412
	speed: 0.2363s/iter; left time: 3599.4929s
	iters: 200, epoch: 4 | loss: 0.0242079
	speed: 0.0591s/iter; left time: 894.1670s
	iters: 300, epoch: 4 | loss: 0.0269835
	speed: 0.0691s/iter; left time: 1039.1803s
	iters: 400, epoch: 4 | loss: 0.0255507
	speed: 0.0643s/iter; left time: 959.9342s
	iters: 500, epoch: 4 | loss: 0.0225070
	speed: 0.0615s/iter; left time: 911.7824s
	iters: 600, epoch: 4 | loss: 0.0230421
	speed: 0.0593s/iter; left time: 873.1800s
	iters: 700, epoch: 4 | loss: 0.0248679
	speed: 0.0755s/iter; left time: 1105.1853s
	iters: 800, epoch: 4 | loss: 0.0225724
	speed: 0.0589s/iter; left time: 855.9364s
	iters: 900, epoch: 4 | loss: 0.0205266
	speed: 0.0608s/iter; left time: 878.2315s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:57.81s
Steps: 902 | Train Loss: 0.0245145 Vali Loss: 0.0396597 Test Loss: 0.0621735
Validation loss decreased (0.040377 --> 0.039660).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0214768
	speed: 0.2413s/iter; left time: 3458.7244s
	iters: 200, epoch: 5 | loss: 0.0234881
	speed: 0.0667s/iter; left time: 948.9383s
	iters: 300, epoch: 5 | loss: 0.0215285
	speed: 0.0667s/iter; left time: 942.9494s
	iters: 400, epoch: 5 | loss: 0.0217437
	speed: 0.0488s/iter; left time: 684.8049s
	iters: 500, epoch: 5 | loss: 0.0214513
	speed: 0.0480s/iter; left time: 669.0579s
	iters: 600, epoch: 5 | loss: 0.0207977
	speed: 0.0536s/iter; left time: 741.1752s
	iters: 700, epoch: 5 | loss: 0.0178466
	speed: 0.0635s/iter; left time: 872.1859s
	iters: 800, epoch: 5 | loss: 0.0219532
	speed: 0.0597s/iter; left time: 814.2188s
	iters: 900, epoch: 5 | loss: 0.0201745
	speed: 0.0626s/iter; left time: 846.9751s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:53.43s
Steps: 902 | Train Loss: 0.0214388 Vali Loss: 0.0403047 Test Loss: 0.0659283
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0192441
	speed: 0.2269s/iter; left time: 3047.5116s
	iters: 200, epoch: 6 | loss: 0.0194779
	speed: 0.0598s/iter; left time: 796.6182s
	iters: 300, epoch: 6 | loss: 0.0164167
	speed: 0.0629s/iter; left time: 832.8238s
	iters: 400, epoch: 6 | loss: 0.0161506
	speed: 0.0628s/iter; left time: 824.2074s
	iters: 500, epoch: 6 | loss: 0.0196075
	speed: 0.0609s/iter; left time: 793.4357s
	iters: 600, epoch: 6 | loss: 0.0166038
	speed: 0.0624s/iter; left time: 806.8177s
	iters: 700, epoch: 6 | loss: 0.0136157
	speed: 0.0640s/iter; left time: 820.9817s
	iters: 800, epoch: 6 | loss: 0.0160816
	speed: 0.0600s/iter; left time: 763.5863s
	iters: 900, epoch: 6 | loss: 0.0160592
	speed: 0.0590s/iter; left time: 744.6866s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:55.54s
Steps: 902 | Train Loss: 0.0170734 Vali Loss: 0.0388602 Test Loss: 0.0664243
Validation loss decreased (0.039660 --> 0.038860).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0169348
	speed: 0.2222s/iter; left time: 2784.4466s
	iters: 200, epoch: 7 | loss: 0.0150197
	speed: 0.0596s/iter; left time: 741.0774s
	iters: 300, epoch: 7 | loss: 0.0177164
	speed: 0.0533s/iter; left time: 656.8524s
	iters: 400, epoch: 7 | loss: 0.0144806
	speed: 0.0598s/iter; left time: 731.5548s
	iters: 500, epoch: 7 | loss: 0.0147240
	speed: 0.0590s/iter; left time: 716.1321s
	iters: 600, epoch: 7 | loss: 0.0131048
	speed: 0.0551s/iter; left time: 662.9405s
	iters: 700, epoch: 7 | loss: 0.0154541
	speed: 0.0537s/iter; left time: 641.0155s
	iters: 800, epoch: 7 | loss: 0.0132857
	speed: 0.0591s/iter; left time: 699.3555s
	iters: 900, epoch: 7 | loss: 0.0172589
	speed: 0.0562s/iter; left time: 659.3353s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:51.92s
Steps: 902 | Train Loss: 0.0149902 Vali Loss: 0.0377542 Test Loss: 0.0672273
Validation loss decreased (0.038860 --> 0.037754).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0124112
	speed: 0.2127s/iter; left time: 2472.9848s
	iters: 200, epoch: 8 | loss: 0.0133382
	speed: 0.0589s/iter; left time: 678.5519s
	iters: 300, epoch: 8 | loss: 0.0144903
	speed: 0.0543s/iter; left time: 620.8336s
	iters: 400, epoch: 8 | loss: 0.0129757
	speed: 0.0560s/iter; left time: 633.8268s
	iters: 500, epoch: 8 | loss: 0.0129781
	speed: 0.0501s/iter; left time: 562.5969s
	iters: 600, epoch: 8 | loss: 0.0131203
	speed: 0.0585s/iter; left time: 650.8065s
	iters: 700, epoch: 8 | loss: 0.0113418
	speed: 0.0575s/iter; left time: 634.1865s
	iters: 800, epoch: 8 | loss: 0.0117694
	speed: 0.0530s/iter; left time: 578.9685s
	iters: 900, epoch: 8 | loss: 0.0125589
	speed: 0.0528s/iter; left time: 571.6851s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:49.93s
Steps: 902 | Train Loss: 0.0136115 Vali Loss: 0.0394928 Test Loss: 0.0707811
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0127657
	speed: 0.2052s/iter; left time: 2200.9914s
	iters: 200, epoch: 9 | loss: 0.0124597
	speed: 0.0584s/iter; left time: 620.5246s
	iters: 300, epoch: 9 | loss: 0.0134299
	speed: 0.0511s/iter; left time: 538.0723s
	iters: 400, epoch: 9 | loss: 0.0110699
	speed: 0.0564s/iter; left time: 588.4007s
	iters: 500, epoch: 9 | loss: 0.0132655
	speed: 0.0568s/iter; left time: 586.7083s
	iters: 600, epoch: 9 | loss: 0.0112603
	speed: 0.0544s/iter; left time: 556.6322s
	iters: 700, epoch: 9 | loss: 0.0130516
	speed: 0.0547s/iter; left time: 554.1436s
	iters: 800, epoch: 9 | loss: 0.0126161
	speed: 0.0520s/iter; left time: 521.2077s
	iters: 900, epoch: 9 | loss: 0.0119859
	speed: 0.0601s/iter; left time: 595.9974s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:49.91s
Steps: 902 | Train Loss: 0.0123658 Vali Loss: 0.0383595 Test Loss: 0.0662519
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0107819
	speed: 0.2077s/iter; left time: 2040.0214s
	iters: 200, epoch: 10 | loss: 0.0127241
	speed: 0.0590s/iter; left time: 574.0561s
	iters: 300, epoch: 10 | loss: 0.0123100
	speed: 0.0543s/iter; left time: 522.4042s
	iters: 400, epoch: 10 | loss: 0.0109170
	speed: 0.0593s/iter; left time: 564.8281s
	iters: 500, epoch: 10 | loss: 0.0114692
	speed: 0.0560s/iter; left time: 527.7626s
	iters: 600, epoch: 10 | loss: 0.0110846
	speed: 0.0552s/iter; left time: 514.3282s
	iters: 700, epoch: 10 | loss: 0.0117878
	speed: 0.0591s/iter; left time: 545.1368s
	iters: 800, epoch: 10 | loss: 0.0111483
	speed: 0.0543s/iter; left time: 495.7798s
	iters: 900, epoch: 10 | loss: 0.0121212
	speed: 0.0466s/iter; left time: 420.1667s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:50.50s
Steps: 902 | Train Loss: 0.0112837 Vali Loss: 0.0393359 Test Loss: 0.0676974
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0106947
	speed: 0.1719s/iter; left time: 1533.6289s
	iters: 200, epoch: 11 | loss: 0.0114429
	speed: 0.0659s/iter; left time: 581.0995s
	iters: 300, epoch: 11 | loss: 0.0102906
	speed: 0.0583s/iter; left time: 508.2840s
	iters: 400, epoch: 11 | loss: 0.0102502
	speed: 0.0627s/iter; left time: 540.9003s
	iters: 500, epoch: 11 | loss: 0.0127098
	speed: 0.0571s/iter; left time: 486.2570s
	iters: 600, epoch: 11 | loss: 0.0100624
	speed: 0.0602s/iter; left time: 506.6048s
	iters: 700, epoch: 11 | loss: 0.0098379
	speed: 0.0580s/iter; left time: 482.4003s
	iters: 800, epoch: 11 | loss: 0.0095954
	speed: 0.0608s/iter; left time: 500.2441s
	iters: 900, epoch: 11 | loss: 0.0092578
	speed: 0.0633s/iter; left time: 514.1071s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:54.45s
Steps: 902 | Train Loss: 0.0103650 Vali Loss: 0.0400552 Test Loss: 0.0669268
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0088414
	speed: 0.2134s/iter; left time: 1711.1095s
	iters: 200, epoch: 12 | loss: 0.0110274
	speed: 0.0509s/iter; left time: 403.3595s
	iters: 300, epoch: 12 | loss: 0.0086307
	speed: 0.0469s/iter; left time: 366.9381s
	iters: 400, epoch: 12 | loss: 0.0093599
	speed: 0.0633s/iter; left time: 488.9164s
	iters: 500, epoch: 12 | loss: 0.0102409
	speed: 0.0534s/iter; left time: 407.1776s
	iters: 600, epoch: 12 | loss: 0.0096047
	speed: 0.0603s/iter; left time: 453.0206s
	iters: 700, epoch: 12 | loss: 0.0099307
	speed: 0.0706s/iter; left time: 524.1401s
	iters: 800, epoch: 12 | loss: 0.0111330
	speed: 0.0614s/iter; left time: 449.0882s
	iters: 900, epoch: 12 | loss: 0.0091989
	speed: 0.0565s/iter; left time: 407.9592s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:52.76s
Steps: 902 | Train Loss: 0.0096406 Vali Loss: 0.0401528 Test Loss: 0.0665900
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_96_168_GB_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.06714829802513123, rmse:0.2591298818588257, mae:0.18294008076190948, rse:0.8983698487281799
Intermediate time for GB and pred_len 168: 00h:14m:09.79sIntermediate time for GB: 00h:25m:04.20s
=== Starting experiments for country: ES ===

=== Starting experiments for pred_len: 24 ===

--- Running model for ES, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_96_24_ES', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_96_24_ES_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0857679
	speed: 0.0440s/iter; left time: 792.6031s
	iters: 200, epoch: 1 | loss: 0.0807853
	speed: 0.0263s/iter; left time: 471.0709s
	iters: 300, epoch: 1 | loss: 0.0553400
	speed: 0.0292s/iter; left time: 520.9487s
	iters: 400, epoch: 1 | loss: 0.0538047
	speed: 0.0293s/iter; left time: 519.2219s
	iters: 500, epoch: 1 | loss: 0.0488718
	speed: 0.0275s/iter; left time: 483.8720s
	iters: 600, epoch: 1 | loss: 0.0414990
	speed: 0.0258s/iter; left time: 452.0399s
	iters: 700, epoch: 1 | loss: 0.0401268
	speed: 0.0286s/iter; left time: 499.0068s
	iters: 800, epoch: 1 | loss: 0.0366052
	speed: 0.0256s/iter; left time: 444.0711s
	iters: 900, epoch: 1 | loss: 0.0330763
	speed: 0.0278s/iter; left time: 479.4301s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.76s
Steps: 906 | Train Loss: 0.0567425 Vali Loss: 0.0218313 Test Loss: 0.0343488
Validation loss decreased (inf --> 0.021831).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0236104
	speed: 0.0970s/iter; left time: 1660.0509s
	iters: 200, epoch: 2 | loss: 0.0223391
	speed: 0.0264s/iter; left time: 449.4381s
	iters: 300, epoch: 2 | loss: 0.0169560
	speed: 0.0258s/iter; left time: 435.7617s
	iters: 400, epoch: 2 | loss: 0.0164908
	speed: 0.0261s/iter; left time: 439.6817s
	iters: 500, epoch: 2 | loss: 0.0154636
	speed: 0.0275s/iter; left time: 459.9297s
	iters: 600, epoch: 2 | loss: 0.0176749
	speed: 0.0276s/iter; left time: 458.2161s
	iters: 700, epoch: 2 | loss: 0.0140468
	speed: 0.0282s/iter; left time: 465.8257s
	iters: 800, epoch: 2 | loss: 0.0139205
	speed: 0.0292s/iter; left time: 478.6710s
	iters: 900, epoch: 2 | loss: 0.0108507
	speed: 0.0286s/iter; left time: 466.0723s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.24s
Steps: 906 | Train Loss: 0.0172144 Vali Loss: 0.0128167 Test Loss: 0.0295072
Validation loss decreased (0.021831 --> 0.012817).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0121302
	speed: 0.0845s/iter; left time: 1370.4653s
	iters: 200, epoch: 3 | loss: 0.0131790
	speed: 0.0270s/iter; left time: 435.1248s
	iters: 300, epoch: 3 | loss: 0.0119967
	speed: 0.0269s/iter; left time: 430.3373s
	iters: 400, epoch: 3 | loss: 0.0101148
	speed: 0.0277s/iter; left time: 440.4781s
	iters: 500, epoch: 3 | loss: 0.0126973
	speed: 0.0275s/iter; left time: 434.4107s
	iters: 600, epoch: 3 | loss: 0.0094017
	speed: 0.0278s/iter; left time: 436.3351s
	iters: 700, epoch: 3 | loss: 0.0109511
	speed: 0.0273s/iter; left time: 426.7283s
	iters: 800, epoch: 3 | loss: 0.0129451
	speed: 0.0257s/iter; left time: 399.3274s
	iters: 900, epoch: 3 | loss: 0.0106098
	speed: 0.0269s/iter; left time: 414.4546s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.96s
Steps: 906 | Train Loss: 0.0110201 Vali Loss: 0.0114797 Test Loss: 0.0272940
Validation loss decreased (0.012817 --> 0.011480).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0107610
	speed: 0.0820s/iter; left time: 1255.4961s
	iters: 200, epoch: 4 | loss: 0.0116187
	speed: 0.0300s/iter; left time: 456.7480s
	iters: 300, epoch: 4 | loss: 0.0090415
	speed: 0.0267s/iter; left time: 403.5439s
	iters: 400, epoch: 4 | loss: 0.0098316
	speed: 0.0258s/iter; left time: 386.5591s
	iters: 500, epoch: 4 | loss: 0.0075964
	speed: 0.0281s/iter; left time: 418.6949s
	iters: 600, epoch: 4 | loss: 0.0088572
	speed: 0.0251s/iter; left time: 371.7086s
	iters: 700, epoch: 4 | loss: 0.0112044
	speed: 0.0268s/iter; left time: 394.2140s
	iters: 800, epoch: 4 | loss: 0.0099376
	speed: 0.0270s/iter; left time: 394.9372s
	iters: 900, epoch: 4 | loss: 0.0107191
	speed: 0.0285s/iter; left time: 412.9988s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.27s
Steps: 906 | Train Loss: 0.0096495 Vali Loss: 0.0106362 Test Loss: 0.0251008
Validation loss decreased (0.011480 --> 0.010636).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0096470
	speed: 0.0909s/iter; left time: 1308.1322s
	iters: 200, epoch: 5 | loss: 0.0094309
	speed: 0.0268s/iter; left time: 382.9182s
	iters: 300, epoch: 5 | loss: 0.0075118
	speed: 0.0283s/iter; left time: 401.2549s
	iters: 400, epoch: 5 | loss: 0.0097770
	speed: 0.0263s/iter; left time: 370.2591s
	iters: 500, epoch: 5 | loss: 0.0081016
	speed: 0.0281s/iter; left time: 393.7292s
	iters: 600, epoch: 5 | loss: 0.0088815
	speed: 0.0308s/iter; left time: 427.9773s
	iters: 700, epoch: 5 | loss: 0.0106172
	speed: 0.0300s/iter; left time: 414.0815s
	iters: 800, epoch: 5 | loss: 0.0077928
	speed: 0.0264s/iter; left time: 361.5377s
	iters: 900, epoch: 5 | loss: 0.0090509
	speed: 0.0274s/iter; left time: 372.7753s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.65s
Steps: 906 | Train Loss: 0.0087972 Vali Loss: 0.0097689 Test Loss: 0.0239744
Validation loss decreased (0.010636 --> 0.009769).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0091501
	speed: 0.0852s/iter; left time: 1148.8839s
	iters: 200, epoch: 6 | loss: 0.0064490
	speed: 0.0305s/iter; left time: 408.4833s
	iters: 300, epoch: 6 | loss: 0.0077124
	speed: 0.0330s/iter; left time: 439.1970s
	iters: 400, epoch: 6 | loss: 0.0087460
	speed: 0.0324s/iter; left time: 427.0396s
	iters: 500, epoch: 6 | loss: 0.0080305
	speed: 0.0325s/iter; left time: 425.0831s
	iters: 600, epoch: 6 | loss: 0.0103331
	speed: 0.0321s/iter; left time: 416.6597s
	iters: 700, epoch: 6 | loss: 0.0072778
	speed: 0.0320s/iter; left time: 412.6148s
	iters: 800, epoch: 6 | loss: 0.0095548
	speed: 0.0358s/iter; left time: 457.8767s
	iters: 900, epoch: 6 | loss: 0.0093930
	speed: 0.0359s/iter; left time: 455.9414s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:30.17s
Steps: 906 | Train Loss: 0.0081579 Vali Loss: 0.0109167 Test Loss: 0.0256032
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0074642
	speed: 0.0976s/iter; left time: 1227.8833s
	iters: 200, epoch: 7 | loss: 0.0078414
	speed: 0.0311s/iter; left time: 388.0548s
	iters: 300, epoch: 7 | loss: 0.0074884
	speed: 0.0335s/iter; left time: 415.2346s
	iters: 400, epoch: 7 | loss: 0.0082921
	speed: 0.0377s/iter; left time: 463.6036s
	iters: 500, epoch: 7 | loss: 0.0081943
	speed: 0.0353s/iter; left time: 430.4170s
	iters: 600, epoch: 7 | loss: 0.0072786
	speed: 0.0311s/iter; left time: 375.3918s
	iters: 700, epoch: 7 | loss: 0.0069414
	speed: 0.0315s/iter; left time: 377.3526s
	iters: 800, epoch: 7 | loss: 0.0066637
	speed: 0.0317s/iter; left time: 376.2685s
	iters: 900, epoch: 7 | loss: 0.0079832
	speed: 0.0321s/iter; left time: 378.8581s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:30.41s
Steps: 906 | Train Loss: 0.0076666 Vali Loss: 0.0096232 Test Loss: 0.0262587
Validation loss decreased (0.009769 --> 0.009623).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0069152
	speed: 0.1117s/iter; left time: 1305.1047s
	iters: 200, epoch: 8 | loss: 0.0064987
	speed: 0.0326s/iter; left time: 377.2986s
	iters: 300, epoch: 8 | loss: 0.0070823
	speed: 0.0325s/iter; left time: 372.9281s
	iters: 400, epoch: 8 | loss: 0.0069094
	speed: 0.0328s/iter; left time: 372.9548s
	iters: 500, epoch: 8 | loss: 0.0070434
	speed: 0.0330s/iter; left time: 372.3254s
	iters: 600, epoch: 8 | loss: 0.0063723
	speed: 0.0345s/iter; left time: 385.1761s
	iters: 700, epoch: 8 | loss: 0.0084175
	speed: 0.0319s/iter; left time: 353.6095s
	iters: 800, epoch: 8 | loss: 0.0076559
	speed: 0.0326s/iter; left time: 357.4149s
	iters: 900, epoch: 8 | loss: 0.0077767
	speed: 0.0335s/iter; left time: 364.8199s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:30.35s
Steps: 906 | Train Loss: 0.0071775 Vali Loss: 0.0098634 Test Loss: 0.0328440
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0059583
	speed: 0.0977s/iter; left time: 1052.2104s
	iters: 200, epoch: 9 | loss: 0.0067932
	speed: 0.0330s/iter; left time: 352.0814s
	iters: 300, epoch: 9 | loss: 0.0063904
	speed: 0.0331s/iter; left time: 349.9304s
	iters: 400, epoch: 9 | loss: 0.0078322
	speed: 0.0341s/iter; left time: 357.0860s
	iters: 500, epoch: 9 | loss: 0.0069900
	speed: 0.0316s/iter; left time: 327.8151s
	iters: 600, epoch: 9 | loss: 0.0074752
	speed: 0.0308s/iter; left time: 315.9255s
	iters: 700, epoch: 9 | loss: 0.0064412
	speed: 0.0308s/iter; left time: 312.9351s
	iters: 800, epoch: 9 | loss: 0.0069325
	speed: 0.0338s/iter; left time: 340.1513s
	iters: 900, epoch: 9 | loss: 0.0047393
	speed: 0.0335s/iter; left time: 333.9166s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:30.14s
Steps: 906 | Train Loss: 0.0067945 Vali Loss: 0.0092748 Test Loss: 0.0247219
Validation loss decreased (0.009623 --> 0.009275).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0068811
	speed: 0.0990s/iter; left time: 976.8156s
	iters: 200, epoch: 10 | loss: 0.0062535
	speed: 0.0352s/iter; left time: 343.5092s
	iters: 300, epoch: 10 | loss: 0.0066703
	speed: 0.0371s/iter; left time: 358.5688s
	iters: 400, epoch: 10 | loss: 0.0085733
	speed: 0.0336s/iter; left time: 321.7765s
	iters: 500, epoch: 10 | loss: 0.0066388
	speed: 0.0311s/iter; left time: 294.8764s
	iters: 600, epoch: 10 | loss: 0.0059668
	speed: 0.0322s/iter; left time: 301.6838s
	iters: 700, epoch: 10 | loss: 0.0079732
	speed: 0.0337s/iter; left time: 311.8872s
	iters: 800, epoch: 10 | loss: 0.0046471
	speed: 0.0347s/iter; left time: 317.9309s
	iters: 900, epoch: 10 | loss: 0.0063734
	speed: 0.0345s/iter; left time: 312.3733s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:31.26s
Steps: 906 | Train Loss: 0.0063905 Vali Loss: 0.0091948 Test Loss: 0.0303363
Validation loss decreased (0.009275 --> 0.009195).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0062151
	speed: 0.1037s/iter; left time: 928.8390s
	iters: 200, epoch: 11 | loss: 0.0057975
	speed: 0.0353s/iter; left time: 313.0500s
	iters: 300, epoch: 11 | loss: 0.0060051
	speed: 0.0332s/iter; left time: 291.0262s
	iters: 400, epoch: 11 | loss: 0.0057208
	speed: 0.0342s/iter; left time: 296.2042s
	iters: 500, epoch: 11 | loss: 0.0063676
	speed: 0.0336s/iter; left time: 287.3652s
	iters: 600, epoch: 11 | loss: 0.0069670
	speed: 0.0345s/iter; left time: 291.6189s
	iters: 700, epoch: 11 | loss: 0.0049594
	speed: 0.0331s/iter; left time: 277.0729s
	iters: 800, epoch: 11 | loss: 0.0060550
	speed: 0.0323s/iter; left time: 267.2256s
	iters: 900, epoch: 11 | loss: 0.0063580
	speed: 0.0348s/iter; left time: 283.9509s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.00s
Steps: 906 | Train Loss: 0.0061548 Vali Loss: 0.0094559 Test Loss: 0.0314645
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0077157
	speed: 0.1027s/iter; left time: 827.3844s
	iters: 200, epoch: 12 | loss: 0.0057735
	speed: 0.0362s/iter; left time: 287.8489s
	iters: 300, epoch: 12 | loss: 0.0053997
	speed: 0.0408s/iter; left time: 320.3952s
	iters: 400, epoch: 12 | loss: 0.0082485
	speed: 0.0447s/iter; left time: 346.9352s
	iters: 500, epoch: 12 | loss: 0.0067849
	speed: 0.0323s/iter; left time: 246.9750s
	iters: 600, epoch: 12 | loss: 0.0046099
	speed: 0.0305s/iter; left time: 230.3371s
	iters: 700, epoch: 12 | loss: 0.0044747
	speed: 0.0327s/iter; left time: 243.7367s
	iters: 800, epoch: 12 | loss: 0.0054506
	speed: 0.0316s/iter; left time: 232.5769s
	iters: 900, epoch: 12 | loss: 0.0053148
	speed: 0.0355s/iter; left time: 257.3868s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:32.83s
Steps: 906 | Train Loss: 0.0057593 Vali Loss: 0.0099598 Test Loss: 0.0384844
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0054433
	speed: 0.1002s/iter; left time: 716.3370s
	iters: 200, epoch: 13 | loss: 0.0058109
	speed: 0.0316s/iter; left time: 223.0693s
	iters: 300, epoch: 13 | loss: 0.0062376
	speed: 0.0321s/iter; left time: 223.0013s
	iters: 400, epoch: 13 | loss: 0.0048624
	speed: 0.0314s/iter; left time: 214.9900s
	iters: 500, epoch: 13 | loss: 0.0055492
	speed: 0.0328s/iter; left time: 221.1479s
	iters: 600, epoch: 13 | loss: 0.0049843
	speed: 0.0328s/iter; left time: 217.8897s
	iters: 700, epoch: 13 | loss: 0.0053882
	speed: 0.0329s/iter; left time: 215.3787s
	iters: 800, epoch: 13 | loss: 0.0060933
	speed: 0.0353s/iter; left time: 227.9628s
	iters: 900, epoch: 13 | loss: 0.0047877
	speed: 0.0316s/iter; left time: 200.8906s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:29.88s
Steps: 906 | Train Loss: 0.0054440 Vali Loss: 0.0095827 Test Loss: 0.0370335
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0048743
	speed: 0.0940s/iter; left time: 587.0656s
	iters: 200, epoch: 14 | loss: 0.0055140
	speed: 0.0357s/iter; left time: 219.1526s
	iters: 300, epoch: 14 | loss: 0.0043491
	speed: 0.0362s/iter; left time: 218.5411s
	iters: 400, epoch: 14 | loss: 0.0053514
	speed: 0.0334s/iter; left time: 198.4606s
	iters: 500, epoch: 14 | loss: 0.0046246
	speed: 0.0315s/iter; left time: 184.0991s
	iters: 600, epoch: 14 | loss: 0.0043639
	speed: 0.0319s/iter; left time: 183.2888s
	iters: 700, epoch: 14 | loss: 0.0058698
	speed: 0.0322s/iter; left time: 181.8568s
	iters: 800, epoch: 14 | loss: 0.0070508
	speed: 0.0340s/iter; left time: 188.2183s
	iters: 900, epoch: 14 | loss: 0.0055367
	speed: 0.0333s/iter; left time: 181.2321s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:30.61s
Steps: 906 | Train Loss: 0.0051721 Vali Loss: 0.0094972 Test Loss: 0.0370448
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0048664
	speed: 0.0982s/iter; left time: 524.2248s
	iters: 200, epoch: 15 | loss: 0.0045329
	speed: 0.0320s/iter; left time: 167.5370s
	iters: 300, epoch: 15 | loss: 0.0051289
	speed: 0.0330s/iter; left time: 169.7455s
	iters: 400, epoch: 15 | loss: 0.0048189
	speed: 0.0313s/iter; left time: 157.8040s
	iters: 500, epoch: 15 | loss: 0.0052685
	speed: 0.0318s/iter; left time: 156.8851s
	iters: 600, epoch: 15 | loss: 0.0050529
	speed: 0.0329s/iter; left time: 159.3255s
	iters: 700, epoch: 15 | loss: 0.0045252
	speed: 0.0330s/iter; left time: 156.5202s
	iters: 800, epoch: 15 | loss: 0.0036254
	speed: 0.0329s/iter; left time: 152.6523s
	iters: 900, epoch: 15 | loss: 0.0046330
	speed: 0.0321s/iter; left time: 145.6334s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:29.80s
Steps: 906 | Train Loss: 0.0049421 Vali Loss: 0.0096856 Test Loss: 0.0405013
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_96_24_ES_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.03036285936832428, rmse:0.17424941062927246, mae:0.10449937731027603, rse:0.5119974613189697
Intermediate time for ES and pred_len 24: 00h:08m:51.92s
=== Starting experiments for pred_len: 96 ===

--- Running model for ES, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_96_96_ES', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_96_96_ES_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1013976
	speed: 0.0739s/iter; left time: 1329.3030s
	iters: 200, epoch: 1 | loss: 0.0771578
	speed: 0.0389s/iter; left time: 695.0236s
	iters: 300, epoch: 1 | loss: 0.0797359
	speed: 0.0348s/iter; left time: 618.2741s
	iters: 400, epoch: 1 | loss: 0.0694062
	speed: 0.0362s/iter; left time: 639.2349s
	iters: 500, epoch: 1 | loss: 0.0591974
	speed: 0.0351s/iter; left time: 617.2378s
	iters: 600, epoch: 1 | loss: 0.0565173
	speed: 0.0362s/iter; left time: 633.2192s
	iters: 700, epoch: 1 | loss: 0.0575356
	speed: 0.0380s/iter; left time: 660.0583s
	iters: 800, epoch: 1 | loss: 0.0524184
	speed: 0.0356s/iter; left time: 615.0854s
	iters: 900, epoch: 1 | loss: 0.0508521
	speed: 0.0366s/iter; left time: 629.2359s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.01s
Steps: 904 | Train Loss: 0.0714525 Vali Loss: 0.0426748 Test Loss: 0.0774080
Validation loss decreased (inf --> 0.042675).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0342556
	speed: 0.1143s/iter; left time: 1952.5424s
	iters: 200, epoch: 2 | loss: 0.0295202
	speed: 0.0349s/iter; left time: 593.2911s
	iters: 300, epoch: 2 | loss: 0.0292581
	speed: 0.0350s/iter; left time: 590.8787s
	iters: 400, epoch: 2 | loss: 0.0218068
	speed: 0.0402s/iter; left time: 673.6128s
	iters: 500, epoch: 2 | loss: 0.0203914
	speed: 0.0398s/iter; left time: 662.9595s
	iters: 600, epoch: 2 | loss: 0.0206816
	speed: 0.0354s/iter; left time: 587.2539s
	iters: 700, epoch: 2 | loss: 0.0191458
	speed: 0.0361s/iter; left time: 594.4477s
	iters: 800, epoch: 2 | loss: 0.0165509
	speed: 0.0359s/iter; left time: 588.2600s
	iters: 900, epoch: 2 | loss: 0.0190492
	speed: 0.0346s/iter; left time: 563.9956s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.41s
Steps: 904 | Train Loss: 0.0254755 Vali Loss: 0.0198806 Test Loss: 0.0384178
Validation loss decreased (0.042675 --> 0.019881).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0185786
	speed: 0.1099s/iter; left time: 1776.8290s
	iters: 200, epoch: 3 | loss: 0.0157663
	speed: 0.0384s/iter; left time: 617.6594s
	iters: 300, epoch: 3 | loss: 0.0181196
	speed: 0.0353s/iter; left time: 564.4243s
	iters: 400, epoch: 3 | loss: 0.0181286
	speed: 0.0357s/iter; left time: 566.4197s
	iters: 500, epoch: 3 | loss: 0.0144538
	speed: 0.0361s/iter; left time: 569.2958s
	iters: 600, epoch: 3 | loss: 0.0161840
	speed: 0.0379s/iter; left time: 594.0816s
	iters: 700, epoch: 3 | loss: 0.0171365
	speed: 0.0372s/iter; left time: 579.3469s
	iters: 800, epoch: 3 | loss: 0.0168469
	speed: 0.0355s/iter; left time: 548.8587s
	iters: 900, epoch: 3 | loss: 0.0152578
	speed: 0.0368s/iter; left time: 566.0448s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.60s
Steps: 904 | Train Loss: 0.0169028 Vali Loss: 0.0177613 Test Loss: 0.0432140
Validation loss decreased (0.019881 --> 0.017761).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0139807
	speed: 0.1156s/iter; left time: 1764.6867s
	iters: 200, epoch: 4 | loss: 0.0142875
	speed: 0.0371s/iter; left time: 562.8297s
	iters: 300, epoch: 4 | loss: 0.0153466
	speed: 0.0365s/iter; left time: 550.6426s
	iters: 400, epoch: 4 | loss: 0.0136019
	speed: 0.0378s/iter; left time: 565.5678s
	iters: 500, epoch: 4 | loss: 0.0160778
	speed: 0.0380s/iter; left time: 565.2504s
	iters: 600, epoch: 4 | loss: 0.0141800
	speed: 0.0352s/iter; left time: 519.9266s
	iters: 700, epoch: 4 | loss: 0.0135171
	speed: 0.0367s/iter; left time: 538.5034s
	iters: 800, epoch: 4 | loss: 0.0128371
	speed: 0.0357s/iter; left time: 519.4828s
	iters: 900, epoch: 4 | loss: 0.0160632
	speed: 0.0387s/iter; left time: 559.5821s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.96s
Steps: 904 | Train Loss: 0.0154550 Vali Loss: 0.0175591 Test Loss: 0.0405319
Validation loss decreased (0.017761 --> 0.017559).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0152498
	speed: 0.1116s/iter; left time: 1603.0667s
	iters: 200, epoch: 5 | loss: 0.0144196
	speed: 0.0339s/iter; left time: 482.9221s
	iters: 300, epoch: 5 | loss: 0.0148976
	speed: 0.0347s/iter; left time: 491.2748s
	iters: 400, epoch: 5 | loss: 0.0138593
	speed: 0.0345s/iter; left time: 485.3613s
	iters: 500, epoch: 5 | loss: 0.0134832
	speed: 0.0383s/iter; left time: 534.3952s
	iters: 600, epoch: 5 | loss: 0.0133692
	speed: 0.0350s/iter; left time: 485.7507s
	iters: 700, epoch: 5 | loss: 0.0127165
	speed: 0.0346s/iter; left time: 476.9180s
	iters: 800, epoch: 5 | loss: 0.0143193
	speed: 0.0356s/iter; left time: 486.0689s
	iters: 900, epoch: 5 | loss: 0.0145045
	speed: 0.0369s/iter; left time: 500.7456s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:32.33s
Steps: 904 | Train Loss: 0.0142620 Vali Loss: 0.0170134 Test Loss: 0.0450900
Validation loss decreased (0.017559 --> 0.017013).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0141830
	speed: 0.1128s/iter; left time: 1518.8698s
	iters: 200, epoch: 6 | loss: 0.0146969
	speed: 0.0366s/iter; left time: 489.3171s
	iters: 300, epoch: 6 | loss: 0.0133638
	speed: 0.0355s/iter; left time: 470.9691s
	iters: 400, epoch: 6 | loss: 0.0126833
	speed: 0.0351s/iter; left time: 462.0429s
	iters: 500, epoch: 6 | loss: 0.0126383
	speed: 0.0353s/iter; left time: 461.1625s
	iters: 600, epoch: 6 | loss: 0.0127252
	speed: 0.0348s/iter; left time: 451.1328s
	iters: 700, epoch: 6 | loss: 0.0139683
	speed: 0.0364s/iter; left time: 468.7590s
	iters: 800, epoch: 6 | loss: 0.0128622
	speed: 0.0348s/iter; left time: 444.4484s
	iters: 900, epoch: 6 | loss: 0.0116518
	speed: 0.0346s/iter; left time: 438.5653s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:32.51s
Steps: 904 | Train Loss: 0.0132401 Vali Loss: 0.0178354 Test Loss: 0.0533979
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0123468
	speed: 0.1065s/iter; left time: 1336.8369s
	iters: 200, epoch: 7 | loss: 0.0132131
	speed: 0.0370s/iter; left time: 461.0177s
	iters: 300, epoch: 7 | loss: 0.0143868
	speed: 0.0357s/iter; left time: 440.8902s
	iters: 400, epoch: 7 | loss: 0.0135288
	speed: 0.0342s/iter; left time: 418.6562s
	iters: 500, epoch: 7 | loss: 0.0111989
	speed: 0.0363s/iter; left time: 440.7803s
	iters: 600, epoch: 7 | loss: 0.0100680
	speed: 0.0354s/iter; left time: 426.9317s
	iters: 700, epoch: 7 | loss: 0.0116993
	speed: 0.0342s/iter; left time: 408.7937s
	iters: 800, epoch: 7 | loss: 0.0126507
	speed: 0.0359s/iter; left time: 425.4187s
	iters: 900, epoch: 7 | loss: 0.0127079
	speed: 0.0350s/iter; left time: 411.5474s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:32.44s
Steps: 904 | Train Loss: 0.0122550 Vali Loss: 0.0170722 Test Loss: 0.0502459
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0137502
	speed: 0.1077s/iter; left time: 1254.6236s
	iters: 200, epoch: 8 | loss: 0.0107854
	speed: 0.0343s/iter; left time: 396.0330s
	iters: 300, epoch: 8 | loss: 0.0110221
	speed: 0.0367s/iter; left time: 420.8695s
	iters: 400, epoch: 8 | loss: 0.0107047
	speed: 0.0376s/iter; left time: 426.8505s
	iters: 500, epoch: 8 | loss: 0.0104447
	speed: 0.0348s/iter; left time: 392.0074s
	iters: 600, epoch: 8 | loss: 0.0098792
	speed: 0.0377s/iter; left time: 420.9666s
	iters: 700, epoch: 8 | loss: 0.0090191
	speed: 0.0355s/iter; left time: 392.7931s
	iters: 800, epoch: 8 | loss: 0.0116056
	speed: 0.0341s/iter; left time: 373.3702s
	iters: 900, epoch: 8 | loss: 0.0101424
	speed: 0.0372s/iter; left time: 403.2423s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:32.96s
Steps: 904 | Train Loss: 0.0111770 Vali Loss: 0.0175536 Test Loss: 0.0653295
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0100417
	speed: 0.1080s/iter; left time: 1160.3693s
	iters: 200, epoch: 9 | loss: 0.0109558
	speed: 0.0346s/iter; left time: 367.9681s
	iters: 300, epoch: 9 | loss: 0.0106716
	speed: 0.0353s/iter; left time: 372.1049s
	iters: 400, epoch: 9 | loss: 0.0099881
	speed: 0.0373s/iter; left time: 389.6040s
	iters: 500, epoch: 9 | loss: 0.0102421
	speed: 0.0362s/iter; left time: 374.7245s
	iters: 600, epoch: 9 | loss: 0.0116103
	speed: 0.0347s/iter; left time: 355.8872s
	iters: 700, epoch: 9 | loss: 0.0098578
	speed: 0.0360s/iter; left time: 365.4718s
	iters: 800, epoch: 9 | loss: 0.0105738
	speed: 0.0362s/iter; left time: 364.2395s
	iters: 900, epoch: 9 | loss: 0.0112765
	speed: 0.0351s/iter; left time: 349.3016s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:32.89s
Steps: 904 | Train Loss: 0.0102351 Vali Loss: 0.0179571 Test Loss: 0.0696844
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0096858
	speed: 0.1002s/iter; left time: 986.7954s
	iters: 200, epoch: 10 | loss: 0.0088900
	speed: 0.0350s/iter; left time: 340.8842s
	iters: 300, epoch: 10 | loss: 0.0082502
	speed: 0.0373s/iter; left time: 359.6288s
	iters: 400, epoch: 10 | loss: 0.0097051
	speed: 0.0379s/iter; left time: 361.3709s
	iters: 500, epoch: 10 | loss: 0.0085401
	speed: 0.0376s/iter; left time: 354.9389s
	iters: 600, epoch: 10 | loss: 0.0089890
	speed: 0.0348s/iter; left time: 325.5696s
	iters: 700, epoch: 10 | loss: 0.0098679
	speed: 0.0359s/iter; left time: 331.9615s
	iters: 800, epoch: 10 | loss: 0.0080299
	speed: 0.0376s/iter; left time: 343.7813s
	iters: 900, epoch: 10 | loss: 0.0081632
	speed: 0.0358s/iter; left time: 323.5646s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:33.02s
Steps: 904 | Train Loss: 0.0094014 Vali Loss: 0.0173877 Test Loss: 0.0682939
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_96_96_ES_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04509866237640381, rmse:0.21236445009708405, mae:0.13736702501773834, rse:0.6238628625869751
Intermediate time for ES and pred_len 96: 00h:06m:56.75s
=== Starting experiments for pred_len: 168 ===

--- Running model for ES, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='ES_96_168_ES', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='ES_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : ES_96_168_ES_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1076604
	speed: 0.0754s/iter; left time: 1352.2940s
	iters: 200, epoch: 1 | loss: 0.0817696
	speed: 0.0587s/iter; left time: 1047.8419s
	iters: 300, epoch: 1 | loss: 0.0782555
	speed: 0.0534s/iter; left time: 947.6364s
	iters: 400, epoch: 1 | loss: 0.0722798
	speed: 0.0514s/iter; left time: 906.7635s
	iters: 500, epoch: 1 | loss: 0.0666439
	speed: 0.0596s/iter; left time: 1045.0301s
	iters: 600, epoch: 1 | loss: 0.0624405
	speed: 0.0515s/iter; left time: 898.6392s
	iters: 700, epoch: 1 | loss: 0.0599549
	speed: 0.0561s/iter; left time: 972.6526s
	iters: 800, epoch: 1 | loss: 0.0559474
	speed: 0.0576s/iter; left time: 992.9466s
	iters: 900, epoch: 1 | loss: 0.0540454
	speed: 0.0513s/iter; left time: 879.0107s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:50.27s
Steps: 902 | Train Loss: 0.0748573 Vali Loss: 0.0524881 Test Loss: 0.0967396
Validation loss decreased (inf --> 0.052488).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0421625
	speed: 0.1912s/iter; left time: 3257.8479s
	iters: 200, epoch: 2 | loss: 0.0393575
	speed: 0.0557s/iter; left time: 943.2098s
	iters: 300, epoch: 2 | loss: 0.0356493
	speed: 0.0556s/iter; left time: 936.4896s
	iters: 400, epoch: 2 | loss: 0.0319433
	speed: 0.0543s/iter; left time: 909.6275s
	iters: 500, epoch: 2 | loss: 0.0246841
	speed: 0.0526s/iter; left time: 874.6119s
	iters: 600, epoch: 2 | loss: 0.0226763
	speed: 0.0565s/iter; left time: 934.5025s
	iters: 700, epoch: 2 | loss: 0.0219264
	speed: 0.0549s/iter; left time: 902.6796s
	iters: 800, epoch: 2 | loss: 0.0208745
	speed: 0.0521s/iter; left time: 851.1553s
	iters: 900, epoch: 2 | loss: 0.0186008
	speed: 0.0553s/iter; left time: 898.4655s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:49.59s
Steps: 902 | Train Loss: 0.0303606 Vali Loss: 0.0206722 Test Loss: 0.0529895
Validation loss decreased (0.052488 --> 0.020672).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0201931
	speed: 0.1919s/iter; left time: 3096.9220s
	iters: 200, epoch: 3 | loss: 0.0177573
	speed: 0.0515s/iter; left time: 825.5585s
	iters: 300, epoch: 3 | loss: 0.0159174
	speed: 0.0557s/iter; left time: 886.9390s
	iters: 400, epoch: 3 | loss: 0.0174967
	speed: 0.0542s/iter; left time: 857.6107s
	iters: 500, epoch: 3 | loss: 0.0174612
	speed: 0.0539s/iter; left time: 848.5347s
	iters: 600, epoch: 3 | loss: 0.0209598
	speed: 0.0563s/iter; left time: 879.7305s
	iters: 700, epoch: 3 | loss: 0.0185944
	speed: 0.0566s/iter; left time: 879.9788s
	iters: 800, epoch: 3 | loss: 0.0170346
	speed: 0.0503s/iter; left time: 777.0366s
	iters: 900, epoch: 3 | loss: 0.0172354
	speed: 0.0542s/iter; left time: 830.5289s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:49.53s
Steps: 902 | Train Loss: 0.0183554 Vali Loss: 0.0204376 Test Loss: 0.0526916
Validation loss decreased (0.020672 --> 0.020438).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0171463
	speed: 0.1866s/iter; left time: 2843.0165s
	iters: 200, epoch: 4 | loss: 0.0193084
	speed: 0.0514s/iter; left time: 778.6349s
	iters: 300, epoch: 4 | loss: 0.0158545
	speed: 0.0521s/iter; left time: 782.9082s
	iters: 400, epoch: 4 | loss: 0.0169759
	speed: 0.0515s/iter; left time: 769.7277s
	iters: 500, epoch: 4 | loss: 0.0165341
	speed: 0.0514s/iter; left time: 763.0252s
	iters: 600, epoch: 4 | loss: 0.0156424
	speed: 0.0491s/iter; left time: 723.6069s
	iters: 700, epoch: 4 | loss: 0.0156201
	speed: 0.0495s/iter; left time: 724.5851s
	iters: 800, epoch: 4 | loss: 0.0194296
	speed: 0.0518s/iter; left time: 752.6211s
	iters: 900, epoch: 4 | loss: 0.0168761
	speed: 0.0499s/iter; left time: 720.8929s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:46.49s
Steps: 902 | Train Loss: 0.0168468 Vali Loss: 0.0181415 Test Loss: 0.0457093
Validation loss decreased (0.020438 --> 0.018142).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0150640
	speed: 0.1748s/iter; left time: 2504.8431s
	iters: 200, epoch: 5 | loss: 0.0157095
	speed: 0.0476s/iter; left time: 676.8551s
	iters: 300, epoch: 5 | loss: 0.0159143
	speed: 0.0483s/iter; left time: 681.9523s
	iters: 400, epoch: 5 | loss: 0.0148808
	speed: 0.0504s/iter; left time: 706.6997s
	iters: 500, epoch: 5 | loss: 0.0149314
	speed: 0.0445s/iter; left time: 620.3126s
	iters: 600, epoch: 5 | loss: 0.0147398
	speed: 0.0397s/iter; left time: 549.4337s
	iters: 700, epoch: 5 | loss: 0.0151090
	speed: 0.0437s/iter; left time: 600.0459s
	iters: 800, epoch: 5 | loss: 0.0155658
	speed: 0.0469s/iter; left time: 640.0667s
	iters: 900, epoch: 5 | loss: 0.0139933
	speed: 0.0557s/iter; left time: 754.2638s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.37s
Steps: 902 | Train Loss: 0.0154849 Vali Loss: 0.0210057 Test Loss: 0.0575928
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0153980
	speed: 0.1915s/iter; left time: 2572.5208s
	iters: 200, epoch: 6 | loss: 0.0163318
	speed: 0.0559s/iter; left time: 745.6963s
	iters: 300, epoch: 6 | loss: 0.0161950
	speed: 0.0531s/iter; left time: 702.8263s
	iters: 400, epoch: 6 | loss: 0.0137966
	speed: 0.0571s/iter; left time: 750.3720s
	iters: 500, epoch: 6 | loss: 0.0135618
	speed: 0.0593s/iter; left time: 772.4411s
	iters: 600, epoch: 6 | loss: 0.0140798
	speed: 0.0534s/iter; left time: 690.6953s
	iters: 700, epoch: 6 | loss: 0.0140824
	speed: 0.0564s/iter; left time: 723.5259s
	iters: 800, epoch: 6 | loss: 0.0144318
	speed: 0.0592s/iter; left time: 753.6689s
	iters: 900, epoch: 6 | loss: 0.0141567
	speed: 0.0452s/iter; left time: 570.7096s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:50.19s
Steps: 902 | Train Loss: 0.0142061 Vali Loss: 0.0200412 Test Loss: 0.0589927
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0129912
	speed: 0.1652s/iter; left time: 2069.3153s
	iters: 200, epoch: 7 | loss: 0.0121356
	speed: 0.0595s/iter; left time: 739.4595s
	iters: 300, epoch: 7 | loss: 0.0127763
	speed: 0.0588s/iter; left time: 724.9347s
	iters: 400, epoch: 7 | loss: 0.0125835
	speed: 0.0611s/iter; left time: 747.7475s
	iters: 500, epoch: 7 | loss: 0.0129308
	speed: 0.0646s/iter; left time: 783.0269s
	iters: 600, epoch: 7 | loss: 0.0124214
	speed: 0.0534s/iter; left time: 642.1967s
	iters: 700, epoch: 7 | loss: 0.0119898
	speed: 0.0599s/iter; left time: 714.2870s
	iters: 800, epoch: 7 | loss: 0.0121501
	speed: 0.0656s/iter; left time: 776.2387s
	iters: 900, epoch: 7 | loss: 0.0122737
	speed: 0.0561s/iter; left time: 658.0494s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:54.64s
Steps: 902 | Train Loss: 0.0129999 Vali Loss: 0.0207440 Test Loss: 0.0627964
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0124242
	speed: 0.2055s/iter; left time: 2389.6126s
	iters: 200, epoch: 8 | loss: 0.0118248
	speed: 0.0526s/iter; left time: 606.7573s
	iters: 300, epoch: 8 | loss: 0.0117292
	speed: 0.0564s/iter; left time: 644.5613s
	iters: 400, epoch: 8 | loss: 0.0130134
	speed: 0.0665s/iter; left time: 753.2220s
	iters: 500, epoch: 8 | loss: 0.0130490
	speed: 0.0596s/iter; left time: 669.5602s
	iters: 600, epoch: 8 | loss: 0.0109687
	speed: 0.0583s/iter; left time: 648.2929s
	iters: 700, epoch: 8 | loss: 0.0122383
	speed: 0.0571s/iter; left time: 630.1158s
	iters: 800, epoch: 8 | loss: 0.0117130
	speed: 0.0663s/iter; left time: 724.1992s
	iters: 900, epoch: 8 | loss: 0.0100833
	speed: 0.0572s/iter; left time: 619.3603s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:54.08s
Steps: 902 | Train Loss: 0.0118847 Vali Loss: 0.0210125 Test Loss: 0.0733620
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0103930
	speed: 0.2014s/iter; left time: 2159.8774s
	iters: 200, epoch: 9 | loss: 0.0112016
	speed: 0.0558s/iter; left time: 592.9863s
	iters: 300, epoch: 9 | loss: 0.0108396
	speed: 0.0565s/iter; left time: 594.7679s
	iters: 400, epoch: 9 | loss: 0.0120394
	speed: 0.0646s/iter; left time: 673.4253s
	iters: 500, epoch: 9 | loss: 0.0112179
	speed: 0.0599s/iter; left time: 618.2037s
	iters: 600, epoch: 9 | loss: 0.0110158
	speed: 0.0553s/iter; left time: 565.7573s
	iters: 700, epoch: 9 | loss: 0.0111671
	speed: 0.0625s/iter; left time: 632.9769s
	iters: 800, epoch: 9 | loss: 0.0114187
	speed: 0.0552s/iter; left time: 553.5929s
	iters: 900, epoch: 9 | loss: 0.0102199
	speed: 0.0608s/iter; left time: 603.9255s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:54.30s
Steps: 902 | Train Loss: 0.0108681 Vali Loss: 0.0215595 Test Loss: 0.0831135
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : ES_96_168_ES_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04569759592413902, rmse:0.21376995742321014, mae:0.14075864851474762, rse:0.6279107928276062
Intermediate time for ES and pred_len 168: 00h:09m:44.87sIntermediate time for ES: 00h:25m:33.53s
=== Starting experiments for country: FR ===

=== Starting experiments for pred_len: 24 ===

--- Running model for FR, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_96_24_FR', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_96_24_FR_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0557040
	speed: 0.0888s/iter; left time: 1599.3656s
	iters: 200, epoch: 1 | loss: 0.0566567
	speed: 0.0361s/iter; left time: 646.6672s
	iters: 300, epoch: 1 | loss: 0.0498068
	speed: 0.0350s/iter; left time: 623.6590s
	iters: 400, epoch: 1 | loss: 0.0433728
	speed: 0.0338s/iter; left time: 598.4894s
	iters: 500, epoch: 1 | loss: 0.0398614
	speed: 0.0324s/iter; left time: 571.7837s
	iters: 600, epoch: 1 | loss: 0.0323519
	speed: 0.0313s/iter; left time: 548.8695s
	iters: 700, epoch: 1 | loss: 0.0296219
	speed: 0.0318s/iter; left time: 554.8368s
	iters: 800, epoch: 1 | loss: 0.0302265
	speed: 0.0329s/iter; left time: 570.3510s
	iters: 900, epoch: 1 | loss: 0.0270551
	speed: 0.0343s/iter; left time: 590.1721s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:32.06s
Steps: 906 | Train Loss: 0.0440174 Vali Loss: 0.0216729 Test Loss: 0.0262815
Validation loss decreased (inf --> 0.021673).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0230959
	speed: 0.1107s/iter; left time: 1893.7844s
	iters: 200, epoch: 2 | loss: 0.0100425
	speed: 0.0361s/iter; left time: 613.6718s
	iters: 300, epoch: 2 | loss: 0.0092201
	speed: 0.0320s/iter; left time: 541.9046s
	iters: 400, epoch: 2 | loss: 0.0095029
	speed: 0.0325s/iter; left time: 547.2760s
	iters: 500, epoch: 2 | loss: 0.0086843
	speed: 0.0350s/iter; left time: 585.3725s
	iters: 600, epoch: 2 | loss: 0.0133543
	speed: 0.0371s/iter; left time: 615.8823s
	iters: 700, epoch: 2 | loss: 0.0075673
	speed: 0.0322s/iter; left time: 532.4580s
	iters: 800, epoch: 2 | loss: 0.0105873
	speed: 0.0334s/iter; left time: 547.8638s
	iters: 900, epoch: 2 | loss: 0.0098104
	speed: 0.0329s/iter; left time: 536.0198s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.25s
Steps: 906 | Train Loss: 0.0122258 Vali Loss: 0.0109184 Test Loss: 0.0141849
Validation loss decreased (0.021673 --> 0.010918).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0077783
	speed: 0.1134s/iter; left time: 1837.3004s
	iters: 200, epoch: 3 | loss: 0.0066038
	speed: 0.0316s/iter; left time: 509.1545s
	iters: 300, epoch: 3 | loss: 0.0083415
	speed: 0.0322s/iter; left time: 515.3240s
	iters: 400, epoch: 3 | loss: 0.0072368
	speed: 0.0316s/iter; left time: 503.4924s
	iters: 500, epoch: 3 | loss: 0.0091273
	speed: 0.0325s/iter; left time: 513.0264s
	iters: 600, epoch: 3 | loss: 0.0085347
	speed: 0.0334s/iter; left time: 523.9644s
	iters: 700, epoch: 3 | loss: 0.0069173
	speed: 0.0355s/iter; left time: 554.4338s
	iters: 800, epoch: 3 | loss: 0.0051648
	speed: 0.0363s/iter; left time: 562.5077s
	iters: 900, epoch: 3 | loss: 0.0051273
	speed: 0.0330s/iter; left time: 508.7869s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:30.63s
Steps: 906 | Train Loss: 0.0077618 Vali Loss: 0.0107251 Test Loss: 0.0137270
Validation loss decreased (0.010918 --> 0.010725).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0063474
	speed: 0.1108s/iter; left time: 1695.6758s
	iters: 200, epoch: 4 | loss: 0.0053195
	speed: 0.0361s/iter; left time: 548.4656s
	iters: 300, epoch: 4 | loss: 0.0081236
	speed: 0.0322s/iter; left time: 486.0109s
	iters: 400, epoch: 4 | loss: 0.0075084
	speed: 0.0327s/iter; left time: 490.0030s
	iters: 500, epoch: 4 | loss: 0.0051806
	speed: 0.0315s/iter; left time: 468.8650s
	iters: 600, epoch: 4 | loss: 0.0053774
	speed: 0.0331s/iter; left time: 490.6987s
	iters: 700, epoch: 4 | loss: 0.0082503
	speed: 0.0343s/iter; left time: 504.4440s
	iters: 800, epoch: 4 | loss: 0.0073275
	speed: 0.0333s/iter; left time: 485.9623s
	iters: 900, epoch: 4 | loss: 0.0056999
	speed: 0.0336s/iter; left time: 486.8531s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:31.17s
Steps: 906 | Train Loss: 0.0069536 Vali Loss: 0.0111535 Test Loss: 0.0136705
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0055979
	speed: 0.1076s/iter; left time: 1549.7699s
	iters: 200, epoch: 5 | loss: 0.0067906
	speed: 0.0343s/iter; left time: 489.8944s
	iters: 300, epoch: 5 | loss: 0.0069095
	speed: 0.0328s/iter; left time: 465.0075s
	iters: 400, epoch: 5 | loss: 0.0069703
	speed: 0.0371s/iter; left time: 523.4686s
	iters: 500, epoch: 5 | loss: 0.0061679
	speed: 0.0372s/iter; left time: 521.2084s
	iters: 600, epoch: 5 | loss: 0.0086047
	speed: 0.0351s/iter; left time: 488.3821s
	iters: 700, epoch: 5 | loss: 0.0074374
	speed: 0.0333s/iter; left time: 459.9522s
	iters: 800, epoch: 5 | loss: 0.0054916
	speed: 0.0350s/iter; left time: 480.0014s
	iters: 900, epoch: 5 | loss: 0.0056452
	speed: 0.0350s/iter; left time: 475.9066s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:32.48s
Steps: 906 | Train Loss: 0.0064846 Vali Loss: 0.0108404 Test Loss: 0.0129843
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0053115
	speed: 0.1062s/iter; left time: 1432.2901s
	iters: 200, epoch: 6 | loss: 0.0040077
	speed: 0.0338s/iter; left time: 451.9645s
	iters: 300, epoch: 6 | loss: 0.0047869
	speed: 0.0378s/iter; left time: 502.1505s
	iters: 400, epoch: 6 | loss: 0.0080178
	speed: 0.0374s/iter; left time: 493.2560s
	iters: 500, epoch: 6 | loss: 0.0051984
	speed: 0.0337s/iter; left time: 440.9629s
	iters: 600, epoch: 6 | loss: 0.0075436
	speed: 0.0337s/iter; left time: 438.4126s
	iters: 700, epoch: 6 | loss: 0.0052424
	speed: 0.0327s/iter; left time: 421.9993s
	iters: 800, epoch: 6 | loss: 0.0052196
	speed: 0.0373s/iter; left time: 476.7730s
	iters: 900, epoch: 6 | loss: 0.0064065
	speed: 0.0367s/iter; left time: 465.4946s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:32.43s
Steps: 906 | Train Loss: 0.0059796 Vali Loss: 0.0110588 Test Loss: 0.0135888
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0043378
	speed: 0.0995s/iter; left time: 1252.8248s
	iters: 200, epoch: 7 | loss: 0.0085250
	speed: 0.0355s/iter; left time: 442.8052s
	iters: 300, epoch: 7 | loss: 0.0049057
	speed: 0.0362s/iter; left time: 447.9070s
	iters: 400, epoch: 7 | loss: 0.0061337
	speed: 0.0328s/iter; left time: 403.3432s
	iters: 500, epoch: 7 | loss: 0.0045658
	speed: 0.0333s/iter; left time: 406.0233s
	iters: 600, epoch: 7 | loss: 0.0041116
	speed: 0.0343s/iter; left time: 414.9597s
	iters: 700, epoch: 7 | loss: 0.0054256
	speed: 0.0322s/iter; left time: 385.3954s
	iters: 800, epoch: 7 | loss: 0.0048906
	speed: 0.0348s/iter; left time: 413.4079s
	iters: 900, epoch: 7 | loss: 0.0044429
	speed: 0.0344s/iter; left time: 405.0318s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:31.16s
Steps: 906 | Train Loss: 0.0055171 Vali Loss: 0.0111075 Test Loss: 0.0134708
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0040176
	speed: 0.1035s/iter; left time: 1208.9279s
	iters: 200, epoch: 8 | loss: 0.0060926
	speed: 0.0348s/iter; left time: 403.1421s
	iters: 300, epoch: 8 | loss: 0.0042525
	speed: 0.0335s/iter; left time: 384.8762s
	iters: 400, epoch: 8 | loss: 0.0058098
	speed: 0.0378s/iter; left time: 430.5484s
	iters: 500, epoch: 8 | loss: 0.0045941
	speed: 0.0321s/iter; left time: 361.9506s
	iters: 600, epoch: 8 | loss: 0.0044146
	speed: 0.0324s/iter; left time: 361.9939s
	iters: 700, epoch: 8 | loss: 0.0051017
	speed: 0.0335s/iter; left time: 371.4275s
	iters: 800, epoch: 8 | loss: 0.0055601
	speed: 0.0380s/iter; left time: 416.6687s
	iters: 900, epoch: 8 | loss: 0.0048369
	speed: 0.0345s/iter; left time: 375.0483s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:31.78s
Steps: 906 | Train Loss: 0.0050730 Vali Loss: 0.0111505 Test Loss: 0.0134428
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_96_24_FR_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.013713154941797256, rmse:0.11710318177938461, mae:0.07169971615076065, rse:0.45187991857528687
Intermediate time for FR and pred_len 24: 00h:05m:24.59s
=== Starting experiments for pred_len: 96 ===

--- Running model for FR, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_96_96_FR', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_96_96_FR_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0713282
	speed: 0.0858s/iter; left time: 1542.7723s
	iters: 200, epoch: 1 | loss: 0.0532927
	speed: 0.0373s/iter; left time: 667.1232s
	iters: 300, epoch: 1 | loss: 0.0547653
	speed: 0.0354s/iter; left time: 629.6149s
	iters: 400, epoch: 1 | loss: 0.0498358
	speed: 0.0401s/iter; left time: 708.5283s
	iters: 500, epoch: 1 | loss: 0.0470307
	speed: 0.0368s/iter; left time: 646.3491s
	iters: 600, epoch: 1 | loss: 0.0438069
	speed: 0.0353s/iter; left time: 616.6241s
	iters: 700, epoch: 1 | loss: 0.0451446
	speed: 0.0341s/iter; left time: 592.4182s
	iters: 800, epoch: 1 | loss: 0.0392235
	speed: 0.0370s/iter; left time: 638.5739s
	iters: 900, epoch: 1 | loss: 0.0377153
	speed: 0.0364s/iter; left time: 625.8237s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.75s
Steps: 904 | Train Loss: 0.0528629 Vali Loss: 0.0476110 Test Loss: 0.0643863
Validation loss decreased (inf --> 0.047611).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0264039
	speed: 0.1191s/iter; left time: 2033.7781s
	iters: 200, epoch: 2 | loss: 0.0236852
	speed: 0.0359s/iter; left time: 609.2975s
	iters: 300, epoch: 2 | loss: 0.0163798
	speed: 0.0402s/iter; left time: 677.7918s
	iters: 400, epoch: 2 | loss: 0.0185473
	speed: 0.0365s/iter; left time: 613.1493s
	iters: 500, epoch: 2 | loss: 0.0154308
	speed: 0.0339s/iter; left time: 565.4403s
	iters: 600, epoch: 2 | loss: 0.0147546
	speed: 0.0342s/iter; left time: 566.7933s
	iters: 700, epoch: 2 | loss: 0.0153008
	speed: 0.0357s/iter; left time: 588.9725s
	iters: 800, epoch: 2 | loss: 0.0102496
	speed: 0.0373s/iter; left time: 610.6545s
	iters: 900, epoch: 2 | loss: 0.0147741
	speed: 0.0355s/iter; left time: 577.4771s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.26s
Steps: 904 | Train Loss: 0.0189365 Vali Loss: 0.0191721 Test Loss: 0.0245784
Validation loss decreased (0.047611 --> 0.019172).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0127275
	speed: 0.1142s/iter; left time: 1846.5062s
	iters: 200, epoch: 3 | loss: 0.0125322
	speed: 0.0351s/iter; left time: 563.8656s
	iters: 300, epoch: 3 | loss: 0.0125635
	speed: 0.0367s/iter; left time: 585.4402s
	iters: 400, epoch: 3 | loss: 0.0092649
	speed: 0.0372s/iter; left time: 590.9637s
	iters: 500, epoch: 3 | loss: 0.0118248
	speed: 0.0354s/iter; left time: 558.4883s
	iters: 600, epoch: 3 | loss: 0.0097686
	speed: 0.0368s/iter; left time: 576.4442s
	iters: 700, epoch: 3 | loss: 0.0104057
	speed: 0.0381s/iter; left time: 594.0925s
	iters: 800, epoch: 3 | loss: 0.0134165
	speed: 0.0348s/iter; left time: 538.1807s
	iters: 900, epoch: 3 | loss: 0.0104153
	speed: 0.0356s/iter; left time: 547.8976s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.26s
Steps: 904 | Train Loss: 0.0116075 Vali Loss: 0.0172378 Test Loss: 0.0219515
Validation loss decreased (0.019172 --> 0.017238).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0087241
	speed: 0.1169s/iter; left time: 1784.9254s
	iters: 200, epoch: 4 | loss: 0.0109887
	speed: 0.0369s/iter; left time: 560.4141s
	iters: 300, epoch: 4 | loss: 0.0094588
	speed: 0.0385s/iter; left time: 580.4079s
	iters: 400, epoch: 4 | loss: 0.0108194
	speed: 0.0354s/iter; left time: 529.1731s
	iters: 500, epoch: 4 | loss: 0.0091312
	speed: 0.0374s/iter; left time: 556.7945s
	iters: 600, epoch: 4 | loss: 0.0099830
	speed: 0.0362s/iter; left time: 534.5328s
	iters: 700, epoch: 4 | loss: 0.0088046
	speed: 0.0358s/iter; left time: 524.6948s
	iters: 800, epoch: 4 | loss: 0.0083616
	speed: 0.0372s/iter; left time: 542.6594s
	iters: 900, epoch: 4 | loss: 0.0098428
	speed: 0.0357s/iter; left time: 516.2106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:33.57s
Steps: 904 | Train Loss: 0.0103794 Vali Loss: 0.0177083 Test Loss: 0.0204828
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0101264
	speed: 0.1086s/iter; left time: 1559.6593s
	iters: 200, epoch: 5 | loss: 0.0090347
	speed: 0.0357s/iter; left time: 509.6380s
	iters: 300, epoch: 5 | loss: 0.0106993
	speed: 0.0355s/iter; left time: 503.3038s
	iters: 400, epoch: 5 | loss: 0.0086455
	speed: 0.0369s/iter; left time: 519.1749s
	iters: 500, epoch: 5 | loss: 0.0094088
	speed: 0.0385s/iter; left time: 538.2974s
	iters: 600, epoch: 5 | loss: 0.0096442
	speed: 0.0361s/iter; left time: 500.2638s
	iters: 700, epoch: 5 | loss: 0.0101340
	speed: 0.0370s/iter; left time: 509.9565s
	iters: 800, epoch: 5 | loss: 0.0093720
	speed: 0.0372s/iter; left time: 508.3056s
	iters: 900, epoch: 5 | loss: 0.0095146
	speed: 0.0364s/iter; left time: 493.3894s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.73s
Steps: 904 | Train Loss: 0.0092743 Vali Loss: 0.0178018 Test Loss: 0.0213532
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0089636
	speed: 0.1105s/iter; left time: 1487.9342s
	iters: 200, epoch: 6 | loss: 0.0083519
	speed: 0.0353s/iter; left time: 471.9524s
	iters: 300, epoch: 6 | loss: 0.0084763
	speed: 0.0375s/iter; left time: 496.9349s
	iters: 400, epoch: 6 | loss: 0.0079713
	speed: 0.0370s/iter; left time: 486.4529s
	iters: 500, epoch: 6 | loss: 0.0071507
	speed: 0.0357s/iter; left time: 466.3746s
	iters: 600, epoch: 6 | loss: 0.0079912
	speed: 0.0374s/iter; left time: 484.7501s
	iters: 700, epoch: 6 | loss: 0.0075933
	speed: 0.0368s/iter; left time: 473.3324s
	iters: 800, epoch: 6 | loss: 0.0071945
	speed: 0.0341s/iter; left time: 434.7576s
	iters: 900, epoch: 6 | loss: 0.0090047
	speed: 0.0343s/iter; left time: 434.1977s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:33.05s
Steps: 904 | Train Loss: 0.0083276 Vali Loss: 0.0188322 Test Loss: 0.0227438
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0072072
	speed: 0.1073s/iter; left time: 1346.9943s
	iters: 200, epoch: 7 | loss: 0.0083546
	speed: 0.0374s/iter; left time: 466.0270s
	iters: 300, epoch: 7 | loss: 0.0075572
	speed: 0.0379s/iter; left time: 467.7444s
	iters: 400, epoch: 7 | loss: 0.0066608
	speed: 0.0361s/iter; left time: 442.1268s
	iters: 500, epoch: 7 | loss: 0.0066593
	speed: 0.0379s/iter; left time: 460.6477s
	iters: 600, epoch: 7 | loss: 0.0058861
	speed: 0.0361s/iter; left time: 435.1961s
	iters: 700, epoch: 7 | loss: 0.0074150
	speed: 0.0374s/iter; left time: 446.6572s
	iters: 800, epoch: 7 | loss: 0.0077773
	speed: 0.0376s/iter; left time: 445.2857s
	iters: 900, epoch: 7 | loss: 0.0078835
	speed: 0.0363s/iter; left time: 426.6413s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.13s
Steps: 904 | Train Loss: 0.0075487 Vali Loss: 0.0184792 Test Loss: 0.0213013
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0079015
	speed: 0.1124s/iter; left time: 1309.9769s
	iters: 200, epoch: 8 | loss: 0.0070421
	speed: 0.0361s/iter; left time: 417.4671s
	iters: 300, epoch: 8 | loss: 0.0068618
	speed: 0.0377s/iter; left time: 431.6196s
	iters: 400, epoch: 8 | loss: 0.0055678
	speed: 0.0368s/iter; left time: 418.0457s
	iters: 500, epoch: 8 | loss: 0.0061512
	speed: 0.0377s/iter; left time: 424.6130s
	iters: 600, epoch: 8 | loss: 0.0059672
	speed: 0.0370s/iter; left time: 412.6894s
	iters: 700, epoch: 8 | loss: 0.0058989
	speed: 0.0354s/iter; left time: 391.2519s
	iters: 800, epoch: 8 | loss: 0.0069831
	speed: 0.0377s/iter; left time: 413.4566s
	iters: 900, epoch: 8 | loss: 0.0054988
	speed: 0.0385s/iter; left time: 417.7743s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:33.91s
Steps: 904 | Train Loss: 0.0068911 Vali Loss: 0.0190678 Test Loss: 0.0223106
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_96_96_FR_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021918583661317825, rmse:0.1480492651462555, mae:0.09203358739614487, rse:0.5726938843727112
Intermediate time for FR and pred_len 96: 00h:05m:44.59s
=== Starting experiments for pred_len: 168 ===

--- Running model for FR, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='FR_96_168_FR', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='FR_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : FR_96_168_FR_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0712789
	speed: 0.0921s/iter; left time: 1652.3474s
	iters: 200, epoch: 1 | loss: 0.0564459
	speed: 0.0514s/iter; left time: 916.5102s
	iters: 300, epoch: 1 | loss: 0.0524226
	speed: 0.0510s/iter; left time: 903.9751s
	iters: 400, epoch: 1 | loss: 0.0486759
	speed: 0.0515s/iter; left time: 908.4272s
	iters: 500, epoch: 1 | loss: 0.0526598
	speed: 0.0411s/iter; left time: 721.2913s
	iters: 600, epoch: 1 | loss: 0.0478596
	speed: 0.0528s/iter; left time: 921.4439s
	iters: 700, epoch: 1 | loss: 0.0439855
	speed: 0.0506s/iter; left time: 878.1430s
	iters: 800, epoch: 1 | loss: 0.0431464
	speed: 0.0573s/iter; left time: 988.1612s
	iters: 900, epoch: 1 | loss: 0.0428041
	speed: 0.0543s/iter; left time: 929.9780s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.93s
Steps: 902 | Train Loss: 0.0537082 Vali Loss: 0.0510528 Test Loss: 0.0686685
Validation loss decreased (inf --> 0.051053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0337284
	speed: 0.1859s/iter; left time: 3167.7391s
	iters: 200, epoch: 2 | loss: 0.0246603
	speed: 0.0531s/iter; left time: 899.5291s
	iters: 300, epoch: 2 | loss: 0.0220720
	speed: 0.0530s/iter; left time: 891.9195s
	iters: 400, epoch: 2 | loss: 0.0226117
	speed: 0.0538s/iter; left time: 901.3671s
	iters: 500, epoch: 2 | loss: 0.0250630
	speed: 0.0549s/iter; left time: 913.7793s
	iters: 600, epoch: 2 | loss: 0.0193863
	speed: 0.0523s/iter; left time: 864.5525s
	iters: 700, epoch: 2 | loss: 0.0175116
	speed: 0.0524s/iter; left time: 861.0281s
	iters: 800, epoch: 2 | loss: 0.0138841
	speed: 0.0573s/iter; left time: 936.4079s
	iters: 900, epoch: 2 | loss: 0.0140103
	speed: 0.0487s/iter; left time: 790.6525s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.67s
Steps: 902 | Train Loss: 0.0229412 Vali Loss: 0.0200941 Test Loss: 0.0258313
Validation loss decreased (0.051053 --> 0.020094).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0138645
	speed: 0.1628s/iter; left time: 2627.1203s
	iters: 200, epoch: 3 | loss: 0.0152363
	speed: 0.0580s/iter; left time: 930.6524s
	iters: 300, epoch: 3 | loss: 0.0125207
	speed: 0.0582s/iter; left time: 927.8613s
	iters: 400, epoch: 3 | loss: 0.0109847
	speed: 0.0609s/iter; left time: 965.1406s
	iters: 500, epoch: 3 | loss: 0.0132744
	speed: 0.0544s/iter; left time: 855.3827s
	iters: 600, epoch: 3 | loss: 0.0139970
	speed: 0.0534s/iter; left time: 834.4592s
	iters: 700, epoch: 3 | loss: 0.0113928
	speed: 0.0589s/iter; left time: 915.1318s
	iters: 800, epoch: 3 | loss: 0.0096550
	speed: 0.0585s/iter; left time: 903.6271s
	iters: 900, epoch: 3 | loss: 0.0107050
	speed: 0.0584s/iter; left time: 895.0547s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:51.87s
Steps: 902 | Train Loss: 0.0128087 Vali Loss: 0.0184778 Test Loss: 0.0229411
Validation loss decreased (0.020094 --> 0.018478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0120290
	speed: 0.1984s/iter; left time: 3021.8811s
	iters: 200, epoch: 4 | loss: 0.0122949
	speed: 0.0591s/iter; left time: 894.9164s
	iters: 300, epoch: 4 | loss: 0.0100306
	speed: 0.0508s/iter; left time: 763.9291s
	iters: 400, epoch: 4 | loss: 0.0128027
	speed: 0.0524s/iter; left time: 783.2639s
	iters: 500, epoch: 4 | loss: 0.0108234
	speed: 0.0638s/iter; left time: 946.7804s
	iters: 600, epoch: 4 | loss: 0.0116764
	speed: 0.0585s/iter; left time: 862.2161s
	iters: 700, epoch: 4 | loss: 0.0110869
	speed: 0.0514s/iter; left time: 751.8002s
	iters: 800, epoch: 4 | loss: 0.0106050
	speed: 0.0563s/iter; left time: 818.6393s
	iters: 900, epoch: 4 | loss: 0.0101593
	speed: 0.0607s/iter; left time: 876.5660s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:51.83s
Steps: 902 | Train Loss: 0.0114168 Vali Loss: 0.0190368 Test Loss: 0.0244393
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0101887
	speed: 0.1833s/iter; left time: 2626.8380s
	iters: 200, epoch: 5 | loss: 0.0095769
	speed: 0.0600s/iter; left time: 854.1281s
	iters: 300, epoch: 5 | loss: 0.0090418
	speed: 0.0576s/iter; left time: 814.4633s
	iters: 400, epoch: 5 | loss: 0.0099594
	speed: 0.0504s/iter; left time: 706.6110s
	iters: 500, epoch: 5 | loss: 0.0107698
	speed: 0.0516s/iter; left time: 718.3115s
	iters: 600, epoch: 5 | loss: 0.0110696
	speed: 0.0602s/iter; left time: 832.9217s
	iters: 700, epoch: 5 | loss: 0.0097897
	speed: 0.0586s/iter; left time: 804.6928s
	iters: 800, epoch: 5 | loss: 0.0107613
	speed: 0.0507s/iter; left time: 691.5241s
	iters: 900, epoch: 5 | loss: 0.0091366
	speed: 0.0565s/iter; left time: 764.6654s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:50.25s
Steps: 902 | Train Loss: 0.0102130 Vali Loss: 0.0209971 Test Loss: 0.0247405
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0088060
	speed: 0.1894s/iter; left time: 2543.3506s
	iters: 200, epoch: 6 | loss: 0.0118641
	speed: 0.0590s/iter; left time: 785.8691s
	iters: 300, epoch: 6 | loss: 0.0103403
	speed: 0.0499s/iter; left time: 660.3317s
	iters: 400, epoch: 6 | loss: 0.0086813
	speed: 0.0567s/iter; left time: 744.4907s
	iters: 500, epoch: 6 | loss: 0.0089356
	speed: 0.0615s/iter; left time: 801.6109s
	iters: 600, epoch: 6 | loss: 0.0079076
	speed: 0.0509s/iter; left time: 657.7054s
	iters: 700, epoch: 6 | loss: 0.0084999
	speed: 0.0416s/iter; left time: 533.1942s
	iters: 800, epoch: 6 | loss: 0.0104291
	speed: 0.0393s/iter; left time: 499.9840s
	iters: 900, epoch: 6 | loss: 0.0085110
	speed: 0.0495s/iter; left time: 625.8533s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.81s
Steps: 902 | Train Loss: 0.0091048 Vali Loss: 0.0218596 Test Loss: 0.0251613
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0081512
	speed: 0.1920s/iter; left time: 2405.6479s
	iters: 200, epoch: 7 | loss: 0.0086582
	speed: 0.0495s/iter; left time: 615.6133s
	iters: 300, epoch: 7 | loss: 0.0078223
	speed: 0.0554s/iter; left time: 683.4369s
	iters: 400, epoch: 7 | loss: 0.0082433
	speed: 0.0590s/iter; left time: 722.0930s
	iters: 500, epoch: 7 | loss: 0.0077983
	speed: 0.0543s/iter; left time: 658.1248s
	iters: 600, epoch: 7 | loss: 0.0094143
	speed: 0.0539s/iter; left time: 647.9025s
	iters: 700, epoch: 7 | loss: 0.0069718
	speed: 0.0529s/iter; left time: 631.1758s
	iters: 800, epoch: 7 | loss: 0.0072303
	speed: 0.0539s/iter; left time: 637.9092s
	iters: 900, epoch: 7 | loss: 0.0069558
	speed: 0.0574s/iter; left time: 673.1431s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:49.92s
Steps: 902 | Train Loss: 0.0082977 Vali Loss: 0.0210507 Test Loss: 0.0243219
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0077253
	speed: 0.1842s/iter; left time: 2142.2477s
	iters: 200, epoch: 8 | loss: 0.0073574
	speed: 0.0517s/iter; left time: 595.8668s
	iters: 300, epoch: 8 | loss: 0.0081805
	speed: 0.0603s/iter; left time: 689.1393s
	iters: 400, epoch: 8 | loss: 0.0069221
	speed: 0.0559s/iter; left time: 633.4095s
	iters: 500, epoch: 8 | loss: 0.0077838
	speed: 0.0483s/iter; left time: 542.0257s
	iters: 600, epoch: 8 | loss: 0.0065794
	speed: 0.0556s/iter; left time: 619.2167s
	iters: 700, epoch: 8 | loss: 0.0078354
	speed: 0.0608s/iter; left time: 670.4803s
	iters: 800, epoch: 8 | loss: 0.0080798
	speed: 0.0532s/iter; left time: 581.5962s
	iters: 900, epoch: 8 | loss: 0.0071020
	speed: 0.0536s/iter; left time: 579.9905s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:49.86s
Steps: 902 | Train Loss: 0.0075413 Vali Loss: 0.0216812 Test Loss: 0.0243932
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : FR_96_168_FR_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02291427180171013, rmse:0.15137460827827454, mae:0.09534455090761185, rse:0.5862637162208557
Intermediate time for FR and pred_len 168: 00h:08m:36.11sIntermediate time for FR: 00h:19m:45.29s
=== Starting experiments for country: IT ===

=== Starting experiments for pred_len: 24 ===

--- Running model for IT, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0957632
	speed: 0.0709s/iter; left time: 1277.4722s
	iters: 200, epoch: 1 | loss: 0.0817575
	speed: 0.0338s/iter; left time: 606.5024s
	iters: 300, epoch: 1 | loss: 0.0646085
	speed: 0.0354s/iter; left time: 631.2071s
	iters: 400, epoch: 1 | loss: 0.0612782
	speed: 0.0329s/iter; left time: 583.1109s
	iters: 500, epoch: 1 | loss: 0.0484514
	speed: 0.0353s/iter; left time: 622.7230s
	iters: 600, epoch: 1 | loss: 0.0481590
	speed: 0.0338s/iter; left time: 592.0886s
	iters: 700, epoch: 1 | loss: 0.0343953
	speed: 0.0346s/iter; left time: 602.4717s
	iters: 800, epoch: 1 | loss: 0.0335397
	speed: 0.0377s/iter; left time: 653.3001s
	iters: 900, epoch: 1 | loss: 0.0383372
	speed: 0.0374s/iter; left time: 644.1736s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:33.47s
Steps: 906 | Train Loss: 0.0605991 Vali Loss: 0.0236095 Test Loss: 0.0250904
Validation loss decreased (inf --> 0.023610).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0261842
	speed: 0.1100s/iter; left time: 1882.6684s
	iters: 200, epoch: 2 | loss: 0.0226637
	speed: 0.0372s/iter; left time: 632.8492s
	iters: 300, epoch: 2 | loss: 0.0147367
	speed: 0.0363s/iter; left time: 613.5112s
	iters: 400, epoch: 2 | loss: 0.0144873
	speed: 0.0345s/iter; left time: 579.4634s
	iters: 500, epoch: 2 | loss: 0.0160467
	speed: 0.0352s/iter; left time: 589.1437s
	iters: 600, epoch: 2 | loss: 0.0193212
	speed: 0.0358s/iter; left time: 594.4283s
	iters: 700, epoch: 2 | loss: 0.0140467
	speed: 0.0343s/iter; left time: 565.8549s
	iters: 800, epoch: 2 | loss: 0.0140468
	speed: 0.0359s/iter; left time: 588.7617s
	iters: 900, epoch: 2 | loss: 0.0126574
	speed: 0.0370s/iter; left time: 604.0885s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:32.84s
Steps: 906 | Train Loss: 0.0177892 Vali Loss: 0.0124438 Test Loss: 0.0138910
Validation loss decreased (0.023610 --> 0.012444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0111033
	speed: 0.1100s/iter; left time: 1783.7594s
	iters: 200, epoch: 3 | loss: 0.0115581
	speed: 0.0366s/iter; left time: 589.7373s
	iters: 300, epoch: 3 | loss: 0.0118196
	speed: 0.0381s/iter; left time: 609.2384s
	iters: 400, epoch: 3 | loss: 0.0087795
	speed: 0.0354s/iter; left time: 563.6478s
	iters: 500, epoch: 3 | loss: 0.0111346
	speed: 0.0329s/iter; left time: 520.6840s
	iters: 600, epoch: 3 | loss: 0.0131450
	speed: 0.0349s/iter; left time: 548.0488s
	iters: 700, epoch: 3 | loss: 0.0124399
	speed: 0.0367s/iter; left time: 572.1388s
	iters: 800, epoch: 3 | loss: 0.0134451
	speed: 0.0357s/iter; left time: 553.1430s
	iters: 900, epoch: 3 | loss: 0.0096626
	speed: 0.0325s/iter; left time: 500.4454s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.34s
Steps: 906 | Train Loss: 0.0118055 Vali Loss: 0.0124286 Test Loss: 0.0138577
Validation loss decreased (0.012444 --> 0.012429).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0127130
	speed: 0.0973s/iter; left time: 1489.5018s
	iters: 200, epoch: 4 | loss: 0.0096245
	speed: 0.0319s/iter; left time: 484.3129s
	iters: 300, epoch: 4 | loss: 0.0105408
	speed: 0.0348s/iter; left time: 526.0765s
	iters: 400, epoch: 4 | loss: 0.0131704
	speed: 0.0346s/iter; left time: 518.8553s
	iters: 500, epoch: 4 | loss: 0.0106625
	speed: 0.0351s/iter; left time: 523.1579s
	iters: 600, epoch: 4 | loss: 0.0090194
	speed: 0.0365s/iter; left time: 540.1050s
	iters: 700, epoch: 4 | loss: 0.0096538
	speed: 0.0351s/iter; left time: 515.4415s
	iters: 800, epoch: 4 | loss: 0.0114234
	speed: 0.0330s/iter; left time: 481.6343s
	iters: 900, epoch: 4 | loss: 0.0113872
	speed: 0.0319s/iter; left time: 462.5542s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:31.24s
Steps: 906 | Train Loss: 0.0106975 Vali Loss: 0.0112019 Test Loss: 0.0123353
Validation loss decreased (0.012429 --> 0.011202).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0091417
	speed: 0.1134s/iter; left time: 1632.2343s
	iters: 200, epoch: 5 | loss: 0.0132211
	speed: 0.0334s/iter; left time: 477.1699s
	iters: 300, epoch: 5 | loss: 0.0108337
	speed: 0.0342s/iter; left time: 484.9021s
	iters: 400, epoch: 5 | loss: 0.0088053
	speed: 0.0329s/iter; left time: 464.2612s
	iters: 500, epoch: 5 | loss: 0.0094521
	speed: 0.0351s/iter; left time: 491.2856s
	iters: 600, epoch: 5 | loss: 0.0083584
	speed: 0.0361s/iter; left time: 502.3690s
	iters: 700, epoch: 5 | loss: 0.0135315
	speed: 0.0335s/iter; left time: 462.7512s
	iters: 800, epoch: 5 | loss: 0.0068324
	speed: 0.0321s/iter; left time: 439.3836s
	iters: 900, epoch: 5 | loss: 0.0104479
	speed: 0.0327s/iter; left time: 444.6534s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.15s
Steps: 906 | Train Loss: 0.0097477 Vali Loss: 0.0103169 Test Loss: 0.0118225
Validation loss decreased (0.011202 --> 0.010317).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0084765
	speed: 0.1093s/iter; left time: 1473.9824s
	iters: 200, epoch: 6 | loss: 0.0092567
	speed: 0.0334s/iter; left time: 447.7382s
	iters: 300, epoch: 6 | loss: 0.0127090
	speed: 0.0331s/iter; left time: 440.3307s
	iters: 400, epoch: 6 | loss: 0.0078653
	speed: 0.0324s/iter; left time: 427.4558s
	iters: 500, epoch: 6 | loss: 0.0061968
	speed: 0.0346s/iter; left time: 452.8788s
	iters: 600, epoch: 6 | loss: 0.0094398
	speed: 0.0362s/iter; left time: 470.1577s
	iters: 700, epoch: 6 | loss: 0.0095741
	speed: 0.0332s/iter; left time: 427.3429s
	iters: 800, epoch: 6 | loss: 0.0084911
	speed: 0.0320s/iter; left time: 409.7873s
	iters: 900, epoch: 6 | loss: 0.0074697
	speed: 0.0329s/iter; left time: 418.1478s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:30.93s
Steps: 906 | Train Loss: 0.0089266 Vali Loss: 0.0098866 Test Loss: 0.0116170
Validation loss decreased (0.010317 --> 0.009887).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0078370
	speed: 0.1131s/iter; left time: 1423.2426s
	iters: 200, epoch: 7 | loss: 0.0097201
	speed: 0.0347s/iter; left time: 433.6008s
	iters: 300, epoch: 7 | loss: 0.0068884
	speed: 0.0329s/iter; left time: 408.0298s
	iters: 400, epoch: 7 | loss: 0.0094338
	speed: 0.0340s/iter; left time: 418.0453s
	iters: 500, epoch: 7 | loss: 0.0086338
	speed: 0.0347s/iter; left time: 422.8576s
	iters: 600, epoch: 7 | loss: 0.0053967
	speed: 0.0341s/iter; left time: 412.4029s
	iters: 700, epoch: 7 | loss: 0.0085320
	speed: 0.0329s/iter; left time: 393.8772s
	iters: 800, epoch: 7 | loss: 0.0095296
	speed: 0.0314s/iter; left time: 373.6059s
	iters: 900, epoch: 7 | loss: 0.0069363
	speed: 0.0331s/iter; left time: 389.5835s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:30.78s
Steps: 906 | Train Loss: 0.0083970 Vali Loss: 0.0095849 Test Loss: 0.0113854
Validation loss decreased (0.009887 --> 0.009585).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0068547
	speed: 0.1201s/iter; left time: 1403.0021s
	iters: 200, epoch: 8 | loss: 0.0062880
	speed: 0.0327s/iter; left time: 378.1468s
	iters: 300, epoch: 8 | loss: 0.0063780
	speed: 0.0362s/iter; left time: 414.9861s
	iters: 400, epoch: 8 | loss: 0.0076308
	speed: 0.0342s/iter; left time: 388.6866s
	iters: 500, epoch: 8 | loss: 0.0084253
	speed: 0.0334s/iter; left time: 376.4441s
	iters: 600, epoch: 8 | loss: 0.0079748
	speed: 0.0329s/iter; left time: 367.5133s
	iters: 700, epoch: 8 | loss: 0.0071999
	speed: 0.0372s/iter; left time: 412.4207s
	iters: 800, epoch: 8 | loss: 0.0082351
	speed: 0.0326s/iter; left time: 357.8190s
	iters: 900, epoch: 8 | loss: 0.0076345
	speed: 0.0357s/iter; left time: 388.4410s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:31.38s
Steps: 906 | Train Loss: 0.0078698 Vali Loss: 0.0095649 Test Loss: 0.0113864
Validation loss decreased (0.009585 --> 0.009565).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0054177
	speed: 0.1082s/iter; left time: 1165.8282s
	iters: 200, epoch: 9 | loss: 0.0087093
	speed: 0.0327s/iter; left time: 348.4798s
	iters: 300, epoch: 9 | loss: 0.0088883
	speed: 0.0364s/iter; left time: 384.6554s
	iters: 400, epoch: 9 | loss: 0.0067530
	speed: 0.0352s/iter; left time: 368.7421s
	iters: 500, epoch: 9 | loss: 0.0068062
	speed: 0.0316s/iter; left time: 327.8233s
	iters: 600, epoch: 9 | loss: 0.0070813
	speed: 0.0325s/iter; left time: 333.4549s
	iters: 700, epoch: 9 | loss: 0.0077914
	speed: 0.0356s/iter; left time: 362.5394s
	iters: 800, epoch: 9 | loss: 0.0067969
	speed: 0.0348s/iter; left time: 350.3827s
	iters: 900, epoch: 9 | loss: 0.0065149
	speed: 0.0340s/iter; left time: 339.3087s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:31.19s
Steps: 906 | Train Loss: 0.0073633 Vali Loss: 0.0106109 Test Loss: 0.0119681
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0078787
	speed: 0.0947s/iter; left time: 933.9321s
	iters: 200, epoch: 10 | loss: 0.0073015
	speed: 0.0334s/iter; left time: 326.6346s
	iters: 300, epoch: 10 | loss: 0.0071232
	speed: 0.0311s/iter; left time: 300.8265s
	iters: 400, epoch: 10 | loss: 0.0069564
	speed: 0.0325s/iter; left time: 310.9176s
	iters: 500, epoch: 10 | loss: 0.0055014
	speed: 0.0346s/iter; left time: 327.3613s
	iters: 600, epoch: 10 | loss: 0.0067581
	speed: 0.0330s/iter; left time: 309.2437s
	iters: 700, epoch: 10 | loss: 0.0056662
	speed: 0.0327s/iter; left time: 303.4657s
	iters: 800, epoch: 10 | loss: 0.0064611
	speed: 0.0332s/iter; left time: 303.9435s
	iters: 900, epoch: 10 | loss: 0.0061233
	speed: 0.0347s/iter; left time: 314.2948s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:30.39s
Steps: 906 | Train Loss: 0.0069422 Vali Loss: 0.0097545 Test Loss: 0.0121330
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0067805
	speed: 0.1014s/iter; left time: 908.4260s
	iters: 200, epoch: 11 | loss: 0.0054183
	speed: 0.0323s/iter; left time: 286.2677s
	iters: 300, epoch: 11 | loss: 0.0069844
	speed: 0.0318s/iter; left time: 278.5425s
	iters: 400, epoch: 11 | loss: 0.0054563
	speed: 0.0348s/iter; left time: 301.7368s
	iters: 500, epoch: 11 | loss: 0.0078667
	speed: 0.0345s/iter; left time: 295.5915s
	iters: 600, epoch: 11 | loss: 0.0084661
	speed: 0.0318s/iter; left time: 269.2762s
	iters: 700, epoch: 11 | loss: 0.0064551
	speed: 0.0317s/iter; left time: 265.2217s
	iters: 800, epoch: 11 | loss: 0.0078192
	speed: 0.0353s/iter; left time: 291.3421s
	iters: 900, epoch: 11 | loss: 0.0064657
	speed: 0.0352s/iter; left time: 287.3652s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.04s
Steps: 906 | Train Loss: 0.0065644 Vali Loss: 0.0102390 Test Loss: 0.0123357
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0049833
	speed: 0.0992s/iter; left time: 799.1754s
	iters: 200, epoch: 12 | loss: 0.0075870
	speed: 0.0328s/iter; left time: 260.8206s
	iters: 300, epoch: 12 | loss: 0.0057872
	speed: 0.0325s/iter; left time: 255.2413s
	iters: 400, epoch: 12 | loss: 0.0063423
	speed: 0.0342s/iter; left time: 265.5325s
	iters: 500, epoch: 12 | loss: 0.0083102
	speed: 0.0329s/iter; left time: 252.0987s
	iters: 600, epoch: 12 | loss: 0.0066547
	speed: 0.0330s/iter; left time: 249.4184s
	iters: 700, epoch: 12 | loss: 0.0055785
	speed: 0.0330s/iter; left time: 245.9778s
	iters: 800, epoch: 12 | loss: 0.0077896
	speed: 0.0340s/iter; left time: 250.0052s
	iters: 900, epoch: 12 | loss: 0.0061444
	speed: 0.0318s/iter; left time: 230.3781s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:30.70s
Steps: 906 | Train Loss: 0.0062224 Vali Loss: 0.0102077 Test Loss: 0.0127671
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0060006
	speed: 0.1032s/iter; left time: 737.7209s
	iters: 200, epoch: 13 | loss: 0.0065340
	speed: 0.0312s/iter; left time: 220.2470s
	iters: 300, epoch: 13 | loss: 0.0052825
	speed: 0.0312s/iter; left time: 217.1292s
	iters: 400, epoch: 13 | loss: 0.0075953
	speed: 0.0333s/iter; left time: 228.3622s
	iters: 500, epoch: 13 | loss: 0.0046650
	speed: 0.0352s/iter; left time: 237.7721s
	iters: 600, epoch: 13 | loss: 0.0054308
	speed: 0.0305s/iter; left time: 202.9122s
	iters: 700, epoch: 13 | loss: 0.0058771
	speed: 0.0326s/iter; left time: 213.7939s
	iters: 800, epoch: 13 | loss: 0.0050994
	speed: 0.0357s/iter; left time: 230.4652s
	iters: 900, epoch: 13 | loss: 0.0066943
	speed: 0.0329s/iter; left time: 208.6631s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:30.50s
Steps: 906 | Train Loss: 0.0058265 Vali Loss: 0.0103207 Test Loss: 0.0131232
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01137869618833065, rmse:0.10667096823453903, mae:0.06598816812038422, rse:0.40311703085899353
Intermediate time for IT and pred_len 24: 00h:08m:25.79s
=== Starting experiments for pred_len: 96 ===

--- Running model for IT, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1052735
	speed: 0.0850s/iter; left time: 1527.9730s
	iters: 200, epoch: 1 | loss: 0.0845075
	speed: 0.0365s/iter; left time: 652.0613s
	iters: 300, epoch: 1 | loss: 0.0778775
	speed: 0.0352s/iter; left time: 626.1546s
	iters: 400, epoch: 1 | loss: 0.0722261
	speed: 0.0364s/iter; left time: 643.2556s
	iters: 500, epoch: 1 | loss: 0.0733849
	speed: 0.0368s/iter; left time: 647.2547s
	iters: 600, epoch: 1 | loss: 0.0649374
	speed: 0.0348s/iter; left time: 608.9235s
	iters: 700, epoch: 1 | loss: 0.0627303
	speed: 0.0355s/iter; left time: 617.1511s
	iters: 800, epoch: 1 | loss: 0.0568795
	speed: 0.0373s/iter; left time: 644.4195s
	iters: 900, epoch: 1 | loss: 0.0588607
	speed: 0.0374s/iter; left time: 642.6338s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.10s
Steps: 904 | Train Loss: 0.0770370 Vali Loss: 0.0422612 Test Loss: 0.0492609
Validation loss decreased (inf --> 0.042261).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0423253
	speed: 0.1105s/iter; left time: 1886.8542s
	iters: 200, epoch: 2 | loss: 0.0328577
	speed: 0.0348s/iter; left time: 591.3248s
	iters: 300, epoch: 2 | loss: 0.0310498
	speed: 0.0361s/iter; left time: 608.5395s
	iters: 400, epoch: 2 | loss: 0.0267299
	speed: 0.0373s/iter; left time: 625.1138s
	iters: 500, epoch: 2 | loss: 0.0250892
	speed: 0.0360s/iter; left time: 600.0345s
	iters: 600, epoch: 2 | loss: 0.0215443
	speed: 0.0369s/iter; left time: 612.4137s
	iters: 700, epoch: 2 | loss: 0.0228624
	speed: 0.0377s/iter; left time: 620.7616s
	iters: 800, epoch: 2 | loss: 0.0199976
	speed: 0.0432s/iter; left time: 708.0240s
	iters: 900, epoch: 2 | loss: 0.0192713
	speed: 0.0431s/iter; left time: 701.2421s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.80s
Steps: 904 | Train Loss: 0.0281857 Vali Loss: 0.0192857 Test Loss: 0.0213712
Validation loss decreased (0.042261 --> 0.019286).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0187188
	speed: 0.1024s/iter; left time: 1655.7202s
	iters: 200, epoch: 3 | loss: 0.0193838
	speed: 0.0351s/iter; left time: 563.7247s
	iters: 300, epoch: 3 | loss: 0.0201494
	speed: 0.0340s/iter; left time: 542.3290s
	iters: 400, epoch: 3 | loss: 0.0181761
	speed: 0.0344s/iter; left time: 546.6556s
	iters: 500, epoch: 3 | loss: 0.0159714
	speed: 0.0340s/iter; left time: 535.8257s
	iters: 600, epoch: 3 | loss: 0.0182038
	speed: 0.0342s/iter; left time: 535.2584s
	iters: 700, epoch: 3 | loss: 0.0159824
	speed: 0.0342s/iter; left time: 532.9489s
	iters: 800, epoch: 3 | loss: 0.0199805
	speed: 0.0354s/iter; left time: 548.0319s
	iters: 900, epoch: 3 | loss: 0.0154733
	speed: 0.0338s/iter; left time: 519.7243s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:31.45s
Steps: 904 | Train Loss: 0.0183871 Vali Loss: 0.0164777 Test Loss: 0.0187503
Validation loss decreased (0.019286 --> 0.016478).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0155618
	speed: 0.1050s/iter; left time: 1603.6096s
	iters: 200, epoch: 4 | loss: 0.0181367
	speed: 0.0342s/iter; left time: 518.7999s
	iters: 300, epoch: 4 | loss: 0.0170885
	speed: 0.0342s/iter; left time: 515.9864s
	iters: 400, epoch: 4 | loss: 0.0159648
	speed: 0.0341s/iter; left time: 510.8793s
	iters: 500, epoch: 4 | loss: 0.0150804
	speed: 0.0340s/iter; left time: 505.8713s
	iters: 600, epoch: 4 | loss: 0.0142211
	speed: 0.0334s/iter; left time: 493.0794s
	iters: 700, epoch: 4 | loss: 0.0189483
	speed: 0.0350s/iter; left time: 513.6063s
	iters: 800, epoch: 4 | loss: 0.0140306
	speed: 0.0349s/iter; left time: 508.0224s
	iters: 900, epoch: 4 | loss: 0.0153686
	speed: 0.0340s/iter; left time: 491.4557s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:31.40s
Steps: 904 | Train Loss: 0.0166229 Vali Loss: 0.0166674 Test Loss: 0.0183428
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0166662
	speed: 0.0984s/iter; left time: 1413.9751s
	iters: 200, epoch: 5 | loss: 0.0135682
	speed: 0.0341s/iter; left time: 485.7783s
	iters: 300, epoch: 5 | loss: 0.0158774
	speed: 0.0338s/iter; left time: 478.6189s
	iters: 400, epoch: 5 | loss: 0.0165986
	speed: 0.0331s/iter; left time: 465.6397s
	iters: 500, epoch: 5 | loss: 0.0149370
	speed: 0.0350s/iter; left time: 488.1823s
	iters: 600, epoch: 5 | loss: 0.0161001
	speed: 0.0340s/iter; left time: 471.1151s
	iters: 700, epoch: 5 | loss: 0.0142459
	speed: 0.0354s/iter; left time: 487.4808s
	iters: 800, epoch: 5 | loss: 0.0150630
	speed: 0.0343s/iter; left time: 468.1941s
	iters: 900, epoch: 5 | loss: 0.0157289
	speed: 0.0361s/iter; left time: 489.2616s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.54s
Steps: 904 | Train Loss: 0.0152686 Vali Loss: 0.0166363 Test Loss: 0.0196131
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0172512
	speed: 0.0995s/iter; left time: 1339.8299s
	iters: 200, epoch: 6 | loss: 0.0152996
	speed: 0.0336s/iter; left time: 448.5455s
	iters: 300, epoch: 6 | loss: 0.0147258
	speed: 0.0342s/iter; left time: 454.0363s
	iters: 400, epoch: 6 | loss: 0.0128632
	speed: 0.0347s/iter; left time: 456.7381s
	iters: 500, epoch: 6 | loss: 0.0138966
	speed: 0.0338s/iter; left time: 440.9587s
	iters: 600, epoch: 6 | loss: 0.0140565
	speed: 0.0350s/iter; left time: 453.9571s
	iters: 700, epoch: 6 | loss: 0.0149950
	speed: 0.0340s/iter; left time: 437.2851s
	iters: 800, epoch: 6 | loss: 0.0133245
	speed: 0.0344s/iter; left time: 438.4345s
	iters: 900, epoch: 6 | loss: 0.0130404
	speed: 0.0341s/iter; left time: 432.1065s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.41s
Steps: 904 | Train Loss: 0.0141668 Vali Loss: 0.0181570 Test Loss: 0.0206778
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0123304
	speed: 0.1006s/iter; left time: 1263.1123s
	iters: 200, epoch: 7 | loss: 0.0136654
	speed: 0.0351s/iter; left time: 437.7539s
	iters: 300, epoch: 7 | loss: 0.0142162
	speed: 0.0339s/iter; left time: 418.6839s
	iters: 400, epoch: 7 | loss: 0.0128690
	speed: 0.0376s/iter; left time: 460.7830s
	iters: 500, epoch: 7 | loss: 0.0128486
	speed: 0.0441s/iter; left time: 535.7995s
	iters: 600, epoch: 7 | loss: 0.0104035
	speed: 0.0470s/iter; left time: 566.8150s
	iters: 700, epoch: 7 | loss: 0.0125170
	speed: 0.0354s/iter; left time: 423.2105s
	iters: 800, epoch: 7 | loss: 0.0103865
	speed: 0.0335s/iter; left time: 397.0982s
	iters: 900, epoch: 7 | loss: 0.0143755
	speed: 0.0352s/iter; left time: 413.5079s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.22s
Steps: 904 | Train Loss: 0.0130236 Vali Loss: 0.0173678 Test Loss: 0.0208934
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0150618
	speed: 0.1098s/iter; left time: 1279.4604s
	iters: 200, epoch: 8 | loss: 0.0120275
	speed: 0.0351s/iter; left time: 405.2959s
	iters: 300, epoch: 8 | loss: 0.0121574
	speed: 0.0347s/iter; left time: 396.9476s
	iters: 400, epoch: 8 | loss: 0.0106792
	speed: 0.0338s/iter; left time: 383.5012s
	iters: 500, epoch: 8 | loss: 0.0111393
	speed: 0.0341s/iter; left time: 383.3223s
	iters: 600, epoch: 8 | loss: 0.0108992
	speed: 0.0357s/iter; left time: 397.9531s
	iters: 700, epoch: 8 | loss: 0.0118494
	speed: 0.0349s/iter; left time: 386.1100s
	iters: 800, epoch: 8 | loss: 0.0115658
	speed: 0.0349s/iter; left time: 382.1861s
	iters: 900, epoch: 8 | loss: 0.0098825
	speed: 0.0345s/iter; left time: 374.1554s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:32.77s
Steps: 904 | Train Loss: 0.0118994 Vali Loss: 0.0178741 Test Loss: 0.0224808
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018757950514554977, rmse:0.13695967197418213, mae:0.09164635092020035, rse:0.5178592801094055
Intermediate time for IT and pred_len 96: 00h:05m:30.33s
=== Starting experiments for pred_len: 168 ===

--- Running model for IT, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1080960
	speed: 0.0668s/iter; left time: 1198.2046s
	iters: 200, epoch: 1 | loss: 0.0824163
	speed: 0.0410s/iter; left time: 730.6883s
	iters: 300, epoch: 1 | loss: 0.0842993
	speed: 0.0466s/iter; left time: 826.2555s
	iters: 400, epoch: 1 | loss: 0.0736092
	speed: 0.0436s/iter; left time: 768.7929s
	iters: 500, epoch: 1 | loss: 0.0733240
	speed: 0.0486s/iter; left time: 851.9585s
	iters: 600, epoch: 1 | loss: 0.0706275
	speed: 0.0447s/iter; left time: 780.0874s
	iters: 700, epoch: 1 | loss: 0.0656435
	speed: 0.0461s/iter; left time: 799.3103s
	iters: 800, epoch: 1 | loss: 0.0658726
	speed: 0.0491s/iter; left time: 847.3773s
	iters: 900, epoch: 1 | loss: 0.0630696
	speed: 0.0458s/iter; left time: 785.7586s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.95s
Steps: 902 | Train Loss: 0.0786550 Vali Loss: 0.0498637 Test Loss: 0.0583538
Validation loss decreased (inf --> 0.049864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0482759
	speed: 0.1476s/iter; left time: 2514.7456s
	iters: 200, epoch: 2 | loss: 0.0421801
	speed: 0.0418s/iter; left time: 708.1329s
	iters: 300, epoch: 2 | loss: 0.0385429
	speed: 0.0454s/iter; left time: 764.3878s
	iters: 400, epoch: 2 | loss: 0.0367902
	speed: 0.0408s/iter; left time: 682.9286s
	iters: 500, epoch: 2 | loss: 0.0308838
	speed: 0.0421s/iter; left time: 701.2395s
	iters: 600, epoch: 2 | loss: 0.0255439
	speed: 0.0423s/iter; left time: 699.4867s
	iters: 700, epoch: 2 | loss: 0.0225206
	speed: 0.0465s/iter; left time: 764.8655s
	iters: 800, epoch: 2 | loss: 0.0219971
	speed: 0.0484s/iter; left time: 790.0311s
	iters: 900, epoch: 2 | loss: 0.0218719
	speed: 0.0456s/iter; left time: 740.5256s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.16s
Steps: 902 | Train Loss: 0.0340902 Vali Loss: 0.0191990 Test Loss: 0.0217300
Validation loss decreased (0.049864 --> 0.019199).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0235283
	speed: 0.1423s/iter; left time: 2296.4848s
	iters: 200, epoch: 3 | loss: 0.0206867
	speed: 0.0407s/iter; left time: 653.2566s
	iters: 300, epoch: 3 | loss: 0.0206621
	speed: 0.0485s/iter; left time: 773.1418s
	iters: 400, epoch: 3 | loss: 0.0177734
	speed: 0.0419s/iter; left time: 663.6464s
	iters: 500, epoch: 3 | loss: 0.0205937
	speed: 0.0455s/iter; left time: 716.7677s
	iters: 600, epoch: 3 | loss: 0.0205176
	speed: 0.0456s/iter; left time: 713.0480s
	iters: 700, epoch: 3 | loss: 0.0188191
	speed: 0.0452s/iter; left time: 701.6847s
	iters: 800, epoch: 3 | loss: 0.0180016
	speed: 0.0459s/iter; left time: 708.7676s
	iters: 900, epoch: 3 | loss: 0.0204296
	speed: 0.0446s/iter; left time: 683.8174s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.36s
Steps: 902 | Train Loss: 0.0200820 Vali Loss: 0.0191245 Test Loss: 0.0210825
Validation loss decreased (0.019199 --> 0.019124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0196903
	speed: 0.1273s/iter; left time: 1940.0853s
	iters: 200, epoch: 4 | loss: 0.0173575
	speed: 0.0442s/iter; left time: 668.9377s
	iters: 300, epoch: 4 | loss: 0.0186932
	speed: 0.0444s/iter; left time: 667.0606s
	iters: 400, epoch: 4 | loss: 0.0181120
	speed: 0.0450s/iter; left time: 671.6515s
	iters: 500, epoch: 4 | loss: 0.0186082
	speed: 0.0441s/iter; left time: 654.0079s
	iters: 600, epoch: 4 | loss: 0.0175178
	speed: 0.0495s/iter; left time: 728.8358s
	iters: 700, epoch: 4 | loss: 0.0184030
	speed: 0.0444s/iter; left time: 650.0754s
	iters: 800, epoch: 4 | loss: 0.0189094
	speed: 0.0421s/iter; left time: 611.4035s
	iters: 900, epoch: 4 | loss: 0.0182288
	speed: 0.0467s/iter; left time: 673.4291s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.26s
Steps: 902 | Train Loss: 0.0183361 Vali Loss: 0.0185760 Test Loss: 0.0211089
Validation loss decreased (0.019124 --> 0.018576).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0169285
	speed: 0.1335s/iter; left time: 1913.8118s
	iters: 200, epoch: 5 | loss: 0.0162984
	speed: 0.0455s/iter; left time: 647.1148s
	iters: 300, epoch: 5 | loss: 0.0175885
	speed: 0.0444s/iter; left time: 627.6361s
	iters: 400, epoch: 5 | loss: 0.0168064
	speed: 0.0421s/iter; left time: 590.5830s
	iters: 500, epoch: 5 | loss: 0.0158014
	speed: 0.0451s/iter; left time: 628.0847s
	iters: 600, epoch: 5 | loss: 0.0175041
	speed: 0.0419s/iter; left time: 579.9780s
	iters: 700, epoch: 5 | loss: 0.0175251
	speed: 0.0464s/iter; left time: 636.5337s
	iters: 800, epoch: 5 | loss: 0.0160738
	speed: 0.0449s/iter; left time: 612.4442s
	iters: 900, epoch: 5 | loss: 0.0180332
	speed: 0.0436s/iter; left time: 590.5206s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.40s
Steps: 902 | Train Loss: 0.0168270 Vali Loss: 0.0191929 Test Loss: 0.0207321
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0170055
	speed: 0.1245s/iter; left time: 1672.5048s
	iters: 200, epoch: 6 | loss: 0.0187532
	speed: 0.0473s/iter; left time: 630.4814s
	iters: 300, epoch: 6 | loss: 0.0166333
	speed: 0.0445s/iter; left time: 588.8341s
	iters: 400, epoch: 6 | loss: 0.0146327
	speed: 0.0452s/iter; left time: 594.0151s
	iters: 500, epoch: 6 | loss: 0.0151519
	speed: 0.0455s/iter; left time: 593.2302s
	iters: 600, epoch: 6 | loss: 0.0148442
	speed: 0.0422s/iter; left time: 546.0029s
	iters: 700, epoch: 6 | loss: 0.0146263
	speed: 0.0452s/iter; left time: 579.5969s
	iters: 800, epoch: 6 | loss: 0.0176119
	speed: 0.0457s/iter; left time: 582.4178s
	iters: 900, epoch: 6 | loss: 0.0159310
	speed: 0.0448s/iter; left time: 565.2726s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.05s
Steps: 902 | Train Loss: 0.0153580 Vali Loss: 0.0195957 Test Loss: 0.0217750
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0179181
	speed: 0.1228s/iter; left time: 1538.5915s
	iters: 200, epoch: 7 | loss: 0.0150460
	speed: 0.0460s/iter; left time: 571.9600s
	iters: 300, epoch: 7 | loss: 0.0146198
	speed: 0.0449s/iter; left time: 553.1517s
	iters: 400, epoch: 7 | loss: 0.0149516
	speed: 0.0448s/iter; left time: 547.4800s
	iters: 500, epoch: 7 | loss: 0.0124086
	speed: 0.0439s/iter; left time: 532.2308s
	iters: 600, epoch: 7 | loss: 0.0153495
	speed: 0.0469s/iter; left time: 564.0056s
	iters: 700, epoch: 7 | loss: 0.0124983
	speed: 0.0521s/iter; left time: 621.8838s
	iters: 800, epoch: 7 | loss: 0.0126885
	speed: 0.0520s/iter; left time: 615.5218s
	iters: 900, epoch: 7 | loss: 0.0129139
	speed: 0.0520s/iter; left time: 609.3312s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.18s
Steps: 902 | Train Loss: 0.0140290 Vali Loss: 0.0201149 Test Loss: 0.0227018
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0139799
	speed: 0.1212s/iter; left time: 1409.4176s
	iters: 200, epoch: 8 | loss: 0.0130178
	speed: 0.0517s/iter; left time: 595.7647s
	iters: 300, epoch: 8 | loss: 0.0146793
	speed: 0.0519s/iter; left time: 592.8671s
	iters: 400, epoch: 8 | loss: 0.0124940
	speed: 0.0517s/iter; left time: 585.7752s
	iters: 500, epoch: 8 | loss: 0.0133813
	speed: 0.0523s/iter; left time: 586.9921s
	iters: 600, epoch: 8 | loss: 0.0127013
	speed: 0.0521s/iter; left time: 579.8516s
	iters: 700, epoch: 8 | loss: 0.0136042
	speed: 0.0519s/iter; left time: 572.0377s
	iters: 800, epoch: 8 | loss: 0.0127588
	speed: 0.0519s/iter; left time: 566.5931s
	iters: 900, epoch: 8 | loss: 0.0109258
	speed: 0.0521s/iter; left time: 563.6564s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:47.13s
Steps: 902 | Train Loss: 0.0127591 Vali Loss: 0.0202601 Test Loss: 0.0218758
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0109588
	speed: 0.1229s/iter; left time: 1318.4384s
	iters: 200, epoch: 9 | loss: 0.0122424
	speed: 0.0508s/iter; left time: 539.5256s
	iters: 300, epoch: 9 | loss: 0.0136600
	speed: 0.0522s/iter; left time: 549.4978s
	iters: 400, epoch: 9 | loss: 0.0114705
	speed: 0.0499s/iter; left time: 520.0693s
	iters: 500, epoch: 9 | loss: 0.0127231
	speed: 0.0520s/iter; left time: 537.2253s
	iters: 600, epoch: 9 | loss: 0.0126706
	speed: 0.0514s/iter; left time: 525.9851s
	iters: 700, epoch: 9 | loss: 0.0122179
	speed: 0.0521s/iter; left time: 527.4878s
	iters: 800, epoch: 9 | loss: 0.0115100
	speed: 0.0519s/iter; left time: 519.8266s
	iters: 900, epoch: 9 | loss: 0.0118221
	speed: 0.0519s/iter; left time: 514.6659s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:46.90s
Steps: 902 | Train Loss: 0.0116011 Vali Loss: 0.0210053 Test Loss: 0.0222173
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021097851917147636, rmse:0.14525099098682404, mae:0.09748273342847824, rse:0.5495890974998474
Intermediate time for IT and pred_len 168: 00h:07m:45.72sIntermediate time for IT: 00h:21m:41.84sTotal time: 01h:56m:54.90s