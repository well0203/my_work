
=== Starting experiments for country: GB ===

=== Starting experiments for pred_len: 24 ===

--- Running model for GB, pred_len=24 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_96_24_GB', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_96_24_GB_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0764679
	speed: 0.0758s/iter; left time: 1366.7560s
	iters: 200, epoch: 1 | loss: 0.0657391
	speed: 0.0462s/iter; left time: 828.6651s
	iters: 300, epoch: 1 | loss: 0.0562565
	speed: 0.0461s/iter; left time: 821.3823s
	iters: 400, epoch: 1 | loss: 0.0548274
	speed: 0.0428s/iter; left time: 757.6466s
	iters: 500, epoch: 1 | loss: 0.0477097
	speed: 0.0414s/iter; left time: 729.4165s
	iters: 600, epoch: 1 | loss: 0.0463367
	speed: 0.0413s/iter; left time: 723.7216s
	iters: 700, epoch: 1 | loss: 0.0439485
	speed: 0.0429s/iter; left time: 746.5383s
	iters: 800, epoch: 1 | loss: 0.0382239
	speed: 0.0473s/iter; left time: 819.5221s
	iters: 900, epoch: 1 | loss: 0.0366430
	speed: 0.0467s/iter; left time: 804.5277s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.14s
Steps: 906 | Train Loss: 0.0594367 Vali Loss: 0.0429403 Test Loss: 0.0600197
Validation loss decreased (inf --> 0.042940).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0303652
	speed: 0.1042s/iter; left time: 1784.1190s
	iters: 200, epoch: 2 | loss: 0.0261540
	speed: 0.0473s/iter; left time: 804.5889s
	iters: 300, epoch: 2 | loss: 0.0150766
	speed: 0.0470s/iter; left time: 794.2834s
	iters: 400, epoch: 2 | loss: 0.0167487
	speed: 0.0466s/iter; left time: 782.8286s
	iters: 500, epoch: 2 | loss: 0.0202715
	speed: 0.0461s/iter; left time: 769.9011s
	iters: 600, epoch: 2 | loss: 0.0124757
	speed: 0.0463s/iter; left time: 769.8667s
	iters: 700, epoch: 2 | loss: 0.0234306
	speed: 0.0461s/iter; left time: 761.6331s
	iters: 800, epoch: 2 | loss: 0.0192762
	speed: 0.0459s/iter; left time: 752.6298s
	iters: 900, epoch: 2 | loss: 0.0130124
	speed: 0.0465s/iter; left time: 759.2532s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.25s
Steps: 906 | Train Loss: 0.0197113 Vali Loss: 0.0220081 Test Loss: 0.0308800
Validation loss decreased (0.042940 --> 0.022008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0158460
	speed: 0.0993s/iter; left time: 1609.6451s
	iters: 200, epoch: 3 | loss: 0.0151482
	speed: 0.0412s/iter; left time: 664.3162s
	iters: 300, epoch: 3 | loss: 0.0177428
	speed: 0.0433s/iter; left time: 692.4326s
	iters: 400, epoch: 3 | loss: 0.0127546
	speed: 0.0415s/iter; left time: 659.6006s
	iters: 500, epoch: 3 | loss: 0.0152168
	speed: 0.0414s/iter; left time: 654.9877s
	iters: 600, epoch: 3 | loss: 0.0130471
	speed: 0.0413s/iter; left time: 648.0942s
	iters: 700, epoch: 3 | loss: 0.0149760
	speed: 0.0455s/iter; left time: 709.5643s
	iters: 800, epoch: 3 | loss: 0.0108637
	speed: 0.0464s/iter; left time: 719.7219s
	iters: 900, epoch: 3 | loss: 0.0151149
	speed: 0.0464s/iter; left time: 715.2005s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:39.53s
Steps: 906 | Train Loss: 0.0149118 Vali Loss: 0.0218676 Test Loss: 0.0311270
Validation loss decreased (0.022008 --> 0.021868).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0119106
	speed: 0.0999s/iter; left time: 1528.0759s
	iters: 200, epoch: 4 | loss: 0.0157133
	speed: 0.0465s/iter; left time: 706.5120s
	iters: 300, epoch: 4 | loss: 0.0150046
	speed: 0.0464s/iter; left time: 700.4594s
	iters: 400, epoch: 4 | loss: 0.0168810
	speed: 0.0468s/iter; left time: 701.5732s
	iters: 500, epoch: 4 | loss: 0.0203729
	speed: 0.0466s/iter; left time: 695.0318s
	iters: 600, epoch: 4 | loss: 0.0154422
	speed: 0.0460s/iter; left time: 680.2294s
	iters: 700, epoch: 4 | loss: 0.0118690
	speed: 0.0435s/iter; left time: 639.4654s
	iters: 800, epoch: 4 | loss: 0.0124499
	speed: 0.0466s/iter; left time: 680.8255s
	iters: 900, epoch: 4 | loss: 0.0121385
	speed: 0.0458s/iter; left time: 664.7619s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.93s
Steps: 906 | Train Loss: 0.0138662 Vali Loss: 0.0221879 Test Loss: 0.0294972
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0200112
	speed: 0.0942s/iter; left time: 1355.9903s
	iters: 200, epoch: 5 | loss: 0.0109799
	speed: 0.0474s/iter; left time: 677.9581s
	iters: 300, epoch: 5 | loss: 0.0117807
	speed: 0.0471s/iter; left time: 668.1902s
	iters: 400, epoch: 5 | loss: 0.0172931
	speed: 0.0463s/iter; left time: 652.6405s
	iters: 500, epoch: 5 | loss: 0.0109414
	speed: 0.0468s/iter; left time: 654.4330s
	iters: 600, epoch: 5 | loss: 0.0122645
	speed: 0.0470s/iter; left time: 653.2040s
	iters: 700, epoch: 5 | loss: 0.0151734
	speed: 0.0459s/iter; left time: 633.9620s
	iters: 800, epoch: 5 | loss: 0.0145623
	speed: 0.0462s/iter; left time: 633.3743s
	iters: 900, epoch: 5 | loss: 0.0112677
	speed: 0.0469s/iter; left time: 638.3172s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.51s
Steps: 906 | Train Loss: 0.0130095 Vali Loss: 0.0240887 Test Loss: 0.0324934
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0120146
	speed: 0.0936s/iter; left time: 1262.4139s
	iters: 200, epoch: 6 | loss: 0.0134536
	speed: 0.0411s/iter; left time: 550.8468s
	iters: 300, epoch: 6 | loss: 0.0109227
	speed: 0.0411s/iter; left time: 545.6947s
	iters: 400, epoch: 6 | loss: 0.0137217
	speed: 0.0471s/iter; left time: 621.0566s
	iters: 500, epoch: 6 | loss: 0.0131301
	speed: 0.0455s/iter; left time: 595.3180s
	iters: 600, epoch: 6 | loss: 0.0103798
	speed: 0.0467s/iter; left time: 607.0220s
	iters: 700, epoch: 6 | loss: 0.0114151
	speed: 0.0463s/iter; left time: 596.6293s
	iters: 800, epoch: 6 | loss: 0.0096706
	speed: 0.0463s/iter; left time: 592.4021s
	iters: 900, epoch: 6 | loss: 0.0158617
	speed: 0.0468s/iter; left time: 593.3785s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.27s
Steps: 906 | Train Loss: 0.0120912 Vali Loss: 0.0258931 Test Loss: 0.0350914
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0107834
	speed: 0.0922s/iter; left time: 1160.0097s
	iters: 200, epoch: 7 | loss: 0.0110156
	speed: 0.0472s/iter; left time: 589.8094s
	iters: 300, epoch: 7 | loss: 0.0107683
	speed: 0.0428s/iter; left time: 530.4415s
	iters: 400, epoch: 7 | loss: 0.0116925
	speed: 0.0413s/iter; left time: 507.5918s
	iters: 500, epoch: 7 | loss: 0.0104368
	speed: 0.0449s/iter; left time: 546.8833s
	iters: 600, epoch: 7 | loss: 0.0069574
	speed: 0.0459s/iter; left time: 554.8449s
	iters: 700, epoch: 7 | loss: 0.0106184
	speed: 0.0465s/iter; left time: 557.7375s
	iters: 800, epoch: 7 | loss: 0.0090532
	speed: 0.0473s/iter; left time: 562.6580s
	iters: 900, epoch: 7 | loss: 0.0105725
	speed: 0.0459s/iter; left time: 540.5507s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:41.22s
Steps: 906 | Train Loss: 0.0112189 Vali Loss: 0.0227329 Test Loss: 0.0320340
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0106522
	speed: 0.0939s/iter; left time: 1097.1025s
	iters: 200, epoch: 8 | loss: 0.0081547
	speed: 0.0466s/iter; left time: 540.0157s
	iters: 300, epoch: 8 | loss: 0.0101518
	speed: 0.0471s/iter; left time: 540.4347s
	iters: 400, epoch: 8 | loss: 0.0103827
	speed: 0.0469s/iter; left time: 533.6337s
	iters: 500, epoch: 8 | loss: 0.0097602
	speed: 0.0467s/iter; left time: 526.9957s
	iters: 600, epoch: 8 | loss: 0.0106588
	speed: 0.0471s/iter; left time: 526.8117s
	iters: 700, epoch: 8 | loss: 0.0106670
	speed: 0.0470s/iter; left time: 520.7833s
	iters: 800, epoch: 8 | loss: 0.0084209
	speed: 0.0455s/iter; left time: 499.9283s
	iters: 900, epoch: 8 | loss: 0.0084942
	speed: 0.0436s/iter; left time: 474.5200s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.21s
Steps: 906 | Train Loss: 0.0102566 Vali Loss: 0.0264436 Test Loss: 0.0365799
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_96_24_GB_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.031130269169807434, rmse:0.17643772065639496, mae:0.12031001597642899, rse:0.6083531379699707
Intermediate time for GB and pred_len 24: 00h:06m:20.86s
=== Starting experiments for pred_len: 96 ===

--- Running model for GB, pred_len=96 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_96_96_GB', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_96_96_GB_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0893760
	speed: 0.0771s/iter; left time: 1386.5858s
	iters: 200, epoch: 1 | loss: 0.0699951
	speed: 0.0478s/iter; left time: 854.5878s
	iters: 300, epoch: 1 | loss: 0.0674433
	speed: 0.0480s/iter; left time: 853.9300s
	iters: 400, epoch: 1 | loss: 0.0645395
	speed: 0.0489s/iter; left time: 864.4706s
	iters: 500, epoch: 1 | loss: 0.0576673
	speed: 0.0483s/iter; left time: 848.8444s
	iters: 600, epoch: 1 | loss: 0.0536212
	speed: 0.0477s/iter; left time: 833.7362s
	iters: 700, epoch: 1 | loss: 0.0497722
	speed: 0.0484s/iter; left time: 841.1261s
	iters: 800, epoch: 1 | loss: 0.0523500
	speed: 0.0484s/iter; left time: 836.7344s
	iters: 900, epoch: 1 | loss: 0.0492230
	speed: 0.0483s/iter; left time: 829.6894s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.40s
Steps: 904 | Train Loss: 0.0649915 Vali Loss: 0.0547138 Test Loss: 0.0850027
Validation loss decreased (inf --> 0.054714).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0341445
	speed: 0.1083s/iter; left time: 1848.9912s
	iters: 200, epoch: 2 | loss: 0.0328115
	speed: 0.0477s/iter; left time: 809.6190s
	iters: 300, epoch: 2 | loss: 0.0280633
	speed: 0.0472s/iter; left time: 797.4198s
	iters: 400, epoch: 2 | loss: 0.0278533
	speed: 0.0486s/iter; left time: 815.4622s
	iters: 500, epoch: 2 | loss: 0.0259066
	speed: 0.0486s/iter; left time: 810.1108s
	iters: 600, epoch: 2 | loss: 0.0295652
	speed: 0.0487s/iter; left time: 806.7384s
	iters: 700, epoch: 2 | loss: 0.0231918
	speed: 0.0479s/iter; left time: 788.7876s
	iters: 800, epoch: 2 | loss: 0.0256015
	speed: 0.0476s/iter; left time: 778.8492s
	iters: 900, epoch: 2 | loss: 0.0304700
	speed: 0.0489s/iter; left time: 796.3451s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.64s
Steps: 904 | Train Loss: 0.0301226 Vali Loss: 0.0388117 Test Loss: 0.0579192
Validation loss decreased (0.054714 --> 0.038812).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0234212
	speed: 0.1146s/iter; left time: 1853.1882s
	iters: 200, epoch: 3 | loss: 0.0262930
	speed: 0.0485s/iter; left time: 778.8745s
	iters: 300, epoch: 3 | loss: 0.0239697
	speed: 0.0477s/iter; left time: 762.6793s
	iters: 400, epoch: 3 | loss: 0.0237850
	speed: 0.0472s/iter; left time: 748.9891s
	iters: 500, epoch: 3 | loss: 0.0224860
	speed: 0.0487s/iter; left time: 768.5099s
	iters: 600, epoch: 3 | loss: 0.0251826
	speed: 0.0487s/iter; left time: 763.4707s
	iters: 700, epoch: 3 | loss: 0.0222447
	speed: 0.0479s/iter; left time: 746.6295s
	iters: 800, epoch: 3 | loss: 0.0206792
	speed: 0.0479s/iter; left time: 741.5689s
	iters: 900, epoch: 3 | loss: 0.0221146
	speed: 0.0482s/iter; left time: 740.9391s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.82s
Steps: 904 | Train Loss: 0.0232364 Vali Loss: 0.0331869 Test Loss: 0.0506150
Validation loss decreased (0.038812 --> 0.033187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0239859
	speed: 0.1116s/iter; left time: 1703.9495s
	iters: 200, epoch: 4 | loss: 0.0222580
	speed: 0.0489s/iter; left time: 741.4599s
	iters: 300, epoch: 4 | loss: 0.0253674
	speed: 0.0482s/iter; left time: 726.1311s
	iters: 400, epoch: 4 | loss: 0.0194161
	speed: 0.0480s/iter; left time: 718.8724s
	iters: 500, epoch: 4 | loss: 0.0188118
	speed: 0.0483s/iter; left time: 718.5034s
	iters: 600, epoch: 4 | loss: 0.0208789
	speed: 0.0472s/iter; left time: 697.7479s
	iters: 700, epoch: 4 | loss: 0.0178792
	speed: 0.0483s/iter; left time: 708.7075s
	iters: 800, epoch: 4 | loss: 0.0212071
	speed: 0.0485s/iter; left time: 706.0308s
	iters: 900, epoch: 4 | loss: 0.0216732
	speed: 0.0487s/iter; left time: 705.3533s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.91s
Steps: 904 | Train Loss: 0.0205480 Vali Loss: 0.0346284 Test Loss: 0.0530353
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0180327
	speed: 0.1026s/iter; left time: 1474.5301s
	iters: 200, epoch: 5 | loss: 0.0200579
	speed: 0.0466s/iter; left time: 664.2468s
	iters: 300, epoch: 5 | loss: 0.0168916
	speed: 0.0472s/iter; left time: 668.4474s
	iters: 400, epoch: 5 | loss: 0.0205630
	speed: 0.0483s/iter; left time: 678.9023s
	iters: 500, epoch: 5 | loss: 0.0182274
	speed: 0.0476s/iter; left time: 664.2421s
	iters: 600, epoch: 5 | loss: 0.0207174
	speed: 0.0485s/iter; left time: 672.5713s
	iters: 700, epoch: 5 | loss: 0.0234901
	speed: 0.0483s/iter; left time: 664.1794s
	iters: 800, epoch: 5 | loss: 0.0209549
	speed: 0.0479s/iter; left time: 654.5739s
	iters: 900, epoch: 5 | loss: 0.0205995
	speed: 0.0487s/iter; left time: 661.2406s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.50s
Steps: 904 | Train Loss: 0.0186726 Vali Loss: 0.0334696 Test Loss: 0.0521068
EarlyStopping counter: 2 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0173234
	speed: 0.1095s/iter; left time: 1474.0086s
	iters: 200, epoch: 6 | loss: 0.0156628
	speed: 0.0485s/iter; left time: 648.0930s
	iters: 300, epoch: 6 | loss: 0.0159969
	speed: 0.0491s/iter; left time: 651.0299s
	iters: 400, epoch: 6 | loss: 0.0178492
	speed: 0.0485s/iter; left time: 637.6560s
	iters: 500, epoch: 6 | loss: 0.0150308
	speed: 0.0494s/iter; left time: 644.9581s
	iters: 600, epoch: 6 | loss: 0.0172063
	speed: 0.0481s/iter; left time: 623.9105s
	iters: 700, epoch: 6 | loss: 0.0152361
	speed: 0.0471s/iter; left time: 605.9831s
	iters: 800, epoch: 6 | loss: 0.0163435
	speed: 0.0472s/iter; left time: 602.5518s
	iters: 900, epoch: 6 | loss: 0.0171424
	speed: 0.0481s/iter; left time: 608.9784s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.88s
Steps: 904 | Train Loss: 0.0166152 Vali Loss: 0.0380499 Test Loss: 0.0581647
EarlyStopping counter: 3 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0139970
	speed: 0.1053s/iter; left time: 1322.0537s
	iters: 200, epoch: 7 | loss: 0.0148535
	speed: 0.0484s/iter; left time: 602.5231s
	iters: 300, epoch: 7 | loss: 0.0137906
	speed: 0.0463s/iter; left time: 572.2347s
	iters: 400, epoch: 7 | loss: 0.0162590
	speed: 0.0478s/iter; left time: 585.8204s
	iters: 500, epoch: 7 | loss: 0.0165481
	speed: 0.0502s/iter; left time: 609.8847s
	iters: 600, epoch: 7 | loss: 0.0164570
	speed: 0.0503s/iter; left time: 606.7374s
	iters: 700, epoch: 7 | loss: 0.0176711
	speed: 0.0482s/iter; left time: 575.8652s
	iters: 800, epoch: 7 | loss: 0.0125647
	speed: 0.0490s/iter; left time: 581.4989s
	iters: 900, epoch: 7 | loss: 0.0137664
	speed: 0.0484s/iter; left time: 569.3538s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:44.13s
Steps: 904 | Train Loss: 0.0148866 Vali Loss: 0.0356738 Test Loss: 0.0604467
EarlyStopping counter: 4 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0133834
	speed: 0.0895s/iter; left time: 1042.6091s
	iters: 200, epoch: 8 | loss: 0.0131127
	speed: 0.0482s/iter; left time: 556.9965s
	iters: 300, epoch: 8 | loss: 0.0137572
	speed: 0.0477s/iter; left time: 545.9729s
	iters: 400, epoch: 8 | loss: 0.0119892
	speed: 0.0478s/iter; left time: 542.4755s
	iters: 500, epoch: 8 | loss: 0.0147413
	speed: 0.0481s/iter; left time: 541.4741s
	iters: 600, epoch: 8 | loss: 0.0135280
	speed: 0.0480s/iter; left time: 534.8598s
	iters: 700, epoch: 8 | loss: 0.0128642
	speed: 0.0480s/iter; left time: 530.6420s
	iters: 800, epoch: 8 | loss: 0.0143640
	speed: 0.0486s/iter; left time: 532.8132s
	iters: 900, epoch: 8 | loss: 0.0136676
	speed: 0.0483s/iter; left time: 523.9539s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.45s
Steps: 904 | Train Loss: 0.0132417 Vali Loss: 0.0376644 Test Loss: 0.0605138
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_96_96_GB_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.05061672627925873, rmse:0.22498160600662231, mae:0.1600819081068039, rse:0.7780177593231201
Intermediate time for GB and pred_len 96: 00h:06m:47.22s
=== Starting experiments for pred_len: 168 ===

--- Running model for GB, pred_len=168 ---
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='GB_96_168_GB', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='GB_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=False, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : GB_96_168_GB_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0828232
	speed: 0.0798s/iter; left time: 1431.9005s
	iters: 200, epoch: 1 | loss: 0.0749127
	speed: 0.0515s/iter; left time: 919.2858s
	iters: 300, epoch: 1 | loss: 0.0620970
	speed: 0.0510s/iter; left time: 904.3161s
	iters: 400, epoch: 1 | loss: 0.0595553
	speed: 0.0451s/iter; left time: 795.3632s
	iters: 500, epoch: 1 | loss: 0.0616825
	speed: 0.0435s/iter; left time: 762.7402s
	iters: 600, epoch: 1 | loss: 0.0584624
	speed: 0.0487s/iter; left time: 849.7259s
	iters: 700, epoch: 1 | loss: 0.0525494
	speed: 0.0447s/iter; left time: 775.2312s
	iters: 800, epoch: 1 | loss: 0.0509944
	speed: 0.0462s/iter; left time: 796.0521s
	iters: 900, epoch: 1 | loss: 0.0496514
	speed: 0.0421s/iter; left time: 721.8641s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.24s
Steps: 902 | Train Loss: 0.0657342 Vali Loss: 0.0569065 Test Loss: 0.0867981
Validation loss decreased (inf --> 0.056906).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0415353
	speed: 0.1158s/iter; left time: 1973.2567s
	iters: 200, epoch: 2 | loss: 0.0353375
	speed: 0.0497s/iter; left time: 841.3736s
	iters: 300, epoch: 2 | loss: 0.0351734
	speed: 0.0507s/iter; left time: 854.4021s
	iters: 400, epoch: 2 | loss: 0.0284817
	speed: 0.0495s/iter; left time: 828.2770s
	iters: 500, epoch: 2 | loss: 0.0283058
	speed: 0.0514s/iter; left time: 854.6885s
	iters: 600, epoch: 2 | loss: 0.0289276
	speed: 0.0507s/iter; left time: 838.2517s
	iters: 700, epoch: 2 | loss: 0.0289890
	speed: 0.0446s/iter; left time: 733.8829s
	iters: 800, epoch: 2 | loss: 0.0284246
	speed: 0.0498s/iter; left time: 813.6006s
	iters: 900, epoch: 2 | loss: 0.0308674
	speed: 0.0498s/iter; left time: 808.1484s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:44.56s
Steps: 902 | Train Loss: 0.0330005 Vali Loss: 0.0403766 Test Loss: 0.0631403
Validation loss decreased (0.056906 --> 0.040377).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0281291
	speed: 0.1277s/iter; left time: 2060.7461s
	iters: 200, epoch: 3 | loss: 0.0253809
	speed: 0.0510s/iter; left time: 818.6629s
	iters: 300, epoch: 3 | loss: 0.0304348
	speed: 0.0464s/iter; left time: 739.8460s
	iters: 400, epoch: 3 | loss: 0.0270059
	speed: 0.0479s/iter; left time: 758.9623s
	iters: 500, epoch: 3 | loss: 0.0259681
	speed: 0.0449s/iter; left time: 706.9402s
	iters: 600, epoch: 3 | loss: 0.0313333
	speed: 0.0437s/iter; left time: 683.0197s
	iters: 700, epoch: 3 | loss: 0.0257676
	speed: 0.0485s/iter; left time: 754.1090s
	iters: 800, epoch: 3 | loss: 0.0252682
	speed: 0.0448s/iter; left time: 691.4457s
	iters: 900, epoch: 3 | loss: 0.0248985
	speed: 0.0448s/iter; left time: 687.0964s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.53s
Steps: 902 | Train Loss: 0.0268744 Vali Loss: 0.0439434 Test Loss: 0.0653365
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0279412
	speed: 0.1087s/iter; left time: 1655.2970s
	iters: 200, epoch: 4 | loss: 0.0242079
	speed: 0.0515s/iter; left time: 779.8743s
	iters: 300, epoch: 4 | loss: 0.0269835
	speed: 0.0482s/iter; left time: 724.6813s
	iters: 400, epoch: 4 | loss: 0.0255507
	speed: 0.0493s/iter; left time: 736.8745s
	iters: 500, epoch: 4 | loss: 0.0225070
	speed: 0.0490s/iter; left time: 726.9783s
	iters: 600, epoch: 4 | loss: 0.0230421
	speed: 0.0465s/iter; left time: 685.7421s
	iters: 700, epoch: 4 | loss: 0.0248679
	speed: 0.0446s/iter; left time: 652.6208s
	iters: 800, epoch: 4 | loss: 0.0225724
	speed: 0.0466s/iter; left time: 677.3341s
	iters: 900, epoch: 4 | loss: 0.0205266
	speed: 0.0507s/iter; left time: 731.9488s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.61s
Steps: 902 | Train Loss: 0.0245145 Vali Loss: 0.0396597 Test Loss: 0.0621735
Validation loss decreased (0.040377 --> 0.039660).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0214768
	speed: 0.1148s/iter; left time: 1644.8283s
	iters: 200, epoch: 5 | loss: 0.0234881
	speed: 0.0434s/iter; left time: 618.2559s
	iters: 300, epoch: 5 | loss: 0.0215285
	speed: 0.0502s/iter; left time: 710.1507s
	iters: 400, epoch: 5 | loss: 0.0217437
	speed: 0.0490s/iter; left time: 687.4988s
	iters: 500, epoch: 5 | loss: 0.0214513
	speed: 0.0457s/iter; left time: 637.1036s
	iters: 600, epoch: 5 | loss: 0.0207977
	speed: 0.0444s/iter; left time: 614.7112s
	iters: 700, epoch: 5 | loss: 0.0178466
	speed: 0.0433s/iter; left time: 594.3988s
	iters: 800, epoch: 5 | loss: 0.0219532
	speed: 0.0466s/iter; left time: 635.3836s
	iters: 900, epoch: 5 | loss: 0.0201745
	speed: 0.0465s/iter; left time: 629.1004s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.78s
Steps: 902 | Train Loss: 0.0214388 Vali Loss: 0.0403047 Test Loss: 0.0659283
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0192441
	speed: 0.1159s/iter; left time: 1557.1226s
	iters: 200, epoch: 6 | loss: 0.0194779
	speed: 0.0498s/iter; left time: 663.6091s
	iters: 300, epoch: 6 | loss: 0.0164167
	speed: 0.0473s/iter; left time: 626.0888s
	iters: 400, epoch: 6 | loss: 0.0161506
	speed: 0.0480s/iter; left time: 630.2631s
	iters: 500, epoch: 6 | loss: 0.0196075
	speed: 0.0443s/iter; left time: 576.6737s
	iters: 600, epoch: 6 | loss: 0.0166038
	speed: 0.0430s/iter; left time: 556.3854s
	iters: 700, epoch: 6 | loss: 0.0136157
	speed: 0.0423s/iter; left time: 542.8662s
	iters: 800, epoch: 6 | loss: 0.0160816
	speed: 0.0406s/iter; left time: 516.5055s
	iters: 900, epoch: 6 | loss: 0.0160592
	speed: 0.0487s/iter; left time: 615.6642s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.75s
Steps: 902 | Train Loss: 0.0170734 Vali Loss: 0.0388602 Test Loss: 0.0664243
Validation loss decreased (0.039660 --> 0.038860).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0169348
	speed: 0.1197s/iter; left time: 1499.2094s
	iters: 200, epoch: 7 | loss: 0.0150197
	speed: 0.0498s/iter; left time: 618.6299s
	iters: 300, epoch: 7 | loss: 0.0177164
	speed: 0.0515s/iter; left time: 634.8088s
	iters: 400, epoch: 7 | loss: 0.0144806
	speed: 0.0467s/iter; left time: 571.1652s
	iters: 500, epoch: 7 | loss: 0.0147240
	speed: 0.0456s/iter; left time: 552.4845s
	iters: 600, epoch: 7 | loss: 0.0131048
	speed: 0.0433s/iter; left time: 521.1404s
	iters: 700, epoch: 7 | loss: 0.0154541
	speed: 0.0421s/iter; left time: 502.5001s
	iters: 800, epoch: 7 | loss: 0.0132857
	speed: 0.0407s/iter; left time: 481.6981s
	iters: 900, epoch: 7 | loss: 0.0172589
	speed: 0.0515s/iter; left time: 604.4133s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.38s
Steps: 902 | Train Loss: 0.0149902 Vali Loss: 0.0377542 Test Loss: 0.0672273
Validation loss decreased (0.038860 --> 0.037754).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0124112
	speed: 0.1281s/iter; left time: 1489.3496s
	iters: 200, epoch: 8 | loss: 0.0133382
	speed: 0.0456s/iter; left time: 525.3094s
	iters: 300, epoch: 8 | loss: 0.0144903
	speed: 0.0450s/iter; left time: 514.1598s
	iters: 400, epoch: 8 | loss: 0.0129757
	speed: 0.0449s/iter; left time: 508.2410s
	iters: 500, epoch: 8 | loss: 0.0129781
	speed: 0.0482s/iter; left time: 540.6267s
	iters: 600, epoch: 8 | loss: 0.0131203
	speed: 0.0509s/iter; left time: 566.6880s
	iters: 700, epoch: 8 | loss: 0.0113418
	speed: 0.0464s/iter; left time: 511.7481s
	iters: 800, epoch: 8 | loss: 0.0117694
	speed: 0.0422s/iter; left time: 460.9609s
	iters: 900, epoch: 8 | loss: 0.0125589
	speed: 0.0458s/iter; left time: 495.9403s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.33s
Steps: 902 | Train Loss: 0.0136115 Vali Loss: 0.0394928 Test Loss: 0.0707811
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0127657
	speed: 0.1156s/iter; left time: 1239.8685s
	iters: 200, epoch: 9 | loss: 0.0124597
	speed: 0.0510s/iter; left time: 541.8199s
	iters: 300, epoch: 9 | loss: 0.0134299
	speed: 0.0483s/iter; left time: 508.7619s
	iters: 400, epoch: 9 | loss: 0.0110699
	speed: 0.0440s/iter; left time: 458.2046s
	iters: 500, epoch: 9 | loss: 0.0132655
	speed: 0.0449s/iter; left time: 464.1038s
	iters: 600, epoch: 9 | loss: 0.0112603
	speed: 0.0476s/iter; left time: 486.7437s
	iters: 700, epoch: 9 | loss: 0.0130516
	speed: 0.0503s/iter; left time: 509.4891s
	iters: 800, epoch: 9 | loss: 0.0126161
	speed: 0.0503s/iter; left time: 504.1978s
	iters: 900, epoch: 9 | loss: 0.0119859
	speed: 0.0475s/iter; left time: 471.7056s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:43.53s
Steps: 902 | Train Loss: 0.0123658 Vali Loss: 0.0383595 Test Loss: 0.0662519
EarlyStopping counter: 2 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0107819
	speed: 0.1182s/iter; left time: 1160.9095s
	iters: 200, epoch: 10 | loss: 0.0127241
	speed: 0.0461s/iter; left time: 448.0598s
	iters: 300, epoch: 10 | loss: 0.0123100
	speed: 0.0513s/iter; left time: 494.1205s
	iters: 400, epoch: 10 | loss: 0.0109170
	speed: 0.0498s/iter; left time: 473.7998s
	iters: 500, epoch: 10 | loss: 0.0114692
	speed: 0.0472s/iter; left time: 444.5972s
	iters: 600, epoch: 10 | loss: 0.0110846
	speed: 0.0486s/iter; left time: 453.0009s
	iters: 700, epoch: 10 | loss: 0.0117878
	speed: 0.0487s/iter; left time: 448.9940s
	iters: 800, epoch: 10 | loss: 0.0111483
	speed: 0.0482s/iter; left time: 439.7616s
	iters: 900, epoch: 10 | loss: 0.0121212
	speed: 0.0502s/iter; left time: 452.7225s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:44.11s
Steps: 902 | Train Loss: 0.0112837 Vali Loss: 0.0393359 Test Loss: 0.0676974
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0106947
	speed: 0.1221s/iter; left time: 1089.5686s
	iters: 200, epoch: 11 | loss: 0.0114429
	speed: 0.0489s/iter; left time: 431.0235s
	iters: 300, epoch: 11 | loss: 0.0102906
	speed: 0.0497s/iter; left time: 433.6481s
	iters: 400, epoch: 11 | loss: 0.0102502
	speed: 0.0472s/iter; left time: 406.8472s
	iters: 500, epoch: 11 | loss: 0.0127098
	speed: 0.0486s/iter; left time: 414.2730s
	iters: 600, epoch: 11 | loss: 0.0100624
	speed: 0.0424s/iter; left time: 357.0879s
	iters: 700, epoch: 11 | loss: 0.0098379
	speed: 0.0435s/iter; left time: 362.1510s
	iters: 800, epoch: 11 | loss: 0.0095954
	speed: 0.0422s/iter; left time: 346.5217s
	iters: 900, epoch: 11 | loss: 0.0092578
	speed: 0.0478s/iter; left time: 387.8455s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:42.46s
Steps: 902 | Train Loss: 0.0103650 Vali Loss: 0.0400552 Test Loss: 0.0669268
EarlyStopping counter: 4 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0088414
	speed: 0.1224s/iter; left time: 981.7626s
	iters: 200, epoch: 12 | loss: 0.0110274
	speed: 0.0465s/iter; left time: 368.5353s
	iters: 300, epoch: 12 | loss: 0.0086307
	speed: 0.0481s/iter; left time: 375.9058s
	iters: 400, epoch: 12 | loss: 0.0093599
	speed: 0.0472s/iter; left time: 364.0621s
	iters: 500, epoch: 12 | loss: 0.0102409
	speed: 0.0456s/iter; left time: 347.0510s
	iters: 600, epoch: 12 | loss: 0.0096047
	speed: 0.0482s/iter; left time: 362.3747s
	iters: 700, epoch: 12 | loss: 0.0099307
	speed: 0.0472s/iter; left time: 350.2989s
	iters: 800, epoch: 12 | loss: 0.0111330
	speed: 0.0488s/iter; left time: 357.3821s
	iters: 900, epoch: 12 | loss: 0.0091989
	speed: 0.0491s/iter; left time: 354.2778s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:43.41s
Steps: 902 | Train Loss: 0.0096406 Vali Loss: 0.0401528 Test Loss: 0.0665900
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : GB_96_168_GB_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.06714829802513123, rmse:0.2591298818588257, mae:0.18294008076190948, rse:0.8983698487281799
Intermediate time for GB and pred_len 168: 00h:10m:12.15sIntermediate time for GB: 00h:23m:20.22sTotal time: 00h:23m:20.22s