
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4625300
	speed: 0.0721s/iter; left time: 646.2302s
	iters: 200, epoch: 1 | loss: 0.3509545
	speed: 0.0426s/iter; left time: 377.5256s
	iters: 300, epoch: 1 | loss: 0.2405195
	speed: 0.0422s/iter; left time: 369.8717s
	iters: 400, epoch: 1 | loss: 0.2214437
	speed: 0.0417s/iter; left time: 361.3671s
	iters: 500, epoch: 1 | loss: 0.1680605
	speed: 0.0416s/iter; left time: 356.0111s
	iters: 600, epoch: 1 | loss: 0.1663851
	speed: 0.0418s/iter; left time: 353.5010s
	iters: 700, epoch: 1 | loss: 0.1372963
	speed: 0.0422s/iter; left time: 352.5364s
	iters: 800, epoch: 1 | loss: 0.1458827
	speed: 0.0424s/iter; left time: 350.5665s
	iters: 900, epoch: 1 | loss: 0.1841954
	speed: 0.0452s/iter; left time: 368.6075s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.22s
Steps: 906 | Train Loss: 0.2600894 Vali Loss: 0.1366055 Test Loss: 0.1520595
Validation loss decreased (inf --> 0.136605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1532973
	speed: 0.1015s/iter; left time: 817.3042s
	iters: 200, epoch: 2 | loss: 0.1260789
	speed: 0.0428s/iter; left time: 340.6858s
	iters: 300, epoch: 2 | loss: 0.1008584
	speed: 0.0432s/iter; left time: 339.6580s
	iters: 400, epoch: 2 | loss: 0.0796642
	speed: 0.0429s/iter; left time: 332.6286s
	iters: 500, epoch: 2 | loss: 0.1141303
	speed: 0.0425s/iter; left time: 325.0501s
	iters: 600, epoch: 2 | loss: 0.1037540
	speed: 0.0422s/iter; left time: 318.9473s
	iters: 700, epoch: 2 | loss: 0.1089663
	speed: 0.0430s/iter; left time: 320.3766s
	iters: 800, epoch: 2 | loss: 0.1039877
	speed: 0.0428s/iter; left time: 314.6970s
	iters: 900, epoch: 2 | loss: 0.1020551
	speed: 0.0414s/iter; left time: 300.2244s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.84s
Steps: 906 | Train Loss: 0.1054358 Vali Loss: 0.0893238 Test Loss: 0.1045632
Validation loss decreased (0.136605 --> 0.089324).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1023343
	speed: 0.0991s/iter; left time: 708.4305s
	iters: 200, epoch: 3 | loss: 0.0731819
	speed: 0.0418s/iter; left time: 294.4957s
	iters: 300, epoch: 3 | loss: 0.0958075
	speed: 0.0411s/iter; left time: 285.6417s
	iters: 400, epoch: 3 | loss: 0.0770710
	speed: 0.0418s/iter; left time: 286.3855s
	iters: 500, epoch: 3 | loss: 0.1102199
	speed: 0.0414s/iter; left time: 279.3725s
	iters: 600, epoch: 3 | loss: 0.0913249
	speed: 0.0422s/iter; left time: 280.8657s
	iters: 700, epoch: 3 | loss: 0.0686877
	speed: 0.0416s/iter; left time: 272.3437s
	iters: 800, epoch: 3 | loss: 0.0790340
	speed: 0.0419s/iter; left time: 270.3541s
	iters: 900, epoch: 3 | loss: 0.0761617
	speed: 0.0417s/iter; left time: 264.9784s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.02s
Steps: 906 | Train Loss: 0.0858373 Vali Loss: 0.0872478 Test Loss: 0.1066528
Validation loss decreased (0.089324 --> 0.087248).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0815753
	speed: 0.0988s/iter; left time: 616.5249s
	iters: 200, epoch: 4 | loss: 0.0754646
	speed: 0.0422s/iter; left time: 258.9453s
	iters: 300, epoch: 4 | loss: 0.0764520
	speed: 0.0422s/iter; left time: 254.7654s
	iters: 400, epoch: 4 | loss: 0.0895106
	speed: 0.0418s/iter; left time: 248.1376s
	iters: 500, epoch: 4 | loss: 0.0601778
	speed: 0.0425s/iter; left time: 248.4276s
	iters: 600, epoch: 4 | loss: 0.1016150
	speed: 0.0419s/iter; left time: 240.8332s
	iters: 700, epoch: 4 | loss: 0.0842820
	speed: 0.0418s/iter; left time: 236.0593s
	iters: 800, epoch: 4 | loss: 0.0868589
	speed: 0.0425s/iter; left time: 235.4316s
	iters: 900, epoch: 4 | loss: 0.0967281
	speed: 0.0419s/iter; left time: 228.1878s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.35s
Steps: 906 | Train Loss: 0.0770693 Vali Loss: 0.0831974 Test Loss: 0.1002508
Validation loss decreased (0.087248 --> 0.083197).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0600150
	speed: 0.0970s/iter; left time: 517.7904s
	iters: 200, epoch: 5 | loss: 0.0542572
	speed: 0.0420s/iter; left time: 219.7320s
	iters: 300, epoch: 5 | loss: 0.0645427
	speed: 0.0422s/iter; left time: 216.6582s
	iters: 400, epoch: 5 | loss: 0.0514126
	speed: 0.0415s/iter; left time: 209.0129s
	iters: 500, epoch: 5 | loss: 0.0702532
	speed: 0.0416s/iter; left time: 205.4085s
	iters: 600, epoch: 5 | loss: 0.0489614
	speed: 0.0414s/iter; left time: 200.0782s
	iters: 700, epoch: 5 | loss: 0.0924419
	speed: 0.0419s/iter; left time: 198.2977s
	iters: 800, epoch: 5 | loss: 0.0652864
	speed: 0.0412s/iter; left time: 191.1621s
	iters: 900, epoch: 5 | loss: 0.0642762
	speed: 0.0417s/iter; left time: 189.1585s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.97s
Steps: 906 | Train Loss: 0.0691553 Vali Loss: 0.0892626 Test Loss: 0.1061498
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0608225
	speed: 0.0948s/iter; left time: 419.9749s
	iters: 200, epoch: 6 | loss: 0.0698372
	speed: 0.0421s/iter; left time: 182.1997s
	iters: 300, epoch: 6 | loss: 0.0788709
	speed: 0.0424s/iter; left time: 179.3410s
	iters: 400, epoch: 6 | loss: 0.0710383
	speed: 0.0422s/iter; left time: 174.4703s
	iters: 500, epoch: 6 | loss: 0.0734161
	speed: 0.0425s/iter; left time: 171.2440s
	iters: 600, epoch: 6 | loss: 0.0809034
	speed: 0.0424s/iter; left time: 166.7563s
	iters: 700, epoch: 6 | loss: 0.0680279
	speed: 0.0426s/iter; left time: 163.2535s
	iters: 800, epoch: 6 | loss: 0.0567202
	speed: 0.0417s/iter; left time: 155.6090s
	iters: 900, epoch: 6 | loss: 0.0692521
	speed: 0.0427s/iter; left time: 155.1485s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.50s
Steps: 906 | Train Loss: 0.0617734 Vali Loss: 0.0905120 Test Loss: 0.1105444
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0574806
	speed: 0.0986s/iter; left time: 347.6475s
	iters: 200, epoch: 7 | loss: 0.0578606
	speed: 0.0455s/iter; left time: 155.8857s
	iters: 300, epoch: 7 | loss: 0.0457384
	speed: 0.0438s/iter; left time: 145.5761s
	iters: 400, epoch: 7 | loss: 0.0540566
	speed: 0.0429s/iter; left time: 138.3762s
	iters: 500, epoch: 7 | loss: 0.0499512
	speed: 0.0426s/iter; left time: 133.2080s
	iters: 600, epoch: 7 | loss: 0.0393287
	speed: 0.0424s/iter; left time: 128.1868s
	iters: 700, epoch: 7 | loss: 0.0459998
	speed: 0.0445s/iter; left time: 130.1834s
	iters: 800, epoch: 7 | loss: 0.0533252
	speed: 0.0443s/iter; left time: 125.0492s
	iters: 900, epoch: 7 | loss: 0.0566984
	speed: 0.0426s/iter; left time: 116.0247s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:39.82s
Steps: 906 | Train Loss: 0.0546729 Vali Loss: 0.0899979 Test Loss: 0.1061608
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.10002385079860687, rmse:0.3162654638290405, mae:0.19335344433784485, rse:0.3993486762046814
Original data scale mse:1696561.0, rmse:1302.52099609375, mae:857.1822509765625, rse:0.09153122454881668
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4168179
	speed: 0.0482s/iter; left time: 431.5110s
	iters: 200, epoch: 1 | loss: 0.2886696
	speed: 0.0459s/iter; left time: 406.9410s
	iters: 300, epoch: 1 | loss: 0.2403183
	speed: 0.0447s/iter; left time: 391.2516s
	iters: 400, epoch: 1 | loss: 0.1930146
	speed: 0.0416s/iter; left time: 360.0591s
	iters: 500, epoch: 1 | loss: 0.1608932
	speed: 0.0419s/iter; left time: 358.3808s
	iters: 600, epoch: 1 | loss: 0.1777097
	speed: 0.0412s/iter; left time: 348.4035s
	iters: 700, epoch: 1 | loss: 0.1669439
	speed: 0.0414s/iter; left time: 346.2489s
	iters: 800, epoch: 1 | loss: 0.1633795
	speed: 0.0417s/iter; left time: 344.5251s
	iters: 900, epoch: 1 | loss: 0.1446787
	speed: 0.0417s/iter; left time: 339.9841s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.13s
Steps: 906 | Train Loss: 0.2495366 Vali Loss: 0.1316007 Test Loss: 0.1512348
Validation loss decreased (inf --> 0.131601).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1034280
	speed: 0.1021s/iter; left time: 822.1082s
	iters: 200, epoch: 2 | loss: 0.1250904
	speed: 0.0426s/iter; left time: 339.1439s
	iters: 300, epoch: 2 | loss: 0.0913794
	speed: 0.0421s/iter; left time: 330.8022s
	iters: 400, epoch: 2 | loss: 0.1011957
	speed: 0.0419s/iter; left time: 324.9645s
	iters: 500, epoch: 2 | loss: 0.1224960
	speed: 0.0427s/iter; left time: 327.1517s
	iters: 600, epoch: 2 | loss: 0.0618044
	speed: 0.0418s/iter; left time: 316.1671s
	iters: 700, epoch: 2 | loss: 0.0826926
	speed: 0.0422s/iter; left time: 314.3606s
	iters: 800, epoch: 2 | loss: 0.0713667
	speed: 0.0419s/iter; left time: 307.8078s
	iters: 900, epoch: 2 | loss: 0.0813036
	speed: 0.0423s/iter; left time: 306.6508s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.54s
Steps: 906 | Train Loss: 0.1056956 Vali Loss: 0.0904077 Test Loss: 0.1066121
Validation loss decreased (0.131601 --> 0.090408).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0805268
	speed: 0.1011s/iter; left time: 722.7247s
	iters: 200, epoch: 3 | loss: 0.0777041
	speed: 0.0411s/iter; left time: 289.7597s
	iters: 300, epoch: 3 | loss: 0.1113748
	speed: 0.0409s/iter; left time: 284.4654s
	iters: 400, epoch: 3 | loss: 0.0737260
	speed: 0.0410s/iter; left time: 281.0607s
	iters: 500, epoch: 3 | loss: 0.0781929
	speed: 0.0410s/iter; left time: 276.5056s
	iters: 600, epoch: 3 | loss: 0.0720723
	speed: 0.0417s/iter; left time: 277.0252s
	iters: 700, epoch: 3 | loss: 0.0949330
	speed: 0.0413s/iter; left time: 270.6018s
	iters: 800, epoch: 3 | loss: 0.0955116
	speed: 0.0411s/iter; left time: 264.9452s
	iters: 900, epoch: 3 | loss: 0.0805945
	speed: 0.0416s/iter; left time: 264.0420s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.64s
Steps: 906 | Train Loss: 0.0855026 Vali Loss: 0.0836945 Test Loss: 0.0981142
Validation loss decreased (0.090408 --> 0.083695).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0895017
	speed: 0.0994s/iter; left time: 620.5960s
	iters: 200, epoch: 4 | loss: 0.0870529
	speed: 0.0420s/iter; left time: 257.9520s
	iters: 300, epoch: 4 | loss: 0.1146038
	speed: 0.0423s/iter; left time: 255.4745s
	iters: 400, epoch: 4 | loss: 0.0830920
	speed: 0.0421s/iter; left time: 250.2070s
	iters: 500, epoch: 4 | loss: 0.0829308
	speed: 0.0420s/iter; left time: 245.5205s
	iters: 600, epoch: 4 | loss: 0.0558912
	speed: 0.0428s/iter; left time: 246.0520s
	iters: 700, epoch: 4 | loss: 0.0529644
	speed: 0.0427s/iter; left time: 240.8568s
	iters: 800, epoch: 4 | loss: 0.0564321
	speed: 0.0424s/iter; left time: 235.0833s
	iters: 900, epoch: 4 | loss: 0.0643488
	speed: 0.0423s/iter; left time: 230.0502s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.60s
Steps: 906 | Train Loss: 0.0786023 Vali Loss: 0.0871105 Test Loss: 0.1037567
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0767027
	speed: 0.0967s/iter; left time: 515.8844s
	iters: 200, epoch: 5 | loss: 0.1085476
	speed: 0.0427s/iter; left time: 223.4023s
	iters: 300, epoch: 5 | loss: 0.0677622
	speed: 0.0424s/iter; left time: 217.7287s
	iters: 400, epoch: 5 | loss: 0.0740710
	speed: 0.0424s/iter; left time: 213.6862s
	iters: 500, epoch: 5 | loss: 0.0827700
	speed: 0.0418s/iter; left time: 206.3014s
	iters: 600, epoch: 5 | loss: 0.0590484
	speed: 0.0419s/iter; left time: 202.4878s
	iters: 700, epoch: 5 | loss: 0.0672496
	speed: 0.0415s/iter; left time: 196.6606s
	iters: 800, epoch: 5 | loss: 0.0579648
	speed: 0.0427s/iter; left time: 197.8927s
	iters: 900, epoch: 5 | loss: 0.0681030
	speed: 0.0418s/iter; left time: 189.7159s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.45s
Steps: 906 | Train Loss: 0.0703172 Vali Loss: 0.0912882 Test Loss: 0.1049923
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0739752
	speed: 0.0995s/iter; left time: 440.8416s
	iters: 200, epoch: 6 | loss: 0.0463412
	speed: 0.0458s/iter; left time: 198.3777s
	iters: 300, epoch: 6 | loss: 0.0616892
	speed: 0.0460s/iter; left time: 194.4861s
	iters: 400, epoch: 6 | loss: 0.0568204
	speed: 0.0458s/iter; left time: 189.1229s
	iters: 500, epoch: 6 | loss: 0.0625511
	speed: 0.0459s/iter; left time: 185.0142s
	iters: 600, epoch: 6 | loss: 0.0598992
	speed: 0.0458s/iter; left time: 180.0717s
	iters: 700, epoch: 6 | loss: 0.0622896
	speed: 0.0431s/iter; left time: 164.9780s
	iters: 800, epoch: 6 | loss: 0.0433253
	speed: 0.0420s/iter; left time: 156.7730s
	iters: 900, epoch: 6 | loss: 0.0558392
	speed: 0.0416s/iter; left time: 150.9796s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:40.64s
Steps: 906 | Train Loss: 0.0630982 Vali Loss: 0.0911216 Test Loss: 0.1052075
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.09819940477609634, rmse:0.3133678436279297, mae:0.19801004230976105, rse:0.39568981528282166
Original data scale mse:1713331.125, rmse:1308.9427490234375, mae:885.3687133789062, rse:0.09198249876499176

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.10002385079860687, RMSE: 0.3162654638290405, MAE: 0.19335344433784485, RSE: 0.3993486762046814
Unscaled Metrics - MSE: 1696561.0, RMSE: 1302.52099609375, MAE: 857.1822509765625, RSE: 0.09153122454881668

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.09819940477609634, RMSE: 0.3133678436279297, MAE: 0.19801004230976105, RSE: 0.39568981528282166
Unscaled Metrics - MSE: 1713331.125, RMSE: 1308.9427490234375, MAE: 885.3687133789062, RSE: 0.09198249876499176

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5045965
	speed: 0.0799s/iter; left time: 714.4619s
	iters: 200, epoch: 1 | loss: 0.4390484
	speed: 0.0503s/iter; left time: 444.9529s
	iters: 300, epoch: 1 | loss: 0.3437441
	speed: 0.0486s/iter; left time: 425.0850s
	iters: 400, epoch: 1 | loss: 0.3208438
	speed: 0.0472s/iter; left time: 407.4240s
	iters: 500, epoch: 1 | loss: 0.3070790
	speed: 0.0470s/iter; left time: 401.7142s
	iters: 600, epoch: 1 | loss: 0.2794358
	speed: 0.0469s/iter; left time: 395.7681s
	iters: 700, epoch: 1 | loss: 0.2686736
	speed: 0.0469s/iter; left time: 390.8473s
	iters: 800, epoch: 1 | loss: 0.2617631
	speed: 0.0469s/iter; left time: 386.1759s
	iters: 900, epoch: 1 | loss: 0.2700858
	speed: 0.0495s/iter; left time: 403.2771s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.26s
Steps: 904 | Train Loss: 0.3468960 Vali Loss: 0.2351844 Test Loss: 0.2707231
Validation loss decreased (inf --> 0.235184).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2300241
	speed: 0.1153s/iter; left time: 926.6494s
	iters: 200, epoch: 2 | loss: 0.2220291
	speed: 0.0475s/iter; left time: 376.9666s
	iters: 300, epoch: 2 | loss: 0.1872774
	speed: 0.0476s/iter; left time: 372.8818s
	iters: 400, epoch: 2 | loss: 0.1779795
	speed: 0.0474s/iter; left time: 366.7985s
	iters: 500, epoch: 2 | loss: 0.1688535
	speed: 0.0474s/iter; left time: 362.3098s
	iters: 600, epoch: 2 | loss: 0.1828407
	speed: 0.0476s/iter; left time: 358.6056s
	iters: 700, epoch: 2 | loss: 0.1627705
	speed: 0.0476s/iter; left time: 353.9687s
	iters: 800, epoch: 2 | loss: 0.1611297
	speed: 0.0475s/iter; left time: 348.2323s
	iters: 900, epoch: 2 | loss: 0.1451629
	speed: 0.0476s/iter; left time: 344.1814s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.17s
Steps: 904 | Train Loss: 0.1849431 Vali Loss: 0.1534018 Test Loss: 0.1706837
Validation loss decreased (0.235184 --> 0.153402).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1613644
	speed: 0.1162s/iter; left time: 828.7136s
	iters: 200, epoch: 3 | loss: 0.1548926
	speed: 0.0474s/iter; left time: 333.6597s
	iters: 300, epoch: 3 | loss: 0.1574221
	speed: 0.0478s/iter; left time: 331.3628s
	iters: 400, epoch: 3 | loss: 0.1564433
	speed: 0.0475s/iter; left time: 324.3579s
	iters: 500, epoch: 3 | loss: 0.1398545
	speed: 0.0478s/iter; left time: 322.0645s
	iters: 600, epoch: 3 | loss: 0.1393510
	speed: 0.0477s/iter; left time: 316.3891s
	iters: 700, epoch: 3 | loss: 0.1322500
	speed: 0.0476s/iter; left time: 311.1233s
	iters: 800, epoch: 3 | loss: 0.1685270
	speed: 0.0477s/iter; left time: 307.1098s
	iters: 900, epoch: 3 | loss: 0.1617758
	speed: 0.0477s/iter; left time: 302.1530s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.33s
Steps: 904 | Train Loss: 0.1460258 Vali Loss: 0.1451110 Test Loss: 0.1648626
Validation loss decreased (0.153402 --> 0.145111).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1242825
	speed: 0.1152s/iter; left time: 717.4326s
	iters: 200, epoch: 4 | loss: 0.1335241
	speed: 0.0472s/iter; left time: 289.3164s
	iters: 300, epoch: 4 | loss: 0.1145575
	speed: 0.0497s/iter; left time: 299.5475s
	iters: 400, epoch: 4 | loss: 0.1492457
	speed: 0.0505s/iter; left time: 299.3059s
	iters: 500, epoch: 4 | loss: 0.1411823
	speed: 0.0503s/iter; left time: 292.9530s
	iters: 600, epoch: 4 | loss: 0.1362645
	speed: 0.0503s/iter; left time: 287.8966s
	iters: 700, epoch: 4 | loss: 0.1161992
	speed: 0.0503s/iter; left time: 283.3188s
	iters: 800, epoch: 4 | loss: 0.1321714
	speed: 0.0485s/iter; left time: 268.0644s
	iters: 900, epoch: 4 | loss: 0.1172668
	speed: 0.0470s/iter; left time: 255.1387s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:44.53s
Steps: 904 | Train Loss: 0.1313648 Vali Loss: 0.1518364 Test Loss: 0.1867373
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1045115
	speed: 0.1114s/iter; left time: 593.2686s
	iters: 200, epoch: 5 | loss: 0.1071720
	speed: 0.0472s/iter; left time: 246.5122s
	iters: 300, epoch: 5 | loss: 0.1205560
	speed: 0.0472s/iter; left time: 241.8979s
	iters: 400, epoch: 5 | loss: 0.1421698
	speed: 0.0472s/iter; left time: 237.2326s
	iters: 500, epoch: 5 | loss: 0.1038092
	speed: 0.0472s/iter; left time: 232.2796s
	iters: 600, epoch: 5 | loss: 0.1141948
	speed: 0.0473s/iter; left time: 228.1499s
	iters: 700, epoch: 5 | loss: 0.1282563
	speed: 0.0473s/iter; left time: 223.6481s
	iters: 800, epoch: 5 | loss: 0.1173381
	speed: 0.0475s/iter; left time: 219.7034s
	iters: 900, epoch: 5 | loss: 0.1051606
	speed: 0.0473s/iter; left time: 214.2197s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.92s
Steps: 904 | Train Loss: 0.1181595 Vali Loss: 0.1614592 Test Loss: 0.1828424
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839722
	speed: 0.1119s/iter; left time: 494.8237s
	iters: 200, epoch: 6 | loss: 0.1093515
	speed: 0.0474s/iter; left time: 204.9572s
	iters: 300, epoch: 6 | loss: 0.1092099
	speed: 0.0475s/iter; left time: 200.5211s
	iters: 400, epoch: 6 | loss: 0.1182218
	speed: 0.0475s/iter; left time: 195.8688s
	iters: 500, epoch: 6 | loss: 0.1052422
	speed: 0.0436s/iter; left time: 175.1931s
	iters: 600, epoch: 6 | loss: 0.0997554
	speed: 0.0403s/iter; left time: 157.9230s
	iters: 700, epoch: 6 | loss: 0.0752411
	speed: 0.0431s/iter; left time: 164.8049s
	iters: 800, epoch: 6 | loss: 0.1045671
	speed: 0.0475s/iter; left time: 176.8885s
	iters: 900, epoch: 6 | loss: 0.0971484
	speed: 0.0474s/iter; left time: 171.5496s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.60s
Steps: 904 | Train Loss: 0.1055968 Vali Loss: 0.1675357 Test Loss: 0.1822582
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.16490043699741364, rmse:0.40607935190200806, mae:0.26791679859161377, rse:0.5121438503265381
Original data scale mse:3421302.0, rmse:1849.6761474609375, mae:1260.5140380859375, rse:0.13016927242279053
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.4475376
	speed: 0.0520s/iter; left time: 464.9204s
	iters: 200, epoch: 1 | loss: 0.4170868
	speed: 0.0503s/iter; left time: 445.1410s
	iters: 300, epoch: 1 | loss: 0.3696011
	speed: 0.0473s/iter; left time: 413.0678s
	iters: 400, epoch: 1 | loss: 0.3156129
	speed: 0.0472s/iter; left time: 407.5147s
	iters: 500, epoch: 1 | loss: 0.3267281
	speed: 0.0473s/iter; left time: 404.0254s
	iters: 600, epoch: 1 | loss: 0.2518276
	speed: 0.0475s/iter; left time: 401.1674s
	iters: 700, epoch: 1 | loss: 0.2776158
	speed: 0.0471s/iter; left time: 393.0135s
	iters: 800, epoch: 1 | loss: 0.2633318
	speed: 0.0471s/iter; left time: 388.1901s
	iters: 900, epoch: 1 | loss: 0.2625957
	speed: 0.0473s/iter; left time: 385.3751s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.60s
Steps: 904 | Train Loss: 0.3421745 Vali Loss: 0.2333531 Test Loss: 0.2728005
Validation loss decreased (inf --> 0.233353).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2594028
	speed: 0.1171s/iter; left time: 941.1998s
	iters: 200, epoch: 2 | loss: 0.2541784
	speed: 0.0477s/iter; left time: 378.6054s
	iters: 300, epoch: 2 | loss: 0.1773580
	speed: 0.0478s/iter; left time: 374.6208s
	iters: 400, epoch: 2 | loss: 0.1676601
	speed: 0.0479s/iter; left time: 370.5879s
	iters: 500, epoch: 2 | loss: 0.1602368
	speed: 0.0477s/iter; left time: 364.1150s
	iters: 600, epoch: 2 | loss: 0.1895377
	speed: 0.0477s/iter; left time: 359.5270s
	iters: 700, epoch: 2 | loss: 0.1559464
	speed: 0.0477s/iter; left time: 354.7906s
	iters: 800, epoch: 2 | loss: 0.1509054
	speed: 0.0478s/iter; left time: 350.5780s
	iters: 900, epoch: 2 | loss: 0.1405970
	speed: 0.0478s/iter; left time: 345.8822s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.39s
Steps: 904 | Train Loss: 0.1825963 Vali Loss: 0.1495076 Test Loss: 0.1701031
Validation loss decreased (0.233353 --> 0.149508).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1443687
	speed: 0.1170s/iter; left time: 834.7906s
	iters: 200, epoch: 3 | loss: 0.1518792
	speed: 0.0474s/iter; left time: 333.5571s
	iters: 300, epoch: 3 | loss: 0.1543838
	speed: 0.0475s/iter; left time: 329.3846s
	iters: 400, epoch: 3 | loss: 0.1467329
	speed: 0.0475s/iter; left time: 324.4534s
	iters: 500, epoch: 3 | loss: 0.1330860
	speed: 0.0475s/iter; left time: 319.8509s
	iters: 600, epoch: 3 | loss: 0.1557555
	speed: 0.0474s/iter; left time: 314.7347s
	iters: 700, epoch: 3 | loss: 0.1508784
	speed: 0.0473s/iter; left time: 308.8469s
	iters: 800, epoch: 3 | loss: 0.1350839
	speed: 0.0474s/iter; left time: 305.0759s
	iters: 900, epoch: 3 | loss: 0.1113788
	speed: 0.0474s/iter; left time: 300.2361s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.12s
Steps: 904 | Train Loss: 0.1437586 Vali Loss: 0.1512932 Test Loss: 0.1674922
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1300042
	speed: 0.1167s/iter; left time: 726.6414s
	iters: 200, epoch: 4 | loss: 0.1244012
	speed: 0.0504s/iter; left time: 308.7586s
	iters: 300, epoch: 4 | loss: 0.1192255
	speed: 0.0498s/iter; left time: 300.3810s
	iters: 400, epoch: 4 | loss: 0.1346381
	speed: 0.0502s/iter; left time: 297.4333s
	iters: 500, epoch: 4 | loss: 0.1325753
	speed: 0.0482s/iter; left time: 280.7504s
	iters: 600, epoch: 4 | loss: 0.1362159
	speed: 0.0475s/iter; left time: 272.3551s
	iters: 700, epoch: 4 | loss: 0.1304613
	speed: 0.0478s/iter; left time: 269.1685s
	iters: 800, epoch: 4 | loss: 0.1154950
	speed: 0.0482s/iter; left time: 266.3544s
	iters: 900, epoch: 4 | loss: 0.1173018
	speed: 0.0476s/iter; left time: 258.4674s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:44.41s
Steps: 904 | Train Loss: 0.1299172 Vali Loss: 0.1495079 Test Loss: 0.1671035
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1128451
	speed: 0.1136s/iter; left time: 604.8635s
	iters: 200, epoch: 5 | loss: 0.1181555
	speed: 0.0479s/iter; left time: 250.0315s
	iters: 300, epoch: 5 | loss: 0.1362707
	speed: 0.0477s/iter; left time: 244.2189s
	iters: 400, epoch: 5 | loss: 0.1163110
	speed: 0.0477s/iter; left time: 239.7325s
	iters: 500, epoch: 5 | loss: 0.1129930
	speed: 0.0477s/iter; left time: 234.8635s
	iters: 600, epoch: 5 | loss: 0.1037793
	speed: 0.0491s/iter; left time: 237.0748s
	iters: 700, epoch: 5 | loss: 0.1132942
	speed: 0.0504s/iter; left time: 238.3661s
	iters: 800, epoch: 5 | loss: 0.1099381
	speed: 0.0502s/iter; left time: 232.2450s
	iters: 900, epoch: 5 | loss: 0.0946565
	speed: 0.0504s/iter; left time: 227.8983s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:44.37s
Steps: 904 | Train Loss: 0.1178938 Vali Loss: 0.1571686 Test Loss: 0.1803182
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.1699843406677246, rmse:0.41229158639907837, mae:0.2785334587097168, rse:0.5199787020683289
Original data scale mse:3697298.25, rmse:1922.8359375, mae:1325.630615234375, rse:0.1353178173303604

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.16490043699741364, RMSE: 0.40607935190200806, MAE: 0.26791679859161377, RSE: 0.5121438503265381
Unscaled Metrics - MSE: 3421302.0, RMSE: 1849.6761474609375, MAE: 1260.5140380859375, RSE: 0.13016927242279053

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.1699843406677246, RMSE: 0.41229158639907837, MAE: 0.2785334587097168, RSE: 0.5199787020683289
Unscaled Metrics - MSE: 3697298.25, RMSE: 1922.8359375, MAE: 1325.630615234375, RSE: 0.1353178173303604

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4966977
	speed: 0.0815s/iter; left time: 726.8950s
	iters: 200, epoch: 1 | loss: 0.4099219
	speed: 0.0521s/iter; left time: 459.3734s
	iters: 300, epoch: 1 | loss: 0.4381100
	speed: 0.0529s/iter; left time: 461.3970s
	iters: 400, epoch: 1 | loss: 0.3973788
	speed: 0.0531s/iter; left time: 458.1676s
	iters: 500, epoch: 1 | loss: 0.3753636
	speed: 0.0527s/iter; left time: 449.0548s
	iters: 600, epoch: 1 | loss: 0.3728669
	speed: 0.0532s/iter; left time: 448.3544s
	iters: 700, epoch: 1 | loss: 0.3483940
	speed: 0.0530s/iter; left time: 440.7301s
	iters: 800, epoch: 1 | loss: 0.3762171
	speed: 0.0527s/iter; left time: 433.4911s
	iters: 900, epoch: 1 | loss: 0.3350616
	speed: 0.0530s/iter; left time: 430.4448s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.33s
Steps: 902 | Train Loss: 0.3986439 Vali Loss: 0.3218878 Test Loss: 0.3710622
Validation loss decreased (inf --> 0.321888).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3282322
	speed: 0.1339s/iter; left time: 1073.8482s
	iters: 200, epoch: 2 | loss: 0.2845210
	speed: 0.0536s/iter; left time: 424.5442s
	iters: 300, epoch: 2 | loss: 0.2315060
	speed: 0.0534s/iter; left time: 417.2753s
	iters: 400, epoch: 2 | loss: 0.2004031
	speed: 0.0499s/iter; left time: 384.8871s
	iters: 500, epoch: 2 | loss: 0.1822670
	speed: 0.0426s/iter; left time: 324.5547s
	iters: 600, epoch: 2 | loss: 0.2010734
	speed: 0.0426s/iter; left time: 320.5012s
	iters: 700, epoch: 2 | loss: 0.1537598
	speed: 0.0426s/iter; left time: 316.1279s
	iters: 800, epoch: 2 | loss: 0.1599696
	speed: 0.0426s/iter; left time: 311.8362s
	iters: 900, epoch: 2 | loss: 0.1636544
	speed: 0.0426s/iter; left time: 307.3216s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.62s
Steps: 902 | Train Loss: 0.2208208 Vali Loss: 0.1734993 Test Loss: 0.2008001
Validation loss decreased (0.321888 --> 0.173499).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1543073
	speed: 0.1343s/iter; left time: 956.0867s
	iters: 200, epoch: 3 | loss: 0.1781035
	speed: 0.0535s/iter; left time: 375.2786s
	iters: 300, epoch: 3 | loss: 0.1746193
	speed: 0.0536s/iter; left time: 370.9490s
	iters: 400, epoch: 3 | loss: 0.1871681
	speed: 0.0535s/iter; left time: 364.8387s
	iters: 500, epoch: 3 | loss: 0.1751289
	speed: 0.0533s/iter; left time: 358.3272s
	iters: 600, epoch: 3 | loss: 0.1499453
	speed: 0.0535s/iter; left time: 354.2278s
	iters: 700, epoch: 3 | loss: 0.1454932
	speed: 0.0535s/iter; left time: 348.8984s
	iters: 800, epoch: 3 | loss: 0.1587827
	speed: 0.0536s/iter; left time: 343.6442s
	iters: 900, epoch: 3 | loss: 0.1564680
	speed: 0.0533s/iter; left time: 336.6767s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.47s
Steps: 902 | Train Loss: 0.1620454 Vali Loss: 0.1663911 Test Loss: 0.1857910
Validation loss decreased (0.173499 --> 0.166391).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1516684
	speed: 0.1330s/iter; left time: 826.7187s
	iters: 200, epoch: 4 | loss: 0.1399278
	speed: 0.0536s/iter; left time: 327.9569s
	iters: 300, epoch: 4 | loss: 0.1754512
	speed: 0.0535s/iter; left time: 321.8352s
	iters: 400, epoch: 4 | loss: 0.1406582
	speed: 0.0533s/iter; left time: 314.9945s
	iters: 500, epoch: 4 | loss: 0.1360245
	speed: 0.0533s/iter; left time: 309.6627s
	iters: 600, epoch: 4 | loss: 0.1327563
	speed: 0.0530s/iter; left time: 303.0875s
	iters: 700, epoch: 4 | loss: 0.1522301
	speed: 0.0533s/iter; left time: 299.1300s
	iters: 800, epoch: 4 | loss: 0.1508048
	speed: 0.0535s/iter; left time: 295.0063s
	iters: 900, epoch: 4 | loss: 0.1359401
	speed: 0.0534s/iter; left time: 289.1917s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.39s
Steps: 902 | Train Loss: 0.1436205 Vali Loss: 0.1616475 Test Loss: 0.1910362
Validation loss decreased (0.166391 --> 0.161647).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1165406
	speed: 0.1333s/iter; left time: 708.1248s
	iters: 200, epoch: 5 | loss: 0.1227968
	speed: 0.0537s/iter; left time: 279.8519s
	iters: 300, epoch: 5 | loss: 0.1398759
	speed: 0.0534s/iter; left time: 272.8818s
	iters: 400, epoch: 5 | loss: 0.1302250
	speed: 0.0538s/iter; left time: 269.4581s
	iters: 500, epoch: 5 | loss: 0.1340078
	speed: 0.0536s/iter; left time: 263.3397s
	iters: 600, epoch: 5 | loss: 0.1324678
	speed: 0.0536s/iter; left time: 257.9358s
	iters: 700, epoch: 5 | loss: 0.1363588
	speed: 0.0537s/iter; left time: 253.0217s
	iters: 800, epoch: 5 | loss: 0.1203870
	speed: 0.0536s/iter; left time: 247.3153s
	iters: 900, epoch: 5 | loss: 0.1123812
	speed: 0.0536s/iter; left time: 241.7397s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.58s
Steps: 902 | Train Loss: 0.1272365 Vali Loss: 0.1729182 Test Loss: 0.1960722
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1052577
	speed: 0.1296s/iter; left time: 571.6242s
	iters: 200, epoch: 6 | loss: 0.1154618
	speed: 0.0535s/iter; left time: 230.7679s
	iters: 300, epoch: 6 | loss: 0.1060943
	speed: 0.0535s/iter; left time: 225.0888s
	iters: 400, epoch: 6 | loss: 0.1166776
	speed: 0.0531s/iter; left time: 218.4751s
	iters: 500, epoch: 6 | loss: 0.1117797
	speed: 0.0536s/iter; left time: 214.8774s
	iters: 600, epoch: 6 | loss: 0.1012975
	speed: 0.0535s/iter; left time: 209.2846s
	iters: 700, epoch: 6 | loss: 0.1002825
	speed: 0.0535s/iter; left time: 203.7766s
	iters: 800, epoch: 6 | loss: 0.0949321
	speed: 0.0530s/iter; left time: 196.6513s
	iters: 900, epoch: 6 | loss: 0.1055358
	speed: 0.0532s/iter; left time: 192.1221s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.34s
Steps: 902 | Train Loss: 0.1114315 Vali Loss: 0.1849274 Test Loss: 0.2154551
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1018671
	speed: 0.1297s/iter; left time: 455.0034s
	iters: 200, epoch: 7 | loss: 0.1101972
	speed: 0.0533s/iter; left time: 181.6714s
	iters: 300, epoch: 7 | loss: 0.0802369
	speed: 0.0532s/iter; left time: 176.0020s
	iters: 400, epoch: 7 | loss: 0.0953395
	speed: 0.0533s/iter; left time: 171.1957s
	iters: 500, epoch: 7 | loss: 0.1015822
	speed: 0.0535s/iter; left time: 166.4659s
	iters: 600, epoch: 7 | loss: 0.0980061
	speed: 0.0531s/iter; left time: 159.8448s
	iters: 700, epoch: 7 | loss: 0.0913025
	speed: 0.0534s/iter; left time: 155.4228s
	iters: 800, epoch: 7 | loss: 0.0808870
	speed: 0.0533s/iter; left time: 149.7050s
	iters: 900, epoch: 7 | loss: 0.0746090
	speed: 0.0534s/iter; left time: 144.7408s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.36s
Steps: 902 | Train Loss: 0.0969700 Vali Loss: 0.1899111 Test Loss: 0.2163351
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.19100810587406158, rmse:0.43704473972320557, mae:0.2906225919723511, rse:0.5505934953689575
Original data scale mse:4675170.5, rmse:2162.21435546875, mae:1425.986083984375, rse:0.15230673551559448
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4542921
	speed: 0.0565s/iter; left time: 504.3819s
	iters: 200, epoch: 1 | loss: 0.4394370
	speed: 0.0537s/iter; left time: 473.8614s
	iters: 300, epoch: 1 | loss: 0.3722619
	speed: 0.0537s/iter; left time: 467.9654s
	iters: 400, epoch: 1 | loss: 0.3826541
	speed: 0.0535s/iter; left time: 461.6214s
	iters: 500, epoch: 1 | loss: 0.3788883
	speed: 0.0536s/iter; left time: 456.9176s
	iters: 600, epoch: 1 | loss: 0.3316003
	speed: 0.0536s/iter; left time: 451.1635s
	iters: 700, epoch: 1 | loss: 0.3430753
	speed: 0.0537s/iter; left time: 446.9174s
	iters: 800, epoch: 1 | loss: 0.3369034
	speed: 0.0537s/iter; left time: 441.2478s
	iters: 900, epoch: 1 | loss: 0.3387891
	speed: 0.0534s/iter; left time: 433.6244s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.3936864 Vali Loss: 0.3190689 Test Loss: 0.3769189
Validation loss decreased (inf --> 0.319069).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3121722
	speed: 0.1314s/iter; left time: 1053.5448s
	iters: 200, epoch: 2 | loss: 0.2628028
	speed: 0.0525s/iter; left time: 415.8112s
	iters: 300, epoch: 2 | loss: 0.2298339
	speed: 0.0449s/iter; left time: 350.7182s
	iters: 400, epoch: 2 | loss: 0.1916041
	speed: 0.0426s/iter; left time: 328.9339s
	iters: 500, epoch: 2 | loss: 0.2294622
	speed: 0.0426s/iter; left time: 324.7520s
	iters: 600, epoch: 2 | loss: 0.1571815
	speed: 0.0426s/iter; left time: 320.4379s
	iters: 700, epoch: 2 | loss: 0.1837410
	speed: 0.0427s/iter; left time: 316.6783s
	iters: 800, epoch: 2 | loss: 0.1569615
	speed: 0.0426s/iter; left time: 312.0896s
	iters: 900, epoch: 2 | loss: 0.1772609
	speed: 0.0426s/iter; left time: 307.6540s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.88s
Steps: 902 | Train Loss: 0.2187708 Vali Loss: 0.1668635 Test Loss: 0.1875922
Validation loss decreased (0.319069 --> 0.166864).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1912389
	speed: 0.1350s/iter; left time: 960.9547s
	iters: 200, epoch: 3 | loss: 0.1580966
	speed: 0.0536s/iter; left time: 375.7838s
	iters: 300, epoch: 3 | loss: 0.1571783
	speed: 0.0534s/iter; left time: 369.1894s
	iters: 400, epoch: 3 | loss: 0.1620918
	speed: 0.0534s/iter; left time: 364.1162s
	iters: 500, epoch: 3 | loss: 0.1507528
	speed: 0.0536s/iter; left time: 359.9931s
	iters: 600, epoch: 3 | loss: 0.1671983
	speed: 0.0534s/iter; left time: 353.1086s
	iters: 700, epoch: 3 | loss: 0.1423663
	speed: 0.0532s/iter; left time: 346.8447s
	iters: 800, epoch: 3 | loss: 0.1704713
	speed: 0.0535s/iter; left time: 343.1298s
	iters: 900, epoch: 3 | loss: 0.1696619
	speed: 0.0534s/iter; left time: 337.6427s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.49s
Steps: 902 | Train Loss: 0.1618859 Vali Loss: 0.1633216 Test Loss: 0.1745463
Validation loss decreased (0.166864 --> 0.163322).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1582388
	speed: 0.1328s/iter; left time: 825.2672s
	iters: 200, epoch: 4 | loss: 0.1516810
	speed: 0.0534s/iter; left time: 326.7718s
	iters: 300, epoch: 4 | loss: 0.1378785
	speed: 0.0531s/iter; left time: 319.6133s
	iters: 400, epoch: 4 | loss: 0.1575182
	speed: 0.0532s/iter; left time: 314.5776s
	iters: 500, epoch: 4 | loss: 0.1490256
	speed: 0.0522s/iter; left time: 303.3780s
	iters: 600, epoch: 4 | loss: 0.1329670
	speed: 0.0533s/iter; left time: 304.3511s
	iters: 700, epoch: 4 | loss: 0.1389233
	speed: 0.0534s/iter; left time: 300.0433s
	iters: 800, epoch: 4 | loss: 0.1491598
	speed: 0.0535s/iter; left time: 295.1766s
	iters: 900, epoch: 4 | loss: 0.1340696
	speed: 0.0535s/iter; left time: 289.6995s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.22s
Steps: 902 | Train Loss: 0.1444540 Vali Loss: 0.1620332 Test Loss: 0.1857745
Validation loss decreased (0.163322 --> 0.162033).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1313165
	speed: 0.1341s/iter; left time: 712.6462s
	iters: 200, epoch: 5 | loss: 0.1233402
	speed: 0.0534s/iter; left time: 278.2777s
	iters: 300, epoch: 5 | loss: 0.1362630
	speed: 0.0535s/iter; left time: 273.5586s
	iters: 400, epoch: 5 | loss: 0.1411424
	speed: 0.0533s/iter; left time: 267.1157s
	iters: 500, epoch: 5 | loss: 0.1263086
	speed: 0.0534s/iter; left time: 262.4771s
	iters: 600, epoch: 5 | loss: 0.1267703
	speed: 0.0532s/iter; left time: 256.0634s
	iters: 700, epoch: 5 | loss: 0.1169034
	speed: 0.0537s/iter; left time: 252.9753s
	iters: 800, epoch: 5 | loss: 0.1271486
	speed: 0.0530s/iter; left time: 244.4466s
	iters: 900, epoch: 5 | loss: 0.1136018
	speed: 0.0532s/iter; left time: 239.9597s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.35s
Steps: 902 | Train Loss: 0.1284857 Vali Loss: 0.1680490 Test Loss: 0.1856285
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1368518
	speed: 0.1299s/iter; left time: 573.0006s
	iters: 200, epoch: 6 | loss: 0.1018151
	speed: 0.0535s/iter; left time: 230.8313s
	iters: 300, epoch: 6 | loss: 0.1177235
	speed: 0.0533s/iter; left time: 224.3080s
	iters: 400, epoch: 6 | loss: 0.1205800
	speed: 0.0535s/iter; left time: 219.9936s
	iters: 500, epoch: 6 | loss: 0.1277281
	speed: 0.0535s/iter; left time: 214.6939s
	iters: 600, epoch: 6 | loss: 0.1199198
	speed: 0.0533s/iter; left time: 208.4946s
	iters: 700, epoch: 6 | loss: 0.1167714
	speed: 0.0534s/iter; left time: 203.4923s
	iters: 800, epoch: 6 | loss: 0.1001362
	speed: 0.0534s/iter; left time: 198.2642s
	iters: 900, epoch: 6 | loss: 0.0938075
	speed: 0.0533s/iter; left time: 192.4728s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.43s
Steps: 902 | Train Loss: 0.1136454 Vali Loss: 0.1834338 Test Loss: 0.2057332
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1056418
	speed: 0.1301s/iter; left time: 456.6226s
	iters: 200, epoch: 7 | loss: 0.1041363
	speed: 0.0534s/iter; left time: 182.0073s
	iters: 300, epoch: 7 | loss: 0.1026165
	speed: 0.0536s/iter; left time: 177.2038s
	iters: 400, epoch: 7 | loss: 0.1092902
	speed: 0.0532s/iter; left time: 170.8495s
	iters: 500, epoch: 7 | loss: 0.0900473
	speed: 0.0533s/iter; left time: 165.7049s
	iters: 600, epoch: 7 | loss: 0.0867380
	speed: 0.0534s/iter; left time: 160.5340s
	iters: 700, epoch: 7 | loss: 0.0969472
	speed: 0.0534s/iter; left time: 155.2814s
	iters: 800, epoch: 7 | loss: 0.0861391
	speed: 0.0532s/iter; left time: 149.5787s
	iters: 900, epoch: 7 | loss: 0.0882257
	speed: 0.0531s/iter; left time: 143.9566s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.35s
Steps: 902 | Train Loss: 0.0986794 Vali Loss: 0.1838279 Test Loss: 0.2055350
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.18572181463241577, rmse:0.43095454573631287, mae:0.2877998948097229, rse:0.5429210066795349
Original data scale mse:4445287.0, rmse:2108.385009765625, mae:1414.09912109375, rse:0.148514986038208

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.19100810587406158, RMSE: 0.43704473972320557, MAE: 0.2906225919723511, RSE: 0.5505934953689575
Unscaled Metrics - MSE: 4675170.5, RMSE: 2162.21435546875, MAE: 1425.986083984375, RSE: 0.15230673551559448

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.18572181463241577, RMSE: 0.43095454573631287, MAE: 0.2877998948097229, RSE: 0.5429210066795349
Unscaled Metrics - MSE: 4445287.0, RMSE: 2108.385009765625, MAE: 1414.09912109375, RSE: 0.148514986038208

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.6713250
	speed: 0.0711s/iter; left time: 636.8543s
	iters: 200, epoch: 1 | loss: 0.5746155
	speed: 0.0420s/iter; left time: 372.5324s
	iters: 300, epoch: 1 | loss: 0.4691629
	speed: 0.0416s/iter; left time: 364.2668s
	iters: 400, epoch: 1 | loss: 0.4558076
	speed: 0.0413s/iter; left time: 357.9231s
	iters: 500, epoch: 1 | loss: 0.3989495
	speed: 0.0413s/iter; left time: 353.5701s
	iters: 600, epoch: 1 | loss: 0.3951532
	speed: 0.0413s/iter; left time: 349.4303s
	iters: 700, epoch: 1 | loss: 0.3611161
	speed: 0.0413s/iter; left time: 345.2523s
	iters: 800, epoch: 1 | loss: 0.3683667
	speed: 0.0409s/iter; left time: 337.9324s
	iters: 900, epoch: 1 | loss: 0.4177614
	speed: 0.0415s/iter; left time: 338.5763s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.27s
Steps: 906 | Train Loss: 0.4823299 Vali Loss: 0.1297127 Test Loss: 0.1445100
Validation loss decreased (inf --> 0.129713).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3774882
	speed: 0.0981s/iter; left time: 790.1355s
	iters: 200, epoch: 2 | loss: 0.3590513
	speed: 0.0414s/iter; left time: 329.3928s
	iters: 300, epoch: 2 | loss: 0.3128399
	speed: 0.0411s/iter; left time: 322.8272s
	iters: 400, epoch: 2 | loss: 0.2862418
	speed: 0.0411s/iter; left time: 318.4109s
	iters: 500, epoch: 2 | loss: 0.3366916
	speed: 0.0411s/iter; left time: 314.9413s
	iters: 600, epoch: 2 | loss: 0.3188420
	speed: 0.0407s/iter; left time: 307.4296s
	iters: 700, epoch: 2 | loss: 0.3298711
	speed: 0.0410s/iter; left time: 305.3138s
	iters: 800, epoch: 2 | loss: 0.3207609
	speed: 0.0405s/iter; left time: 298.1130s
	iters: 900, epoch: 2 | loss: 0.3203365
	speed: 0.0407s/iter; left time: 295.6146s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.39s
Steps: 906 | Train Loss: 0.3200334 Vali Loss: 0.0892027 Test Loss: 0.1035133
Validation loss decreased (0.129713 --> 0.089203).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3195523
	speed: 0.1027s/iter; left time: 734.1392s
	iters: 200, epoch: 3 | loss: 0.2723418
	speed: 0.0409s/iter; left time: 288.1735s
	iters: 300, epoch: 3 | loss: 0.3066047
	speed: 0.0411s/iter; left time: 285.3017s
	iters: 400, epoch: 3 | loss: 0.2739902
	speed: 0.0405s/iter; left time: 277.3353s
	iters: 500, epoch: 3 | loss: 0.3328080
	speed: 0.0408s/iter; left time: 275.2985s
	iters: 600, epoch: 3 | loss: 0.3068560
	speed: 0.0406s/iter; left time: 269.9660s
	iters: 700, epoch: 3 | loss: 0.2571502
	speed: 0.0405s/iter; left time: 265.3207s
	iters: 800, epoch: 3 | loss: 0.2763128
	speed: 0.0408s/iter; left time: 263.2531s
	iters: 900, epoch: 3 | loss: 0.2732482
	speed: 0.0406s/iter; left time: 257.9999s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.16s
Steps: 906 | Train Loss: 0.2898511 Vali Loss: 0.0879231 Test Loss: 0.1062618
Validation loss decreased (0.089203 --> 0.087923).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2844734
	speed: 0.0978s/iter; left time: 610.8170s
	iters: 200, epoch: 4 | loss: 0.2732232
	speed: 0.0409s/iter; left time: 250.9717s
	iters: 300, epoch: 4 | loss: 0.2767519
	speed: 0.0413s/iter; left time: 249.7548s
	iters: 400, epoch: 4 | loss: 0.2922099
	speed: 0.0407s/iter; left time: 241.9880s
	iters: 500, epoch: 4 | loss: 0.2302153
	speed: 0.0407s/iter; left time: 237.5323s
	iters: 600, epoch: 4 | loss: 0.3151538
	speed: 0.0408s/iter; left time: 234.1979s
	iters: 700, epoch: 4 | loss: 0.2925580
	speed: 0.0407s/iter; left time: 229.4470s
	iters: 800, epoch: 4 | loss: 0.2975780
	speed: 0.0404s/iter; left time: 224.0522s
	iters: 900, epoch: 4 | loss: 0.3112267
	speed: 0.0405s/iter; left time: 220.2407s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.21s
Steps: 906 | Train Loss: 0.2737008 Vali Loss: 0.0830865 Test Loss: 0.1014789
Validation loss decreased (0.087923 --> 0.083086).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2465318
	speed: 0.0979s/iter; left time: 522.3602s
	iters: 200, epoch: 5 | loss: 0.2280588
	speed: 0.0407s/iter; left time: 213.0662s
	iters: 300, epoch: 5 | loss: 0.2604049
	speed: 0.0407s/iter; left time: 209.0768s
	iters: 400, epoch: 5 | loss: 0.2268636
	speed: 0.0408s/iter; left time: 205.5341s
	iters: 500, epoch: 5 | loss: 0.2929680
	speed: 0.0414s/iter; left time: 204.2966s
	iters: 600, epoch: 5 | loss: 0.2141552
	speed: 0.0415s/iter; left time: 200.6759s
	iters: 700, epoch: 5 | loss: 0.2961240
	speed: 0.0415s/iter; left time: 196.5399s
	iters: 800, epoch: 5 | loss: 0.2475485
	speed: 0.0409s/iter; left time: 189.4521s
	iters: 900, epoch: 5 | loss: 0.2456564
	speed: 0.0408s/iter; left time: 185.0831s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.45s
Steps: 906 | Train Loss: 0.2595105 Vali Loss: 0.0909883 Test Loss: 0.1040540
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2315773
	speed: 0.1019s/iter; left time: 451.3820s
	iters: 200, epoch: 6 | loss: 0.2623151
	speed: 0.0459s/iter; left time: 198.6174s
	iters: 300, epoch: 6 | loss: 0.2961919
	speed: 0.0450s/iter; left time: 190.4095s
	iters: 400, epoch: 6 | loss: 0.2524416
	speed: 0.0420s/iter; left time: 173.5357s
	iters: 500, epoch: 6 | loss: 0.2610012
	speed: 0.0421s/iter; left time: 169.7330s
	iters: 600, epoch: 6 | loss: 0.2793341
	speed: 0.0424s/iter; left time: 166.8615s
	iters: 700, epoch: 6 | loss: 0.2532963
	speed: 0.0420s/iter; left time: 160.7202s
	iters: 800, epoch: 6 | loss: 0.2478609
	speed: 0.0410s/iter; left time: 153.0658s
	iters: 900, epoch: 6 | loss: 0.2598470
	speed: 0.0414s/iter; left time: 150.2936s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:39.40s
Steps: 906 | Train Loss: 0.2444963 Vali Loss: 0.0934578 Test Loss: 0.1112469
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2545051
	speed: 0.0953s/iter; left time: 336.0677s
	iters: 200, epoch: 7 | loss: 0.2206395
	speed: 0.0405s/iter; left time: 138.7239s
	iters: 300, epoch: 7 | loss: 0.2069458
	speed: 0.0407s/iter; left time: 135.3046s
	iters: 400, epoch: 7 | loss: 0.2269061
	speed: 0.0409s/iter; left time: 131.8963s
	iters: 500, epoch: 7 | loss: 0.2188151
	speed: 0.0408s/iter; left time: 127.4390s
	iters: 600, epoch: 7 | loss: 0.2116071
	speed: 0.0410s/iter; left time: 124.1179s
	iters: 700, epoch: 7 | loss: 0.2180890
	speed: 0.0406s/iter; left time: 118.8846s
	iters: 800, epoch: 7 | loss: 0.2350762
	speed: 0.0409s/iter; left time: 115.5154s
	iters: 900, epoch: 7 | loss: 0.2312025
	speed: 0.0410s/iter; left time: 111.6853s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.25s
Steps: 906 | Train Loss: 0.2293505 Vali Loss: 0.0911001 Test Loss: 0.1068099
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.10121527314186096, rmse:0.31814348697662354, mae:0.1955755352973938, rse:0.4017200171947479
Original data scale mse:1772951.375, rmse:1331.522216796875, mae:882.83447265625, rse:0.09356920421123505
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.6387104
	speed: 0.0439s/iter; left time: 393.4884s
	iters: 200, epoch: 1 | loss: 0.5202302
	speed: 0.0415s/iter; left time: 368.0963s
	iters: 300, epoch: 1 | loss: 0.4718112
	speed: 0.0420s/iter; left time: 367.6984s
	iters: 400, epoch: 1 | loss: 0.4226309
	speed: 0.0420s/iter; left time: 363.4308s
	iters: 500, epoch: 1 | loss: 0.3903136
	speed: 0.0416s/iter; left time: 355.7931s
	iters: 600, epoch: 1 | loss: 0.4099773
	speed: 0.0422s/iter; left time: 356.7406s
	iters: 700, epoch: 1 | loss: 0.3962696
	speed: 0.0424s/iter; left time: 354.1770s
	iters: 800, epoch: 1 | loss: 0.3976924
	speed: 0.0423s/iter; left time: 349.1104s
	iters: 900, epoch: 1 | loss: 0.3702214
	speed: 0.0422s/iter; left time: 344.5023s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.33s
Steps: 906 | Train Loss: 0.4750207 Vali Loss: 0.1252253 Test Loss: 0.1440151
Validation loss decreased (inf --> 0.125225).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3238702
	speed: 0.0983s/iter; left time: 791.6843s
	iters: 200, epoch: 2 | loss: 0.3565642
	speed: 0.0413s/iter; left time: 328.3182s
	iters: 300, epoch: 2 | loss: 0.2994523
	speed: 0.0409s/iter; left time: 321.2571s
	iters: 400, epoch: 2 | loss: 0.3117840
	speed: 0.0405s/iter; left time: 314.3972s
	iters: 500, epoch: 2 | loss: 0.3382605
	speed: 0.0404s/iter; left time: 309.6441s
	iters: 600, epoch: 2 | loss: 0.2482596
	speed: 0.0406s/iter; left time: 306.7462s
	iters: 700, epoch: 2 | loss: 0.2856577
	speed: 0.0405s/iter; left time: 301.9089s
	iters: 800, epoch: 2 | loss: 0.2650714
	speed: 0.0404s/iter; left time: 296.7895s
	iters: 900, epoch: 2 | loss: 0.2874792
	speed: 0.0405s/iter; left time: 293.6864s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.16s
Steps: 906 | Train Loss: 0.3208735 Vali Loss: 0.0921786 Test Loss: 0.1085492
Validation loss decreased (0.125225 --> 0.092179).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2825559
	speed: 0.0984s/iter; left time: 703.3786s
	iters: 200, epoch: 3 | loss: 0.2785680
	speed: 0.0404s/iter; left time: 285.0572s
	iters: 300, epoch: 3 | loss: 0.3291669
	speed: 0.0408s/iter; left time: 283.6369s
	iters: 400, epoch: 3 | loss: 0.2636746
	speed: 0.0408s/iter; left time: 279.1684s
	iters: 500, epoch: 3 | loss: 0.2784389
	speed: 0.0408s/iter; left time: 275.5807s
	iters: 600, epoch: 3 | loss: 0.2625436
	speed: 0.0405s/iter; left time: 269.3736s
	iters: 700, epoch: 3 | loss: 0.3021619
	speed: 0.0407s/iter; left time: 266.4316s
	iters: 800, epoch: 3 | loss: 0.3065397
	speed: 0.0407s/iter; left time: 262.2978s
	iters: 900, epoch: 3 | loss: 0.2815774
	speed: 0.0405s/iter; left time: 257.4468s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.14s
Steps: 906 | Train Loss: 0.2897735 Vali Loss: 0.0840460 Test Loss: 0.0999372
Validation loss decreased (0.092179 --> 0.084046).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3026658
	speed: 0.1015s/iter; left time: 633.4493s
	iters: 200, epoch: 4 | loss: 0.2818322
	speed: 0.0406s/iter; left time: 249.5643s
	iters: 300, epoch: 4 | loss: 0.3274560
	speed: 0.0403s/iter; left time: 243.8232s
	iters: 400, epoch: 4 | loss: 0.2884991
	speed: 0.0349s/iter; left time: 207.2581s
	iters: 500, epoch: 4 | loss: 0.2975112
	speed: 0.0403s/iter; left time: 235.4278s
	iters: 600, epoch: 4 | loss: 0.2391492
	speed: 0.0406s/iter; left time: 233.2116s
	iters: 700, epoch: 4 | loss: 0.2316259
	speed: 0.0406s/iter; left time: 229.2331s
	iters: 800, epoch: 4 | loss: 0.2406767
	speed: 0.0396s/iter; left time: 219.3908s
	iters: 900, epoch: 4 | loss: 0.2454505
	speed: 0.0406s/iter; left time: 221.2038s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.37s
Steps: 906 | Train Loss: 0.2776075 Vali Loss: 0.0879932 Test Loss: 0.1045437
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2722987
	speed: 0.0953s/iter; left time: 508.4674s
	iters: 200, epoch: 5 | loss: 0.3304349
	speed: 0.0417s/iter; left time: 218.3732s
	iters: 300, epoch: 5 | loss: 0.2579944
	speed: 0.0421s/iter; left time: 216.4062s
	iters: 400, epoch: 5 | loss: 0.2711307
	speed: 0.0422s/iter; left time: 212.4489s
	iters: 500, epoch: 5 | loss: 0.2844849
	speed: 0.0416s/iter; left time: 205.5543s
	iters: 600, epoch: 5 | loss: 0.2492066
	speed: 0.0420s/iter; left time: 203.0845s
	iters: 700, epoch: 5 | loss: 0.2619545
	speed: 0.0410s/iter; left time: 194.2880s
	iters: 800, epoch: 5 | loss: 0.2553905
	speed: 0.0413s/iter; left time: 191.4817s
	iters: 900, epoch: 5 | loss: 0.2662020
	speed: 0.0411s/iter; left time: 186.3556s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.99s
Steps: 906 | Train Loss: 0.2636664 Vali Loss: 0.0895833 Test Loss: 0.1048924
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2702800
	speed: 0.0956s/iter; left time: 423.3911s
	iters: 200, epoch: 6 | loss: 0.2116584
	speed: 0.0415s/iter; left time: 179.5900s
	iters: 300, epoch: 6 | loss: 0.2352795
	speed: 0.0410s/iter; left time: 173.5184s
	iters: 400, epoch: 6 | loss: 0.2390181
	speed: 0.0409s/iter; left time: 168.7737s
	iters: 500, epoch: 6 | loss: 0.2512813
	speed: 0.0412s/iter; left time: 165.8862s
	iters: 600, epoch: 6 | loss: 0.2593416
	speed: 0.0408s/iter; left time: 160.3884s
	iters: 700, epoch: 6 | loss: 0.2502033
	speed: 0.0409s/iter; left time: 156.5038s
	iters: 800, epoch: 6 | loss: 0.2122997
	speed: 0.0411s/iter; left time: 153.3358s
	iters: 900, epoch: 6 | loss: 0.2274542
	speed: 0.0407s/iter; left time: 147.7527s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.39s
Steps: 906 | Train Loss: 0.2505443 Vali Loss: 0.0889714 Test Loss: 0.0995042
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.09998292475938797, rmse:0.31620076298713684, mae:0.1991349756717682, rse:0.3992669880390167
Original data scale mse:1705655.875, rmse:1306.007568359375, mae:881.322265625, rse:0.09177622944116592

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.10121527314186096, RMSE: 0.31814348697662354, MAE: 0.1955755352973938, RSE: 0.4017200171947479
Unscaled Metrics - MSE: 1772951.375, RMSE: 1331.522216796875, MAE: 882.83447265625, RSE: 0.09356920421123505

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.09998292475938797, RMSE: 0.31620076298713684, MAE: 0.1991349756717682, RSE: 0.3992669880390167
Unscaled Metrics - MSE: 1705655.875, RMSE: 1306.007568359375, MAE: 881.322265625, RSE: 0.09177622944116592

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7076046
	speed: 0.0802s/iter; left time: 716.7557s
	iters: 200, epoch: 1 | loss: 0.6578112
	speed: 0.0504s/iter; left time: 445.4731s
	iters: 300, epoch: 1 | loss: 0.5769344
	speed: 0.0506s/iter; left time: 442.0016s
	iters: 400, epoch: 1 | loss: 0.5587603
	speed: 0.0506s/iter; left time: 437.0378s
	iters: 500, epoch: 1 | loss: 0.5470400
	speed: 0.0505s/iter; left time: 430.9606s
	iters: 600, epoch: 1 | loss: 0.5232704
	speed: 0.0504s/iter; left time: 425.4894s
	iters: 700, epoch: 1 | loss: 0.5129842
	speed: 0.0502s/iter; left time: 418.3993s
	iters: 800, epoch: 1 | loss: 0.5082648
	speed: 0.0471s/iter; left time: 387.7673s
	iters: 900, epoch: 1 | loss: 0.5144677
	speed: 0.0473s/iter; left time: 385.3660s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:45.67s
Steps: 904 | Train Loss: 0.5785226 Vali Loss: 0.2295883 Test Loss: 0.2638969
Validation loss decreased (inf --> 0.229588).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4732634
	speed: 0.1167s/iter; left time: 938.1659s
	iters: 200, epoch: 2 | loss: 0.4678551
	speed: 0.0478s/iter; left time: 379.1766s
	iters: 300, epoch: 2 | loss: 0.4294797
	speed: 0.0476s/iter; left time: 372.7387s
	iters: 400, epoch: 2 | loss: 0.4149728
	speed: 0.0478s/iter; left time: 370.0574s
	iters: 500, epoch: 2 | loss: 0.4075000
	speed: 0.0476s/iter; left time: 363.6969s
	iters: 600, epoch: 2 | loss: 0.4256922
	speed: 0.0476s/iter; left time: 358.6389s
	iters: 700, epoch: 2 | loss: 0.3983435
	speed: 0.0476s/iter; left time: 354.0736s
	iters: 800, epoch: 2 | loss: 0.3994232
	speed: 0.0476s/iter; left time: 349.5357s
	iters: 900, epoch: 2 | loss: 0.3774057
	speed: 0.0476s/iter; left time: 344.6866s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.35s
Steps: 904 | Train Loss: 0.4255902 Vali Loss: 0.1541461 Test Loss: 0.1693270
Validation loss decreased (0.229588 --> 0.154146).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3967619
	speed: 0.1150s/iter; left time: 820.2421s
	iters: 200, epoch: 3 | loss: 0.3920103
	speed: 0.0474s/iter; left time: 333.5479s
	iters: 300, epoch: 3 | loss: 0.3928330
	speed: 0.0475s/iter; left time: 329.4105s
	iters: 400, epoch: 3 | loss: 0.3925671
	speed: 0.0474s/iter; left time: 323.8783s
	iters: 500, epoch: 3 | loss: 0.3702200
	speed: 0.0471s/iter; left time: 317.1831s
	iters: 600, epoch: 3 | loss: 0.3681182
	speed: 0.0472s/iter; left time: 312.9214s
	iters: 700, epoch: 3 | loss: 0.3606570
	speed: 0.0471s/iter; left time: 307.9082s
	iters: 800, epoch: 3 | loss: 0.4051598
	speed: 0.0476s/iter; left time: 306.2310s
	iters: 900, epoch: 3 | loss: 0.4003642
	speed: 0.0475s/iter; left time: 300.6565s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.03s
Steps: 904 | Train Loss: 0.3784842 Vali Loss: 0.1468547 Test Loss: 0.1658393
Validation loss decreased (0.154146 --> 0.146855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3489684
	speed: 0.1156s/iter; left time: 720.1678s
	iters: 200, epoch: 4 | loss: 0.3631746
	speed: 0.0470s/iter; left time: 288.1459s
	iters: 300, epoch: 4 | loss: 0.3305521
	speed: 0.0474s/iter; left time: 286.0212s
	iters: 400, epoch: 4 | loss: 0.3837603
	speed: 0.0474s/iter; left time: 281.2414s
	iters: 500, epoch: 4 | loss: 0.3715574
	speed: 0.0475s/iter; left time: 276.9851s
	iters: 600, epoch: 4 | loss: 0.3740263
	speed: 0.0477s/iter; left time: 273.2213s
	iters: 700, epoch: 4 | loss: 0.3437344
	speed: 0.0472s/iter; left time: 265.6247s
	iters: 800, epoch: 4 | loss: 0.3518785
	speed: 0.0473s/iter; left time: 261.4097s
	iters: 900, epoch: 4 | loss: 0.3361613
	speed: 0.0474s/iter; left time: 257.1632s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.05s
Steps: 904 | Train Loss: 0.3586428 Vali Loss: 0.1560999 Test Loss: 0.1877114
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3248732
	speed: 0.1131s/iter; left time: 602.5082s
	iters: 200, epoch: 5 | loss: 0.3218637
	speed: 0.0476s/iter; left time: 248.6593s
	iters: 300, epoch: 5 | loss: 0.3424231
	speed: 0.0476s/iter; left time: 244.0626s
	iters: 400, epoch: 5 | loss: 0.3658382
	speed: 0.0476s/iter; left time: 239.0712s
	iters: 500, epoch: 5 | loss: 0.3252520
	speed: 0.0476s/iter; left time: 234.3015s
	iters: 600, epoch: 5 | loss: 0.3373571
	speed: 0.0478s/iter; left time: 230.7813s
	iters: 700, epoch: 5 | loss: 0.3443996
	speed: 0.0477s/iter; left time: 225.3664s
	iters: 800, epoch: 5 | loss: 0.3433782
	speed: 0.0477s/iter; left time: 220.5594s
	iters: 900, epoch: 5 | loss: 0.3306960
	speed: 0.0474s/iter; left time: 214.4160s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.28s
Steps: 904 | Train Loss: 0.3405212 Vali Loss: 0.1581815 Test Loss: 0.1783044
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2823818
	speed: 0.1144s/iter; left time: 505.9786s
	iters: 200, epoch: 6 | loss: 0.3170049
	speed: 0.0501s/iter; left time: 216.3365s
	iters: 300, epoch: 6 | loss: 0.3333640
	speed: 0.0499s/iter; left time: 210.6539s
	iters: 400, epoch: 6 | loss: 0.3317137
	speed: 0.0501s/iter; left time: 206.5240s
	iters: 500, epoch: 6 | loss: 0.3278592
	speed: 0.0500s/iter; left time: 201.1922s
	iters: 600, epoch: 6 | loss: 0.3134820
	speed: 0.0500s/iter; left time: 196.0346s
	iters: 700, epoch: 6 | loss: 0.2773586
	speed: 0.0501s/iter; left time: 191.3630s
	iters: 800, epoch: 6 | loss: 0.3259693
	speed: 0.0501s/iter; left time: 186.6063s
	iters: 900, epoch: 6 | loss: 0.3263755
	speed: 0.0502s/iter; left time: 181.8907s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.42s
Steps: 904 | Train Loss: 0.3207081 Vali Loss: 0.1650522 Test Loss: 0.1883738
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.1658245027065277, rmse:0.40721553564071655, mae:0.26516279578208923, rse:0.513576865196228
Original data scale mse:3241397.75, rmse:1800.38818359375, mae:1225.7508544921875, rse:0.12670066952705383
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6672028
	speed: 0.0493s/iter; left time: 440.9679s
	iters: 200, epoch: 1 | loss: 0.6411328
	speed: 0.0475s/iter; left time: 420.2654s
	iters: 300, epoch: 1 | loss: 0.6009921
	speed: 0.0476s/iter; left time: 416.4155s
	iters: 400, epoch: 1 | loss: 0.5562096
	speed: 0.0476s/iter; left time: 411.1776s
	iters: 500, epoch: 1 | loss: 0.5659007
	speed: 0.0478s/iter; left time: 407.8408s
	iters: 600, epoch: 1 | loss: 0.4958803
	speed: 0.0477s/iter; left time: 402.4228s
	iters: 700, epoch: 1 | loss: 0.5227539
	speed: 0.0476s/iter; left time: 396.9508s
	iters: 800, epoch: 1 | loss: 0.5079434
	speed: 0.0475s/iter; left time: 391.2304s
	iters: 900, epoch: 1 | loss: 0.5088897
	speed: 0.0476s/iter; left time: 387.3342s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.28s
Steps: 904 | Train Loss: 0.5751543 Vali Loss: 0.2293541 Test Loss: 0.2676332
Validation loss decreased (inf --> 0.229354).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5067975
	speed: 0.1159s/iter; left time: 931.2692s
	iters: 200, epoch: 2 | loss: 0.5009702
	speed: 0.0474s/iter; left time: 376.5013s
	iters: 300, epoch: 2 | loss: 0.4146907
	speed: 0.0471s/iter; left time: 369.2055s
	iters: 400, epoch: 2 | loss: 0.4065040
	speed: 0.0474s/iter; left time: 366.4733s
	iters: 500, epoch: 2 | loss: 0.4014253
	speed: 0.0474s/iter; left time: 362.2084s
	iters: 600, epoch: 2 | loss: 0.4311000
	speed: 0.0476s/iter; left time: 358.6814s
	iters: 700, epoch: 2 | loss: 0.3940893
	speed: 0.0476s/iter; left time: 353.7970s
	iters: 800, epoch: 2 | loss: 0.3867381
	speed: 0.0474s/iter; left time: 347.4309s
	iters: 900, epoch: 2 | loss: 0.3697745
	speed: 0.0474s/iter; left time: 342.8745s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.09s
Steps: 904 | Train Loss: 0.4226489 Vali Loss: 0.1488076 Test Loss: 0.1676236
Validation loss decreased (0.229354 --> 0.148808).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3767413
	speed: 0.1199s/iter; left time: 855.2428s
	iters: 200, epoch: 3 | loss: 0.3853996
	speed: 0.0502s/iter; left time: 353.2613s
	iters: 300, epoch: 3 | loss: 0.3907964
	speed: 0.0480s/iter; left time: 333.1190s
	iters: 400, epoch: 3 | loss: 0.3817881
	speed: 0.0479s/iter; left time: 327.1148s
	iters: 500, epoch: 3 | loss: 0.3638865
	speed: 0.0479s/iter; left time: 322.1902s
	iters: 600, epoch: 3 | loss: 0.3909920
	speed: 0.0477s/iter; left time: 316.3597s
	iters: 700, epoch: 3 | loss: 0.3906323
	speed: 0.0477s/iter; left time: 311.5878s
	iters: 800, epoch: 3 | loss: 0.3639559
	speed: 0.0476s/iter; left time: 306.4525s
	iters: 900, epoch: 3 | loss: 0.3295690
	speed: 0.0487s/iter; left time: 308.4801s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:44.08s
Steps: 904 | Train Loss: 0.3760676 Vali Loss: 0.1517964 Test Loss: 0.1692900
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3557675
	speed: 0.1128s/iter; left time: 702.3462s
	iters: 200, epoch: 4 | loss: 0.3477727
	speed: 0.0476s/iter; left time: 291.7067s
	iters: 300, epoch: 4 | loss: 0.3481817
	speed: 0.0473s/iter; left time: 285.3461s
	iters: 400, epoch: 4 | loss: 0.3668278
	speed: 0.0475s/iter; left time: 281.8820s
	iters: 500, epoch: 4 | loss: 0.3499805
	speed: 0.0475s/iter; left time: 276.7011s
	iters: 600, epoch: 4 | loss: 0.3646893
	speed: 0.0474s/iter; left time: 271.6823s
	iters: 700, epoch: 4 | loss: 0.3595571
	speed: 0.0476s/iter; left time: 267.9632s
	iters: 800, epoch: 4 | loss: 0.3383426
	speed: 0.0476s/iter; left time: 263.0439s
	iters: 900, epoch: 4 | loss: 0.3377383
	speed: 0.0474s/iter; left time: 257.4807s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.16s
Steps: 904 | Train Loss: 0.3568804 Vali Loss: 0.1482026 Test Loss: 0.1685868
Validation loss decreased (0.148808 --> 0.148203).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3419493
	speed: 0.1156s/iter; left time: 615.3142s
	iters: 200, epoch: 5 | loss: 0.3460248
	speed: 0.0477s/iter; left time: 249.3727s
	iters: 300, epoch: 5 | loss: 0.3735531
	speed: 0.0478s/iter; left time: 244.7819s
	iters: 400, epoch: 5 | loss: 0.3435251
	speed: 0.0475s/iter; left time: 238.8335s
	iters: 500, epoch: 5 | loss: 0.3315926
	speed: 0.0478s/iter; left time: 235.4938s
	iters: 600, epoch: 5 | loss: 0.3124721
	speed: 0.0474s/iter; left time: 228.6926s
	iters: 700, epoch: 5 | loss: 0.3316106
	speed: 0.0477s/iter; left time: 225.4776s
	iters: 800, epoch: 5 | loss: 0.3173794
	speed: 0.0477s/iter; left time: 220.8379s
	iters: 900, epoch: 5 | loss: 0.3123973
	speed: 0.0476s/iter; left time: 215.2903s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.31s
Steps: 904 | Train Loss: 0.3386473 Vali Loss: 0.1553063 Test Loss: 0.1836271
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3127868
	speed: 0.1126s/iter; left time: 497.7198s
	iters: 200, epoch: 6 | loss: 0.3188365
	speed: 0.0475s/iter; left time: 205.1790s
	iters: 300, epoch: 6 | loss: 0.3285469
	speed: 0.0475s/iter; left time: 200.6273s
	iters: 400, epoch: 6 | loss: 0.3047352
	speed: 0.0476s/iter; left time: 196.2882s
	iters: 500, epoch: 6 | loss: 0.3122153
	speed: 0.0477s/iter; left time: 191.7161s
	iters: 600, epoch: 6 | loss: 0.3297661
	speed: 0.0475s/iter; left time: 186.3747s
	iters: 700, epoch: 6 | loss: 0.3428793
	speed: 0.0478s/iter; left time: 182.5869s
	iters: 800, epoch: 6 | loss: 0.3054907
	speed: 0.0474s/iter; left time: 176.4158s
	iters: 900, epoch: 6 | loss: 0.2888380
	speed: 0.0474s/iter; left time: 171.6798s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.21s
Steps: 904 | Train Loss: 0.3165271 Vali Loss: 0.1582868 Test Loss: 0.1829295
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2851221
	speed: 0.1140s/iter; left time: 400.9939s
	iters: 200, epoch: 7 | loss: 0.2907151
	speed: 0.0474s/iter; left time: 162.0832s
	iters: 300, epoch: 7 | loss: 0.2974072
	speed: 0.0478s/iter; left time: 158.5306s
	iters: 400, epoch: 7 | loss: 0.2852646
	speed: 0.0479s/iter; left time: 154.1008s
	iters: 500, epoch: 7 | loss: 0.3227853
	speed: 0.0476s/iter; left time: 148.3787s
	iters: 600, epoch: 7 | loss: 0.2930651
	speed: 0.0476s/iter; left time: 143.7180s
	iters: 700, epoch: 7 | loss: 0.3022570
	speed: 0.0475s/iter; left time: 138.4527s
	iters: 800, epoch: 7 | loss: 0.2779420
	speed: 0.0476s/iter; left time: 134.1450s
	iters: 900, epoch: 7 | loss: 0.2702541
	speed: 0.0476s/iter; left time: 129.2359s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.32s
Steps: 904 | Train Loss: 0.2941211 Vali Loss: 0.1734410 Test Loss: 0.1993210
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.16867855191230774, rmse:0.41070494055747986, mae:0.26371267437934875, rse:0.5179775953292847
Original data scale mse:3074052.25, rmse:1753.2974853515625, mae:1195.16259765625, rse:0.12338671088218689

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.1658245027065277, RMSE: 0.40721553564071655, MAE: 0.26516279578208923, RSE: 0.513576865196228
Unscaled Metrics - MSE: 3241397.75, RMSE: 1800.38818359375, MAE: 1225.7508544921875, RSE: 0.12670066952705383

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.16867855191230774, RMSE: 0.41070494055747986, MAE: 0.26371267437934875, RSE: 0.5179775953292847
Unscaled Metrics - MSE: 3074052.25, RMSE: 1753.2974853515625, MAE: 1195.16259765625, RSE: 0.12338671088218689

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7030319
	speed: 0.0839s/iter; left time: 748.5235s
	iters: 200, epoch: 1 | loss: 0.6379470
	speed: 0.0540s/iter; left time: 476.5007s
	iters: 300, epoch: 1 | loss: 0.6583493
	speed: 0.0540s/iter; left time: 471.2133s
	iters: 400, epoch: 1 | loss: 0.6269465
	speed: 0.0535s/iter; left time: 461.3240s
	iters: 500, epoch: 1 | loss: 0.6083505
	speed: 0.0534s/iter; left time: 455.4200s
	iters: 600, epoch: 1 | loss: 0.6066701
	speed: 0.0535s/iter; left time: 450.2474s
	iters: 700, epoch: 1 | loss: 0.5861924
	speed: 0.0534s/iter; left time: 444.0215s
	iters: 800, epoch: 1 | loss: 0.6097019
	speed: 0.0532s/iter; left time: 437.7048s
	iters: 900, epoch: 1 | loss: 0.5756783
	speed: 0.0540s/iter; left time: 438.2281s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.20s
Steps: 902 | Train Loss: 0.6260541 Vali Loss: 0.3185092 Test Loss: 0.3676021
Validation loss decreased (inf --> 0.318509).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5736175
	speed: 0.1331s/iter; left time: 1067.3181s
	iters: 200, epoch: 2 | loss: 0.5195261
	speed: 0.0529s/iter; left time: 418.9155s
	iters: 300, epoch: 2 | loss: 0.4741110
	speed: 0.0533s/iter; left time: 416.6689s
	iters: 400, epoch: 2 | loss: 0.4486416
	speed: 0.0532s/iter; left time: 410.4720s
	iters: 500, epoch: 2 | loss: 0.4234707
	speed: 0.0535s/iter; left time: 407.7040s
	iters: 600, epoch: 2 | loss: 0.4446415
	speed: 0.0534s/iter; left time: 401.6814s
	iters: 700, epoch: 2 | loss: 0.3860600
	speed: 0.0536s/iter; left time: 397.3061s
	iters: 800, epoch: 2 | loss: 0.3970504
	speed: 0.0531s/iter; left time: 388.4043s
	iters: 900, epoch: 2 | loss: 0.3983404
	speed: 0.0533s/iter; left time: 384.8615s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.34s
Steps: 902 | Train Loss: 0.4623911 Vali Loss: 0.1713549 Test Loss: 0.2025613
Validation loss decreased (0.318509 --> 0.171355).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3905887
	speed: 0.1376s/iter; left time: 979.6159s
	iters: 200, epoch: 3 | loss: 0.4174222
	speed: 0.0534s/iter; left time: 375.0495s
	iters: 300, epoch: 3 | loss: 0.4136868
	speed: 0.0532s/iter; left time: 368.1868s
	iters: 400, epoch: 3 | loss: 0.4274124
	speed: 0.0530s/iter; left time: 361.4051s
	iters: 500, epoch: 3 | loss: 0.4152164
	speed: 0.0533s/iter; left time: 357.9887s
	iters: 600, epoch: 3 | loss: 0.3837762
	speed: 0.0533s/iter; left time: 352.4076s
	iters: 700, epoch: 3 | loss: 0.3787870
	speed: 0.0532s/iter; left time: 346.8958s
	iters: 800, epoch: 3 | loss: 0.3964634
	speed: 0.0533s/iter; left time: 341.7249s
	iters: 900, epoch: 3 | loss: 0.3896996
	speed: 0.0533s/iter; left time: 336.8227s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.35s
Steps: 902 | Train Loss: 0.3983761 Vali Loss: 0.1663148 Test Loss: 0.1848693
Validation loss decreased (0.171355 --> 0.166315).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3883315
	speed: 0.1352s/iter; left time: 840.1276s
	iters: 200, epoch: 4 | loss: 0.3728841
	speed: 0.0538s/iter; left time: 328.9867s
	iters: 300, epoch: 4 | loss: 0.4123284
	speed: 0.0533s/iter; left time: 320.4594s
	iters: 400, epoch: 4 | loss: 0.3718892
	speed: 0.0534s/iter; left time: 316.1063s
	iters: 500, epoch: 4 | loss: 0.3651274
	speed: 0.0536s/iter; left time: 311.4453s
	iters: 600, epoch: 4 | loss: 0.3572811
	speed: 0.0533s/iter; left time: 304.6674s
	iters: 700, epoch: 4 | loss: 0.3860814
	speed: 0.0534s/iter; left time: 300.0396s
	iters: 800, epoch: 4 | loss: 0.3816961
	speed: 0.0533s/iter; left time: 293.9776s
	iters: 900, epoch: 4 | loss: 0.3650135
	speed: 0.0532s/iter; left time: 288.2238s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.47s
Steps: 902 | Train Loss: 0.3741104 Vali Loss: 0.1641398 Test Loss: 0.1942639
Validation loss decreased (0.166315 --> 0.164140).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3342488
	speed: 0.1323s/iter; left time: 702.9499s
	iters: 200, epoch: 5 | loss: 0.3426462
	speed: 0.0536s/iter; left time: 279.2700s
	iters: 300, epoch: 5 | loss: 0.3665124
	speed: 0.0535s/iter; left time: 273.3211s
	iters: 400, epoch: 5 | loss: 0.3555437
	speed: 0.0532s/iter; left time: 266.5344s
	iters: 500, epoch: 5 | loss: 0.3538319
	speed: 0.0535s/iter; left time: 262.9908s
	iters: 600, epoch: 5 | loss: 0.3626565
	speed: 0.0535s/iter; left time: 257.4855s
	iters: 700, epoch: 5 | loss: 0.3609807
	speed: 0.0536s/iter; left time: 252.4125s
	iters: 800, epoch: 5 | loss: 0.3420316
	speed: 0.0533s/iter; left time: 245.7224s
	iters: 900, epoch: 5 | loss: 0.3177894
	speed: 0.0535s/iter; left time: 241.4457s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.3497111 Vali Loss: 0.1779226 Test Loss: 0.1954813
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3193985
	speed: 0.1287s/iter; left time: 567.6670s
	iters: 200, epoch: 6 | loss: 0.3323399
	speed: 0.0530s/iter; left time: 228.6441s
	iters: 300, epoch: 6 | loss: 0.3176599
	speed: 0.0531s/iter; left time: 223.4800s
	iters: 400, epoch: 6 | loss: 0.3318381
	speed: 0.0526s/iter; left time: 216.2846s
	iters: 500, epoch: 6 | loss: 0.3247978
	speed: 0.0529s/iter; left time: 212.1795s
	iters: 600, epoch: 6 | loss: 0.3188559
	speed: 0.0525s/iter; left time: 205.2728s
	iters: 700, epoch: 6 | loss: 0.3107843
	speed: 0.0526s/iter; left time: 200.5402s
	iters: 800, epoch: 6 | loss: 0.3002223
	speed: 0.0529s/iter; left time: 196.2235s
	iters: 900, epoch: 6 | loss: 0.3081976
	speed: 0.0528s/iter; left time: 190.5044s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.82s
Steps: 902 | Train Loss: 0.3248961 Vali Loss: 0.1818803 Test Loss: 0.2120247
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3027043
	speed: 0.1293s/iter; left time: 453.5444s
	iters: 200, epoch: 7 | loss: 0.3187273
	speed: 0.0535s/iter; left time: 182.5042s
	iters: 300, epoch: 7 | loss: 0.2836799
	speed: 0.0535s/iter; left time: 177.1857s
	iters: 400, epoch: 7 | loss: 0.2965950
	speed: 0.0535s/iter; left time: 171.8120s
	iters: 500, epoch: 7 | loss: 0.3029802
	speed: 0.0535s/iter; left time: 166.4681s
	iters: 600, epoch: 7 | loss: 0.2989697
	speed: 0.0536s/iter; left time: 161.2123s
	iters: 700, epoch: 7 | loss: 0.2894181
	speed: 0.0534s/iter; left time: 155.3672s
	iters: 800, epoch: 7 | loss: 0.2712937
	speed: 0.0534s/iter; left time: 149.8770s
	iters: 900, epoch: 7 | loss: 0.2549787
	speed: 0.0536s/iter; left time: 145.0834s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.47s
Steps: 902 | Train Loss: 0.3009742 Vali Loss: 0.1985542 Test Loss: 0.2236999
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.1943083256483078, rmse:0.4408041834831238, mae:0.29183581471443176, rse:0.5553297400474548
Original data scale mse:4601502.0, rmse:2145.111083984375, mae:1414.7354736328125, rse:0.1511019915342331
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.6723502
	speed: 0.0548s/iter; left time: 488.8549s
	iters: 200, epoch: 1 | loss: 0.6609371
	speed: 0.0533s/iter; left time: 470.0426s
	iters: 300, epoch: 1 | loss: 0.6070185
	speed: 0.0532s/iter; left time: 464.2008s
	iters: 400, epoch: 1 | loss: 0.6146190
	speed: 0.0533s/iter; left time: 459.4865s
	iters: 500, epoch: 1 | loss: 0.6127619
	speed: 0.0531s/iter; left time: 452.3338s
	iters: 600, epoch: 1 | loss: 0.5725184
	speed: 0.0528s/iter; left time: 444.2240s
	iters: 700, epoch: 1 | loss: 0.5825441
	speed: 0.0532s/iter; left time: 442.7166s
	iters: 800, epoch: 1 | loss: 0.5778645
	speed: 0.0535s/iter; left time: 439.8502s
	iters: 900, epoch: 1 | loss: 0.5800887
	speed: 0.0532s/iter; left time: 432.2504s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.22s
Steps: 902 | Train Loss: 0.6227781 Vali Loss: 0.3165659 Test Loss: 0.3747235
Validation loss decreased (inf --> 0.316566).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5546201
	speed: 0.1338s/iter; left time: 1073.0040s
	iters: 200, epoch: 2 | loss: 0.5001150
	speed: 0.0533s/iter; left time: 422.0764s
	iters: 300, epoch: 2 | loss: 0.4752352
	speed: 0.0534s/iter; left time: 417.8601s
	iters: 400, epoch: 2 | loss: 0.4362716
	speed: 0.0535s/iter; left time: 412.9809s
	iters: 500, epoch: 2 | loss: 0.4830326
	speed: 0.0537s/iter; left time: 408.9044s
	iters: 600, epoch: 2 | loss: 0.3963277
	speed: 0.0534s/iter; left time: 401.7560s
	iters: 700, epoch: 2 | loss: 0.4241565
	speed: 0.0533s/iter; left time: 395.5212s
	iters: 800, epoch: 2 | loss: 0.3883984
	speed: 0.0533s/iter; left time: 390.2696s
	iters: 900, epoch: 2 | loss: 0.4167257
	speed: 0.0534s/iter; left time: 385.5856s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.4604631 Vali Loss: 0.1654439 Test Loss: 0.1855372
Validation loss decreased (0.316566 --> 0.165444).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4327329
	speed: 0.1337s/iter; left time: 951.7605s
	iters: 200, epoch: 3 | loss: 0.3957958
	speed: 0.0533s/iter; left time: 373.7281s
	iters: 300, epoch: 3 | loss: 0.3918147
	speed: 0.0532s/iter; left time: 368.3101s
	iters: 400, epoch: 3 | loss: 0.3974347
	speed: 0.0531s/iter; left time: 362.0889s
	iters: 500, epoch: 3 | loss: 0.3861700
	speed: 0.0535s/iter; left time: 359.3677s
	iters: 600, epoch: 3 | loss: 0.4063203
	speed: 0.0534s/iter; left time: 353.2609s
	iters: 700, epoch: 3 | loss: 0.3755366
	speed: 0.0533s/iter; left time: 347.3661s
	iters: 800, epoch: 3 | loss: 0.4101175
	speed: 0.0534s/iter; left time: 342.5668s
	iters: 900, epoch: 3 | loss: 0.4065938
	speed: 0.0534s/iter; left time: 337.2392s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.35s
Steps: 902 | Train Loss: 0.3985641 Vali Loss: 0.1615396 Test Loss: 0.1741239
Validation loss decreased (0.165444 --> 0.161540).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3973604
	speed: 0.1328s/iter; left time: 825.4746s
	iters: 200, epoch: 4 | loss: 0.3811136
	speed: 0.0532s/iter; left time: 325.5959s
	iters: 300, epoch: 4 | loss: 0.3667543
	speed: 0.0532s/iter; left time: 320.0663s
	iters: 400, epoch: 4 | loss: 0.3984342
	speed: 0.0535s/iter; left time: 316.6181s
	iters: 500, epoch: 4 | loss: 0.3825527
	speed: 0.0536s/iter; left time: 311.6205s
	iters: 600, epoch: 4 | loss: 0.3598682
	speed: 0.0536s/iter; left time: 306.3476s
	iters: 700, epoch: 4 | loss: 0.3688106
	speed: 0.0533s/iter; left time: 299.5572s
	iters: 800, epoch: 4 | loss: 0.3855335
	speed: 0.0532s/iter; left time: 293.3586s
	iters: 900, epoch: 4 | loss: 0.3541565
	speed: 0.0529s/iter; left time: 286.2378s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.35s
Steps: 902 | Train Loss: 0.3764152 Vali Loss: 0.1675763 Test Loss: 0.1879234
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3548161
	speed: 0.1308s/iter; left time: 694.7941s
	iters: 200, epoch: 5 | loss: 0.3561797
	speed: 0.0534s/iter; left time: 278.5239s
	iters: 300, epoch: 5 | loss: 0.3693134
	speed: 0.0534s/iter; left time: 272.9339s
	iters: 400, epoch: 5 | loss: 0.3632230
	speed: 0.0535s/iter; left time: 268.0663s
	iters: 500, epoch: 5 | loss: 0.3501744
	speed: 0.0537s/iter; left time: 263.5916s
	iters: 600, epoch: 5 | loss: 0.3605365
	speed: 0.0535s/iter; left time: 257.2844s
	iters: 700, epoch: 5 | loss: 0.3378835
	speed: 0.0534s/iter; left time: 251.4644s
	iters: 800, epoch: 5 | loss: 0.3507200
	speed: 0.0536s/iter; left time: 247.2318s
	iters: 900, epoch: 5 | loss: 0.3309479
	speed: 0.0534s/iter; left time: 241.0231s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.54s
Steps: 902 | Train Loss: 0.3533288 Vali Loss: 0.1728445 Test Loss: 0.1920822
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3452060
	speed: 0.1312s/iter; left time: 578.5930s
	iters: 200, epoch: 6 | loss: 0.3228913
	speed: 0.0533s/iter; left time: 229.9566s
	iters: 300, epoch: 6 | loss: 0.3375479
	speed: 0.0532s/iter; left time: 224.2315s
	iters: 400, epoch: 6 | loss: 0.3367357
	speed: 0.0532s/iter; left time: 218.7645s
	iters: 500, epoch: 6 | loss: 0.3427296
	speed: 0.0534s/iter; left time: 214.1138s
	iters: 600, epoch: 6 | loss: 0.3427576
	speed: 0.0532s/iter; left time: 207.9529s
	iters: 700, epoch: 6 | loss: 0.3230248
	speed: 0.0533s/iter; left time: 202.9748s
	iters: 800, epoch: 6 | loss: 0.3116249
	speed: 0.0532s/iter; left time: 197.5769s
	iters: 900, epoch: 6 | loss: 0.3034044
	speed: 0.0533s/iter; left time: 192.6413s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.28s
Steps: 902 | Train Loss: 0.3296081 Vali Loss: 0.1894973 Test Loss: 0.2087091
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.1740160584449768, rmse:0.4171523153781891, mae:0.2821454405784607, rse:0.5255328416824341
Original data scale mse:3916505.5, rmse:1979.0162353515625, mae:1351.43994140625, rse:0.13940225541591644

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.1943083256483078, RMSE: 0.4408041834831238, MAE: 0.29183581471443176, RSE: 0.5553297400474548
Unscaled Metrics - MSE: 4601502.0, RMSE: 2145.111083984375, MAE: 1414.7354736328125, RSE: 0.1511019915342331

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.1740160584449768, RMSE: 0.4171523153781891, MAE: 0.2821454405784607, RSE: 0.5255328416824341
Unscaled Metrics - MSE: 3916505.5, RMSE: 1979.0162353515625, MAE: 1351.43994140625, RSE: 0.13940225541591644

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.5457722
	speed: 0.0744s/iter; left time: 666.8877s
	iters: 200, epoch: 1 | loss: 0.4619505
	speed: 0.0447s/iter; left time: 395.7536s
	iters: 300, epoch: 1 | loss: 0.3818028
	speed: 0.0363s/iter; left time: 318.3249s
	iters: 400, epoch: 1 | loss: 0.3662461
	speed: 0.0380s/iter; left time: 329.2945s
	iters: 500, epoch: 1 | loss: 0.3121561
	speed: 0.0448s/iter; left time: 383.4400s
	iters: 600, epoch: 1 | loss: 0.3036166
	speed: 0.0449s/iter; left time: 380.0047s
	iters: 700, epoch: 1 | loss: 0.2796393
	speed: 0.0446s/iter; left time: 373.1687s
	iters: 800, epoch: 1 | loss: 0.2928684
	speed: 0.0448s/iter; left time: 369.8095s
	iters: 900, epoch: 1 | loss: 0.3108425
	speed: 0.0443s/iter; left time: 361.6804s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.66s
Steps: 906 | Train Loss: 0.3805347 Vali Loss: 0.2673029 Test Loss: 0.2819944
Validation loss decreased (inf --> 0.267303).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2744780
	speed: 0.0986s/iter; left time: 794.4252s
	iters: 200, epoch: 2 | loss: 0.2373412
	speed: 0.0408s/iter; left time: 324.4975s
	iters: 300, epoch: 2 | loss: 0.2131426
	speed: 0.0407s/iter; left time: 319.8872s
	iters: 400, epoch: 2 | loss: 0.1916635
	speed: 0.0409s/iter; left time: 316.8684s
	iters: 500, epoch: 2 | loss: 0.2201029
	speed: 0.0408s/iter; left time: 312.1310s
	iters: 600, epoch: 2 | loss: 0.2060806
	speed: 0.0406s/iter; left time: 306.8481s
	iters: 700, epoch: 2 | loss: 0.1968652
	speed: 0.0413s/iter; left time: 307.7042s
	iters: 800, epoch: 2 | loss: 0.1945976
	speed: 0.0408s/iter; left time: 300.0182s
	iters: 900, epoch: 2 | loss: 0.2025563
	speed: 0.0410s/iter; left time: 297.7726s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.27s
Steps: 906 | Train Loss: 0.2138651 Vali Loss: 0.1810661 Test Loss: 0.1998956
Validation loss decreased (0.267303 --> 0.181066).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1849810
	speed: 0.0985s/iter; left time: 703.8968s
	iters: 200, epoch: 3 | loss: 0.1683050
	speed: 0.0408s/iter; left time: 287.5415s
	iters: 300, epoch: 3 | loss: 0.1933122
	speed: 0.0412s/iter; left time: 286.5381s
	iters: 400, epoch: 3 | loss: 0.1747953
	speed: 0.0413s/iter; left time: 282.6948s
	iters: 500, epoch: 3 | loss: 0.1968665
	speed: 0.0410s/iter; left time: 277.0382s
	iters: 600, epoch: 3 | loss: 0.1883342
	speed: 0.0415s/iter; left time: 276.2210s
	iters: 700, epoch: 3 | loss: 0.1661317
	speed: 0.0410s/iter; left time: 268.8148s
	iters: 800, epoch: 3 | loss: 0.1753330
	speed: 0.0413s/iter; left time: 266.6649s
	iters: 900, epoch: 3 | loss: 0.1612290
	speed: 0.0409s/iter; left time: 259.6948s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.58s
Steps: 906 | Train Loss: 0.1781615 Vali Loss: 0.1714392 Test Loss: 0.1930635
Validation loss decreased (0.181066 --> 0.171439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1667491
	speed: 0.0978s/iter; left time: 610.8551s
	iters: 200, epoch: 4 | loss: 0.1568225
	speed: 0.0401s/iter; left time: 246.6025s
	iters: 300, epoch: 4 | loss: 0.1570158
	speed: 0.0411s/iter; left time: 248.4502s
	iters: 400, epoch: 4 | loss: 0.1697214
	speed: 0.0412s/iter; left time: 245.1402s
	iters: 500, epoch: 4 | loss: 0.1468529
	speed: 0.0411s/iter; left time: 240.2270s
	iters: 600, epoch: 4 | loss: 0.2020216
	speed: 0.0410s/iter; left time: 235.4103s
	iters: 700, epoch: 4 | loss: 0.1758019
	speed: 0.0410s/iter; left time: 231.3828s
	iters: 800, epoch: 4 | loss: 0.1742330
	speed: 0.0409s/iter; left time: 226.6291s
	iters: 900, epoch: 4 | loss: 0.1855033
	speed: 0.0411s/iter; left time: 223.7715s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.39s
Steps: 906 | Train Loss: 0.1667347 Vali Loss: 0.1718393 Test Loss: 0.1885798
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1557937
	speed: 0.0949s/iter; left time: 506.3479s
	iters: 200, epoch: 5 | loss: 0.1380313
	speed: 0.0410s/iter; left time: 214.4671s
	iters: 300, epoch: 5 | loss: 0.1472689
	speed: 0.0406s/iter; left time: 208.7242s
	iters: 400, epoch: 5 | loss: 0.1500001
	speed: 0.0407s/iter; left time: 204.9495s
	iters: 500, epoch: 5 | loss: 0.1750159
	speed: 0.0406s/iter; left time: 200.4821s
	iters: 600, epoch: 5 | loss: 0.1361495
	speed: 0.0405s/iter; left time: 195.9850s
	iters: 700, epoch: 5 | loss: 0.1765044
	speed: 0.0409s/iter; left time: 193.6395s
	iters: 800, epoch: 5 | loss: 0.1426417
	speed: 0.0413s/iter; left time: 191.5054s
	iters: 900, epoch: 5 | loss: 0.1558857
	speed: 0.0414s/iter; left time: 187.7925s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.32s
Steps: 906 | Train Loss: 0.1589783 Vali Loss: 0.1625855 Test Loss: 0.1826195
Validation loss decreased (0.171439 --> 0.162585).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1450308
	speed: 0.0975s/iter; left time: 431.8505s
	iters: 200, epoch: 6 | loss: 0.1558551
	speed: 0.0407s/iter; left time: 176.4633s
	iters: 300, epoch: 6 | loss: 0.1792783
	speed: 0.0409s/iter; left time: 173.2156s
	iters: 400, epoch: 6 | loss: 0.1704415
	speed: 0.0409s/iter; left time: 169.0471s
	iters: 500, epoch: 6 | loss: 0.1573851
	speed: 0.0415s/iter; left time: 167.3075s
	iters: 600, epoch: 6 | loss: 0.1671356
	speed: 0.0409s/iter; left time: 160.7905s
	iters: 700, epoch: 6 | loss: 0.1638393
	speed: 0.0408s/iter; left time: 156.2579s
	iters: 800, epoch: 6 | loss: 0.1595617
	speed: 0.0327s/iter; left time: 122.1136s
	iters: 900, epoch: 6 | loss: 0.1701097
	speed: 0.0283s/iter; left time: 102.6949s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:35.16s
Steps: 906 | Train Loss: 0.1515545 Vali Loss: 0.1674609 Test Loss: 0.1899537
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1610046
	speed: 0.0955s/iter; left time: 336.5264s
	iters: 200, epoch: 7 | loss: 0.1198155
	speed: 0.0409s/iter; left time: 139.9861s
	iters: 300, epoch: 7 | loss: 0.1407748
	speed: 0.0414s/iter; left time: 137.5900s
	iters: 400, epoch: 7 | loss: 0.1454923
	speed: 0.0412s/iter; left time: 132.7282s
	iters: 500, epoch: 7 | loss: 0.1364675
	speed: 0.0411s/iter; left time: 128.5014s
	iters: 600, epoch: 7 | loss: 0.1231406
	speed: 0.0411s/iter; left time: 124.3791s
	iters: 700, epoch: 7 | loss: 0.1398096
	speed: 0.0413s/iter; left time: 120.7101s
	iters: 800, epoch: 7 | loss: 0.1630591
	speed: 0.0412s/iter; left time: 116.3141s
	iters: 900, epoch: 7 | loss: 0.1463931
	speed: 0.0411s/iter; left time: 112.0641s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.64s
Steps: 906 | Train Loss: 0.1454282 Vali Loss: 0.1638277 Test Loss: 0.1816822
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1371342
	speed: 0.0982s/iter; left time: 257.0689s
	iters: 200, epoch: 8 | loss: 0.1308029
	speed: 0.0406s/iter; left time: 102.3947s
	iters: 300, epoch: 8 | loss: 0.1505614
	speed: 0.0409s/iter; left time: 98.9800s
	iters: 400, epoch: 8 | loss: 0.1294539
	speed: 0.0413s/iter; left time: 95.7732s
	iters: 500, epoch: 8 | loss: 0.1530150
	speed: 0.0408s/iter; left time: 90.5320s
	iters: 600, epoch: 8 | loss: 0.1423034
	speed: 0.0413s/iter; left time: 87.5004s
	iters: 700, epoch: 8 | loss: 0.1252410
	speed: 0.0408s/iter; left time: 82.3644s
	iters: 800, epoch: 8 | loss: 0.1201913
	speed: 0.0411s/iter; left time: 78.9379s
	iters: 900, epoch: 8 | loss: 0.1563341
	speed: 0.0407s/iter; left time: 74.1012s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.42s
Steps: 906 | Train Loss: 0.1401851 Vali Loss: 0.1655675 Test Loss: 0.1868510
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.09913782775402069, rmse:0.31486159563064575, mae:0.1829637587070465, rse:0.3975760042667389
Original data scale mse:1536245.125, rmse:1239.45361328125, mae:781.243896484375, rse:0.08709932863712311
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4776601
	speed: 0.0461s/iter; left time: 412.8404s
	iters: 200, epoch: 1 | loss: 0.4439813
	speed: 0.0434s/iter; left time: 384.2912s
	iters: 300, epoch: 1 | loss: 0.3909110
	speed: 0.0409s/iter; left time: 357.9452s
	iters: 400, epoch: 1 | loss: 0.3461046
	speed: 0.0413s/iter; left time: 357.8975s
	iters: 500, epoch: 1 | loss: 0.3320941
	speed: 0.0413s/iter; left time: 353.9767s
	iters: 600, epoch: 1 | loss: 0.2909390
	speed: 0.0412s/iter; left time: 348.3473s
	iters: 700, epoch: 1 | loss: 0.2996924
	speed: 0.0442s/iter; left time: 369.5877s
	iters: 800, epoch: 1 | loss: 0.2653154
	speed: 0.0450s/iter; left time: 371.7347s
	iters: 900, epoch: 1 | loss: 0.2755414
	speed: 0.0422s/iter; left time: 344.4898s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.89s
Steps: 906 | Train Loss: 0.3752849 Vali Loss: 0.2672270 Test Loss: 0.2840111
Validation loss decreased (inf --> 0.267227).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2506149
	speed: 0.0988s/iter; left time: 796.0010s
	iters: 200, epoch: 2 | loss: 0.2350883
	speed: 0.0415s/iter; left time: 330.3662s
	iters: 300, epoch: 2 | loss: 0.2358949
	speed: 0.0409s/iter; left time: 321.4743s
	iters: 400, epoch: 2 | loss: 0.1885822
	speed: 0.0409s/iter; left time: 316.8041s
	iters: 500, epoch: 2 | loss: 0.2010925
	speed: 0.0407s/iter; left time: 311.2328s
	iters: 600, epoch: 2 | loss: 0.1833385
	speed: 0.0407s/iter; left time: 307.1990s
	iters: 700, epoch: 2 | loss: 0.1935309
	speed: 0.0408s/iter; left time: 303.8843s
	iters: 800, epoch: 2 | loss: 0.1903417
	speed: 0.0411s/iter; left time: 302.1274s
	iters: 900, epoch: 2 | loss: 0.1762984
	speed: 0.0412s/iter; left time: 299.0325s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.43s
Steps: 906 | Train Loss: 0.2146217 Vali Loss: 0.1833718 Test Loss: 0.2010264
Validation loss decreased (0.267227 --> 0.183372).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1991241
	speed: 0.1004s/iter; left time: 718.0332s
	iters: 200, epoch: 3 | loss: 0.1883680
	speed: 0.0407s/iter; left time: 286.5865s
	iters: 300, epoch: 3 | loss: 0.2205907
	speed: 0.0407s/iter; left time: 282.9394s
	iters: 400, epoch: 3 | loss: 0.1706741
	speed: 0.0409s/iter; left time: 280.1142s
	iters: 500, epoch: 3 | loss: 0.1849377
	speed: 0.0409s/iter; left time: 276.2070s
	iters: 600, epoch: 3 | loss: 0.1509293
	speed: 0.0410s/iter; left time: 272.8778s
	iters: 700, epoch: 3 | loss: 0.1512517
	speed: 0.0408s/iter; left time: 267.4778s
	iters: 800, epoch: 3 | loss: 0.1526526
	speed: 0.0418s/iter; left time: 269.7099s
	iters: 900, epoch: 3 | loss: 0.1587323
	speed: 0.0411s/iter; left time: 260.7721s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.43s
Steps: 906 | Train Loss: 0.1776619 Vali Loss: 0.1771492 Test Loss: 0.1885832
Validation loss decreased (0.183372 --> 0.177149).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1701278
	speed: 0.0984s/iter; left time: 614.3843s
	iters: 200, epoch: 4 | loss: 0.2015077
	speed: 0.0421s/iter; left time: 258.6759s
	iters: 300, epoch: 4 | loss: 0.1763208
	speed: 0.0413s/iter; left time: 249.6956s
	iters: 400, epoch: 4 | loss: 0.1486210
	speed: 0.0414s/iter; left time: 246.0193s
	iters: 500, epoch: 4 | loss: 0.1765108
	speed: 0.0412s/iter; left time: 240.6579s
	iters: 600, epoch: 4 | loss: 0.1562960
	speed: 0.0414s/iter; left time: 237.9090s
	iters: 700, epoch: 4 | loss: 0.1685656
	speed: 0.0414s/iter; left time: 233.7903s
	iters: 800, epoch: 4 | loss: 0.1544240
	speed: 0.0413s/iter; left time: 228.7849s
	iters: 900, epoch: 4 | loss: 0.1616580
	speed: 0.0409s/iter; left time: 222.8746s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.78s
Steps: 906 | Train Loss: 0.1661116 Vali Loss: 0.1647085 Test Loss: 0.1840274
Validation loss decreased (0.177149 --> 0.164708).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1714782
	speed: 0.0981s/iter; left time: 523.6351s
	iters: 200, epoch: 5 | loss: 0.1369216
	speed: 0.0415s/iter; left time: 217.4533s
	iters: 300, epoch: 5 | loss: 0.1575394
	speed: 0.0412s/iter; left time: 211.8560s
	iters: 400, epoch: 5 | loss: 0.1656790
	speed: 0.0414s/iter; left time: 208.6095s
	iters: 500, epoch: 5 | loss: 0.1608222
	speed: 0.0422s/iter; left time: 208.0950s
	iters: 600, epoch: 5 | loss: 0.1554044
	speed: 0.0410s/iter; left time: 198.5533s
	iters: 700, epoch: 5 | loss: 0.1500034
	speed: 0.0411s/iter; left time: 194.9225s
	iters: 800, epoch: 5 | loss: 0.1416839
	speed: 0.0413s/iter; left time: 191.4694s
	iters: 900, epoch: 5 | loss: 0.1522401
	speed: 0.0413s/iter; left time: 187.2200s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.76s
Steps: 906 | Train Loss: 0.1595445 Vali Loss: 0.1665687 Test Loss: 0.1847638
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1443708
	speed: 0.0948s/iter; left time: 420.0415s
	iters: 200, epoch: 6 | loss: 0.1567374
	speed: 0.0416s/iter; left time: 180.2060s
	iters: 300, epoch: 6 | loss: 0.1493996
	speed: 0.0412s/iter; left time: 174.3654s
	iters: 400, epoch: 6 | loss: 0.1430849
	speed: 0.0413s/iter; left time: 170.7233s
	iters: 500, epoch: 6 | loss: 0.1443629
	speed: 0.0412s/iter; left time: 166.0309s
	iters: 600, epoch: 6 | loss: 0.1465211
	speed: 0.0409s/iter; left time: 160.9508s
	iters: 700, epoch: 6 | loss: 0.1611205
	speed: 0.0410s/iter; left time: 157.0484s
	iters: 800, epoch: 6 | loss: 0.1412749
	speed: 0.0405s/iter; left time: 151.1371s
	iters: 900, epoch: 6 | loss: 0.1253723
	speed: 0.0409s/iter; left time: 148.5076s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.46s
Steps: 906 | Train Loss: 0.1522222 Vali Loss: 0.1653213 Test Loss: 0.1843068
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1479426
	speed: 0.0951s/iter; left time: 335.3703s
	iters: 200, epoch: 7 | loss: 0.1245969
	speed: 0.0415s/iter; left time: 142.1496s
	iters: 300, epoch: 7 | loss: 0.1496309
	speed: 0.0416s/iter; left time: 138.4134s
	iters: 400, epoch: 7 | loss: 0.1311834
	speed: 0.0418s/iter; left time: 134.6999s
	iters: 500, epoch: 7 | loss: 0.1564162
	speed: 0.0416s/iter; left time: 129.9491s
	iters: 600, epoch: 7 | loss: 0.1434652
	speed: 0.0412s/iter; left time: 124.7116s
	iters: 700, epoch: 7 | loss: 0.1580399
	speed: 0.0415s/iter; left time: 121.3790s
	iters: 800, epoch: 7 | loss: 0.1317641
	speed: 0.0410s/iter; left time: 115.9327s
	iters: 900, epoch: 7 | loss: 0.1625302
	speed: 0.0413s/iter; left time: 112.4334s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.77s
Steps: 906 | Train Loss: 0.1465913 Vali Loss: 0.1644109 Test Loss: 0.1782902
Validation loss decreased (0.164708 --> 0.164411).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1670306
	speed: 0.0976s/iter; left time: 255.6239s
	iters: 200, epoch: 8 | loss: 0.1477174
	speed: 0.0406s/iter; left time: 102.3562s
	iters: 300, epoch: 8 | loss: 0.1230330
	speed: 0.0409s/iter; left time: 98.9534s
	iters: 400, epoch: 8 | loss: 0.1492897
	speed: 0.0407s/iter; left time: 94.3518s
	iters: 500, epoch: 8 | loss: 0.1254149
	speed: 0.0406s/iter; left time: 90.1382s
	iters: 600, epoch: 8 | loss: 0.1357246
	speed: 0.0413s/iter; left time: 87.5731s
	iters: 700, epoch: 8 | loss: 0.1226515
	speed: 0.0410s/iter; left time: 82.8609s
	iters: 800, epoch: 8 | loss: 0.1265222
	speed: 0.0408s/iter; left time: 78.2217s
	iters: 900, epoch: 8 | loss: 0.1466777
	speed: 0.0411s/iter; left time: 74.7114s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.29s
Steps: 906 | Train Loss: 0.1410861 Vali Loss: 0.1640912 Test Loss: 0.1874596
Validation loss decreased (0.164411 --> 0.164091).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1428328
	speed: 0.0984s/iter; left time: 168.4962s
	iters: 200, epoch: 9 | loss: 0.1480935
	speed: 0.0408s/iter; left time: 65.8877s
	iters: 300, epoch: 9 | loss: 0.1487220
	speed: 0.0409s/iter; left time: 61.8406s
	iters: 400, epoch: 9 | loss: 0.1373631
	speed: 0.0402s/iter; left time: 56.8076s
	iters: 500, epoch: 9 | loss: 0.1378880
	speed: 0.0408s/iter; left time: 53.5502s
	iters: 600, epoch: 9 | loss: 0.1345500
	speed: 0.0407s/iter; left time: 49.3720s
	iters: 700, epoch: 9 | loss: 0.1397694
	speed: 0.0408s/iter; left time: 45.4425s
	iters: 800, epoch: 9 | loss: 0.1351453
	speed: 0.0408s/iter; left time: 41.3072s
	iters: 900, epoch: 9 | loss: 0.1375480
	speed: 0.0408s/iter; left time: 37.2337s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.23s
Steps: 906 | Train Loss: 0.1350569 Vali Loss: 0.1672038 Test Loss: 0.1815512
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.1340280
	speed: 0.0949s/iter; left time: 76.6006s
	iters: 200, epoch: 10 | loss: 0.1237886
	speed: 0.0409s/iter; left time: 28.9508s
	iters: 300, epoch: 10 | loss: 0.1060987
	speed: 0.0411s/iter; left time: 24.9558s
	iters: 400, epoch: 10 | loss: 0.1337412
	speed: 0.0409s/iter; left time: 20.7277s
	iters: 500, epoch: 10 | loss: 0.1200562
	speed: 0.0408s/iter; left time: 16.5927s
	iters: 600, epoch: 10 | loss: 0.1317466
	speed: 0.0412s/iter; left time: 12.6409s
	iters: 700, epoch: 10 | loss: 0.1188810
	speed: 0.0407s/iter; left time: 8.4306s
	iters: 800, epoch: 10 | loss: 0.1366085
	speed: 0.0409s/iter; left time: 4.3756s
	iters: 900, epoch: 10 | loss: 0.1230256
	speed: 0.0407s/iter; left time: 0.2848s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:37.31s
Steps: 906 | Train Loss: 0.1295959 Vali Loss: 0.1670163 Test Loss: 0.1832003
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.782969000000001e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.10783817619085312, rmse:0.32838723063468933, mae:0.18776381015777588, rse:0.41465485095977783
Original data scale mse:1982624.5, rmse:1408.0570068359375, mae:824.5411376953125, rse:0.09894748777151108

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.09913782775402069, RMSE: 0.31486159563064575, MAE: 0.1829637587070465, RSE: 0.3975760042667389
Unscaled Metrics - MSE: 1536245.125, RMSE: 1239.45361328125, MAE: 781.243896484375, RSE: 0.08709932863712311

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.10783817619085312, RMSE: 0.32838723063468933, MAE: 0.18776381015777588, RSE: 0.41465485095977783
Unscaled Metrics - MSE: 1982624.5, RMSE: 1408.0570068359375, MAE: 824.5411376953125, RSE: 0.09894748777151108

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5609224
	speed: 0.0807s/iter; left time: 721.8443s
	iters: 200, epoch: 1 | loss: 0.5243334
	speed: 0.0499s/iter; left time: 441.0276s
	iters: 300, epoch: 1 | loss: 0.4619636
	speed: 0.0486s/iter; left time: 424.9568s
	iters: 400, epoch: 1 | loss: 0.4469604
	speed: 0.0472s/iter; left time: 408.0894s
	iters: 500, epoch: 1 | loss: 0.4346926
	speed: 0.0473s/iter; left time: 403.6345s
	iters: 600, epoch: 1 | loss: 0.4109475
	speed: 0.0471s/iter; left time: 397.6922s
	iters: 700, epoch: 1 | loss: 0.4042616
	speed: 0.0471s/iter; left time: 392.4713s
	iters: 800, epoch: 1 | loss: 0.3887668
	speed: 0.0489s/iter; left time: 403.2261s
	iters: 900, epoch: 1 | loss: 0.3973931
	speed: 0.0481s/iter; left time: 391.3313s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.33s
Steps: 904 | Train Loss: 0.4573110 Vali Loss: 0.3704648 Test Loss: 0.4015980
Validation loss decreased (inf --> 0.370465).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3526562
	speed: 0.1174s/iter; left time: 943.8853s
	iters: 200, epoch: 2 | loss: 0.3401772
	speed: 0.0472s/iter; left time: 374.4983s
	iters: 300, epoch: 2 | loss: 0.3025575
	speed: 0.0472s/iter; left time: 370.1550s
	iters: 400, epoch: 2 | loss: 0.2961200
	speed: 0.0471s/iter; left time: 364.0647s
	iters: 500, epoch: 2 | loss: 0.2845877
	speed: 0.0470s/iter; left time: 359.0534s
	iters: 600, epoch: 2 | loss: 0.2914656
	speed: 0.0473s/iter; left time: 356.7556s
	iters: 700, epoch: 2 | loss: 0.2735434
	speed: 0.0473s/iter; left time: 351.9857s
	iters: 800, epoch: 2 | loss: 0.2677212
	speed: 0.0471s/iter; left time: 345.7804s
	iters: 900, epoch: 2 | loss: 0.2493406
	speed: 0.0469s/iter; left time: 339.6551s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.87s
Steps: 904 | Train Loss: 0.3005623 Vali Loss: 0.2569939 Test Loss: 0.2728545
Validation loss decreased (0.370465 --> 0.256994).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2540559
	speed: 0.1152s/iter; left time: 822.0176s
	iters: 200, epoch: 3 | loss: 0.2587475
	speed: 0.0470s/iter; left time: 330.6456s
	iters: 300, epoch: 3 | loss: 0.2666639
	speed: 0.0470s/iter; left time: 326.0529s
	iters: 400, epoch: 3 | loss: 0.2591120
	speed: 0.0470s/iter; left time: 321.0159s
	iters: 500, epoch: 3 | loss: 0.2382762
	speed: 0.0468s/iter; left time: 315.0162s
	iters: 600, epoch: 3 | loss: 0.2448051
	speed: 0.0464s/iter; left time: 307.8453s
	iters: 700, epoch: 3 | loss: 0.2321104
	speed: 0.0471s/iter; left time: 307.7846s
	iters: 800, epoch: 3 | loss: 0.2661161
	speed: 0.0469s/iter; left time: 301.4209s
	iters: 900, epoch: 3 | loss: 0.2559404
	speed: 0.0468s/iter; left time: 296.6984s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.62s
Steps: 904 | Train Loss: 0.2469540 Vali Loss: 0.2406677 Test Loss: 0.2586666
Validation loss decreased (0.256994 --> 0.240668).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2228930
	speed: 0.1147s/iter; left time: 714.3309s
	iters: 200, epoch: 4 | loss: 0.2382651
	speed: 0.0469s/iter; left time: 287.4373s
	iters: 300, epoch: 4 | loss: 0.2213701
	speed: 0.0470s/iter; left time: 283.5119s
	iters: 400, epoch: 4 | loss: 0.2358070
	speed: 0.0467s/iter; left time: 277.0446s
	iters: 500, epoch: 4 | loss: 0.2334090
	speed: 0.0465s/iter; left time: 271.2478s
	iters: 600, epoch: 4 | loss: 0.2296933
	speed: 0.0469s/iter; left time: 268.5268s
	iters: 700, epoch: 4 | loss: 0.2192774
	speed: 0.0470s/iter; left time: 264.7494s
	iters: 800, epoch: 4 | loss: 0.2308961
	speed: 0.0470s/iter; left time: 260.0620s
	iters: 900, epoch: 4 | loss: 0.2068672
	speed: 0.0470s/iter; left time: 255.0662s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.62s
Steps: 904 | Train Loss: 0.2287963 Vali Loss: 0.2351468 Test Loss: 0.2627827
Validation loss decreased (0.240668 --> 0.235147).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1998413
	speed: 0.1158s/iter; left time: 616.8073s
	iters: 200, epoch: 5 | loss: 0.2193071
	speed: 0.0471s/iter; left time: 245.9561s
	iters: 300, epoch: 5 | loss: 0.2077117
	speed: 0.0473s/iter; left time: 242.6683s
	iters: 400, epoch: 5 | loss: 0.2434303
	speed: 0.0472s/iter; left time: 236.9354s
	iters: 500, epoch: 5 | loss: 0.2125362
	speed: 0.0472s/iter; left time: 232.3533s
	iters: 600, epoch: 5 | loss: 0.2191880
	speed: 0.0471s/iter; left time: 227.2594s
	iters: 700, epoch: 5 | loss: 0.2376513
	speed: 0.0476s/iter; left time: 224.7071s
	iters: 800, epoch: 5 | loss: 0.2253581
	speed: 0.0471s/iter; left time: 217.8281s
	iters: 900, epoch: 5 | loss: 0.1962350
	speed: 0.0472s/iter; left time: 213.5386s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.95s
Steps: 904 | Train Loss: 0.2154299 Vali Loss: 0.2394691 Test Loss: 0.2566609
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1866974
	speed: 0.1112s/iter; left time: 491.6012s
	iters: 200, epoch: 6 | loss: 0.2211927
	speed: 0.0469s/iter; left time: 202.8588s
	iters: 300, epoch: 6 | loss: 0.2087145
	speed: 0.0469s/iter; left time: 198.0450s
	iters: 400, epoch: 6 | loss: 0.2200092
	speed: 0.0468s/iter; left time: 193.0123s
	iters: 500, epoch: 6 | loss: 0.2026272
	speed: 0.0470s/iter; left time: 188.9387s
	iters: 600, epoch: 6 | loss: 0.2080359
	speed: 0.0471s/iter; left time: 184.6969s
	iters: 700, epoch: 6 | loss: 0.1720245
	speed: 0.0470s/iter; left time: 179.4810s
	iters: 800, epoch: 6 | loss: 0.2128961
	speed: 0.0468s/iter; left time: 174.2381s
	iters: 900, epoch: 6 | loss: 0.2041475
	speed: 0.0467s/iter; left time: 169.2741s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.60s
Steps: 904 | Train Loss: 0.2046925 Vali Loss: 0.2335692 Test Loss: 0.2630001
Validation loss decreased (0.235147 --> 0.233569).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1906876
	speed: 0.1167s/iter; left time: 410.2612s
	iters: 200, epoch: 7 | loss: 0.1760302
	speed: 0.0478s/iter; left time: 163.3774s
	iters: 300, epoch: 7 | loss: 0.1980612
	speed: 0.0484s/iter; left time: 160.6115s
	iters: 400, epoch: 7 | loss: 0.1917071
	speed: 0.0498s/iter; left time: 160.1522s
	iters: 500, epoch: 7 | loss: 0.1776822
	speed: 0.0498s/iter; left time: 155.3002s
	iters: 600, epoch: 7 | loss: 0.2179713
	speed: 0.0499s/iter; left time: 150.4242s
	iters: 700, epoch: 7 | loss: 0.1928537
	speed: 0.0502s/iter; left time: 146.5233s
	iters: 800, epoch: 7 | loss: 0.1681959
	speed: 0.0494s/iter; left time: 139.0894s
	iters: 900, epoch: 7 | loss: 0.1982576
	speed: 0.0460s/iter; left time: 125.0524s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:44.41s
Steps: 904 | Train Loss: 0.1930687 Vali Loss: 0.2379507 Test Loss: 0.2623207
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1884136
	speed: 0.1142s/iter; left time: 298.3624s
	iters: 200, epoch: 8 | loss: 0.1891558
	speed: 0.0460s/iter; left time: 115.5783s
	iters: 300, epoch: 8 | loss: 0.1987314
	speed: 0.0472s/iter; left time: 113.9516s
	iters: 400, epoch: 8 | loss: 0.1750718
	speed: 0.0471s/iter; left time: 108.9153s
	iters: 500, epoch: 8 | loss: 0.1834746
	speed: 0.0471s/iter; left time: 104.1451s
	iters: 600, epoch: 8 | loss: 0.1824766
	speed: 0.0472s/iter; left time: 99.7576s
	iters: 700, epoch: 8 | loss: 0.1741492
	speed: 0.0472s/iter; left time: 95.0208s
	iters: 800, epoch: 8 | loss: 0.1780686
	speed: 0.0465s/iter; left time: 89.0106s
	iters: 900, epoch: 8 | loss: 0.1818569
	speed: 0.0469s/iter; left time: 85.0450s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.63s
Steps: 904 | Train Loss: 0.1835456 Vali Loss: 0.2421833 Test Loss: 0.2674352
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1895448
	speed: 0.1133s/iter; left time: 193.6269s
	iters: 200, epoch: 9 | loss: 0.1986769
	speed: 0.0473s/iter; left time: 76.1230s
	iters: 300, epoch: 9 | loss: 0.1697396
	speed: 0.0470s/iter; left time: 70.8791s
	iters: 400, epoch: 9 | loss: 0.1702705
	speed: 0.0470s/iter; left time: 66.2886s
	iters: 500, epoch: 9 | loss: 0.1700645
	speed: 0.0469s/iter; left time: 61.4218s
	iters: 600, epoch: 9 | loss: 0.1629677
	speed: 0.0473s/iter; left time: 57.1464s
	iters: 700, epoch: 9 | loss: 0.1640444
	speed: 0.0469s/iter; left time: 51.9779s
	iters: 800, epoch: 9 | loss: 0.1654269
	speed: 0.0470s/iter; left time: 47.3798s
	iters: 900, epoch: 9 | loss: 0.1891501
	speed: 0.0475s/iter; left time: 43.1555s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:42.83s
Steps: 904 | Train Loss: 0.1746325 Vali Loss: 0.2436785 Test Loss: 0.2686452
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.19483530521392822, rmse:0.44140151143074036, mae:0.2628290355205536, rse:0.5566918849945068
Original data scale mse:3251107.5, rmse:1803.082763671875, mae:1161.2264404296875, rse:0.12689030170440674
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5408066
	speed: 0.0516s/iter; left time: 461.4843s
	iters: 200, epoch: 1 | loss: 0.4969047
	speed: 0.0498s/iter; left time: 440.2971s
	iters: 300, epoch: 1 | loss: 0.4587035
	speed: 0.0496s/iter; left time: 433.3118s
	iters: 400, epoch: 1 | loss: 0.4662279
	speed: 0.0497s/iter; left time: 429.2563s
	iters: 500, epoch: 1 | loss: 0.4190004
	speed: 0.0500s/iter; left time: 427.0476s
	iters: 600, epoch: 1 | loss: 0.4151782
	speed: 0.0500s/iter; left time: 421.6642s
	iters: 700, epoch: 1 | loss: 0.4062589
	speed: 0.0492s/iter; left time: 410.6811s
	iters: 800, epoch: 1 | loss: 0.3966270
	speed: 0.0467s/iter; left time: 385.0427s
	iters: 900, epoch: 1 | loss: 0.3835855
	speed: 0.0471s/iter; left time: 383.3067s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.63s
Steps: 904 | Train Loss: 0.4568406 Vali Loss: 0.3676046 Test Loss: 0.3981673
Validation loss decreased (inf --> 0.367605).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3467729
	speed: 0.1163s/iter; left time: 934.4207s
	iters: 200, epoch: 2 | loss: 0.3216526
	speed: 0.0473s/iter; left time: 375.1793s
	iters: 300, epoch: 2 | loss: 0.3120637
	speed: 0.0473s/iter; left time: 370.8043s
	iters: 400, epoch: 2 | loss: 0.2981583
	speed: 0.0475s/iter; left time: 367.3445s
	iters: 500, epoch: 2 | loss: 0.2839856
	speed: 0.0474s/iter; left time: 362.0329s
	iters: 600, epoch: 2 | loss: 0.2709781
	speed: 0.0469s/iter; left time: 353.7034s
	iters: 700, epoch: 2 | loss: 0.2700642
	speed: 0.0468s/iter; left time: 347.8630s
	iters: 800, epoch: 2 | loss: 0.2589352
	speed: 0.0466s/iter; left time: 341.6855s
	iters: 900, epoch: 2 | loss: 0.2295327
	speed: 0.0470s/iter; left time: 340.0469s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.77s
Steps: 904 | Train Loss: 0.2983323 Vali Loss: 0.2517128 Test Loss: 0.2744485
Validation loss decreased (0.367605 --> 0.251713).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2584858
	speed: 0.1169s/iter; left time: 833.8333s
	iters: 200, epoch: 3 | loss: 0.2443511
	speed: 0.0469s/iter; left time: 330.1567s
	iters: 300, epoch: 3 | loss: 0.2449764
	speed: 0.0471s/iter; left time: 326.2539s
	iters: 400, epoch: 3 | loss: 0.2443414
	speed: 0.0471s/iter; left time: 321.9918s
	iters: 500, epoch: 3 | loss: 0.2429548
	speed: 0.0471s/iter; left time: 317.1408s
	iters: 600, epoch: 3 | loss: 0.2538213
	speed: 0.0493s/iter; left time: 327.2300s
	iters: 700, epoch: 3 | loss: 0.2554872
	speed: 0.0504s/iter; left time: 329.3079s
	iters: 800, epoch: 3 | loss: 0.2518428
	speed: 0.0503s/iter; left time: 323.5352s
	iters: 900, epoch: 3 | loss: 0.2169301
	speed: 0.0501s/iter; left time: 317.3786s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:44.03s
Steps: 904 | Train Loss: 0.2459033 Vali Loss: 0.2346435 Test Loss: 0.2624269
Validation loss decreased (0.251713 --> 0.234643).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2383796
	speed: 0.1169s/iter; left time: 728.3092s
	iters: 200, epoch: 4 | loss: 0.2254887
	speed: 0.0470s/iter; left time: 287.8584s
	iters: 300, epoch: 4 | loss: 0.2504866
	speed: 0.0473s/iter; left time: 284.9244s
	iters: 400, epoch: 4 | loss: 0.2294751
	speed: 0.0471s/iter; left time: 279.0207s
	iters: 500, epoch: 4 | loss: 0.2393156
	speed: 0.0469s/iter; left time: 273.4581s
	iters: 600, epoch: 4 | loss: 0.2135119
	speed: 0.0469s/iter; left time: 268.8396s
	iters: 700, epoch: 4 | loss: 0.2433015
	speed: 0.0473s/iter; left time: 266.0163s
	iters: 800, epoch: 4 | loss: 0.2229665
	speed: 0.0471s/iter; left time: 260.2189s
	iters: 900, epoch: 4 | loss: 0.2053911
	speed: 0.0469s/iter; left time: 254.8192s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.88s
Steps: 904 | Train Loss: 0.2304690 Vali Loss: 0.2361450 Test Loss: 0.2645998
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2325177
	speed: 0.1149s/iter; left time: 611.8691s
	iters: 200, epoch: 5 | loss: 0.1985134
	speed: 0.0475s/iter; left time: 248.0737s
	iters: 300, epoch: 5 | loss: 0.2265277
	speed: 0.0474s/iter; left time: 242.9874s
	iters: 400, epoch: 5 | loss: 0.2089091
	speed: 0.0473s/iter; left time: 237.7510s
	iters: 500, epoch: 5 | loss: 0.2146145
	speed: 0.0471s/iter; left time: 231.8437s
	iters: 600, epoch: 5 | loss: 0.1989035
	speed: 0.0472s/iter; left time: 227.7578s
	iters: 700, epoch: 5 | loss: 0.1927797
	speed: 0.0487s/iter; left time: 230.1957s
	iters: 800, epoch: 5 | loss: 0.2129710
	speed: 0.0479s/iter; left time: 221.3371s
	iters: 900, epoch: 5 | loss: 0.2192665
	speed: 0.0472s/iter; left time: 213.3962s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.43s
Steps: 904 | Train Loss: 0.2171487 Vali Loss: 0.2318016 Test Loss: 0.2570986
Validation loss decreased (0.234643 --> 0.231802).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2084969
	speed: 0.1167s/iter; left time: 515.7562s
	iters: 200, epoch: 6 | loss: 0.1960920
	speed: 0.0474s/iter; left time: 204.6015s
	iters: 300, epoch: 6 | loss: 0.1975544
	speed: 0.0472s/iter; left time: 199.1091s
	iters: 400, epoch: 6 | loss: 0.2043416
	speed: 0.0466s/iter; left time: 192.0208s
	iters: 500, epoch: 6 | loss: 0.1878395
	speed: 0.0476s/iter; left time: 191.2629s
	iters: 600, epoch: 6 | loss: 0.1995321
	speed: 0.0472s/iter; left time: 184.8964s
	iters: 700, epoch: 6 | loss: 0.1923771
	speed: 0.0473s/iter; left time: 180.9114s
	iters: 800, epoch: 6 | loss: 0.1949241
	speed: 0.0471s/iter; left time: 175.2477s
	iters: 900, epoch: 6 | loss: 0.1903680
	speed: 0.0474s/iter; left time: 171.5970s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.91s
Steps: 904 | Train Loss: 0.2058508 Vali Loss: 0.2401966 Test Loss: 0.2729353
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2076644
	speed: 0.1128s/iter; left time: 396.8121s
	iters: 200, epoch: 7 | loss: 0.2082104
	speed: 0.0470s/iter; left time: 160.7667s
	iters: 300, epoch: 7 | loss: 0.1862247
	speed: 0.0471s/iter; left time: 156.1758s
	iters: 400, epoch: 7 | loss: 0.1918603
	speed: 0.0472s/iter; left time: 151.9866s
	iters: 500, epoch: 7 | loss: 0.2082264
	speed: 0.0472s/iter; left time: 147.0251s
	iters: 600, epoch: 7 | loss: 0.1977967
	speed: 0.0469s/iter; left time: 141.4618s
	iters: 700, epoch: 7 | loss: 0.1790795
	speed: 0.0470s/iter; left time: 137.0395s
	iters: 800, epoch: 7 | loss: 0.1721518
	speed: 0.0472s/iter; left time: 133.0916s
	iters: 900, epoch: 7 | loss: 0.1934605
	speed: 0.0469s/iter; left time: 127.3983s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.82s
Steps: 904 | Train Loss: 0.1956340 Vali Loss: 0.2346087 Test Loss: 0.2638255
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1697118
	speed: 0.1109s/iter; left time: 289.6941s
	iters: 200, epoch: 8 | loss: 0.1707996
	speed: 0.0417s/iter; left time: 104.7575s
	iters: 300, epoch: 8 | loss: 0.1900202
	speed: 0.0490s/iter; left time: 118.3149s
	iters: 400, epoch: 8 | loss: 0.1792226
	speed: 0.0493s/iter; left time: 114.0551s
	iters: 500, epoch: 8 | loss: 0.1682744
	speed: 0.0495s/iter; left time: 109.4872s
	iters: 600, epoch: 8 | loss: 0.1779657
	speed: 0.0460s/iter; left time: 97.1204s
	iters: 700, epoch: 8 | loss: 0.1766959
	speed: 0.0470s/iter; left time: 94.5642s
	iters: 800, epoch: 8 | loss: 0.1739851
	speed: 0.0435s/iter; left time: 83.1857s
	iters: 900, epoch: 8 | loss: 0.1696727
	speed: 0.0441s/iter; left time: 80.0369s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:41.93s
Steps: 904 | Train Loss: 0.1860251 Vali Loss: 0.2392129 Test Loss: 0.2659991
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.17835581302642822, rmse:0.42232194542884827, mae:0.25708287954330444, rse:0.5326288938522339
Original data scale mse:2883676.75, rmse:1698.13916015625, mae:1115.929931640625, rse:0.11950498819351196

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.19483530521392822, RMSE: 0.44140151143074036, MAE: 0.2628290355205536, RSE: 0.5566918849945068
Unscaled Metrics - MSE: 3251107.5, RMSE: 1803.082763671875, MAE: 1161.2264404296875, RSE: 0.12689030170440674

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.17835581302642822, RMSE: 0.42232194542884827, MAE: 0.25708287954330444, RSE: 0.5326288938522339
Unscaled Metrics - MSE: 2883676.75, RMSE: 1698.13916015625, MAE: 1115.929931640625, RSE: 0.11950498819351196

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5632496
	speed: 0.0830s/iter; left time: 740.7944s
	iters: 200, epoch: 1 | loss: 0.5157527
	speed: 0.0533s/iter; left time: 470.5417s
	iters: 300, epoch: 1 | loss: 0.5225931
	speed: 0.0530s/iter; left time: 462.4681s
	iters: 400, epoch: 1 | loss: 0.5064175
	speed: 0.0534s/iter; left time: 460.7277s
	iters: 500, epoch: 1 | loss: 0.4810719
	speed: 0.0534s/iter; left time: 455.0067s
	iters: 600, epoch: 1 | loss: 0.4809999
	speed: 0.0533s/iter; left time: 448.5249s
	iters: 700, epoch: 1 | loss: 0.4591694
	speed: 0.0532s/iter; left time: 442.8845s
	iters: 800, epoch: 1 | loss: 0.4808295
	speed: 0.0530s/iter; left time: 435.8347s
	iters: 900, epoch: 1 | loss: 0.4464947
	speed: 0.0532s/iter; left time: 431.9688s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.78s
Steps: 902 | Train Loss: 0.4963819 Vali Loss: 0.4380530 Test Loss: 0.4737262
Validation loss decreased (inf --> 0.438053).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4330719
	speed: 0.1220s/iter; left time: 978.1042s
	iters: 200, epoch: 2 | loss: 0.3893396
	speed: 0.0426s/iter; left time: 337.0944s
	iters: 300, epoch: 2 | loss: 0.3565597
	speed: 0.0425s/iter; left time: 332.3930s
	iters: 400, epoch: 2 | loss: 0.3294356
	speed: 0.0425s/iter; left time: 328.4396s
	iters: 500, epoch: 2 | loss: 0.3018270
	speed: 0.0426s/iter; left time: 324.2466s
	iters: 600, epoch: 2 | loss: 0.3169613
	speed: 0.0425s/iter; left time: 319.7372s
	iters: 700, epoch: 2 | loss: 0.2771275
	speed: 0.0426s/iter; left time: 315.6814s
	iters: 800, epoch: 2 | loss: 0.2816032
	speed: 0.0425s/iter; left time: 311.2600s
	iters: 900, epoch: 2 | loss: 0.2748971
	speed: 0.0425s/iter; left time: 307.0207s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.65s
Steps: 902 | Train Loss: 0.3392451 Vali Loss: 0.2828687 Test Loss: 0.3127548
Validation loss decreased (0.438053 --> 0.282869).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2557863
	speed: 0.1221s/iter; left time: 869.1969s
	iters: 200, epoch: 3 | loss: 0.2850989
	speed: 0.0426s/iter; left time: 298.7850s
	iters: 300, epoch: 3 | loss: 0.2787260
	speed: 0.0426s/iter; left time: 294.5779s
	iters: 400, epoch: 3 | loss: 0.2852941
	speed: 0.0426s/iter; left time: 290.3637s
	iters: 500, epoch: 3 | loss: 0.2793160
	speed: 0.0426s/iter; left time: 285.8982s
	iters: 600, epoch: 3 | loss: 0.2520508
	speed: 0.0426s/iter; left time: 281.7621s
	iters: 700, epoch: 3 | loss: 0.2584607
	speed: 0.0426s/iter; left time: 277.4774s
	iters: 800, epoch: 3 | loss: 0.2498769
	speed: 0.0426s/iter; left time: 273.3059s
	iters: 900, epoch: 3 | loss: 0.2536239
	speed: 0.0426s/iter; left time: 268.9810s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.67s
Steps: 902 | Train Loss: 0.2655078 Vali Loss: 0.2571282 Test Loss: 0.2876839
Validation loss decreased (0.282869 --> 0.257128).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2511209
	speed: 0.1313s/iter; left time: 816.2297s
	iters: 200, epoch: 4 | loss: 0.2478851
	speed: 0.0535s/iter; left time: 327.2596s
	iters: 300, epoch: 4 | loss: 0.2678837
	speed: 0.0532s/iter; left time: 320.0443s
	iters: 400, epoch: 4 | loss: 0.2342361
	speed: 0.0533s/iter; left time: 315.0167s
	iters: 500, epoch: 4 | loss: 0.2349243
	speed: 0.0532s/iter; left time: 309.6219s
	iters: 600, epoch: 4 | loss: 0.2358436
	speed: 0.0534s/iter; left time: 304.9643s
	iters: 700, epoch: 4 | loss: 0.2612453
	speed: 0.0533s/iter; left time: 299.5092s
	iters: 800, epoch: 4 | loss: 0.2574546
	speed: 0.0535s/iter; left time: 294.9436s
	iters: 900, epoch: 4 | loss: 0.2365944
	speed: 0.0533s/iter; left time: 288.4956s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.32s
Steps: 902 | Train Loss: 0.2442949 Vali Loss: 0.2538681 Test Loss: 0.2768912
Validation loss decreased (0.257128 --> 0.253868).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2193953
	speed: 0.1331s/iter; left time: 707.2679s
	iters: 200, epoch: 5 | loss: 0.2179842
	speed: 0.0534s/iter; left time: 278.2102s
	iters: 300, epoch: 5 | loss: 0.2360814
	speed: 0.0535s/iter; left time: 273.3457s
	iters: 400, epoch: 5 | loss: 0.2377615
	speed: 0.0530s/iter; left time: 265.9079s
	iters: 500, epoch: 5 | loss: 0.2363496
	speed: 0.0535s/iter; left time: 262.9627s
	iters: 600, epoch: 5 | loss: 0.2460192
	speed: 0.0533s/iter; left time: 256.4488s
	iters: 700, epoch: 5 | loss: 0.2457788
	speed: 0.0534s/iter; left time: 251.6651s
	iters: 800, epoch: 5 | loss: 0.2220787
	speed: 0.0536s/iter; left time: 247.4824s
	iters: 900, epoch: 5 | loss: 0.2101454
	speed: 0.0533s/iter; left time: 240.6346s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.38s
Steps: 902 | Train Loss: 0.2286190 Vali Loss: 0.2507990 Test Loss: 0.2743211
Validation loss decreased (0.253868 --> 0.250799).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2139448
	speed: 0.1337s/iter; left time: 589.6982s
	iters: 200, epoch: 6 | loss: 0.2156881
	speed: 0.0547s/iter; left time: 235.8534s
	iters: 300, epoch: 6 | loss: 0.1959274
	speed: 0.0531s/iter; left time: 223.6519s
	iters: 400, epoch: 6 | loss: 0.2159407
	speed: 0.0534s/iter; left time: 219.4428s
	iters: 500, epoch: 6 | loss: 0.2154929
	speed: 0.0533s/iter; left time: 213.8546s
	iters: 600, epoch: 6 | loss: 0.2082460
	speed: 0.0533s/iter; left time: 208.4073s
	iters: 700, epoch: 6 | loss: 0.2061070
	speed: 0.0532s/iter; left time: 202.8335s
	iters: 800, epoch: 6 | loss: 0.2044578
	speed: 0.0528s/iter; left time: 195.8487s
	iters: 900, epoch: 6 | loss: 0.2099167
	speed: 0.0532s/iter; left time: 192.2172s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.51s
Steps: 902 | Train Loss: 0.2151362 Vali Loss: 0.2525556 Test Loss: 0.2818373
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2145544
	speed: 0.1316s/iter; left time: 461.9511s
	iters: 200, epoch: 7 | loss: 0.2077160
	speed: 0.0531s/iter; left time: 181.1511s
	iters: 300, epoch: 7 | loss: 0.1872474
	speed: 0.0535s/iter; left time: 177.0622s
	iters: 400, epoch: 7 | loss: 0.2064607
	speed: 0.0532s/iter; left time: 170.7752s
	iters: 500, epoch: 7 | loss: 0.2029885
	speed: 0.0533s/iter; left time: 165.8356s
	iters: 600, epoch: 7 | loss: 0.2078575
	speed: 0.0534s/iter; left time: 160.5704s
	iters: 700, epoch: 7 | loss: 0.2009865
	speed: 0.0535s/iter; left time: 155.5503s
	iters: 800, epoch: 7 | loss: 0.1900662
	speed: 0.0535s/iter; left time: 150.2426s
	iters: 900, epoch: 7 | loss: 0.1870289
	speed: 0.0536s/iter; left time: 145.1170s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.43s
Steps: 902 | Train Loss: 0.2037051 Vali Loss: 0.2534152 Test Loss: 0.2857353
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1959792
	speed: 0.1307s/iter; left time: 340.6820s
	iters: 200, epoch: 8 | loss: 0.1916496
	speed: 0.0534s/iter; left time: 133.8008s
	iters: 300, epoch: 8 | loss: 0.2030609
	speed: 0.0535s/iter; left time: 128.7537s
	iters: 400, epoch: 8 | loss: 0.1842758
	speed: 0.0534s/iter; left time: 123.1915s
	iters: 500, epoch: 8 | loss: 0.2033385
	speed: 0.0538s/iter; left time: 118.6975s
	iters: 600, epoch: 8 | loss: 0.1765361
	speed: 0.0541s/iter; left time: 113.9100s
	iters: 700, epoch: 8 | loss: 0.1814290
	speed: 0.0534s/iter; left time: 107.1938s
	iters: 800, epoch: 8 | loss: 0.1856684
	speed: 0.0537s/iter; left time: 102.3870s
	iters: 900, epoch: 8 | loss: 0.1858994
	speed: 0.0536s/iter; left time: 96.8201s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.56s
Steps: 902 | Train Loss: 0.1918486 Vali Loss: 0.2561021 Test Loss: 0.2780934
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.1986117660999298, rmse:0.445658802986145, mae:0.2743431031703949, rse:0.5614455938339233
Original data scale mse:3670718.0, rmse:1915.9117431640625, mae:1241.1048583984375, rse:0.13495714962482452
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5457351
	speed: 0.0566s/iter; left time: 505.3249s
	iters: 200, epoch: 1 | loss: 0.5282264
	speed: 0.0546s/iter; left time: 481.6154s
	iters: 300, epoch: 1 | loss: 0.5236274
	speed: 0.0540s/iter; left time: 470.7641s
	iters: 400, epoch: 1 | loss: 0.4873364
	speed: 0.0532s/iter; left time: 458.7364s
	iters: 500, epoch: 1 | loss: 0.5103250
	speed: 0.0532s/iter; left time: 453.1004s
	iters: 600, epoch: 1 | loss: 0.4482754
	speed: 0.0537s/iter; left time: 452.2883s
	iters: 700, epoch: 1 | loss: 0.4625291
	speed: 0.0538s/iter; left time: 447.4308s
	iters: 800, epoch: 1 | loss: 0.4470968
	speed: 0.0533s/iter; left time: 438.2881s
	iters: 900, epoch: 1 | loss: 0.4476103
	speed: 0.0531s/iter; left time: 431.2845s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.74s
Steps: 902 | Train Loss: 0.4975166 Vali Loss: 0.4339187 Test Loss: 0.4721376
Validation loss decreased (inf --> 0.433919).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4327614
	speed: 0.1336s/iter; left time: 1071.3273s
	iters: 200, epoch: 2 | loss: 0.3745706
	speed: 0.0535s/iter; left time: 423.3517s
	iters: 300, epoch: 2 | loss: 0.3375767
	speed: 0.0535s/iter; left time: 418.0493s
	iters: 400, epoch: 2 | loss: 0.3305673
	speed: 0.0536s/iter; left time: 414.0333s
	iters: 500, epoch: 2 | loss: 0.2993053
	speed: 0.0535s/iter; left time: 407.4923s
	iters: 600, epoch: 2 | loss: 0.3125845
	speed: 0.0531s/iter; left time: 399.6328s
	iters: 700, epoch: 2 | loss: 0.2725176
	speed: 0.0533s/iter; left time: 395.4394s
	iters: 800, epoch: 2 | loss: 0.3078899
	speed: 0.0533s/iter; left time: 390.1788s
	iters: 900, epoch: 2 | loss: 0.3088821
	speed: 0.0536s/iter; left time: 387.0181s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.42s
Steps: 902 | Train Loss: 0.3349405 Vali Loss: 0.2755053 Test Loss: 0.2961000
Validation loss decreased (0.433919 --> 0.275505).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2862371
	speed: 0.1381s/iter; left time: 982.9267s
	iters: 200, epoch: 3 | loss: 0.2703195
	speed: 0.0543s/iter; left time: 380.9892s
	iters: 300, epoch: 3 | loss: 0.2668331
	speed: 0.0543s/iter; left time: 375.2759s
	iters: 400, epoch: 3 | loss: 0.2816649
	speed: 0.0538s/iter; left time: 366.9804s
	iters: 500, epoch: 3 | loss: 0.2603705
	speed: 0.0533s/iter; left time: 357.9738s
	iters: 600, epoch: 3 | loss: 0.2601631
	speed: 0.0534s/iter; left time: 353.3462s
	iters: 700, epoch: 3 | loss: 0.2542909
	speed: 0.0535s/iter; left time: 348.5974s
	iters: 800, epoch: 3 | loss: 0.2753270
	speed: 0.0526s/iter; left time: 337.7030s
	iters: 900, epoch: 3 | loss: 0.2467102
	speed: 0.0533s/iter; left time: 336.5134s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.70s
Steps: 902 | Train Loss: 0.2655737 Vali Loss: 0.2521651 Test Loss: 0.2810098
Validation loss decreased (0.275505 --> 0.252165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2506363
	speed: 0.1331s/iter; left time: 827.3443s
	iters: 200, epoch: 4 | loss: 0.2414227
	speed: 0.0532s/iter; left time: 325.5158s
	iters: 300, epoch: 4 | loss: 0.2542776
	speed: 0.0533s/iter; left time: 320.6653s
	iters: 400, epoch: 4 | loss: 0.2567456
	speed: 0.0533s/iter; left time: 315.5052s
	iters: 500, epoch: 4 | loss: 0.2462144
	speed: 0.0532s/iter; left time: 309.6437s
	iters: 600, epoch: 4 | loss: 0.2383162
	speed: 0.0532s/iter; left time: 304.2010s
	iters: 700, epoch: 4 | loss: 0.2410191
	speed: 0.0535s/iter; left time: 300.5779s
	iters: 800, epoch: 4 | loss: 0.2308063
	speed: 0.0533s/iter; left time: 293.7284s
	iters: 900, epoch: 4 | loss: 0.2438544
	speed: 0.0537s/iter; left time: 290.9130s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.41s
Steps: 902 | Train Loss: 0.2451951 Vali Loss: 0.2500954 Test Loss: 0.2752612
Validation loss decreased (0.252165 --> 0.250095).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2437989
	speed: 0.1222s/iter; left time: 649.3465s
	iters: 200, epoch: 5 | loss: 0.2259947
	speed: 0.0426s/iter; left time: 221.9999s
	iters: 300, epoch: 5 | loss: 0.2319941
	speed: 0.0426s/iter; left time: 217.7861s
	iters: 400, epoch: 5 | loss: 0.2390596
	speed: 0.0426s/iter; left time: 213.3919s
	iters: 500, epoch: 5 | loss: 0.2380520
	speed: 0.0426s/iter; left time: 209.1694s
	iters: 600, epoch: 5 | loss: 0.2440550
	speed: 0.0426s/iter; left time: 204.8844s
	iters: 700, epoch: 5 | loss: 0.2459286
	speed: 0.0426s/iter; left time: 200.6821s
	iters: 800, epoch: 5 | loss: 0.2140070
	speed: 0.0426s/iter; left time: 196.4969s
	iters: 900, epoch: 5 | loss: 0.2049489
	speed: 0.0426s/iter; left time: 192.0431s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.67s
Steps: 902 | Train Loss: 0.2310374 Vali Loss: 0.2522435 Test Loss: 0.2711625
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2384680
	speed: 0.1290s/iter; left time: 569.0554s
	iters: 200, epoch: 6 | loss: 0.2129129
	speed: 0.0535s/iter; left time: 230.5736s
	iters: 300, epoch: 6 | loss: 0.2252229
	speed: 0.0533s/iter; left time: 224.3544s
	iters: 400, epoch: 6 | loss: 0.2482168
	speed: 0.0534s/iter; left time: 219.4611s
	iters: 500, epoch: 6 | loss: 0.2043865
	speed: 0.0533s/iter; left time: 213.9853s
	iters: 600, epoch: 6 | loss: 0.2184150
	speed: 0.0533s/iter; left time: 208.5547s
	iters: 700, epoch: 6 | loss: 0.2206749
	speed: 0.0539s/iter; left time: 205.3108s
	iters: 800, epoch: 6 | loss: 0.2014902
	speed: 0.0533s/iter; left time: 197.8232s
	iters: 900, epoch: 6 | loss: 0.1992556
	speed: 0.0532s/iter; left time: 192.1413s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.38s
Steps: 902 | Train Loss: 0.2182060 Vali Loss: 0.2485982 Test Loss: 0.2788172
Validation loss decreased (0.250095 --> 0.248598).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2268518
	speed: 0.1321s/iter; left time: 463.4375s
	iters: 200, epoch: 7 | loss: 0.1959685
	speed: 0.0529s/iter; left time: 180.2719s
	iters: 300, epoch: 7 | loss: 0.2199124
	speed: 0.0533s/iter; left time: 176.2295s
	iters: 400, epoch: 7 | loss: 0.2110029
	speed: 0.0532s/iter; left time: 170.8075s
	iters: 500, epoch: 7 | loss: 0.2112837
	speed: 0.0536s/iter; left time: 166.5283s
	iters: 600, epoch: 7 | loss: 0.2058442
	speed: 0.0535s/iter; left time: 160.9561s
	iters: 700, epoch: 7 | loss: 0.2065753
	speed: 0.0531s/iter; left time: 154.4960s
	iters: 800, epoch: 7 | loss: 0.1991162
	speed: 0.0532s/iter; left time: 149.5157s
	iters: 900, epoch: 7 | loss: 0.1958534
	speed: 0.0534s/iter; left time: 144.6848s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.29s
Steps: 902 | Train Loss: 0.2060740 Vali Loss: 0.2488902 Test Loss: 0.2776476
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1959849
	speed: 0.1291s/iter; left time: 336.6893s
	iters: 200, epoch: 8 | loss: 0.1851822
	speed: 0.0536s/iter; left time: 134.3725s
	iters: 300, epoch: 8 | loss: 0.1907590
	speed: 0.0534s/iter; left time: 128.5736s
	iters: 400, epoch: 8 | loss: 0.1977106
	speed: 0.0524s/iter; left time: 120.9297s
	iters: 500, epoch: 8 | loss: 0.2159291
	speed: 0.0533s/iter; left time: 117.6742s
	iters: 600, epoch: 8 | loss: 0.1979827
	speed: 0.0532s/iter; left time: 112.1569s
	iters: 700, epoch: 8 | loss: 0.2029708
	speed: 0.0534s/iter; left time: 107.2124s
	iters: 800, epoch: 8 | loss: 0.1968417
	speed: 0.0533s/iter; left time: 101.5509s
	iters: 900, epoch: 8 | loss: 0.2011698
	speed: 0.0531s/iter; left time: 95.9740s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.21s
Steps: 902 | Train Loss: 0.1949730 Vali Loss: 0.2532729 Test Loss: 0.2763503
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1993018
	speed: 0.1292s/iter; left time: 220.3438s
	iters: 200, epoch: 9 | loss: 0.1774716
	speed: 0.0531s/iter; left time: 85.1862s
	iters: 300, epoch: 9 | loss: 0.1944499
	speed: 0.0533s/iter; left time: 80.1721s
	iters: 400, epoch: 9 | loss: 0.2078677
	speed: 0.0534s/iter; left time: 75.0381s
	iters: 500, epoch: 9 | loss: 0.1839815
	speed: 0.0529s/iter; left time: 69.0919s
	iters: 600, epoch: 9 | loss: 0.1692742
	speed: 0.0532s/iter; left time: 64.0768s
	iters: 700, epoch: 9 | loss: 0.1779524
	speed: 0.0531s/iter; left time: 58.6744s
	iters: 800, epoch: 9 | loss: 0.1794150
	speed: 0.0533s/iter; left time: 53.5607s
	iters: 900, epoch: 9 | loss: 0.1874640
	speed: 0.0532s/iter; left time: 48.1241s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:48.19s
Steps: 902 | Train Loss: 0.1844025 Vali Loss: 0.2545887 Test Loss: 0.2794953
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.20644119381904602, rmse:0.4543580114841461, mae:0.27873149514198303, rse:0.5724049806594849
Original data scale mse:4193679.75, rmse:2047.8475341796875, mae:1284.98291015625, rse:0.14425072073936462

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.1986117660999298, RMSE: 0.445658802986145, MAE: 0.2743431031703949, RSE: 0.5614455938339233
Unscaled Metrics - MSE: 3670718.0, RMSE: 1915.9117431640625, MAE: 1241.1048583984375, RSE: 0.13495714962482452

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.20644119381904602, RMSE: 0.4543580114841461, MAE: 0.27873149514198303, RSE: 0.5724049806594849
Unscaled Metrics - MSE: 4193679.75, RMSE: 2047.8475341796875, MAE: 1284.98291015625, RSE: 0.14425072073936462
