
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0178860
	speed: 0.4434s/iter; left time: 3915.8177s
	iters: 200, epoch: 1 | loss: 0.0169326
	speed: 0.4254s/iter; left time: 3714.4942s
	iters: 300, epoch: 1 | loss: 0.0177864
	speed: 0.4276s/iter; left time: 3690.6313s
	iters: 400, epoch: 1 | loss: 0.0153700
	speed: 0.4290s/iter; left time: 3659.4418s
	iters: 500, epoch: 1 | loss: 0.0152166
	speed: 0.4289s/iter; left time: 3615.7466s
	iters: 600, epoch: 1 | loss: 0.0146014
	speed: 0.4282s/iter; left time: 3567.7378s
	iters: 700, epoch: 1 | loss: 0.0215663
	speed: 0.4284s/iter; left time: 3526.2290s
	iters: 800, epoch: 1 | loss: 0.0166149
	speed: 0.4278s/iter; left time: 3478.1148s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:06m:21.75s
Steps: 893 | Train Loss: 0.0171471 Vali Loss: 0.0219967 Test Loss: 0.0232732
Validation loss decreased (inf --> 0.021997).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0243180
	speed: 1.4188s/iter; left time: 11262.7187s
	iters: 200, epoch: 2 | loss: 0.0268429
	speed: 0.4282s/iter; left time: 3355.9003s
	iters: 300, epoch: 2 | loss: 0.0273141
	speed: 0.4277s/iter; left time: 3309.7694s
	iters: 400, epoch: 2 | loss: 0.0198984
	speed: 0.4284s/iter; left time: 3271.8898s
	iters: 500, epoch: 2 | loss: 0.0238225
	speed: 0.4280s/iter; left time: 3226.5117s
	iters: 600, epoch: 2 | loss: 0.0155228
	speed: 0.4285s/iter; left time: 3187.0978s
	iters: 700, epoch: 2 | loss: 0.0154257
	speed: 0.4284s/iter; left time: 3143.4436s
	iters: 800, epoch: 2 | loss: 0.0132572
	speed: 0.4282s/iter; left time: 3099.1570s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:06m:22.35s
Steps: 893 | Train Loss: 0.0218147 Vali Loss: 0.0244885 Test Loss: 0.0268524
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0145059
	speed: 1.4192s/iter; left time: 9998.3647s
	iters: 200, epoch: 3 | loss: 0.0141769
	speed: 0.4281s/iter; left time: 2973.1804s
	iters: 300, epoch: 3 | loss: 0.0208750
	speed: 0.4285s/iter; left time: 2932.9778s
	iters: 400, epoch: 3 | loss: 0.0146102
	speed: 0.4282s/iter; left time: 2888.0411s
	iters: 500, epoch: 3 | loss: 0.0178606
	speed: 0.4279s/iter; left time: 2843.0829s
	iters: 600, epoch: 3 | loss: 0.0249682
	speed: 0.4280s/iter; left time: 2800.9725s
	iters: 700, epoch: 3 | loss: 0.0209207
	speed: 0.4282s/iter; left time: 2759.7631s
	iters: 800, epoch: 3 | loss: 0.0444897
	speed: 0.4282s/iter; left time: 2716.6308s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:06m:22.34s
Steps: 893 | Train Loss: 0.0225802 Vali Loss: 0.0236040 Test Loss: 0.0261911
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0175259
	speed: 1.4188s/iter; left time: 8728.4710s
	iters: 200, epoch: 4 | loss: 0.0113677
	speed: 0.4281s/iter; left time: 2591.0384s
	iters: 300, epoch: 4 | loss: 0.0186958
	speed: 0.4283s/iter; left time: 2549.2732s
	iters: 400, epoch: 4 | loss: 0.0182057
	speed: 0.4282s/iter; left time: 2505.9721s
	iters: 500, epoch: 4 | loss: 0.0152340
	speed: 0.4285s/iter; left time: 2464.4906s
	iters: 600, epoch: 4 | loss: 0.0136931
	speed: 0.4283s/iter; left time: 2420.7310s
	iters: 700, epoch: 4 | loss: 0.0127485
	speed: 0.4284s/iter; left time: 2378.5524s
	iters: 800, epoch: 4 | loss: 0.0131599
	speed: 0.4282s/iter; left time: 2334.7102s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:06m:22.40s
Steps: 893 | Train Loss: 0.0159823 Vali Loss: 0.0214036 Test Loss: 0.0236595
Validation loss decreased (0.021997 --> 0.021404).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0124148
	speed: 1.4303s/iter; left time: 7522.0930s
	iters: 200, epoch: 5 | loss: 0.0156158
	speed: 0.4280s/iter; left time: 2207.8823s
	iters: 300, epoch: 5 | loss: 0.0117028
	speed: 0.4280s/iter; left time: 2165.4559s
	iters: 400, epoch: 5 | loss: 0.0145740
	speed: 0.4284s/iter; left time: 2124.5967s
	iters: 500, epoch: 5 | loss: 0.0199729
	speed: 0.4283s/iter; left time: 2081.0597s
	iters: 600, epoch: 5 | loss: 0.0147219
	speed: 0.4282s/iter; left time: 2037.7682s
	iters: 700, epoch: 5 | loss: 0.0156687
	speed: 0.4281s/iter; left time: 1994.6563s
	iters: 800, epoch: 5 | loss: 0.0203800
	speed: 0.4281s/iter; left time: 1951.5102s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:06m:22.34s
Steps: 893 | Train Loss: 0.0146515 Vali Loss: 0.0210099 Test Loss: 0.0236059
Validation loss decreased (0.021404 --> 0.021010).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0125323
	speed: 1.4227s/iter; left time: 6211.5507s
	iters: 200, epoch: 6 | loss: 0.0113746
	speed: 0.4283s/iter; left time: 1827.2356s
	iters: 300, epoch: 6 | loss: 0.0159533
	speed: 0.4282s/iter; left time: 1783.7677s
	iters: 400, epoch: 6 | loss: 0.0127291
	speed: 0.4282s/iter; left time: 1740.9605s
	iters: 500, epoch: 6 | loss: 0.0134739
	speed: 0.4280s/iter; left time: 1697.6407s
	iters: 600, epoch: 6 | loss: 0.0127388
	speed: 0.4280s/iter; left time: 1654.4819s
	iters: 700, epoch: 6 | loss: 0.0137653
	speed: 0.4284s/iter; left time: 1613.4003s
	iters: 800, epoch: 6 | loss: 0.0181432
	speed: 0.4284s/iter; left time: 1570.3734s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:06m:22.33s
Steps: 893 | Train Loss: 0.0139436 Vali Loss: 0.0208776 Test Loss: 0.0235940
Validation loss decreased (0.021010 --> 0.020878).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0151487
	speed: 1.4222s/iter; left time: 4939.2193s
	iters: 200, epoch: 7 | loss: 0.0127952
	speed: 0.4282s/iter; left time: 1444.1935s
	iters: 300, epoch: 7 | loss: 0.0144052
	speed: 0.4282s/iter; left time: 1401.3815s
	iters: 400, epoch: 7 | loss: 0.0236742
	speed: 0.4277s/iter; left time: 1357.2237s
	iters: 500, epoch: 7 | loss: 0.0195656
	speed: 0.4276s/iter; left time: 1314.0093s
	iters: 600, epoch: 7 | loss: 0.0161492
	speed: 0.4273s/iter; left time: 1270.2847s
	iters: 700, epoch: 7 | loss: 0.0151523
	speed: 0.4282s/iter; left time: 1230.1678s
	iters: 800, epoch: 7 | loss: 0.0507604
	speed: 0.4275s/iter; left time: 1185.5085s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:06m:22.02s
Steps: 893 | Train Loss: 0.0235456 Vali Loss: 0.0225810 Test Loss: 0.0251738
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0130106
	speed: 1.4173s/iter; left time: 3656.6384s
	iters: 200, epoch: 8 | loss: 0.0154134
	speed: 0.4278s/iter; left time: 1061.0462s
	iters: 300, epoch: 8 | loss: 0.0146791
	speed: 0.4276s/iter; left time: 1017.6405s
	iters: 400, epoch: 8 | loss: 0.0177554
	speed: 0.4279s/iter; left time: 975.6976s
	iters: 500, epoch: 8 | loss: 0.0132755
	speed: 0.4279s/iter; left time: 932.7475s
	iters: 600, epoch: 8 | loss: 0.0137135
	speed: 0.4281s/iter; left time: 890.5289s
	iters: 700, epoch: 8 | loss: 0.0145373
	speed: 0.4276s/iter; left time: 846.7283s
	iters: 800, epoch: 8 | loss: 0.0157890
	speed: 0.4279s/iter; left time: 804.4407s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:06m:21.99s
Steps: 893 | Train Loss: 0.0142003 Vali Loss: 0.0207319 Test Loss: 0.0232901
Validation loss decreased (0.020878 --> 0.020732).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0096708
	speed: 1.4267s/iter; left time: 2406.7800s
	iters: 200, epoch: 9 | loss: 0.0087747
	speed: 0.4275s/iter; left time: 678.5039s
	iters: 300, epoch: 9 | loss: 0.0116768
	speed: 0.4276s/iter; left time: 635.8493s
	iters: 400, epoch: 9 | loss: 0.0218671
	speed: 0.4281s/iter; left time: 593.7344s
	iters: 500, epoch: 9 | loss: 0.0133158
	speed: 0.4279s/iter; left time: 550.7484s
	iters: 600, epoch: 9 | loss: 0.0126080
	speed: 0.4277s/iter; left time: 507.7127s
	iters: 700, epoch: 9 | loss: 0.0241127
	speed: 0.4280s/iter; left time: 465.2435s
	iters: 800, epoch: 9 | loss: 0.0100901
	speed: 0.4276s/iter; left time: 422.0620s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:06m:22.01s
Steps: 893 | Train Loss: 0.0149611 Vali Loss: 0.0210497 Test Loss: 0.0237300
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0154547
	speed: 1.4166s/iter; left time: 1124.7439s
	iters: 200, epoch: 10 | loss: 0.0191808
	speed: 0.4281s/iter; left time: 297.0684s
	iters: 300, epoch: 10 | loss: 0.0164838
	speed: 0.4279s/iter; left time: 254.1842s
	iters: 400, epoch: 10 | loss: 0.0117427
	speed: 0.4276s/iter; left time: 211.2371s
	iters: 500, epoch: 10 | loss: 0.0121091
	speed: 0.4280s/iter; left time: 168.6182s
	iters: 600, epoch: 10 | loss: 0.0118478
	speed: 0.4283s/iter; left time: 125.9305s
	iters: 700, epoch: 10 | loss: 0.0180274
	speed: 0.4278s/iter; left time: 82.9934s
	iters: 800, epoch: 10 | loss: 0.0180528
	speed: 0.4282s/iter; left time: 40.2493s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:06m:22.17s
Steps: 893 | Train Loss: 0.0141204 Vali Loss: 0.0204878 Test Loss: 0.0232158
Validation loss decreased (0.020732 --> 0.020488).  Saving model ...
Updating learning rate to 4.782969000000001e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.023215798661112785, rmse:0.15236730873584747, mae:0.09755730628967285, rse:0.5380893349647522
Original data scale mse:19121818.0, rmse:4372.85009765625, mae:2694.030029296875, rse:0.21742692589759827
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0180778
	speed: 0.4266s/iter; left time: 3766.9053s
	iters: 200, epoch: 1 | loss: 0.0163322
	speed: 0.4266s/iter; left time: 3724.5365s
	iters: 300, epoch: 1 | loss: 0.0176314
	speed: 0.4274s/iter; left time: 3688.9209s
	iters: 400, epoch: 1 | loss: 0.0141984
	speed: 0.4270s/iter; left time: 3642.4855s
	iters: 500, epoch: 1 | loss: 0.0177176
	speed: 0.4271s/iter; left time: 3600.7512s
	iters: 600, epoch: 1 | loss: 0.0174672
	speed: 0.4273s/iter; left time: 3559.6145s
	iters: 700, epoch: 1 | loss: 0.0166501
	speed: 0.4268s/iter; left time: 3513.2715s
	iters: 800, epoch: 1 | loss: 0.0176461
	speed: 0.4273s/iter; left time: 3474.2641s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:06m:21.36s
Steps: 893 | Train Loss: 0.0170548 Vali Loss: 0.0218490 Test Loss: 0.0236651
Validation loss decreased (inf --> 0.021849).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0206407
	speed: 1.4216s/iter; left time: 11284.4107s
	iters: 200, epoch: 2 | loss: 0.0132826
	speed: 0.4278s/iter; left time: 3352.9100s
	iters: 300, epoch: 2 | loss: 0.0231198
	speed: 0.4271s/iter; left time: 3304.7482s
	iters: 400, epoch: 2 | loss: 0.0214154
	speed: 0.4279s/iter; left time: 3268.5271s
	iters: 500, epoch: 2 | loss: 0.0166591
	speed: 0.4276s/iter; left time: 3223.3902s
	iters: 600, epoch: 2 | loss: 0.0242910
	speed: 0.4273s/iter; left time: 3178.1454s
	iters: 700, epoch: 2 | loss: 0.0168519
	speed: 0.4276s/iter; left time: 3138.0261s
	iters: 800, epoch: 2 | loss: 0.0160146
	speed: 0.4274s/iter; left time: 3093.4395s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:06m:21.80s
Steps: 893 | Train Loss: 0.0219532 Vali Loss: 0.0256835 Test Loss: 0.0284416
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0148315
	speed: 1.4155s/iter; left time: 9971.9163s
	iters: 200, epoch: 3 | loss: 0.0176530
	speed: 0.4276s/iter; left time: 2969.5737s
	iters: 300, epoch: 3 | loss: 0.0169491
	speed: 0.4277s/iter; left time: 2927.4634s
	iters: 400, epoch: 3 | loss: 0.0864020
	speed: 0.4277s/iter; left time: 2885.0878s
	iters: 500, epoch: 3 | loss: 0.0602697
	speed: 0.4272s/iter; left time: 2839.0378s
	iters: 600, epoch: 3 | loss: 0.0156740
	speed: 0.4278s/iter; left time: 2800.2452s
	iters: 700, epoch: 3 | loss: 0.0184390
	speed: 0.4275s/iter; left time: 2755.1472s
	iters: 800, epoch: 3 | loss: 0.0169400
	speed: 0.4276s/iter; left time: 2713.2932s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:06m:21.83s
Steps: 893 | Train Loss: 0.0213608 Vali Loss: 0.0231353 Test Loss: 0.0245471
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0119369
	speed: 1.4146s/iter; left time: 8702.6874s
	iters: 200, epoch: 4 | loss: 0.0219901
	speed: 0.4271s/iter; left time: 2585.0033s
	iters: 300, epoch: 4 | loss: 0.0155143
	speed: 0.4274s/iter; left time: 2543.9529s
	iters: 400, epoch: 4 | loss: 0.0183572
	speed: 0.4277s/iter; left time: 2502.9318s
	iters: 500, epoch: 4 | loss: 0.0153375
	speed: 0.4275s/iter; left time: 2459.0461s
	iters: 600, epoch: 4 | loss: 0.0149584
	speed: 0.4277s/iter; left time: 2417.3312s
	iters: 700, epoch: 4 | loss: 0.0190068
	speed: 0.4273s/iter; left time: 2372.5866s
	iters: 800, epoch: 4 | loss: 0.0261481
	speed: 0.4274s/iter; left time: 2330.2745s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:06m:21.67s
Steps: 893 | Train Loss: 0.0203667 Vali Loss: 0.0313648 Test Loss: 0.0352401
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.023665064945816994, rmse:0.1538345366716385, mae:0.0999179482460022, rse:0.5432708263397217
Original data scale mse:19271696.0, rmse:4389.9541015625, mae:2777.172607421875, rse:0.21827736496925354

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.023215798661112785, RMSE: 0.15236730873584747, MAE: 0.09755730628967285, RSE: 0.5380893349647522
Unscaled Metrics - MSE: 19121818.0, RMSE: 4372.85009765625, MAE: 2694.030029296875, RSE: 0.21742692589759827

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.023665064945816994, RMSE: 0.1538345366716385, MAE: 0.0999179482460022, RSE: 0.5432708263397217
Unscaled Metrics - MSE: 19271696.0, RMSE: 4389.9541015625, MAE: 2777.172607421875, RSE: 0.21827736496925354

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=1, stride=1, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
Traceback (most recent call last):
  File "/vol/fob-vol3/nebenf24/riabchuv/my_work/./PatchTST-main/PatchTST_supervised/run_longExp.py", line 145, in <module>
    exp.train(setting)
  File "/vol/fob-vol3/nebenf24/riabchuv/my_work/PatchTST-main/PatchTST_supervised/exp/exp_main.py", line 177, in train
    outputs = self.model(batch_x)
              ^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/my_work/PatchTST-main/PatchTST_supervised/models/PatchTST.py", line 91, in forward
    x = self.model(x)
        ^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/my_work/PatchTST-main/PatchTST_supervised/layers/PatchTST_backbone.py", line 77, in forward
    z = self.head(z)                                                                    # z: [bs x nvars x target_window] 
        ^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/my_work/PatchTST-main/PatchTST_supervised/layers/PatchTST_backbone.py", line 127, in forward
    x = self.flatten(x)
        ^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/vol/fob-vol3/nebenf24/riabchuv/.conda/envs/val/lib/python3.11/site-packages/torch/nn/modules/flatten.py", line 49, in forward
    return input.flatten(self.start_dim, self.end_dim)
           ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'flatten'
