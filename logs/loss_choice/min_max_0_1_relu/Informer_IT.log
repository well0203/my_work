
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1015439
	speed: 0.1310s/iter; left time: 1173.7397s
	iters: 200, epoch: 1 | loss: 0.0780112
	speed: 0.0415s/iter; left time: 367.9963s
	iters: 300, epoch: 1 | loss: 0.0634276
	speed: 0.0448s/iter; left time: 392.8263s
	iters: 400, epoch: 1 | loss: 0.0499723
	speed: 0.0433s/iter; left time: 375.1178s
	iters: 500, epoch: 1 | loss: 0.0366096
	speed: 0.0404s/iter; left time: 346.2343s
	iters: 600, epoch: 1 | loss: 0.0305542
	speed: 0.0406s/iter; left time: 343.7792s
	iters: 700, epoch: 1 | loss: 0.0254408
	speed: 0.0405s/iter; left time: 338.9794s
	iters: 800, epoch: 1 | loss: 0.0277302
	speed: 0.0410s/iter; left time: 339.0201s
	iters: 900, epoch: 1 | loss: 0.0307077
	speed: 0.0406s/iter; left time: 331.0971s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.60s
Steps: 906 | Train Loss: 0.0542530 Vali Loss: 0.0167840 Test Loss: 0.0182139
Validation loss decreased (inf --> 0.016784).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0249653
	speed: 0.1038s/iter; left time: 835.7988s
	iters: 200, epoch: 2 | loss: 0.0205376
	speed: 0.0408s/iter; left time: 324.2999s
	iters: 300, epoch: 2 | loss: 0.0144465
	speed: 0.0418s/iter; left time: 328.1696s
	iters: 400, epoch: 2 | loss: 0.0110110
	speed: 0.0443s/iter; left time: 343.9046s
	iters: 500, epoch: 2 | loss: 0.0148877
	speed: 0.0449s/iter; left time: 343.9901s
	iters: 600, epoch: 2 | loss: 0.0146665
	speed: 0.0452s/iter; left time: 341.2740s
	iters: 700, epoch: 2 | loss: 0.0117732
	speed: 0.0456s/iter; left time: 340.0806s
	iters: 800, epoch: 2 | loss: 0.0135435
	speed: 0.0419s/iter; left time: 308.5073s
	iters: 900, epoch: 2 | loss: 0.0127468
	speed: 0.0439s/iter; left time: 318.6474s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.67s
Steps: 906 | Train Loss: 0.0155822 Vali Loss: 0.0117499 Test Loss: 0.0131114
Validation loss decreased (0.016784 --> 0.011750).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0114066
	speed: 0.1068s/iter; left time: 763.1871s
	iters: 200, epoch: 3 | loss: 0.0089474
	speed: 0.0411s/iter; left time: 289.5808s
	iters: 300, epoch: 3 | loss: 0.0102706
	speed: 0.0433s/iter; left time: 300.5452s
	iters: 400, epoch: 3 | loss: 0.0080307
	speed: 0.0414s/iter; left time: 283.3393s
	iters: 500, epoch: 3 | loss: 0.0117475
	speed: 0.0418s/iter; left time: 282.0641s
	iters: 600, epoch: 3 | loss: 0.0127674
	speed: 0.0408s/iter; left time: 271.2909s
	iters: 700, epoch: 3 | loss: 0.0085980
	speed: 0.0407s/iter; left time: 266.3854s
	iters: 800, epoch: 3 | loss: 0.0090622
	speed: 0.0418s/iter; left time: 269.8809s
	iters: 900, epoch: 3 | loss: 0.0092529
	speed: 0.0407s/iter; left time: 258.5249s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.93s
Steps: 906 | Train Loss: 0.0107991 Vali Loss: 0.0098243 Test Loss: 0.0119410
Validation loss decreased (0.011750 --> 0.009824).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0092516
	speed: 0.1028s/iter; left time: 641.7830s
	iters: 200, epoch: 4 | loss: 0.0081608
	speed: 0.0405s/iter; left time: 248.9594s
	iters: 300, epoch: 4 | loss: 0.0097082
	speed: 0.0414s/iter; left time: 250.0619s
	iters: 400, epoch: 4 | loss: 0.0108099
	speed: 0.0414s/iter; left time: 245.9300s
	iters: 500, epoch: 4 | loss: 0.0078915
	speed: 0.0418s/iter; left time: 244.3197s
	iters: 600, epoch: 4 | loss: 0.0114540
	speed: 0.0410s/iter; left time: 235.5187s
	iters: 700, epoch: 4 | loss: 0.0109546
	speed: 0.0454s/iter; left time: 255.9517s
	iters: 800, epoch: 4 | loss: 0.0103235
	speed: 0.0450s/iter; left time: 249.4279s
	iters: 900, epoch: 4 | loss: 0.0106262
	speed: 0.0447s/iter; left time: 243.2706s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.92s
Steps: 906 | Train Loss: 0.0093414 Vali Loss: 0.0090817 Test Loss: 0.0107185
Validation loss decreased (0.009824 --> 0.009082).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0079604
	speed: 0.1040s/iter; left time: 555.2854s
	iters: 200, epoch: 5 | loss: 0.0065428
	speed: 0.0449s/iter; left time: 235.1357s
	iters: 300, epoch: 5 | loss: 0.0076818
	speed: 0.0451s/iter; left time: 231.5861s
	iters: 400, epoch: 5 | loss: 0.0070810
	speed: 0.0450s/iter; left time: 226.8368s
	iters: 500, epoch: 5 | loss: 0.0086843
	speed: 0.0449s/iter; left time: 221.6744s
	iters: 600, epoch: 5 | loss: 0.0058556
	speed: 0.0447s/iter; left time: 216.1470s
	iters: 700, epoch: 5 | loss: 0.0103446
	speed: 0.0458s/iter; left time: 217.1356s
	iters: 800, epoch: 5 | loss: 0.0082625
	speed: 0.0437s/iter; left time: 202.8233s
	iters: 900, epoch: 5 | loss: 0.0090409
	speed: 0.0447s/iter; left time: 202.7508s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.85s
Steps: 906 | Train Loss: 0.0083556 Vali Loss: 0.0096571 Test Loss: 0.0109171
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0064203
	speed: 0.0997s/iter; left time: 441.5518s
	iters: 200, epoch: 6 | loss: 0.0072406
	speed: 0.0454s/iter; left time: 196.7311s
	iters: 300, epoch: 6 | loss: 0.0118000
	speed: 0.0449s/iter; left time: 189.9531s
	iters: 400, epoch: 6 | loss: 0.0090705
	speed: 0.0444s/iter; left time: 183.3947s
	iters: 500, epoch: 6 | loss: 0.0073423
	speed: 0.0450s/iter; left time: 181.4222s
	iters: 600, epoch: 6 | loss: 0.0087076
	speed: 0.0447s/iter; left time: 175.8631s
	iters: 700, epoch: 6 | loss: 0.0080332
	speed: 0.0455s/iter; left time: 174.3984s
	iters: 800, epoch: 6 | loss: 0.0068916
	speed: 0.0454s/iter; left time: 169.4103s
	iters: 900, epoch: 6 | loss: 0.0086625
	speed: 0.0447s/iter; left time: 162.3169s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:40.99s
Steps: 906 | Train Loss: 0.0077443 Vali Loss: 0.0101560 Test Loss: 0.0128229
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0068713
	speed: 0.0968s/iter; left time: 341.1281s
	iters: 200, epoch: 7 | loss: 0.0056414
	speed: 0.0409s/iter; left time: 140.1466s
	iters: 300, epoch: 7 | loss: 0.0055930
	speed: 0.0406s/iter; left time: 135.0289s
	iters: 400, epoch: 7 | loss: 0.0067463
	speed: 0.0408s/iter; left time: 131.6137s
	iters: 500, epoch: 7 | loss: 0.0064569
	speed: 0.0428s/iter; left time: 133.6938s
	iters: 600, epoch: 7 | loss: 0.0050494
	speed: 0.0444s/iter; left time: 134.4179s
	iters: 700, epoch: 7 | loss: 0.0066490
	speed: 0.0450s/iter; left time: 131.7498s
	iters: 800, epoch: 7 | loss: 0.0080448
	speed: 0.0444s/iter; left time: 125.4707s
	iters: 900, epoch: 7 | loss: 0.0078710
	speed: 0.0407s/iter; left time: 110.7877s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.72s
Steps: 906 | Train Loss: 0.0071003 Vali Loss: 0.0097350 Test Loss: 0.0120525
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010717766359448433, rmse:0.10352664440870285, mae:0.06321258097887039, rse:0.391234427690506
Original data scale mse:1526122.125, rmse:1235.3631591796875, mae:813.0914916992188, rse:0.08681188523769379
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1072771
	speed: 0.0466s/iter; left time: 417.2858s
	iters: 200, epoch: 1 | loss: 0.0727854
	speed: 0.0452s/iter; left time: 400.8090s
	iters: 300, epoch: 1 | loss: 0.0564901
	speed: 0.0291s/iter; left time: 254.8711s
	iters: 400, epoch: 1 | loss: 0.0384456
	speed: 0.0281s/iter; left time: 243.4099s
	iters: 500, epoch: 1 | loss: 0.0314287
	speed: 0.0281s/iter; left time: 240.6022s
	iters: 600, epoch: 1 | loss: 0.0333188
	speed: 0.0312s/iter; left time: 264.3165s
	iters: 700, epoch: 1 | loss: 0.0309556
	speed: 0.0450s/iter; left time: 376.1455s
	iters: 800, epoch: 1 | loss: 0.0317015
	speed: 0.0433s/iter; left time: 357.4865s
	iters: 900, epoch: 1 | loss: 0.0256815
	speed: 0.0409s/iter; left time: 333.3969s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.05s
Steps: 906 | Train Loss: 0.0540615 Vali Loss: 0.0167371 Test Loss: 0.0184141
Validation loss decreased (inf --> 0.016737).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0195280
	speed: 0.1017s/iter; left time: 819.5498s
	iters: 200, epoch: 2 | loss: 0.0186638
	speed: 0.0412s/iter; left time: 328.0544s
	iters: 300, epoch: 2 | loss: 0.0144677
	speed: 0.0411s/iter; left time: 322.7769s
	iters: 400, epoch: 2 | loss: 0.0139153
	speed: 0.0409s/iter; left time: 317.2043s
	iters: 500, epoch: 2 | loss: 0.0180252
	speed: 0.0413s/iter; left time: 316.3473s
	iters: 600, epoch: 2 | loss: 0.0111117
	speed: 0.0412s/iter; left time: 311.0344s
	iters: 700, epoch: 2 | loss: 0.0108622
	speed: 0.0411s/iter; left time: 306.7167s
	iters: 800, epoch: 2 | loss: 0.0091546
	speed: 0.0413s/iter; left time: 303.4726s
	iters: 900, epoch: 2 | loss: 0.0104582
	speed: 0.0412s/iter; left time: 299.0707s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.57s
Steps: 906 | Train Loss: 0.0158579 Vali Loss: 0.0106347 Test Loss: 0.0121935
Validation loss decreased (0.016737 --> 0.010635).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0106450
	speed: 0.0978s/iter; left time: 699.0452s
	iters: 200, epoch: 3 | loss: 0.0105016
	speed: 0.0418s/iter; left time: 294.3921s
	iters: 300, epoch: 3 | loss: 0.0131094
	speed: 0.0414s/iter; left time: 287.3878s
	iters: 400, epoch: 3 | loss: 0.0087256
	speed: 0.0418s/iter; left time: 286.1287s
	iters: 500, epoch: 3 | loss: 0.0092445
	speed: 0.0410s/iter; left time: 276.9930s
	iters: 600, epoch: 3 | loss: 0.0089797
	speed: 0.0408s/iter; left time: 271.3292s
	iters: 700, epoch: 3 | loss: 0.0099697
	speed: 0.0409s/iter; left time: 267.6165s
	iters: 800, epoch: 3 | loss: 0.0115768
	speed: 0.0412s/iter; left time: 265.7591s
	iters: 900, epoch: 3 | loss: 0.0107241
	speed: 0.0410s/iter; left time: 260.3120s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.57s
Steps: 906 | Train Loss: 0.0109342 Vali Loss: 0.0096202 Test Loss: 0.0108889
Validation loss decreased (0.010635 --> 0.009620).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0122454
	speed: 0.0967s/iter; left time: 603.9196s
	iters: 200, epoch: 4 | loss: 0.0103315
	speed: 0.0413s/iter; left time: 253.6873s
	iters: 300, epoch: 4 | loss: 0.0183899
	speed: 0.0414s/iter; left time: 250.3466s
	iters: 400, epoch: 4 | loss: 0.0099227
	speed: 0.0411s/iter; left time: 244.1338s
	iters: 500, epoch: 4 | loss: 0.0106649
	speed: 0.0415s/iter; left time: 242.2621s
	iters: 600, epoch: 4 | loss: 0.0087657
	speed: 0.0414s/iter; left time: 237.8428s
	iters: 700, epoch: 4 | loss: 0.0059044
	speed: 0.0414s/iter; left time: 233.3948s
	iters: 800, epoch: 4 | loss: 0.0082942
	speed: 0.0415s/iter; left time: 230.0344s
	iters: 900, epoch: 4 | loss: 0.0090943
	speed: 0.0410s/iter; left time: 223.2998s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.63s
Steps: 906 | Train Loss: 0.0096520 Vali Loss: 0.0101080 Test Loss: 0.0116650
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0084265
	speed: 0.0966s/iter; left time: 515.6285s
	iters: 200, epoch: 5 | loss: 0.0112829
	speed: 0.0453s/iter; left time: 236.9820s
	iters: 300, epoch: 5 | loss: 0.0086787
	speed: 0.0450s/iter; left time: 230.9672s
	iters: 400, epoch: 5 | loss: 0.0081475
	speed: 0.0452s/iter; left time: 227.5051s
	iters: 500, epoch: 5 | loss: 0.0099095
	speed: 0.0451s/iter; left time: 222.4889s
	iters: 600, epoch: 5 | loss: 0.0075935
	speed: 0.0450s/iter; left time: 217.6005s
	iters: 700, epoch: 5 | loss: 0.0097166
	speed: 0.0443s/iter; left time: 209.9948s
	iters: 800, epoch: 5 | loss: 0.0067493
	speed: 0.0412s/iter; left time: 191.1842s
	iters: 900, epoch: 5 | loss: 0.0083288
	speed: 0.0453s/iter; left time: 205.4272s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.53s
Steps: 906 | Train Loss: 0.0085997 Vali Loss: 0.0092223 Test Loss: 0.0108748
Validation loss decreased (0.009620 --> 0.009222).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0091523
	speed: 0.1000s/iter; left time: 443.0962s
	iters: 200, epoch: 6 | loss: 0.0071133
	speed: 0.0416s/iter; left time: 180.2960s
	iters: 300, epoch: 6 | loss: 0.0082193
	speed: 0.0418s/iter; left time: 176.8737s
	iters: 400, epoch: 6 | loss: 0.0080703
	speed: 0.0413s/iter; left time: 170.5997s
	iters: 500, epoch: 6 | loss: 0.0076564
	speed: 0.0413s/iter; left time: 166.6557s
	iters: 600, epoch: 6 | loss: 0.0077170
	speed: 0.0415s/iter; left time: 163.1258s
	iters: 700, epoch: 6 | loss: 0.0069852
	speed: 0.0411s/iter; left time: 157.4837s
	iters: 800, epoch: 6 | loss: 0.0069441
	speed: 0.0410s/iter; left time: 152.9914s
	iters: 900, epoch: 6 | loss: 0.0075413
	speed: 0.0415s/iter; left time: 150.6913s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.77s
Steps: 906 | Train Loss: 0.0081203 Vali Loss: 0.0096952 Test Loss: 0.0113186
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0061328
	speed: 0.0942s/iter; left time: 332.0654s
	iters: 200, epoch: 7 | loss: 0.0075554
	speed: 0.0416s/iter; left time: 142.4430s
	iters: 300, epoch: 7 | loss: 0.0073546
	speed: 0.0415s/iter; left time: 138.1309s
	iters: 400, epoch: 7 | loss: 0.0069964
	speed: 0.0416s/iter; left time: 134.2166s
	iters: 500, epoch: 7 | loss: 0.0069561
	speed: 0.0417s/iter; left time: 130.2927s
	iters: 600, epoch: 7 | loss: 0.0066977
	speed: 0.0418s/iter; left time: 126.5644s
	iters: 700, epoch: 7 | loss: 0.0093124
	speed: 0.0408s/iter; left time: 119.3629s
	iters: 800, epoch: 7 | loss: 0.0061187
	speed: 0.0416s/iter; left time: 117.4203s
	iters: 900, epoch: 7 | loss: 0.0054671
	speed: 0.0414s/iter; left time: 112.8953s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.79s
Steps: 906 | Train Loss: 0.0074914 Vali Loss: 0.0099514 Test Loss: 0.0116304
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0064661
	speed: 0.0944s/iter; left time: 247.1204s
	iters: 200, epoch: 8 | loss: 0.0056693
	speed: 0.0410s/iter; left time: 103.1883s
	iters: 300, epoch: 8 | loss: 0.0065405
	speed: 0.0412s/iter; left time: 99.7724s
	iters: 400, epoch: 8 | loss: 0.0057899
	speed: 0.0416s/iter; left time: 96.4946s
	iters: 500, epoch: 8 | loss: 0.0082420
	speed: 0.0404s/iter; left time: 89.7155s
	iters: 600, epoch: 8 | loss: 0.0066698
	speed: 0.0411s/iter; left time: 87.1092s
	iters: 700, epoch: 8 | loss: 0.0070464
	speed: 0.0407s/iter; left time: 82.0825s
	iters: 800, epoch: 8 | loss: 0.0054594
	speed: 0.0404s/iter; left time: 77.5172s
	iters: 900, epoch: 8 | loss: 0.0076695
	speed: 0.0411s/iter; left time: 74.7435s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.26s
Steps: 906 | Train Loss: 0.0069357 Vali Loss: 0.0098625 Test Loss: 0.0113585
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010888392105698586, rmse:0.10434745997190475, mae:0.06476157903671265, rse:0.3943363130092621
Original data scale mse:1720168.5, rmse:1311.552001953125, mae:849.8506469726562, rse:0.09216585010290146

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.010717766359448433, RMSE: 0.10352664440870285, MAE: 0.06321258097887039, RSE: 0.391234427690506
Unscaled Metrics - MSE: 1526122.125, RMSE: 1235.3631591796875, MAE: 813.0914916992188, RSE: 0.08681188523769379

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.010888392105698586, RMSE: 0.10434745997190475, MAE: 0.06476157903671265, RSE: 0.3943363130092621
Unscaled Metrics - MSE: 1720168.5, RMSE: 1311.552001953125, MAE: 849.8506469726562, RSE: 0.09216585010290146

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0965978
	speed: 0.0762s/iter; left time: 681.0253s
	iters: 200, epoch: 1 | loss: 0.0763174
	speed: 0.0473s/iter; left time: 418.4102s
	iters: 300, epoch: 1 | loss: 0.0624324
	speed: 0.0473s/iter; left time: 413.8774s
	iters: 400, epoch: 1 | loss: 0.0575895
	speed: 0.0474s/iter; left time: 409.8899s
	iters: 500, epoch: 1 | loss: 0.0522829
	speed: 0.0474s/iter; left time: 404.4719s
	iters: 600, epoch: 1 | loss: 0.0474165
	speed: 0.0471s/iter; left time: 397.9874s
	iters: 700, epoch: 1 | loss: 0.0446128
	speed: 0.0474s/iter; left time: 394.9680s
	iters: 800, epoch: 1 | loss: 0.0429181
	speed: 0.0473s/iter; left time: 389.4987s
	iters: 900, epoch: 1 | loss: 0.0435803
	speed: 0.0456s/iter; left time: 370.9120s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.30s
Steps: 904 | Train Loss: 0.0626754 Vali Loss: 0.0342747 Test Loss: 0.0396404
Validation loss decreased (inf --> 0.034275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0316409
	speed: 0.1136s/iter; left time: 912.7016s
	iters: 200, epoch: 2 | loss: 0.0300582
	speed: 0.0474s/iter; left time: 376.3983s
	iters: 300, epoch: 2 | loss: 0.0245600
	speed: 0.0472s/iter; left time: 369.9472s
	iters: 400, epoch: 2 | loss: 0.0222255
	speed: 0.0473s/iter; left time: 365.9265s
	iters: 500, epoch: 2 | loss: 0.0221407
	speed: 0.0474s/iter; left time: 361.7758s
	iters: 600, epoch: 2 | loss: 0.0229814
	speed: 0.0473s/iter; left time: 356.4701s
	iters: 700, epoch: 2 | loss: 0.0199335
	speed: 0.0473s/iter; left time: 351.5507s
	iters: 800, epoch: 2 | loss: 0.0198781
	speed: 0.0473s/iter; left time: 346.9803s
	iters: 900, epoch: 2 | loss: 0.0168008
	speed: 0.0473s/iter; left time: 342.1705s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.95s
Steps: 904 | Train Loss: 0.0248720 Vali Loss: 0.0181293 Test Loss: 0.0190602
Validation loss decreased (0.034275 --> 0.018129).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0185513
	speed: 0.1158s/iter; left time: 826.1195s
	iters: 200, epoch: 3 | loss: 0.0179213
	speed: 0.0472s/iter; left time: 331.6582s
	iters: 300, epoch: 3 | loss: 0.0190399
	speed: 0.0472s/iter; left time: 327.2241s
	iters: 400, epoch: 3 | loss: 0.0179476
	speed: 0.0472s/iter; left time: 322.3024s
	iters: 500, epoch: 3 | loss: 0.0167958
	speed: 0.0473s/iter; left time: 318.3566s
	iters: 600, epoch: 3 | loss: 0.0156560
	speed: 0.0473s/iter; left time: 313.9871s
	iters: 700, epoch: 3 | loss: 0.0143740
	speed: 0.0473s/iter; left time: 308.8785s
	iters: 800, epoch: 3 | loss: 0.0194579
	speed: 0.0474s/iter; left time: 304.8830s
	iters: 900, epoch: 3 | loss: 0.0194166
	speed: 0.0473s/iter; left time: 299.7215s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.96s
Steps: 904 | Train Loss: 0.0173184 Vali Loss: 0.0168388 Test Loss: 0.0188488
Validation loss decreased (0.018129 --> 0.016839).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0145729
	speed: 0.1141s/iter; left time: 710.9329s
	iters: 200, epoch: 4 | loss: 0.0157704
	speed: 0.0475s/iter; left time: 291.2584s
	iters: 300, epoch: 4 | loss: 0.0148348
	speed: 0.0476s/iter; left time: 287.2766s
	iters: 400, epoch: 4 | loss: 0.0170949
	speed: 0.0476s/iter; left time: 282.3401s
	iters: 500, epoch: 4 | loss: 0.0174292
	speed: 0.0475s/iter; left time: 277.0821s
	iters: 600, epoch: 4 | loss: 0.0169957
	speed: 0.0476s/iter; left time: 272.8387s
	iters: 700, epoch: 4 | loss: 0.0144556
	speed: 0.0476s/iter; left time: 268.0350s
	iters: 800, epoch: 4 | loss: 0.0159345
	speed: 0.0476s/iter; left time: 263.3802s
	iters: 900, epoch: 4 | loss: 0.0133411
	speed: 0.0477s/iter; left time: 258.7137s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.21s
Steps: 904 | Train Loss: 0.0155758 Vali Loss: 0.0160214 Test Loss: 0.0188094
Validation loss decreased (0.016839 --> 0.016021).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0125320
	speed: 0.1154s/iter; left time: 614.7517s
	iters: 200, epoch: 5 | loss: 0.0142376
	speed: 0.0475s/iter; left time: 247.9534s
	iters: 300, epoch: 5 | loss: 0.0147045
	speed: 0.0475s/iter; left time: 243.4648s
	iters: 400, epoch: 5 | loss: 0.0165673
	speed: 0.0475s/iter; left time: 238.7636s
	iters: 500, epoch: 5 | loss: 0.0136447
	speed: 0.0473s/iter; left time: 232.8595s
	iters: 600, epoch: 5 | loss: 0.0137602
	speed: 0.0474s/iter; left time: 228.7746s
	iters: 700, epoch: 5 | loss: 0.0156750
	speed: 0.0473s/iter; left time: 223.7079s
	iters: 800, epoch: 5 | loss: 0.0154189
	speed: 0.0475s/iter; left time: 219.6795s
	iters: 900, epoch: 5 | loss: 0.0126147
	speed: 0.0474s/iter; left time: 214.5903s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.08s
Steps: 904 | Train Loss: 0.0141869 Vali Loss: 0.0175523 Test Loss: 0.0200307
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0091899
	speed: 0.1115s/iter; left time: 492.9849s
	iters: 200, epoch: 6 | loss: 0.0141560
	speed: 0.0476s/iter; left time: 205.4736s
	iters: 300, epoch: 6 | loss: 0.0133619
	speed: 0.0475s/iter; left time: 200.2932s
	iters: 400, epoch: 6 | loss: 0.0147298
	speed: 0.0474s/iter; left time: 195.3883s
	iters: 500, epoch: 6 | loss: 0.0129567
	speed: 0.0474s/iter; left time: 190.5601s
	iters: 600, epoch: 6 | loss: 0.0123693
	speed: 0.0474s/iter; left time: 185.9515s
	iters: 700, epoch: 6 | loss: 0.0106462
	speed: 0.0475s/iter; left time: 181.3720s
	iters: 800, epoch: 6 | loss: 0.0129582
	speed: 0.0475s/iter; left time: 176.7794s
	iters: 900, epoch: 6 | loss: 0.0141232
	speed: 0.0476s/iter; left time: 172.4487s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.10s
Steps: 904 | Train Loss: 0.0129504 Vali Loss: 0.0182900 Test Loss: 0.0199193
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0112996
	speed: 0.1111s/iter; left time: 390.6785s
	iters: 200, epoch: 7 | loss: 0.0106417
	speed: 0.0474s/iter; left time: 161.9596s
	iters: 300, epoch: 7 | loss: 0.0122807
	speed: 0.0472s/iter; left time: 156.6039s
	iters: 400, epoch: 7 | loss: 0.0110445
	speed: 0.0473s/iter; left time: 152.0657s
	iters: 500, epoch: 7 | loss: 0.0100627
	speed: 0.0468s/iter; left time: 145.8580s
	iters: 600, epoch: 7 | loss: 0.0139700
	speed: 0.0465s/iter; left time: 140.3984s
	iters: 700, epoch: 7 | loss: 0.0108820
	speed: 0.0473s/iter; left time: 137.9081s
	iters: 800, epoch: 7 | loss: 0.0082813
	speed: 0.0473s/iter; left time: 133.2190s
	iters: 900, epoch: 7 | loss: 0.0116650
	speed: 0.0476s/iter; left time: 129.2115s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.80s
Steps: 904 | Train Loss: 0.0116611 Vali Loss: 0.0171298 Test Loss: 0.0204476
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018819740042090416, rmse:0.13718505203723907, mae:0.08882778137922287, rse:0.518711507320404
Original data scale mse:3564554.25, rmse:1888.002685546875, mae:1239.82080078125, rse:0.13286645710468292
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0987037
	speed: 0.0375s/iter; left time: 335.5127s
	iters: 200, epoch: 1 | loss: 0.0884736
	speed: 0.0354s/iter; left time: 312.7682s
	iters: 300, epoch: 1 | loss: 0.0708279
	speed: 0.0428s/iter; left time: 373.9243s
	iters: 400, epoch: 1 | loss: 0.0658146
	speed: 0.0354s/iter; left time: 305.8593s
	iters: 500, epoch: 1 | loss: 0.0579624
	speed: 0.0354s/iter; left time: 302.5463s
	iters: 600, epoch: 1 | loss: 0.0521227
	speed: 0.0354s/iter; left time: 298.8751s
	iters: 700, epoch: 1 | loss: 0.0463430
	speed: 0.0473s/iter; left time: 394.3204s
	iters: 800, epoch: 1 | loss: 0.0407464
	speed: 0.0478s/iter; left time: 394.2186s
	iters: 900, epoch: 1 | loss: 0.0368132
	speed: 0.0476s/iter; left time: 387.6669s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:36.72s
Steps: 904 | Train Loss: 0.0656269 Vali Loss: 0.0303077 Test Loss: 0.0346506
Validation loss decreased (inf --> 0.030308).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0314901
	speed: 0.1178s/iter; left time: 946.4329s
	iters: 200, epoch: 2 | loss: 0.0277157
	speed: 0.0476s/iter; left time: 378.1330s
	iters: 300, epoch: 2 | loss: 0.0278407
	speed: 0.0474s/iter; left time: 371.7138s
	iters: 400, epoch: 2 | loss: 0.0232088
	speed: 0.0476s/iter; left time: 368.0031s
	iters: 500, epoch: 2 | loss: 0.0220202
	speed: 0.0477s/iter; left time: 364.3466s
	iters: 600, epoch: 2 | loss: 0.0238796
	speed: 0.0476s/iter; left time: 358.4986s
	iters: 700, epoch: 2 | loss: 0.0221600
	speed: 0.0474s/iter; left time: 352.2041s
	iters: 800, epoch: 2 | loss: 0.0193208
	speed: 0.0476s/iter; left time: 349.2448s
	iters: 900, epoch: 2 | loss: 0.0164941
	speed: 0.0477s/iter; left time: 345.3040s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.27s
Steps: 904 | Train Loss: 0.0246974 Vali Loss: 0.0191642 Test Loss: 0.0209797
Validation loss decreased (0.030308 --> 0.019164).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0168466
	speed: 0.1139s/iter; left time: 812.1294s
	iters: 200, epoch: 3 | loss: 0.0170843
	speed: 0.0472s/iter; left time: 332.1354s
	iters: 300, epoch: 3 | loss: 0.0168764
	speed: 0.0471s/iter; left time: 326.6742s
	iters: 400, epoch: 3 | loss: 0.0185967
	speed: 0.0472s/iter; left time: 322.6500s
	iters: 500, epoch: 3 | loss: 0.0171801
	speed: 0.0473s/iter; left time: 318.4292s
	iters: 600, epoch: 3 | loss: 0.0186517
	speed: 0.0472s/iter; left time: 313.0755s
	iters: 700, epoch: 3 | loss: 0.0172052
	speed: 0.0472s/iter; left time: 308.2848s
	iters: 800, epoch: 3 | loss: 0.0153880
	speed: 0.0472s/iter; left time: 303.3904s
	iters: 900, epoch: 3 | loss: 0.0160327
	speed: 0.0472s/iter; left time: 298.6118s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.84s
Steps: 904 | Train Loss: 0.0175482 Vali Loss: 0.0187653 Test Loss: 0.0193137
Validation loss decreased (0.019164 --> 0.018765).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0164750
	speed: 0.1144s/iter; left time: 712.5761s
	iters: 200, epoch: 4 | loss: 0.0166649
	speed: 0.0472s/iter; left time: 289.3087s
	iters: 300, epoch: 4 | loss: 0.0179890
	speed: 0.0471s/iter; left time: 283.7901s
	iters: 400, epoch: 4 | loss: 0.0157988
	speed: 0.0470s/iter; left time: 278.8068s
	iters: 500, epoch: 4 | loss: 0.0155213
	speed: 0.0472s/iter; left time: 274.9645s
	iters: 600, epoch: 4 | loss: 0.0151332
	speed: 0.0471s/iter; left time: 269.9226s
	iters: 700, epoch: 4 | loss: 0.0159517
	speed: 0.0472s/iter; left time: 265.4620s
	iters: 800, epoch: 4 | loss: 0.0151334
	speed: 0.0472s/iter; left time: 260.7976s
	iters: 900, epoch: 4 | loss: 0.0128318
	speed: 0.0471s/iter; left time: 255.7127s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.83s
Steps: 904 | Train Loss: 0.0159095 Vali Loss: 0.0161542 Test Loss: 0.0184494
Validation loss decreased (0.018765 --> 0.016154).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0147134
	speed: 0.1140s/iter; left time: 607.0038s
	iters: 200, epoch: 5 | loss: 0.0142841
	speed: 0.0474s/iter; left time: 247.8148s
	iters: 300, epoch: 5 | loss: 0.0152451
	speed: 0.0474s/iter; left time: 242.8952s
	iters: 400, epoch: 5 | loss: 0.0152598
	speed: 0.0472s/iter; left time: 237.2849s
	iters: 500, epoch: 5 | loss: 0.0143808
	speed: 0.0473s/iter; left time: 233.0658s
	iters: 600, epoch: 5 | loss: 0.0165163
	speed: 0.0473s/iter; left time: 228.2278s
	iters: 700, epoch: 5 | loss: 0.0169006
	speed: 0.0475s/iter; left time: 224.3815s
	iters: 800, epoch: 5 | loss: 0.0150849
	speed: 0.0473s/iter; left time: 218.9098s
	iters: 900, epoch: 5 | loss: 0.0129701
	speed: 0.0472s/iter; left time: 213.7157s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.00s
Steps: 904 | Train Loss: 0.0145653 Vali Loss: 0.0167866 Test Loss: 0.0182130
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0144543
	speed: 0.1105s/iter; left time: 488.5565s
	iters: 200, epoch: 6 | loss: 0.0131637
	speed: 0.0477s/iter; left time: 206.2026s
	iters: 300, epoch: 6 | loss: 0.0150082
	speed: 0.0473s/iter; left time: 199.5008s
	iters: 400, epoch: 6 | loss: 0.0124514
	speed: 0.0476s/iter; left time: 196.1149s
	iters: 500, epoch: 6 | loss: 0.0153600
	speed: 0.0464s/iter; left time: 186.7413s
	iters: 600, epoch: 6 | loss: 0.0130928
	speed: 0.0473s/iter; left time: 185.3577s
	iters: 700, epoch: 6 | loss: 0.0130013
	speed: 0.0474s/iter; left time: 181.0134s
	iters: 800, epoch: 6 | loss: 0.0135275
	speed: 0.0474s/iter; left time: 176.5605s
	iters: 900, epoch: 6 | loss: 0.0117891
	speed: 0.0477s/iter; left time: 172.5988s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.94s
Steps: 904 | Train Loss: 0.0134384 Vali Loss: 0.0176615 Test Loss: 0.0193987
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0139532
	speed: 0.1115s/iter; left time: 392.0331s
	iters: 200, epoch: 7 | loss: 0.0113275
	speed: 0.0471s/iter; left time: 160.9963s
	iters: 300, epoch: 7 | loss: 0.0125756
	speed: 0.0471s/iter; left time: 156.2567s
	iters: 400, epoch: 7 | loss: 0.0121575
	speed: 0.0471s/iter; left time: 151.5473s
	iters: 500, epoch: 7 | loss: 0.0122219
	speed: 0.0472s/iter; left time: 147.0921s
	iters: 600, epoch: 7 | loss: 0.0115706
	speed: 0.0471s/iter; left time: 142.0904s
	iters: 700, epoch: 7 | loss: 0.0109862
	speed: 0.0473s/iter; left time: 137.8901s
	iters: 800, epoch: 7 | loss: 0.0125606
	speed: 0.0472s/iter; left time: 132.9607s
	iters: 900, epoch: 7 | loss: 0.0116496
	speed: 0.0473s/iter; left time: 128.5439s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.88s
Steps: 904 | Train Loss: 0.0122618 Vali Loss: 0.0180657 Test Loss: 0.0196466
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018441960215568542, rmse:0.13580118119716644, mae:0.08805994689464569, rse:0.5134788751602173
Original data scale mse:3233782.0, rmse:1798.27197265625, mae:1197.27587890625, rse:0.12655173242092133

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.018819740042090416, RMSE: 0.13718505203723907, MAE: 0.08882778137922287, RSE: 0.518711507320404
Unscaled Metrics - MSE: 3564554.25, RMSE: 1888.002685546875, MAE: 1239.82080078125, RSE: 0.13286645710468292

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.018441960215568542, RMSE: 0.13580118119716644, MAE: 0.08805994689464569, RSE: 0.5134788751602173
Unscaled Metrics - MSE: 3233782.0, RMSE: 1798.27197265625, MAE: 1197.27587890625, RSE: 0.12655173242092133

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0974921
	speed: 0.0825s/iter; left time: 735.7528s
	iters: 200, epoch: 1 | loss: 0.0737297
	speed: 0.0534s/iter; left time: 470.8799s
	iters: 300, epoch: 1 | loss: 0.0746729
	speed: 0.0535s/iter; left time: 466.7414s
	iters: 400, epoch: 1 | loss: 0.0646961
	speed: 0.0535s/iter; left time: 461.1368s
	iters: 500, epoch: 1 | loss: 0.0622333
	speed: 0.0535s/iter; left time: 456.1089s
	iters: 600, epoch: 1 | loss: 0.0593816
	speed: 0.0535s/iter; left time: 450.1662s
	iters: 700, epoch: 1 | loss: 0.0558329
	speed: 0.0536s/iter; left time: 445.7981s
	iters: 800, epoch: 1 | loss: 0.0576991
	speed: 0.0534s/iter; left time: 438.9984s
	iters: 900, epoch: 1 | loss: 0.0550442
	speed: 0.0536s/iter; left time: 435.1808s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.95s
Steps: 902 | Train Loss: 0.0695445 Vali Loss: 0.0452942 Test Loss: 0.0526632
Validation loss decreased (inf --> 0.045294).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0437670
	speed: 0.1333s/iter; left time: 1069.2581s
	iters: 200, epoch: 2 | loss: 0.0377229
	speed: 0.0536s/iter; left time: 424.6213s
	iters: 300, epoch: 2 | loss: 0.0359136
	speed: 0.0535s/iter; left time: 418.1643s
	iters: 400, epoch: 2 | loss: 0.0271950
	speed: 0.0536s/iter; left time: 414.0493s
	iters: 500, epoch: 2 | loss: 0.0231806
	speed: 0.0536s/iter; left time: 408.4090s
	iters: 600, epoch: 2 | loss: 0.0230975
	speed: 0.0537s/iter; left time: 403.6334s
	iters: 700, epoch: 2 | loss: 0.0187729
	speed: 0.0538s/iter; left time: 398.8894s
	iters: 800, epoch: 2 | loss: 0.0190174
	speed: 0.0538s/iter; left time: 393.7135s
	iters: 900, epoch: 2 | loss: 0.0191427
	speed: 0.0533s/iter; left time: 384.5845s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.62s
Steps: 902 | Train Loss: 0.0297272 Vali Loss: 0.0194273 Test Loss: 0.0212550
Validation loss decreased (0.045294 --> 0.019427).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0185710
	speed: 0.1317s/iter; left time: 937.2025s
	iters: 200, epoch: 3 | loss: 0.0202392
	speed: 0.0537s/iter; left time: 376.4998s
	iters: 300, epoch: 3 | loss: 0.0209719
	speed: 0.0536s/iter; left time: 370.9046s
	iters: 400, epoch: 3 | loss: 0.0212731
	speed: 0.0536s/iter; left time: 365.2491s
	iters: 500, epoch: 3 | loss: 0.0211410
	speed: 0.0536s/iter; left time: 360.0919s
	iters: 600, epoch: 3 | loss: 0.0179709
	speed: 0.0535s/iter; left time: 353.9707s
	iters: 700, epoch: 3 | loss: 0.0172771
	speed: 0.0535s/iter; left time: 348.9777s
	iters: 800, epoch: 3 | loss: 0.0189959
	speed: 0.0536s/iter; left time: 344.1826s
	iters: 900, epoch: 3 | loss: 0.0183518
	speed: 0.0536s/iter; left time: 338.8088s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.55s
Steps: 902 | Train Loss: 0.0192145 Vali Loss: 0.0187917 Test Loss: 0.0198753
Validation loss decreased (0.019427 --> 0.018792).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0182034
	speed: 0.1316s/iter; left time: 817.9436s
	iters: 200, epoch: 4 | loss: 0.0170556
	speed: 0.0535s/iter; left time: 327.0335s
	iters: 300, epoch: 4 | loss: 0.0216248
	speed: 0.0536s/iter; left time: 322.5213s
	iters: 400, epoch: 4 | loss: 0.0158034
	speed: 0.0535s/iter; left time: 316.5500s
	iters: 500, epoch: 4 | loss: 0.0156982
	speed: 0.0536s/iter; left time: 311.7207s
	iters: 600, epoch: 4 | loss: 0.0158063
	speed: 0.0536s/iter; left time: 306.5031s
	iters: 700, epoch: 4 | loss: 0.0180456
	speed: 0.0536s/iter; left time: 300.7023s
	iters: 800, epoch: 4 | loss: 0.0191916
	speed: 0.0536s/iter; left time: 295.5241s
	iters: 900, epoch: 4 | loss: 0.0169604
	speed: 0.0535s/iter; left time: 289.4934s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.53s
Steps: 902 | Train Loss: 0.0172478 Vali Loss: 0.0177593 Test Loss: 0.0202066
Validation loss decreased (0.018792 --> 0.017759).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0134522
	speed: 0.1338s/iter; left time: 710.7707s
	iters: 200, epoch: 5 | loss: 0.0142919
	speed: 0.0533s/iter; left time: 277.7485s
	iters: 300, epoch: 5 | loss: 0.0167201
	speed: 0.0535s/iter; left time: 273.7144s
	iters: 400, epoch: 5 | loss: 0.0171382
	speed: 0.0533s/iter; left time: 267.1030s
	iters: 500, epoch: 5 | loss: 0.0173544
	speed: 0.0534s/iter; left time: 262.2365s
	iters: 600, epoch: 5 | loss: 0.0171960
	speed: 0.0534s/iter; left time: 256.7834s
	iters: 700, epoch: 5 | loss: 0.0171616
	speed: 0.0535s/iter; left time: 251.9577s
	iters: 800, epoch: 5 | loss: 0.0146170
	speed: 0.0532s/iter; left time: 245.6127s
	iters: 900, epoch: 5 | loss: 0.0154075
	speed: 0.0531s/iter; left time: 239.4700s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.31s
Steps: 902 | Train Loss: 0.0157436 Vali Loss: 0.0180761 Test Loss: 0.0218641
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0139048
	speed: 0.1291s/iter; left time: 569.3290s
	iters: 200, epoch: 6 | loss: 0.0145707
	speed: 0.0534s/iter; left time: 230.3934s
	iters: 300, epoch: 6 | loss: 0.0134117
	speed: 0.0537s/iter; left time: 226.3076s
	iters: 400, epoch: 6 | loss: 0.0142503
	speed: 0.0546s/iter; left time: 224.2976s
	iters: 500, epoch: 6 | loss: 0.0131306
	speed: 0.0543s/iter; left time: 217.6128s
	iters: 600, epoch: 6 | loss: 0.0130733
	speed: 0.0545s/iter; left time: 213.1281s
	iters: 700, epoch: 6 | loss: 0.0129872
	speed: 0.0543s/iter; left time: 206.8636s
	iters: 800, epoch: 6 | loss: 0.0133410
	speed: 0.0542s/iter; left time: 200.9958s
	iters: 900, epoch: 6 | loss: 0.0126120
	speed: 0.0540s/iter; left time: 195.1716s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.96s
Steps: 902 | Train Loss: 0.0142612 Vali Loss: 0.0194945 Test Loss: 0.0218930
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0139907
	speed: 0.1289s/iter; left time: 452.4482s
	iters: 200, epoch: 7 | loss: 0.0136648
	speed: 0.0535s/iter; left time: 182.3061s
	iters: 300, epoch: 7 | loss: 0.0112592
	speed: 0.0535s/iter; left time: 176.9092s
	iters: 400, epoch: 7 | loss: 0.0125166
	speed: 0.0536s/iter; left time: 171.9065s
	iters: 500, epoch: 7 | loss: 0.0131221
	speed: 0.0535s/iter; left time: 166.2066s
	iters: 600, epoch: 7 | loss: 0.0132257
	speed: 0.0535s/iter; left time: 160.9143s
	iters: 700, epoch: 7 | loss: 0.0126774
	speed: 0.0535s/iter; left time: 155.5203s
	iters: 800, epoch: 7 | loss: 0.0114170
	speed: 0.0534s/iter; left time: 150.1093s
	iters: 900, epoch: 7 | loss: 0.0112940
	speed: 0.0534s/iter; left time: 144.5609s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.44s
Steps: 902 | Train Loss: 0.0128613 Vali Loss: 0.0195691 Test Loss: 0.0236121
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020197875797748566, rmse:0.14211922883987427, mae:0.09424823522567749, rse:0.5377394556999207
Original data scale mse:4201466.0, rmse:2049.747802734375, mae:1339.478515625, rse:0.14438457787036896
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0880133
	speed: 0.0552s/iter; left time: 492.2436s
	iters: 200, epoch: 1 | loss: 0.0756381
	speed: 0.0538s/iter; left time: 474.2967s
	iters: 300, epoch: 1 | loss: 0.0622192
	speed: 0.0536s/iter; left time: 467.7347s
	iters: 400, epoch: 1 | loss: 0.0637600
	speed: 0.0538s/iter; left time: 463.9864s
	iters: 500, epoch: 1 | loss: 0.0594108
	speed: 0.0535s/iter; left time: 456.2175s
	iters: 600, epoch: 1 | loss: 0.0529074
	speed: 0.0536s/iter; left time: 451.0078s
	iters: 700, epoch: 1 | loss: 0.0529065
	speed: 0.0538s/iter; left time: 447.7386s
	iters: 800, epoch: 1 | loss: 0.0508091
	speed: 0.0538s/iter; left time: 442.0815s
	iters: 900, epoch: 1 | loss: 0.0500937
	speed: 0.0538s/iter; left time: 436.6090s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.0661808 Vali Loss: 0.0413559 Test Loss: 0.0479795
Validation loss decreased (inf --> 0.041356).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0433474
	speed: 0.1356s/iter; left time: 1087.1189s
	iters: 200, epoch: 2 | loss: 0.0373783
	speed: 0.0536s/iter; left time: 424.4293s
	iters: 300, epoch: 2 | loss: 0.0313706
	speed: 0.0535s/iter; left time: 418.0906s
	iters: 400, epoch: 2 | loss: 0.0255383
	speed: 0.0536s/iter; left time: 413.6664s
	iters: 500, epoch: 2 | loss: 0.0288372
	speed: 0.0536s/iter; left time: 408.3424s
	iters: 600, epoch: 2 | loss: 0.0199318
	speed: 0.0534s/iter; left time: 401.1755s
	iters: 700, epoch: 2 | loss: 0.0209868
	speed: 0.0532s/iter; left time: 394.5953s
	iters: 800, epoch: 2 | loss: 0.0186831
	speed: 0.0535s/iter; left time: 391.5688s
	iters: 900, epoch: 2 | loss: 0.0215274
	speed: 0.0532s/iter; left time: 383.7659s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.44s
Steps: 902 | Train Loss: 0.0290190 Vali Loss: 0.0191896 Test Loss: 0.0217418
Validation loss decreased (0.041356 --> 0.019190).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0228122
	speed: 0.1339s/iter; left time: 953.0939s
	iters: 200, epoch: 3 | loss: 0.0186541
	speed: 0.0535s/iter; left time: 375.4153s
	iters: 300, epoch: 3 | loss: 0.0188690
	speed: 0.0535s/iter; left time: 370.1147s
	iters: 400, epoch: 3 | loss: 0.0197870
	speed: 0.0534s/iter; left time: 363.9003s
	iters: 500, epoch: 3 | loss: 0.0179528
	speed: 0.0534s/iter; left time: 358.7001s
	iters: 600, epoch: 3 | loss: 0.0193526
	speed: 0.0533s/iter; left time: 352.5694s
	iters: 700, epoch: 3 | loss: 0.0176058
	speed: 0.0533s/iter; left time: 347.1464s
	iters: 800, epoch: 3 | loss: 0.0200834
	speed: 0.0532s/iter; left time: 341.6545s
	iters: 900, epoch: 3 | loss: 0.0206543
	speed: 0.0533s/iter; left time: 336.8070s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.38s
Steps: 902 | Train Loss: 0.0192441 Vali Loss: 0.0189449 Test Loss: 0.0203193
Validation loss decreased (0.019190 --> 0.018945).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0186950
	speed: 0.1366s/iter; left time: 849.0916s
	iters: 200, epoch: 4 | loss: 0.0169173
	speed: 0.0533s/iter; left time: 325.8142s
	iters: 300, epoch: 4 | loss: 0.0162353
	speed: 0.0535s/iter; left time: 321.7313s
	iters: 400, epoch: 4 | loss: 0.0181942
	speed: 0.0534s/iter; left time: 315.7704s
	iters: 500, epoch: 4 | loss: 0.0174420
	speed: 0.0536s/iter; left time: 311.7832s
	iters: 600, epoch: 4 | loss: 0.0158387
	speed: 0.0537s/iter; left time: 306.9508s
	iters: 700, epoch: 4 | loss: 0.0159433
	speed: 0.0537s/iter; left time: 301.2956s
	iters: 800, epoch: 4 | loss: 0.0187397
	speed: 0.0538s/iter; left time: 296.4794s
	iters: 900, epoch: 4 | loss: 0.0150236
	speed: 0.0536s/iter; left time: 290.2011s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.54s
Steps: 902 | Train Loss: 0.0172565 Vali Loss: 0.0178393 Test Loss: 0.0205282
Validation loss decreased (0.018945 --> 0.017839).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0164729
	speed: 0.1350s/iter; left time: 717.1105s
	iters: 200, epoch: 5 | loss: 0.0161181
	speed: 0.0533s/iter; left time: 277.8203s
	iters: 300, epoch: 5 | loss: 0.0165497
	speed: 0.0534s/iter; left time: 272.8465s
	iters: 400, epoch: 5 | loss: 0.0168216
	speed: 0.0535s/iter; left time: 268.4181s
	iters: 500, epoch: 5 | loss: 0.0152248
	speed: 0.0536s/iter; left time: 263.5084s
	iters: 600, epoch: 5 | loss: 0.0158233
	speed: 0.0535s/iter; left time: 257.3457s
	iters: 700, epoch: 5 | loss: 0.0145402
	speed: 0.0537s/iter; left time: 253.0563s
	iters: 800, epoch: 5 | loss: 0.0146539
	speed: 0.0537s/iter; left time: 247.8315s
	iters: 900, epoch: 5 | loss: 0.0144568
	speed: 0.0538s/iter; left time: 242.8567s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.54s
Steps: 902 | Train Loss: 0.0156204 Vali Loss: 0.0194440 Test Loss: 0.0200516
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0173520
	speed: 0.1292s/iter; left time: 570.0364s
	iters: 200, epoch: 6 | loss: 0.0135571
	speed: 0.0534s/iter; left time: 230.3637s
	iters: 300, epoch: 6 | loss: 0.0146123
	speed: 0.0534s/iter; left time: 225.0571s
	iters: 400, epoch: 6 | loss: 0.0143503
	speed: 0.0534s/iter; left time: 219.6636s
	iters: 500, epoch: 6 | loss: 0.0160940
	speed: 0.0536s/iter; left time: 214.9079s
	iters: 600, epoch: 6 | loss: 0.0147968
	speed: 0.0534s/iter; left time: 208.7783s
	iters: 700, epoch: 6 | loss: 0.0148049
	speed: 0.0533s/iter; left time: 203.1789s
	iters: 800, epoch: 6 | loss: 0.0126878
	speed: 0.0535s/iter; left time: 198.4702s
	iters: 900, epoch: 6 | loss: 0.0131650
	speed: 0.0530s/iter; left time: 191.2493s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.35s
Steps: 902 | Train Loss: 0.0141731 Vali Loss: 0.0193749 Test Loss: 0.0208626
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0144330
	speed: 0.1301s/iter; left time: 456.3769s
	iters: 200, epoch: 7 | loss: 0.0120475
	speed: 0.0534s/iter; left time: 181.9750s
	iters: 300, epoch: 7 | loss: 0.0135179
	speed: 0.0538s/iter; left time: 178.0603s
	iters: 400, epoch: 7 | loss: 0.0155561
	speed: 0.0535s/iter; left time: 171.8344s
	iters: 500, epoch: 7 | loss: 0.0116965
	speed: 0.0537s/iter; left time: 166.9060s
	iters: 600, epoch: 7 | loss: 0.0115004
	speed: 0.0537s/iter; left time: 161.5230s
	iters: 700, epoch: 7 | loss: 0.0121655
	speed: 0.0536s/iter; left time: 156.0456s
	iters: 800, epoch: 7 | loss: 0.0107254
	speed: 0.0537s/iter; left time: 150.7323s
	iters: 900, epoch: 7 | loss: 0.0114145
	speed: 0.0540s/iter; left time: 146.1563s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.0126369 Vali Loss: 0.0208729 Test Loss: 0.0223272
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020525574684143066, rmse:0.14326749742031097, mae:0.09577973932027817, rse:0.5420841574668884
Original data scale mse:4258257.5, rmse:2063.5546875, mae:1360.009521484375, rse:0.1453571319580078

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.020197875797748566, RMSE: 0.14211922883987427, MAE: 0.09424823522567749, RSE: 0.5377394556999207
Unscaled Metrics - MSE: 4201466.0, RMSE: 2049.747802734375, MAE: 1339.478515625, RSE: 0.14438457787036896

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.020525574684143066, RMSE: 0.14326749742031097, MAE: 0.09577973932027817, RSE: 0.5420841574668884
Unscaled Metrics - MSE: 4258257.5, RMSE: 2063.5546875, MAE: 1360.009521484375, RSE: 0.1453571319580078

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3182604
	speed: 0.0716s/iter; left time: 641.2754s
	iters: 200, epoch: 1 | loss: 0.2770974
	speed: 0.0420s/iter; left time: 371.7654s
	iters: 300, epoch: 1 | loss: 0.2441429
	speed: 0.0411s/iter; left time: 360.2982s
	iters: 400, epoch: 1 | loss: 0.2138520
	speed: 0.0422s/iter; left time: 365.7111s
	iters: 500, epoch: 1 | loss: 0.1800770
	speed: 0.0416s/iter; left time: 355.7371s
	iters: 600, epoch: 1 | loss: 0.1667540
	speed: 0.0421s/iter; left time: 356.5201s
	iters: 700, epoch: 1 | loss: 0.1557548
	speed: 0.0417s/iter; left time: 348.3195s
	iters: 800, epoch: 1 | loss: 0.1619005
	speed: 0.0421s/iter; left time: 347.7277s
	iters: 900, epoch: 1 | loss: 0.1687815
	speed: 0.0419s/iter; left time: 341.9491s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.67s
Steps: 906 | Train Loss: 0.2193276 Vali Loss: 0.0159234 Test Loss: 0.0171577
Validation loss decreased (inf --> 0.015923).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1524664
	speed: 0.0979s/iter; left time: 788.3034s
	iters: 200, epoch: 2 | loss: 0.1471833
	speed: 0.0411s/iter; left time: 326.6227s
	iters: 300, epoch: 2 | loss: 0.1178364
	speed: 0.0409s/iter; left time: 321.1649s
	iters: 400, epoch: 2 | loss: 0.1025365
	speed: 0.0417s/iter; left time: 323.0284s
	iters: 500, epoch: 2 | loss: 0.1178664
	speed: 0.0410s/iter; left time: 313.9844s
	iters: 600, epoch: 2 | loss: 0.1164678
	speed: 0.0410s/iter; left time: 309.9430s
	iters: 700, epoch: 2 | loss: 0.1081067
	speed: 0.0411s/iter; left time: 306.4010s
	iters: 800, epoch: 2 | loss: 0.1138696
	speed: 0.0422s/iter; left time: 310.0353s
	iters: 900, epoch: 2 | loss: 0.1096448
	speed: 0.0423s/iter; left time: 306.6602s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.68s
Steps: 906 | Train Loss: 0.1213882 Vali Loss: 0.0106168 Test Loss: 0.0117372
Validation loss decreased (0.015923 --> 0.010617).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1067631
	speed: 0.1017s/iter; left time: 726.9278s
	iters: 200, epoch: 3 | loss: 0.0951836
	speed: 0.0409s/iter; left time: 288.2038s
	iters: 300, epoch: 3 | loss: 0.0984001
	speed: 0.0410s/iter; left time: 284.8004s
	iters: 400, epoch: 3 | loss: 0.0898459
	speed: 0.0409s/iter; left time: 280.4395s
	iters: 500, epoch: 3 | loss: 0.1085829
	speed: 0.0406s/iter; left time: 274.2096s
	iters: 600, epoch: 3 | loss: 0.1113385
	speed: 0.0406s/iter; left time: 269.7543s
	iters: 700, epoch: 3 | loss: 0.0902102
	speed: 0.0408s/iter; left time: 267.1824s
	iters: 800, epoch: 3 | loss: 0.0938348
	speed: 0.0413s/iter; left time: 266.1449s
	iters: 900, epoch: 3 | loss: 0.0945645
	speed: 0.0407s/iter; left time: 258.6713s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.35s
Steps: 906 | Train Loss: 0.1017762 Vali Loss: 0.0097399 Test Loss: 0.0118244
Validation loss decreased (0.010617 --> 0.009740).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0939657
	speed: 0.1211s/iter; left time: 756.2410s
	iters: 200, epoch: 4 | loss: 0.0882766
	speed: 0.0415s/iter; left time: 254.6917s
	iters: 300, epoch: 4 | loss: 0.0982791
	speed: 0.0415s/iter; left time: 251.0807s
	iters: 400, epoch: 4 | loss: 0.1011343
	speed: 0.0423s/iter; left time: 251.5908s
	iters: 500, epoch: 4 | loss: 0.0886876
	speed: 0.0421s/iter; left time: 245.9089s
	iters: 600, epoch: 4 | loss: 0.1053476
	speed: 0.0412s/iter; left time: 236.5156s
	iters: 700, epoch: 4 | loss: 0.1022160
	speed: 0.0419s/iter; left time: 236.4574s
	iters: 800, epoch: 4 | loss: 0.1016116
	speed: 0.0415s/iter; left time: 229.9223s
	iters: 900, epoch: 4 | loss: 0.1024074
	speed: 0.0415s/iter; left time: 225.9438s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.95s
Steps: 906 | Train Loss: 0.0948879 Vali Loss: 0.0091693 Test Loss: 0.0108764
Validation loss decreased (0.009740 --> 0.009169).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0859901
	speed: 0.0977s/iter; left time: 521.3319s
	iters: 200, epoch: 5 | loss: 0.0802012
	speed: 0.0419s/iter; left time: 219.6377s
	iters: 300, epoch: 5 | loss: 0.0922981
	speed: 0.0415s/iter; left time: 213.0535s
	iters: 400, epoch: 5 | loss: 0.0850021
	speed: 0.0412s/iter; left time: 207.4662s
	iters: 500, epoch: 5 | loss: 0.0914865
	speed: 0.0416s/iter; left time: 205.1606s
	iters: 600, epoch: 5 | loss: 0.0781691
	speed: 0.0411s/iter; left time: 198.9582s
	iters: 700, epoch: 5 | loss: 0.1035452
	speed: 0.0414s/iter; left time: 196.2305s
	iters: 800, epoch: 5 | loss: 0.0874057
	speed: 0.0411s/iter; left time: 190.4587s
	iters: 900, epoch: 5 | loss: 0.0946838
	speed: 0.0407s/iter; left time: 184.6146s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.70s
Steps: 906 | Train Loss: 0.0898690 Vali Loss: 0.0101848 Test Loss: 0.0112890
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0777053
	speed: 0.0809s/iter; left time: 358.5837s
	iters: 200, epoch: 6 | loss: 0.0830942
	speed: 0.0284s/iter; left time: 122.9781s
	iters: 300, epoch: 6 | loss: 0.0984198
	speed: 0.0359s/iter; left time: 151.8389s
	iters: 400, epoch: 6 | loss: 0.0952906
	speed: 0.0341s/iter; left time: 140.9086s
	iters: 500, epoch: 6 | loss: 0.0854248
	speed: 0.0284s/iter; left time: 114.5715s
	iters: 600, epoch: 6 | loss: 0.0935238
	speed: 0.0284s/iter; left time: 111.6021s
	iters: 700, epoch: 6 | loss: 0.0869963
	speed: 0.0284s/iter; left time: 108.9317s
	iters: 800, epoch: 6 | loss: 0.0817814
	speed: 0.0284s/iter; left time: 106.0273s
	iters: 900, epoch: 6 | loss: 0.0914296
	speed: 0.0284s/iter; left time: 103.1880s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:27.25s
Steps: 906 | Train Loss: 0.0859213 Vali Loss: 0.0103888 Test Loss: 0.0133877
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0810883
	speed: 0.0930s/iter; left time: 327.8318s
	iters: 200, epoch: 7 | loss: 0.0840721
	speed: 0.0415s/iter; left time: 141.9881s
	iters: 300, epoch: 7 | loss: 0.0760165
	speed: 0.0411s/iter; left time: 136.7089s
	iters: 400, epoch: 7 | loss: 0.0797312
	speed: 0.0414s/iter; left time: 133.3998s
	iters: 500, epoch: 7 | loss: 0.0769169
	speed: 0.0415s/iter; left time: 129.8118s
	iters: 600, epoch: 7 | loss: 0.0663107
	speed: 0.0411s/iter; left time: 124.3310s
	iters: 700, epoch: 7 | loss: 0.0769300
	speed: 0.0407s/iter; left time: 118.9592s
	iters: 800, epoch: 7 | loss: 0.0851740
	speed: 0.0419s/iter; left time: 118.4615s
	iters: 900, epoch: 7 | loss: 0.0794168
	speed: 0.0416s/iter; left time: 113.2410s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.67s
Steps: 906 | Train Loss: 0.0821731 Vali Loss: 0.0096805 Test Loss: 0.0119052
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010888553224503994, rmse:0.10434822738170624, mae:0.0634869635105133, rse:0.39433926343917847
Original data scale mse:1534866.75, rmse:1238.8973388671875, mae:812.377197265625, rse:0.08706024289131165
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3249058
	speed: 0.0429s/iter; left time: 384.3226s
	iters: 200, epoch: 1 | loss: 0.2643020
	speed: 0.0407s/iter; left time: 360.6692s
	iters: 300, epoch: 1 | loss: 0.2268334
	speed: 0.0412s/iter; left time: 360.7888s
	iters: 400, epoch: 1 | loss: 0.1881913
	speed: 0.0415s/iter; left time: 359.5493s
	iters: 500, epoch: 1 | loss: 0.1727815
	speed: 0.0408s/iter; left time: 349.4728s
	iters: 600, epoch: 1 | loss: 0.1763984
	speed: 0.0418s/iter; left time: 353.4515s
	iters: 700, epoch: 1 | loss: 0.1701801
	speed: 0.0424s/iter; left time: 354.6989s
	iters: 800, epoch: 1 | loss: 0.1725375
	speed: 0.0425s/iter; left time: 350.7218s
	iters: 900, epoch: 1 | loss: 0.1567586
	speed: 0.0423s/iter; left time: 344.8935s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.92s
Steps: 906 | Train Loss: 0.2171405 Vali Loss: 0.0161332 Test Loss: 0.0176991
Validation loss decreased (inf --> 0.016133).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1346782
	speed: 0.0992s/iter; left time: 799.1743s
	iters: 200, epoch: 2 | loss: 0.1427562
	speed: 0.0440s/iter; left time: 349.8737s
	iters: 300, epoch: 2 | loss: 0.1232258
	speed: 0.0448s/iter; left time: 351.7260s
	iters: 400, epoch: 2 | loss: 0.1206460
	speed: 0.0413s/iter; left time: 319.9968s
	iters: 500, epoch: 2 | loss: 0.1229743
	speed: 0.0420s/iter; left time: 321.1400s
	iters: 600, epoch: 2 | loss: 0.0942307
	speed: 0.0413s/iter; left time: 312.3597s
	iters: 700, epoch: 2 | loss: 0.1056243
	speed: 0.0417s/iter; left time: 310.7263s
	iters: 800, epoch: 2 | loss: 0.0898980
	speed: 0.0420s/iter; left time: 308.8767s
	iters: 900, epoch: 2 | loss: 0.0971111
	speed: 0.0415s/iter; left time: 301.2280s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.46s
Steps: 906 | Train Loss: 0.1220734 Vali Loss: 0.0107910 Test Loss: 0.0118928
Validation loss decreased (0.016133 --> 0.010791).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0994909
	speed: 0.1011s/iter; left time: 723.0283s
	iters: 200, epoch: 3 | loss: 0.1011429
	speed: 0.0422s/iter; left time: 297.6204s
	iters: 300, epoch: 3 | loss: 0.1120767
	speed: 0.0424s/iter; left time: 294.3011s
	iters: 400, epoch: 3 | loss: 0.0906715
	speed: 0.0421s/iter; left time: 288.2626s
	iters: 500, epoch: 3 | loss: 0.0948843
	speed: 0.0425s/iter; left time: 286.5540s
	iters: 600, epoch: 3 | loss: 0.0924422
	speed: 0.0424s/iter; left time: 282.0193s
	iters: 700, epoch: 3 | loss: 0.0997984
	speed: 0.0419s/iter; left time: 274.1567s
	iters: 800, epoch: 3 | loss: 0.1009684
	speed: 0.0421s/iter; left time: 271.3685s
	iters: 900, epoch: 3 | loss: 0.1017207
	speed: 0.0422s/iter; left time: 267.7834s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.38s
Steps: 906 | Train Loss: 0.1023464 Vali Loss: 0.0095821 Test Loss: 0.0107349
Validation loss decreased (0.010791 --> 0.009582).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1117368
	speed: 0.1050s/iter; left time: 655.4046s
	iters: 200, epoch: 4 | loss: 0.0998291
	speed: 0.0428s/iter; left time: 262.9923s
	iters: 300, epoch: 4 | loss: 0.1429095
	speed: 0.0424s/iter; left time: 256.0993s
	iters: 400, epoch: 4 | loss: 0.0983246
	speed: 0.0424s/iter; left time: 251.8715s
	iters: 500, epoch: 4 | loss: 0.1017309
	speed: 0.0428s/iter; left time: 249.8884s
	iters: 600, epoch: 4 | loss: 0.0921886
	speed: 0.0422s/iter; left time: 242.1613s
	iters: 700, epoch: 4 | loss: 0.0749214
	speed: 0.0428s/iter; left time: 241.4805s
	iters: 800, epoch: 4 | loss: 0.0893823
	speed: 0.0412s/iter; left time: 228.4818s
	iters: 900, epoch: 4 | loss: 0.0917266
	speed: 0.0421s/iter; left time: 228.9115s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.55s
Steps: 906 | Train Loss: 0.0965951 Vali Loss: 0.0100754 Test Loss: 0.0116149
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0910494
	speed: 0.0948s/iter; left time: 505.8962s
	iters: 200, epoch: 5 | loss: 0.1032694
	speed: 0.0415s/iter; left time: 217.5820s
	iters: 300, epoch: 5 | loss: 0.0915657
	speed: 0.0419s/iter; left time: 215.3326s
	iters: 400, epoch: 5 | loss: 0.0895251
	speed: 0.0423s/iter; left time: 213.2501s
	iters: 500, epoch: 5 | loss: 0.0972055
	speed: 0.0421s/iter; left time: 208.0637s
	iters: 600, epoch: 5 | loss: 0.0843432
	speed: 0.0420s/iter; left time: 203.1072s
	iters: 700, epoch: 5 | loss: 0.1003992
	speed: 0.0419s/iter; left time: 198.3618s
	iters: 800, epoch: 5 | loss: 0.0822892
	speed: 0.0410s/iter; left time: 190.1573s
	iters: 900, epoch: 5 | loss: 0.0875018
	speed: 0.0412s/iter; left time: 186.7643s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.07s
Steps: 906 | Train Loss: 0.0912888 Vali Loss: 0.0095399 Test Loss: 0.0112318
Validation loss decreased (0.009582 --> 0.009540).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0916704
	speed: 0.0987s/iter; left time: 437.2875s
	iters: 200, epoch: 6 | loss: 0.0794364
	speed: 0.0413s/iter; left time: 178.6745s
	iters: 300, epoch: 6 | loss: 0.0904049
	speed: 0.0420s/iter; left time: 177.6642s
	iters: 400, epoch: 6 | loss: 0.0893343
	speed: 0.0416s/iter; left time: 171.6832s
	iters: 500, epoch: 6 | loss: 0.0879736
	speed: 0.0416s/iter; left time: 167.7502s
	iters: 600, epoch: 6 | loss: 0.0845218
	speed: 0.0408s/iter; left time: 160.3519s
	iters: 700, epoch: 6 | loss: 0.0837633
	speed: 0.0420s/iter; left time: 160.7438s
	iters: 800, epoch: 6 | loss: 0.0816363
	speed: 0.0412s/iter; left time: 153.6590s
	iters: 900, epoch: 6 | loss: 0.0853578
	speed: 0.0406s/iter; left time: 147.4023s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.73s
Steps: 906 | Train Loss: 0.0881462 Vali Loss: 0.0098351 Test Loss: 0.0113337
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0776963
	speed: 0.0951s/iter; left time: 335.1890s
	iters: 200, epoch: 7 | loss: 0.0805482
	speed: 0.0417s/iter; left time: 142.9027s
	iters: 300, epoch: 7 | loss: 0.0822162
	speed: 0.0417s/iter; left time: 138.7009s
	iters: 400, epoch: 7 | loss: 0.0841111
	speed: 0.0413s/iter; left time: 133.1032s
	iters: 500, epoch: 7 | loss: 0.0785663
	speed: 0.0413s/iter; left time: 129.0893s
	iters: 600, epoch: 7 | loss: 0.0783009
	speed: 0.0414s/iter; left time: 125.1993s
	iters: 700, epoch: 7 | loss: 0.0904575
	speed: 0.0419s/iter; left time: 122.4429s
	iters: 800, epoch: 7 | loss: 0.0775695
	speed: 0.0412s/iter; left time: 116.5235s
	iters: 900, epoch: 7 | loss: 0.0721560
	speed: 0.0413s/iter; left time: 112.6520s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.88s
Steps: 906 | Train Loss: 0.0841262 Vali Loss: 0.0105104 Test Loss: 0.0121925
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0777827
	speed: 0.0943s/iter; left time: 246.8707s
	iters: 200, epoch: 8 | loss: 0.0705804
	speed: 0.0416s/iter; left time: 104.7503s
	iters: 300, epoch: 8 | loss: 0.0777941
	speed: 0.0419s/iter; left time: 101.4501s
	iters: 400, epoch: 8 | loss: 0.0780481
	speed: 0.0418s/iter; left time: 96.9204s
	iters: 500, epoch: 8 | loss: 0.0863282
	speed: 0.0415s/iter; left time: 92.0732s
	iters: 600, epoch: 8 | loss: 0.0793224
	speed: 0.0420s/iter; left time: 88.9502s
	iters: 700, epoch: 8 | loss: 0.0807142
	speed: 0.0417s/iter; left time: 84.2875s
	iters: 800, epoch: 8 | loss: 0.0704703
	speed: 0.0423s/iter; left time: 81.2521s
	iters: 900, epoch: 8 | loss: 0.0806989
	speed: 0.0421s/iter; left time: 76.5006s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.14s
Steps: 906 | Train Loss: 0.0803950 Vali Loss: 0.0100393 Test Loss: 0.0121175
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011233567260205746, rmse:0.1059885248541832, mae:0.06507769227027893, rse:0.40053799748420715
Original data scale mse:1773736.375, rmse:1331.81689453125, mae:851.7637939453125, rse:0.0935899168252945

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.010888553224503994, RMSE: 0.10434822738170624, MAE: 0.0634869635105133, RSE: 0.39433926343917847
Unscaled Metrics - MSE: 1534866.75, RMSE: 1238.8973388671875, MAE: 812.377197265625, RSE: 0.08706024289131165

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.011233567260205746, RMSE: 0.1059885248541832, MAE: 0.06507769227027893, RSE: 0.40053799748420715
Unscaled Metrics - MSE: 1773736.375, RMSE: 1331.81689453125, MAE: 851.7637939453125, RSE: 0.0935899168252945

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.3093516
	speed: 0.0791s/iter; left time: 707.2536s
	iters: 200, epoch: 1 | loss: 0.2738091
	speed: 0.0475s/iter; left time: 420.1360s
	iters: 300, epoch: 1 | loss: 0.2461182
	speed: 0.0474s/iter; left time: 414.1914s
	iters: 400, epoch: 1 | loss: 0.2357789
	speed: 0.0473s/iter; left time: 408.7942s
	iters: 500, epoch: 1 | loss: 0.2247297
	speed: 0.0472s/iter; left time: 403.0200s
	iters: 600, epoch: 1 | loss: 0.2151177
	speed: 0.0472s/iter; left time: 398.5754s
	iters: 700, epoch: 1 | loss: 0.2076221
	speed: 0.0473s/iter; left time: 394.3565s
	iters: 800, epoch: 1 | loss: 0.2049244
	speed: 0.0470s/iter; left time: 387.1357s
	iters: 900, epoch: 1 | loss: 0.2059878
	speed: 0.0472s/iter; left time: 384.4090s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.65s
Steps: 904 | Train Loss: 0.2443136 Vali Loss: 0.0333227 Test Loss: 0.0384182
Validation loss decreased (inf --> 0.033323).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1822715
	speed: 0.1152s/iter; left time: 926.2195s
	iters: 200, epoch: 2 | loss: 0.1671452
	speed: 0.0474s/iter; left time: 376.0191s
	iters: 300, epoch: 2 | loss: 0.1565934
	speed: 0.0474s/iter; left time: 371.1391s
	iters: 400, epoch: 2 | loss: 0.1451148
	speed: 0.0471s/iter; left time: 364.3411s
	iters: 500, epoch: 2 | loss: 0.1437272
	speed: 0.0472s/iter; left time: 360.7014s
	iters: 600, epoch: 2 | loss: 0.1491941
	speed: 0.0473s/iter; left time: 356.6832s
	iters: 700, epoch: 2 | loss: 0.1374314
	speed: 0.0473s/iter; left time: 351.9057s
	iters: 800, epoch: 2 | loss: 0.1391107
	speed: 0.0473s/iter; left time: 347.0267s
	iters: 900, epoch: 2 | loss: 0.1286135
	speed: 0.0473s/iter; left time: 342.1513s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.01s
Steps: 904 | Train Loss: 0.1541158 Vali Loss: 0.0181501 Test Loss: 0.0187154
Validation loss decreased (0.033323 --> 0.018150).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1340026
	speed: 0.1231s/iter; left time: 877.9084s
	iters: 200, epoch: 3 | loss: 0.1307715
	speed: 0.0474s/iter; left time: 333.6583s
	iters: 300, epoch: 3 | loss: 0.1367581
	speed: 0.0475s/iter; left time: 329.4653s
	iters: 400, epoch: 3 | loss: 0.1319982
	speed: 0.0474s/iter; left time: 323.8161s
	iters: 500, epoch: 3 | loss: 0.1290497
	speed: 0.0473s/iter; left time: 318.5530s
	iters: 600, epoch: 3 | loss: 0.1244611
	speed: 0.0473s/iter; left time: 314.0446s
	iters: 700, epoch: 3 | loss: 0.1183973
	speed: 0.0475s/iter; left time: 310.1993s
	iters: 800, epoch: 3 | loss: 0.1375077
	speed: 0.0475s/iter; left time: 305.4937s
	iters: 900, epoch: 3 | loss: 0.1373645
	speed: 0.0477s/iter; left time: 301.7991s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.14s
Steps: 904 | Train Loss: 0.1296189 Vali Loss: 0.0169026 Test Loss: 0.0189925
Validation loss decreased (0.018150 --> 0.016903).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1206669
	speed: 0.1193s/iter; left time: 743.0393s
	iters: 200, epoch: 4 | loss: 0.1230979
	speed: 0.0504s/iter; left time: 309.1026s
	iters: 300, epoch: 4 | loss: 0.1206558
	speed: 0.0505s/iter; left time: 304.4835s
	iters: 400, epoch: 4 | loss: 0.1287496
	speed: 0.0504s/iter; left time: 299.0186s
	iters: 500, epoch: 4 | loss: 0.1311547
	speed: 0.0505s/iter; left time: 294.1444s
	iters: 600, epoch: 4 | loss: 0.1281368
	speed: 0.0505s/iter; left time: 289.2386s
	iters: 700, epoch: 4 | loss: 0.1205751
	speed: 0.0475s/iter; left time: 267.5811s
	iters: 800, epoch: 4 | loss: 0.1238125
	speed: 0.0469s/iter; left time: 259.3429s
	iters: 900, epoch: 4 | loss: 0.1135014
	speed: 0.0473s/iter; left time: 256.9885s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:44.88s
Steps: 904 | Train Loss: 0.1227720 Vali Loss: 0.0161618 Test Loss: 0.0187646
Validation loss decreased (0.016903 --> 0.016162).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1118904
	speed: 0.1154s/iter; left time: 614.6522s
	iters: 200, epoch: 5 | loss: 0.1183519
	speed: 0.0473s/iter; left time: 247.1001s
	iters: 300, epoch: 5 | loss: 0.1187731
	speed: 0.0472s/iter; left time: 242.0070s
	iters: 400, epoch: 5 | loss: 0.1281916
	speed: 0.0466s/iter; left time: 234.1237s
	iters: 500, epoch: 5 | loss: 0.1133893
	speed: 0.0409s/iter; left time: 201.5333s
	iters: 600, epoch: 5 | loss: 0.1150367
	speed: 0.0354s/iter; left time: 170.8016s
	iters: 700, epoch: 5 | loss: 0.1234257
	speed: 0.0354s/iter; left time: 167.3867s
	iters: 800, epoch: 5 | loss: 0.1167801
	speed: 0.0354s/iter; left time: 163.6354s
	iters: 900, epoch: 5 | loss: 0.1119384
	speed: 0.0353s/iter; left time: 159.8321s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.41s
Steps: 904 | Train Loss: 0.1166390 Vali Loss: 0.0180569 Test Loss: 0.0201445
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0955252
	speed: 0.1115s/iter; left time: 492.8507s
	iters: 200, epoch: 6 | loss: 0.1180441
	speed: 0.0473s/iter; left time: 204.3640s
	iters: 300, epoch: 6 | loss: 0.1125253
	speed: 0.0470s/iter; left time: 198.5857s
	iters: 400, epoch: 6 | loss: 0.1174403
	speed: 0.0474s/iter; left time: 195.1706s
	iters: 500, epoch: 6 | loss: 0.1112897
	speed: 0.0472s/iter; left time: 189.6462s
	iters: 600, epoch: 6 | loss: 0.1109653
	speed: 0.0472s/iter; left time: 185.0726s
	iters: 700, epoch: 6 | loss: 0.0987567
	speed: 0.0470s/iter; left time: 179.4818s
	iters: 800, epoch: 6 | loss: 0.1128278
	speed: 0.0470s/iter; left time: 175.0519s
	iters: 900, epoch: 6 | loss: 0.1145909
	speed: 0.0463s/iter; left time: 167.7519s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.76s
Steps: 904 | Train Loss: 0.1111408 Vali Loss: 0.0182058 Test Loss: 0.0206058
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1026105
	speed: 0.1121s/iter; left time: 394.2949s
	iters: 200, epoch: 7 | loss: 0.1005317
	speed: 0.0474s/iter; left time: 161.8218s
	iters: 300, epoch: 7 | loss: 0.1091398
	speed: 0.0473s/iter; left time: 156.8418s
	iters: 400, epoch: 7 | loss: 0.1002923
	speed: 0.0472s/iter; left time: 151.7066s
	iters: 500, epoch: 7 | loss: 0.1028722
	speed: 0.0474s/iter; left time: 147.8414s
	iters: 600, epoch: 7 | loss: 0.1124648
	speed: 0.0472s/iter; left time: 142.4139s
	iters: 700, epoch: 7 | loss: 0.0987508
	speed: 0.0472s/iter; left time: 137.5483s
	iters: 800, epoch: 7 | loss: 0.0898055
	speed: 0.0473s/iter; left time: 133.3129s
	iters: 900, epoch: 7 | loss: 0.1027407
	speed: 0.0470s/iter; left time: 127.8326s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.94s
Steps: 904 | Train Loss: 0.1049334 Vali Loss: 0.0180185 Test Loss: 0.0222405
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01876760646700859, rmse:0.13699491322040558, mae:0.08846016228199005, rse:0.5179925560951233
Original data scale mse:3390077.0, rmse:1841.2161865234375, mae:1212.3902587890625, rse:0.12957391142845154
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.3128209
	speed: 0.0494s/iter; left time: 441.3614s
	iters: 200, epoch: 1 | loss: 0.2955156
	speed: 0.0476s/iter; left time: 420.9630s
	iters: 300, epoch: 1 | loss: 0.2620749
	speed: 0.0477s/iter; left time: 417.1716s
	iters: 400, epoch: 1 | loss: 0.2516717
	speed: 0.0476s/iter; left time: 411.4821s
	iters: 500, epoch: 1 | loss: 0.2320990
	speed: 0.0477s/iter; left time: 407.6792s
	iters: 600, epoch: 1 | loss: 0.2213243
	speed: 0.0476s/iter; left time: 401.7715s
	iters: 700, epoch: 1 | loss: 0.2081433
	speed: 0.0466s/iter; left time: 389.0156s
	iters: 800, epoch: 1 | loss: 0.1962108
	speed: 0.0476s/iter; left time: 392.1444s
	iters: 900, epoch: 1 | loss: 0.1879538
	speed: 0.0474s/iter; left time: 385.4928s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.19s
Steps: 904 | Train Loss: 0.2476883 Vali Loss: 0.0290575 Test Loss: 0.0331817
Validation loss decreased (inf --> 0.029058).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1764619
	speed: 0.1160s/iter; left time: 932.3588s
	iters: 200, epoch: 2 | loss: 0.1683673
	speed: 0.0470s/iter; left time: 373.2908s
	iters: 300, epoch: 2 | loss: 0.1619842
	speed: 0.0472s/iter; left time: 369.8399s
	iters: 400, epoch: 2 | loss: 0.1518464
	speed: 0.0473s/iter; left time: 366.2454s
	iters: 500, epoch: 2 | loss: 0.1466087
	speed: 0.0471s/iter; left time: 359.6874s
	iters: 600, epoch: 2 | loss: 0.1508116
	speed: 0.0468s/iter; left time: 352.9120s
	iters: 700, epoch: 2 | loss: 0.1465930
	speed: 0.0471s/iter; left time: 350.5781s
	iters: 800, epoch: 2 | loss: 0.1357613
	speed: 0.0472s/iter; left time: 346.4459s
	iters: 900, epoch: 2 | loss: 0.1240935
	speed: 0.0469s/iter; left time: 339.6863s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.86s
Steps: 904 | Train Loss: 0.1536848 Vali Loss: 0.0179040 Test Loss: 0.0197165
Validation loss decreased (0.029058 --> 0.017904).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1294200
	speed: 0.1192s/iter; left time: 849.9884s
	iters: 200, epoch: 3 | loss: 0.1286483
	speed: 0.0478s/iter; left time: 336.0429s
	iters: 300, epoch: 3 | loss: 0.1275968
	speed: 0.0474s/iter; left time: 328.7727s
	iters: 400, epoch: 3 | loss: 0.1349039
	speed: 0.0479s/iter; left time: 327.1305s
	iters: 500, epoch: 3 | loss: 0.1299272
	speed: 0.0478s/iter; left time: 321.7381s
	iters: 600, epoch: 3 | loss: 0.1388921
	speed: 0.0476s/iter; left time: 315.8851s
	iters: 700, epoch: 3 | loss: 0.1323673
	speed: 0.0477s/iter; left time: 311.5752s
	iters: 800, epoch: 3 | loss: 0.1230982
	speed: 0.0478s/iter; left time: 307.5521s
	iters: 900, epoch: 3 | loss: 0.1216354
	speed: 0.0463s/iter; left time: 293.5233s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.25s
Steps: 904 | Train Loss: 0.1304383 Vali Loss: 0.0174966 Test Loss: 0.0184413
Validation loss decreased (0.017904 --> 0.017497).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1273170
	speed: 0.1157s/iter; left time: 720.9661s
	iters: 200, epoch: 4 | loss: 0.1274066
	speed: 0.0473s/iter; left time: 290.0291s
	iters: 300, epoch: 4 | loss: 0.1370937
	speed: 0.0475s/iter; left time: 286.5481s
	iters: 400, epoch: 4 | loss: 0.1244887
	speed: 0.0475s/iter; left time: 281.7104s
	iters: 500, epoch: 4 | loss: 0.1210962
	speed: 0.0470s/iter; left time: 274.1290s
	iters: 600, epoch: 4 | loss: 0.1220659
	speed: 0.0472s/iter; left time: 270.5318s
	iters: 700, epoch: 4 | loss: 0.1266540
	speed: 0.0475s/iter; left time: 267.6302s
	iters: 800, epoch: 4 | loss: 0.1187862
	speed: 0.0474s/iter; left time: 262.2091s
	iters: 900, epoch: 4 | loss: 0.1119336
	speed: 0.0472s/iter; left time: 256.3160s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.02s
Steps: 904 | Train Loss: 0.1242702 Vali Loss: 0.0162720 Test Loss: 0.0183281
Validation loss decreased (0.017497 --> 0.016272).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1207941
	speed: 0.1168s/iter; left time: 621.8121s
	iters: 200, epoch: 5 | loss: 0.1195423
	speed: 0.0474s/iter; left time: 247.7547s
	iters: 300, epoch: 5 | loss: 0.1203133
	speed: 0.0473s/iter; left time: 242.5092s
	iters: 400, epoch: 5 | loss: 0.1215813
	speed: 0.0474s/iter; left time: 238.3320s
	iters: 500, epoch: 5 | loss: 0.1187193
	speed: 0.0476s/iter; left time: 234.4606s
	iters: 600, epoch: 5 | loss: 0.1240349
	speed: 0.0477s/iter; left time: 230.1495s
	iters: 700, epoch: 5 | loss: 0.1272121
	speed: 0.0456s/iter; left time: 215.2866s
	iters: 800, epoch: 5 | loss: 0.1198318
	speed: 0.0474s/iter; left time: 219.2031s
	iters: 900, epoch: 5 | loss: 0.1121756
	speed: 0.0474s/iter; left time: 214.6565s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.98s
Steps: 904 | Train Loss: 0.1187592 Vali Loss: 0.0167673 Test Loss: 0.0185229
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1198316
	speed: 0.1121s/iter; left time: 495.4451s
	iters: 200, epoch: 6 | loss: 0.1141960
	speed: 0.0472s/iter; left time: 203.8468s
	iters: 300, epoch: 6 | loss: 0.1226976
	speed: 0.0474s/iter; left time: 200.1406s
	iters: 400, epoch: 6 | loss: 0.1084806
	speed: 0.0473s/iter; left time: 194.8309s
	iters: 500, epoch: 6 | loss: 0.1220213
	speed: 0.0473s/iter; left time: 190.0457s
	iters: 600, epoch: 6 | loss: 0.1114138
	speed: 0.0474s/iter; left time: 185.9047s
	iters: 700, epoch: 6 | loss: 0.1136626
	speed: 0.0459s/iter; left time: 175.2370s
	iters: 800, epoch: 6 | loss: 0.1129887
	speed: 0.0473s/iter; left time: 175.9469s
	iters: 900, epoch: 6 | loss: 0.1044783
	speed: 0.0475s/iter; left time: 172.0149s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.88s
Steps: 904 | Train Loss: 0.1139844 Vali Loss: 0.0173552 Test Loss: 0.0193293
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1130000
	speed: 0.1127s/iter; left time: 396.5220s
	iters: 200, epoch: 7 | loss: 0.1024909
	speed: 0.0471s/iter; left time: 160.8255s
	iters: 300, epoch: 7 | loss: 0.1091288
	speed: 0.0475s/iter; left time: 157.6906s
	iters: 400, epoch: 7 | loss: 0.1049215
	speed: 0.0474s/iter; left time: 152.5315s
	iters: 500, epoch: 7 | loss: 0.1069582
	speed: 0.0470s/iter; left time: 146.3583s
	iters: 600, epoch: 7 | loss: 0.1061765
	speed: 0.0470s/iter; left time: 141.8038s
	iters: 700, epoch: 7 | loss: 0.1013205
	speed: 0.0477s/iter; left time: 139.0143s
	iters: 800, epoch: 7 | loss: 0.1089787
	speed: 0.0476s/iter; left time: 134.1126s
	iters: 900, epoch: 7 | loss: 0.1058136
	speed: 0.0477s/iter; left time: 129.6591s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.06s
Steps: 904 | Train Loss: 0.1079938 Vali Loss: 0.0177931 Test Loss: 0.0200110
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018318794667720795, rmse:0.13534694910049438, mae:0.08790011703968048, rse:0.5117613673210144
Original data scale mse:3278264.25, rmse:1810.5977783203125, mae:1197.8482666015625, rse:0.12741915881633759

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.01876760646700859, RMSE: 0.13699491322040558, MAE: 0.08846016228199005, RSE: 0.5179925560951233
Unscaled Metrics - MSE: 3390077.0, RMSE: 1841.2161865234375, MAE: 1212.3902587890625, RSE: 0.12957391142845154

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.018318794667720795, RMSE: 0.13534694910049438, MAE: 0.08790011703968048, RSE: 0.5117613673210144
Unscaled Metrics - MSE: 3278264.25, RMSE: 1810.5977783203125, MAE: 1197.8482666015625, RSE: 0.12741915881633759

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.3112887
	speed: 0.0825s/iter; left time: 735.6923s
	iters: 200, epoch: 1 | loss: 0.2701333
	speed: 0.0537s/iter; left time: 474.0526s
	iters: 300, epoch: 1 | loss: 0.2705595
	speed: 0.0537s/iter; left time: 468.4028s
	iters: 400, epoch: 1 | loss: 0.2516117
	speed: 0.0535s/iter; left time: 461.6536s
	iters: 500, epoch: 1 | loss: 0.2469053
	speed: 0.0536s/iter; left time: 456.6427s
	iters: 600, epoch: 1 | loss: 0.2417244
	speed: 0.0537s/iter; left time: 451.8177s
	iters: 700, epoch: 1 | loss: 0.2345901
	speed: 0.0536s/iter; left time: 445.6770s
	iters: 800, epoch: 1 | loss: 0.2377720
	speed: 0.0532s/iter; left time: 437.3073s
	iters: 900, epoch: 1 | loss: 0.2321623
	speed: 0.0536s/iter; left time: 434.9974s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.06s
Steps: 902 | Train Loss: 0.2595995 Vali Loss: 0.0446152 Test Loss: 0.0519481
Validation loss decreased (inf --> 0.044615).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2095231
	speed: 0.1338s/iter; left time: 1073.1568s
	iters: 200, epoch: 2 | loss: 0.1930412
	speed: 0.0532s/iter; left time: 421.6841s
	iters: 300, epoch: 2 | loss: 0.1828628
	speed: 0.0529s/iter; left time: 413.9831s
	iters: 400, epoch: 2 | loss: 0.1591913
	speed: 0.0532s/iter; left time: 410.8479s
	iters: 500, epoch: 2 | loss: 0.1478090
	speed: 0.0532s/iter; left time: 405.5744s
	iters: 600, epoch: 2 | loss: 0.1490079
	speed: 0.0537s/iter; left time: 403.5480s
	iters: 700, epoch: 2 | loss: 0.1323661
	speed: 0.0519s/iter; left time: 385.0773s
	iters: 800, epoch: 2 | loss: 0.1343427
	speed: 0.0426s/iter; left time: 311.8499s
	iters: 900, epoch: 2 | loss: 0.1348851
	speed: 0.0426s/iter; left time: 307.7877s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.00s
Steps: 902 | Train Loss: 0.1666839 Vali Loss: 0.0195425 Test Loss: 0.0213045
Validation loss decreased (0.044615 --> 0.019543).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1338077
	speed: 0.1328s/iter; left time: 944.8767s
	iters: 200, epoch: 3 | loss: 0.1401786
	speed: 0.0538s/iter; left time: 377.2157s
	iters: 300, epoch: 3 | loss: 0.1417433
	speed: 0.0537s/iter; left time: 371.6811s
	iters: 400, epoch: 3 | loss: 0.1445573
	speed: 0.0536s/iter; left time: 365.6255s
	iters: 500, epoch: 3 | loss: 0.1437448
	speed: 0.0536s/iter; left time: 359.8686s
	iters: 600, epoch: 3 | loss: 0.1327194
	speed: 0.0499s/iter; left time: 330.3635s
	iters: 700, epoch: 3 | loss: 0.1307158
	speed: 0.0532s/iter; left time: 346.8615s
	iters: 800, epoch: 3 | loss: 0.1380625
	speed: 0.0536s/iter; left time: 343.7401s
	iters: 900, epoch: 3 | loss: 0.1341755
	speed: 0.0538s/iter; left time: 339.7082s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.23s
Steps: 902 | Train Loss: 0.1367471 Vali Loss: 0.0188825 Test Loss: 0.0199922
Validation loss decreased (0.019543 --> 0.018882).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1325566
	speed: 0.1370s/iter; left time: 851.7444s
	iters: 200, epoch: 4 | loss: 0.1291571
	speed: 0.0532s/iter; left time: 325.5793s
	iters: 300, epoch: 4 | loss: 0.1449718
	speed: 0.0536s/iter; left time: 322.1288s
	iters: 400, epoch: 4 | loss: 0.1253113
	speed: 0.0535s/iter; left time: 316.4423s
	iters: 500, epoch: 4 | loss: 0.1236327
	speed: 0.0533s/iter; left time: 309.8147s
	iters: 600, epoch: 4 | loss: 0.1235445
	speed: 0.0535s/iter; left time: 305.7284s
	iters: 700, epoch: 4 | loss: 0.1320168
	speed: 0.0533s/iter; left time: 299.2516s
	iters: 800, epoch: 4 | loss: 0.1361436
	speed: 0.0537s/iter; left time: 295.8888s
	iters: 900, epoch: 4 | loss: 0.1281451
	speed: 0.0536s/iter; left time: 290.1657s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.1295634 Vali Loss: 0.0176831 Test Loss: 0.0205406
Validation loss decreased (0.018882 --> 0.017683).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1150929
	speed: 0.1321s/iter; left time: 702.0196s
	iters: 200, epoch: 5 | loss: 0.1167147
	speed: 0.0533s/iter; left time: 278.0462s
	iters: 300, epoch: 5 | loss: 0.1266226
	speed: 0.0537s/iter; left time: 274.3381s
	iters: 400, epoch: 5 | loss: 0.1278830
	speed: 0.0534s/iter; left time: 267.6566s
	iters: 500, epoch: 5 | loss: 0.1277956
	speed: 0.0534s/iter; left time: 262.2331s
	iters: 600, epoch: 5 | loss: 0.1261985
	speed: 0.0534s/iter; left time: 257.1861s
	iters: 700, epoch: 5 | loss: 0.1258485
	speed: 0.0534s/iter; left time: 251.4575s
	iters: 800, epoch: 5 | loss: 0.1196405
	speed: 0.0533s/iter; left time: 245.7857s
	iters: 900, epoch: 5 | loss: 0.1235818
	speed: 0.0537s/iter; left time: 242.3290s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.44s
Steps: 902 | Train Loss: 0.1232680 Vali Loss: 0.0182817 Test Loss: 0.0220861
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1156967
	speed: 0.1298s/iter; left time: 572.3652s
	iters: 200, epoch: 6 | loss: 0.1169142
	speed: 0.0532s/iter; left time: 229.4148s
	iters: 300, epoch: 6 | loss: 0.1136387
	speed: 0.0536s/iter; left time: 225.6471s
	iters: 400, epoch: 6 | loss: 0.1170498
	speed: 0.0534s/iter; left time: 219.5016s
	iters: 500, epoch: 6 | loss: 0.1119323
	speed: 0.0534s/iter; left time: 214.2342s
	iters: 600, epoch: 6 | loss: 0.1116978
	speed: 0.0538s/iter; left time: 210.4088s
	iters: 700, epoch: 6 | loss: 0.1114990
	speed: 0.0537s/iter; left time: 204.6228s
	iters: 800, epoch: 6 | loss: 0.1117063
	speed: 0.0534s/iter; left time: 198.1729s
	iters: 900, epoch: 6 | loss: 0.1119812
	speed: 0.0534s/iter; left time: 192.8020s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.1164972 Vali Loss: 0.0206008 Test Loss: 0.0228311
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1143144
	speed: 0.1285s/iter; left time: 451.0081s
	iters: 200, epoch: 7 | loss: 0.1144165
	speed: 0.0531s/iter; left time: 181.1541s
	iters: 300, epoch: 7 | loss: 0.1029689
	speed: 0.0535s/iter; left time: 176.9808s
	iters: 400, epoch: 7 | loss: 0.1095792
	speed: 0.0534s/iter; left time: 171.2356s
	iters: 500, epoch: 7 | loss: 0.1093956
	speed: 0.0534s/iter; left time: 166.0192s
	iters: 600, epoch: 7 | loss: 0.1144555
	speed: 0.0533s/iter; left time: 160.4881s
	iters: 700, epoch: 7 | loss: 0.1100785
	speed: 0.0531s/iter; left time: 154.4243s
	iters: 800, epoch: 7 | loss: 0.1042493
	speed: 0.0534s/iter; left time: 149.9875s
	iters: 900, epoch: 7 | loss: 0.1019507
	speed: 0.0530s/iter; left time: 143.5090s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.23s
Steps: 902 | Train Loss: 0.1097639 Vali Loss: 0.0205848 Test Loss: 0.0239609
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020536771044135094, rmse:0.14330656826496124, mae:0.09462139755487442, rse:0.5422319769859314
Original data scale mse:4204012.5, rmse:2050.368896484375, mae:1340.250732421875, rse:0.1444283425807953
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2946924
	speed: 0.0552s/iter; left time: 492.7706s
	iters: 200, epoch: 1 | loss: 0.2727692
	speed: 0.0538s/iter; left time: 474.4335s
	iters: 300, epoch: 1 | loss: 0.2474688
	speed: 0.0538s/iter; left time: 469.5520s
	iters: 400, epoch: 1 | loss: 0.2492456
	speed: 0.0536s/iter; left time: 461.9037s
	iters: 500, epoch: 1 | loss: 0.2408135
	speed: 0.0535s/iter; left time: 456.0903s
	iters: 600, epoch: 1 | loss: 0.2271375
	speed: 0.0537s/iter; left time: 451.8885s
	iters: 700, epoch: 1 | loss: 0.2273930
	speed: 0.0536s/iter; left time: 445.9574s
	iters: 800, epoch: 1 | loss: 0.2224111
	speed: 0.0536s/iter; left time: 440.9934s
	iters: 900, epoch: 1 | loss: 0.2213976
	speed: 0.0536s/iter; left time: 435.1031s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.63s
Steps: 902 | Train Loss: 0.2528524 Vali Loss: 0.0405547 Test Loss: 0.0472158
Validation loss decreased (inf --> 0.040555).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2126475
	speed: 0.1354s/iter; left time: 1085.9551s
	iters: 200, epoch: 2 | loss: 0.1908140
	speed: 0.0536s/iter; left time: 424.4064s
	iters: 300, epoch: 2 | loss: 0.1739328
	speed: 0.0536s/iter; left time: 419.4592s
	iters: 400, epoch: 2 | loss: 0.1522334
	speed: 0.0536s/iter; left time: 413.8778s
	iters: 500, epoch: 2 | loss: 0.1636279
	speed: 0.0537s/iter; left time: 409.2218s
	iters: 600, epoch: 2 | loss: 0.1378988
	speed: 0.0536s/iter; left time: 403.0689s
	iters: 700, epoch: 2 | loss: 0.1439680
	speed: 0.0535s/iter; left time: 397.2218s
	iters: 800, epoch: 2 | loss: 0.1361979
	speed: 0.0536s/iter; left time: 391.9755s
	iters: 900, epoch: 2 | loss: 0.1441313
	speed: 0.0536s/iter; left time: 386.9012s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.58s
Steps: 902 | Train Loss: 0.1653762 Vali Loss: 0.0199595 Test Loss: 0.0222983
Validation loss decreased (0.040555 --> 0.019959).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1493491
	speed: 0.1381s/iter; left time: 982.8557s
	iters: 200, epoch: 3 | loss: 0.1346568
	speed: 0.0536s/iter; left time: 375.8053s
	iters: 300, epoch: 3 | loss: 0.1362912
	speed: 0.0535s/iter; left time: 370.3832s
	iters: 400, epoch: 3 | loss: 0.1394345
	speed: 0.0537s/iter; left time: 365.8996s
	iters: 500, epoch: 3 | loss: 0.1331303
	speed: 0.0536s/iter; left time: 360.3122s
	iters: 600, epoch: 3 | loss: 0.1393345
	speed: 0.0536s/iter; left time: 354.4942s
	iters: 700, epoch: 3 | loss: 0.1299409
	speed: 0.0538s/iter; left time: 350.7849s
	iters: 800, epoch: 3 | loss: 0.1384254
	speed: 0.0536s/iter; left time: 343.6746s
	iters: 900, epoch: 3 | loss: 0.1396079
	speed: 0.0537s/iter; left time: 339.1172s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.61s
Steps: 902 | Train Loss: 0.1366752 Vali Loss: 0.0187700 Test Loss: 0.0201410
Validation loss decreased (0.019959 --> 0.018770).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1338240
	speed: 0.1717s/iter; left time: 1067.1219s
	iters: 200, epoch: 4 | loss: 0.1282149
	speed: 0.0536s/iter; left time: 327.9180s
	iters: 300, epoch: 4 | loss: 0.1255529
	speed: 0.0537s/iter; left time: 322.7052s
	iters: 400, epoch: 4 | loss: 0.1347245
	speed: 0.0536s/iter; left time: 317.0174s
	iters: 500, epoch: 4 | loss: 0.1311705
	speed: 0.0537s/iter; left time: 312.0740s
	iters: 600, epoch: 4 | loss: 0.1248666
	speed: 0.0536s/iter; left time: 306.5678s
	iters: 700, epoch: 4 | loss: 0.1231481
	speed: 0.0537s/iter; left time: 301.4458s
	iters: 800, epoch: 4 | loss: 0.1336111
	speed: 0.0537s/iter; left time: 296.3403s
	iters: 900, epoch: 4 | loss: 0.1212290
	speed: 0.0537s/iter; left time: 290.5375s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.65s
Steps: 902 | Train Loss: 0.1292714 Vali Loss: 0.0177111 Test Loss: 0.0204296
Validation loss decreased (0.018770 --> 0.017711).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1234529
	speed: 0.1352s/iter; left time: 718.3571s
	iters: 200, epoch: 5 | loss: 0.1218383
	speed: 0.0529s/iter; left time: 275.9253s
	iters: 300, epoch: 5 | loss: 0.1262273
	speed: 0.0535s/iter; left time: 273.3354s
	iters: 400, epoch: 5 | loss: 0.1278754
	speed: 0.0538s/iter; left time: 269.6483s
	iters: 500, epoch: 5 | loss: 0.1240764
	speed: 0.0536s/iter; left time: 263.2243s
	iters: 600, epoch: 5 | loss: 0.1216050
	speed: 0.0535s/iter; left time: 257.3236s
	iters: 700, epoch: 5 | loss: 0.1151582
	speed: 0.0536s/iter; left time: 252.6482s
	iters: 800, epoch: 5 | loss: 0.1192179
	speed: 0.0536s/iter; left time: 247.4831s
	iters: 900, epoch: 5 | loss: 0.1187990
	speed: 0.0536s/iter; left time: 241.7311s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.1222272 Vali Loss: 0.0192881 Test Loss: 0.0205918
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1269725
	speed: 0.1299s/iter; left time: 573.1448s
	iters: 200, epoch: 6 | loss: 0.1139024
	speed: 0.0537s/iter; left time: 231.3023s
	iters: 300, epoch: 6 | loss: 0.1152724
	speed: 0.0532s/iter; left time: 224.1063s
	iters: 400, epoch: 6 | loss: 0.1153143
	speed: 0.0534s/iter; left time: 219.5725s
	iters: 500, epoch: 6 | loss: 0.1218429
	speed: 0.0535s/iter; left time: 214.4162s
	iters: 600, epoch: 6 | loss: 0.1179661
	speed: 0.0534s/iter; left time: 208.8307s
	iters: 700, epoch: 6 | loss: 0.1186708
	speed: 0.0534s/iter; left time: 203.4186s
	iters: 800, epoch: 6 | loss: 0.1072247
	speed: 0.0534s/iter; left time: 198.3054s
	iters: 900, epoch: 6 | loss: 0.1118134
	speed: 0.0542s/iter; left time: 195.5985s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.50s
Steps: 902 | Train Loss: 0.1156325 Vali Loss: 0.0195381 Test Loss: 0.0220591
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1112536
	speed: 0.1306s/iter; left time: 458.4017s
	iters: 200, epoch: 7 | loss: 0.1043497
	speed: 0.0535s/iter; left time: 182.5304s
	iters: 300, epoch: 7 | loss: 0.1131319
	speed: 0.0539s/iter; left time: 178.2385s
	iters: 400, epoch: 7 | loss: 0.1199129
	speed: 0.0536s/iter; left time: 172.0274s
	iters: 500, epoch: 7 | loss: 0.1025044
	speed: 0.0534s/iter; left time: 165.9288s
	iters: 600, epoch: 7 | loss: 0.1039046
	speed: 0.0536s/iter; left time: 161.1780s
	iters: 700, epoch: 7 | loss: 0.1046316
	speed: 0.0537s/iter; left time: 156.1181s
	iters: 800, epoch: 7 | loss: 0.1025476
	speed: 0.0536s/iter; left time: 150.6755s
	iters: 900, epoch: 7 | loss: 0.1025557
	speed: 0.0536s/iter; left time: 145.1751s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.1081127 Vali Loss: 0.0209927 Test Loss: 0.0224661
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02042943425476551, rmse:0.14293156564235687, mae:0.09454325586557388, rse:0.5408130884170532
Original data scale mse:4257367.0, rmse:2063.3388671875, mae:1350.48828125, rse:0.1453419327735901

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.020536771044135094, RMSE: 0.14330656826496124, MAE: 0.09462139755487442, RSE: 0.5422319769859314
Unscaled Metrics - MSE: 4204012.5, RMSE: 2050.368896484375, MAE: 1340.250732421875, RSE: 0.1444283425807953

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.02042943425476551, RMSE: 0.14293156564235687, MAE: 0.09454325586557388, RSE: 0.5408130884170532
Unscaled Metrics - MSE: 4257367.0, RMSE: 2063.3388671875, MAE: 1350.48828125, RSE: 0.1453419327735901

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2368102
	speed: 0.0712s/iter; left time: 638.0534s
	iters: 200, epoch: 1 | loss: 0.1976145
	speed: 0.0417s/iter; left time: 369.5399s
	iters: 300, epoch: 1 | loss: 0.1820158
	speed: 0.0417s/iter; left time: 365.1668s
	iters: 400, epoch: 1 | loss: 0.1763024
	speed: 0.0417s/iter; left time: 360.8912s
	iters: 500, epoch: 1 | loss: 0.1667152
	speed: 0.0414s/iter; left time: 354.6597s
	iters: 600, epoch: 1 | loss: 0.1668866
	speed: 0.0414s/iter; left time: 349.9806s
	iters: 700, epoch: 1 | loss: 0.1545057
	speed: 0.0415s/iter; left time: 346.8767s
	iters: 800, epoch: 1 | loss: 0.1634929
	speed: 0.0416s/iter; left time: 344.0347s
	iters: 900, epoch: 1 | loss: 0.1671590
	speed: 0.0411s/iter; left time: 335.2099s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.36s
Steps: 906 | Train Loss: 0.1831342 Vali Loss: 0.1416364 Test Loss: 0.1593144
Validation loss decreased (inf --> 0.141636).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1567799
	speed: 0.0980s/iter; left time: 789.3895s
	iters: 200, epoch: 2 | loss: 0.1347314
	speed: 0.0419s/iter; left time: 333.3247s
	iters: 300, epoch: 2 | loss: 0.0954429
	speed: 0.0415s/iter; left time: 325.9367s
	iters: 400, epoch: 2 | loss: 0.0659710
	speed: 0.0411s/iter; left time: 318.8248s
	iters: 500, epoch: 2 | loss: 0.0784877
	speed: 0.0419s/iter; left time: 320.5171s
	iters: 600, epoch: 2 | loss: 0.0708326
	speed: 0.0409s/iter; left time: 308.9285s
	iters: 700, epoch: 2 | loss: 0.0691726
	speed: 0.0418s/iter; left time: 311.4909s
	iters: 800, epoch: 2 | loss: 0.0743973
	speed: 0.0416s/iter; left time: 306.1699s
	iters: 900, epoch: 2 | loss: 0.0698419
	speed: 0.0413s/iter; left time: 299.8172s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.80s
Steps: 906 | Train Loss: 0.0935563 Vali Loss: 0.0675837 Test Loss: 0.0692845
Validation loss decreased (0.141636 --> 0.067584).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0667837
	speed: 0.0969s/iter; left time: 692.7236s
	iters: 200, epoch: 3 | loss: 0.0628219
	speed: 0.0405s/iter; left time: 285.2175s
	iters: 300, epoch: 3 | loss: 0.0620333
	speed: 0.0409s/iter; left time: 284.2573s
	iters: 400, epoch: 3 | loss: 0.0580120
	speed: 0.0405s/iter; left time: 277.3138s
	iters: 500, epoch: 3 | loss: 0.0724367
	speed: 0.0406s/iter; left time: 274.2748s
	iters: 600, epoch: 3 | loss: 0.0686133
	speed: 0.0404s/iter; left time: 268.3333s
	iters: 700, epoch: 3 | loss: 0.0544494
	speed: 0.0411s/iter; left time: 269.1719s
	iters: 800, epoch: 3 | loss: 0.0651684
	speed: 0.0407s/iter; left time: 262.2730s
	iters: 900, epoch: 3 | loss: 0.0568570
	speed: 0.0408s/iter; left time: 258.7420s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.09s
Steps: 906 | Train Loss: 0.0631371 Vali Loss: 0.0593375 Test Loss: 0.0664737
Validation loss decreased (0.067584 --> 0.059338).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0625494
	speed: 0.0971s/iter; left time: 606.4911s
	iters: 200, epoch: 4 | loss: 0.0533406
	speed: 0.0416s/iter; left time: 255.3307s
	iters: 300, epoch: 4 | loss: 0.0576288
	speed: 0.0410s/iter; left time: 247.8326s
	iters: 400, epoch: 4 | loss: 0.0586074
	speed: 0.0409s/iter; left time: 243.1164s
	iters: 500, epoch: 4 | loss: 0.0580517
	speed: 0.0409s/iter; left time: 238.7017s
	iters: 600, epoch: 4 | loss: 0.0680938
	speed: 0.0406s/iter; left time: 233.4110s
	iters: 700, epoch: 4 | loss: 0.0595984
	speed: 0.0408s/iter; left time: 230.4083s
	iters: 800, epoch: 4 | loss: 0.0616186
	speed: 0.0405s/iter; left time: 224.7522s
	iters: 900, epoch: 4 | loss: 0.0607496
	speed: 0.0406s/iter; left time: 220.9843s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.33s
Steps: 906 | Train Loss: 0.0583044 Vali Loss: 0.0594619 Test Loss: 0.0648209
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0508268
	speed: 0.0935s/iter; left time: 499.2689s
	iters: 200, epoch: 5 | loss: 0.0465041
	speed: 0.0408s/iter; left time: 213.7084s
	iters: 300, epoch: 5 | loss: 0.0510423
	speed: 0.0409s/iter; left time: 210.0478s
	iters: 400, epoch: 5 | loss: 0.0523918
	speed: 0.0411s/iter; left time: 207.1005s
	iters: 500, epoch: 5 | loss: 0.0598315
	speed: 0.0421s/iter; left time: 207.7896s
	iters: 600, epoch: 5 | loss: 0.0490402
	speed: 0.0416s/iter; left time: 201.1613s
	iters: 700, epoch: 5 | loss: 0.0619671
	speed: 0.0414s/iter; left time: 195.9439s
	iters: 800, epoch: 5 | loss: 0.0528487
	speed: 0.0408s/iter; left time: 189.4135s
	iters: 900, epoch: 5 | loss: 0.0534129
	speed: 0.0409s/iter; left time: 185.4279s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.50s
Steps: 906 | Train Loss: 0.0549647 Vali Loss: 0.0630590 Test Loss: 0.0669836
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0482354
	speed: 0.0944s/iter; left time: 418.1274s
	iters: 200, epoch: 6 | loss: 0.0546013
	speed: 0.0406s/iter; left time: 175.9608s
	iters: 300, epoch: 6 | loss: 0.0570758
	speed: 0.0413s/iter; left time: 174.7038s
	iters: 400, epoch: 6 | loss: 0.0596123
	speed: 0.0405s/iter; left time: 167.4209s
	iters: 500, epoch: 6 | loss: 0.0551656
	speed: 0.0405s/iter; left time: 163.4208s
	iters: 600, epoch: 6 | loss: 0.0586615
	speed: 0.0406s/iter; left time: 159.5553s
	iters: 700, epoch: 6 | loss: 0.0553976
	speed: 0.0410s/iter; left time: 156.8940s
	iters: 800, epoch: 6 | loss: 0.0517439
	speed: 0.0405s/iter; left time: 150.9326s
	iters: 900, epoch: 6 | loss: 0.0614059
	speed: 0.0409s/iter; left time: 148.3436s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.15s
Steps: 906 | Train Loss: 0.0526655 Vali Loss: 0.0566184 Test Loss: 0.0645697
Validation loss decreased (0.059338 --> 0.056618).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0527649
	speed: 0.0901s/iter; left time: 317.6721s
	iters: 200, epoch: 7 | loss: 0.0461824
	speed: 0.0282s/iter; left time: 96.6433s
	iters: 300, epoch: 7 | loss: 0.0488837
	speed: 0.0282s/iter; left time: 93.8066s
	iters: 400, epoch: 7 | loss: 0.0497226
	speed: 0.0282s/iter; left time: 91.0615s
	iters: 500, epoch: 7 | loss: 0.0484969
	speed: 0.0282s/iter; left time: 88.2365s
	iters: 600, epoch: 7 | loss: 0.0423569
	speed: 0.0282s/iter; left time: 85.3462s
	iters: 700, epoch: 7 | loss: 0.0470160
	speed: 0.0283s/iter; left time: 82.6647s
	iters: 800, epoch: 7 | loss: 0.0575899
	speed: 0.0282s/iter; left time: 79.7431s
	iters: 900, epoch: 7 | loss: 0.0479537
	speed: 0.0283s/iter; left time: 76.9843s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:25.91s
Steps: 906 | Train Loss: 0.0508175 Vali Loss: 0.0561616 Test Loss: 0.0629275
Validation loss decreased (0.056618 --> 0.056162).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0453912
	speed: 0.0966s/iter; left time: 253.0347s
	iters: 200, epoch: 8 | loss: 0.0434858
	speed: 0.0406s/iter; left time: 102.3126s
	iters: 300, epoch: 8 | loss: 0.0531948
	speed: 0.0406s/iter; left time: 98.3216s
	iters: 400, epoch: 8 | loss: 0.0452402
	speed: 0.0404s/iter; left time: 93.7591s
	iters: 500, epoch: 8 | loss: 0.0539990
	speed: 0.0405s/iter; left time: 89.9707s
	iters: 600, epoch: 8 | loss: 0.0542634
	speed: 0.0409s/iter; left time: 86.7441s
	iters: 700, epoch: 8 | loss: 0.0458029
	speed: 0.0405s/iter; left time: 81.7955s
	iters: 800, epoch: 8 | loss: 0.0414126
	speed: 0.0406s/iter; left time: 77.9568s
	iters: 900, epoch: 8 | loss: 0.0540792
	speed: 0.0405s/iter; left time: 73.7572s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.09s
Steps: 906 | Train Loss: 0.0489464 Vali Loss: 0.0573378 Test Loss: 0.0645426
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0454752
	speed: 0.0957s/iter; left time: 164.0005s
	iters: 200, epoch: 9 | loss: 0.0501344
	speed: 0.0411s/iter; left time: 66.3269s
	iters: 300, epoch: 9 | loss: 0.0486988
	speed: 0.0419s/iter; left time: 63.4375s
	iters: 400, epoch: 9 | loss: 0.0566403
	speed: 0.0416s/iter; left time: 58.7914s
	iters: 500, epoch: 9 | loss: 0.0500063
	speed: 0.0406s/iter; left time: 53.3525s
	iters: 600, epoch: 9 | loss: 0.0535145
	speed: 0.0412s/iter; left time: 49.9371s
	iters: 700, epoch: 9 | loss: 0.0479669
	speed: 0.0414s/iter; left time: 46.0735s
	iters: 800, epoch: 9 | loss: 0.0512015
	speed: 0.0410s/iter; left time: 41.4899s
	iters: 900, epoch: 9 | loss: 0.0509077
	speed: 0.0411s/iter; left time: 37.5164s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.63s
Steps: 906 | Train Loss: 0.0472082 Vali Loss: 0.0564906 Test Loss: 0.0648163
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0465797
	speed: 0.0885s/iter; left time: 71.4220s
	iters: 200, epoch: 10 | loss: 0.0429502
	speed: 0.0411s/iter; left time: 29.0685s
	iters: 300, epoch: 10 | loss: 0.0492641
	speed: 0.0407s/iter; left time: 24.6997s
	iters: 400, epoch: 10 | loss: 0.0430836
	speed: 0.0409s/iter; left time: 20.7244s
	iters: 500, epoch: 10 | loss: 0.0444101
	speed: 0.0408s/iter; left time: 16.6193s
	iters: 600, epoch: 10 | loss: 0.0426973
	speed: 0.0404s/iter; left time: 12.4028s
	iters: 700, epoch: 10 | loss: 0.0503525
	speed: 0.0409s/iter; left time: 8.4645s
	iters: 800, epoch: 10 | loss: 0.0387502
	speed: 0.0413s/iter; left time: 4.4145s
	iters: 900, epoch: 10 | loss: 0.0532494
	speed: 0.0409s/iter; left time: 0.2864s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:36.66s
Steps: 906 | Train Loss: 0.0456444 Vali Loss: 0.0574741 Test Loss: 0.0645414
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011482995003461838, rmse:0.10715873539447784, mae:0.06290280073881149, rse:0.4049603343009949
Original data scale mse:1691501.875, rmse:1300.5775146484375, mae:802.243408203125, rse:0.09139464795589447
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2293039
	speed: 0.0440s/iter; left time: 394.4993s
	iters: 200, epoch: 1 | loss: 0.1949999
	speed: 0.0415s/iter; left time: 367.7592s
	iters: 300, epoch: 1 | loss: 0.1854941
	speed: 0.0410s/iter; left time: 358.8304s
	iters: 400, epoch: 1 | loss: 0.1584033
	speed: 0.0407s/iter; left time: 352.0863s
	iters: 500, epoch: 1 | loss: 0.1715456
	speed: 0.0408s/iter; left time: 349.1541s
	iters: 600, epoch: 1 | loss: 0.1699277
	speed: 0.0406s/iter; left time: 343.8288s
	iters: 700, epoch: 1 | loss: 0.1542774
	speed: 0.0406s/iter; left time: 339.7839s
	iters: 800, epoch: 1 | loss: 0.1516741
	speed: 0.0414s/iter; left time: 341.7199s
	iters: 900, epoch: 1 | loss: 0.1462401
	speed: 0.0410s/iter; left time: 334.4061s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.47s
Steps: 906 | Train Loss: 0.1825827 Vali Loss: 0.1343112 Test Loss: 0.1503070
Validation loss decreased (inf --> 0.134311).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1107656
	speed: 0.0989s/iter; left time: 796.7470s
	iters: 200, epoch: 2 | loss: 0.1030795
	speed: 0.0417s/iter; left time: 331.9653s
	iters: 300, epoch: 2 | loss: 0.0860572
	speed: 0.0417s/iter; left time: 327.7018s
	iters: 400, epoch: 2 | loss: 0.0752717
	speed: 0.0424s/iter; left time: 328.5950s
	iters: 500, epoch: 2 | loss: 0.0827808
	speed: 0.0412s/iter; left time: 315.5587s
	iters: 600, epoch: 2 | loss: 0.0736229
	speed: 0.0417s/iter; left time: 314.8256s
	iters: 700, epoch: 2 | loss: 0.0723702
	speed: 0.0412s/iter; left time: 307.1595s
	iters: 800, epoch: 2 | loss: 0.0665644
	speed: 0.0417s/iter; left time: 306.4962s
	iters: 900, epoch: 2 | loss: 0.0643604
	speed: 0.0414s/iter; left time: 300.7116s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.96s
Steps: 906 | Train Loss: 0.0861478 Vali Loss: 0.0631266 Test Loss: 0.0667304
Validation loss decreased (0.134311 --> 0.063127).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0693751
	speed: 0.1034s/iter; left time: 739.4476s
	iters: 200, epoch: 3 | loss: 0.0592428
	speed: 0.0421s/iter; left time: 296.9034s
	iters: 300, epoch: 3 | loss: 0.0610428
	speed: 0.0422s/iter; left time: 293.5499s
	iters: 400, epoch: 3 | loss: 0.0658390
	speed: 0.0420s/iter; left time: 287.8221s
	iters: 500, epoch: 3 | loss: 0.0666335
	speed: 0.0412s/iter; left time: 278.0228s
	iters: 600, epoch: 3 | loss: 0.0606009
	speed: 0.0411s/iter; left time: 273.3607s
	iters: 700, epoch: 3 | loss: 0.0581337
	speed: 0.0405s/iter; left time: 265.5538s
	iters: 800, epoch: 3 | loss: 0.0582383
	speed: 0.0415s/iter; left time: 267.9168s
	iters: 900, epoch: 3 | loss: 0.0596758
	speed: 0.0413s/iter; left time: 262.4578s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.95s
Steps: 906 | Train Loss: 0.0641978 Vali Loss: 0.0611058 Test Loss: 0.0658730
Validation loss decreased (0.063127 --> 0.061106).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0562136
	speed: 0.0998s/iter; left time: 623.1873s
	iters: 200, epoch: 4 | loss: 0.0655172
	speed: 0.0412s/iter; left time: 253.1975s
	iters: 300, epoch: 4 | loss: 0.0593281
	speed: 0.0412s/iter; left time: 248.8640s
	iters: 400, epoch: 4 | loss: 0.0546823
	speed: 0.0406s/iter; left time: 241.5464s
	iters: 500, epoch: 4 | loss: 0.0553918
	speed: 0.0407s/iter; left time: 237.9398s
	iters: 600, epoch: 4 | loss: 0.0603409
	speed: 0.0409s/iter; left time: 234.9392s
	iters: 700, epoch: 4 | loss: 0.0628517
	speed: 0.0410s/iter; left time: 231.5435s
	iters: 800, epoch: 4 | loss: 0.0533420
	speed: 0.0408s/iter; left time: 226.3870s
	iters: 900, epoch: 4 | loss: 0.0497529
	speed: 0.0408s/iter; left time: 221.8164s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.38s
Steps: 906 | Train Loss: 0.0593306 Vali Loss: 0.0581195 Test Loss: 0.0622350
Validation loss decreased (0.061106 --> 0.058120).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0587280
	speed: 0.0979s/iter; left time: 522.5709s
	iters: 200, epoch: 5 | loss: 0.0496650
	speed: 0.0413s/iter; left time: 216.4735s
	iters: 300, epoch: 5 | loss: 0.0512741
	speed: 0.0411s/iter; left time: 211.2610s
	iters: 400, epoch: 5 | loss: 0.0494401
	speed: 0.0409s/iter; left time: 206.0223s
	iters: 500, epoch: 5 | loss: 0.0611358
	speed: 0.0412s/iter; left time: 203.3781s
	iters: 600, epoch: 5 | loss: 0.0572452
	speed: 0.0417s/iter; left time: 201.7430s
	iters: 700, epoch: 5 | loss: 0.0612310
	speed: 0.0406s/iter; left time: 192.3878s
	iters: 800, epoch: 5 | loss: 0.0486969
	speed: 0.0412s/iter; left time: 191.1214s
	iters: 900, epoch: 5 | loss: 0.0643084
	speed: 0.0412s/iter; left time: 186.7641s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.59s
Steps: 906 | Train Loss: 0.0560262 Vali Loss: 0.0554300 Test Loss: 0.0610669
Validation loss decreased (0.058120 --> 0.055430).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0596108
	speed: 0.0991s/iter; left time: 438.9817s
	iters: 200, epoch: 6 | loss: 0.0585680
	speed: 0.0425s/iter; left time: 183.9326s
	iters: 300, epoch: 6 | loss: 0.0506056
	speed: 0.0422s/iter; left time: 178.7083s
	iters: 400, epoch: 6 | loss: 0.0554475
	speed: 0.0420s/iter; left time: 173.6498s
	iters: 500, epoch: 6 | loss: 0.0471394
	speed: 0.0413s/iter; left time: 166.6214s
	iters: 600, epoch: 6 | loss: 0.0487447
	speed: 0.0420s/iter; left time: 165.0913s
	iters: 700, epoch: 6 | loss: 0.0455151
	speed: 0.0413s/iter; left time: 158.1296s
	iters: 800, epoch: 6 | loss: 0.0467743
	speed: 0.0418s/iter; left time: 155.7936s
	iters: 900, epoch: 6 | loss: 0.0532170
	speed: 0.0416s/iter; left time: 151.2130s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.20s
Steps: 906 | Train Loss: 0.0540781 Vali Loss: 0.0558894 Test Loss: 0.0634225
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0499279
	speed: 0.0954s/iter; left time: 336.1861s
	iters: 200, epoch: 7 | loss: 0.0548485
	speed: 0.0412s/iter; left time: 141.2768s
	iters: 300, epoch: 7 | loss: 0.0522096
	speed: 0.0414s/iter; left time: 137.7741s
	iters: 400, epoch: 7 | loss: 0.0482700
	speed: 0.0414s/iter; left time: 133.5169s
	iters: 500, epoch: 7 | loss: 0.0502691
	speed: 0.0416s/iter; left time: 130.0006s
	iters: 600, epoch: 7 | loss: 0.0580107
	speed: 0.0414s/iter; left time: 125.1401s
	iters: 700, epoch: 7 | loss: 0.0561222
	speed: 0.0408s/iter; left time: 119.4559s
	iters: 800, epoch: 7 | loss: 0.0497233
	speed: 0.0408s/iter; left time: 115.3270s
	iters: 900, epoch: 7 | loss: 0.0482512
	speed: 0.0416s/iter; left time: 113.3738s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.70s
Steps: 906 | Train Loss: 0.0516833 Vali Loss: 0.0570287 Test Loss: 0.0636291
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0507852
	speed: 0.0943s/iter; left time: 247.0311s
	iters: 200, epoch: 8 | loss: 0.0477182
	speed: 0.0405s/iter; left time: 101.9260s
	iters: 300, epoch: 8 | loss: 0.0415919
	speed: 0.0412s/iter; left time: 99.5689s
	iters: 400, epoch: 8 | loss: 0.0505819
	speed: 0.0410s/iter; left time: 94.9782s
	iters: 500, epoch: 8 | loss: 0.0492290
	speed: 0.0408s/iter; left time: 90.5867s
	iters: 600, epoch: 8 | loss: 0.0508336
	speed: 0.0409s/iter; left time: 86.7708s
	iters: 700, epoch: 8 | loss: 0.0446340
	speed: 0.0406s/iter; left time: 81.9453s
	iters: 800, epoch: 8 | loss: 0.0494645
	speed: 0.0411s/iter; left time: 78.8533s
	iters: 900, epoch: 8 | loss: 0.0484836
	speed: 0.0408s/iter; left time: 74.3008s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.30s
Steps: 906 | Train Loss: 0.0502655 Vali Loss: 0.0593058 Test Loss: 0.0663687
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01105409674346447, rmse:0.10513846576213837, mae:0.061079539358615875, rse:0.3973256051540375
Original data scale mse:1389721.625, rmse:1178.864501953125, mae:748.0409545898438, rse:0.08284159004688263

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.011482995003461838, RMSE: 0.10715873539447784, MAE: 0.06290280073881149, RSE: 0.4049603343009949
Unscaled Metrics - MSE: 1691501.875, RMSE: 1300.5775146484375, MAE: 802.243408203125, RSE: 0.09139464795589447

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.01105409674346447, RMSE: 0.10513846576213837, MAE: 0.061079539358615875, RSE: 0.3973256051540375
Unscaled Metrics - MSE: 1389721.625, RMSE: 1178.864501953125, MAE: 748.0409545898438, RSE: 0.08284159004688263

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2243602
	speed: 0.0767s/iter; left time: 686.1226s
	iters: 200, epoch: 1 | loss: 0.2027065
	speed: 0.0476s/iter; left time: 420.6963s
	iters: 300, epoch: 1 | loss: 0.1868845
	speed: 0.0473s/iter; left time: 413.8237s
	iters: 400, epoch: 1 | loss: 0.1847196
	speed: 0.0460s/iter; left time: 397.5533s
	iters: 500, epoch: 1 | loss: 0.1851151
	speed: 0.0478s/iter; left time: 408.3032s
	iters: 600, epoch: 1 | loss: 0.1763308
	speed: 0.0477s/iter; left time: 402.7618s
	iters: 700, epoch: 1 | loss: 0.1776650
	speed: 0.0478s/iter; left time: 398.8537s
	iters: 800, epoch: 1 | loss: 0.1680425
	speed: 0.0477s/iter; left time: 393.2185s
	iters: 900, epoch: 1 | loss: 0.1724489
	speed: 0.0479s/iter; left time: 389.6047s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.67s
Steps: 904 | Train Loss: 0.1918924 Vali Loss: 0.1596796 Test Loss: 0.1781078
Validation loss decreased (inf --> 0.159680).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1530025
	speed: 0.1178s/iter; left time: 946.6485s
	iters: 200, epoch: 2 | loss: 0.1297616
	speed: 0.0475s/iter; left time: 376.7796s
	iters: 300, epoch: 2 | loss: 0.1149904
	speed: 0.0476s/iter; left time: 373.3182s
	iters: 400, epoch: 2 | loss: 0.1057039
	speed: 0.0477s/iter; left time: 368.8188s
	iters: 500, epoch: 2 | loss: 0.1026849
	speed: 0.0475s/iter; left time: 362.8403s
	iters: 600, epoch: 2 | loss: 0.1063231
	speed: 0.0455s/iter; left time: 342.6285s
	iters: 700, epoch: 2 | loss: 0.0957590
	speed: 0.0475s/iter; left time: 353.2155s
	iters: 800, epoch: 2 | loss: 0.0971975
	speed: 0.0475s/iter; left time: 348.8500s
	iters: 900, epoch: 2 | loss: 0.0866247
	speed: 0.0475s/iter; left time: 343.4672s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.97s
Steps: 904 | Train Loss: 0.1147572 Vali Loss: 0.0918063 Test Loss: 0.0950631
Validation loss decreased (0.159680 --> 0.091806).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0887786
	speed: 0.1243s/iter; left time: 886.5882s
	iters: 200, epoch: 3 | loss: 0.0895701
	speed: 0.0474s/iter; left time: 333.1588s
	iters: 300, epoch: 3 | loss: 0.0920746
	speed: 0.0472s/iter; left time: 326.9817s
	iters: 400, epoch: 3 | loss: 0.0863848
	speed: 0.0473s/iter; left time: 323.1555s
	iters: 500, epoch: 3 | loss: 0.0874794
	speed: 0.0474s/iter; left time: 319.2563s
	iters: 600, epoch: 3 | loss: 0.0857909
	speed: 0.0471s/iter; left time: 312.6884s
	iters: 700, epoch: 3 | loss: 0.0795361
	speed: 0.0473s/iter; left time: 309.3042s
	iters: 800, epoch: 3 | loss: 0.0905731
	speed: 0.0470s/iter; left time: 302.3265s
	iters: 900, epoch: 3 | loss: 0.0883819
	speed: 0.0472s/iter; left time: 298.7633s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.99s
Steps: 904 | Train Loss: 0.0859464 Vali Loss: 0.0834362 Test Loss: 0.0888495
Validation loss decreased (0.091806 --> 0.083436).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0770556
	speed: 0.1150s/iter; left time: 716.5504s
	iters: 200, epoch: 4 | loss: 0.0817428
	speed: 0.0471s/iter; left time: 288.5582s
	iters: 300, epoch: 4 | loss: 0.0759583
	speed: 0.0471s/iter; left time: 283.7167s
	iters: 400, epoch: 4 | loss: 0.0846592
	speed: 0.0471s/iter; left time: 279.3253s
	iters: 500, epoch: 4 | loss: 0.0812071
	speed: 0.0472s/iter; left time: 275.3366s
	iters: 600, epoch: 4 | loss: 0.0800486
	speed: 0.0471s/iter; left time: 269.7768s
	iters: 700, epoch: 4 | loss: 0.0755152
	speed: 0.0471s/iter; left time: 265.3926s
	iters: 800, epoch: 4 | loss: 0.0806880
	speed: 0.0468s/iter; left time: 258.7435s
	iters: 900, epoch: 4 | loss: 0.0723897
	speed: 0.0471s/iter; left time: 255.8471s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.80s
Steps: 904 | Train Loss: 0.0793150 Vali Loss: 0.0786396 Test Loss: 0.0888349
Validation loss decreased (0.083436 --> 0.078640).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0715495
	speed: 0.1153s/iter; left time: 614.0485s
	iters: 200, epoch: 5 | loss: 0.0792769
	speed: 0.0473s/iter; left time: 247.0987s
	iters: 300, epoch: 5 | loss: 0.0732970
	speed: 0.0473s/iter; left time: 242.3837s
	iters: 400, epoch: 5 | loss: 0.0858842
	speed: 0.0473s/iter; left time: 237.8546s
	iters: 500, epoch: 5 | loss: 0.0754363
	speed: 0.0473s/iter; left time: 233.1763s
	iters: 600, epoch: 5 | loss: 0.0764097
	speed: 0.0472s/iter; left time: 227.6236s
	iters: 700, epoch: 5 | loss: 0.0786430
	speed: 0.0472s/iter; left time: 222.9780s
	iters: 800, epoch: 5 | loss: 0.0794202
	speed: 0.0474s/iter; left time: 219.2312s
	iters: 900, epoch: 5 | loss: 0.0708164
	speed: 0.0474s/iter; left time: 214.5815s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.99s
Steps: 904 | Train Loss: 0.0752230 Vali Loss: 0.0787254 Test Loss: 0.0872884
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0605731
	speed: 0.1114s/iter; left time: 492.4020s
	iters: 200, epoch: 6 | loss: 0.0735579
	speed: 0.0471s/iter; left time: 203.5601s
	iters: 300, epoch: 6 | loss: 0.0757417
	speed: 0.0471s/iter; left time: 198.8017s
	iters: 400, epoch: 6 | loss: 0.0776769
	speed: 0.0471s/iter; left time: 194.2973s
	iters: 500, epoch: 6 | loss: 0.0724421
	speed: 0.0470s/iter; left time: 189.0419s
	iters: 600, epoch: 6 | loss: 0.0672777
	speed: 0.0472s/iter; left time: 185.1111s
	iters: 700, epoch: 6 | loss: 0.0635118
	speed: 0.0471s/iter; left time: 179.9935s
	iters: 800, epoch: 6 | loss: 0.0738846
	speed: 0.0471s/iter; left time: 175.0887s
	iters: 900, epoch: 6 | loss: 0.0723136
	speed: 0.0472s/iter; left time: 170.7340s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.80s
Steps: 904 | Train Loss: 0.0717300 Vali Loss: 0.0797349 Test Loss: 0.0892030
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0677241
	speed: 0.1123s/iter; left time: 395.0050s
	iters: 200, epoch: 7 | loss: 0.0646913
	speed: 0.0469s/iter; left time: 160.2284s
	iters: 300, epoch: 7 | loss: 0.0696629
	speed: 0.0475s/iter; left time: 157.6190s
	iters: 400, epoch: 7 | loss: 0.0655409
	speed: 0.0475s/iter; left time: 152.7913s
	iters: 500, epoch: 7 | loss: 0.0625962
	speed: 0.0474s/iter; left time: 147.6344s
	iters: 600, epoch: 7 | loss: 0.0773934
	speed: 0.0475s/iter; left time: 143.3745s
	iters: 700, epoch: 7 | loss: 0.0629039
	speed: 0.0475s/iter; left time: 138.4763s
	iters: 800, epoch: 7 | loss: 0.0599256
	speed: 0.0475s/iter; left time: 133.8986s
	iters: 900, epoch: 7 | loss: 0.0667820
	speed: 0.0476s/iter; left time: 129.2207s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.10s
Steps: 904 | Train Loss: 0.0682445 Vali Loss: 0.0809954 Test Loss: 0.0913115
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019984431564807892, rmse:0.14136630296707153, mae:0.0888453871011734, rse:0.534521222114563
Original data scale mse:3605560.25, rmse:1898.831298828125, mae:1205.3231201171875, rse:0.13362851738929749
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2240398
	speed: 0.0502s/iter; left time: 448.5318s
	iters: 200, epoch: 1 | loss: 0.2105331
	speed: 0.0480s/iter; left time: 424.7962s
	iters: 300, epoch: 1 | loss: 0.1883464
	speed: 0.0474s/iter; left time: 414.2431s
	iters: 400, epoch: 1 | loss: 0.1845039
	speed: 0.0478s/iter; left time: 412.7784s
	iters: 500, epoch: 1 | loss: 0.1790367
	speed: 0.0477s/iter; left time: 407.4003s
	iters: 600, epoch: 1 | loss: 0.1824718
	speed: 0.0478s/iter; left time: 403.8657s
	iters: 700, epoch: 1 | loss: 0.1725546
	speed: 0.0478s/iter; left time: 398.5019s
	iters: 800, epoch: 1 | loss: 0.1700925
	speed: 0.0478s/iter; left time: 393.8054s
	iters: 900, epoch: 1 | loss: 0.1613553
	speed: 0.0478s/iter; left time: 389.0894s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.49s
Steps: 904 | Train Loss: 0.1915094 Vali Loss: 0.1579992 Test Loss: 0.1774052
Validation loss decreased (inf --> 0.157999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1470376
	speed: 0.1158s/iter; left time: 930.3071s
	iters: 200, epoch: 2 | loss: 0.1239771
	speed: 0.0478s/iter; left time: 379.5583s
	iters: 300, epoch: 2 | loss: 0.1165423
	speed: 0.0479s/iter; left time: 375.1930s
	iters: 400, epoch: 2 | loss: 0.1071929
	speed: 0.0479s/iter; left time: 370.6951s
	iters: 500, epoch: 2 | loss: 0.1061287
	speed: 0.0478s/iter; left time: 365.3921s
	iters: 600, epoch: 2 | loss: 0.1077616
	speed: 0.0475s/iter; left time: 358.3735s
	iters: 700, epoch: 2 | loss: 0.1017539
	speed: 0.0474s/iter; left time: 352.3390s
	iters: 800, epoch: 2 | loss: 0.0951709
	speed: 0.0466s/iter; left time: 342.0989s
	iters: 900, epoch: 2 | loss: 0.0865274
	speed: 0.0475s/iter; left time: 343.4739s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.27s
Steps: 904 | Train Loss: 0.1142872 Vali Loss: 0.0897007 Test Loss: 0.0939150
Validation loss decreased (0.157999 --> 0.089701).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0840477
	speed: 0.1169s/iter; left time: 834.0878s
	iters: 200, epoch: 3 | loss: 0.0851544
	speed: 0.0475s/iter; left time: 333.8247s
	iters: 300, epoch: 3 | loss: 0.0887517
	speed: 0.0474s/iter; left time: 328.9420s
	iters: 400, epoch: 3 | loss: 0.0920378
	speed: 0.0477s/iter; left time: 326.1445s
	iters: 500, epoch: 3 | loss: 0.0844317
	speed: 0.0479s/iter; left time: 322.4737s
	iters: 600, epoch: 3 | loss: 0.0899497
	speed: 0.0479s/iter; left time: 317.7516s
	iters: 700, epoch: 3 | loss: 0.0846821
	speed: 0.0477s/iter; left time: 311.7969s
	iters: 800, epoch: 3 | loss: 0.0789549
	speed: 0.0477s/iter; left time: 306.6669s
	iters: 900, epoch: 3 | loss: 0.0810189
	speed: 0.0479s/iter; left time: 303.3256s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.40s
Steps: 904 | Train Loss: 0.0866498 Vali Loss: 0.0863490 Test Loss: 0.0889597
Validation loss decreased (0.089701 --> 0.086349).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0819868
	speed: 0.1168s/iter; left time: 727.7127s
	iters: 200, epoch: 4 | loss: 0.0814292
	speed: 0.0467s/iter; left time: 286.0030s
	iters: 300, epoch: 4 | loss: 0.0853356
	speed: 0.0479s/iter; left time: 289.0133s
	iters: 400, epoch: 4 | loss: 0.0793281
	speed: 0.0479s/iter; left time: 283.8274s
	iters: 500, epoch: 4 | loss: 0.0783759
	speed: 0.0480s/iter; left time: 279.6255s
	iters: 600, epoch: 4 | loss: 0.0773403
	speed: 0.0477s/iter; left time: 273.5178s
	iters: 700, epoch: 4 | loss: 0.0798870
	speed: 0.0478s/iter; left time: 269.2479s
	iters: 800, epoch: 4 | loss: 0.0750341
	speed: 0.0479s/iter; left time: 264.8317s
	iters: 900, epoch: 4 | loss: 0.0692645
	speed: 0.0478s/iter; left time: 259.6956s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.39s
Steps: 904 | Train Loss: 0.0802790 Vali Loss: 0.0805011 Test Loss: 0.0879182
Validation loss decreased (0.086349 --> 0.080501).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0772444
	speed: 0.1155s/iter; left time: 615.0323s
	iters: 200, epoch: 5 | loss: 0.0743210
	speed: 0.0471s/iter; left time: 246.2216s
	iters: 300, epoch: 5 | loss: 0.0736933
	speed: 0.0472s/iter; left time: 242.0452s
	iters: 400, epoch: 5 | loss: 0.0747714
	speed: 0.0473s/iter; left time: 237.8036s
	iters: 500, epoch: 5 | loss: 0.0765212
	speed: 0.0475s/iter; left time: 233.7236s
	iters: 600, epoch: 5 | loss: 0.0804278
	speed: 0.0474s/iter; left time: 228.6670s
	iters: 700, epoch: 5 | loss: 0.0784457
	speed: 0.0475s/iter; left time: 224.6252s
	iters: 800, epoch: 5 | loss: 0.0800255
	speed: 0.0474s/iter; left time: 219.2930s
	iters: 900, epoch: 5 | loss: 0.0701285
	speed: 0.0475s/iter; left time: 214.7984s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.07s
Steps: 904 | Train Loss: 0.0760173 Vali Loss: 0.0785532 Test Loss: 0.0887440
Validation loss decreased (0.080501 --> 0.078553).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0737377
	speed: 0.1183s/iter; left time: 522.8410s
	iters: 200, epoch: 6 | loss: 0.0705482
	speed: 0.0472s/iter; left time: 204.1348s
	iters: 300, epoch: 6 | loss: 0.0787471
	speed: 0.0477s/iter; left time: 201.2439s
	iters: 400, epoch: 6 | loss: 0.0691097
	speed: 0.0477s/iter; left time: 196.5368s
	iters: 500, epoch: 6 | loss: 0.0787415
	speed: 0.0477s/iter; left time: 191.7652s
	iters: 600, epoch: 6 | loss: 0.0688312
	speed: 0.0475s/iter; left time: 186.3779s
	iters: 700, epoch: 6 | loss: 0.0719894
	speed: 0.0477s/iter; left time: 182.0970s
	iters: 800, epoch: 6 | loss: 0.0703194
	speed: 0.0477s/iter; left time: 177.4717s
	iters: 900, epoch: 6 | loss: 0.0661363
	speed: 0.0476s/iter; left time: 172.3399s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.28s
Steps: 904 | Train Loss: 0.0725727 Vali Loss: 0.0793032 Test Loss: 0.0889991
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0726100
	speed: 0.1119s/iter; left time: 393.4853s
	iters: 200, epoch: 7 | loss: 0.0638280
	speed: 0.0473s/iter; left time: 161.6024s
	iters: 300, epoch: 7 | loss: 0.0714715
	speed: 0.0473s/iter; left time: 156.8270s
	iters: 400, epoch: 7 | loss: 0.0687825
	speed: 0.0473s/iter; left time: 152.1248s
	iters: 500, epoch: 7 | loss: 0.0678533
	speed: 0.0465s/iter; left time: 144.8768s
	iters: 600, epoch: 7 | loss: 0.0674889
	speed: 0.0474s/iter; left time: 143.0084s
	iters: 700, epoch: 7 | loss: 0.0599818
	speed: 0.0474s/iter; left time: 138.2006s
	iters: 800, epoch: 7 | loss: 0.0693051
	speed: 0.0475s/iter; left time: 133.8327s
	iters: 900, epoch: 7 | loss: 0.0677483
	speed: 0.0474s/iter; left time: 128.7330s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.93s
Steps: 904 | Train Loss: 0.0693443 Vali Loss: 0.0803082 Test Loss: 0.0903231
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0680132
	speed: 0.1124s/iter; left time: 293.5955s
	iters: 200, epoch: 8 | loss: 0.0651403
	speed: 0.0477s/iter; left time: 119.7791s
	iters: 300, epoch: 8 | loss: 0.0652519
	speed: 0.0477s/iter; left time: 115.0940s
	iters: 400, epoch: 8 | loss: 0.0637966
	speed: 0.0477s/iter; left time: 110.3705s
	iters: 500, epoch: 8 | loss: 0.0607010
	speed: 0.0477s/iter; left time: 105.5669s
	iters: 600, epoch: 8 | loss: 0.0625788
	speed: 0.0478s/iter; left time: 100.9017s
	iters: 700, epoch: 8 | loss: 0.0660454
	speed: 0.0476s/iter; left time: 95.7366s
	iters: 800, epoch: 8 | loss: 0.0644100
	speed: 0.0476s/iter; left time: 91.0729s
	iters: 900, epoch: 8 | loss: 0.0647821
	speed: 0.0476s/iter; left time: 86.2740s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.30s
Steps: 904 | Train Loss: 0.0664464 Vali Loss: 0.0813904 Test Loss: 0.0939181
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.0203001257032156, rmse:0.14247851073741913, mae:0.08875438570976257, rse:0.5387266278266907
Original data scale mse:3148950.0, rmse:1774.528076171875, mae:1153.3165283203125, rse:0.12488079071044922

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.019984431564807892, RMSE: 0.14136630296707153, MAE: 0.0888453871011734, RSE: 0.534521222114563
Unscaled Metrics - MSE: 3605560.25, RMSE: 1898.831298828125, MAE: 1205.3231201171875, RSE: 0.13362851738929749

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.0203001257032156, RMSE: 0.14247851073741913, MAE: 0.08875438570976257, RSE: 0.5387266278266907
Unscaled Metrics - MSE: 3148950.0, RMSE: 1774.528076171875, MAE: 1153.3165283203125, RSE: 0.12488079071044922

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2298318
	speed: 0.0825s/iter; left time: 736.3882s
	iters: 200, epoch: 1 | loss: 0.1998459
	speed: 0.0534s/iter; left time: 470.8385s
	iters: 300, epoch: 1 | loss: 0.2001658
	speed: 0.0533s/iter; left time: 464.9805s
	iters: 400, epoch: 1 | loss: 0.1908817
	speed: 0.0534s/iter; left time: 460.0223s
	iters: 500, epoch: 1 | loss: 0.1891606
	speed: 0.0535s/iter; left time: 455.9600s
	iters: 600, epoch: 1 | loss: 0.1892172
	speed: 0.0534s/iter; left time: 449.4187s
	iters: 700, epoch: 1 | loss: 0.1822665
	speed: 0.0535s/iter; left time: 445.4146s
	iters: 800, epoch: 1 | loss: 0.1839132
	speed: 0.0533s/iter; left time: 438.3533s
	iters: 900, epoch: 1 | loss: 0.1841313
	speed: 0.0534s/iter; left time: 433.5217s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.90s
Steps: 902 | Train Loss: 0.1967058 Vali Loss: 0.1674167 Test Loss: 0.1840987
Validation loss decreased (inf --> 0.167417).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1718581
	speed: 0.1348s/iter; left time: 1080.9632s
	iters: 200, epoch: 2 | loss: 0.1566561
	speed: 0.0535s/iter; left time: 423.4127s
	iters: 300, epoch: 2 | loss: 0.1566442
	speed: 0.0537s/iter; left time: 420.0192s
	iters: 400, epoch: 2 | loss: 0.1416597
	speed: 0.0535s/iter; left time: 413.2291s
	iters: 500, epoch: 2 | loss: 0.1273803
	speed: 0.0538s/iter; left time: 409.6028s
	iters: 600, epoch: 2 | loss: 0.1301640
	speed: 0.0534s/iter; left time: 401.6584s
	iters: 700, epoch: 2 | loss: 0.1060042
	speed: 0.0536s/iter; left time: 397.3919s
	iters: 800, epoch: 2 | loss: 0.0993617
	speed: 0.0536s/iter; left time: 392.3517s
	iters: 900, epoch: 2 | loss: 0.0959845
	speed: 0.0535s/iter; left time: 386.1089s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.62s
Steps: 902 | Train Loss: 0.1376420 Vali Loss: 0.0958561 Test Loss: 0.1030837
Validation loss decreased (0.167417 --> 0.095856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0903104
	speed: 0.1475s/iter; left time: 1049.9315s
	iters: 200, epoch: 3 | loss: 0.0961597
	speed: 0.0536s/iter; left time: 375.9214s
	iters: 300, epoch: 3 | loss: 0.0976604
	speed: 0.0535s/iter; left time: 369.7555s
	iters: 400, epoch: 3 | loss: 0.0974886
	speed: 0.0535s/iter; left time: 364.5856s
	iters: 500, epoch: 3 | loss: 0.0988006
	speed: 0.0536s/iter; left time: 359.8330s
	iters: 600, epoch: 3 | loss: 0.0879664
	speed: 0.0537s/iter; left time: 355.0943s
	iters: 700, epoch: 3 | loss: 0.0922868
	speed: 0.0536s/iter; left time: 349.2342s
	iters: 800, epoch: 3 | loss: 0.0906126
	speed: 0.0536s/iter; left time: 343.6364s
	iters: 900, epoch: 3 | loss: 0.0882223
	speed: 0.0529s/iter; left time: 333.9432s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.64s
Steps: 902 | Train Loss: 0.0932331 Vali Loss: 0.0870312 Test Loss: 0.0972080
Validation loss decreased (0.095856 --> 0.087031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0886278
	speed: 0.1350s/iter; left time: 838.7277s
	iters: 200, epoch: 4 | loss: 0.0887057
	speed: 0.0537s/iter; left time: 328.1023s
	iters: 300, epoch: 4 | loss: 0.0948177
	speed: 0.0536s/iter; left time: 322.3888s
	iters: 400, epoch: 4 | loss: 0.0810935
	speed: 0.0537s/iter; left time: 317.6143s
	iters: 500, epoch: 4 | loss: 0.0813296
	speed: 0.0536s/iter; left time: 311.5330s
	iters: 600, epoch: 4 | loss: 0.0820543
	speed: 0.0536s/iter; left time: 306.0416s
	iters: 700, epoch: 4 | loss: 0.0880838
	speed: 0.0536s/iter; left time: 300.9334s
	iters: 800, epoch: 4 | loss: 0.0881585
	speed: 0.0536s/iter; left time: 295.6368s
	iters: 900, epoch: 4 | loss: 0.0856838
	speed: 0.0535s/iter; left time: 289.6046s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.40s
Steps: 902 | Train Loss: 0.0858926 Vali Loss: 0.0852741 Test Loss: 0.0950092
Validation loss decreased (0.087031 --> 0.085274).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0764841
	speed: 0.1376s/iter; left time: 731.2550s
	iters: 200, epoch: 5 | loss: 0.0780453
	speed: 0.0538s/iter; left time: 280.2100s
	iters: 300, epoch: 5 | loss: 0.0825350
	speed: 0.0536s/iter; left time: 274.2535s
	iters: 400, epoch: 5 | loss: 0.0867204
	speed: 0.0537s/iter; left time: 269.1990s
	iters: 500, epoch: 5 | loss: 0.0856278
	speed: 0.0537s/iter; left time: 263.7113s
	iters: 600, epoch: 5 | loss: 0.0901060
	speed: 0.0536s/iter; left time: 257.8315s
	iters: 700, epoch: 5 | loss: 0.0878257
	speed: 0.0536s/iter; left time: 252.5243s
	iters: 800, epoch: 5 | loss: 0.0791946
	speed: 0.0536s/iter; left time: 247.1623s
	iters: 900, epoch: 5 | loss: 0.0788658
	speed: 0.0536s/iter; left time: 242.0140s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.61s
Steps: 902 | Train Loss: 0.0813541 Vali Loss: 0.0838442 Test Loss: 0.0949016
Validation loss decreased (0.085274 --> 0.083844).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0780597
	speed: 0.1327s/iter; left time: 585.3461s
	iters: 200, epoch: 6 | loss: 0.0760589
	speed: 0.0533s/iter; left time: 229.9676s
	iters: 300, epoch: 6 | loss: 0.0752045
	speed: 0.0534s/iter; left time: 224.9412s
	iters: 400, epoch: 6 | loss: 0.0775517
	speed: 0.0536s/iter; left time: 220.1926s
	iters: 500, epoch: 6 | loss: 0.0747982
	speed: 0.0535s/iter; left time: 214.4630s
	iters: 600, epoch: 6 | loss: 0.0752919
	speed: 0.0535s/iter; left time: 209.1105s
	iters: 700, epoch: 6 | loss: 0.0737840
	speed: 0.0532s/iter; left time: 202.8696s
	iters: 800, epoch: 6 | loss: 0.0741504
	speed: 0.0533s/iter; left time: 197.9036s
	iters: 900, epoch: 6 | loss: 0.0761954
	speed: 0.0534s/iter; left time: 192.7559s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.43s
Steps: 902 | Train Loss: 0.0776061 Vali Loss: 0.0840367 Test Loss: 0.0930206
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0769571
	speed: 0.1295s/iter; left time: 454.2588s
	iters: 200, epoch: 7 | loss: 0.0793617
	speed: 0.0538s/iter; left time: 183.4518s
	iters: 300, epoch: 7 | loss: 0.0704730
	speed: 0.0537s/iter; left time: 177.7622s
	iters: 400, epoch: 7 | loss: 0.0761969
	speed: 0.0537s/iter; left time: 172.4685s
	iters: 500, epoch: 7 | loss: 0.0744571
	speed: 0.0536s/iter; left time: 166.5060s
	iters: 600, epoch: 7 | loss: 0.0700828
	speed: 0.0537s/iter; left time: 161.5185s
	iters: 700, epoch: 7 | loss: 0.0725735
	speed: 0.0537s/iter; left time: 156.1507s
	iters: 800, epoch: 7 | loss: 0.0692064
	speed: 0.0537s/iter; left time: 150.9383s
	iters: 900, epoch: 7 | loss: 0.0691122
	speed: 0.0536s/iter; left time: 145.2764s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.64s
Steps: 902 | Train Loss: 0.0740751 Vali Loss: 0.0850344 Test Loss: 0.0976326
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0709344
	speed: 0.1295s/iter; left time: 337.5863s
	iters: 200, epoch: 8 | loss: 0.0714713
	speed: 0.0535s/iter; left time: 134.1754s
	iters: 300, epoch: 8 | loss: 0.0738888
	speed: 0.0537s/iter; left time: 129.3121s
	iters: 400, epoch: 8 | loss: 0.0697268
	speed: 0.0537s/iter; left time: 123.9243s
	iters: 500, epoch: 8 | loss: 0.0722686
	speed: 0.0536s/iter; left time: 118.3762s
	iters: 600, epoch: 8 | loss: 0.0642004
	speed: 0.0536s/iter; left time: 112.8968s
	iters: 700, epoch: 8 | loss: 0.0685385
	speed: 0.0536s/iter; left time: 107.6008s
	iters: 800, epoch: 8 | loss: 0.0682947
	speed: 0.0537s/iter; left time: 102.4311s
	iters: 900, epoch: 8 | loss: 0.0678271
	speed: 0.0536s/iter; left time: 96.9129s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.60s
Steps: 902 | Train Loss: 0.0704684 Vali Loss: 0.0865647 Test Loss: 0.0950548
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02299390733242035, rmse:0.15163742005825043, mae:0.09486686438322067, rse:0.5737535953521729
Original data scale mse:3959525.75, rmse:1989.855712890625, mae:1283.2562255859375, rse:0.140165776014328
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2355672
	speed: 0.0550s/iter; left time: 490.9036s
	iters: 200, epoch: 1 | loss: 0.2082962
	speed: 0.0534s/iter; left time: 471.4107s
	iters: 300, epoch: 1 | loss: 0.2001346
	speed: 0.0535s/iter; left time: 466.3010s
	iters: 400, epoch: 1 | loss: 0.1898813
	speed: 0.0505s/iter; left time: 435.6436s
	iters: 500, epoch: 1 | loss: 0.1939274
	speed: 0.0536s/iter; left time: 456.8865s
	iters: 600, epoch: 1 | loss: 0.1758054
	speed: 0.0538s/iter; left time: 453.1958s
	iters: 700, epoch: 1 | loss: 0.1830661
	speed: 0.0536s/iter; left time: 446.1904s
	iters: 800, epoch: 1 | loss: 0.1783938
	speed: 0.0536s/iter; left time: 440.3851s
	iters: 900, epoch: 1 | loss: 0.1776050
	speed: 0.0537s/iter; left time: 435.9135s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.27s
Steps: 902 | Train Loss: 0.1993217 Vali Loss: 0.1684725 Test Loss: 0.1856237
Validation loss decreased (inf --> 0.168473).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1772077
	speed: 0.1382s/iter; left time: 1108.5755s
	iters: 200, epoch: 2 | loss: 0.1593870
	speed: 0.0535s/iter; left time: 424.0562s
	iters: 300, epoch: 2 | loss: 0.1458719
	speed: 0.0537s/iter; left time: 419.5145s
	iters: 400, epoch: 2 | loss: 0.1398193
	speed: 0.0534s/iter; left time: 412.2365s
	iters: 500, epoch: 2 | loss: 0.1258138
	speed: 0.0536s/iter; left time: 408.5763s
	iters: 600, epoch: 2 | loss: 0.1268865
	speed: 0.0537s/iter; left time: 403.5820s
	iters: 700, epoch: 2 | loss: 0.1063164
	speed: 0.0534s/iter; left time: 396.2074s
	iters: 800, epoch: 2 | loss: 0.1085631
	speed: 0.0537s/iter; left time: 392.7548s
	iters: 900, epoch: 2 | loss: 0.1064118
	speed: 0.0535s/iter; left time: 385.9334s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.58s
Steps: 902 | Train Loss: 0.1362844 Vali Loss: 0.0990677 Test Loss: 0.1042230
Validation loss decreased (0.168473 --> 0.099068).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0998725
	speed: 0.1361s/iter; left time: 968.4711s
	iters: 200, epoch: 3 | loss: 0.0983012
	speed: 0.0536s/iter; left time: 375.8272s
	iters: 300, epoch: 3 | loss: 0.0917605
	speed: 0.0536s/iter; left time: 370.9441s
	iters: 400, epoch: 3 | loss: 0.0950676
	speed: 0.0532s/iter; left time: 362.9610s
	iters: 500, epoch: 3 | loss: 0.0909999
	speed: 0.0534s/iter; left time: 358.7169s
	iters: 600, epoch: 3 | loss: 0.0889725
	speed: 0.0535s/iter; left time: 354.3174s
	iters: 700, epoch: 3 | loss: 0.0891478
	speed: 0.0534s/iter; left time: 348.2011s
	iters: 800, epoch: 3 | loss: 0.0936719
	speed: 0.0536s/iter; left time: 344.2168s
	iters: 900, epoch: 3 | loss: 0.0865493
	speed: 0.0536s/iter; left time: 338.6365s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.51s
Steps: 902 | Train Loss: 0.0931072 Vali Loss: 0.0867504 Test Loss: 0.0969969
Validation loss decreased (0.099068 --> 0.086750).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0893613
	speed: 0.1335s/iter; left time: 829.5846s
	iters: 200, epoch: 4 | loss: 0.0867445
	speed: 0.0537s/iter; left time: 328.1827s
	iters: 300, epoch: 4 | loss: 0.0891742
	speed: 0.0537s/iter; left time: 322.7572s
	iters: 400, epoch: 4 | loss: 0.0909827
	speed: 0.0536s/iter; left time: 316.9791s
	iters: 500, epoch: 4 | loss: 0.0847673
	speed: 0.0536s/iter; left time: 311.5998s
	iters: 600, epoch: 4 | loss: 0.0848179
	speed: 0.0536s/iter; left time: 306.1912s
	iters: 700, epoch: 4 | loss: 0.0837448
	speed: 0.0537s/iter; left time: 301.2962s
	iters: 800, epoch: 4 | loss: 0.0826288
	speed: 0.0537s/iter; left time: 296.1636s
	iters: 900, epoch: 4 | loss: 0.0867797
	speed: 0.0536s/iter; left time: 290.0531s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.58s
Steps: 902 | Train Loss: 0.0861360 Vali Loss: 0.0855893 Test Loss: 0.0923006
Validation loss decreased (0.086750 --> 0.085589).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0843569
	speed: 0.1323s/iter; left time: 702.6738s
	iters: 200, epoch: 5 | loss: 0.0802317
	speed: 0.0533s/iter; left time: 277.7716s
	iters: 300, epoch: 5 | loss: 0.0815511
	speed: 0.0444s/iter; left time: 226.9064s
	iters: 400, epoch: 5 | loss: 0.0857412
	speed: 0.0493s/iter; left time: 247.2085s
	iters: 500, epoch: 5 | loss: 0.0838052
	speed: 0.0535s/iter; left time: 262.8507s
	iters: 600, epoch: 5 | loss: 0.0853470
	speed: 0.0534s/iter; left time: 256.9961s
	iters: 700, epoch: 5 | loss: 0.0854153
	speed: 0.0534s/iter; left time: 251.4942s
	iters: 800, epoch: 5 | loss: 0.0780036
	speed: 0.0537s/iter; left time: 247.5287s
	iters: 900, epoch: 5 | loss: 0.0753279
	speed: 0.0535s/iter; left time: 241.4745s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.11s
Steps: 902 | Train Loss: 0.0815848 Vali Loss: 0.0841493 Test Loss: 0.0947114
Validation loss decreased (0.085589 --> 0.084149).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0812029
	speed: 0.1327s/iter; left time: 585.3540s
	iters: 200, epoch: 6 | loss: 0.0748727
	speed: 0.0536s/iter; left time: 230.9717s
	iters: 300, epoch: 6 | loss: 0.0804090
	speed: 0.0534s/iter; left time: 224.8703s
	iters: 400, epoch: 6 | loss: 0.0886825
	speed: 0.0536s/iter; left time: 220.2488s
	iters: 500, epoch: 6 | loss: 0.0724488
	speed: 0.0536s/iter; left time: 215.1116s
	iters: 600, epoch: 6 | loss: 0.0776584
	speed: 0.0534s/iter; left time: 209.0327s
	iters: 700, epoch: 6 | loss: 0.0772588
	speed: 0.0534s/iter; left time: 203.4286s
	iters: 800, epoch: 6 | loss: 0.0730131
	speed: 0.0534s/iter; left time: 198.0591s
	iters: 900, epoch: 6 | loss: 0.0727902
	speed: 0.0537s/iter; left time: 193.7541s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.50s
Steps: 902 | Train Loss: 0.0776841 Vali Loss: 0.0844284 Test Loss: 0.0970682
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0801010
	speed: 0.1291s/iter; left time: 452.9455s
	iters: 200, epoch: 7 | loss: 0.0696431
	speed: 0.0534s/iter; left time: 182.0305s
	iters: 300, epoch: 7 | loss: 0.0785697
	speed: 0.0535s/iter; left time: 176.9202s
	iters: 400, epoch: 7 | loss: 0.0787124
	speed: 0.0535s/iter; left time: 171.7072s
	iters: 500, epoch: 7 | loss: 0.0768499
	speed: 0.0536s/iter; left time: 166.4997s
	iters: 600, epoch: 7 | loss: 0.0727005
	speed: 0.0535s/iter; left time: 160.9517s
	iters: 700, epoch: 7 | loss: 0.0715927
	speed: 0.0529s/iter; left time: 153.8591s
	iters: 800, epoch: 7 | loss: 0.0703656
	speed: 0.0535s/iter; left time: 150.2613s
	iters: 900, epoch: 7 | loss: 0.0697115
	speed: 0.0536s/iter; left time: 145.1048s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.39s
Steps: 902 | Train Loss: 0.0739525 Vali Loss: 0.0846868 Test Loss: 0.0978098
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0693346
	speed: 0.1290s/iter; left time: 336.4067s
	iters: 200, epoch: 8 | loss: 0.0674614
	speed: 0.0536s/iter; left time: 134.3733s
	iters: 300, epoch: 8 | loss: 0.0711595
	speed: 0.0532s/iter; left time: 128.1560s
	iters: 400, epoch: 8 | loss: 0.0698352
	speed: 0.0535s/iter; left time: 123.4025s
	iters: 500, epoch: 8 | loss: 0.0765227
	speed: 0.0534s/iter; left time: 117.8613s
	iters: 600, epoch: 8 | loss: 0.0681868
	speed: 0.0535s/iter; left time: 112.7772s
	iters: 700, epoch: 8 | loss: 0.0718112
	speed: 0.0533s/iter; left time: 106.9776s
	iters: 800, epoch: 8 | loss: 0.0683741
	speed: 0.0532s/iter; left time: 101.5390s
	iters: 900, epoch: 8 | loss: 0.0696974
	speed: 0.0534s/iter; left time: 96.5459s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.41s
Steps: 902 | Train Loss: 0.0703952 Vali Loss: 0.0860372 Test Loss: 0.0952666
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02248666062951088, rmse:0.14995552599430084, mae:0.09472323209047318, rse:0.5673897862434387
Original data scale mse:4440883.0, rmse:2107.34033203125, mae:1338.431884765625, rse:0.1484414041042328

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.02299390733242035, RMSE: 0.15163742005825043, MAE: 0.09486686438322067, RSE: 0.5737535953521729
Unscaled Metrics - MSE: 3959525.75, RMSE: 1989.855712890625, MAE: 1283.2562255859375, RSE: 0.140165776014328

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.02248666062951088, RMSE: 0.14995552599430084, MAE: 0.09472323209047318, RSE: 0.5673897862434387
Unscaled Metrics - MSE: 4440883.0, RMSE: 2107.34033203125, MAE: 1338.431884765625, RSE: 0.1484414041042328
