
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0942546
	speed: 0.0700s/iter; left time: 627.7158s
	iters: 200, epoch: 1 | loss: 0.0667797
	speed: 0.0408s/iter; left time: 361.3990s
	iters: 300, epoch: 1 | loss: 0.0588467
	speed: 0.0407s/iter; left time: 356.6063s
	iters: 400, epoch: 1 | loss: 0.0457102
	speed: 0.0405s/iter; left time: 350.7956s
	iters: 500, epoch: 1 | loss: 0.0421427
	speed: 0.0406s/iter; left time: 347.6140s
	iters: 600, epoch: 1 | loss: 0.0368923
	speed: 0.0409s/iter; left time: 345.6893s
	iters: 700, epoch: 1 | loss: 0.0460224
	speed: 0.0412s/iter; left time: 344.5950s
	iters: 800, epoch: 1 | loss: 0.0355560
	speed: 0.0410s/iter; left time: 338.4662s
	iters: 900, epoch: 1 | loss: 0.0282983
	speed: 0.0408s/iter; left time: 332.6258s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.75s
Steps: 906 | Train Loss: 0.0578716 Vali Loss: 0.0328540 Test Loss: 0.0360874
Validation loss decreased (inf --> 0.032854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0200453
	speed: 0.1070s/iter; left time: 861.7894s
	iters: 200, epoch: 2 | loss: 0.0261499
	speed: 0.0409s/iter; left time: 325.3522s
	iters: 300, epoch: 2 | loss: 0.0187321
	speed: 0.0410s/iter; left time: 322.0977s
	iters: 400, epoch: 2 | loss: 0.0183808
	speed: 0.0406s/iter; left time: 315.0277s
	iters: 500, epoch: 2 | loss: 0.0152190
	speed: 0.0404s/iter; left time: 309.5811s
	iters: 600, epoch: 2 | loss: 0.0156461
	speed: 0.0414s/iter; left time: 312.7897s
	iters: 700, epoch: 2 | loss: 0.0146780
	speed: 0.0419s/iter; left time: 312.0975s
	iters: 800, epoch: 2 | loss: 0.0206594
	speed: 0.0400s/iter; left time: 294.5469s
	iters: 900, epoch: 2 | loss: 0.0144302
	speed: 0.0414s/iter; left time: 300.3895s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.39s
Steps: 906 | Train Loss: 0.0199861 Vali Loss: 0.0212579 Test Loss: 0.0242976
Validation loss decreased (0.032854 --> 0.021258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0159689
	speed: 0.1015s/iter; left time: 725.9778s
	iters: 200, epoch: 3 | loss: 0.0128649
	speed: 0.0405s/iter; left time: 285.3480s
	iters: 300, epoch: 3 | loss: 0.0146372
	speed: 0.0407s/iter; left time: 283.0179s
	iters: 400, epoch: 3 | loss: 0.0158485
	speed: 0.0406s/iter; left time: 278.0355s
	iters: 500, epoch: 3 | loss: 0.0186484
	speed: 0.0409s/iter; left time: 275.8659s
	iters: 600, epoch: 3 | loss: 0.0192382
	speed: 0.0406s/iter; left time: 270.1737s
	iters: 700, epoch: 3 | loss: 0.0138006
	speed: 0.0407s/iter; left time: 266.8225s
	iters: 800, epoch: 3 | loss: 0.0132834
	speed: 0.0407s/iter; left time: 262.5218s
	iters: 900, epoch: 3 | loss: 0.0159991
	speed: 0.0406s/iter; left time: 257.7569s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.15s
Steps: 906 | Train Loss: 0.0146077 Vali Loss: 0.0212980 Test Loss: 0.0228801
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0104485
	speed: 0.0938s/iter; left time: 585.4653s
	iters: 200, epoch: 4 | loss: 0.0125054
	speed: 0.0410s/iter; left time: 251.9391s
	iters: 300, epoch: 4 | loss: 0.0128581
	speed: 0.0409s/iter; left time: 247.0135s
	iters: 400, epoch: 4 | loss: 0.0100157
	speed: 0.0408s/iter; left time: 242.2898s
	iters: 500, epoch: 4 | loss: 0.0132754
	speed: 0.0407s/iter; left time: 237.9373s
	iters: 600, epoch: 4 | loss: 0.0139050
	speed: 0.0410s/iter; left time: 235.3904s
	iters: 700, epoch: 4 | loss: 0.0112287
	speed: 0.0411s/iter; left time: 231.9881s
	iters: 800, epoch: 4 | loss: 0.0141093
	speed: 0.0412s/iter; left time: 228.4658s
	iters: 900, epoch: 4 | loss: 0.0116282
	speed: 0.0409s/iter; left time: 222.4809s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.18s
Steps: 906 | Train Loss: 0.0129339 Vali Loss: 0.0229334 Test Loss: 0.0247191
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0140071
	speed: 0.0824s/iter; left time: 439.5661s
	iters: 200, epoch: 5 | loss: 0.0111624
	speed: 0.0283s/iter; left time: 147.9461s
	iters: 300, epoch: 5 | loss: 0.0104040
	speed: 0.0282s/iter; left time: 145.1094s
	iters: 400, epoch: 5 | loss: 0.0135564
	speed: 0.0282s/iter; left time: 142.0852s
	iters: 500, epoch: 5 | loss: 0.0099290
	speed: 0.0282s/iter; left time: 139.2726s
	iters: 600, epoch: 5 | loss: 0.0110839
	speed: 0.0282s/iter; left time: 136.3802s
	iters: 700, epoch: 5 | loss: 0.0107402
	speed: 0.0282s/iter; left time: 133.7749s
	iters: 800, epoch: 5 | loss: 0.0121734
	speed: 0.0282s/iter; left time: 130.9026s
	iters: 900, epoch: 5 | loss: 0.0128513
	speed: 0.0282s/iter; left time: 127.9846s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:25.81s
Steps: 906 | Train Loss: 0.0116328 Vali Loss: 0.0209129 Test Loss: 0.0249126
Validation loss decreased (0.021258 --> 0.020913).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0121859
	speed: 0.1069s/iter; left time: 473.6636s
	iters: 200, epoch: 6 | loss: 0.0115178
	speed: 0.0415s/iter; left time: 179.8720s
	iters: 300, epoch: 6 | loss: 0.0104146
	speed: 0.0408s/iter; left time: 172.4728s
	iters: 400, epoch: 6 | loss: 0.0115494
	speed: 0.0415s/iter; left time: 171.2343s
	iters: 500, epoch: 6 | loss: 0.0119643
	speed: 0.0416s/iter; left time: 167.5382s
	iters: 600, epoch: 6 | loss: 0.0081770
	speed: 0.0417s/iter; left time: 163.8169s
	iters: 700, epoch: 6 | loss: 0.0123818
	speed: 0.0411s/iter; left time: 157.5467s
	iters: 800, epoch: 6 | loss: 0.0079767
	speed: 0.0410s/iter; left time: 153.0460s
	iters: 900, epoch: 6 | loss: 0.0072877
	speed: 0.0409s/iter; left time: 148.4073s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.61s
Steps: 906 | Train Loss: 0.0099782 Vali Loss: 0.0219904 Test Loss: 0.0262837
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0073663
	speed: 0.0946s/iter; left time: 333.4701s
	iters: 200, epoch: 7 | loss: 0.0101608
	speed: 0.0406s/iter; left time: 139.0480s
	iters: 300, epoch: 7 | loss: 0.0081983
	speed: 0.0406s/iter; left time: 135.1511s
	iters: 400, epoch: 7 | loss: 0.0104248
	speed: 0.0405s/iter; left time: 130.6221s
	iters: 500, epoch: 7 | loss: 0.0086621
	speed: 0.0415s/iter; left time: 129.6926s
	iters: 600, epoch: 7 | loss: 0.0076589
	speed: 0.0409s/iter; left time: 123.7931s
	iters: 700, epoch: 7 | loss: 0.0073568
	speed: 0.0407s/iter; left time: 119.0445s
	iters: 800, epoch: 7 | loss: 0.0081911
	speed: 0.0413s/iter; left time: 116.6765s
	iters: 900, epoch: 7 | loss: 0.0091360
	speed: 0.0415s/iter; left time: 113.0128s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.31s
Steps: 906 | Train Loss: 0.0087739 Vali Loss: 0.0225039 Test Loss: 0.0279977
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0083496
	speed: 0.0946s/iter; left time: 247.8221s
	iters: 200, epoch: 8 | loss: 0.0081475
	speed: 0.0415s/iter; left time: 104.4573s
	iters: 300, epoch: 8 | loss: 0.0073608
	speed: 0.0413s/iter; left time: 99.9306s
	iters: 400, epoch: 8 | loss: 0.0073632
	speed: 0.0408s/iter; left time: 94.5886s
	iters: 500, epoch: 8 | loss: 0.0064928
	speed: 0.0411s/iter; left time: 91.1606s
	iters: 600, epoch: 8 | loss: 0.0057923
	speed: 0.0415s/iter; left time: 87.9722s
	iters: 700, epoch: 8 | loss: 0.0083221
	speed: 0.0413s/iter; left time: 83.3585s
	iters: 800, epoch: 8 | loss: 0.0076627
	speed: 0.0412s/iter; left time: 79.0234s
	iters: 900, epoch: 8 | loss: 0.0086224
	speed: 0.0408s/iter; left time: 74.1826s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.50s
Steps: 906 | Train Loss: 0.0077076 Vali Loss: 0.0230374 Test Loss: 0.0285441
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02496965043246746, rmse:0.15801787376403809, mae:0.10408886522054672, rse:0.55804443359375
Original data scale mse:21478470.0, rmse:4634.48681640625, mae:2927.15283203125, rse:0.2304360270500183
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0938398
	speed: 0.0425s/iter; left time: 381.2046s
	iters: 200, epoch: 1 | loss: 0.0642789
	speed: 0.0407s/iter; left time: 360.2140s
	iters: 300, epoch: 1 | loss: 0.0629560
	speed: 0.0406s/iter; left time: 355.9833s
	iters: 400, epoch: 1 | loss: 0.0477485
	speed: 0.0404s/iter; left time: 350.2551s
	iters: 500, epoch: 1 | loss: 0.0532036
	speed: 0.0405s/iter; left time: 346.9005s
	iters: 600, epoch: 1 | loss: 0.0478263
	speed: 0.0407s/iter; left time: 344.6948s
	iters: 700, epoch: 1 | loss: 0.0405289
	speed: 0.0405s/iter; left time: 338.5439s
	iters: 800, epoch: 1 | loss: 0.0288731
	speed: 0.0408s/iter; left time: 337.3617s
	iters: 900, epoch: 1 | loss: 0.0323386
	speed: 0.0405s/iter; left time: 330.4046s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.06s
Steps: 906 | Train Loss: 0.0581791 Vali Loss: 0.0334077 Test Loss: 0.0377991
Validation loss decreased (inf --> 0.033408).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0285942
	speed: 0.1028s/iter; left time: 828.3814s
	iters: 200, epoch: 2 | loss: 0.0189234
	speed: 0.0412s/iter; left time: 327.3616s
	iters: 300, epoch: 2 | loss: 0.0159083
	speed: 0.0414s/iter; left time: 325.0453s
	iters: 400, epoch: 2 | loss: 0.0204149
	speed: 0.0415s/iter; left time: 321.6462s
	iters: 500, epoch: 2 | loss: 0.0143734
	speed: 0.0410s/iter; left time: 313.6170s
	iters: 600, epoch: 2 | loss: 0.0182881
	speed: 0.0417s/iter; left time: 314.9621s
	iters: 700, epoch: 2 | loss: 0.0160795
	speed: 0.0416s/iter; left time: 310.1215s
	iters: 800, epoch: 2 | loss: 0.0160197
	speed: 0.0415s/iter; left time: 305.4940s
	iters: 900, epoch: 2 | loss: 0.0163546
	speed: 0.0414s/iter; left time: 300.2803s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.85s
Steps: 906 | Train Loss: 0.0199710 Vali Loss: 0.0215980 Test Loss: 0.0231432
Validation loss decreased (0.033408 --> 0.021598).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0140854
	speed: 0.1017s/iter; left time: 727.2599s
	iters: 200, epoch: 3 | loss: 0.0205783
	speed: 0.0407s/iter; left time: 287.0602s
	iters: 300, epoch: 3 | loss: 0.0187233
	speed: 0.0412s/iter; left time: 286.5152s
	iters: 400, epoch: 3 | loss: 0.0169409
	speed: 0.0419s/iter; left time: 286.9073s
	iters: 500, epoch: 3 | loss: 0.0176392
	speed: 0.0415s/iter; left time: 279.9987s
	iters: 600, epoch: 3 | loss: 0.0134549
	speed: 0.0407s/iter; left time: 270.3361s
	iters: 700, epoch: 3 | loss: 0.0117885
	speed: 0.0406s/iter; left time: 265.7820s
	iters: 800, epoch: 3 | loss: 0.0129310
	speed: 0.0409s/iter; left time: 263.7808s
	iters: 900, epoch: 3 | loss: 0.0140353
	speed: 0.0408s/iter; left time: 258.9337s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.49s
Steps: 906 | Train Loss: 0.0143454 Vali Loss: 0.0208516 Test Loss: 0.0233106
Validation loss decreased (0.021598 --> 0.020852).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0143937
	speed: 0.0996s/iter; left time: 621.8131s
	iters: 200, epoch: 4 | loss: 0.0103517
	speed: 0.0417s/iter; left time: 256.3368s
	iters: 300, epoch: 4 | loss: 0.0144832
	speed: 0.0417s/iter; left time: 251.9122s
	iters: 400, epoch: 4 | loss: 0.0151069
	speed: 0.0414s/iter; left time: 245.9329s
	iters: 500, epoch: 4 | loss: 0.0142648
	speed: 0.0417s/iter; left time: 243.5854s
	iters: 600, epoch: 4 | loss: 0.0151003
	speed: 0.0414s/iter; left time: 237.7969s
	iters: 700, epoch: 4 | loss: 0.0103973
	speed: 0.0408s/iter; left time: 230.0350s
	iters: 800, epoch: 4 | loss: 0.0104725
	speed: 0.0410s/iter; left time: 227.0628s
	iters: 900, epoch: 4 | loss: 0.0114167
	speed: 0.0415s/iter; left time: 225.7521s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.81s
Steps: 906 | Train Loss: 0.0127303 Vali Loss: 0.0203258 Test Loss: 0.0228659
Validation loss decreased (0.020852 --> 0.020326).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0112127
	speed: 0.0981s/iter; left time: 523.5135s
	iters: 200, epoch: 5 | loss: 0.0120055
	speed: 0.0411s/iter; left time: 215.2658s
	iters: 300, epoch: 5 | loss: 0.0105872
	speed: 0.0412s/iter; left time: 211.5021s
	iters: 400, epoch: 5 | loss: 0.0095046
	speed: 0.0408s/iter; left time: 205.7146s
	iters: 500, epoch: 5 | loss: 0.0124287
	speed: 0.0415s/iter; left time: 205.0714s
	iters: 600, epoch: 5 | loss: 0.0123740
	speed: 0.0415s/iter; left time: 200.9555s
	iters: 700, epoch: 5 | loss: 0.0126600
	speed: 0.0414s/iter; left time: 195.8994s
	iters: 800, epoch: 5 | loss: 0.0142700
	speed: 0.0414s/iter; left time: 191.9503s
	iters: 900, epoch: 5 | loss: 0.0119086
	speed: 0.0416s/iter; left time: 188.5246s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.62s
Steps: 906 | Train Loss: 0.0110497 Vali Loss: 0.0213849 Test Loss: 0.0252486
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0091037
	speed: 0.0954s/iter; left time: 422.6417s
	iters: 200, epoch: 6 | loss: 0.0097279
	speed: 0.0416s/iter; left time: 180.0149s
	iters: 300, epoch: 6 | loss: 0.0106359
	speed: 0.0418s/iter; left time: 176.7906s
	iters: 400, epoch: 6 | loss: 0.0091133
	speed: 0.0410s/iter; left time: 169.5551s
	iters: 500, epoch: 6 | loss: 0.0097699
	speed: 0.0412s/iter; left time: 165.9132s
	iters: 600, epoch: 6 | loss: 0.0069945
	speed: 0.0410s/iter; left time: 161.0406s
	iters: 700, epoch: 6 | loss: 0.0091658
	speed: 0.0415s/iter; left time: 159.0774s
	iters: 800, epoch: 6 | loss: 0.0087391
	speed: 0.0409s/iter; left time: 152.6115s
	iters: 900, epoch: 6 | loss: 0.0090745
	speed: 0.0410s/iter; left time: 148.7389s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.65s
Steps: 906 | Train Loss: 0.0096277 Vali Loss: 0.0212603 Test Loss: 0.0247180
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0102733
	speed: 0.0962s/iter; left time: 338.9697s
	iters: 200, epoch: 7 | loss: 0.0070053
	speed: 0.0411s/iter; left time: 140.6991s
	iters: 300, epoch: 7 | loss: 0.0102707
	speed: 0.0410s/iter; left time: 136.2691s
	iters: 400, epoch: 7 | loss: 0.0087207
	speed: 0.0410s/iter; left time: 132.2213s
	iters: 500, epoch: 7 | loss: 0.0102770
	speed: 0.0408s/iter; left time: 127.3535s
	iters: 600, epoch: 7 | loss: 0.0107841
	speed: 0.0412s/iter; left time: 124.6287s
	iters: 700, epoch: 7 | loss: 0.0091903
	speed: 0.0411s/iter; left time: 120.0760s
	iters: 800, epoch: 7 | loss: 0.0090340
	speed: 0.0409s/iter; left time: 115.6283s
	iters: 900, epoch: 7 | loss: 0.0084766
	speed: 0.0405s/iter; left time: 110.4607s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.41s
Steps: 906 | Train Loss: 0.0083809 Vali Loss: 0.0239215 Test Loss: 0.0280777
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.022877730429172516, rmse:0.1512538641691208, mae:0.10139743983745575, rse:0.5341570973396301
Original data scale mse:19517502.0, rmse:4417.86181640625, mae:2843.488037109375, rse:0.21966499090194702

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.02496965043246746, RMSE: 0.15801787376403809, MAE: 0.10408886522054672, RSE: 0.55804443359375
Unscaled Metrics - MSE: 21478470.0, RMSE: 4634.48681640625, MAE: 2927.15283203125, RSE: 0.2304360270500183

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.022877730429172516, RMSE: 0.1512538641691208, MAE: 0.10139743983745575, RSE: 0.5341570973396301
Unscaled Metrics - MSE: 19517502.0, RMSE: 4417.86181640625, MAE: 2843.488037109375, RSE: 0.21966499090194702

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0945499
	speed: 0.0804s/iter; left time: 718.9307s
	iters: 200, epoch: 1 | loss: 0.0813206
	speed: 0.0500s/iter; left time: 442.4028s
	iters: 300, epoch: 1 | loss: 0.0689713
	speed: 0.0493s/iter; left time: 430.5452s
	iters: 400, epoch: 1 | loss: 0.0582750
	speed: 0.0480s/iter; left time: 414.6301s
	iters: 500, epoch: 1 | loss: 0.0542483
	speed: 0.0481s/iter; left time: 410.4966s
	iters: 600, epoch: 1 | loss: 0.0503807
	speed: 0.0480s/iter; left time: 405.2029s
	iters: 700, epoch: 1 | loss: 0.0456270
	speed: 0.0480s/iter; left time: 400.7814s
	iters: 800, epoch: 1 | loss: 0.0463673
	speed: 0.0496s/iter; left time: 408.4281s
	iters: 900, epoch: 1 | loss: 0.0438126
	speed: 0.0504s/iter; left time: 410.0708s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:45.16s
Steps: 904 | Train Loss: 0.0647476 Vali Loss: 0.0486602 Test Loss: 0.0615587
Validation loss decreased (inf --> 0.048660).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0290388
	speed: 0.1199s/iter; left time: 963.5849s
	iters: 200, epoch: 2 | loss: 0.0303201
	speed: 0.0482s/iter; left time: 382.4958s
	iters: 300, epoch: 2 | loss: 0.0295338
	speed: 0.0481s/iter; left time: 376.9743s
	iters: 400, epoch: 2 | loss: 0.0259183
	speed: 0.0481s/iter; left time: 372.2034s
	iters: 500, epoch: 2 | loss: 0.0269378
	speed: 0.0480s/iter; left time: 366.3616s
	iters: 600, epoch: 2 | loss: 0.0310408
	speed: 0.0476s/iter; left time: 358.7047s
	iters: 700, epoch: 2 | loss: 0.0253571
	speed: 0.0356s/iter; left time: 264.5605s
	iters: 800, epoch: 2 | loss: 0.0286073
	speed: 0.0355s/iter; left time: 260.6318s
	iters: 900, epoch: 2 | loss: 0.0237425
	speed: 0.0355s/iter; left time: 257.0965s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.82s
Steps: 904 | Train Loss: 0.0288204 Vali Loss: 0.0342063 Test Loss: 0.0416341
Validation loss decreased (0.048660 --> 0.034206).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0266491
	speed: 0.1159s/iter; left time: 826.6766s
	iters: 200, epoch: 3 | loss: 0.0200128
	speed: 0.0477s/iter; left time: 335.3482s
	iters: 300, epoch: 3 | loss: 0.0205474
	speed: 0.0478s/iter; left time: 331.0808s
	iters: 400, epoch: 3 | loss: 0.0209371
	speed: 0.0477s/iter; left time: 325.9392s
	iters: 500, epoch: 3 | loss: 0.0211199
	speed: 0.0478s/iter; left time: 322.0576s
	iters: 600, epoch: 3 | loss: 0.0268021
	speed: 0.0478s/iter; left time: 316.9888s
	iters: 700, epoch: 3 | loss: 0.0192956
	speed: 0.0477s/iter; left time: 311.5624s
	iters: 800, epoch: 3 | loss: 0.0224315
	speed: 0.0476s/iter; left time: 306.4048s
	iters: 900, epoch: 3 | loss: 0.0214192
	speed: 0.0476s/iter; left time: 301.2055s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.23s
Steps: 904 | Train Loss: 0.0229189 Vali Loss: 0.0342457 Test Loss: 0.0418113
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0187121
	speed: 0.1145s/iter; left time: 713.0368s
	iters: 200, epoch: 4 | loss: 0.0181936
	speed: 0.0478s/iter; left time: 293.1747s
	iters: 300, epoch: 4 | loss: 0.0200255
	speed: 0.0479s/iter; left time: 288.6336s
	iters: 400, epoch: 4 | loss: 0.0162172
	speed: 0.0479s/iter; left time: 284.2420s
	iters: 500, epoch: 4 | loss: 0.0216165
	speed: 0.0481s/iter; left time: 280.3720s
	iters: 600, epoch: 4 | loss: 0.0161444
	speed: 0.0482s/iter; left time: 275.9975s
	iters: 700, epoch: 4 | loss: 0.0214690
	speed: 0.0480s/iter; left time: 270.0373s
	iters: 800, epoch: 4 | loss: 0.0181671
	speed: 0.0481s/iter; left time: 265.8662s
	iters: 900, epoch: 4 | loss: 0.0226844
	speed: 0.0479s/iter; left time: 260.2793s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.64s
Steps: 904 | Train Loss: 0.0199593 Vali Loss: 0.0352827 Test Loss: 0.0429098
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0180635
	speed: 0.1144s/iter; left time: 609.4337s
	iters: 200, epoch: 5 | loss: 0.0210786
	speed: 0.0480s/iter; left time: 250.8851s
	iters: 300, epoch: 5 | loss: 0.0164446
	speed: 0.0480s/iter; left time: 246.1041s
	iters: 400, epoch: 5 | loss: 0.0171539
	speed: 0.0460s/iter; left time: 231.0193s
	iters: 500, epoch: 5 | loss: 0.0164758
	speed: 0.0478s/iter; left time: 235.3526s
	iters: 600, epoch: 5 | loss: 0.0173010
	speed: 0.0479s/iter; left time: 231.1727s
	iters: 700, epoch: 5 | loss: 0.0152048
	speed: 0.0479s/iter; left time: 226.5249s
	iters: 800, epoch: 5 | loss: 0.0145456
	speed: 0.0480s/iter; left time: 221.9807s
	iters: 900, epoch: 5 | loss: 0.0151162
	speed: 0.0479s/iter; left time: 216.8844s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.40s
Steps: 904 | Train Loss: 0.0170921 Vali Loss: 0.0348996 Test Loss: 0.0446376
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041615840047597885, rmse:0.2039996087551117, mae:0.14690826833248138, rse:0.7224038243293762
Original data scale mse:38027972.0, rmse:6166.6826171875, mae:4192.33154296875, rse:0.3071029782295227
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0934298
	speed: 0.0507s/iter; left time: 453.3141s
	iters: 200, epoch: 1 | loss: 0.0724698
	speed: 0.0477s/iter; left time: 421.3680s
	iters: 300, epoch: 1 | loss: 0.0670248
	speed: 0.0478s/iter; left time: 418.0132s
	iters: 400, epoch: 1 | loss: 0.0601231
	speed: 0.0477s/iter; left time: 411.7807s
	iters: 500, epoch: 1 | loss: 0.0589422
	speed: 0.0482s/iter; left time: 411.7008s
	iters: 600, epoch: 1 | loss: 0.0493249
	speed: 0.0504s/iter; left time: 425.6835s
	iters: 700, epoch: 1 | loss: 0.0617602
	speed: 0.0504s/iter; left time: 420.5116s
	iters: 800, epoch: 1 | loss: 0.0475968
	speed: 0.0503s/iter; left time: 414.8698s
	iters: 900, epoch: 1 | loss: 0.0497684
	speed: 0.0505s/iter; left time: 410.8179s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.67s
Steps: 904 | Train Loss: 0.0670265 Vali Loss: 0.0486257 Test Loss: 0.0613907
Validation loss decreased (inf --> 0.048626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0374997
	speed: 0.1161s/iter; left time: 933.4427s
	iters: 200, epoch: 2 | loss: 0.0309897
	speed: 0.0355s/iter; left time: 281.9439s
	iters: 300, epoch: 2 | loss: 0.0294268
	speed: 0.0355s/iter; left time: 278.3391s
	iters: 400, epoch: 2 | loss: 0.0241191
	speed: 0.0355s/iter; left time: 274.5109s
	iters: 500, epoch: 2 | loss: 0.0253514
	speed: 0.0355s/iter; left time: 271.1455s
	iters: 600, epoch: 2 | loss: 0.0310746
	speed: 0.0355s/iter; left time: 267.6506s
	iters: 700, epoch: 2 | loss: 0.0256869
	speed: 0.0356s/iter; left time: 264.3938s
	iters: 800, epoch: 2 | loss: 0.0268583
	speed: 0.0355s/iter; left time: 260.4595s
	iters: 900, epoch: 2 | loss: 0.0207889
	speed: 0.0355s/iter; left time: 256.7897s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:33.28s
Steps: 904 | Train Loss: 0.0290841 Vali Loss: 0.0344298 Test Loss: 0.0417856
Validation loss decreased (0.048626 --> 0.034430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0261266
	speed: 0.1228s/iter; left time: 876.0529s
	iters: 200, epoch: 3 | loss: 0.0260678
	speed: 0.0478s/iter; left time: 336.0701s
	iters: 300, epoch: 3 | loss: 0.0206129
	speed: 0.0477s/iter; left time: 330.9796s
	iters: 400, epoch: 3 | loss: 0.0226454
	speed: 0.0477s/iter; left time: 325.8309s
	iters: 500, epoch: 3 | loss: 0.0228899
	speed: 0.0478s/iter; left time: 321.8733s
	iters: 600, epoch: 3 | loss: 0.0228538
	speed: 0.0478s/iter; left time: 317.2094s
	iters: 700, epoch: 3 | loss: 0.0218899
	speed: 0.0478s/iter; left time: 312.1683s
	iters: 800, epoch: 3 | loss: 0.0265811
	speed: 0.0478s/iter; left time: 307.1878s
	iters: 900, epoch: 3 | loss: 0.0242745
	speed: 0.0475s/iter; left time: 300.9996s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.45s
Steps: 904 | Train Loss: 0.0228451 Vali Loss: 0.0336392 Test Loss: 0.0409652
Validation loss decreased (0.034430 --> 0.033639).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0228310
	speed: 0.1180s/iter; left time: 735.2555s
	iters: 200, epoch: 4 | loss: 0.0209504
	speed: 0.0479s/iter; left time: 293.7684s
	iters: 300, epoch: 4 | loss: 0.0185800
	speed: 0.0481s/iter; left time: 290.0404s
	iters: 400, epoch: 4 | loss: 0.0181875
	speed: 0.0481s/iter; left time: 284.9501s
	iters: 500, epoch: 4 | loss: 0.0187002
	speed: 0.0481s/iter; left time: 280.4168s
	iters: 600, epoch: 4 | loss: 0.0216594
	speed: 0.0482s/iter; left time: 275.8876s
	iters: 700, epoch: 4 | loss: 0.0190073
	speed: 0.0481s/iter; left time: 270.8143s
	iters: 800, epoch: 4 | loss: 0.0199375
	speed: 0.0479s/iter; left time: 264.9219s
	iters: 900, epoch: 4 | loss: 0.0178906
	speed: 0.0480s/iter; left time: 260.5433s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.70s
Steps: 904 | Train Loss: 0.0203049 Vali Loss: 0.0356499 Test Loss: 0.0466749
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0140134
	speed: 0.1147s/iter; left time: 610.7527s
	iters: 200, epoch: 5 | loss: 0.0168959
	speed: 0.0479s/iter; left time: 250.1738s
	iters: 300, epoch: 5 | loss: 0.0174581
	speed: 0.0478s/iter; left time: 245.0479s
	iters: 400, epoch: 5 | loss: 0.0161702
	speed: 0.0480s/iter; left time: 241.3474s
	iters: 500, epoch: 5 | loss: 0.0201695
	speed: 0.0480s/iter; left time: 236.6370s
	iters: 600, epoch: 5 | loss: 0.0151612
	speed: 0.0479s/iter; left time: 231.2103s
	iters: 700, epoch: 5 | loss: 0.0207555
	speed: 0.0480s/iter; left time: 226.9880s
	iters: 800, epoch: 5 | loss: 0.0172408
	speed: 0.0479s/iter; left time: 221.6750s
	iters: 900, epoch: 5 | loss: 0.0148860
	speed: 0.0477s/iter; left time: 215.9573s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.57s
Steps: 904 | Train Loss: 0.0178362 Vali Loss: 0.0331190 Test Loss: 0.0419096
Validation loss decreased (0.033639 --> 0.033119).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0144145
	speed: 0.1233s/iter; left time: 545.2123s
	iters: 200, epoch: 6 | loss: 0.0169662
	speed: 0.0479s/iter; left time: 206.7737s
	iters: 300, epoch: 6 | loss: 0.0174153
	speed: 0.0478s/iter; left time: 201.9536s
	iters: 400, epoch: 6 | loss: 0.0158803
	speed: 0.0480s/iter; left time: 197.6887s
	iters: 500, epoch: 6 | loss: 0.0153488
	speed: 0.0479s/iter; left time: 192.4610s
	iters: 600, epoch: 6 | loss: 0.0144447
	speed: 0.0481s/iter; left time: 188.4310s
	iters: 700, epoch: 6 | loss: 0.0143681
	speed: 0.0481s/iter; left time: 183.8511s
	iters: 800, epoch: 6 | loss: 0.0135953
	speed: 0.0479s/iter; left time: 178.3391s
	iters: 900, epoch: 6 | loss: 0.0135909
	speed: 0.0480s/iter; left time: 173.9635s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.68s
Steps: 904 | Train Loss: 0.0152141 Vali Loss: 0.0362119 Test Loss: 0.0441905
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0117771
	speed: 0.1146s/iter; left time: 403.0666s
	iters: 200, epoch: 7 | loss: 0.0153151
	speed: 0.0480s/iter; left time: 164.0703s
	iters: 300, epoch: 7 | loss: 0.0163094
	speed: 0.0481s/iter; left time: 159.5725s
	iters: 400, epoch: 7 | loss: 0.0121797
	speed: 0.0478s/iter; left time: 153.6245s
	iters: 500, epoch: 7 | loss: 0.0131824
	speed: 0.0478s/iter; left time: 148.8505s
	iters: 600, epoch: 7 | loss: 0.0118811
	speed: 0.0480s/iter; left time: 144.7546s
	iters: 700, epoch: 7 | loss: 0.0120821
	speed: 0.0475s/iter; left time: 138.7008s
	iters: 800, epoch: 7 | loss: 0.0115689
	speed: 0.0479s/iter; left time: 135.0149s
	iters: 900, epoch: 7 | loss: 0.0110598
	speed: 0.0479s/iter; left time: 130.2394s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.56s
Steps: 904 | Train Loss: 0.0131583 Vali Loss: 0.0358438 Test Loss: 0.0466085
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0126066
	speed: 0.1147s/iter; left time: 299.5809s
	iters: 200, epoch: 8 | loss: 0.0109178
	speed: 0.0478s/iter; left time: 120.1959s
	iters: 300, epoch: 8 | loss: 0.0105501
	speed: 0.0479s/iter; left time: 115.6187s
	iters: 400, epoch: 8 | loss: 0.0104000
	speed: 0.0478s/iter; left time: 110.5759s
	iters: 500, epoch: 8 | loss: 0.0107914
	speed: 0.0476s/iter; left time: 105.3679s
	iters: 600, epoch: 8 | loss: 0.0112817
	speed: 0.0480s/iter; left time: 101.3766s
	iters: 700, epoch: 8 | loss: 0.0132655
	speed: 0.0476s/iter; left time: 95.8793s
	iters: 800, epoch: 8 | loss: 0.0105933
	speed: 0.0478s/iter; left time: 91.4673s
	iters: 900, epoch: 8 | loss: 0.0097098
	speed: 0.0479s/iter; left time: 86.7910s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.50s
Steps: 904 | Train Loss: 0.0114334 Vali Loss: 0.0356914 Test Loss: 0.0472074
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041922442615032196, rmse:0.2047497034072876, mae:0.14136722683906555, rse:0.7250601053237915
Original data scale mse:38741736.0, rmse:6224.2861328125, mae:4020.862548828125, rse:0.3099716603755951

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.041615840047597885, RMSE: 0.2039996087551117, MAE: 0.14690826833248138, RSE: 0.7224038243293762
Unscaled Metrics - MSE: 38027972.0, RMSE: 6166.6826171875, MAE: 4192.33154296875, RSE: 0.3071029782295227

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.041922442615032196, RMSE: 0.2047497034072876, MAE: 0.14136722683906555, RSE: 0.7250601053237915
Unscaled Metrics - MSE: 38741736.0, RMSE: 6224.2861328125, MAE: 4020.862548828125, RSE: 0.3099716603755951

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0873523
	speed: 0.0825s/iter; left time: 736.2686s
	iters: 200, epoch: 1 | loss: 0.0789642
	speed: 0.0538s/iter; left time: 474.3834s
	iters: 300, epoch: 1 | loss: 0.0649056
	speed: 0.0534s/iter; left time: 466.0224s
	iters: 400, epoch: 1 | loss: 0.0617752
	speed: 0.0535s/iter; left time: 461.5456s
	iters: 500, epoch: 1 | loss: 0.0583439
	speed: 0.0538s/iter; left time: 458.6291s
	iters: 600, epoch: 1 | loss: 0.0582502
	speed: 0.0535s/iter; left time: 450.2001s
	iters: 700, epoch: 1 | loss: 0.0537353
	speed: 0.0537s/iter; left time: 447.1793s
	iters: 800, epoch: 1 | loss: 0.0514252
	speed: 0.0536s/iter; left time: 440.7911s
	iters: 900, epoch: 1 | loss: 0.0530902
	speed: 0.0536s/iter; left time: 435.3057s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.13s
Steps: 902 | Train Loss: 0.0672486 Vali Loss: 0.0566032 Test Loss: 0.0734987
Validation loss decreased (inf --> 0.056603).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0474865
	speed: 0.1366s/iter; left time: 1095.4581s
	iters: 200, epoch: 2 | loss: 0.0358440
	speed: 0.0537s/iter; left time: 425.2152s
	iters: 300, epoch: 2 | loss: 0.0414159
	speed: 0.0537s/iter; left time: 419.9536s
	iters: 400, epoch: 2 | loss: 0.0342225
	speed: 0.0536s/iter; left time: 413.8588s
	iters: 500, epoch: 2 | loss: 0.0330931
	speed: 0.0536s/iter; left time: 408.6210s
	iters: 600, epoch: 2 | loss: 0.0289756
	speed: 0.0536s/iter; left time: 403.0532s
	iters: 700, epoch: 2 | loss: 0.0288790
	speed: 0.0537s/iter; left time: 398.1771s
	iters: 800, epoch: 2 | loss: 0.0331658
	speed: 0.0536s/iter; left time: 392.0846s
	iters: 900, epoch: 2 | loss: 0.0241773
	speed: 0.0533s/iter; left time: 384.8963s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.0342880 Vali Loss: 0.0365227 Test Loss: 0.0451551
Validation loss decreased (0.056603 --> 0.036523).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0288659
	speed: 0.1385s/iter; left time: 985.4032s
	iters: 200, epoch: 3 | loss: 0.0243717
	speed: 0.0537s/iter; left time: 376.5400s
	iters: 300, epoch: 3 | loss: 0.0256150
	speed: 0.0538s/iter; left time: 371.9475s
	iters: 400, epoch: 3 | loss: 0.0281696
	speed: 0.0538s/iter; left time: 366.5797s
	iters: 500, epoch: 3 | loss: 0.0227520
	speed: 0.0537s/iter; left time: 360.7814s
	iters: 600, epoch: 3 | loss: 0.0243430
	speed: 0.0536s/iter; left time: 354.9169s
	iters: 700, epoch: 3 | loss: 0.0243500
	speed: 0.0537s/iter; left time: 349.8627s
	iters: 800, epoch: 3 | loss: 0.0246347
	speed: 0.0537s/iter; left time: 344.3376s
	iters: 900, epoch: 3 | loss: 0.0226484
	speed: 0.0535s/iter; left time: 337.8796s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.0242081 Vali Loss: 0.0350496 Test Loss: 0.0419213
Validation loss decreased (0.036523 --> 0.035050).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0195246
	speed: 0.1341s/iter; left time: 833.1418s
	iters: 200, epoch: 4 | loss: 0.0185972
	speed: 0.0538s/iter; left time: 329.1871s
	iters: 300, epoch: 4 | loss: 0.0225250
	speed: 0.0535s/iter; left time: 322.1019s
	iters: 400, epoch: 4 | loss: 0.0223284
	speed: 0.0538s/iter; left time: 318.3512s
	iters: 500, epoch: 4 | loss: 0.0223749
	speed: 0.0537s/iter; left time: 312.0035s
	iters: 600, epoch: 4 | loss: 0.0182441
	speed: 0.0536s/iter; left time: 306.5107s
	iters: 700, epoch: 4 | loss: 0.0231301
	speed: 0.0536s/iter; left time: 301.0563s
	iters: 800, epoch: 4 | loss: 0.0219780
	speed: 0.0537s/iter; left time: 296.2411s
	iters: 900, epoch: 4 | loss: 0.0195454
	speed: 0.0537s/iter; left time: 290.6264s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.71s
Steps: 902 | Train Loss: 0.0208355 Vali Loss: 0.0383455 Test Loss: 0.0469129
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0197092
	speed: 0.1310s/iter; left time: 696.2320s
	iters: 200, epoch: 5 | loss: 0.0191564
	speed: 0.0537s/iter; left time: 279.6873s
	iters: 300, epoch: 5 | loss: 0.0180140
	speed: 0.0538s/iter; left time: 274.8789s
	iters: 400, epoch: 5 | loss: 0.0199376
	speed: 0.0536s/iter; left time: 268.8492s
	iters: 500, epoch: 5 | loss: 0.0148208
	speed: 0.0535s/iter; left time: 262.8099s
	iters: 600, epoch: 5 | loss: 0.0175141
	speed: 0.0536s/iter; left time: 257.8693s
	iters: 700, epoch: 5 | loss: 0.0173887
	speed: 0.0536s/iter; left time: 252.5322s
	iters: 800, epoch: 5 | loss: 0.0157184
	speed: 0.0537s/iter; left time: 247.8774s
	iters: 900, epoch: 5 | loss: 0.0148864
	speed: 0.0534s/iter; left time: 241.1819s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.0178738 Vali Loss: 0.0387645 Test Loss: 0.0473018
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0163559
	speed: 0.1305s/iter; left time: 575.5075s
	iters: 200, epoch: 6 | loss: 0.0168228
	speed: 0.0538s/iter; left time: 231.7619s
	iters: 300, epoch: 6 | loss: 0.0148977
	speed: 0.0538s/iter; left time: 226.3885s
	iters: 400, epoch: 6 | loss: 0.0183019
	speed: 0.0539s/iter; left time: 221.4342s
	iters: 500, epoch: 6 | loss: 0.0140002
	speed: 0.0537s/iter; left time: 215.4706s
	iters: 600, epoch: 6 | loss: 0.0141699
	speed: 0.0538s/iter; left time: 210.2261s
	iters: 700, epoch: 6 | loss: 0.0162823
	speed: 0.0537s/iter; left time: 204.7227s
	iters: 800, epoch: 6 | loss: 0.0132826
	speed: 0.0536s/iter; left time: 198.8901s
	iters: 900, epoch: 6 | loss: 0.0166660
	speed: 0.0536s/iter; left time: 193.4376s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.65s
Steps: 902 | Train Loss: 0.0152689 Vali Loss: 0.0395027 Test Loss: 0.0494608
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04194251820445061, rmse:0.20479872822761536, mae:0.14613044261932373, rse:0.7255402207374573
Original data scale mse:38667512.0, rmse:6218.32080078125, mae:4159.83203125, rse:0.3098265826702118
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0996415
	speed: 0.0554s/iter; left time: 494.0087s
	iters: 200, epoch: 1 | loss: 0.0730885
	speed: 0.0537s/iter; left time: 473.6945s
	iters: 300, epoch: 1 | loss: 0.0679008
	speed: 0.0538s/iter; left time: 469.0254s
	iters: 400, epoch: 1 | loss: 0.0527211
	speed: 0.0539s/iter; left time: 464.2531s
	iters: 500, epoch: 1 | loss: 0.0611140
	speed: 0.0537s/iter; left time: 457.7350s
	iters: 600, epoch: 1 | loss: 0.0541079
	speed: 0.0537s/iter; left time: 451.9281s
	iters: 700, epoch: 1 | loss: 0.0524976
	speed: 0.0536s/iter; left time: 445.7283s
	iters: 800, epoch: 1 | loss: 0.0498116
	speed: 0.0537s/iter; left time: 441.5276s
	iters: 900, epoch: 1 | loss: 0.0514907
	speed: 0.0541s/iter; left time: 439.1023s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.0677858 Vali Loss: 0.0552768 Test Loss: 0.0721760
Validation loss decreased (inf --> 0.055277).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0399472
	speed: 0.1370s/iter; left time: 1098.2554s
	iters: 200, epoch: 2 | loss: 0.0345920
	speed: 0.0534s/iter; left time: 423.2073s
	iters: 300, epoch: 2 | loss: 0.0327963
	speed: 0.0536s/iter; left time: 419.3104s
	iters: 400, epoch: 2 | loss: 0.0300119
	speed: 0.0536s/iter; left time: 413.4709s
	iters: 500, epoch: 2 | loss: 0.0309086
	speed: 0.0535s/iter; left time: 407.2992s
	iters: 600, epoch: 2 | loss: 0.0327205
	speed: 0.0534s/iter; left time: 401.4027s
	iters: 700, epoch: 2 | loss: 0.0301898
	speed: 0.0535s/iter; left time: 396.7848s
	iters: 800, epoch: 2 | loss: 0.0246733
	speed: 0.0534s/iter; left time: 391.0160s
	iters: 900, epoch: 2 | loss: 0.0267641
	speed: 0.0534s/iter; left time: 385.6927s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.53s
Steps: 902 | Train Loss: 0.0344061 Vali Loss: 0.0406078 Test Loss: 0.0490091
Validation loss decreased (0.055277 --> 0.040608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0244818
	speed: 0.1487s/iter; left time: 1058.5863s
	iters: 200, epoch: 3 | loss: 0.0276308
	speed: 0.0530s/iter; left time: 372.0225s
	iters: 300, epoch: 3 | loss: 0.0285101
	speed: 0.0524s/iter; left time: 362.4821s
	iters: 400, epoch: 3 | loss: 0.0247908
	speed: 0.0529s/iter; left time: 360.8414s
	iters: 500, epoch: 3 | loss: 0.0248932
	speed: 0.0527s/iter; left time: 354.0814s
	iters: 600, epoch: 3 | loss: 0.0240189
	speed: 0.0527s/iter; left time: 348.7810s
	iters: 700, epoch: 3 | loss: 0.0220240
	speed: 0.0528s/iter; left time: 344.3598s
	iters: 800, epoch: 3 | loss: 0.0212572
	speed: 0.0529s/iter; left time: 339.3520s
	iters: 900, epoch: 3 | loss: 0.0232297
	speed: 0.0532s/iter; left time: 336.1426s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.94s
Steps: 902 | Train Loss: 0.0245630 Vali Loss: 0.0353295 Test Loss: 0.0427999
Validation loss decreased (0.040608 --> 0.035330).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0222516
	speed: 0.1363s/iter; left time: 847.0935s
	iters: 200, epoch: 4 | loss: 0.0187717
	speed: 0.0536s/iter; left time: 328.0645s
	iters: 300, epoch: 4 | loss: 0.0205009
	speed: 0.0538s/iter; left time: 323.5813s
	iters: 400, epoch: 4 | loss: 0.0192620
	speed: 0.0536s/iter; left time: 317.2180s
	iters: 500, epoch: 4 | loss: 0.0217269
	speed: 0.0535s/iter; left time: 311.1861s
	iters: 600, epoch: 4 | loss: 0.0232268
	speed: 0.0538s/iter; left time: 307.2986s
	iters: 700, epoch: 4 | loss: 0.0181606
	speed: 0.0536s/iter; left time: 301.1740s
	iters: 800, epoch: 4 | loss: 0.0204242
	speed: 0.0534s/iter; left time: 294.5789s
	iters: 900, epoch: 4 | loss: 0.0196388
	speed: 0.0536s/iter; left time: 290.0532s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.0210388 Vali Loss: 0.0377036 Test Loss: 0.0474297
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0165764
	speed: 0.1316s/iter; left time: 699.2834s
	iters: 200, epoch: 5 | loss: 0.0184076
	speed: 0.0538s/iter; left time: 280.5277s
	iters: 300, epoch: 5 | loss: 0.0180536
	speed: 0.0538s/iter; left time: 275.1700s
	iters: 400, epoch: 5 | loss: 0.0186979
	speed: 0.0537s/iter; left time: 269.3605s
	iters: 500, epoch: 5 | loss: 0.0193929
	speed: 0.0538s/iter; left time: 264.2389s
	iters: 600, epoch: 5 | loss: 0.0152829
	speed: 0.0538s/iter; left time: 258.8215s
	iters: 700, epoch: 5 | loss: 0.0181565
	speed: 0.0537s/iter; left time: 252.8856s
	iters: 800, epoch: 5 | loss: 0.0155313
	speed: 0.0537s/iter; left time: 247.6362s
	iters: 900, epoch: 5 | loss: 0.0167628
	speed: 0.0536s/iter; left time: 242.0677s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.71s
Steps: 902 | Train Loss: 0.0181379 Vali Loss: 0.0366080 Test Loss: 0.0473259
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0165936
	speed: 0.1323s/iter; left time: 583.5683s
	iters: 200, epoch: 6 | loss: 0.0156297
	speed: 0.0539s/iter; left time: 232.2201s
	iters: 300, epoch: 6 | loss: 0.0156377
	speed: 0.0536s/iter; left time: 225.6151s
	iters: 400, epoch: 6 | loss: 0.0153034
	speed: 0.0534s/iter; left time: 219.6238s
	iters: 500, epoch: 6 | loss: 0.0144845
	speed: 0.0536s/iter; left time: 215.1185s
	iters: 600, epoch: 6 | loss: 0.0171050
	speed: 0.0538s/iter; left time: 210.3131s
	iters: 700, epoch: 6 | loss: 0.0161407
	speed: 0.0539s/iter; left time: 205.4423s
	iters: 800, epoch: 6 | loss: 0.0129499
	speed: 0.0537s/iter; left time: 199.3313s
	iters: 900, epoch: 6 | loss: 0.0129710
	speed: 0.0537s/iter; left time: 194.0015s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.70s
Steps: 902 | Train Loss: 0.0157268 Vali Loss: 0.0384959 Test Loss: 0.0500071
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.042809925973415375, rmse:0.20690560340881348, mae:0.14824068546295166, rse:0.7330042123794556
Original data scale mse:40122660.0, rmse:6334.2451171875, mae:4268.5029296875, rse:0.31560251116752625

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.04194251820445061, RMSE: 0.20479872822761536, MAE: 0.14613044261932373, RSE: 0.7255402207374573
Unscaled Metrics - MSE: 38667512.0, RMSE: 6218.32080078125, MAE: 4159.83203125, RSE: 0.3098265826702118

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.042809925973415375, RMSE: 0.20690560340881348, MAE: 0.14824068546295166, RSE: 0.7330042123794556
Unscaled Metrics - MSE: 40122660.0, RMSE: 6334.2451171875, MAE: 4268.5029296875, RSE: 0.31560251116752625

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3044245
	speed: 0.0756s/iter; left time: 677.2137s
	iters: 200, epoch: 1 | loss: 0.2541756
	speed: 0.0452s/iter; left time: 400.5752s
	iters: 300, epoch: 1 | loss: 0.2359411
	speed: 0.0435s/iter; left time: 381.3559s
	iters: 400, epoch: 1 | loss: 0.2080690
	speed: 0.0449s/iter; left time: 389.0107s
	iters: 500, epoch: 1 | loss: 0.1993576
	speed: 0.0422s/iter; left time: 361.6764s
	iters: 600, epoch: 1 | loss: 0.1850158
	speed: 0.0422s/iter; left time: 356.8153s
	iters: 700, epoch: 1 | loss: 0.2074167
	speed: 0.0421s/iter; left time: 351.7882s
	iters: 800, epoch: 1 | loss: 0.1798474
	speed: 0.0422s/iter; left time: 348.4517s
	iters: 900, epoch: 1 | loss: 0.1626024
	speed: 0.0422s/iter; left time: 344.1744s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:40.06s
Steps: 906 | Train Loss: 0.2292621 Vali Loss: 0.0312259 Test Loss: 0.0339099
Validation loss decreased (inf --> 0.031226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1436080
	speed: 0.1036s/iter; left time: 834.1994s
	iters: 200, epoch: 2 | loss: 0.1658469
	speed: 0.0432s/iter; left time: 343.4598s
	iters: 300, epoch: 2 | loss: 0.1337088
	speed: 0.0431s/iter; left time: 338.5820s
	iters: 400, epoch: 2 | loss: 0.1365202
	speed: 0.0425s/iter; left time: 329.3796s
	iters: 500, epoch: 2 | loss: 0.1223429
	speed: 0.0422s/iter; left time: 323.2477s
	iters: 600, epoch: 2 | loss: 0.1205767
	speed: 0.0428s/iter; left time: 323.3256s
	iters: 700, epoch: 2 | loss: 0.1182104
	speed: 0.0431s/iter; left time: 321.2216s
	iters: 800, epoch: 2 | loss: 0.1484690
	speed: 0.0433s/iter; left time: 318.1072s
	iters: 900, epoch: 2 | loss: 0.1202950
	speed: 0.0427s/iter; left time: 309.6014s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.16s
Steps: 906 | Train Loss: 0.1393169 Vali Loss: 0.0213747 Test Loss: 0.0251196
Validation loss decreased (0.031226 --> 0.021375).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1234659
	speed: 0.0915s/iter; left time: 654.2046s
	iters: 200, epoch: 3 | loss: 0.1091781
	speed: 0.0304s/iter; left time: 214.5712s
	iters: 300, epoch: 3 | loss: 0.1174415
	speed: 0.0457s/iter; left time: 317.3540s
	iters: 400, epoch: 3 | loss: 0.1293539
	speed: 0.0457s/iter; left time: 312.9096s
	iters: 500, epoch: 3 | loss: 0.1327087
	speed: 0.0459s/iter; left time: 310.0185s
	iters: 600, epoch: 3 | loss: 0.1358925
	speed: 0.0462s/iter; left time: 307.1419s
	iters: 700, epoch: 3 | loss: 0.1168140
	speed: 0.0458s/iter; left time: 299.7247s
	iters: 800, epoch: 3 | loss: 0.1123386
	speed: 0.0462s/iter; left time: 297.6363s
	iters: 900, epoch: 3 | loss: 0.1164839
	speed: 0.0464s/iter; left time: 294.4225s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.85s
Steps: 906 | Train Loss: 0.1189934 Vali Loss: 0.0215323 Test Loss: 0.0226174
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1026148
	speed: 0.0970s/iter; left time: 605.7869s
	iters: 200, epoch: 4 | loss: 0.1106264
	speed: 0.0425s/iter; left time: 261.3559s
	iters: 300, epoch: 4 | loss: 0.1169095
	speed: 0.0426s/iter; left time: 257.7163s
	iters: 400, epoch: 4 | loss: 0.1024052
	speed: 0.0420s/iter; left time: 249.4003s
	iters: 500, epoch: 4 | loss: 0.1161740
	speed: 0.0418s/iter; left time: 244.1080s
	iters: 600, epoch: 4 | loss: 0.1163085
	speed: 0.0421s/iter; left time: 241.5704s
	iters: 700, epoch: 4 | loss: 0.1058583
	speed: 0.0422s/iter; left time: 238.1552s
	iters: 800, epoch: 4 | loss: 0.1178173
	speed: 0.0424s/iter; left time: 234.8144s
	iters: 900, epoch: 4 | loss: 0.1051704
	speed: 0.0420s/iter; left time: 228.5138s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.45s
Steps: 906 | Train Loss: 0.1120337 Vali Loss: 0.0215291 Test Loss: 0.0237347
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1136920
	speed: 0.0974s/iter; left time: 520.0461s
	iters: 200, epoch: 5 | loss: 0.0999234
	speed: 0.0425s/iter; left time: 222.3249s
	iters: 300, epoch: 5 | loss: 0.1005163
	speed: 0.0426s/iter; left time: 219.0033s
	iters: 400, epoch: 5 | loss: 0.1132154
	speed: 0.0425s/iter; left time: 214.0120s
	iters: 500, epoch: 5 | loss: 0.0953875
	speed: 0.0421s/iter; left time: 207.9056s
	iters: 600, epoch: 5 | loss: 0.1069302
	speed: 0.0421s/iter; left time: 203.5432s
	iters: 700, epoch: 5 | loss: 0.1032498
	speed: 0.0421s/iter; left time: 199.3809s
	iters: 800, epoch: 5 | loss: 0.1120966
	speed: 0.0421s/iter; left time: 195.2326s
	iters: 900, epoch: 5 | loss: 0.1105405
	speed: 0.0423s/iter; left time: 192.1026s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.58s
Steps: 906 | Train Loss: 0.1057751 Vali Loss: 0.0214539 Test Loss: 0.0253474
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025140458717942238, rmse:0.15855742990970612, mae:0.10656960308551788, rse:0.5599498748779297
Original data scale mse:20226732.0, rmse:4497.4140625, mae:2958.59619140625, rse:0.2236204892396927
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2595895
	speed: 0.0449s/iter; left time: 401.9492s
	iters: 200, epoch: 1 | loss: 0.2608878
	speed: 0.0428s/iter; left time: 378.8627s
	iters: 300, epoch: 1 | loss: 0.2372577
	speed: 0.0429s/iter; left time: 375.9413s
	iters: 400, epoch: 1 | loss: 0.2196511
	speed: 0.0419s/iter; left time: 362.9133s
	iters: 500, epoch: 1 | loss: 0.2175351
	speed: 0.0418s/iter; left time: 357.8264s
	iters: 600, epoch: 1 | loss: 0.1980118
	speed: 0.0418s/iter; left time: 354.0548s
	iters: 700, epoch: 1 | loss: 0.1874889
	speed: 0.0443s/iter; left time: 370.4003s
	iters: 800, epoch: 1 | loss: 0.1916354
	speed: 0.0453s/iter; left time: 374.5693s
	iters: 900, epoch: 1 | loss: 0.1750810
	speed: 0.0422s/iter; left time: 344.0526s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.14s
Steps: 906 | Train Loss: 0.2307725 Vali Loss: 0.0320970 Test Loss: 0.0358286
Validation loss decreased (inf --> 0.032097).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1507739
	speed: 0.1047s/iter; left time: 842.9745s
	iters: 200, epoch: 2 | loss: 0.1655973
	speed: 0.0429s/iter; left time: 341.2961s
	iters: 300, epoch: 2 | loss: 0.1238459
	speed: 0.0421s/iter; left time: 330.8285s
	iters: 400, epoch: 2 | loss: 0.1277618
	speed: 0.0428s/iter; left time: 331.5396s
	iters: 500, epoch: 2 | loss: 0.1319637
	speed: 0.0426s/iter; left time: 326.0439s
	iters: 600, epoch: 2 | loss: 0.1444153
	speed: 0.0423s/iter; left time: 319.6187s
	iters: 700, epoch: 2 | loss: 0.1221743
	speed: 0.0422s/iter; left time: 314.3985s
	iters: 800, epoch: 2 | loss: 0.1195042
	speed: 0.0454s/iter; left time: 333.8014s
	iters: 900, epoch: 2 | loss: 0.1323075
	speed: 0.0427s/iter; left time: 309.7508s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:39.11s
Steps: 906 | Train Loss: 0.1392018 Vali Loss: 0.0237769 Test Loss: 0.0260980
Validation loss decreased (0.032097 --> 0.023777).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1315212
	speed: 0.1017s/iter; left time: 727.0007s
	iters: 200, epoch: 3 | loss: 0.1110490
	speed: 0.0425s/iter; left time: 299.5826s
	iters: 300, epoch: 3 | loss: 0.1065218
	speed: 0.0424s/iter; left time: 294.9460s
	iters: 400, epoch: 3 | loss: 0.1213241
	speed: 0.0427s/iter; left time: 292.4168s
	iters: 500, epoch: 3 | loss: 0.1188660
	speed: 0.0426s/iter; left time: 287.2155s
	iters: 600, epoch: 3 | loss: 0.1148553
	speed: 0.0429s/iter; left time: 285.2754s
	iters: 700, epoch: 3 | loss: 0.1197077
	speed: 0.0433s/iter; left time: 283.2620s
	iters: 800, epoch: 3 | loss: 0.1219010
	speed: 0.0430s/iter; left time: 277.3380s
	iters: 900, epoch: 3 | loss: 0.1039494
	speed: 0.0430s/iter; left time: 273.1271s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:39.04s
Steps: 906 | Train Loss: 0.1192013 Vali Loss: 0.0214143 Test Loss: 0.0234998
Validation loss decreased (0.023777 --> 0.021414).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1082590
	speed: 0.1016s/iter; left time: 634.5072s
	iters: 200, epoch: 4 | loss: 0.1080726
	speed: 0.0422s/iter; left time: 259.5234s
	iters: 300, epoch: 4 | loss: 0.1309506
	speed: 0.0426s/iter; left time: 257.6589s
	iters: 400, epoch: 4 | loss: 0.1074475
	speed: 0.0426s/iter; left time: 253.2057s
	iters: 500, epoch: 4 | loss: 0.1255920
	speed: 0.0423s/iter; left time: 247.3923s
	iters: 600, epoch: 4 | loss: 0.1189473
	speed: 0.0426s/iter; left time: 244.7748s
	iters: 700, epoch: 4 | loss: 0.1094264
	speed: 0.0427s/iter; left time: 240.6936s
	iters: 800, epoch: 4 | loss: 0.0985998
	speed: 0.0425s/iter; left time: 235.4349s
	iters: 900, epoch: 4 | loss: 0.0951604
	speed: 0.0423s/iter; left time: 230.1889s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.81s
Steps: 906 | Train Loss: 0.1119296 Vali Loss: 0.0210033 Test Loss: 0.0229962
Validation loss decreased (0.021414 --> 0.021003).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1206323
	speed: 0.1032s/iter; left time: 550.9744s
	iters: 200, epoch: 5 | loss: 0.1025492
	speed: 0.0422s/iter; left time: 221.0341s
	iters: 300, epoch: 5 | loss: 0.0958860
	speed: 0.0464s/iter; left time: 238.2039s
	iters: 400, epoch: 5 | loss: 0.1053028
	speed: 0.0465s/iter; left time: 234.2991s
	iters: 500, epoch: 5 | loss: 0.0911213
	speed: 0.0457s/iter; left time: 225.4931s
	iters: 600, epoch: 5 | loss: 0.1147761
	speed: 0.0461s/iter; left time: 222.8288s
	iters: 700, epoch: 5 | loss: 0.0964720
	speed: 0.0450s/iter; left time: 212.9695s
	iters: 800, epoch: 5 | loss: 0.0956109
	speed: 0.0424s/iter; left time: 196.6276s
	iters: 900, epoch: 5 | loss: 0.1076336
	speed: 0.0422s/iter; left time: 191.3419s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:40.44s
Steps: 906 | Train Loss: 0.1052212 Vali Loss: 0.0230487 Test Loss: 0.0248546
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0975094
	speed: 0.0976s/iter; left time: 432.6329s
	iters: 200, epoch: 6 | loss: 0.1022177
	speed: 0.0415s/iter; left time: 179.8468s
	iters: 300, epoch: 6 | loss: 0.1188942
	speed: 0.0420s/iter; left time: 177.5846s
	iters: 400, epoch: 6 | loss: 0.1018972
	speed: 0.0430s/iter; left time: 177.5288s
	iters: 500, epoch: 6 | loss: 0.1062510
	speed: 0.0419s/iter; left time: 168.7636s
	iters: 600, epoch: 6 | loss: 0.0971001
	speed: 0.0422s/iter; left time: 165.7171s
	iters: 700, epoch: 6 | loss: 0.0943823
	speed: 0.0425s/iter; left time: 162.6849s
	iters: 800, epoch: 6 | loss: 0.0997844
	speed: 0.0420s/iter; left time: 156.7798s
	iters: 900, epoch: 6 | loss: 0.0909821
	speed: 0.0421s/iter; left time: 152.8641s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.45s
Steps: 906 | Train Loss: 0.0983646 Vali Loss: 0.0231138 Test Loss: 0.0255483
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1109275
	speed: 0.1026s/iter; left time: 361.5863s
	iters: 200, epoch: 7 | loss: 0.0878093
	speed: 0.0461s/iter; left time: 157.9592s
	iters: 300, epoch: 7 | loss: 0.0889100
	speed: 0.0305s/iter; left time: 101.3052s
	iters: 400, epoch: 7 | loss: 0.1003922
	speed: 0.0303s/iter; left time: 97.8166s
	iters: 500, epoch: 7 | loss: 0.0935495
	speed: 0.0349s/iter; left time: 109.0133s
	iters: 600, epoch: 7 | loss: 0.0867671
	speed: 0.0460s/iter; left time: 139.0098s
	iters: 700, epoch: 7 | loss: 0.0835018
	speed: 0.0458s/iter; left time: 133.9576s
	iters: 800, epoch: 7 | loss: 0.0924193
	speed: 0.0460s/iter; left time: 130.0904s
	iters: 900, epoch: 7 | loss: 0.0836910
	speed: 0.0458s/iter; left time: 124.8114s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.67s
Steps: 906 | Train Loss: 0.0906459 Vali Loss: 0.0246819 Test Loss: 0.0273251
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.022993577644228935, rmse:0.15163633227348328, mae:0.10003083199262619, rse:0.53550785779953
Original data scale mse:19474288.0, rmse:4412.96826171875, mae:2820.479248046875, rse:0.21942166984081268

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.025140458717942238, RMSE: 0.15855742990970612, MAE: 0.10656960308551788, RSE: 0.5599498748779297
Unscaled Metrics - MSE: 20226732.0, RMSE: 4497.4140625, MAE: 2958.59619140625, RSE: 0.2236204892396927

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.022993577644228935, RMSE: 0.15163633227348328, MAE: 0.10003083199262619, RSE: 0.53550785779953
Unscaled Metrics - MSE: 19474288.0, RMSE: 4412.96826171875, MAE: 2820.479248046875, RSE: 0.21942166984081268

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.3050602
	speed: 0.0781s/iter; left time: 698.3855s
	iters: 200, epoch: 1 | loss: 0.2792929
	speed: 0.0504s/iter; left time: 445.2401s
	iters: 300, epoch: 1 | loss: 0.2580291
	speed: 0.0477s/iter; left time: 416.5160s
	iters: 400, epoch: 1 | loss: 0.2379579
	speed: 0.0476s/iter; left time: 411.3502s
	iters: 500, epoch: 1 | loss: 0.2285644
	speed: 0.0476s/iter; left time: 406.2006s
	iters: 600, epoch: 1 | loss: 0.2200543
	speed: 0.0473s/iter; left time: 399.5404s
	iters: 700, epoch: 1 | loss: 0.2084320
	speed: 0.0476s/iter; left time: 396.6160s
	iters: 800, epoch: 1 | loss: 0.2090365
	speed: 0.0479s/iter; left time: 395.0435s
	iters: 900, epoch: 1 | loss: 0.2044081
	speed: 0.0480s/iter; left time: 390.6186s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.25s
Steps: 904 | Train Loss: 0.2474488 Vali Loss: 0.0465068 Test Loss: 0.0587189
Validation loss decreased (inf --> 0.046507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1707423
	speed: 0.1223s/iter; left time: 983.0254s
	iters: 200, epoch: 2 | loss: 0.1756015
	speed: 0.0504s/iter; left time: 400.1047s
	iters: 300, epoch: 2 | loss: 0.1726436
	speed: 0.0503s/iter; left time: 393.9451s
	iters: 400, epoch: 2 | loss: 0.1585707
	speed: 0.0502s/iter; left time: 388.6009s
	iters: 500, epoch: 2 | loss: 0.1642121
	speed: 0.0503s/iter; left time: 384.2773s
	iters: 600, epoch: 2 | loss: 0.1724601
	speed: 0.0505s/iter; left time: 380.9353s
	iters: 700, epoch: 2 | loss: 0.1577658
	speed: 0.0505s/iter; left time: 375.9311s
	iters: 800, epoch: 2 | loss: 0.1684639
	speed: 0.0504s/iter; left time: 369.9190s
	iters: 900, epoch: 2 | loss: 0.1521902
	speed: 0.0504s/iter; left time: 364.9993s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:45.84s
Steps: 904 | Train Loss: 0.1675332 Vali Loss: 0.0336258 Test Loss: 0.0410545
Validation loss decreased (0.046507 --> 0.033626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1651728
	speed: 0.1064s/iter; left time: 758.8851s
	iters: 200, epoch: 3 | loss: 0.1408958
	speed: 0.0354s/iter; left time: 249.0608s
	iters: 300, epoch: 3 | loss: 0.1396739
	speed: 0.0354s/iter; left time: 245.5360s
	iters: 400, epoch: 3 | loss: 0.1394162
	speed: 0.0354s/iter; left time: 241.6826s
	iters: 500, epoch: 3 | loss: 0.1471861
	speed: 0.0354s/iter; left time: 238.4769s
	iters: 600, epoch: 3 | loss: 0.1604891
	speed: 0.0354s/iter; left time: 235.0967s
	iters: 700, epoch: 3 | loss: 0.1398279
	speed: 0.0354s/iter; left time: 231.3749s
	iters: 800, epoch: 3 | loss: 0.1480567
	speed: 0.0354s/iter; left time: 227.6947s
	iters: 900, epoch: 3 | loss: 0.1475054
	speed: 0.0387s/iter; left time: 244.9664s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.70s
Steps: 904 | Train Loss: 0.1492850 Vali Loss: 0.0337527 Test Loss: 0.0420692
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1347107
	speed: 0.1146s/iter; left time: 713.6439s
	iters: 200, epoch: 4 | loss: 0.1328156
	speed: 0.0477s/iter; left time: 292.3445s
	iters: 300, epoch: 4 | loss: 0.1383835
	speed: 0.0477s/iter; left time: 287.3725s
	iters: 400, epoch: 4 | loss: 0.1231011
	speed: 0.0477s/iter; left time: 282.7877s
	iters: 500, epoch: 4 | loss: 0.1435674
	speed: 0.0477s/iter; left time: 278.1344s
	iters: 600, epoch: 4 | loss: 0.1305622
	speed: 0.0477s/iter; left time: 273.0500s
	iters: 700, epoch: 4 | loss: 0.1443142
	speed: 0.0475s/iter; left time: 267.6419s
	iters: 800, epoch: 4 | loss: 0.1291650
	speed: 0.0471s/iter; left time: 260.2952s
	iters: 900, epoch: 4 | loss: 0.1457163
	speed: 0.0474s/iter; left time: 257.1606s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.26s
Steps: 904 | Train Loss: 0.1390550 Vali Loss: 0.0356938 Test Loss: 0.0444108
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1368660
	speed: 0.1168s/iter; left time: 622.2204s
	iters: 200, epoch: 5 | loss: 0.1410505
	speed: 0.0472s/iter; left time: 246.4697s
	iters: 300, epoch: 5 | loss: 0.1253819
	speed: 0.0483s/iter; left time: 247.7688s
	iters: 400, epoch: 5 | loss: 0.1291719
	speed: 0.0479s/iter; left time: 240.6349s
	iters: 500, epoch: 5 | loss: 0.1253986
	speed: 0.0488s/iter; left time: 240.5403s
	iters: 600, epoch: 5 | loss: 0.1274677
	speed: 0.0504s/iter; left time: 243.3136s
	iters: 700, epoch: 5 | loss: 0.1198974
	speed: 0.0494s/iter; left time: 233.3008s
	iters: 800, epoch: 5 | loss: 0.1168309
	speed: 0.0478s/iter; left time: 220.9980s
	iters: 900, epoch: 5 | loss: 0.1229431
	speed: 0.0477s/iter; left time: 215.7128s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:44.00s
Steps: 904 | Train Loss: 0.1276485 Vali Loss: 0.0351315 Test Loss: 0.0445958
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04103325307369232, rmse:0.20256666839122772, mae:0.1448090672492981, rse:0.7173295021057129
Original data scale mse:36910216.0, rmse:6075.3779296875, mae:4103.126953125, rse:0.30255600810050964
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.3033006
	speed: 0.0527s/iter; left time: 470.7883s
	iters: 200, epoch: 1 | loss: 0.2656540
	speed: 0.0505s/iter; left time: 446.2560s
	iters: 300, epoch: 1 | loss: 0.2539203
	speed: 0.0503s/iter; left time: 440.0465s
	iters: 400, epoch: 1 | loss: 0.2405170
	speed: 0.0504s/iter; left time: 435.1958s
	iters: 500, epoch: 1 | loss: 0.2386315
	speed: 0.0504s/iter; left time: 430.8299s
	iters: 600, epoch: 1 | loss: 0.2180775
	speed: 0.0489s/iter; left time: 412.7733s
	iters: 700, epoch: 1 | loss: 0.2443407
	speed: 0.0476s/iter; left time: 396.7101s
	iters: 800, epoch: 1 | loss: 0.2130085
	speed: 0.0499s/iter; left time: 411.0398s
	iters: 900, epoch: 1 | loss: 0.2177016
	speed: 0.0504s/iter; left time: 410.6883s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:45.40s
Steps: 904 | Train Loss: 0.2510130 Vali Loss: 0.0469525 Test Loss: 0.0592683
Validation loss decreased (inf --> 0.046953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1928810
	speed: 0.1219s/iter; left time: 979.8434s
	iters: 200, epoch: 2 | loss: 0.1737615
	speed: 0.0478s/iter; left time: 379.2192s
	iters: 300, epoch: 2 | loss: 0.1708919
	speed: 0.0477s/iter; left time: 373.5658s
	iters: 400, epoch: 2 | loss: 0.1574111
	speed: 0.0475s/iter; left time: 367.3809s
	iters: 500, epoch: 2 | loss: 0.1583550
	speed: 0.0475s/iter; left time: 362.7301s
	iters: 600, epoch: 2 | loss: 0.1736619
	speed: 0.0476s/iter; left time: 359.0177s
	iters: 700, epoch: 2 | loss: 0.1612795
	speed: 0.0476s/iter; left time: 354.1433s
	iters: 800, epoch: 2 | loss: 0.1629753
	speed: 0.0478s/iter; left time: 350.6080s
	iters: 900, epoch: 2 | loss: 0.1445371
	speed: 0.0477s/iter; left time: 344.9093s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.40s
Steps: 904 | Train Loss: 0.1683245 Vali Loss: 0.0335551 Test Loss: 0.0415100
Validation loss decreased (0.046953 --> 0.033555).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1596928
	speed: 0.1188s/iter; left time: 847.1477s
	iters: 200, epoch: 3 | loss: 0.1593727
	speed: 0.0474s/iter; left time: 333.1254s
	iters: 300, epoch: 3 | loss: 0.1426084
	speed: 0.0476s/iter; left time: 329.7261s
	iters: 400, epoch: 3 | loss: 0.1490009
	speed: 0.0475s/iter; left time: 324.7389s
	iters: 500, epoch: 3 | loss: 0.1475351
	speed: 0.0476s/iter; left time: 320.2214s
	iters: 600, epoch: 3 | loss: 0.1512032
	speed: 0.0474s/iter; left time: 314.5922s
	iters: 700, epoch: 3 | loss: 0.1463389
	speed: 0.0473s/iter; left time: 309.1003s
	iters: 800, epoch: 3 | loss: 0.1608187
	speed: 0.0475s/iter; left time: 305.5488s
	iters: 900, epoch: 3 | loss: 0.1560631
	speed: 0.0474s/iter; left time: 300.0561s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.19s
Steps: 904 | Train Loss: 0.1491675 Vali Loss: 0.0331871 Test Loss: 0.0418654
Validation loss decreased (0.033555 --> 0.033187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1472884
	speed: 0.1183s/iter; left time: 737.0817s
	iters: 200, epoch: 4 | loss: 0.1476162
	speed: 0.0477s/iter; left time: 292.2439s
	iters: 300, epoch: 4 | loss: 0.1375844
	speed: 0.0474s/iter; left time: 285.6144s
	iters: 400, epoch: 4 | loss: 0.1338737
	speed: 0.0476s/iter; left time: 282.1596s
	iters: 500, epoch: 4 | loss: 0.1385023
	speed: 0.0477s/iter; left time: 277.8313s
	iters: 600, epoch: 4 | loss: 0.1450797
	speed: 0.0476s/iter; left time: 272.9438s
	iters: 700, epoch: 4 | loss: 0.1402115
	speed: 0.0477s/iter; left time: 268.4205s
	iters: 800, epoch: 4 | loss: 0.1368200
	speed: 0.0478s/iter; left time: 264.1160s
	iters: 900, epoch: 4 | loss: 0.1321137
	speed: 0.0476s/iter; left time: 258.1608s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.38s
Steps: 904 | Train Loss: 0.1401779 Vali Loss: 0.0347146 Test Loss: 0.0455525
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1162099
	speed: 0.1147s/iter; left time: 610.5134s
	iters: 200, epoch: 5 | loss: 0.1308444
	speed: 0.0474s/iter; left time: 247.5895s
	iters: 300, epoch: 5 | loss: 0.1344330
	speed: 0.0474s/iter; left time: 242.6779s
	iters: 400, epoch: 5 | loss: 0.1229379
	speed: 0.0474s/iter; left time: 238.1923s
	iters: 500, epoch: 5 | loss: 0.1343827
	speed: 0.0476s/iter; left time: 234.3293s
	iters: 600, epoch: 5 | loss: 0.1198288
	speed: 0.0473s/iter; left time: 228.3916s
	iters: 700, epoch: 5 | loss: 0.1365760
	speed: 0.0475s/iter; left time: 224.5180s
	iters: 800, epoch: 5 | loss: 0.1273134
	speed: 0.0475s/iter; left time: 219.7608s
	iters: 900, epoch: 5 | loss: 0.1240884
	speed: 0.0476s/iter; left time: 215.4504s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.16s
Steps: 904 | Train Loss: 0.1306954 Vali Loss: 0.0344826 Test Loss: 0.0431674
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1184841
	speed: 0.1141s/iter; left time: 504.3543s
	iters: 200, epoch: 6 | loss: 0.1300571
	speed: 0.0477s/iter; left time: 206.1272s
	iters: 300, epoch: 6 | loss: 0.1251907
	speed: 0.0478s/iter; left time: 201.9175s
	iters: 400, epoch: 6 | loss: 0.1189657
	speed: 0.0477s/iter; left time: 196.7519s
	iters: 500, epoch: 6 | loss: 0.1225212
	speed: 0.0478s/iter; left time: 192.0400s
	iters: 600, epoch: 6 | loss: 0.1154039
	speed: 0.0474s/iter; left time: 186.0062s
	iters: 700, epoch: 6 | loss: 0.1176639
	speed: 0.0475s/iter; left time: 181.5044s
	iters: 800, epoch: 6 | loss: 0.1150488
	speed: 0.0474s/iter; left time: 176.3909s
	iters: 900, epoch: 6 | loss: 0.1111033
	speed: 0.0476s/iter; left time: 172.2562s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.33s
Steps: 904 | Train Loss: 0.1199580 Vali Loss: 0.0392481 Test Loss: 0.0465440
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04188527911901474, rmse:0.20465894043445587, mae:0.1424560695886612, rse:0.7247387170791626
Original data scale mse:38137348.0, rmse:6175.54443359375, mae:4037.75927734375, rse:0.3075443208217621

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.04103325307369232, RMSE: 0.20256666839122772, MAE: 0.1448090672492981, RSE: 0.7173295021057129
Unscaled Metrics - MSE: 36910216.0, RMSE: 6075.3779296875, MAE: 4103.126953125, RSE: 0.30255600810050964

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.04188527911901474, RMSE: 0.20465894043445587, MAE: 0.1424560695886612, RSE: 0.7247387170791626
Unscaled Metrics - MSE: 38137348.0, RMSE: 6175.54443359375, MAE: 4037.75927734375, RSE: 0.3075443208217621

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2926495
	speed: 0.0844s/iter; left time: 752.9933s
	iters: 200, epoch: 1 | loss: 0.2759382
	speed: 0.0537s/iter; left time: 473.6639s
	iters: 300, epoch: 1 | loss: 0.2516454
	speed: 0.0535s/iter; left time: 466.1599s
	iters: 400, epoch: 1 | loss: 0.2446894
	speed: 0.0535s/iter; left time: 460.8136s
	iters: 500, epoch: 1 | loss: 0.2390247
	speed: 0.0537s/iter; left time: 457.8701s
	iters: 600, epoch: 1 | loss: 0.2378901
	speed: 0.0536s/iter; left time: 451.6392s
	iters: 700, epoch: 1 | loss: 0.2287076
	speed: 0.0534s/iter; left time: 443.9600s
	iters: 800, epoch: 1 | loss: 0.2237932
	speed: 0.0537s/iter; left time: 441.7604s
	iters: 900, epoch: 1 | loss: 0.2274978
	speed: 0.0538s/iter; left time: 436.5448s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.25s
Steps: 902 | Train Loss: 0.2537300 Vali Loss: 0.0554739 Test Loss: 0.0720860
Validation loss decreased (inf --> 0.055474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2111945
	speed: 0.1353s/iter; left time: 1084.8407s
	iters: 200, epoch: 2 | loss: 0.1888788
	speed: 0.0537s/iter; left time: 425.4315s
	iters: 300, epoch: 2 | loss: 0.2003660
	speed: 0.0539s/iter; left time: 421.1136s
	iters: 400, epoch: 2 | loss: 0.1833679
	speed: 0.0537s/iter; left time: 414.7454s
	iters: 500, epoch: 2 | loss: 0.1778117
	speed: 0.0540s/iter; left time: 411.5908s
	iters: 600, epoch: 2 | loss: 0.1675996
	speed: 0.0539s/iter; left time: 404.9248s
	iters: 700, epoch: 2 | loss: 0.1670957
	speed: 0.0539s/iter; left time: 400.2321s
	iters: 800, epoch: 2 | loss: 0.1790987
	speed: 0.0535s/iter; left time: 391.3275s
	iters: 900, epoch: 2 | loss: 0.1498518
	speed: 0.0540s/iter; left time: 390.0972s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.85s
Steps: 902 | Train Loss: 0.1816401 Vali Loss: 0.0353314 Test Loss: 0.0436157
Validation loss decreased (0.055474 --> 0.035331).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1658780
	speed: 0.1365s/iter; left time: 971.7080s
	iters: 200, epoch: 3 | loss: 0.1539436
	speed: 0.0539s/iter; left time: 378.1427s
	iters: 300, epoch: 3 | loss: 0.1573724
	speed: 0.0538s/iter; left time: 372.1556s
	iters: 400, epoch: 3 | loss: 0.1706105
	speed: 0.0538s/iter; left time: 366.8453s
	iters: 500, epoch: 3 | loss: 0.1472732
	speed: 0.0539s/iter; left time: 362.1113s
	iters: 600, epoch: 3 | loss: 0.1535669
	speed: 0.0537s/iter; left time: 355.3648s
	iters: 700, epoch: 3 | loss: 0.1553864
	speed: 0.0538s/iter; left time: 350.4386s
	iters: 800, epoch: 3 | loss: 0.1544610
	speed: 0.0537s/iter; left time: 344.8392s
	iters: 900, epoch: 3 | loss: 0.1476951
	speed: 0.0539s/iter; left time: 340.5541s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.83s
Steps: 902 | Train Loss: 0.1532935 Vali Loss: 0.0348557 Test Loss: 0.0415470
Validation loss decreased (0.035331 --> 0.034856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1365672
	speed: 0.1353s/iter; left time: 841.1260s
	iters: 200, epoch: 4 | loss: 0.1337031
	speed: 0.0539s/iter; left time: 329.4726s
	iters: 300, epoch: 4 | loss: 0.1502062
	speed: 0.0538s/iter; left time: 323.8578s
	iters: 400, epoch: 4 | loss: 0.1468889
	speed: 0.0537s/iter; left time: 317.3534s
	iters: 500, epoch: 4 | loss: 0.1529484
	speed: 0.0536s/iter; left time: 311.9329s
	iters: 600, epoch: 4 | loss: 0.1329334
	speed: 0.0538s/iter; left time: 307.2036s
	iters: 700, epoch: 4 | loss: 0.1536939
	speed: 0.0537s/iter; left time: 301.5138s
	iters: 800, epoch: 4 | loss: 0.1441478
	speed: 0.0537s/iter; left time: 296.1831s
	iters: 900, epoch: 4 | loss: 0.1344999
	speed: 0.0536s/iter; left time: 290.4619s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.75s
Steps: 902 | Train Loss: 0.1418212 Vali Loss: 0.0379184 Test Loss: 0.0469089
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1399765
	speed: 0.1319s/iter; left time: 700.6899s
	iters: 200, epoch: 5 | loss: 0.1334775
	speed: 0.0536s/iter; left time: 279.6502s
	iters: 300, epoch: 5 | loss: 0.1285665
	speed: 0.0539s/iter; left time: 275.7352s
	iters: 400, epoch: 5 | loss: 0.1392056
	speed: 0.0539s/iter; left time: 270.3621s
	iters: 500, epoch: 5 | loss: 0.1215379
	speed: 0.0539s/iter; left time: 264.9537s
	iters: 600, epoch: 5 | loss: 0.1303193
	speed: 0.0537s/iter; left time: 258.3738s
	iters: 700, epoch: 5 | loss: 0.1267691
	speed: 0.0538s/iter; left time: 253.5886s
	iters: 800, epoch: 5 | loss: 0.1245160
	speed: 0.0538s/iter; left time: 248.0065s
	iters: 900, epoch: 5 | loss: 0.1172705
	speed: 0.0536s/iter; left time: 242.0793s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.76s
Steps: 902 | Train Loss: 0.1298998 Vali Loss: 0.0396953 Test Loss: 0.0485864
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1218988
	speed: 0.1316s/iter; left time: 580.3267s
	iters: 200, epoch: 6 | loss: 0.1267436
	speed: 0.0538s/iter; left time: 231.9743s
	iters: 300, epoch: 6 | loss: 0.1143450
	speed: 0.0537s/iter; left time: 226.0899s
	iters: 400, epoch: 6 | loss: 0.1284699
	speed: 0.0538s/iter; left time: 221.1135s
	iters: 500, epoch: 6 | loss: 0.1149280
	speed: 0.0537s/iter; left time: 215.3660s
	iters: 600, epoch: 6 | loss: 0.1126125
	speed: 0.0537s/iter; left time: 209.8899s
	iters: 700, epoch: 6 | loss: 0.1189998
	speed: 0.0536s/iter; left time: 204.4408s
	iters: 800, epoch: 6 | loss: 0.1114934
	speed: 0.0536s/iter; left time: 198.7814s
	iters: 900, epoch: 6 | loss: 0.1228147
	speed: 0.0535s/iter; left time: 193.1487s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.64s
Steps: 902 | Train Loss: 0.1195825 Vali Loss: 0.0401932 Test Loss: 0.0509725
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.041561320424079895, rmse:0.2038659304380417, mae:0.14510895311832428, rse:0.7222356200218201
Original data scale mse:38455032.0, rmse:6201.2119140625, mae:4132.53271484375, rse:0.30897417664527893
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.3113247
	speed: 0.0565s/iter; left time: 503.7476s
	iters: 200, epoch: 1 | loss: 0.2668369
	speed: 0.0538s/iter; left time: 474.3546s
	iters: 300, epoch: 1 | loss: 0.2556839
	speed: 0.0538s/iter; left time: 469.0089s
	iters: 400, epoch: 1 | loss: 0.2252100
	speed: 0.0537s/iter; left time: 462.8217s
	iters: 500, epoch: 1 | loss: 0.2424131
	speed: 0.0538s/iter; left time: 458.7640s
	iters: 600, epoch: 1 | loss: 0.2288676
	speed: 0.0538s/iter; left time: 452.6889s
	iters: 700, epoch: 1 | loss: 0.2255107
	speed: 0.0538s/iter; left time: 447.3104s
	iters: 800, epoch: 1 | loss: 0.2196986
	speed: 0.0538s/iter; left time: 441.8829s
	iters: 900, epoch: 1 | loss: 0.2234770
	speed: 0.0536s/iter; left time: 435.3711s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.83s
Steps: 902 | Train Loss: 0.2539692 Vali Loss: 0.0544385 Test Loss: 0.0711512
Validation loss decreased (inf --> 0.054439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2002301
	speed: 0.1369s/iter; left time: 1097.6334s
	iters: 200, epoch: 2 | loss: 0.1902201
	speed: 0.0537s/iter; left time: 425.2088s
	iters: 300, epoch: 2 | loss: 0.1814798
	speed: 0.0540s/iter; left time: 422.1479s
	iters: 400, epoch: 2 | loss: 0.1707954
	speed: 0.0538s/iter; left time: 415.3305s
	iters: 500, epoch: 2 | loss: 0.1734090
	speed: 0.0538s/iter; left time: 410.2490s
	iters: 600, epoch: 2 | loss: 0.1803765
	speed: 0.0535s/iter; left time: 402.3966s
	iters: 700, epoch: 2 | loss: 0.1676639
	speed: 0.0535s/iter; left time: 396.9880s
	iters: 800, epoch: 2 | loss: 0.1515651
	speed: 0.0538s/iter; left time: 393.6638s
	iters: 900, epoch: 2 | loss: 0.1576114
	speed: 0.0538s/iter; left time: 388.6830s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.80s
Steps: 902 | Train Loss: 0.1831233 Vali Loss: 0.0411337 Test Loss: 0.0487919
Validation loss decreased (0.054439 --> 0.041134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1539670
	speed: 0.1363s/iter; left time: 969.7555s
	iters: 200, epoch: 3 | loss: 0.1628677
	speed: 0.0538s/iter; left time: 377.4586s
	iters: 300, epoch: 3 | loss: 0.1688538
	speed: 0.0536s/iter; left time: 370.9110s
	iters: 400, epoch: 3 | loss: 0.1600339
	speed: 0.0537s/iter; left time: 365.7726s
	iters: 500, epoch: 3 | loss: 0.1580702
	speed: 0.0537s/iter; left time: 360.7385s
	iters: 600, epoch: 3 | loss: 0.1543265
	speed: 0.0537s/iter; left time: 355.4255s
	iters: 700, epoch: 3 | loss: 0.1496884
	speed: 0.0537s/iter; left time: 349.7671s
	iters: 800, epoch: 3 | loss: 0.1444830
	speed: 0.0535s/iter; left time: 343.5058s
	iters: 900, epoch: 3 | loss: 0.1467203
	speed: 0.0535s/iter; left time: 338.2497s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.74s
Steps: 902 | Train Loss: 0.1542953 Vali Loss: 0.0354638 Test Loss: 0.0431497
Validation loss decreased (0.041134 --> 0.035464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1480040
	speed: 0.1360s/iter; left time: 845.5179s
	iters: 200, epoch: 4 | loss: 0.1369039
	speed: 0.0538s/iter; left time: 329.0979s
	iters: 300, epoch: 4 | loss: 0.1432847
	speed: 0.0537s/iter; left time: 323.1930s
	iters: 400, epoch: 4 | loss: 0.1397676
	speed: 0.0539s/iter; left time: 318.6197s
	iters: 500, epoch: 4 | loss: 0.1429798
	speed: 0.0538s/iter; left time: 312.9058s
	iters: 600, epoch: 4 | loss: 0.1483091
	speed: 0.0537s/iter; left time: 306.9805s
	iters: 700, epoch: 4 | loss: 0.1336518
	speed: 0.0537s/iter; left time: 301.6189s
	iters: 800, epoch: 4 | loss: 0.1385359
	speed: 0.0537s/iter; left time: 296.0877s
	iters: 900, epoch: 4 | loss: 0.1367240
	speed: 0.0538s/iter; left time: 291.0608s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.79s
Steps: 902 | Train Loss: 0.1427702 Vali Loss: 0.0372985 Test Loss: 0.0459323
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1259555
	speed: 0.1322s/iter; left time: 702.3514s
	iters: 200, epoch: 5 | loss: 0.1316517
	speed: 0.0538s/iter; left time: 280.3851s
	iters: 300, epoch: 5 | loss: 0.1307634
	speed: 0.0539s/iter; left time: 275.3648s
	iters: 400, epoch: 5 | loss: 0.1369316
	speed: 0.0537s/iter; left time: 269.0117s
	iters: 500, epoch: 5 | loss: 0.1391668
	speed: 0.0539s/iter; left time: 265.0516s
	iters: 600, epoch: 5 | loss: 0.1236826
	speed: 0.0534s/iter; left time: 257.1278s
	iters: 700, epoch: 5 | loss: 0.1305160
	speed: 0.0537s/iter; left time: 253.1924s
	iters: 800, epoch: 5 | loss: 0.1278001
	speed: 0.0539s/iter; left time: 248.4260s
	iters: 900, epoch: 5 | loss: 0.1261872
	speed: 0.0539s/iter; left time: 243.1384s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.74s
Steps: 902 | Train Loss: 0.1319320 Vali Loss: 0.0381629 Test Loss: 0.0498999
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1268972
	speed: 0.1317s/iter; left time: 580.8704s
	iters: 200, epoch: 6 | loss: 0.1211389
	speed: 0.0538s/iter; left time: 231.7858s
	iters: 300, epoch: 6 | loss: 0.1249150
	speed: 0.0537s/iter; left time: 226.0132s
	iters: 400, epoch: 6 | loss: 0.1167591
	speed: 0.0537s/iter; left time: 220.7569s
	iters: 500, epoch: 6 | loss: 0.1198143
	speed: 0.0538s/iter; left time: 215.8014s
	iters: 600, epoch: 6 | loss: 0.1263515
	speed: 0.0538s/iter; left time: 210.3897s
	iters: 700, epoch: 6 | loss: 0.1237719
	speed: 0.0535s/iter; left time: 203.9407s
	iters: 800, epoch: 6 | loss: 0.1125178
	speed: 0.0535s/iter; left time: 198.5471s
	iters: 900, epoch: 6 | loss: 0.1126838
	speed: 0.0537s/iter; left time: 193.7442s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.1220499 Vali Loss: 0.0388611 Test Loss: 0.0490557
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04315508157014847, rmse:0.2077380120754242, mae:0.1485593318939209, rse:0.7359532117843628
Original data scale mse:40330176.0, rmse:6350.6044921875, mae:4271.23583984375, rse:0.3164176046848297

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.041561320424079895, RMSE: 0.2038659304380417, MAE: 0.14510895311832428, RSE: 0.7222356200218201
Unscaled Metrics - MSE: 38455032.0, RMSE: 6201.2119140625, MAE: 4132.53271484375, RSE: 0.30897417664527893

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.04315508157014847, RMSE: 0.2077380120754242, MAE: 0.1485593318939209, RSE: 0.7359532117843628
Unscaled Metrics - MSE: 40330176.0, RMSE: 6350.6044921875, MAE: 4271.23583984375, RSE: 0.3164176046848297

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2242578
	speed: 0.0725s/iter; left time: 650.0106s
	iters: 200, epoch: 1 | loss: 0.1898357
	speed: 0.0420s/iter; left time: 371.7293s
	iters: 300, epoch: 1 | loss: 0.1789733
	speed: 0.0412s/iter; left time: 360.7032s
	iters: 400, epoch: 1 | loss: 0.1563358
	speed: 0.0408s/iter; left time: 353.5666s
	iters: 500, epoch: 1 | loss: 0.1528879
	speed: 0.0447s/iter; left time: 382.2834s
	iters: 600, epoch: 1 | loss: 0.1442027
	speed: 0.0453s/iter; left time: 383.4218s
	iters: 700, epoch: 1 | loss: 0.1612527
	speed: 0.0454s/iter; left time: 379.8701s
	iters: 800, epoch: 1 | loss: 0.1469584
	speed: 0.0455s/iter; left time: 375.9019s
	iters: 900, epoch: 1 | loss: 0.1317047
	speed: 0.0457s/iter; left time: 373.2978s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:40.29s
Steps: 906 | Train Loss: 0.1751491 Vali Loss: 0.1478380 Test Loss: 0.1567377
Validation loss decreased (inf --> 0.147838).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1182877
	speed: 0.1023s/iter; left time: 823.8732s
	iters: 200, epoch: 2 | loss: 0.1345648
	speed: 0.0458s/iter; left time: 364.6610s
	iters: 300, epoch: 2 | loss: 0.1065895
	speed: 0.0460s/iter; left time: 361.2539s
	iters: 400, epoch: 2 | loss: 0.0933015
	speed: 0.0459s/iter; left time: 356.1907s
	iters: 500, epoch: 2 | loss: 0.0904975
	speed: 0.0462s/iter; left time: 353.6962s
	iters: 600, epoch: 2 | loss: 0.0893114
	speed: 0.0461s/iter; left time: 348.4494s
	iters: 700, epoch: 2 | loss: 0.0859625
	speed: 0.0455s/iter; left time: 339.1846s
	iters: 800, epoch: 2 | loss: 0.1043300
	speed: 0.0463s/iter; left time: 340.3797s
	iters: 900, epoch: 2 | loss: 0.0872503
	speed: 0.0461s/iter; left time: 334.4571s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.57s
Steps: 906 | Train Loss: 0.1040518 Vali Loss: 0.0984693 Test Loss: 0.1067379
Validation loss decreased (0.147838 --> 0.098469).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0818719
	speed: 0.1072s/iter; left time: 766.3893s
	iters: 200, epoch: 3 | loss: 0.0733229
	speed: 0.0467s/iter; left time: 329.2906s
	iters: 300, epoch: 3 | loss: 0.0786101
	speed: 0.0463s/iter; left time: 321.9820s
	iters: 400, epoch: 3 | loss: 0.0841790
	speed: 0.0463s/iter; left time: 317.4203s
	iters: 500, epoch: 3 | loss: 0.0886876
	speed: 0.0462s/iter; left time: 311.7402s
	iters: 600, epoch: 3 | loss: 0.0879167
	speed: 0.0456s/iter; left time: 303.1527s
	iters: 700, epoch: 3 | loss: 0.0797993
	speed: 0.0467s/iter; left time: 305.9932s
	iters: 800, epoch: 3 | loss: 0.0734361
	speed: 0.0458s/iter; left time: 295.1245s
	iters: 900, epoch: 3 | loss: 0.0759469
	speed: 0.0463s/iter; left time: 293.7423s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.19s
Steps: 906 | Train Loss: 0.0804971 Vali Loss: 0.0948412 Test Loss: 0.0987356
Validation loss decreased (0.098469 --> 0.094841).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0642318
	speed: 0.1045s/iter; left time: 652.3535s
	iters: 200, epoch: 4 | loss: 0.0718670
	speed: 0.0461s/iter; left time: 283.1297s
	iters: 300, epoch: 4 | loss: 0.0737519
	speed: 0.0461s/iter; left time: 278.3082s
	iters: 400, epoch: 4 | loss: 0.0626771
	speed: 0.0463s/iter; left time: 275.3659s
	iters: 500, epoch: 4 | loss: 0.0802833
	speed: 0.0459s/iter; left time: 267.9427s
	iters: 600, epoch: 4 | loss: 0.0729032
	speed: 0.0462s/iter; left time: 265.2842s
	iters: 700, epoch: 4 | loss: 0.0714076
	speed: 0.0459s/iter; left time: 258.9103s
	iters: 800, epoch: 4 | loss: 0.0793254
	speed: 0.0448s/iter; left time: 248.2672s
	iters: 900, epoch: 4 | loss: 0.0715816
	speed: 0.0457s/iter; left time: 248.5096s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.86s
Steps: 906 | Train Loss: 0.0747579 Vali Loss: 0.0942132 Test Loss: 0.0991149
Validation loss decreased (0.094841 --> 0.094213).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0734457
	speed: 0.1062s/iter; left time: 566.7797s
	iters: 200, epoch: 5 | loss: 0.0635436
	speed: 0.0455s/iter; left time: 238.0296s
	iters: 300, epoch: 5 | loss: 0.0630266
	speed: 0.0453s/iter; left time: 232.6167s
	iters: 400, epoch: 5 | loss: 0.0745912
	speed: 0.0454s/iter; left time: 228.4972s
	iters: 500, epoch: 5 | loss: 0.0656142
	speed: 0.0458s/iter; left time: 226.3559s
	iters: 600, epoch: 5 | loss: 0.0726853
	speed: 0.0447s/iter; left time: 216.2456s
	iters: 700, epoch: 5 | loss: 0.0620390
	speed: 0.0447s/iter; left time: 211.5371s
	iters: 800, epoch: 5 | loss: 0.0712027
	speed: 0.0456s/iter; left time: 211.4913s
	iters: 900, epoch: 5 | loss: 0.0770849
	speed: 0.0448s/iter; left time: 203.0415s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.29s
Steps: 906 | Train Loss: 0.0701890 Vali Loss: 0.0943323 Test Loss: 0.1031515
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0754840
	speed: 0.1005s/iter; left time: 445.1818s
	iters: 200, epoch: 6 | loss: 0.0691707
	speed: 0.0446s/iter; left time: 192.9565s
	iters: 300, epoch: 6 | loss: 0.0682686
	speed: 0.0414s/iter; left time: 174.9972s
	iters: 400, epoch: 6 | loss: 0.0671632
	speed: 0.0418s/iter; left time: 172.5815s
	iters: 500, epoch: 6 | loss: 0.0660435
	speed: 0.0409s/iter; left time: 164.9983s
	iters: 600, epoch: 6 | loss: 0.0615367
	speed: 0.0411s/iter; left time: 161.7411s
	iters: 700, epoch: 6 | loss: 0.0730367
	speed: 0.0413s/iter; left time: 158.3831s
	iters: 800, epoch: 6 | loss: 0.0604000
	speed: 0.0409s/iter; left time: 152.5891s
	iters: 900, epoch: 6 | loss: 0.0591007
	speed: 0.0412s/iter; left time: 149.4527s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.37s
Steps: 906 | Train Loss: 0.0658827 Vali Loss: 0.0926875 Test Loss: 0.1001576
Validation loss decreased (0.094213 --> 0.092688).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0595968
	speed: 0.1023s/iter; left time: 360.4638s
	iters: 200, epoch: 7 | loss: 0.0638212
	speed: 0.0419s/iter; left time: 143.6088s
	iters: 300, epoch: 7 | loss: 0.0653568
	speed: 0.0416s/iter; left time: 138.2431s
	iters: 400, epoch: 7 | loss: 0.0698452
	speed: 0.0421s/iter; left time: 135.8982s
	iters: 500, epoch: 7 | loss: 0.0636178
	speed: 0.0425s/iter; left time: 132.8777s
	iters: 600, epoch: 7 | loss: 0.0604861
	speed: 0.0422s/iter; left time: 127.7809s
	iters: 700, epoch: 7 | loss: 0.0573631
	speed: 0.0424s/iter; left time: 123.9554s
	iters: 800, epoch: 7 | loss: 0.0619043
	speed: 0.0409s/iter; left time: 115.6549s
	iters: 900, epoch: 7 | loss: 0.0663653
	speed: 0.0415s/iter; left time: 112.9801s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.23s
Steps: 906 | Train Loss: 0.0620958 Vali Loss: 0.0929043 Test Loss: 0.1012591
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0586540
	speed: 0.0959s/iter; left time: 251.1811s
	iters: 200, epoch: 8 | loss: 0.0570356
	speed: 0.0420s/iter; left time: 105.7774s
	iters: 300, epoch: 8 | loss: 0.0614286
	speed: 0.0414s/iter; left time: 100.2437s
	iters: 400, epoch: 8 | loss: 0.0557369
	speed: 0.0418s/iter; left time: 96.9505s
	iters: 500, epoch: 8 | loss: 0.0580302
	speed: 0.0415s/iter; left time: 91.9913s
	iters: 600, epoch: 8 | loss: 0.0533425
	speed: 0.0413s/iter; left time: 87.5763s
	iters: 700, epoch: 8 | loss: 0.0671045
	speed: 0.0416s/iter; left time: 84.0866s
	iters: 800, epoch: 8 | loss: 0.0617950
	speed: 0.0413s/iter; left time: 79.3067s
	iters: 900, epoch: 8 | loss: 0.0624347
	speed: 0.0416s/iter; left time: 75.6381s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.93s
Steps: 906 | Train Loss: 0.0588377 Vali Loss: 0.0950490 Test Loss: 0.1016366
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0547856
	speed: 0.0960s/iter; left time: 164.4069s
	iters: 200, epoch: 9 | loss: 0.0544514
	speed: 0.0415s/iter; left time: 66.9476s
	iters: 300, epoch: 9 | loss: 0.0549416
	speed: 0.0416s/iter; left time: 62.9729s
	iters: 400, epoch: 9 | loss: 0.0452026
	speed: 0.0412s/iter; left time: 58.2491s
	iters: 500, epoch: 9 | loss: 0.0623649
	speed: 0.0409s/iter; left time: 53.6435s
	iters: 600, epoch: 9 | loss: 0.0527327
	speed: 0.0408s/iter; left time: 49.4744s
	iters: 700, epoch: 9 | loss: 0.0464450
	speed: 0.0410s/iter; left time: 45.6056s
	iters: 800, epoch: 9 | loss: 0.0578498
	speed: 0.0413s/iter; left time: 41.8026s
	iters: 900, epoch: 9 | loss: 0.0538073
	speed: 0.0411s/iter; left time: 37.5695s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.60s
Steps: 906 | Train Loss: 0.0553605 Vali Loss: 0.0962622 Test Loss: 0.1036498
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02428990602493286, rmse:0.15585219860076904, mae:0.10028143227100372, rse:0.5503962635993958
Original data scale mse:21054224.0, rmse:4588.48828125, mae:2843.177734375, rse:0.22814887762069702
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2398754
	speed: 0.0435s/iter; left time: 389.8503s
	iters: 200, epoch: 1 | loss: 0.1856430
	speed: 0.0404s/iter; left time: 357.9499s
	iters: 300, epoch: 1 | loss: 0.1713152
	speed: 0.0413s/iter; left time: 362.2326s
	iters: 400, epoch: 1 | loss: 0.1687666
	speed: 0.0408s/iter; left time: 353.7627s
	iters: 500, epoch: 1 | loss: 0.1446649
	speed: 0.0412s/iter; left time: 352.8009s
	iters: 600, epoch: 1 | loss: 0.1513872
	speed: 0.0414s/iter; left time: 350.3684s
	iters: 700, epoch: 1 | loss: 0.1499691
	speed: 0.0418s/iter; left time: 349.8712s
	iters: 800, epoch: 1 | loss: 0.1507011
	speed: 0.0412s/iter; left time: 340.0420s
	iters: 900, epoch: 1 | loss: 0.1491221
	speed: 0.0408s/iter; left time: 333.2013s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.60s
Steps: 906 | Train Loss: 0.1721454 Vali Loss: 0.1453274 Test Loss: 0.1554676
Validation loss decreased (inf --> 0.145327).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1367854
	speed: 0.1040s/iter; left time: 837.3232s
	iters: 200, epoch: 2 | loss: 0.1436689
	speed: 0.0423s/iter; left time: 336.6013s
	iters: 300, epoch: 2 | loss: 0.1178042
	speed: 0.0423s/iter; left time: 331.9771s
	iters: 400, epoch: 2 | loss: 0.1216650
	speed: 0.0427s/iter; left time: 331.1619s
	iters: 500, epoch: 2 | loss: 0.1117384
	speed: 0.0422s/iter; left time: 323.2580s
	iters: 600, epoch: 2 | loss: 0.1006765
	speed: 0.0421s/iter; left time: 318.3355s
	iters: 700, epoch: 2 | loss: 0.1048252
	speed: 0.0423s/iter; left time: 315.0200s
	iters: 800, epoch: 2 | loss: 0.1010501
	speed: 0.0414s/iter; left time: 304.5439s
	iters: 900, epoch: 2 | loss: 0.0956941
	speed: 0.0420s/iter; left time: 304.9591s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.66s
Steps: 906 | Train Loss: 0.1168003 Vali Loss: 0.1239653 Test Loss: 0.1346233
Validation loss decreased (0.145327 --> 0.123965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1117251
	speed: 0.1039s/iter; left time: 742.6213s
	iters: 200, epoch: 3 | loss: 0.0945623
	speed: 0.0424s/iter; left time: 298.5649s
	iters: 300, epoch: 3 | loss: 0.1088686
	speed: 0.0422s/iter; left time: 292.9194s
	iters: 400, epoch: 3 | loss: 0.1032642
	speed: 0.0418s/iter; left time: 286.3089s
	iters: 500, epoch: 3 | loss: 0.1057146
	speed: 0.0418s/iter; left time: 282.1651s
	iters: 600, epoch: 3 | loss: 0.1101636
	speed: 0.0422s/iter; left time: 280.7591s
	iters: 700, epoch: 3 | loss: 0.0980100
	speed: 0.0419s/iter; left time: 274.4427s
	iters: 800, epoch: 3 | loss: 0.0908421
	speed: 0.0419s/iter; left time: 270.3413s
	iters: 900, epoch: 3 | loss: 0.0937770
	speed: 0.0417s/iter; left time: 264.9833s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.40s
Steps: 906 | Train Loss: 0.0995902 Vali Loss: 0.1212749 Test Loss: 0.1346379
Validation loss decreased (0.123965 --> 0.121275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0892682
	speed: 0.1009s/iter; left time: 630.1567s
	iters: 200, epoch: 4 | loss: 0.0957315
	speed: 0.0426s/iter; left time: 261.7159s
	iters: 300, epoch: 4 | loss: 0.1004061
	speed: 0.0429s/iter; left time: 259.0213s
	iters: 400, epoch: 4 | loss: 0.0986237
	speed: 0.0433s/iter; left time: 257.3565s
	iters: 500, epoch: 4 | loss: 0.1025814
	speed: 0.0426s/iter; left time: 248.6978s
	iters: 600, epoch: 4 | loss: 0.0974615
	speed: 0.0427s/iter; left time: 245.4352s
	iters: 700, epoch: 4 | loss: 0.0962705
	speed: 0.0432s/iter; left time: 243.5245s
	iters: 800, epoch: 4 | loss: 0.1142599
	speed: 0.0426s/iter; left time: 236.2723s
	iters: 900, epoch: 4 | loss: 0.1030049
	speed: 0.0429s/iter; left time: 233.7431s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:39.09s
Steps: 906 | Train Loss: 0.0947139 Vali Loss: 0.1200141 Test Loss: 0.1341392
Validation loss decreased (0.121275 --> 0.120014).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0791858
	speed: 0.1046s/iter; left time: 558.0106s
	iters: 200, epoch: 5 | loss: 0.0867286
	speed: 0.0458s/iter; left time: 239.7717s
	iters: 300, epoch: 5 | loss: 0.0983167
	speed: 0.0454s/iter; left time: 233.0174s
	iters: 400, epoch: 5 | loss: 0.0940453
	speed: 0.0449s/iter; left time: 226.3567s
	iters: 500, epoch: 5 | loss: 0.0883916
	speed: 0.0455s/iter; left time: 224.8256s
	iters: 600, epoch: 5 | loss: 0.0810032
	speed: 0.0454s/iter; left time: 219.4685s
	iters: 700, epoch: 5 | loss: 0.0885094
	speed: 0.0458s/iter; left time: 216.7408s
	iters: 800, epoch: 5 | loss: 0.0834468
	speed: 0.0455s/iter; left time: 210.8197s
	iters: 900, epoch: 5 | loss: 0.0845016
	speed: 0.0450s/iter; left time: 204.2171s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.43s
Steps: 906 | Train Loss: 0.0901976 Vali Loss: 0.1183101 Test Loss: 0.1362442
Validation loss decreased (0.120014 --> 0.118310).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0904852
	speed: 0.1026s/iter; left time: 454.4632s
	iters: 200, epoch: 6 | loss: 0.0860661
	speed: 0.0427s/iter; left time: 185.1467s
	iters: 300, epoch: 6 | loss: 0.0953179
	speed: 0.0423s/iter; left time: 178.9851s
	iters: 400, epoch: 6 | loss: 0.0882991
	speed: 0.0427s/iter; left time: 176.2718s
	iters: 500, epoch: 6 | loss: 0.0900472
	speed: 0.0425s/iter; left time: 171.3693s
	iters: 600, epoch: 6 | loss: 0.0927474
	speed: 0.0418s/iter; left time: 164.1588s
	iters: 700, epoch: 6 | loss: 0.0931357
	speed: 0.0424s/iter; left time: 162.2969s
	iters: 800, epoch: 6 | loss: 0.0883807
	speed: 0.0425s/iter; left time: 158.7150s
	iters: 900, epoch: 6 | loss: 0.0831026
	speed: 0.0417s/iter; left time: 151.3560s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.64s
Steps: 906 | Train Loss: 0.0864103 Vali Loss: 0.1206650 Test Loss: 0.1355586
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0921505
	speed: 0.0991s/iter; left time: 349.3771s
	iters: 200, epoch: 7 | loss: 0.0885938
	speed: 0.0423s/iter; left time: 144.9604s
	iters: 300, epoch: 7 | loss: 0.0844395
	speed: 0.0410s/iter; left time: 136.3709s
	iters: 400, epoch: 7 | loss: 0.0734793
	speed: 0.0418s/iter; left time: 134.6488s
	iters: 500, epoch: 7 | loss: 0.0862103
	speed: 0.0418s/iter; left time: 130.6232s
	iters: 600, epoch: 7 | loss: 0.0811895
	speed: 0.0421s/iter; left time: 127.2037s
	iters: 700, epoch: 7 | loss: 0.0868509
	speed: 0.0416s/iter; left time: 121.7380s
	iters: 800, epoch: 7 | loss: 0.0813473
	speed: 0.0453s/iter; left time: 127.8969s
	iters: 900, epoch: 7 | loss: 0.0785179
	speed: 0.0458s/iter; left time: 124.7803s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:39.06s
Steps: 906 | Train Loss: 0.0824528 Vali Loss: 0.1243991 Test Loss: 0.1378392
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0794904
	speed: 0.0979s/iter; left time: 256.4764s
	iters: 200, epoch: 8 | loss: 0.0707949
	speed: 0.0420s/iter; left time: 105.8470s
	iters: 300, epoch: 8 | loss: 0.0853107
	speed: 0.0423s/iter; left time: 102.3940s
	iters: 400, epoch: 8 | loss: 0.0743418
	speed: 0.0418s/iter; left time: 96.8516s
	iters: 500, epoch: 8 | loss: 0.0784529
	speed: 0.0416s/iter; left time: 92.2456s
	iters: 600, epoch: 8 | loss: 0.0759883
	speed: 0.0461s/iter; left time: 97.7547s
	iters: 700, epoch: 8 | loss: 0.0777603
	speed: 0.0458s/iter; left time: 92.4739s
	iters: 800, epoch: 8 | loss: 0.0783959
	speed: 0.0417s/iter; left time: 79.9886s
	iters: 900, epoch: 8 | loss: 0.0811906
	speed: 0.0416s/iter; left time: 75.6178s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:39.03s
Steps: 906 | Train Loss: 0.0787350 Vali Loss: 0.1227477 Test Loss: 0.1377678
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.049023713916540146, rmse:0.2214130014181137, mae:0.1361154168844223, rse:0.7819259762763977
Original data scale mse:43415168.0, rmse:6589.0185546875, mae:3892.1005859375, rse:0.3276193141937256

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.02428990602493286, RMSE: 0.15585219860076904, MAE: 0.10028143227100372, RSE: 0.5503962635993958
Unscaled Metrics - MSE: 21054224.0, RMSE: 4588.48828125, MAE: 2843.177734375, RSE: 0.22814887762069702

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.049023713916540146, RMSE: 0.2214130014181137, MAE: 0.1361154168844223, RSE: 0.7819259762763977
Unscaled Metrics - MSE: 43415168.0, RMSE: 6589.0185546875, MAE: 3892.1005859375, RSE: 0.3276193141937256

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2246122
	speed: 0.0766s/iter; left time: 684.5962s
	iters: 200, epoch: 1 | loss: 0.2081167
	speed: 0.0478s/iter; left time: 422.3950s
	iters: 300, epoch: 1 | loss: 0.1920674
	speed: 0.0477s/iter; left time: 417.2155s
	iters: 400, epoch: 1 | loss: 0.1789065
	speed: 0.0477s/iter; left time: 412.1276s
	iters: 500, epoch: 1 | loss: 0.1717356
	speed: 0.0477s/iter; left time: 407.4011s
	iters: 600, epoch: 1 | loss: 0.1616433
	speed: 0.0477s/iter; left time: 402.5688s
	iters: 700, epoch: 1 | loss: 0.1571472
	speed: 0.0476s/iter; left time: 396.7013s
	iters: 800, epoch: 1 | loss: 0.1616814
	speed: 0.0465s/iter; left time: 383.5230s
	iters: 900, epoch: 1 | loss: 0.1596366
	speed: 0.0480s/iter; left time: 390.8968s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.76s
Steps: 904 | Train Loss: 0.1861247 Vali Loss: 0.1693542 Test Loss: 0.1905535
Validation loss decreased (inf --> 0.169354).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1489258
	speed: 0.1198s/iter; left time: 962.4461s
	iters: 200, epoch: 2 | loss: 0.1441848
	speed: 0.0501s/iter; left time: 397.5552s
	iters: 300, epoch: 2 | loss: 0.1349168
	speed: 0.0503s/iter; left time: 393.9881s
	iters: 400, epoch: 2 | loss: 0.1247658
	speed: 0.0502s/iter; left time: 388.4870s
	iters: 500, epoch: 2 | loss: 0.1154853
	speed: 0.0501s/iter; left time: 382.6325s
	iters: 600, epoch: 2 | loss: 0.1227886
	speed: 0.0503s/iter; left time: 379.0314s
	iters: 700, epoch: 2 | loss: 0.1144098
	speed: 0.0503s/iter; left time: 374.3143s
	iters: 800, epoch: 2 | loss: 0.1222551
	speed: 0.0503s/iter; left time: 369.2331s
	iters: 900, epoch: 2 | loss: 0.1097277
	speed: 0.0492s/iter; left time: 356.2351s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:45.57s
Steps: 904 | Train Loss: 0.1286928 Vali Loss: 0.1329564 Test Loss: 0.1465919
Validation loss decreased (0.169354 --> 0.132956).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1156913
	speed: 0.1178s/iter; left time: 840.5194s
	iters: 200, epoch: 3 | loss: 0.0975211
	speed: 0.0476s/iter; left time: 335.0737s
	iters: 300, epoch: 3 | loss: 0.1011100
	speed: 0.0475s/iter; left time: 329.4588s
	iters: 400, epoch: 3 | loss: 0.0964197
	speed: 0.0473s/iter; left time: 323.3032s
	iters: 500, epoch: 3 | loss: 0.1049682
	speed: 0.0477s/iter; left time: 321.3351s
	iters: 600, epoch: 3 | loss: 0.1179357
	speed: 0.0476s/iter; left time: 315.7179s
	iters: 700, epoch: 3 | loss: 0.0949325
	speed: 0.0475s/iter; left time: 310.6207s
	iters: 800, epoch: 3 | loss: 0.1066777
	speed: 0.0474s/iter; left time: 305.0717s
	iters: 900, epoch: 3 | loss: 0.1093972
	speed: 0.0474s/iter; left time: 300.4695s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.24s
Steps: 904 | Train Loss: 0.1063339 Vali Loss: 0.1264300 Test Loss: 0.1395350
Validation loss decreased (0.132956 --> 0.126430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0966239
	speed: 0.1168s/iter; left time: 727.2813s
	iters: 200, epoch: 4 | loss: 0.0967393
	speed: 0.0476s/iter; left time: 291.9313s
	iters: 300, epoch: 4 | loss: 0.0974483
	speed: 0.0475s/iter; left time: 286.5496s
	iters: 400, epoch: 4 | loss: 0.0835162
	speed: 0.0476s/iter; left time: 282.2574s
	iters: 500, epoch: 4 | loss: 0.1076640
	speed: 0.0477s/iter; left time: 278.2330s
	iters: 600, epoch: 4 | loss: 0.0894532
	speed: 0.0477s/iter; left time: 273.1273s
	iters: 700, epoch: 4 | loss: 0.1045760
	speed: 0.0478s/iter; left time: 268.9783s
	iters: 800, epoch: 4 | loss: 0.0914320
	speed: 0.0475s/iter; left time: 262.7435s
	iters: 900, epoch: 4 | loss: 0.1015885
	speed: 0.0447s/iter; left time: 242.9459s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.96s
Steps: 904 | Train Loss: 0.0977769 Vali Loss: 0.1318640 Test Loss: 0.1405835
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0893329
	speed: 0.1141s/iter; left time: 607.3401s
	iters: 200, epoch: 5 | loss: 0.1042083
	speed: 0.0477s/iter; left time: 249.2042s
	iters: 300, epoch: 5 | loss: 0.0933421
	speed: 0.0477s/iter; left time: 244.6439s
	iters: 400, epoch: 5 | loss: 0.0931832
	speed: 0.0477s/iter; left time: 239.4942s
	iters: 500, epoch: 5 | loss: 0.0885474
	speed: 0.0478s/iter; left time: 235.5157s
	iters: 600, epoch: 5 | loss: 0.0869318
	speed: 0.0475s/iter; left time: 229.3520s
	iters: 700, epoch: 5 | loss: 0.0834743
	speed: 0.0477s/iter; left time: 225.2079s
	iters: 800, epoch: 5 | loss: 0.0820703
	speed: 0.0472s/iter; left time: 218.4459s
	iters: 900, epoch: 5 | loss: 0.0915056
	speed: 0.0474s/iter; left time: 214.6974s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.29s
Steps: 904 | Train Loss: 0.0905559 Vali Loss: 0.1254451 Test Loss: 0.1421491
Validation loss decreased (0.126430 --> 0.125445).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0856860
	speed: 0.1170s/iter; left time: 517.1642s
	iters: 200, epoch: 6 | loss: 0.0736776
	speed: 0.0473s/iter; left time: 204.5221s
	iters: 300, epoch: 6 | loss: 0.0857565
	speed: 0.0474s/iter; left time: 200.0387s
	iters: 400, epoch: 6 | loss: 0.0888394
	speed: 0.0474s/iter; left time: 195.3220s
	iters: 500, epoch: 6 | loss: 0.0817830
	speed: 0.0474s/iter; left time: 190.7686s
	iters: 600, epoch: 6 | loss: 0.0856055
	speed: 0.0475s/iter; left time: 186.3789s
	iters: 700, epoch: 6 | loss: 0.0784503
	speed: 0.0474s/iter; left time: 180.9669s
	iters: 800, epoch: 6 | loss: 0.0899893
	speed: 0.0473s/iter; left time: 175.9523s
	iters: 900, epoch: 6 | loss: 0.0813079
	speed: 0.0472s/iter; left time: 171.0350s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.10s
Steps: 904 | Train Loss: 0.0840287 Vali Loss: 0.1298426 Test Loss: 0.1410313
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0734346
	speed: 0.1150s/iter; left time: 404.3763s
	iters: 200, epoch: 7 | loss: 0.0739107
	speed: 0.0480s/iter; left time: 163.9014s
	iters: 300, epoch: 7 | loss: 0.0758579
	speed: 0.0480s/iter; left time: 159.0662s
	iters: 400, epoch: 7 | loss: 0.0730996
	speed: 0.0478s/iter; left time: 153.8890s
	iters: 500, epoch: 7 | loss: 0.0801694
	speed: 0.0479s/iter; left time: 149.1838s
	iters: 600, epoch: 7 | loss: 0.0745910
	speed: 0.0477s/iter; left time: 143.8985s
	iters: 700, epoch: 7 | loss: 0.0786007
	speed: 0.0478s/iter; left time: 139.5066s
	iters: 800, epoch: 7 | loss: 0.0737484
	speed: 0.0478s/iter; left time: 134.5833s
	iters: 900, epoch: 7 | loss: 0.0823639
	speed: 0.0478s/iter; left time: 129.9419s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.52s
Steps: 904 | Train Loss: 0.0780969 Vali Loss: 0.1301674 Test Loss: 0.1462440
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0773419
	speed: 0.1137s/iter; left time: 297.0339s
	iters: 200, epoch: 8 | loss: 0.0745791
	speed: 0.0475s/iter; left time: 119.4015s
	iters: 300, epoch: 8 | loss: 0.0757380
	speed: 0.0475s/iter; left time: 114.5924s
	iters: 400, epoch: 8 | loss: 0.0745323
	speed: 0.0475s/iter; left time: 109.8397s
	iters: 500, epoch: 8 | loss: 0.0775097
	speed: 0.0476s/iter; left time: 105.2775s
	iters: 600, epoch: 8 | loss: 0.0751869
	speed: 0.0475s/iter; left time: 100.2757s
	iters: 700, epoch: 8 | loss: 0.0781270
	speed: 0.0476s/iter; left time: 95.9122s
	iters: 800, epoch: 8 | loss: 0.0685896
	speed: 0.0476s/iter; left time: 91.0042s
	iters: 900, epoch: 8 | loss: 0.0697254
	speed: 0.0476s/iter; left time: 86.3878s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.23s
Steps: 904 | Train Loss: 0.0732840 Vali Loss: 0.1306358 Test Loss: 0.1448181
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.045397039502859116, rmse:0.21306580305099487, mae:0.14210247993469238, rse:0.7545090913772583
Original data scale mse:40688736.0, rmse:6378.7724609375, mae:4003.507568359375, rse:0.31766512989997864
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2301333
	speed: 0.0500s/iter; left time: 447.0137s
	iters: 200, epoch: 1 | loss: 0.1951126
	speed: 0.0478s/iter; left time: 422.4199s
	iters: 300, epoch: 1 | loss: 0.1723979
	speed: 0.0480s/iter; left time: 419.3318s
	iters: 400, epoch: 1 | loss: 0.1629347
	speed: 0.0477s/iter; left time: 412.2920s
	iters: 500, epoch: 1 | loss: 0.1636003
	speed: 0.0478s/iter; left time: 408.3158s
	iters: 600, epoch: 1 | loss: 0.1724814
	speed: 0.0488s/iter; left time: 411.9863s
	iters: 700, epoch: 1 | loss: 0.1671904
	speed: 0.0502s/iter; left time: 418.4229s
	iters: 800, epoch: 1 | loss: 0.1681524
	speed: 0.0498s/iter; left time: 410.4301s
	iters: 900, epoch: 1 | loss: 0.1574399
	speed: 0.0488s/iter; left time: 397.4146s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.17s
Steps: 904 | Train Loss: 0.1846326 Vali Loss: 0.1673415 Test Loss: 0.1887328
Validation loss decreased (inf --> 0.167341).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1451383
	speed: 0.1212s/iter; left time: 974.4672s
	iters: 200, epoch: 2 | loss: 0.1455005
	speed: 0.0477s/iter; left time: 378.3367s
	iters: 300, epoch: 2 | loss: 0.1271278
	speed: 0.0477s/iter; left time: 373.6870s
	iters: 400, epoch: 2 | loss: 0.1205615
	speed: 0.0476s/iter; left time: 368.4213s
	iters: 500, epoch: 2 | loss: 0.1160921
	speed: 0.0476s/iter; left time: 363.5420s
	iters: 600, epoch: 2 | loss: 0.1196285
	speed: 0.0475s/iter; left time: 357.8634s
	iters: 700, epoch: 2 | loss: 0.1190385
	speed: 0.0476s/iter; left time: 353.8770s
	iters: 800, epoch: 2 | loss: 0.1101898
	speed: 0.0471s/iter; left time: 345.2306s
	iters: 900, epoch: 2 | loss: 0.1044184
	speed: 0.0474s/iter; left time: 342.8551s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.29s
Steps: 904 | Train Loss: 0.1283991 Vali Loss: 0.1355134 Test Loss: 0.1446352
Validation loss decreased (0.167341 --> 0.135513).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1039385
	speed: 0.1215s/iter; left time: 866.3886s
	iters: 200, epoch: 3 | loss: 0.1261861
	speed: 0.0477s/iter; left time: 335.1434s
	iters: 300, epoch: 3 | loss: 0.1150491
	speed: 0.0475s/iter; left time: 329.6268s
	iters: 400, epoch: 3 | loss: 0.1001509
	speed: 0.0476s/iter; left time: 325.1672s
	iters: 500, epoch: 3 | loss: 0.0977131
	speed: 0.0476s/iter; left time: 320.4054s
	iters: 600, epoch: 3 | loss: 0.1125626
	speed: 0.0477s/iter; left time: 316.2451s
	iters: 700, epoch: 3 | loss: 0.0982501
	speed: 0.0478s/iter; left time: 312.2386s
	iters: 800, epoch: 3 | loss: 0.1015485
	speed: 0.0475s/iter; left time: 305.5349s
	iters: 900, epoch: 3 | loss: 0.1056257
	speed: 0.0476s/iter; left time: 301.2429s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.34s
Steps: 904 | Train Loss: 0.1050790 Vali Loss: 0.1275464 Test Loss: 0.1397778
Validation loss decreased (0.135513 --> 0.127546).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0961418
	speed: 0.1181s/iter; left time: 735.8718s
	iters: 200, epoch: 4 | loss: 0.1005371
	speed: 0.0481s/iter; left time: 294.6778s
	iters: 300, epoch: 4 | loss: 0.0996916
	speed: 0.0476s/iter; left time: 287.0609s
	iters: 400, epoch: 4 | loss: 0.0910206
	speed: 0.0476s/iter; left time: 282.4551s
	iters: 500, epoch: 4 | loss: 0.1074546
	speed: 0.0475s/iter; left time: 277.0089s
	iters: 600, epoch: 4 | loss: 0.0947664
	speed: 0.0476s/iter; left time: 272.8884s
	iters: 700, epoch: 4 | loss: 0.0980362
	speed: 0.0479s/iter; left time: 269.7480s
	iters: 800, epoch: 4 | loss: 0.0869908
	speed: 0.0479s/iter; left time: 264.9840s
	iters: 900, epoch: 4 | loss: 0.0859004
	speed: 0.0478s/iter; left time: 259.2809s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.47s
Steps: 904 | Train Loss: 0.0974901 Vali Loss: 0.1262636 Test Loss: 0.1426535
Validation loss decreased (0.127546 --> 0.126264).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0958850
	speed: 0.1185s/iter; left time: 631.0066s
	iters: 200, epoch: 5 | loss: 0.0915819
	speed: 0.0473s/iter; left time: 247.1980s
	iters: 300, epoch: 5 | loss: 0.0879767
	speed: 0.0475s/iter; left time: 243.4579s
	iters: 400, epoch: 5 | loss: 0.0803326
	speed: 0.0474s/iter; left time: 238.0850s
	iters: 500, epoch: 5 | loss: 0.0850065
	speed: 0.0475s/iter; left time: 233.7860s
	iters: 600, epoch: 5 | loss: 0.0890771
	speed: 0.0476s/iter; left time: 229.6892s
	iters: 700, epoch: 5 | loss: 0.0929132
	speed: 0.0474s/iter; left time: 224.1027s
	iters: 800, epoch: 5 | loss: 0.0846247
	speed: 0.0475s/iter; left time: 219.7021s
	iters: 900, epoch: 5 | loss: 0.0851368
	speed: 0.0474s/iter; left time: 214.6123s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.21s
Steps: 904 | Train Loss: 0.0912254 Vali Loss: 0.1260705 Test Loss: 0.1398559
Validation loss decreased (0.126264 --> 0.126071).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0966838
	speed: 0.1180s/iter; left time: 521.6061s
	iters: 200, epoch: 6 | loss: 0.0888424
	speed: 0.0478s/iter; left time: 206.4158s
	iters: 300, epoch: 6 | loss: 0.0831272
	speed: 0.0474s/iter; left time: 199.9933s
	iters: 400, epoch: 6 | loss: 0.0903139
	speed: 0.0474s/iter; left time: 195.1566s
	iters: 500, epoch: 6 | loss: 0.0874166
	speed: 0.0474s/iter; left time: 190.7842s
	iters: 600, epoch: 6 | loss: 0.0912243
	speed: 0.0475s/iter; left time: 186.3248s
	iters: 700, epoch: 6 | loss: 0.0895760
	speed: 0.0475s/iter; left time: 181.5964s
	iters: 800, epoch: 6 | loss: 0.0793183
	speed: 0.0473s/iter; left time: 176.1254s
	iters: 900, epoch: 6 | loss: 0.0831427
	speed: 0.0474s/iter; left time: 171.5682s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.16s
Steps: 904 | Train Loss: 0.0851726 Vali Loss: 0.1282148 Test Loss: 0.1443390
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0754341
	speed: 0.1169s/iter; left time: 411.1184s
	iters: 200, epoch: 7 | loss: 0.0798553
	speed: 0.0479s/iter; left time: 163.7177s
	iters: 300, epoch: 7 | loss: 0.0775340
	speed: 0.0479s/iter; left time: 158.7545s
	iters: 400, epoch: 7 | loss: 0.0785744
	speed: 0.0477s/iter; left time: 153.5118s
	iters: 500, epoch: 7 | loss: 0.0772450
	speed: 0.0477s/iter; left time: 148.6140s
	iters: 600, epoch: 7 | loss: 0.0841917
	speed: 0.0504s/iter; left time: 152.0504s
	iters: 700, epoch: 7 | loss: 0.0775137
	speed: 0.0503s/iter; left time: 146.8029s
	iters: 800, epoch: 7 | loss: 0.0842347
	speed: 0.0499s/iter; left time: 140.6118s
	iters: 900, epoch: 7 | loss: 0.0790158
	speed: 0.0502s/iter; left time: 136.4940s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:44.54s
Steps: 904 | Train Loss: 0.0794048 Vali Loss: 0.1288580 Test Loss: 0.1445608
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0741648
	speed: 0.1143s/iter; left time: 298.7918s
	iters: 200, epoch: 8 | loss: 0.0693042
	speed: 0.0476s/iter; left time: 119.5015s
	iters: 300, epoch: 8 | loss: 0.0753945
	speed: 0.0477s/iter; left time: 115.0869s
	iters: 400, epoch: 8 | loss: 0.0730816
	speed: 0.0475s/iter; left time: 109.8324s
	iters: 500, epoch: 8 | loss: 0.0720230
	speed: 0.0475s/iter; left time: 105.0902s
	iters: 600, epoch: 8 | loss: 0.0695945
	speed: 0.0474s/iter; left time: 100.1734s
	iters: 700, epoch: 8 | loss: 0.0733338
	speed: 0.0476s/iter; left time: 95.8067s
	iters: 800, epoch: 8 | loss: 0.0721483
	speed: 0.0475s/iter; left time: 90.9388s
	iters: 900, epoch: 8 | loss: 0.0699571
	speed: 0.0476s/iter; left time: 86.2755s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.24s
Steps: 904 | Train Loss: 0.0741621 Vali Loss: 0.1269441 Test Loss: 0.1441041
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04406126216053963, rmse:0.20990774035453796, mae:0.13983353972434998, rse:0.7433257699012756
Original data scale mse:38573712.0, rmse:6210.77392578125, mae:3890.927490234375, rse:0.3092987537384033

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.045397039502859116, RMSE: 0.21306580305099487, MAE: 0.14210247993469238, RSE: 0.7545090913772583
Unscaled Metrics - MSE: 40688736.0, RMSE: 6378.7724609375, MAE: 4003.507568359375, RSE: 0.31766512989997864

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.04406126216053963, RMSE: 0.20990774035453796, MAE: 0.13983353972434998, RSE: 0.7433257699012756
Unscaled Metrics - MSE: 38573712.0, RMSE: 6210.77392578125, MAE: 3890.927490234375, RSE: 0.3092987537384033

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2147408
	speed: 0.0844s/iter; left time: 752.5271s
	iters: 200, epoch: 1 | loss: 0.2049752
	speed: 0.0544s/iter; left time: 480.0236s
	iters: 300, epoch: 1 | loss: 0.1858589
	speed: 0.0534s/iter; left time: 465.6800s
	iters: 400, epoch: 1 | loss: 0.1819223
	speed: 0.0533s/iter; left time: 459.9233s
	iters: 500, epoch: 1 | loss: 0.1769616
	speed: 0.0533s/iter; left time: 454.0801s
	iters: 600, epoch: 1 | loss: 0.1786938
	speed: 0.0532s/iter; left time: 448.0498s
	iters: 700, epoch: 1 | loss: 0.1688549
	speed: 0.0536s/iter; left time: 446.0571s
	iters: 800, epoch: 1 | loss: 0.1654620
	speed: 0.0532s/iter; left time: 437.0259s
	iters: 900, epoch: 1 | loss: 0.1702404
	speed: 0.0539s/iter; left time: 437.9574s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.15s
Steps: 902 | Train Loss: 0.1895083 Vali Loss: 0.1759074 Test Loss: 0.1999528
Validation loss decreased (inf --> 0.175907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1651679
	speed: 0.1349s/iter; left time: 1081.8961s
	iters: 200, epoch: 2 | loss: 0.1541310
	speed: 0.0538s/iter; left time: 426.2249s
	iters: 300, epoch: 2 | loss: 0.1586817
	speed: 0.0534s/iter; left time: 417.8857s
	iters: 400, epoch: 2 | loss: 0.1454573
	speed: 0.0537s/iter; left time: 414.2687s
	iters: 500, epoch: 2 | loss: 0.1384664
	speed: 0.0536s/iter; left time: 408.4807s
	iters: 600, epoch: 2 | loss: 0.1333779
	speed: 0.0538s/iter; left time: 404.1857s
	iters: 700, epoch: 2 | loss: 0.1278873
	speed: 0.0538s/iter; left time: 398.9881s
	iters: 800, epoch: 2 | loss: 0.1431116
	speed: 0.0538s/iter; left time: 393.9117s
	iters: 900, epoch: 2 | loss: 0.1280995
	speed: 0.0537s/iter; left time: 387.3605s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.76s
Steps: 902 | Train Loss: 0.1441035 Vali Loss: 0.1519851 Test Loss: 0.1711886
Validation loss decreased (0.175907 --> 0.151985).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1377297
	speed: 0.1353s/iter; left time: 962.9312s
	iters: 200, epoch: 3 | loss: 0.1210781
	speed: 0.0537s/iter; left time: 376.5384s
	iters: 300, epoch: 3 | loss: 0.1198194
	speed: 0.0536s/iter; left time: 371.0440s
	iters: 400, epoch: 3 | loss: 0.1224196
	speed: 0.0536s/iter; left time: 365.6868s
	iters: 500, epoch: 3 | loss: 0.1074672
	speed: 0.0536s/iter; left time: 359.7538s
	iters: 600, epoch: 3 | loss: 0.1116899
	speed: 0.0536s/iter; left time: 354.5666s
	iters: 700, epoch: 3 | loss: 0.1112872
	speed: 0.0537s/iter; left time: 349.8568s
	iters: 800, epoch: 3 | loss: 0.1100388
	speed: 0.0537s/iter; left time: 344.3599s
	iters: 900, epoch: 3 | loss: 0.1070697
	speed: 0.0537s/iter; left time: 339.3175s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.1143792 Vali Loss: 0.1312807 Test Loss: 0.1447967
Validation loss decreased (0.151985 --> 0.131281).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0993531
	speed: 0.1366s/iter; left time: 849.1048s
	iters: 200, epoch: 4 | loss: 0.0976536
	speed: 0.0537s/iter; left time: 328.6756s
	iters: 300, epoch: 4 | loss: 0.1099965
	speed: 0.0537s/iter; left time: 323.0815s
	iters: 400, epoch: 4 | loss: 0.1085633
	speed: 0.0538s/iter; left time: 318.0533s
	iters: 500, epoch: 4 | loss: 0.1053810
	speed: 0.0536s/iter; left time: 311.8871s
	iters: 600, epoch: 4 | loss: 0.0958832
	speed: 0.0534s/iter; left time: 305.3794s
	iters: 700, epoch: 4 | loss: 0.1085369
	speed: 0.0533s/iter; left time: 299.5085s
	iters: 800, epoch: 4 | loss: 0.1051037
	speed: 0.0536s/iter; left time: 295.5138s
	iters: 900, epoch: 4 | loss: 0.0943609
	speed: 0.0536s/iter; left time: 290.3997s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.64s
Steps: 902 | Train Loss: 0.1017112 Vali Loss: 0.1352619 Test Loss: 0.1506488
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1000706
	speed: 0.1328s/iter; left time: 705.5015s
	iters: 200, epoch: 5 | loss: 0.0926405
	speed: 0.0536s/iter; left time: 279.6510s
	iters: 300, epoch: 5 | loss: 0.0950490
	speed: 0.0539s/iter; left time: 275.4698s
	iters: 400, epoch: 5 | loss: 0.0976274
	speed: 0.0537s/iter; left time: 268.9795s
	iters: 500, epoch: 5 | loss: 0.0843251
	speed: 0.0536s/iter; left time: 263.3051s
	iters: 600, epoch: 5 | loss: 0.0954909
	speed: 0.0536s/iter; left time: 258.0546s
	iters: 700, epoch: 5 | loss: 0.0944040
	speed: 0.0537s/iter; left time: 253.1218s
	iters: 800, epoch: 5 | loss: 0.0896012
	speed: 0.0538s/iter; left time: 248.1191s
	iters: 900, epoch: 5 | loss: 0.0822994
	speed: 0.0538s/iter; left time: 242.6411s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.0932891 Vali Loss: 0.1389595 Test Loss: 0.1535437
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0876330
	speed: 0.1323s/iter; left time: 583.5504s
	iters: 200, epoch: 6 | loss: 0.0893045
	speed: 0.0539s/iter; left time: 232.1882s
	iters: 300, epoch: 6 | loss: 0.0815809
	speed: 0.0539s/iter; left time: 226.9240s
	iters: 400, epoch: 6 | loss: 0.0949811
	speed: 0.0535s/iter; left time: 219.8712s
	iters: 500, epoch: 6 | loss: 0.0837089
	speed: 0.0537s/iter; left time: 215.2059s
	iters: 600, epoch: 6 | loss: 0.0823262
	speed: 0.0533s/iter; left time: 208.4497s
	iters: 700, epoch: 6 | loss: 0.0879384
	speed: 0.0538s/iter; left time: 205.0885s
	iters: 800, epoch: 6 | loss: 0.0795501
	speed: 0.0535s/iter; left time: 198.5937s
	iters: 900, epoch: 6 | loss: 0.0906194
	speed: 0.0532s/iter; left time: 192.2108s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.0859014 Vali Loss: 0.1372263 Test Loss: 0.1539112
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04394709691405296, rmse:0.2096356302499771, mae:0.14478307962417603, rse:0.7426759004592896
Original data scale mse:39822152.0, rmse:6310.4794921875, mae:4082.469482421875, rse:0.31441840529441833
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2321397
	speed: 0.0453s/iter; left time: 403.8943s
	iters: 200, epoch: 1 | loss: 0.1973691
	speed: 0.0428s/iter; left time: 377.8423s
	iters: 300, epoch: 1 | loss: 0.1899634
	speed: 0.0428s/iter; left time: 373.6296s
	iters: 400, epoch: 1 | loss: 0.1636305
	speed: 0.0428s/iter; left time: 369.2176s
	iters: 500, epoch: 1 | loss: 0.1814534
	speed: 0.0428s/iter; left time: 364.8918s
	iters: 600, epoch: 1 | loss: 0.1696513
	speed: 0.0428s/iter; left time: 360.4121s
	iters: 700, epoch: 1 | loss: 0.1682921
	speed: 0.0428s/iter; left time: 356.3557s
	iters: 800, epoch: 1 | loss: 0.1633812
	speed: 0.0428s/iter; left time: 352.1331s
	iters: 900, epoch: 1 | loss: 0.1687731
	speed: 0.0428s/iter; left time: 347.7364s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.94s
Steps: 902 | Train Loss: 0.1893847 Vali Loss: 0.1745064 Test Loss: 0.1995509
Validation loss decreased (inf --> 0.174506).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1527932
	speed: 0.1364s/iter; left time: 1094.1890s
	iters: 200, epoch: 2 | loss: 0.1483294
	speed: 0.0536s/iter; left time: 424.7139s
	iters: 300, epoch: 2 | loss: 0.1427017
	speed: 0.0537s/iter; left time: 419.5394s
	iters: 400, epoch: 2 | loss: 0.1373652
	speed: 0.0536s/iter; left time: 413.8958s
	iters: 500, epoch: 2 | loss: 0.1404201
	speed: 0.0537s/iter; left time: 408.7945s
	iters: 600, epoch: 2 | loss: 0.1426174
	speed: 0.0534s/iter; left time: 401.8065s
	iters: 700, epoch: 2 | loss: 0.1350924
	speed: 0.0535s/iter; left time: 396.9304s
	iters: 800, epoch: 2 | loss: 0.1242686
	speed: 0.0535s/iter; left time: 391.6150s
	iters: 900, epoch: 2 | loss: 0.1295320
	speed: 0.0535s/iter; left time: 385.9883s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.69s
Steps: 902 | Train Loss: 0.1452574 Vali Loss: 0.1592431 Test Loss: 0.1785243
Validation loss decreased (0.174506 --> 0.159243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1216370
	speed: 0.1350s/iter; left time: 960.6596s
	iters: 200, epoch: 3 | loss: 0.1274602
	speed: 0.0536s/iter; left time: 376.1184s
	iters: 300, epoch: 3 | loss: 0.1250435
	speed: 0.0535s/iter; left time: 370.1860s
	iters: 400, epoch: 3 | loss: 0.1166226
	speed: 0.0537s/iter; left time: 365.8595s
	iters: 500, epoch: 3 | loss: 0.1175315
	speed: 0.0536s/iter; left time: 359.9996s
	iters: 600, epoch: 3 | loss: 0.1078033
	speed: 0.0535s/iter; left time: 354.0505s
	iters: 700, epoch: 3 | loss: 0.1084212
	speed: 0.0534s/iter; left time: 348.2309s
	iters: 800, epoch: 3 | loss: 0.1020218
	speed: 0.0533s/iter; left time: 342.0026s
	iters: 900, epoch: 3 | loss: 0.1084920
	speed: 0.0536s/iter; left time: 338.6977s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.56s
Steps: 902 | Train Loss: 0.1151611 Vali Loss: 0.1308115 Test Loss: 0.1448318
Validation loss decreased (0.159243 --> 0.130811).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1048867
	speed: 0.1360s/iter; left time: 845.4010s
	iters: 200, epoch: 4 | loss: 0.0964195
	speed: 0.0537s/iter; left time: 328.1689s
	iters: 300, epoch: 4 | loss: 0.1035071
	speed: 0.0538s/iter; left time: 323.4828s
	iters: 400, epoch: 4 | loss: 0.1002823
	speed: 0.0538s/iter; left time: 318.1358s
	iters: 500, epoch: 4 | loss: 0.1016895
	speed: 0.0536s/iter; left time: 311.8232s
	iters: 600, epoch: 4 | loss: 0.1110194
	speed: 0.0537s/iter; left time: 307.1581s
	iters: 700, epoch: 4 | loss: 0.0958979
	speed: 0.0537s/iter; left time: 301.5589s
	iters: 800, epoch: 4 | loss: 0.1013383
	speed: 0.0537s/iter; left time: 296.0334s
	iters: 900, epoch: 4 | loss: 0.0973082
	speed: 0.0537s/iter; left time: 290.9437s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.77s
Steps: 902 | Train Loss: 0.1012365 Vali Loss: 0.1355156 Test Loss: 0.1474784
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0882527
	speed: 0.1359s/iter; left time: 721.8029s
	iters: 200, epoch: 5 | loss: 0.0935989
	speed: 0.0537s/iter; left time: 280.1440s
	iters: 300, epoch: 5 | loss: 0.0921567
	speed: 0.0537s/iter; left time: 274.8168s
	iters: 400, epoch: 5 | loss: 0.0977337
	speed: 0.0536s/iter; left time: 268.6083s
	iters: 500, epoch: 5 | loss: 0.1000321
	speed: 0.0537s/iter; left time: 263.6669s
	iters: 600, epoch: 5 | loss: 0.0865251
	speed: 0.0538s/iter; left time: 259.1644s
	iters: 700, epoch: 5 | loss: 0.0922151
	speed: 0.0537s/iter; left time: 253.0635s
	iters: 800, epoch: 5 | loss: 0.0845081
	speed: 0.0536s/iter; left time: 247.3660s
	iters: 900, epoch: 5 | loss: 0.0910032
	speed: 0.0538s/iter; left time: 242.7150s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.75s
Steps: 902 | Train Loss: 0.0929604 Vali Loss: 0.1366524 Test Loss: 0.1539558
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0900509
	speed: 0.1331s/iter; left time: 586.9460s
	iters: 200, epoch: 6 | loss: 0.0848731
	speed: 0.0537s/iter; left time: 231.6547s
	iters: 300, epoch: 6 | loss: 0.0875704
	speed: 0.0536s/iter; left time: 225.7914s
	iters: 400, epoch: 6 | loss: 0.0834398
	speed: 0.0537s/iter; left time: 220.9433s
	iters: 500, epoch: 6 | loss: 0.0816596
	speed: 0.0536s/iter; left time: 215.0474s
	iters: 600, epoch: 6 | loss: 0.0911666
	speed: 0.0537s/iter; left time: 209.8499s
	iters: 700, epoch: 6 | loss: 0.0888930
	speed: 0.0537s/iter; left time: 204.6476s
	iters: 800, epoch: 6 | loss: 0.0769717
	speed: 0.0538s/iter; left time: 199.5199s
	iters: 900, epoch: 6 | loss: 0.0764168
	speed: 0.0536s/iter; left time: 193.4223s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.67s
Steps: 902 | Train Loss: 0.0858187 Vali Loss: 0.1359175 Test Loss: 0.1564617
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04477142170071602, rmse:0.21159258484840393, mae:0.14479929208755493, rse:0.7496087551116943
Original data scale mse:41195184.0, rmse:6418.34765625, mae:4090.05419921875, rse:0.31979289650917053

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.04394709691405296, RMSE: 0.2096356302499771, MAE: 0.14478307962417603, RSE: 0.7426759004592896
Unscaled Metrics - MSE: 39822152.0, RMSE: 6310.4794921875, MAE: 4082.469482421875, RSE: 0.31441840529441833

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.04477142170071602, RMSE: 0.21159258484840393, MAE: 0.14479929208755493, RSE: 0.7496087551116943
Unscaled Metrics - MSE: 41195184.0, RMSE: 6418.34765625, MAE: 4090.05419921875, RSE: 0.31979289650917053
