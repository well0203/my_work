
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0179542
	speed: 0.0552s/iter; left time: 487.2250s
	iters: 200, epoch: 1 | loss: 0.0138904
	speed: 0.0273s/iter; left time: 238.1074s
	iters: 300, epoch: 1 | loss: 0.0134035
	speed: 0.0273s/iter; left time: 235.6602s
	iters: 400, epoch: 1 | loss: 0.0135565
	speed: 0.0274s/iter; left time: 233.9331s
	iters: 500, epoch: 1 | loss: 0.0133962
	speed: 0.0274s/iter; left time: 231.2300s
	iters: 600, epoch: 1 | loss: 0.0119742
	speed: 0.0274s/iter; left time: 228.4587s
	iters: 700, epoch: 1 | loss: 0.0094369
	speed: 0.0274s/iter; left time: 225.4702s
	iters: 800, epoch: 1 | loss: 0.0085627
	speed: 0.0274s/iter; left time: 222.5055s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.93s
Steps: 893 | Train Loss: 0.0136738 Vali Loss: 0.0103639 Test Loss: 0.0115427
Validation loss decreased (inf --> 0.010364).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0108790
	speed: 0.1052s/iter; left time: 835.0876s
	iters: 200, epoch: 2 | loss: 0.0106265
	speed: 0.0273s/iter; left time: 214.2982s
	iters: 300, epoch: 2 | loss: 0.0171496
	speed: 0.0273s/iter; left time: 211.5469s
	iters: 400, epoch: 2 | loss: 0.0108691
	speed: 0.0274s/iter; left time: 209.1198s
	iters: 500, epoch: 2 | loss: 0.0096130
	speed: 0.0273s/iter; left time: 205.9187s
	iters: 600, epoch: 2 | loss: 0.0067438
	speed: 0.0273s/iter; left time: 203.2502s
	iters: 700, epoch: 2 | loss: 0.0092933
	speed: 0.0273s/iter; left time: 200.6816s
	iters: 800, epoch: 2 | loss: 0.0094463
	speed: 0.0274s/iter; left time: 198.0658s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.73s
Steps: 893 | Train Loss: 0.0112482 Vali Loss: 0.0105930 Test Loss: 0.0121308
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0082705
	speed: 0.1032s/iter; left time: 727.0771s
	iters: 200, epoch: 3 | loss: 0.0104382
	speed: 0.0274s/iter; left time: 189.9706s
	iters: 300, epoch: 3 | loss: 0.0095984
	speed: 0.0273s/iter; left time: 187.1716s
	iters: 400, epoch: 3 | loss: 0.0099487
	speed: 0.0273s/iter; left time: 184.2654s
	iters: 500, epoch: 3 | loss: 0.0085704
	speed: 0.0273s/iter; left time: 181.6043s
	iters: 600, epoch: 3 | loss: 0.0132205
	speed: 0.0273s/iter; left time: 178.8964s
	iters: 700, epoch: 3 | loss: 0.0080598
	speed: 0.0273s/iter; left time: 176.2561s
	iters: 800, epoch: 3 | loss: 0.0189686
	speed: 0.0274s/iter; left time: 173.7908s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.69s
Steps: 893 | Train Loss: 0.0108874 Vali Loss: 0.0112805 Test Loss: 0.0129576
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0136215
	speed: 0.1034s/iter; left time: 635.8994s
	iters: 200, epoch: 4 | loss: 0.0101591
	speed: 0.0273s/iter; left time: 165.2181s
	iters: 300, epoch: 4 | loss: 0.0112350
	speed: 0.0273s/iter; left time: 162.5542s
	iters: 400, epoch: 4 | loss: 0.0081314
	speed: 0.0273s/iter; left time: 159.9038s
	iters: 500, epoch: 4 | loss: 0.0093440
	speed: 0.0273s/iter; left time: 157.1197s
	iters: 600, epoch: 4 | loss: 0.0082074
	speed: 0.0273s/iter; left time: 154.3747s
	iters: 700, epoch: 4 | loss: 0.0132336
	speed: 0.0273s/iter; left time: 151.6975s
	iters: 800, epoch: 4 | loss: 0.0107905
	speed: 0.0273s/iter; left time: 148.9472s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.65s
Steps: 893 | Train Loss: 0.0102207 Vali Loss: 0.0100708 Test Loss: 0.0113745
Validation loss decreased (0.010364 --> 0.010071).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0115043
	speed: 0.1043s/iter; left time: 548.3836s
	iters: 200, epoch: 5 | loss: 0.0084141
	speed: 0.0273s/iter; left time: 140.9637s
	iters: 300, epoch: 5 | loss: 0.0127091
	speed: 0.0273s/iter; left time: 138.1543s
	iters: 400, epoch: 5 | loss: 0.0153487
	speed: 0.0273s/iter; left time: 135.5170s
	iters: 500, epoch: 5 | loss: 0.0081473
	speed: 0.0273s/iter; left time: 132.7334s
	iters: 600, epoch: 5 | loss: 0.0102224
	speed: 0.0274s/iter; left time: 130.2442s
	iters: 700, epoch: 5 | loss: 0.0080581
	speed: 0.0274s/iter; left time: 127.5125s
	iters: 800, epoch: 5 | loss: 0.0064560
	speed: 0.0274s/iter; left time: 124.7568s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.68s
Steps: 893 | Train Loss: 0.0096187 Vali Loss: 0.0101121 Test Loss: 0.0111427
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0088460
	speed: 0.1025s/iter; left time: 447.4207s
	iters: 200, epoch: 6 | loss: 0.0091043
	speed: 0.0273s/iter; left time: 116.5049s
	iters: 300, epoch: 6 | loss: 0.0085249
	speed: 0.0273s/iter; left time: 113.7709s
	iters: 400, epoch: 6 | loss: 0.0152927
	speed: 0.0273s/iter; left time: 111.1869s
	iters: 500, epoch: 6 | loss: 0.0070305
	speed: 0.0273s/iter; left time: 108.3764s
	iters: 600, epoch: 6 | loss: 0.0100624
	speed: 0.0273s/iter; left time: 105.5898s
	iters: 700, epoch: 6 | loss: 0.0063936
	speed: 0.0273s/iter; left time: 102.9194s
	iters: 800, epoch: 6 | loss: 0.0066943
	speed: 0.0274s/iter; left time: 100.3018s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.66s
Steps: 893 | Train Loss: 0.0088890 Vali Loss: 0.0101707 Test Loss: 0.0111860
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0083871
	speed: 0.1026s/iter; left time: 356.3202s
	iters: 200, epoch: 7 | loss: 0.0053402
	speed: 0.0273s/iter; left time: 92.0997s
	iters: 300, epoch: 7 | loss: 0.0097876
	speed: 0.0274s/iter; left time: 89.5210s
	iters: 400, epoch: 7 | loss: 0.0099697
	speed: 0.0274s/iter; left time: 86.8617s
	iters: 500, epoch: 7 | loss: 0.0062928
	speed: 0.0274s/iter; left time: 84.1095s
	iters: 600, epoch: 7 | loss: 0.0058842
	speed: 0.0275s/iter; left time: 81.6776s
	iters: 700, epoch: 7 | loss: 0.0072408
	speed: 0.0273s/iter; left time: 78.4893s
	iters: 800, epoch: 7 | loss: 0.0060141
	speed: 0.0273s/iter; left time: 75.7465s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.70s
Steps: 893 | Train Loss: 0.0082139 Vali Loss: 0.0104854 Test Loss: 0.0114490
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011374467983841896, rmse:0.10665114969015121, mae:0.06564203649759293, rse:0.40304216742515564
Original data scale mse:1649581.25, rmse:1284.3602294921875, mae:850.4398803710938, rse:0.09025502949953079
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0166307
	speed: 0.0299s/iter; left time: 263.9967s
	iters: 200, epoch: 1 | loss: 0.0166566
	speed: 0.0273s/iter; left time: 238.6638s
	iters: 300, epoch: 1 | loss: 0.0141988
	speed: 0.0274s/iter; left time: 236.3787s
	iters: 400, epoch: 1 | loss: 0.0141700
	speed: 0.0274s/iter; left time: 233.4709s
	iters: 500, epoch: 1 | loss: 0.0141194
	speed: 0.0274s/iter; left time: 230.6842s
	iters: 600, epoch: 1 | loss: 0.0084427
	speed: 0.0273s/iter; left time: 227.7201s
	iters: 700, epoch: 1 | loss: 0.0085769
	speed: 0.0274s/iter; left time: 225.5102s
	iters: 800, epoch: 1 | loss: 0.0109168
	speed: 0.0274s/iter; left time: 222.8881s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.73s
Steps: 893 | Train Loss: 0.0138819 Vali Loss: 0.0103448 Test Loss: 0.0114709
Validation loss decreased (inf --> 0.010345).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0129929
	speed: 0.1051s/iter; left time: 834.6183s
	iters: 200, epoch: 2 | loss: 0.0109798
	speed: 0.0274s/iter; left time: 214.7107s
	iters: 300, epoch: 2 | loss: 0.0116839
	speed: 0.0274s/iter; left time: 212.1379s
	iters: 400, epoch: 2 | loss: 0.0110836
	speed: 0.0273s/iter; left time: 208.8368s
	iters: 500, epoch: 2 | loss: 0.0118132
	speed: 0.0274s/iter; left time: 206.7823s
	iters: 600, epoch: 2 | loss: 0.0090276
	speed: 0.0274s/iter; left time: 204.1027s
	iters: 700, epoch: 2 | loss: 0.0093626
	speed: 0.0273s/iter; left time: 200.5686s
	iters: 800, epoch: 2 | loss: 0.0107725
	speed: 0.0273s/iter; left time: 197.8214s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.75s
Steps: 893 | Train Loss: 0.0112159 Vali Loss: 0.0109890 Test Loss: 0.0122895
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0082013
	speed: 0.1034s/iter; left time: 728.3026s
	iters: 200, epoch: 3 | loss: 0.0094840
	speed: 0.0272s/iter; left time: 188.9278s
	iters: 300, epoch: 3 | loss: 0.0102744
	speed: 0.0272s/iter; left time: 186.1707s
	iters: 400, epoch: 3 | loss: 0.0099393
	speed: 0.0272s/iter; left time: 183.5389s
	iters: 500, epoch: 3 | loss: 0.0106268
	speed: 0.0272s/iter; left time: 180.4941s
	iters: 600, epoch: 3 | loss: 0.0128014
	speed: 0.0274s/iter; left time: 179.3906s
	iters: 700, epoch: 3 | loss: 0.0077773
	speed: 0.0274s/iter; left time: 176.8723s
	iters: 800, epoch: 3 | loss: 0.0084611
	speed: 0.0272s/iter; left time: 172.4294s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.0103463 Vali Loss: 0.0102759 Test Loss: 0.0115329
Validation loss decreased (0.010345 --> 0.010276).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0077549
	speed: 0.1058s/iter; left time: 651.0412s
	iters: 200, epoch: 4 | loss: 0.0082192
	speed: 0.0274s/iter; left time: 165.7412s
	iters: 300, epoch: 4 | loss: 0.0111770
	speed: 0.0273s/iter; left time: 162.7405s
	iters: 400, epoch: 4 | loss: 0.0101953
	speed: 0.0274s/iter; left time: 160.0846s
	iters: 500, epoch: 4 | loss: 0.0088418
	speed: 0.0274s/iter; left time: 157.3829s
	iters: 600, epoch: 4 | loss: 0.0097280
	speed: 0.0274s/iter; left time: 154.6599s
	iters: 700, epoch: 4 | loss: 0.0072450
	speed: 0.0274s/iter; left time: 151.9348s
	iters: 800, epoch: 4 | loss: 0.0095672
	speed: 0.0274s/iter; left time: 149.1266s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.74s
Steps: 893 | Train Loss: 0.0096818 Vali Loss: 0.0104526 Test Loss: 0.0117177
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0081902
	speed: 0.1034s/iter; left time: 543.9136s
	iters: 200, epoch: 5 | loss: 0.0095075
	speed: 0.0276s/iter; left time: 142.1739s
	iters: 300, epoch: 5 | loss: 0.0122090
	speed: 0.0276s/iter; left time: 139.4676s
	iters: 400, epoch: 5 | loss: 0.0068247
	speed: 0.0276s/iter; left time: 136.8705s
	iters: 500, epoch: 5 | loss: 0.0092223
	speed: 0.0276s/iter; left time: 134.0687s
	iters: 600, epoch: 5 | loss: 0.0071447
	speed: 0.0275s/iter; left time: 131.0474s
	iters: 700, epoch: 5 | loss: 0.0104501
	speed: 0.0276s/iter; left time: 128.4322s
	iters: 800, epoch: 5 | loss: 0.0105895
	speed: 0.0275s/iter; left time: 125.5672s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.87s
Steps: 893 | Train Loss: 0.0092726 Vali Loss: 0.0104986 Test Loss: 0.0117461
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0108101
	speed: 0.1039s/iter; left time: 453.8211s
	iters: 200, epoch: 6 | loss: 0.0076216
	speed: 0.0276s/iter; left time: 117.7827s
	iters: 300, epoch: 6 | loss: 0.0076059
	speed: 0.0275s/iter; left time: 114.7628s
	iters: 400, epoch: 6 | loss: 0.0092112
	speed: 0.0276s/iter; left time: 112.3754s
	iters: 500, epoch: 6 | loss: 0.0112508
	speed: 0.0271s/iter; left time: 107.6380s
	iters: 600, epoch: 6 | loss: 0.0075125
	speed: 0.0272s/iter; left time: 104.9773s
	iters: 700, epoch: 6 | loss: 0.0073639
	speed: 0.0272s/iter; left time: 102.2479s
	iters: 800, epoch: 6 | loss: 0.0104844
	speed: 0.0273s/iter; left time: 100.0395s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.76s
Steps: 893 | Train Loss: 0.0086391 Vali Loss: 0.0105031 Test Loss: 0.0113079
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011532868258655071, rmse:0.10739119350910187, mae:0.06529892235994339, rse:0.40583881735801697
Original data scale mse:1637449.875, rmse:1279.6287841796875, mae:845.58740234375, rse:0.08992253243923187

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.011374467983841896, RMSE: 0.10665114969015121, MAE: 0.06564203649759293, RSE: 0.40304216742515564
Unscaled Metrics - MSE: 1649581.25, RMSE: 1284.3602294921875, MAE: 850.4398803710938, RSE: 0.09025502949953079

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.011532868258655071, RMSE: 0.10739119350910187, MAE: 0.06529892235994339, RSE: 0.40583881735801697
Unscaled Metrics - MSE: 1637449.875, RMSE: 1279.6287841796875, MAE: 845.58740234375, RSE: 0.08992253243923187

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0263875
	speed: 0.0550s/iter; left time: 484.5276s
	iters: 200, epoch: 1 | loss: 0.0218959
	speed: 0.0275s/iter; left time: 239.5755s
	iters: 300, epoch: 1 | loss: 0.0232871
	speed: 0.0275s/iter; left time: 236.6156s
	iters: 400, epoch: 1 | loss: 0.0175504
	speed: 0.0275s/iter; left time: 233.7479s
	iters: 500, epoch: 1 | loss: 0.0178115
	speed: 0.0275s/iter; left time: 230.9166s
	iters: 600, epoch: 1 | loss: 0.0190175
	speed: 0.0275s/iter; left time: 228.1475s
	iters: 700, epoch: 1 | loss: 0.0164534
	speed: 0.0275s/iter; left time: 225.7372s
	iters: 800, epoch: 1 | loss: 0.0149383
	speed: 0.0275s/iter; left time: 222.7568s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.94s
Steps: 891 | Train Loss: 0.0202432 Vali Loss: 0.0170104 Test Loss: 0.0181856
Validation loss decreased (inf --> 0.017010).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0198332
	speed: 0.1035s/iter; left time: 820.0447s
	iters: 200, epoch: 2 | loss: 0.0126811
	speed: 0.0274s/iter; left time: 214.5012s
	iters: 300, epoch: 2 | loss: 0.0172694
	speed: 0.0274s/iter; left time: 211.7450s
	iters: 400, epoch: 2 | loss: 0.0172652
	speed: 0.0274s/iter; left time: 208.5730s
	iters: 500, epoch: 2 | loss: 0.0150981
	speed: 0.0274s/iter; left time: 206.2350s
	iters: 600, epoch: 2 | loss: 0.0165091
	speed: 0.0274s/iter; left time: 203.0811s
	iters: 700, epoch: 2 | loss: 0.0191504
	speed: 0.0274s/iter; left time: 200.3715s
	iters: 800, epoch: 2 | loss: 0.0176131
	speed: 0.0274s/iter; left time: 197.5709s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.66s
Steps: 891 | Train Loss: 0.0178884 Vali Loss: 0.0187196 Test Loss: 0.0195916
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0162321
	speed: 0.1041s/iter; left time: 731.3762s
	iters: 200, epoch: 3 | loss: 0.0164735
	speed: 0.0277s/iter; left time: 191.9194s
	iters: 300, epoch: 3 | loss: 0.0150039
	speed: 0.0277s/iter; left time: 189.4536s
	iters: 400, epoch: 3 | loss: 0.0172733
	speed: 0.0277s/iter; left time: 186.2656s
	iters: 500, epoch: 3 | loss: 0.0167668
	speed: 0.0277s/iter; left time: 183.7205s
	iters: 600, epoch: 3 | loss: 0.0138447
	speed: 0.0277s/iter; left time: 180.6407s
	iters: 700, epoch: 3 | loss: 0.0161234
	speed: 0.0277s/iter; left time: 177.9997s
	iters: 800, epoch: 3 | loss: 0.0136648
	speed: 0.0277s/iter; left time: 175.1595s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.96s
Steps: 891 | Train Loss: 0.0153205 Vali Loss: 0.0192233 Test Loss: 0.0199144
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0136606
	speed: 0.1044s/iter; left time: 640.6647s
	iters: 200, epoch: 4 | loss: 0.0178643
	speed: 0.0278s/iter; left time: 167.7844s
	iters: 300, epoch: 4 | loss: 0.0123156
	speed: 0.0278s/iter; left time: 164.8036s
	iters: 400, epoch: 4 | loss: 0.0127967
	speed: 0.0277s/iter; left time: 161.5033s
	iters: 500, epoch: 4 | loss: 0.0209878
	speed: 0.0277s/iter; left time: 158.8467s
	iters: 600, epoch: 4 | loss: 0.0116704
	speed: 0.0276s/iter; left time: 155.7819s
	iters: 700, epoch: 4 | loss: 0.0132667
	speed: 0.0276s/iter; left time: 153.0243s
	iters: 800, epoch: 4 | loss: 0.0128624
	speed: 0.0276s/iter; left time: 150.1039s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.91s
Steps: 891 | Train Loss: 0.0129043 Vali Loss: 0.0200244 Test Loss: 0.0225289
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01818559132516384, rmse:0.13485395908355713, mae:0.08711884915828705, rse:0.5098973512649536
Original data scale mse:3181651.5, rmse:1783.718505859375, mae:1182.0157470703125, rse:0.1255275458097458
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0228928
	speed: 0.0303s/iter; left time: 266.6980s
	iters: 200, epoch: 1 | loss: 0.0217010
	speed: 0.0276s/iter; left time: 240.3312s
	iters: 300, epoch: 1 | loss: 0.0180449
	speed: 0.0276s/iter; left time: 237.7914s
	iters: 400, epoch: 1 | loss: 0.0172134
	speed: 0.0276s/iter; left time: 234.8575s
	iters: 500, epoch: 1 | loss: 0.0184300
	speed: 0.0276s/iter; left time: 232.1817s
	iters: 600, epoch: 1 | loss: 0.0183138
	speed: 0.0276s/iter; left time: 229.3931s
	iters: 700, epoch: 1 | loss: 0.0156772
	speed: 0.0276s/iter; left time: 226.6315s
	iters: 800, epoch: 1 | loss: 0.0192672
	speed: 0.0276s/iter; left time: 224.0229s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.91s
Steps: 891 | Train Loss: 0.0202957 Vali Loss: 0.0168783 Test Loss: 0.0180804
Validation loss decreased (inf --> 0.016878).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0215709
	speed: 0.1063s/iter; left time: 841.5654s
	iters: 200, epoch: 2 | loss: 0.0182619
	speed: 0.0275s/iter; left time: 215.1483s
	iters: 300, epoch: 2 | loss: 0.0155779
	speed: 0.0275s/iter; left time: 212.3227s
	iters: 400, epoch: 2 | loss: 0.0211766
	speed: 0.0275s/iter; left time: 209.6543s
	iters: 500, epoch: 2 | loss: 0.0140793
	speed: 0.0274s/iter; left time: 206.3725s
	iters: 600, epoch: 2 | loss: 0.0237876
	speed: 0.0274s/iter; left time: 203.2644s
	iters: 700, epoch: 2 | loss: 0.0155597
	speed: 0.0274s/iter; left time: 200.6269s
	iters: 800, epoch: 2 | loss: 0.0165534
	speed: 0.0278s/iter; left time: 200.3659s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.78s
Steps: 891 | Train Loss: 0.0180016 Vali Loss: 0.0177291 Test Loss: 0.0195989
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0150112
	speed: 0.1022s/iter; left time: 718.3428s
	iters: 200, epoch: 3 | loss: 0.0136525
	speed: 0.0276s/iter; left time: 191.1572s
	iters: 300, epoch: 3 | loss: 0.0159441
	speed: 0.0275s/iter; left time: 188.0802s
	iters: 400, epoch: 3 | loss: 0.0138051
	speed: 0.0275s/iter; left time: 185.2923s
	iters: 500, epoch: 3 | loss: 0.0130835
	speed: 0.0275s/iter; left time: 182.2703s
	iters: 600, epoch: 3 | loss: 0.0189182
	speed: 0.0275s/iter; left time: 179.2806s
	iters: 700, epoch: 3 | loss: 0.0147348
	speed: 0.0274s/iter; left time: 176.4514s
	iters: 800, epoch: 3 | loss: 0.0128391
	speed: 0.0274s/iter; left time: 173.6275s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.71s
Steps: 891 | Train Loss: 0.0153594 Vali Loss: 0.0182596 Test Loss: 0.0197869
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0169716
	speed: 0.1020s/iter; left time: 626.2548s
	iters: 200, epoch: 4 | loss: 0.0135279
	speed: 0.0274s/iter; left time: 165.6003s
	iters: 300, epoch: 4 | loss: 0.0121340
	speed: 0.0275s/iter; left time: 163.1170s
	iters: 400, epoch: 4 | loss: 0.0120603
	speed: 0.0275s/iter; left time: 160.6846s
	iters: 500, epoch: 4 | loss: 0.0123591
	speed: 0.0275s/iter; left time: 157.8752s
	iters: 600, epoch: 4 | loss: 0.0127861
	speed: 0.0275s/iter; left time: 155.1358s
	iters: 700, epoch: 4 | loss: 0.0133667
	speed: 0.0275s/iter; left time: 152.4337s
	iters: 800, epoch: 4 | loss: 0.0132274
	speed: 0.0275s/iter; left time: 149.7101s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.71s
Steps: 891 | Train Loss: 0.0134171 Vali Loss: 0.0191772 Test Loss: 0.0216198
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018080413341522217, rmse:0.13446342945098877, mae:0.08679895102977753, rse:0.5084207057952881
Original data scale mse:3139555.5, rmse:1771.8790283203125, mae:1171.673583984375, rse:0.12469436973333359

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.01818559132516384, RMSE: 0.13485395908355713, MAE: 0.08711884915828705, RSE: 0.5098973512649536
Unscaled Metrics - MSE: 3181651.5, RMSE: 1783.718505859375, MAE: 1182.0157470703125, RSE: 0.1255275458097458

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.018080413341522217, RMSE: 0.13446342945098877, MAE: 0.08679895102977753, RSE: 0.5084207057952881
Unscaled Metrics - MSE: 3139555.5, RMSE: 1771.8790283203125, MAE: 1171.673583984375, RSE: 0.12469436973333359

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0236162
	speed: 0.0534s/iter; left time: 469.0630s
	iters: 200, epoch: 1 | loss: 0.0183719
	speed: 0.0280s/iter; left time: 243.0752s
	iters: 300, epoch: 1 | loss: 0.0199116
	speed: 0.0279s/iter; left time: 240.0900s
	iters: 400, epoch: 1 | loss: 0.0255526
	speed: 0.0280s/iter; left time: 237.7154s
	iters: 500, epoch: 1 | loss: 0.0240575
	speed: 0.0280s/iter; left time: 235.1871s
	iters: 600, epoch: 1 | loss: 0.0206351
	speed: 0.0280s/iter; left time: 232.1718s
	iters: 700, epoch: 1 | loss: 0.0214608
	speed: 0.0280s/iter; left time: 229.3636s
	iters: 800, epoch: 1 | loss: 0.0190965
	speed: 0.0280s/iter; left time: 226.8976s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.38s
Steps: 889 | Train Loss: 0.0215779 Vali Loss: 0.0185147 Test Loss: 0.0193631
Validation loss decreased (inf --> 0.018515).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0219754
	speed: 0.1074s/iter; left time: 848.9284s
	iters: 200, epoch: 2 | loss: 0.0184724
	speed: 0.0280s/iter; left time: 218.6829s
	iters: 300, epoch: 2 | loss: 0.0209752
	speed: 0.0280s/iter; left time: 215.9832s
	iters: 400, epoch: 2 | loss: 0.0174810
	speed: 0.0280s/iter; left time: 213.0747s
	iters: 500, epoch: 2 | loss: 0.0179584
	speed: 0.0280s/iter; left time: 210.2927s
	iters: 600, epoch: 2 | loss: 0.0199438
	speed: 0.0280s/iter; left time: 207.3693s
	iters: 700, epoch: 2 | loss: 0.0223011
	speed: 0.0280s/iter; left time: 204.2497s
	iters: 800, epoch: 2 | loss: 0.0188354
	speed: 0.0280s/iter; left time: 201.5896s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.12s
Steps: 889 | Train Loss: 0.0191857 Vali Loss: 0.0196306 Test Loss: 0.0218072
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0145795
	speed: 0.1031s/iter; left time: 723.0902s
	iters: 200, epoch: 3 | loss: 0.0162144
	speed: 0.0280s/iter; left time: 193.3139s
	iters: 300, epoch: 3 | loss: 0.0173045
	speed: 0.0280s/iter; left time: 190.6228s
	iters: 400, epoch: 3 | loss: 0.0162256
	speed: 0.0280s/iter; left time: 187.8791s
	iters: 500, epoch: 3 | loss: 0.0127041
	speed: 0.0280s/iter; left time: 184.9851s
	iters: 600, epoch: 3 | loss: 0.0130897
	speed: 0.0280s/iter; left time: 182.3079s
	iters: 700, epoch: 3 | loss: 0.0149259
	speed: 0.0280s/iter; left time: 179.6833s
	iters: 800, epoch: 3 | loss: 0.0167985
	speed: 0.0280s/iter; left time: 176.6836s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.07s
Steps: 889 | Train Loss: 0.0155784 Vali Loss: 0.0220581 Test Loss: 0.0241300
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0120209
	speed: 0.1029s/iter; left time: 630.3915s
	iters: 200, epoch: 4 | loss: 0.0117652
	speed: 0.0280s/iter; left time: 168.9182s
	iters: 300, epoch: 4 | loss: 0.0127462
	speed: 0.0281s/iter; left time: 166.2134s
	iters: 400, epoch: 4 | loss: 0.0109700
	speed: 0.0280s/iter; left time: 163.3150s
	iters: 500, epoch: 4 | loss: 0.0098459
	speed: 0.0280s/iter; left time: 160.2756s
	iters: 600, epoch: 4 | loss: 0.0106720
	speed: 0.0280s/iter; left time: 157.2570s
	iters: 700, epoch: 4 | loss: 0.0115856
	speed: 0.0280s/iter; left time: 154.5354s
	iters: 800, epoch: 4 | loss: 0.0168614
	speed: 0.0280s/iter; left time: 151.7719s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.09s
Steps: 889 | Train Loss: 0.0126771 Vali Loss: 0.0232748 Test Loss: 0.0249381
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019363099709153175, rmse:0.13915134966373444, mae:0.09162752330303192, rse:0.5265098214149475
Original data scale mse:3698332.25, rmse:1923.1048583984375, mae:1273.1566162109375, rse:0.13546383380889893
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0247541
	speed: 0.0300s/iter; left time: 263.9974s
	iters: 200, epoch: 1 | loss: 0.0261065
	speed: 0.0281s/iter; left time: 244.0573s
	iters: 300, epoch: 1 | loss: 0.0198978
	speed: 0.0281s/iter; left time: 241.2585s
	iters: 400, epoch: 1 | loss: 0.0230611
	speed: 0.0281s/iter; left time: 238.3196s
	iters: 500, epoch: 1 | loss: 0.0194879
	speed: 0.0281s/iter; left time: 235.5011s
	iters: 600, epoch: 1 | loss: 0.0192141
	speed: 0.0281s/iter; left time: 232.7507s
	iters: 700, epoch: 1 | loss: 0.0171524
	speed: 0.0281s/iter; left time: 229.8912s
	iters: 800, epoch: 1 | loss: 0.0183360
	speed: 0.0280s/iter; left time: 226.1779s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.17s
Steps: 889 | Train Loss: 0.0216471 Vali Loss: 0.0184627 Test Loss: 0.0193748
Validation loss decreased (inf --> 0.018463).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0233741
	speed: 0.1062s/iter; left time: 839.1494s
	iters: 200, epoch: 2 | loss: 0.0204443
	speed: 0.0281s/iter; left time: 218.9538s
	iters: 300, epoch: 2 | loss: 0.0225896
	speed: 0.0281s/iter; left time: 216.2066s
	iters: 400, epoch: 2 | loss: 0.0158943
	speed: 0.0281s/iter; left time: 213.2772s
	iters: 500, epoch: 2 | loss: 0.0184105
	speed: 0.0280s/iter; left time: 210.3145s
	iters: 600, epoch: 2 | loss: 0.0190272
	speed: 0.0280s/iter; left time: 207.4345s
	iters: 700, epoch: 2 | loss: 0.0172599
	speed: 0.0280s/iter; left time: 204.5007s
	iters: 800, epoch: 2 | loss: 0.0152705
	speed: 0.0280s/iter; left time: 201.8741s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.17s
Steps: 889 | Train Loss: 0.0187181 Vali Loss: 0.0192850 Test Loss: 0.0239670
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0159321
	speed: 0.1033s/iter; left time: 724.6270s
	iters: 200, epoch: 3 | loss: 0.0163656
	speed: 0.0280s/iter; left time: 193.3770s
	iters: 300, epoch: 3 | loss: 0.0158224
	speed: 0.0280s/iter; left time: 190.5241s
	iters: 400, epoch: 3 | loss: 0.0133546
	speed: 0.0280s/iter; left time: 187.6772s
	iters: 500, epoch: 3 | loss: 0.0165057
	speed: 0.0279s/iter; left time: 184.8106s
	iters: 600, epoch: 3 | loss: 0.0140909
	speed: 0.0279s/iter; left time: 182.0064s
	iters: 700, epoch: 3 | loss: 0.0140744
	speed: 0.0280s/iter; left time: 179.4765s
	iters: 800, epoch: 3 | loss: 0.0151225
	speed: 0.0280s/iter; left time: 176.7411s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.09s
Steps: 889 | Train Loss: 0.0149630 Vali Loss: 0.0216498 Test Loss: 0.0257693
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0121486
	speed: 0.1039s/iter; left time: 636.4021s
	iters: 200, epoch: 4 | loss: 0.0113173
	speed: 0.0280s/iter; left time: 168.6476s
	iters: 300, epoch: 4 | loss: 0.0110981
	speed: 0.0280s/iter; left time: 165.8878s
	iters: 400, epoch: 4 | loss: 0.0113187
	speed: 0.0280s/iter; left time: 162.9382s
	iters: 500, epoch: 4 | loss: 0.0126804
	speed: 0.0279s/iter; left time: 159.9819s
	iters: 600, epoch: 4 | loss: 0.0112432
	speed: 0.0280s/iter; left time: 157.3162s
	iters: 700, epoch: 4 | loss: 0.0113324
	speed: 0.0280s/iter; left time: 154.4275s
	iters: 800, epoch: 4 | loss: 0.0100309
	speed: 0.0280s/iter; left time: 151.9221s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.11s
Steps: 889 | Train Loss: 0.0113790 Vali Loss: 0.0225733 Test Loss: 0.0267746
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01937480829656124, rmse:0.13919341564178467, mae:0.09127473831176758, rse:0.526668906211853
Original data scale mse:3587113.5, rmse:1893.9676513671875, mae:1255.863525390625, rse:0.13341140747070312

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.019363099709153175, RMSE: 0.13915134966373444, MAE: 0.09162752330303192, RSE: 0.5265098214149475
Unscaled Metrics - MSE: 3698332.25, RMSE: 1923.1048583984375, MAE: 1273.1566162109375, RSE: 0.13546383380889893

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.01937480829656124, RMSE: 0.13919341564178467, MAE: 0.09127473831176758, RSE: 0.526668906211853
Unscaled Metrics - MSE: 3587113.5, RMSE: 1893.9676513671875, MAE: 1255.863525390625, RSE: 0.13341140747070312

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1336230
	speed: 0.0553s/iter; left time: 488.2585s
	iters: 200, epoch: 1 | loss: 0.1155068
	speed: 0.0272s/iter; left time: 237.5775s
	iters: 300, epoch: 1 | loss: 0.1121432
	speed: 0.0272s/iter; left time: 234.9864s
	iters: 400, epoch: 1 | loss: 0.1140316
	speed: 0.0272s/iter; left time: 231.8497s
	iters: 500, epoch: 1 | loss: 0.1130750
	speed: 0.0272s/iter; left time: 229.3489s
	iters: 600, epoch: 1 | loss: 0.1088183
	speed: 0.0272s/iter; left time: 226.4775s
	iters: 700, epoch: 1 | loss: 0.0967024
	speed: 0.0272s/iter; left time: 223.8843s
	iters: 800, epoch: 1 | loss: 0.0916955
	speed: 0.0272s/iter; left time: 221.3664s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.79s
Steps: 893 | Train Loss: 0.1131722 Vali Loss: 0.0101976 Test Loss: 0.0113959
Validation loss decreased (inf --> 0.010198).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1050137
	speed: 0.1035s/iter; left time: 821.3278s
	iters: 200, epoch: 2 | loss: 0.1007863
	speed: 0.0273s/iter; left time: 213.6088s
	iters: 300, epoch: 2 | loss: 0.1326872
	speed: 0.0272s/iter; left time: 210.1571s
	iters: 400, epoch: 2 | loss: 0.1074101
	speed: 0.0272s/iter; left time: 207.9068s
	iters: 500, epoch: 2 | loss: 0.1004094
	speed: 0.0272s/iter; left time: 204.7980s
	iters: 600, epoch: 2 | loss: 0.0910867
	speed: 0.0272s/iter; left time: 202.0179s
	iters: 700, epoch: 2 | loss: 0.1073109
	speed: 0.0272s/iter; left time: 199.4069s
	iters: 800, epoch: 2 | loss: 0.0984889
	speed: 0.0273s/iter; left time: 197.7257s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.63s
Steps: 893 | Train Loss: 0.1070746 Vali Loss: 0.0108972 Test Loss: 0.0123732
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0865848
	speed: 0.1031s/iter; left time: 726.0789s
	iters: 200, epoch: 3 | loss: 0.1020046
	speed: 0.0273s/iter; left time: 189.4461s
	iters: 300, epoch: 3 | loss: 0.0922649
	speed: 0.0275s/iter; left time: 188.0378s
	iters: 400, epoch: 3 | loss: 0.1004084
	speed: 0.0275s/iter; left time: 185.1835s
	iters: 500, epoch: 3 | loss: 0.0948766
	speed: 0.0273s/iter; left time: 181.1685s
	iters: 600, epoch: 3 | loss: 0.1179055
	speed: 0.0272s/iter; left time: 177.9232s
	iters: 700, epoch: 3 | loss: 0.0856405
	speed: 0.0272s/iter; left time: 175.1191s
	iters: 800, epoch: 3 | loss: 0.1091467
	speed: 0.0272s/iter; left time: 172.6393s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.1025416 Vali Loss: 0.0103346 Test Loss: 0.0115246
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1041363
	speed: 0.1026s/iter; left time: 631.4290s
	iters: 200, epoch: 4 | loss: 0.0963972
	speed: 0.0272s/iter; left time: 164.7449s
	iters: 300, epoch: 4 | loss: 0.1047586
	speed: 0.0272s/iter; left time: 161.7208s
	iters: 400, epoch: 4 | loss: 0.0921619
	speed: 0.0271s/iter; left time: 158.8169s
	iters: 500, epoch: 4 | loss: 0.0976954
	speed: 0.0272s/iter; left time: 156.4304s
	iters: 600, epoch: 4 | loss: 0.0881593
	speed: 0.0273s/iter; left time: 154.0539s
	iters: 700, epoch: 4 | loss: 0.1065766
	speed: 0.0272s/iter; left time: 151.2442s
	iters: 800, epoch: 4 | loss: 0.1049190
	speed: 0.0273s/iter; left time: 148.5698s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.0997130 Vali Loss: 0.0104954 Test Loss: 0.0120944
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011395939625799656, rmse:0.10675176978111267, mae:0.06576605141162872, rse:0.40342235565185547
Original data scale mse:1851359.875, rmse:1360.6468505859375, mae:874.3543701171875, rse:0.09561585634946823
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1388093
	speed: 0.0292s/iter; left time: 258.0713s
	iters: 200, epoch: 1 | loss: 0.1117809
	speed: 0.0274s/iter; left time: 238.8148s
	iters: 300, epoch: 1 | loss: 0.1294807
	speed: 0.0273s/iter; left time: 236.0087s
	iters: 400, epoch: 1 | loss: 0.1107772
	speed: 0.0271s/iter; left time: 231.6098s
	iters: 500, epoch: 1 | loss: 0.0995625
	speed: 0.0271s/iter; left time: 228.3454s
	iters: 600, epoch: 1 | loss: 0.1074394
	speed: 0.0273s/iter; left time: 227.3726s
	iters: 700, epoch: 1 | loss: 0.1001715
	speed: 0.0273s/iter; left time: 224.7820s
	iters: 800, epoch: 1 | loss: 0.0994926
	speed: 0.0273s/iter; left time: 221.9556s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.59s
Steps: 893 | Train Loss: 0.1137531 Vali Loss: 0.0103037 Test Loss: 0.0114750
Validation loss decreased (inf --> 0.010304).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1124581
	speed: 0.1047s/iter; left time: 831.3677s
	iters: 200, epoch: 2 | loss: 0.1012988
	speed: 0.0273s/iter; left time: 213.9236s
	iters: 300, epoch: 2 | loss: 0.1143391
	speed: 0.0273s/iter; left time: 211.2506s
	iters: 400, epoch: 2 | loss: 0.1000488
	speed: 0.0272s/iter; left time: 208.0139s
	iters: 500, epoch: 2 | loss: 0.0999656
	speed: 0.0272s/iter; left time: 204.9040s
	iters: 600, epoch: 2 | loss: 0.0956163
	speed: 0.0272s/iter; left time: 202.1540s
	iters: 700, epoch: 2 | loss: 0.0920859
	speed: 0.0272s/iter; left time: 199.5921s
	iters: 800, epoch: 2 | loss: 0.1179271
	speed: 0.0272s/iter; left time: 196.9376s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.55s
Steps: 893 | Train Loss: 0.1058963 Vali Loss: 0.0107609 Test Loss: 0.0120347
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0982848
	speed: 0.1019s/iter; left time: 718.0865s
	iters: 200, epoch: 3 | loss: 0.1196185
	speed: 0.0273s/iter; left time: 189.7404s
	iters: 300, epoch: 3 | loss: 0.0814890
	speed: 0.0272s/iter; left time: 186.3990s
	iters: 400, epoch: 3 | loss: 0.0979836
	speed: 0.0272s/iter; left time: 183.7628s
	iters: 500, epoch: 3 | loss: 0.0956824
	speed: 0.0272s/iter; left time: 181.0141s
	iters: 600, epoch: 3 | loss: 0.0909160
	speed: 0.0272s/iter; left time: 178.0660s
	iters: 700, epoch: 3 | loss: 0.1006822
	speed: 0.0272s/iter; left time: 175.4138s
	iters: 800, epoch: 3 | loss: 0.0918016
	speed: 0.0272s/iter; left time: 172.7803s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.53s
Steps: 893 | Train Loss: 0.1021115 Vali Loss: 0.0104125 Test Loss: 0.0117827
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0912620
	speed: 0.1024s/iter; left time: 630.1537s
	iters: 200, epoch: 4 | loss: 0.1102126
	speed: 0.0275s/iter; left time: 166.3765s
	iters: 300, epoch: 4 | loss: 0.0985254
	speed: 0.0275s/iter; left time: 163.4348s
	iters: 400, epoch: 4 | loss: 0.0976668
	speed: 0.0274s/iter; left time: 160.5018s
	iters: 500, epoch: 4 | loss: 0.1039490
	speed: 0.0272s/iter; left time: 156.5369s
	iters: 600, epoch: 4 | loss: 0.0898440
	speed: 0.0272s/iter; left time: 153.7540s
	iters: 700, epoch: 4 | loss: 0.0876081
	speed: 0.0273s/iter; left time: 151.3703s
	iters: 800, epoch: 4 | loss: 0.1061534
	speed: 0.0272s/iter; left time: 148.5040s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.64s
Steps: 893 | Train Loss: 0.0986301 Vali Loss: 0.0107811 Test Loss: 0.0123823
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01147499494254589, rmse:0.10712140053510666, mae:0.066454216837883, rse:0.4048192799091339
Original data scale mse:1904325.375, rmse:1379.9730224609375, mae:891.10009765625, rse:0.0969739556312561

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.011395939625799656, RMSE: 0.10675176978111267, MAE: 0.06576605141162872, RSE: 0.40342235565185547
Unscaled Metrics - MSE: 1851359.875, RMSE: 1360.6468505859375, MAE: 874.3543701171875, RSE: 0.09561585634946823

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.01147499494254589, RMSE: 0.10712140053510666, MAE: 0.066454216837883, RSE: 0.4048192799091339
Unscaled Metrics - MSE: 1904325.375, RMSE: 1379.9730224609375, MAE: 891.10009765625, RSE: 0.0969739556312561

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1612096
	speed: 0.0554s/iter; left time: 488.5091s
	iters: 200, epoch: 1 | loss: 0.1467356
	speed: 0.0275s/iter; left time: 239.5342s
	iters: 300, epoch: 1 | loss: 0.1518958
	speed: 0.0275s/iter; left time: 236.5573s
	iters: 400, epoch: 1 | loss: 0.1317786
	speed: 0.0275s/iter; left time: 233.9197s
	iters: 500, epoch: 1 | loss: 0.1327047
	speed: 0.0275s/iter; left time: 231.0283s
	iters: 600, epoch: 1 | loss: 0.1364689
	speed: 0.0275s/iter; left time: 228.2888s
	iters: 700, epoch: 1 | loss: 0.1275773
	speed: 0.0275s/iter; left time: 225.8782s
	iters: 800, epoch: 1 | loss: 0.1212199
	speed: 0.0275s/iter; left time: 222.8246s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.98s
Steps: 891 | Train Loss: 0.1405650 Vali Loss: 0.0169173 Test Loss: 0.0181296
Validation loss decreased (inf --> 0.016917).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1407798
	speed: 0.1039s/iter; left time: 823.0167s
	iters: 200, epoch: 2 | loss: 0.1132862
	speed: 0.0275s/iter; left time: 215.1548s
	iters: 300, epoch: 2 | loss: 0.1313431
	speed: 0.0276s/iter; left time: 213.0305s
	iters: 400, epoch: 2 | loss: 0.1309543
	speed: 0.0276s/iter; left time: 210.4537s
	iters: 500, epoch: 2 | loss: 0.1231728
	speed: 0.0276s/iter; left time: 207.6381s
	iters: 600, epoch: 2 | loss: 0.1290840
	speed: 0.0276s/iter; left time: 204.6861s
	iters: 700, epoch: 2 | loss: 0.1367119
	speed: 0.0276s/iter; left time: 202.1426s
	iters: 800, epoch: 2 | loss: 0.1343888
	speed: 0.0276s/iter; left time: 199.1967s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.82s
Steps: 891 | Train Loss: 0.1342701 Vali Loss: 0.0187091 Test Loss: 0.0192857
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1257509
	speed: 0.1021s/iter; left time: 717.5881s
	iters: 200, epoch: 3 | loss: 0.1280146
	speed: 0.0273s/iter; left time: 189.2340s
	iters: 300, epoch: 3 | loss: 0.1178980
	speed: 0.0273s/iter; left time: 186.5112s
	iters: 400, epoch: 3 | loss: 0.1302711
	speed: 0.0273s/iter; left time: 183.7821s
	iters: 500, epoch: 3 | loss: 0.1262439
	speed: 0.0274s/iter; left time: 181.9604s
	iters: 600, epoch: 3 | loss: 0.1175837
	speed: 0.0275s/iter; left time: 179.4664s
	iters: 700, epoch: 3 | loss: 0.1250318
	speed: 0.0274s/iter; left time: 176.3853s
	iters: 800, epoch: 3 | loss: 0.1148603
	speed: 0.0274s/iter; left time: 173.5160s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.57s
Steps: 891 | Train Loss: 0.1230018 Vali Loss: 0.0192505 Test Loss: 0.0204372
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1223086
	speed: 0.1020s/iter; left time: 625.8356s
	iters: 200, epoch: 4 | loss: 0.1278397
	speed: 0.0276s/iter; left time: 166.5951s
	iters: 300, epoch: 4 | loss: 0.1042883
	speed: 0.0276s/iter; left time: 163.6585s
	iters: 400, epoch: 4 | loss: 0.1116099
	speed: 0.0276s/iter; left time: 160.8600s
	iters: 500, epoch: 4 | loss: 0.1929631
	speed: 0.0275s/iter; left time: 158.0444s
	iters: 600, epoch: 4 | loss: 0.1039310
	speed: 0.0276s/iter; left time: 155.4701s
	iters: 700, epoch: 4 | loss: 0.1109765
	speed: 0.0276s/iter; left time: 152.6531s
	iters: 800, epoch: 4 | loss: 0.1156806
	speed: 0.0276s/iter; left time: 149.9475s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.76s
Steps: 891 | Train Loss: 0.1124573 Vali Loss: 0.0200614 Test Loss: 0.0231085
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018129628151655197, rmse:0.13464631140232086, mae:0.08668393641710281, rse:0.5091121792793274
Original data scale mse:3113013.75, rmse:1764.3734130859375, mae:1168.9976806640625, rse:0.12416616082191467
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1495688
	speed: 0.0294s/iter; left time: 259.1273s
	iters: 200, epoch: 1 | loss: 0.1463868
	speed: 0.0274s/iter; left time: 238.9611s
	iters: 300, epoch: 1 | loss: 0.1333702
	speed: 0.0274s/iter; left time: 236.1130s
	iters: 400, epoch: 1 | loss: 0.1300492
	speed: 0.0274s/iter; left time: 233.3643s
	iters: 500, epoch: 1 | loss: 0.1337928
	speed: 0.0274s/iter; left time: 230.7367s
	iters: 600, epoch: 1 | loss: 0.1342798
	speed: 0.0274s/iter; left time: 227.9619s
	iters: 700, epoch: 1 | loss: 0.1246924
	speed: 0.0276s/iter; left time: 226.4948s
	iters: 800, epoch: 1 | loss: 0.1377941
	speed: 0.0275s/iter; left time: 223.4370s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.71s
Steps: 891 | Train Loss: 0.1405721 Vali Loss: 0.0167831 Test Loss: 0.0180072
Validation loss decreased (inf --> 0.016783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1467238
	speed: 0.1037s/iter; left time: 821.6762s
	iters: 200, epoch: 2 | loss: 0.1360969
	speed: 0.0275s/iter; left time: 214.8438s
	iters: 300, epoch: 2 | loss: 0.1264257
	speed: 0.0275s/iter; left time: 212.0823s
	iters: 400, epoch: 2 | loss: 0.1452207
	speed: 0.0275s/iter; left time: 209.2331s
	iters: 500, epoch: 2 | loss: 0.1207512
	speed: 0.0274s/iter; left time: 206.3639s
	iters: 600, epoch: 2 | loss: 0.1442054
	speed: 0.0274s/iter; left time: 203.5868s
	iters: 700, epoch: 2 | loss: 0.1262565
	speed: 0.0274s/iter; left time: 200.7346s
	iters: 800, epoch: 2 | loss: 0.1496262
	speed: 0.0274s/iter; left time: 197.9219s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.69s
Steps: 891 | Train Loss: 0.1342886 Vali Loss: 0.0179572 Test Loss: 0.0197570
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1195421
	speed: 0.1019s/iter; left time: 716.0260s
	iters: 200, epoch: 3 | loss: 0.1202214
	speed: 0.0275s/iter; left time: 190.2595s
	iters: 300, epoch: 3 | loss: 0.1266964
	speed: 0.0275s/iter; left time: 187.5472s
	iters: 400, epoch: 3 | loss: 0.1236266
	speed: 0.0274s/iter; left time: 184.7001s
	iters: 500, epoch: 3 | loss: 0.1166376
	speed: 0.0275s/iter; left time: 182.0828s
	iters: 600, epoch: 3 | loss: 0.1360387
	speed: 0.0275s/iter; left time: 179.2470s
	iters: 700, epoch: 3 | loss: 0.1262230
	speed: 0.0275s/iter; left time: 176.5138s
	iters: 800, epoch: 3 | loss: 0.1146488
	speed: 0.0275s/iter; left time: 173.9978s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.69s
Steps: 891 | Train Loss: 0.1250462 Vali Loss: 0.0183877 Test Loss: 0.0199011
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1335205
	speed: 0.1019s/iter; left time: 625.5570s
	iters: 200, epoch: 4 | loss: 0.1363225
	speed: 0.0276s/iter; left time: 166.4817s
	iters: 300, epoch: 4 | loss: 0.1124470
	speed: 0.0276s/iter; left time: 163.7063s
	iters: 400, epoch: 4 | loss: 0.1130551
	speed: 0.0276s/iter; left time: 160.9372s
	iters: 500, epoch: 4 | loss: 0.1142171
	speed: 0.0275s/iter; left time: 158.0765s
	iters: 600, epoch: 4 | loss: 0.1137453
	speed: 0.0275s/iter; left time: 155.2392s
	iters: 700, epoch: 4 | loss: 0.1127641
	speed: 0.0275s/iter; left time: 152.2473s
	iters: 800, epoch: 4 | loss: 0.1094655
	speed: 0.0275s/iter; left time: 149.2764s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.1167262 Vali Loss: 0.0200590 Test Loss: 0.0232277
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.018007179722189903, rmse:0.13419082760810852, mae:0.0862976536154747, rse:0.5073899626731873
Original data scale mse:3066430.25, rmse:1751.12255859375, mae:1157.38037109375, rse:0.12323364615440369

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.018129628151655197, RMSE: 0.13464631140232086, MAE: 0.08668393641710281, RSE: 0.5091121792793274
Unscaled Metrics - MSE: 3113013.75, RMSE: 1764.3734130859375, MAE: 1168.9976806640625, RSE: 0.12416616082191467

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.018007179722189903, RMSE: 0.13419082760810852, MAE: 0.0862976536154747, RSE: 0.5073899626731873
Unscaled Metrics - MSE: 3066430.25, RMSE: 1751.12255859375, MAE: 1157.38037109375, RSE: 0.12323364615440369

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1526763
	speed: 0.0567s/iter; left time: 498.1957s
	iters: 200, epoch: 1 | loss: 0.1348829
	speed: 0.0282s/iter; left time: 244.9739s
	iters: 300, epoch: 1 | loss: 0.1405146
	speed: 0.0282s/iter; left time: 242.0161s
	iters: 400, epoch: 1 | loss: 0.1588301
	speed: 0.0281s/iter; left time: 238.4071s
	iters: 500, epoch: 1 | loss: 0.1540524
	speed: 0.0281s/iter; left time: 235.5241s
	iters: 600, epoch: 1 | loss: 0.1427126
	speed: 0.0280s/iter; left time: 232.2965s
	iters: 700, epoch: 1 | loss: 0.1456371
	speed: 0.0281s/iter; left time: 229.7898s
	iters: 800, epoch: 1 | loss: 0.1377048
	speed: 0.0282s/iter; left time: 228.0373s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.48s
Steps: 889 | Train Loss: 0.1453442 Vali Loss: 0.0184368 Test Loss: 0.0192923
Validation loss decreased (inf --> 0.018437).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1480042
	speed: 0.1075s/iter; left time: 849.7872s
	iters: 200, epoch: 2 | loss: 0.1339409
	speed: 0.0283s/iter; left time: 220.7146s
	iters: 300, epoch: 2 | loss: 0.1472317
	speed: 0.0284s/iter; left time: 219.0707s
	iters: 400, epoch: 2 | loss: 0.1334711
	speed: 0.0284s/iter; left time: 216.2757s
	iters: 500, epoch: 2 | loss: 0.1341700
	speed: 0.0284s/iter; left time: 212.6936s
	iters: 600, epoch: 2 | loss: 0.1413193
	speed: 0.0285s/iter; left time: 210.6591s
	iters: 700, epoch: 2 | loss: 0.1294785
	speed: 0.0284s/iter; left time: 207.5759s
	iters: 800, epoch: 2 | loss: 0.1371240
	speed: 0.0284s/iter; left time: 204.2723s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.55s
Steps: 889 | Train Loss: 0.1377887 Vali Loss: 0.0194952 Test Loss: 0.0224702
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1238881
	speed: 0.1062s/iter; left time: 744.7159s
	iters: 200, epoch: 3 | loss: 0.1281789
	speed: 0.0281s/iter; left time: 194.2146s
	iters: 300, epoch: 3 | loss: 0.1261756
	speed: 0.0282s/iter; left time: 192.4381s
	iters: 400, epoch: 3 | loss: 0.1239973
	speed: 0.0282s/iter; left time: 189.4659s
	iters: 500, epoch: 3 | loss: 0.1175015
	speed: 0.0282s/iter; left time: 186.6579s
	iters: 600, epoch: 3 | loss: 0.1132074
	speed: 0.0282s/iter; left time: 183.7128s
	iters: 700, epoch: 3 | loss: 0.1198484
	speed: 0.0282s/iter; left time: 180.9089s
	iters: 800, epoch: 3 | loss: 0.1233855
	speed: 0.0281s/iter; left time: 177.2401s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.34s
Steps: 889 | Train Loss: 0.1231958 Vali Loss: 0.0220815 Test Loss: 0.0253941
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1124273
	speed: 0.1044s/iter; left time: 639.1454s
	iters: 200, epoch: 4 | loss: 0.1091032
	speed: 0.0282s/iter; left time: 169.8217s
	iters: 300, epoch: 4 | loss: 0.1198413
	speed: 0.0282s/iter; left time: 167.2789s
	iters: 400, epoch: 4 | loss: 0.1105534
	speed: 0.0284s/iter; left time: 165.3854s
	iters: 500, epoch: 4 | loss: 0.1048551
	speed: 0.0282s/iter; left time: 161.6502s
	iters: 600, epoch: 4 | loss: 0.1314389
	speed: 0.0282s/iter; left time: 158.7624s
	iters: 700, epoch: 4 | loss: 0.1183181
	speed: 0.0282s/iter; left time: 155.8765s
	iters: 800, epoch: 4 | loss: 0.1056019
	speed: 0.0283s/iter; left time: 153.3510s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.35s
Steps: 889 | Train Loss: 0.1099546 Vali Loss: 0.0234355 Test Loss: 0.0249912
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01929234340786934, rmse:0.1388968825340271, mae:0.09116160124540329, rse:0.5255469679832458
Original data scale mse:3630107.25, rmse:1905.2840576171875, mae:1260.4178466796875, rse:0.1342085301876068
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1561739
	speed: 0.0307s/iter; left time: 269.4648s
	iters: 200, epoch: 1 | loss: 0.1605728
	speed: 0.0283s/iter; left time: 245.8203s
	iters: 300, epoch: 1 | loss: 0.1400924
	speed: 0.0282s/iter; left time: 242.3826s
	iters: 400, epoch: 1 | loss: 0.1510603
	speed: 0.0282s/iter; left time: 239.5200s
	iters: 500, epoch: 1 | loss: 0.1386138
	speed: 0.0283s/iter; left time: 237.1322s
	iters: 600, epoch: 1 | loss: 0.1376126
	speed: 0.0282s/iter; left time: 234.2168s
	iters: 700, epoch: 1 | loss: 0.1298753
	speed: 0.0282s/iter; left time: 231.1451s
	iters: 800, epoch: 1 | loss: 0.1350235
	speed: 0.0282s/iter; left time: 228.1661s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.38s
Steps: 889 | Train Loss: 0.1455408 Vali Loss: 0.0183783 Test Loss: 0.0192681
Validation loss decreased (inf --> 0.018378).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1540410
	speed: 0.1087s/iter; left time: 858.7673s
	iters: 200, epoch: 2 | loss: 0.1433096
	speed: 0.0282s/iter; left time: 220.0220s
	iters: 300, epoch: 2 | loss: 0.1515379
	speed: 0.0282s/iter; left time: 217.2163s
	iters: 400, epoch: 2 | loss: 0.1265191
	speed: 0.0280s/iter; left time: 212.5000s
	iters: 500, epoch: 2 | loss: 0.1357703
	speed: 0.0282s/iter; left time: 211.5971s
	iters: 600, epoch: 2 | loss: 0.1384776
	speed: 0.0283s/iter; left time: 209.2869s
	iters: 700, epoch: 2 | loss: 0.1279574
	speed: 0.0283s/iter; left time: 206.6641s
	iters: 800, epoch: 2 | loss: 0.1234654
	speed: 0.0283s/iter; left time: 203.7540s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.36s
Steps: 889 | Train Loss: 0.1373205 Vali Loss: 0.0197247 Test Loss: 0.0248364
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1267300
	speed: 0.1047s/iter; left time: 734.6082s
	iters: 200, epoch: 3 | loss: 0.1273013
	speed: 0.0281s/iter; left time: 194.4381s
	iters: 300, epoch: 3 | loss: 0.1333112
	speed: 0.0283s/iter; left time: 192.5230s
	iters: 400, epoch: 3 | loss: 0.1214130
	speed: 0.0282s/iter; left time: 189.4316s
	iters: 500, epoch: 3 | loss: 0.1233395
	speed: 0.0282s/iter; left time: 186.6820s
	iters: 600, epoch: 3 | loss: 0.1203233
	speed: 0.0282s/iter; left time: 183.8856s
	iters: 700, epoch: 3 | loss: 0.1158218
	speed: 0.0282s/iter; left time: 181.0448s
	iters: 800, epoch: 3 | loss: 0.1173633
	speed: 0.0282s/iter; left time: 178.2990s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.31s
Steps: 889 | Train Loss: 0.1231975 Vali Loss: 0.0220960 Test Loss: 0.0254985
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1178611
	speed: 0.1064s/iter; left time: 651.8720s
	iters: 200, epoch: 4 | loss: 0.1095064
	speed: 0.0284s/iter; left time: 170.8841s
	iters: 300, epoch: 4 | loss: 0.1147172
	speed: 0.0282s/iter; left time: 167.2012s
	iters: 400, epoch: 4 | loss: 0.1098857
	speed: 0.0282s/iter; left time: 164.0700s
	iters: 500, epoch: 4 | loss: 0.1116106
	speed: 0.0282s/iter; left time: 161.5191s
	iters: 600, epoch: 4 | loss: 0.1040639
	speed: 0.0282s/iter; left time: 158.6095s
	iters: 700, epoch: 4 | loss: 0.1096108
	speed: 0.0283s/iter; left time: 156.3893s
	iters: 800, epoch: 4 | loss: 0.0992196
	speed: 0.0283s/iter; left time: 153.4722s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.35s
Steps: 889 | Train Loss: 0.1056597 Vali Loss: 0.0242961 Test Loss: 0.0272296
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.019268110394477844, rmse:0.13880962133407593, mae:0.0907384529709816, rse:0.5252167582511902
Original data scale mse:3512351.75, rmse:1874.126953125, mae:1241.5947265625, rse:0.13201381266117096

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.01929234340786934, RMSE: 0.1388968825340271, MAE: 0.09116160124540329, RSE: 0.5255469679832458
Unscaled Metrics - MSE: 3630107.25, RMSE: 1905.2840576171875, MAE: 1260.4178466796875, RSE: 0.1342085301876068

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.019268110394477844, RMSE: 0.13880962133407593, MAE: 0.0907384529709816, RSE: 0.5252167582511902
Unscaled Metrics - MSE: 3512351.75, RMSE: 1874.126953125, MAE: 1241.5947265625, RSE: 0.13201381266117096

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0910473
	speed: 0.0553s/iter; left time: 488.4476s
	iters: 200, epoch: 1 | loss: 0.0794505
	speed: 0.0272s/iter; left time: 237.6089s
	iters: 300, epoch: 1 | loss: 0.0759636
	speed: 0.0272s/iter; left time: 234.6548s
	iters: 400, epoch: 1 | loss: 0.0731807
	speed: 0.0272s/iter; left time: 232.1330s
	iters: 500, epoch: 1 | loss: 0.0727000
	speed: 0.0273s/iter; left time: 230.4277s
	iters: 600, epoch: 1 | loss: 0.0689269
	speed: 0.0273s/iter; left time: 227.3161s
	iters: 700, epoch: 1 | loss: 0.0640382
	speed: 0.0274s/iter; left time: 225.6406s
	iters: 800, epoch: 1 | loss: 0.0586276
	speed: 0.0274s/iter; left time: 222.9862s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.90s
Steps: 893 | Train Loss: 0.0754870 Vali Loss: 0.0624566 Test Loss: 0.0650983
Validation loss decreased (inf --> 0.062457).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0746917
	speed: 0.1031s/iter; left time: 818.6855s
	iters: 200, epoch: 2 | loss: 0.0670957
	speed: 0.0273s/iter; left time: 213.9416s
	iters: 300, epoch: 2 | loss: 0.0867313
	speed: 0.0274s/iter; left time: 211.6879s
	iters: 400, epoch: 2 | loss: 0.0686259
	speed: 0.0274s/iter; left time: 209.0276s
	iters: 500, epoch: 2 | loss: 0.0666773
	speed: 0.0274s/iter; left time: 206.3718s
	iters: 600, epoch: 2 | loss: 0.0521042
	speed: 0.0272s/iter; left time: 202.3813s
	iters: 700, epoch: 2 | loss: 0.0632667
	speed: 0.0273s/iter; left time: 200.0943s
	iters: 800, epoch: 2 | loss: 0.0575946
	speed: 0.0273s/iter; left time: 197.4325s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.61s
Steps: 893 | Train Loss: 0.0690810 Vali Loss: 0.0626315 Test Loss: 0.0653662
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0546044
	speed: 0.1023s/iter; left time: 720.4089s
	iters: 200, epoch: 3 | loss: 0.0539697
	speed: 0.0272s/iter; left time: 188.9977s
	iters: 300, epoch: 3 | loss: 0.0572773
	speed: 0.0272s/iter; left time: 186.4035s
	iters: 400, epoch: 3 | loss: 0.0586237
	speed: 0.0272s/iter; left time: 183.5448s
	iters: 500, epoch: 3 | loss: 0.0520420
	speed: 0.0272s/iter; left time: 180.9132s
	iters: 600, epoch: 3 | loss: 0.0595647
	speed: 0.0272s/iter; left time: 178.1133s
	iters: 700, epoch: 3 | loss: 0.0531289
	speed: 0.0272s/iter; left time: 175.3212s
	iters: 800, epoch: 3 | loss: 0.0639382
	speed: 0.0272s/iter; left time: 172.5818s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.50s
Steps: 893 | Train Loss: 0.0586708 Vali Loss: 0.0584809 Test Loss: 0.0608546
Validation loss decreased (0.062457 --> 0.058481).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0601936
	speed: 0.1041s/iter; left time: 640.7063s
	iters: 200, epoch: 4 | loss: 0.0545148
	speed: 0.0274s/iter; left time: 166.0841s
	iters: 300, epoch: 4 | loss: 0.0584930
	speed: 0.0274s/iter; left time: 162.8830s
	iters: 400, epoch: 4 | loss: 0.0498120
	speed: 0.0272s/iter; left time: 159.3882s
	iters: 500, epoch: 4 | loss: 0.0515589
	speed: 0.0273s/iter; left time: 156.7834s
	iters: 600, epoch: 4 | loss: 0.0490566
	speed: 0.0272s/iter; left time: 153.7343s
	iters: 700, epoch: 4 | loss: 0.0592232
	speed: 0.0272s/iter; left time: 150.9939s
	iters: 800, epoch: 4 | loss: 0.0573731
	speed: 0.0272s/iter; left time: 148.3684s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.59s
Steps: 893 | Train Loss: 0.0566463 Vali Loss: 0.0575501 Test Loss: 0.0600113
Validation loss decreased (0.058481 --> 0.057550).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0616790
	speed: 0.1045s/iter; left time: 549.3555s
	iters: 200, epoch: 5 | loss: 0.0507358
	speed: 0.0272s/iter; left time: 140.2540s
	iters: 300, epoch: 5 | loss: 0.0606048
	speed: 0.0274s/iter; left time: 138.7255s
	iters: 400, epoch: 5 | loss: 0.0653844
	speed: 0.0274s/iter; left time: 135.8857s
	iters: 500, epoch: 5 | loss: 0.0538452
	speed: 0.0276s/iter; left time: 134.2376s
	iters: 600, epoch: 5 | loss: 0.0470062
	speed: 0.0275s/iter; left time: 130.9189s
	iters: 700, epoch: 5 | loss: 0.0503518
	speed: 0.0274s/iter; left time: 127.7542s
	iters: 800, epoch: 5 | loss: 0.0466454
	speed: 0.0272s/iter; left time: 123.9346s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.72s
Steps: 893 | Train Loss: 0.0546173 Vali Loss: 0.0563897 Test Loss: 0.0583857
Validation loss decreased (0.057550 --> 0.056390).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0582530
	speed: 0.1036s/iter; left time: 452.3057s
	iters: 200, epoch: 6 | loss: 0.0565379
	speed: 0.0272s/iter; left time: 116.1865s
	iters: 300, epoch: 6 | loss: 0.0718446
	speed: 0.0272s/iter; left time: 113.4779s
	iters: 400, epoch: 6 | loss: 0.0540270
	speed: 0.0272s/iter; left time: 110.7569s
	iters: 500, epoch: 6 | loss: 0.0500298
	speed: 0.0271s/iter; left time: 107.6661s
	iters: 600, epoch: 6 | loss: 0.0561089
	speed: 0.0271s/iter; left time: 104.8665s
	iters: 700, epoch: 6 | loss: 0.0410015
	speed: 0.0271s/iter; left time: 102.2103s
	iters: 800, epoch: 6 | loss: 0.0512881
	speed: 0.0271s/iter; left time: 99.4989s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.51s
Steps: 893 | Train Loss: 0.0532083 Vali Loss: 0.0569526 Test Loss: 0.0597836
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0531806
	speed: 0.1012s/iter; left time: 351.4625s
	iters: 200, epoch: 7 | loss: 0.0461118
	speed: 0.0272s/iter; left time: 91.6802s
	iters: 300, epoch: 7 | loss: 0.0501736
	speed: 0.0273s/iter; left time: 89.2604s
	iters: 400, epoch: 7 | loss: 0.0543070
	speed: 0.0273s/iter; left time: 86.6364s
	iters: 500, epoch: 7 | loss: 0.0510931
	speed: 0.0270s/iter; left time: 82.8417s
	iters: 600, epoch: 7 | loss: 0.0482978
	speed: 0.0270s/iter; left time: 80.1242s
	iters: 700, epoch: 7 | loss: 0.0444117
	speed: 0.0272s/iter; left time: 78.2658s
	iters: 800, epoch: 7 | loss: 0.0442912
	speed: 0.0272s/iter; left time: 75.5368s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.49s
Steps: 893 | Train Loss: 0.0514513 Vali Loss: 0.0569198 Test Loss: 0.0590043
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0531063
	speed: 0.1022s/iter; left time: 263.7179s
	iters: 200, epoch: 8 | loss: 0.0489339
	speed: 0.0275s/iter; left time: 68.1674s
	iters: 300, epoch: 8 | loss: 0.0549303
	speed: 0.0272s/iter; left time: 64.8130s
	iters: 400, epoch: 8 | loss: 0.0488694
	speed: 0.0272s/iter; left time: 61.9901s
	iters: 500, epoch: 8 | loss: 0.0514850
	speed: 0.0273s/iter; left time: 59.4784s
	iters: 600, epoch: 8 | loss: 0.0523009
	speed: 0.0273s/iter; left time: 56.8083s
	iters: 700, epoch: 8 | loss: 0.0520393
	speed: 0.0273s/iter; left time: 54.0450s
	iters: 800, epoch: 8 | loss: 0.0511650
	speed: 0.0272s/iter; left time: 51.1784s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:24.59s
Steps: 893 | Train Loss: 0.0501382 Vali Loss: 0.0566781 Test Loss: 0.0581417
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01028512418270111, rmse:0.10141560435295105, mae:0.05838574469089508, rse:0.3832566440105438
Original data scale mse:1229446.0, rmse:1108.8038330078125, mae:701.6743774414062, rse:0.07791826128959656
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0975641
	speed: 0.0293s/iter; left time: 258.9420s
	iters: 200, epoch: 1 | loss: 0.0777413
	speed: 0.0273s/iter; left time: 238.4598s
	iters: 300, epoch: 1 | loss: 0.0768691
	speed: 0.0273s/iter; left time: 235.4037s
	iters: 400, epoch: 1 | loss: 0.0726286
	speed: 0.0273s/iter; left time: 232.5244s
	iters: 500, epoch: 1 | loss: 0.0716908
	speed: 0.0273s/iter; left time: 229.8772s
	iters: 600, epoch: 1 | loss: 0.0617660
	speed: 0.0272s/iter; left time: 226.9776s
	iters: 700, epoch: 1 | loss: 0.0626643
	speed: 0.0273s/iter; left time: 224.4578s
	iters: 800, epoch: 1 | loss: 0.0655708
	speed: 0.0272s/iter; left time: 221.4910s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.0756596 Vali Loss: 0.0627629 Test Loss: 0.0651303
Validation loss decreased (inf --> 0.062763).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0722900
	speed: 0.1040s/iter; left time: 825.4871s
	iters: 200, epoch: 2 | loss: 0.0733775
	speed: 0.0272s/iter; left time: 212.9218s
	iters: 300, epoch: 2 | loss: 0.0716743
	speed: 0.0272s/iter; left time: 210.1759s
	iters: 400, epoch: 2 | loss: 0.0700278
	speed: 0.0272s/iter; left time: 207.5393s
	iters: 500, epoch: 2 | loss: 0.0712918
	speed: 0.0272s/iter; left time: 204.8897s
	iters: 600, epoch: 2 | loss: 0.0671054
	speed: 0.0272s/iter; left time: 202.1212s
	iters: 700, epoch: 2 | loss: 0.0511962
	speed: 0.0272s/iter; left time: 199.8970s
	iters: 800, epoch: 2 | loss: 0.0579681
	speed: 0.0274s/iter; left time: 197.9920s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.0687280 Vali Loss: 0.0642013 Test Loss: 0.0670042
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0546441
	speed: 0.1016s/iter; left time: 715.5404s
	iters: 200, epoch: 3 | loss: 0.0511300
	speed: 0.0272s/iter; left time: 188.8772s
	iters: 300, epoch: 3 | loss: 0.0653810
	speed: 0.0272s/iter; left time: 186.4060s
	iters: 400, epoch: 3 | loss: 0.0579011
	speed: 0.0273s/iter; left time: 183.9577s
	iters: 500, epoch: 3 | loss: 0.0563735
	speed: 0.0271s/iter; left time: 180.3892s
	iters: 600, epoch: 3 | loss: 0.0537993
	speed: 0.0273s/iter; left time: 178.6976s
	iters: 700, epoch: 3 | loss: 0.0503184
	speed: 0.0273s/iter; left time: 175.9395s
	iters: 800, epoch: 3 | loss: 0.0616823
	speed: 0.0273s/iter; left time: 173.3512s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.55s
Steps: 893 | Train Loss: 0.0596183 Vali Loss: 0.0602274 Test Loss: 0.0631756
Validation loss decreased (0.062763 --> 0.060227).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0566016
	speed: 0.1034s/iter; left time: 636.2913s
	iters: 200, epoch: 4 | loss: 0.0607590
	speed: 0.0274s/iter; left time: 165.7392s
	iters: 300, epoch: 4 | loss: 0.0590630
	speed: 0.0273s/iter; left time: 162.3564s
	iters: 400, epoch: 4 | loss: 0.0577303
	speed: 0.0275s/iter; left time: 160.8193s
	iters: 500, epoch: 4 | loss: 0.0543574
	speed: 0.0274s/iter; left time: 157.6705s
	iters: 600, epoch: 4 | loss: 0.0560706
	speed: 0.0274s/iter; left time: 154.8340s
	iters: 700, epoch: 4 | loss: 0.0535994
	speed: 0.0273s/iter; left time: 151.6173s
	iters: 800, epoch: 4 | loss: 0.0558486
	speed: 0.0273s/iter; left time: 148.8331s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.66s
Steps: 893 | Train Loss: 0.0577159 Vali Loss: 0.0600420 Test Loss: 0.0633396
Validation loss decreased (0.060227 --> 0.060042).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0585898
	speed: 0.1047s/iter; left time: 550.6945s
	iters: 200, epoch: 5 | loss: 0.0554182
	speed: 0.0273s/iter; left time: 140.9073s
	iters: 300, epoch: 5 | loss: 0.0534251
	speed: 0.0273s/iter; left time: 138.2541s
	iters: 400, epoch: 5 | loss: 0.0573839
	speed: 0.0274s/iter; left time: 135.9504s
	iters: 500, epoch: 5 | loss: 0.0654479
	speed: 0.0274s/iter; left time: 132.9638s
	iters: 600, epoch: 5 | loss: 0.0548622
	speed: 0.0274s/iter; left time: 130.3175s
	iters: 700, epoch: 5 | loss: 0.0537886
	speed: 0.0274s/iter; left time: 127.5791s
	iters: 800, epoch: 5 | loss: 0.0669306
	speed: 0.0274s/iter; left time: 124.8259s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.74s
Steps: 893 | Train Loss: 0.0556455 Vali Loss: 0.0566821 Test Loss: 0.0597330
Validation loss decreased (0.060042 --> 0.056682).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0597068
	speed: 0.1034s/iter; left time: 451.6137s
	iters: 200, epoch: 6 | loss: 0.0576773
	speed: 0.0273s/iter; left time: 116.4474s
	iters: 300, epoch: 6 | loss: 0.0541847
	speed: 0.0273s/iter; left time: 113.8685s
	iters: 400, epoch: 6 | loss: 0.0544486
	speed: 0.0273s/iter; left time: 111.0857s
	iters: 500, epoch: 6 | loss: 0.0583042
	speed: 0.0273s/iter; left time: 108.4008s
	iters: 600, epoch: 6 | loss: 0.0583834
	speed: 0.0273s/iter; left time: 105.4225s
	iters: 700, epoch: 6 | loss: 0.0603294
	speed: 0.0273s/iter; left time: 102.8035s
	iters: 800, epoch: 6 | loss: 0.0498330
	speed: 0.0273s/iter; left time: 100.0575s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.60s
Steps: 893 | Train Loss: 0.0539432 Vali Loss: 0.0568931 Test Loss: 0.0590978
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0543028
	speed: 0.1013s/iter; left time: 351.7732s
	iters: 200, epoch: 7 | loss: 0.0535316
	speed: 0.0272s/iter; left time: 91.5892s
	iters: 300, epoch: 7 | loss: 0.0476825
	speed: 0.0271s/iter; left time: 88.8612s
	iters: 400, epoch: 7 | loss: 0.0455986
	speed: 0.0272s/iter; left time: 86.1572s
	iters: 500, epoch: 7 | loss: 0.0611927
	speed: 0.0272s/iter; left time: 83.4797s
	iters: 600, epoch: 7 | loss: 0.0537777
	speed: 0.0272s/iter; left time: 80.7806s
	iters: 700, epoch: 7 | loss: 0.0457810
	speed: 0.0272s/iter; left time: 78.0918s
	iters: 800, epoch: 7 | loss: 0.0555975
	speed: 0.0272s/iter; left time: 75.4304s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.49s
Steps: 893 | Train Loss: 0.0523131 Vali Loss: 0.0568664 Test Loss: 0.0589486
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0444779
	speed: 0.1026s/iter; left time: 264.5918s
	iters: 200, epoch: 8 | loss: 0.0471091
	speed: 0.0275s/iter; left time: 68.1242s
	iters: 300, epoch: 8 | loss: 0.0528419
	speed: 0.0275s/iter; left time: 65.3533s
	iters: 400, epoch: 8 | loss: 0.0582183
	speed: 0.0274s/iter; left time: 62.4948s
	iters: 500, epoch: 8 | loss: 0.0537932
	speed: 0.0275s/iter; left time: 59.8843s
	iters: 600, epoch: 8 | loss: 0.0470188
	speed: 0.0275s/iter; left time: 57.1329s
	iters: 700, epoch: 8 | loss: 0.0450193
	speed: 0.0275s/iter; left time: 54.4315s
	iters: 800, epoch: 8 | loss: 0.0499783
	speed: 0.0274s/iter; left time: 51.5014s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:24.73s
Steps: 893 | Train Loss: 0.0512041 Vali Loss: 0.0569716 Test Loss: 0.0592024
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.010606962256133556, rmse:0.10299010574817657, mae:0.05973299592733383, rse:0.38920682668685913
Original data scale mse:1335150.25, rmse:1155.487060546875, mae:726.6997680664062, rse:0.0811987966299057

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.01028512418270111, RMSE: 0.10141560435295105, MAE: 0.05838574469089508, RSE: 0.3832566440105438
Unscaled Metrics - MSE: 1229446.0, RMSE: 1108.8038330078125, MAE: 701.6743774414062, RSE: 0.07791826128959656

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.010606962256133556, RMSE: 0.10299010574817657, MAE: 0.05973299592733383, RSE: 0.38920682668685913
Unscaled Metrics - MSE: 1335150.25, RMSE: 1155.487060546875, MAE: 726.6997680664062, RSE: 0.0811987966299057

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1105081
	speed: 0.0557s/iter; left time: 491.0879s
	iters: 200, epoch: 1 | loss: 0.0996064
	speed: 0.0276s/iter; left time: 240.1496s
	iters: 300, epoch: 1 | loss: 0.1031656
	speed: 0.0276s/iter; left time: 238.0412s
	iters: 400, epoch: 1 | loss: 0.0851174
	speed: 0.0277s/iter; left time: 235.3552s
	iters: 500, epoch: 1 | loss: 0.0866854
	speed: 0.0276s/iter; left time: 232.5178s
	iters: 600, epoch: 1 | loss: 0.0902673
	speed: 0.0277s/iter; left time: 229.8870s
	iters: 700, epoch: 1 | loss: 0.0830515
	speed: 0.0277s/iter; left time: 227.2108s
	iters: 800, epoch: 1 | loss: 0.0793476
	speed: 0.0276s/iter; left time: 223.8058s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.10s
Steps: 891 | Train Loss: 0.0937454 Vali Loss: 0.0822166 Test Loss: 0.0856704
Validation loss decreased (inf --> 0.082217).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0964225
	speed: 0.1043s/iter; left time: 825.9565s
	iters: 200, epoch: 2 | loss: 0.0774365
	speed: 0.0275s/iter; left time: 214.7657s
	iters: 300, epoch: 2 | loss: 0.0834263
	speed: 0.0275s/iter; left time: 211.9282s
	iters: 400, epoch: 2 | loss: 0.0835805
	speed: 0.0275s/iter; left time: 209.2406s
	iters: 500, epoch: 2 | loss: 0.0785982
	speed: 0.0274s/iter; left time: 206.3997s
	iters: 600, epoch: 2 | loss: 0.0789744
	speed: 0.0274s/iter; left time: 203.6677s
	iters: 700, epoch: 2 | loss: 0.0887654
	speed: 0.0275s/iter; left time: 201.0437s
	iters: 800, epoch: 2 | loss: 0.0835906
	speed: 0.0275s/iter; left time: 198.5823s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.71s
Steps: 891 | Train Loss: 0.0864526 Vali Loss: 0.0831924 Test Loss: 0.0863210
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0888632
	speed: 0.1011s/iter; left time: 710.3952s
	iters: 200, epoch: 3 | loss: 0.0798621
	speed: 0.0275s/iter; left time: 190.8001s
	iters: 300, epoch: 3 | loss: 0.0709843
	speed: 0.0276s/iter; left time: 188.2727s
	iters: 400, epoch: 3 | loss: 0.0765194
	speed: 0.0277s/iter; left time: 186.5185s
	iters: 500, epoch: 3 | loss: 0.0815379
	speed: 0.0278s/iter; left time: 184.1734s
	iters: 600, epoch: 3 | loss: 0.0730954
	speed: 0.0279s/iter; left time: 181.9433s
	iters: 700, epoch: 3 | loss: 0.0865044
	speed: 0.0276s/iter; left time: 177.6965s
	iters: 800, epoch: 3 | loss: 0.0689433
	speed: 0.0276s/iter; left time: 174.7090s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.84s
Steps: 891 | Train Loss: 0.0780314 Vali Loss: 0.0818157 Test Loss: 0.0857488
Validation loss decreased (0.082217 --> 0.081816).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818749
	speed: 0.1029s/iter; left time: 631.3753s
	iters: 200, epoch: 4 | loss: 0.0822757
	speed: 0.0274s/iter; left time: 165.6094s
	iters: 300, epoch: 4 | loss: 0.0778840
	speed: 0.0275s/iter; left time: 163.1373s
	iters: 400, epoch: 4 | loss: 0.0758914
	speed: 0.0276s/iter; left time: 160.8885s
	iters: 500, epoch: 4 | loss: 0.0926706
	speed: 0.0276s/iter; left time: 158.6033s
	iters: 600, epoch: 4 | loss: 0.0729162
	speed: 0.0277s/iter; left time: 156.1014s
	iters: 700, epoch: 4 | loss: 0.0779274
	speed: 0.0277s/iter; left time: 153.4515s
	iters: 800, epoch: 4 | loss: 0.0670786
	speed: 0.0275s/iter; left time: 149.7963s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.0747541 Vali Loss: 0.0829245 Test Loss: 0.0867970
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0757331
	speed: 0.1007s/iter; left time: 528.1917s
	iters: 200, epoch: 5 | loss: 0.0728932
	speed: 0.0276s/iter; left time: 141.9621s
	iters: 300, epoch: 5 | loss: 0.0734011
	speed: 0.0275s/iter; left time: 139.0087s
	iters: 400, epoch: 5 | loss: 0.0735156
	speed: 0.0276s/iter; left time: 136.2995s
	iters: 500, epoch: 5 | loss: 0.0631086
	speed: 0.0275s/iter; left time: 133.4610s
	iters: 600, epoch: 5 | loss: 0.0768523
	speed: 0.0276s/iter; left time: 130.9842s
	iters: 700, epoch: 5 | loss: 0.0680443
	speed: 0.0277s/iter; left time: 128.5577s
	iters: 800, epoch: 5 | loss: 0.0671747
	speed: 0.0276s/iter; left time: 125.7064s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.0709043 Vali Loss: 0.0810450 Test Loss: 0.0866122
Validation loss decreased (0.081816 --> 0.081045).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0741014
	speed: 0.1047s/iter; left time: 456.0453s
	iters: 200, epoch: 6 | loss: 0.0688873
	speed: 0.0275s/iter; left time: 117.1964s
	iters: 300, epoch: 6 | loss: 0.0628658
	speed: 0.0275s/iter; left time: 114.3372s
	iters: 400, epoch: 6 | loss: 0.0743414
	speed: 0.0276s/iter; left time: 111.8775s
	iters: 500, epoch: 6 | loss: 0.0634853
	speed: 0.0275s/iter; left time: 108.9567s
	iters: 600, epoch: 6 | loss: 0.0571122
	speed: 0.0276s/iter; left time: 106.2458s
	iters: 700, epoch: 6 | loss: 0.0648721
	speed: 0.0274s/iter; left time: 103.0115s
	iters: 800, epoch: 6 | loss: 0.0680667
	speed: 0.0274s/iter; left time: 100.2137s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.0659990 Vali Loss: 0.0834558 Test Loss: 0.0894878
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0690747
	speed: 0.1014s/iter; left time: 351.4710s
	iters: 200, epoch: 7 | loss: 0.0606300
	speed: 0.0275s/iter; left time: 92.6739s
	iters: 300, epoch: 7 | loss: 0.0632668
	speed: 0.0275s/iter; left time: 89.7871s
	iters: 400, epoch: 7 | loss: 0.0688783
	speed: 0.0275s/iter; left time: 87.1181s
	iters: 500, epoch: 7 | loss: 0.0662787
	speed: 0.0275s/iter; left time: 84.2109s
	iters: 600, epoch: 7 | loss: 0.0551271
	speed: 0.0275s/iter; left time: 81.4969s
	iters: 700, epoch: 7 | loss: 0.0581844
	speed: 0.0279s/iter; left time: 79.8114s
	iters: 800, epoch: 7 | loss: 0.0640281
	speed: 0.0279s/iter; left time: 77.2233s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.85s
Steps: 891 | Train Loss: 0.0618867 Vali Loss: 0.0832266 Test Loss: 0.0898357
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0513199
	speed: 0.1022s/iter; left time: 263.0413s
	iters: 200, epoch: 8 | loss: 0.0782013
	speed: 0.0277s/iter; left time: 68.6314s
	iters: 300, epoch: 8 | loss: 0.0491225
	speed: 0.0277s/iter; left time: 65.8426s
	iters: 400, epoch: 8 | loss: 0.0580266
	speed: 0.0278s/iter; left time: 63.1637s
	iters: 500, epoch: 8 | loss: 0.0587969
	speed: 0.0278s/iter; left time: 60.3784s
	iters: 600, epoch: 8 | loss: 0.0479266
	speed: 0.0276s/iter; left time: 57.2363s
	iters: 700, epoch: 8 | loss: 0.0576645
	speed: 0.0276s/iter; left time: 54.4550s
	iters: 800, epoch: 8 | loss: 0.0481737
	speed: 0.0276s/iter; left time: 51.7066s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:24.88s
Steps: 891 | Train Loss: 0.0572285 Vali Loss: 0.0836563 Test Loss: 0.0915003
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.021427039057016373, rmse:0.14637978374958038, mae:0.08661221712827682, rse:0.5534777045249939
Original data scale mse:2624052.5, rmse:1619.8927001953125, mae:1041.3607177734375, rse:0.11399847269058228
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1045499
	speed: 0.0294s/iter; left time: 259.1068s
	iters: 200, epoch: 1 | loss: 0.0942988
	speed: 0.0274s/iter; left time: 238.8377s
	iters: 300, epoch: 1 | loss: 0.0955527
	speed: 0.0274s/iter; left time: 236.2447s
	iters: 400, epoch: 1 | loss: 0.0876866
	speed: 0.0278s/iter; left time: 236.4848s
	iters: 500, epoch: 1 | loss: 0.0838357
	speed: 0.0275s/iter; left time: 231.3410s
	iters: 600, epoch: 1 | loss: 0.0872190
	speed: 0.0274s/iter; left time: 228.0833s
	iters: 700, epoch: 1 | loss: 0.0871359
	speed: 0.0276s/iter; left time: 226.2911s
	iters: 800, epoch: 1 | loss: 0.0799396
	speed: 0.0275s/iter; left time: 223.1991s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.0938517 Vali Loss: 0.0821118 Test Loss: 0.0857604
Validation loss decreased (inf --> 0.082112).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0913598
	speed: 0.1067s/iter; left time: 845.2780s
	iters: 200, epoch: 2 | loss: 0.0965336
	speed: 0.0279s/iter; left time: 218.3456s
	iters: 300, epoch: 2 | loss: 0.0905271
	speed: 0.0279s/iter; left time: 215.1444s
	iters: 400, epoch: 2 | loss: 0.0860040
	speed: 0.0279s/iter; left time: 212.6764s
	iters: 500, epoch: 2 | loss: 0.0879794
	speed: 0.0279s/iter; left time: 209.7249s
	iters: 600, epoch: 2 | loss: 0.0794324
	speed: 0.0279s/iter; left time: 206.6952s
	iters: 700, epoch: 2 | loss: 0.0820050
	speed: 0.0279s/iter; left time: 204.2072s
	iters: 800, epoch: 2 | loss: 0.0899950
	speed: 0.0278s/iter; left time: 200.5401s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.16s
Steps: 891 | Train Loss: 0.0877869 Vali Loss: 0.0833377 Test Loss: 0.0864561
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0824860
	speed: 0.1032s/iter; left time: 725.3639s
	iters: 200, epoch: 3 | loss: 0.0761332
	speed: 0.0277s/iter; left time: 192.0090s
	iters: 300, epoch: 3 | loss: 0.0737090
	speed: 0.0277s/iter; left time: 189.0776s
	iters: 400, epoch: 3 | loss: 0.0849798
	speed: 0.0277s/iter; left time: 186.2115s
	iters: 500, epoch: 3 | loss: 0.0765213
	speed: 0.0277s/iter; left time: 183.5519s
	iters: 600, epoch: 3 | loss: 0.0724109
	speed: 0.0278s/iter; left time: 181.2114s
	iters: 700, epoch: 3 | loss: 0.0826410
	speed: 0.0277s/iter; left time: 178.2232s
	iters: 800, epoch: 3 | loss: 0.0783634
	speed: 0.0277s/iter; left time: 175.2891s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.94s
Steps: 891 | Train Loss: 0.0792087 Vali Loss: 0.0850541 Test Loss: 0.0870546
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0753194
	speed: 0.1041s/iter; left time: 638.8625s
	iters: 200, epoch: 4 | loss: 0.0721694
	speed: 0.0279s/iter; left time: 168.3910s
	iters: 300, epoch: 4 | loss: 0.0677039
	speed: 0.0279s/iter; left time: 165.5042s
	iters: 400, epoch: 4 | loss: 0.0699360
	speed: 0.0275s/iter; left time: 160.8117s
	iters: 500, epoch: 4 | loss: 0.0759124
	speed: 0.0275s/iter; left time: 157.7168s
	iters: 600, epoch: 4 | loss: 0.0900504
	speed: 0.0275s/iter; left time: 155.0775s
	iters: 700, epoch: 4 | loss: 0.0657946
	speed: 0.0275s/iter; left time: 152.0975s
	iters: 800, epoch: 4 | loss: 0.0746171
	speed: 0.0274s/iter; left time: 149.1982s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.82s
Steps: 891 | Train Loss: 0.0764817 Vali Loss: 0.0789856 Test Loss: 0.0851568
Validation loss decreased (0.082112 --> 0.078986).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0663137
	speed: 0.1037s/iter; left time: 544.1926s
	iters: 200, epoch: 5 | loss: 0.0731977
	speed: 0.0276s/iter; left time: 141.8379s
	iters: 300, epoch: 5 | loss: 0.0844509
	speed: 0.0275s/iter; left time: 138.9748s
	iters: 400, epoch: 5 | loss: 0.0784731
	speed: 0.0275s/iter; left time: 136.1952s
	iters: 500, epoch: 5 | loss: 0.0762210
	speed: 0.0276s/iter; left time: 133.7498s
	iters: 600, epoch: 5 | loss: 0.0740356
	speed: 0.0276s/iter; left time: 130.8398s
	iters: 700, epoch: 5 | loss: 0.0737937
	speed: 0.0275s/iter; left time: 127.7239s
	iters: 800, epoch: 5 | loss: 0.0710074
	speed: 0.0275s/iter; left time: 125.0434s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.77s
Steps: 891 | Train Loss: 0.0719726 Vali Loss: 0.0809696 Test Loss: 0.0867843
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0612981
	speed: 0.1014s/iter; left time: 441.7285s
	iters: 200, epoch: 6 | loss: 0.0708099
	speed: 0.0274s/iter; left time: 116.7236s
	iters: 300, epoch: 6 | loss: 0.0721445
	speed: 0.0275s/iter; left time: 114.1800s
	iters: 400, epoch: 6 | loss: 0.0615193
	speed: 0.0275s/iter; left time: 111.7191s
	iters: 500, epoch: 6 | loss: 0.0626318
	speed: 0.0275s/iter; left time: 108.9667s
	iters: 600, epoch: 6 | loss: 0.0559747
	speed: 0.0276s/iter; left time: 106.4437s
	iters: 700, epoch: 6 | loss: 0.0643778
	speed: 0.0275s/iter; left time: 103.4658s
	iters: 800, epoch: 6 | loss: 0.0708977
	speed: 0.0275s/iter; left time: 100.4496s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.71s
Steps: 891 | Train Loss: 0.0675554 Vali Loss: 0.0832063 Test Loss: 0.0866704
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0648114
	speed: 0.1013s/iter; left time: 351.1349s
	iters: 200, epoch: 7 | loss: 0.0653329
	speed: 0.0275s/iter; left time: 92.5449s
	iters: 300, epoch: 7 | loss: 0.0769019
	speed: 0.0276s/iter; left time: 89.9993s
	iters: 400, epoch: 7 | loss: 0.0619589
	speed: 0.0276s/iter; left time: 87.2128s
	iters: 500, epoch: 7 | loss: 0.0582421
	speed: 0.0275s/iter; left time: 84.4353s
	iters: 600, epoch: 7 | loss: 0.0584133
	speed: 0.0276s/iter; left time: 81.7081s
	iters: 700, epoch: 7 | loss: 0.0624822
	speed: 0.0276s/iter; left time: 78.9521s
	iters: 800, epoch: 7 | loss: 0.0700237
	speed: 0.0276s/iter; left time: 76.1891s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.0625225 Vali Loss: 0.0852454 Test Loss: 0.0872330
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.020278727635741234, rmse:0.14240339398384094, mae:0.08515677601099014, rse:0.5384426116943359
Original data scale mse:2622210.25, rmse:1619.323974609375, mae:1035.57177734375, rse:0.1139584481716156

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.021427039057016373, RMSE: 0.14637978374958038, MAE: 0.08661221712827682, RSE: 0.5534777045249939
Unscaled Metrics - MSE: 2624052.5, RMSE: 1619.8927001953125, MAE: 1041.3607177734375, RSE: 0.11399847269058228

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.020278727635741234, RMSE: 0.14240339398384094, MAE: 0.08515677601099014, RSE: 0.5384426116943359
Unscaled Metrics - MSE: 2622210.25, RMSE: 1619.323974609375, MAE: 1035.57177734375, RSE: 0.1139584481716156

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=True, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1059616
	speed: 0.0556s/iter; left time: 489.0309s
	iters: 200, epoch: 1 | loss: 0.0925271
	speed: 0.0281s/iter; left time: 243.9435s
	iters: 300, epoch: 1 | loss: 0.0948087
	speed: 0.0280s/iter; left time: 240.5591s
	iters: 400, epoch: 1 | loss: 0.1033951
	speed: 0.0281s/iter; left time: 238.4128s
	iters: 500, epoch: 1 | loss: 0.1001987
	speed: 0.0281s/iter; left time: 235.3876s
	iters: 600, epoch: 1 | loss: 0.0933774
	speed: 0.0280s/iter; left time: 232.4289s
	iters: 700, epoch: 1 | loss: 0.0946327
	speed: 0.0281s/iter; left time: 230.3044s
	iters: 800, epoch: 1 | loss: 0.0881099
	speed: 0.0281s/iter; left time: 227.5806s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.41s
Steps: 889 | Train Loss: 0.0974119 Vali Loss: 0.0868911 Test Loss: 0.0899986
Validation loss decreased (inf --> 0.086891).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1020916
	speed: 0.1049s/iter; left time: 828.7534s
	iters: 200, epoch: 2 | loss: 0.0901684
	speed: 0.0281s/iter; left time: 219.0411s
	iters: 300, epoch: 2 | loss: 0.0959429
	speed: 0.0280s/iter; left time: 215.8091s
	iters: 400, epoch: 2 | loss: 0.0896802
	speed: 0.0280s/iter; left time: 212.7746s
	iters: 500, epoch: 2 | loss: 0.0897216
	speed: 0.0280s/iter; left time: 210.0979s
	iters: 600, epoch: 2 | loss: 0.0874215
	speed: 0.0280s/iter; left time: 207.2917s
	iters: 700, epoch: 2 | loss: 0.0849532
	speed: 0.0280s/iter; left time: 204.4806s
	iters: 800, epoch: 2 | loss: 0.0962499
	speed: 0.0280s/iter; left time: 201.6529s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.10s
Steps: 889 | Train Loss: 0.0912460 Vali Loss: 0.0920862 Test Loss: 0.0919890
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0816956
	speed: 0.1020s/iter; left time: 715.4454s
	iters: 200, epoch: 3 | loss: 0.0831593
	speed: 0.0281s/iter; left time: 194.4577s
	iters: 300, epoch: 3 | loss: 0.0901702
	speed: 0.0281s/iter; left time: 191.7269s
	iters: 400, epoch: 3 | loss: 0.0834232
	speed: 0.0281s/iter; left time: 188.7216s
	iters: 500, epoch: 3 | loss: 0.0726667
	speed: 0.0281s/iter; left time: 185.6703s
	iters: 600, epoch: 3 | loss: 0.0877903
	speed: 0.0281s/iter; left time: 183.0311s
	iters: 700, epoch: 3 | loss: 0.0849057
	speed: 0.0281s/iter; left time: 180.3086s
	iters: 800, epoch: 3 | loss: 0.0813427
	speed: 0.0281s/iter; left time: 177.4830s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.21s
Steps: 889 | Train Loss: 0.0823801 Vali Loss: 0.0893270 Test Loss: 0.0928033
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0783064
	speed: 0.1021s/iter; left time: 625.2114s
	iters: 200, epoch: 4 | loss: 0.0768117
	speed: 0.0280s/iter; left time: 168.9315s
	iters: 300, epoch: 4 | loss: 0.0803863
	speed: 0.0279s/iter; left time: 165.1620s
	iters: 400, epoch: 4 | loss: 0.0834070
	speed: 0.0279s/iter; left time: 162.4391s
	iters: 500, epoch: 4 | loss: 0.0716773
	speed: 0.0279s/iter; left time: 159.6676s
	iters: 600, epoch: 4 | loss: 0.0775080
	speed: 0.0279s/iter; left time: 156.7710s
	iters: 700, epoch: 4 | loss: 0.0838788
	speed: 0.0281s/iter; left time: 155.0253s
	iters: 800, epoch: 4 | loss: 0.0776621
	speed: 0.0281s/iter; left time: 152.5139s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.09s
Steps: 889 | Train Loss: 0.0776832 Vali Loss: 0.0887898 Test Loss: 0.0905043
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0197745431214571, rmse:0.14062198996543884, mae:0.08999864012002945, rse:0.5320742726325989
Original data scale mse:3422754.75, rmse:1850.06884765625, mae:1207.7420654296875, rse:0.13031916320323944
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1084314
	speed: 0.0302s/iter; left time: 265.4684s
	iters: 200, epoch: 1 | loss: 0.1079780
	speed: 0.0281s/iter; left time: 244.2277s
	iters: 300, epoch: 1 | loss: 0.0920241
	speed: 0.0281s/iter; left time: 241.5918s
	iters: 400, epoch: 1 | loss: 0.0974978
	speed: 0.0281s/iter; left time: 238.6649s
	iters: 500, epoch: 1 | loss: 0.0915105
	speed: 0.0281s/iter; left time: 235.9022s
	iters: 600, epoch: 1 | loss: 0.0927587
	speed: 0.0281s/iter; left time: 232.9231s
	iters: 700, epoch: 1 | loss: 0.0884221
	speed: 0.0282s/iter; left time: 230.7792s
	iters: 800, epoch: 1 | loss: 0.0889496
	speed: 0.0281s/iter; left time: 227.3147s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.26s
Steps: 889 | Train Loss: 0.0975213 Vali Loss: 0.0868709 Test Loss: 0.0899723
Validation loss decreased (inf --> 0.086871).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1052320
	speed: 0.1059s/iter; left time: 836.5984s
	iters: 200, epoch: 2 | loss: 0.0990840
	speed: 0.0281s/iter; left time: 219.4619s
	iters: 300, epoch: 2 | loss: 0.0991621
	speed: 0.0282s/iter; left time: 216.8983s
	iters: 400, epoch: 2 | loss: 0.0781823
	speed: 0.0281s/iter; left time: 213.5949s
	iters: 500, epoch: 2 | loss: 0.0846231
	speed: 0.0280s/iter; left time: 210.4189s
	iters: 600, epoch: 2 | loss: 0.0931173
	speed: 0.0280s/iter; left time: 207.2008s
	iters: 700, epoch: 2 | loss: 0.0860006
	speed: 0.0281s/iter; left time: 205.0403s
	iters: 800, epoch: 2 | loss: 0.0766494
	speed: 0.0281s/iter; left time: 202.2758s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.24s
Steps: 889 | Train Loss: 0.0901386 Vali Loss: 0.0884175 Test Loss: 0.0907820
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0802124
	speed: 0.1026s/iter; left time: 719.6549s
	iters: 200, epoch: 3 | loss: 0.0815620
	speed: 0.0281s/iter; left time: 193.9808s
	iters: 300, epoch: 3 | loss: 0.0839815
	speed: 0.0281s/iter; left time: 191.3583s
	iters: 400, epoch: 3 | loss: 0.0790244
	speed: 0.0282s/iter; left time: 189.0413s
	iters: 500, epoch: 3 | loss: 0.0828257
	speed: 0.0283s/iter; left time: 187.1084s
	iters: 600, epoch: 3 | loss: 0.0853539
	speed: 0.0281s/iter; left time: 182.8044s
	iters: 700, epoch: 3 | loss: 0.0793968
	speed: 0.0281s/iter; left time: 180.2423s
	iters: 800, epoch: 3 | loss: 0.0808210
	speed: 0.0281s/iter; left time: 177.1817s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.17s
Steps: 889 | Train Loss: 0.0807323 Vali Loss: 0.0869236 Test Loss: 0.0910492
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0790713
	speed: 0.1025s/iter; left time: 627.5350s
	iters: 200, epoch: 4 | loss: 0.0761492
	speed: 0.0280s/iter; left time: 168.7715s
	iters: 300, epoch: 4 | loss: 0.0809847
	speed: 0.0281s/iter; left time: 166.5376s
	iters: 400, epoch: 4 | loss: 0.0769964
	speed: 0.0281s/iter; left time: 163.5850s
	iters: 500, epoch: 4 | loss: 0.0794484
	speed: 0.0280s/iter; left time: 160.1380s
	iters: 600, epoch: 4 | loss: 0.0832798
	speed: 0.0280s/iter; left time: 157.5623s
	iters: 700, epoch: 4 | loss: 0.0840414
	speed: 0.0280s/iter; left time: 154.9441s
	iters: 800, epoch: 4 | loss: 0.0749400
	speed: 0.0281s/iter; left time: 152.2343s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.15s
Steps: 889 | Train Loss: 0.0768347 Vali Loss: 0.0873793 Test Loss: 0.0922181
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.01980746164917946, rmse:0.14073897898197174, mae:0.0899723544716835, rse:0.5325169563293457
Original data scale mse:3396051.75, rmse:1842.8380126953125, mae:1203.2320556640625, rse:0.12980982661247253

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.0197745431214571, RMSE: 0.14062198996543884, MAE: 0.08999864012002945, RSE: 0.5320742726325989
Unscaled Metrics - MSE: 3422754.75, RMSE: 1850.06884765625, MAE: 1207.7420654296875, RSE: 0.13031916320323944

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.01980746164917946, RMSE: 0.14073897898197174, MAE: 0.0899723544716835, RSE: 0.5325169563293457
Unscaled Metrics - MSE: 3396051.75, RMSE: 1842.8380126953125, MAE: 1203.2320556640625, RSE: 0.12980982661247253
