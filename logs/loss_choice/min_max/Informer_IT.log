
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0972284
	speed: 0.0536s/iter; left time: 966.1672s
	iters: 200, epoch: 1 | loss: 0.0881270
	speed: 0.0342s/iter; left time: 613.4235s
	iters: 300, epoch: 1 | loss: 0.0660699
	speed: 0.0341s/iter; left time: 608.2886s
	iters: 400, epoch: 1 | loss: 0.0614750
	speed: 0.0340s/iter; left time: 602.7891s
	iters: 500, epoch: 1 | loss: 0.0473126
	speed: 0.0339s/iter; left time: 597.8125s
	iters: 600, epoch: 1 | loss: 0.0451944
	speed: 0.0339s/iter; left time: 593.9310s
	iters: 700, epoch: 1 | loss: 0.0370400
	speed: 0.0339s/iter; left time: 590.5924s
	iters: 800, epoch: 1 | loss: 0.0355196
	speed: 0.0339s/iter; left time: 587.0480s
	iters: 900, epoch: 1 | loss: 0.0400502
	speed: 0.0339s/iter; left time: 583.7089s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:31.55s
Steps: 906 | Train Loss: 0.0606730 Vali Loss: 0.0234355 Test Loss: 0.0250223
Validation loss decreased (inf --> 0.023436).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0261067
	speed: 0.1125s/iter; left time: 1924.9819s
	iters: 200, epoch: 2 | loss: 0.0200592
	speed: 0.0338s/iter; left time: 575.7650s
	iters: 300, epoch: 2 | loss: 0.0135396
	speed: 0.0338s/iter; left time: 572.3251s
	iters: 400, epoch: 2 | loss: 0.0149230
	speed: 0.0338s/iter; left time: 569.0747s
	iters: 500, epoch: 2 | loss: 0.0170563
	speed: 0.0339s/iter; left time: 566.4360s
	iters: 600, epoch: 2 | loss: 0.0198278
	speed: 0.0339s/iter; left time: 563.1388s
	iters: 700, epoch: 2 | loss: 0.0141211
	speed: 0.0339s/iter; left time: 559.8101s
	iters: 800, epoch: 2 | loss: 0.0126595
	speed: 0.0339s/iter; left time: 557.1424s
	iters: 900, epoch: 2 | loss: 0.0124770
	speed: 0.0339s/iter; left time: 553.2910s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:30.97s
Steps: 906 | Train Loss: 0.0178323 Vali Loss: 0.0126410 Test Loss: 0.0139350
Validation loss decreased (0.023436 --> 0.012641).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0115169
	speed: 0.0977s/iter; left time: 1584.0204s
	iters: 200, epoch: 3 | loss: 0.0113969
	speed: 0.0340s/iter; left time: 547.1095s
	iters: 300, epoch: 3 | loss: 0.0122884
	speed: 0.0340s/iter; left time: 543.8462s
	iters: 400, epoch: 3 | loss: 0.0091601
	speed: 0.0340s/iter; left time: 541.0101s
	iters: 500, epoch: 3 | loss: 0.0105911
	speed: 0.0340s/iter; left time: 537.9233s
	iters: 600, epoch: 3 | loss: 0.0134643
	speed: 0.0340s/iter; left time: 534.0213s
	iters: 700, epoch: 3 | loss: 0.0123838
	speed: 0.0340s/iter; left time: 530.0699s
	iters: 800, epoch: 3 | loss: 0.0144936
	speed: 0.0340s/iter; left time: 528.0502s
	iters: 900, epoch: 3 | loss: 0.0104546
	speed: 0.0340s/iter; left time: 524.3756s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:31.07s
Steps: 906 | Train Loss: 0.0117578 Vali Loss: 0.0118713 Test Loss: 0.0133946
Validation loss decreased (0.012641 --> 0.011871).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0126508
	speed: 0.0957s/iter; left time: 1464.2749s
	iters: 200, epoch: 4 | loss: 0.0097992
	speed: 0.0341s/iter; left time: 517.8578s
	iters: 300, epoch: 4 | loss: 0.0106744
	speed: 0.0341s/iter; left time: 514.7958s
	iters: 400, epoch: 4 | loss: 0.0124443
	speed: 0.0341s/iter; left time: 511.1804s
	iters: 500, epoch: 4 | loss: 0.0105432
	speed: 0.0341s/iter; left time: 507.4604s
	iters: 600, epoch: 4 | loss: 0.0091463
	speed: 0.0341s/iter; left time: 504.3534s
	iters: 700, epoch: 4 | loss: 0.0091151
	speed: 0.0341s/iter; left time: 500.7982s
	iters: 800, epoch: 4 | loss: 0.0115890
	speed: 0.0340s/iter; left time: 497.0697s
	iters: 900, epoch: 4 | loss: 0.0114444
	speed: 0.0341s/iter; left time: 494.2043s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:31.11s
Steps: 906 | Train Loss: 0.0106479 Vali Loss: 0.0109121 Test Loss: 0.0119638
Validation loss decreased (0.011871 --> 0.010912).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0093729
	speed: 0.0960s/iter; left time: 1382.2816s
	iters: 200, epoch: 5 | loss: 0.0132099
	speed: 0.0341s/iter; left time: 487.0891s
	iters: 300, epoch: 5 | loss: 0.0109833
	speed: 0.0341s/iter; left time: 483.5999s
	iters: 400, epoch: 5 | loss: 0.0088139
	speed: 0.0341s/iter; left time: 480.7247s
	iters: 500, epoch: 5 | loss: 0.0091402
	speed: 0.0341s/iter; left time: 477.8466s
	iters: 600, epoch: 5 | loss: 0.0087063
	speed: 0.0341s/iter; left time: 473.4118s
	iters: 700, epoch: 5 | loss: 0.0136012
	speed: 0.0341s/iter; left time: 470.2053s
	iters: 800, epoch: 5 | loss: 0.0067761
	speed: 0.0341s/iter; left time: 466.8037s
	iters: 900, epoch: 5 | loss: 0.0103542
	speed: 0.0341s/iter; left time: 463.7574s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.15s
Steps: 906 | Train Loss: 0.0096692 Vali Loss: 0.0101006 Test Loss: 0.0114337
Validation loss decreased (0.010912 --> 0.010101).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0084755
	speed: 0.0979s/iter; left time: 1320.9922s
	iters: 200, epoch: 6 | loss: 0.0094736
	speed: 0.0341s/iter; left time: 456.7171s
	iters: 300, epoch: 6 | loss: 0.0119596
	speed: 0.0341s/iter; left time: 453.2811s
	iters: 400, epoch: 6 | loss: 0.0080049
	speed: 0.0341s/iter; left time: 449.8563s
	iters: 500, epoch: 6 | loss: 0.0060297
	speed: 0.0341s/iter; left time: 446.0368s
	iters: 600, epoch: 6 | loss: 0.0095585
	speed: 0.0341s/iter; left time: 442.6893s
	iters: 700, epoch: 6 | loss: 0.0103028
	speed: 0.0341s/iter; left time: 439.4991s
	iters: 800, epoch: 6 | loss: 0.0082057
	speed: 0.0341s/iter; left time: 435.5695s
	iters: 900, epoch: 6 | loss: 0.0073152
	speed: 0.0340s/iter; left time: 431.9884s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.15s
Steps: 906 | Train Loss: 0.0089187 Vali Loss: 0.0100227 Test Loss: 0.0115355
Validation loss decreased (0.010101 --> 0.010023).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0078097
	speed: 0.0956s/iter; left time: 1203.4684s
	iters: 200, epoch: 7 | loss: 0.0098551
	speed: 0.0340s/iter; left time: 425.0222s
	iters: 300, epoch: 7 | loss: 0.0068888
	speed: 0.0340s/iter; left time: 421.5561s
	iters: 400, epoch: 7 | loss: 0.0101782
	speed: 0.0341s/iter; left time: 418.5162s
	iters: 500, epoch: 7 | loss: 0.0082054
	speed: 0.0340s/iter; left time: 414.5701s
	iters: 600, epoch: 7 | loss: 0.0057436
	speed: 0.0340s/iter; left time: 411.3872s
	iters: 700, epoch: 7 | loss: 0.0080928
	speed: 0.0341s/iter; left time: 408.4066s
	iters: 800, epoch: 7 | loss: 0.0097687
	speed: 0.0341s/iter; left time: 404.9074s
	iters: 900, epoch: 7 | loss: 0.0065648
	speed: 0.0341s/iter; left time: 401.5536s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:31.09s
Steps: 906 | Train Loss: 0.0083377 Vali Loss: 0.0095675 Test Loss: 0.0110407
Validation loss decreased (0.010023 --> 0.009568).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0066216
	speed: 0.1007s/iter; left time: 1176.4372s
	iters: 200, epoch: 8 | loss: 0.0064539
	speed: 0.0340s/iter; left time: 393.6709s
	iters: 300, epoch: 8 | loss: 0.0060218
	speed: 0.0340s/iter; left time: 390.0610s
	iters: 400, epoch: 8 | loss: 0.0077329
	speed: 0.0340s/iter; left time: 386.6462s
	iters: 500, epoch: 8 | loss: 0.0081930
	speed: 0.0340s/iter; left time: 383.7722s
	iters: 600, epoch: 8 | loss: 0.0085409
	speed: 0.0340s/iter; left time: 380.2440s
	iters: 700, epoch: 8 | loss: 0.0067278
	speed: 0.0340s/iter; left time: 376.6261s
	iters: 800, epoch: 8 | loss: 0.0081196
	speed: 0.0340s/iter; left time: 373.3279s
	iters: 900, epoch: 8 | loss: 0.0074904
	speed: 0.0339s/iter; left time: 369.3196s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:31.04s
Steps: 906 | Train Loss: 0.0077836 Vali Loss: 0.0094765 Test Loss: 0.0111610
Validation loss decreased (0.009568 --> 0.009476).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0052157
	speed: 0.0960s/iter; left time: 1034.0261s
	iters: 200, epoch: 9 | loss: 0.0087680
	speed: 0.0340s/iter; left time: 362.6165s
	iters: 300, epoch: 9 | loss: 0.0094829
	speed: 0.0340s/iter; left time: 359.9351s
	iters: 400, epoch: 9 | loss: 0.0059583
	speed: 0.0340s/iter; left time: 355.9876s
	iters: 500, epoch: 9 | loss: 0.0065391
	speed: 0.0339s/iter; left time: 352.1177s
	iters: 600, epoch: 9 | loss: 0.0079168
	speed: 0.0340s/iter; left time: 349.1545s
	iters: 700, epoch: 9 | loss: 0.0076959
	speed: 0.0340s/iter; left time: 345.5142s
	iters: 800, epoch: 9 | loss: 0.0063940
	speed: 0.0340s/iter; left time: 342.2727s
	iters: 900, epoch: 9 | loss: 0.0064888
	speed: 0.0340s/iter; left time: 339.3683s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:31.04s
Steps: 906 | Train Loss: 0.0072910 Vali Loss: 0.0106013 Test Loss: 0.0116490
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0081920
	speed: 0.0924s/iter; left time: 912.0649s
	iters: 200, epoch: 10 | loss: 0.0071812
	speed: 0.0340s/iter; left time: 331.7457s
	iters: 300, epoch: 10 | loss: 0.0080360
	speed: 0.0340s/iter; left time: 328.7072s
	iters: 400, epoch: 10 | loss: 0.0067103
	speed: 0.0340s/iter; left time: 325.5007s
	iters: 500, epoch: 10 | loss: 0.0057465
	speed: 0.0340s/iter; left time: 322.0288s
	iters: 600, epoch: 10 | loss: 0.0076225
	speed: 0.0340s/iter; left time: 318.1950s
	iters: 700, epoch: 10 | loss: 0.0055612
	speed: 0.0340s/iter; left time: 314.8224s
	iters: 800, epoch: 10 | loss: 0.0072454
	speed: 0.0340s/iter; left time: 311.8976s
	iters: 900, epoch: 10 | loss: 0.0064351
	speed: 0.0340s/iter; left time: 308.1954s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:31.04s
Steps: 906 | Train Loss: 0.0068866 Vali Loss: 0.0099388 Test Loss: 0.0116837
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0069420
	speed: 0.0922s/iter; left time: 826.5974s
	iters: 200, epoch: 11 | loss: 0.0058681
	speed: 0.0340s/iter; left time: 301.3443s
	iters: 300, epoch: 11 | loss: 0.0074936
	speed: 0.0340s/iter; left time: 297.8629s
	iters: 400, epoch: 11 | loss: 0.0056524
	speed: 0.0340s/iter; left time: 294.6827s
	iters: 500, epoch: 11 | loss: 0.0071056
	speed: 0.0340s/iter; left time: 291.1001s
	iters: 600, epoch: 11 | loss: 0.0073804
	speed: 0.0340s/iter; left time: 287.7534s
	iters: 700, epoch: 11 | loss: 0.0070853
	speed: 0.0340s/iter; left time: 284.2631s
	iters: 800, epoch: 11 | loss: 0.0074142
	speed: 0.0340s/iter; left time: 281.1463s
	iters: 900, epoch: 11 | loss: 0.0059911
	speed: 0.0340s/iter; left time: 277.2952s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.02s
Steps: 906 | Train Loss: 0.0064856 Vali Loss: 0.0105782 Test Loss: 0.0118934
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0053530
	speed: 0.0928s/iter; left time: 747.8610s
	iters: 200, epoch: 12 | loss: 0.0075861
	speed: 0.0339s/iter; left time: 269.7478s
	iters: 300, epoch: 12 | loss: 0.0055364
	speed: 0.0340s/iter; left time: 267.1719s
	iters: 400, epoch: 12 | loss: 0.0068468
	speed: 0.0340s/iter; left time: 263.6226s
	iters: 500, epoch: 12 | loss: 0.0076434
	speed: 0.0340s/iter; left time: 260.0121s
	iters: 600, epoch: 12 | loss: 0.0064606
	speed: 0.0340s/iter; left time: 256.7812s
	iters: 700, epoch: 12 | loss: 0.0058148
	speed: 0.0340s/iter; left time: 253.6848s
	iters: 800, epoch: 12 | loss: 0.0071375
	speed: 0.0340s/iter; left time: 249.8700s
	iters: 900, epoch: 12 | loss: 0.0060761
	speed: 0.0340s/iter; left time: 246.9253s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:31.03s
Steps: 906 | Train Loss: 0.0061183 Vali Loss: 0.0104378 Test Loss: 0.0126510
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0053074
	speed: 0.0930s/iter; left time: 664.6588s
	iters: 200, epoch: 13 | loss: 0.0066337
	speed: 0.0340s/iter; left time: 239.3422s
	iters: 300, epoch: 13 | loss: 0.0057878
	speed: 0.0340s/iter; left time: 236.0683s
	iters: 400, epoch: 13 | loss: 0.0048156
	speed: 0.0340s/iter; left time: 232.6297s
	iters: 500, epoch: 13 | loss: 0.0046192
	speed: 0.0339s/iter; left time: 229.1009s
	iters: 600, epoch: 13 | loss: 0.0050266
	speed: 0.0339s/iter; left time: 225.6425s
	iters: 700, epoch: 13 | loss: 0.0063398
	speed: 0.0340s/iter; left time: 222.6156s
	iters: 800, epoch: 13 | loss: 0.0056544
	speed: 0.0340s/iter; left time: 219.1683s
	iters: 900, epoch: 13 | loss: 0.0062224
	speed: 0.0340s/iter; left time: 215.8425s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:31.03s
Steps: 906 | Train Loss: 0.0058192 Vali Loss: 0.0104211 Test Loss: 0.0130738
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011139685288071632, rmse:0.10554470866918564, mae:0.06488028168678284, rse:0.3988608121871948
Original data scale mse:1800234.625, rmse:1341.728271484375, mae:865.4649047851562, rse:0.09428640455007553
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0946719
	speed: 0.0364s/iter; left time: 655.2500s
	iters: 200, epoch: 1 | loss: 0.0929217
	speed: 0.0339s/iter; left time: 608.1890s
	iters: 300, epoch: 1 | loss: 0.0742790
	speed: 0.0340s/iter; left time: 605.5886s
	iters: 400, epoch: 1 | loss: 0.0651068
	speed: 0.0340s/iter; left time: 601.9478s
	iters: 500, epoch: 1 | loss: 0.0646000
	speed: 0.0340s/iter; left time: 598.5111s
	iters: 600, epoch: 1 | loss: 0.0608652
	speed: 0.0339s/iter; left time: 594.3870s
	iters: 700, epoch: 1 | loss: 0.0580129
	speed: 0.0340s/iter; left time: 592.0174s
	iters: 800, epoch: 1 | loss: 0.0489166
	speed: 0.0339s/iter; left time: 587.4049s
	iters: 900, epoch: 1 | loss: 0.0366947
	speed: 0.0339s/iter; left time: 584.3648s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:31.05s
Steps: 906 | Train Loss: 0.0725760 Vali Loss: 0.0295805 Test Loss: 0.0328899
Validation loss decreased (inf --> 0.029580).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0274326
	speed: 0.0966s/iter; left time: 1653.8839s
	iters: 200, epoch: 2 | loss: 0.0216325
	speed: 0.0340s/iter; left time: 578.6356s
	iters: 300, epoch: 2 | loss: 0.0185726
	speed: 0.0340s/iter; left time: 574.8628s
	iters: 400, epoch: 2 | loss: 0.0210525
	speed: 0.0340s/iter; left time: 571.3170s
	iters: 500, epoch: 2 | loss: 0.0165901
	speed: 0.0340s/iter; left time: 567.7598s
	iters: 600, epoch: 2 | loss: 0.0174658
	speed: 0.0340s/iter; left time: 565.3028s
	iters: 700, epoch: 2 | loss: 0.0126684
	speed: 0.0340s/iter; left time: 561.7988s
	iters: 800, epoch: 2 | loss: 0.0152528
	speed: 0.0340s/iter; left time: 558.3740s
	iters: 900, epoch: 2 | loss: 0.0113291
	speed: 0.0340s/iter; left time: 554.1465s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.08s
Steps: 906 | Train Loss: 0.0188265 Vali Loss: 0.0125718 Test Loss: 0.0131998
Validation loss decreased (0.029580 --> 0.012572).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0108299
	speed: 0.0963s/iter; left time: 1560.2048s
	iters: 200, epoch: 3 | loss: 0.0125845
	speed: 0.0340s/iter; left time: 548.5016s
	iters: 300, epoch: 3 | loss: 0.0093613
	speed: 0.0340s/iter; left time: 544.3124s
	iters: 400, epoch: 3 | loss: 0.0108911
	speed: 0.0340s/iter; left time: 541.3197s
	iters: 500, epoch: 3 | loss: 0.0121867
	speed: 0.0340s/iter; left time: 538.0183s
	iters: 600, epoch: 3 | loss: 0.0101375
	speed: 0.0340s/iter; left time: 534.4255s
	iters: 700, epoch: 3 | loss: 0.0091377
	speed: 0.0341s/iter; left time: 531.6456s
	iters: 800, epoch: 3 | loss: 0.0105136
	speed: 0.0340s/iter; left time: 527.9341s
	iters: 900, epoch: 3 | loss: 0.0100957
	speed: 0.0340s/iter; left time: 524.1469s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:31.13s
Steps: 906 | Train Loss: 0.0121599 Vali Loss: 0.0116421 Test Loss: 0.0125670
Validation loss decreased (0.012572 --> 0.011642).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0097274
	speed: 0.0957s/iter; left time: 1464.6991s
	iters: 200, epoch: 4 | loss: 0.0092834
	speed: 0.0340s/iter; left time: 517.2461s
	iters: 300, epoch: 4 | loss: 0.0118909
	speed: 0.0340s/iter; left time: 514.0601s
	iters: 400, epoch: 4 | loss: 0.0108857
	speed: 0.0340s/iter; left time: 510.2022s
	iters: 500, epoch: 4 | loss: 0.0103518
	speed: 0.0339s/iter; left time: 505.7799s
	iters: 600, epoch: 4 | loss: 0.0116715
	speed: 0.0340s/iter; left time: 502.6033s
	iters: 700, epoch: 4 | loss: 0.0093000
	speed: 0.0340s/iter; left time: 499.2699s
	iters: 800, epoch: 4 | loss: 0.0107670
	speed: 0.0339s/iter; left time: 495.5604s
	iters: 900, epoch: 4 | loss: 0.0110103
	speed: 0.0340s/iter; left time: 492.5112s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:31.05s
Steps: 906 | Train Loss: 0.0107405 Vali Loss: 0.0104148 Test Loss: 0.0119527
Validation loss decreased (0.011642 --> 0.010415).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0099993
	speed: 0.0961s/iter; left time: 1383.4842s
	iters: 200, epoch: 5 | loss: 0.0106571
	speed: 0.0339s/iter; left time: 484.7378s
	iters: 300, epoch: 5 | loss: 0.0106437
	speed: 0.0339s/iter; left time: 481.3551s
	iters: 400, epoch: 5 | loss: 0.0118819
	speed: 0.0339s/iter; left time: 478.5914s
	iters: 500, epoch: 5 | loss: 0.0102038
	speed: 0.0340s/iter; left time: 475.5587s
	iters: 600, epoch: 5 | loss: 0.0104462
	speed: 0.0340s/iter; left time: 471.9792s
	iters: 700, epoch: 5 | loss: 0.0114743
	speed: 0.0340s/iter; left time: 468.9569s
	iters: 800, epoch: 5 | loss: 0.0108274
	speed: 0.0340s/iter; left time: 465.6280s
	iters: 900, epoch: 5 | loss: 0.0099661
	speed: 0.0340s/iter; left time: 462.0270s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.00s
Steps: 906 | Train Loss: 0.0099865 Vali Loss: 0.0101851 Test Loss: 0.0121074
Validation loss decreased (0.010415 --> 0.010185).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0106021
	speed: 0.0955s/iter; left time: 1288.5754s
	iters: 200, epoch: 6 | loss: 0.0106260
	speed: 0.0340s/iter; left time: 455.1006s
	iters: 300, epoch: 6 | loss: 0.0109733
	speed: 0.0340s/iter; left time: 451.7967s
	iters: 400, epoch: 6 | loss: 0.0133107
	speed: 0.0340s/iter; left time: 448.7293s
	iters: 500, epoch: 6 | loss: 0.0114055
	speed: 0.0340s/iter; left time: 445.7267s
	iters: 600, epoch: 6 | loss: 0.0075874
	speed: 0.0340s/iter; left time: 441.5994s
	iters: 700, epoch: 6 | loss: 0.0097217
	speed: 0.0340s/iter; left time: 438.6970s
	iters: 800, epoch: 6 | loss: 0.0075483
	speed: 0.0340s/iter; left time: 434.8378s
	iters: 900, epoch: 6 | loss: 0.0069364
	speed: 0.0340s/iter; left time: 431.5836s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.08s
Steps: 906 | Train Loss: 0.0092689 Vali Loss: 0.0105527 Test Loss: 0.0121766
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0099495
	speed: 0.0938s/iter; left time: 1180.4143s
	iters: 200, epoch: 7 | loss: 0.0088085
	speed: 0.0341s/iter; left time: 426.2258s
	iters: 300, epoch: 7 | loss: 0.0082324
	speed: 0.0340s/iter; left time: 421.6041s
	iters: 400, epoch: 7 | loss: 0.0098417
	speed: 0.0340s/iter; left time: 418.1880s
	iters: 500, epoch: 7 | loss: 0.0068528
	speed: 0.0341s/iter; left time: 415.3217s
	iters: 600, epoch: 7 | loss: 0.0073076
	speed: 0.0340s/iter; left time: 411.3323s
	iters: 700, epoch: 7 | loss: 0.0096363
	speed: 0.0341s/iter; left time: 408.4615s
	iters: 800, epoch: 7 | loss: 0.0079663
	speed: 0.0340s/iter; left time: 403.6016s
	iters: 900, epoch: 7 | loss: 0.0101435
	speed: 0.0340s/iter; left time: 400.6379s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:31.11s
Steps: 906 | Train Loss: 0.0087563 Vali Loss: 0.0098878 Test Loss: 0.0116902
Validation loss decreased (0.010185 --> 0.009888).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0083788
	speed: 0.0967s/iter; left time: 1129.1874s
	iters: 200, epoch: 8 | loss: 0.0093471
	speed: 0.0339s/iter; left time: 392.9146s
	iters: 300, epoch: 8 | loss: 0.0077939
	speed: 0.0340s/iter; left time: 389.8273s
	iters: 400, epoch: 8 | loss: 0.0077422
	speed: 0.0339s/iter; left time: 386.2956s
	iters: 500, epoch: 8 | loss: 0.0079480
	speed: 0.0340s/iter; left time: 383.4038s
	iters: 600, epoch: 8 | loss: 0.0111170
	speed: 0.0340s/iter; left time: 379.6807s
	iters: 700, epoch: 8 | loss: 0.0080697
	speed: 0.0339s/iter; left time: 375.7415s
	iters: 800, epoch: 8 | loss: 0.0100588
	speed: 0.0339s/iter; left time: 372.6925s
	iters: 900, epoch: 8 | loss: 0.0087991
	speed: 0.0340s/iter; left time: 369.8613s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:31.05s
Steps: 906 | Train Loss: 0.0081583 Vali Loss: 0.0097605 Test Loss: 0.0114968
Validation loss decreased (0.009888 --> 0.009760).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0079887
	speed: 0.0968s/iter; left time: 1042.5671s
	iters: 200, epoch: 9 | loss: 0.0076844
	speed: 0.0340s/iter; left time: 362.9627s
	iters: 300, epoch: 9 | loss: 0.0073041
	speed: 0.0340s/iter; left time: 359.6542s
	iters: 400, epoch: 9 | loss: 0.0070676
	speed: 0.0340s/iter; left time: 356.5332s
	iters: 500, epoch: 9 | loss: 0.0085628
	speed: 0.0340s/iter; left time: 352.6650s
	iters: 600, epoch: 9 | loss: 0.0063866
	speed: 0.0340s/iter; left time: 349.4597s
	iters: 700, epoch: 9 | loss: 0.0070996
	speed: 0.0340s/iter; left time: 345.8963s
	iters: 800, epoch: 9 | loss: 0.0083093
	speed: 0.0340s/iter; left time: 342.8567s
	iters: 900, epoch: 9 | loss: 0.0069805
	speed: 0.0340s/iter; left time: 339.0049s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:31.10s
Steps: 906 | Train Loss: 0.0076499 Vali Loss: 0.0097633 Test Loss: 0.0117772
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0060302
	speed: 0.0937s/iter; left time: 924.0546s
	iters: 200, epoch: 10 | loss: 0.0093350
	speed: 0.0340s/iter; left time: 331.6450s
	iters: 300, epoch: 10 | loss: 0.0070846
	speed: 0.0339s/iter; left time: 327.8166s
	iters: 400, epoch: 10 | loss: 0.0069731
	speed: 0.0340s/iter; left time: 324.8613s
	iters: 500, epoch: 10 | loss: 0.0060187
	speed: 0.0340s/iter; left time: 321.5116s
	iters: 600, epoch: 10 | loss: 0.0069155
	speed: 0.0339s/iter; left time: 317.4491s
	iters: 700, epoch: 10 | loss: 0.0081655
	speed: 0.0340s/iter; left time: 315.0145s
	iters: 800, epoch: 10 | loss: 0.0055532
	speed: 0.0340s/iter; left time: 311.4031s
	iters: 900, epoch: 10 | loss: 0.0065675
	speed: 0.0339s/iter; left time: 307.4455s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:31.02s
Steps: 906 | Train Loss: 0.0071673 Vali Loss: 0.0101122 Test Loss: 0.0121082
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0066794
	speed: 0.0930s/iter; left time: 833.4363s
	iters: 200, epoch: 11 | loss: 0.0056569
	speed: 0.0340s/iter; left time: 301.0403s
	iters: 300, epoch: 11 | loss: 0.0075528
	speed: 0.0339s/iter; left time: 297.2453s
	iters: 400, epoch: 11 | loss: 0.0063265
	speed: 0.0340s/iter; left time: 294.1769s
	iters: 500, epoch: 11 | loss: 0.0058926
	speed: 0.0340s/iter; left time: 290.9720s
	iters: 600, epoch: 11 | loss: 0.0044438
	speed: 0.0340s/iter; left time: 287.7091s
	iters: 700, epoch: 11 | loss: 0.0066303
	speed: 0.0340s/iter; left time: 284.2641s
	iters: 800, epoch: 11 | loss: 0.0057136
	speed: 0.0340s/iter; left time: 280.8560s
	iters: 900, epoch: 11 | loss: 0.0089892
	speed: 0.0344s/iter; left time: 281.1268s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.08s
Steps: 906 | Train Loss: 0.0067194 Vali Loss: 0.0100680 Test Loss: 0.0121831
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0066273
	speed: 0.1040s/iter; left time: 837.6305s
	iters: 200, epoch: 12 | loss: 0.0053922
	speed: 0.0365s/iter; left time: 290.6183s
	iters: 300, epoch: 12 | loss: 0.0060718
	speed: 0.0359s/iter; left time: 281.6058s
	iters: 400, epoch: 12 | loss: 0.0073088
	speed: 0.0355s/iter; left time: 275.2680s
	iters: 500, epoch: 12 | loss: 0.0073975
	speed: 0.0360s/iter; left time: 275.2791s
	iters: 600, epoch: 12 | loss: 0.0072382
	speed: 0.0355s/iter; left time: 268.5791s
	iters: 700, epoch: 12 | loss: 0.0062839
	speed: 0.0359s/iter; left time: 267.5799s
	iters: 800, epoch: 12 | loss: 0.0054433
	speed: 0.0355s/iter; left time: 261.2184s
	iters: 900, epoch: 12 | loss: 0.0057036
	speed: 0.0363s/iter; left time: 263.5234s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:33.06s
Steps: 906 | Train Loss: 0.0063486 Vali Loss: 0.0103845 Test Loss: 0.0123336
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0073871
	speed: 0.1099s/iter; left time: 785.9836s
	iters: 200, epoch: 13 | loss: 0.0051247
	speed: 0.0444s/iter; left time: 313.1598s
	iters: 300, epoch: 13 | loss: 0.0053725
	speed: 0.0355s/iter; left time: 246.4561s
	iters: 400, epoch: 13 | loss: 0.0055240
	speed: 0.0347s/iter; left time: 237.6544s
	iters: 500, epoch: 13 | loss: 0.0064759
	speed: 0.0345s/iter; left time: 233.1055s
	iters: 600, epoch: 13 | loss: 0.0065577
	speed: 0.0343s/iter; left time: 228.1991s
	iters: 700, epoch: 13 | loss: 0.0059091
	speed: 0.0343s/iter; left time: 224.5556s
	iters: 800, epoch: 13 | loss: 0.0059391
	speed: 0.0342s/iter; left time: 220.6454s
	iters: 900, epoch: 13 | loss: 0.0051179
	speed: 0.0341s/iter; left time: 216.5813s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:33.77s
Steps: 906 | Train Loss: 0.0059923 Vali Loss: 0.0098415 Test Loss: 0.0122717
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.011506819166243076, rmse:0.10726984590291977, mae:0.06715415418148041, rse:0.4053802192211151
Original data scale mse:1954150.75, rmse:1397.909423828125, mae:902.05517578125, rse:0.0982343927025795

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.011139685288071632, RMSE: 0.10554470866918564, MAE: 0.06488028168678284, RSE: 0.3988608121871948
Unscaled Metrics - MSE: 1800234.625, RMSE: 1341.728271484375, MAE: 865.4649047851562, RSE: 0.09428640455007553

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.011506819166243076, RMSE: 0.10726984590291977, MAE: 0.06715415418148041, RSE: 0.4053802192211151
Unscaled Metrics - MSE: 1954150.75, RMSE: 1397.909423828125, MAE: 902.05517578125, RSE: 0.0982343927025795

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1049265
	speed: 0.0607s/iter; left time: 1092.1872s
	iters: 200, epoch: 1 | loss: 0.0846940
	speed: 0.0415s/iter; left time: 741.6410s
	iters: 300, epoch: 1 | loss: 0.0775601
	speed: 0.0415s/iter; left time: 737.2690s
	iters: 400, epoch: 1 | loss: 0.0718062
	speed: 0.0414s/iter; left time: 732.8635s
	iters: 500, epoch: 1 | loss: 0.0738738
	speed: 0.0414s/iter; left time: 728.2129s
	iters: 600, epoch: 1 | loss: 0.0635841
	speed: 0.0414s/iter; left time: 724.2041s
	iters: 700, epoch: 1 | loss: 0.0610177
	speed: 0.0414s/iter; left time: 720.0709s
	iters: 800, epoch: 1 | loss: 0.0556312
	speed: 0.0414s/iter; left time: 715.6822s
	iters: 900, epoch: 1 | loss: 0.0562442
	speed: 0.0414s/iter; left time: 711.9366s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.18s
Steps: 904 | Train Loss: 0.0766098 Vali Loss: 0.0418758 Test Loss: 0.0485719
Validation loss decreased (inf --> 0.041876).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0419440
	speed: 0.1174s/iter; left time: 2004.7477s
	iters: 200, epoch: 2 | loss: 0.0319205
	speed: 0.0424s/iter; left time: 719.3124s
	iters: 300, epoch: 2 | loss: 0.0304332
	speed: 0.0532s/iter; left time: 898.2974s
	iters: 400, epoch: 2 | loss: 0.0277296
	speed: 0.0564s/iter; left time: 946.2585s
	iters: 500, epoch: 2 | loss: 0.0251713
	speed: 0.0595s/iter; left time: 991.6578s
	iters: 600, epoch: 2 | loss: 0.0220603
	speed: 0.0540s/iter; left time: 895.2998s
	iters: 700, epoch: 2 | loss: 0.0232078
	speed: 0.0527s/iter; left time: 869.0406s
	iters: 800, epoch: 2 | loss: 0.0204120
	speed: 0.0527s/iter; left time: 862.9570s
	iters: 900, epoch: 2 | loss: 0.0191393
	speed: 0.0527s/iter; left time: 857.5374s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.18s
Steps: 904 | Train Loss: 0.0283085 Vali Loss: 0.0188907 Test Loss: 0.0211461
Validation loss decreased (0.041876 --> 0.018891).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0187438
	speed: 0.1674s/iter; left time: 2707.0198s
	iters: 200, epoch: 3 | loss: 0.0197342
	speed: 0.0533s/iter; left time: 856.1275s
	iters: 300, epoch: 3 | loss: 0.0203294
	speed: 0.0539s/iter; left time: 860.3920s
	iters: 400, epoch: 3 | loss: 0.0184877
	speed: 0.0527s/iter; left time: 837.2661s
	iters: 500, epoch: 3 | loss: 0.0159188
	speed: 0.0532s/iter; left time: 838.7748s
	iters: 600, epoch: 3 | loss: 0.0180105
	speed: 0.0529s/iter; left time: 828.9039s
	iters: 700, epoch: 3 | loss: 0.0156782
	speed: 0.0528s/iter; left time: 822.8708s
	iters: 800, epoch: 3 | loss: 0.0193025
	speed: 0.0529s/iter; left time: 819.1714s
	iters: 900, epoch: 3 | loss: 0.0151986
	speed: 0.0531s/iter; left time: 815.8522s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.80s
Steps: 904 | Train Loss: 0.0183987 Vali Loss: 0.0166293 Test Loss: 0.0188253
Validation loss decreased (0.018891 --> 0.016629).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0159682
	speed: 0.1674s/iter; left time: 2555.8749s
	iters: 200, epoch: 4 | loss: 0.0178815
	speed: 0.0534s/iter; left time: 809.7267s
	iters: 300, epoch: 4 | loss: 0.0170291
	speed: 0.0533s/iter; left time: 803.3239s
	iters: 400, epoch: 4 | loss: 0.0162365
	speed: 0.0556s/iter; left time: 832.3580s
	iters: 500, epoch: 4 | loss: 0.0143917
	speed: 0.0540s/iter; left time: 803.4717s
	iters: 600, epoch: 4 | loss: 0.0142564
	speed: 0.0529s/iter; left time: 781.9514s
	iters: 700, epoch: 4 | loss: 0.0178271
	speed: 0.0532s/iter; left time: 780.2451s
	iters: 800, epoch: 4 | loss: 0.0143080
	speed: 0.0539s/iter; left time: 785.2239s
	iters: 900, epoch: 4 | loss: 0.0154388
	speed: 0.0535s/iter; left time: 773.4466s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:49.19s
Steps: 904 | Train Loss: 0.0166150 Vali Loss: 0.0166704 Test Loss: 0.0182467
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0165838
	speed: 0.1648s/iter; left time: 2367.6710s
	iters: 200, epoch: 5 | loss: 0.0141575
	speed: 0.0526s/iter; left time: 750.2102s
	iters: 300, epoch: 5 | loss: 0.0159495
	speed: 0.0533s/iter; left time: 755.4581s
	iters: 400, epoch: 5 | loss: 0.0164002
	speed: 0.0533s/iter; left time: 748.9939s
	iters: 500, epoch: 5 | loss: 0.0142062
	speed: 0.0531s/iter; left time: 741.9294s
	iters: 600, epoch: 5 | loss: 0.0154078
	speed: 0.0539s/iter; left time: 747.3516s
	iters: 700, epoch: 5 | loss: 0.0143207
	speed: 0.0532s/iter; left time: 732.2056s
	iters: 800, epoch: 5 | loss: 0.0149392
	speed: 0.0531s/iter; left time: 725.5975s
	iters: 900, epoch: 5 | loss: 0.0159033
	speed: 0.0530s/iter; left time: 718.8426s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:49.00s
Steps: 904 | Train Loss: 0.0152258 Vali Loss: 0.0165378 Test Loss: 0.0194802
Validation loss decreased (0.016629 --> 0.016538).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0166436
	speed: 0.1697s/iter; left time: 2284.4207s
	iters: 200, epoch: 6 | loss: 0.0146428
	speed: 0.0544s/iter; left time: 726.9341s
	iters: 300, epoch: 6 | loss: 0.0157662
	speed: 0.0543s/iter; left time: 719.9059s
	iters: 400, epoch: 6 | loss: 0.0138133
	speed: 0.0535s/iter; left time: 704.2182s
	iters: 500, epoch: 6 | loss: 0.0142254
	speed: 0.0536s/iter; left time: 700.0674s
	iters: 600, epoch: 6 | loss: 0.0132052
	speed: 0.0535s/iter; left time: 693.3678s
	iters: 700, epoch: 6 | loss: 0.0143211
	speed: 0.0534s/iter; left time: 686.8834s
	iters: 800, epoch: 6 | loss: 0.0126709
	speed: 0.0529s/iter; left time: 674.8693s
	iters: 900, epoch: 6 | loss: 0.0125704
	speed: 0.0532s/iter; left time: 673.0247s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:49.30s
Steps: 904 | Train Loss: 0.0140307 Vali Loss: 0.0180145 Test Loss: 0.0204602
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0126386
	speed: 0.1683s/iter; left time: 2113.4941s
	iters: 200, epoch: 7 | loss: 0.0133538
	speed: 0.0540s/iter; left time: 672.5232s
	iters: 300, epoch: 7 | loss: 0.0133844
	speed: 0.0546s/iter; left time: 675.1542s
	iters: 400, epoch: 7 | loss: 0.0124519
	speed: 0.0547s/iter; left time: 670.7335s
	iters: 500, epoch: 7 | loss: 0.0129995
	speed: 0.0521s/iter; left time: 633.1811s
	iters: 600, epoch: 7 | loss: 0.0107722
	speed: 0.0464s/iter; left time: 559.8365s
	iters: 700, epoch: 7 | loss: 0.0119335
	speed: 0.0447s/iter; left time: 534.0714s
	iters: 800, epoch: 7 | loss: 0.0103852
	speed: 0.0450s/iter; left time: 533.7265s
	iters: 900, epoch: 7 | loss: 0.0142198
	speed: 0.0447s/iter; left time: 525.4157s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:46.23s
Steps: 904 | Train Loss: 0.0128629 Vali Loss: 0.0177987 Test Loss: 0.0203428
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0135118
	speed: 0.1235s/iter; left time: 1439.4967s
	iters: 200, epoch: 8 | loss: 0.0121883
	speed: 0.0431s/iter; left time: 497.4859s
	iters: 300, epoch: 8 | loss: 0.0131335
	speed: 0.0430s/iter; left time: 492.6867s
	iters: 400, epoch: 8 | loss: 0.0103409
	speed: 0.0430s/iter; left time: 488.4876s
	iters: 500, epoch: 8 | loss: 0.0116575
	speed: 0.0431s/iter; left time: 484.5180s
	iters: 600, epoch: 8 | loss: 0.0120145
	speed: 0.0430s/iter; left time: 479.7410s
	iters: 700, epoch: 8 | loss: 0.0120938
	speed: 0.0431s/iter; left time: 475.8528s
	iters: 800, epoch: 8 | loss: 0.0120940
	speed: 0.0440s/iter; left time: 481.8987s
	iters: 900, epoch: 8 | loss: 0.0107168
	speed: 0.0439s/iter; left time: 476.6432s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:39.48s
Steps: 904 | Train Loss: 0.0118077 Vali Loss: 0.0179464 Test Loss: 0.0215799
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0109323
	speed: 0.1226s/iter; left time: 1317.6650s
	iters: 200, epoch: 9 | loss: 0.0112944
	speed: 0.0434s/iter; left time: 461.7670s
	iters: 300, epoch: 9 | loss: 0.0106901
	speed: 0.0435s/iter; left time: 458.5771s
	iters: 400, epoch: 9 | loss: 0.0096885
	speed: 0.0433s/iter; left time: 452.8120s
	iters: 500, epoch: 9 | loss: 0.0116936
	speed: 0.0432s/iter; left time: 447.2979s
	iters: 600, epoch: 9 | loss: 0.0094251
	speed: 0.0433s/iter; left time: 443.2965s
	iters: 700, epoch: 9 | loss: 0.0082147
	speed: 0.0432s/iter; left time: 438.8344s
	iters: 800, epoch: 9 | loss: 0.0106462
	speed: 0.0433s/iter; left time: 435.0709s
	iters: 900, epoch: 9 | loss: 0.0098766
	speed: 0.0434s/iter; left time: 431.8735s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:39.53s
Steps: 904 | Train Loss: 0.0107340 Vali Loss: 0.0186820 Test Loss: 0.0224837
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0115943
	speed: 0.1215s/iter; left time: 1196.5460s
	iters: 200, epoch: 10 | loss: 0.0096779
	speed: 0.0431s/iter; left time: 420.3857s
	iters: 300, epoch: 10 | loss: 0.0088626
	speed: 0.0432s/iter; left time: 416.3585s
	iters: 400, epoch: 10 | loss: 0.0084990
	speed: 0.0433s/iter; left time: 412.8813s
	iters: 500, epoch: 10 | loss: 0.0103513
	speed: 0.0432s/iter; left time: 408.2939s
	iters: 600, epoch: 10 | loss: 0.0088736
	speed: 0.0429s/iter; left time: 400.8461s
	iters: 700, epoch: 10 | loss: 0.0096829
	speed: 0.0424s/iter; left time: 391.7970s
	iters: 800, epoch: 10 | loss: 0.0093004
	speed: 0.0422s/iter; left time: 386.0505s
	iters: 900, epoch: 10 | loss: 0.0105206
	speed: 0.0420s/iter; left time: 380.1751s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:39.07s
Steps: 904 | Train Loss: 0.0097450 Vali Loss: 0.0187195 Test Loss: 0.0226919
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019469980150461197, rmse:0.1395348757505417, mae:0.0925842821598053, rse:0.5275964140892029
Original data scale mse:4252090.5, rmse:2062.059814453125, mae:1342.6978759765625, rse:0.14511555433273315
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1188145
	speed: 0.0447s/iter; left time: 804.3235s
	iters: 200, epoch: 1 | loss: 0.0895602
	speed: 0.0419s/iter; left time: 749.0011s
	iters: 300, epoch: 1 | loss: 0.0841904
	speed: 0.0418s/iter; left time: 743.0178s
	iters: 400, epoch: 1 | loss: 0.0788894
	speed: 0.0418s/iter; left time: 739.1143s
	iters: 500, epoch: 1 | loss: 0.0712075
	speed: 0.0418s/iter; left time: 735.0515s
	iters: 600, epoch: 1 | loss: 0.0662194
	speed: 0.0418s/iter; left time: 730.4560s
	iters: 700, epoch: 1 | loss: 0.0625979
	speed: 0.0418s/iter; left time: 726.6581s
	iters: 800, epoch: 1 | loss: 0.0646832
	speed: 0.0418s/iter; left time: 721.6061s
	iters: 900, epoch: 1 | loss: 0.0580059
	speed: 0.0418s/iter; left time: 717.5734s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.14s
Steps: 904 | Train Loss: 0.0848243 Vali Loss: 0.0437767 Test Loss: 0.0507185
Validation loss decreased (inf --> 0.043777).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0419231
	speed: 0.1185s/iter; left time: 2022.8678s
	iters: 200, epoch: 2 | loss: 0.0348182
	speed: 0.0418s/iter; left time: 709.6629s
	iters: 300, epoch: 2 | loss: 0.0337430
	speed: 0.0418s/iter; left time: 704.6591s
	iters: 400, epoch: 2 | loss: 0.0276726
	speed: 0.0418s/iter; left time: 700.9713s
	iters: 500, epoch: 2 | loss: 0.0261824
	speed: 0.0418s/iter; left time: 696.3883s
	iters: 600, epoch: 2 | loss: 0.0223262
	speed: 0.0417s/iter; left time: 691.9626s
	iters: 700, epoch: 2 | loss: 0.0221144
	speed: 0.0417s/iter; left time: 687.3417s
	iters: 800, epoch: 2 | loss: 0.0235434
	speed: 0.0417s/iter; left time: 683.5103s
	iters: 900, epoch: 2 | loss: 0.0199030
	speed: 0.0417s/iter; left time: 679.2975s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.06s
Steps: 904 | Train Loss: 0.0300192 Vali Loss: 0.0186070 Test Loss: 0.0201987
Validation loss decreased (0.043777 --> 0.018607).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0220435
	speed: 0.1204s/iter; left time: 1946.8453s
	iters: 200, epoch: 3 | loss: 0.0185804
	speed: 0.0416s/iter; left time: 668.5496s
	iters: 300, epoch: 3 | loss: 0.0224635
	speed: 0.0416s/iter; left time: 665.1535s
	iters: 400, epoch: 3 | loss: 0.0182236
	speed: 0.0416s/iter; left time: 660.3865s
	iters: 500, epoch: 3 | loss: 0.0184334
	speed: 0.0416s/iter; left time: 656.7100s
	iters: 600, epoch: 3 | loss: 0.0173897
	speed: 0.0416s/iter; left time: 652.5666s
	iters: 700, epoch: 3 | loss: 0.0187687
	speed: 0.0416s/iter; left time: 648.0779s
	iters: 800, epoch: 3 | loss: 0.0163097
	speed: 0.0416s/iter; left time: 643.3917s
	iters: 900, epoch: 3 | loss: 0.0201210
	speed: 0.0416s/iter; left time: 639.3407s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.91s
Steps: 904 | Train Loss: 0.0187056 Vali Loss: 0.0173176 Test Loss: 0.0189823
Validation loss decreased (0.018607 --> 0.017318).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0144917
	speed: 0.1180s/iter; left time: 1801.6745s
	iters: 200, epoch: 4 | loss: 0.0155436
	speed: 0.0415s/iter; left time: 630.2428s
	iters: 300, epoch: 4 | loss: 0.0161402
	speed: 0.0415s/iter; left time: 626.0061s
	iters: 400, epoch: 4 | loss: 0.0169928
	speed: 0.0415s/iter; left time: 621.7141s
	iters: 500, epoch: 4 | loss: 0.0170970
	speed: 0.0416s/iter; left time: 618.2207s
	iters: 600, epoch: 4 | loss: 0.0154074
	speed: 0.0415s/iter; left time: 613.6160s
	iters: 700, epoch: 4 | loss: 0.0159156
	speed: 0.0416s/iter; left time: 609.6295s
	iters: 800, epoch: 4 | loss: 0.0133574
	speed: 0.0416s/iter; left time: 605.4293s
	iters: 900, epoch: 4 | loss: 0.0152945
	speed: 0.0416s/iter; left time: 601.7694s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.86s
Steps: 904 | Train Loss: 0.0167078 Vali Loss: 0.0166588 Test Loss: 0.0186600
Validation loss decreased (0.017318 --> 0.016659).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0153981
	speed: 0.1183s/iter; left time: 1699.1464s
	iters: 200, epoch: 5 | loss: 0.0178646
	speed: 0.0415s/iter; left time: 592.6832s
	iters: 300, epoch: 5 | loss: 0.0161108
	speed: 0.0416s/iter; left time: 588.6116s
	iters: 400, epoch: 5 | loss: 0.0161433
	speed: 0.0416s/iter; left time: 585.3525s
	iters: 500, epoch: 5 | loss: 0.0140053
	speed: 0.0416s/iter; left time: 580.6463s
	iters: 600, epoch: 5 | loss: 0.0154303
	speed: 0.0416s/iter; left time: 576.9176s
	iters: 700, epoch: 5 | loss: 0.0164928
	speed: 0.0416s/iter; left time: 572.4771s
	iters: 800, epoch: 5 | loss: 0.0140502
	speed: 0.0416s/iter; left time: 568.0646s
	iters: 900, epoch: 5 | loss: 0.0171279
	speed: 0.0416s/iter; left time: 564.4707s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.89s
Steps: 904 | Train Loss: 0.0154135 Vali Loss: 0.0172233 Test Loss: 0.0202088
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0115788
	speed: 0.1155s/iter; left time: 1555.1758s
	iters: 200, epoch: 6 | loss: 0.0148507
	speed: 0.0416s/iter; left time: 555.7257s
	iters: 300, epoch: 6 | loss: 0.0161882
	speed: 0.0416s/iter; left time: 551.6425s
	iters: 400, epoch: 6 | loss: 0.0178210
	speed: 0.0416s/iter; left time: 546.9586s
	iters: 500, epoch: 6 | loss: 0.0141026
	speed: 0.0416s/iter; left time: 542.7646s
	iters: 600, epoch: 6 | loss: 0.0153834
	speed: 0.0415s/iter; left time: 538.4952s
	iters: 700, epoch: 6 | loss: 0.0159608
	speed: 0.0415s/iter; left time: 534.1593s
	iters: 800, epoch: 6 | loss: 0.0149545
	speed: 0.0416s/iter; left time: 530.5532s
	iters: 900, epoch: 6 | loss: 0.0159737
	speed: 0.0416s/iter; left time: 526.8273s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.90s
Steps: 904 | Train Loss: 0.0141988 Vali Loss: 0.0176414 Test Loss: 0.0199413
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0107467
	speed: 0.1155s/iter; left time: 1450.3939s
	iters: 200, epoch: 7 | loss: 0.0162226
	speed: 0.0417s/iter; left time: 518.9944s
	iters: 300, epoch: 7 | loss: 0.0132818
	speed: 0.0416s/iter; left time: 514.4507s
	iters: 400, epoch: 7 | loss: 0.0117365
	speed: 0.0416s/iter; left time: 509.7889s
	iters: 500, epoch: 7 | loss: 0.0134289
	speed: 0.0416s/iter; left time: 505.7472s
	iters: 600, epoch: 7 | loss: 0.0136149
	speed: 0.0416s/iter; left time: 501.9396s
	iters: 700, epoch: 7 | loss: 0.0113703
	speed: 0.0416s/iter; left time: 497.6530s
	iters: 800, epoch: 7 | loss: 0.0135708
	speed: 0.0417s/iter; left time: 494.2570s
	iters: 900, epoch: 7 | loss: 0.0130386
	speed: 0.0416s/iter; left time: 489.5120s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.93s
Steps: 904 | Train Loss: 0.0132573 Vali Loss: 0.0190168 Test Loss: 0.0217226
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0109275
	speed: 0.1148s/iter; left time: 1337.9031s
	iters: 200, epoch: 8 | loss: 0.0107192
	speed: 0.0416s/iter; left time: 481.0936s
	iters: 300, epoch: 8 | loss: 0.0152382
	speed: 0.0416s/iter; left time: 476.9342s
	iters: 400, epoch: 8 | loss: 0.0101954
	speed: 0.0416s/iter; left time: 472.7591s
	iters: 500, epoch: 8 | loss: 0.0121182
	speed: 0.0417s/iter; left time: 469.0132s
	iters: 600, epoch: 8 | loss: 0.0124160
	speed: 0.0417s/iter; left time: 465.0637s
	iters: 700, epoch: 8 | loss: 0.0121680
	speed: 0.0417s/iter; left time: 460.6849s
	iters: 800, epoch: 8 | loss: 0.0120201
	speed: 0.0417s/iter; left time: 456.8240s
	iters: 900, epoch: 8 | loss: 0.0105643
	speed: 0.0417s/iter; left time: 452.4506s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.94s
Steps: 904 | Train Loss: 0.0120862 Vali Loss: 0.0178637 Test Loss: 0.0204340
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0107147
	speed: 0.1151s/iter; left time: 1236.8307s
	iters: 200, epoch: 9 | loss: 0.0107479
	speed: 0.0417s/iter; left time: 444.0111s
	iters: 300, epoch: 9 | loss: 0.0091522
	speed: 0.0417s/iter; left time: 439.7855s
	iters: 400, epoch: 9 | loss: 0.0114802
	speed: 0.0417s/iter; left time: 435.5504s
	iters: 500, epoch: 9 | loss: 0.0108412
	speed: 0.0417s/iter; left time: 431.8752s
	iters: 600, epoch: 9 | loss: 0.0123784
	speed: 0.0416s/iter; left time: 426.5394s
	iters: 700, epoch: 9 | loss: 0.0099401
	speed: 0.0416s/iter; left time: 422.1139s
	iters: 800, epoch: 9 | loss: 0.0091135
	speed: 0.0415s/iter; left time: 417.1378s
	iters: 900, epoch: 9 | loss: 0.0097398
	speed: 0.0415s/iter; left time: 413.0207s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.94s
Steps: 904 | Train Loss: 0.0110619 Vali Loss: 0.0181419 Test Loss: 0.0215314
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.01865767501294613, rmse:0.13659310340881348, mae:0.09037815779447556, rse:0.5164732336997986
Original data scale mse:3400539.25, rmse:1844.0550537109375, mae:1237.254150390625, rse:0.12977369129657745

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.019469980150461197, RMSE: 0.1395348757505417, MAE: 0.0925842821598053, RSE: 0.5275964140892029
Unscaled Metrics - MSE: 4252090.5, RMSE: 2062.059814453125, MAE: 1342.6978759765625, RSE: 0.14511555433273315

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.01865767501294613, RMSE: 0.13659310340881348, MAE: 0.09037815779447556, RSE: 0.5164732336997986
Unscaled Metrics - MSE: 3400539.25, RMSE: 1844.0550537109375, MAE: 1237.254150390625, RSE: 0.12977369129657745

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1085400
	speed: 0.0697s/iter; left time: 1250.9350s
	iters: 200, epoch: 1 | loss: 0.0816883
	speed: 0.0505s/iter; left time: 900.3890s
	iters: 300, epoch: 1 | loss: 0.0842634
	speed: 0.0504s/iter; left time: 894.5641s
	iters: 400, epoch: 1 | loss: 0.0737756
	speed: 0.0504s/iter; left time: 889.7256s
	iters: 500, epoch: 1 | loss: 0.0733426
	speed: 0.0505s/iter; left time: 885.9905s
	iters: 600, epoch: 1 | loss: 0.0697691
	speed: 0.0504s/iter; left time: 879.2263s
	iters: 700, epoch: 1 | loss: 0.0659135
	speed: 0.0504s/iter; left time: 874.5820s
	iters: 800, epoch: 1 | loss: 0.0656875
	speed: 0.0505s/iter; left time: 870.3694s
	iters: 900, epoch: 1 | loss: 0.0628677
	speed: 0.0504s/iter; left time: 863.4964s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.16s
Steps: 902 | Train Loss: 0.0788118 Vali Loss: 0.0499987 Test Loss: 0.0585373
Validation loss decreased (inf --> 0.049999).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0473542
	speed: 0.1406s/iter; left time: 2394.9686s
	iters: 200, epoch: 2 | loss: 0.0424444
	speed: 0.0504s/iter; left time: 853.5207s
	iters: 300, epoch: 2 | loss: 0.0378179
	speed: 0.0504s/iter; left time: 848.7462s
	iters: 400, epoch: 2 | loss: 0.0354004
	speed: 0.0504s/iter; left time: 843.7869s
	iters: 500, epoch: 2 | loss: 0.0290515
	speed: 0.0504s/iter; left time: 838.6282s
	iters: 600, epoch: 2 | loss: 0.0255628
	speed: 0.0504s/iter; left time: 833.8755s
	iters: 700, epoch: 2 | loss: 0.0224540
	speed: 0.0504s/iter; left time: 828.5267s
	iters: 800, epoch: 2 | loss: 0.0219169
	speed: 0.0506s/iter; left time: 826.2668s
	iters: 900, epoch: 2 | loss: 0.0214847
	speed: 0.0505s/iter; left time: 819.4119s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:45.79s
Steps: 902 | Train Loss: 0.0335635 Vali Loss: 0.0189745 Test Loss: 0.0212966
Validation loss decreased (0.049999 --> 0.018974).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0235515
	speed: 0.1402s/iter; left time: 2262.3782s
	iters: 200, epoch: 3 | loss: 0.0204115
	speed: 0.0503s/iter; left time: 807.2532s
	iters: 300, epoch: 3 | loss: 0.0205418
	speed: 0.0504s/iter; left time: 803.0996s
	iters: 400, epoch: 3 | loss: 0.0176324
	speed: 0.0505s/iter; left time: 799.1270s
	iters: 500, epoch: 3 | loss: 0.0200714
	speed: 0.0505s/iter; left time: 794.1898s
	iters: 600, epoch: 3 | loss: 0.0202698
	speed: 0.0505s/iter; left time: 789.4579s
	iters: 700, epoch: 3 | loss: 0.0186561
	speed: 0.0505s/iter; left time: 784.2378s
	iters: 800, epoch: 3 | loss: 0.0182578
	speed: 0.0504s/iter; left time: 778.3410s
	iters: 900, epoch: 3 | loss: 0.0199967
	speed: 0.0504s/iter; left time: 772.8519s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:45.78s
Steps: 902 | Train Loss: 0.0200834 Vali Loss: 0.0190667 Test Loss: 0.0209968
EarlyStopping counter: 1 out of 5
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0193595
	speed: 0.1366s/iter; left time: 2081.0988s
	iters: 200, epoch: 4 | loss: 0.0170491
	speed: 0.0503s/iter; left time: 761.4699s
	iters: 300, epoch: 4 | loss: 0.0187636
	speed: 0.0504s/iter; left time: 757.7046s
	iters: 400, epoch: 4 | loss: 0.0182095
	speed: 0.0504s/iter; left time: 752.4597s
	iters: 500, epoch: 4 | loss: 0.0184221
	speed: 0.0503s/iter; left time: 746.7746s
	iters: 600, epoch: 4 | loss: 0.0173221
	speed: 0.0504s/iter; left time: 742.7025s
	iters: 700, epoch: 4 | loss: 0.0179912
	speed: 0.0504s/iter; left time: 737.2832s
	iters: 800, epoch: 4 | loss: 0.0189602
	speed: 0.0504s/iter; left time: 732.3357s
	iters: 900, epoch: 4 | loss: 0.0181465
	speed: 0.0504s/iter; left time: 727.2644s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.65s
Steps: 902 | Train Loss: 0.0183140 Vali Loss: 0.0184400 Test Loss: 0.0211830
Validation loss decreased (0.018974 --> 0.018440).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0170493
	speed: 0.1398s/iter; left time: 2003.7152s
	iters: 200, epoch: 5 | loss: 0.0163401
	speed: 0.0504s/iter; left time: 716.6871s
	iters: 300, epoch: 5 | loss: 0.0172979
	speed: 0.0504s/iter; left time: 712.2541s
	iters: 400, epoch: 5 | loss: 0.0170552
	speed: 0.0505s/iter; left time: 708.7722s
	iters: 500, epoch: 5 | loss: 0.0159546
	speed: 0.0505s/iter; left time: 703.1248s
	iters: 600, epoch: 5 | loss: 0.0179998
	speed: 0.0505s/iter; left time: 698.4075s
	iters: 700, epoch: 5 | loss: 0.0170143
	speed: 0.0503s/iter; left time: 691.3856s
	iters: 800, epoch: 5 | loss: 0.0153025
	speed: 0.0504s/iter; left time: 686.9005s
	iters: 900, epoch: 5 | loss: 0.0177909
	speed: 0.0504s/iter; left time: 681.8678s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:45.75s
Steps: 902 | Train Loss: 0.0167801 Vali Loss: 0.0190931 Test Loss: 0.0210882
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0168719
	speed: 0.1371s/iter; left time: 1840.8245s
	iters: 200, epoch: 6 | loss: 0.0183581
	speed: 0.0504s/iter; left time: 671.8229s
	iters: 300, epoch: 6 | loss: 0.0161392
	speed: 0.0504s/iter; left time: 666.4302s
	iters: 400, epoch: 6 | loss: 0.0146639
	speed: 0.0505s/iter; left time: 662.8648s
	iters: 500, epoch: 6 | loss: 0.0147155
	speed: 0.0504s/iter; left time: 656.6532s
	iters: 600, epoch: 6 | loss: 0.0146213
	speed: 0.0504s/iter; left time: 651.1786s
	iters: 700, epoch: 6 | loss: 0.0153003
	speed: 0.0505s/iter; left time: 647.9012s
	iters: 800, epoch: 6 | loss: 0.0174402
	speed: 0.0505s/iter; left time: 642.3031s
	iters: 900, epoch: 6 | loss: 0.0154924
	speed: 0.0504s/iter; left time: 636.3953s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.77s
Steps: 902 | Train Loss: 0.0152655 Vali Loss: 0.0186443 Test Loss: 0.0209225
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0171572
	speed: 0.1380s/iter; left time: 1729.2695s
	iters: 200, epoch: 7 | loss: 0.0150322
	speed: 0.0504s/iter; left time: 626.3312s
	iters: 300, epoch: 7 | loss: 0.0145275
	speed: 0.0504s/iter; left time: 621.1622s
	iters: 400, epoch: 7 | loss: 0.0152736
	speed: 0.0504s/iter; left time: 616.4084s
	iters: 500, epoch: 7 | loss: 0.0124688
	speed: 0.0504s/iter; left time: 611.6776s
	iters: 600, epoch: 7 | loss: 0.0142438
	speed: 0.0505s/iter; left time: 607.5710s
	iters: 700, epoch: 7 | loss: 0.0118809
	speed: 0.0505s/iter; left time: 602.1007s
	iters: 800, epoch: 7 | loss: 0.0129951
	speed: 0.0506s/iter; left time: 597.9871s
	iters: 900, epoch: 7 | loss: 0.0129787
	speed: 0.0504s/iter; left time: 591.1747s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:45.79s
Steps: 902 | Train Loss: 0.0139308 Vali Loss: 0.0198808 Test Loss: 0.0221280
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0132050
	speed: 0.1375s/iter; left time: 1598.8070s
	iters: 200, epoch: 8 | loss: 0.0124671
	speed: 0.0504s/iter; left time: 580.5713s
	iters: 300, epoch: 8 | loss: 0.0145717
	speed: 0.0504s/iter; left time: 576.0552s
	iters: 400, epoch: 8 | loss: 0.0130775
	speed: 0.0504s/iter; left time: 570.8247s
	iters: 500, epoch: 8 | loss: 0.0132061
	speed: 0.0504s/iter; left time: 565.6927s
	iters: 600, epoch: 8 | loss: 0.0130485
	speed: 0.0504s/iter; left time: 561.2924s
	iters: 700, epoch: 8 | loss: 0.0142619
	speed: 0.0503s/iter; left time: 555.0997s
	iters: 800, epoch: 8 | loss: 0.0127802
	speed: 0.0505s/iter; left time: 551.5882s
	iters: 900, epoch: 8 | loss: 0.0116429
	speed: 0.0504s/iter; left time: 546.1321s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:45.73s
Steps: 902 | Train Loss: 0.0126203 Vali Loss: 0.0205238 Test Loss: 0.0220269
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0107108
	speed: 0.1369s/iter; left time: 1467.8649s
	iters: 200, epoch: 9 | loss: 0.0120930
	speed: 0.0504s/iter; left time: 535.5691s
	iters: 300, epoch: 9 | loss: 0.0129282
	speed: 0.0504s/iter; left time: 530.5359s
	iters: 400, epoch: 9 | loss: 0.0113463
	speed: 0.0504s/iter; left time: 525.4851s
	iters: 500, epoch: 9 | loss: 0.0122018
	speed: 0.0504s/iter; left time: 520.4735s
	iters: 600, epoch: 9 | loss: 0.0119361
	speed: 0.0504s/iter; left time: 515.1971s
	iters: 700, epoch: 9 | loss: 0.0110174
	speed: 0.0504s/iter; left time: 510.7152s
	iters: 800, epoch: 9 | loss: 0.0113841
	speed: 0.0505s/iter; left time: 506.5025s
	iters: 900, epoch: 9 | loss: 0.0112757
	speed: 0.0505s/iter; left time: 501.3016s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:45.76s
Steps: 902 | Train Loss: 0.0114438 Vali Loss: 0.0220248 Test Loss: 0.0233626
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.021184653043746948, rmse:0.1455494910478592, mae:0.09746020287275314, rse:0.5507185459136963
Original data scale mse:4480882.5, rmse:2116.8095703125, mae:1392.976318359375, rse:0.149108424782753
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1019148
	speed: 0.0526s/iter; left time: 944.3682s
	iters: 200, epoch: 1 | loss: 0.0971051
	speed: 0.0504s/iter; left time: 898.3083s
	iters: 300, epoch: 1 | loss: 0.0842349
	speed: 0.0504s/iter; left time: 894.0588s
	iters: 400, epoch: 1 | loss: 0.0804336
	speed: 0.0504s/iter; left time: 889.5991s
	iters: 500, epoch: 1 | loss: 0.0757676
	speed: 0.0504s/iter; left time: 883.8320s
	iters: 600, epoch: 1 | loss: 0.0732939
	speed: 0.0504s/iter; left time: 878.8875s
	iters: 700, epoch: 1 | loss: 0.0695650
	speed: 0.0504s/iter; left time: 874.3043s
	iters: 800, epoch: 1 | loss: 0.0631033
	speed: 0.0504s/iter; left time: 869.1836s
	iters: 900, epoch: 1 | loss: 0.0608767
	speed: 0.0504s/iter; left time: 864.1493s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:45.75s
Steps: 902 | Train Loss: 0.0810947 Vali Loss: 0.0496574 Test Loss: 0.0587924
Validation loss decreased (inf --> 0.049657).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0457406
	speed: 0.1415s/iter; left time: 2411.4615s
	iters: 200, epoch: 2 | loss: 0.0414700
	speed: 0.0504s/iter; left time: 853.9498s
	iters: 300, epoch: 2 | loss: 0.0416473
	speed: 0.0504s/iter; left time: 848.6696s
	iters: 400, epoch: 2 | loss: 0.0360631
	speed: 0.0504s/iter; left time: 843.8794s
	iters: 500, epoch: 2 | loss: 0.0260347
	speed: 0.0504s/iter; left time: 839.3970s
	iters: 600, epoch: 2 | loss: 0.0260261
	speed: 0.0504s/iter; left time: 833.9215s
	iters: 700, epoch: 2 | loss: 0.0235522
	speed: 0.0505s/iter; left time: 829.4308s
	iters: 800, epoch: 2 | loss: 0.0238006
	speed: 0.0504s/iter; left time: 823.1763s
	iters: 900, epoch: 2 | loss: 0.0225498
	speed: 0.0504s/iter; left time: 818.6855s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:45.79s
Steps: 902 | Train Loss: 0.0333600 Vali Loss: 0.0196942 Test Loss: 0.0227760
Validation loss decreased (0.049657 --> 0.019694).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0205507
	speed: 0.1442s/iter; left time: 2326.5165s
	iters: 200, epoch: 3 | loss: 0.0212225
	speed: 0.0505s/iter; left time: 809.6008s
	iters: 300, epoch: 3 | loss: 0.0184537
	speed: 0.0505s/iter; left time: 804.5555s
	iters: 400, epoch: 3 | loss: 0.0189279
	speed: 0.0504s/iter; left time: 798.2155s
	iters: 500, epoch: 3 | loss: 0.0200594
	speed: 0.0504s/iter; left time: 793.7653s
	iters: 600, epoch: 3 | loss: 0.0195526
	speed: 0.0504s/iter; left time: 788.6567s
	iters: 700, epoch: 3 | loss: 0.0186151
	speed: 0.0504s/iter; left time: 783.8307s
	iters: 800, epoch: 3 | loss: 0.0191913
	speed: 0.0504s/iter; left time: 778.1420s
	iters: 900, epoch: 3 | loss: 0.0220613
	speed: 0.0504s/iter; left time: 773.3089s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:45.80s
Steps: 902 | Train Loss: 0.0201075 Vali Loss: 0.0190689 Test Loss: 0.0200431
Validation loss decreased (0.019694 --> 0.019069).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0171240
	speed: 0.1422s/iter; left time: 2166.5491s
	iters: 200, epoch: 4 | loss: 0.0206921
	speed: 0.0504s/iter; left time: 762.9619s
	iters: 300, epoch: 4 | loss: 0.0182534
	speed: 0.0520s/iter; left time: 782.1456s
	iters: 400, epoch: 4 | loss: 0.0190155
	speed: 0.0723s/iter; left time: 1080.1645s
	iters: 500, epoch: 4 | loss: 0.0201484
	speed: 0.0667s/iter; left time: 989.8799s
	iters: 600, epoch: 4 | loss: 0.0165982
	speed: 0.0785s/iter; left time: 1157.0690s
	iters: 700, epoch: 4 | loss: 0.0193496
	speed: 0.0804s/iter; left time: 1176.0266s
	iters: 800, epoch: 4 | loss: 0.0172085
	speed: 0.0844s/iter; left time: 1226.0731s
	iters: 900, epoch: 4 | loss: 0.0173498
	speed: 0.0813s/iter; left time: 1173.2556s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:02.13s
Steps: 902 | Train Loss: 0.0183315 Vali Loss: 0.0183397 Test Loss: 0.0207560
Validation loss decreased (0.019069 --> 0.018340).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0187501
	speed: 0.2563s/iter; left time: 3673.2631s
	iters: 200, epoch: 5 | loss: 0.0163279
	speed: 0.0880s/iter; left time: 1252.0913s
	iters: 300, epoch: 5 | loss: 0.0170697
	speed: 0.0672s/iter; left time: 949.6596s
	iters: 400, epoch: 5 | loss: 0.0180755
	speed: 0.0547s/iter; left time: 768.2341s
	iters: 500, epoch: 5 | loss: 0.0187004
	speed: 0.0525s/iter; left time: 731.2108s
	iters: 600, epoch: 5 | loss: 0.0161837
	speed: 0.0533s/iter; left time: 736.9585s
	iters: 700, epoch: 5 | loss: 0.0168634
	speed: 0.0529s/iter; left time: 726.9524s
	iters: 800, epoch: 5 | loss: 0.0175499
	speed: 0.0522s/iter; left time: 711.5540s
	iters: 900, epoch: 5 | loss: 0.0164792
	speed: 0.0525s/iter; left time: 710.3112s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:58.06s
Steps: 902 | Train Loss: 0.0167912 Vali Loss: 0.0176525 Test Loss: 0.0205528
Validation loss decreased (0.018340 --> 0.017653).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0158256
	speed: 0.1478s/iter; left time: 1984.7557s
	iters: 200, epoch: 6 | loss: 0.0186154
	speed: 0.0515s/iter; left time: 686.9078s
	iters: 300, epoch: 6 | loss: 0.0142938
	speed: 0.0513s/iter; left time: 678.8094s
	iters: 400, epoch: 6 | loss: 0.0167240
	speed: 0.0518s/iter; left time: 679.6925s
	iters: 500, epoch: 6 | loss: 0.0155176
	speed: 0.0516s/iter; left time: 671.8245s
	iters: 600, epoch: 6 | loss: 0.0151491
	speed: 0.0516s/iter; left time: 666.6773s
	iters: 700, epoch: 6 | loss: 0.0149393
	speed: 0.0512s/iter; left time: 657.1318s
	iters: 800, epoch: 6 | loss: 0.0143527
	speed: 0.0511s/iter; left time: 650.1514s
	iters: 900, epoch: 6 | loss: 0.0146510
	speed: 0.0510s/iter; left time: 644.4751s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.81s
Steps: 902 | Train Loss: 0.0154842 Vali Loss: 0.0188059 Test Loss: 0.0227140
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0130530
	speed: 0.1428s/iter; left time: 1788.8689s
	iters: 200, epoch: 7 | loss: 0.0151590
	speed: 0.0514s/iter; left time: 639.1924s
	iters: 300, epoch: 7 | loss: 0.0141264
	speed: 0.0514s/iter; left time: 634.1811s
	iters: 400, epoch: 7 | loss: 0.0145031
	speed: 0.0510s/iter; left time: 624.1067s
	iters: 500, epoch: 7 | loss: 0.0130284
	speed: 0.0511s/iter; left time: 619.2173s
	iters: 600, epoch: 7 | loss: 0.0141119
	speed: 0.0512s/iter; left time: 615.7427s
	iters: 700, epoch: 7 | loss: 0.0144239
	speed: 0.0512s/iter; left time: 610.2346s
	iters: 800, epoch: 7 | loss: 0.0143639
	speed: 0.0513s/iter; left time: 606.3581s
	iters: 900, epoch: 7 | loss: 0.0123217
	speed: 0.0508s/iter; left time: 595.9450s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:46.53s
Steps: 902 | Train Loss: 0.0142994 Vali Loss: 0.0195513 Test Loss: 0.0221172
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0138762
	speed: 0.1443s/iter; left time: 1677.3878s
	iters: 200, epoch: 8 | loss: 0.0138030
	speed: 0.0512s/iter; left time: 589.6166s
	iters: 300, epoch: 8 | loss: 0.0154013
	speed: 0.0511s/iter; left time: 583.8309s
	iters: 400, epoch: 8 | loss: 0.0137396
	speed: 0.0510s/iter; left time: 577.3447s
	iters: 500, epoch: 8 | loss: 0.0140458
	speed: 0.0510s/iter; left time: 572.0200s
	iters: 600, epoch: 8 | loss: 0.0125235
	speed: 0.0519s/iter; left time: 577.8666s
	iters: 700, epoch: 8 | loss: 0.0122497
	speed: 0.0536s/iter; left time: 590.9076s
	iters: 800, epoch: 8 | loss: 0.0124928
	speed: 0.0950s/iter; left time: 1038.0701s
	iters: 900, epoch: 8 | loss: 0.0133401
	speed: 0.1017s/iter; left time: 1100.6342s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:56.49s
Steps: 902 | Train Loss: 0.0129918 Vali Loss: 0.0208927 Test Loss: 0.0225966
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0125784
	speed: 0.2970s/iter; left time: 3185.8262s
	iters: 200, epoch: 9 | loss: 0.0115299
	speed: 0.0511s/iter; left time: 542.8985s
	iters: 300, epoch: 9 | loss: 0.0138254
	speed: 0.0511s/iter; left time: 537.8576s
	iters: 400, epoch: 9 | loss: 0.0125443
	speed: 0.0510s/iter; left time: 531.5680s
	iters: 500, epoch: 9 | loss: 0.0119621
	speed: 0.0506s/iter; left time: 522.7962s
	iters: 600, epoch: 9 | loss: 0.0108240
	speed: 0.0507s/iter; left time: 517.9832s
	iters: 700, epoch: 9 | loss: 0.0106221
	speed: 0.0507s/iter; left time: 512.8421s
	iters: 800, epoch: 9 | loss: 0.0118533
	speed: 0.0507s/iter; left time: 508.0741s
	iters: 900, epoch: 9 | loss: 0.0114278
	speed: 0.0508s/iter; left time: 504.2767s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:46.44s
Steps: 902 | Train Loss: 0.0117030 Vali Loss: 0.0204482 Test Loss: 0.0228200
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0112076
	speed: 0.1394s/iter; left time: 1369.1657s
	iters: 200, epoch: 10 | loss: 0.0118141
	speed: 0.0509s/iter; left time: 494.5809s
	iters: 300, epoch: 10 | loss: 0.0120569
	speed: 0.0508s/iter; left time: 489.1606s
	iters: 400, epoch: 10 | loss: 0.0113766
	speed: 0.0508s/iter; left time: 483.8873s
	iters: 500, epoch: 10 | loss: 0.0112426
	speed: 0.0508s/iter; left time: 478.5691s
	iters: 600, epoch: 10 | loss: 0.0100483
	speed: 0.0508s/iter; left time: 473.5713s
	iters: 700, epoch: 10 | loss: 0.0111024
	speed: 0.0508s/iter; left time: 468.7846s
	iters: 800, epoch: 10 | loss: 0.0104355
	speed: 0.0508s/iter; left time: 463.6809s
	iters: 900, epoch: 10 | loss: 0.0096493
	speed: 0.0510s/iter; left time: 459.8826s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:46.17s
Steps: 902 | Train Loss: 0.0106408 Vali Loss: 0.0222400 Test Loss: 0.0249648
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.02053854614496231, rmse:0.1433127522468567, mae:0.09565677493810654, rse:0.5422554016113281
Original data scale mse:4692489.5, rmse:2166.215576171875, mae:1400.195068359375, rse:0.1525885909795761

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.021184653043746948, RMSE: 0.1455494910478592, MAE: 0.09746020287275314, RSE: 0.5507185459136963
Unscaled Metrics - MSE: 4480882.5, RMSE: 2116.8095703125, MAE: 1392.976318359375, RSE: 0.149108424782753

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.02053854614496231, RMSE: 0.1433127522468567, MAE: 0.09565677493810654, RSE: 0.5422554016113281
Unscaled Metrics - MSE: 4692489.5, RMSE: 2166.215576171875, MAE: 1400.195068359375, RSE: 0.1525885909795761

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2289756
	speed: 0.0549s/iter; left time: 990.1262s
	iters: 200, epoch: 1 | loss: 0.2147405
	speed: 0.0340s/iter; left time: 610.1203s
	iters: 300, epoch: 1 | loss: 0.2024794
	speed: 0.0342s/iter; left time: 610.2855s
	iters: 400, epoch: 1 | loss: 0.1978398
	speed: 0.0351s/iter; left time: 621.3565s
	iters: 500, epoch: 1 | loss: 0.1838570
	speed: 0.0348s/iter; left time: 613.4514s
	iters: 600, epoch: 1 | loss: 0.1871906
	speed: 0.0347s/iter; left time: 607.1201s
	iters: 700, epoch: 1 | loss: 0.1718587
	speed: 0.0347s/iter; left time: 604.1682s
	iters: 800, epoch: 1 | loss: 0.1741228
	speed: 0.0344s/iter; left time: 595.8422s
	iters: 900, epoch: 1 | loss: 0.1741925
	speed: 0.0341s/iter; left time: 587.2876s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:31.96s
Steps: 906 | Train Loss: 0.1946895 Vali Loss: 0.1531637 Test Loss: 0.1688930
Validation loss decreased (inf --> 0.153164).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1200996
	speed: 0.1076s/iter; left time: 1841.7908s
	iters: 200, epoch: 2 | loss: 0.0943886
	speed: 0.0346s/iter; left time: 588.3090s
	iters: 300, epoch: 2 | loss: 0.0873010
	speed: 0.0346s/iter; left time: 585.6588s
	iters: 400, epoch: 2 | loss: 0.0911078
	speed: 0.0346s/iter; left time: 581.6602s
	iters: 500, epoch: 2 | loss: 0.0900601
	speed: 0.0341s/iter; left time: 570.0030s
	iters: 600, epoch: 2 | loss: 0.0939043
	speed: 0.0341s/iter; left time: 566.5680s
	iters: 700, epoch: 2 | loss: 0.0763428
	speed: 0.0341s/iter; left time: 562.8113s
	iters: 800, epoch: 2 | loss: 0.0738119
	speed: 0.0341s/iter; left time: 559.0866s
	iters: 900, epoch: 2 | loss: 0.0727385
	speed: 0.0341s/iter; left time: 555.6687s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.43s
Steps: 906 | Train Loss: 0.0941843 Vali Loss: 0.0731850 Test Loss: 0.0763463
Validation loss decreased (0.153164 --> 0.073185).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0689264
	speed: 0.0999s/iter; left time: 1618.8934s
	iters: 200, epoch: 3 | loss: 0.0680265
	speed: 0.0341s/iter; left time: 548.6482s
	iters: 300, epoch: 3 | loss: 0.0720875
	speed: 0.0340s/iter; left time: 544.4800s
	iters: 400, epoch: 3 | loss: 0.0637039
	speed: 0.0340s/iter; left time: 540.8900s
	iters: 500, epoch: 3 | loss: 0.0603021
	speed: 0.0340s/iter; left time: 537.8295s
	iters: 600, epoch: 3 | loss: 0.0701781
	speed: 0.0340s/iter; left time: 534.2992s
	iters: 700, epoch: 3 | loss: 0.0690891
	speed: 0.0340s/iter; left time: 531.0566s
	iters: 800, epoch: 3 | loss: 0.0771389
	speed: 0.0340s/iter; left time: 527.3040s
	iters: 900, epoch: 3 | loss: 0.0653842
	speed: 0.0441s/iter; left time: 678.8912s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.16s
Steps: 906 | Train Loss: 0.0697471 Vali Loss: 0.0669245 Test Loss: 0.0713615
Validation loss decreased (0.073185 --> 0.066924).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0727013
	speed: 0.1012s/iter; left time: 1547.9813s
	iters: 200, epoch: 4 | loss: 0.0631000
	speed: 0.0341s/iter; left time: 518.5061s
	iters: 300, epoch: 4 | loss: 0.0641052
	speed: 0.0341s/iter; left time: 514.4442s
	iters: 400, epoch: 4 | loss: 0.0677283
	speed: 0.0340s/iter; left time: 510.3607s
	iters: 500, epoch: 4 | loss: 0.0661093
	speed: 0.0344s/iter; left time: 512.5893s
	iters: 600, epoch: 4 | loss: 0.0596208
	speed: 0.0388s/iter; left time: 574.5589s
	iters: 700, epoch: 4 | loss: 0.0618208
	speed: 0.0497s/iter; left time: 731.1782s
	iters: 800, epoch: 4 | loss: 0.0644566
	speed: 0.0481s/iter; left time: 702.8723s
	iters: 900, epoch: 4 | loss: 0.0667040
	speed: 0.0491s/iter; left time: 712.5401s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.41s
Steps: 906 | Train Loss: 0.0649319 Vali Loss: 0.0651137 Test Loss: 0.0699982
Validation loss decreased (0.066924 --> 0.065114).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0597008
	speed: 0.1615s/iter; left time: 2325.5606s
	iters: 200, epoch: 5 | loss: 0.0717447
	speed: 0.0481s/iter; left time: 687.7577s
	iters: 300, epoch: 5 | loss: 0.0594414
	speed: 0.0486s/iter; left time: 690.6490s
	iters: 400, epoch: 5 | loss: 0.0574381
	speed: 0.0483s/iter; left time: 680.2591s
	iters: 500, epoch: 5 | loss: 0.0629130
	speed: 0.0485s/iter; left time: 679.3439s
	iters: 600, epoch: 5 | loss: 0.0602561
	speed: 0.0493s/iter; left time: 685.4686s
	iters: 700, epoch: 5 | loss: 0.0723139
	speed: 0.0483s/iter; left time: 665.7755s
	iters: 800, epoch: 5 | loss: 0.0493080
	speed: 0.0489s/iter; left time: 670.1410s
	iters: 900, epoch: 5 | loss: 0.0612842
	speed: 0.0509s/iter; left time: 692.5149s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:44.95s
Steps: 906 | Train Loss: 0.0610163 Vali Loss: 0.0614561 Test Loss: 0.0658055
Validation loss decreased (0.065114 --> 0.061456).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0591033
	speed: 0.1620s/iter; left time: 2186.1804s
	iters: 200, epoch: 6 | loss: 0.0583568
	speed: 0.0485s/iter; left time: 649.8758s
	iters: 300, epoch: 6 | loss: 0.0663953
	speed: 0.0485s/iter; left time: 644.4826s
	iters: 400, epoch: 6 | loss: 0.0580835
	speed: 0.0523s/iter; left time: 690.2673s
	iters: 500, epoch: 6 | loss: 0.0495465
	speed: 0.0541s/iter; left time: 707.6604s
	iters: 600, epoch: 6 | loss: 0.0566977
	speed: 0.0499s/iter; left time: 648.8261s
	iters: 700, epoch: 6 | loss: 0.0582300
	speed: 0.0484s/iter; left time: 623.3253s
	iters: 800, epoch: 6 | loss: 0.0565420
	speed: 0.0482s/iter; left time: 616.7458s
	iters: 900, epoch: 6 | loss: 0.0544238
	speed: 0.0482s/iter; left time: 612.1940s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.12s
Steps: 906 | Train Loss: 0.0582357 Vali Loss: 0.0605395 Test Loss: 0.0657733
Validation loss decreased (0.061456 --> 0.060540).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0518394
	speed: 0.1610s/iter; left time: 2025.7553s
	iters: 200, epoch: 7 | loss: 0.0625482
	speed: 0.0481s/iter; left time: 599.9669s
	iters: 300, epoch: 7 | loss: 0.0538388
	speed: 0.0487s/iter; left time: 603.7410s
	iters: 400, epoch: 7 | loss: 0.0608252
	speed: 0.0498s/iter; left time: 611.3335s
	iters: 500, epoch: 7 | loss: 0.0573636
	speed: 0.0492s/iter; left time: 599.0954s
	iters: 600, epoch: 7 | loss: 0.0511362
	speed: 0.0492s/iter; left time: 594.1859s
	iters: 700, epoch: 7 | loss: 0.0534262
	speed: 0.0494s/iter; left time: 591.6290s
	iters: 800, epoch: 7 | loss: 0.0597523
	speed: 0.0491s/iter; left time: 584.0605s
	iters: 900, epoch: 7 | loss: 0.0498654
	speed: 0.0491s/iter; left time: 578.4413s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:45.49s
Steps: 906 | Train Loss: 0.0561592 Vali Loss: 0.0586244 Test Loss: 0.0642837
Validation loss decreased (0.060540 --> 0.058624).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0509520
	speed: 0.1443s/iter; left time: 1685.6265s
	iters: 200, epoch: 8 | loss: 0.0509359
	speed: 0.0492s/iter; left time: 569.2770s
	iters: 300, epoch: 8 | loss: 0.0527956
	speed: 0.0482s/iter; left time: 553.8227s
	iters: 400, epoch: 8 | loss: 0.0565501
	speed: 0.0480s/iter; left time: 546.0127s
	iters: 500, epoch: 8 | loss: 0.0532382
	speed: 0.0478s/iter; left time: 538.9741s
	iters: 600, epoch: 8 | loss: 0.0565472
	speed: 0.0479s/iter; left time: 535.6273s
	iters: 700, epoch: 8 | loss: 0.0503138
	speed: 0.0477s/iter; left time: 528.1958s
	iters: 800, epoch: 8 | loss: 0.0552599
	speed: 0.0473s/iter; left time: 519.7131s
	iters: 900, epoch: 8 | loss: 0.0519355
	speed: 0.0470s/iter; left time: 511.3554s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:44.13s
Steps: 906 | Train Loss: 0.0541787 Vali Loss: 0.0579991 Test Loss: 0.0646259
Validation loss decreased (0.058624 --> 0.057999).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0463596
	speed: 0.1263s/iter; left time: 1360.3871s
	iters: 200, epoch: 9 | loss: 0.0533909
	speed: 0.0379s/iter; left time: 404.8751s
	iters: 300, epoch: 9 | loss: 0.0609420
	speed: 0.0380s/iter; left time: 401.3176s
	iters: 400, epoch: 9 | loss: 0.0476018
	speed: 0.0380s/iter; left time: 397.4870s
	iters: 500, epoch: 9 | loss: 0.0494947
	speed: 0.0380s/iter; left time: 394.1571s
	iters: 600, epoch: 9 | loss: 0.0558363
	speed: 0.0382s/iter; left time: 391.9354s
	iters: 700, epoch: 9 | loss: 0.0526480
	speed: 0.0381s/iter; left time: 387.2590s
	iters: 800, epoch: 9 | loss: 0.0504616
	speed: 0.0379s/iter; left time: 381.6059s
	iters: 900, epoch: 9 | loss: 0.0483640
	speed: 0.0378s/iter; left time: 376.9914s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:35.13s
Steps: 906 | Train Loss: 0.0524793 Vali Loss: 0.0583450 Test Loss: 0.0629489
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0541091
	speed: 0.1094s/iter; left time: 1079.2697s
	iters: 200, epoch: 10 | loss: 0.0536419
	speed: 0.0383s/iter; left time: 374.4389s
	iters: 300, epoch: 10 | loss: 0.0514194
	speed: 0.0373s/iter; left time: 360.9619s
	iters: 400, epoch: 10 | loss: 0.0504203
	speed: 0.0372s/iter; left time: 355.8477s
	iters: 500, epoch: 10 | loss: 0.0432660
	speed: 0.0369s/iter; left time: 349.2516s
	iters: 600, epoch: 10 | loss: 0.0556666
	speed: 0.0369s/iter; left time: 345.6723s
	iters: 700, epoch: 10 | loss: 0.0505122
	speed: 0.0369s/iter; left time: 341.8069s
	iters: 800, epoch: 10 | loss: 0.0518186
	speed: 0.0367s/iter; left time: 336.5103s
	iters: 900, epoch: 10 | loss: 0.0462847
	speed: 0.0367s/iter; left time: 333.1667s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:34.15s
Steps: 906 | Train Loss: 0.0511121 Vali Loss: 0.0566754 Test Loss: 0.0640028
Validation loss decreased (0.057999 --> 0.056675).  Saving model ...
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0522779
	speed: 0.1086s/iter; left time: 972.9886s
	iters: 200, epoch: 11 | loss: 0.0463553
	speed: 0.0365s/iter; left time: 323.3875s
	iters: 300, epoch: 11 | loss: 0.0524409
	speed: 0.0363s/iter; left time: 318.2349s
	iters: 400, epoch: 11 | loss: 0.0493511
	speed: 0.0364s/iter; left time: 314.9420s
	iters: 500, epoch: 11 | loss: 0.0535235
	speed: 0.0365s/iter; left time: 312.1508s
	iters: 600, epoch: 11 | loss: 0.0537348
	speed: 0.0365s/iter; left time: 308.6240s
	iters: 700, epoch: 11 | loss: 0.0487254
	speed: 0.0364s/iter; left time: 304.7200s
	iters: 800, epoch: 11 | loss: 0.0524150
	speed: 0.0365s/iter; left time: 301.2415s
	iters: 900, epoch: 11 | loss: 0.0441130
	speed: 0.0364s/iter; left time: 297.3931s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:33.51s
Steps: 906 | Train Loss: 0.0498137 Vali Loss: 0.0567335 Test Loss: 0.0640843
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0454959
	speed: 0.1039s/iter; left time: 836.9042s
	iters: 200, epoch: 12 | loss: 0.0510769
	speed: 0.0364s/iter; left time: 289.8777s
	iters: 300, epoch: 12 | loss: 0.0456563
	speed: 0.0360s/iter; left time: 283.0406s
	iters: 400, epoch: 12 | loss: 0.0503837
	speed: 0.0360s/iter; left time: 279.2977s
	iters: 500, epoch: 12 | loss: 0.0526142
	speed: 0.0361s/iter; left time: 276.2053s
	iters: 600, epoch: 12 | loss: 0.0477144
	speed: 0.0361s/iter; left time: 272.9732s
	iters: 700, epoch: 12 | loss: 0.0439736
	speed: 0.0361s/iter; left time: 269.4045s
	iters: 800, epoch: 12 | loss: 0.0518971
	speed: 0.0364s/iter; left time: 267.6893s
	iters: 900, epoch: 12 | loss: 0.0473772
	speed: 0.0361s/iter; left time: 261.8315s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:33.21s
Steps: 906 | Train Loss: 0.0486576 Vali Loss: 0.0559295 Test Loss: 0.0642169
Validation loss decreased (0.056675 --> 0.055930).  Saving model ...
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0414750
	speed: 0.1070s/iter; left time: 764.7068s
	iters: 200, epoch: 13 | loss: 0.0494478
	speed: 0.0362s/iter; left time: 255.0997s
	iters: 300, epoch: 13 | loss: 0.0469200
	speed: 0.0362s/iter; left time: 251.7409s
	iters: 400, epoch: 13 | loss: 0.0549754
	speed: 0.0362s/iter; left time: 248.2033s
	iters: 500, epoch: 13 | loss: 0.0429797
	speed: 0.0362s/iter; left time: 244.3588s
	iters: 600, epoch: 13 | loss: 0.0493610
	speed: 0.0363s/iter; left time: 241.1040s
	iters: 700, epoch: 13 | loss: 0.0470018
	speed: 0.0363s/iter; left time: 237.6180s
	iters: 800, epoch: 13 | loss: 0.0505446
	speed: 0.0364s/iter; left time: 234.5015s
	iters: 900, epoch: 13 | loss: 0.0527018
	speed: 0.0364s/iter; left time: 231.1573s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:33.26s
Steps: 906 | Train Loss: 0.0474767 Vali Loss: 0.0565293 Test Loss: 0.0645984
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0478024
	speed: 0.1037s/iter; left time: 647.4428s
	iters: 200, epoch: 14 | loss: 0.0465574
	speed: 0.0363s/iter; left time: 223.0201s
	iters: 300, epoch: 14 | loss: 0.0409424
	speed: 0.0369s/iter; left time: 222.8736s
	iters: 400, epoch: 14 | loss: 0.0393596
	speed: 0.0367s/iter; left time: 218.1721s
	iters: 500, epoch: 14 | loss: 0.0479720
	speed: 0.0360s/iter; left time: 210.2544s
	iters: 600, epoch: 14 | loss: 0.0455824
	speed: 0.0357s/iter; left time: 205.0235s
	iters: 700, epoch: 14 | loss: 0.0412655
	speed: 0.0356s/iter; left time: 200.6092s
	iters: 800, epoch: 14 | loss: 0.0518019
	speed: 0.0356s/iter; left time: 197.3110s
	iters: 900, epoch: 14 | loss: 0.0401611
	speed: 0.0363s/iter; left time: 197.3124s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:33.15s
Steps: 906 | Train Loss: 0.0464986 Vali Loss: 0.0564530 Test Loss: 0.0648331
EarlyStopping counter: 2 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0453141
	speed: 0.1015s/iter; left time: 541.9354s
	iters: 200, epoch: 15 | loss: 0.0427157
	speed: 0.0356s/iter; left time: 186.6870s
	iters: 300, epoch: 15 | loss: 0.0424050
	speed: 0.0355s/iter; left time: 182.5853s
	iters: 400, epoch: 15 | loss: 0.0450250
	speed: 0.0356s/iter; left time: 179.2244s
	iters: 500, epoch: 15 | loss: 0.0498884
	speed: 0.0356s/iter; left time: 175.7776s
	iters: 600, epoch: 15 | loss: 0.0426898
	speed: 0.0356s/iter; left time: 172.2587s
	iters: 700, epoch: 15 | loss: 0.0478519
	speed: 0.0356s/iter; left time: 168.4243s
	iters: 800, epoch: 15 | loss: 0.0399454
	speed: 0.0355s/iter; left time: 164.7651s
	iters: 900, epoch: 15 | loss: 0.0482494
	speed: 0.0356s/iter; left time: 161.5485s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:32.62s
Steps: 906 | Train Loss: 0.0455909 Vali Loss: 0.0574777 Test Loss: 0.0649152
EarlyStopping counter: 3 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0477243
	speed: 0.1030s/iter; left time: 456.3738s
	iters: 200, epoch: 16 | loss: 0.0499466
	speed: 0.0367s/iter; left time: 159.0718s
	iters: 300, epoch: 16 | loss: 0.0453695
	speed: 0.0364s/iter; left time: 154.0372s
	iters: 400, epoch: 16 | loss: 0.0438813
	speed: 0.0363s/iter; left time: 150.0823s
	iters: 500, epoch: 16 | loss: 0.0471978
	speed: 0.0363s/iter; left time: 146.2428s
	iters: 600, epoch: 16 | loss: 0.0432691
	speed: 0.0363s/iter; left time: 142.8684s
	iters: 700, epoch: 16 | loss: 0.0403846
	speed: 0.0363s/iter; left time: 138.8803s
	iters: 800, epoch: 16 | loss: 0.0475129
	speed: 0.0363s/iter; left time: 135.5841s
	iters: 900, epoch: 16 | loss: 0.0473321
	speed: 0.0363s/iter; left time: 131.6925s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:33.40s
Steps: 906 | Train Loss: 0.0446047 Vali Loss: 0.0561414 Test Loss: 0.0642355
EarlyStopping counter: 4 out of 5
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0387600
	speed: 0.1014s/iter; left time: 357.4797s
	iters: 200, epoch: 17 | loss: 0.0365247
	speed: 0.0360s/iter; left time: 123.2303s
	iters: 300, epoch: 17 | loss: 0.0416560
	speed: 0.0357s/iter; left time: 118.7469s
	iters: 400, epoch: 17 | loss: 0.0426961
	speed: 0.0356s/iter; left time: 114.7506s
	iters: 500, epoch: 17 | loss: 0.0431453
	speed: 0.0356s/iter; left time: 111.2004s
	iters: 600, epoch: 17 | loss: 0.0430919
	speed: 0.0347s/iter; left time: 105.0595s
	iters: 700, epoch: 17 | loss: 0.0497445
	speed: 0.0350s/iter; left time: 102.3518s
	iters: 800, epoch: 17 | loss: 0.0412744
	speed: 0.0356s/iter; left time: 100.6510s
	iters: 900, epoch: 17 | loss: 0.0451680
	speed: 0.0355s/iter; left time: 96.7984s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:32.58s
Steps: 906 | Train Loss: 0.0439459 Vali Loss: 0.0560204 Test Loss: 0.0647921
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.01203176286071539, rmse:0.1096893921494484, mae:0.06421584635972977, rse:0.4145238697528839
Original data scale mse:1767036.25, rmse:1329.2991943359375, mae:813.9424438476562, rse:0.09341298788785934
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2498116
	speed: 0.0377s/iter; left time: 679.9452s
	iters: 200, epoch: 1 | loss: 0.2011735
	speed: 0.0347s/iter; left time: 622.4779s
	iters: 300, epoch: 1 | loss: 0.2150934
	speed: 0.0347s/iter; left time: 619.1292s
	iters: 400, epoch: 1 | loss: 0.1960537
	speed: 0.0347s/iter; left time: 615.3222s
	iters: 500, epoch: 1 | loss: 0.1826794
	speed: 0.0347s/iter; left time: 610.9105s
	iters: 600, epoch: 1 | loss: 0.1927706
	speed: 0.0346s/iter; left time: 606.8498s
	iters: 700, epoch: 1 | loss: 0.1779167
	speed: 0.0347s/iter; left time: 604.7175s
	iters: 800, epoch: 1 | loss: 0.1746279
	speed: 0.0348s/iter; left time: 601.9485s
	iters: 900, epoch: 1 | loss: 0.1654574
	speed: 0.0347s/iter; left time: 597.1462s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:31.80s
Steps: 906 | Train Loss: 0.1992125 Vali Loss: 0.1432941 Test Loss: 0.1544233
Validation loss decreased (inf --> 0.143294).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1207117
	speed: 0.1040s/iter; left time: 1779.4130s
	iters: 200, epoch: 2 | loss: 0.0950160
	speed: 0.0348s/iter; left time: 592.4506s
	iters: 300, epoch: 2 | loss: 0.1002817
	speed: 0.0348s/iter; left time: 589.3753s
	iters: 400, epoch: 2 | loss: 0.0960616
	speed: 0.0348s/iter; left time: 585.3643s
	iters: 500, epoch: 2 | loss: 0.0890009
	speed: 0.0348s/iter; left time: 582.1026s
	iters: 600, epoch: 2 | loss: 0.0752527
	speed: 0.0348s/iter; left time: 577.9216s
	iters: 700, epoch: 2 | loss: 0.0765394
	speed: 0.0348s/iter; left time: 573.9364s
	iters: 800, epoch: 2 | loss: 0.0737386
	speed: 0.0347s/iter; left time: 570.2224s
	iters: 900, epoch: 2 | loss: 0.0719303
	speed: 0.0348s/iter; left time: 567.7863s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:31.90s
Steps: 906 | Train Loss: 0.0930362 Vali Loss: 0.0793414 Test Loss: 0.0821712
Validation loss decreased (0.143294 --> 0.079341).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0749184
	speed: 0.1021s/iter; left time: 1654.6067s
	iters: 200, epoch: 3 | loss: 0.0750817
	speed: 0.0351s/iter; left time: 564.7599s
	iters: 300, epoch: 3 | loss: 0.0689839
	speed: 0.0347s/iter; left time: 556.1284s
	iters: 400, epoch: 3 | loss: 0.0704358
	speed: 0.0347s/iter; left time: 551.3547s
	iters: 500, epoch: 3 | loss: 0.0624443
	speed: 0.0347s/iter; left time: 548.6931s
	iters: 600, epoch: 3 | loss: 0.0694029
	speed: 0.0347s/iter; left time: 544.8820s
	iters: 700, epoch: 3 | loss: 0.0815309
	speed: 0.0347s/iter; left time: 541.6771s
	iters: 800, epoch: 3 | loss: 0.0664670
	speed: 0.0347s/iter; left time: 538.2890s
	iters: 900, epoch: 3 | loss: 0.0646821
	speed: 0.0347s/iter; left time: 535.0300s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:31.86s
Steps: 906 | Train Loss: 0.0724885 Vali Loss: 0.0685023 Test Loss: 0.0725131
Validation loss decreased (0.079341 --> 0.068502).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0744193
	speed: 0.1038s/iter; left time: 1588.5692s
	iters: 200, epoch: 4 | loss: 0.0712759
	speed: 0.0349s/iter; left time: 530.1567s
	iters: 300, epoch: 4 | loss: 0.0668154
	speed: 0.0348s/iter; left time: 525.6213s
	iters: 400, epoch: 4 | loss: 0.0690735
	speed: 0.0347s/iter; left time: 521.3429s
	iters: 500, epoch: 4 | loss: 0.0684960
	speed: 0.0348s/iter; left time: 519.1811s
	iters: 600, epoch: 4 | loss: 0.0681758
	speed: 0.0348s/iter; left time: 515.5497s
	iters: 700, epoch: 4 | loss: 0.0672854
	speed: 0.0348s/iter; left time: 511.2669s
	iters: 800, epoch: 4 | loss: 0.0688433
	speed: 0.0347s/iter; left time: 507.1866s
	iters: 900, epoch: 4 | loss: 0.0717380
	speed: 0.0348s/iter; left time: 504.1914s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:31.91s
Steps: 906 | Train Loss: 0.0678150 Vali Loss: 0.0665552 Test Loss: 0.0727431
Validation loss decreased (0.068502 --> 0.066555).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0659932
	speed: 0.1030s/iter; left time: 1482.6231s
	iters: 200, epoch: 5 | loss: 0.0691543
	speed: 0.0348s/iter; left time: 497.2530s
	iters: 300, epoch: 5 | loss: 0.0622396
	speed: 0.0349s/iter; left time: 495.1291s
	iters: 400, epoch: 5 | loss: 0.0609198
	speed: 0.0348s/iter; left time: 491.1055s
	iters: 500, epoch: 5 | loss: 0.0666150
	speed: 0.0348s/iter; left time: 487.7235s
	iters: 600, epoch: 5 | loss: 0.0587350
	speed: 0.0348s/iter; left time: 483.2866s
	iters: 700, epoch: 5 | loss: 0.0578601
	speed: 0.0347s/iter; left time: 479.1644s
	iters: 800, epoch: 5 | loss: 0.0598911
	speed: 0.0348s/iter; left time: 476.0198s
	iters: 900, epoch: 5 | loss: 0.0647039
	speed: 0.0347s/iter; left time: 472.3193s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:31.87s
Steps: 906 | Train Loss: 0.0635315 Vali Loss: 0.0618177 Test Loss: 0.0684821
Validation loss decreased (0.066555 --> 0.061818).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0551207
	speed: 0.1025s/iter; left time: 1382.9035s
	iters: 200, epoch: 6 | loss: 0.0664826
	speed: 0.0347s/iter; left time: 464.9690s
	iters: 300, epoch: 6 | loss: 0.0643861
	speed: 0.0347s/iter; left time: 461.6338s
	iters: 400, epoch: 6 | loss: 0.0645496
	speed: 0.0348s/iter; left time: 458.7964s
	iters: 500, epoch: 6 | loss: 0.0522045
	speed: 0.0347s/iter; left time: 454.6579s
	iters: 600, epoch: 6 | loss: 0.0588533
	speed: 0.0348s/iter; left time: 451.7366s
	iters: 700, epoch: 6 | loss: 0.0584210
	speed: 0.0349s/iter; left time: 449.6483s
	iters: 800, epoch: 6 | loss: 0.0518436
	speed: 0.0348s/iter; left time: 444.5817s
	iters: 900, epoch: 6 | loss: 0.0592274
	speed: 0.0348s/iter; left time: 441.4078s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:31.87s
Steps: 906 | Train Loss: 0.0598389 Vali Loss: 0.0608522 Test Loss: 0.0686492
Validation loss decreased (0.061818 --> 0.060852).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0570249
	speed: 0.1035s/iter; left time: 1301.9967s
	iters: 200, epoch: 7 | loss: 0.0546420
	speed: 0.0347s/iter; left time: 433.7013s
	iters: 300, epoch: 7 | loss: 0.0586133
	speed: 0.0348s/iter; left time: 430.6990s
	iters: 400, epoch: 7 | loss: 0.0534843
	speed: 0.0348s/iter; left time: 426.9856s
	iters: 500, epoch: 7 | loss: 0.0500044
	speed: 0.0348s/iter; left time: 423.8945s
	iters: 600, epoch: 7 | loss: 0.0479839
	speed: 0.0348s/iter; left time: 420.4538s
	iters: 700, epoch: 7 | loss: 0.0544220
	speed: 0.0347s/iter; left time: 416.0986s
	iters: 800, epoch: 7 | loss: 0.0504415
	speed: 0.0347s/iter; left time: 412.9291s
	iters: 900, epoch: 7 | loss: 0.0664917
	speed: 0.0347s/iter; left time: 408.9576s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:31.87s
Steps: 906 | Train Loss: 0.0572039 Vali Loss: 0.0600482 Test Loss: 0.0666491
Validation loss decreased (0.060852 --> 0.060048).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0569239
	speed: 0.1054s/iter; left time: 1231.2677s
	iters: 200, epoch: 8 | loss: 0.0524420
	speed: 0.0360s/iter; left time: 417.0321s
	iters: 300, epoch: 8 | loss: 0.0549767
	speed: 0.0354s/iter; left time: 405.8189s
	iters: 400, epoch: 8 | loss: 0.0569074
	speed: 0.0351s/iter; left time: 399.2967s
	iters: 500, epoch: 8 | loss: 0.0560224
	speed: 0.0344s/iter; left time: 388.0709s
	iters: 600, epoch: 8 | loss: 0.0586272
	speed: 0.0351s/iter; left time: 392.2186s
	iters: 700, epoch: 8 | loss: 0.0534134
	speed: 0.0351s/iter; left time: 388.7864s
	iters: 800, epoch: 8 | loss: 0.0507184
	speed: 0.0351s/iter; left time: 385.2647s
	iters: 900, epoch: 8 | loss: 0.0588685
	speed: 0.0352s/iter; left time: 382.5251s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:32.33s
Steps: 906 | Train Loss: 0.0554143 Vali Loss: 0.0588686 Test Loss: 0.0643074
Validation loss decreased (0.060048 --> 0.058869).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0554289
	speed: 0.1005s/iter; left time: 1082.5421s
	iters: 200, epoch: 9 | loss: 0.0491354
	speed: 0.0345s/iter; left time: 367.9343s
	iters: 300, epoch: 9 | loss: 0.0533709
	speed: 0.0344s/iter; left time: 364.1632s
	iters: 400, epoch: 9 | loss: 0.0478047
	speed: 0.0345s/iter; left time: 361.1691s
	iters: 500, epoch: 9 | loss: 0.0562404
	speed: 0.0344s/iter; left time: 357.0031s
	iters: 600, epoch: 9 | loss: 0.0546994
	speed: 0.0345s/iter; left time: 354.4891s
	iters: 700, epoch: 9 | loss: 0.0573833
	speed: 0.0345s/iter; left time: 351.0283s
	iters: 800, epoch: 9 | loss: 0.0525519
	speed: 0.0345s/iter; left time: 347.3084s
	iters: 900, epoch: 9 | loss: 0.0501279
	speed: 0.0345s/iter; left time: 343.9121s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:31.57s
Steps: 906 | Train Loss: 0.0537802 Vali Loss: 0.0572465 Test Loss: 0.0636292
Validation loss decreased (0.058869 --> 0.057246).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0570313
	speed: 0.1024s/iter; left time: 1010.6265s
	iters: 200, epoch: 10 | loss: 0.0489191
	speed: 0.0345s/iter; left time: 336.7999s
	iters: 300, epoch: 10 | loss: 0.0466328
	speed: 0.0345s/iter; left time: 333.5356s
	iters: 400, epoch: 10 | loss: 0.0506991
	speed: 0.0345s/iter; left time: 329.9629s
	iters: 500, epoch: 10 | loss: 0.0551326
	speed: 0.0344s/iter; left time: 326.0982s
	iters: 600, epoch: 10 | loss: 0.0489854
	speed: 0.0344s/iter; left time: 322.5553s
	iters: 700, epoch: 10 | loss: 0.0582220
	speed: 0.0345s/iter; left time: 320.0594s
	iters: 800, epoch: 10 | loss: 0.0630818
	speed: 0.0345s/iter; left time: 316.0620s
	iters: 900, epoch: 10 | loss: 0.0590224
	speed: 0.0345s/iter; left time: 312.8794s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:31.65s
Steps: 906 | Train Loss: 0.0524546 Vali Loss: 0.0584495 Test Loss: 0.0668093
EarlyStopping counter: 1 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0541355
	speed: 0.0996s/iter; left time: 892.8866s
	iters: 200, epoch: 11 | loss: 0.0514751
	speed: 0.0345s/iter; left time: 305.4828s
	iters: 300, epoch: 11 | loss: 0.0508684
	speed: 0.0342s/iter; left time: 299.3527s
	iters: 400, epoch: 11 | loss: 0.0488365
	speed: 0.0341s/iter; left time: 295.6787s
	iters: 500, epoch: 11 | loss: 0.0411242
	speed: 0.0341s/iter; left time: 292.2782s
	iters: 600, epoch: 11 | loss: 0.0533406
	speed: 0.0342s/iter; left time: 289.1026s
	iters: 700, epoch: 11 | loss: 0.0518379
	speed: 0.0343s/iter; left time: 286.7094s
	iters: 800, epoch: 11 | loss: 0.0526628
	speed: 0.0343s/iter; left time: 283.3028s
	iters: 900, epoch: 11 | loss: 0.0498659
	speed: 0.0343s/iter; left time: 279.7757s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:31.42s
Steps: 906 | Train Loss: 0.0511982 Vali Loss: 0.0571466 Test Loss: 0.0659549
Validation loss decreased (0.057246 --> 0.057147).  Saving model ...
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0479833
	speed: 0.1002s/iter; left time: 807.2062s
	iters: 200, epoch: 12 | loss: 0.0515542
	speed: 0.0343s/iter; left time: 272.5373s
	iters: 300, epoch: 12 | loss: 0.0507848
	speed: 0.0342s/iter; left time: 268.8197s
	iters: 400, epoch: 12 | loss: 0.0510435
	speed: 0.0342s/iter; left time: 265.3663s
	iters: 500, epoch: 12 | loss: 0.0462130
	speed: 0.0342s/iter; left time: 262.0749s
	iters: 600, epoch: 12 | loss: 0.0533448
	speed: 0.0342s/iter; left time: 258.4630s
	iters: 700, epoch: 12 | loss: 0.0432821
	speed: 0.0342s/iter; left time: 255.0894s
	iters: 800, epoch: 12 | loss: 0.0530810
	speed: 0.0342s/iter; left time: 251.8856s
	iters: 900, epoch: 12 | loss: 0.0456739
	speed: 0.0342s/iter; left time: 248.2836s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:31.36s
Steps: 906 | Train Loss: 0.0497971 Vali Loss: 0.0571572 Test Loss: 0.0657481
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0520588
	speed: 0.0987s/iter; left time: 705.3635s
	iters: 200, epoch: 13 | loss: 0.0471978
	speed: 0.0348s/iter; left time: 245.0608s
	iters: 300, epoch: 13 | loss: 0.0492734
	speed: 0.0343s/iter; left time: 238.3167s
	iters: 400, epoch: 13 | loss: 0.0487693
	speed: 0.0344s/iter; left time: 235.8220s
	iters: 500, epoch: 13 | loss: 0.0490274
	speed: 0.0348s/iter; left time: 234.6202s
	iters: 600, epoch: 13 | loss: 0.0444182
	speed: 0.0348s/iter; left time: 231.5386s
	iters: 700, epoch: 13 | loss: 0.0454526
	speed: 0.0348s/iter; left time: 228.0235s
	iters: 800, epoch: 13 | loss: 0.0502009
	speed: 0.0345s/iter; left time: 222.5046s
	iters: 900, epoch: 13 | loss: 0.0519659
	speed: 0.0345s/iter; left time: 219.1692s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:31.71s
Steps: 906 | Train Loss: 0.0487688 Vali Loss: 0.0568870 Test Loss: 0.0654286
Validation loss decreased (0.057147 --> 0.056887).  Saving model ...
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.0472592
	speed: 0.1002s/iter; left time: 625.7885s
	iters: 200, epoch: 14 | loss: 0.0461481
	speed: 0.0342s/iter; left time: 209.8813s
	iters: 300, epoch: 14 | loss: 0.0439564
	speed: 0.0342s/iter; left time: 206.4675s
	iters: 400, epoch: 14 | loss: 0.0481552
	speed: 0.0342s/iter; left time: 203.0564s
	iters: 500, epoch: 14 | loss: 0.0552839
	speed: 0.0342s/iter; left time: 199.6786s
	iters: 600, epoch: 14 | loss: 0.0544599
	speed: 0.0342s/iter; left time: 196.4713s
	iters: 700, epoch: 14 | loss: 0.0492873
	speed: 0.0342s/iter; left time: 193.2318s
	iters: 800, epoch: 14 | loss: 0.0519501
	speed: 0.0342s/iter; left time: 189.7543s
	iters: 900, epoch: 14 | loss: 0.0444011
	speed: 0.0342s/iter; left time: 186.2489s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:31.29s
Steps: 906 | Train Loss: 0.0478288 Vali Loss: 0.0574118 Test Loss: 0.0649276
EarlyStopping counter: 1 out of 5
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.0518620
	speed: 0.0967s/iter; left time: 515.8636s
	iters: 200, epoch: 15 | loss: 0.0447321
	speed: 0.0342s/iter; left time: 178.8927s
	iters: 300, epoch: 15 | loss: 0.0470643
	speed: 0.0341s/iter; left time: 175.3891s
	iters: 400, epoch: 15 | loss: 0.0505560
	speed: 0.0341s/iter; left time: 171.8593s
	iters: 500, epoch: 15 | loss: 0.0455437
	speed: 0.0342s/iter; left time: 168.7319s
	iters: 600, epoch: 15 | loss: 0.0463022
	speed: 0.0342s/iter; left time: 165.6396s
	iters: 700, epoch: 15 | loss: 0.0565158
	speed: 0.0342s/iter; left time: 162.1732s
	iters: 800, epoch: 15 | loss: 0.0485040
	speed: 0.0343s/iter; left time: 158.8992s
	iters: 900, epoch: 15 | loss: 0.0463231
	speed: 0.0343s/iter; left time: 155.4253s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:31.33s
Steps: 906 | Train Loss: 0.0470613 Vali Loss: 0.0568892 Test Loss: 0.0665978
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.0476478
	speed: 0.0966s/iter; left time: 428.1729s
	iters: 200, epoch: 16 | loss: 0.0442408
	speed: 0.0342s/iter; left time: 148.2688s
	iters: 300, epoch: 16 | loss: 0.0460189
	speed: 0.0342s/iter; left time: 144.6738s
	iters: 400, epoch: 16 | loss: 0.0477852
	speed: 0.0343s/iter; left time: 141.5326s
	iters: 500, epoch: 16 | loss: 0.0508246
	speed: 0.0342s/iter; left time: 137.9401s
	iters: 600, epoch: 16 | loss: 0.0476234
	speed: 0.0342s/iter; left time: 134.6194s
	iters: 700, epoch: 16 | loss: 0.0496349
	speed: 0.0342s/iter; left time: 131.0207s
	iters: 800, epoch: 16 | loss: 0.0451010
	speed: 0.0342s/iter; left time: 127.7402s
	iters: 900, epoch: 16 | loss: 0.0472244
	speed: 0.0342s/iter; left time: 124.3203s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:31.35s
Steps: 906 | Train Loss: 0.0462200 Vali Loss: 0.0565890 Test Loss: 0.0651991
Validation loss decreased (0.056887 --> 0.056589).  Saving model ...
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.0511533
	speed: 0.1034s/iter; left time: 364.6280s
	iters: 200, epoch: 17 | loss: 0.0410157
	speed: 0.0342s/iter; left time: 117.1469s
	iters: 300, epoch: 17 | loss: 0.0532006
	speed: 0.0342s/iter; left time: 113.7880s
	iters: 400, epoch: 17 | loss: 0.0506476
	speed: 0.0342s/iter; left time: 110.4402s
	iters: 500, epoch: 17 | loss: 0.0444746
	speed: 0.0342s/iter; left time: 106.8317s
	iters: 600, epoch: 17 | loss: 0.0454823
	speed: 0.0342s/iter; left time: 103.3351s
	iters: 700, epoch: 17 | loss: 0.0417460
	speed: 0.0342s/iter; left time: 100.0191s
	iters: 800, epoch: 17 | loss: 0.0485935
	speed: 0.0342s/iter; left time: 96.6135s
	iters: 900, epoch: 17 | loss: 0.0427209
	speed: 0.0342s/iter; left time: 93.1659s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:31.39s
Steps: 906 | Train Loss: 0.0454245 Vali Loss: 0.0563723 Test Loss: 0.0671997
Validation loss decreased (0.056589 --> 0.056372).  Saving model ...
Updating learning rate to 2.287679245496101e-05
	iters: 100, epoch: 18 | loss: 0.0397315
	speed: 0.1005s/iter; left time: 263.1075s
	iters: 200, epoch: 18 | loss: 0.0411270
	speed: 0.0342s/iter; left time: 86.1586s
	iters: 300, epoch: 18 | loss: 0.0484297
	speed: 0.0342s/iter; left time: 82.8027s
	iters: 400, epoch: 18 | loss: 0.0467603
	speed: 0.0341s/iter; left time: 79.1762s
	iters: 500, epoch: 18 | loss: 0.0422288
	speed: 0.0342s/iter; left time: 75.8083s
	iters: 600, epoch: 18 | loss: 0.0504954
	speed: 0.0341s/iter; left time: 72.3610s
	iters: 700, epoch: 18 | loss: 0.0396327
	speed: 0.0342s/iter; left time: 68.9799s
	iters: 800, epoch: 18 | loss: 0.0461913
	speed: 0.0343s/iter; left time: 65.7860s
	iters: 900, epoch: 18 | loss: 0.0522097
	speed: 0.0342s/iter; left time: 62.1365s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:31.37s
Steps: 906 | Train Loss: 0.0448353 Vali Loss: 0.0574077 Test Loss: 0.0666983
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.0589113209464907e-05
	iters: 100, epoch: 19 | loss: 0.0404343
	speed: 0.0989s/iter; left time: 169.3815s
	iters: 200, epoch: 19 | loss: 0.0435289
	speed: 0.0343s/iter; left time: 55.2672s
	iters: 300, epoch: 19 | loss: 0.0437113
	speed: 0.0342s/iter; left time: 51.8030s
	iters: 400, epoch: 19 | loss: 0.0464690
	speed: 0.0343s/iter; left time: 48.4120s
	iters: 500, epoch: 19 | loss: 0.0434488
	speed: 0.0342s/iter; left time: 44.9089s
	iters: 600, epoch: 19 | loss: 0.0420474
	speed: 0.0342s/iter; left time: 41.5055s
	iters: 700, epoch: 19 | loss: 0.0488688
	speed: 0.0342s/iter; left time: 38.1102s
	iters: 800, epoch: 19 | loss: 0.0425040
	speed: 0.0343s/iter; left time: 34.7056s
	iters: 900, epoch: 19 | loss: 0.0387297
	speed: 0.0342s/iter; left time: 31.2248s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:31.40s
Steps: 906 | Train Loss: 0.0441012 Vali Loss: 0.0579686 Test Loss: 0.0662565
EarlyStopping counter: 2 out of 5
Updating learning rate to 1.8530201888518416e-05
	iters: 100, epoch: 20 | loss: 0.0443658
	speed: 0.0989s/iter; left time: 79.8351s
	iters: 200, epoch: 20 | loss: 0.0434084
	speed: 0.0342s/iter; left time: 24.2121s
	iters: 300, epoch: 20 | loss: 0.0444593
	speed: 0.0343s/iter; left time: 20.7924s
	iters: 400, epoch: 20 | loss: 0.0421418
	speed: 0.0343s/iter; left time: 17.3657s
	iters: 500, epoch: 20 | loss: 0.0421504
	speed: 0.0342s/iter; left time: 13.9296s
	iters: 600, epoch: 20 | loss: 0.0476669
	speed: 0.0343s/iter; left time: 10.5251s
	iters: 700, epoch: 20 | loss: 0.0507700
	speed: 0.0342s/iter; left time: 7.0834s
	iters: 800, epoch: 20 | loss: 0.0446998
	speed: 0.0343s/iter; left time: 3.6648s
	iters: 900, epoch: 20 | loss: 0.0413743
	speed: 0.0343s/iter; left time: 0.2398s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:31.41s
Steps: 906 | Train Loss: 0.0435656 Vali Loss: 0.0569343 Test Loss: 0.0663891
EarlyStopping counter: 3 out of 5
Updating learning rate to 1.6677181699666577e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.013082382269203663, rmse:0.11437824368476868, mae:0.06724400073289871, rse:0.43224334716796875
Original data scale mse:1968128.25, rmse:1402.89990234375, mae:857.3510131835938, rse:0.0985850915312767

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.01203176286071539, RMSE: 0.1096893921494484, MAE: 0.06421584635972977, RSE: 0.4145238697528839
Unscaled Metrics - MSE: 1767036.25, RMSE: 1329.2991943359375, MAE: 813.9424438476562, RSE: 0.09341298788785934

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.013082382269203663, RMSE: 0.11437824368476868, MAE: 0.06724400073289871, RSE: 0.43224334716796875
Unscaled Metrics - MSE: 1968128.25, RMSE: 1402.89990234375, MAE: 857.3510131835938, RSE: 0.0985850915312767

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2329149
	speed: 0.0625s/iter; left time: 1124.5767s
	iters: 200, epoch: 1 | loss: 0.2132984
	speed: 0.0415s/iter; left time: 741.5448s
	iters: 300, epoch: 1 | loss: 0.2021164
	speed: 0.0416s/iter; left time: 739.1000s
	iters: 400, epoch: 1 | loss: 0.1994694
	speed: 0.0415s/iter; left time: 734.3424s
	iters: 500, epoch: 1 | loss: 0.1993076
	speed: 0.0416s/iter; left time: 730.6598s
	iters: 600, epoch: 1 | loss: 0.1911502
	speed: 0.0416s/iter; left time: 727.3324s
	iters: 700, epoch: 1 | loss: 0.1889577
	speed: 0.0415s/iter; left time: 721.9669s
	iters: 800, epoch: 1 | loss: 0.1783947
	speed: 0.0416s/iter; left time: 718.5942s
	iters: 900, epoch: 1 | loss: 0.1868250
	speed: 0.0417s/iter; left time: 716.7412s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.31s
Steps: 904 | Train Loss: 0.2045878 Vali Loss: 0.1702724 Test Loss: 0.1878111
Validation loss decreased (inf --> 0.170272).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1723534
	speed: 0.1170s/iter; left time: 1998.0238s
	iters: 200, epoch: 2 | loss: 0.1603348
	speed: 0.0415s/iter; left time: 705.1172s
	iters: 300, epoch: 2 | loss: 0.1485798
	speed: 0.0416s/iter; left time: 702.0892s
	iters: 400, epoch: 2 | loss: 0.1373307
	speed: 0.0416s/iter; left time: 697.6313s
	iters: 500, epoch: 2 | loss: 0.1285997
	speed: 0.0416s/iter; left time: 694.2753s
	iters: 600, epoch: 2 | loss: 0.1198477
	speed: 0.0416s/iter; left time: 689.9216s
	iters: 700, epoch: 2 | loss: 0.1147303
	speed: 0.0416s/iter; left time: 685.3850s
	iters: 800, epoch: 2 | loss: 0.1007503
	speed: 0.0416s/iter; left time: 680.7088s
	iters: 900, epoch: 2 | loss: 0.0971180
	speed: 0.0416s/iter; left time: 676.8412s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.86s
Steps: 904 | Train Loss: 0.1339202 Vali Loss: 0.0941798 Test Loss: 0.1007875
Validation loss decreased (0.170272 --> 0.094180).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0933497
	speed: 0.1180s/iter; left time: 1908.1330s
	iters: 200, epoch: 3 | loss: 0.0936517
	speed: 0.0415s/iter; left time: 667.0889s
	iters: 300, epoch: 3 | loss: 0.0927260
	speed: 0.0416s/iter; left time: 663.7515s
	iters: 400, epoch: 3 | loss: 0.0904723
	speed: 0.0416s/iter; left time: 660.0851s
	iters: 500, epoch: 3 | loss: 0.0878174
	speed: 0.0415s/iter; left time: 655.3119s
	iters: 600, epoch: 3 | loss: 0.0923175
	speed: 0.0416s/iter; left time: 651.3754s
	iters: 700, epoch: 3 | loss: 0.0842094
	speed: 0.0416s/iter; left time: 647.8343s
	iters: 800, epoch: 3 | loss: 0.0947829
	speed: 0.0416s/iter; left time: 642.9995s
	iters: 900, epoch: 3 | loss: 0.0795053
	speed: 0.0416s/iter; left time: 638.8667s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.86s
Steps: 904 | Train Loss: 0.0910683 Vali Loss: 0.0842124 Test Loss: 0.0916354
Validation loss decreased (0.094180 --> 0.084212).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0810681
	speed: 0.1177s/iter; left time: 1797.1778s
	iters: 200, epoch: 4 | loss: 0.0898334
	speed: 0.0416s/iter; left time: 631.2290s
	iters: 300, epoch: 4 | loss: 0.0877813
	speed: 0.0416s/iter; left time: 626.6074s
	iters: 400, epoch: 4 | loss: 0.0827008
	speed: 0.0416s/iter; left time: 622.2855s
	iters: 500, epoch: 4 | loss: 0.0800275
	speed: 0.0417s/iter; left time: 619.4193s
	iters: 600, epoch: 4 | loss: 0.0795660
	speed: 0.0416s/iter; left time: 614.2605s
	iters: 700, epoch: 4 | loss: 0.0887710
	speed: 0.0416s/iter; left time: 610.7840s
	iters: 800, epoch: 4 | loss: 0.0751216
	speed: 0.0416s/iter; left time: 606.0313s
	iters: 900, epoch: 4 | loss: 0.0814652
	speed: 0.0416s/iter; left time: 601.8596s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.87s
Steps: 904 | Train Loss: 0.0842684 Vali Loss: 0.0824417 Test Loss: 0.0909199
Validation loss decreased (0.084212 --> 0.082442).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0819404
	speed: 0.1164s/iter; left time: 1671.9546s
	iters: 200, epoch: 5 | loss: 0.0734804
	speed: 0.0416s/iter; left time: 593.8394s
	iters: 300, epoch: 5 | loss: 0.0850687
	speed: 0.0416s/iter; left time: 589.6366s
	iters: 400, epoch: 5 | loss: 0.0805629
	speed: 0.0416s/iter; left time: 585.1509s
	iters: 500, epoch: 5 | loss: 0.0772669
	speed: 0.0416s/iter; left time: 581.4584s
	iters: 600, epoch: 5 | loss: 0.0835028
	speed: 0.0417s/iter; left time: 578.4996s
	iters: 700, epoch: 5 | loss: 0.0755597
	speed: 0.0416s/iter; left time: 572.9308s
	iters: 800, epoch: 5 | loss: 0.0821126
	speed: 0.0416s/iter; left time: 568.7943s
	iters: 900, epoch: 5 | loss: 0.0793681
	speed: 0.0416s/iter; left time: 564.5852s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.89s
Steps: 904 | Train Loss: 0.0794752 Vali Loss: 0.0815711 Test Loss: 0.0942506
Validation loss decreased (0.082442 --> 0.081571).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0839607
	speed: 0.1165s/iter; left time: 1567.7003s
	iters: 200, epoch: 6 | loss: 0.0795517
	speed: 0.0415s/iter; left time: 554.9614s
	iters: 300, epoch: 6 | loss: 0.0796291
	speed: 0.0415s/iter; left time: 550.9057s
	iters: 400, epoch: 6 | loss: 0.0740407
	speed: 0.0416s/iter; left time: 547.3535s
	iters: 500, epoch: 6 | loss: 0.0732674
	speed: 0.0415s/iter; left time: 542.0746s
	iters: 600, epoch: 6 | loss: 0.0717258
	speed: 0.0415s/iter; left time: 538.5073s
	iters: 700, epoch: 6 | loss: 0.0781353
	speed: 0.0415s/iter; left time: 534.3261s
	iters: 800, epoch: 6 | loss: 0.0775410
	speed: 0.0417s/iter; left time: 531.5219s
	iters: 900, epoch: 6 | loss: 0.0719830
	speed: 0.0416s/iter; left time: 527.0386s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.82s
Steps: 904 | Train Loss: 0.0759981 Vali Loss: 0.0810199 Test Loss: 0.0920831
Validation loss decreased (0.081571 --> 0.081020).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0723580
	speed: 0.1168s/iter; left time: 1467.0508s
	iters: 200, epoch: 7 | loss: 0.0775005
	speed: 0.0416s/iter; left time: 518.2076s
	iters: 300, epoch: 7 | loss: 0.0755266
	speed: 0.0416s/iter; left time: 514.1917s
	iters: 400, epoch: 7 | loss: 0.0716491
	speed: 0.0417s/iter; left time: 510.6866s
	iters: 500, epoch: 7 | loss: 0.0726988
	speed: 0.0417s/iter; left time: 506.4100s
	iters: 600, epoch: 7 | loss: 0.0645041
	speed: 0.0416s/iter; left time: 501.7992s
	iters: 700, epoch: 7 | loss: 0.0743607
	speed: 0.0416s/iter; left time: 497.2485s
	iters: 800, epoch: 7 | loss: 0.0622560
	speed: 0.0417s/iter; left time: 494.2482s
	iters: 900, epoch: 7 | loss: 0.0748020
	speed: 0.0416s/iter; left time: 489.6376s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.91s
Steps: 904 | Train Loss: 0.0728088 Vali Loss: 0.0797380 Test Loss: 0.0911746
Validation loss decreased (0.081020 --> 0.079738).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0803198
	speed: 0.1169s/iter; left time: 1362.3808s
	iters: 200, epoch: 8 | loss: 0.0780065
	speed: 0.0416s/iter; left time: 480.2506s
	iters: 300, epoch: 8 | loss: 0.0705057
	speed: 0.0416s/iter; left time: 476.4226s
	iters: 400, epoch: 8 | loss: 0.0695511
	speed: 0.0416s/iter; left time: 471.9944s
	iters: 500, epoch: 8 | loss: 0.0667554
	speed: 0.0416s/iter; left time: 467.9705s
	iters: 600, epoch: 8 | loss: 0.0727597
	speed: 0.0416s/iter; left time: 463.7615s
	iters: 700, epoch: 8 | loss: 0.0681027
	speed: 0.0416s/iter; left time: 459.6343s
	iters: 800, epoch: 8 | loss: 0.0727258
	speed: 0.0416s/iter; left time: 455.9461s
	iters: 900, epoch: 8 | loss: 0.0665395
	speed: 0.0416s/iter; left time: 451.3620s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.87s
Steps: 904 | Train Loss: 0.0701697 Vali Loss: 0.0797013 Test Loss: 0.0913741
Validation loss decreased (0.079738 --> 0.079701).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0698563
	speed: 0.1173s/iter; left time: 1260.9097s
	iters: 200, epoch: 9 | loss: 0.0712313
	speed: 0.0416s/iter; left time: 443.3270s
	iters: 300, epoch: 9 | loss: 0.0642897
	speed: 0.0416s/iter; left time: 438.3744s
	iters: 400, epoch: 9 | loss: 0.0650743
	speed: 0.0415s/iter; left time: 433.9851s
	iters: 500, epoch: 9 | loss: 0.0677874
	speed: 0.0416s/iter; left time: 430.0534s
	iters: 600, epoch: 9 | loss: 0.0642288
	speed: 0.0417s/iter; left time: 426.9064s
	iters: 700, epoch: 9 | loss: 0.0613472
	speed: 0.0417s/iter; left time: 423.0093s
	iters: 800, epoch: 9 | loss: 0.0655759
	speed: 0.0416s/iter; left time: 418.0862s
	iters: 900, epoch: 9 | loss: 0.0630118
	speed: 0.0416s/iter; left time: 413.9156s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.88s
Steps: 904 | Train Loss: 0.0675159 Vali Loss: 0.0817569 Test Loss: 0.0939381
EarlyStopping counter: 1 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0707889
	speed: 0.1139s/iter; left time: 1121.5378s
	iters: 200, epoch: 10 | loss: 0.0646257
	speed: 0.0416s/iter; left time: 404.9200s
	iters: 300, epoch: 10 | loss: 0.0597870
	speed: 0.0416s/iter; left time: 400.9223s
	iters: 400, epoch: 10 | loss: 0.0606851
	speed: 0.0416s/iter; left time: 396.6420s
	iters: 500, epoch: 10 | loss: 0.0722949
	speed: 0.0416s/iter; left time: 392.6873s
	iters: 600, epoch: 10 | loss: 0.0613441
	speed: 0.0416s/iter; left time: 388.6736s
	iters: 700, epoch: 10 | loss: 0.0637856
	speed: 0.0415s/iter; left time: 384.0569s
	iters: 800, epoch: 10 | loss: 0.0674466
	speed: 0.0416s/iter; left time: 379.9879s
	iters: 900, epoch: 10 | loss: 0.0660359
	speed: 0.0416s/iter; left time: 375.8863s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:37.82s
Steps: 904 | Train Loss: 0.0650114 Vali Loss: 0.0814649 Test Loss: 0.0932802
EarlyStopping counter: 2 out of 5
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.0628955
	speed: 0.1127s/iter; left time: 1008.0033s
	iters: 200, epoch: 11 | loss: 0.0667712
	speed: 0.0415s/iter; left time: 367.2613s
	iters: 300, epoch: 11 | loss: 0.0622564
	speed: 0.0416s/iter; left time: 363.2537s
	iters: 400, epoch: 11 | loss: 0.0667247
	speed: 0.0416s/iter; left time: 359.2532s
	iters: 500, epoch: 11 | loss: 0.0588989
	speed: 0.0415s/iter; left time: 354.7833s
	iters: 600, epoch: 11 | loss: 0.0601503
	speed: 0.0416s/iter; left time: 350.7901s
	iters: 700, epoch: 11 | loss: 0.0651884
	speed: 0.0416s/iter; left time: 346.7569s
	iters: 800, epoch: 11 | loss: 0.0648965
	speed: 0.0416s/iter; left time: 342.6994s
	iters: 900, epoch: 11 | loss: 0.0662556
	speed: 0.0416s/iter; left time: 338.4072s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:37.79s
Steps: 904 | Train Loss: 0.0628507 Vali Loss: 0.0824759 Test Loss: 0.0953183
EarlyStopping counter: 3 out of 5
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.0586193
	speed: 0.1130s/iter; left time: 908.5539s
	iters: 200, epoch: 12 | loss: 0.0632593
	speed: 0.0416s/iter; left time: 329.8416s
	iters: 300, epoch: 12 | loss: 0.0581805
	speed: 0.0416s/iter; left time: 325.7241s
	iters: 400, epoch: 12 | loss: 0.0527286
	speed: 0.0416s/iter; left time: 321.5225s
	iters: 500, epoch: 12 | loss: 0.0617137
	speed: 0.0416s/iter; left time: 317.4147s
	iters: 600, epoch: 12 | loss: 0.0588900
	speed: 0.0416s/iter; left time: 313.2914s
	iters: 700, epoch: 12 | loss: 0.0644570
	speed: 0.0417s/iter; left time: 309.8406s
	iters: 800, epoch: 12 | loss: 0.0602104
	speed: 0.0417s/iter; left time: 305.8512s
	iters: 900, epoch: 12 | loss: 0.0594495
	speed: 0.0416s/iter; left time: 301.2144s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:37.82s
Steps: 904 | Train Loss: 0.0606359 Vali Loss: 0.0830488 Test Loss: 0.0953343
EarlyStopping counter: 4 out of 5
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.0596162
	speed: 0.1130s/iter; left time: 806.0487s
	iters: 200, epoch: 13 | loss: 0.0571232
	speed: 0.0416s/iter; left time: 292.3219s
	iters: 300, epoch: 13 | loss: 0.0555218
	speed: 0.0415s/iter; left time: 287.8518s
	iters: 400, epoch: 13 | loss: 0.0576127
	speed: 0.0415s/iter; left time: 283.6851s
	iters: 500, epoch: 13 | loss: 0.0613527
	speed: 0.0415s/iter; left time: 279.6292s
	iters: 600, epoch: 13 | loss: 0.0561092
	speed: 0.0415s/iter; left time: 275.5358s
	iters: 700, epoch: 13 | loss: 0.0549113
	speed: 0.0415s/iter; left time: 271.2652s
	iters: 800, epoch: 13 | loss: 0.0601151
	speed: 0.0415s/iter; left time: 267.0093s
	iters: 900, epoch: 13 | loss: 0.0564174
	speed: 0.0415s/iter; left time: 262.8507s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:37.78s
Steps: 904 | Train Loss: 0.0588037 Vali Loss: 0.0848033 Test Loss: 0.0960292
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.022316191345453262, rmse:0.14938604831695557, mae:0.09133996814489365, rse:0.5648447275161743
Original data scale mse:3587957.25, rmse:1894.1904296875, mae:1209.4962158203125, rse:0.13330191373825073
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2292959
	speed: 0.0436s/iter; left time: 784.4314s
	iters: 200, epoch: 1 | loss: 0.2081810
	speed: 0.0415s/iter; left time: 742.3908s
	iters: 300, epoch: 1 | loss: 0.2096158
	speed: 0.0415s/iter; left time: 738.3307s
	iters: 400, epoch: 1 | loss: 0.2077726
	speed: 0.0416s/iter; left time: 734.9492s
	iters: 500, epoch: 1 | loss: 0.1998558
	speed: 0.0416s/iter; left time: 731.0103s
	iters: 600, epoch: 1 | loss: 0.1957197
	speed: 0.0416s/iter; left time: 727.4164s
	iters: 700, epoch: 1 | loss: 0.1891191
	speed: 0.0416s/iter; left time: 723.2605s
	iters: 800, epoch: 1 | loss: 0.1786730
	speed: 0.0416s/iter; left time: 718.6975s
	iters: 900, epoch: 1 | loss: 0.1799013
	speed: 0.0417s/iter; left time: 715.6068s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.85s
Steps: 904 | Train Loss: 0.2049319 Vali Loss: 0.1680077 Test Loss: 0.1860517
Validation loss decreased (inf --> 0.168008).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1652640
	speed: 0.1172s/iter; left time: 2000.7531s
	iters: 200, epoch: 2 | loss: 0.1542776
	speed: 0.0416s/iter; left time: 705.5053s
	iters: 300, epoch: 2 | loss: 0.1318608
	speed: 0.0416s/iter; left time: 701.3330s
	iters: 400, epoch: 2 | loss: 0.1279899
	speed: 0.0415s/iter; left time: 696.5773s
	iters: 500, epoch: 2 | loss: 0.1211760
	speed: 0.0416s/iter; left time: 693.3474s
	iters: 600, epoch: 2 | loss: 0.1045376
	speed: 0.0415s/iter; left time: 688.4711s
	iters: 700, epoch: 2 | loss: 0.1058448
	speed: 0.0416s/iter; left time: 684.6972s
	iters: 800, epoch: 2 | loss: 0.0937553
	speed: 0.0416s/iter; left time: 680.5882s
	iters: 900, epoch: 2 | loss: 0.0992664
	speed: 0.0415s/iter; left time: 676.1729s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.88s
Steps: 904 | Train Loss: 0.1267896 Vali Loss: 0.0913177 Test Loss: 0.0968462
Validation loss decreased (0.168008 --> 0.091318).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0841759
	speed: 0.1158s/iter; left time: 1873.2858s
	iters: 200, epoch: 3 | loss: 0.0893953
	speed: 0.0416s/iter; left time: 669.0539s
	iters: 300, epoch: 3 | loss: 0.0954204
	speed: 0.0416s/iter; left time: 664.5233s
	iters: 400, epoch: 3 | loss: 0.1050853
	speed: 0.0416s/iter; left time: 660.1259s
	iters: 500, epoch: 3 | loss: 0.0887890
	speed: 0.0416s/iter; left time: 656.1868s
	iters: 600, epoch: 3 | loss: 0.0911384
	speed: 0.0416s/iter; left time: 652.0109s
	iters: 700, epoch: 3 | loss: 0.0956997
	speed: 0.0416s/iter; left time: 648.1649s
	iters: 800, epoch: 3 | loss: 0.0855911
	speed: 0.0416s/iter; left time: 643.8648s
	iters: 900, epoch: 3 | loss: 0.0926109
	speed: 0.0416s/iter; left time: 639.6259s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.86s
Steps: 904 | Train Loss: 0.0894015 Vali Loss: 0.0832333 Test Loss: 0.0903517
Validation loss decreased (0.091318 --> 0.083233).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0818864
	speed: 0.1160s/iter; left time: 1771.7134s
	iters: 200, epoch: 4 | loss: 0.0908587
	speed: 0.0415s/iter; left time: 629.9923s
	iters: 300, epoch: 4 | loss: 0.0815956
	speed: 0.0415s/iter; left time: 626.0588s
	iters: 400, epoch: 4 | loss: 0.0794364
	speed: 0.0416s/iter; left time: 622.1080s
	iters: 500, epoch: 4 | loss: 0.0824227
	speed: 0.0416s/iter; left time: 617.8755s
	iters: 600, epoch: 4 | loss: 0.0863480
	speed: 0.0416s/iter; left time: 614.6422s
	iters: 700, epoch: 4 | loss: 0.0751134
	speed: 0.0415s/iter; left time: 609.2223s
	iters: 800, epoch: 4 | loss: 0.0925940
	speed: 0.0416s/iter; left time: 605.8829s
	iters: 900, epoch: 4 | loss: 0.0779531
	speed: 0.0415s/iter; left time: 600.9640s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.85s
Steps: 904 | Train Loss: 0.0827076 Vali Loss: 0.0849494 Test Loss: 0.0960318
EarlyStopping counter: 1 out of 5
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0767040
	speed: 0.1133s/iter; left time: 1627.2919s
	iters: 200, epoch: 5 | loss: 0.0699800
	speed: 0.0416s/iter; left time: 593.4614s
	iters: 300, epoch: 5 | loss: 0.0853455
	speed: 0.0417s/iter; left time: 589.9893s
	iters: 400, epoch: 5 | loss: 0.0704516
	speed: 0.0416s/iter; left time: 585.7014s
	iters: 500, epoch: 5 | loss: 0.0756307
	speed: 0.0416s/iter; left time: 581.3195s
	iters: 600, epoch: 5 | loss: 0.0742427
	speed: 0.0416s/iter; left time: 577.2092s
	iters: 700, epoch: 5 | loss: 0.0752169
	speed: 0.0417s/iter; left time: 573.5065s
	iters: 800, epoch: 5 | loss: 0.0806310
	speed: 0.0417s/iter; left time: 569.2082s
	iters: 900, epoch: 5 | loss: 0.0723156
	speed: 0.0416s/iter; left time: 564.3980s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.88s
Steps: 904 | Train Loss: 0.0782667 Vali Loss: 0.0774129 Test Loss: 0.0860390
Validation loss decreased (0.083233 --> 0.077413).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0741043
	speed: 0.1167s/iter; left time: 1571.4782s
	iters: 200, epoch: 6 | loss: 0.0707103
	speed: 0.0415s/iter; left time: 555.0698s
	iters: 300, epoch: 6 | loss: 0.0718977
	speed: 0.0415s/iter; left time: 550.8301s
	iters: 400, epoch: 6 | loss: 0.0712616
	speed: 0.0415s/iter; left time: 546.6244s
	iters: 500, epoch: 6 | loss: 0.0730634
	speed: 0.0415s/iter; left time: 542.5050s
	iters: 600, epoch: 6 | loss: 0.0824830
	speed: 0.0415s/iter; left time: 538.4869s
	iters: 700, epoch: 6 | loss: 0.0697925
	speed: 0.0416s/iter; left time: 534.3990s
	iters: 800, epoch: 6 | loss: 0.0703837
	speed: 0.0415s/iter; left time: 529.9483s
	iters: 900, epoch: 6 | loss: 0.0704858
	speed: 0.0415s/iter; left time: 526.0207s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.86s
Steps: 904 | Train Loss: 0.0749824 Vali Loss: 0.0792238 Test Loss: 0.0932515
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0748432
	speed: 0.1137s/iter; left time: 1428.2696s
	iters: 200, epoch: 7 | loss: 0.0809488
	speed: 0.0417s/iter; left time: 519.5531s
	iters: 300, epoch: 7 | loss: 0.0747016
	speed: 0.0416s/iter; left time: 514.5460s
	iters: 400, epoch: 7 | loss: 0.0723035
	speed: 0.0416s/iter; left time: 510.0456s
	iters: 500, epoch: 7 | loss: 0.0700389
	speed: 0.0416s/iter; left time: 505.7433s
	iters: 600, epoch: 7 | loss: 0.0682066
	speed: 0.0417s/iter; left time: 502.3680s
	iters: 700, epoch: 7 | loss: 0.0772949
	speed: 0.0416s/iter; left time: 497.8219s
	iters: 800, epoch: 7 | loss: 0.0649828
	speed: 0.0416s/iter; left time: 493.5770s
	iters: 900, epoch: 7 | loss: 0.0713191
	speed: 0.0416s/iter; left time: 489.6683s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.90s
Steps: 904 | Train Loss: 0.0719335 Vali Loss: 0.0794691 Test Loss: 0.0918467
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0724586
	speed: 0.1132s/iter; left time: 1318.6076s
	iters: 200, epoch: 8 | loss: 0.0715756
	speed: 0.0415s/iter; left time: 479.9574s
	iters: 300, epoch: 8 | loss: 0.0657794
	speed: 0.0415s/iter; left time: 475.8581s
	iters: 400, epoch: 8 | loss: 0.0654476
	speed: 0.0415s/iter; left time: 471.5701s
	iters: 500, epoch: 8 | loss: 0.0704021
	speed: 0.0415s/iter; left time: 467.3692s
	iters: 600, epoch: 8 | loss: 0.0675833
	speed: 0.0416s/iter; left time: 463.7433s
	iters: 700, epoch: 8 | loss: 0.0698371
	speed: 0.0417s/iter; left time: 460.4970s
	iters: 800, epoch: 8 | loss: 0.0766558
	speed: 0.0417s/iter; left time: 456.3488s
	iters: 900, epoch: 8 | loss: 0.0691651
	speed: 0.0416s/iter; left time: 451.5233s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.81s
Steps: 904 | Train Loss: 0.0692788 Vali Loss: 0.0809576 Test Loss: 0.0899754
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0643936
	speed: 0.1139s/iter; left time: 1224.2093s
	iters: 200, epoch: 9 | loss: 0.0613265
	speed: 0.0416s/iter; left time: 443.4043s
	iters: 300, epoch: 9 | loss: 0.0656117
	speed: 0.0416s/iter; left time: 438.8676s
	iters: 400, epoch: 9 | loss: 0.0665474
	speed: 0.0416s/iter; left time: 434.8444s
	iters: 500, epoch: 9 | loss: 0.0646721
	speed: 0.0417s/iter; left time: 431.0723s
	iters: 600, epoch: 9 | loss: 0.0673045
	speed: 0.0416s/iter; left time: 426.7336s
	iters: 700, epoch: 9 | loss: 0.0699422
	speed: 0.0416s/iter; left time: 422.3595s
	iters: 800, epoch: 9 | loss: 0.0713633
	speed: 0.0416s/iter; left time: 418.3219s
	iters: 900, epoch: 9 | loss: 0.0673369
	speed: 0.0416s/iter; left time: 413.8153s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.91s
Steps: 904 | Train Loss: 0.0662697 Vali Loss: 0.0811222 Test Loss: 0.0916531
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0716086
	speed: 0.1139s/iter; left time: 1121.3967s
	iters: 200, epoch: 10 | loss: 0.0616231
	speed: 0.0416s/iter; left time: 405.7231s
	iters: 300, epoch: 10 | loss: 0.0624919
	speed: 0.0416s/iter; left time: 401.6778s
	iters: 400, epoch: 10 | loss: 0.0612750
	speed: 0.0416s/iter; left time: 396.9229s
	iters: 500, epoch: 10 | loss: 0.0687094
	speed: 0.0416s/iter; left time: 392.6401s
	iters: 600, epoch: 10 | loss: 0.0689967
	speed: 0.0416s/iter; left time: 388.3892s
	iters: 700, epoch: 10 | loss: 0.0666971
	speed: 0.0416s/iter; left time: 384.5630s
	iters: 800, epoch: 10 | loss: 0.0618813
	speed: 0.0416s/iter; left time: 380.4564s
	iters: 900, epoch: 10 | loss: 0.0615688
	speed: 0.0416s/iter; left time: 376.0103s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:37.88s
Steps: 904 | Train Loss: 0.0640776 Vali Loss: 0.0819628 Test Loss: 0.0911019
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.019260551780462265, rmse:0.13878239691257477, mae:0.08605317771434784, rse:0.5247511863708496
Original data scale mse:3035685.0, rmse:1742.32177734375, mae:1125.773193359375, rse:0.1226142942905426

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.022316191345453262, RMSE: 0.14938604831695557, MAE: 0.09133996814489365, RSE: 0.5648447275161743
Unscaled Metrics - MSE: 3587957.25, RMSE: 1894.1904296875, MAE: 1209.4962158203125, RSE: 0.13330191373825073

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.019260551780462265, RMSE: 0.13878239691257477, MAE: 0.08605317771434784, RSE: 0.5247511863708496
Unscaled Metrics - MSE: 3035685.0, RMSE: 1742.32177734375, MAE: 1125.773193359375, RSE: 0.1226142942905426

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='minmax', if_relu=True, channel_mixing=0, seq_len=96, label_len=48, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=5, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2417706
	speed: 0.0732s/iter; left time: 1313.6734s
	iters: 200, epoch: 1 | loss: 0.2105667
	speed: 0.0502s/iter; left time: 894.7541s
	iters: 300, epoch: 1 | loss: 0.2133086
	speed: 0.0501s/iter; left time: 889.6829s
	iters: 400, epoch: 1 | loss: 0.2001980
	speed: 0.0501s/iter; left time: 884.3414s
	iters: 500, epoch: 1 | loss: 0.1996722
	speed: 0.0502s/iter; left time: 879.6867s
	iters: 600, epoch: 1 | loss: 0.1957152
	speed: 0.0502s/iter; left time: 875.2917s
	iters: 700, epoch: 1 | loss: 0.1911985
	speed: 0.0501s/iter; left time: 869.5728s
	iters: 800, epoch: 1 | loss: 0.1923567
	speed: 0.0502s/iter; left time: 865.2195s
	iters: 900, epoch: 1 | loss: 0.1911421
	speed: 0.0502s/iter; left time: 860.4972s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:45.98s
Steps: 902 | Train Loss: 0.2067105 Vali Loss: 0.1742837 Test Loss: 0.1910858
Validation loss decreased (inf --> 0.174284).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1741898
	speed: 0.1404s/iter; left time: 2392.3116s
	iters: 200, epoch: 2 | loss: 0.1590756
	speed: 0.0506s/iter; left time: 857.9386s
	iters: 300, epoch: 2 | loss: 0.1492482
	speed: 0.0505s/iter; left time: 850.1480s
	iters: 400, epoch: 2 | loss: 0.1439626
	speed: 0.0508s/iter; left time: 850.4616s
	iters: 500, epoch: 2 | loss: 0.1376841
	speed: 0.0508s/iter; left time: 845.3795s
	iters: 600, epoch: 2 | loss: 0.1318157
	speed: 0.0508s/iter; left time: 839.8752s
	iters: 700, epoch: 2 | loss: 0.1226903
	speed: 0.0508s/iter; left time: 834.9961s
	iters: 800, epoch: 2 | loss: 0.1155013
	speed: 0.0507s/iter; left time: 827.6535s
	iters: 900, epoch: 2 | loss: 0.1036045
	speed: 0.0507s/iter; left time: 823.0407s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.06s
Steps: 902 | Train Loss: 0.1425180 Vali Loss: 0.0997220 Test Loss: 0.1080564
Validation loss decreased (0.174284 --> 0.099722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1070874
	speed: 0.1398s/iter; left time: 2256.4475s
	iters: 200, epoch: 3 | loss: 0.0982135
	speed: 0.0504s/iter; left time: 808.1067s
	iters: 300, epoch: 3 | loss: 0.0975068
	speed: 0.0504s/iter; left time: 802.6138s
	iters: 400, epoch: 3 | loss: 0.0913634
	speed: 0.0504s/iter; left time: 797.4300s
	iters: 500, epoch: 3 | loss: 0.0938966
	speed: 0.0503s/iter; left time: 791.4884s
	iters: 600, epoch: 3 | loss: 0.0963875
	speed: 0.0503s/iter; left time: 786.6601s
	iters: 700, epoch: 3 | loss: 0.0930466
	speed: 0.0503s/iter; left time: 781.5806s
	iters: 800, epoch: 3 | loss: 0.0894339
	speed: 0.0503s/iter; left time: 776.8466s
	iters: 900, epoch: 3 | loss: 0.0931466
	speed: 0.0503s/iter; left time: 771.8152s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:45.67s
Steps: 902 | Train Loss: 0.0965498 Vali Loss: 0.0912357 Test Loss: 0.1002337
Validation loss decreased (0.099722 --> 0.091236).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0912320
	speed: 0.1397s/iter; left time: 2128.0002s
	iters: 200, epoch: 4 | loss: 0.0867965
	speed: 0.0505s/iter; left time: 764.5297s
	iters: 300, epoch: 4 | loss: 0.0868980
	speed: 0.0508s/iter; left time: 763.2987s
	iters: 400, epoch: 4 | loss: 0.0909916
	speed: 0.0508s/iter; left time: 759.0966s
	iters: 500, epoch: 4 | loss: 0.0869087
	speed: 0.0506s/iter; left time: 751.0372s
	iters: 600, epoch: 4 | loss: 0.0885214
	speed: 0.0503s/iter; left time: 741.4114s
	iters: 700, epoch: 4 | loss: 0.0855719
	speed: 0.0503s/iter; left time: 736.5400s
	iters: 800, epoch: 4 | loss: 0.0911454
	speed: 0.0503s/iter; left time: 731.5811s
	iters: 900, epoch: 4 | loss: 0.0852361
	speed: 0.0504s/iter; left time: 728.0232s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.86s
Steps: 902 | Train Loss: 0.0885773 Vali Loss: 0.0855312 Test Loss: 0.0943597
Validation loss decreased (0.091236 --> 0.085531).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0867432
	speed: 0.1398s/iter; left time: 2003.7861s
	iters: 200, epoch: 5 | loss: 0.0810685
	speed: 0.0504s/iter; left time: 716.7022s
	iters: 300, epoch: 5 | loss: 0.0855442
	speed: 0.0503s/iter; left time: 710.7386s
	iters: 400, epoch: 5 | loss: 0.0874002
	speed: 0.0503s/iter; left time: 706.4313s
	iters: 500, epoch: 5 | loss: 0.0819072
	speed: 0.0503s/iter; left time: 701.0007s
	iters: 600, epoch: 5 | loss: 0.0860219
	speed: 0.0503s/iter; left time: 695.7446s
	iters: 700, epoch: 5 | loss: 0.0811444
	speed: 0.0503s/iter; left time: 691.2264s
	iters: 800, epoch: 5 | loss: 0.0809208
	speed: 0.0503s/iter; left time: 686.3793s
	iters: 900, epoch: 5 | loss: 0.0855082
	speed: 0.0503s/iter; left time: 680.7643s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:45.66s
Steps: 902 | Train Loss: 0.0836334 Vali Loss: 0.0855765 Test Loss: 0.0958990
EarlyStopping counter: 1 out of 5
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0837307
	speed: 0.1368s/iter; left time: 1837.7812s
	iters: 200, epoch: 6 | loss: 0.0879220
	speed: 0.0503s/iter; left time: 670.4094s
	iters: 300, epoch: 6 | loss: 0.0843503
	speed: 0.0503s/iter; left time: 665.8380s
	iters: 400, epoch: 6 | loss: 0.0791846
	speed: 0.0503s/iter; left time: 660.8877s
	iters: 500, epoch: 6 | loss: 0.0788330
	speed: 0.0504s/iter; left time: 656.2666s
	iters: 600, epoch: 6 | loss: 0.0786551
	speed: 0.0504s/iter; left time: 651.1553s
	iters: 700, epoch: 6 | loss: 0.0774791
	speed: 0.0503s/iter; left time: 645.0547s
	iters: 800, epoch: 6 | loss: 0.0832842
	speed: 0.0503s/iter; left time: 640.0853s
	iters: 900, epoch: 6 | loss: 0.0777149
	speed: 0.0503s/iter; left time: 634.8439s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.61s
Steps: 902 | Train Loss: 0.0799680 Vali Loss: 0.0855314 Test Loss: 0.0941967
EarlyStopping counter: 2 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0832227
	speed: 0.1360s/iter; left time: 1704.5641s
	iters: 200, epoch: 7 | loss: 0.0769130
	speed: 0.0504s/iter; left time: 626.0757s
	iters: 300, epoch: 7 | loss: 0.0797686
	speed: 0.0504s/iter; left time: 620.8238s
	iters: 400, epoch: 7 | loss: 0.0803033
	speed: 0.0504s/iter; left time: 615.8619s
	iters: 500, epoch: 7 | loss: 0.0713358
	speed: 0.0504s/iter; left time: 611.4078s
	iters: 600, epoch: 7 | loss: 0.0767121
	speed: 0.0504s/iter; left time: 606.4078s
	iters: 700, epoch: 7 | loss: 0.0724495
	speed: 0.0504s/iter; left time: 601.4697s
	iters: 800, epoch: 7 | loss: 0.0772860
	speed: 0.0503s/iter; left time: 595.1761s
	iters: 900, epoch: 7 | loss: 0.0758775
	speed: 0.0503s/iter; left time: 589.9143s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:45.68s
Steps: 902 | Train Loss: 0.0763688 Vali Loss: 0.0862588 Test Loss: 0.0960034
EarlyStopping counter: 3 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0746740
	speed: 0.1361s/iter; left time: 1582.0123s
	iters: 200, epoch: 8 | loss: 0.0710704
	speed: 0.0503s/iter; left time: 579.7476s
	iters: 300, epoch: 8 | loss: 0.0767001
	speed: 0.0503s/iter; left time: 574.4545s
	iters: 400, epoch: 8 | loss: 0.0722365
	speed: 0.0503s/iter; left time: 569.7450s
	iters: 500, epoch: 8 | loss: 0.0735169
	speed: 0.0503s/iter; left time: 564.7603s
	iters: 600, epoch: 8 | loss: 0.0702938
	speed: 0.0503s/iter; left time: 559.6372s
	iters: 700, epoch: 8 | loss: 0.0752317
	speed: 0.0503s/iter; left time: 554.7130s
	iters: 800, epoch: 8 | loss: 0.0745411
	speed: 0.0504s/iter; left time: 550.5014s
	iters: 900, epoch: 8 | loss: 0.0704616
	speed: 0.0504s/iter; left time: 545.3479s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:45.65s
Steps: 902 | Train Loss: 0.0728395 Vali Loss: 0.0874766 Test Loss: 0.0982277
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0669056
	speed: 0.1367s/iter; left time: 1466.3744s
	iters: 200, epoch: 9 | loss: 0.0704915
	speed: 0.0503s/iter; left time: 534.9016s
	iters: 300, epoch: 9 | loss: 0.0730468
	speed: 0.0504s/iter; left time: 530.0172s
	iters: 400, epoch: 9 | loss: 0.0681769
	speed: 0.0504s/iter; left time: 525.0744s
	iters: 500, epoch: 9 | loss: 0.0706938
	speed: 0.0503s/iter; left time: 519.4402s
	iters: 600, epoch: 9 | loss: 0.0717596
	speed: 0.0503s/iter; left time: 514.7432s
	iters: 700, epoch: 9 | loss: 0.0657810
	speed: 0.0504s/iter; left time: 509.9126s
	iters: 800, epoch: 9 | loss: 0.0699422
	speed: 0.0503s/iter; left time: 504.3844s
	iters: 900, epoch: 9 | loss: 0.0668692
	speed: 0.0504s/iter; left time: 500.1502s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:45.70s
Steps: 902 | Train Loss: 0.0693792 Vali Loss: 0.0873247 Test Loss: 0.0969773
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.020803824067115784, rmse:0.14423531293869019, mae:0.09436223655939102, rse:0.5457460880279541
Original data scale mse:4198082.0, rmse:2048.922119140625, mae:1319.8297119140625, rse:0.14432641863822937
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2284859
	speed: 0.0528s/iter; left time: 947.9565s
	iters: 200, epoch: 1 | loss: 0.2267227
	speed: 0.0505s/iter; left time: 901.1121s
	iters: 300, epoch: 1 | loss: 0.2108397
	speed: 0.0507s/iter; left time: 899.8530s
	iters: 400, epoch: 1 | loss: 0.2069933
	speed: 0.0507s/iter; left time: 894.1343s
	iters: 500, epoch: 1 | loss: 0.2013356
	speed: 0.0507s/iter; left time: 890.0209s
	iters: 600, epoch: 1 | loss: 0.1998173
	speed: 0.0507s/iter; left time: 884.9019s
	iters: 700, epoch: 1 | loss: 0.1979535
	speed: 0.0508s/iter; left time: 880.6791s
	iters: 800, epoch: 1 | loss: 0.1894962
	speed: 0.0509s/iter; left time: 878.1609s
	iters: 900, epoch: 1 | loss: 0.1864503
	speed: 0.0510s/iter; left time: 874.2594s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.06s
Steps: 902 | Train Loss: 0.2082656 Vali Loss: 0.1732536 Test Loss: 0.1907203
Validation loss decreased (inf --> 0.173254).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1713080
	speed: 0.1459s/iter; left time: 2486.1602s
	iters: 200, epoch: 2 | loss: 0.1709103
	speed: 0.0508s/iter; left time: 860.4514s
	iters: 300, epoch: 2 | loss: 0.1648743
	speed: 0.0508s/iter; left time: 854.9622s
	iters: 400, epoch: 2 | loss: 0.1496821
	speed: 0.0508s/iter; left time: 850.6620s
	iters: 500, epoch: 2 | loss: 0.1361954
	speed: 0.0508s/iter; left time: 845.3745s
	iters: 600, epoch: 2 | loss: 0.1361084
	speed: 0.0508s/iter; left time: 839.6243s
	iters: 700, epoch: 2 | loss: 0.1295184
	speed: 0.0508s/iter; left time: 834.8571s
	iters: 800, epoch: 2 | loss: 0.1168782
	speed: 0.0508s/iter; left time: 829.9455s
	iters: 900, epoch: 2 | loss: 0.1084049
	speed: 0.0508s/iter; left time: 824.8439s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.09s
Steps: 902 | Train Loss: 0.1460171 Vali Loss: 0.0987828 Test Loss: 0.1063009
Validation loss decreased (0.173254 --> 0.098783).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1028040
	speed: 0.1430s/iter; left time: 2307.4413s
	iters: 200, epoch: 3 | loss: 0.1012544
	speed: 0.0503s/iter; left time: 807.3088s
	iters: 300, epoch: 3 | loss: 0.0942322
	speed: 0.0503s/iter; left time: 802.0428s
	iters: 400, epoch: 3 | loss: 0.0913546
	speed: 0.0503s/iter; left time: 797.3676s
	iters: 500, epoch: 3 | loss: 0.0966000
	speed: 0.0504s/iter; left time: 792.4710s
	iters: 600, epoch: 3 | loss: 0.0914325
	speed: 0.0504s/iter; left time: 787.6114s
	iters: 700, epoch: 3 | loss: 0.0900648
	speed: 0.0503s/iter; left time: 782.1404s
	iters: 800, epoch: 3 | loss: 0.0941671
	speed: 0.0504s/iter; left time: 777.6173s
	iters: 900, epoch: 3 | loss: 0.0972075
	speed: 0.0504s/iter; left time: 772.6439s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:45.74s
Steps: 902 | Train Loss: 0.0964605 Vali Loss: 0.0890032 Test Loss: 0.0937895
Validation loss decreased (0.098783 --> 0.089003).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0857249
	speed: 0.1408s/iter; left time: 2145.1603s
	iters: 200, epoch: 4 | loss: 0.0923728
	speed: 0.0504s/iter; left time: 762.7480s
	iters: 300, epoch: 4 | loss: 0.0903793
	speed: 0.0504s/iter; left time: 757.0812s
	iters: 400, epoch: 4 | loss: 0.0886440
	speed: 0.0503s/iter; left time: 750.9803s
	iters: 500, epoch: 4 | loss: 0.0932834
	speed: 0.0503s/iter; left time: 746.6138s
	iters: 600, epoch: 4 | loss: 0.0853107
	speed: 0.0504s/iter; left time: 742.2900s
	iters: 700, epoch: 4 | loss: 0.0900107
	speed: 0.0503s/iter; left time: 735.8664s
	iters: 800, epoch: 4 | loss: 0.0842938
	speed: 0.0503s/iter; left time: 730.7650s
	iters: 900, epoch: 4 | loss: 0.0850098
	speed: 0.0503s/iter; left time: 726.5279s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.69s
Steps: 902 | Train Loss: 0.0881512 Vali Loss: 0.0848641 Test Loss: 0.0966458
Validation loss decreased (0.089003 --> 0.084864).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0882770
	speed: 0.1405s/iter; left time: 2014.4634s
	iters: 200, epoch: 5 | loss: 0.0824666
	speed: 0.0504s/iter; left time: 717.1276s
	iters: 300, epoch: 5 | loss: 0.0812579
	speed: 0.0504s/iter; left time: 713.0051s
	iters: 400, epoch: 5 | loss: 0.0867619
	speed: 0.0505s/iter; left time: 708.2942s
	iters: 500, epoch: 5 | loss: 0.0906413
	speed: 0.0504s/iter; left time: 702.6749s
	iters: 600, epoch: 5 | loss: 0.0816955
	speed: 0.0503s/iter; left time: 696.1346s
	iters: 700, epoch: 5 | loss: 0.0825760
	speed: 0.0503s/iter; left time: 690.8054s
	iters: 800, epoch: 5 | loss: 0.0871430
	speed: 0.0503s/iter; left time: 686.2776s
	iters: 900, epoch: 5 | loss: 0.0818188
	speed: 0.0503s/iter; left time: 681.1906s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:45.73s
Steps: 902 | Train Loss: 0.0832878 Vali Loss: 0.0822736 Test Loss: 0.0991102
Validation loss decreased (0.084864 --> 0.082274).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0807753
	speed: 0.1439s/iter; left time: 1932.1154s
	iters: 200, epoch: 6 | loss: 0.0926194
	speed: 0.0508s/iter; left time: 677.6089s
	iters: 300, epoch: 6 | loss: 0.0734528
	speed: 0.0508s/iter; left time: 672.2760s
	iters: 400, epoch: 6 | loss: 0.0836199
	speed: 0.0509s/iter; left time: 667.9432s
	iters: 500, epoch: 6 | loss: 0.0807985
	speed: 0.0508s/iter; left time: 662.2467s
	iters: 600, epoch: 6 | loss: 0.0781274
	speed: 0.0509s/iter; left time: 658.2782s
	iters: 700, epoch: 6 | loss: 0.0795121
	speed: 0.0511s/iter; left time: 655.3439s
	iters: 800, epoch: 6 | loss: 0.0790593
	speed: 0.0508s/iter; left time: 646.2384s
	iters: 900, epoch: 6 | loss: 0.0770177
	speed: 0.0504s/iter; left time: 636.5361s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.12s
Steps: 902 | Train Loss: 0.0793978 Vali Loss: 0.0833777 Test Loss: 0.0989826
EarlyStopping counter: 1 out of 5
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0754626
	speed: 0.1371s/iter; left time: 1717.5762s
	iters: 200, epoch: 7 | loss: 0.0837843
	speed: 0.0505s/iter; left time: 627.0626s
	iters: 300, epoch: 7 | loss: 0.0735349
	speed: 0.0505s/iter; left time: 622.5638s
	iters: 400, epoch: 7 | loss: 0.0791819
	speed: 0.0509s/iter; left time: 621.9647s
	iters: 500, epoch: 7 | loss: 0.0693690
	speed: 0.0508s/iter; left time: 616.5585s
	iters: 600, epoch: 7 | loss: 0.0743524
	speed: 0.0508s/iter; left time: 611.3922s
	iters: 700, epoch: 7 | loss: 0.0732933
	speed: 0.0508s/iter; left time: 606.3508s
	iters: 800, epoch: 7 | loss: 0.0761782
	speed: 0.0508s/iter; left time: 601.3687s
	iters: 900, epoch: 7 | loss: 0.0737806
	speed: 0.0507s/iter; left time: 594.7946s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:45.98s
Steps: 902 | Train Loss: 0.0760379 Vali Loss: 0.0858319 Test Loss: 0.0968157
EarlyStopping counter: 2 out of 5
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0726987
	speed: 0.1380s/iter; left time: 1604.0718s
	iters: 200, epoch: 8 | loss: 0.0783981
	speed: 0.0509s/iter; left time: 586.4848s
	iters: 300, epoch: 8 | loss: 0.0806944
	speed: 0.0509s/iter; left time: 581.1668s
	iters: 400, epoch: 8 | loss: 0.0715075
	speed: 0.0509s/iter; left time: 576.2698s
	iters: 500, epoch: 8 | loss: 0.0750728
	speed: 0.0507s/iter; left time: 569.6230s
	iters: 600, epoch: 8 | loss: 0.0702019
	speed: 0.0505s/iter; left time: 562.2030s
	iters: 700, epoch: 8 | loss: 0.0728789
	speed: 0.0505s/iter; left time: 556.6964s
	iters: 800, epoch: 8 | loss: 0.0746686
	speed: 0.0504s/iter; left time: 551.0053s
	iters: 900, epoch: 8 | loss: 0.0702752
	speed: 0.0509s/iter; left time: 550.8832s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:46.00s
Steps: 902 | Train Loss: 0.0726852 Vali Loss: 0.0867959 Test Loss: 0.0998598
EarlyStopping counter: 3 out of 5
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0709978
	speed: 0.1367s/iter; left time: 1466.3880s
	iters: 200, epoch: 9 | loss: 0.0679601
	speed: 0.0503s/iter; left time: 534.4922s
	iters: 300, epoch: 9 | loss: 0.0751877
	speed: 0.0504s/iter; left time: 530.4816s
	iters: 400, epoch: 9 | loss: 0.0699946
	speed: 0.0509s/iter; left time: 531.0785s
	iters: 500, epoch: 9 | loss: 0.0732694
	speed: 0.0509s/iter; left time: 525.4624s
	iters: 600, epoch: 9 | loss: 0.0649203
	speed: 0.0508s/iter; left time: 519.4839s
	iters: 700, epoch: 9 | loss: 0.0642313
	speed: 0.0504s/iter; left time: 510.6238s
	iters: 800, epoch: 9 | loss: 0.0708400
	speed: 0.0505s/iter; left time: 505.8513s
	iters: 900, epoch: 9 | loss: 0.0663069
	speed: 0.0507s/iter; left time: 502.8069s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:45.89s
Steps: 902 | Train Loss: 0.0691620 Vali Loss: 0.0897910 Test Loss: 0.1007773
EarlyStopping counter: 4 out of 5
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.0708059
	speed: 0.1367s/iter; left time: 1342.4807s
	iters: 200, epoch: 10 | loss: 0.0699524
	speed: 0.0505s/iter; left time: 491.4053s
	iters: 300, epoch: 10 | loss: 0.0707789
	speed: 0.0505s/iter; left time: 485.9362s
	iters: 400, epoch: 10 | loss: 0.0686859
	speed: 0.0504s/iter; left time: 480.0881s
	iters: 500, epoch: 10 | loss: 0.0652517
	speed: 0.0504s/iter; left time: 474.6876s
	iters: 600, epoch: 10 | loss: 0.0646466
	speed: 0.0503s/iter; left time: 469.2621s
	iters: 700, epoch: 10 | loss: 0.0682247
	speed: 0.0505s/iter; left time: 465.4389s
	iters: 800, epoch: 10 | loss: 0.0651449
	speed: 0.0504s/iter; left time: 460.1285s
	iters: 900, epoch: 10 | loss: 0.0604966
	speed: 0.0504s/iter; left time: 454.9785s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:45.75s
Steps: 902 | Train Loss: 0.0659150 Vali Loss: 0.0909240 Test Loss: 0.1030022
EarlyStopping counter: 5 out of 5
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll48_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.023398978635668755, rmse:0.15296724438667297, mae:0.09908542037010193, rse:0.578785240650177
Original data scale mse:5321987.5, rmse:2306.943359375, mae:1452.3974609375, rse:0.1625014841556549

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.020803824067115784, RMSE: 0.14423531293869019, MAE: 0.09436223655939102, RSE: 0.5457460880279541
Unscaled Metrics - MSE: 4198082.0, RMSE: 2048.922119140625, MAE: 1319.8297119140625, RSE: 0.14432641863822937

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.023398978635668755, RMSE: 0.15296724438667297, MAE: 0.09908542037010193, RSE: 0.578785240650177
Unscaled Metrics - MSE: 5321987.5, RMSE: 2306.943359375, MAE: 1452.3974609375, RSE: 0.1625014841556549
