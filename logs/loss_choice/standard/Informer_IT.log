
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.9077650
	speed: 0.0644s/iter; left time: 577.0575s
	iters: 200, epoch: 1 | loss: 0.7206524
	speed: 0.0401s/iter; left time: 355.0800s
	iters: 300, epoch: 1 | loss: 0.5564621
	speed: 0.0388s/iter; left time: 340.1231s
	iters: 400, epoch: 1 | loss: 0.5153261
	speed: 0.0414s/iter; left time: 358.4871s
	iters: 500, epoch: 1 | loss: 0.3779013
	speed: 0.0427s/iter; left time: 365.2457s
	iters: 600, epoch: 1 | loss: 0.3729406
	speed: 0.0419s/iter; left time: 354.7380s
	iters: 700, epoch: 1 | loss: 0.2922451
	speed: 0.0415s/iter; left time: 346.9090s
	iters: 800, epoch: 1 | loss: 0.2991309
	speed: 0.0413s/iter; left time: 341.1050s
	iters: 900, epoch: 1 | loss: 0.3837284
	speed: 0.0412s/iter; left time: 335.9559s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.90s
Steps: 906 | Train Loss: 0.5321539 Vali Loss: 0.3108906 Test Loss: 0.3447380
Validation loss decreased (inf --> 0.310891).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3330117
	speed: 0.1004s/iter; left time: 808.7010s
	iters: 200, epoch: 2 | loss: 0.2729391
	speed: 0.0430s/iter; left time: 341.6900s
	iters: 300, epoch: 2 | loss: 0.2129094
	speed: 0.0425s/iter; left time: 334.1655s
	iters: 400, epoch: 2 | loss: 0.1659483
	speed: 0.0419s/iter; left time: 324.9107s
	iters: 500, epoch: 2 | loss: 0.2437365
	speed: 0.0424s/iter; left time: 324.2546s
	iters: 600, epoch: 2 | loss: 0.2368046
	speed: 0.0427s/iter; left time: 322.6392s
	iters: 700, epoch: 2 | loss: 0.2270562
	speed: 0.0420s/iter; left time: 312.7398s
	iters: 800, epoch: 2 | loss: 0.2221931
	speed: 0.0432s/iter; left time: 317.7437s
	iters: 900, epoch: 2 | loss: 0.2283614
	speed: 0.0430s/iter; left time: 311.8077s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.87s
Steps: 906 | Train Loss: 0.2270178 Vali Loss: 0.2048767 Test Loss: 0.2331024
Validation loss decreased (0.310891 --> 0.204877).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2103239
	speed: 0.1132s/iter; left time: 809.4209s
	iters: 200, epoch: 3 | loss: 0.1660750
	speed: 0.0456s/iter; left time: 321.4504s
	iters: 300, epoch: 3 | loss: 0.2124806
	speed: 0.0462s/iter; left time: 321.1456s
	iters: 400, epoch: 3 | loss: 0.1652551
	speed: 0.0460s/iter; left time: 314.8463s
	iters: 500, epoch: 3 | loss: 0.2328932
	speed: 0.0463s/iter; left time: 312.7546s
	iters: 600, epoch: 3 | loss: 0.1998887
	speed: 0.0422s/iter; left time: 280.9077s
	iters: 700, epoch: 3 | loss: 0.1491173
	speed: 0.0418s/iter; left time: 273.5480s
	iters: 800, epoch: 3 | loss: 0.1747972
	speed: 0.0419s/iter; left time: 270.3579s
	iters: 900, epoch: 3 | loss: 0.1756226
	speed: 0.0417s/iter; left time: 264.7926s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.32s
Steps: 906 | Train Loss: 0.1872182 Vali Loss: 0.1997467 Test Loss: 0.2394210
Validation loss decreased (0.204877 --> 0.199747).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1924419
	speed: 0.1007s/iter; left time: 628.4484s
	iters: 200, epoch: 4 | loss: 0.1605985
	speed: 0.0422s/iter; left time: 259.1858s
	iters: 300, epoch: 4 | loss: 0.1625077
	speed: 0.0420s/iter; left time: 254.0000s
	iters: 400, epoch: 4 | loss: 0.1835384
	speed: 0.0425s/iter; left time: 252.4034s
	iters: 500, epoch: 4 | loss: 0.1403968
	speed: 0.0422s/iter; left time: 246.3518s
	iters: 600, epoch: 4 | loss: 0.2121755
	speed: 0.0421s/iter; left time: 241.8702s
	iters: 700, epoch: 4 | loss: 0.1964207
	speed: 0.0416s/iter; left time: 234.6433s
	iters: 800, epoch: 4 | loss: 0.1895563
	speed: 0.0411s/iter; left time: 227.5900s
	iters: 900, epoch: 4 | loss: 0.2115497
	speed: 0.0417s/iter; left time: 226.9553s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.29s
Steps: 906 | Train Loss: 0.1703408 Vali Loss: 0.1995286 Test Loss: 0.2353900
Validation loss decreased (0.199747 --> 0.199529).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1362432
	speed: 0.1000s/iter; left time: 533.6858s
	iters: 200, epoch: 5 | loss: 0.1369280
	speed: 0.0412s/iter; left time: 215.8790s
	iters: 300, epoch: 5 | loss: 0.1448472
	speed: 0.0413s/iter; left time: 212.0458s
	iters: 400, epoch: 5 | loss: 0.1160104
	speed: 0.0413s/iter; left time: 208.1000s
	iters: 500, epoch: 5 | loss: 0.1775427
	speed: 0.0409s/iter; left time: 201.7746s
	iters: 600, epoch: 5 | loss: 0.1285657
	speed: 0.0414s/iter; left time: 200.3145s
	iters: 700, epoch: 5 | loss: 0.1914375
	speed: 0.0413s/iter; left time: 195.8684s
	iters: 800, epoch: 5 | loss: 0.1294856
	speed: 0.0416s/iter; left time: 193.0099s
	iters: 900, epoch: 5 | loss: 0.1576559
	speed: 0.0410s/iter; left time: 185.8964s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.68s
Steps: 906 | Train Loss: 0.1537165 Vali Loss: 0.1881759 Test Loss: 0.2199492
Validation loss decreased (0.199529 --> 0.188176).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1204349
	speed: 0.1047s/iter; left time: 463.9133s
	iters: 200, epoch: 6 | loss: 0.1661701
	speed: 0.0413s/iter; left time: 178.9601s
	iters: 300, epoch: 6 | loss: 0.1831964
	speed: 0.0411s/iter; left time: 173.8061s
	iters: 400, epoch: 6 | loss: 0.1533017
	speed: 0.0413s/iter; left time: 170.7265s
	iters: 500, epoch: 6 | loss: 0.1412704
	speed: 0.0414s/iter; left time: 166.8351s
	iters: 600, epoch: 6 | loss: 0.1848968
	speed: 0.0413s/iter; left time: 162.2994s
	iters: 700, epoch: 6 | loss: 0.1539993
	speed: 0.0423s/iter; left time: 162.1069s
	iters: 800, epoch: 6 | loss: 0.1590530
	speed: 0.0419s/iter; left time: 156.2689s
	iters: 900, epoch: 6 | loss: 0.1608916
	speed: 0.0416s/iter; left time: 151.0810s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.32s
Steps: 906 | Train Loss: 0.1368363 Vali Loss: 0.1989342 Test Loss: 0.2347656
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1253192
	speed: 0.0975s/iter; left time: 343.5968s
	iters: 200, epoch: 7 | loss: 0.1000210
	speed: 0.0406s/iter; left time: 139.0067s
	iters: 300, epoch: 7 | loss: 0.1024607
	speed: 0.0405s/iter; left time: 134.8230s
	iters: 400, epoch: 7 | loss: 0.1324184
	speed: 0.0409s/iter; left time: 131.8328s
	iters: 500, epoch: 7 | loss: 0.1015832
	speed: 0.0419s/iter; left time: 130.9446s
	iters: 600, epoch: 7 | loss: 0.0832773
	speed: 0.0412s/iter; left time: 124.6605s
	iters: 700, epoch: 7 | loss: 0.0973674
	speed: 0.0412s/iter; left time: 120.4103s
	iters: 800, epoch: 7 | loss: 0.1169297
	speed: 0.0411s/iter; left time: 116.0727s
	iters: 900, epoch: 7 | loss: 0.1258078
	speed: 0.0420s/iter; left time: 114.5577s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.59s
Steps: 906 | Train Loss: 0.1207703 Vali Loss: 0.2017218 Test Loss: 0.2464880
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1069099
	speed: 0.0827s/iter; left time: 216.4715s
	iters: 200, epoch: 8 | loss: 0.1065024
	speed: 0.0283s/iter; left time: 71.2909s
	iters: 300, epoch: 8 | loss: 0.0999009
	speed: 0.0283s/iter; left time: 68.4477s
	iters: 400, epoch: 8 | loss: 0.0856247
	speed: 0.0284s/iter; left time: 65.7728s
	iters: 500, epoch: 8 | loss: 0.1132398
	speed: 0.0283s/iter; left time: 62.8247s
	iters: 600, epoch: 8 | loss: 0.1181563
	speed: 0.0283s/iter; left time: 59.9921s
	iters: 700, epoch: 8 | loss: 0.1022272
	speed: 0.0283s/iter; left time: 57.1278s
	iters: 800, epoch: 8 | loss: 0.0938685
	speed: 0.0283s/iter; left time: 54.3577s
	iters: 900, epoch: 8 | loss: 0.1234807
	speed: 0.0283s/iter; left time: 51.5035s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:25.91s
Steps: 906 | Train Loss: 0.1063426 Vali Loss: 0.2097767 Test Loss: 0.2688747
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2208726555109024, rmse:0.4699709117412567, mae:0.28958678245544434, rse:0.430417001247406
Original data scale mse:1701676.125, rmse:1304.4830322265625, mae:847.7084350585938, rse:0.09166909754276276
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7754775
	speed: 0.0444s/iter; left time: 398.0556s
	iters: 200, epoch: 1 | loss: 0.6727810
	speed: 0.0423s/iter; left time: 374.4800s
	iters: 300, epoch: 1 | loss: 0.5889021
	speed: 0.0421s/iter; left time: 368.5221s
	iters: 400, epoch: 1 | loss: 0.4644165
	speed: 0.0413s/iter; left time: 357.9862s
	iters: 500, epoch: 1 | loss: 0.4481243
	speed: 0.0420s/iter; left time: 359.3925s
	iters: 600, epoch: 1 | loss: 0.3283843
	speed: 0.0421s/iter; left time: 356.3016s
	iters: 700, epoch: 1 | loss: 0.3391944
	speed: 0.0417s/iter; left time: 348.9230s
	iters: 800, epoch: 1 | loss: 0.2743212
	speed: 0.0416s/iter; left time: 343.8022s
	iters: 900, epoch: 1 | loss: 0.2950136
	speed: 0.0418s/iter; left time: 341.4666s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.25s
Steps: 906 | Train Loss: 0.5348350 Vali Loss: 0.3073518 Test Loss: 0.3400588
Validation loss decreased (inf --> 0.307352).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2508383
	speed: 0.1008s/iter; left time: 812.2546s
	iters: 200, epoch: 2 | loss: 0.2273803
	speed: 0.0405s/iter; left time: 322.0995s
	iters: 300, epoch: 2 | loss: 0.2623755
	speed: 0.0405s/iter; left time: 317.8419s
	iters: 400, epoch: 2 | loss: 0.1846166
	speed: 0.0410s/iter; left time: 317.9415s
	iters: 500, epoch: 2 | loss: 0.2051657
	speed: 0.0411s/iter; left time: 314.8011s
	iters: 600, epoch: 2 | loss: 0.1928996
	speed: 0.0409s/iter; left time: 309.1757s
	iters: 700, epoch: 2 | loss: 0.1912605
	speed: 0.0408s/iter; left time: 304.3303s
	iters: 800, epoch: 2 | loss: 0.2125411
	speed: 0.0383s/iter; left time: 281.7624s
	iters: 900, epoch: 2 | loss: 0.1866349
	speed: 0.0283s/iter; left time: 205.6751s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:35.71s
Steps: 906 | Train Loss: 0.2270710 Vali Loss: 0.1950675 Test Loss: 0.2256972
Validation loss decreased (0.307352 --> 0.195067).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2398734
	speed: 0.0989s/iter; left time: 707.0295s
	iters: 200, epoch: 3 | loss: 0.2027886
	speed: 0.0416s/iter; left time: 293.4623s
	iters: 300, epoch: 3 | loss: 0.2584473
	speed: 0.0415s/iter; left time: 288.4762s
	iters: 400, epoch: 3 | loss: 0.1886541
	speed: 0.0426s/iter; left time: 291.7001s
	iters: 500, epoch: 3 | loss: 0.1961745
	speed: 0.0435s/iter; left time: 293.5419s
	iters: 600, epoch: 3 | loss: 0.1296368
	speed: 0.0416s/iter; left time: 276.4235s
	iters: 700, epoch: 3 | loss: 0.1295638
	speed: 0.0420s/iter; left time: 274.8326s
	iters: 800, epoch: 3 | loss: 0.1580061
	speed: 0.0407s/iter; left time: 262.6592s
	iters: 900, epoch: 3 | loss: 0.1627956
	speed: 0.0414s/iter; left time: 262.9511s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.12s
Steps: 906 | Train Loss: 0.1877868 Vali Loss: 0.1917220 Test Loss: 0.2221078
Validation loss decreased (0.195067 --> 0.191722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1663524
	speed: 0.0995s/iter; left time: 621.1066s
	iters: 200, epoch: 4 | loss: 0.2559897
	speed: 0.0418s/iter; left time: 256.9927s
	iters: 300, epoch: 4 | loss: 0.1874934
	speed: 0.0415s/iter; left time: 250.6752s
	iters: 400, epoch: 4 | loss: 0.1628203
	speed: 0.0419s/iter; left time: 248.8103s
	iters: 500, epoch: 4 | loss: 0.2088244
	speed: 0.0418s/iter; left time: 244.1969s
	iters: 600, epoch: 4 | loss: 0.1518817
	speed: 0.0418s/iter; left time: 240.2204s
	iters: 700, epoch: 4 | loss: 0.1747356
	speed: 0.0421s/iter; left time: 237.4623s
	iters: 800, epoch: 4 | loss: 0.1363630
	speed: 0.0418s/iter; left time: 231.6899s
	iters: 900, epoch: 4 | loss: 0.1679870
	speed: 0.0420s/iter; left time: 228.6203s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.15s
Steps: 906 | Train Loss: 0.1713730 Vali Loss: 0.1945334 Test Loss: 0.2409081
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1816738
	speed: 0.0977s/iter; left time: 521.3284s
	iters: 200, epoch: 5 | loss: 0.1069402
	speed: 0.0420s/iter; left time: 219.7631s
	iters: 300, epoch: 5 | loss: 0.1429783
	speed: 0.0416s/iter; left time: 213.9257s
	iters: 400, epoch: 5 | loss: 0.1633556
	speed: 0.0410s/iter; left time: 206.4159s
	iters: 500, epoch: 5 | loss: 0.1529420
	speed: 0.0416s/iter; left time: 205.2919s
	iters: 600, epoch: 5 | loss: 0.1550685
	speed: 0.0419s/iter; left time: 202.7130s
	iters: 700, epoch: 5 | loss: 0.1464684
	speed: 0.0415s/iter; left time: 196.7318s
	iters: 800, epoch: 5 | loss: 0.1245090
	speed: 0.0420s/iter; left time: 194.6655s
	iters: 900, epoch: 5 | loss: 0.1269926
	speed: 0.0413s/iter; left time: 187.1843s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.99s
Steps: 906 | Train Loss: 0.1573021 Vali Loss: 0.1869135 Test Loss: 0.2290657
Validation loss decreased (0.191722 --> 0.186914).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1214358
	speed: 0.0865s/iter; left time: 383.3620s
	iters: 200, epoch: 6 | loss: 0.1240562
	speed: 0.0284s/iter; left time: 122.9345s
	iters: 300, epoch: 6 | loss: 0.1562274
	speed: 0.0284s/iter; left time: 120.1635s
	iters: 400, epoch: 6 | loss: 0.1274819
	speed: 0.0284s/iter; left time: 117.3997s
	iters: 500, epoch: 6 | loss: 0.1257778
	speed: 0.0284s/iter; left time: 114.6563s
	iters: 600, epoch: 6 | loss: 0.1304643
	speed: 0.0284s/iter; left time: 111.8177s
	iters: 700, epoch: 6 | loss: 0.1582749
	speed: 0.0284s/iter; left time: 108.9046s
	iters: 800, epoch: 6 | loss: 0.1065237
	speed: 0.0284s/iter; left time: 106.1314s
	iters: 900, epoch: 6 | loss: 0.1076068
	speed: 0.0284s/iter; left time: 103.1513s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.04s
Steps: 906 | Train Loss: 0.1428022 Vali Loss: 0.1881761 Test Loss: 0.2300182
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1232289
	speed: 0.0956s/iter; left time: 336.8360s
	iters: 200, epoch: 7 | loss: 0.1055129
	speed: 0.0412s/iter; left time: 140.9499s
	iters: 300, epoch: 7 | loss: 0.1285034
	speed: 0.0422s/iter; left time: 140.4213s
	iters: 400, epoch: 7 | loss: 0.1115938
	speed: 0.0413s/iter; left time: 133.2149s
	iters: 500, epoch: 7 | loss: 0.1336542
	speed: 0.0414s/iter; left time: 129.3025s
	iters: 600, epoch: 7 | loss: 0.1339087
	speed: 0.0406s/iter; left time: 122.9076s
	iters: 700, epoch: 7 | loss: 0.1484605
	speed: 0.0420s/iter; left time: 122.9227s
	iters: 800, epoch: 7 | loss: 0.1089894
	speed: 0.0422s/iter; left time: 119.0827s
	iters: 900, epoch: 7 | loss: 0.1292099
	speed: 0.0417s/iter; left time: 113.5054s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.77s
Steps: 906 | Train Loss: 0.1261849 Vali Loss: 0.1965726 Test Loss: 0.2453146
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1619487
	speed: 0.0962s/iter; left time: 251.8607s
	iters: 200, epoch: 8 | loss: 0.1010399
	speed: 0.0413s/iter; left time: 104.0032s
	iters: 300, epoch: 8 | loss: 0.0898229
	speed: 0.0413s/iter; left time: 99.8510s
	iters: 400, epoch: 8 | loss: 0.1036512
	speed: 0.0415s/iter; left time: 96.2577s
	iters: 500, epoch: 8 | loss: 0.0900405
	speed: 0.0414s/iter; left time: 91.8750s
	iters: 600, epoch: 8 | loss: 0.0915634
	speed: 0.0414s/iter; left time: 87.7165s
	iters: 700, epoch: 8 | loss: 0.0871406
	speed: 0.0412s/iter; left time: 83.2687s
	iters: 800, epoch: 8 | loss: 0.0984599
	speed: 0.0414s/iter; left time: 79.4468s
	iters: 900, epoch: 8 | loss: 0.1102560
	speed: 0.0412s/iter; left time: 74.9099s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.77s
Steps: 906 | Train Loss: 0.1122992 Vali Loss: 0.2157277 Test Loss: 0.2629190
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.22948257625102997, rmse:0.4790433943271637, mae:0.29066377878189087, rse:0.43872591853141785
Original data scale mse:1636712.625, rmse:1279.3406982421875, mae:840.6755981445312, rse:0.08990228921175003

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2208726555109024, RMSE: 0.4699709117412567, MAE: 0.28958678245544434, RSE: 0.430417001247406
Unscaled Metrics - MSE: 1701676.125, RMSE: 1304.4830322265625, MAE: 847.7084350585938, RSE: 0.09166909754276276

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.22948257625102997, RMSE: 0.4790433943271637, MAE: 0.29066377878189087, RSE: 0.43872591853141785
Unscaled Metrics - MSE: 1636712.625, RMSE: 1279.3406982421875, MAE: 840.6755981445312, RSE: 0.08990228921175003

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.0541128
	speed: 0.0761s/iter; left time: 680.0137s
	iters: 200, epoch: 1 | loss: 0.9511186
	speed: 0.0479s/iter; left time: 423.3175s
	iters: 300, epoch: 1 | loss: 0.7857096
	speed: 0.0477s/iter; left time: 416.5847s
	iters: 400, epoch: 1 | loss: 0.7475081
	speed: 0.0478s/iter; left time: 413.3000s
	iters: 500, epoch: 1 | loss: 0.6940102
	speed: 0.0477s/iter; left time: 407.4981s
	iters: 600, epoch: 1 | loss: 0.6297445
	speed: 0.0476s/iter; left time: 401.7683s
	iters: 700, epoch: 1 | loss: 0.5797683
	speed: 0.0475s/iter; left time: 396.5747s
	iters: 800, epoch: 1 | loss: 0.5758185
	speed: 0.0475s/iter; left time: 391.6098s
	iters: 900, epoch: 1 | loss: 0.6026171
	speed: 0.0474s/iter; left time: 386.2663s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.83s
Steps: 904 | Train Loss: 0.7525918 Vali Loss: 0.5359884 Test Loss: 0.6039184
Validation loss decreased (inf --> 0.535988).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4775855
	speed: 0.1175s/iter; left time: 944.1399s
	iters: 200, epoch: 2 | loss: 0.4913372
	speed: 0.0478s/iter; left time: 379.5932s
	iters: 300, epoch: 2 | loss: 0.3978512
	speed: 0.0474s/iter; left time: 371.5221s
	iters: 400, epoch: 2 | loss: 0.3830325
	speed: 0.0477s/iter; left time: 368.9680s
	iters: 500, epoch: 2 | loss: 0.3718461
	speed: 0.0474s/iter; left time: 361.8863s
	iters: 600, epoch: 2 | loss: 0.3970672
	speed: 0.0481s/iter; left time: 362.7025s
	iters: 700, epoch: 2 | loss: 0.3536695
	speed: 0.0481s/iter; left time: 357.6347s
	iters: 800, epoch: 2 | loss: 0.3603841
	speed: 0.0474s/iter; left time: 347.9924s
	iters: 900, epoch: 2 | loss: 0.3257468
	speed: 0.0463s/iter; left time: 335.3390s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.30s
Steps: 904 | Train Loss: 0.4017876 Vali Loss: 0.3394754 Test Loss: 0.3717253
Validation loss decreased (0.535988 --> 0.339475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3440864
	speed: 0.1220s/iter; left time: 870.1233s
	iters: 200, epoch: 3 | loss: 0.3384868
	speed: 0.0459s/iter; left time: 322.8742s
	iters: 300, epoch: 3 | loss: 0.3365248
	speed: 0.0477s/iter; left time: 330.7714s
	iters: 400, epoch: 3 | loss: 0.3494789
	speed: 0.0475s/iter; left time: 324.7002s
	iters: 500, epoch: 3 | loss: 0.2955706
	speed: 0.0473s/iter; left time: 318.3411s
	iters: 600, epoch: 3 | loss: 0.3028949
	speed: 0.0473s/iter; left time: 313.5998s
	iters: 700, epoch: 3 | loss: 0.2911758
	speed: 0.0477s/iter; left time: 311.3580s
	iters: 800, epoch: 3 | loss: 0.3544095
	speed: 0.0473s/iter; left time: 304.3425s
	iters: 900, epoch: 3 | loss: 0.3368629
	speed: 0.0475s/iter; left time: 300.8747s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.82s
Steps: 904 | Train Loss: 0.3176050 Vali Loss: 0.3210835 Test Loss: 0.3704849
Validation loss decreased (0.339475 --> 0.321084).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2596914
	speed: 0.1150s/iter; left time: 716.3475s
	iters: 200, epoch: 4 | loss: 0.2863995
	speed: 0.0467s/iter; left time: 285.9519s
	iters: 300, epoch: 4 | loss: 0.2517426
	speed: 0.0474s/iter; left time: 285.7444s
	iters: 400, epoch: 4 | loss: 0.3148614
	speed: 0.0469s/iter; left time: 278.3581s
	iters: 500, epoch: 4 | loss: 0.2996282
	speed: 0.0457s/iter; left time: 266.2419s
	iters: 600, epoch: 4 | loss: 0.3036328
	speed: 0.0473s/iter; left time: 270.7481s
	iters: 700, epoch: 4 | loss: 0.2489701
	speed: 0.0473s/iter; left time: 266.5086s
	iters: 800, epoch: 4 | loss: 0.2852030
	speed: 0.0478s/iter; left time: 264.0987s
	iters: 900, epoch: 4 | loss: 0.2396016
	speed: 0.0476s/iter; left time: 258.4504s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.65s
Steps: 904 | Train Loss: 0.2867657 Vali Loss: 0.3555674 Test Loss: 0.4118356
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2319648
	speed: 0.1123s/iter; left time: 598.1677s
	iters: 200, epoch: 5 | loss: 0.2395408
	speed: 0.0472s/iter; left time: 246.5551s
	iters: 300, epoch: 5 | loss: 0.2402054
	speed: 0.0468s/iter; left time: 239.6518s
	iters: 400, epoch: 5 | loss: 0.3315456
	speed: 0.0472s/iter; left time: 237.1645s
	iters: 500, epoch: 5 | loss: 0.2539203
	speed: 0.0474s/iter; left time: 233.4065s
	iters: 600, epoch: 5 | loss: 0.2478678
	speed: 0.0458s/iter; left time: 220.9672s
	iters: 700, epoch: 5 | loss: 0.2756614
	speed: 0.0474s/iter; left time: 224.0705s
	iters: 800, epoch: 5 | loss: 0.2559558
	speed: 0.0474s/iter; left time: 219.1041s
	iters: 900, epoch: 5 | loss: 0.2546978
	speed: 0.0473s/iter; left time: 213.9921s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.79s
Steps: 904 | Train Loss: 0.2569826 Vali Loss: 0.3550914 Test Loss: 0.3837304
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2063523
	speed: 0.1126s/iter; left time: 497.7633s
	iters: 200, epoch: 6 | loss: 0.2272255
	speed: 0.0477s/iter; left time: 206.3071s
	iters: 300, epoch: 6 | loss: 0.2267709
	speed: 0.0477s/iter; left time: 201.5090s
	iters: 400, epoch: 6 | loss: 0.2578495
	speed: 0.0473s/iter; left time: 194.8715s
	iters: 500, epoch: 6 | loss: 0.2069694
	speed: 0.0473s/iter; left time: 190.0428s
	iters: 600, epoch: 6 | loss: 0.1977466
	speed: 0.0472s/iter; left time: 185.0786s
	iters: 700, epoch: 6 | loss: 0.1651872
	speed: 0.0473s/iter; left time: 180.5434s
	iters: 800, epoch: 6 | loss: 0.2204035
	speed: 0.0472s/iter; left time: 175.5603s
	iters: 900, epoch: 6 | loss: 0.2147726
	speed: 0.0471s/iter; left time: 170.6819s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.05s
Steps: 904 | Train Loss: 0.2275399 Vali Loss: 0.3627177 Test Loss: 0.4026233
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.37037569284439087, rmse:0.608585000038147, mae:0.40191981196403503, rse:0.5572232604026794
Original data scale mse:3217915.5, rmse:1793.85498046875, mae:1224.63134765625, rse:0.12624089419841766
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.9337338
	speed: 0.0495s/iter; left time: 442.2338s
	iters: 200, epoch: 1 | loss: 0.9235025
	speed: 0.0476s/iter; left time: 420.9655s
	iters: 300, epoch: 1 | loss: 0.8574675
	speed: 0.0467s/iter; left time: 408.3679s
	iters: 400, epoch: 1 | loss: 0.7419078
	speed: 0.0475s/iter; left time: 410.5361s
	iters: 500, epoch: 1 | loss: 0.7440818
	speed: 0.0473s/iter; left time: 404.1436s
	iters: 600, epoch: 1 | loss: 0.5846918
	speed: 0.0474s/iter; left time: 400.1073s
	iters: 700, epoch: 1 | loss: 0.6283469
	speed: 0.0473s/iter; left time: 394.2216s
	iters: 800, epoch: 1 | loss: 0.5976415
	speed: 0.0474s/iter; left time: 390.8650s
	iters: 900, epoch: 1 | loss: 0.5860528
	speed: 0.0474s/iter; left time: 385.7621s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.08s
Steps: 904 | Train Loss: 0.7524506 Vali Loss: 0.5397327 Test Loss: 0.6191788
Validation loss decreased (inf --> 0.539733).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5762796
	speed: 0.1173s/iter; left time: 942.6826s
	iters: 200, epoch: 2 | loss: 0.5620694
	speed: 0.0470s/iter; left time: 373.4113s
	iters: 300, epoch: 2 | loss: 0.3899109
	speed: 0.0473s/iter; left time: 370.7563s
	iters: 400, epoch: 2 | loss: 0.3580979
	speed: 0.0472s/iter; left time: 365.2699s
	iters: 500, epoch: 2 | loss: 0.3499281
	speed: 0.0473s/iter; left time: 361.5894s
	iters: 600, epoch: 2 | loss: 0.4224021
	speed: 0.0473s/iter; left time: 356.6385s
	iters: 700, epoch: 2 | loss: 0.3379313
	speed: 0.0472s/iter; left time: 351.0864s
	iters: 800, epoch: 2 | loss: 0.3291656
	speed: 0.0473s/iter; left time: 346.8305s
	iters: 900, epoch: 2 | loss: 0.2988941
	speed: 0.0472s/iter; left time: 341.2970s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.99s
Steps: 904 | Train Loss: 0.4003550 Vali Loss: 0.3323830 Test Loss: 0.3765272
Validation loss decreased (0.539733 --> 0.332383).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3313694
	speed: 0.1190s/iter; left time: 848.5859s
	iters: 200, epoch: 3 | loss: 0.3338119
	speed: 0.0476s/iter; left time: 334.8579s
	iters: 300, epoch: 3 | loss: 0.3441159
	speed: 0.0477s/iter; left time: 330.5277s
	iters: 400, epoch: 3 | loss: 0.3290250
	speed: 0.0474s/iter; left time: 324.1240s
	iters: 500, epoch: 3 | loss: 0.3113160
	speed: 0.0457s/iter; left time: 307.9290s
	iters: 600, epoch: 3 | loss: 0.3430007
	speed: 0.0353s/iter; left time: 233.9345s
	iters: 700, epoch: 3 | loss: 0.3453022
	speed: 0.0421s/iter; left time: 275.2597s
	iters: 800, epoch: 3 | loss: 0.2906919
	speed: 0.0477s/iter; left time: 307.0477s
	iters: 900, epoch: 3 | loss: 0.2504905
	speed: 0.0477s/iter; left time: 302.1538s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.40s
Steps: 904 | Train Loss: 0.3185649 Vali Loss: 0.3303451 Test Loss: 0.3620087
Validation loss decreased (0.332383 --> 0.330345).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2839441
	speed: 0.1192s/iter; left time: 742.2407s
	iters: 200, epoch: 4 | loss: 0.2823039
	speed: 0.0478s/iter; left time: 293.0703s
	iters: 300, epoch: 4 | loss: 0.2683024
	speed: 0.0478s/iter; left time: 288.2391s
	iters: 400, epoch: 4 | loss: 0.2901298
	speed: 0.0477s/iter; left time: 283.0745s
	iters: 500, epoch: 4 | loss: 0.2617262
	speed: 0.0476s/iter; left time: 277.3656s
	iters: 600, epoch: 4 | loss: 0.3013727
	speed: 0.0475s/iter; left time: 272.1523s
	iters: 700, epoch: 4 | loss: 0.2833124
	speed: 0.0477s/iter; left time: 268.5380s
	iters: 800, epoch: 4 | loss: 0.2667525
	speed: 0.0464s/iter; left time: 256.5344s
	iters: 900, epoch: 4 | loss: 0.2641250
	speed: 0.0476s/iter; left time: 258.3106s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.28s
Steps: 904 | Train Loss: 0.2854963 Vali Loss: 0.3585173 Test Loss: 0.3759785
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2507585
	speed: 0.1142s/iter; left time: 608.3377s
	iters: 200, epoch: 5 | loss: 0.2824777
	speed: 0.0474s/iter; left time: 247.8719s
	iters: 300, epoch: 5 | loss: 0.3018561
	speed: 0.0472s/iter; left time: 242.1511s
	iters: 400, epoch: 5 | loss: 0.2504855
	speed: 0.0472s/iter; left time: 236.9716s
	iters: 500, epoch: 5 | loss: 0.2457954
	speed: 0.0471s/iter; left time: 231.8009s
	iters: 600, epoch: 5 | loss: 0.2263056
	speed: 0.0473s/iter; left time: 228.0546s
	iters: 700, epoch: 5 | loss: 0.2466917
	speed: 0.0474s/iter; left time: 223.7634s
	iters: 800, epoch: 5 | loss: 0.2365645
	speed: 0.0472s/iter; left time: 218.4709s
	iters: 900, epoch: 5 | loss: 0.2119735
	speed: 0.0473s/iter; left time: 214.1105s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.98s
Steps: 904 | Train Loss: 0.2573648 Vali Loss: 0.3460917 Test Loss: 0.3805954
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2322785
	speed: 0.1135s/iter; left time: 501.7339s
	iters: 200, epoch: 6 | loss: 0.2249614
	speed: 0.0474s/iter; left time: 205.0259s
	iters: 300, epoch: 6 | loss: 0.2376129
	speed: 0.0473s/iter; left time: 199.7497s
	iters: 400, epoch: 6 | loss: 0.2228169
	speed: 0.0472s/iter; left time: 194.3576s
	iters: 500, epoch: 6 | loss: 0.2342702
	speed: 0.0472s/iter; left time: 189.9897s
	iters: 600, epoch: 6 | loss: 0.2327003
	speed: 0.0474s/iter; left time: 185.6805s
	iters: 700, epoch: 6 | loss: 0.2488261
	speed: 0.0466s/iter; left time: 177.9742s
	iters: 800, epoch: 6 | loss: 0.1996328
	speed: 0.0474s/iter; left time: 176.4618s
	iters: 900, epoch: 6 | loss: 0.2027881
	speed: 0.0473s/iter; left time: 171.4319s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.99s
Steps: 904 | Train Loss: 0.2274300 Vali Loss: 0.3503064 Test Loss: 0.3857954
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.36230218410491943, rmse:0.6019154191017151, mae:0.4003490209579468, rse:0.5511165857315063
Original data scale mse:3257407.0, rmse:1804.828857421875, mae:1229.317138671875, rse:0.1270131766796112

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.37037569284439087, RMSE: 0.608585000038147, MAE: 0.40191981196403503, RSE: 0.5572232604026794
Unscaled Metrics - MSE: 3217915.5, RMSE: 1793.85498046875, MAE: 1224.63134765625, RSE: 0.12624089419841766

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.36230218410491943, RMSE: 0.6019154191017151, MAE: 0.4003490209579468, RSE: 0.5511165857315063
Unscaled Metrics - MSE: 3257407.0, RMSE: 1804.828857421875, MAE: 1229.317138671875, RSE: 0.1270131766796112

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.0352520
	speed: 0.0828s/iter; left time: 738.9999s
	iters: 200, epoch: 1 | loss: 0.8843445
	speed: 0.0536s/iter; left time: 473.0874s
	iters: 300, epoch: 1 | loss: 0.9591513
	speed: 0.0537s/iter; left time: 467.9554s
	iters: 400, epoch: 1 | loss: 0.8913056
	speed: 0.0536s/iter; left time: 461.7636s
	iters: 500, epoch: 1 | loss: 0.8296232
	speed: 0.0537s/iter; left time: 457.7239s
	iters: 600, epoch: 1 | loss: 0.8437170
	speed: 0.0532s/iter; left time: 447.7938s
	iters: 700, epoch: 1 | loss: 0.7764721
	speed: 0.0539s/iter; left time: 448.4168s
	iters: 800, epoch: 1 | loss: 0.8490142
	speed: 0.0536s/iter; left time: 440.7849s
	iters: 900, epoch: 1 | loss: 0.7274157
	speed: 0.0535s/iter; left time: 434.6729s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.08s
Steps: 902 | Train Loss: 0.8603764 Vali Loss: 0.7261466 Test Loss: 0.8109670
Validation loss decreased (inf --> 0.726147).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7174020
	speed: 0.1348s/iter; left time: 1081.1436s
	iters: 200, epoch: 2 | loss: 0.6028435
	speed: 0.0538s/iter; left time: 426.0300s
	iters: 300, epoch: 2 | loss: 0.4851946
	speed: 0.0533s/iter; left time: 416.6235s
	iters: 400, epoch: 2 | loss: 0.4661842
	speed: 0.0538s/iter; left time: 415.1531s
	iters: 500, epoch: 2 | loss: 0.3948885
	speed: 0.0537s/iter; left time: 409.4760s
	iters: 600, epoch: 2 | loss: 0.4322046
	speed: 0.0497s/iter; left time: 373.4288s
	iters: 700, epoch: 2 | loss: 0.3274599
	speed: 0.0425s/iter; left time: 315.4310s
	iters: 800, epoch: 2 | loss: 0.3611328
	speed: 0.0425s/iter; left time: 311.1160s
	iters: 900, epoch: 2 | loss: 0.3525777
	speed: 0.0425s/iter; left time: 306.5411s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:44.89s
Steps: 902 | Train Loss: 0.4774519 Vali Loss: 0.3732497 Test Loss: 0.4343471
Validation loss decreased (0.726147 --> 0.373250).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3263149
	speed: 0.1345s/iter; left time: 957.2621s
	iters: 200, epoch: 3 | loss: 0.3917048
	speed: 0.0537s/iter; left time: 376.4958s
	iters: 300, epoch: 3 | loss: 0.3700061
	speed: 0.0536s/iter; left time: 370.8663s
	iters: 400, epoch: 3 | loss: 0.3872994
	speed: 0.0538s/iter; left time: 366.4659s
	iters: 500, epoch: 3 | loss: 0.3737902
	speed: 0.0534s/iter; left time: 358.7892s
	iters: 600, epoch: 3 | loss: 0.3211397
	speed: 0.0536s/iter; left time: 354.8917s
	iters: 700, epoch: 3 | loss: 0.3212829
	speed: 0.0533s/iter; left time: 347.5148s
	iters: 800, epoch: 3 | loss: 0.3380259
	speed: 0.0536s/iter; left time: 343.6437s
	iters: 900, epoch: 3 | loss: 0.3399831
	speed: 0.0535s/iter; left time: 337.9451s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.60s
Steps: 902 | Train Loss: 0.3501782 Vali Loss: 0.3699983 Test Loss: 0.4152780
Validation loss decreased (0.373250 --> 0.369998).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3479404
	speed: 0.1343s/iter; left time: 834.8855s
	iters: 200, epoch: 4 | loss: 0.3310426
	speed: 0.0537s/iter; left time: 328.2093s
	iters: 300, epoch: 4 | loss: 0.3827023
	speed: 0.0537s/iter; left time: 323.0436s
	iters: 400, epoch: 4 | loss: 0.2956242
	speed: 0.0537s/iter; left time: 317.4859s
	iters: 500, epoch: 4 | loss: 0.3059477
	speed: 0.0537s/iter; left time: 312.2453s
	iters: 600, epoch: 4 | loss: 0.2993397
	speed: 0.0537s/iter; left time: 306.8406s
	iters: 700, epoch: 4 | loss: 0.3192849
	speed: 0.0538s/iter; left time: 302.0566s
	iters: 800, epoch: 4 | loss: 0.3390286
	speed: 0.0538s/iter; left time: 296.5083s
	iters: 900, epoch: 4 | loss: 0.2694327
	speed: 0.0537s/iter; left time: 290.6189s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.71s
Steps: 902 | Train Loss: 0.3130426 Vali Loss: 0.3673058 Test Loss: 0.4220827
Validation loss decreased (0.369998 --> 0.367306).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2468412
	speed: 0.1341s/iter; left time: 712.5306s
	iters: 200, epoch: 5 | loss: 0.2541611
	speed: 0.0534s/iter; left time: 278.3319s
	iters: 300, epoch: 5 | loss: 0.3100707
	speed: 0.0535s/iter; left time: 273.5287s
	iters: 400, epoch: 5 | loss: 0.3046283
	speed: 0.0535s/iter; left time: 268.2938s
	iters: 500, epoch: 5 | loss: 0.2887363
	speed: 0.0533s/iter; left time: 261.6776s
	iters: 600, epoch: 5 | loss: 0.2887882
	speed: 0.0536s/iter; left time: 258.1397s
	iters: 700, epoch: 5 | loss: 0.2981873
	speed: 0.0535s/iter; left time: 252.2277s
	iters: 800, epoch: 5 | loss: 0.2505410
	speed: 0.0535s/iter; left time: 246.5830s
	iters: 900, epoch: 5 | loss: 0.2425153
	speed: 0.0532s/iter; left time: 239.9469s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.52s
Steps: 902 | Train Loss: 0.2761646 Vali Loss: 0.3889923 Test Loss: 0.4356992
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2529745
	speed: 0.1304s/iter; left time: 575.0244s
	iters: 200, epoch: 6 | loss: 0.2425989
	speed: 0.0537s/iter; left time: 231.3742s
	iters: 300, epoch: 6 | loss: 0.2282566
	speed: 0.0536s/iter; left time: 225.6736s
	iters: 400, epoch: 6 | loss: 0.2432566
	speed: 0.0535s/iter; left time: 219.7363s
	iters: 500, epoch: 6 | loss: 0.2222433
	speed: 0.0535s/iter; left time: 214.6405s
	iters: 600, epoch: 6 | loss: 0.2259503
	speed: 0.0536s/iter; left time: 209.5280s
	iters: 700, epoch: 6 | loss: 0.2287765
	speed: 0.0535s/iter; left time: 203.8741s
	iters: 800, epoch: 6 | loss: 0.2085671
	speed: 0.0536s/iter; left time: 199.0563s
	iters: 900, epoch: 6 | loss: 0.2087848
	speed: 0.0534s/iter; left time: 192.8421s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.55s
Steps: 902 | Train Loss: 0.2383222 Vali Loss: 0.4319429 Test Loss: 0.4547587
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2152961
	speed: 0.1309s/iter; left time: 459.2067s
	iters: 200, epoch: 7 | loss: 0.2162431
	speed: 0.0536s/iter; left time: 182.5826s
	iters: 300, epoch: 7 | loss: 0.1736993
	speed: 0.0531s/iter; left time: 175.7456s
	iters: 400, epoch: 7 | loss: 0.1954045
	speed: 0.0531s/iter; left time: 170.4348s
	iters: 500, epoch: 7 | loss: 0.2192847
	speed: 0.0532s/iter; left time: 165.2642s
	iters: 600, epoch: 7 | loss: 0.2032651
	speed: 0.0532s/iter; left time: 159.9337s
	iters: 700, epoch: 7 | loss: 0.1837695
	speed: 0.0531s/iter; left time: 154.4087s
	iters: 800, epoch: 7 | loss: 0.1727953
	speed: 0.0536s/iter; left time: 150.6426s
	iters: 900, epoch: 7 | loss: 0.1644937
	speed: 0.0535s/iter; left time: 144.9069s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.37s
Steps: 902 | Train Loss: 0.2039232 Vali Loss: 0.4284594 Test Loss: 0.4776398
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4220791459083557, rmse:0.6496762037277222, mae:0.4367922842502594, rse:0.5950237512588501
Original data scale mse:4621935.5, rmse:2149.86865234375, mae:1406.2320556640625, rse:0.15143711864948273
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.9463976
	speed: 0.0556s/iter; left time: 495.7274s
	iters: 200, epoch: 1 | loss: 0.9521781
	speed: 0.0535s/iter; left time: 471.6365s
	iters: 300, epoch: 1 | loss: 0.8312523
	speed: 0.0535s/iter; left time: 466.8151s
	iters: 400, epoch: 1 | loss: 0.8522292
	speed: 0.0537s/iter; left time: 462.7510s
	iters: 500, epoch: 1 | loss: 0.8371087
	speed: 0.0532s/iter; left time: 453.4180s
	iters: 600, epoch: 1 | loss: 0.7258029
	speed: 0.0537s/iter; left time: 452.6002s
	iters: 700, epoch: 1 | loss: 0.7484930
	speed: 0.0534s/iter; left time: 444.6823s
	iters: 800, epoch: 1 | loss: 0.7367945
	speed: 0.0535s/iter; left time: 439.6773s
	iters: 900, epoch: 1 | loss: 0.7452044
	speed: 0.0536s/iter; left time: 435.5720s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.56s
Steps: 902 | Train Loss: 0.8502440 Vali Loss: 0.7115534 Test Loss: 0.8138284
Validation loss decreased (inf --> 0.711553).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6679220
	speed: 0.1360s/iter; left time: 1090.8395s
	iters: 200, epoch: 2 | loss: 0.5553952
	speed: 0.0536s/iter; left time: 424.5753s
	iters: 300, epoch: 2 | loss: 0.5025268
	speed: 0.0536s/iter; left time: 419.1566s
	iters: 400, epoch: 2 | loss: 0.4186817
	speed: 0.0535s/iter; left time: 412.7314s
	iters: 500, epoch: 2 | loss: 0.4775873
	speed: 0.0536s/iter; left time: 408.3592s
	iters: 600, epoch: 2 | loss: 0.3473051
	speed: 0.0535s/iter; left time: 402.5193s
	iters: 700, epoch: 2 | loss: 0.3982804
	speed: 0.0534s/iter; left time: 396.5275s
	iters: 800, epoch: 2 | loss: 0.3341379
	speed: 0.0536s/iter; left time: 391.9747s
	iters: 900, epoch: 2 | loss: 0.3920733
	speed: 0.0538s/iter; left time: 388.3541s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.65s
Steps: 902 | Train Loss: 0.4766409 Vali Loss: 0.3738549 Test Loss: 0.4161000
Validation loss decreased (0.711553 --> 0.373855).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4308762
	speed: 0.1366s/iter; left time: 972.2991s
	iters: 200, epoch: 3 | loss: 0.3449390
	speed: 0.0537s/iter; left time: 376.6992s
	iters: 300, epoch: 3 | loss: 0.3446561
	speed: 0.0534s/iter; left time: 369.1327s
	iters: 400, epoch: 3 | loss: 0.3578669
	speed: 0.0537s/iter; left time: 366.0372s
	iters: 500, epoch: 3 | loss: 0.3281203
	speed: 0.0535s/iter; left time: 359.6889s
	iters: 600, epoch: 3 | loss: 0.3589796
	speed: 0.0537s/iter; left time: 355.0726s
	iters: 700, epoch: 3 | loss: 0.3088960
	speed: 0.0537s/iter; left time: 350.2522s
	iters: 800, epoch: 3 | loss: 0.3715822
	speed: 0.0536s/iter; left time: 344.2591s
	iters: 900, epoch: 3 | loss: 0.3649552
	speed: 0.0537s/iter; left time: 339.2708s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.68s
Steps: 902 | Train Loss: 0.3539985 Vali Loss: 0.3544865 Test Loss: 0.3872484
Validation loss decreased (0.373855 --> 0.354486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3418356
	speed: 0.1336s/iter; left time: 830.1258s
	iters: 200, epoch: 4 | loss: 0.3142967
	speed: 0.0537s/iter; left time: 328.3436s
	iters: 300, epoch: 4 | loss: 0.3053995
	speed: 0.0538s/iter; left time: 323.3760s
	iters: 400, epoch: 4 | loss: 0.3469464
	speed: 0.0536s/iter; left time: 317.2304s
	iters: 500, epoch: 4 | loss: 0.3096003
	speed: 0.0536s/iter; left time: 311.4034s
	iters: 600, epoch: 4 | loss: 0.2848569
	speed: 0.0538s/iter; left time: 307.2242s
	iters: 700, epoch: 4 | loss: 0.3047622
	speed: 0.0537s/iter; left time: 301.7395s
	iters: 800, epoch: 4 | loss: 0.3498112
	speed: 0.0537s/iter; left time: 296.1012s
	iters: 900, epoch: 4 | loss: 0.2738811
	speed: 0.0537s/iter; left time: 290.8571s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.65s
Steps: 902 | Train Loss: 0.3162700 Vali Loss: 0.3743628 Test Loss: 0.4209250
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2817701
	speed: 0.1316s/iter; left time: 699.2244s
	iters: 200, epoch: 5 | loss: 0.2708364
	speed: 0.0538s/iter; left time: 280.2077s
	iters: 300, epoch: 5 | loss: 0.3019592
	speed: 0.0538s/iter; left time: 274.8878s
	iters: 400, epoch: 5 | loss: 0.3011470
	speed: 0.0536s/iter; left time: 268.7635s
	iters: 500, epoch: 5 | loss: 0.2717673
	speed: 0.0539s/iter; left time: 264.6548s
	iters: 600, epoch: 5 | loss: 0.2605802
	speed: 0.0538s/iter; left time: 258.8344s
	iters: 700, epoch: 5 | loss: 0.2486690
	speed: 0.0537s/iter; left time: 253.2136s
	iters: 800, epoch: 5 | loss: 0.2669793
	speed: 0.0536s/iter; left time: 247.3029s
	iters: 900, epoch: 5 | loss: 0.2559718
	speed: 0.0536s/iter; left time: 241.8226s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.69s
Steps: 902 | Train Loss: 0.2773519 Vali Loss: 0.3851812 Test Loss: 0.4164009
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2765988
	speed: 0.1316s/iter; left time: 580.3740s
	iters: 200, epoch: 6 | loss: 0.2202259
	speed: 0.0535s/iter; left time: 230.6329s
	iters: 300, epoch: 6 | loss: 0.2247253
	speed: 0.0536s/iter; left time: 225.5679s
	iters: 400, epoch: 6 | loss: 0.2569248
	speed: 0.0535s/iter; left time: 219.8556s
	iters: 500, epoch: 6 | loss: 0.2518732
	speed: 0.0534s/iter; left time: 214.3369s
	iters: 600, epoch: 6 | loss: 0.2591949
	speed: 0.0534s/iter; left time: 208.8687s
	iters: 700, epoch: 6 | loss: 0.2306166
	speed: 0.0533s/iter; left time: 203.1169s
	iters: 800, epoch: 6 | loss: 0.2176325
	speed: 0.0535s/iter; left time: 198.5014s
	iters: 900, epoch: 6 | loss: 0.1950187
	speed: 0.0534s/iter; left time: 192.7857s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.50s
Steps: 902 | Train Loss: 0.2413657 Vali Loss: 0.4186473 Test Loss: 0.4736757
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.38717150688171387, rmse:0.6222310662269592, mae:0.4290606677532196, rse:0.5698874592781067
Original data scale mse:4015123.0, rmse:2003.7772216796875, mae:1363.0994873046875, rse:0.14114640653133392

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.4220791459083557, RMSE: 0.6496762037277222, MAE: 0.4367922842502594, RSE: 0.5950237512588501
Unscaled Metrics - MSE: 4621935.5, RMSE: 2149.86865234375, MAE: 1406.2320556640625, RSE: 0.15143711864948273

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.38717150688171387, RMSE: 0.6222310662269592, MAE: 0.4290606677532196, RSE: 0.5698874592781067
Unscaled Metrics - MSE: 4015123.0, RMSE: 2003.7772216796875, MAE: 1363.0994873046875, RSE: 0.14114640653133392

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.9480735
	speed: 0.0711s/iter; left time: 637.4752s
	iters: 200, epoch: 1 | loss: 0.8427295
	speed: 0.0413s/iter; left time: 365.5689s
	iters: 300, epoch: 1 | loss: 0.7319086
	speed: 0.0417s/iter; left time: 365.3899s
	iters: 400, epoch: 1 | loss: 0.6998473
	speed: 0.0414s/iter; left time: 358.4737s
	iters: 500, epoch: 1 | loss: 0.5977362
	speed: 0.0418s/iter; left time: 357.8095s
	iters: 600, epoch: 1 | loss: 0.5942448
	speed: 0.0413s/iter; left time: 349.8130s
	iters: 700, epoch: 1 | loss: 0.5309054
	speed: 0.0417s/iter; left time: 348.3530s
	iters: 800, epoch: 1 | loss: 0.5348661
	speed: 0.0410s/iter; left time: 338.5740s
	iters: 900, epoch: 1 | loss: 0.6100189
	speed: 0.0413s/iter; left time: 336.7901s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.31s
Steps: 906 | Train Loss: 0.7044290 Vali Loss: 0.2997542 Test Loss: 0.3326752
Validation loss decreased (inf --> 0.299754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5566050
	speed: 0.0982s/iter; left time: 791.3423s
	iters: 200, epoch: 2 | loss: 0.5258386
	speed: 0.0410s/iter; left time: 326.2829s
	iters: 300, epoch: 2 | loss: 0.4542652
	speed: 0.0412s/iter; left time: 323.3676s
	iters: 400, epoch: 2 | loss: 0.4059312
	speed: 0.0409s/iter; left time: 317.2079s
	iters: 500, epoch: 2 | loss: 0.4969504
	speed: 0.0405s/iter; left time: 309.8600s
	iters: 600, epoch: 2 | loss: 0.4856435
	speed: 0.0404s/iter; left time: 304.8806s
	iters: 700, epoch: 2 | loss: 0.4713282
	speed: 0.0407s/iter; left time: 303.1845s
	iters: 800, epoch: 2 | loss: 0.4687838
	speed: 0.0408s/iter; left time: 300.3571s
	iters: 900, epoch: 2 | loss: 0.4769658
	speed: 0.0403s/iter; left time: 292.5342s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.16s
Steps: 906 | Train Loss: 0.4720521 Vali Loss: 0.2057424 Test Loss: 0.2335918
Validation loss decreased (0.299754 --> 0.205742).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4587199
	speed: 0.0862s/iter; left time: 616.3726s
	iters: 200, epoch: 3 | loss: 0.4064642
	speed: 0.0282s/iter; left time: 198.4843s
	iters: 300, epoch: 3 | loss: 0.4669948
	speed: 0.0281s/iter; left time: 195.3194s
	iters: 400, epoch: 3 | loss: 0.4047443
	speed: 0.0281s/iter; left time: 192.5172s
	iters: 500, epoch: 3 | loss: 0.4785196
	speed: 0.0281s/iter; left time: 189.8964s
	iters: 600, epoch: 3 | loss: 0.4469507
	speed: 0.0281s/iter; left time: 186.9888s
	iters: 700, epoch: 3 | loss: 0.3790830
	speed: 0.0281s/iter; left time: 184.1194s
	iters: 800, epoch: 3 | loss: 0.4164144
	speed: 0.0282s/iter; left time: 182.0322s
	iters: 900, epoch: 3 | loss: 0.4179831
	speed: 0.0281s/iter; left time: 178.5294s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.78s
Steps: 906 | Train Loss: 0.4283799 Vali Loss: 0.1974791 Test Loss: 0.2404038
Validation loss decreased (0.205742 --> 0.197479).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4403027
	speed: 0.0976s/iter; left time: 609.3872s
	iters: 200, epoch: 4 | loss: 0.4034479
	speed: 0.0408s/iter; left time: 250.3736s
	iters: 300, epoch: 4 | loss: 0.4076033
	speed: 0.0406s/iter; left time: 245.4948s
	iters: 400, epoch: 4 | loss: 0.4190568
	speed: 0.0409s/iter; left time: 242.9066s
	iters: 500, epoch: 4 | loss: 0.3587362
	speed: 0.0404s/iter; left time: 236.1111s
	iters: 600, epoch: 4 | loss: 0.4518852
	speed: 0.0404s/iter; left time: 232.1398s
	iters: 700, epoch: 4 | loss: 0.4377737
	speed: 0.0405s/iter; left time: 228.5203s
	iters: 800, epoch: 4 | loss: 0.4353015
	speed: 0.0408s/iter; left time: 226.1917s
	iters: 900, epoch: 4 | loss: 0.4563699
	speed: 0.0408s/iter; left time: 222.1290s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.10s
Steps: 906 | Train Loss: 0.4086633 Vali Loss: 0.1918920 Test Loss: 0.2227312
Validation loss decreased (0.197479 --> 0.191892).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3664392
	speed: 0.0997s/iter; left time: 531.8568s
	iters: 200, epoch: 5 | loss: 0.3622502
	speed: 0.0411s/iter; left time: 215.0188s
	iters: 300, epoch: 5 | loss: 0.3794925
	speed: 0.0412s/iter; left time: 211.7276s
	iters: 400, epoch: 5 | loss: 0.3470703
	speed: 0.0410s/iter; left time: 206.6413s
	iters: 500, epoch: 5 | loss: 0.3929685
	speed: 0.0408s/iter; left time: 201.4843s
	iters: 600, epoch: 5 | loss: 0.3469204
	speed: 0.0406s/iter; left time: 196.1909s
	iters: 700, epoch: 5 | loss: 0.4225162
	speed: 0.0413s/iter; left time: 195.7600s
	iters: 800, epoch: 5 | loss: 0.3689858
	speed: 0.0405s/iter; left time: 187.6970s
	iters: 900, epoch: 5 | loss: 0.3917327
	speed: 0.0410s/iter; left time: 186.1420s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.42s
Steps: 906 | Train Loss: 0.3868912 Vali Loss: 0.1898287 Test Loss: 0.2168613
Validation loss decreased (0.191892 --> 0.189829).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3194527
	speed: 0.0990s/iter; left time: 438.5531s
	iters: 200, epoch: 6 | loss: 0.3869855
	speed: 0.0413s/iter; left time: 178.9323s
	iters: 300, epoch: 6 | loss: 0.4469472
	speed: 0.0409s/iter; left time: 173.0561s
	iters: 400, epoch: 6 | loss: 0.3830153
	speed: 0.0410s/iter; left time: 169.5492s
	iters: 500, epoch: 6 | loss: 0.3783035
	speed: 0.0417s/iter; left time: 168.2294s
	iters: 600, epoch: 6 | loss: 0.4072692
	speed: 0.0409s/iter; left time: 160.7923s
	iters: 700, epoch: 6 | loss: 0.3506239
	speed: 0.0413s/iter; left time: 158.3626s
	iters: 800, epoch: 6 | loss: 0.3843220
	speed: 0.0412s/iter; left time: 153.5742s
	iters: 900, epoch: 6 | loss: 0.3957846
	speed: 0.0412s/iter; left time: 149.7009s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.67s
Steps: 906 | Train Loss: 0.3654887 Vali Loss: 0.2033441 Test Loss: 0.2261756
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3248346
	speed: 0.0956s/iter; left time: 337.1356s
	iters: 200, epoch: 7 | loss: 0.3394749
	speed: 0.0410s/iter; left time: 140.3245s
	iters: 300, epoch: 7 | loss: 0.3177157
	speed: 0.0410s/iter; left time: 136.4701s
	iters: 400, epoch: 7 | loss: 0.3456450
	speed: 0.0415s/iter; left time: 133.7204s
	iters: 500, epoch: 7 | loss: 0.3253287
	speed: 0.0409s/iter; left time: 127.6888s
	iters: 600, epoch: 7 | loss: 0.2988238
	speed: 0.0409s/iter; left time: 123.8078s
	iters: 700, epoch: 7 | loss: 0.3332763
	speed: 0.0408s/iter; left time: 119.3574s
	iters: 800, epoch: 7 | loss: 0.3243552
	speed: 0.0416s/iter; left time: 117.3877s
	iters: 900, epoch: 7 | loss: 0.3442824
	speed: 0.0415s/iter; left time: 113.2140s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.58s
Steps: 906 | Train Loss: 0.3423406 Vali Loss: 0.2080219 Test Loss: 0.2362713
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3409720
	speed: 0.0948s/iter; left time: 248.3574s
	iters: 200, epoch: 8 | loss: 0.3057624
	speed: 0.0411s/iter; left time: 103.4292s
	iters: 300, epoch: 8 | loss: 0.3478164
	speed: 0.0408s/iter; left time: 98.7717s
	iters: 400, epoch: 8 | loss: 0.3017595
	speed: 0.0407s/iter; left time: 94.3115s
	iters: 500, epoch: 8 | loss: 0.3636425
	speed: 0.0407s/iter; left time: 90.2068s
	iters: 600, epoch: 8 | loss: 0.3382644
	speed: 0.0405s/iter; left time: 85.8900s
	iters: 700, epoch: 8 | loss: 0.2818981
	speed: 0.0408s/iter; left time: 82.3840s
	iters: 800, epoch: 8 | loss: 0.2803948
	speed: 0.0406s/iter; left time: 77.9823s
	iters: 900, epoch: 8 | loss: 0.3310596
	speed: 0.0409s/iter; left time: 74.4305s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.19s
Steps: 906 | Train Loss: 0.3209019 Vali Loss: 0.2109462 Test Loss: 0.2570929
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2176513373851776, rmse:0.4665311872959137, mae:0.28478193283081055, rse:0.4272667467594147
Original data scale mse:1623739.375, rmse:1274.2603759765625, mae:826.7006225585938, rse:0.08954527974128723
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.8770059
	speed: 0.0431s/iter; left time: 386.2126s
	iters: 200, epoch: 1 | loss: 0.8124475
	speed: 0.0412s/iter; left time: 365.3899s
	iters: 300, epoch: 1 | loss: 0.7515377
	speed: 0.0406s/iter; left time: 356.1330s
	iters: 400, epoch: 1 | loss: 0.6662431
	speed: 0.0410s/iter; left time: 354.7088s
	iters: 500, epoch: 1 | loss: 0.6586979
	speed: 0.0411s/iter; left time: 352.1286s
	iters: 600, epoch: 1 | loss: 0.5561125
	speed: 0.0417s/iter; left time: 352.9548s
	iters: 700, epoch: 1 | loss: 0.5687483
	speed: 0.0418s/iter; left time: 349.6941s
	iters: 800, epoch: 1 | loss: 0.5079992
	speed: 0.0412s/iter; left time: 340.5785s
	iters: 900, epoch: 1 | loss: 0.5308265
	speed: 0.0412s/iter; left time: 336.6220s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.65s
Steps: 906 | Train Loss: 0.7051452 Vali Loss: 0.2952747 Test Loss: 0.3267589
Validation loss decreased (inf --> 0.295275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4965989
	speed: 0.0989s/iter; left time: 796.5245s
	iters: 200, epoch: 2 | loss: 0.4741895
	speed: 0.0413s/iter; left time: 328.2162s
	iters: 300, epoch: 2 | loss: 0.5188652
	speed: 0.0409s/iter; left time: 320.9088s
	iters: 400, epoch: 2 | loss: 0.4301800
	speed: 0.0409s/iter; left time: 317.1718s
	iters: 500, epoch: 2 | loss: 0.4468519
	speed: 0.0407s/iter; left time: 311.4428s
	iters: 600, epoch: 2 | loss: 0.4368624
	speed: 0.0412s/iter; left time: 311.0876s
	iters: 700, epoch: 2 | loss: 0.4345208
	speed: 0.0415s/iter; left time: 309.2066s
	iters: 800, epoch: 2 | loss: 0.4607006
	speed: 0.0414s/iter; left time: 304.5913s
	iters: 900, epoch: 2 | loss: 0.4288935
	speed: 0.0405s/iter; left time: 293.8267s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.47s
Steps: 906 | Train Loss: 0.4719402 Vali Loss: 0.1950955 Test Loss: 0.2229580
Validation loss decreased (0.295275 --> 0.195095).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4913486
	speed: 0.0993s/iter; left time: 709.6185s
	iters: 200, epoch: 3 | loss: 0.4496928
	speed: 0.0405s/iter; left time: 285.3006s
	iters: 300, epoch: 3 | loss: 0.5105748
	speed: 0.0414s/iter; left time: 287.6451s
	iters: 400, epoch: 3 | loss: 0.4337781
	speed: 0.0409s/iter; left time: 279.8223s
	iters: 500, epoch: 3 | loss: 0.4370473
	speed: 0.0406s/iter; left time: 274.3446s
	iters: 600, epoch: 3 | loss: 0.3606272
	speed: 0.0407s/iter; left time: 270.3317s
	iters: 700, epoch: 3 | loss: 0.3622395
	speed: 0.0408s/iter; left time: 267.1637s
	iters: 800, epoch: 3 | loss: 0.3990384
	speed: 0.0408s/iter; left time: 262.9889s
	iters: 900, epoch: 3 | loss: 0.4004874
	speed: 0.0410s/iter; left time: 260.5216s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.31s
Steps: 906 | Train Loss: 0.4296497 Vali Loss: 0.1919278 Test Loss: 0.2202868
Validation loss decreased (0.195095 --> 0.191928).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4041441
	speed: 0.0990s/iter; left time: 618.3242s
	iters: 200, epoch: 4 | loss: 0.4973756
	speed: 0.0414s/iter; left time: 254.2014s
	iters: 300, epoch: 4 | loss: 0.4268958
	speed: 0.0417s/iter; left time: 251.8466s
	iters: 400, epoch: 4 | loss: 0.3984044
	speed: 0.0416s/iter; left time: 247.3551s
	iters: 500, epoch: 4 | loss: 0.4543271
	speed: 0.0417s/iter; left time: 243.4599s
	iters: 600, epoch: 4 | loss: 0.3691638
	speed: 0.0414s/iter; left time: 237.6635s
	iters: 700, epoch: 4 | loss: 0.4096003
	speed: 0.0415s/iter; left time: 234.3747s
	iters: 800, epoch: 4 | loss: 0.3740402
	speed: 0.0416s/iter; left time: 230.6747s
	iters: 900, epoch: 4 | loss: 0.3950447
	speed: 0.0410s/iter; left time: 223.3791s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.83s
Steps: 906 | Train Loss: 0.4099039 Vali Loss: 0.1971609 Test Loss: 0.2409566
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4244377
	speed: 0.0960s/iter; left time: 512.2285s
	iters: 200, epoch: 5 | loss: 0.3191028
	speed: 0.0411s/iter; left time: 215.0848s
	iters: 300, epoch: 5 | loss: 0.3719194
	speed: 0.0412s/iter; left time: 211.8558s
	iters: 400, epoch: 5 | loss: 0.4139623
	speed: 0.0411s/iter; left time: 207.1965s
	iters: 500, epoch: 5 | loss: 0.3868535
	speed: 0.0416s/iter; left time: 205.2724s
	iters: 600, epoch: 5 | loss: 0.3970801
	speed: 0.0412s/iter; left time: 199.2678s
	iters: 700, epoch: 5 | loss: 0.3840395
	speed: 0.0414s/iter; left time: 195.9915s
	iters: 800, epoch: 5 | loss: 0.3479422
	speed: 0.0415s/iter; left time: 192.6417s
	iters: 900, epoch: 5 | loss: 0.3502213
	speed: 0.0415s/iter; left time: 188.3824s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.71s
Steps: 906 | Train Loss: 0.3927765 Vali Loss: 0.1901884 Test Loss: 0.2261441
Validation loss decreased (0.191928 --> 0.190188).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3550489
	speed: 0.1000s/iter; left time: 443.0897s
	iters: 200, epoch: 6 | loss: 0.3525634
	speed: 0.0409s/iter; left time: 177.2517s
	iters: 300, epoch: 6 | loss: 0.3742825
	speed: 0.0404s/iter; left time: 170.9458s
	iters: 400, epoch: 6 | loss: 0.3386062
	speed: 0.0408s/iter; left time: 168.4569s
	iters: 500, epoch: 6 | loss: 0.3345012
	speed: 0.0409s/iter; left time: 164.9591s
	iters: 600, epoch: 6 | loss: 0.3348132
	speed: 0.0410s/iter; left time: 161.2128s
	iters: 700, epoch: 6 | loss: 0.3902002
	speed: 0.0408s/iter; left time: 156.3407s
	iters: 800, epoch: 6 | loss: 0.3468649
	speed: 0.0408s/iter; left time: 152.0445s
	iters: 900, epoch: 6 | loss: 0.3265851
	speed: 0.0409s/iter; left time: 148.4252s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.33s
Steps: 906 | Train Loss: 0.3722013 Vali Loss: 0.1954660 Test Loss: 0.2291034
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3450672
	speed: 0.0959s/iter; left time: 338.1605s
	iters: 200, epoch: 7 | loss: 0.3208027
	speed: 0.0413s/iter; left time: 141.4500s
	iters: 300, epoch: 7 | loss: 0.3465224
	speed: 0.0413s/iter; left time: 137.4656s
	iters: 400, epoch: 7 | loss: 0.3191282
	speed: 0.0408s/iter; left time: 131.6040s
	iters: 500, epoch: 7 | loss: 0.3643130
	speed: 0.0405s/iter; left time: 126.6938s
	iters: 600, epoch: 7 | loss: 0.3728662
	speed: 0.0412s/iter; left time: 124.7040s
	iters: 700, epoch: 7 | loss: 0.3715833
	speed: 0.0411s/iter; left time: 120.2489s
	iters: 800, epoch: 7 | loss: 0.3453424
	speed: 0.0409s/iter; left time: 115.4819s
	iters: 900, epoch: 7 | loss: 0.3477891
	speed: 0.0414s/iter; left time: 112.7447s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.50s
Steps: 906 | Train Loss: 0.3479370 Vali Loss: 0.2106204 Test Loss: 0.2396576
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3851016
	speed: 0.0975s/iter; left time: 255.2469s
	iters: 200, epoch: 8 | loss: 0.3217009
	speed: 0.0412s/iter; left time: 103.8931s
	iters: 300, epoch: 8 | loss: 0.2868378
	speed: 0.0419s/iter; left time: 101.4428s
	iters: 400, epoch: 8 | loss: 0.3272646
	speed: 0.0420s/iter; left time: 97.4678s
	iters: 500, epoch: 8 | loss: 0.3015457
	speed: 0.0404s/iter; left time: 89.6345s
	iters: 600, epoch: 8 | loss: 0.3095928
	speed: 0.0412s/iter; left time: 87.2567s
	iters: 700, epoch: 8 | loss: 0.2762116
	speed: 0.0404s/iter; left time: 81.6620s
	iters: 800, epoch: 8 | loss: 0.3122315
	speed: 0.0415s/iter; left time: 79.6093s
	iters: 900, epoch: 8 | loss: 0.3299581
	speed: 0.0415s/iter; left time: 75.5525s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.72s
Steps: 906 | Train Loss: 0.3259930 Vali Loss: 0.2279959 Test Loss: 0.2598976
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.22640159726142883, rmse:0.4758167564868927, mae:0.28863799571990967, rse:0.4357708692550659
Original data scale mse:1724387.875, rmse:1313.1595458984375, mae:853.6309204101562, rse:0.09227881580591202

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2176513373851776, RMSE: 0.4665311872959137, MAE: 0.28478193283081055, RSE: 0.4272667467594147
Unscaled Metrics - MSE: 1623739.375, RMSE: 1274.2603759765625, MAE: 826.7006225585938, RSE: 0.08954527974128723

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.22640159726142883, RMSE: 0.4758167564868927, MAE: 0.28863799571990967, RSE: 0.4357708692550659
Unscaled Metrics - MSE: 1724387.875, RMSE: 1313.1595458984375, MAE: 853.6309204101562, RSE: 0.09227881580591202

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.0260856
	speed: 0.0768s/iter; left time: 686.7209s
	iters: 200, epoch: 1 | loss: 0.9738876
	speed: 0.0475s/iter; left time: 420.2311s
	iters: 300, epoch: 1 | loss: 0.8828842
	speed: 0.0472s/iter; left time: 412.7726s
	iters: 400, epoch: 1 | loss: 0.8587000
	speed: 0.0474s/iter; left time: 409.1549s
	iters: 500, epoch: 1 | loss: 0.8266032
	speed: 0.0473s/iter; left time: 403.7439s
	iters: 600, epoch: 1 | loss: 0.7888606
	speed: 0.0472s/iter; left time: 398.7428s
	iters: 700, epoch: 1 | loss: 0.7569785
	speed: 0.0473s/iter; left time: 394.9159s
	iters: 800, epoch: 1 | loss: 0.7537541
	speed: 0.0473s/iter; left time: 389.5424s
	iters: 900, epoch: 1 | loss: 0.7713877
	speed: 0.0366s/iter; left time: 298.1175s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.43s
Steps: 904 | Train Loss: 0.8586791 Vali Loss: 0.5276232 Test Loss: 0.5946516
Validation loss decreased (inf --> 0.527623).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6971501
	speed: 0.1168s/iter; left time: 938.3703s
	iters: 200, epoch: 2 | loss: 0.6988704
	speed: 0.0477s/iter; left time: 378.3673s
	iters: 300, epoch: 2 | loss: 0.6259297
	speed: 0.0477s/iter; left time: 373.7467s
	iters: 400, epoch: 2 | loss: 0.6188000
	speed: 0.0474s/iter; left time: 366.7363s
	iters: 500, epoch: 2 | loss: 0.6050654
	speed: 0.0476s/iter; left time: 363.3400s
	iters: 600, epoch: 2 | loss: 0.6239865
	speed: 0.0475s/iter; left time: 358.2305s
	iters: 700, epoch: 2 | loss: 0.5909189
	speed: 0.0476s/iter; left time: 353.7279s
	iters: 800, epoch: 2 | loss: 0.5950203
	speed: 0.0476s/iter; left time: 348.9504s
	iters: 900, epoch: 2 | loss: 0.5672927
	speed: 0.0475s/iter; left time: 343.5809s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.22s
Steps: 904 | Train Loss: 0.6273292 Vali Loss: 0.3351797 Test Loss: 0.3716765
Validation loss decreased (0.527623 --> 0.335180).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5791374
	speed: 0.1184s/iter; left time: 844.4222s
	iters: 200, epoch: 3 | loss: 0.5702775
	speed: 0.0455s/iter; left time: 320.2130s
	iters: 300, epoch: 3 | loss: 0.5766770
	speed: 0.0477s/iter; left time: 330.4062s
	iters: 400, epoch: 3 | loss: 0.5881222
	speed: 0.0475s/iter; left time: 324.4008s
	iters: 500, epoch: 3 | loss: 0.5487005
	speed: 0.0476s/iter; left time: 320.4045s
	iters: 600, epoch: 3 | loss: 0.5415710
	speed: 0.0475s/iter; left time: 314.9048s
	iters: 700, epoch: 3 | loss: 0.5320235
	speed: 0.0476s/iter; left time: 310.8461s
	iters: 800, epoch: 3 | loss: 0.5985110
	speed: 0.0476s/iter; left time: 306.0700s
	iters: 900, epoch: 3 | loss: 0.5814335
	speed: 0.0475s/iter; left time: 300.6547s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.10s
Steps: 904 | Train Loss: 0.5598977 Vali Loss: 0.3286674 Test Loss: 0.3754258
Validation loss decreased (0.335180 --> 0.328667).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5162741
	speed: 0.1153s/iter; left time: 718.4231s
	iters: 200, epoch: 4 | loss: 0.5375088
	speed: 0.0472s/iter; left time: 289.1693s
	iters: 300, epoch: 4 | loss: 0.5039598
	speed: 0.0461s/iter; left time: 277.7577s
	iters: 400, epoch: 4 | loss: 0.5622481
	speed: 0.0435s/iter; left time: 257.6817s
	iters: 500, epoch: 4 | loss: 0.5508606
	speed: 0.0462s/iter; left time: 269.3836s
	iters: 600, epoch: 4 | loss: 0.5462506
	speed: 0.0471s/iter; left time: 269.6675s
	iters: 700, epoch: 4 | loss: 0.4972303
	speed: 0.0462s/iter; left time: 260.3223s
	iters: 800, epoch: 4 | loss: 0.5380936
	speed: 0.0467s/iter; left time: 258.1795s
	iters: 900, epoch: 4 | loss: 0.4996651
	speed: 0.0471s/iter; left time: 255.6568s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.10s
Steps: 904 | Train Loss: 0.5315238 Vali Loss: 0.3494109 Test Loss: 0.4130935
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4826322
	speed: 0.1113s/iter; left time: 592.8288s
	iters: 200, epoch: 5 | loss: 0.4889189
	speed: 0.0482s/iter; left time: 251.7059s
	iters: 300, epoch: 5 | loss: 0.5033612
	speed: 0.0478s/iter; left time: 245.2226s
	iters: 400, epoch: 5 | loss: 0.5665222
	speed: 0.0472s/iter; left time: 237.2823s
	iters: 500, epoch: 5 | loss: 0.4908153
	speed: 0.0474s/iter; left time: 233.2074s
	iters: 600, epoch: 5 | loss: 0.5147063
	speed: 0.0472s/iter; left time: 227.6687s
	iters: 700, epoch: 5 | loss: 0.5094537
	speed: 0.0480s/iter; left time: 226.6643s
	iters: 800, epoch: 5 | loss: 0.4967179
	speed: 0.0479s/iter; left time: 221.6643s
	iters: 900, epoch: 5 | loss: 0.5081043
	speed: 0.0479s/iter; left time: 216.7222s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.24s
Steps: 904 | Train Loss: 0.5015742 Vali Loss: 0.3630638 Test Loss: 0.4041309
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4387510
	speed: 0.1133s/iter; left time: 500.8447s
	iters: 200, epoch: 6 | loss: 0.4870841
	speed: 0.0477s/iter; left time: 206.1144s
	iters: 300, epoch: 6 | loss: 0.4566146
	speed: 0.0477s/iter; left time: 201.2555s
	iters: 400, epoch: 6 | loss: 0.5016585
	speed: 0.0476s/iter; left time: 195.9814s
	iters: 500, epoch: 6 | loss: 0.4581495
	speed: 0.0478s/iter; left time: 192.0669s
	iters: 600, epoch: 6 | loss: 0.4670890
	speed: 0.0476s/iter; left time: 186.7489s
	iters: 700, epoch: 6 | loss: 0.4126664
	speed: 0.0476s/iter; left time: 181.9990s
	iters: 800, epoch: 6 | loss: 0.4717660
	speed: 0.0473s/iter; left time: 175.9381s
	iters: 900, epoch: 6 | loss: 0.4670301
	speed: 0.0473s/iter; left time: 171.1890s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.24s
Steps: 904 | Train Loss: 0.4697863 Vali Loss: 0.3762727 Test Loss: 0.4250588
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3752802610397339, rmse:0.6126012206077576, mae:0.4050658047199249, rse:0.5609005689620972
Original data scale mse:3351209.75, rmse:1830.6309814453125, mae:1242.9312744140625, rse:0.1288289725780487
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.9653229
	speed: 0.0498s/iter; left time: 445.7071s
	iters: 200, epoch: 1 | loss: 0.9592443
	speed: 0.0480s/iter; left time: 424.3403s
	iters: 300, epoch: 1 | loss: 0.9222880
	speed: 0.0477s/iter; left time: 416.7712s
	iters: 400, epoch: 1 | loss: 0.8529933
	speed: 0.0478s/iter; left time: 412.6439s
	iters: 500, epoch: 1 | loss: 0.8573939
	speed: 0.0478s/iter; left time: 408.0985s
	iters: 600, epoch: 1 | loss: 0.7562770
	speed: 0.0475s/iter; left time: 400.5721s
	iters: 700, epoch: 1 | loss: 0.7871364
	speed: 0.0475s/iter; left time: 396.5616s
	iters: 800, epoch: 1 | loss: 0.7676636
	speed: 0.0478s/iter; left time: 394.1268s
	iters: 900, epoch: 1 | loss: 0.7613009
	speed: 0.0477s/iter; left time: 388.3531s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.44s
Steps: 904 | Train Loss: 0.8579809 Vali Loss: 0.5315363 Test Loss: 0.6103464
Validation loss decreased (inf --> 0.531536).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7556233
	speed: 0.1181s/iter; left time: 949.1566s
	iters: 200, epoch: 2 | loss: 0.7506686
	speed: 0.0478s/iter; left time: 379.0447s
	iters: 300, epoch: 2 | loss: 0.6182517
	speed: 0.0478s/iter; left time: 374.8729s
	iters: 400, epoch: 2 | loss: 0.5909048
	speed: 0.0476s/iter; left time: 368.3877s
	iters: 500, epoch: 2 | loss: 0.5872334
	speed: 0.0476s/iter; left time: 363.2943s
	iters: 600, epoch: 2 | loss: 0.6536552
	speed: 0.0477s/iter; left time: 359.2390s
	iters: 700, epoch: 2 | loss: 0.5787288
	speed: 0.0476s/iter; left time: 354.0162s
	iters: 800, epoch: 2 | loss: 0.5663756
	speed: 0.0476s/iter; left time: 349.3878s
	iters: 900, epoch: 2 | loss: 0.5409783
	speed: 0.0477s/iter; left time: 344.8887s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.42s
Steps: 904 | Train Loss: 0.6271455 Vali Loss: 0.3295841 Test Loss: 0.3736068
Validation loss decreased (0.531536 --> 0.329584).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5716667
	speed: 0.1189s/iter; left time: 848.2560s
	iters: 200, epoch: 3 | loss: 0.5719661
	speed: 0.0475s/iter; left time: 334.0743s
	iters: 300, epoch: 3 | loss: 0.5840744
	speed: 0.0475s/iter; left time: 329.0342s
	iters: 400, epoch: 3 | loss: 0.5660654
	speed: 0.0475s/iter; left time: 324.7668s
	iters: 500, epoch: 3 | loss: 0.5564195
	speed: 0.0471s/iter; left time: 317.4331s
	iters: 600, epoch: 3 | loss: 0.5835620
	speed: 0.0473s/iter; left time: 313.4799s
	iters: 700, epoch: 3 | loss: 0.5875228
	speed: 0.0474s/iter; left time: 309.9616s
	iters: 800, epoch: 3 | loss: 0.5355662
	speed: 0.0474s/iter; left time: 304.7386s
	iters: 900, epoch: 3 | loss: 0.4973130
	speed: 0.0474s/iter; left time: 300.2796s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.19s
Steps: 904 | Train Loss: 0.5603253 Vali Loss: 0.3253356 Test Loss: 0.3687771
Validation loss decreased (0.329584 --> 0.325336).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5248124
	speed: 0.1191s/iter; left time: 742.1396s
	iters: 200, epoch: 4 | loss: 0.5187337
	speed: 0.0475s/iter; left time: 291.3117s
	iters: 300, epoch: 4 | loss: 0.5060655
	speed: 0.0473s/iter; left time: 285.2141s
	iters: 400, epoch: 4 | loss: 0.5335032
	speed: 0.0472s/iter; left time: 280.0692s
	iters: 500, epoch: 4 | loss: 0.5122482
	speed: 0.0474s/iter; left time: 276.1540s
	iters: 600, epoch: 4 | loss: 0.5394168
	speed: 0.0474s/iter; left time: 271.5606s
	iters: 700, epoch: 4 | loss: 0.5319420
	speed: 0.0477s/iter; left time: 268.3972s
	iters: 800, epoch: 4 | loss: 0.5055789
	speed: 0.0479s/iter; left time: 264.6199s
	iters: 900, epoch: 4 | loss: 0.5209659
	speed: 0.0478s/iter; left time: 259.7257s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.23s
Steps: 904 | Train Loss: 0.5305911 Vali Loss: 0.3501219 Test Loss: 0.3719394
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4953448
	speed: 0.1153s/iter; left time: 614.1127s
	iters: 200, epoch: 5 | loss: 0.5292857
	speed: 0.0476s/iter; left time: 248.4562s
	iters: 300, epoch: 5 | loss: 0.5442499
	speed: 0.0476s/iter; left time: 243.9004s
	iters: 400, epoch: 5 | loss: 0.5065758
	speed: 0.0475s/iter; left time: 238.9152s
	iters: 500, epoch: 5 | loss: 0.5069329
	speed: 0.0474s/iter; left time: 233.6742s
	iters: 600, epoch: 5 | loss: 0.4753252
	speed: 0.0475s/iter; left time: 228.9475s
	iters: 700, epoch: 5 | loss: 0.4917132
	speed: 0.0475s/iter; left time: 224.3497s
	iters: 800, epoch: 5 | loss: 0.4792212
	speed: 0.0467s/iter; left time: 216.0557s
	iters: 900, epoch: 5 | loss: 0.4421820
	speed: 0.0475s/iter; left time: 214.9806s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.19s
Steps: 904 | Train Loss: 0.5022767 Vali Loss: 0.3613940 Test Loss: 0.4034348
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4668971
	speed: 0.1130s/iter; left time: 499.5837s
	iters: 200, epoch: 6 | loss: 0.4685586
	speed: 0.0473s/iter; left time: 204.3179s
	iters: 300, epoch: 6 | loss: 0.4735772
	speed: 0.0469s/iter; left time: 198.1707s
	iters: 400, epoch: 6 | loss: 0.4623413
	speed: 0.0472s/iter; left time: 194.6466s
	iters: 500, epoch: 6 | loss: 0.4929044
	speed: 0.0473s/iter; left time: 190.3615s
	iters: 600, epoch: 6 | loss: 0.4877677
	speed: 0.0464s/iter; left time: 181.9197s
	iters: 700, epoch: 6 | loss: 0.5007854
	speed: 0.0474s/iter; left time: 181.2034s
	iters: 800, epoch: 6 | loss: 0.4480936
	speed: 0.0474s/iter; left time: 176.2143s
	iters: 900, epoch: 6 | loss: 0.4335511
	speed: 0.0474s/iter; left time: 171.5226s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.85s
Steps: 904 | Train Loss: 0.4695626 Vali Loss: 0.3493001 Test Loss: 0.4039576
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.36870425939559937, rmse:0.6072102189064026, mae:0.4022841155529022, rse:0.5559645295143127
Original data scale mse:3368993.75, rmse:1835.48193359375, mae:1239.2218017578125, rse:0.12917035818099976

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.3752802610397339, RMSE: 0.6126012206077576, MAE: 0.4050658047199249, RSE: 0.5609005689620972
Unscaled Metrics - MSE: 3351209.75, RMSE: 1830.6309814453125, MAE: 1242.9312744140625, RSE: 0.1288289725780487

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.36870425939559937, RMSE: 0.6072102189064026, MAE: 0.4022841155529022, RSE: 0.5559645295143127
Unscaled Metrics - MSE: 3368993.75, RMSE: 1835.48193359375, MAE: 1239.2218017578125, RSE: 0.12917035818099976

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.0167955
	speed: 0.0827s/iter; left time: 737.6426s
	iters: 200, epoch: 1 | loss: 0.9397397
	speed: 0.0535s/iter; left time: 472.1460s
	iters: 300, epoch: 1 | loss: 0.9781731
	speed: 0.0534s/iter; left time: 465.5493s
	iters: 400, epoch: 1 | loss: 0.9427738
	speed: 0.0534s/iter; left time: 460.0725s
	iters: 500, epoch: 1 | loss: 0.9082873
	speed: 0.0536s/iter; left time: 456.6418s
	iters: 600, epoch: 1 | loss: 0.9156837
	speed: 0.0535s/iter; left time: 450.3429s
	iters: 700, epoch: 1 | loss: 0.8786386
	speed: 0.0535s/iter; left time: 445.3970s
	iters: 800, epoch: 1 | loss: 0.9189999
	speed: 0.0536s/iter; left time: 440.6238s
	iters: 900, epoch: 1 | loss: 0.8499623
	speed: 0.0536s/iter; left time: 434.9434s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.03s
Steps: 902 | Train Loss: 0.9243095 Vali Loss: 0.7218931 Test Loss: 0.8066534
Validation loss decreased (inf --> 0.721893).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8436679
	speed: 0.1347s/iter; left time: 1079.8641s
	iters: 200, epoch: 2 | loss: 0.7684191
	speed: 0.0536s/iter; left time: 424.4849s
	iters: 300, epoch: 2 | loss: 0.6995217
	speed: 0.0538s/iter; left time: 420.5903s
	iters: 400, epoch: 2 | loss: 0.6781839
	speed: 0.0536s/iter; left time: 413.7463s
	iters: 500, epoch: 2 | loss: 0.6225335
	speed: 0.0537s/iter; left time: 409.2749s
	iters: 600, epoch: 2 | loss: 0.6461043
	speed: 0.0538s/iter; left time: 404.1608s
	iters: 700, epoch: 2 | loss: 0.5617115
	speed: 0.0535s/iter; left time: 397.2537s
	iters: 800, epoch: 2 | loss: 0.5937615
	speed: 0.0537s/iter; left time: 392.9541s
	iters: 900, epoch: 2 | loss: 0.5894011
	speed: 0.0536s/iter; left time: 386.7439s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.68s
Steps: 902 | Train Loss: 0.6807329 Vali Loss: 0.3710781 Test Loss: 0.4374319
Validation loss decreased (0.721893 --> 0.371078).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5658567
	speed: 0.1361s/iter; left time: 968.4365s
	iters: 200, epoch: 3 | loss: 0.6233304
	speed: 0.0536s/iter; left time: 376.3044s
	iters: 300, epoch: 3 | loss: 0.6068082
	speed: 0.0535s/iter; left time: 369.7976s
	iters: 400, epoch: 3 | loss: 0.6192529
	speed: 0.0535s/iter; left time: 364.4368s
	iters: 500, epoch: 3 | loss: 0.6099423
	speed: 0.0536s/iter; left time: 360.0647s
	iters: 600, epoch: 3 | loss: 0.5602368
	speed: 0.0537s/iter; left time: 355.0779s
	iters: 700, epoch: 3 | loss: 0.5612581
	speed: 0.0533s/iter; left time: 347.5466s
	iters: 800, epoch: 3 | loss: 0.5751061
	speed: 0.0537s/iter; left time: 344.3109s
	iters: 900, epoch: 3 | loss: 0.5740261
	speed: 0.0534s/iter; left time: 337.1203s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.5868403 Vali Loss: 0.3717536 Test Loss: 0.4094001
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5883700
	speed: 0.1200s/iter; left time: 746.0194s
	iters: 200, epoch: 4 | loss: 0.5593413
	speed: 0.0424s/iter; left time: 259.4555s
	iters: 300, epoch: 4 | loss: 0.6124033
	speed: 0.0424s/iter; left time: 255.0458s
	iters: 400, epoch: 4 | loss: 0.5379121
	speed: 0.0424s/iter; left time: 250.7185s
	iters: 500, epoch: 4 | loss: 0.5447181
	speed: 0.0519s/iter; left time: 301.7443s
	iters: 600, epoch: 4 | loss: 0.5390958
	speed: 0.0535s/iter; left time: 305.5368s
	iters: 700, epoch: 4 | loss: 0.5633318
	speed: 0.0535s/iter; left time: 300.4656s
	iters: 800, epoch: 4 | loss: 0.5803256
	speed: 0.0536s/iter; left time: 295.4104s
	iters: 900, epoch: 4 | loss: 0.5154415
	speed: 0.0535s/iter; left time: 289.6044s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.94s
Steps: 902 | Train Loss: 0.5545426 Vali Loss: 0.3691072 Test Loss: 0.4263225
Validation loss decreased (0.371078 --> 0.369107).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4848920
	speed: 0.1336s/iter; left time: 709.7887s
	iters: 200, epoch: 5 | loss: 0.4848527
	speed: 0.0533s/iter; left time: 278.1005s
	iters: 300, epoch: 5 | loss: 0.5481394
	speed: 0.0535s/iter; left time: 273.7559s
	iters: 400, epoch: 5 | loss: 0.5518869
	speed: 0.0535s/iter; left time: 268.1675s
	iters: 500, epoch: 5 | loss: 0.5256121
	speed: 0.0533s/iter; left time: 261.9975s
	iters: 600, epoch: 5 | loss: 0.5175101
	speed: 0.0532s/iter; left time: 255.8990s
	iters: 700, epoch: 5 | loss: 0.5304766
	speed: 0.0534s/iter; left time: 251.5521s
	iters: 800, epoch: 5 | loss: 0.5045947
	speed: 0.0532s/iter; left time: 245.5637s
	iters: 900, epoch: 5 | loss: 0.4729941
	speed: 0.0534s/iter; left time: 241.1132s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.42s
Steps: 902 | Train Loss: 0.5183214 Vali Loss: 0.3914593 Test Loss: 0.4242806
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4672797
	speed: 0.1302s/iter; left time: 574.4827s
	iters: 200, epoch: 6 | loss: 0.4909238
	speed: 0.0535s/iter; left time: 230.8274s
	iters: 300, epoch: 6 | loss: 0.4649538
	speed: 0.0537s/iter; left time: 226.0089s
	iters: 400, epoch: 6 | loss: 0.4733930
	speed: 0.0536s/iter; left time: 220.5091s
	iters: 500, epoch: 6 | loss: 0.4558841
	speed: 0.0538s/iter; left time: 215.6564s
	iters: 600, epoch: 6 | loss: 0.4638785
	speed: 0.0537s/iter; left time: 210.0393s
	iters: 700, epoch: 6 | loss: 0.4564201
	speed: 0.0537s/iter; left time: 204.5904s
	iters: 800, epoch: 6 | loss: 0.4620390
	speed: 0.0537s/iter; left time: 199.2853s
	iters: 900, epoch: 6 | loss: 0.4517702
	speed: 0.0536s/iter; left time: 193.5612s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.64s
Steps: 902 | Train Loss: 0.4782813 Vali Loss: 0.4453080 Test Loss: 0.4706109
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4473444
	speed: 0.1309s/iter; left time: 459.2251s
	iters: 200, epoch: 7 | loss: 0.4557104
	speed: 0.0535s/iter; left time: 182.4277s
	iters: 300, epoch: 7 | loss: 0.4176767
	speed: 0.0537s/iter; left time: 177.6896s
	iters: 400, epoch: 7 | loss: 0.4240120
	speed: 0.0537s/iter; left time: 172.3057s
	iters: 500, epoch: 7 | loss: 0.4496929
	speed: 0.0536s/iter; left time: 166.7687s
	iters: 600, epoch: 7 | loss: 0.4319722
	speed: 0.0536s/iter; left time: 161.2157s
	iters: 700, epoch: 7 | loss: 0.4240620
	speed: 0.0536s/iter; left time: 155.9381s
	iters: 800, epoch: 7 | loss: 0.4044870
	speed: 0.0536s/iter; left time: 150.6331s
	iters: 900, epoch: 7 | loss: 0.3836114
	speed: 0.0535s/iter; left time: 145.0103s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.60s
Steps: 902 | Train Loss: 0.4386697 Vali Loss: 0.4388615 Test Loss: 0.4871139
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.42663174867630005, rmse:0.6531705260276794, mae:0.4383777678012848, rse:0.5982241630554199
Original data scale mse:4557453.0, rmse:2134.819091796875, mae:1400.7711181640625, rse:0.15037702023983002
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.9722031
	speed: 0.0554s/iter; left time: 494.5249s
	iters: 200, epoch: 1 | loss: 0.9747844
	speed: 0.0536s/iter; left time: 472.7617s
	iters: 300, epoch: 1 | loss: 0.9109181
	speed: 0.0535s/iter; left time: 466.9747s
	iters: 400, epoch: 1 | loss: 0.9210148
	speed: 0.0535s/iter; left time: 460.8464s
	iters: 500, epoch: 1 | loss: 0.9123129
	speed: 0.0535s/iter; left time: 455.9922s
	iters: 600, epoch: 1 | loss: 0.8490481
	speed: 0.0532s/iter; left time: 448.3974s
	iters: 700, epoch: 1 | loss: 0.8629799
	speed: 0.0535s/iter; left time: 445.0326s
	iters: 800, epoch: 1 | loss: 0.8565895
	speed: 0.0536s/iter; left time: 440.4781s
	iters: 900, epoch: 1 | loss: 0.8606700
	speed: 0.0536s/iter; left time: 435.0685s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.52s
Steps: 902 | Train Loss: 0.9185804 Vali Loss: 0.7074089 Test Loss: 0.8100665
Validation loss decreased (inf --> 0.707409).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8139427
	speed: 0.1371s/iter; left time: 1099.7135s
	iters: 200, epoch: 2 | loss: 0.7304046
	speed: 0.0533s/iter; left time: 421.6982s
	iters: 300, epoch: 2 | loss: 0.7087858
	speed: 0.0530s/iter; left time: 414.1389s
	iters: 400, epoch: 2 | loss: 0.6459229
	speed: 0.0533s/iter; left time: 411.6613s
	iters: 500, epoch: 2 | loss: 0.6948351
	speed: 0.0532s/iter; left time: 405.4510s
	iters: 600, epoch: 2 | loss: 0.5876655
	speed: 0.0533s/iter; left time: 401.0946s
	iters: 700, epoch: 2 | loss: 0.6246740
	speed: 0.0531s/iter; left time: 393.7840s
	iters: 800, epoch: 2 | loss: 0.5705623
	speed: 0.0531s/iter; left time: 388.8764s
	iters: 900, epoch: 2 | loss: 0.6203146
	speed: 0.0532s/iter; left time: 383.7635s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.25s
Steps: 902 | Train Loss: 0.6811836 Vali Loss: 0.3664021 Test Loss: 0.4130161
Validation loss decreased (0.707409 --> 0.366402).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6519820
	speed: 0.1375s/iter; left time: 978.4451s
	iters: 200, epoch: 3 | loss: 0.5853963
	speed: 0.0537s/iter; left time: 376.6686s
	iters: 300, epoch: 3 | loss: 0.5813435
	speed: 0.0538s/iter; left time: 372.1143s
	iters: 400, epoch: 3 | loss: 0.5948873
	speed: 0.0536s/iter; left time: 365.1735s
	iters: 500, epoch: 3 | loss: 0.5645135
	speed: 0.0538s/iter; left time: 361.4715s
	iters: 600, epoch: 3 | loss: 0.5952434
	speed: 0.0537s/iter; left time: 355.2524s
	iters: 700, epoch: 3 | loss: 0.5550939
	speed: 0.0537s/iter; left time: 350.1320s
	iters: 800, epoch: 3 | loss: 0.6046544
	speed: 0.0537s/iter; left time: 344.6704s
	iters: 900, epoch: 3 | loss: 0.6012749
	speed: 0.0535s/iter; left time: 337.9059s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.80s
Steps: 902 | Train Loss: 0.5895619 Vali Loss: 0.3544819 Test Loss: 0.3803743
Validation loss decreased (0.366402 --> 0.354482).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5805601
	speed: 0.1356s/iter; left time: 843.0595s
	iters: 200, epoch: 4 | loss: 0.5506290
	speed: 0.0535s/iter; left time: 327.1589s
	iters: 300, epoch: 4 | loss: 0.5444251
	speed: 0.0534s/iter; left time: 321.3679s
	iters: 400, epoch: 4 | loss: 0.5716223
	speed: 0.0534s/iter; left time: 315.9805s
	iters: 500, epoch: 4 | loss: 0.5440370
	speed: 0.0534s/iter; left time: 310.4134s
	iters: 600, epoch: 4 | loss: 0.5197716
	speed: 0.0535s/iter; left time: 305.6312s
	iters: 700, epoch: 4 | loss: 0.5420921
	speed: 0.0532s/iter; left time: 298.9896s
	iters: 800, epoch: 4 | loss: 0.5675485
	speed: 0.0536s/iter; left time: 295.4046s
	iters: 900, epoch: 4 | loss: 0.5283664
	speed: 0.0535s/iter; left time: 289.8484s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.54s
Steps: 902 | Train Loss: 0.5549234 Vali Loss: 0.3772310 Test Loss: 0.4337317
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5204930
	speed: 0.1323s/iter; left time: 703.1094s
	iters: 200, epoch: 5 | loss: 0.5137395
	speed: 0.0538s/iter; left time: 280.3061s
	iters: 300, epoch: 5 | loss: 0.5436147
	speed: 0.0536s/iter; left time: 274.3116s
	iters: 400, epoch: 5 | loss: 0.5396038
	speed: 0.0538s/iter; left time: 269.5186s
	iters: 500, epoch: 5 | loss: 0.5049858
	speed: 0.0538s/iter; left time: 264.1832s
	iters: 600, epoch: 5 | loss: 0.5065873
	speed: 0.0538s/iter; left time: 258.9192s
	iters: 700, epoch: 5 | loss: 0.4958868
	speed: 0.0537s/iter; left time: 252.8669s
	iters: 800, epoch: 5 | loss: 0.5119482
	speed: 0.0537s/iter; left time: 247.7993s
	iters: 900, epoch: 5 | loss: 0.4998782
	speed: 0.0536s/iter; left time: 241.8501s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.5179544 Vali Loss: 0.4029525 Test Loss: 0.4237615
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5306967
	speed: 0.1313s/iter; left time: 579.3572s
	iters: 200, epoch: 6 | loss: 0.4490047
	speed: 0.0535s/iter; left time: 230.7212s
	iters: 300, epoch: 6 | loss: 0.4816878
	speed: 0.0536s/iter; left time: 225.7131s
	iters: 400, epoch: 6 | loss: 0.4949283
	speed: 0.0537s/iter; left time: 220.8548s
	iters: 500, epoch: 6 | loss: 0.5112297
	speed: 0.0537s/iter; left time: 215.3931s
	iters: 600, epoch: 6 | loss: 0.4775193
	speed: 0.0536s/iter; left time: 209.8149s
	iters: 700, epoch: 6 | loss: 0.4740773
	speed: 0.0539s/iter; left time: 205.2385s
	iters: 800, epoch: 6 | loss: 0.4434006
	speed: 0.0537s/iter; left time: 199.1042s
	iters: 900, epoch: 6 | loss: 0.4392073
	speed: 0.0537s/iter; left time: 193.8715s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.67s
Steps: 902 | Train Loss: 0.4809718 Vali Loss: 0.4163098 Test Loss: 0.4588859
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.38027825951576233, rmse:0.6166670322418213, mae:0.4219621419906616, rse:0.5647914409637451
Original data scale mse:3870673.5, rmse:1967.4027099609375, mae:1330.7379150390625, rse:0.1385841816663742

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.42663174867630005, RMSE: 0.6531705260276794, MAE: 0.4383777678012848, RSE: 0.5982241630554199
Unscaled Metrics - MSE: 4557453.0, RMSE: 2134.819091796875, MAE: 1400.7711181640625, RSE: 0.15037702023983002

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.38027825951576233, RMSE: 0.6166670322418213, MAE: 0.4219621419906616, RSE: 0.5647914409637451
Unscaled Metrics - MSE: 3870673.5, RMSE: 1967.4027099609375, MAE: 1330.7379150390625, RSE: 0.1385841816663742

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7658398
	speed: 0.0765s/iter; left time: 685.6830s
	iters: 200, epoch: 1 | loss: 0.6677880
	speed: 0.0452s/iter; left time: 400.4808s
	iters: 300, epoch: 1 | loss: 0.5829280
	speed: 0.0454s/iter; left time: 397.4778s
	iters: 400, epoch: 1 | loss: 0.5657452
	speed: 0.0422s/iter; left time: 365.8596s
	iters: 500, epoch: 1 | loss: 0.4680697
	speed: 0.0423s/iter; left time: 362.3191s
	iters: 600, epoch: 1 | loss: 0.4667040
	speed: 0.0445s/iter; left time: 376.4680s
	iters: 700, epoch: 1 | loss: 0.4123696
	speed: 0.0415s/iter; left time: 347.3890s
	iters: 800, epoch: 1 | loss: 0.4252708
	speed: 0.0417s/iter; left time: 344.5298s
	iters: 900, epoch: 1 | loss: 0.4546904
	speed: 0.0433s/iter; left time: 353.7515s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:40.21s
Steps: 906 | Train Loss: 0.5560629 Vali Loss: 0.4108872 Test Loss: 0.4343379
Validation loss decreased (inf --> 0.410887).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3920784
	speed: 0.1005s/iter; left time: 809.6570s
	iters: 200, epoch: 2 | loss: 0.3530011
	speed: 0.0414s/iter; left time: 328.9530s
	iters: 300, epoch: 2 | loss: 0.3132612
	speed: 0.0417s/iter; left time: 327.3611s
	iters: 400, epoch: 2 | loss: 0.2940865
	speed: 0.0416s/iter; left time: 322.6943s
	iters: 500, epoch: 2 | loss: 0.3241894
	speed: 0.0419s/iter; left time: 320.4422s
	iters: 600, epoch: 2 | loss: 0.3002513
	speed: 0.0422s/iter; left time: 318.9555s
	iters: 700, epoch: 2 | loss: 0.3009806
	speed: 0.0407s/iter; left time: 303.4073s
	iters: 800, epoch: 2 | loss: 0.2952692
	speed: 0.0413s/iter; left time: 304.0421s
	iters: 900, epoch: 2 | loss: 0.3011583
	speed: 0.0419s/iter; left time: 304.1201s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.97s
Steps: 906 | Train Loss: 0.3142306 Vali Loss: 0.2782304 Test Loss: 0.3069682
Validation loss decreased (0.410887 --> 0.278230).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2778008
	speed: 0.1040s/iter; left time: 743.1850s
	iters: 200, epoch: 3 | loss: 0.2557818
	speed: 0.0444s/iter; left time: 312.9402s
	iters: 300, epoch: 3 | loss: 0.2828343
	speed: 0.0412s/iter; left time: 286.5279s
	iters: 400, epoch: 3 | loss: 0.2644242
	speed: 0.0436s/iter; left time: 298.9049s
	iters: 500, epoch: 3 | loss: 0.2965000
	speed: 0.0457s/iter; left time: 308.5607s
	iters: 600, epoch: 3 | loss: 0.2691018
	speed: 0.0459s/iter; left time: 304.9286s
	iters: 700, epoch: 3 | loss: 0.2444813
	speed: 0.0462s/iter; left time: 302.4119s
	iters: 800, epoch: 3 | loss: 0.2611493
	speed: 0.0460s/iter; left time: 296.8090s
	iters: 900, epoch: 3 | loss: 0.2468601
	speed: 0.0448s/iter; left time: 284.3898s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:40.63s
Steps: 906 | Train Loss: 0.2656985 Vali Loss: 0.2622160 Test Loss: 0.2867334
Validation loss decreased (0.278230 --> 0.262216).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2448414
	speed: 0.1011s/iter; left time: 631.2036s
	iters: 200, epoch: 4 | loss: 0.2262080
	speed: 0.0416s/iter; left time: 255.7612s
	iters: 300, epoch: 4 | loss: 0.2377535
	speed: 0.0415s/iter; left time: 250.9648s
	iters: 400, epoch: 4 | loss: 0.2528980
	speed: 0.0413s/iter; left time: 245.5571s
	iters: 500, epoch: 4 | loss: 0.2211230
	speed: 0.0420s/iter; left time: 245.2556s
	iters: 600, epoch: 4 | loss: 0.3098609
	speed: 0.0423s/iter; left time: 242.7409s
	iters: 700, epoch: 4 | loss: 0.2626181
	speed: 0.0417s/iter; left time: 235.3160s
	iters: 800, epoch: 4 | loss: 0.2586488
	speed: 0.0424s/iter; left time: 235.0273s
	iters: 900, epoch: 4 | loss: 0.2817690
	speed: 0.0456s/iter; left time: 248.0972s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.58s
Steps: 906 | Train Loss: 0.2504700 Vali Loss: 0.2566077 Test Loss: 0.2819408
Validation loss decreased (0.262216 --> 0.256608).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2320381
	speed: 0.1013s/iter; left time: 540.7964s
	iters: 200, epoch: 5 | loss: 0.2063793
	speed: 0.0410s/iter; left time: 214.5667s
	iters: 300, epoch: 5 | loss: 0.2258321
	speed: 0.0413s/iter; left time: 212.0350s
	iters: 400, epoch: 5 | loss: 0.2275739
	speed: 0.0417s/iter; left time: 209.8938s
	iters: 500, epoch: 5 | loss: 0.2579707
	speed: 0.0414s/iter; left time: 204.5843s
	iters: 600, epoch: 5 | loss: 0.2204268
	speed: 0.0414s/iter; left time: 200.0845s
	iters: 700, epoch: 5 | loss: 0.2691202
	speed: 0.0411s/iter; left time: 194.7388s
	iters: 800, epoch: 5 | loss: 0.2176536
	speed: 0.0411s/iter; left time: 190.7247s
	iters: 900, epoch: 5 | loss: 0.2476480
	speed: 0.0413s/iter; left time: 187.2931s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.73s
Steps: 906 | Train Loss: 0.2392980 Vali Loss: 0.2457850 Test Loss: 0.2784732
Validation loss decreased (0.256608 --> 0.245785).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2278262
	speed: 0.1013s/iter; left time: 448.8074s
	iters: 200, epoch: 6 | loss: 0.2344662
	speed: 0.0417s/iter; left time: 180.7242s
	iters: 300, epoch: 6 | loss: 0.2678352
	speed: 0.0417s/iter; left time: 176.3628s
	iters: 400, epoch: 6 | loss: 0.2622559
	speed: 0.0412s/iter; left time: 170.1877s
	iters: 500, epoch: 6 | loss: 0.2319873
	speed: 0.0416s/iter; left time: 167.8782s
	iters: 600, epoch: 6 | loss: 0.2493435
	speed: 0.0413s/iter; left time: 162.3903s
	iters: 700, epoch: 6 | loss: 0.2529826
	speed: 0.0414s/iter; left time: 158.7732s
	iters: 800, epoch: 6 | loss: 0.2370283
	speed: 0.0409s/iter; left time: 152.4275s
	iters: 900, epoch: 6 | loss: 0.2512580
	speed: 0.0410s/iter; left time: 149.0144s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.81s
Steps: 906 | Train Loss: 0.2300658 Vali Loss: 0.2555321 Test Loss: 0.2912895
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2401146
	speed: 0.0955s/iter; left time: 336.4843s
	iters: 200, epoch: 7 | loss: 0.1981369
	speed: 0.0422s/iter; left time: 144.3935s
	iters: 300, epoch: 7 | loss: 0.2162853
	speed: 0.0414s/iter; left time: 137.6000s
	iters: 400, epoch: 7 | loss: 0.2156045
	speed: 0.0418s/iter; left time: 134.6520s
	iters: 500, epoch: 7 | loss: 0.2025874
	speed: 0.0417s/iter; left time: 130.3836s
	iters: 600, epoch: 7 | loss: 0.1930152
	speed: 0.0418s/iter; left time: 126.4446s
	iters: 700, epoch: 7 | loss: 0.2144910
	speed: 0.0414s/iter; left time: 121.0575s
	iters: 800, epoch: 7 | loss: 0.2522355
	speed: 0.0422s/iter; left time: 119.2965s
	iters: 900, epoch: 7 | loss: 0.2177822
	speed: 0.0419s/iter; left time: 114.2636s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.07s
Steps: 906 | Train Loss: 0.2204496 Vali Loss: 0.2520531 Test Loss: 0.2736143
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2086276
	speed: 0.0969s/iter; left time: 253.8050s
	iters: 200, epoch: 8 | loss: 0.1845438
	speed: 0.0416s/iter; left time: 104.9120s
	iters: 300, epoch: 8 | loss: 0.2192687
	speed: 0.0412s/iter; left time: 99.7516s
	iters: 400, epoch: 8 | loss: 0.1884843
	speed: 0.0414s/iter; left time: 95.8979s
	iters: 500, epoch: 8 | loss: 0.2302061
	speed: 0.0412s/iter; left time: 91.3578s
	iters: 600, epoch: 8 | loss: 0.2098395
	speed: 0.0414s/iter; left time: 87.7754s
	iters: 700, epoch: 8 | loss: 0.2069492
	speed: 0.0412s/iter; left time: 83.1820s
	iters: 800, epoch: 8 | loss: 0.1913996
	speed: 0.0413s/iter; left time: 79.1897s
	iters: 900, epoch: 8 | loss: 0.2314721
	speed: 0.0412s/iter; left time: 74.9306s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.72s
Steps: 906 | Train Loss: 0.2109208 Vali Loss: 0.2510587 Test Loss: 0.2787984
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.21910180151462555, rmse:0.46808311343193054, mae:0.27836713194847107, rse:0.42868807911872864
Original data scale mse:1594660.125, rmse:1262.798583984375, mae:805.4220581054688, rse:0.08873982727527618
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7002316
	speed: 0.0468s/iter; left time: 419.2475s
	iters: 200, epoch: 1 | loss: 0.6557034
	speed: 0.0451s/iter; left time: 399.2997s
	iters: 300, epoch: 1 | loss: 0.6142732
	speed: 0.0420s/iter; left time: 367.5446s
	iters: 400, epoch: 1 | loss: 0.5308752
	speed: 0.0419s/iter; left time: 362.5780s
	iters: 500, epoch: 1 | loss: 0.5120242
	speed: 0.0423s/iter; left time: 362.2324s
	iters: 600, epoch: 1 | loss: 0.4399273
	speed: 0.0415s/iter; left time: 351.4441s
	iters: 700, epoch: 1 | loss: 0.4464138
	speed: 0.0424s/iter; left time: 354.1084s
	iters: 800, epoch: 1 | loss: 0.3971923
	speed: 0.0417s/iter; left time: 344.7159s
	iters: 900, epoch: 1 | loss: 0.4011859
	speed: 0.0409s/iter; left time: 333.8295s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.79s
Steps: 906 | Train Loss: 0.5618671 Vali Loss: 0.4116590 Test Loss: 0.4370006
Validation loss decreased (inf --> 0.411659).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3624009
	speed: 0.1011s/iter; left time: 814.5107s
	iters: 200, epoch: 2 | loss: 0.3401251
	speed: 0.0418s/iter; left time: 332.1955s
	iters: 300, epoch: 2 | loss: 0.3464944
	speed: 0.0424s/iter; left time: 332.6919s
	iters: 400, epoch: 2 | loss: 0.2691968
	speed: 0.0414s/iter; left time: 320.9664s
	iters: 500, epoch: 2 | loss: 0.3069927
	speed: 0.0418s/iter; left time: 320.0072s
	iters: 600, epoch: 2 | loss: 0.2768152
	speed: 0.0421s/iter; left time: 317.6939s
	iters: 700, epoch: 2 | loss: 0.2844798
	speed: 0.0416s/iter; left time: 310.2009s
	iters: 800, epoch: 2 | loss: 0.2903019
	speed: 0.0417s/iter; left time: 306.4033s
	iters: 900, epoch: 2 | loss: 0.2610583
	speed: 0.0414s/iter; left time: 300.3299s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.17s
Steps: 906 | Train Loss: 0.3161997 Vali Loss: 0.2772183 Test Loss: 0.2996305
Validation loss decreased (0.411659 --> 0.277218).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3098630
	speed: 0.1025s/iter; left time: 732.8856s
	iters: 200, epoch: 3 | loss: 0.2784005
	speed: 0.0416s/iter; left time: 293.4541s
	iters: 300, epoch: 3 | loss: 0.3128611
	speed: 0.0408s/iter; left time: 283.3059s
	iters: 400, epoch: 3 | loss: 0.2680096
	speed: 0.0412s/iter; left time: 282.3892s
	iters: 500, epoch: 3 | loss: 0.2751653
	speed: 0.0409s/iter; left time: 275.7543s
	iters: 600, epoch: 3 | loss: 0.2231238
	speed: 0.0412s/iter; left time: 274.1632s
	iters: 700, epoch: 3 | loss: 0.2238910
	speed: 0.0409s/iter; left time: 267.9594s
	iters: 800, epoch: 3 | loss: 0.2307681
	speed: 0.0410s/iter; left time: 264.2617s
	iters: 900, epoch: 3 | loss: 0.2413232
	speed: 0.0418s/iter; left time: 265.5472s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.67s
Steps: 906 | Train Loss: 0.2651823 Vali Loss: 0.2702336 Test Loss: 0.2830085
Validation loss decreased (0.277218 --> 0.270234).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2537463
	speed: 0.1033s/iter; left time: 645.0320s
	iters: 200, epoch: 4 | loss: 0.3079119
	speed: 0.0414s/iter; left time: 254.6232s
	iters: 300, epoch: 4 | loss: 0.2620684
	speed: 0.0422s/iter; left time: 255.0415s
	iters: 400, epoch: 4 | loss: 0.2197376
	speed: 0.0412s/iter; left time: 245.1303s
	iters: 500, epoch: 4 | loss: 0.2753679
	speed: 0.0413s/iter; left time: 241.1551s
	iters: 600, epoch: 4 | loss: 0.2384428
	speed: 0.0416s/iter; left time: 238.6550s
	iters: 700, epoch: 4 | loss: 0.2516672
	speed: 0.0414s/iter; left time: 233.7938s
	iters: 800, epoch: 4 | loss: 0.2341013
	speed: 0.0410s/iter; left time: 227.3969s
	iters: 900, epoch: 4 | loss: 0.2442877
	speed: 0.0413s/iter; left time: 224.8460s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.10s
Steps: 906 | Train Loss: 0.2494561 Vali Loss: 0.2530367 Test Loss: 0.2756551
Validation loss decreased (0.270234 --> 0.253037).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2617603
	speed: 0.1021s/iter; left time: 544.9529s
	iters: 200, epoch: 5 | loss: 0.2048971
	speed: 0.0418s/iter; left time: 218.7532s
	iters: 300, epoch: 5 | loss: 0.2296131
	speed: 0.0414s/iter; left time: 212.7431s
	iters: 400, epoch: 5 | loss: 0.2419697
	speed: 0.0417s/iter; left time: 209.8243s
	iters: 500, epoch: 5 | loss: 0.2483848
	speed: 0.0417s/iter; left time: 205.8060s
	iters: 600, epoch: 5 | loss: 0.2277864
	speed: 0.0414s/iter; left time: 200.2685s
	iters: 700, epoch: 5 | loss: 0.2237131
	speed: 0.0414s/iter; left time: 196.0168s
	iters: 800, epoch: 5 | loss: 0.2181919
	speed: 0.0418s/iter; left time: 193.6859s
	iters: 900, epoch: 5 | loss: 0.2288605
	speed: 0.0420s/iter; left time: 190.4421s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.05s
Steps: 906 | Train Loss: 0.2391961 Vali Loss: 0.2532814 Test Loss: 0.2769435
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2130304
	speed: 0.0976s/iter; left time: 432.6497s
	iters: 200, epoch: 6 | loss: 0.2479201
	speed: 0.0416s/iter; left time: 180.1449s
	iters: 300, epoch: 6 | loss: 0.2207096
	speed: 0.0417s/iter; left time: 176.6016s
	iters: 400, epoch: 6 | loss: 0.2143759
	speed: 0.0413s/iter; left time: 170.6869s
	iters: 500, epoch: 6 | loss: 0.2286179
	speed: 0.0413s/iter; left time: 166.6473s
	iters: 600, epoch: 6 | loss: 0.2237428
	speed: 0.0416s/iter; left time: 163.7237s
	iters: 700, epoch: 6 | loss: 0.2361782
	speed: 0.0407s/iter; left time: 155.8369s
	iters: 800, epoch: 6 | loss: 0.2027325
	speed: 0.0412s/iter; left time: 153.6008s
	iters: 900, epoch: 6 | loss: 0.1944828
	speed: 0.0411s/iter; left time: 149.3028s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.78s
Steps: 906 | Train Loss: 0.2290326 Vali Loss: 0.2474496 Test Loss: 0.2735841
Validation loss decreased (0.253037 --> 0.247450).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2271255
	speed: 0.1014s/iter; left time: 357.4117s
	iters: 200, epoch: 7 | loss: 0.2014666
	speed: 0.0419s/iter; left time: 143.4667s
	iters: 300, epoch: 7 | loss: 0.2065472
	speed: 0.0417s/iter; left time: 138.7222s
	iters: 400, epoch: 7 | loss: 0.1876702
	speed: 0.0417s/iter; left time: 134.3374s
	iters: 500, epoch: 7 | loss: 0.2400982
	speed: 0.0412s/iter; left time: 128.7473s
	iters: 600, epoch: 7 | loss: 0.2203981
	speed: 0.0418s/iter; left time: 126.4563s
	iters: 700, epoch: 7 | loss: 0.2342420
	speed: 0.0414s/iter; left time: 121.0740s
	iters: 800, epoch: 7 | loss: 0.2080038
	speed: 0.0412s/iter; left time: 116.3019s
	iters: 900, epoch: 7 | loss: 0.2372303
	speed: 0.0419s/iter; left time: 114.1069s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.03s
Steps: 906 | Train Loss: 0.2197368 Vali Loss: 0.2475829 Test Loss: 0.2720874
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2573103
	speed: 0.0996s/iter; left time: 260.7845s
	iters: 200, epoch: 8 | loss: 0.2178015
	speed: 0.0423s/iter; left time: 106.5094s
	iters: 300, epoch: 8 | loss: 0.1936962
	speed: 0.0443s/iter; left time: 107.1205s
	iters: 400, epoch: 8 | loss: 0.2067839
	speed: 0.0436s/iter; left time: 101.1954s
	iters: 500, epoch: 8 | loss: 0.1968598
	speed: 0.0413s/iter; left time: 91.5944s
	iters: 600, epoch: 8 | loss: 0.1934470
	speed: 0.0414s/iter; left time: 87.7996s
	iters: 700, epoch: 8 | loss: 0.1789363
	speed: 0.0416s/iter; left time: 83.9557s
	iters: 800, epoch: 8 | loss: 0.1970618
	speed: 0.0416s/iter; left time: 79.8603s
	iters: 900, epoch: 8 | loss: 0.2077165
	speed: 0.0417s/iter; left time: 75.8331s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.75s
Steps: 906 | Train Loss: 0.2129173 Vali Loss: 0.2442430 Test Loss: 0.2759668
Validation loss decreased (0.247450 --> 0.244243).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1978225
	speed: 0.1017s/iter; left time: 174.2127s
	iters: 200, epoch: 9 | loss: 0.2363453
	speed: 0.0415s/iter; left time: 66.8724s
	iters: 300, epoch: 9 | loss: 0.1999378
	speed: 0.0419s/iter; left time: 63.3596s
	iters: 400, epoch: 9 | loss: 0.2127515
	speed: 0.0417s/iter; left time: 58.8905s
	iters: 500, epoch: 9 | loss: 0.2056280
	speed: 0.0416s/iter; left time: 54.6223s
	iters: 600, epoch: 9 | loss: 0.2182594
	speed: 0.0413s/iter; left time: 50.1565s
	iters: 700, epoch: 9 | loss: 0.2273411
	speed: 0.0411s/iter; left time: 45.7786s
	iters: 800, epoch: 9 | loss: 0.1936232
	speed: 0.0409s/iter; left time: 41.4758s
	iters: 900, epoch: 9 | loss: 0.2037744
	speed: 0.0412s/iter; left time: 37.6448s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.85s
Steps: 906 | Train Loss: 0.2049292 Vali Loss: 0.2466030 Test Loss: 0.2727070
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2055866
	speed: 0.1012s/iter; left time: 81.6411s
	iters: 200, epoch: 10 | loss: 0.1861190
	speed: 0.0435s/iter; left time: 30.7545s
	iters: 300, epoch: 10 | loss: 0.1647008
	speed: 0.0410s/iter; left time: 24.8744s
	iters: 400, epoch: 10 | loss: 0.2084407
	speed: 0.0415s/iter; left time: 21.0268s
	iters: 500, epoch: 10 | loss: 0.1822848
	speed: 0.0413s/iter; left time: 16.8199s
	iters: 600, epoch: 10 | loss: 0.1939348
	speed: 0.0410s/iter; left time: 12.5734s
	iters: 700, epoch: 10 | loss: 0.1764833
	speed: 0.0412s/iter; left time: 8.5362s
	iters: 800, epoch: 10 | loss: 0.2045729
	speed: 0.0410s/iter; left time: 4.3870s
	iters: 900, epoch: 10 | loss: 0.1914260
	speed: 0.0414s/iter; left time: 0.2895s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:38.17s
Steps: 906 | Train Loss: 0.1966049 Vali Loss: 0.2504768 Test Loss: 0.2802193
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.782969000000001e-05
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2303640991449356, rmse:0.4799625873565674, mae:0.27629637718200684, rse:0.43956777453422546
Original data scale mse:1614850.0, rmse:1270.7674560546875, mae:776.7830810546875, rse:0.08929982781410217

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.21910180151462555, RMSE: 0.46808311343193054, MAE: 0.27836713194847107, RSE: 0.42868807911872864
Unscaled Metrics - MSE: 1594660.125, RMSE: 1262.798583984375, MAE: 805.4220581054688, RSE: 0.08873982727527618

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.2303640991449356, RMSE: 0.4799625873565674, MAE: 0.27629637718200684, RSE: 0.43956777453422546
Unscaled Metrics - MSE: 1614850.0, RMSE: 1270.7674560546875, MAE: 776.7830810546875, RSE: 0.08929982781410217

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8194444
	speed: 0.0805s/iter; left time: 719.4058s
	iters: 200, epoch: 1 | loss: 0.7858828
	speed: 0.0502s/iter; left time: 444.0286s
	iters: 300, epoch: 1 | loss: 0.7105099
	speed: 0.0502s/iter; left time: 438.9224s
	iters: 400, epoch: 1 | loss: 0.6920090
	speed: 0.0480s/iter; left time: 414.5215s
	iters: 500, epoch: 1 | loss: 0.6592720
	speed: 0.0472s/iter; left time: 403.0431s
	iters: 600, epoch: 1 | loss: 0.6233738
	speed: 0.0470s/iter; left time: 396.9303s
	iters: 700, epoch: 1 | loss: 0.5969990
	speed: 0.0473s/iter; left time: 394.6747s
	iters: 800, epoch: 1 | loss: 0.5781684
	speed: 0.0472s/iter; left time: 389.0491s
	iters: 900, epoch: 1 | loss: 0.5954326
	speed: 0.0472s/iter; left time: 384.4809s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.36s
Steps: 904 | Train Loss: 0.6849336 Vali Loss: 0.5648963 Test Loss: 0.6105000
Validation loss decreased (inf --> 0.564896).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5083486
	speed: 0.1064s/iter; left time: 854.8880s
	iters: 200, epoch: 2 | loss: 0.5090740
	speed: 0.0354s/iter; left time: 280.8304s
	iters: 300, epoch: 2 | loss: 0.4422763
	speed: 0.0354s/iter; left time: 277.3503s
	iters: 400, epoch: 2 | loss: 0.4356405
	speed: 0.0354s/iter; left time: 273.9752s
	iters: 500, epoch: 2 | loss: 0.4120343
	speed: 0.0354s/iter; left time: 270.1370s
	iters: 600, epoch: 2 | loss: 0.4265748
	speed: 0.0354s/iter; left time: 266.7956s
	iters: 700, epoch: 2 | loss: 0.4015089
	speed: 0.0354s/iter; left time: 263.3968s
	iters: 800, epoch: 2 | loss: 0.4046543
	speed: 0.0354s/iter; left time: 259.6764s
	iters: 900, epoch: 2 | loss: 0.3653881
	speed: 0.0354s/iter; left time: 255.9780s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:32.32s
Steps: 904 | Train Loss: 0.4398183 Vali Loss: 0.3721565 Test Loss: 0.4010210
Validation loss decreased (0.564896 --> 0.372157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3745862
	speed: 0.1158s/iter; left time: 825.9446s
	iters: 200, epoch: 3 | loss: 0.3748656
	speed: 0.0475s/iter; left time: 334.0947s
	iters: 300, epoch: 3 | loss: 0.3898795
	speed: 0.0472s/iter; left time: 327.4442s
	iters: 400, epoch: 3 | loss: 0.3843555
	speed: 0.0473s/iter; left time: 323.0174s
	iters: 500, epoch: 3 | loss: 0.3563525
	speed: 0.0475s/iter; left time: 320.0548s
	iters: 600, epoch: 3 | loss: 0.3737522
	speed: 0.0475s/iter; left time: 314.8416s
	iters: 700, epoch: 3 | loss: 0.3472854
	speed: 0.0475s/iter; left time: 310.4421s
	iters: 800, epoch: 3 | loss: 0.3999780
	speed: 0.0474s/iter; left time: 304.6860s
	iters: 900, epoch: 3 | loss: 0.3750979
	speed: 0.0475s/iter; left time: 300.5358s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.14s
Steps: 904 | Train Loss: 0.3655876 Vali Loss: 0.3575998 Test Loss: 0.3905281
Validation loss decreased (0.372157 --> 0.357600).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3321671
	speed: 0.1189s/iter; left time: 740.6478s
	iters: 200, epoch: 4 | loss: 0.3498135
	speed: 0.0505s/iter; left time: 309.3956s
	iters: 300, epoch: 4 | loss: 0.3257758
	speed: 0.0501s/iter; left time: 302.3249s
	iters: 400, epoch: 4 | loss: 0.3659987
	speed: 0.0502s/iter; left time: 297.7908s
	iters: 500, epoch: 4 | loss: 0.3485477
	speed: 0.0505s/iter; left time: 294.4132s
	iters: 600, epoch: 4 | loss: 0.3386375
	speed: 0.0483s/iter; left time: 276.5377s
	iters: 700, epoch: 4 | loss: 0.3202740
	speed: 0.0472s/iter; left time: 265.9634s
	iters: 800, epoch: 4 | loss: 0.3301730
	speed: 0.0471s/iter; left time: 260.4226s
	iters: 900, epoch: 4 | loss: 0.3042085
	speed: 0.0473s/iter; left time: 256.9869s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:44.46s
Steps: 904 | Train Loss: 0.3410043 Vali Loss: 0.3503501 Test Loss: 0.3966831
Validation loss decreased (0.357600 --> 0.350350).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3037659
	speed: 0.1188s/iter; left time: 632.6499s
	iters: 200, epoch: 5 | loss: 0.3203688
	speed: 0.0473s/iter; left time: 247.1551s
	iters: 300, epoch: 5 | loss: 0.3133463
	speed: 0.0475s/iter; left time: 243.4599s
	iters: 400, epoch: 5 | loss: 0.3655977
	speed: 0.0476s/iter; left time: 239.1807s
	iters: 500, epoch: 5 | loss: 0.3193843
	speed: 0.0475s/iter; left time: 233.8762s
	iters: 600, epoch: 5 | loss: 0.3130433
	speed: 0.0473s/iter; left time: 228.1575s
	iters: 700, epoch: 5 | loss: 0.3429522
	speed: 0.0472s/iter; left time: 222.8656s
	iters: 800, epoch: 5 | loss: 0.3375140
	speed: 0.0470s/iter; left time: 217.3195s
	iters: 900, epoch: 5 | loss: 0.3091466
	speed: 0.0472s/iter; left time: 213.4298s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.07s
Steps: 904 | Train Loss: 0.3219305 Vali Loss: 0.3534890 Test Loss: 0.3829751
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2647931
	speed: 0.1157s/iter; left time: 511.3467s
	iters: 200, epoch: 6 | loss: 0.3202358
	speed: 0.0502s/iter; left time: 216.8789s
	iters: 300, epoch: 6 | loss: 0.3043575
	speed: 0.0501s/iter; left time: 211.5173s
	iters: 400, epoch: 6 | loss: 0.3216367
	speed: 0.0502s/iter; left time: 207.0104s
	iters: 500, epoch: 6 | loss: 0.3066123
	speed: 0.0502s/iter; left time: 201.7388s
	iters: 600, epoch: 6 | loss: 0.3039983
	speed: 0.0499s/iter; left time: 195.8427s
	iters: 700, epoch: 6 | loss: 0.2687866
	speed: 0.0503s/iter; left time: 192.0486s
	iters: 800, epoch: 6 | loss: 0.3116033
	speed: 0.0501s/iter; left time: 186.4922s
	iters: 900, epoch: 6 | loss: 0.3062279
	speed: 0.0487s/iter; left time: 176.3396s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.42s
Steps: 904 | Train Loss: 0.3055620 Vali Loss: 0.3545743 Test Loss: 0.3873697
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2980606
	speed: 0.1130s/iter; left time: 397.3380s
	iters: 200, epoch: 7 | loss: 0.2836417
	speed: 0.0475s/iter; left time: 162.4116s
	iters: 300, epoch: 7 | loss: 0.2874886
	speed: 0.0475s/iter; left time: 157.5723s
	iters: 400, epoch: 7 | loss: 0.2846011
	speed: 0.0474s/iter; left time: 152.4624s
	iters: 500, epoch: 7 | loss: 0.2747485
	speed: 0.0473s/iter; left time: 147.3167s
	iters: 600, epoch: 7 | loss: 0.3222345
	speed: 0.0473s/iter; left time: 142.8112s
	iters: 700, epoch: 7 | loss: 0.2801009
	speed: 0.0473s/iter; left time: 138.1023s
	iters: 800, epoch: 7 | loss: 0.2525797
	speed: 0.0475s/iter; left time: 133.7823s
	iters: 900, epoch: 7 | loss: 0.2912352
	speed: 0.0473s/iter; left time: 128.6475s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.09s
Steps: 904 | Train Loss: 0.2894968 Vali Loss: 0.3572147 Test Loss: 0.3913181
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.414560467004776, rmse:0.6438636779785156, mae:0.39693915843963623, rse:0.5895246267318726
Original data scale mse:3466446.0, rmse:1861.83935546875, mae:1189.1580810546875, rse:0.13102523982524872
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8143600
	speed: 0.0494s/iter; left time: 442.0827s
	iters: 200, epoch: 1 | loss: 0.8069707
	speed: 0.0474s/iter; left time: 418.8391s
	iters: 300, epoch: 1 | loss: 0.7258905
	speed: 0.0472s/iter; left time: 412.3985s
	iters: 400, epoch: 1 | loss: 0.6662552
	speed: 0.0469s/iter; left time: 405.4667s
	iters: 500, epoch: 1 | loss: 0.6254606
	speed: 0.0470s/iter; left time: 401.6897s
	iters: 600, epoch: 1 | loss: 0.6576487
	speed: 0.0480s/iter; left time: 405.4567s
	iters: 700, epoch: 1 | loss: 0.5940247
	speed: 0.0506s/iter; left time: 421.8687s
	iters: 800, epoch: 1 | loss: 0.5689263
	speed: 0.0502s/iter; left time: 413.9366s
	iters: 900, epoch: 1 | loss: 0.5605963
	speed: 0.0486s/iter; left time: 395.4849s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.81s
Steps: 904 | Train Loss: 0.6858299 Vali Loss: 0.5634840 Test Loss: 0.6084830
Validation loss decreased (inf --> 0.563484).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5220233
	speed: 0.1169s/iter; left time: 939.1496s
	iters: 200, epoch: 2 | loss: 0.4787720
	speed: 0.0474s/iter; left time: 375.8959s
	iters: 300, epoch: 2 | loss: 0.4464873
	speed: 0.0473s/iter; left time: 370.6414s
	iters: 400, epoch: 2 | loss: 0.4336378
	speed: 0.0471s/iter; left time: 364.7181s
	iters: 500, epoch: 2 | loss: 0.4204385
	speed: 0.0474s/iter; left time: 361.6562s
	iters: 600, epoch: 2 | loss: 0.4378102
	speed: 0.0472s/iter; left time: 355.4123s
	iters: 700, epoch: 2 | loss: 0.4077846
	speed: 0.0472s/iter; left time: 350.7232s
	iters: 800, epoch: 2 | loss: 0.3857242
	speed: 0.0474s/iter; left time: 347.6205s
	iters: 900, epoch: 2 | loss: 0.3512188
	speed: 0.0473s/iter; left time: 342.1979s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.05s
Steps: 904 | Train Loss: 0.4402507 Vali Loss: 0.3794266 Test Loss: 0.4041635
Validation loss decreased (0.563484 --> 0.379427).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3567398
	speed: 0.1205s/iter; left time: 859.6440s
	iters: 200, epoch: 3 | loss: 0.3579572
	speed: 0.0475s/iter; left time: 333.8881s
	iters: 300, epoch: 3 | loss: 0.3662185
	speed: 0.0473s/iter; left time: 327.8303s
	iters: 400, epoch: 3 | loss: 0.3844012
	speed: 0.0471s/iter; left time: 322.1346s
	iters: 500, epoch: 3 | loss: 0.3645019
	speed: 0.0472s/iter; left time: 317.9801s
	iters: 600, epoch: 3 | loss: 0.3728656
	speed: 0.0502s/iter; left time: 332.7096s
	iters: 700, epoch: 3 | loss: 0.3663040
	speed: 0.0499s/iter; left time: 325.8255s
	iters: 800, epoch: 3 | loss: 0.3479218
	speed: 0.0480s/iter; left time: 308.8979s
	iters: 900, epoch: 3 | loss: 0.3317879
	speed: 0.0470s/iter; left time: 297.5619s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.81s
Steps: 904 | Train Loss: 0.3648478 Vali Loss: 0.3700708 Test Loss: 0.3906473
Validation loss decreased (0.379427 --> 0.370071).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3530393
	speed: 0.1171s/iter; left time: 729.5586s
	iters: 200, epoch: 4 | loss: 0.3552867
	speed: 0.0473s/iter; left time: 289.9136s
	iters: 300, epoch: 4 | loss: 0.3695587
	speed: 0.0473s/iter; left time: 285.2111s
	iters: 400, epoch: 4 | loss: 0.3399829
	speed: 0.0473s/iter; left time: 280.1509s
	iters: 500, epoch: 4 | loss: 0.3399383
	speed: 0.0472s/iter; left time: 275.1257s
	iters: 600, epoch: 4 | loss: 0.3228261
	speed: 0.0473s/iter; left time: 271.2226s
	iters: 700, epoch: 4 | loss: 0.3409550
	speed: 0.0471s/iter; left time: 265.1996s
	iters: 800, epoch: 4 | loss: 0.3364600
	speed: 0.0473s/iter; left time: 261.3382s
	iters: 900, epoch: 4 | loss: 0.2953443
	speed: 0.0471s/iter; left time: 255.8722s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.99s
Steps: 904 | Train Loss: 0.3410232 Vali Loss: 0.3620172 Test Loss: 0.3849885
Validation loss decreased (0.370071 --> 0.362017).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3398839
	speed: 0.1167s/iter; left time: 621.6759s
	iters: 200, epoch: 5 | loss: 0.3214668
	speed: 0.0474s/iter; left time: 247.5621s
	iters: 300, epoch: 5 | loss: 0.3290381
	speed: 0.0474s/iter; left time: 242.9089s
	iters: 400, epoch: 5 | loss: 0.3247005
	speed: 0.0475s/iter; left time: 238.5903s
	iters: 500, epoch: 5 | loss: 0.3435668
	speed: 0.0475s/iter; left time: 233.7329s
	iters: 600, epoch: 5 | loss: 0.3316515
	speed: 0.0477s/iter; left time: 230.0208s
	iters: 700, epoch: 5 | loss: 0.3310225
	speed: 0.0505s/iter; left time: 238.7798s
	iters: 800, epoch: 5 | loss: 0.3263980
	speed: 0.0505s/iter; left time: 233.7177s
	iters: 900, epoch: 5 | loss: 0.3044598
	speed: 0.0505s/iter; left time: 228.3011s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:44.13s
Steps: 904 | Train Loss: 0.3234676 Vali Loss: 0.3503571 Test Loss: 0.3843094
Validation loss decreased (0.362017 --> 0.350357).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3157598
	speed: 0.1180s/iter; left time: 521.8317s
	iters: 200, epoch: 6 | loss: 0.2970769
	speed: 0.0471s/iter; left time: 203.5699s
	iters: 300, epoch: 6 | loss: 0.3265921
	speed: 0.0471s/iter; left time: 198.8464s
	iters: 400, epoch: 6 | loss: 0.2929426
	speed: 0.0470s/iter; left time: 193.6389s
	iters: 500, epoch: 6 | loss: 0.3182901
	speed: 0.0471s/iter; left time: 189.4658s
	iters: 600, epoch: 6 | loss: 0.2865613
	speed: 0.0473s/iter; left time: 185.3949s
	iters: 700, epoch: 6 | loss: 0.3130028
	speed: 0.0475s/iter; left time: 181.4853s
	iters: 800, epoch: 6 | loss: 0.3050112
	speed: 0.0474s/iter; left time: 176.3870s
	iters: 900, epoch: 6 | loss: 0.2854015
	speed: 0.0475s/iter; left time: 171.8417s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.11s
Steps: 904 | Train Loss: 0.3077483 Vali Loss: 0.3485248 Test Loss: 0.3923289
Validation loss decreased (0.350357 --> 0.348525).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3004719
	speed: 0.1164s/iter; left time: 409.3966s
	iters: 200, epoch: 7 | loss: 0.2644054
	speed: 0.0471s/iter; left time: 160.7908s
	iters: 300, epoch: 7 | loss: 0.3215572
	speed: 0.0471s/iter; left time: 156.1646s
	iters: 400, epoch: 7 | loss: 0.2850278
	speed: 0.0470s/iter; left time: 151.2093s
	iters: 500, epoch: 7 | loss: 0.2908298
	speed: 0.0473s/iter; left time: 147.3212s
	iters: 600, epoch: 7 | loss: 0.2764945
	speed: 0.0472s/iter; left time: 142.4026s
	iters: 700, epoch: 7 | loss: 0.2627114
	speed: 0.0471s/iter; left time: 137.4139s
	iters: 800, epoch: 7 | loss: 0.2888100
	speed: 0.0473s/iter; left time: 133.1882s
	iters: 900, epoch: 7 | loss: 0.2858063
	speed: 0.0471s/iter; left time: 128.0374s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.89s
Steps: 904 | Train Loss: 0.2921198 Vali Loss: 0.3484330 Test Loss: 0.3854381
Validation loss decreased (0.348525 --> 0.348433).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3018363
	speed: 0.1162s/iter; left time: 303.6164s
	iters: 200, epoch: 8 | loss: 0.2597109
	speed: 0.0470s/iter; left time: 118.1681s
	iters: 300, epoch: 8 | loss: 0.2587171
	speed: 0.0469s/iter; left time: 113.1121s
	iters: 400, epoch: 8 | loss: 0.2744844
	speed: 0.0472s/iter; left time: 109.1114s
	iters: 500, epoch: 8 | loss: 0.2540216
	speed: 0.0473s/iter; left time: 104.5649s
	iters: 600, epoch: 8 | loss: 0.2557564
	speed: 0.0470s/iter; left time: 99.2848s
	iters: 700, epoch: 8 | loss: 0.2673918
	speed: 0.0471s/iter; left time: 94.7725s
	iters: 800, epoch: 8 | loss: 0.2698271
	speed: 0.0473s/iter; left time: 90.4269s
	iters: 900, epoch: 8 | loss: 0.2563220
	speed: 0.0471s/iter; left time: 85.4545s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.87s
Steps: 904 | Train Loss: 0.2767774 Vali Loss: 0.3609783 Test Loss: 0.4058788
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2785788
	speed: 0.1141s/iter; left time: 195.0190s
	iters: 200, epoch: 9 | loss: 0.2689047
	speed: 0.0471s/iter; left time: 75.7127s
	iters: 300, epoch: 9 | loss: 0.2455976
	speed: 0.0471s/iter; left time: 71.1161s
	iters: 400, epoch: 9 | loss: 0.2755028
	speed: 0.0471s/iter; left time: 66.4021s
	iters: 500, epoch: 9 | loss: 0.2793898
	speed: 0.0472s/iter; left time: 61.7562s
	iters: 600, epoch: 9 | loss: 0.2587385
	speed: 0.0471s/iter; left time: 56.9480s
	iters: 700, epoch: 9 | loss: 0.2422304
	speed: 0.0471s/iter; left time: 52.2741s
	iters: 800, epoch: 9 | loss: 0.2421417
	speed: 0.0472s/iter; left time: 47.6489s
	iters: 900, epoch: 9 | loss: 0.2597741
	speed: 0.0472s/iter; left time: 42.8615s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:42.88s
Steps: 904 | Train Loss: 0.2642728 Vali Loss: 0.3604100 Test Loss: 0.4007988
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2395650
	speed: 0.1150s/iter; left time: 92.5979s
	iters: 200, epoch: 10 | loss: 0.2511782
	speed: 0.0473s/iter; left time: 33.3351s
	iters: 300, epoch: 10 | loss: 0.2586820
	speed: 0.0473s/iter; left time: 28.6020s
	iters: 400, epoch: 10 | loss: 0.2348278
	speed: 0.0496s/iter; left time: 25.0611s
	iters: 500, epoch: 10 | loss: 0.2347807
	speed: 0.0502s/iter; left time: 20.3390s
	iters: 600, epoch: 10 | loss: 0.2540067
	speed: 0.0502s/iter; left time: 15.3117s
	iters: 700, epoch: 10 | loss: 0.2489862
	speed: 0.0502s/iter; left time: 10.2906s
	iters: 800, epoch: 10 | loss: 0.2420948
	speed: 0.0479s/iter; left time: 5.0308s
	iters: 900, epoch: 10 | loss: 0.2396270
	speed: 0.0471s/iter; left time: 0.2357s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:44.21s
Steps: 904 | Train Loss: 0.2499323 Vali Loss: 0.3648506 Test Loss: 0.4001853
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.4017380177974701, rmse:0.6338280439376831, mae:0.3854842483997345, rse:0.5803359746932983
Original data scale mse:2930002.25, rmse:1711.7249755859375, mae:1105.7059326171875, rse:0.12046107649803162

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.414560467004776, RMSE: 0.6438636779785156, MAE: 0.39693915843963623, RSE: 0.5895246267318726
Unscaled Metrics - MSE: 3466446.0, RMSE: 1861.83935546875, MAE: 1189.1580810546875, RSE: 0.13102523982524872

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.4017380177974701, RMSE: 0.6338280439376831, MAE: 0.3854842483997345, RSE: 0.5803359746932983
Unscaled Metrics - MSE: 2930002.25, RMSE: 1711.7249755859375, MAE: 1105.7059326171875, RSE: 0.12046107649803162

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8267067
	speed: 0.0837s/iter; left time: 746.3259s
	iters: 200, epoch: 1 | loss: 0.7652000
	speed: 0.0535s/iter; left time: 471.8990s
	iters: 300, epoch: 1 | loss: 0.7857451
	speed: 0.0536s/iter; left time: 467.7878s
	iters: 400, epoch: 1 | loss: 0.7664663
	speed: 0.0535s/iter; left time: 461.2001s
	iters: 500, epoch: 1 | loss: 0.7256621
	speed: 0.0533s/iter; left time: 454.1560s
	iters: 600, epoch: 1 | loss: 0.7299204
	speed: 0.0533s/iter; left time: 448.8814s
	iters: 700, epoch: 1 | loss: 0.6947920
	speed: 0.0531s/iter; left time: 441.7160s
	iters: 800, epoch: 1 | loss: 0.7260430
	speed: 0.0531s/iter; left time: 436.4153s
	iters: 900, epoch: 1 | loss: 0.6595711
	speed: 0.0533s/iter; left time: 432.8372s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.84s
Steps: 902 | Train Loss: 0.7395102 Vali Loss: 0.6638799 Test Loss: 0.7127875
Validation loss decreased (inf --> 0.663880).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6599444
	speed: 0.1247s/iter; left time: 1000.1839s
	iters: 200, epoch: 2 | loss: 0.5900978
	speed: 0.0426s/iter; left time: 337.4324s
	iters: 300, epoch: 2 | loss: 0.5217836
	speed: 0.0426s/iter; left time: 332.8255s
	iters: 400, epoch: 2 | loss: 0.4894909
	speed: 0.0426s/iter; left time: 328.9131s
	iters: 500, epoch: 2 | loss: 0.4371974
	speed: 0.0426s/iter; left time: 324.4768s
	iters: 600, epoch: 2 | loss: 0.4573642
	speed: 0.0426s/iter; left time: 320.5336s
	iters: 700, epoch: 2 | loss: 0.3945926
	speed: 0.0426s/iter; left time: 315.8639s
	iters: 800, epoch: 2 | loss: 0.4019454
	speed: 0.0426s/iter; left time: 311.8591s
	iters: 900, epoch: 2 | loss: 0.4062926
	speed: 0.0426s/iter; left time: 307.2821s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.72s
Steps: 902 | Train Loss: 0.4962916 Vali Loss: 0.4031456 Test Loss: 0.4533842
Validation loss decreased (0.663880 --> 0.403146).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3758159
	speed: 0.1358s/iter; left time: 966.5805s
	iters: 200, epoch: 3 | loss: 0.4133745
	speed: 0.0538s/iter; left time: 377.1903s
	iters: 300, epoch: 3 | loss: 0.4120754
	speed: 0.0539s/iter; left time: 372.7912s
	iters: 400, epoch: 3 | loss: 0.4086446
	speed: 0.0537s/iter; left time: 365.8784s
	iters: 500, epoch: 3 | loss: 0.4066531
	speed: 0.0535s/iter; left time: 359.5578s
	iters: 600, epoch: 3 | loss: 0.3669579
	speed: 0.0536s/iter; left time: 354.6082s
	iters: 700, epoch: 3 | loss: 0.3846762
	speed: 0.0534s/iter; left time: 348.2740s
	iters: 800, epoch: 3 | loss: 0.3673024
	speed: 0.0537s/iter; left time: 344.3238s
	iters: 900, epoch: 3 | loss: 0.3758486
	speed: 0.0537s/iter; left time: 339.1304s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.81s
Steps: 902 | Train Loss: 0.3890517 Vali Loss: 0.3764254 Test Loss: 0.4272145
Validation loss decreased (0.403146 --> 0.376425).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3833492
	speed: 0.1350s/iter; left time: 838.7145s
	iters: 200, epoch: 4 | loss: 0.3712101
	speed: 0.0539s/iter; left time: 329.8729s
	iters: 300, epoch: 4 | loss: 0.4018792
	speed: 0.0539s/iter; left time: 323.9922s
	iters: 400, epoch: 4 | loss: 0.3448816
	speed: 0.0541s/iter; left time: 319.7761s
	iters: 500, epoch: 4 | loss: 0.3506112
	speed: 0.0536s/iter; left time: 311.6642s
	iters: 600, epoch: 4 | loss: 0.3428992
	speed: 0.0536s/iter; left time: 306.5482s
	iters: 700, epoch: 4 | loss: 0.3810257
	speed: 0.0534s/iter; left time: 299.7659s
	iters: 800, epoch: 4 | loss: 0.3814814
	speed: 0.0536s/iter; left time: 295.3619s
	iters: 900, epoch: 4 | loss: 0.3528812
	speed: 0.0530s/iter; left time: 287.2330s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.72s
Steps: 902 | Train Loss: 0.3627834 Vali Loss: 0.3839064 Test Loss: 0.4172231
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3241353
	speed: 0.1313s/iter; left time: 697.7951s
	iters: 200, epoch: 5 | loss: 0.3217109
	speed: 0.0537s/iter; left time: 279.8724s
	iters: 300, epoch: 5 | loss: 0.3566695
	speed: 0.0536s/iter; left time: 274.2684s
	iters: 400, epoch: 5 | loss: 0.3547616
	speed: 0.0538s/iter; left time: 269.5018s
	iters: 500, epoch: 5 | loss: 0.3673005
	speed: 0.0537s/iter; left time: 263.8934s
	iters: 600, epoch: 5 | loss: 0.3618083
	speed: 0.0536s/iter; left time: 257.9355s
	iters: 700, epoch: 5 | loss: 0.3725259
	speed: 0.0537s/iter; left time: 253.2760s
	iters: 800, epoch: 5 | loss: 0.3284369
	speed: 0.0538s/iter; left time: 247.9755s
	iters: 900, epoch: 5 | loss: 0.3179455
	speed: 0.0537s/iter; left time: 242.4279s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.68s
Steps: 902 | Train Loss: 0.3416904 Vali Loss: 0.3842506 Test Loss: 0.4151492
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3249086
	speed: 0.1303s/iter; left time: 574.7481s
	iters: 200, epoch: 6 | loss: 0.3238573
	speed: 0.0536s/iter; left time: 231.1893s
	iters: 300, epoch: 6 | loss: 0.3014056
	speed: 0.0538s/iter; left time: 226.7043s
	iters: 400, epoch: 6 | loss: 0.3240064
	speed: 0.0539s/iter; left time: 221.6891s
	iters: 500, epoch: 6 | loss: 0.3105236
	speed: 0.0537s/iter; left time: 215.3346s
	iters: 600, epoch: 6 | loss: 0.3142249
	speed: 0.0538s/iter; left time: 210.5564s
	iters: 700, epoch: 6 | loss: 0.3072575
	speed: 0.0537s/iter; left time: 204.7646s
	iters: 800, epoch: 6 | loss: 0.3001997
	speed: 0.0537s/iter; left time: 199.4366s
	iters: 900, epoch: 6 | loss: 0.3205052
	speed: 0.0539s/iter; left time: 194.7073s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.3231418 Vali Loss: 0.3906348 Test Loss: 0.4224386
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4430864751338959, rmse:0.6656473875045776, mae:0.4272341728210449, rse:0.6096514463424683
Original data scale mse:4373828.5, rmse:2091.3701171875, mae:1345.841064453125, rse:0.14731645584106445
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7937866
	speed: 0.0556s/iter; left time: 496.3345s
	iters: 200, epoch: 1 | loss: 0.7556736
	speed: 0.0534s/iter; left time: 471.3548s
	iters: 300, epoch: 1 | loss: 0.7930080
	speed: 0.0535s/iter; left time: 466.4268s
	iters: 400, epoch: 1 | loss: 0.7363957
	speed: 0.0536s/iter; left time: 461.7500s
	iters: 500, epoch: 1 | loss: 0.7320346
	speed: 0.0536s/iter; left time: 456.3666s
	iters: 600, epoch: 1 | loss: 0.7238904
	speed: 0.0535s/iter; left time: 450.8748s
	iters: 700, epoch: 1 | loss: 0.7105531
	speed: 0.0536s/iter; left time: 446.1926s
	iters: 800, epoch: 1 | loss: 0.6997612
	speed: 0.0537s/iter; left time: 441.8748s
	iters: 900, epoch: 1 | loss: 0.6425950
	speed: 0.0536s/iter; left time: 435.5986s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.63s
Steps: 902 | Train Loss: 0.7438353 Vali Loss: 0.6606365 Test Loss: 0.7169139
Validation loss decreased (inf --> 0.660636).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6109409
	speed: 0.1354s/iter; left time: 1085.9430s
	iters: 200, epoch: 2 | loss: 0.5715893
	speed: 0.0531s/iter; left time: 420.1301s
	iters: 300, epoch: 2 | loss: 0.4916646
	speed: 0.0537s/iter; left time: 419.9724s
	iters: 400, epoch: 2 | loss: 0.4784447
	speed: 0.0538s/iter; left time: 415.5683s
	iters: 500, epoch: 2 | loss: 0.4660654
	speed: 0.0537s/iter; left time: 409.0897s
	iters: 600, epoch: 2 | loss: 0.4350959
	speed: 0.0536s/iter; left time: 403.0004s
	iters: 700, epoch: 2 | loss: 0.4040615
	speed: 0.0538s/iter; left time: 398.8676s
	iters: 800, epoch: 2 | loss: 0.4253862
	speed: 0.0538s/iter; left time: 393.5667s
	iters: 900, epoch: 2 | loss: 0.4270161
	speed: 0.0536s/iter; left time: 387.1414s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.67s
Steps: 902 | Train Loss: 0.4971768 Vali Loss: 0.4029886 Test Loss: 0.4524754
Validation loss decreased (0.660636 --> 0.402989).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4311551
	speed: 0.1272s/iter; left time: 905.0811s
	iters: 200, epoch: 3 | loss: 0.3860455
	speed: 0.0428s/iter; left time: 300.4843s
	iters: 300, epoch: 3 | loss: 0.4196113
	speed: 0.0427s/iter; left time: 295.6447s
	iters: 400, epoch: 3 | loss: 0.3953407
	speed: 0.0427s/iter; left time: 291.2421s
	iters: 500, epoch: 3 | loss: 0.4171326
	speed: 0.0427s/iter; left time: 286.9549s
	iters: 600, epoch: 3 | loss: 0.3467782
	speed: 0.0428s/iter; left time: 282.9095s
	iters: 700, epoch: 3 | loss: 0.3781426
	speed: 0.0427s/iter; left time: 278.1978s
	iters: 800, epoch: 3 | loss: 0.3518520
	speed: 0.0427s/iter; left time: 274.1716s
	iters: 900, epoch: 3 | loss: 0.3819619
	speed: 0.0489s/iter; left time: 308.9917s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:39.59s
Steps: 902 | Train Loss: 0.3939003 Vali Loss: 0.3781945 Test Loss: 0.4223990
Validation loss decreased (0.402989 --> 0.378195).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4080811
	speed: 0.1387s/iter; left time: 861.7099s
	iters: 200, epoch: 4 | loss: 0.3544478
	speed: 0.0537s/iter; left time: 328.5229s
	iters: 300, epoch: 4 | loss: 0.3679753
	speed: 0.0538s/iter; left time: 323.7758s
	iters: 400, epoch: 4 | loss: 0.3738083
	speed: 0.0537s/iter; left time: 317.5581s
	iters: 500, epoch: 4 | loss: 0.3503709
	speed: 0.0544s/iter; left time: 316.3240s
	iters: 600, epoch: 4 | loss: 0.3668576
	speed: 0.0540s/iter; left time: 308.5844s
	iters: 700, epoch: 4 | loss: 0.3389795
	speed: 0.0535s/iter; left time: 300.4236s
	iters: 800, epoch: 4 | loss: 0.3894020
	speed: 0.0537s/iter; left time: 296.3338s
	iters: 900, epoch: 4 | loss: 0.3903238
	speed: 0.0538s/iter; left time: 291.1162s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.99s
Steps: 902 | Train Loss: 0.3661394 Vali Loss: 0.3769134 Test Loss: 0.4053811
Validation loss decreased (0.378195 --> 0.376913).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3745990
	speed: 0.1371s/iter; left time: 728.2439s
	iters: 200, epoch: 5 | loss: 0.3425794
	speed: 0.0537s/iter; left time: 279.9874s
	iters: 300, epoch: 5 | loss: 0.3297193
	speed: 0.0537s/iter; left time: 274.6979s
	iters: 400, epoch: 5 | loss: 0.3584466
	speed: 0.0536s/iter; left time: 268.8157s
	iters: 500, epoch: 5 | loss: 0.3425139
	speed: 0.0536s/iter; left time: 263.3154s
	iters: 600, epoch: 5 | loss: 0.3366902
	speed: 0.0537s/iter; left time: 258.6635s
	iters: 700, epoch: 5 | loss: 0.3418617
	speed: 0.0537s/iter; left time: 253.1218s
	iters: 800, epoch: 5 | loss: 0.3734284
	speed: 0.0535s/iter; left time: 246.8241s
	iters: 900, epoch: 5 | loss: 0.3319694
	speed: 0.0537s/iter; left time: 242.3901s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.72s
Steps: 902 | Train Loss: 0.3445658 Vali Loss: 0.3708047 Test Loss: 0.4228962
Validation loss decreased (0.376913 --> 0.370805).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3361575
	speed: 0.1349s/iter; left time: 595.0754s
	iters: 200, epoch: 6 | loss: 0.3252003
	speed: 0.0537s/iter; left time: 231.4531s
	iters: 300, epoch: 6 | loss: 0.3393177
	speed: 0.0536s/iter; left time: 225.7424s
	iters: 400, epoch: 6 | loss: 0.3423147
	speed: 0.0537s/iter; left time: 220.9102s
	iters: 500, epoch: 6 | loss: 0.3299300
	speed: 0.0535s/iter; left time: 214.5343s
	iters: 600, epoch: 6 | loss: 0.3095607
	speed: 0.0537s/iter; left time: 210.1738s
	iters: 700, epoch: 6 | loss: 0.3155437
	speed: 0.0537s/iter; left time: 204.8154s
	iters: 800, epoch: 6 | loss: 0.3248185
	speed: 0.0537s/iter; left time: 199.2228s
	iters: 900, epoch: 6 | loss: 0.3197203
	speed: 0.0534s/iter; left time: 192.9659s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.67s
Steps: 902 | Train Loss: 0.3261178 Vali Loss: 0.3809638 Test Loss: 0.4202033
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3260661
	speed: 0.1312s/iter; left time: 460.4493s
	iters: 200, epoch: 7 | loss: 0.2973912
	speed: 0.0537s/iter; left time: 183.0411s
	iters: 300, epoch: 7 | loss: 0.3061194
	speed: 0.0537s/iter; left time: 177.7495s
	iters: 400, epoch: 7 | loss: 0.3206269
	speed: 0.0536s/iter; left time: 172.1050s
	iters: 500, epoch: 7 | loss: 0.3198177
	speed: 0.0536s/iter; left time: 166.4957s
	iters: 600, epoch: 7 | loss: 0.3043910
	speed: 0.0537s/iter; left time: 161.5500s
	iters: 700, epoch: 7 | loss: 0.3240526
	speed: 0.0535s/iter; left time: 155.6034s
	iters: 800, epoch: 7 | loss: 0.2837071
	speed: 0.0535s/iter; left time: 150.3844s
	iters: 900, epoch: 7 | loss: 0.2735225
	speed: 0.0536s/iter; left time: 145.1624s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.65s
Steps: 902 | Train Loss: 0.3092398 Vali Loss: 0.3815430 Test Loss: 0.4276521
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3008300
	speed: 0.1306s/iter; left time: 340.5255s
	iters: 200, epoch: 8 | loss: 0.3018333
	speed: 0.0536s/iter; left time: 134.3801s
	iters: 300, epoch: 8 | loss: 0.3085520
	speed: 0.0538s/iter; left time: 129.5189s
	iters: 400, epoch: 8 | loss: 0.3161208
	speed: 0.0535s/iter; left time: 123.4104s
	iters: 500, epoch: 8 | loss: 0.2728466
	speed: 0.0537s/iter; left time: 118.5807s
	iters: 600, epoch: 8 | loss: 0.2825543
	speed: 0.0537s/iter; left time: 113.2198s
	iters: 700, epoch: 8 | loss: 0.2872694
	speed: 0.0535s/iter; left time: 107.4220s
	iters: 800, epoch: 8 | loss: 0.2744077
	speed: 0.0536s/iter; left time: 102.2033s
	iters: 900, epoch: 8 | loss: 0.2787901
	speed: 0.0537s/iter; left time: 97.0373s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.68s
Steps: 902 | Train Loss: 0.2927391 Vali Loss: 0.3817847 Test Loss: 0.4285708
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.44777974486351013, rmse:0.6691634654998779, mae:0.42269623279571533, rse:0.6128717660903931
Original data scale mse:4235910.0, rmse:2058.132568359375, mae:1310.9803466796875, rse:0.1449752151966095

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.4430864751338959, RMSE: 0.6656473875045776, MAE: 0.4272341728210449, RSE: 0.6096514463424683
Unscaled Metrics - MSE: 4373828.5, RMSE: 2091.3701171875, MAE: 1345.841064453125, RSE: 0.14731645584106445

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.44777974486351013, RMSE: 0.6691634654998779, MAE: 0.42269623279571533, RSE: 0.6128717660903931
Unscaled Metrics - MSE: 4235910.0, RMSE: 2058.132568359375, MAE: 1310.9803466796875, RSE: 0.1449752151966095
