
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=3, learning_rate=1e-05, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 1.2655926
	speed: 0.0645s/iter; left time: 1163.1290s
	iters: 200, epoch: 1 | loss: 1.1257330
	speed: 0.0334s/iter; left time: 598.8550s
	iters: 300, epoch: 1 | loss: 1.0365514
	speed: 0.0336s/iter; left time: 598.8625s
	iters: 400, epoch: 1 | loss: 1.0826616
	speed: 0.0332s/iter; left time: 588.5207s
	iters: 500, epoch: 1 | loss: 0.9831452
	speed: 0.0333s/iter; left time: 587.5538s
	iters: 600, epoch: 1 | loss: 0.9529172
	speed: 0.0333s/iter; left time: 583.9105s
	iters: 700, epoch: 1 | loss: 0.8132041
	speed: 0.0352s/iter; left time: 613.9352s
	iters: 800, epoch: 1 | loss: 0.8678878
	speed: 0.0330s/iter; left time: 572.3718s
	iters: 900, epoch: 1 | loss: 0.8668443
	speed: 0.0330s/iter; left time: 568.9413s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:31.64s
Steps: 906 | Train Loss: 1.0168596 Vali Loss: 0.8487804 Test Loss: 0.9571623
Validation loss decreased (inf --> 0.848780).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 2 | loss: 0.6205368
	speed: 0.0983s/iter; left time: 1681.9596s
	iters: 200, epoch: 2 | loss: 0.4253878
	speed: 0.0330s/iter; left time: 561.3882s
	iters: 300, epoch: 2 | loss: 0.3354857
	speed: 0.0345s/iter; left time: 583.4433s
	iters: 400, epoch: 2 | loss: 0.2754024
	speed: 0.0334s/iter; left time: 561.4366s
	iters: 500, epoch: 2 | loss: 0.3423934
	speed: 0.0330s/iter; left time: 551.2826s
	iters: 600, epoch: 2 | loss: 0.2980999
	speed: 0.0329s/iter; left time: 546.1756s
	iters: 700, epoch: 2 | loss: 0.2921608
	speed: 0.0330s/iter; left time: 544.1735s
	iters: 800, epoch: 2 | loss: 0.2983772
	speed: 0.0329s/iter; left time: 540.6488s
	iters: 900, epoch: 2 | loss: 0.2948388
	speed: 0.0328s/iter; left time: 535.6796s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:30.51s
Steps: 906 | Train Loss: 0.3569713 Vali Loss: 0.2462852 Test Loss: 0.2797472
Validation loss decreased (0.848780 --> 0.246285).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 3 | loss: 0.2653996
	speed: 0.1000s/iter; left time: 1620.6737s
	iters: 200, epoch: 3 | loss: 0.2120890
	speed: 0.0328s/iter; left time: 527.8860s
	iters: 300, epoch: 3 | loss: 0.2602098
	speed: 0.0328s/iter; left time: 524.8766s
	iters: 400, epoch: 3 | loss: 0.2079800
	speed: 0.0330s/iter; left time: 524.9169s
	iters: 500, epoch: 3 | loss: 0.3032918
	speed: 0.0328s/iter; left time: 518.7615s
	iters: 600, epoch: 3 | loss: 0.2656105
	speed: 0.0328s/iter; left time: 515.2379s
	iters: 700, epoch: 3 | loss: 0.1913124
	speed: 0.0327s/iter; left time: 509.8536s
	iters: 800, epoch: 3 | loss: 0.2174596
	speed: 0.0324s/iter; left time: 503.2106s
	iters: 900, epoch: 3 | loss: 0.2116019
	speed: 0.0325s/iter; left time: 501.2202s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:30.05s
Steps: 906 | Train Loss: 0.2390530 Vali Loss: 0.2166305 Test Loss: 0.2498899
Validation loss decreased (0.246285 --> 0.216630).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 4 | loss: 0.1990468
	speed: 0.0999s/iter; left time: 1529.4257s
	iters: 200, epoch: 4 | loss: 0.1888942
	speed: 0.0325s/iter; left time: 494.5352s
	iters: 300, epoch: 4 | loss: 0.2250282
	speed: 0.0325s/iter; left time: 491.4924s
	iters: 400, epoch: 4 | loss: 0.2040859
	speed: 0.0325s/iter; left time: 486.8950s
	iters: 500, epoch: 4 | loss: 0.2031991
	speed: 0.0325s/iter; left time: 484.5961s
	iters: 600, epoch: 4 | loss: 0.2883396
	speed: 0.0326s/iter; left time: 482.3796s
	iters: 700, epoch: 4 | loss: 0.2602419
	speed: 0.0324s/iter; left time: 476.3455s
	iters: 800, epoch: 4 | loss: 0.2502171
	speed: 0.0323s/iter; left time: 471.3138s
	iters: 900, epoch: 4 | loss: 0.2754031
	speed: 0.0327s/iter; left time: 474.0360s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:29.88s
Steps: 906 | Train Loss: 0.2162457 Vali Loss: 0.2035362 Test Loss: 0.2375945
Validation loss decreased (0.216630 --> 0.203536).  Saving model ...
Updating learning rate to 9e-06
	iters: 100, epoch: 5 | loss: 0.1779218
	speed: 0.0941s/iter; left time: 1355.3232s
	iters: 200, epoch: 5 | loss: 0.1628965
	speed: 0.0320s/iter; left time: 457.3853s
	iters: 300, epoch: 5 | loss: 0.1668604
	speed: 0.0319s/iter; left time: 453.3149s
	iters: 400, epoch: 5 | loss: 0.1712749
	speed: 0.0320s/iter; left time: 450.9551s
	iters: 500, epoch: 5 | loss: 0.2286835
	speed: 0.0320s/iter; left time: 448.2459s
	iters: 600, epoch: 5 | loss: 0.1758938
	speed: 0.0320s/iter; left time: 444.3929s
	iters: 700, epoch: 5 | loss: 0.2287813
	speed: 0.0319s/iter; left time: 439.8470s
	iters: 800, epoch: 5 | loss: 0.1645952
	speed: 0.0317s/iter; left time: 433.5500s
	iters: 900, epoch: 5 | loss: 0.2300254
	speed: 0.0317s/iter; left time: 431.3851s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:29.25s
Steps: 906 | Train Loss: 0.2023375 Vali Loss: 0.1983158 Test Loss: 0.2302715
Validation loss decreased (0.203536 --> 0.198316).  Saving model ...
Updating learning rate to 8.1e-06
	iters: 100, epoch: 6 | loss: 0.1984994
	speed: 0.0910s/iter; left time: 1228.3472s
	iters: 200, epoch: 6 | loss: 0.2014216
	speed: 0.0316s/iter; left time: 423.4627s
	iters: 300, epoch: 6 | loss: 0.2673222
	speed: 0.0316s/iter; left time: 420.3885s
	iters: 400, epoch: 6 | loss: 0.2324974
	speed: 0.0318s/iter; left time: 418.8575s
	iters: 500, epoch: 6 | loss: 0.1736211
	speed: 0.0316s/iter; left time: 414.3100s
	iters: 600, epoch: 6 | loss: 0.2277704
	speed: 0.0316s/iter; left time: 410.7830s
	iters: 700, epoch: 6 | loss: 0.2457504
	speed: 0.0316s/iter; left time: 406.8684s
	iters: 800, epoch: 6 | loss: 0.1754776
	speed: 0.0317s/iter; left time: 404.9718s
	iters: 900, epoch: 6 | loss: 0.2075734
	speed: 0.0317s/iter; left time: 402.7895s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:28.95s
Steps: 906 | Train Loss: 0.1929701 Vali Loss: 0.1915811 Test Loss: 0.2247654
Validation loss decreased (0.198316 --> 0.191581).  Saving model ...
Updating learning rate to 7.290000000000001e-06
	iters: 100, epoch: 7 | loss: 0.1909763
	speed: 0.0899s/iter; left time: 1131.4732s
	iters: 200, epoch: 7 | loss: 0.1391223
	speed: 0.0316s/iter; left time: 394.0341s
	iters: 300, epoch: 7 | loss: 0.1620394
	speed: 0.0315s/iter; left time: 389.8233s
	iters: 400, epoch: 7 | loss: 0.1572613
	speed: 0.0314s/iter; left time: 385.9734s
	iters: 500, epoch: 7 | loss: 0.1740226
	speed: 0.0314s/iter; left time: 383.0674s
	iters: 600, epoch: 7 | loss: 0.1448199
	speed: 0.0315s/iter; left time: 380.2064s
	iters: 700, epoch: 7 | loss: 0.1617811
	speed: 0.0314s/iter; left time: 376.6538s
	iters: 800, epoch: 7 | loss: 0.2418114
	speed: 0.0315s/iter; left time: 373.9198s
	iters: 900, epoch: 7 | loss: 0.1763118
	speed: 0.0315s/iter; left time: 371.4470s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:28.84s
Steps: 906 | Train Loss: 0.1855679 Vali Loss: 0.1916122 Test Loss: 0.2240161
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-06
	iters: 100, epoch: 8 | loss: 0.1528163
	speed: 0.0898s/iter; left time: 1049.0655s
	iters: 200, epoch: 8 | loss: 0.1402654
	speed: 0.0323s/iter; left time: 373.8837s
	iters: 300, epoch: 8 | loss: 0.1994791
	speed: 0.0323s/iter; left time: 370.7118s
	iters: 400, epoch: 8 | loss: 0.1748054
	speed: 0.0327s/iter; left time: 372.0569s
	iters: 500, epoch: 8 | loss: 0.2032394
	speed: 0.0325s/iter; left time: 366.1325s
	iters: 600, epoch: 8 | loss: 0.1853030
	speed: 0.0323s/iter; left time: 360.9262s
	iters: 700, epoch: 8 | loss: 0.1588358
	speed: 0.0321s/iter; left time: 355.6575s
	iters: 800, epoch: 8 | loss: 0.1668811
	speed: 0.0319s/iter; left time: 350.5853s
	iters: 900, epoch: 8 | loss: 0.2083564
	speed: 0.0319s/iter; left time: 347.5378s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:29.58s
Steps: 906 | Train Loss: 0.1789123 Vali Loss: 0.1909796 Test Loss: 0.2257884
Validation loss decreased (0.191581 --> 0.190980).  Saving model ...
Updating learning rate to 5.904900000000001e-06
	iters: 100, epoch: 9 | loss: 0.1739116
	speed: 0.0925s/iter; left time: 996.9422s
	iters: 200, epoch: 9 | loss: 0.1993625
	speed: 0.0319s/iter; left time: 340.8745s
	iters: 300, epoch: 9 | loss: 0.1636563
	speed: 0.0319s/iter; left time: 337.7103s
	iters: 400, epoch: 9 | loss: 0.2166614
	speed: 0.0319s/iter; left time: 334.1953s
	iters: 500, epoch: 9 | loss: 0.1858605
	speed: 0.0320s/iter; left time: 331.5020s
	iters: 600, epoch: 9 | loss: 0.1781302
	speed: 0.0319s/iter; left time: 327.8943s
	iters: 700, epoch: 9 | loss: 0.1733542
	speed: 0.0319s/iter; left time: 324.7958s
	iters: 800, epoch: 9 | loss: 0.1696661
	speed: 0.0319s/iter; left time: 320.9749s
	iters: 900, epoch: 9 | loss: 0.1628733
	speed: 0.0318s/iter; left time: 317.2615s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:29.27s
Steps: 906 | Train Loss: 0.1739853 Vali Loss: 0.1913661 Test Loss: 0.2280283
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.314410000000001e-06
	iters: 100, epoch: 10 | loss: 0.1886700
	speed: 0.0869s/iter; left time: 857.7209s
	iters: 200, epoch: 10 | loss: 0.1583662
	speed: 0.0305s/iter; left time: 298.1652s
	iters: 300, epoch: 10 | loss: 0.2071207
	speed: 0.0305s/iter; left time: 295.0708s
	iters: 400, epoch: 10 | loss: 0.1750381
	speed: 0.0305s/iter; left time: 291.6122s
	iters: 500, epoch: 10 | loss: 0.1599534
	speed: 0.0305s/iter; left time: 288.4065s
	iters: 600, epoch: 10 | loss: 0.1547934
	speed: 0.0305s/iter; left time: 285.6697s
	iters: 700, epoch: 10 | loss: 0.1641959
	speed: 0.0305s/iter; left time: 282.5363s
	iters: 800, epoch: 10 | loss: 0.1693465
	speed: 0.0305s/iter; left time: 279.6251s
	iters: 900, epoch: 10 | loss: 0.2088962
	speed: 0.0305s/iter; left time: 276.9105s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:27.96s
Steps: 906 | Train Loss: 0.1698084 Vali Loss: 0.1913244 Test Loss: 0.2238524
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.782969000000001e-06
	iters: 100, epoch: 11 | loss: 0.1410738
	speed: 0.0856s/iter; left time: 766.6166s
	iters: 200, epoch: 11 | loss: 0.1254946
	speed: 0.0305s/iter; left time: 270.6632s
	iters: 300, epoch: 11 | loss: 0.1921563
	speed: 0.0306s/iter; left time: 267.6494s
	iters: 400, epoch: 11 | loss: 0.1626051
	speed: 0.0305s/iter; left time: 264.3194s
	iters: 500, epoch: 11 | loss: 0.1395112
	speed: 0.0305s/iter; left time: 261.3798s
	iters: 600, epoch: 11 | loss: 0.1702996
	speed: 0.0304s/iter; left time: 257.4136s
	iters: 700, epoch: 11 | loss: 0.1565440
	speed: 0.0303s/iter; left time: 253.2346s
	iters: 800, epoch: 11 | loss: 0.1646023
	speed: 0.0303s/iter; left time: 250.4390s
	iters: 900, epoch: 11 | loss: 0.1816361
	speed: 0.0303s/iter; left time: 247.1955s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:27.89s
Steps: 906 | Train Loss: 0.1661819 Vali Loss: 0.1863565 Test Loss: 0.2223691
Validation loss decreased (0.190980 --> 0.186356).  Saving model ...
Updating learning rate to 4.304672100000001e-06
	iters: 100, epoch: 12 | loss: 0.2047073
	speed: 0.0920s/iter; left time: 741.0522s
	iters: 200, epoch: 12 | loss: 0.1806621
	speed: 0.0302s/iter; left time: 240.0103s
	iters: 300, epoch: 12 | loss: 0.2038715
	speed: 0.0302s/iter; left time: 237.3835s
	iters: 400, epoch: 12 | loss: 0.1419129
	speed: 0.0302s/iter; left time: 234.1270s
	iters: 500, epoch: 12 | loss: 0.1215186
	speed: 0.0302s/iter; left time: 231.0748s
	iters: 600, epoch: 12 | loss: 0.1550405
	speed: 0.0303s/iter; left time: 228.6485s
	iters: 700, epoch: 12 | loss: 0.1790772
	speed: 0.0303s/iter; left time: 225.6667s
	iters: 800, epoch: 12 | loss: 0.1482660
	speed: 0.0302s/iter; left time: 222.3609s
	iters: 900, epoch: 12 | loss: 0.1308462
	speed: 0.0303s/iter; left time: 219.6609s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:27.68s
Steps: 906 | Train Loss: 0.1631092 Vali Loss: 0.1833248 Test Loss: 0.2202100
Validation loss decreased (0.186356 --> 0.183325).  Saving model ...
Updating learning rate to 3.8742048900000015e-06
	iters: 100, epoch: 13 | loss: 0.2019415
	speed: 0.0888s/iter; left time: 634.8460s
	iters: 200, epoch: 13 | loss: 0.1578228
	speed: 0.0303s/iter; left time: 213.3379s
	iters: 300, epoch: 13 | loss: 0.1638445
	speed: 0.0303s/iter; left time: 210.2209s
	iters: 400, epoch: 13 | loss: 0.1835979
	speed: 0.0302s/iter; left time: 206.8192s
	iters: 500, epoch: 13 | loss: 0.1297828
	speed: 0.0302s/iter; left time: 204.0778s
	iters: 600, epoch: 13 | loss: 0.1768717
	speed: 0.0303s/iter; left time: 201.3557s
	iters: 700, epoch: 13 | loss: 0.1593725
	speed: 0.0303s/iter; left time: 198.4293s
	iters: 800, epoch: 13 | loss: 0.1237680
	speed: 0.0303s/iter; left time: 195.2640s
	iters: 900, epoch: 13 | loss: 0.1891339
	speed: 0.0303s/iter; left time: 192.2266s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:27.70s
Steps: 906 | Train Loss: 0.1603260 Vali Loss: 0.1840722 Test Loss: 0.2198605
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.486784401000001e-06
	iters: 100, epoch: 14 | loss: 0.1957013
	speed: 0.0835s/iter; left time: 521.0004s
	iters: 200, epoch: 14 | loss: 0.1663086
	speed: 0.0303s/iter; left time: 186.0366s
	iters: 300, epoch: 14 | loss: 0.1738329
	speed: 0.0303s/iter; left time: 182.9138s
	iters: 400, epoch: 14 | loss: 0.1429007
	speed: 0.0303s/iter; left time: 179.9698s
	iters: 500, epoch: 14 | loss: 0.1599222
	speed: 0.0303s/iter; left time: 176.8835s
	iters: 600, epoch: 14 | loss: 0.1743926
	speed: 0.0303s/iter; left time: 173.8981s
	iters: 700, epoch: 14 | loss: 0.1334641
	speed: 0.0303s/iter; left time: 170.9197s
	iters: 800, epoch: 14 | loss: 0.1281492
	speed: 0.0303s/iter; left time: 167.9768s
	iters: 900, epoch: 14 | loss: 0.1342761
	speed: 0.0303s/iter; left time: 164.8300s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:27.71s
Steps: 906 | Train Loss: 0.1581648 Vali Loss: 0.1850006 Test Loss: 0.2216871
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.138105960900001e-06
	iters: 100, epoch: 15 | loss: 0.1295189
	speed: 0.0832s/iter; left time: 444.1976s
	iters: 200, epoch: 15 | loss: 0.1223399
	speed: 0.0303s/iter; left time: 158.4610s
	iters: 300, epoch: 15 | loss: 0.1357728
	speed: 0.0302s/iter; left time: 155.3259s
	iters: 400, epoch: 15 | loss: 0.1444422
	speed: 0.0303s/iter; left time: 152.4297s
	iters: 500, epoch: 15 | loss: 0.1802864
	speed: 0.0303s/iter; left time: 149.6979s
	iters: 600, epoch: 15 | loss: 0.1279870
	speed: 0.0303s/iter; left time: 146.7310s
	iters: 700, epoch: 15 | loss: 0.1535772
	speed: 0.0303s/iter; left time: 143.4354s
	iters: 800, epoch: 15 | loss: 0.1905851
	speed: 0.0304s/iter; left time: 140.8355s
	iters: 900, epoch: 15 | loss: 0.1444526
	speed: 0.0303s/iter; left time: 137.3389s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.71s
Steps: 906 | Train Loss: 0.1560168 Vali Loss: 0.1850767 Test Loss: 0.2227659
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.22030074894428253, rmse:0.4693620800971985, mae:0.2934994399547577, rse:0.4298593997955322
Original data scale mse:1680994.875, rmse:1296.5318603515625, mae:861.99560546875, rse:0.09111034870147705
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 1.1973295
	speed: 0.0331s/iter; left time: 597.1368s
	iters: 200, epoch: 1 | loss: 1.1421980
	speed: 0.0302s/iter; left time: 542.1042s
	iters: 300, epoch: 1 | loss: 1.0683498
	speed: 0.0302s/iter; left time: 538.2024s
	iters: 400, epoch: 1 | loss: 1.0709852
	speed: 0.0302s/iter; left time: 535.1117s
	iters: 500, epoch: 1 | loss: 0.9242501
	speed: 0.0302s/iter; left time: 532.3480s
	iters: 600, epoch: 1 | loss: 0.9109845
	speed: 0.0302s/iter; left time: 528.7240s
	iters: 700, epoch: 1 | loss: 0.8609775
	speed: 0.0301s/iter; left time: 524.0272s
	iters: 800, epoch: 1 | loss: 0.9410301
	speed: 0.0299s/iter; left time: 518.2336s
	iters: 900, epoch: 1 | loss: 0.8934740
	speed: 0.0299s/iter; left time: 515.6926s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:27.64s
Steps: 906 | Train Loss: 1.0131149 Vali Loss: 0.8399439 Test Loss: 0.9540177
Validation loss decreased (inf --> 0.839944).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 2 | loss: 0.5374418
	speed: 0.0861s/iter; left time: 1472.7873s
	iters: 200, epoch: 2 | loss: 0.4233172
	speed: 0.0301s/iter; left time: 512.2404s
	iters: 300, epoch: 2 | loss: 0.3481802
	speed: 0.0301s/iter; left time: 508.7664s
	iters: 400, epoch: 2 | loss: 0.3249161
	speed: 0.0301s/iter; left time: 506.2153s
	iters: 500, epoch: 2 | loss: 0.3003129
	speed: 0.0301s/iter; left time: 503.8228s
	iters: 600, epoch: 2 | loss: 0.3237344
	speed: 0.0301s/iter; left time: 500.5551s
	iters: 700, epoch: 2 | loss: 0.2852631
	speed: 0.0301s/iter; left time: 496.8078s
	iters: 800, epoch: 2 | loss: 0.2535228
	speed: 0.0301s/iter; left time: 493.6008s
	iters: 900, epoch: 2 | loss: 0.2464543
	speed: 0.0301s/iter; left time: 491.1864s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:27.59s
Steps: 906 | Train Loss: 0.3592484 Vali Loss: 0.2497449 Test Loss: 0.2751626
Validation loss decreased (0.839944 --> 0.249745).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 3 | loss: 0.2510317
	speed: 0.0878s/iter; left time: 1423.4172s
	iters: 200, epoch: 3 | loss: 0.2203990
	speed: 0.0300s/iter; left time: 483.4522s
	iters: 300, epoch: 3 | loss: 0.1857467
	speed: 0.0300s/iter; left time: 480.4008s
	iters: 400, epoch: 3 | loss: 0.2201314
	speed: 0.0300s/iter; left time: 476.8723s
	iters: 500, epoch: 3 | loss: 0.2493524
	speed: 0.0300s/iter; left time: 474.0173s
	iters: 600, epoch: 3 | loss: 0.2327100
	speed: 0.0300s/iter; left time: 471.1628s
	iters: 700, epoch: 3 | loss: 0.1974741
	speed: 0.0300s/iter; left time: 468.4419s
	iters: 800, epoch: 3 | loss: 0.2512345
	speed: 0.0300s/iter; left time: 465.1880s
	iters: 900, epoch: 3 | loss: 0.1945242
	speed: 0.0300s/iter; left time: 462.2478s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.50s
Steps: 906 | Train Loss: 0.2380821 Vali Loss: 0.2192356 Test Loss: 0.2467774
Validation loss decreased (0.249745 --> 0.219236).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 4 | loss: 0.2088396
	speed: 0.0925s/iter; left time: 1415.8979s
	iters: 200, epoch: 4 | loss: 0.2268296
	speed: 0.0300s/iter; left time: 456.0171s
	iters: 300, epoch: 4 | loss: 0.2682111
	speed: 0.0300s/iter; left time: 453.8006s
	iters: 400, epoch: 4 | loss: 0.2142512
	speed: 0.0300s/iter; left time: 450.3977s
	iters: 500, epoch: 4 | loss: 0.2133008
	speed: 0.0300s/iter; left time: 447.0090s
	iters: 600, epoch: 4 | loss: 0.2556488
	speed: 0.0300s/iter; left time: 444.4221s
	iters: 700, epoch: 4 | loss: 0.1777005
	speed: 0.0300s/iter; left time: 440.5006s
	iters: 800, epoch: 4 | loss: 0.2581894
	speed: 0.0300s/iter; left time: 437.8109s
	iters: 900, epoch: 4 | loss: 0.1423981
	speed: 0.0300s/iter; left time: 435.1368s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:27.48s
Steps: 906 | Train Loss: 0.2149451 Vali Loss: 0.2036094 Test Loss: 0.2357368
Validation loss decreased (0.219236 --> 0.203609).  Saving model ...
Updating learning rate to 9e-06
	iters: 100, epoch: 5 | loss: 0.2451628
	speed: 0.0859s/iter; left time: 1236.6785s
	iters: 200, epoch: 5 | loss: 0.1844019
	speed: 0.0300s/iter; left time: 429.1551s
	iters: 300, epoch: 5 | loss: 0.1272023
	speed: 0.0300s/iter; left time: 425.9297s
	iters: 400, epoch: 5 | loss: 0.2236189
	speed: 0.0300s/iter; left time: 422.9288s
	iters: 500, epoch: 5 | loss: 0.1628642
	speed: 0.0300s/iter; left time: 420.4496s
	iters: 600, epoch: 5 | loss: 0.1402728
	speed: 0.0300s/iter; left time: 417.2173s
	iters: 700, epoch: 5 | loss: 0.2224473
	speed: 0.0300s/iter; left time: 413.9148s
	iters: 800, epoch: 5 | loss: 0.2364742
	speed: 0.0300s/iter; left time: 411.1036s
	iters: 900, epoch: 5 | loss: 0.2050458
	speed: 0.0300s/iter; left time: 407.9116s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:27.48s
Steps: 906 | Train Loss: 0.2004238 Vali Loss: 0.1958581 Test Loss: 0.2253950
Validation loss decreased (0.203609 --> 0.195858).  Saving model ...
Updating learning rate to 8.1e-06
	iters: 100, epoch: 6 | loss: 0.1923144
	speed: 0.0883s/iter; left time: 1191.6470s
	iters: 200, epoch: 6 | loss: 0.1665370
	speed: 0.0300s/iter; left time: 402.2874s
	iters: 300, epoch: 6 | loss: 0.1647235
	speed: 0.0300s/iter; left time: 398.5364s
	iters: 400, epoch: 6 | loss: 0.1797579
	speed: 0.0300s/iter; left time: 395.2480s
	iters: 500, epoch: 6 | loss: 0.1545018
	speed: 0.0300s/iter; left time: 392.1223s
	iters: 600, epoch: 6 | loss: 0.2259643
	speed: 0.0300s/iter; left time: 389.2560s
	iters: 700, epoch: 6 | loss: 0.1816601
	speed: 0.0300s/iter; left time: 386.0955s
	iters: 800, epoch: 6 | loss: 0.1513158
	speed: 0.0300s/iter; left time: 383.1009s
	iters: 900, epoch: 6 | loss: 0.1692653
	speed: 0.0299s/iter; left time: 379.9580s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:27.45s
Steps: 906 | Train Loss: 0.1902713 Vali Loss: 0.1955038 Test Loss: 0.2277900
Validation loss decreased (0.195858 --> 0.195504).  Saving model ...
Updating learning rate to 7.290000000000001e-06
	iters: 100, epoch: 7 | loss: 0.2298900
	speed: 0.0853s/iter; left time: 1073.7301s
	iters: 200, epoch: 7 | loss: 0.1472812
	speed: 0.0300s/iter; left time: 375.0070s
	iters: 300, epoch: 7 | loss: 0.1788663
	speed: 0.0301s/iter; left time: 372.5321s
	iters: 400, epoch: 7 | loss: 0.1623691
	speed: 0.0300s/iter; left time: 369.0336s
	iters: 500, epoch: 7 | loss: 0.1475256
	speed: 0.0300s/iter; left time: 365.6372s
	iters: 600, epoch: 7 | loss: 0.1393432
	speed: 0.0300s/iter; left time: 362.4063s
	iters: 700, epoch: 7 | loss: 0.1944267
	speed: 0.0300s/iter; left time: 359.2233s
	iters: 800, epoch: 7 | loss: 0.1804781
	speed: 0.0300s/iter; left time: 356.3488s
	iters: 900, epoch: 7 | loss: 0.1573293
	speed: 0.0300s/iter; left time: 353.1029s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:27.48s
Steps: 906 | Train Loss: 0.1823200 Vali Loss: 0.1930710 Test Loss: 0.2249620
Validation loss decreased (0.195504 --> 0.193071).  Saving model ...
Updating learning rate to 6.561e-06
	iters: 100, epoch: 8 | loss: 0.1789100
	speed: 0.0881s/iter; left time: 1028.5819s
	iters: 200, epoch: 8 | loss: 0.1614548
	speed: 0.0300s/iter; left time: 347.3805s
	iters: 300, epoch: 8 | loss: 0.1923694
	speed: 0.0300s/iter; left time: 344.4026s
	iters: 400, epoch: 8 | loss: 0.2199651
	speed: 0.0300s/iter; left time: 341.3317s
	iters: 500, epoch: 8 | loss: 0.1808472
	speed: 0.0301s/iter; left time: 339.4498s
	iters: 600, epoch: 8 | loss: 0.2397220
	speed: 0.0300s/iter; left time: 335.1406s
	iters: 700, epoch: 8 | loss: 0.2278471
	speed: 0.0300s/iter; left time: 332.3878s
	iters: 800, epoch: 8 | loss: 0.2043150
	speed: 0.0300s/iter; left time: 329.1771s
	iters: 900, epoch: 8 | loss: 0.1779005
	speed: 0.0300s/iter; left time: 326.3565s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:27.46s
Steps: 906 | Train Loss: 0.1759455 Vali Loss: 0.1875082 Test Loss: 0.2209941
Validation loss decreased (0.193071 --> 0.187508).  Saving model ...
Updating learning rate to 5.904900000000001e-06
	iters: 100, epoch: 9 | loss: 0.1644031
	speed: 0.0869s/iter; left time: 935.7968s
	iters: 200, epoch: 9 | loss: 0.2507294
	speed: 0.0300s/iter; left time: 319.7723s
	iters: 300, epoch: 9 | loss: 0.2283448
	speed: 0.0299s/iter; left time: 316.4675s
	iters: 400, epoch: 9 | loss: 0.1817382
	speed: 0.0300s/iter; left time: 314.2980s
	iters: 500, epoch: 9 | loss: 0.1469816
	speed: 0.0300s/iter; left time: 311.0364s
	iters: 600, epoch: 9 | loss: 0.1369695
	speed: 0.0300s/iter; left time: 308.5459s
	iters: 700, epoch: 9 | loss: 0.1735614
	speed: 0.0300s/iter; left time: 304.7610s
	iters: 800, epoch: 9 | loss: 0.1863412
	speed: 0.0300s/iter; left time: 301.7859s
	iters: 900, epoch: 9 | loss: 0.1586168
	speed: 0.0300s/iter; left time: 299.1835s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:27.43s
Steps: 906 | Train Loss: 0.1704638 Vali Loss: 0.1869479 Test Loss: 0.2218861
Validation loss decreased (0.187508 --> 0.186948).  Saving model ...
Updating learning rate to 5.314410000000001e-06
	iters: 100, epoch: 10 | loss: 0.1457572
	speed: 0.0875s/iter; left time: 863.3844s
	iters: 200, epoch: 10 | loss: 0.1251245
	speed: 0.0300s/iter; left time: 293.0288s
	iters: 300, epoch: 10 | loss: 0.1279689
	speed: 0.0301s/iter; left time: 290.5573s
	iters: 400, epoch: 10 | loss: 0.2251878
	speed: 0.0300s/iter; left time: 286.8774s
	iters: 500, epoch: 10 | loss: 0.1428768
	speed: 0.0300s/iter; left time: 284.0455s
	iters: 600, epoch: 10 | loss: 0.1350298
	speed: 0.0300s/iter; left time: 280.9236s
	iters: 700, epoch: 10 | loss: 0.1976508
	speed: 0.0300s/iter; left time: 277.9905s
	iters: 800, epoch: 10 | loss: 0.1537141
	speed: 0.0300s/iter; left time: 275.4100s
	iters: 900, epoch: 10 | loss: 0.1983796
	speed: 0.0301s/iter; left time: 272.9098s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:27.51s
Steps: 906 | Train Loss: 0.1660709 Vali Loss: 0.1898970 Test Loss: 0.2283974
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.782969000000001e-06
	iters: 100, epoch: 11 | loss: 0.1414833
	speed: 0.0838s/iter; left time: 750.9173s
	iters: 200, epoch: 11 | loss: 0.1964810
	speed: 0.0301s/iter; left time: 266.5659s
	iters: 300, epoch: 11 | loss: 0.1748426
	speed: 0.0300s/iter; left time: 262.9623s
	iters: 400, epoch: 11 | loss: 0.1310564
	speed: 0.0300s/iter; left time: 259.4383s
	iters: 500, epoch: 11 | loss: 0.1376743
	speed: 0.0300s/iter; left time: 256.4575s
	iters: 600, epoch: 11 | loss: 0.1773211
	speed: 0.0300s/iter; left time: 253.4089s
	iters: 700, epoch: 11 | loss: 0.1335469
	speed: 0.0300s/iter; left time: 250.6750s
	iters: 800, epoch: 11 | loss: 0.1604896
	speed: 0.0300s/iter; left time: 247.4972s
	iters: 900, epoch: 11 | loss: 0.1420005
	speed: 0.0300s/iter; left time: 244.6819s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:27.45s
Steps: 906 | Train Loss: 0.1620493 Vali Loss: 0.1876232 Test Loss: 0.2207744
EarlyStopping counter: 2 out of 3
Updating learning rate to 4.304672100000001e-06
	iters: 100, epoch: 12 | loss: 0.1794909
	speed: 0.0828s/iter; left time: 666.7311s
	iters: 200, epoch: 12 | loss: 0.1482996
	speed: 0.0301s/iter; left time: 239.1626s
	iters: 300, epoch: 12 | loss: 0.1748915
	speed: 0.0301s/iter; left time: 236.1895s
	iters: 400, epoch: 12 | loss: 0.1930236
	speed: 0.0300s/iter; left time: 233.0031s
	iters: 500, epoch: 12 | loss: 0.1466676
	speed: 0.0301s/iter; left time: 230.2141s
	iters: 600, epoch: 12 | loss: 0.1437257
	speed: 0.0301s/iter; left time: 227.2452s
	iters: 700, epoch: 12 | loss: 0.2111108
	speed: 0.0301s/iter; left time: 224.1386s
	iters: 800, epoch: 12 | loss: 0.1766935
	speed: 0.0301s/iter; left time: 221.4640s
	iters: 900, epoch: 12 | loss: 0.1558518
	speed: 0.0301s/iter; left time: 218.0682s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:27.54s
Steps: 906 | Train Loss: 0.1592279 Vali Loss: 0.1830799 Test Loss: 0.2161524
Validation loss decreased (0.186948 --> 0.183080).  Saving model ...
Updating learning rate to 3.8742048900000015e-06
	iters: 100, epoch: 13 | loss: 0.1335872
	speed: 0.0866s/iter; left time: 618.8869s
	iters: 200, epoch: 13 | loss: 0.1904642
	speed: 0.0300s/iter; left time: 211.5857s
	iters: 300, epoch: 13 | loss: 0.1406990
	speed: 0.0300s/iter; left time: 208.4297s
	iters: 400, epoch: 13 | loss: 0.1491441
	speed: 0.0300s/iter; left time: 205.5397s
	iters: 500, epoch: 13 | loss: 0.1908478
	speed: 0.0300s/iter; left time: 202.5455s
	iters: 600, epoch: 13 | loss: 0.1886673
	speed: 0.0301s/iter; left time: 200.1375s
	iters: 700, epoch: 13 | loss: 0.1309064
	speed: 0.0300s/iter; left time: 196.4595s
	iters: 800, epoch: 13 | loss: 0.1589462
	speed: 0.0300s/iter; left time: 193.4215s
	iters: 900, epoch: 13 | loss: 0.1876475
	speed: 0.0300s/iter; left time: 190.3491s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:27.49s
Steps: 906 | Train Loss: 0.1563049 Vali Loss: 0.1856795 Test Loss: 0.2219029
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.486784401000001e-06
	iters: 100, epoch: 14 | loss: 0.1495333
	speed: 0.0830s/iter; left time: 518.1374s
	iters: 200, epoch: 14 | loss: 0.0944232
	speed: 0.0301s/iter; left time: 184.7374s
	iters: 300, epoch: 14 | loss: 0.1575354
	speed: 0.0301s/iter; left time: 181.6256s
	iters: 400, epoch: 14 | loss: 0.1296602
	speed: 0.0301s/iter; left time: 178.7741s
	iters: 500, epoch: 14 | loss: 0.1424343
	speed: 0.0301s/iter; left time: 175.6434s
	iters: 600, epoch: 14 | loss: 0.1530355
	speed: 0.0300s/iter; left time: 172.5209s
	iters: 700, epoch: 14 | loss: 0.1749859
	speed: 0.0300s/iter; left time: 169.5089s
	iters: 800, epoch: 14 | loss: 0.1459346
	speed: 0.0301s/iter; left time: 167.0267s
	iters: 900, epoch: 14 | loss: 0.2009379
	speed: 0.0301s/iter; left time: 163.6234s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:27.51s
Steps: 906 | Train Loss: 0.1537245 Vali Loss: 0.1861046 Test Loss: 0.2244890
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.138105960900001e-06
	iters: 100, epoch: 15 | loss: 0.1449612
	speed: 0.0829s/iter; left time: 442.2043s
	iters: 200, epoch: 15 | loss: 0.1392896
	speed: 0.0300s/iter; left time: 157.2547s
	iters: 300, epoch: 15 | loss: 0.1350373
	speed: 0.0300s/iter; left time: 154.1967s
	iters: 400, epoch: 15 | loss: 0.1786360
	speed: 0.0301s/iter; left time: 151.5792s
	iters: 500, epoch: 15 | loss: 0.1219083
	speed: 0.0301s/iter; left time: 148.6239s
	iters: 600, epoch: 15 | loss: 0.1108440
	speed: 0.0301s/iter; left time: 145.7405s
	iters: 700, epoch: 15 | loss: 0.1847629
	speed: 0.0300s/iter; left time: 142.2635s
	iters: 800, epoch: 15 | loss: 0.1144152
	speed: 0.0300s/iter; left time: 139.2765s
	iters: 900, epoch: 15 | loss: 0.1235651
	speed: 0.0301s/iter; left time: 136.4244s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.52s
Steps: 906 | Train Loss: 0.1517470 Vali Loss: 0.1870975 Test Loss: 0.2185816
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.21708616614341736, rmse:0.46592506766319275, mae:0.28623270988464355, rse:0.42671167850494385
Original data scale mse:1580196.75, rmse:1257.0587158203125, mae:835.594482421875, rse:0.08833649009466171

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.22030074894428253, RMSE: 0.4693620800971985, MAE: 0.2934994399547577, RSE: 0.4298593997955322
Unscaled Metrics - MSE: 1680994.875, RMSE: 1296.5318603515625, MAE: 861.99560546875, RSE: 0.09111034870147705

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.21708616614341736, RMSE: 0.46592506766319275, MAE: 0.28623270988464355, RSE: 0.42671167850494385
Unscaled Metrics - MSE: 1580196.75, RMSE: 1257.0587158203125, MAE: 835.594482421875, RSE: 0.08833649009466171

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.0433810
	speed: 0.0569s/iter; left time: 1024.0082s
	iters: 200, epoch: 1 | loss: 0.9495971
	speed: 0.0377s/iter; left time: 673.9913s
	iters: 300, epoch: 1 | loss: 0.7839106
	speed: 0.0377s/iter; left time: 669.4830s
	iters: 400, epoch: 1 | loss: 0.7479047
	speed: 0.0377s/iter; left time: 667.3794s
	iters: 500, epoch: 1 | loss: 0.6955235
	speed: 0.0377s/iter; left time: 663.0406s
	iters: 600, epoch: 1 | loss: 0.6325172
	speed: 0.0378s/iter; left time: 659.9135s
	iters: 700, epoch: 1 | loss: 0.5802335
	speed: 0.0377s/iter; left time: 655.1418s
	iters: 800, epoch: 1 | loss: 0.5810441
	speed: 0.0377s/iter; left time: 651.7636s
	iters: 900, epoch: 1 | loss: 0.5980899
	speed: 0.0377s/iter; left time: 648.2250s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.79s
Steps: 904 | Train Loss: 0.7531377 Vali Loss: 0.5355341 Test Loss: 0.6029890
Validation loss decreased (inf --> 0.535534).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4816381
	speed: 0.1161s/iter; left time: 1982.9286s
	iters: 200, epoch: 2 | loss: 0.4974765
	speed: 0.0376s/iter; left time: 638.9604s
	iters: 300, epoch: 2 | loss: 0.3962263
	speed: 0.0376s/iter; left time: 635.1478s
	iters: 400, epoch: 2 | loss: 0.3811402
	speed: 0.0376s/iter; left time: 631.0355s
	iters: 500, epoch: 2 | loss: 0.3722235
	speed: 0.0377s/iter; left time: 627.9117s
	iters: 600, epoch: 2 | loss: 0.3952564
	speed: 0.0376s/iter; left time: 624.1202s
	iters: 700, epoch: 2 | loss: 0.3544340
	speed: 0.0377s/iter; left time: 620.6429s
	iters: 800, epoch: 2 | loss: 0.3584991
	speed: 0.0376s/iter; left time: 615.7825s
	iters: 900, epoch: 2 | loss: 0.3201607
	speed: 0.0376s/iter; left time: 611.8754s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.29s
Steps: 904 | Train Loss: 0.4017989 Vali Loss: 0.3387201 Test Loss: 0.3724573
Validation loss decreased (0.535534 --> 0.338720).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3438635
	speed: 0.1079s/iter; left time: 1744.7986s
	iters: 200, epoch: 3 | loss: 0.3321435
	speed: 0.0377s/iter; left time: 605.2934s
	iters: 300, epoch: 3 | loss: 0.3372475
	speed: 0.0377s/iter; left time: 601.4924s
	iters: 400, epoch: 3 | loss: 0.3517059
	speed: 0.0376s/iter; left time: 597.1930s
	iters: 500, epoch: 3 | loss: 0.2855895
	speed: 0.0376s/iter; left time: 593.2270s
	iters: 600, epoch: 3 | loss: 0.2975675
	speed: 0.0376s/iter; left time: 590.0400s
	iters: 700, epoch: 3 | loss: 0.2875018
	speed: 0.0376s/iter; left time: 585.8464s
	iters: 800, epoch: 3 | loss: 0.3534431
	speed: 0.0376s/iter; left time: 581.7769s
	iters: 900, epoch: 3 | loss: 0.3374185
	speed: 0.0376s/iter; left time: 578.6753s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.33s
Steps: 904 | Train Loss: 0.3183414 Vali Loss: 0.3282952 Test Loss: 0.3708166
Validation loss decreased (0.338720 --> 0.328295).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2574762
	speed: 0.1077s/iter; left time: 1645.0413s
	iters: 200, epoch: 4 | loss: 0.2858969
	speed: 0.0377s/iter; left time: 571.8356s
	iters: 300, epoch: 4 | loss: 0.2627040
	speed: 0.0377s/iter; left time: 567.9005s
	iters: 400, epoch: 4 | loss: 0.3160098
	speed: 0.0377s/iter; left time: 564.6174s
	iters: 500, epoch: 4 | loss: 0.3133468
	speed: 0.0377s/iter; left time: 559.8755s
	iters: 600, epoch: 4 | loss: 0.3077377
	speed: 0.0377s/iter; left time: 556.5746s
	iters: 700, epoch: 4 | loss: 0.2466153
	speed: 0.0377s/iter; left time: 552.7487s
	iters: 800, epoch: 4 | loss: 0.2869949
	speed: 0.0377s/iter; left time: 549.2527s
	iters: 900, epoch: 4 | loss: 0.2474540
	speed: 0.0377s/iter; left time: 545.1041s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.38s
Steps: 904 | Train Loss: 0.2874134 Vali Loss: 0.3369873 Test Loss: 0.4013102
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2177296
	speed: 0.1037s/iter; left time: 1489.9128s
	iters: 200, epoch: 5 | loss: 0.2392200
	speed: 0.0377s/iter; left time: 538.2414s
	iters: 300, epoch: 5 | loss: 0.2466172
	speed: 0.0377s/iter; left time: 534.4068s
	iters: 400, epoch: 5 | loss: 0.3085367
	speed: 0.0377s/iter; left time: 530.0428s
	iters: 500, epoch: 5 | loss: 0.2516232
	speed: 0.0377s/iter; left time: 526.8087s
	iters: 600, epoch: 5 | loss: 0.2561632
	speed: 0.0377s/iter; left time: 522.5252s
	iters: 700, epoch: 5 | loss: 0.2971331
	speed: 0.0377s/iter; left time: 518.8838s
	iters: 800, epoch: 5 | loss: 0.2664599
	speed: 0.0377s/iter; left time: 514.8066s
	iters: 900, epoch: 5 | loss: 0.2453663
	speed: 0.0377s/iter; left time: 510.9887s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.40s
Steps: 904 | Train Loss: 0.2574948 Vali Loss: 0.3611175 Test Loss: 0.3933213
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1780142
	speed: 0.1035s/iter; left time: 1392.9055s
	iters: 200, epoch: 6 | loss: 0.2488946
	speed: 0.0377s/iter; left time: 503.9347s
	iters: 300, epoch: 6 | loss: 0.2395774
	speed: 0.0376s/iter; left time: 499.1077s
	iters: 400, epoch: 6 | loss: 0.2469465
	speed: 0.0376s/iter; left time: 495.4591s
	iters: 500, epoch: 6 | loss: 0.2110956
	speed: 0.0377s/iter; left time: 492.0184s
	iters: 600, epoch: 6 | loss: 0.2194913
	speed: 0.0377s/iter; left time: 488.0563s
	iters: 700, epoch: 6 | loss: 0.1760184
	speed: 0.0376s/iter; left time: 483.9136s
	iters: 800, epoch: 6 | loss: 0.2334978
	speed: 0.0376s/iter; left time: 480.3680s
	iters: 900, epoch: 6 | loss: 0.2233697
	speed: 0.0376s/iter; left time: 476.3402s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:34.30s
Steps: 904 | Train Loss: 0.2282654 Vali Loss: 0.3764598 Test Loss: 0.4058681
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.37084266543388367, rmse:0.6089684963226318, mae:0.40437051653862, rse:0.557574450969696
Original data scale mse:3333727.75, rmse:1825.849853515625, mae:1242.7080078125, rse:0.12849251925945282
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.9310343
	speed: 0.0403s/iter; left time: 724.1424s
	iters: 200, epoch: 1 | loss: 0.9147289
	speed: 0.0379s/iter; left time: 677.7552s
	iters: 300, epoch: 1 | loss: 0.8570474
	speed: 0.0377s/iter; left time: 670.4289s
	iters: 400, epoch: 1 | loss: 0.7464865
	speed: 0.0377s/iter; left time: 667.3594s
	iters: 500, epoch: 1 | loss: 0.7416446
	speed: 0.0377s/iter; left time: 663.1987s
	iters: 600, epoch: 1 | loss: 0.5792195
	speed: 0.0379s/iter; left time: 661.7161s
	iters: 700, epoch: 1 | loss: 0.6355222
	speed: 0.0377s/iter; left time: 655.7716s
	iters: 800, epoch: 1 | loss: 0.5904879
	speed: 0.0377s/iter; left time: 651.3748s
	iters: 900, epoch: 1 | loss: 0.5825278
	speed: 0.0377s/iter; left time: 647.5685s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.44s
Steps: 904 | Train Loss: 0.7520023 Vali Loss: 0.5394430 Test Loss: 0.6188242
Validation loss decreased (inf --> 0.539443).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5777426
	speed: 0.1100s/iter; left time: 1877.6433s
	iters: 200, epoch: 2 | loss: 0.5601380
	speed: 0.0377s/iter; left time: 639.4571s
	iters: 300, epoch: 2 | loss: 0.3959455
	speed: 0.0377s/iter; left time: 635.4391s
	iters: 400, epoch: 2 | loss: 0.3575569
	speed: 0.0377s/iter; left time: 631.7300s
	iters: 500, epoch: 2 | loss: 0.3508132
	speed: 0.0377s/iter; left time: 628.5374s
	iters: 600, epoch: 2 | loss: 0.4210768
	speed: 0.0376s/iter; left time: 623.6913s
	iters: 700, epoch: 2 | loss: 0.3401209
	speed: 0.0376s/iter; left time: 620.0123s
	iters: 800, epoch: 2 | loss: 0.3282757
	speed: 0.0376s/iter; left time: 615.9705s
	iters: 900, epoch: 2 | loss: 0.2986883
	speed: 0.0376s/iter; left time: 612.5596s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.34s
Steps: 904 | Train Loss: 0.4000782 Vali Loss: 0.3314674 Test Loss: 0.3737507
Validation loss decreased (0.539443 --> 0.331467).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3327233
	speed: 0.1071s/iter; left time: 1731.6260s
	iters: 200, epoch: 3 | loss: 0.3367423
	speed: 0.0377s/iter; left time: 606.6234s
	iters: 300, epoch: 3 | loss: 0.3462038
	speed: 0.0377s/iter; left time: 601.9935s
	iters: 400, epoch: 3 | loss: 0.3281111
	speed: 0.0378s/iter; left time: 599.3999s
	iters: 500, epoch: 3 | loss: 0.3106598
	speed: 0.0376s/iter; left time: 593.5081s
	iters: 600, epoch: 3 | loss: 0.3515031
	speed: 0.0377s/iter; left time: 590.9953s
	iters: 700, epoch: 3 | loss: 0.3463474
	speed: 0.0377s/iter; left time: 587.7160s
	iters: 800, epoch: 3 | loss: 0.2964612
	speed: 0.0377s/iter; left time: 583.3999s
	iters: 900, epoch: 3 | loss: 0.2469234
	speed: 0.0376s/iter; left time: 578.1815s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.38s
Steps: 904 | Train Loss: 0.3193620 Vali Loss: 0.3252755 Test Loss: 0.3624292
Validation loss decreased (0.331467 --> 0.325275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2780003
	speed: 0.1063s/iter; left time: 1622.9697s
	iters: 200, epoch: 4 | loss: 0.2793081
	speed: 0.0376s/iter; left time: 570.0459s
	iters: 300, epoch: 4 | loss: 0.2678560
	speed: 0.0376s/iter; left time: 565.9655s
	iters: 400, epoch: 4 | loss: 0.2835883
	speed: 0.0376s/iter; left time: 562.3242s
	iters: 500, epoch: 4 | loss: 0.2706463
	speed: 0.0376s/iter; left time: 559.4220s
	iters: 600, epoch: 4 | loss: 0.2996997
	speed: 0.0376s/iter; left time: 554.8207s
	iters: 700, epoch: 4 | loss: 0.2831515
	speed: 0.0376s/iter; left time: 551.4538s
	iters: 800, epoch: 4 | loss: 0.2655961
	speed: 0.0376s/iter; left time: 547.5039s
	iters: 900, epoch: 4 | loss: 0.2640123
	speed: 0.0376s/iter; left time: 543.5847s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.26s
Steps: 904 | Train Loss: 0.2878566 Vali Loss: 0.3581431 Test Loss: 0.3730399
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2474798
	speed: 0.1043s/iter; left time: 1498.7728s
	iters: 200, epoch: 5 | loss: 0.2787637
	speed: 0.0377s/iter; left time: 537.1097s
	iters: 300, epoch: 5 | loss: 0.2955056
	speed: 0.0376s/iter; left time: 533.1558s
	iters: 400, epoch: 5 | loss: 0.2447727
	speed: 0.0376s/iter; left time: 529.3492s
	iters: 500, epoch: 5 | loss: 0.2601503
	speed: 0.0375s/iter; left time: 524.0882s
	iters: 600, epoch: 5 | loss: 0.2364178
	speed: 0.0374s/iter; left time: 518.5631s
	iters: 700, epoch: 5 | loss: 0.2461311
	speed: 0.0374s/iter; left time: 514.7506s
	iters: 800, epoch: 5 | loss: 0.2391737
	speed: 0.0374s/iter; left time: 511.5207s
	iters: 900, epoch: 5 | loss: 0.2079362
	speed: 0.0374s/iter; left time: 507.4393s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.22s
Steps: 904 | Train Loss: 0.2588882 Vali Loss: 0.3430499 Test Loss: 0.3840977
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2355718
	speed: 0.1020s/iter; left time: 1372.6722s
	iters: 200, epoch: 6 | loss: 0.2274001
	speed: 0.0374s/iter; left time: 499.7743s
	iters: 300, epoch: 6 | loss: 0.2482404
	speed: 0.0374s/iter; left time: 495.9254s
	iters: 400, epoch: 6 | loss: 0.2259423
	speed: 0.0374s/iter; left time: 492.0059s
	iters: 500, epoch: 6 | loss: 0.2531618
	speed: 0.0374s/iter; left time: 488.3754s
	iters: 600, epoch: 6 | loss: 0.2216336
	speed: 0.0374s/iter; left time: 484.6852s
	iters: 700, epoch: 6 | loss: 0.2537532
	speed: 0.0374s/iter; left time: 480.6494s
	iters: 800, epoch: 6 | loss: 0.2284748
	speed: 0.0374s/iter; left time: 477.4921s
	iters: 900, epoch: 6 | loss: 0.1975201
	speed: 0.0374s/iter; left time: 473.6613s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:34.04s
Steps: 904 | Train Loss: 0.2283777 Vali Loss: 0.3500589 Test Loss: 0.3929238
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3623674511909485, rmse:0.6019696593284607, mae:0.40077000856399536, rse:0.5511662364006042
Original data scale mse:3329982.0, rmse:1824.8238525390625, mae:1235.0142822265625, rse:0.12842030823230743

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.37084266543388367, RMSE: 0.6089684963226318, MAE: 0.40437051653862, RSE: 0.557574450969696
Unscaled Metrics - MSE: 3333727.75, RMSE: 1825.849853515625, MAE: 1242.7080078125, RSE: 0.12849251925945282

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.3623674511909485, RMSE: 0.6019696593284607, MAE: 0.40077000856399536, RSE: 0.5511662364006042
Unscaled Metrics - MSE: 3329982.0, RMSE: 1824.8238525390625, MAE: 1235.0142822265625, RSE: 0.12842030823230743

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.0365422
	speed: 0.0653s/iter; left time: 1170.6770s
	iters: 200, epoch: 1 | loss: 0.8846171
	speed: 0.0461s/iter; left time: 821.8567s
	iters: 300, epoch: 1 | loss: 0.9547038
	speed: 0.0460s/iter; left time: 816.6930s
	iters: 400, epoch: 1 | loss: 0.8920675
	speed: 0.0460s/iter; left time: 811.7746s
	iters: 500, epoch: 1 | loss: 0.8275010
	speed: 0.0460s/iter; left time: 806.9469s
	iters: 600, epoch: 1 | loss: 0.8351727
	speed: 0.0460s/iter; left time: 802.6539s
	iters: 700, epoch: 1 | loss: 0.7744251
	speed: 0.0460s/iter; left time: 798.0742s
	iters: 800, epoch: 1 | loss: 0.8452673
	speed: 0.0460s/iter; left time: 793.2100s
	iters: 900, epoch: 1 | loss: 0.7219580
	speed: 0.0460s/iter; left time: 788.9305s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.18s
Steps: 902 | Train Loss: 0.8602328 Vali Loss: 0.7254865 Test Loss: 0.8113574
Validation loss decreased (inf --> 0.725486).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7216184
	speed: 0.1308s/iter; left time: 2228.7236s
	iters: 200, epoch: 2 | loss: 0.5977059
	speed: 0.0460s/iter; left time: 778.8051s
	iters: 300, epoch: 2 | loss: 0.4923407
	speed: 0.0460s/iter; left time: 774.0135s
	iters: 400, epoch: 2 | loss: 0.4656889
	speed: 0.0460s/iter; left time: 769.8012s
	iters: 500, epoch: 2 | loss: 0.3986078
	speed: 0.0460s/iter; left time: 764.7337s
	iters: 600, epoch: 2 | loss: 0.4369687
	speed: 0.0459s/iter; left time: 759.8672s
	iters: 700, epoch: 2 | loss: 0.3256683
	speed: 0.0460s/iter; left time: 755.8531s
	iters: 800, epoch: 2 | loss: 0.3587376
	speed: 0.0460s/iter; left time: 752.1556s
	iters: 900, epoch: 2 | loss: 0.3530706
	speed: 0.0460s/iter; left time: 747.2583s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.80s
Steps: 902 | Train Loss: 0.4776453 Vali Loss: 0.3714094 Test Loss: 0.4325749
Validation loss decreased (0.725486 --> 0.371409).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3177940
	speed: 0.1278s/iter; left time: 2062.3018s
	iters: 200, epoch: 3 | loss: 0.3877927
	speed: 0.0460s/iter; left time: 737.2365s
	iters: 300, epoch: 3 | loss: 0.3711354
	speed: 0.0460s/iter; left time: 732.5720s
	iters: 400, epoch: 3 | loss: 0.3970094
	speed: 0.0460s/iter; left time: 727.9206s
	iters: 500, epoch: 3 | loss: 0.3705113
	speed: 0.0460s/iter; left time: 723.5329s
	iters: 600, epoch: 3 | loss: 0.3258202
	speed: 0.0460s/iter; left time: 719.0005s
	iters: 700, epoch: 3 | loss: 0.3217875
	speed: 0.0460s/iter; left time: 714.8503s
	iters: 800, epoch: 3 | loss: 0.3373196
	speed: 0.0460s/iter; left time: 709.8886s
	iters: 900, epoch: 3 | loss: 0.3432759
	speed: 0.0460s/iter; left time: 705.5292s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.80s
Steps: 902 | Train Loss: 0.3510486 Vali Loss: 0.3671135 Test Loss: 0.4210625
Validation loss decreased (0.371409 --> 0.367113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3528281
	speed: 0.1391s/iter; left time: 2118.8700s
	iters: 200, epoch: 4 | loss: 0.3186574
	speed: 0.0460s/iter; left time: 695.6235s
	iters: 300, epoch: 4 | loss: 0.3744135
	speed: 0.0460s/iter; left time: 691.7972s
	iters: 400, epoch: 4 | loss: 0.3007407
	speed: 0.0460s/iter; left time: 686.6211s
	iters: 500, epoch: 4 | loss: 0.2949081
	speed: 0.0460s/iter; left time: 681.8642s
	iters: 600, epoch: 4 | loss: 0.2888547
	speed: 0.0460s/iter; left time: 677.5281s
	iters: 700, epoch: 4 | loss: 0.3272570
	speed: 0.0460s/iter; left time: 673.0745s
	iters: 800, epoch: 4 | loss: 0.3382494
	speed: 0.0460s/iter; left time: 668.6579s
	iters: 900, epoch: 4 | loss: 0.2757096
	speed: 0.0460s/iter; left time: 664.3530s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.80s
Steps: 902 | Train Loss: 0.3145241 Vali Loss: 0.3660716 Test Loss: 0.4241156
Validation loss decreased (0.367113 --> 0.366072).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2358644
	speed: 0.1314s/iter; left time: 1882.8356s
	iters: 200, epoch: 5 | loss: 0.2573364
	speed: 0.0460s/iter; left time: 654.6122s
	iters: 300, epoch: 5 | loss: 0.3155867
	speed: 0.0459s/iter; left time: 649.3689s
	iters: 400, epoch: 5 | loss: 0.2975460
	speed: 0.0460s/iter; left time: 645.6292s
	iters: 500, epoch: 5 | loss: 0.3126471
	speed: 0.0460s/iter; left time: 640.3623s
	iters: 600, epoch: 5 | loss: 0.2959611
	speed: 0.0459s/iter; left time: 635.4049s
	iters: 700, epoch: 5 | loss: 0.2912783
	speed: 0.0459s/iter; left time: 630.8552s
	iters: 800, epoch: 5 | loss: 0.2545171
	speed: 0.0460s/iter; left time: 626.6237s
	iters: 900, epoch: 5 | loss: 0.2511979
	speed: 0.0459s/iter; left time: 621.4281s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.76s
Steps: 902 | Train Loss: 0.2790021 Vali Loss: 0.3885911 Test Loss: 0.4254634
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2349278
	speed: 0.1242s/iter; left time: 1667.5303s
	iters: 200, epoch: 6 | loss: 0.2527872
	speed: 0.0460s/iter; left time: 612.6010s
	iters: 300, epoch: 6 | loss: 0.2303856
	speed: 0.0460s/iter; left time: 608.2484s
	iters: 400, epoch: 6 | loss: 0.2505732
	speed: 0.0459s/iter; left time: 603.3416s
	iters: 500, epoch: 6 | loss: 0.2211367
	speed: 0.0459s/iter; left time: 598.7680s
	iters: 600, epoch: 6 | loss: 0.2237590
	speed: 0.0459s/iter; left time: 594.0626s
	iters: 700, epoch: 6 | loss: 0.2217987
	speed: 0.0460s/iter; left time: 590.0449s
	iters: 800, epoch: 6 | loss: 0.2063637
	speed: 0.0460s/iter; left time: 585.9575s
	iters: 900, epoch: 6 | loss: 0.2388363
	speed: 0.0460s/iter; left time: 581.2877s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.71s
Steps: 902 | Train Loss: 0.2412845 Vali Loss: 0.4343924 Test Loss: 0.4782678
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2122227
	speed: 0.1245s/iter; left time: 1560.2874s
	iters: 200, epoch: 7 | loss: 0.2170379
	speed: 0.0460s/iter; left time: 572.2216s
	iters: 300, epoch: 7 | loss: 0.1788052
	speed: 0.0460s/iter; left time: 567.1034s
	iters: 400, epoch: 7 | loss: 0.2009487
	speed: 0.0460s/iter; left time: 562.6962s
	iters: 500, epoch: 7 | loss: 0.2186683
	speed: 0.0460s/iter; left time: 557.5170s
	iters: 600, epoch: 7 | loss: 0.1997348
	speed: 0.0460s/iter; left time: 552.9203s
	iters: 700, epoch: 7 | loss: 0.2164418
	speed: 0.0460s/iter; left time: 548.5680s
	iters: 800, epoch: 7 | loss: 0.1825523
	speed: 0.0460s/iter; left time: 543.8909s
	iters: 900, epoch: 7 | loss: 0.1736540
	speed: 0.0460s/iter; left time: 539.3218s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:41.71s
Steps: 902 | Train Loss: 0.2064077 Vali Loss: 0.4329301 Test Loss: 0.4813861
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.42409995198249817, rmse:0.6512295603752136, mae:0.4370887279510498, rse:0.5964465141296387
Original data scale mse:4642685.0, rmse:2154.68896484375, mae:1412.206298828125, rse:0.15177665650844574
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.9483397
	speed: 0.0486s/iter; left time: 871.2939s
	iters: 200, epoch: 1 | loss: 0.9486579
	speed: 0.0459s/iter; left time: 819.4881s
	iters: 300, epoch: 1 | loss: 0.8301455
	speed: 0.0459s/iter; left time: 815.1927s
	iters: 400, epoch: 1 | loss: 0.8503751
	speed: 0.0460s/iter; left time: 811.5638s
	iters: 500, epoch: 1 | loss: 0.8364280
	speed: 0.0460s/iter; left time: 806.5143s
	iters: 600, epoch: 1 | loss: 0.7260083
	speed: 0.0460s/iter; left time: 802.2086s
	iters: 700, epoch: 1 | loss: 0.7473571
	speed: 0.0460s/iter; left time: 797.1512s
	iters: 800, epoch: 1 | loss: 0.7346708
	speed: 0.0459s/iter; left time: 791.9212s
	iters: 900, epoch: 1 | loss: 0.7429011
	speed: 0.0459s/iter; left time: 787.3694s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.78s
Steps: 902 | Train Loss: 0.8504171 Vali Loss: 0.7121906 Test Loss: 0.8145077
Validation loss decreased (inf --> 0.712191).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6728511
	speed: 0.1291s/iter; left time: 2200.3610s
	iters: 200, epoch: 2 | loss: 0.5547946
	speed: 0.0460s/iter; left time: 778.4769s
	iters: 300, epoch: 2 | loss: 0.4963667
	speed: 0.0460s/iter; left time: 774.3294s
	iters: 400, epoch: 2 | loss: 0.4185760
	speed: 0.0460s/iter; left time: 769.7803s
	iters: 500, epoch: 2 | loss: 0.4750888
	speed: 0.0460s/iter; left time: 765.2050s
	iters: 600, epoch: 2 | loss: 0.3476305
	speed: 0.0460s/iter; left time: 760.8368s
	iters: 700, epoch: 2 | loss: 0.3973275
	speed: 0.0460s/iter; left time: 756.4821s
	iters: 800, epoch: 2 | loss: 0.3312517
	speed: 0.0460s/iter; left time: 751.6923s
	iters: 900, epoch: 2 | loss: 0.3894624
	speed: 0.0460s/iter; left time: 746.8053s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.80s
Steps: 902 | Train Loss: 0.4763714 Vali Loss: 0.3743415 Test Loss: 0.4174978
Validation loss decreased (0.712191 --> 0.374341).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4348660
	speed: 0.1308s/iter; left time: 2110.4257s
	iters: 200, epoch: 3 | loss: 0.3467556
	speed: 0.0459s/iter; left time: 736.0747s
	iters: 300, epoch: 3 | loss: 0.3449248
	speed: 0.0459s/iter; left time: 731.6484s
	iters: 400, epoch: 3 | loss: 0.3525844
	speed: 0.0459s/iter; left time: 727.3909s
	iters: 500, epoch: 3 | loss: 0.3267336
	speed: 0.0459s/iter; left time: 722.7367s
	iters: 600, epoch: 3 | loss: 0.3575354
	speed: 0.0459s/iter; left time: 718.0812s
	iters: 700, epoch: 3 | loss: 0.3118579
	speed: 0.0459s/iter; left time: 713.4389s
	iters: 800, epoch: 3 | loss: 0.3681702
	speed: 0.0460s/iter; left time: 709.7085s
	iters: 900, epoch: 3 | loss: 0.3573784
	speed: 0.0460s/iter; left time: 704.9484s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.74s
Steps: 902 | Train Loss: 0.3528322 Vali Loss: 0.3532912 Test Loss: 0.3813401
Validation loss decreased (0.374341 --> 0.353291).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3417735
	speed: 0.1317s/iter; left time: 2006.1464s
	iters: 200, epoch: 4 | loss: 0.3159100
	speed: 0.0460s/iter; left time: 696.0940s
	iters: 300, epoch: 4 | loss: 0.3165792
	speed: 0.0459s/iter; left time: 690.8286s
	iters: 400, epoch: 4 | loss: 0.3459593
	speed: 0.0460s/iter; left time: 686.7806s
	iters: 500, epoch: 4 | loss: 0.3109958
	speed: 0.0460s/iter; left time: 682.1137s
	iters: 600, epoch: 4 | loss: 0.2787214
	speed: 0.0460s/iter; left time: 677.2847s
	iters: 700, epoch: 4 | loss: 0.2935751
	speed: 0.0460s/iter; left time: 673.2650s
	iters: 800, epoch: 4 | loss: 0.3336336
	speed: 0.0460s/iter; left time: 668.3545s
	iters: 900, epoch: 4 | loss: 0.2844190
	speed: 0.0460s/iter; left time: 663.5614s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.80s
Steps: 902 | Train Loss: 0.3145994 Vali Loss: 0.3677874 Test Loss: 0.4210186
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2839892
	speed: 0.1254s/iter; left time: 1797.6038s
	iters: 200, epoch: 5 | loss: 0.2727775
	speed: 0.0460s/iter; left time: 654.5081s
	iters: 300, epoch: 5 | loss: 0.2952268
	speed: 0.0460s/iter; left time: 649.9031s
	iters: 400, epoch: 5 | loss: 0.3162156
	speed: 0.0460s/iter; left time: 645.5828s
	iters: 500, epoch: 5 | loss: 0.2694507
	speed: 0.0460s/iter; left time: 640.7541s
	iters: 600, epoch: 5 | loss: 0.2709764
	speed: 0.0460s/iter; left time: 636.1252s
	iters: 700, epoch: 5 | loss: 0.2563318
	speed: 0.0460s/iter; left time: 631.3768s
	iters: 800, epoch: 5 | loss: 0.2637875
	speed: 0.0459s/iter; left time: 625.6919s
	iters: 900, epoch: 5 | loss: 0.2628876
	speed: 0.0459s/iter; left time: 621.3065s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.74s
Steps: 902 | Train Loss: 0.2780898 Vali Loss: 0.3827886 Test Loss: 0.4289864
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2936564
	speed: 0.1256s/iter; left time: 1686.5657s
	iters: 200, epoch: 6 | loss: 0.2175375
	speed: 0.0460s/iter; left time: 612.7038s
	iters: 300, epoch: 6 | loss: 0.2566068
	speed: 0.0459s/iter; left time: 607.3514s
	iters: 400, epoch: 6 | loss: 0.2495589
	speed: 0.0460s/iter; left time: 603.6189s
	iters: 500, epoch: 6 | loss: 0.2659388
	speed: 0.0459s/iter; left time: 598.4815s
	iters: 600, epoch: 6 | loss: 0.2379672
	speed: 0.0459s/iter; left time: 593.6949s
	iters: 700, epoch: 6 | loss: 0.2380564
	speed: 0.0459s/iter; left time: 588.9495s
	iters: 800, epoch: 6 | loss: 0.2162333
	speed: 0.0459s/iter; left time: 584.5651s
	iters: 900, epoch: 6 | loss: 0.1989905
	speed: 0.0459s/iter; left time: 580.2203s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.69s
Steps: 902 | Train Loss: 0.2424242 Vali Loss: 0.4012789 Test Loss: 0.4505979
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.3812984824180603, rmse:0.6174936890602112, mae:0.42579272389411926, rse:0.5655485987663269
Original data scale mse:3976689.75, rmse:1994.1639404296875, mae:1357.449951171875, rse:0.1404692530632019

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.42409995198249817, RMSE: 0.6512295603752136, MAE: 0.4370887279510498, RSE: 0.5964465141296387
Unscaled Metrics - MSE: 4642685.0, RMSE: 2154.68896484375, MAE: 1412.206298828125, RSE: 0.15177665650844574

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.3812984824180603, RMSE: 0.6174936890602112, MAE: 0.42579272389411926, RSE: 0.5655485987663269
Unscaled Metrics - MSE: 3976689.75, RMSE: 1994.1639404296875, MAE: 1357.449951171875, RSE: 0.1404692530632019

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_24_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=3, learning_rate=1e-05, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.8982518
	speed: 0.0481s/iter; left time: 867.4449s
	iters: 200, epoch: 1 | loss: 0.8458576
	speed: 0.0297s/iter; left time: 532.9588s
	iters: 300, epoch: 1 | loss: 0.8074365
	speed: 0.0298s/iter; left time: 530.2900s
	iters: 400, epoch: 1 | loss: 0.8315028
	speed: 0.0297s/iter; left time: 526.4179s
	iters: 500, epoch: 1 | loss: 0.7915738
	speed: 0.0297s/iter; left time: 523.2911s
	iters: 600, epoch: 1 | loss: 0.7709562
	speed: 0.0297s/iter; left time: 520.5343s
	iters: 700, epoch: 1 | loss: 0.7027000
	speed: 0.0297s/iter; left time: 517.4899s
	iters: 800, epoch: 1 | loss: 0.7458278
	speed: 0.0297s/iter; left time: 514.2975s
	iters: 900, epoch: 1 | loss: 0.7395509
	speed: 0.0297s/iter; left time: 511.3382s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:27.57s
Steps: 906 | Train Loss: 0.8002553 Vali Loss: 0.7254151 Test Loss: 0.7859074
Validation loss decreased (inf --> 0.725415).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 2 | loss: 0.6148894
	speed: 0.0841s/iter; left time: 1438.8980s
	iters: 200, epoch: 2 | loss: 0.4927519
	speed: 0.0297s/iter; left time: 506.0349s
	iters: 300, epoch: 2 | loss: 0.4147166
	speed: 0.0297s/iter; left time: 502.4199s
	iters: 400, epoch: 2 | loss: 0.3876883
	speed: 0.0297s/iter; left time: 499.4253s
	iters: 500, epoch: 2 | loss: 0.4275194
	speed: 0.0297s/iter; left time: 496.5132s
	iters: 600, epoch: 2 | loss: 0.3958344
	speed: 0.0297s/iter; left time: 493.6855s
	iters: 700, epoch: 2 | loss: 0.3779832
	speed: 0.0297s/iter; left time: 490.2781s
	iters: 800, epoch: 2 | loss: 0.3738647
	speed: 0.0297s/iter; left time: 487.3906s
	iters: 900, epoch: 2 | loss: 0.3732349
	speed: 0.0297s/iter; left time: 484.4823s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:27.22s
Steps: 906 | Train Loss: 0.4314672 Vali Loss: 0.3343946 Test Loss: 0.3576734
Validation loss decreased (0.725415 --> 0.334395).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 3 | loss: 0.3488475
	speed: 0.0848s/iter; left time: 1373.9056s
	iters: 200, epoch: 3 | loss: 0.3256014
	speed: 0.0297s/iter; left time: 479.2160s
	iters: 300, epoch: 3 | loss: 0.3474699
	speed: 0.0298s/iter; left time: 476.2749s
	iters: 400, epoch: 3 | loss: 0.3086111
	speed: 0.0298s/iter; left time: 473.4016s
	iters: 500, epoch: 3 | loss: 0.3724214
	speed: 0.0297s/iter; left time: 470.1714s
	iters: 600, epoch: 3 | loss: 0.3401731
	speed: 0.0297s/iter; left time: 467.2649s
	iters: 700, epoch: 3 | loss: 0.2903460
	speed: 0.0297s/iter; left time: 464.2514s
	iters: 800, epoch: 3 | loss: 0.3162773
	speed: 0.0297s/iter; left time: 461.1949s
	iters: 900, epoch: 3 | loss: 0.2989454
	speed: 0.0298s/iter; left time: 458.8302s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.26s
Steps: 906 | Train Loss: 0.3265869 Vali Loss: 0.3017584 Test Loss: 0.3241872
Validation loss decreased (0.334395 --> 0.301758).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 4 | loss: 0.2934006
	speed: 0.0874s/iter; left time: 1336.7751s
	iters: 200, epoch: 4 | loss: 0.2847592
	speed: 0.0297s/iter; left time: 451.4091s
	iters: 300, epoch: 4 | loss: 0.2830035
	speed: 0.0297s/iter; left time: 448.6787s
	iters: 400, epoch: 4 | loss: 0.3007552
	speed: 0.0297s/iter; left time: 445.7759s
	iters: 500, epoch: 4 | loss: 0.2848407
	speed: 0.0298s/iter; left time: 443.6352s
	iters: 600, epoch: 4 | loss: 0.3638254
	speed: 0.0297s/iter; left time: 439.9402s
	iters: 700, epoch: 4 | loss: 0.3218064
	speed: 0.0297s/iter; left time: 436.7098s
	iters: 800, epoch: 4 | loss: 0.3125134
	speed: 0.0297s/iter; left time: 434.1397s
	iters: 900, epoch: 4 | loss: 0.3308379
	speed: 0.0297s/iter; left time: 431.0257s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:27.23s
Steps: 906 | Train Loss: 0.3002852 Vali Loss: 0.2842374 Test Loss: 0.3071113
Validation loss decreased (0.301758 --> 0.284237).  Saving model ...
Updating learning rate to 9e-06
	iters: 100, epoch: 5 | loss: 0.2778125
	speed: 0.0836s/iter; left time: 1203.5683s
	iters: 200, epoch: 5 | loss: 0.2598670
	speed: 0.0297s/iter; left time: 424.9238s
	iters: 300, epoch: 5 | loss: 0.2578112
	speed: 0.0297s/iter; left time: 421.8773s
	iters: 400, epoch: 5 | loss: 0.2655600
	speed: 0.0297s/iter; left time: 418.2920s
	iters: 500, epoch: 5 | loss: 0.2985246
	speed: 0.0297s/iter; left time: 415.2158s
	iters: 600, epoch: 5 | loss: 0.2696084
	speed: 0.0297s/iter; left time: 412.0989s
	iters: 700, epoch: 5 | loss: 0.3071485
	speed: 0.0297s/iter; left time: 409.1783s
	iters: 800, epoch: 5 | loss: 0.2650835
	speed: 0.0297s/iter; left time: 406.2400s
	iters: 900, epoch: 5 | loss: 0.3005427
	speed: 0.0297s/iter; left time: 403.3584s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:27.16s
Steps: 906 | Train Loss: 0.2854086 Vali Loss: 0.2762106 Test Loss: 0.2984711
Validation loss decreased (0.284237 --> 0.276211).  Saving model ...
Updating learning rate to 8.1e-06
	iters: 100, epoch: 6 | loss: 0.2698609
	speed: 0.0835s/iter; left time: 1126.8387s
	iters: 200, epoch: 6 | loss: 0.2821735
	speed: 0.0297s/iter; left time: 397.6747s
	iters: 300, epoch: 6 | loss: 0.3199257
	speed: 0.0297s/iter; left time: 394.6988s
	iters: 400, epoch: 6 | loss: 0.3014683
	speed: 0.0298s/iter; left time: 393.2111s
	iters: 500, epoch: 6 | loss: 0.2745761
	speed: 0.0297s/iter; left time: 388.4676s
	iters: 600, epoch: 6 | loss: 0.3011068
	speed: 0.0297s/iter; left time: 385.7197s
	iters: 700, epoch: 6 | loss: 0.3174651
	speed: 0.0297s/iter; left time: 382.7527s
	iters: 800, epoch: 6 | loss: 0.2696464
	speed: 0.0297s/iter; left time: 379.3997s
	iters: 900, epoch: 6 | loss: 0.2929690
	speed: 0.0297s/iter; left time: 376.9704s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:27.16s
Steps: 906 | Train Loss: 0.2763475 Vali Loss: 0.2698329 Test Loss: 0.2898619
Validation loss decreased (0.276211 --> 0.269833).  Saving model ...
Updating learning rate to 7.290000000000001e-06
	iters: 100, epoch: 7 | loss: 0.2727868
	speed: 0.0896s/iter; left time: 1127.4983s
	iters: 200, epoch: 7 | loss: 0.2350268
	speed: 0.0297s/iter; left time: 371.0242s
	iters: 300, epoch: 7 | loss: 0.2592110
	speed: 0.0297s/iter; left time: 368.0230s
	iters: 400, epoch: 7 | loss: 0.2567597
	speed: 0.0297s/iter; left time: 365.0991s
	iters: 500, epoch: 7 | loss: 0.2733704
	speed: 0.0297s/iter; left time: 362.1358s
	iters: 600, epoch: 7 | loss: 0.2359796
	speed: 0.0298s/iter; left time: 359.5599s
	iters: 700, epoch: 7 | loss: 0.2640343
	speed: 0.0297s/iter; left time: 356.1277s
	iters: 800, epoch: 7 | loss: 0.3033043
	speed: 0.0297s/iter; left time: 353.3048s
	iters: 900, epoch: 7 | loss: 0.2588506
	speed: 0.0297s/iter; left time: 350.3886s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:27.20s
Steps: 906 | Train Loss: 0.2694365 Vali Loss: 0.2679622 Test Loss: 0.2863183
Validation loss decreased (0.269833 --> 0.267962).  Saving model ...
Updating learning rate to 6.561e-06
	iters: 100, epoch: 8 | loss: 0.2531316
	speed: 0.0855s/iter; left time: 999.0332s
	iters: 200, epoch: 8 | loss: 0.2331702
	speed: 0.0298s/iter; left time: 345.5013s
	iters: 300, epoch: 8 | loss: 0.2810597
	speed: 0.0297s/iter; left time: 340.7911s
	iters: 400, epoch: 8 | loss: 0.2593723
	speed: 0.0297s/iter; left time: 337.8376s
	iters: 500, epoch: 8 | loss: 0.2738975
	speed: 0.0298s/iter; left time: 336.2042s
	iters: 600, epoch: 8 | loss: 0.2735357
	speed: 0.0297s/iter; left time: 331.8914s
	iters: 700, epoch: 8 | loss: 0.2414902
	speed: 0.0297s/iter; left time: 329.2963s
	iters: 800, epoch: 8 | loss: 0.2622409
	speed: 0.0298s/iter; left time: 326.6831s
	iters: 900, epoch: 8 | loss: 0.2747293
	speed: 0.0298s/iter; left time: 323.8279s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:27.22s
Steps: 906 | Train Loss: 0.2640604 Vali Loss: 0.2653358 Test Loss: 0.2851748
Validation loss decreased (0.267962 --> 0.265336).  Saving model ...
Updating learning rate to 5.904900000000001e-06
	iters: 100, epoch: 9 | loss: 0.2595016
	speed: 0.0845s/iter; left time: 909.8972s
	iters: 200, epoch: 9 | loss: 0.2779095
	speed: 0.0297s/iter; left time: 317.4450s
	iters: 300, epoch: 9 | loss: 0.2664872
	speed: 0.0297s/iter; left time: 314.3498s
	iters: 400, epoch: 9 | loss: 0.2874963
	speed: 0.0297s/iter; left time: 311.4365s
	iters: 500, epoch: 9 | loss: 0.2765655
	speed: 0.0298s/iter; left time: 308.6198s
	iters: 600, epoch: 9 | loss: 0.2846298
	speed: 0.0297s/iter; left time: 305.2169s
	iters: 700, epoch: 9 | loss: 0.2560660
	speed: 0.0297s/iter; left time: 302.3223s
	iters: 800, epoch: 9 | loss: 0.2671131
	speed: 0.0297s/iter; left time: 299.2118s
	iters: 900, epoch: 9 | loss: 0.2638635
	speed: 0.0297s/iter; left time: 296.4255s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:27.18s
Steps: 906 | Train Loss: 0.2599821 Vali Loss: 0.2610800 Test Loss: 0.2821350
Validation loss decreased (0.265336 --> 0.261080).  Saving model ...
Updating learning rate to 5.314410000000001e-06
	iters: 100, epoch: 10 | loss: 0.2800991
	speed: 0.0890s/iter; left time: 878.3295s
	iters: 200, epoch: 10 | loss: 0.2533764
	speed: 0.0297s/iter; left time: 290.1227s
	iters: 300, epoch: 10 | loss: 0.2552003
	speed: 0.0297s/iter; left time: 286.9439s
	iters: 400, epoch: 10 | loss: 0.2396801
	speed: 0.0297s/iter; left time: 283.9378s
	iters: 500, epoch: 10 | loss: 0.2476129
	speed: 0.0297s/iter; left time: 280.9742s
	iters: 600, epoch: 10 | loss: 0.2463096
	speed: 0.0297s/iter; left time: 278.2766s
	iters: 700, epoch: 10 | loss: 0.2813039
	speed: 0.0297s/iter; left time: 275.0762s
	iters: 800, epoch: 10 | loss: 0.2465423
	speed: 0.0297s/iter; left time: 272.0061s
	iters: 900, epoch: 10 | loss: 0.2718271
	speed: 0.0297s/iter; left time: 269.1579s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:27.17s
Steps: 906 | Train Loss: 0.2567788 Vali Loss: 0.2563201 Test Loss: 0.2764029
Validation loss decreased (0.261080 --> 0.256320).  Saving model ...
Updating learning rate to 4.782969000000001e-06
	iters: 100, epoch: 11 | loss: 0.2349428
	speed: 0.0837s/iter; left time: 749.6510s
	iters: 200, epoch: 11 | loss: 0.2101355
	speed: 0.0297s/iter; left time: 263.0291s
	iters: 300, epoch: 11 | loss: 0.2650644
	speed: 0.0297s/iter; left time: 260.1611s
	iters: 400, epoch: 11 | loss: 0.2470534
	speed: 0.0297s/iter; left time: 257.2599s
	iters: 500, epoch: 11 | loss: 0.2220689
	speed: 0.0297s/iter; left time: 254.0692s
	iters: 600, epoch: 11 | loss: 0.2561055
	speed: 0.0298s/iter; left time: 252.0712s
	iters: 700, epoch: 11 | loss: 0.2374993
	speed: 0.0297s/iter; left time: 248.0921s
	iters: 800, epoch: 11 | loss: 0.2698430
	speed: 0.0297s/iter; left time: 245.0836s
	iters: 900, epoch: 11 | loss: 0.2755079
	speed: 0.0297s/iter; left time: 242.2851s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:27.16s
Steps: 906 | Train Loss: 0.2536946 Vali Loss: 0.2556883 Test Loss: 0.2753615
Validation loss decreased (0.256320 --> 0.255688).  Saving model ...
Updating learning rate to 4.304672100000001e-06
	iters: 100, epoch: 12 | loss: 0.2882319
	speed: 0.0855s/iter; left time: 689.0102s
	iters: 200, epoch: 12 | loss: 0.2682012
	speed: 0.0298s/iter; left time: 237.0759s
	iters: 300, epoch: 12 | loss: 0.2818410
	speed: 0.0297s/iter; left time: 233.5231s
	iters: 400, epoch: 12 | loss: 0.2349325
	speed: 0.0297s/iter; left time: 230.5776s
	iters: 500, epoch: 12 | loss: 0.2266099
	speed: 0.0297s/iter; left time: 227.4607s
	iters: 600, epoch: 12 | loss: 0.2481263
	speed: 0.0297s/iter; left time: 224.7088s
	iters: 700, epoch: 12 | loss: 0.2797031
	speed: 0.0297s/iter; left time: 221.5651s
	iters: 800, epoch: 12 | loss: 0.2338008
	speed: 0.0297s/iter; left time: 218.6188s
	iters: 900, epoch: 12 | loss: 0.2118474
	speed: 0.0297s/iter; left time: 215.6630s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:27.22s
Steps: 906 | Train Loss: 0.2514646 Vali Loss: 0.2569689 Test Loss: 0.2758863
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.8742048900000015e-06
	iters: 100, epoch: 13 | loss: 0.2733481
	speed: 0.0810s/iter; left time: 579.1838s
	iters: 200, epoch: 13 | loss: 0.2261509
	speed: 0.0297s/iter; left time: 209.1092s
	iters: 300, epoch: 13 | loss: 0.2664162
	speed: 0.0296s/iter; left time: 206.0195s
	iters: 400, epoch: 13 | loss: 0.2684229
	speed: 0.0297s/iter; left time: 203.3725s
	iters: 500, epoch: 13 | loss: 0.2347163
	speed: 0.0297s/iter; left time: 200.1210s
	iters: 600, epoch: 13 | loss: 0.2607549
	speed: 0.0297s/iter; left time: 197.3067s
	iters: 700, epoch: 13 | loss: 0.2645776
	speed: 0.0297s/iter; left time: 194.2120s
	iters: 800, epoch: 13 | loss: 0.2235833
	speed: 0.0297s/iter; left time: 191.2300s
	iters: 900, epoch: 13 | loss: 0.2673401
	speed: 0.0297s/iter; left time: 188.7295s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:27.13s
Steps: 906 | Train Loss: 0.2495886 Vali Loss: 0.2539084 Test Loss: 0.2739456
Validation loss decreased (0.255688 --> 0.253908).  Saving model ...
Updating learning rate to 3.486784401000001e-06
	iters: 100, epoch: 14 | loss: 0.2711326
	speed: 0.0850s/iter; left time: 530.5404s
	iters: 200, epoch: 14 | loss: 0.2620098
	speed: 0.0297s/iter; left time: 182.5565s
	iters: 300, epoch: 14 | loss: 0.2505479
	speed: 0.0298s/iter; left time: 180.0664s
	iters: 400, epoch: 14 | loss: 0.2493832
	speed: 0.0298s/iter; left time: 176.9898s
	iters: 500, epoch: 14 | loss: 0.2596759
	speed: 0.0298s/iter; left time: 173.9443s
	iters: 600, epoch: 14 | loss: 0.2682787
	speed: 0.0298s/iter; left time: 170.8650s
	iters: 700, epoch: 14 | loss: 0.2262208
	speed: 0.0297s/iter; left time: 167.7721s
	iters: 800, epoch: 14 | loss: 0.2294442
	speed: 0.0297s/iter; left time: 164.7715s
	iters: 900, epoch: 14 | loss: 0.2381168
	speed: 0.0297s/iter; left time: 161.8526s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:27.29s
Steps: 906 | Train Loss: 0.2475619 Vali Loss: 0.2536014 Test Loss: 0.2733522
Validation loss decreased (0.253908 --> 0.253601).  Saving model ...
Updating learning rate to 3.138105960900001e-06
	iters: 100, epoch: 15 | loss: 0.2370972
	speed: 0.0943s/iter; left time: 503.2433s
	iters: 200, epoch: 15 | loss: 0.2218398
	speed: 0.0297s/iter; left time: 155.5923s
	iters: 300, epoch: 15 | loss: 0.2296391
	speed: 0.0297s/iter; left time: 152.6052s
	iters: 400, epoch: 15 | loss: 0.2450830
	speed: 0.0297s/iter; left time: 149.7055s
	iters: 500, epoch: 15 | loss: 0.2539105
	speed: 0.0297s/iter; left time: 146.6762s
	iters: 600, epoch: 15 | loss: 0.2359191
	speed: 0.0297s/iter; left time: 143.7300s
	iters: 700, epoch: 15 | loss: 0.2427872
	speed: 0.0297s/iter; left time: 140.7293s
	iters: 800, epoch: 15 | loss: 0.2720754
	speed: 0.0297s/iter; left time: 137.7881s
	iters: 900, epoch: 15 | loss: 0.2266614
	speed: 0.0297s/iter; left time: 134.8216s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.17s
Steps: 906 | Train Loss: 0.2461112 Vali Loss: 0.2515949 Test Loss: 0.2726883
Validation loss decreased (0.253601 --> 0.251595).  Saving model ...
Updating learning rate to 2.8242953648100014e-06
	iters: 100, epoch: 16 | loss: 0.2497180
	speed: 0.0844s/iter; left time: 373.8421s
	iters: 200, epoch: 16 | loss: 0.2179761
	speed: 0.0297s/iter; left time: 128.4918s
	iters: 300, epoch: 16 | loss: 0.2537304
	speed: 0.0297s/iter; left time: 125.5295s
	iters: 400, epoch: 16 | loss: 0.2146583
	speed: 0.0297s/iter; left time: 122.5427s
	iters: 500, epoch: 16 | loss: 0.2429717
	speed: 0.0297s/iter; left time: 119.5926s
	iters: 600, epoch: 16 | loss: 0.2603196
	speed: 0.0297s/iter; left time: 116.6146s
	iters: 700, epoch: 16 | loss: 0.2139096
	speed: 0.0297s/iter; left time: 113.6635s
	iters: 800, epoch: 16 | loss: 0.2822977
	speed: 0.0297s/iter; left time: 110.6746s
	iters: 900, epoch: 16 | loss: 0.2415431
	speed: 0.0297s/iter; left time: 107.7848s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:27.17s
Steps: 906 | Train Loss: 0.2447823 Vali Loss: 0.2506451 Test Loss: 0.2708200
Validation loss decreased (0.251595 --> 0.250645).  Saving model ...
Updating learning rate to 2.541865828329001e-06
	iters: 100, epoch: 17 | loss: 0.2776798
	speed: 0.0836s/iter; left time: 294.6541s
	iters: 200, epoch: 17 | loss: 0.2585074
	speed: 0.0297s/iter; left time: 101.7487s
	iters: 300, epoch: 17 | loss: 0.2394258
	speed: 0.0298s/iter; left time: 98.9250s
	iters: 400, epoch: 17 | loss: 0.2552698
	speed: 0.0298s/iter; left time: 96.0708s
	iters: 500, epoch: 17 | loss: 0.2025661
	speed: 0.0298s/iter; left time: 93.1585s
	iters: 600, epoch: 17 | loss: 0.2419886
	speed: 0.0298s/iter; left time: 90.0811s
	iters: 700, epoch: 17 | loss: 0.2193597
	speed: 0.0297s/iter; left time: 87.0132s
	iters: 800, epoch: 17 | loss: 0.2553150
	speed: 0.0298s/iter; left time: 84.2773s
	iters: 900, epoch: 17 | loss: 0.2422516
	speed: 0.0298s/iter; left time: 81.0731s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:27.23s
Steps: 906 | Train Loss: 0.2437425 Vali Loss: 0.2494281 Test Loss: 0.2729142
Validation loss decreased (0.250645 --> 0.249428).  Saving model ...
Updating learning rate to 2.287679245496101e-06
	iters: 100, epoch: 18 | loss: 0.2305934
	speed: 0.0913s/iter; left time: 238.9989s
	iters: 200, epoch: 18 | loss: 0.3099913
	speed: 0.0297s/iter; left time: 74.8895s
	iters: 300, epoch: 18 | loss: 0.2491073
	speed: 0.0297s/iter; left time: 71.7583s
	iters: 400, epoch: 18 | loss: 0.2230721
	speed: 0.0296s/iter; left time: 68.7421s
	iters: 500, epoch: 18 | loss: 0.2287904
	speed: 0.0296s/iter; left time: 65.7752s
	iters: 600, epoch: 18 | loss: 0.2555149
	speed: 0.0296s/iter; left time: 62.7942s
	iters: 700, epoch: 18 | loss: 0.2349044
	speed: 0.0296s/iter; left time: 59.8325s
	iters: 800, epoch: 18 | loss: 0.2563432
	speed: 0.0297s/iter; left time: 56.9289s
	iters: 900, epoch: 18 | loss: 0.2518946
	speed: 0.0297s/iter; left time: 54.0497s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:27.15s
Steps: 906 | Train Loss: 0.2425837 Vali Loss: 0.2502056 Test Loss: 0.2719750
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.058911320946491e-06
	iters: 100, epoch: 19 | loss: 0.2546939
	speed: 0.0816s/iter; left time: 139.8302s
	iters: 200, epoch: 19 | loss: 0.2464008
	speed: 0.0297s/iter; left time: 47.8488s
	iters: 300, epoch: 19 | loss: 0.2259780
	speed: 0.0297s/iter; left time: 44.9106s
	iters: 400, epoch: 19 | loss: 0.2565815
	speed: 0.0297s/iter; left time: 41.9182s
	iters: 500, epoch: 19 | loss: 0.2522539
	speed: 0.0297s/iter; left time: 38.9499s
	iters: 600, epoch: 19 | loss: 0.2340999
	speed: 0.0297s/iter; left time: 35.9794s
	iters: 700, epoch: 19 | loss: 0.2489940
	speed: 0.0297s/iter; left time: 33.0274s
	iters: 800, epoch: 19 | loss: 0.2335016
	speed: 0.0297s/iter; left time: 30.0633s
	iters: 900, epoch: 19 | loss: 0.2551128
	speed: 0.0297s/iter; left time: 27.1611s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:27.18s
Steps: 906 | Train Loss: 0.2415383 Vali Loss: 0.2505901 Test Loss: 0.2700067
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.8530201888518418e-06
	iters: 100, epoch: 20 | loss: 0.2540413
	speed: 0.0815s/iter; left time: 65.7976s
	iters: 200, epoch: 20 | loss: 0.2746835
	speed: 0.0298s/iter; left time: 21.0381s
	iters: 300, epoch: 20 | loss: 0.2585455
	speed: 0.0297s/iter; left time: 18.0570s
	iters: 400, epoch: 20 | loss: 0.2225086
	speed: 0.0297s/iter; left time: 15.0756s
	iters: 500, epoch: 20 | loss: 0.2870366
	speed: 0.0297s/iter; left time: 12.1002s
	iters: 600, epoch: 20 | loss: 0.2433546
	speed: 0.0297s/iter; left time: 9.1215s
	iters: 700, epoch: 20 | loss: 0.2240592
	speed: 0.0297s/iter; left time: 6.1506s
	iters: 800, epoch: 20 | loss: 0.2773416
	speed: 0.0297s/iter; left time: 3.1804s
	iters: 900, epoch: 20 | loss: 0.2103368
	speed: 0.0297s/iter; left time: 0.2080s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:27.20s
Steps: 906 | Train Loss: 0.2407939 Vali Loss: 0.2490563 Test Loss: 0.2700902
Validation loss decreased (0.249428 --> 0.249056).  Saving model ...
Updating learning rate to 1.6677181699666578e-06
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2122817486524582, rmse:0.46074044704437256, mae:0.2702677845954895, rse:0.4219633936882019
Original data scale mse:1440519.5, rmse:1200.2164306640625, mae:759.9635620117188, rse:0.08434204012155533
Use GPU: cuda:0
>>>>>>>start training : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.9303597
	speed: 0.0326s/iter; left time: 586.9792s
	iters: 200, epoch: 1 | loss: 0.8192927
	speed: 0.0297s/iter; left time: 532.6112s
	iters: 300, epoch: 1 | loss: 0.8756372
	speed: 0.0297s/iter; left time: 529.2985s
	iters: 400, epoch: 1 | loss: 0.7628884
	speed: 0.0297s/iter; left time: 526.6783s
	iters: 500, epoch: 1 | loss: 0.7693668
	speed: 0.0298s/iter; left time: 524.7210s
	iters: 600, epoch: 1 | loss: 0.7992023
	speed: 0.0298s/iter; left time: 521.4579s
	iters: 700, epoch: 1 | loss: 0.7673064
	speed: 0.0297s/iter; left time: 517.8952s
	iters: 800, epoch: 1 | loss: 0.7632505
	speed: 0.0297s/iter; left time: 515.0162s
	iters: 900, epoch: 1 | loss: 0.7252381
	speed: 0.0297s/iter; left time: 512.3197s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:27.27s
Steps: 906 | Train Loss: 0.8191658 Vali Loss: 0.7367652 Test Loss: 0.8015324
Validation loss decreased (inf --> 0.736765).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 2 | loss: 0.5939575
	speed: 0.0930s/iter; left time: 1591.0904s
	iters: 200, epoch: 2 | loss: 0.4519100
	speed: 0.0296s/iter; left time: 504.4735s
	iters: 300, epoch: 2 | loss: 0.4430814
	speed: 0.0297s/iter; left time: 501.5422s
	iters: 400, epoch: 2 | loss: 0.4072329
	speed: 0.0297s/iter; left time: 498.7854s
	iters: 500, epoch: 2 | loss: 0.3674377
	speed: 0.0296s/iter; left time: 495.5015s
	iters: 600, epoch: 2 | loss: 0.3417858
	speed: 0.0296s/iter; left time: 492.4725s
	iters: 700, epoch: 2 | loss: 0.3673163
	speed: 0.0296s/iter; left time: 489.1801s
	iters: 800, epoch: 2 | loss: 0.3352906
	speed: 0.0296s/iter; left time: 486.2918s
	iters: 900, epoch: 2 | loss: 0.3289691
	speed: 0.0296s/iter; left time: 483.6157s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:27.20s
Steps: 906 | Train Loss: 0.4283856 Vali Loss: 0.3295324 Test Loss: 0.3497426
Validation loss decreased (0.736765 --> 0.329532).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 3 | loss: 0.3273184
	speed: 0.0872s/iter; left time: 1413.4415s
	iters: 200, epoch: 3 | loss: 0.3205146
	speed: 0.0297s/iter; left time: 478.4437s
	iters: 300, epoch: 3 | loss: 0.3572803
	speed: 0.0297s/iter; left time: 475.2252s
	iters: 400, epoch: 3 | loss: 0.3491791
	speed: 0.0297s/iter; left time: 472.2608s
	iters: 500, epoch: 3 | loss: 0.3285128
	speed: 0.0297s/iter; left time: 469.4995s
	iters: 600, epoch: 3 | loss: 0.3490100
	speed: 0.0297s/iter; left time: 466.1848s
	iters: 700, epoch: 3 | loss: 0.3510199
	speed: 0.0297s/iter; left time: 463.2814s
	iters: 800, epoch: 3 | loss: 0.3305733
	speed: 0.0297s/iter; left time: 460.2696s
	iters: 900, epoch: 3 | loss: 0.3242746
	speed: 0.0297s/iter; left time: 457.2757s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.17s
Steps: 906 | Train Loss: 0.3215313 Vali Loss: 0.3007587 Test Loss: 0.3236365
Validation loss decreased (0.329532 --> 0.300759).  Saving model ...
Updating learning rate to 1e-05
	iters: 100, epoch: 4 | loss: 0.2934029
	speed: 0.0855s/iter; left time: 1308.2738s
	iters: 200, epoch: 4 | loss: 0.3443906
	speed: 0.0298s/iter; left time: 452.6202s
	iters: 300, epoch: 4 | loss: 0.3247115
	speed: 0.0297s/iter; left time: 448.7962s
	iters: 400, epoch: 4 | loss: 0.3113715
	speed: 0.0297s/iter; left time: 446.2804s
	iters: 500, epoch: 4 | loss: 0.2876775
	speed: 0.0297s/iter; left time: 443.0331s
	iters: 600, epoch: 4 | loss: 0.2765463
	speed: 0.0297s/iter; left time: 439.9927s
	iters: 700, epoch: 4 | loss: 0.2743662
	speed: 0.0297s/iter; left time: 436.7594s
	iters: 800, epoch: 4 | loss: 0.2984843
	speed: 0.0299s/iter; left time: 436.2664s
	iters: 900, epoch: 4 | loss: 0.2925319
	speed: 0.0297s/iter; left time: 430.2031s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:27.28s
Steps: 906 | Train Loss: 0.2977832 Vali Loss: 0.2814059 Test Loss: 0.3024971
Validation loss decreased (0.300759 --> 0.281406).  Saving model ...
Updating learning rate to 9e-06
	iters: 100, epoch: 5 | loss: 0.2975923
	speed: 0.0870s/iter; left time: 1252.4389s
	iters: 200, epoch: 5 | loss: 0.2624957
	speed: 0.0297s/iter; left time: 424.6663s
	iters: 300, epoch: 5 | loss: 0.2594224
	speed: 0.0297s/iter; left time: 422.0511s
	iters: 400, epoch: 5 | loss: 0.3374806
	speed: 0.0297s/iter; left time: 418.7985s
	iters: 500, epoch: 5 | loss: 0.2633976
	speed: 0.0297s/iter; left time: 415.9577s
	iters: 600, epoch: 5 | loss: 0.2445966
	speed: 0.0297s/iter; left time: 413.0095s
	iters: 700, epoch: 5 | loss: 0.2778179
	speed: 0.0297s/iter; left time: 410.1356s
	iters: 800, epoch: 5 | loss: 0.2677927
	speed: 0.0297s/iter; left time: 406.6834s
	iters: 900, epoch: 5 | loss: 0.3016306
	speed: 0.0297s/iter; left time: 403.7709s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:27.27s
Steps: 906 | Train Loss: 0.2837949 Vali Loss: 0.2746767 Test Loss: 0.2949765
Validation loss decreased (0.281406 --> 0.274677).  Saving model ...
Updating learning rate to 8.1e-06
	iters: 100, epoch: 6 | loss: 0.2517997
	speed: 0.0851s/iter; left time: 1148.3904s
	iters: 200, epoch: 6 | loss: 0.3100924
	speed: 0.0297s/iter; left time: 397.5403s
	iters: 300, epoch: 6 | loss: 0.2727546
	speed: 0.0297s/iter; left time: 394.7224s
	iters: 400, epoch: 6 | loss: 0.2320868
	speed: 0.0298s/iter; left time: 392.5534s
	iters: 500, epoch: 6 | loss: 0.2645080
	speed: 0.0297s/iter; left time: 389.3964s
	iters: 600, epoch: 6 | loss: 0.2786039
	speed: 0.0298s/iter; left time: 386.6330s
	iters: 700, epoch: 6 | loss: 0.2487097
	speed: 0.0297s/iter; left time: 383.2807s
	iters: 800, epoch: 6 | loss: 0.2429876
	speed: 0.0298s/iter; left time: 381.1682s
	iters: 900, epoch: 6 | loss: 0.2557825
	speed: 0.0298s/iter; left time: 378.6029s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:27.27s
Steps: 906 | Train Loss: 0.2744221 Vali Loss: 0.2668014 Test Loss: 0.2890441
Validation loss decreased (0.274677 --> 0.266801).  Saving model ...
Updating learning rate to 7.290000000000001e-06
	iters: 100, epoch: 7 | loss: 0.2778957
	speed: 0.0853s/iter; left time: 1072.9598s
	iters: 200, epoch: 7 | loss: 0.2636458
	speed: 0.0297s/iter; left time: 371.3007s
	iters: 300, epoch: 7 | loss: 0.2854033
	speed: 0.0297s/iter; left time: 368.2265s
	iters: 400, epoch: 7 | loss: 0.2845186
	speed: 0.0297s/iter; left time: 365.3568s
	iters: 500, epoch: 7 | loss: 0.2655800
	speed: 0.0297s/iter; left time: 362.4132s
	iters: 600, epoch: 7 | loss: 0.2446871
	speed: 0.0297s/iter; left time: 359.2617s
	iters: 700, epoch: 7 | loss: 0.3329983
	speed: 0.0297s/iter; left time: 356.2926s
	iters: 800, epoch: 7 | loss: 0.2764859
	speed: 0.0297s/iter; left time: 353.3629s
	iters: 900, epoch: 7 | loss: 0.2517844
	speed: 0.0297s/iter; left time: 350.3834s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:27.25s
Steps: 906 | Train Loss: 0.2676544 Vali Loss: 0.2648553 Test Loss: 0.2808464
Validation loss decreased (0.266801 --> 0.264855).  Saving model ...
Updating learning rate to 6.561e-06
	iters: 100, epoch: 8 | loss: 0.2560193
	speed: 0.0847s/iter; left time: 989.3790s
	iters: 200, epoch: 8 | loss: 0.2670867
	speed: 0.0297s/iter; left time: 344.2435s
	iters: 300, epoch: 8 | loss: 0.2400081
	speed: 0.0297s/iter; left time: 341.3633s
	iters: 400, epoch: 8 | loss: 0.2598019
	speed: 0.0298s/iter; left time: 338.7085s
	iters: 500, epoch: 8 | loss: 0.2636440
	speed: 0.0298s/iter; left time: 335.7785s
	iters: 600, epoch: 8 | loss: 0.2835736
	speed: 0.0298s/iter; left time: 333.1830s
	iters: 700, epoch: 8 | loss: 0.2559046
	speed: 0.0297s/iter; left time: 329.4972s
	iters: 800, epoch: 8 | loss: 0.2724702
	speed: 0.0297s/iter; left time: 326.0561s
	iters: 900, epoch: 8 | loss: 0.2947002
	speed: 0.0297s/iter; left time: 323.1083s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:27.22s
Steps: 906 | Train Loss: 0.2621302 Vali Loss: 0.2571634 Test Loss: 0.2844976
Validation loss decreased (0.264855 --> 0.257163).  Saving model ...
Updating learning rate to 5.904900000000001e-06
	iters: 100, epoch: 9 | loss: 0.2716273
	speed: 0.0869s/iter; left time: 935.8086s
	iters: 200, epoch: 9 | loss: 0.2145229
	speed: 0.0297s/iter; left time: 317.4157s
	iters: 300, epoch: 9 | loss: 0.2432051
	speed: 0.0297s/iter; left time: 314.1877s
	iters: 400, epoch: 9 | loss: 0.2403807
	speed: 0.0297s/iter; left time: 311.1321s
	iters: 500, epoch: 9 | loss: 0.2410014
	speed: 0.0297s/iter; left time: 308.1593s
	iters: 600, epoch: 9 | loss: 0.2758222
	speed: 0.0297s/iter; left time: 305.3799s
	iters: 700, epoch: 9 | loss: 0.2780923
	speed: 0.0297s/iter; left time: 302.5114s
	iters: 800, epoch: 9 | loss: 0.2528399
	speed: 0.0297s/iter; left time: 299.4109s
	iters: 900, epoch: 9 | loss: 0.2815757
	speed: 0.0297s/iter; left time: 296.6913s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:27.27s
Steps: 906 | Train Loss: 0.2582970 Vali Loss: 0.2553545 Test Loss: 0.2808213
Validation loss decreased (0.257163 --> 0.255355).  Saving model ...
Updating learning rate to 5.314410000000001e-06
	iters: 100, epoch: 10 | loss: 0.2581372
	speed: 0.0841s/iter; left time: 829.9376s
	iters: 200, epoch: 10 | loss: 0.2428953
	speed: 0.0298s/iter; left time: 290.8452s
	iters: 300, epoch: 10 | loss: 0.2504463
	speed: 0.0298s/iter; left time: 287.8333s
	iters: 400, epoch: 10 | loss: 0.2884009
	speed: 0.0298s/iter; left time: 284.6374s
	iters: 500, epoch: 10 | loss: 0.2555453
	speed: 0.0297s/iter; left time: 281.3531s
	iters: 600, epoch: 10 | loss: 0.2282630
	speed: 0.0297s/iter; left time: 278.3321s
	iters: 700, epoch: 10 | loss: 0.2553661
	speed: 0.0297s/iter; left time: 275.3069s
	iters: 800, epoch: 10 | loss: 0.2430495
	speed: 0.0297s/iter; left time: 272.3415s
	iters: 900, epoch: 10 | loss: 0.2311419
	speed: 0.0297s/iter; left time: 269.5938s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:27.23s
Steps: 906 | Train Loss: 0.2546838 Vali Loss: 0.2557582 Test Loss: 0.2759125
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.782969000000001e-06
	iters: 100, epoch: 11 | loss: 0.2596675
	speed: 0.0817s/iter; left time: 732.0639s
	iters: 200, epoch: 11 | loss: 0.2587310
	speed: 0.0296s/iter; left time: 262.7214s
	iters: 300, epoch: 11 | loss: 0.2235795
	speed: 0.0296s/iter; left time: 259.7499s
	iters: 400, epoch: 11 | loss: 0.2279402
	speed: 0.0296s/iter; left time: 256.6977s
	iters: 500, epoch: 11 | loss: 0.2848815
	speed: 0.0296s/iter; left time: 253.8299s
	iters: 600, epoch: 11 | loss: 0.2675300
	speed: 0.0296s/iter; left time: 250.7357s
	iters: 700, epoch: 11 | loss: 0.2346966
	speed: 0.0296s/iter; left time: 247.8062s
	iters: 800, epoch: 11 | loss: 0.2234470
	speed: 0.0296s/iter; left time: 244.8440s
	iters: 900, epoch: 11 | loss: 0.2768649
	speed: 0.0296s/iter; left time: 241.8773s
-------------------------------------------------------------------------------------
Epoch: 11
Cost time: 00h:00m:27.14s
Steps: 906 | Train Loss: 0.2518432 Vali Loss: 0.2534573 Test Loss: 0.2760886
Validation loss decreased (0.255355 --> 0.253457).  Saving model ...
Updating learning rate to 4.304672100000001e-06
	iters: 100, epoch: 12 | loss: 0.2355793
	speed: 0.0845s/iter; left time: 680.9141s
	iters: 200, epoch: 12 | loss: 0.2460623
	speed: 0.0297s/iter; left time: 236.5404s
	iters: 300, epoch: 12 | loss: 0.2458866
	speed: 0.0297s/iter; left time: 233.4098s
	iters: 400, epoch: 12 | loss: 0.2901711
	speed: 0.0297s/iter; left time: 230.4566s
	iters: 500, epoch: 12 | loss: 0.2442312
	speed: 0.0297s/iter; left time: 227.0561s
	iters: 600, epoch: 12 | loss: 0.2325747
	speed: 0.0297s/iter; left time: 224.1511s
	iters: 700, epoch: 12 | loss: 0.2606840
	speed: 0.0297s/iter; left time: 221.5413s
	iters: 800, epoch: 12 | loss: 0.2331602
	speed: 0.0297s/iter; left time: 218.5537s
	iters: 900, epoch: 12 | loss: 0.2301960
	speed: 0.0297s/iter; left time: 215.2126s
-------------------------------------------------------------------------------------
Epoch: 12
Cost time: 00h:00m:27.21s
Steps: 906 | Train Loss: 0.2494160 Vali Loss: 0.2504608 Test Loss: 0.2713868
Validation loss decreased (0.253457 --> 0.250461).  Saving model ...
Updating learning rate to 3.8742048900000015e-06
	iters: 100, epoch: 13 | loss: 0.2390223
	speed: 0.0840s/iter; left time: 600.5392s
	iters: 200, epoch: 13 | loss: 0.2358641
	speed: 0.0297s/iter; left time: 209.2916s
	iters: 300, epoch: 13 | loss: 0.2319415
	speed: 0.0297s/iter; left time: 206.1479s
	iters: 400, epoch: 13 | loss: 0.2719097
	speed: 0.0296s/iter; left time: 203.0059s
	iters: 500, epoch: 13 | loss: 0.2816010
	speed: 0.0296s/iter; left time: 199.9928s
	iters: 600, epoch: 13 | loss: 0.2265584
	speed: 0.0296s/iter; left time: 197.0046s
	iters: 700, epoch: 13 | loss: 0.2560033
	speed: 0.0296s/iter; left time: 194.0592s
	iters: 800, epoch: 13 | loss: 0.2094005
	speed: 0.0296s/iter; left time: 191.0651s
	iters: 900, epoch: 13 | loss: 0.1995389
	speed: 0.0296s/iter; left time: 188.1114s
-------------------------------------------------------------------------------------
Epoch: 13
Cost time: 00h:00m:27.15s
Steps: 906 | Train Loss: 0.2474359 Vali Loss: 0.2490291 Test Loss: 0.2725363
Validation loss decreased (0.250461 --> 0.249029).  Saving model ...
Updating learning rate to 3.486784401000001e-06
	iters: 100, epoch: 14 | loss: 0.2317441
	speed: 0.0846s/iter; left time: 528.0283s
	iters: 200, epoch: 14 | loss: 0.2502038
	speed: 0.0297s/iter; left time: 182.5454s
	iters: 300, epoch: 14 | loss: 0.2363130
	speed: 0.0297s/iter; left time: 179.5008s
	iters: 400, epoch: 14 | loss: 0.2655280
	speed: 0.0296s/iter; left time: 176.1714s
	iters: 500, epoch: 14 | loss: 0.2653955
	speed: 0.0296s/iter; left time: 173.1674s
	iters: 600, epoch: 14 | loss: 0.2435174
	speed: 0.0298s/iter; left time: 170.9052s
	iters: 700, epoch: 14 | loss: 0.2368079
	speed: 0.0297s/iter; left time: 167.4013s
	iters: 800, epoch: 14 | loss: 0.2336951
	speed: 0.0297s/iter; left time: 164.4195s
	iters: 900, epoch: 14 | loss: 0.2768160
	speed: 0.0297s/iter; left time: 161.4854s
-------------------------------------------------------------------------------------
Epoch: 14
Cost time: 00h:00m:27.18s
Steps: 906 | Train Loss: 0.2456541 Vali Loss: 0.2486161 Test Loss: 0.2733704
Validation loss decreased (0.249029 --> 0.248616).  Saving model ...
Updating learning rate to 3.138105960900001e-06
	iters: 100, epoch: 15 | loss: 0.2262324
	speed: 0.0840s/iter; left time: 448.3596s
	iters: 200, epoch: 15 | loss: 0.2571841
	speed: 0.0297s/iter; left time: 155.6499s
	iters: 300, epoch: 15 | loss: 0.2922182
	speed: 0.0297s/iter; left time: 152.7801s
	iters: 400, epoch: 15 | loss: 0.2663425
	speed: 0.0297s/iter; left time: 149.7176s
	iters: 500, epoch: 15 | loss: 0.2416984
	speed: 0.0297s/iter; left time: 146.7448s
	iters: 600, epoch: 15 | loss: 0.2661588
	speed: 0.0297s/iter; left time: 143.7651s
	iters: 700, epoch: 15 | loss: 0.2324841
	speed: 0.0297s/iter; left time: 140.8390s
	iters: 800, epoch: 15 | loss: 0.2875350
	speed: 0.0297s/iter; left time: 137.8252s
	iters: 900, epoch: 15 | loss: 0.2483862
	speed: 0.0297s/iter; left time: 134.8537s
-------------------------------------------------------------------------------------
Epoch: 15
Cost time: 00h:00m:27.23s
Steps: 906 | Train Loss: 0.2442277 Vali Loss: 0.2486614 Test Loss: 0.2727549
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.8242953648100014e-06
	iters: 100, epoch: 16 | loss: 0.2580866
	speed: 0.0819s/iter; left time: 362.8449s
	iters: 200, epoch: 16 | loss: 0.2610742
	speed: 0.0297s/iter; left time: 128.5407s
	iters: 300, epoch: 16 | loss: 0.2428169
	speed: 0.0297s/iter; left time: 125.4956s
	iters: 400, epoch: 16 | loss: 0.2550306
	speed: 0.0297s/iter; left time: 122.4997s
	iters: 500, epoch: 16 | loss: 0.2314095
	speed: 0.0297s/iter; left time: 119.6146s
	iters: 600, epoch: 16 | loss: 0.2286934
	speed: 0.0297s/iter; left time: 116.6313s
	iters: 700, epoch: 16 | loss: 0.2168345
	speed: 0.0296s/iter; left time: 113.5630s
	iters: 800, epoch: 16 | loss: 0.2415393
	speed: 0.0297s/iter; left time: 110.6996s
	iters: 900, epoch: 16 | loss: 0.2262828
	speed: 0.0297s/iter; left time: 107.6609s
-------------------------------------------------------------------------------------
Epoch: 16
Cost time: 00h:00m:27.15s
Steps: 906 | Train Loss: 0.2424408 Vali Loss: 0.2466327 Test Loss: 0.2727647
Validation loss decreased (0.248616 --> 0.246633).  Saving model ...
Updating learning rate to 2.541865828329001e-06
	iters: 100, epoch: 17 | loss: 0.2161431
	speed: 0.0852s/iter; left time: 300.4944s
	iters: 200, epoch: 17 | loss: 0.2529179
	speed: 0.0297s/iter; left time: 101.7114s
	iters: 300, epoch: 17 | loss: 0.2262137
	speed: 0.0297s/iter; left time: 98.7399s
	iters: 400, epoch: 17 | loss: 0.1929938
	speed: 0.0297s/iter; left time: 95.7707s
	iters: 500, epoch: 17 | loss: 0.2696162
	speed: 0.0297s/iter; left time: 92.8047s
	iters: 600, epoch: 17 | loss: 0.2311496
	speed: 0.0296s/iter; left time: 89.6794s
	iters: 700, epoch: 17 | loss: 0.2199807
	speed: 0.0297s/iter; left time: 86.7306s
	iters: 800, epoch: 17 | loss: 0.2416278
	speed: 0.0297s/iter; left time: 83.7614s
	iters: 900, epoch: 17 | loss: 0.2810754
	speed: 0.0297s/iter; left time: 80.8611s
-------------------------------------------------------------------------------------
Epoch: 17
Cost time: 00h:00m:27.16s
Steps: 906 | Train Loss: 0.2413637 Vali Loss: 0.2464718 Test Loss: 0.2705329
Validation loss decreased (0.246633 --> 0.246472).  Saving model ...
Updating learning rate to 2.287679245496101e-06
	iters: 100, epoch: 18 | loss: 0.2167058
	speed: 0.0847s/iter; left time: 221.9057s
	iters: 200, epoch: 18 | loss: 0.2368382
	speed: 0.0297s/iter; left time: 74.7456s
	iters: 300, epoch: 18 | loss: 0.2192357
	speed: 0.0297s/iter; left time: 71.7985s
	iters: 400, epoch: 18 | loss: 0.2327405
	speed: 0.0297s/iter; left time: 68.9066s
	iters: 500, epoch: 18 | loss: 0.2245473
	speed: 0.0296s/iter; left time: 65.7693s
	iters: 600, epoch: 18 | loss: 0.2043872
	speed: 0.0296s/iter; left time: 62.8237s
	iters: 700, epoch: 18 | loss: 0.2337856
	speed: 0.0296s/iter; left time: 59.8587s
	iters: 800, epoch: 18 | loss: 0.2345974
	speed: 0.0296s/iter; left time: 56.8741s
	iters: 900, epoch: 18 | loss: 0.2442849
	speed: 0.0297s/iter; left time: 54.0045s
-------------------------------------------------------------------------------------
Epoch: 18
Cost time: 00h:00m:27.16s
Steps: 906 | Train Loss: 0.2403704 Vali Loss: 0.2465864 Test Loss: 0.2721342
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.058911320946491e-06
	iters: 100, epoch: 19 | loss: 0.2852758
	speed: 0.0813s/iter; left time: 139.2840s
	iters: 200, epoch: 19 | loss: 0.2500556
	speed: 0.0297s/iter; left time: 47.9651s
	iters: 300, epoch: 19 | loss: 0.2271177
	speed: 0.0297s/iter; left time: 44.9767s
	iters: 400, epoch: 19 | loss: 0.1958688
	speed: 0.0297s/iter; left time: 42.0149s
	iters: 500, epoch: 19 | loss: 0.2321912
	speed: 0.0297s/iter; left time: 39.0288s
	iters: 600, epoch: 19 | loss: 0.2199782
	speed: 0.0297s/iter; left time: 36.0422s
	iters: 700, epoch: 19 | loss: 0.2116968
	speed: 0.0298s/iter; left time: 33.1877s
	iters: 800, epoch: 19 | loss: 0.2390930
	speed: 0.0297s/iter; left time: 30.0972s
	iters: 900, epoch: 19 | loss: 0.2520115
	speed: 0.0297s/iter; left time: 27.1346s
-------------------------------------------------------------------------------------
Epoch: 19
Cost time: 00h:00m:27.20s
Steps: 906 | Train Loss: 0.2395252 Vali Loss: 0.2471846 Test Loss: 0.2706857
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.8530201888518418e-06
	iters: 100, epoch: 20 | loss: 0.2002559
	speed: 0.0811s/iter; left time: 65.4880s
	iters: 200, epoch: 20 | loss: 0.2317692
	speed: 0.0297s/iter; left time: 21.0164s
	iters: 300, epoch: 20 | loss: 0.2474830
	speed: 0.0297s/iter; left time: 18.0412s
	iters: 400, epoch: 20 | loss: 0.2230704
	speed: 0.0297s/iter; left time: 15.0637s
	iters: 500, epoch: 20 | loss: 0.2750233
	speed: 0.0297s/iter; left time: 12.0914s
	iters: 600, epoch: 20 | loss: 0.2412827
	speed: 0.0297s/iter; left time: 9.1208s
	iters: 700, epoch: 20 | loss: 0.2620236
	speed: 0.0297s/iter; left time: 6.1519s
	iters: 800, epoch: 20 | loss: 0.2424151
	speed: 0.0297s/iter; left time: 3.1793s
	iters: 900, epoch: 20 | loss: 0.2197125
	speed: 0.0297s/iter; left time: 0.2079s
-------------------------------------------------------------------------------------
Epoch: 20
Cost time: 00h:00m:27.16s
Steps: 906 | Train Loss: 0.2387766 Vali Loss: 0.2458301 Test Loss: 0.2699371
Validation loss decreased (0.246472 --> 0.245830).  Saving model ...
Updating learning rate to 1.6677181699666578e-06
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_24_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.21430844068527222, rmse:0.46293458342552185, mae:0.26991504430770874, rse:0.42397287487983704
Original data scale mse:1422171.75, rmse:1192.5484619140625, mae:752.7681274414062, rse:0.083803191781044

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2122817486524582, RMSE: 0.46074044704437256, MAE: 0.2702677845954895, RSE: 0.4219633936882019
Unscaled Metrics - MSE: 1440519.5, RMSE: 1200.2164306640625, MAE: 759.9635620117188, RSE: 0.08434204012155533

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.21430844068527222, RMSE: 0.46293458342552185, MAE: 0.26991504430770874, RSE: 0.42397287487983704
Unscaled Metrics - MSE: 1422171.75, RMSE: 1192.5484619140625, MAE: 752.7681274414062, RSE: 0.083803191781044

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_96_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8150337
	speed: 0.0571s/iter; left time: 1027.0300s
	iters: 200, epoch: 1 | loss: 0.7865309
	speed: 0.0375s/iter; left time: 670.5916s
	iters: 300, epoch: 1 | loss: 0.7082292
	speed: 0.0375s/iter; left time: 666.1179s
	iters: 400, epoch: 1 | loss: 0.6916044
	speed: 0.0375s/iter; left time: 663.3239s
	iters: 500, epoch: 1 | loss: 0.6595669
	speed: 0.0375s/iter; left time: 658.7198s
	iters: 600, epoch: 1 | loss: 0.6274444
	speed: 0.0375s/iter; left time: 654.9922s
	iters: 700, epoch: 1 | loss: 0.5982677
	speed: 0.0375s/iter; left time: 651.2928s
	iters: 800, epoch: 1 | loss: 0.5808680
	speed: 0.0375s/iter; left time: 648.7011s
	iters: 900, epoch: 1 | loss: 0.5951590
	speed: 0.0375s/iter; left time: 644.2150s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.59s
Steps: 904 | Train Loss: 0.6850672 Vali Loss: 0.5645998 Test Loss: 0.6092119
Validation loss decreased (inf --> 0.564600).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5116340
	speed: 0.1068s/iter; left time: 1823.7026s
	iters: 200, epoch: 2 | loss: 0.5119313
	speed: 0.0380s/iter; left time: 645.7579s
	iters: 300, epoch: 2 | loss: 0.4384262
	speed: 0.0381s/iter; left time: 642.6145s
	iters: 400, epoch: 2 | loss: 0.4303905
	speed: 0.0381s/iter; left time: 638.5407s
	iters: 500, epoch: 2 | loss: 0.4120647
	speed: 0.0381s/iter; left time: 634.6446s
	iters: 600, epoch: 2 | loss: 0.4223784
	speed: 0.0380s/iter; left time: 630.6994s
	iters: 700, epoch: 2 | loss: 0.4023072
	speed: 0.0381s/iter; left time: 627.5626s
	iters: 800, epoch: 2 | loss: 0.3992223
	speed: 0.0377s/iter; left time: 617.0627s
	iters: 900, epoch: 2 | loss: 0.3646308
	speed: 0.0375s/iter; left time: 611.0971s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.60s
Steps: 904 | Train Loss: 0.4395237 Vali Loss: 0.3742394 Test Loss: 0.4021838
Validation loss decreased (0.564600 --> 0.374239).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3748493
	speed: 0.1196s/iter; left time: 1934.5646s
	iters: 200, epoch: 3 | loss: 0.3729239
	speed: 0.0376s/iter; left time: 603.8395s
	iters: 300, epoch: 3 | loss: 0.3902239
	speed: 0.0376s/iter; left time: 600.0100s
	iters: 400, epoch: 3 | loss: 0.3805928
	speed: 0.0375s/iter; left time: 595.1036s
	iters: 500, epoch: 3 | loss: 0.3480365
	speed: 0.0375s/iter; left time: 591.9830s
	iters: 600, epoch: 3 | loss: 0.3729757
	speed: 0.0376s/iter; left time: 589.1283s
	iters: 700, epoch: 3 | loss: 0.3477038
	speed: 0.0376s/iter; left time: 585.2741s
	iters: 800, epoch: 3 | loss: 0.3995710
	speed: 0.0375s/iter; left time: 580.9570s
	iters: 900, epoch: 3 | loss: 0.3725554
	speed: 0.0381s/iter; left time: 585.2538s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.32s
Steps: 904 | Train Loss: 0.3649984 Vali Loss: 0.3627852 Test Loss: 0.3926698
Validation loss decreased (0.374239 --> 0.362785).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3369209
	speed: 0.1066s/iter; left time: 1628.0758s
	iters: 200, epoch: 4 | loss: 0.3438199
	speed: 0.0375s/iter; left time: 568.2858s
	iters: 300, epoch: 4 | loss: 0.3186904
	speed: 0.0375s/iter; left time: 564.9885s
	iters: 400, epoch: 4 | loss: 0.3523760
	speed: 0.0375s/iter; left time: 560.9002s
	iters: 500, epoch: 4 | loss: 0.3491880
	speed: 0.0375s/iter; left time: 557.4642s
	iters: 600, epoch: 4 | loss: 0.3450741
	speed: 0.0376s/iter; left time: 554.7143s
	iters: 700, epoch: 4 | loss: 0.3198591
	speed: 0.0375s/iter; left time: 549.3687s
	iters: 800, epoch: 4 | loss: 0.3282226
	speed: 0.0377s/iter; left time: 548.8080s
	iters: 900, epoch: 4 | loss: 0.3083993
	speed: 0.0380s/iter; left time: 550.4655s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.23s
Steps: 904 | Train Loss: 0.3405427 Vali Loss: 0.3546020 Test Loss: 0.3999583
Validation loss decreased (0.362785 --> 0.354602).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3082108
	speed: 0.1059s/iter; left time: 1521.3681s
	iters: 200, epoch: 5 | loss: 0.3236231
	speed: 0.0375s/iter; left time: 535.1098s
	iters: 300, epoch: 5 | loss: 0.3039698
	speed: 0.0375s/iter; left time: 531.2313s
	iters: 400, epoch: 5 | loss: 0.3608793
	speed: 0.0375s/iter; left time: 527.9320s
	iters: 500, epoch: 5 | loss: 0.3142963
	speed: 0.0375s/iter; left time: 524.0369s
	iters: 600, epoch: 5 | loss: 0.3134119
	speed: 0.0375s/iter; left time: 520.0403s
	iters: 700, epoch: 5 | loss: 0.3490780
	speed: 0.0375s/iter; left time: 515.7575s
	iters: 800, epoch: 5 | loss: 0.3387781
	speed: 0.0375s/iter; left time: 511.7868s
	iters: 900, epoch: 5 | loss: 0.3102326
	speed: 0.0375s/iter; left time: 508.0107s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.18s
Steps: 904 | Train Loss: 0.3213092 Vali Loss: 0.3511533 Test Loss: 0.3767008
Validation loss decreased (0.354602 --> 0.351153).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2619042
	speed: 0.1067s/iter; left time: 1435.9811s
	iters: 200, epoch: 6 | loss: 0.3239393
	speed: 0.0381s/iter; left time: 509.0829s
	iters: 300, epoch: 6 | loss: 0.3155590
	speed: 0.0376s/iter; left time: 498.4058s
	iters: 400, epoch: 6 | loss: 0.3265509
	speed: 0.0376s/iter; left time: 494.5927s
	iters: 500, epoch: 6 | loss: 0.2980553
	speed: 0.0375s/iter; left time: 490.3284s
	iters: 600, epoch: 6 | loss: 0.3054219
	speed: 0.0375s/iter; left time: 486.4441s
	iters: 700, epoch: 6 | loss: 0.2757724
	speed: 0.0376s/iter; left time: 482.9909s
	iters: 800, epoch: 6 | loss: 0.3181484
	speed: 0.0375s/iter; left time: 478.9380s
	iters: 900, epoch: 6 | loss: 0.2964580
	speed: 0.0375s/iter; left time: 475.2743s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:34.38s
Steps: 904 | Train Loss: 0.3061327 Vali Loss: 0.3628338 Test Loss: 0.3884365
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2978437
	speed: 0.1048s/iter; left time: 1315.9603s
	iters: 200, epoch: 7 | loss: 0.2830954
	speed: 0.0375s/iter; left time: 467.4470s
	iters: 300, epoch: 7 | loss: 0.2900503
	speed: 0.0375s/iter; left time: 463.8769s
	iters: 400, epoch: 7 | loss: 0.2858080
	speed: 0.0376s/iter; left time: 460.6450s
	iters: 500, epoch: 7 | loss: 0.2673484
	speed: 0.0376s/iter; left time: 456.6471s
	iters: 600, epoch: 7 | loss: 0.3229191
	speed: 0.0376s/iter; left time: 453.3841s
	iters: 700, epoch: 7 | loss: 0.2741376
	speed: 0.0376s/iter; left time: 449.1000s
	iters: 800, epoch: 7 | loss: 0.2455494
	speed: 0.0375s/iter; left time: 445.0959s
	iters: 900, epoch: 7 | loss: 0.2912613
	speed: 0.0376s/iter; left time: 441.9013s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.24s
Steps: 904 | Train Loss: 0.2898870 Vali Loss: 0.3604039 Test Loss: 0.3900767
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2654546
	speed: 0.1048s/iter; left time: 1221.3755s
	iters: 200, epoch: 8 | loss: 0.2805337
	speed: 0.0381s/iter; left time: 440.3548s
	iters: 300, epoch: 8 | loss: 0.2866867
	speed: 0.0381s/iter; left time: 436.3423s
	iters: 400, epoch: 8 | loss: 0.2736313
	speed: 0.0381s/iter; left time: 432.1537s
	iters: 500, epoch: 8 | loss: 0.2847659
	speed: 0.0381s/iter; left time: 428.6094s
	iters: 600, epoch: 8 | loss: 0.2609076
	speed: 0.0381s/iter; left time: 425.2393s
	iters: 700, epoch: 8 | loss: 0.2739472
	speed: 0.0381s/iter; left time: 420.8724s
	iters: 800, epoch: 8 | loss: 0.2664894
	speed: 0.0381s/iter; left time: 417.0207s
	iters: 900, epoch: 8 | loss: 0.2703234
	speed: 0.0381s/iter; left time: 413.1208s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:34.73s
Steps: 904 | Train Loss: 0.2745776 Vali Loss: 0.3704009 Test Loss: 0.3950642
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3860393762588501, rmse:0.6213206648826599, mae:0.37681102752685547, rse:0.5688841342926025
Original data scale mse:2678728.5, rmse:1636.68212890625, mae:1075.39013671875, rse:0.11518000811338425
Use GPU: cuda:0
>>>>>>>start training : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7977383
	speed: 0.0405s/iter; left time: 728.9609s
	iters: 200, epoch: 1 | loss: 0.7573959
	speed: 0.0375s/iter; left time: 671.3267s
	iters: 300, epoch: 1 | loss: 0.7317508
	speed: 0.0375s/iter; left time: 667.1749s
	iters: 400, epoch: 1 | loss: 0.6853316
	speed: 0.0375s/iter; left time: 663.0008s
	iters: 500, epoch: 1 | loss: 0.6389797
	speed: 0.0375s/iter; left time: 659.1503s
	iters: 600, epoch: 1 | loss: 0.6572399
	speed: 0.0375s/iter; left time: 655.6831s
	iters: 700, epoch: 1 | loss: 0.6264318
	speed: 0.0375s/iter; left time: 651.7014s
	iters: 800, epoch: 1 | loss: 0.6064339
	speed: 0.0375s/iter; left time: 648.8700s
	iters: 900, epoch: 1 | loss: 0.5623375
	speed: 0.0376s/iter; left time: 645.5621s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.28s
Steps: 904 | Train Loss: 0.6866124 Vali Loss: 0.5657853 Test Loss: 0.6095882
Validation loss decreased (inf --> 0.565785).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5049976
	speed: 0.1070s/iter; left time: 1827.1604s
	iters: 200, epoch: 2 | loss: 0.4583150
	speed: 0.0375s/iter; left time: 636.8089s
	iters: 300, epoch: 2 | loss: 0.4456894
	speed: 0.0375s/iter; left time: 633.3854s
	iters: 400, epoch: 2 | loss: 0.4533090
	speed: 0.0376s/iter; left time: 630.5014s
	iters: 500, epoch: 2 | loss: 0.4204739
	speed: 0.0375s/iter; left time: 626.1323s
	iters: 600, epoch: 2 | loss: 0.4253356
	speed: 0.0375s/iter; left time: 622.2301s
	iters: 700, epoch: 2 | loss: 0.4037566
	speed: 0.0375s/iter; left time: 618.3432s
	iters: 800, epoch: 2 | loss: 0.3865068
	speed: 0.0376s/iter; left time: 615.0318s
	iters: 900, epoch: 2 | loss: 0.3612042
	speed: 0.0375s/iter; left time: 610.5751s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.26s
Steps: 904 | Train Loss: 0.4439592 Vali Loss: 0.3900311 Test Loss: 0.4203017
Validation loss decreased (0.565785 --> 0.390031).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3815211
	speed: 0.1060s/iter; left time: 1714.4680s
	iters: 200, epoch: 3 | loss: 0.3716187
	speed: 0.0375s/iter; left time: 603.1464s
	iters: 300, epoch: 3 | loss: 0.3916775
	speed: 0.0375s/iter; left time: 599.1812s
	iters: 400, epoch: 3 | loss: 0.3593472
	speed: 0.0375s/iter; left time: 594.8796s
	iters: 500, epoch: 3 | loss: 0.3692485
	speed: 0.0375s/iter; left time: 591.4259s
	iters: 600, epoch: 3 | loss: 0.3481042
	speed: 0.0375s/iter; left time: 587.8379s
	iters: 700, epoch: 3 | loss: 0.3654119
	speed: 0.0375s/iter; left time: 584.0099s
	iters: 800, epoch: 3 | loss: 0.3498480
	speed: 0.0375s/iter; left time: 580.1506s
	iters: 900, epoch: 3 | loss: 0.3100273
	speed: 0.0375s/iter; left time: 576.3347s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.19s
Steps: 904 | Train Loss: 0.3654165 Vali Loss: 0.3589092 Test Loss: 0.3908001
Validation loss decreased (0.390031 --> 0.358909).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3473025
	speed: 0.1087s/iter; left time: 1660.0657s
	iters: 200, epoch: 4 | loss: 0.3399260
	speed: 0.0375s/iter; left time: 568.7360s
	iters: 300, epoch: 4 | loss: 0.3408269
	speed: 0.0375s/iter; left time: 565.6346s
	iters: 400, epoch: 4 | loss: 0.3393246
	speed: 0.0375s/iter; left time: 561.6981s
	iters: 500, epoch: 4 | loss: 0.3567283
	speed: 0.0375s/iter; left time: 558.2047s
	iters: 600, epoch: 4 | loss: 0.3573701
	speed: 0.0376s/iter; left time: 555.0123s
	iters: 700, epoch: 4 | loss: 0.3585140
	speed: 0.0376s/iter; left time: 550.9456s
	iters: 800, epoch: 4 | loss: 0.3528823
	speed: 0.0376s/iter; left time: 547.2860s
	iters: 900, epoch: 4 | loss: 0.3077019
	speed: 0.0376s/iter; left time: 544.0108s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.35s
Steps: 904 | Train Loss: 0.3424055 Vali Loss: 0.3478123 Test Loss: 0.3919922
Validation loss decreased (0.358909 --> 0.347812).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3381594
	speed: 0.1106s/iter; left time: 1588.9792s
	iters: 200, epoch: 5 | loss: 0.3218094
	speed: 0.0375s/iter; left time: 534.8815s
	iters: 300, epoch: 5 | loss: 0.3541737
	speed: 0.0376s/iter; left time: 531.9164s
	iters: 400, epoch: 5 | loss: 0.3116988
	speed: 0.0375s/iter; left time: 527.3819s
	iters: 500, epoch: 5 | loss: 0.3338269
	speed: 0.0375s/iter; left time: 523.9197s
	iters: 600, epoch: 5 | loss: 0.2980376
	speed: 0.0375s/iter; left time: 520.2871s
	iters: 700, epoch: 5 | loss: 0.3347347
	speed: 0.0375s/iter; left time: 516.2773s
	iters: 800, epoch: 5 | loss: 0.3145725
	speed: 0.0375s/iter; left time: 512.5478s
	iters: 900, epoch: 5 | loss: 0.2930928
	speed: 0.0375s/iter; left time: 508.7915s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:34.23s
Steps: 904 | Train Loss: 0.3253946 Vali Loss: 0.3588083 Test Loss: 0.4050261
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3154757
	speed: 0.1038s/iter; left time: 1397.5447s
	iters: 200, epoch: 6 | loss: 0.2960304
	speed: 0.0381s/iter; left time: 509.3535s
	iters: 300, epoch: 6 | loss: 0.3257332
	speed: 0.0381s/iter; left time: 504.6835s
	iters: 400, epoch: 6 | loss: 0.3083124
	speed: 0.0381s/iter; left time: 501.0911s
	iters: 500, epoch: 6 | loss: 0.3041582
	speed: 0.0381s/iter; left time: 497.2419s
	iters: 600, epoch: 6 | loss: 0.2994896
	speed: 0.0380s/iter; left time: 492.9504s
	iters: 700, epoch: 6 | loss: 0.2627114
	speed: 0.0381s/iter; left time: 489.6458s
	iters: 800, epoch: 6 | loss: 0.2952165
	speed: 0.0377s/iter; left time: 480.5313s
	iters: 900, epoch: 6 | loss: 0.3007255
	speed: 0.0375s/iter; left time: 474.5668s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:34.58s
Steps: 904 | Train Loss: 0.3104735 Vali Loss: 0.3581659 Test Loss: 0.3918914
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3124721
	speed: 0.1036s/iter; left time: 1300.2887s
	iters: 200, epoch: 7 | loss: 0.2769096
	speed: 0.0376s/iter; left time: 468.3732s
	iters: 300, epoch: 7 | loss: 0.2846074
	speed: 0.0376s/iter; left time: 465.2190s
	iters: 400, epoch: 7 | loss: 0.2937971
	speed: 0.0376s/iter; left time: 460.4218s
	iters: 500, epoch: 7 | loss: 0.2685632
	speed: 0.0375s/iter; left time: 456.4859s
	iters: 600, epoch: 7 | loss: 0.2725448
	speed: 0.0376s/iter; left time: 453.6257s
	iters: 700, epoch: 7 | loss: 0.2755593
	speed: 0.0376s/iter; left time: 449.7034s
	iters: 800, epoch: 7 | loss: 0.2673206
	speed: 0.0376s/iter; left time: 445.3372s
	iters: 900, epoch: 7 | loss: 0.2814191
	speed: 0.0376s/iter; left time: 441.7177s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:34.28s
Steps: 904 | Train Loss: 0.2954007 Vali Loss: 0.3726324 Test Loss: 0.4216487
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_96_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.39962294697761536, rmse:0.6321573853492737, mae:0.39198100566864014, rse:0.5788062214851379
Original data scale mse:3289923.75, rmse:1813.814697265625, mae:1161.396728515625, rse:0.1276455521583557

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.3860393762588501, RMSE: 0.6213206648826599, MAE: 0.37681102752685547, RSE: 0.5688841342926025
Unscaled Metrics - MSE: 2678728.5, RMSE: 1636.68212890625, MAE: 1075.39013671875, RSE: 0.11518000811338425

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.39962294697761536, RMSE: 0.6321573853492737, MAE: 0.39198100566864014, RSE: 0.5788062214851379
Unscaled Metrics - MSE: 3289923.75, RMSE: 1813.814697265625, MAE: 1161.396728515625, RSE: 0.1276455521583557

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_96_168_loss_choice_for_IT', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work-1/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=20, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8280501
	speed: 0.0648s/iter; left time: 1162.0792s
	iters: 200, epoch: 1 | loss: 0.7671803
	speed: 0.0460s/iter; left time: 819.8382s
	iters: 300, epoch: 1 | loss: 0.7849457
	speed: 0.0459s/iter; left time: 815.0010s
	iters: 400, epoch: 1 | loss: 0.7654822
	speed: 0.0459s/iter; left time: 809.9302s
	iters: 500, epoch: 1 | loss: 0.7249994
	speed: 0.0460s/iter; left time: 806.0810s
	iters: 600, epoch: 1 | loss: 0.7271847
	speed: 0.0459s/iter; left time: 801.0097s
	iters: 700, epoch: 1 | loss: 0.6938729
	speed: 0.0460s/iter; left time: 796.8871s
	iters: 800, epoch: 1 | loss: 0.7244999
	speed: 0.0460s/iter; left time: 792.2574s
	iters: 900, epoch: 1 | loss: 0.6612191
	speed: 0.0460s/iter; left time: 787.8262s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.10s
Steps: 902 | Train Loss: 0.7398342 Vali Loss: 0.6647944 Test Loss: 0.7146385
Validation loss decreased (inf --> 0.664794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6549571
	speed: 0.1340s/iter; left time: 2283.4777s
	iters: 200, epoch: 2 | loss: 0.5886534
	speed: 0.0460s/iter; left time: 778.4671s
	iters: 300, epoch: 2 | loss: 0.5208691
	speed: 0.0460s/iter; left time: 774.1602s
	iters: 400, epoch: 2 | loss: 0.4893373
	speed: 0.0460s/iter; left time: 769.5013s
	iters: 500, epoch: 2 | loss: 0.4368061
	speed: 0.0460s/iter; left time: 764.6985s
	iters: 600, epoch: 2 | loss: 0.4560348
	speed: 0.0460s/iter; left time: 760.7329s
	iters: 700, epoch: 2 | loss: 0.3951013
	speed: 0.0460s/iter; left time: 756.1441s
	iters: 800, epoch: 2 | loss: 0.4011065
	speed: 0.0460s/iter; left time: 751.5147s
	iters: 900, epoch: 2 | loss: 0.4047628
	speed: 0.0460s/iter; left time: 746.8052s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.73s
Steps: 902 | Train Loss: 0.4958260 Vali Loss: 0.4030131 Test Loss: 0.4575190
Validation loss decreased (0.664794 --> 0.403013).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3732580
	speed: 0.1270s/iter; left time: 2049.9142s
	iters: 200, epoch: 3 | loss: 0.4142113
	speed: 0.0460s/iter; left time: 737.6633s
	iters: 300, epoch: 3 | loss: 0.4074443
	speed: 0.0460s/iter; left time: 733.2607s
	iters: 400, epoch: 3 | loss: 0.4110204
	speed: 0.0460s/iter; left time: 728.4617s
	iters: 500, epoch: 3 | loss: 0.4058383
	speed: 0.0460s/iter; left time: 724.0710s
	iters: 600, epoch: 3 | loss: 0.3690900
	speed: 0.0460s/iter; left time: 719.6120s
	iters: 700, epoch: 3 | loss: 0.3863875
	speed: 0.0460s/iter; left time: 714.9164s
	iters: 800, epoch: 3 | loss: 0.3612333
	speed: 0.0460s/iter; left time: 710.1167s
	iters: 900, epoch: 3 | loss: 0.3778325
	speed: 0.0460s/iter; left time: 705.3669s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.75s
Steps: 902 | Train Loss: 0.3893514 Vali Loss: 0.3763303 Test Loss: 0.4238930
Validation loss decreased (0.403013 --> 0.376330).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3786625
	speed: 0.1276s/iter; left time: 1943.4564s
	iters: 200, epoch: 4 | loss: 0.3670406
	speed: 0.0459s/iter; left time: 694.8889s
	iters: 300, epoch: 4 | loss: 0.3980571
	speed: 0.0461s/iter; left time: 692.4354s
	iters: 400, epoch: 4 | loss: 0.3459499
	speed: 0.0459s/iter; left time: 686.2604s
	iters: 500, epoch: 4 | loss: 0.3482888
	speed: 0.0459s/iter; left time: 681.5713s
	iters: 600, epoch: 4 | loss: 0.3452627
	speed: 0.0459s/iter; left time: 676.6531s
	iters: 700, epoch: 4 | loss: 0.3783236
	speed: 0.0459s/iter; left time: 672.1073s
	iters: 800, epoch: 4 | loss: 0.3829342
	speed: 0.0459s/iter; left time: 667.2400s
	iters: 900, epoch: 4 | loss: 0.3624015
	speed: 0.0459s/iter; left time: 662.7438s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.74s
Steps: 902 | Train Loss: 0.3627147 Vali Loss: 0.3870502 Test Loss: 0.4186793
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3258232
	speed: 0.1243s/iter; left time: 1782.1133s
	iters: 200, epoch: 5 | loss: 0.3195130
	speed: 0.0460s/iter; left time: 655.1124s
	iters: 300, epoch: 5 | loss: 0.3546770
	speed: 0.0460s/iter; left time: 649.8544s
	iters: 400, epoch: 5 | loss: 0.3555680
	speed: 0.0460s/iter; left time: 645.0062s
	iters: 500, epoch: 5 | loss: 0.3524508
	speed: 0.0460s/iter; left time: 640.3811s
	iters: 600, epoch: 5 | loss: 0.3631451
	speed: 0.0460s/iter; left time: 636.3669s
	iters: 700, epoch: 5 | loss: 0.3687120
	speed: 0.0459s/iter; left time: 630.9881s
	iters: 800, epoch: 5 | loss: 0.3300255
	speed: 0.0460s/iter; left time: 626.7650s
	iters: 900, epoch: 5 | loss: 0.3168762
	speed: 0.0460s/iter; left time: 622.8306s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.72s
Steps: 902 | Train Loss: 0.3414206 Vali Loss: 0.3805757 Test Loss: 0.4232909
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3305565
	speed: 0.1240s/iter; left time: 1665.3506s
	iters: 200, epoch: 6 | loss: 0.3264413
	speed: 0.0459s/iter; left time: 611.8131s
	iters: 300, epoch: 6 | loss: 0.3067354
	speed: 0.0459s/iter; left time: 607.3502s
	iters: 400, epoch: 6 | loss: 0.3274036
	speed: 0.0459s/iter; left time: 602.6175s
	iters: 500, epoch: 6 | loss: 0.3122303
	speed: 0.0459s/iter; left time: 598.2635s
	iters: 600, epoch: 6 | loss: 0.3093185
	speed: 0.0459s/iter; left time: 593.8813s
	iters: 700, epoch: 6 | loss: 0.3042404
	speed: 0.0459s/iter; left time: 589.1627s
	iters: 800, epoch: 6 | loss: 0.3062407
	speed: 0.0459s/iter; left time: 584.5509s
	iters: 900, epoch: 6 | loss: 0.3096261
	speed: 0.0459s/iter; left time: 579.8216s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.66s
Steps: 902 | Train Loss: 0.3224779 Vali Loss: 0.3952253 Test Loss: 0.4266629
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4348284602165222, rmse:0.6594152450561523, mae:0.42385366559028625, rse:0.6039435863494873
Original data scale mse:4242708.0, rmse:2059.783447265625, mae:1329.1781005859375, rse:0.1450914889574051
Use GPU: cuda:0
>>>>>>>start training : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7974735
	speed: 0.0489s/iter; left time: 876.6159s
	iters: 200, epoch: 1 | loss: 0.7544412
	speed: 0.0459s/iter; left time: 819.5194s
	iters: 300, epoch: 1 | loss: 0.7925992
	speed: 0.0460s/iter; left time: 815.3856s
	iters: 400, epoch: 1 | loss: 0.7377703
	speed: 0.0459s/iter; left time: 810.2478s
	iters: 500, epoch: 1 | loss: 0.7340454
	speed: 0.0459s/iter; left time: 805.9650s
	iters: 600, epoch: 1 | loss: 0.7256621
	speed: 0.0459s/iter; left time: 801.3613s
	iters: 700, epoch: 1 | loss: 0.7105807
	speed: 0.0460s/iter; left time: 796.9050s
	iters: 800, epoch: 1 | loss: 0.6977004
	speed: 0.0460s/iter; left time: 792.4218s
	iters: 900, epoch: 1 | loss: 0.6401993
	speed: 0.0459s/iter; left time: 787.4375s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.79s
Steps: 902 | Train Loss: 0.7437132 Vali Loss: 0.6597509 Test Loss: 0.7151433
Validation loss decreased (inf --> 0.659751).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6102369
	speed: 0.1301s/iter; left time: 2216.0522s
	iters: 200, epoch: 2 | loss: 0.5705064
	speed: 0.0460s/iter; left time: 778.5306s
	iters: 300, epoch: 2 | loss: 0.4899058
	speed: 0.0460s/iter; left time: 774.2105s
	iters: 400, epoch: 2 | loss: 0.4781640
	speed: 0.0460s/iter; left time: 769.5036s
	iters: 500, epoch: 2 | loss: 0.4673846
	speed: 0.0460s/iter; left time: 764.9942s
	iters: 600, epoch: 2 | loss: 0.4334404
	speed: 0.0460s/iter; left time: 760.8389s
	iters: 700, epoch: 2 | loss: 0.4007219
	speed: 0.0460s/iter; left time: 756.1422s
	iters: 800, epoch: 2 | loss: 0.4263807
	speed: 0.0460s/iter; left time: 751.8025s
	iters: 900, epoch: 2 | loss: 0.4291814
	speed: 0.0460s/iter; left time: 746.9764s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.78s
Steps: 902 | Train Loss: 0.4971245 Vali Loss: 0.4060253 Test Loss: 0.4578899
Validation loss decreased (0.659751 --> 0.406025).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4284823
	speed: 0.1310s/iter; left time: 2114.4274s
	iters: 200, epoch: 3 | loss: 0.3880342
	speed: 0.0459s/iter; left time: 736.4957s
	iters: 300, epoch: 3 | loss: 0.4185027
	speed: 0.0459s/iter; left time: 732.0549s
	iters: 400, epoch: 3 | loss: 0.3936366
	speed: 0.0459s/iter; left time: 727.5856s
	iters: 500, epoch: 3 | loss: 0.4209563
	speed: 0.0459s/iter; left time: 722.5659s
	iters: 600, epoch: 3 | loss: 0.3490029
	speed: 0.0460s/iter; left time: 718.9048s
	iters: 700, epoch: 3 | loss: 0.3856685
	speed: 0.0460s/iter; left time: 714.4894s
	iters: 800, epoch: 3 | loss: 0.3550621
	speed: 0.0460s/iter; left time: 709.5749s
	iters: 900, epoch: 3 | loss: 0.3765105
	speed: 0.0460s/iter; left time: 705.1142s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.77s
Steps: 902 | Train Loss: 0.3937890 Vali Loss: 0.3807809 Test Loss: 0.4213197
Validation loss decreased (0.406025 --> 0.380781).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4087430
	speed: 0.1290s/iter; left time: 1966.0731s
	iters: 200, epoch: 4 | loss: 0.3617661
	speed: 0.0459s/iter; left time: 695.3753s
	iters: 300, epoch: 4 | loss: 0.3720865
	speed: 0.0459s/iter; left time: 690.5803s
	iters: 400, epoch: 4 | loss: 0.3709372
	speed: 0.0459s/iter; left time: 686.0791s
	iters: 500, epoch: 4 | loss: 0.3520428
	speed: 0.0460s/iter; left time: 681.9133s
	iters: 600, epoch: 4 | loss: 0.3697520
	speed: 0.0460s/iter; left time: 677.5122s
	iters: 700, epoch: 4 | loss: 0.3444159
	speed: 0.0460s/iter; left time: 673.0597s
	iters: 800, epoch: 4 | loss: 0.3860698
	speed: 0.0460s/iter; left time: 668.2669s
	iters: 900, epoch: 4 | loss: 0.3856181
	speed: 0.0460s/iter; left time: 663.5784s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.76s
Steps: 902 | Train Loss: 0.3666811 Vali Loss: 0.3818067 Test Loss: 0.4054340
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3714052
	speed: 0.1254s/iter; left time: 1797.7750s
	iters: 200, epoch: 5 | loss: 0.3473887
	speed: 0.0460s/iter; left time: 654.3548s
	iters: 300, epoch: 5 | loss: 0.3265126
	speed: 0.0459s/iter; left time: 649.3528s
	iters: 400, epoch: 5 | loss: 0.3595056
	speed: 0.0459s/iter; left time: 644.4749s
	iters: 500, epoch: 5 | loss: 0.3287465
	speed: 0.0459s/iter; left time: 640.0399s
	iters: 600, epoch: 5 | loss: 0.3324325
	speed: 0.0459s/iter; left time: 635.5376s
	iters: 700, epoch: 5 | loss: 0.3384423
	speed: 0.0459s/iter; left time: 630.6958s
	iters: 800, epoch: 5 | loss: 0.3693855
	speed: 0.0459s/iter; left time: 626.3665s
	iters: 900, epoch: 5 | loss: 0.3303832
	speed: 0.0460s/iter; left time: 622.3776s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.76s
Steps: 902 | Train Loss: 0.3449307 Vali Loss: 0.3710508 Test Loss: 0.4327653
Validation loss decreased (0.380781 --> 0.371051).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3339225
	speed: 0.1305s/iter; left time: 1753.3196s
	iters: 200, epoch: 6 | loss: 0.3325287
	speed: 0.0459s/iter; left time: 611.8145s
	iters: 300, epoch: 6 | loss: 0.3434712
	speed: 0.0459s/iter; left time: 607.1119s
	iters: 400, epoch: 6 | loss: 0.3417833
	speed: 0.0459s/iter; left time: 602.6456s
	iters: 500, epoch: 6 | loss: 0.3304627
	speed: 0.0459s/iter; left time: 598.0939s
	iters: 600, epoch: 6 | loss: 0.3096986
	speed: 0.0459s/iter; left time: 593.4194s
	iters: 700, epoch: 6 | loss: 0.3188351
	speed: 0.0459s/iter; left time: 589.0232s
	iters: 800, epoch: 6 | loss: 0.3207916
	speed: 0.0459s/iter; left time: 584.6534s
	iters: 900, epoch: 6 | loss: 0.3165942
	speed: 0.0459s/iter; left time: 580.0843s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.72s
Steps: 902 | Train Loss: 0.3264330 Vali Loss: 0.3824500 Test Loss: 0.4231836
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3252023
	speed: 0.1254s/iter; left time: 1570.6715s
	iters: 200, epoch: 7 | loss: 0.2956451
	speed: 0.0460s/iter; left time: 571.8627s
	iters: 300, epoch: 7 | loss: 0.3121677
	speed: 0.0460s/iter; left time: 567.0415s
	iters: 400, epoch: 7 | loss: 0.3224980
	speed: 0.0460s/iter; left time: 562.1929s
	iters: 500, epoch: 7 | loss: 0.3192953
	speed: 0.0460s/iter; left time: 557.6396s
	iters: 600, epoch: 7 | loss: 0.3228470
	speed: 0.0460s/iter; left time: 553.4963s
	iters: 700, epoch: 7 | loss: 0.3234811
	speed: 0.0460s/iter; left time: 548.4020s
	iters: 800, epoch: 7 | loss: 0.2908741
	speed: 0.0460s/iter; left time: 544.1635s
	iters: 900, epoch: 7 | loss: 0.2781619
	speed: 0.0460s/iter; left time: 539.1398s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:41.74s
Steps: 902 | Train Loss: 0.3102664 Vali Loss: 0.3849172 Test Loss: 0.4344090
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3061499
	speed: 0.1246s/iter; left time: 1448.6184s
	iters: 200, epoch: 8 | loss: 0.2870059
	speed: 0.0460s/iter; left time: 530.1086s
	iters: 300, epoch: 8 | loss: 0.3007690
	speed: 0.0460s/iter; left time: 525.6528s
	iters: 400, epoch: 8 | loss: 0.3293248
	speed: 0.0460s/iter; left time: 520.9789s
	iters: 500, epoch: 8 | loss: 0.2685870
	speed: 0.0460s/iter; left time: 516.2828s
	iters: 600, epoch: 8 | loss: 0.2870359
	speed: 0.0460s/iter; left time: 511.6359s
	iters: 700, epoch: 8 | loss: 0.2987286
	speed: 0.0460s/iter; left time: 507.0246s
	iters: 800, epoch: 8 | loss: 0.2776779
	speed: 0.0460s/iter; left time: 502.2331s
	iters: 900, epoch: 8 | loss: 0.2833379
	speed: 0.0460s/iter; left time: 497.8054s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:41.72s
Steps: 902 | Train Loss: 0.2932087 Vali Loss: 0.3821450 Test Loss: 0.4211602
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_96_168_loss_choice_for_IT_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.45692309737205505, rmse:0.675960898399353, mae:0.4327623248100281, rse:0.6190972924232483
Original data scale mse:4784611.0, rmse:2187.37548828125, mae:1385.891357421875, rse:0.15407909452915192

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.4348284602165222, RMSE: 0.6594152450561523, MAE: 0.42385366559028625, RSE: 0.6039435863494873
Unscaled Metrics - MSE: 4242708.0, RMSE: 2059.783447265625, MAE: 1329.1781005859375, RSE: 0.1450914889574051

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.45692309737205505, RMSE: 0.675960898399353, MAE: 0.4327623248100281, RSE: 0.6190972924232483
Unscaled Metrics - MSE: 4784611.0, RMSE: 2187.37548828125, MAE: 1385.891357421875, RSE: 0.15407909452915192
