
=== Starting experiments for loss function: MSE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4062752
	speed: 0.0679s/iter; left time: 599.2427s
	iters: 200, epoch: 1 | loss: 0.4490731
	speed: 0.0423s/iter; left time: 369.6214s
	iters: 300, epoch: 1 | loss: 0.3447189
	speed: 0.0423s/iter; left time: 364.8243s
	iters: 400, epoch: 1 | loss: 0.4202814
	speed: 0.0423s/iter; left time: 360.7949s
	iters: 500, epoch: 1 | loss: 0.3825126
	speed: 0.0423s/iter; left time: 356.3038s
	iters: 600, epoch: 1 | loss: 0.4463949
	speed: 0.0423s/iter; left time: 352.4487s
	iters: 700, epoch: 1 | loss: 0.3554860
	speed: 0.0424s/iter; left time: 348.7190s
	iters: 800, epoch: 1 | loss: 0.3329375
	speed: 0.0423s/iter; left time: 344.2259s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.29s
Steps: 893 | Train Loss: 0.3779395 Vali Loss: 0.4368218 Test Loss: 0.4749455
Validation loss decreased (inf --> 0.436822).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4321591
	speed: 0.1555s/iter; left time: 1234.0575s
	iters: 200, epoch: 2 | loss: 0.3975809
	speed: 0.0425s/iter; left time: 333.0563s
	iters: 300, epoch: 2 | loss: 0.2834045
	speed: 0.0423s/iter; left time: 327.4289s
	iters: 400, epoch: 2 | loss: 0.2936918
	speed: 0.0423s/iter; left time: 323.1378s
	iters: 500, epoch: 2 | loss: 0.2714845
	speed: 0.0424s/iter; left time: 319.3444s
	iters: 600, epoch: 2 | loss: 0.2872095
	speed: 0.0424s/iter; left time: 315.6703s
	iters: 700, epoch: 2 | loss: 0.3408362
	speed: 0.0424s/iter; left time: 311.3674s
	iters: 800, epoch: 2 | loss: 0.2582404
	speed: 0.0424s/iter; left time: 306.6420s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.17s
Steps: 893 | Train Loss: 0.3092715 Vali Loss: 0.4199357 Test Loss: 0.4742230
Validation loss decreased (0.436822 --> 0.419936).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2012810
	speed: 0.1529s/iter; left time: 1076.8527s
	iters: 200, epoch: 3 | loss: 0.2745693
	speed: 0.0423s/iter; left time: 293.8910s
	iters: 300, epoch: 3 | loss: 0.2421604
	speed: 0.0423s/iter; left time: 289.8235s
	iters: 400, epoch: 3 | loss: 0.2551808
	speed: 0.0423s/iter; left time: 285.4184s
	iters: 500, epoch: 3 | loss: 0.2312551
	speed: 0.0423s/iter; left time: 281.0323s
	iters: 600, epoch: 3 | loss: 0.2817569
	speed: 0.0424s/iter; left time: 277.5837s
	iters: 700, epoch: 3 | loss: 0.1640334
	speed: 0.0424s/iter; left time: 273.0298s
	iters: 800, epoch: 3 | loss: 0.3372894
	speed: 0.0424s/iter; left time: 268.7246s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.2761120 Vali Loss: 0.4101853 Test Loss: 0.4503999
Validation loss decreased (0.419936 --> 0.410185).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2537383
	speed: 0.1525s/iter; left time: 938.3432s
	iters: 200, epoch: 4 | loss: 0.2325063
	speed: 0.0424s/iter; left time: 256.4355s
	iters: 300, epoch: 4 | loss: 0.2676595
	speed: 0.0424s/iter; left time: 252.0785s
	iters: 400, epoch: 4 | loss: 0.2086366
	speed: 0.0424s/iter; left time: 248.0409s
	iters: 500, epoch: 4 | loss: 0.3853133
	speed: 0.0424s/iter; left time: 243.6700s
	iters: 600, epoch: 4 | loss: 0.2249607
	speed: 0.0422s/iter; left time: 238.5343s
	iters: 700, epoch: 4 | loss: 0.2668764
	speed: 0.0423s/iter; left time: 234.8522s
	iters: 800, epoch: 4 | loss: 0.2927850
	speed: 0.0424s/iter; left time: 231.2456s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.2687885 Vali Loss: 0.4336080 Test Loss: 0.4734263
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2390144
	speed: 0.1502s/iter; left time: 790.1390s
	iters: 200, epoch: 5 | loss: 0.1977134
	speed: 0.0423s/iter; left time: 218.3652s
	iters: 300, epoch: 5 | loss: 0.2724915
	speed: 0.0423s/iter; left time: 214.0501s
	iters: 400, epoch: 5 | loss: 0.2195267
	speed: 0.0424s/iter; left time: 210.1197s
	iters: 500, epoch: 5 | loss: 0.2479026
	speed: 0.0423s/iter; left time: 205.4403s
	iters: 600, epoch: 5 | loss: 0.2113601
	speed: 0.0424s/iter; left time: 201.8271s
	iters: 700, epoch: 5 | loss: 0.2392982
	speed: 0.0424s/iter; left time: 197.5442s
	iters: 800, epoch: 5 | loss: 0.2210716
	speed: 0.0424s/iter; left time: 193.3673s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.99s
Steps: 893 | Train Loss: 0.2557502 Vali Loss: 0.4083221 Test Loss: 0.4551176
Validation loss decreased (0.410185 --> 0.408322).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2018318
	speed: 0.1536s/iter; left time: 670.6467s
	iters: 200, epoch: 6 | loss: 0.2799388
	speed: 0.0424s/iter; left time: 181.0247s
	iters: 300, epoch: 6 | loss: 0.1967447
	speed: 0.0425s/iter; left time: 177.0979s
	iters: 400, epoch: 6 | loss: 0.2135415
	speed: 0.0423s/iter; left time: 172.0800s
	iters: 500, epoch: 6 | loss: 0.2062024
	speed: 0.0423s/iter; left time: 167.8923s
	iters: 600, epoch: 6 | loss: 0.2476224
	speed: 0.0424s/iter; left time: 163.9357s
	iters: 700, epoch: 6 | loss: 0.1791212
	speed: 0.0425s/iter; left time: 160.0147s
	iters: 800, epoch: 6 | loss: 0.2224586
	speed: 0.0424s/iter; left time: 155.4403s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.09s
Steps: 893 | Train Loss: 0.2370440 Vali Loss: 0.4499719 Test Loss: 0.4937295
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2283527
	speed: 0.1506s/iter; left time: 522.9856s
	iters: 200, epoch: 7 | loss: 0.2216568
	speed: 0.0424s/iter; left time: 142.8875s
	iters: 300, epoch: 7 | loss: 0.2187734
	speed: 0.0423s/iter; left time: 138.5007s
	iters: 400, epoch: 7 | loss: 0.2077828
	speed: 0.0423s/iter; left time: 134.1586s
	iters: 500, epoch: 7 | loss: 0.1985875
	speed: 0.0423s/iter; left time: 129.8508s
	iters: 600, epoch: 7 | loss: 0.2054232
	speed: 0.0423s/iter; left time: 125.7131s
	iters: 700, epoch: 7 | loss: 0.1703641
	speed: 0.0423s/iter; left time: 121.5996s
	iters: 800, epoch: 7 | loss: 0.1733078
	speed: 0.0423s/iter; left time: 117.3378s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.93s
Steps: 893 | Train Loss: 0.2119504 Vali Loss: 0.4550525 Test Loss: 0.5188643
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2100210
	speed: 0.1507s/iter; left time: 388.9244s
	iters: 200, epoch: 8 | loss: 0.1868386
	speed: 0.0424s/iter; left time: 105.2177s
	iters: 300, epoch: 8 | loss: 0.1724563
	speed: 0.0423s/iter; left time: 100.7432s
	iters: 400, epoch: 8 | loss: 0.2129223
	speed: 0.0423s/iter; left time: 96.5167s
	iters: 500, epoch: 8 | loss: 0.2158544
	speed: 0.0424s/iter; left time: 92.4012s
	iters: 600, epoch: 8 | loss: 0.1620623
	speed: 0.0425s/iter; left time: 88.3637s
	iters: 700, epoch: 8 | loss: 0.1801844
	speed: 0.0424s/iter; left time: 83.9291s
	iters: 800, epoch: 8 | loss: 0.2255919
	speed: 0.0424s/iter; left time: 79.7232s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.1881337 Vali Loss: 0.4813017 Test Loss: 0.5380040
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.45511767268180847, rmse:0.6746240854263306, mae:0.4416392743587494, rse:0.5339223742485046
Original data scale mse:17261680.0, rmse:4154.7177734375, mae:2581.17822265625, rse:0.20658095180988312
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3967359
	speed: 0.0443s/iter; left time: 391.4396s
	iters: 200, epoch: 1 | loss: 0.4064189
	speed: 0.0424s/iter; left time: 370.5603s
	iters: 300, epoch: 1 | loss: 0.2779341
	speed: 0.0424s/iter; left time: 366.0447s
	iters: 400, epoch: 1 | loss: 0.2643839
	speed: 0.0424s/iter; left time: 362.0700s
	iters: 500, epoch: 1 | loss: 0.2900892
	speed: 0.0423s/iter; left time: 356.8179s
	iters: 600, epoch: 1 | loss: 0.3112502
	speed: 0.0425s/iter; left time: 353.7496s
	iters: 700, epoch: 1 | loss: 0.2473065
	speed: 0.0423s/iter; left time: 347.9740s
	iters: 800, epoch: 1 | loss: 0.2575147
	speed: 0.0423s/iter; left time: 344.3299s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.09s
Steps: 893 | Train Loss: 0.3743255 Vali Loss: 0.4390815 Test Loss: 0.4765824
Validation loss decreased (inf --> 0.439081).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3144976
	speed: 0.1532s/iter; left time: 1216.0693s
	iters: 200, epoch: 2 | loss: 0.2808562
	speed: 0.0424s/iter; left time: 332.0637s
	iters: 300, epoch: 2 | loss: 0.2744709
	speed: 0.0425s/iter; left time: 328.6438s
	iters: 400, epoch: 2 | loss: 0.3588106
	speed: 0.0424s/iter; left time: 323.6192s
	iters: 500, epoch: 2 | loss: 0.3180828
	speed: 0.0423s/iter; left time: 318.8200s
	iters: 600, epoch: 2 | loss: 0.2916528
	speed: 0.0424s/iter; left time: 315.2543s
	iters: 700, epoch: 2 | loss: 0.2639987
	speed: 0.0425s/iter; left time: 311.7480s
	iters: 800, epoch: 2 | loss: 0.3295977
	speed: 0.0425s/iter; left time: 307.3230s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.3134294 Vali Loss: 0.4065219 Test Loss: 0.4498437
Validation loss decreased (0.439081 --> 0.406522).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2422723
	speed: 0.1536s/iter; left time: 1082.1756s
	iters: 200, epoch: 3 | loss: 0.2763481
	speed: 0.0423s/iter; left time: 293.5784s
	iters: 300, epoch: 3 | loss: 0.2693237
	speed: 0.0423s/iter; left time: 289.8415s
	iters: 400, epoch: 3 | loss: 0.3108239
	speed: 0.0424s/iter; left time: 286.2577s
	iters: 500, epoch: 3 | loss: 0.1933685
	speed: 0.0425s/iter; left time: 282.6698s
	iters: 600, epoch: 3 | loss: 0.2856435
	speed: 0.0425s/iter; left time: 278.2216s
	iters: 700, epoch: 3 | loss: 0.2616338
	speed: 0.0425s/iter; left time: 273.5982s
	iters: 800, epoch: 3 | loss: 0.2869773
	speed: 0.0424s/iter; left time: 268.8112s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.2774806 Vali Loss: 0.4149170 Test Loss: 0.4646415
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3248570
	speed: 0.1508s/iter; left time: 928.0265s
	iters: 200, epoch: 4 | loss: 0.2699777
	speed: 0.0423s/iter; left time: 255.9761s
	iters: 300, epoch: 4 | loss: 0.2988690
	speed: 0.0424s/iter; left time: 252.1062s
	iters: 400, epoch: 4 | loss: 0.2862901
	speed: 0.0424s/iter; left time: 248.3990s
	iters: 500, epoch: 4 | loss: 0.2651158
	speed: 0.0423s/iter; left time: 243.5503s
	iters: 600, epoch: 4 | loss: 0.2613765
	speed: 0.0423s/iter; left time: 239.0812s
	iters: 700, epoch: 4 | loss: 0.2783110
	speed: 0.0424s/iter; left time: 235.2375s
	iters: 800, epoch: 4 | loss: 0.2053535
	speed: 0.0423s/iter; left time: 230.5099s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.2820289 Vali Loss: 0.4095885 Test Loss: 0.4661101
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2652097
	speed: 0.1515s/iter; left time: 796.8502s
	iters: 200, epoch: 5 | loss: 0.2383111
	speed: 0.0423s/iter; left time: 218.2376s
	iters: 300, epoch: 5 | loss: 0.2541043
	speed: 0.0423s/iter; left time: 214.1389s
	iters: 400, epoch: 5 | loss: 0.2939530
	speed: 0.0423s/iter; left time: 209.8434s
	iters: 500, epoch: 5 | loss: 0.3624977
	speed: 0.0423s/iter; left time: 205.5906s
	iters: 600, epoch: 5 | loss: 0.2916973
	speed: 0.0424s/iter; left time: 201.8669s
	iters: 700, epoch: 5 | loss: 0.2681513
	speed: 0.0423s/iter; left time: 197.2126s
	iters: 800, epoch: 5 | loss: 0.2681236
	speed: 0.0424s/iter; left time: 193.1918s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.2520440 Vali Loss: 0.4063278 Test Loss: 0.4664033
Validation loss decreased (0.406522 --> 0.406328).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3188669
	speed: 0.1528s/iter; left time: 667.0724s
	iters: 200, epoch: 6 | loss: 0.2008031
	speed: 0.0423s/iter; left time: 180.4956s
	iters: 300, epoch: 6 | loss: 0.2052909
	speed: 0.0423s/iter; left time: 176.3804s
	iters: 400, epoch: 6 | loss: 0.2591189
	speed: 0.0423s/iter; left time: 172.0109s
	iters: 500, epoch: 6 | loss: 0.1943497
	speed: 0.0422s/iter; left time: 167.1677s
	iters: 600, epoch: 6 | loss: 0.2352947
	speed: 0.0422s/iter; left time: 163.0949s
	iters: 700, epoch: 6 | loss: 0.2489737
	speed: 0.0420s/iter; left time: 158.3054s
	iters: 800, epoch: 6 | loss: 0.2547600
	speed: 0.0420s/iter; left time: 153.9780s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.88s
Steps: 893 | Train Loss: 0.2338442 Vali Loss: 0.4190404 Test Loss: 0.4860373
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2307729
	speed: 0.1512s/iter; left time: 525.1738s
	iters: 200, epoch: 7 | loss: 0.3084017
	speed: 0.0423s/iter; left time: 142.6637s
	iters: 300, epoch: 7 | loss: 0.2080216
	speed: 0.0423s/iter; left time: 138.4167s
	iters: 400, epoch: 7 | loss: 0.2292389
	speed: 0.0423s/iter; left time: 134.1549s
	iters: 500, epoch: 7 | loss: 0.1513019
	speed: 0.0423s/iter; left time: 130.1379s
	iters: 600, epoch: 7 | loss: 0.1729813
	speed: 0.0423s/iter; left time: 125.8568s
	iters: 700, epoch: 7 | loss: 0.1880350
	speed: 0.0424s/iter; left time: 121.7990s
	iters: 800, epoch: 7 | loss: 0.1786184
	speed: 0.0423s/iter; left time: 117.4291s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.2103385 Vali Loss: 0.4527536 Test Loss: 0.5490917
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.1798774
	speed: 0.1514s/iter; left time: 390.7379s
	iters: 200, epoch: 8 | loss: 0.1682350
	speed: 0.0423s/iter; left time: 105.0200s
	iters: 300, epoch: 8 | loss: 0.1307397
	speed: 0.0425s/iter; left time: 101.0480s
	iters: 400, epoch: 8 | loss: 0.2033289
	speed: 0.0423s/iter; left time: 96.4256s
	iters: 500, epoch: 8 | loss: 0.1776353
	speed: 0.0423s/iter; left time: 92.1877s
	iters: 600, epoch: 8 | loss: 0.1967961
	speed: 0.0423s/iter; left time: 88.0449s
	iters: 700, epoch: 8 | loss: 0.1893690
	speed: 0.0423s/iter; left time: 83.8084s
	iters: 800, epoch: 8 | loss: 0.1618215
	speed: 0.0423s/iter; left time: 79.5701s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.1851797 Vali Loss: 0.4516812 Test Loss: 0.5370039
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.4664033055305481, rmse:0.6829372644424438, mae:0.4505856931209564, rse:0.5405017137527466
Original data scale mse:17762658.0, rmse:4214.57666015625, mae:2639.203857421875, rse:0.20955726504325867

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7372616
	speed: 0.0670s/iter; left time: 590.5372s
	iters: 200, epoch: 1 | loss: 0.5333896
	speed: 0.0427s/iter; left time: 371.7987s
	iters: 300, epoch: 1 | loss: 0.5598907
	speed: 0.0429s/iter; left time: 369.0281s
	iters: 400, epoch: 1 | loss: 0.4729436
	speed: 0.0427s/iter; left time: 363.5738s
	iters: 500, epoch: 1 | loss: 0.5560483
	speed: 0.0428s/iter; left time: 359.5714s
	iters: 600, epoch: 1 | loss: 0.4819749
	speed: 0.0427s/iter; left time: 355.0414s
	iters: 700, epoch: 1 | loss: 0.5415132
	speed: 0.0427s/iter; left time: 350.7844s
	iters: 800, epoch: 1 | loss: 0.6243510
	speed: 0.0428s/iter; left time: 347.0955s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.47s
Steps: 891 | Train Loss: 0.5668236 Vali Loss: 0.6507477 Test Loss: 0.7603212
Validation loss decreased (inf --> 0.650748).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5540779
	speed: 0.1520s/iter; left time: 1203.6075s
	iters: 200, epoch: 2 | loss: 0.4847487
	speed: 0.0428s/iter; left time: 334.7597s
	iters: 300, epoch: 2 | loss: 0.4586814
	speed: 0.0428s/iter; left time: 330.5472s
	iters: 400, epoch: 2 | loss: 0.5438913
	speed: 0.0427s/iter; left time: 325.4002s
	iters: 500, epoch: 2 | loss: 0.4111202
	speed: 0.0428s/iter; left time: 321.4945s
	iters: 600, epoch: 2 | loss: 0.3895184
	speed: 0.0427s/iter; left time: 316.8562s
	iters: 700, epoch: 2 | loss: 0.3883051
	speed: 0.0427s/iter; left time: 312.7519s
	iters: 800, epoch: 2 | loss: 0.5433491
	speed: 0.0427s/iter; left time: 308.4782s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.24s
Steps: 891 | Train Loss: 0.5033157 Vali Loss: 0.6297555 Test Loss: 0.7439358
Validation loss decreased (0.650748 --> 0.629755).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4145484
	speed: 0.1531s/iter; left time: 1076.0209s
	iters: 200, epoch: 3 | loss: 0.4595998
	speed: 0.0428s/iter; left time: 296.6672s
	iters: 300, epoch: 3 | loss: 0.4619078
	speed: 0.0427s/iter; left time: 291.7835s
	iters: 400, epoch: 3 | loss: 0.4526187
	speed: 0.0427s/iter; left time: 287.4733s
	iters: 500, epoch: 3 | loss: 0.4454547
	speed: 0.0428s/iter; left time: 283.4371s
	iters: 600, epoch: 3 | loss: 0.3692695
	speed: 0.0426s/iter; left time: 278.4322s
	iters: 700, epoch: 3 | loss: 0.4703220
	speed: 0.0427s/iter; left time: 274.5120s
	iters: 800, epoch: 3 | loss: 0.3812272
	speed: 0.0428s/iter; left time: 270.8899s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.4455938 Vali Loss: 0.6881084 Test Loss: 0.8548705
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4174319
	speed: 0.1502s/iter; left time: 921.8349s
	iters: 200, epoch: 4 | loss: 0.4014978
	speed: 0.0426s/iter; left time: 257.2844s
	iters: 300, epoch: 4 | loss: 0.4054119
	speed: 0.0427s/iter; left time: 253.3398s
	iters: 400, epoch: 4 | loss: 0.3589748
	speed: 0.0427s/iter; left time: 249.2604s
	iters: 500, epoch: 4 | loss: 0.3653719
	speed: 0.0427s/iter; left time: 245.0993s
	iters: 600, epoch: 4 | loss: 0.3618014
	speed: 0.0427s/iter; left time: 240.9776s
	iters: 700, epoch: 4 | loss: 0.3188422
	speed: 0.0427s/iter; left time: 236.5605s
	iters: 800, epoch: 4 | loss: 0.2926117
	speed: 0.0427s/iter; left time: 232.2316s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.16s
Steps: 891 | Train Loss: 0.3568448 Vali Loss: 0.7477230 Test Loss: 0.9618957
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2811221
	speed: 0.1508s/iter; left time: 791.3091s
	iters: 200, epoch: 5 | loss: 0.2773483
	speed: 0.0427s/iter; left time: 219.8007s
	iters: 300, epoch: 5 | loss: 0.3285968
	speed: 0.0427s/iter; left time: 215.6158s
	iters: 400, epoch: 5 | loss: 0.2673545
	speed: 0.0427s/iter; left time: 211.2512s
	iters: 500, epoch: 5 | loss: 0.2493921
	speed: 0.0427s/iter; left time: 207.0348s
	iters: 600, epoch: 5 | loss: 0.2386115
	speed: 0.0427s/iter; left time: 202.6892s
	iters: 700, epoch: 5 | loss: 0.2263911
	speed: 0.0427s/iter; left time: 198.4134s
	iters: 800, epoch: 5 | loss: 0.1957354
	speed: 0.0427s/iter; left time: 194.1377s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.19s
Steps: 891 | Train Loss: 0.2605241 Vali Loss: 0.8050478 Test Loss: 0.9919707
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.7439358234405518, rmse:0.8625171184539795, mae:0.6113150119781494, rse:0.6840823292732239
Original data scale mse:30875704.0, rmse:5556.5908203125, mae:3633.89697265625, rse:0.27672022581100464
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5473459
	speed: 0.0440s/iter; left time: 387.7336s
	iters: 200, epoch: 1 | loss: 0.4877608
	speed: 0.0428s/iter; left time: 372.4392s
	iters: 300, epoch: 1 | loss: 0.6598209
	speed: 0.0428s/iter; left time: 368.2271s
	iters: 400, epoch: 1 | loss: 0.6614044
	speed: 0.0429s/iter; left time: 364.7257s
	iters: 500, epoch: 1 | loss: 0.4741346
	speed: 0.0427s/iter; left time: 359.2832s
	iters: 600, epoch: 1 | loss: 0.6109210
	speed: 0.0428s/iter; left time: 355.6680s
	iters: 700, epoch: 1 | loss: 0.5352585
	speed: 0.0427s/iter; left time: 350.3490s
	iters: 800, epoch: 1 | loss: 0.5013155
	speed: 0.0427s/iter; left time: 346.3452s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.5658269 Vali Loss: 0.6509469 Test Loss: 0.7612176
Validation loss decreased (inf --> 0.650947).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5183153
	speed: 0.1529s/iter; left time: 1211.1457s
	iters: 200, epoch: 2 | loss: 0.4526019
	speed: 0.0427s/iter; left time: 333.8961s
	iters: 300, epoch: 2 | loss: 0.5071620
	speed: 0.0427s/iter; left time: 329.6108s
	iters: 400, epoch: 2 | loss: 0.4839136
	speed: 0.0426s/iter; left time: 324.8442s
	iters: 500, epoch: 2 | loss: 0.3920006
	speed: 0.0427s/iter; left time: 321.1203s
	iters: 600, epoch: 2 | loss: 0.4868114
	speed: 0.0428s/iter; left time: 317.5724s
	iters: 700, epoch: 2 | loss: 0.5634870
	speed: 0.0427s/iter; left time: 312.2350s
	iters: 800, epoch: 2 | loss: 0.4724952
	speed: 0.0427s/iter; left time: 308.2773s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.21s
Steps: 891 | Train Loss: 0.5043234 Vali Loss: 0.6191998 Test Loss: 0.7726130
Validation loss decreased (0.650947 --> 0.619200).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5086631
	speed: 0.1538s/iter; left time: 1081.2978s
	iters: 200, epoch: 3 | loss: 0.4055051
	speed: 0.0427s/iter; left time: 295.7305s
	iters: 300, epoch: 3 | loss: 0.3720219
	speed: 0.0427s/iter; left time: 291.4443s
	iters: 400, epoch: 3 | loss: 0.4331014
	speed: 0.0427s/iter; left time: 287.2703s
	iters: 500, epoch: 3 | loss: 0.3976127
	speed: 0.0426s/iter; left time: 282.6995s
	iters: 600, epoch: 3 | loss: 0.4022872
	speed: 0.0427s/iter; left time: 278.8334s
	iters: 700, epoch: 3 | loss: 0.4675071
	speed: 0.0427s/iter; left time: 274.2666s
	iters: 800, epoch: 3 | loss: 0.3814891
	speed: 0.0427s/iter; left time: 269.9880s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.23s
Steps: 891 | Train Loss: 0.4320488 Vali Loss: 0.6841762 Test Loss: 0.8737969
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3273250
	speed: 0.1505s/iter; left time: 923.9212s
	iters: 200, epoch: 4 | loss: 0.3400194
	speed: 0.0427s/iter; left time: 257.7144s
	iters: 300, epoch: 4 | loss: 0.3161496
	speed: 0.0426s/iter; left time: 253.1537s
	iters: 400, epoch: 4 | loss: 0.3390466
	speed: 0.0427s/iter; left time: 249.2543s
	iters: 500, epoch: 4 | loss: 0.2879927
	speed: 0.0427s/iter; left time: 244.7857s
	iters: 600, epoch: 4 | loss: 0.3149875
	speed: 0.0430s/iter; left time: 242.4409s
	iters: 700, epoch: 4 | loss: 0.3463651
	speed: 0.0427s/iter; left time: 236.6177s
	iters: 800, epoch: 4 | loss: 0.2761787
	speed: 0.0427s/iter; left time: 232.1485s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.21s
Steps: 891 | Train Loss: 0.3297124 Vali Loss: 0.7400400 Test Loss: 0.9315168
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2692976
	speed: 0.1504s/iter; left time: 789.1331s
	iters: 200, epoch: 5 | loss: 0.2221422
	speed: 0.0427s/iter; left time: 220.0111s
	iters: 300, epoch: 5 | loss: 0.2397722
	speed: 0.0427s/iter; left time: 215.6517s
	iters: 400, epoch: 5 | loss: 0.2549823
	speed: 0.0427s/iter; left time: 211.1870s
	iters: 500, epoch: 5 | loss: 0.2158701
	speed: 0.0427s/iter; left time: 206.9031s
	iters: 600, epoch: 5 | loss: 0.2114049
	speed: 0.0427s/iter; left time: 202.8592s
	iters: 700, epoch: 5 | loss: 0.2200302
	speed: 0.0428s/iter; left time: 198.8283s
	iters: 800, epoch: 5 | loss: 0.2109580
	speed: 0.0426s/iter; left time: 193.8754s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.21s
Steps: 891 | Train Loss: 0.2433385 Vali Loss: 0.7909078 Test Loss: 1.0188278
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.7726126909255981, rmse:0.8789839148521423, mae:0.6244558691978455, rse:0.6971425414085388
Original data scale mse:32792920.0, rmse:5726.51025390625, mae:3746.37841796875, rse:0.28518226742744446

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7546027
	speed: 0.0685s/iter; left time: 601.9188s
	iters: 200, epoch: 1 | loss: 0.6000124
	speed: 0.0434s/iter; left time: 377.0916s
	iters: 300, epoch: 1 | loss: 0.6143029
	speed: 0.0434s/iter; left time: 373.0299s
	iters: 400, epoch: 1 | loss: 0.7047151
	speed: 0.0432s/iter; left time: 367.0263s
	iters: 500, epoch: 1 | loss: 0.6804361
	speed: 0.0433s/iter; left time: 363.1118s
	iters: 600, epoch: 1 | loss: 0.5855610
	speed: 0.0432s/iter; left time: 358.4246s
	iters: 700, epoch: 1 | loss: 0.5702372
	speed: 0.0433s/iter; left time: 354.2754s
	iters: 800, epoch: 1 | loss: 0.5958639
	speed: 0.0433s/iter; left time: 350.2932s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.94s
Steps: 889 | Train Loss: 0.6097435 Vali Loss: 0.6800801 Test Loss: 0.8067515
Validation loss decreased (inf --> 0.680080).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6113356
	speed: 0.1570s/iter; left time: 1240.7043s
	iters: 200, epoch: 2 | loss: 0.4996085
	speed: 0.0434s/iter; left time: 338.6026s
	iters: 300, epoch: 2 | loss: 0.6496976
	speed: 0.0434s/iter; left time: 334.2431s
	iters: 400, epoch: 2 | loss: 0.5307702
	speed: 0.0434s/iter; left time: 329.8440s
	iters: 500, epoch: 2 | loss: 0.5256283
	speed: 0.0433s/iter; left time: 324.4753s
	iters: 600, epoch: 2 | loss: 0.5327381
	speed: 0.0432s/iter; left time: 319.7562s
	iters: 700, epoch: 2 | loss: 0.4570733
	speed: 0.0432s/iter; left time: 315.7967s
	iters: 800, epoch: 2 | loss: 0.5451870
	speed: 0.0433s/iter; left time: 311.4916s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.71s
Steps: 889 | Train Loss: 0.5431589 Vali Loss: 0.6531566 Test Loss: 0.8226323
Validation loss decreased (0.680080 --> 0.653157).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4712646
	speed: 0.1560s/iter; left time: 1094.2592s
	iters: 200, epoch: 3 | loss: 0.4011992
	speed: 0.0432s/iter; left time: 298.3359s
	iters: 300, epoch: 3 | loss: 0.4421045
	speed: 0.0432s/iter; left time: 294.0255s
	iters: 400, epoch: 3 | loss: 0.4903741
	speed: 0.0431s/iter; left time: 289.5582s
	iters: 500, epoch: 3 | loss: 0.4915803
	speed: 0.0431s/iter; left time: 285.1769s
	iters: 600, epoch: 3 | loss: 0.4369896
	speed: 0.0431s/iter; left time: 280.9883s
	iters: 700, epoch: 3 | loss: 0.4332677
	speed: 0.0432s/iter; left time: 276.8598s
	iters: 800, epoch: 3 | loss: 0.3947041
	speed: 0.0432s/iter; left time: 272.8533s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.60s
Steps: 889 | Train Loss: 0.4362630 Vali Loss: 0.7709182 Test Loss: 1.0190653
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3152215
	speed: 0.1524s/iter; left time: 933.1655s
	iters: 200, epoch: 4 | loss: 0.3043053
	speed: 0.0432s/iter; left time: 260.4047s
	iters: 300, epoch: 4 | loss: 0.3607482
	speed: 0.0431s/iter; left time: 255.6109s
	iters: 400, epoch: 4 | loss: 0.3158475
	speed: 0.0432s/iter; left time: 251.3440s
	iters: 500, epoch: 4 | loss: 0.3114798
	speed: 0.0432s/iter; left time: 247.1892s
	iters: 600, epoch: 4 | loss: 0.2569940
	speed: 0.0432s/iter; left time: 243.1016s
	iters: 700, epoch: 4 | loss: 0.2990108
	speed: 0.0433s/iter; left time: 239.1715s
	iters: 800, epoch: 4 | loss: 0.2757485
	speed: 0.0432s/iter; left time: 234.4776s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.61s
Steps: 889 | Train Loss: 0.3139915 Vali Loss: 0.8249027 Test Loss: 1.1139140
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2653311
	speed: 0.1534s/iter; left time: 803.1848s
	iters: 200, epoch: 5 | loss: 0.2252893
	speed: 0.0432s/iter; left time: 221.7956s
	iters: 300, epoch: 5 | loss: 0.2340532
	speed: 0.0432s/iter; left time: 217.7169s
	iters: 400, epoch: 5 | loss: 0.2358732
	speed: 0.0432s/iter; left time: 213.0039s
	iters: 500, epoch: 5 | loss: 0.2421527
	speed: 0.0431s/iter; left time: 208.5055s
	iters: 600, epoch: 5 | loss: 0.2229267
	speed: 0.0431s/iter; left time: 204.2013s
	iters: 700, epoch: 5 | loss: 0.2323525
	speed: 0.0432s/iter; left time: 200.3228s
	iters: 800, epoch: 5 | loss: 0.1996585
	speed: 0.0432s/iter; left time: 195.7359s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.60s
Steps: 889 | Train Loss: 0.2229739 Vali Loss: 0.8824634 Test Loss: 1.1303844
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.8226325511932373, rmse:0.9069909453392029, mae:0.6497392058372498, rse:0.7184973955154419
Original data scale mse:35247892.0, rmse:5936.99365234375, mae:3905.610107421875, rse:0.2958095371723175
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7979063
	speed: 0.0451s/iter; left time: 396.8241s
	iters: 200, epoch: 1 | loss: 0.6841452
	speed: 0.0432s/iter; left time: 375.3620s
	iters: 300, epoch: 1 | loss: 0.7397766
	speed: 0.0432s/iter; left time: 370.8872s
	iters: 400, epoch: 1 | loss: 0.6866934
	speed: 0.0431s/iter; left time: 366.3169s
	iters: 500, epoch: 1 | loss: 0.6043772
	speed: 0.0433s/iter; left time: 363.0868s
	iters: 600, epoch: 1 | loss: 0.4847449
	speed: 0.0434s/iter; left time: 359.8004s
	iters: 700, epoch: 1 | loss: 0.5677136
	speed: 0.0432s/iter; left time: 354.1416s
	iters: 800, epoch: 1 | loss: 0.5065239
	speed: 0.0434s/iter; left time: 351.4464s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.69s
Steps: 889 | Train Loss: 0.6112015 Vali Loss: 0.6771722 Test Loss: 0.8046841
Validation loss decreased (inf --> 0.677172).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6040920
	speed: 0.1561s/iter; left time: 1233.4365s
	iters: 200, epoch: 2 | loss: 0.5640650
	speed: 0.0432s/iter; left time: 336.7035s
	iters: 300, epoch: 2 | loss: 0.5824279
	speed: 0.0433s/iter; left time: 333.2817s
	iters: 400, epoch: 2 | loss: 0.5516443
	speed: 0.0432s/iter; left time: 328.2858s
	iters: 500, epoch: 2 | loss: 0.5464745
	speed: 0.0432s/iter; left time: 324.1682s
	iters: 600, epoch: 2 | loss: 0.5696195
	speed: 0.0432s/iter; left time: 319.6071s
	iters: 700, epoch: 2 | loss: 0.4997825
	speed: 0.0432s/iter; left time: 315.3826s
	iters: 800, epoch: 2 | loss: 0.4807952
	speed: 0.0432s/iter; left time: 310.9324s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.64s
Steps: 889 | Train Loss: 0.5430961 Vali Loss: 0.6961910 Test Loss: 0.8720690
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4384274
	speed: 0.1543s/iter; left time: 1081.8186s
	iters: 200, epoch: 3 | loss: 0.4003488
	speed: 0.0434s/iter; left time: 299.8521s
	iters: 300, epoch: 3 | loss: 0.5147206
	speed: 0.0432s/iter; left time: 294.4050s
	iters: 400, epoch: 3 | loss: 0.5407557
	speed: 0.0432s/iter; left time: 290.0289s
	iters: 500, epoch: 3 | loss: 0.4383535
	speed: 0.0432s/iter; left time: 285.9180s
	iters: 600, epoch: 3 | loss: 0.4661134
	speed: 0.0433s/iter; left time: 282.1961s
	iters: 700, epoch: 3 | loss: 0.4150949
	speed: 0.0433s/iter; left time: 277.7682s
	iters: 800, epoch: 3 | loss: 0.4085022
	speed: 0.0432s/iter; left time: 272.7991s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.4439213 Vali Loss: 0.7267453 Test Loss: 0.9541050
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3798918
	speed: 0.1547s/iter; left time: 947.2197s
	iters: 200, epoch: 4 | loss: 0.3046944
	speed: 0.0432s/iter; left time: 260.1293s
	iters: 300, epoch: 4 | loss: 0.3279685
	speed: 0.0432s/iter; left time: 255.9744s
	iters: 400, epoch: 4 | loss: 0.3203649
	speed: 0.0432s/iter; left time: 251.5670s
	iters: 500, epoch: 4 | loss: 0.3229451
	speed: 0.0430s/iter; left time: 246.2402s
	iters: 600, epoch: 4 | loss: 0.2853895
	speed: 0.0430s/iter; left time: 241.6585s
	iters: 700, epoch: 4 | loss: 0.3258071
	speed: 0.0430s/iter; left time: 237.3710s
	iters: 800, epoch: 4 | loss: 0.3050725
	speed: 0.0430s/iter; left time: 233.3593s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.53s
Steps: 889 | Train Loss: 0.3247702 Vali Loss: 0.8104095 Test Loss: 1.0395817
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.8046845197677612, rmse:0.8970420956611633, mae:0.64595627784729, rse:0.7106161713600159
Original data scale mse:34226872.0, rmse:5850.37353515625, mae:3899.109619140625, rse:0.2914937138557434

=== Starting experiments for loss function: RMSE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.6304526
	speed: 0.0683s/iter; left time: 602.9611s
	iters: 200, epoch: 1 | loss: 0.6647899
	speed: 0.0426s/iter; left time: 371.7983s
	iters: 300, epoch: 1 | loss: 0.5844824
	speed: 0.0424s/iter; left time: 365.9783s
	iters: 400, epoch: 1 | loss: 0.6426585
	speed: 0.0424s/iter; left time: 361.7525s
	iters: 500, epoch: 1 | loss: 0.6155174
	speed: 0.0425s/iter; left time: 358.2786s
	iters: 600, epoch: 1 | loss: 0.6662328
	speed: 0.0425s/iter; left time: 353.9473s
	iters: 700, epoch: 1 | loss: 0.5895321
	speed: 0.0424s/iter; left time: 349.1764s
	iters: 800, epoch: 1 | loss: 0.5740807
	speed: 0.0424s/iter; left time: 344.6121s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.42s
Steps: 893 | Train Loss: 0.6036704 Vali Loss: 0.4339436 Test Loss: 0.4720358
Validation loss decreased (inf --> 0.433944).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6498488
	speed: 0.1531s/iter; left time: 1215.5868s
	iters: 200, epoch: 2 | loss: 0.6380902
	speed: 0.0425s/iter; left time: 332.7322s
	iters: 300, epoch: 2 | loss: 0.5367553
	speed: 0.0424s/iter; left time: 328.2144s
	iters: 400, epoch: 2 | loss: 0.5489156
	speed: 0.0424s/iter; left time: 323.6393s
	iters: 500, epoch: 2 | loss: 0.5260842
	speed: 0.0425s/iter; left time: 320.3660s
	iters: 600, epoch: 2 | loss: 0.5337558
	speed: 0.0423s/iter; left time: 314.5709s
	iters: 700, epoch: 2 | loss: 0.5897491
	speed: 0.0424s/iter; left time: 311.4112s
	iters: 800, epoch: 2 | loss: 0.5088241
	speed: 0.0425s/iter; left time: 307.3364s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.5554133 Vali Loss: 0.4260295 Test Loss: 0.4780068
Validation loss decreased (0.433944 --> 0.426029).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4309910
	speed: 0.1533s/iter; left time: 1079.7285s
	iters: 200, epoch: 3 | loss: 0.5291359
	speed: 0.0423s/iter; left time: 293.7864s
	iters: 300, epoch: 3 | loss: 0.4883050
	speed: 0.0423s/iter; left time: 289.7883s
	iters: 400, epoch: 3 | loss: 0.4879614
	speed: 0.0424s/iter; left time: 286.2550s
	iters: 500, epoch: 3 | loss: 0.4847891
	speed: 0.0424s/iter; left time: 282.0516s
	iters: 600, epoch: 3 | loss: 0.5293490
	speed: 0.0424s/iter; left time: 277.6713s
	iters: 700, epoch: 3 | loss: 0.4065211
	speed: 0.0424s/iter; left time: 273.1066s
	iters: 800, epoch: 3 | loss: 0.5855716
	speed: 0.0424s/iter; left time: 269.1374s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.5231845 Vali Loss: 0.4079853 Test Loss: 0.4513101
Validation loss decreased (0.426029 --> 0.407985).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5018351
	speed: 0.1527s/iter; left time: 939.2845s
	iters: 200, epoch: 4 | loss: 0.4895697
	speed: 0.0424s/iter; left time: 256.6275s
	iters: 300, epoch: 4 | loss: 0.5145022
	speed: 0.0424s/iter; left time: 252.0868s
	iters: 400, epoch: 4 | loss: 0.4483052
	speed: 0.0424s/iter; left time: 248.3293s
	iters: 500, epoch: 4 | loss: 0.6109250
	speed: 0.0424s/iter; left time: 243.7719s
	iters: 600, epoch: 4 | loss: 0.4802767
	speed: 0.0424s/iter; left time: 239.4784s
	iters: 700, epoch: 4 | loss: 0.5246813
	speed: 0.0424s/iter; left time: 235.4710s
	iters: 800, epoch: 4 | loss: 0.5321484
	speed: 0.0423s/iter; left time: 230.7899s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.07s
Steps: 893 | Train Loss: 0.5150838 Vali Loss: 0.4270419 Test Loss: 0.4700336
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4871208
	speed: 0.1525s/iter; left time: 801.8416s
	iters: 200, epoch: 5 | loss: 0.4352125
	speed: 0.0425s/iter; left time: 219.2843s
	iters: 300, epoch: 5 | loss: 0.5049165
	speed: 0.0424s/iter; left time: 214.2495s
	iters: 400, epoch: 5 | loss: 0.4666814
	speed: 0.0424s/iter; left time: 210.3353s
	iters: 500, epoch: 5 | loss: 0.5018875
	speed: 0.0426s/iter; left time: 206.7576s
	iters: 600, epoch: 5 | loss: 0.4701836
	speed: 0.0425s/iter; left time: 202.3015s
	iters: 700, epoch: 5 | loss: 0.5009473
	speed: 0.0424s/iter; left time: 197.7662s
	iters: 800, epoch: 5 | loss: 0.4748931
	speed: 0.0424s/iter; left time: 193.3968s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.16s
Steps: 893 | Train Loss: 0.5074182 Vali Loss: 0.4152391 Test Loss: 0.4634299
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4203286
	speed: 0.1519s/iter; left time: 663.1395s
	iters: 200, epoch: 6 | loss: 0.5329765
	speed: 0.0424s/iter; left time: 180.8140s
	iters: 300, epoch: 6 | loss: 0.4321128
	speed: 0.0422s/iter; left time: 175.9150s
	iters: 400, epoch: 6 | loss: 0.4385991
	speed: 0.0424s/iter; left time: 172.3634s
	iters: 500, epoch: 6 | loss: 0.4512403
	speed: 0.0424s/iter; left time: 168.1754s
	iters: 600, epoch: 6 | loss: 0.4838388
	speed: 0.0425s/iter; left time: 164.1365s
	iters: 700, epoch: 6 | loss: 0.4213574
	speed: 0.0424s/iter; left time: 159.6564s
	iters: 800, epoch: 6 | loss: 0.4768175
	speed: 0.0425s/iter; left time: 155.7236s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.07s
Steps: 893 | Train Loss: 0.4807680 Vali Loss: 0.4451250 Test Loss: 0.4856848
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.45131009817123413, rmse:0.6717962026596069, mae:0.44347333908081055, rse:0.5316842198371887
Original data scale mse:17305828.0, rmse:4160.02734375, mae:2609.172119140625, rse:0.20684495568275452
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7208875
	speed: 0.0446s/iter; left time: 394.2604s
	iters: 200, epoch: 1 | loss: 0.5653324
	speed: 0.0424s/iter; left time: 370.4031s
	iters: 300, epoch: 1 | loss: 0.5747016
	speed: 0.0424s/iter; left time: 366.2074s
	iters: 400, epoch: 1 | loss: 0.5493563
	speed: 0.0424s/iter; left time: 362.0482s
	iters: 500, epoch: 1 | loss: 0.5951235
	speed: 0.0424s/iter; left time: 357.8883s
	iters: 600, epoch: 1 | loss: 0.5839962
	speed: 0.0424s/iter; left time: 353.3596s
	iters: 700, epoch: 1 | loss: 0.5883811
	speed: 0.0426s/iter; left time: 350.4200s
	iters: 800, epoch: 1 | loss: 0.6175978
	speed: 0.0425s/iter; left time: 345.2648s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.17s
Steps: 893 | Train Loss: 0.6029870 Vali Loss: 0.4296014 Test Loss: 0.4724245
Validation loss decreased (inf --> 0.429601).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5956693
	speed: 0.1548s/iter; left time: 1228.5427s
	iters: 200, epoch: 2 | loss: 0.6147557
	speed: 0.0424s/iter; left time: 332.5428s
	iters: 300, epoch: 2 | loss: 0.5424049
	speed: 0.0425s/iter; left time: 328.9423s
	iters: 400, epoch: 2 | loss: 0.5658551
	speed: 0.0424s/iter; left time: 323.7582s
	iters: 500, epoch: 2 | loss: 0.5137780
	speed: 0.0424s/iter; left time: 319.8523s
	iters: 600, epoch: 2 | loss: 0.5194274
	speed: 0.0426s/iter; left time: 316.5765s
	iters: 700, epoch: 2 | loss: 0.4312453
	speed: 0.0424s/iter; left time: 311.0337s
	iters: 800, epoch: 2 | loss: 0.5377391
	speed: 0.0425s/iter; left time: 307.6491s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.21s
Steps: 893 | Train Loss: 0.5573271 Vali Loss: 0.4067231 Test Loss: 0.4517895
Validation loss decreased (0.429601 --> 0.406723).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4817174
	speed: 0.1552s/iter; left time: 1093.4068s
	iters: 200, epoch: 3 | loss: 0.5098557
	speed: 0.0424s/iter; left time: 294.5240s
	iters: 300, epoch: 3 | loss: 0.4692909
	speed: 0.0425s/iter; left time: 290.6536s
	iters: 400, epoch: 3 | loss: 0.4773871
	speed: 0.0425s/iter; left time: 286.4687s
	iters: 500, epoch: 3 | loss: 0.5546513
	speed: 0.0426s/iter; left time: 282.9506s
	iters: 600, epoch: 3 | loss: 0.5032052
	speed: 0.0422s/iter; left time: 276.2888s
	iters: 700, epoch: 3 | loss: 0.4395917
	speed: 0.0428s/iter; left time: 275.6103s
	iters: 800, epoch: 3 | loss: 0.5026121
	speed: 0.0424s/iter; left time: 269.0393s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.19s
Steps: 893 | Train Loss: 0.5239807 Vali Loss: 0.4195922 Test Loss: 0.4513127
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5083061
	speed: 0.1526s/iter; left time: 938.8968s
	iters: 200, epoch: 4 | loss: 0.4650363
	speed: 0.0425s/iter; left time: 256.9514s
	iters: 300, epoch: 4 | loss: 0.4765425
	speed: 0.0424s/iter; left time: 252.5899s
	iters: 400, epoch: 4 | loss: 0.5530409
	speed: 0.0426s/iter; left time: 249.0418s
	iters: 500, epoch: 4 | loss: 0.5370450
	speed: 0.0425s/iter; left time: 244.3009s
	iters: 600, epoch: 4 | loss: 0.6664306
	speed: 0.0425s/iter; left time: 240.1234s
	iters: 700, epoch: 4 | loss: 0.4789167
	speed: 0.0425s/iter; left time: 235.7937s
	iters: 800, epoch: 4 | loss: 0.5579545
	speed: 0.0425s/iter; left time: 231.5205s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.17s
Steps: 893 | Train Loss: 0.5211855 Vali Loss: 0.4197213 Test Loss: 0.4598895
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4809563
	speed: 0.1527s/iter; left time: 802.9587s
	iters: 200, epoch: 5 | loss: 0.4911440
	speed: 0.0425s/iter; left time: 219.3020s
	iters: 300, epoch: 5 | loss: 0.4891045
	speed: 0.0425s/iter; left time: 214.8820s
	iters: 400, epoch: 5 | loss: 0.5189811
	speed: 0.0425s/iter; left time: 210.5983s
	iters: 500, epoch: 5 | loss: 0.4235159
	speed: 0.0424s/iter; left time: 206.1090s
	iters: 600, epoch: 5 | loss: 0.5044044
	speed: 0.0424s/iter; left time: 201.8627s
	iters: 700, epoch: 5 | loss: 0.4964522
	speed: 0.0425s/iter; left time: 198.0154s
	iters: 800, epoch: 5 | loss: 0.5055836
	speed: 0.0427s/iter; left time: 194.4971s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.21s
Steps: 893 | Train Loss: 0.4999788 Vali Loss: 0.4229821 Test Loss: 0.4707361
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.4517894387245178, rmse:0.6721528172492981, mae:0.44926226139068604, rse:0.531966507434845
Original data scale mse:17345650.0, rmse:4164.81103515625, mae:2657.558349609375, rse:0.20708277821540833

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8564085
	speed: 0.0680s/iter; left time: 598.7694s
	iters: 200, epoch: 1 | loss: 0.7276816
	speed: 0.0427s/iter; left time: 372.1279s
	iters: 300, epoch: 1 | loss: 0.7469753
	speed: 0.0428s/iter; left time: 368.4669s
	iters: 400, epoch: 1 | loss: 0.6862437
	speed: 0.0428s/iter; left time: 363.9586s
	iters: 500, epoch: 1 | loss: 0.7447299
	speed: 0.0428s/iter; left time: 359.6042s
	iters: 600, epoch: 1 | loss: 0.6932904
	speed: 0.0428s/iter; left time: 355.4343s
	iters: 700, epoch: 1 | loss: 0.7336010
	speed: 0.0428s/iter; left time: 351.2675s
	iters: 800, epoch: 1 | loss: 0.7876992
	speed: 0.0427s/iter; left time: 346.6676s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.61s
Steps: 891 | Train Loss: 0.7489301 Vali Loss: 0.6496119 Test Loss: 0.7595298
Validation loss decreased (inf --> 0.649612).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7455665
	speed: 0.1529s/iter; left time: 1211.0281s
	iters: 200, epoch: 2 | loss: 0.6923752
	speed: 0.0428s/iter; left time: 334.4074s
	iters: 300, epoch: 2 | loss: 0.6735732
	speed: 0.0428s/iter; left time: 330.3872s
	iters: 400, epoch: 2 | loss: 0.7412770
	speed: 0.0428s/iter; left time: 326.0852s
	iters: 500, epoch: 2 | loss: 0.6404418
	speed: 0.0428s/iter; left time: 321.7587s
	iters: 600, epoch: 2 | loss: 0.6246042
	speed: 0.0428s/iter; left time: 317.6922s
	iters: 700, epoch: 2 | loss: 0.6204208
	speed: 0.0428s/iter; left time: 313.1966s
	iters: 800, epoch: 2 | loss: 0.7364731
	speed: 0.0428s/iter; left time: 309.1296s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.31s
Steps: 891 | Train Loss: 0.7072706 Vali Loss: 0.6384751 Test Loss: 0.7534525
Validation loss decreased (0.649612 --> 0.638475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6394007
	speed: 0.1540s/iter; left time: 1082.3165s
	iters: 200, epoch: 3 | loss: 0.6838906
	speed: 0.0427s/iter; left time: 296.1545s
	iters: 300, epoch: 3 | loss: 0.6923274
	speed: 0.0427s/iter; left time: 291.7429s
	iters: 400, epoch: 3 | loss: 0.6940130
	speed: 0.0427s/iter; left time: 287.3802s
	iters: 500, epoch: 3 | loss: 0.6825750
	speed: 0.0428s/iter; left time: 283.4176s
	iters: 600, epoch: 3 | loss: 0.6074114
	speed: 0.0428s/iter; left time: 279.4834s
	iters: 700, epoch: 3 | loss: 0.6975672
	speed: 0.0427s/iter; left time: 274.6385s
	iters: 800, epoch: 3 | loss: 0.5953272
	speed: 0.0429s/iter; left time: 271.1997s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.6643052 Vali Loss: 0.6965610 Test Loss: 0.8775428
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6318092
	speed: 0.1515s/iter; left time: 929.6129s
	iters: 200, epoch: 4 | loss: 0.6489524
	speed: 0.0428s/iter; left time: 258.2389s
	iters: 300, epoch: 4 | loss: 0.6114253
	speed: 0.0428s/iter; left time: 254.2544s
	iters: 400, epoch: 4 | loss: 0.6083454
	speed: 0.0428s/iter; left time: 250.0377s
	iters: 500, epoch: 4 | loss: 0.5923827
	speed: 0.0428s/iter; left time: 245.5615s
	iters: 600, epoch: 4 | loss: 0.6142623
	speed: 0.0428s/iter; left time: 241.5447s
	iters: 700, epoch: 4 | loss: 0.5633094
	speed: 0.0428s/iter; left time: 237.1731s
	iters: 800, epoch: 4 | loss: 0.5035748
	speed: 0.0427s/iter; left time: 232.4046s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.32s
Steps: 891 | Train Loss: 0.5925956 Vali Loss: 0.7727130 Test Loss: 0.9328302
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5578295
	speed: 0.1509s/iter; left time: 792.0183s
	iters: 200, epoch: 5 | loss: 0.5414807
	speed: 0.0427s/iter; left time: 219.8039s
	iters: 300, epoch: 5 | loss: 0.5636502
	speed: 0.0427s/iter; left time: 215.6220s
	iters: 400, epoch: 5 | loss: 0.5362424
	speed: 0.0427s/iter; left time: 211.3051s
	iters: 500, epoch: 5 | loss: 0.4829004
	speed: 0.0427s/iter; left time: 207.0390s
	iters: 600, epoch: 5 | loss: 0.4771944
	speed: 0.0428s/iter; left time: 203.1562s
	iters: 700, epoch: 5 | loss: 0.4571800
	speed: 0.0428s/iter; left time: 199.0780s
	iters: 800, epoch: 5 | loss: 0.4408690
	speed: 0.0428s/iter; left time: 194.4026s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.25s
Steps: 891 | Train Loss: 0.5061452 Vali Loss: 0.8498826 Test Loss: 0.9658751
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.7534525394439697, rmse:0.8680164217948914, mae:0.6171937584877014, rse:0.6884440183639526
Original data scale mse:31262294.0, rmse:5591.26953125, mae:3673.384033203125, rse:0.2784472107887268
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7373669
	speed: 0.0446s/iter; left time: 392.8948s
	iters: 200, epoch: 1 | loss: 0.6961303
	speed: 0.0427s/iter; left time: 372.2155s
	iters: 300, epoch: 1 | loss: 0.8107926
	speed: 0.0427s/iter; left time: 367.3601s
	iters: 400, epoch: 1 | loss: 0.8115740
	speed: 0.0425s/iter; left time: 361.4023s
	iters: 500, epoch: 1 | loss: 0.6878027
	speed: 0.0426s/iter; left time: 358.4285s
	iters: 600, epoch: 1 | loss: 0.7807432
	speed: 0.0428s/iter; left time: 355.4065s
	iters: 700, epoch: 1 | loss: 0.7302145
	speed: 0.0427s/iter; left time: 350.7357s
	iters: 800, epoch: 1 | loss: 0.7058792
	speed: 0.0428s/iter; left time: 347.2005s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.7482038 Vali Loss: 0.6501760 Test Loss: 0.7607240
Validation loss decreased (inf --> 0.650176).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7201242
	speed: 0.1530s/iter; left time: 1211.3649s
	iters: 200, epoch: 2 | loss: 0.6755181
	speed: 0.0427s/iter; left time: 334.0633s
	iters: 300, epoch: 2 | loss: 0.7100089
	speed: 0.0428s/iter; left time: 330.0868s
	iters: 400, epoch: 2 | loss: 0.6997021
	speed: 0.0428s/iter; left time: 325.8922s
	iters: 500, epoch: 2 | loss: 0.6204954
	speed: 0.0428s/iter; left time: 321.5709s
	iters: 600, epoch: 2 | loss: 0.6984884
	speed: 0.0427s/iter; left time: 316.7871s
	iters: 700, epoch: 2 | loss: 0.7466449
	speed: 0.0427s/iter; left time: 312.8736s
	iters: 800, epoch: 2 | loss: 0.6878006
	speed: 0.0428s/iter; left time: 308.7455s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.7087464 Vali Loss: 0.6216077 Test Loss: 0.7755335
Validation loss decreased (0.650176 --> 0.621608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7080504
	speed: 0.1542s/iter; left time: 1083.7248s
	iters: 200, epoch: 3 | loss: 0.6345065
	speed: 0.0427s/iter; left time: 296.0350s
	iters: 300, epoch: 3 | loss: 0.6015949
	speed: 0.0427s/iter; left time: 291.8595s
	iters: 400, epoch: 3 | loss: 0.6569807
	speed: 0.0428s/iter; left time: 287.9846s
	iters: 500, epoch: 3 | loss: 0.6287000
	speed: 0.0429s/iter; left time: 284.1811s
	iters: 600, epoch: 3 | loss: 0.6277207
	speed: 0.0428s/iter; left time: 279.3057s
	iters: 700, epoch: 3 | loss: 0.6814144
	speed: 0.0428s/iter; left time: 275.0404s
	iters: 800, epoch: 3 | loss: 0.6294596
	speed: 0.0428s/iter; left time: 270.5965s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.30s
Steps: 891 | Train Loss: 0.6558177 Vali Loss: 0.6887955 Test Loss: 0.8492430
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6006249
	speed: 0.1517s/iter; left time: 931.1551s
	iters: 200, epoch: 4 | loss: 0.5826002
	speed: 0.0428s/iter; left time: 258.2005s
	iters: 300, epoch: 4 | loss: 0.5727263
	speed: 0.0428s/iter; left time: 254.3509s
	iters: 400, epoch: 4 | loss: 0.5923206
	speed: 0.0428s/iter; left time: 249.8124s
	iters: 500, epoch: 4 | loss: 0.5391967
	speed: 0.0427s/iter; left time: 245.1838s
	iters: 600, epoch: 4 | loss: 0.5598037
	speed: 0.0427s/iter; left time: 240.8971s
	iters: 700, epoch: 4 | loss: 0.5872183
	speed: 0.0427s/iter; left time: 236.5888s
	iters: 800, epoch: 4 | loss: 0.5201843
	speed: 0.0428s/iter; left time: 232.7306s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.5749528 Vali Loss: 0.7418606 Test Loss: 0.9283234
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5154231
	speed: 0.1517s/iter; left time: 795.9826s
	iters: 200, epoch: 5 | loss: 0.4713488
	speed: 0.0427s/iter; left time: 219.9947s
	iters: 300, epoch: 5 | loss: 0.4894331
	speed: 0.0428s/iter; left time: 215.8808s
	iters: 400, epoch: 5 | loss: 0.4998905
	speed: 0.0427s/iter; left time: 211.4325s
	iters: 500, epoch: 5 | loss: 0.4573486
	speed: 0.0428s/iter; left time: 207.3145s
	iters: 600, epoch: 5 | loss: 0.4486329
	speed: 0.0428s/iter; left time: 202.9889s
	iters: 700, epoch: 5 | loss: 0.4750489
	speed: 0.0428s/iter; left time: 198.6629s
	iters: 800, epoch: 5 | loss: 0.4578401
	speed: 0.0427s/iter; left time: 194.3392s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.28s
Steps: 891 | Train Loss: 0.4898551 Vali Loss: 0.7914582 Test Loss: 0.9788902
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.7755337357521057, rmse:0.880643904209137, mae:0.6255269646644592, rse:0.6984591484069824
Original data scale mse:33044252.0, rmse:5748.4130859375, mae:3757.29541015625, rse:0.2862730324268341

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8679006
	speed: 0.0679s/iter; left time: 597.0260s
	iters: 200, epoch: 1 | loss: 0.7743645
	speed: 0.0433s/iter; left time: 376.1120s
	iters: 300, epoch: 1 | loss: 0.7822117
	speed: 0.0432s/iter; left time: 371.4445s
	iters: 400, epoch: 1 | loss: 0.8378281
	speed: 0.0435s/iter; left time: 369.2035s
	iters: 500, epoch: 1 | loss: 0.8232630
	speed: 0.0433s/iter; left time: 363.1095s
	iters: 600, epoch: 1 | loss: 0.7636237
	speed: 0.0433s/iter; left time: 358.8792s
	iters: 700, epoch: 1 | loss: 0.7548945
	speed: 0.0433s/iter; left time: 354.7984s
	iters: 800, epoch: 1 | loss: 0.7713766
	speed: 0.0433s/iter; left time: 350.1022s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.94s
Steps: 889 | Train Loss: 0.7772274 Vali Loss: 0.6790550 Test Loss: 0.8057779
Validation loss decreased (inf --> 0.679055).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7821077
	speed: 0.1550s/iter; left time: 1224.7803s
	iters: 200, epoch: 2 | loss: 0.7020079
	speed: 0.0434s/iter; left time: 338.3973s
	iters: 300, epoch: 2 | loss: 0.8012208
	speed: 0.0435s/iter; left time: 334.7136s
	iters: 400, epoch: 2 | loss: 0.7271333
	speed: 0.0433s/iter; left time: 329.0446s
	iters: 500, epoch: 2 | loss: 0.7285502
	speed: 0.0433s/iter; left time: 325.2045s
	iters: 600, epoch: 2 | loss: 0.7326428
	speed: 0.0433s/iter; left time: 320.4505s
	iters: 700, epoch: 2 | loss: 0.6793472
	speed: 0.0433s/iter; left time: 316.2541s
	iters: 800, epoch: 2 | loss: 0.7332686
	speed: 0.0433s/iter; left time: 311.9381s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.72s
Steps: 889 | Train Loss: 0.7356485 Vali Loss: 0.6576813 Test Loss: 0.8276157
Validation loss decreased (0.679055 --> 0.657681).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6861941
	speed: 0.1559s/iter; left time: 1093.2852s
	iters: 200, epoch: 3 | loss: 0.6369764
	speed: 0.0434s/iter; left time: 300.2822s
	iters: 300, epoch: 3 | loss: 0.6813426
	speed: 0.0433s/iter; left time: 295.1944s
	iters: 400, epoch: 3 | loss: 0.6887080
	speed: 0.0434s/iter; left time: 291.2259s
	iters: 500, epoch: 3 | loss: 0.7160903
	speed: 0.0433s/iter; left time: 286.5825s
	iters: 600, epoch: 3 | loss: 0.6524235
	speed: 0.0433s/iter; left time: 282.3045s
	iters: 700, epoch: 3 | loss: 0.6551255
	speed: 0.0433s/iter; left time: 277.3797s
	iters: 800, epoch: 3 | loss: 0.6208397
	speed: 0.0432s/iter; left time: 273.0252s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.74s
Steps: 889 | Train Loss: 0.6604352 Vali Loss: 0.7732214 Test Loss: 0.9868738
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5560720
	speed: 0.1521s/iter; left time: 931.1967s
	iters: 200, epoch: 4 | loss: 0.5402793
	speed: 0.0433s/iter; left time: 260.7411s
	iters: 300, epoch: 4 | loss: 0.6283324
	speed: 0.0433s/iter; left time: 256.3194s
	iters: 400, epoch: 4 | loss: 0.5678048
	speed: 0.0433s/iter; left time: 252.1106s
	iters: 500, epoch: 4 | loss: 0.5673718
	speed: 0.0433s/iter; left time: 247.9093s
	iters: 600, epoch: 4 | loss: 0.5018236
	speed: 0.0433s/iter; left time: 243.5630s
	iters: 700, epoch: 4 | loss: 0.5377899
	speed: 0.0433s/iter; left time: 239.4047s
	iters: 800, epoch: 4 | loss: 0.5352262
	speed: 0.0434s/iter; left time: 235.3983s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.68s
Steps: 889 | Train Loss: 0.5602547 Vali Loss: 0.7991609 Test Loss: 1.1161594
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5087005
	speed: 0.1530s/iter; left time: 800.7100s
	iters: 200, epoch: 5 | loss: 0.4705424
	speed: 0.0433s/iter; left time: 222.3024s
	iters: 300, epoch: 5 | loss: 0.4730842
	speed: 0.0434s/iter; left time: 218.5353s
	iters: 400, epoch: 5 | loss: 0.4877660
	speed: 0.0433s/iter; left time: 213.8698s
	iters: 500, epoch: 5 | loss: 0.4700000
	speed: 0.0434s/iter; left time: 209.7451s
	iters: 600, epoch: 5 | loss: 0.4700326
	speed: 0.0433s/iter; left time: 204.9263s
	iters: 700, epoch: 5 | loss: 0.4628400
	speed: 0.0434s/iter; left time: 201.0596s
	iters: 800, epoch: 5 | loss: 0.4603879
	speed: 0.0433s/iter; left time: 196.4808s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.71s
Steps: 889 | Train Loss: 0.4696992 Vali Loss: 0.8641824 Test Loss: 1.1385818
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.8276155591011047, rmse:0.909733772277832, mae:0.6518822908401489, rse:0.7206702828407288
Original data scale mse:35287100.0, rmse:5940.29443359375, mae:3912.64697265625, rse:0.2959740161895752
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8919598
	speed: 0.0449s/iter; left time: 394.7934s
	iters: 200, epoch: 1 | loss: 0.8255026
	speed: 0.0432s/iter; left time: 375.7960s
	iters: 300, epoch: 1 | loss: 0.8588480
	speed: 0.0432s/iter; left time: 371.0216s
	iters: 400, epoch: 1 | loss: 0.8268682
	speed: 0.0433s/iter; left time: 367.3549s
	iters: 500, epoch: 1 | loss: 0.7757027
	speed: 0.0433s/iter; left time: 362.9946s
	iters: 600, epoch: 1 | loss: 0.6946961
	speed: 0.0433s/iter; left time: 359.0086s
	iters: 700, epoch: 1 | loss: 0.7522021
	speed: 0.0433s/iter; left time: 354.6110s
	iters: 800, epoch: 1 | loss: 0.7110764
	speed: 0.0433s/iter; left time: 350.2308s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.67s
Steps: 889 | Train Loss: 0.7784579 Vali Loss: 0.6762899 Test Loss: 0.8039310
Validation loss decreased (inf --> 0.676290).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7776949
	speed: 0.1558s/iter; left time: 1230.8541s
	iters: 200, epoch: 2 | loss: 0.7495913
	speed: 0.0433s/iter; left time: 338.1045s
	iters: 300, epoch: 2 | loss: 0.7632322
	speed: 0.0432s/iter; left time: 333.0286s
	iters: 400, epoch: 2 | loss: 0.7406695
	speed: 0.0433s/iter; left time: 329.1651s
	iters: 500, epoch: 2 | loss: 0.7516730
	speed: 0.0432s/iter; left time: 324.3799s
	iters: 600, epoch: 2 | loss: 0.7519017
	speed: 0.0433s/iter; left time: 320.4085s
	iters: 700, epoch: 2 | loss: 0.7013571
	speed: 0.0433s/iter; left time: 316.3720s
	iters: 800, epoch: 2 | loss: 0.6977748
	speed: 0.0433s/iter; left time: 311.8371s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.68s
Steps: 889 | Train Loss: 0.7361888 Vali Loss: 0.6949371 Test Loss: 0.8629977
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6662261
	speed: 0.1525s/iter; left time: 1069.2643s
	iters: 200, epoch: 3 | loss: 0.6339747
	speed: 0.0433s/iter; left time: 299.5387s
	iters: 300, epoch: 3 | loss: 0.7117482
	speed: 0.0433s/iter; left time: 294.7726s
	iters: 400, epoch: 3 | loss: 0.7264873
	speed: 0.0433s/iter; left time: 290.5272s
	iters: 500, epoch: 3 | loss: 0.6518920
	speed: 0.0434s/iter; left time: 286.7612s
	iters: 600, epoch: 3 | loss: 0.6870541
	speed: 0.0433s/iter; left time: 282.0510s
	iters: 700, epoch: 3 | loss: 0.6374604
	speed: 0.0434s/iter; left time: 278.2254s
	iters: 800, epoch: 3 | loss: 0.6561266
	speed: 0.0434s/iter; left time: 273.7489s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.6618887 Vali Loss: 0.7081003 Test Loss: 0.9726987
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6204436
	speed: 0.1539s/iter; left time: 942.5101s
	iters: 200, epoch: 4 | loss: 0.5560814
	speed: 0.0433s/iter; left time: 260.8545s
	iters: 300, epoch: 4 | loss: 0.5717813
	speed: 0.0432s/iter; left time: 256.1611s
	iters: 400, epoch: 4 | loss: 0.5512108
	speed: 0.0433s/iter; left time: 251.9285s
	iters: 500, epoch: 4 | loss: 0.5558363
	speed: 0.0435s/iter; left time: 248.7970s
	iters: 600, epoch: 4 | loss: 0.5101167
	speed: 0.0433s/iter; left time: 243.5595s
	iters: 700, epoch: 4 | loss: 0.5733330
	speed: 0.0433s/iter; left time: 239.1401s
	iters: 800, epoch: 4 | loss: 0.5397598
	speed: 0.0433s/iter; left time: 234.7837s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.67s
Steps: 889 | Train Loss: 0.5612400 Vali Loss: 0.7595485 Test Loss: 1.0782422
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.8039314150810242, rmse:0.8966222405433655, mae:0.6451408863067627, rse:0.7102835774421692
Original data scale mse:34170808.0, rmse:5845.580078125, mae:3891.957763671875, rse:0.2912548780441284

=== Starting experiments for loss function: MAE ===


=== Starting experiments for pred_len: 24 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4695036
	speed: 0.0677s/iter; left time: 597.7402s
	iters: 200, epoch: 1 | loss: 0.4849952
	speed: 0.0426s/iter; left time: 371.9770s
	iters: 300, epoch: 1 | loss: 0.4187118
	speed: 0.0427s/iter; left time: 368.5911s
	iters: 400, epoch: 1 | loss: 0.4342759
	speed: 0.0424s/iter; left time: 362.0456s
	iters: 500, epoch: 1 | loss: 0.4137512
	speed: 0.0424s/iter; left time: 357.4461s
	iters: 600, epoch: 1 | loss: 0.4539363
	speed: 0.0424s/iter; left time: 352.9844s
	iters: 700, epoch: 1 | loss: 0.4049172
	speed: 0.0424s/iter; left time: 349.1495s
	iters: 800, epoch: 1 | loss: 0.3974779
	speed: 0.0426s/iter; left time: 346.1173s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.44s
Steps: 893 | Train Loss: 0.4296926 Vali Loss: 0.4422245 Test Loss: 0.4514492
Validation loss decreased (inf --> 0.442224).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4751551
	speed: 0.1525s/iter; left time: 1210.6738s
	iters: 200, epoch: 2 | loss: 0.4530021
	speed: 0.0424s/iter; left time: 332.3615s
	iters: 300, epoch: 2 | loss: 0.3882786
	speed: 0.0424s/iter; left time: 327.8379s
	iters: 400, epoch: 2 | loss: 0.4140501
	speed: 0.0424s/iter; left time: 323.5683s
	iters: 500, epoch: 2 | loss: 0.3746513
	speed: 0.0424s/iter; left time: 319.7359s
	iters: 600, epoch: 2 | loss: 0.3730287
	speed: 0.0423s/iter; left time: 314.9048s
	iters: 700, epoch: 2 | loss: 0.4009704
	speed: 0.0424s/iter; left time: 311.0437s
	iters: 800, epoch: 2 | loss: 0.3358727
	speed: 0.0424s/iter; left time: 307.2041s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.3956892 Vali Loss: 0.4311240 Test Loss: 0.4466510
Validation loss decreased (0.442224 --> 0.431124).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2904167
	speed: 0.1537s/iter; left time: 1082.8511s
	iters: 200, epoch: 3 | loss: 0.3576709
	speed: 0.0424s/iter; left time: 294.3742s
	iters: 300, epoch: 3 | loss: 0.3403774
	speed: 0.0423s/iter; left time: 289.4606s
	iters: 400, epoch: 3 | loss: 0.3329291
	speed: 0.0424s/iter; left time: 285.7193s
	iters: 500, epoch: 3 | loss: 0.3230645
	speed: 0.0424s/iter; left time: 281.5820s
	iters: 600, epoch: 3 | loss: 0.3635491
	speed: 0.0424s/iter; left time: 277.2735s
	iters: 700, epoch: 3 | loss: 0.2835732
	speed: 0.0423s/iter; left time: 272.9224s
	iters: 800, epoch: 3 | loss: 0.3851331
	speed: 0.0424s/iter; left time: 269.1206s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.3495539 Vali Loss: 0.4219367 Test Loss: 0.4352997
Validation loss decreased (0.431124 --> 0.421937).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3447823
	speed: 0.1539s/iter; left time: 946.7996s
	iters: 200, epoch: 4 | loss: 0.3190766
	speed: 0.0424s/iter; left time: 256.7966s
	iters: 300, epoch: 4 | loss: 0.3549941
	speed: 0.0424s/iter; left time: 252.1900s
	iters: 400, epoch: 4 | loss: 0.2950929
	speed: 0.0423s/iter; left time: 247.8224s
	iters: 500, epoch: 4 | loss: 0.4276862
	speed: 0.0423s/iter; left time: 243.5792s
	iters: 600, epoch: 4 | loss: 0.3246305
	speed: 0.0424s/iter; left time: 239.7012s
	iters: 700, epoch: 4 | loss: 0.3205589
	speed: 0.0424s/iter; left time: 235.2304s
	iters: 800, epoch: 4 | loss: 0.3858584
	speed: 0.0424s/iter; left time: 231.2089s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.3416200 Vali Loss: 0.4134573 Test Loss: 0.4247172
Validation loss decreased (0.421937 --> 0.413457).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3319281
	speed: 0.1539s/iter; left time: 809.3437s
	iters: 200, epoch: 5 | loss: 0.2934890
	speed: 0.0424s/iter; left time: 218.5093s
	iters: 300, epoch: 5 | loss: 0.3355778
	speed: 0.0423s/iter; left time: 214.0601s
	iters: 400, epoch: 5 | loss: 0.3117720
	speed: 0.0424s/iter; left time: 210.0868s
	iters: 500, epoch: 5 | loss: 0.3203244
	speed: 0.0424s/iter; left time: 205.8614s
	iters: 600, epoch: 5 | loss: 0.2914104
	speed: 0.0424s/iter; left time: 201.7048s
	iters: 700, epoch: 5 | loss: 0.3308161
	speed: 0.0424s/iter; left time: 197.4604s
	iters: 800, epoch: 5 | loss: 0.3173711
	speed: 0.0425s/iter; left time: 193.5303s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.06s
Steps: 893 | Train Loss: 0.3343107 Vali Loss: 0.4109769 Test Loss: 0.4230208
Validation loss decreased (0.413457 --> 0.410977).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2896678
	speed: 0.1526s/iter; left time: 666.3155s
	iters: 200, epoch: 6 | loss: 0.3515523
	speed: 0.0424s/iter; left time: 180.7143s
	iters: 300, epoch: 6 | loss: 0.3070067
	speed: 0.0423s/iter; left time: 176.3146s
	iters: 400, epoch: 6 | loss: 0.2854919
	speed: 0.0424s/iter; left time: 172.3742s
	iters: 500, epoch: 6 | loss: 0.3352777
	speed: 0.0423s/iter; left time: 167.9545s
	iters: 600, epoch: 6 | loss: 0.3287666
	speed: 0.0424s/iter; left time: 163.8867s
	iters: 700, epoch: 6 | loss: 0.2857096
	speed: 0.0424s/iter; left time: 159.7712s
	iters: 800, epoch: 6 | loss: 0.3255485
	speed: 0.0424s/iter; left time: 155.2943s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.3294495 Vali Loss: 0.4255356 Test Loss: 0.4324502
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3365586
	speed: 0.1510s/iter; left time: 524.5512s
	iters: 200, epoch: 7 | loss: 0.3124640
	speed: 0.0425s/iter; left time: 143.2186s
	iters: 300, epoch: 7 | loss: 0.3412698
	speed: 0.0423s/iter; left time: 138.4806s
	iters: 400, epoch: 7 | loss: 0.3270743
	speed: 0.0424s/iter; left time: 134.5114s
	iters: 500, epoch: 7 | loss: 0.3453423
	speed: 0.0421s/iter; left time: 129.4667s
	iters: 600, epoch: 7 | loss: 0.3201989
	speed: 0.0421s/iter; left time: 125.1563s
	iters: 700, epoch: 7 | loss: 0.2999701
	speed: 0.0424s/iter; left time: 121.8284s
	iters: 800, epoch: 7 | loss: 0.3040497
	speed: 0.0425s/iter; left time: 117.9124s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.3237632 Vali Loss: 0.4205632 Test Loss: 0.4347714
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3042686
	speed: 0.1510s/iter; left time: 389.6832s
	iters: 200, epoch: 8 | loss: 0.3169928
	speed: 0.0423s/iter; left time: 105.0182s
	iters: 300, epoch: 8 | loss: 0.2797357
	speed: 0.0423s/iter; left time: 100.7148s
	iters: 400, epoch: 8 | loss: 0.3393894
	speed: 0.0423s/iter; left time: 96.5069s
	iters: 500, epoch: 8 | loss: 0.3562687
	speed: 0.0423s/iter; left time: 92.1845s
	iters: 600, epoch: 8 | loss: 0.2649100
	speed: 0.0423s/iter; left time: 88.0785s
	iters: 700, epoch: 8 | loss: 0.3125881
	speed: 0.0424s/iter; left time: 83.9210s
	iters: 800, epoch: 8 | loss: 0.3596777
	speed: 0.0424s/iter; left time: 79.6677s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.99s
Steps: 893 | Train Loss: 0.3133540 Vali Loss: 0.4209787 Test Loss: 0.4364639
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.4612430930137634, rmse:0.67914879322052, mae:0.42302075028419495, rse:0.5375033617019653
Original data scale mse:17183404.0, rmse:4145.287109375, mae:2456.189453125, rse:0.20611201226711273
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4739339
	speed: 0.0440s/iter; left time: 388.8090s
	iters: 200, epoch: 1 | loss: 0.4540531
	speed: 0.0424s/iter; left time: 369.7961s
	iters: 300, epoch: 1 | loss: 0.3691141
	speed: 0.0424s/iter; left time: 365.9028s
	iters: 400, epoch: 1 | loss: 0.3733300
	speed: 0.0423s/iter; left time: 361.0668s
	iters: 500, epoch: 1 | loss: 0.3640547
	speed: 0.0424s/iter; left time: 357.5223s
	iters: 600, epoch: 1 | loss: 0.3699769
	speed: 0.0424s/iter; left time: 353.0969s
	iters: 700, epoch: 1 | loss: 0.3467535
	speed: 0.0424s/iter; left time: 348.8939s
	iters: 800, epoch: 1 | loss: 0.3464169
	speed: 0.0424s/iter; left time: 344.4607s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.4279929 Vali Loss: 0.4427081 Test Loss: 0.4532785
Validation loss decreased (inf --> 0.442708).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4089020
	speed: 0.1550s/iter; left time: 1230.0104s
	iters: 200, epoch: 2 | loss: 0.3849083
	speed: 0.0425s/iter; left time: 332.7663s
	iters: 300, epoch: 2 | loss: 0.3607240
	speed: 0.0426s/iter; left time: 329.8853s
	iters: 400, epoch: 2 | loss: 0.4332860
	speed: 0.0426s/iter; left time: 325.0105s
	iters: 500, epoch: 2 | loss: 0.3553748
	speed: 0.0426s/iter; left time: 321.0306s
	iters: 600, epoch: 2 | loss: 0.3558212
	speed: 0.0426s/iter; left time: 316.4920s
	iters: 700, epoch: 2 | loss: 0.3483924
	speed: 0.0425s/iter; left time: 311.8307s
	iters: 800, epoch: 2 | loss: 0.3718648
	speed: 0.0424s/iter; left time: 307.2120s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.26s
Steps: 893 | Train Loss: 0.3910895 Vali Loss: 0.4320702 Test Loss: 0.4399559
Validation loss decreased (0.442708 --> 0.432070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3337142
	speed: 0.1540s/iter; left time: 1084.9239s
	iters: 200, epoch: 3 | loss: 0.3450969
	speed: 0.0424s/iter; left time: 294.5996s
	iters: 300, epoch: 3 | loss: 0.3313186
	speed: 0.0424s/iter; left time: 290.4464s
	iters: 400, epoch: 3 | loss: 0.3627611
	speed: 0.0426s/iter; left time: 287.5233s
	iters: 500, epoch: 3 | loss: 0.3072940
	speed: 0.0426s/iter; left time: 282.9629s
	iters: 600, epoch: 3 | loss: 0.3159499
	speed: 0.0424s/iter; left time: 277.3633s
	iters: 700, epoch: 3 | loss: 0.3433414
	speed: 0.0425s/iter; left time: 273.7528s
	iters: 800, epoch: 3 | loss: 0.3504495
	speed: 0.0424s/iter; left time: 268.8622s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.14s
Steps: 893 | Train Loss: 0.3478101 Vali Loss: 0.4106736 Test Loss: 0.4247069
Validation loss decreased (0.432070 --> 0.410674).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3664916
	speed: 0.1534s/iter; left time: 943.9890s
	iters: 200, epoch: 4 | loss: 0.3556045
	speed: 0.0425s/iter; left time: 257.0485s
	iters: 300, epoch: 4 | loss: 0.3436058
	speed: 0.0424s/iter; left time: 252.1175s
	iters: 400, epoch: 4 | loss: 0.3065186
	speed: 0.0424s/iter; left time: 248.2914s
	iters: 500, epoch: 4 | loss: 0.3289182
	speed: 0.0423s/iter; left time: 243.5285s
	iters: 600, epoch: 4 | loss: 0.3316960
	speed: 0.0424s/iter; left time: 239.5950s
	iters: 700, epoch: 4 | loss: 0.3341659
	speed: 0.0425s/iter; left time: 235.9053s
	iters: 800, epoch: 4 | loss: 0.2980278
	speed: 0.0425s/iter; left time: 231.4593s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.13s
Steps: 893 | Train Loss: 0.3400171 Vali Loss: 0.4142010 Test Loss: 0.4281743
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3242514
	speed: 0.1518s/iter; left time: 798.4761s
	iters: 200, epoch: 5 | loss: 0.3074272
	speed: 0.0426s/iter; left time: 219.9973s
	iters: 300, epoch: 5 | loss: 0.3388836
	speed: 0.0426s/iter; left time: 215.2733s
	iters: 400, epoch: 5 | loss: 0.3729826
	speed: 0.0425s/iter; left time: 210.7732s
	iters: 500, epoch: 5 | loss: 0.4128991
	speed: 0.0426s/iter; left time: 207.0960s
	iters: 600, epoch: 5 | loss: 0.3496001
	speed: 0.0427s/iter; left time: 203.1897s
	iters: 700, epoch: 5 | loss: 0.3578146
	speed: 0.0426s/iter; left time: 198.5819s
	iters: 800, epoch: 5 | loss: 0.3022088
	speed: 0.0426s/iter; left time: 194.3290s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.28s
Steps: 893 | Train Loss: 0.3320721 Vali Loss: 0.4036397 Test Loss: 0.4186656
Validation loss decreased (0.410674 --> 0.403640).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3790839
	speed: 0.1552s/iter; left time: 677.4648s
	iters: 200, epoch: 6 | loss: 0.2824487
	speed: 0.0424s/iter; left time: 180.9843s
	iters: 300, epoch: 6 | loss: 0.3130301
	speed: 0.0425s/iter; left time: 177.2606s
	iters: 400, epoch: 6 | loss: 0.3765152
	speed: 0.0424s/iter; left time: 172.3570s
	iters: 500, epoch: 6 | loss: 0.2899759
	speed: 0.0425s/iter; left time: 168.5191s
	iters: 600, epoch: 6 | loss: 0.3341354
	speed: 0.0425s/iter; left time: 164.1625s
	iters: 700, epoch: 6 | loss: 0.3467826
	speed: 0.0425s/iter; left time: 160.1688s
	iters: 800, epoch: 6 | loss: 0.3329554
	speed: 0.0425s/iter; left time: 155.9498s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.18s
Steps: 893 | Train Loss: 0.3288571 Vali Loss: 0.4075786 Test Loss: 0.4223005
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3471135
	speed: 0.1524s/iter; left time: 529.1976s
	iters: 200, epoch: 7 | loss: 0.3624613
	speed: 0.0425s/iter; left time: 143.2853s
	iters: 300, epoch: 7 | loss: 0.3461682
	speed: 0.0425s/iter; left time: 138.9486s
	iters: 400, epoch: 7 | loss: 0.3192582
	speed: 0.0426s/iter; left time: 135.0798s
	iters: 500, epoch: 7 | loss: 0.2862870
	speed: 0.0427s/iter; left time: 131.3159s
	iters: 600, epoch: 7 | loss: 0.3154697
	speed: 0.0427s/iter; left time: 126.8909s
	iters: 700, epoch: 7 | loss: 0.3064333
	speed: 0.0427s/iter; left time: 122.6409s
	iters: 800, epoch: 7 | loss: 0.3354075
	speed: 0.0425s/iter; left time: 117.9054s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.23s
Steps: 893 | Train Loss: 0.3221708 Vali Loss: 0.4098179 Test Loss: 0.4235730
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2890800
	speed: 0.1522s/iter; left time: 392.7008s
	iters: 200, epoch: 8 | loss: 0.3243214
	speed: 0.0427s/iter; left time: 106.0005s
	iters: 300, epoch: 8 | loss: 0.2589266
	speed: 0.0425s/iter; left time: 101.1173s
	iters: 400, epoch: 8 | loss: 0.3333530
	speed: 0.0423s/iter; left time: 96.4767s
	iters: 500, epoch: 8 | loss: 0.2846834
	speed: 0.0424s/iter; left time: 92.4178s
	iters: 600, epoch: 8 | loss: 0.3179591
	speed: 0.0424s/iter; left time: 88.2907s
	iters: 700, epoch: 8 | loss: 0.3226090
	speed: 0.0425s/iter; left time: 84.2358s
	iters: 800, epoch: 8 | loss: 0.3119867
	speed: 0.0425s/iter; left time: 79.9177s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.15s
Steps: 893 | Train Loss: 0.3134166 Vali Loss: 0.4092242 Test Loss: 0.4205885
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.44546520709991455, rmse:0.6674317717552185, mae:0.41866567730903625, rse:0.5282301306724548
Original data scale mse:16678795.0, rmse:4083.968017578125, mae:2431.303955078125, rse:0.20306311547756195

=== Starting experiments for pred_len: 96 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6374813
	speed: 0.0668s/iter; left time: 588.6268s
	iters: 200, epoch: 1 | loss: 0.5262504
	speed: 0.0429s/iter; left time: 373.6804s
	iters: 300, epoch: 1 | loss: 0.5496212
	speed: 0.0425s/iter; left time: 366.3395s
	iters: 400, epoch: 1 | loss: 0.4834964
	speed: 0.0427s/iter; left time: 363.0046s
	iters: 500, epoch: 1 | loss: 0.5325756
	speed: 0.0426s/iter; left time: 358.4012s
	iters: 600, epoch: 1 | loss: 0.4872109
	speed: 0.0427s/iter; left time: 354.5742s
	iters: 700, epoch: 1 | loss: 0.5237520
	speed: 0.0429s/iter; left time: 352.3595s
	iters: 800, epoch: 1 | loss: 0.5554903
	speed: 0.0428s/iter; left time: 347.2004s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.50s
Steps: 891 | Train Loss: 0.5397429 Vali Loss: 0.5700328 Test Loss: 0.6036903
Validation loss decreased (inf --> 0.570033).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5374577
	speed: 0.1534s/iter; left time: 1214.5876s
	iters: 200, epoch: 2 | loss: 0.5270962
	speed: 0.0428s/iter; left time: 334.9445s
	iters: 300, epoch: 2 | loss: 0.4995303
	speed: 0.0427s/iter; left time: 329.8634s
	iters: 400, epoch: 2 | loss: 0.5156381
	speed: 0.0428s/iter; left time: 325.8718s
	iters: 500, epoch: 2 | loss: 0.4754504
	speed: 0.0428s/iter; left time: 321.6876s
	iters: 600, epoch: 2 | loss: 0.4311262
	speed: 0.0427s/iter; left time: 316.6085s
	iters: 700, epoch: 2 | loss: 0.4329669
	speed: 0.0429s/iter; left time: 314.0876s
	iters: 800, epoch: 2 | loss: 0.5162832
	speed: 0.0427s/iter; left time: 308.0701s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.37s
Steps: 891 | Train Loss: 0.5097087 Vali Loss: 0.5559564 Test Loss: 0.5963426
Validation loss decreased (0.570033 --> 0.555956).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4553922
	speed: 0.1539s/iter; left time: 1081.4243s
	iters: 200, epoch: 3 | loss: 0.4781276
	speed: 0.0428s/iter; left time: 296.3413s
	iters: 300, epoch: 3 | loss: 0.5148327
	speed: 0.0427s/iter; left time: 291.8887s
	iters: 400, epoch: 3 | loss: 0.4678192
	speed: 0.0428s/iter; left time: 287.7050s
	iters: 500, epoch: 3 | loss: 0.4578561
	speed: 0.0428s/iter; left time: 283.4134s
	iters: 600, epoch: 3 | loss: 0.4424357
	speed: 0.0427s/iter; left time: 278.8488s
	iters: 700, epoch: 3 | loss: 0.4751456
	speed: 0.0427s/iter; left time: 274.5151s
	iters: 800, epoch: 3 | loss: 0.4236996
	speed: 0.0427s/iter; left time: 270.0678s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.4665015 Vali Loss: 0.5722540 Test Loss: 0.6234865
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4868843
	speed: 0.1518s/iter; left time: 932.0490s
	iters: 200, epoch: 4 | loss: 0.4776935
	speed: 0.0428s/iter; left time: 258.3937s
	iters: 300, epoch: 4 | loss: 0.4831240
	speed: 0.0428s/iter; left time: 253.9956s
	iters: 400, epoch: 4 | loss: 0.4405861
	speed: 0.0427s/iter; left time: 249.4328s
	iters: 500, epoch: 4 | loss: 0.4349448
	speed: 0.0428s/iter; left time: 245.3025s
	iters: 600, epoch: 4 | loss: 0.4479438
	speed: 0.0429s/iter; left time: 241.9157s
	iters: 700, epoch: 4 | loss: 0.4399997
	speed: 0.0429s/iter; left time: 237.6722s
	iters: 800, epoch: 4 | loss: 0.3783943
	speed: 0.0429s/iter; left time: 233.0458s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.33s
Steps: 891 | Train Loss: 0.4382588 Vali Loss: 0.5783772 Test Loss: 0.6318021
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4318333
	speed: 0.1513s/iter; left time: 793.8737s
	iters: 200, epoch: 5 | loss: 0.3880471
	speed: 0.0427s/iter; left time: 219.6857s
	iters: 300, epoch: 5 | loss: 0.4674024
	speed: 0.0428s/iter; left time: 216.0979s
	iters: 400, epoch: 5 | loss: 0.3704361
	speed: 0.0430s/iter; left time: 212.4841s
	iters: 500, epoch: 5 | loss: 0.3912926
	speed: 0.0428s/iter; left time: 207.3283s
	iters: 600, epoch: 5 | loss: 0.3840115
	speed: 0.0427s/iter; left time: 202.6971s
	iters: 700, epoch: 5 | loss: 0.3629414
	speed: 0.0427s/iter; left time: 198.4789s
	iters: 800, epoch: 5 | loss: 0.3453966
	speed: 0.0427s/iter; left time: 194.2788s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.3968851 Vali Loss: 0.5949938 Test Loss: 0.6539372
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.7655912637710571, rmse:0.8749807476997375, mae:0.5963423848152161, rse:0.6939675807952881
Original data scale mse:31555720.0, rmse:5617.44775390625, mae:3527.80322265625, rse:0.27975091338157654
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5567461
	speed: 0.0443s/iter; left time: 390.7184s
	iters: 200, epoch: 1 | loss: 0.5131473
	speed: 0.0427s/iter; left time: 372.0392s
	iters: 300, epoch: 1 | loss: 0.5688336
	speed: 0.0427s/iter; left time: 367.3527s
	iters: 400, epoch: 1 | loss: 0.5851882
	speed: 0.0426s/iter; left time: 362.9409s
	iters: 500, epoch: 1 | loss: 0.4940234
	speed: 0.0427s/iter; left time: 359.3432s
	iters: 600, epoch: 1 | loss: 0.5569887
	speed: 0.0427s/iter; left time: 355.1089s
	iters: 700, epoch: 1 | loss: 0.5020673
	speed: 0.0427s/iter; left time: 350.4669s
	iters: 800, epoch: 1 | loss: 0.5009230
	speed: 0.0427s/iter; left time: 346.4349s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.25s
Steps: 891 | Train Loss: 0.5401562 Vali Loss: 0.5691482 Test Loss: 0.6024293
Validation loss decreased (inf --> 0.569148).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5425625
	speed: 0.1539s/iter; left time: 1219.0067s
	iters: 200, epoch: 2 | loss: 0.5092666
	speed: 0.0427s/iter; left time: 333.6463s
	iters: 300, epoch: 2 | loss: 0.5347412
	speed: 0.0427s/iter; left time: 329.3097s
	iters: 400, epoch: 2 | loss: 0.5148687
	speed: 0.0427s/iter; left time: 325.4797s
	iters: 500, epoch: 2 | loss: 0.4511907
	speed: 0.0427s/iter; left time: 321.2890s
	iters: 600, epoch: 2 | loss: 0.4812346
	speed: 0.0427s/iter; left time: 316.8765s
	iters: 700, epoch: 2 | loss: 0.5175083
	speed: 0.0427s/iter; left time: 312.3264s
	iters: 800, epoch: 2 | loss: 0.4783387
	speed: 0.0427s/iter; left time: 308.0100s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.5104276 Vali Loss: 0.5632515 Test Loss: 0.6076972
Validation loss decreased (0.569148 --> 0.563251).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4891643
	speed: 0.1538s/iter; left time: 1080.8924s
	iters: 200, epoch: 3 | loss: 0.4391293
	speed: 0.0427s/iter; left time: 295.9464s
	iters: 300, epoch: 3 | loss: 0.4282694
	speed: 0.0427s/iter; left time: 291.3648s
	iters: 400, epoch: 3 | loss: 0.4537349
	speed: 0.0424s/iter; left time: 285.3786s
	iters: 500, epoch: 3 | loss: 0.4212231
	speed: 0.0428s/iter; left time: 283.9576s
	iters: 600, epoch: 3 | loss: 0.4614433
	speed: 0.0427s/iter; left time: 278.6681s
	iters: 700, epoch: 3 | loss: 0.5231907
	speed: 0.0427s/iter; left time: 274.5001s
	iters: 800, epoch: 3 | loss: 0.4524678
	speed: 0.0428s/iter; left time: 270.6154s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.25s
Steps: 891 | Train Loss: 0.4641792 Vali Loss: 0.5592130 Test Loss: 0.6112368
Validation loss decreased (0.563251 --> 0.559213).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4562828
	speed: 0.1539s/iter; left time: 944.6766s
	iters: 200, epoch: 4 | loss: 0.4032119
	speed: 0.0427s/iter; left time: 258.0062s
	iters: 300, epoch: 4 | loss: 0.4174506
	speed: 0.0427s/iter; left time: 253.6510s
	iters: 400, epoch: 4 | loss: 0.4366000
	speed: 0.0426s/iter; left time: 248.9802s
	iters: 500, epoch: 4 | loss: 0.3799008
	speed: 0.0426s/iter; left time: 244.6381s
	iters: 600, epoch: 4 | loss: 0.4402491
	speed: 0.0427s/iter; left time: 240.5559s
	iters: 700, epoch: 4 | loss: 0.4542446
	speed: 0.0427s/iter; left time: 236.7406s
	iters: 800, epoch: 4 | loss: 0.4093605
	speed: 0.0427s/iter; left time: 232.3596s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.28s
Steps: 891 | Train Loss: 0.4341894 Vali Loss: 0.5747357 Test Loss: 0.6246487
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3754254
	speed: 0.1526s/iter; left time: 800.5439s
	iters: 200, epoch: 5 | loss: 0.3966073
	speed: 0.0427s/iter; left time: 219.6991s
	iters: 300, epoch: 5 | loss: 0.3927452
	speed: 0.0427s/iter; left time: 215.6141s
	iters: 400, epoch: 5 | loss: 0.4006265
	speed: 0.0428s/iter; left time: 211.5692s
	iters: 500, epoch: 5 | loss: 0.3565641
	speed: 0.0427s/iter; left time: 207.1230s
	iters: 600, epoch: 5 | loss: 0.3645180
	speed: 0.0427s/iter; left time: 202.7275s
	iters: 700, epoch: 5 | loss: 0.3615814
	speed: 0.0426s/iter; left time: 198.0965s
	iters: 800, epoch: 5 | loss: 0.3716194
	speed: 0.0428s/iter; left time: 194.4276s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.28s
Steps: 891 | Train Loss: 0.3956859 Vali Loss: 0.5881065 Test Loss: 0.6395448
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3419645
	speed: 0.1518s/iter; left time: 661.4252s
	iters: 200, epoch: 6 | loss: 0.3649749
	speed: 0.0425s/iter; left time: 181.0643s
	iters: 300, epoch: 6 | loss: 0.3397926
	speed: 0.0425s/iter; left time: 176.5243s
	iters: 400, epoch: 6 | loss: 0.3800455
	speed: 0.0427s/iter; left time: 173.1685s
	iters: 500, epoch: 6 | loss: 0.3381722
	speed: 0.0427s/iter; left time: 168.8047s
	iters: 600, epoch: 6 | loss: 0.3673343
	speed: 0.0427s/iter; left time: 164.7808s
	iters: 700, epoch: 6 | loss: 0.3715284
	speed: 0.0427s/iter; left time: 160.3121s
	iters: 800, epoch: 6 | loss: 0.3510702
	speed: 0.0427s/iter; left time: 156.2257s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.23s
Steps: 891 | Train Loss: 0.3557695 Vali Loss: 0.5995966 Test Loss: 0.6508650
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.8202449083328247, rmse:0.9056737422943115, mae:0.6112369298934937, rse:0.7183108925819397
Original data scale mse:34537172.0, rmse:5876.83349609375, mae:3631.940673828125, rse:0.2926684021949768

=== Starting experiments for pred_len: 168 ===

Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.6454177
	speed: 0.0676s/iter; left time: 594.5601s
	iters: 200, epoch: 1 | loss: 0.5544594
	speed: 0.0434s/iter; left time: 377.3446s
	iters: 300, epoch: 1 | loss: 0.5635941
	speed: 0.0434s/iter; left time: 372.8728s
	iters: 400, epoch: 1 | loss: 0.6180624
	speed: 0.0434s/iter; left time: 368.1762s
	iters: 500, epoch: 1 | loss: 0.5999923
	speed: 0.0432s/iter; left time: 362.8958s
	iters: 600, epoch: 1 | loss: 0.5538129
	speed: 0.0433s/iter; left time: 359.3278s
	iters: 700, epoch: 1 | loss: 0.5393959
	speed: 0.0433s/iter; left time: 354.2748s
	iters: 800, epoch: 1 | loss: 0.5381173
	speed: 0.0433s/iter; left time: 350.0561s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.95s
Steps: 889 | Train Loss: 0.5633903 Vali Loss: 0.5876741 Test Loss: 0.6291287
Validation loss decreased (inf --> 0.587674).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5834135
	speed: 0.1545s/iter; left time: 1221.0624s
	iters: 200, epoch: 2 | loss: 0.5220478
	speed: 0.0434s/iter; left time: 338.3012s
	iters: 300, epoch: 2 | loss: 0.5758332
	speed: 0.0433s/iter; left time: 333.5033s
	iters: 400, epoch: 2 | loss: 0.5207759
	speed: 0.0434s/iter; left time: 329.8133s
	iters: 500, epoch: 2 | loss: 0.5079741
	speed: 0.0433s/iter; left time: 324.9222s
	iters: 600, epoch: 2 | loss: 0.5090077
	speed: 0.0432s/iter; left time: 320.0888s
	iters: 700, epoch: 2 | loss: 0.4622243
	speed: 0.0434s/iter; left time: 317.2569s
	iters: 800, epoch: 2 | loss: 0.5246297
	speed: 0.0433s/iter; left time: 312.1196s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.72s
Steps: 889 | Train Loss: 0.5286044 Vali Loss: 0.5791647 Test Loss: 0.6255860
Validation loss decreased (0.587674 --> 0.579165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4951027
	speed: 0.1555s/iter; left time: 1090.4638s
	iters: 200, epoch: 3 | loss: 0.4212805
	speed: 0.0433s/iter; left time: 299.4308s
	iters: 300, epoch: 3 | loss: 0.4809437
	speed: 0.0433s/iter; left time: 294.8038s
	iters: 400, epoch: 3 | loss: 0.5490001
	speed: 0.0433s/iter; left time: 290.3509s
	iters: 500, epoch: 3 | loss: 0.5272199
	speed: 0.0433s/iter; left time: 286.4257s
	iters: 600, epoch: 3 | loss: 0.4973647
	speed: 0.0433s/iter; left time: 281.9563s
	iters: 700, epoch: 3 | loss: 0.4791625
	speed: 0.0433s/iter; left time: 277.8630s
	iters: 800, epoch: 3 | loss: 0.4444051
	speed: 0.0434s/iter; left time: 273.6776s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.71s
Steps: 889 | Train Loss: 0.4811308 Vali Loss: 0.5916529 Test Loss: 0.6518676
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4643247
	speed: 0.1514s/iter; left time: 927.3796s
	iters: 200, epoch: 4 | loss: 0.4047467
	speed: 0.0433s/iter; left time: 260.8542s
	iters: 300, epoch: 4 | loss: 0.5270584
	speed: 0.0433s/iter; left time: 256.4785s
	iters: 400, epoch: 4 | loss: 0.4366706
	speed: 0.0433s/iter; left time: 252.2116s
	iters: 500, epoch: 4 | loss: 0.4361570
	speed: 0.0433s/iter; left time: 247.5898s
	iters: 600, epoch: 4 | loss: 0.3978770
	speed: 0.0433s/iter; left time: 243.4390s
	iters: 700, epoch: 4 | loss: 0.4258873
	speed: 0.0432s/iter; left time: 238.8988s
	iters: 800, epoch: 4 | loss: 0.4317477
	speed: 0.0432s/iter; left time: 234.4671s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.65s
Steps: 889 | Train Loss: 0.4384420 Vali Loss: 0.5988257 Test Loss: 0.6685336
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3967570
	speed: 0.1522s/iter; left time: 796.9504s
	iters: 200, epoch: 5 | loss: 0.3766952
	speed: 0.0434s/iter; left time: 222.8755s
	iters: 300, epoch: 5 | loss: 0.3889566
	speed: 0.0434s/iter; left time: 218.2767s
	iters: 400, epoch: 5 | loss: 0.4054741
	speed: 0.0433s/iter; left time: 213.4839s
	iters: 500, epoch: 5 | loss: 0.4088733
	speed: 0.0434s/iter; left time: 209.7270s
	iters: 600, epoch: 5 | loss: 0.3773878
	speed: 0.0433s/iter; left time: 204.8636s
	iters: 700, epoch: 5 | loss: 0.3832667
	speed: 0.0433s/iter; left time: 200.6077s
	iters: 800, epoch: 5 | loss: 0.3715691
	speed: 0.0433s/iter; left time: 196.5096s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.68s
Steps: 889 | Train Loss: 0.3870841 Vali Loss: 0.6039886 Test Loss: 0.6716257
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.8244243860244751, rmse:0.9079781770706177, mae:0.6255861520767212, rse:0.7192794680595398
Original data scale mse:35018344.0, rmse:5917.6298828125, mae:3745.188720703125, rse:0.29484474658966064
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.6611432
	speed: 0.0448s/iter; left time: 394.1709s
	iters: 200, epoch: 1 | loss: 0.5944821
	speed: 0.0433s/iter; left time: 376.1663s
	iters: 300, epoch: 1 | loss: 0.6297670
	speed: 0.0434s/iter; left time: 372.9207s
	iters: 400, epoch: 1 | loss: 0.6077808
	speed: 0.0434s/iter; left time: 368.4377s
	iters: 500, epoch: 1 | loss: 0.5648095
	speed: 0.0433s/iter; left time: 363.7158s
	iters: 600, epoch: 1 | loss: 0.4902555
	speed: 0.0434s/iter; left time: 359.6220s
	iters: 700, epoch: 1 | loss: 0.5395623
	speed: 0.0433s/iter; left time: 354.3923s
	iters: 800, epoch: 1 | loss: 0.5115961
	speed: 0.0433s/iter; left time: 350.1797s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.72s
Steps: 889 | Train Loss: 0.5642094 Vali Loss: 0.5857942 Test Loss: 0.6274691
Validation loss decreased (inf --> 0.585794).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5886168
	speed: 0.1535s/iter; left time: 1212.7097s
	iters: 200, epoch: 2 | loss: 0.5624777
	speed: 0.0433s/iter; left time: 337.5492s
	iters: 300, epoch: 2 | loss: 0.5613257
	speed: 0.0434s/iter; left time: 334.1199s
	iters: 400, epoch: 2 | loss: 0.5375162
	speed: 0.0434s/iter; left time: 329.5467s
	iters: 500, epoch: 2 | loss: 0.5497366
	speed: 0.0433s/iter; left time: 324.5267s
	iters: 600, epoch: 2 | loss: 0.5392722
	speed: 0.0433s/iter; left time: 320.3824s
	iters: 700, epoch: 2 | loss: 0.4927635
	speed: 0.0433s/iter; left time: 316.4743s
	iters: 800, epoch: 2 | loss: 0.4971849
	speed: 0.0434s/iter; left time: 312.4371s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.73s
Steps: 889 | Train Loss: 0.5316510 Vali Loss: 0.5887495 Test Loss: 0.6355409
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4743690
	speed: 0.1516s/iter; left time: 1063.4614s
	iters: 200, epoch: 3 | loss: 0.4684273
	speed: 0.0434s/iter; left time: 299.8641s
	iters: 300, epoch: 3 | loss: 0.5384349
	speed: 0.0434s/iter; left time: 295.6602s
	iters: 400, epoch: 3 | loss: 0.5281529
	speed: 0.0433s/iter; left time: 290.6836s
	iters: 500, epoch: 3 | loss: 0.4912407
	speed: 0.0433s/iter; left time: 286.2018s
	iters: 600, epoch: 3 | loss: 0.5095457
	speed: 0.0433s/iter; left time: 282.3354s
	iters: 700, epoch: 3 | loss: 0.4622054
	speed: 0.0433s/iter; left time: 277.5876s
	iters: 800, epoch: 3 | loss: 0.4754922
	speed: 0.0433s/iter; left time: 273.5890s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.72s
Steps: 889 | Train Loss: 0.4833817 Vali Loss: 0.5937650 Test Loss: 0.6408314
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4836038
	speed: 0.1509s/iter; left time: 924.0996s
	iters: 200, epoch: 4 | loss: 0.4296790
	speed: 0.0434s/iter; left time: 261.1547s
	iters: 300, epoch: 4 | loss: 0.4317384
	speed: 0.0434s/iter; left time: 256.8122s
	iters: 400, epoch: 4 | loss: 0.3970349
	speed: 0.0433s/iter; left time: 252.3072s
	iters: 500, epoch: 4 | loss: 0.4507579
	speed: 0.0435s/iter; left time: 248.7202s
	iters: 600, epoch: 4 | loss: 0.4092776
	speed: 0.0434s/iter; left time: 244.0600s
	iters: 700, epoch: 4 | loss: 0.4983984
	speed: 0.0432s/iter; left time: 238.8728s
	iters: 800, epoch: 4 | loss: 0.4482481
	speed: 0.0433s/iter; left time: 234.9684s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.4415455 Vali Loss: 0.6122530 Test Loss: 0.6604525
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.8160760402679443, rmse:0.9033692479133606, mae:0.6274691224098206, rse:0.715628445148468
Original data scale mse:33935912.0, rmse:5825.45361328125, mae:3740.77783203125, rse:0.29025208950042725
