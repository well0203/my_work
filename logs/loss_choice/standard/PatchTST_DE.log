
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0186265
	speed: 0.0667s/iter; left time: 589.0130s
	iters: 200, epoch: 1 | loss: 0.0204422
	speed: 0.0424s/iter; left time: 369.9746s
	iters: 300, epoch: 1 | loss: 0.0158871
	speed: 0.0424s/iter; left time: 366.0454s
	iters: 400, epoch: 1 | loss: 0.0188983
	speed: 0.0424s/iter; left time: 361.3712s
	iters: 500, epoch: 1 | loss: 0.0171893
	speed: 0.0424s/iter; left time: 357.7586s
	iters: 600, epoch: 1 | loss: 0.0204163
	speed: 0.0423s/iter; left time: 352.7042s
	iters: 700, epoch: 1 | loss: 0.0160199
	speed: 0.0424s/iter; left time: 349.0989s
	iters: 800, epoch: 1 | loss: 0.0154415
	speed: 0.0424s/iter; left time: 344.7013s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.32s
Steps: 893 | Train Loss: 0.0172390 Vali Loss: 0.0207930 Test Loss: 0.0224516
Validation loss decreased (inf --> 0.020793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0187046
	speed: 0.1542s/iter; left time: 1223.7823s
	iters: 200, epoch: 2 | loss: 0.0174998
	speed: 0.0423s/iter; left time: 331.6636s
	iters: 300, epoch: 2 | loss: 0.0124051
	speed: 0.0424s/iter; left time: 328.4124s
	iters: 400, epoch: 2 | loss: 0.0135999
	speed: 0.0424s/iter; left time: 323.5106s
	iters: 500, epoch: 2 | loss: 0.0125794
	speed: 0.0424s/iter; left time: 319.6508s
	iters: 600, epoch: 2 | loss: 0.0132403
	speed: 0.0425s/iter; left time: 315.7498s
	iters: 700, epoch: 2 | loss: 0.0160454
	speed: 0.0424s/iter; left time: 311.1230s
	iters: 800, epoch: 2 | loss: 0.0115534
	speed: 0.0425s/iter; left time: 307.9234s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0140562 Vali Loss: 0.0199467 Test Loss: 0.0225555
Validation loss decreased (0.020793 --> 0.019947).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0083730
	speed: 0.1542s/iter; left time: 1086.1988s
	iters: 200, epoch: 3 | loss: 0.0124742
	speed: 0.0424s/iter; left time: 294.3130s
	iters: 300, epoch: 3 | loss: 0.0106130
	speed: 0.0424s/iter; left time: 290.0911s
	iters: 400, epoch: 3 | loss: 0.0110241
	speed: 0.0424s/iter; left time: 286.0384s
	iters: 500, epoch: 3 | loss: 0.0102109
	speed: 0.0424s/iter; left time: 281.9351s
	iters: 600, epoch: 3 | loss: 0.0130316
	speed: 0.0423s/iter; left time: 276.9790s
	iters: 700, epoch: 3 | loss: 0.0093260
	speed: 0.0423s/iter; left time: 272.5360s
	iters: 800, epoch: 3 | loss: 0.0157502
	speed: 0.0423s/iter; left time: 268.6206s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.0125945 Vali Loss: 0.0193660 Test Loss: 0.0214509
Validation loss decreased (0.019947 --> 0.019366).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0121307
	speed: 0.1537s/iter; left time: 945.6492s
	iters: 200, epoch: 4 | loss: 0.0111028
	speed: 0.0420s/iter; left time: 254.3636s
	iters: 300, epoch: 4 | loss: 0.0134106
	speed: 0.0421s/iter; left time: 250.8665s
	iters: 400, epoch: 4 | loss: 0.0094057
	speed: 0.0422s/iter; left time: 246.6755s
	iters: 500, epoch: 4 | loss: 0.0171544
	speed: 0.0422s/iter; left time: 242.9775s
	iters: 600, epoch: 4 | loss: 0.0112910
	speed: 0.0421s/iter; left time: 237.9794s
	iters: 700, epoch: 4 | loss: 0.0110425
	speed: 0.0423s/iter; left time: 234.6691s
	iters: 800, epoch: 4 | loss: 0.0135985
	speed: 0.0424s/iter; left time: 230.9620s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.89s
Steps: 893 | Train Loss: 0.0120672 Vali Loss: 0.0202044 Test Loss: 0.0227893
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0104726
	speed: 0.1513s/iter; left time: 795.4265s
	iters: 200, epoch: 5 | loss: 0.0081487
	speed: 0.0423s/iter; left time: 218.4158s
	iters: 300, epoch: 5 | loss: 0.0113901
	speed: 0.0424s/iter; left time: 214.4464s
	iters: 400, epoch: 5 | loss: 0.0103068
	speed: 0.0424s/iter; left time: 210.0472s
	iters: 500, epoch: 5 | loss: 0.0112572
	speed: 0.0424s/iter; left time: 205.8148s
	iters: 600, epoch: 5 | loss: 0.0088546
	speed: 0.0424s/iter; left time: 201.7266s
	iters: 700, epoch: 5 | loss: 0.0099310
	speed: 0.0423s/iter; left time: 196.9785s
	iters: 800, epoch: 5 | loss: 0.0101148
	speed: 0.0424s/iter; left time: 193.1738s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.0115217 Vali Loss: 0.0200888 Test Loss: 0.0223086
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0080665
	speed: 0.1511s/iter; left time: 659.5243s
	iters: 200, epoch: 6 | loss: 0.0134688
	speed: 0.0423s/iter; left time: 180.5685s
	iters: 300, epoch: 6 | loss: 0.0091302
	speed: 0.0424s/iter; left time: 176.6107s
	iters: 400, epoch: 6 | loss: 0.0082836
	speed: 0.0424s/iter; left time: 172.2078s
	iters: 500, epoch: 6 | loss: 0.0096623
	speed: 0.0423s/iter; left time: 167.9155s
	iters: 600, epoch: 6 | loss: 0.0109867
	speed: 0.0424s/iter; left time: 163.8684s
	iters: 700, epoch: 6 | loss: 0.0099595
	speed: 0.0423s/iter; left time: 159.4473s
	iters: 800, epoch: 6 | loss: 0.0100367
	speed: 0.0422s/iter; left time: 154.6099s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.00s
