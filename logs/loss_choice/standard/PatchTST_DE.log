
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0186265
	speed: 0.0673s/iter; left time: 593.9052s
	iters: 200, epoch: 1 | loss: 0.0204422
	speed: 0.0425s/iter; left time: 371.4124s
	iters: 300, epoch: 1 | loss: 0.0158871
	speed: 0.0424s/iter; left time: 365.6571s
	iters: 400, epoch: 1 | loss: 0.0188983
	speed: 0.0424s/iter; left time: 361.4986s
	iters: 500, epoch: 1 | loss: 0.0171893
	speed: 0.0424s/iter; left time: 357.1421s
	iters: 600, epoch: 1 | loss: 0.0204163
	speed: 0.0423s/iter; left time: 352.6107s
	iters: 700, epoch: 1 | loss: 0.0160199
	speed: 0.0425s/iter; left time: 350.0541s
	iters: 800, epoch: 1 | loss: 0.0154415
	speed: 0.0425s/iter; left time: 345.6019s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.35s
Steps: 893 | Train Loss: 0.0172390 Vali Loss: 0.0207930 Test Loss: 0.0224516
Validation loss decreased (inf --> 0.020793).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0187046
	speed: 0.1538s/iter; left time: 1221.0351s
	iters: 200, epoch: 2 | loss: 0.0174998
	speed: 0.0424s/iter; left time: 332.1015s
	iters: 300, epoch: 2 | loss: 0.0124051
	speed: 0.0424s/iter; left time: 327.8057s
	iters: 400, epoch: 2 | loss: 0.0135999
	speed: 0.0424s/iter; left time: 323.6658s
	iters: 500, epoch: 2 | loss: 0.0125794
	speed: 0.0423s/iter; left time: 319.0117s
	iters: 600, epoch: 2 | loss: 0.0132403
	speed: 0.0423s/iter; left time: 314.2585s
	iters: 700, epoch: 2 | loss: 0.0160454
	speed: 0.0424s/iter; left time: 310.8119s
	iters: 800, epoch: 2 | loss: 0.0115534
	speed: 0.0423s/iter; left time: 306.5218s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.0140562 Vali Loss: 0.0199467 Test Loss: 0.0225555
Validation loss decreased (0.020793 --> 0.019947).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0083730
	speed: 0.1528s/iter; left time: 1076.2789s
	iters: 200, epoch: 3 | loss: 0.0124742
	speed: 0.0424s/iter; left time: 294.2786s
	iters: 300, epoch: 3 | loss: 0.0106130
	speed: 0.0423s/iter; left time: 289.6536s
	iters: 400, epoch: 3 | loss: 0.0110241
	speed: 0.0424s/iter; left time: 285.8635s
	iters: 500, epoch: 3 | loss: 0.0102109
	speed: 0.0423s/iter; left time: 281.2480s
	iters: 600, epoch: 3 | loss: 0.0130316
	speed: 0.0424s/iter; left time: 277.7369s
	iters: 700, epoch: 3 | loss: 0.0093260
	speed: 0.0424s/iter; left time: 273.1356s
	iters: 800, epoch: 3 | loss: 0.0157502
	speed: 0.0423s/iter; left time: 268.4541s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.0125945 Vali Loss: 0.0193660 Test Loss: 0.0214509
Validation loss decreased (0.019947 --> 0.019366).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0121307
	speed: 0.1530s/iter; left time: 941.0394s
	iters: 200, epoch: 4 | loss: 0.0111028
	speed: 0.0423s/iter; left time: 256.0373s
	iters: 300, epoch: 4 | loss: 0.0134106
	speed: 0.0423s/iter; left time: 252.0329s
	iters: 400, epoch: 4 | loss: 0.0094057
	speed: 0.0423s/iter; left time: 247.6997s
	iters: 500, epoch: 4 | loss: 0.0171544
	speed: 0.0423s/iter; left time: 243.5040s
	iters: 600, epoch: 4 | loss: 0.0112910
	speed: 0.0424s/iter; left time: 239.5752s
	iters: 700, epoch: 4 | loss: 0.0110425
	speed: 0.0423s/iter; left time: 235.0488s
	iters: 800, epoch: 4 | loss: 0.0135985
	speed: 0.0423s/iter; left time: 230.7220s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.0120672 Vali Loss: 0.0202044 Test Loss: 0.0227893
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0104726
	speed: 0.1516s/iter; left time: 797.0310s
	iters: 200, epoch: 5 | loss: 0.0081487
	speed: 0.0425s/iter; left time: 219.0523s
	iters: 300, epoch: 5 | loss: 0.0113901
	speed: 0.0423s/iter; left time: 214.0969s
	iters: 400, epoch: 5 | loss: 0.0103068
	speed: 0.0425s/iter; left time: 210.5952s
	iters: 500, epoch: 5 | loss: 0.0112572
	speed: 0.0424s/iter; left time: 206.1605s
	iters: 600, epoch: 5 | loss: 0.0088546
	speed: 0.0423s/iter; left time: 201.1860s
	iters: 700, epoch: 5 | loss: 0.0099310
	speed: 0.0423s/iter; left time: 197.1133s
	iters: 800, epoch: 5 | loss: 0.0101148
	speed: 0.0424s/iter; left time: 193.1490s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.10s
Steps: 893 | Train Loss: 0.0115217 Vali Loss: 0.0200888 Test Loss: 0.0223086
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0080665
	speed: 0.1511s/iter; left time: 659.5094s
	iters: 200, epoch: 6 | loss: 0.0134688
	speed: 0.0425s/iter; left time: 181.3065s
	iters: 300, epoch: 6 | loss: 0.0091302
	speed: 0.0423s/iter; left time: 176.3581s
	iters: 400, epoch: 6 | loss: 0.0082836
	speed: 0.0424s/iter; left time: 172.2351s
	iters: 500, epoch: 6 | loss: 0.0096623
	speed: 0.0423s/iter; left time: 167.8155s
	iters: 600, epoch: 6 | loss: 0.0109867
	speed: 0.0426s/iter; left time: 164.5528s
	iters: 700, epoch: 6 | loss: 0.0099595
	speed: 0.0425s/iter; left time: 160.0556s
	iters: 800, epoch: 6 | loss: 0.0100367
	speed: 0.0424s/iter; left time: 155.6117s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0106920 Vali Loss: 0.0210210 Test Loss: 0.0233727
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021450931206345558, rmse:0.1464613676071167, mae:0.09386222064495087, rse:0.5172322988510132
Original data scale mse:17161886.0, rmse:4142.6904296875, mae:2553.821044921875, rse:0.20598293840885162
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0241524
	speed: 0.0442s/iter; left time: 390.5160s
	iters: 200, epoch: 1 | loss: 0.0150888
	speed: 0.0424s/iter; left time: 369.8921s
	iters: 300, epoch: 1 | loss: 0.0153452
	speed: 0.0425s/iter; left time: 366.5297s
	iters: 400, epoch: 1 | loss: 0.0137540
	speed: 0.0424s/iter; left time: 362.1092s
	iters: 500, epoch: 1 | loss: 0.0163585
	speed: 0.0427s/iter; left time: 359.7273s
	iters: 600, epoch: 1 | loss: 0.0158045
	speed: 0.0424s/iter; left time: 353.3610s
	iters: 700, epoch: 1 | loss: 0.0160179
	speed: 0.0426s/iter; left time: 350.4453s
	iters: 800, epoch: 1 | loss: 0.0174562
	speed: 0.0425s/iter; left time: 345.5916s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.16s
Steps: 893 | Train Loss: 0.0171803 Vali Loss: 0.0206600 Test Loss: 0.0225042
Validation loss decreased (inf --> 0.020660).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0152778
	speed: 0.1551s/iter; left time: 1230.9770s
	iters: 200, epoch: 2 | loss: 0.0156064
	speed: 0.0425s/iter; left time: 332.9020s
	iters: 300, epoch: 2 | loss: 0.0138266
	speed: 0.0424s/iter; left time: 328.0051s
	iters: 400, epoch: 2 | loss: 0.0139048
	speed: 0.0423s/iter; left time: 323.3082s
	iters: 500, epoch: 2 | loss: 0.0117401
	speed: 0.0425s/iter; left time: 320.1448s
	iters: 600, epoch: 2 | loss: 0.0119023
	speed: 0.0426s/iter; left time: 316.7337s
	iters: 700, epoch: 2 | loss: 0.0089794
	speed: 0.0424s/iter; left time: 311.1197s
	iters: 800, epoch: 2 | loss: 0.0132081
	speed: 0.0424s/iter; left time: 306.7376s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.11s
Steps: 893 | Train Loss: 0.0139596 Vali Loss: 0.0192198 Test Loss: 0.0214212
Validation loss decreased (0.020660 --> 0.019220).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0099537
	speed: 0.1540s/iter; left time: 1084.6870s
	iters: 200, epoch: 3 | loss: 0.0112865
	speed: 0.0424s/iter; left time: 294.6619s
	iters: 300, epoch: 3 | loss: 0.0108359
	speed: 0.0424s/iter; left time: 290.2200s
	iters: 400, epoch: 3 | loss: 0.0110285
	speed: 0.0424s/iter; left time: 285.8407s
	iters: 500, epoch: 3 | loss: 0.0130919
	speed: 0.0424s/iter; left time: 281.7735s
	iters: 600, epoch: 3 | loss: 0.0122870
	speed: 0.0424s/iter; left time: 277.7073s
	iters: 700, epoch: 3 | loss: 0.0091051
	speed: 0.0425s/iter; left time: 274.2129s
	iters: 800, epoch: 3 | loss: 0.0105469
	speed: 0.0424s/iter; left time: 269.2967s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.13s
Steps: 893 | Train Loss: 0.0125011 Vali Loss: 0.0193032 Test Loss: 0.0212502
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0114234
	speed: 0.1530s/iter; left time: 940.9590s
	iters: 200, epoch: 4 | loss: 0.0096694
	speed: 0.0424s/iter; left time: 256.8145s
	iters: 300, epoch: 4 | loss: 0.0103410
	speed: 0.0425s/iter; left time: 252.6979s
	iters: 400, epoch: 4 | loss: 0.0144069
	speed: 0.0424s/iter; left time: 248.2136s
	iters: 500, epoch: 4 | loss: 0.0133314
	speed: 0.0424s/iter; left time: 244.1232s
	iters: 600, epoch: 4 | loss: 0.0128110
	speed: 0.0424s/iter; left time: 239.8968s
	iters: 700, epoch: 4 | loss: 0.0100962
	speed: 0.0426s/iter; left time: 236.5666s
	iters: 800, epoch: 4 | loss: 0.0136120
	speed: 0.0424s/iter; left time: 231.3319s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.11s
Steps: 893 | Train Loss: 0.0119852 Vali Loss: 0.0194677 Test Loss: 0.0217007
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0108032
	speed: 0.1539s/iter; left time: 809.6166s
	iters: 200, epoch: 5 | loss: 0.0102258
	speed: 0.0425s/iter; left time: 219.2864s
	iters: 300, epoch: 5 | loss: 0.0108887
	speed: 0.0426s/iter; left time: 215.5382s
	iters: 400, epoch: 5 | loss: 0.0120689
	speed: 0.0424s/iter; left time: 210.1471s
	iters: 500, epoch: 5 | loss: 0.0079460
	speed: 0.0423s/iter; left time: 205.3764s
	iters: 600, epoch: 5 | loss: 0.0108227
	speed: 0.0425s/iter; left time: 202.4742s
	iters: 700, epoch: 5 | loss: 0.0108111
	speed: 0.0425s/iter; left time: 197.9847s
	iters: 800, epoch: 5 | loss: 0.0116400
	speed: 0.0424s/iter; left time: 193.0755s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.17s
Steps: 893 | Train Loss: 0.0113180 Vali Loss: 0.0201557 Test Loss: 0.0224901
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02142123319208622, rmse:0.14635995030403137, mae:0.09442413598299026, rse:0.5168741345405579
Original data scale mse:17119326.0, rmse:4137.55078125, mae:2579.4404296875, rse:0.20572736859321594

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.021450931206345558, RMSE: 0.1464613676071167, MAE: 0.09386222064495087, RSE: 0.5172322988510132
Unscaled Metrics - MSE: 17161886.0, RMSE: 4142.6904296875, MAE: 2553.821044921875, RSE: 0.20598293840885162

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.02142123319208622, RMSE: 0.14635995030403137, MAE: 0.09442413598299026, RSE: 0.5168741345405579
Unscaled Metrics - MSE: 17119326.0, RMSE: 4137.55078125, MAE: 2579.4404296875, RSE: 0.20572736859321594

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0331177
	speed: 0.0688s/iter; left time: 605.8631s
	iters: 200, epoch: 1 | loss: 0.0241566
	speed: 0.0428s/iter; left time: 372.7624s
	iters: 300, epoch: 1 | loss: 0.0251843
	speed: 0.0427s/iter; left time: 367.4077s
	iters: 400, epoch: 1 | loss: 0.0215071
	speed: 0.0427s/iter; left time: 363.3859s
	iters: 500, epoch: 1 | loss: 0.0252792
	speed: 0.0427s/iter; left time: 359.2813s
	iters: 600, epoch: 1 | loss: 0.0215467
	speed: 0.0427s/iter; left time: 355.2290s
	iters: 700, epoch: 1 | loss: 0.0244969
	speed: 0.0427s/iter; left time: 350.9236s
	iters: 800, epoch: 1 | loss: 0.0285908
	speed: 0.0427s/iter; left time: 346.2732s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.55s
Steps: 891 | Train Loss: 0.0256955 Vali Loss: 0.0307555 Test Loss: 0.0356706
Validation loss decreased (inf --> 0.030756).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0246738
	speed: 0.1551s/iter; left time: 1228.1205s
	iters: 200, epoch: 2 | loss: 0.0222918
	speed: 0.0427s/iter; left time: 333.7058s
	iters: 300, epoch: 2 | loss: 0.0204998
	speed: 0.0426s/iter; left time: 329.2395s
	iters: 400, epoch: 2 | loss: 0.0239871
	speed: 0.0428s/iter; left time: 325.9742s
	iters: 500, epoch: 2 | loss: 0.0186084
	speed: 0.0428s/iter; left time: 321.9454s
	iters: 600, epoch: 2 | loss: 0.0180444
	speed: 0.0427s/iter; left time: 316.8058s
	iters: 700, epoch: 2 | loss: 0.0181111
	speed: 0.0427s/iter; left time: 312.7314s
	iters: 800, epoch: 2 | loss: 0.0241413
	speed: 0.0427s/iter; left time: 308.4054s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.0226432 Vali Loss: 0.0295111 Test Loss: 0.0350451
Validation loss decreased (0.030756 --> 0.029511).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0185620
	speed: 0.1567s/iter; left time: 1101.4137s
	iters: 200, epoch: 3 | loss: 0.0206256
	speed: 0.0427s/iter; left time: 295.6153s
	iters: 300, epoch: 3 | loss: 0.0214388
	speed: 0.0427s/iter; left time: 291.7330s
	iters: 400, epoch: 3 | loss: 0.0203976
	speed: 0.0427s/iter; left time: 287.2029s
	iters: 500, epoch: 3 | loss: 0.0208142
	speed: 0.0427s/iter; left time: 283.1082s
	iters: 600, epoch: 3 | loss: 0.0176320
	speed: 0.0428s/iter; left time: 279.1515s
	iters: 700, epoch: 3 | loss: 0.0211789
	speed: 0.0427s/iter; left time: 274.3333s
	iters: 800, epoch: 3 | loss: 0.0161145
	speed: 0.0427s/iter; left time: 270.1991s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.0200725 Vali Loss: 0.0318672 Test Loss: 0.0379946
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0187531
	speed: 0.1520s/iter; left time: 933.2700s
	iters: 200, epoch: 4 | loss: 0.0186870
	speed: 0.0428s/iter; left time: 258.3443s
	iters: 300, epoch: 4 | loss: 0.0185298
	speed: 0.0429s/iter; left time: 254.6091s
	iters: 400, epoch: 4 | loss: 0.0159659
	speed: 0.0426s/iter; left time: 248.8959s
	iters: 500, epoch: 4 | loss: 0.0174854
	speed: 0.0428s/iter; left time: 245.4871s
	iters: 600, epoch: 4 | loss: 0.0168278
	speed: 0.0429s/iter; left time: 241.8599s
	iters: 700, epoch: 4 | loss: 0.0153451
	speed: 0.0427s/iter; left time: 236.4684s
	iters: 800, epoch: 4 | loss: 0.0127366
	speed: 0.0427s/iter; left time: 232.3359s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.28s
Steps: 891 | Train Loss: 0.0159453 Vali Loss: 0.0339835 Test Loss: 0.0441837
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0123417
	speed: 0.1516s/iter; left time: 795.6708s
	iters: 200, epoch: 5 | loss: 0.0116674
	speed: 0.0424s/iter; left time: 218.1896s
	iters: 300, epoch: 5 | loss: 0.0138313
	speed: 0.0427s/iter; left time: 215.5624s
	iters: 400, epoch: 5 | loss: 0.0120017
	speed: 0.0428s/iter; left time: 211.5992s
	iters: 500, epoch: 5 | loss: 0.0106340
	speed: 0.0426s/iter; left time: 206.4859s
	iters: 600, epoch: 5 | loss: 0.0108038
	speed: 0.0427s/iter; left time: 202.8386s
	iters: 700, epoch: 5 | loss: 0.0110587
	speed: 0.0426s/iter; left time: 198.1594s
	iters: 800, epoch: 5 | loss: 0.0086651
	speed: 0.0427s/iter; left time: 194.0761s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.19s
Steps: 891 | Train Loss: 0.0115554 Vali Loss: 0.0384158 Test Loss: 0.0489048
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.035045064985752106, rmse:0.1872032731771469, mae:0.12920968234539032, rse:0.6629246473312378
Original data scale mse:30968164.0, rmse:5564.90478515625, mae:3569.146484375, rse:0.2771342396736145
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0252734
	speed: 0.0445s/iter; left time: 392.1205s
	iters: 200, epoch: 1 | loss: 0.0225215
	speed: 0.0426s/iter; left time: 371.3740s
	iters: 300, epoch: 1 | loss: 0.0298266
	speed: 0.0426s/iter; left time: 367.0374s
	iters: 400, epoch: 1 | loss: 0.0298059
	speed: 0.0427s/iter; left time: 363.0781s
	iters: 500, epoch: 1 | loss: 0.0215589
	speed: 0.0427s/iter; left time: 358.8407s
	iters: 600, epoch: 1 | loss: 0.0275637
	speed: 0.0427s/iter; left time: 355.0823s
	iters: 700, epoch: 1 | loss: 0.0242801
	speed: 0.0427s/iter; left time: 350.3681s
	iters: 800, epoch: 1 | loss: 0.0225968
	speed: 0.0426s/iter; left time: 345.8008s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.24s
Steps: 891 | Train Loss: 0.0256559 Vali Loss: 0.0307612 Test Loss: 0.0356008
Validation loss decreased (inf --> 0.030761).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0234988
	speed: 0.1564s/iter; left time: 1238.5551s
	iters: 200, epoch: 2 | loss: 0.0206265
	speed: 0.0428s/iter; left time: 334.7831s
	iters: 300, epoch: 2 | loss: 0.0227529
	speed: 0.0427s/iter; left time: 329.8608s
	iters: 400, epoch: 2 | loss: 0.0226817
	speed: 0.0428s/iter; left time: 325.8458s
	iters: 500, epoch: 2 | loss: 0.0179773
	speed: 0.0428s/iter; left time: 321.5871s
	iters: 600, epoch: 2 | loss: 0.0216318
	speed: 0.0427s/iter; left time: 316.9104s
	iters: 700, epoch: 2 | loss: 0.0251577
	speed: 0.0427s/iter; left time: 312.4019s
	iters: 800, epoch: 2 | loss: 0.0213571
	speed: 0.0427s/iter; left time: 308.4299s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.37s
Steps: 891 | Train Loss: 0.0226894 Vali Loss: 0.0294289 Test Loss: 0.0360354
Validation loss decreased (0.030761 --> 0.029429).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0220962
	speed: 0.1567s/iter; left time: 1101.4733s
	iters: 200, epoch: 3 | loss: 0.0182221
	speed: 0.0428s/iter; left time: 296.4807s
	iters: 300, epoch: 3 | loss: 0.0183425
	speed: 0.0427s/iter; left time: 291.8833s
	iters: 400, epoch: 3 | loss: 0.0183479
	speed: 0.0426s/iter; left time: 286.9705s
	iters: 500, epoch: 3 | loss: 0.0169455
	speed: 0.0427s/iter; left time: 283.0014s
	iters: 600, epoch: 3 | loss: 0.0196326
	speed: 0.0426s/iter; left time: 278.3288s
	iters: 700, epoch: 3 | loss: 0.0224708
	speed: 0.0427s/iter; left time: 274.3768s
	iters: 800, epoch: 3 | loss: 0.0191012
	speed: 0.0427s/iter; left time: 270.2808s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.0196020 Vali Loss: 0.0333951 Test Loss: 0.0427147
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0156322
	speed: 0.1528s/iter; left time: 938.0043s
	iters: 200, epoch: 4 | loss: 0.0144624
	speed: 0.0428s/iter; left time: 258.4770s
	iters: 300, epoch: 4 | loss: 0.0155768
	speed: 0.0428s/iter; left time: 254.0572s
	iters: 400, epoch: 4 | loss: 0.0152853
	speed: 0.0427s/iter; left time: 249.0260s
	iters: 500, epoch: 4 | loss: 0.0136205
	speed: 0.0427s/iter; left time: 244.7655s
	iters: 600, epoch: 4 | loss: 0.0151473
	speed: 0.0427s/iter; left time: 240.4703s
	iters: 700, epoch: 4 | loss: 0.0167133
	speed: 0.0427s/iter; left time: 236.6188s
	iters: 800, epoch: 4 | loss: 0.0141558
	speed: 0.0427s/iter; left time: 232.2853s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.0154854 Vali Loss: 0.0368914 Test Loss: 0.0445472
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0125562
	speed: 0.1529s/iter; left time: 802.0953s
	iters: 200, epoch: 5 | loss: 0.0119047
	speed: 0.0428s/iter; left time: 220.1003s
	iters: 300, epoch: 5 | loss: 0.0114228
	speed: 0.0428s/iter; left time: 216.1855s
	iters: 400, epoch: 5 | loss: 0.0124558
	speed: 0.0429s/iter; left time: 211.9926s
	iters: 500, epoch: 5 | loss: 0.0095058
	speed: 0.0428s/iter; left time: 207.6617s
	iters: 600, epoch: 5 | loss: 0.0092139
	speed: 0.0428s/iter; left time: 202.9588s
	iters: 700, epoch: 5 | loss: 0.0101714
	speed: 0.0427s/iter; left time: 198.3543s
	iters: 800, epoch: 5 | loss: 0.0099094
	speed: 0.0427s/iter; left time: 194.0607s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.34s
Steps: 891 | Train Loss: 0.0113700 Vali Loss: 0.0386358 Test Loss: 0.0474626
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03603537380695343, rmse:0.18982985615730286, mae:0.13202139735221863, rse:0.6722258925437927
Original data scale mse:32859850.0, rmse:5732.35107421875, mae:3690.53515625, rse:0.28547313809394836

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.035045064985752106, RMSE: 0.1872032731771469, MAE: 0.12920968234539032, RSE: 0.6629246473312378
Unscaled Metrics - MSE: 30968164.0, RMSE: 5564.90478515625, MAE: 3569.146484375, RSE: 0.2771342396736145

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.03603537380695343, RMSE: 0.18982985615730286, MAE: 0.13202139735221863, RSE: 0.6722258925437927
Unscaled Metrics - MSE: 32859850.0, RMSE: 5732.35107421875, MAE: 3690.53515625, RSE: 0.28547313809394836

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0336958
	speed: 0.0675s/iter; left time: 593.0589s
	iters: 200, epoch: 1 | loss: 0.0275518
	speed: 0.0433s/iter; left time: 375.9451s
	iters: 300, epoch: 1 | loss: 0.0277910
	speed: 0.0432s/iter; left time: 371.1693s
	iters: 400, epoch: 1 | loss: 0.0320238
	speed: 0.0433s/iter; left time: 367.7548s
	iters: 500, epoch: 1 | loss: 0.0305507
	speed: 0.0433s/iter; left time: 363.0654s
	iters: 600, epoch: 1 | loss: 0.0266151
	speed: 0.0432s/iter; left time: 358.4262s
	iters: 700, epoch: 1 | loss: 0.0258001
	speed: 0.0433s/iter; left time: 354.4698s
	iters: 800, epoch: 1 | loss: 0.0265895
	speed: 0.0432s/iter; left time: 349.8887s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.90s
Steps: 889 | Train Loss: 0.0275991 Vali Loss: 0.0321770 Test Loss: 0.0377074
Validation loss decreased (inf --> 0.032177).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0269805
	speed: 0.1560s/iter; left time: 1233.0749s
	iters: 200, epoch: 2 | loss: 0.0223709
	speed: 0.0432s/iter; left time: 336.9347s
	iters: 300, epoch: 2 | loss: 0.0284553
	speed: 0.0432s/iter; left time: 333.0484s
	iters: 400, epoch: 2 | loss: 0.0243248
	speed: 0.0432s/iter; left time: 328.7509s
	iters: 500, epoch: 2 | loss: 0.0235313
	speed: 0.0432s/iter; left time: 324.2022s
	iters: 600, epoch: 2 | loss: 0.0243723
	speed: 0.0432s/iter; left time: 320.0285s
	iters: 700, epoch: 2 | loss: 0.0205655
	speed: 0.0432s/iter; left time: 315.2636s
	iters: 800, epoch: 2 | loss: 0.0245541
	speed: 0.0432s/iter; left time: 311.4073s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.64s
Steps: 889 | Train Loss: 0.0243995 Vali Loss: 0.0313660 Test Loss: 0.0386110
Validation loss decreased (0.032177 --> 0.031366).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0219679
	speed: 0.1570s/iter; left time: 1101.0176s
	iters: 200, epoch: 3 | loss: 0.0185651
	speed: 0.0432s/iter; left time: 298.9773s
	iters: 300, epoch: 3 | loss: 0.0216196
	speed: 0.0432s/iter; left time: 294.5004s
	iters: 400, epoch: 3 | loss: 0.0229394
	speed: 0.0432s/iter; left time: 289.8230s
	iters: 500, epoch: 3 | loss: 0.0231433
	speed: 0.0432s/iter; left time: 285.8395s
	iters: 600, epoch: 3 | loss: 0.0202164
	speed: 0.0433s/iter; left time: 281.8551s
	iters: 700, epoch: 3 | loss: 0.0192351
	speed: 0.0432s/iter; left time: 277.1798s
	iters: 800, epoch: 3 | loss: 0.0171767
	speed: 0.0433s/iter; left time: 273.1139s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.65s
Steps: 889 | Train Loss: 0.0199984 Vali Loss: 0.0360289 Test Loss: 0.0455055
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0162297
	speed: 0.1534s/iter; left time: 939.1968s
	iters: 200, epoch: 4 | loss: 0.0124574
	speed: 0.0432s/iter; left time: 260.2186s
	iters: 300, epoch: 4 | loss: 0.0172678
	speed: 0.0433s/iter; left time: 256.2979s
	iters: 400, epoch: 4 | loss: 0.0153522
	speed: 0.0433s/iter; left time: 252.2440s
	iters: 500, epoch: 4 | loss: 0.0137240
	speed: 0.0433s/iter; left time: 247.8063s
	iters: 600, epoch: 4 | loss: 0.0138512
	speed: 0.0432s/iter; left time: 243.2112s
	iters: 700, epoch: 4 | loss: 0.0129080
	speed: 0.0432s/iter; left time: 238.8926s
	iters: 800, epoch: 4 | loss: 0.0131985
	speed: 0.0432s/iter; left time: 234.4522s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.65s
Steps: 889 | Train Loss: 0.0146474 Vali Loss: 0.0382402 Test Loss: 0.0497850
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0118652
	speed: 0.1537s/iter; left time: 804.4823s
	iters: 200, epoch: 5 | loss: 0.0103289
	speed: 0.0432s/iter; left time: 221.8596s
	iters: 300, epoch: 5 | loss: 0.0110708
	speed: 0.0433s/iter; left time: 218.1787s
	iters: 400, epoch: 5 | loss: 0.0107497
	speed: 0.0433s/iter; left time: 213.5859s
	iters: 500, epoch: 5 | loss: 0.0105743
	speed: 0.0434s/iter; left time: 209.6938s
	iters: 600, epoch: 5 | loss: 0.0096314
	speed: 0.0433s/iter; left time: 204.8333s
	iters: 700, epoch: 5 | loss: 0.0106433
	speed: 0.0433s/iter; left time: 200.7063s
	iters: 800, epoch: 5 | loss: 0.0091215
	speed: 0.0432s/iter; left time: 196.0176s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.69s
Steps: 889 | Train Loss: 0.0104776 Vali Loss: 0.0408016 Test Loss: 0.0518497
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03861093893647194, rmse:0.19649666547775269, mae:0.13665854930877686, rse:0.6961284875869751
Original data scale mse:35078208.0, rmse:5922.68603515625, mae:3812.864501953125, rse:0.29509666562080383
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0359611
	speed: 0.0456s/iter; left time: 400.9014s
	iters: 200, epoch: 1 | loss: 0.0305847
	speed: 0.0432s/iter; left time: 375.6016s
	iters: 300, epoch: 1 | loss: 0.0329304
	speed: 0.0433s/iter; left time: 371.7022s
	iters: 400, epoch: 1 | loss: 0.0310998
	speed: 0.0432s/iter; left time: 366.6693s
	iters: 500, epoch: 1 | loss: 0.0275226
	speed: 0.0433s/iter; left time: 362.9298s
	iters: 600, epoch: 1 | loss: 0.0220132
	speed: 0.0433s/iter; left time: 358.7802s
	iters: 700, epoch: 1 | loss: 0.0255434
	speed: 0.0432s/iter; left time: 353.8894s
	iters: 800, epoch: 1 | loss: 0.0230196
	speed: 0.0432s/iter; left time: 349.8641s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.71s
Steps: 889 | Train Loss: 0.0276503 Vali Loss: 0.0320385 Test Loss: 0.0376059
Validation loss decreased (inf --> 0.032038).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0272676
	speed: 0.1604s/iter; left time: 1267.5499s
	iters: 200, epoch: 2 | loss: 0.0250907
	speed: 0.0433s/iter; left time: 337.6219s
	iters: 300, epoch: 2 | loss: 0.0260860
	speed: 0.0432s/iter; left time: 332.7208s
	iters: 400, epoch: 2 | loss: 0.0250327
	speed: 0.0432s/iter; left time: 328.5671s
	iters: 500, epoch: 2 | loss: 0.0255473
	speed: 0.0432s/iter; left time: 324.3145s
	iters: 600, epoch: 2 | loss: 0.0246568
	speed: 0.0430s/iter; left time: 318.2438s
	iters: 700, epoch: 2 | loss: 0.0225364
	speed: 0.0430s/iter; left time: 314.0164s
	iters: 800, epoch: 2 | loss: 0.0225365
	speed: 0.0431s/iter; left time: 310.5219s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.63s
Steps: 889 | Train Loss: 0.0244215 Vali Loss: 0.0325945 Test Loss: 0.0400992
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0186854
	speed: 0.1547s/iter; left time: 1084.8794s
	iters: 200, epoch: 3 | loss: 0.0189317
	speed: 0.0432s/iter; left time: 298.5707s
	iters: 300, epoch: 3 | loss: 0.0232559
	speed: 0.0431s/iter; left time: 293.3315s
	iters: 400, epoch: 3 | loss: 0.0214100
	speed: 0.0433s/iter; left time: 290.5354s
	iters: 500, epoch: 3 | loss: 0.0183989
	speed: 0.0432s/iter; left time: 285.8838s
	iters: 600, epoch: 3 | loss: 0.0202461
	speed: 0.0432s/iter; left time: 281.1114s
	iters: 700, epoch: 3 | loss: 0.0178831
	speed: 0.0432s/iter; left time: 277.1765s
	iters: 800, epoch: 3 | loss: 0.0169872
	speed: 0.0432s/iter; left time: 272.6093s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.57s
Steps: 889 | Train Loss: 0.0194532 Vali Loss: 0.0351343 Test Loss: 0.0476060
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0156688
	speed: 0.1542s/iter; left time: 944.4341s
	iters: 200, epoch: 4 | loss: 0.0136872
	speed: 0.0433s/iter; left time: 261.0068s
	iters: 300, epoch: 4 | loss: 0.0140966
	speed: 0.0433s/iter; left time: 256.3088s
	iters: 400, epoch: 4 | loss: 0.0138336
	speed: 0.0432s/iter; left time: 251.7475s
	iters: 500, epoch: 4 | loss: 0.0124785
	speed: 0.0432s/iter; left time: 247.4439s
	iters: 600, epoch: 4 | loss: 0.0119031
	speed: 0.0433s/iter; left time: 243.3074s
	iters: 700, epoch: 4 | loss: 0.0155341
	speed: 0.0432s/iter; left time: 238.6934s
	iters: 800, epoch: 4 | loss: 0.0122225
	speed: 0.0432s/iter; left time: 234.4168s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.69s
Steps: 889 | Train Loss: 0.0139439 Vali Loss: 0.0402674 Test Loss: 0.0492468
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.0376058854162693, rmse:0.19392237067222595, mae:0.1368750035762787, rse:0.6870085597038269
Original data scale mse:34050108.0, rmse:5835.2470703125, mae:3839.478271484375, rse:0.290740042924881

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.03861093893647194, RMSE: 0.19649666547775269, MAE: 0.13665854930877686, RSE: 0.6961284875869751
Unscaled Metrics - MSE: 35078208.0, RMSE: 5922.68603515625, MAE: 3812.864501953125, RSE: 0.29509666562080383

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.0376058854162693, RMSE: 0.19392237067222595, MAE: 0.1368750035762787, RSE: 0.6870085597038269
Unscaled Metrics - MSE: 34050108.0, RMSE: 5835.2470703125, MAE: 3839.478271484375, RSE: 0.290740042924881

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1350967
	speed: 0.0675s/iter; left time: 596.3538s
	iters: 200, epoch: 1 | loss: 0.1420312
	speed: 0.0425s/iter; left time: 371.3936s
	iters: 300, epoch: 1 | loss: 0.1255292
	speed: 0.0425s/iter; left time: 366.8999s
	iters: 400, epoch: 1 | loss: 0.1363435
	speed: 0.0425s/iter; left time: 362.7567s
	iters: 500, epoch: 1 | loss: 0.1305171
	speed: 0.0425s/iter; left time: 358.7195s
	iters: 600, epoch: 1 | loss: 0.1424945
	speed: 0.0425s/iter; left time: 353.8047s
	iters: 700, epoch: 1 | loss: 0.1252133
	speed: 0.0427s/iter; left time: 351.3114s
	iters: 800, epoch: 1 | loss: 0.1236854
	speed: 0.0425s/iter; left time: 345.2662s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.42s
Steps: 893 | Train Loss: 0.1290060 Vali Loss: 0.0206608 Test Loss: 0.0223194
Validation loss decreased (inf --> 0.020661).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1363344
	speed: 0.1542s/iter; left time: 1224.1825s
	iters: 200, epoch: 2 | loss: 0.1335109
	speed: 0.0426s/iter; left time: 333.7850s
	iters: 300, epoch: 2 | loss: 0.1115886
	speed: 0.0425s/iter; left time: 328.7855s
	iters: 400, epoch: 2 | loss: 0.1164773
	speed: 0.0425s/iter; left time: 324.6873s
	iters: 500, epoch: 2 | loss: 0.1129846
	speed: 0.0425s/iter; left time: 320.4549s
	iters: 600, epoch: 2 | loss: 0.1131861
	speed: 0.0425s/iter; left time: 316.1980s
	iters: 700, epoch: 2 | loss: 0.1245049
	speed: 0.0424s/iter; left time: 311.3802s
	iters: 800, epoch: 2 | loss: 0.1075016
	speed: 0.0425s/iter; left time: 307.5424s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.16s
Steps: 893 | Train Loss: 0.1182092 Vali Loss: 0.0202321 Test Loss: 0.0226576
Validation loss decreased (0.020661 --> 0.020232).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0917212
	speed: 0.1554s/iter; left time: 1094.4983s
	iters: 200, epoch: 3 | loss: 0.1115365
	speed: 0.0426s/iter; left time: 295.6504s
	iters: 300, epoch: 3 | loss: 0.1022477
	speed: 0.0426s/iter; left time: 291.3312s
	iters: 400, epoch: 3 | loss: 0.1051710
	speed: 0.0425s/iter; left time: 286.8327s
	iters: 500, epoch: 3 | loss: 0.1028769
	speed: 0.0425s/iter; left time: 282.1794s
	iters: 600, epoch: 3 | loss: 0.1118995
	speed: 0.0425s/iter; left time: 277.8460s
	iters: 700, epoch: 3 | loss: 0.0920849
	speed: 0.0426s/iter; left time: 274.5434s
	iters: 800, epoch: 3 | loss: 0.1228990
	speed: 0.0424s/iter; left time: 269.2742s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.19s
Steps: 893 | Train Loss: 0.1119564 Vali Loss: 0.0195025 Test Loss: 0.0215181
Validation loss decreased (0.020232 --> 0.019503).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1056295
	speed: 0.1549s/iter; left time: 953.1333s
	iters: 200, epoch: 4 | loss: 0.1062738
	speed: 0.0425s/iter; left time: 257.3976s
	iters: 300, epoch: 4 | loss: 0.1069851
	speed: 0.0425s/iter; left time: 252.6865s
	iters: 400, epoch: 4 | loss: 0.0964099
	speed: 0.0424s/iter; left time: 248.3499s
	iters: 500, epoch: 4 | loss: 0.1313533
	speed: 0.0426s/iter; left time: 244.9283s
	iters: 600, epoch: 4 | loss: 0.1023512
	speed: 0.0425s/iter; left time: 240.3528s
	iters: 700, epoch: 4 | loss: 0.1074806
	speed: 0.0424s/iter; left time: 235.5697s
	iters: 800, epoch: 4 | loss: 0.1164315
	speed: 0.0424s/iter; left time: 231.3778s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.14s
Steps: 893 | Train Loss: 0.1090867 Vali Loss: 0.0199321 Test Loss: 0.0221008
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1024238
	speed: 0.1528s/iter; left time: 803.4116s
	iters: 200, epoch: 5 | loss: 0.0909193
	speed: 0.0426s/iter; left time: 219.8146s
	iters: 300, epoch: 5 | loss: 0.1086716
	speed: 0.0425s/iter; left time: 215.0014s
	iters: 400, epoch: 5 | loss: 0.0993418
	speed: 0.0425s/iter; left time: 210.6249s
	iters: 500, epoch: 5 | loss: 0.1037285
	speed: 0.0425s/iter; left time: 206.4401s
	iters: 600, epoch: 5 | loss: 0.0967105
	speed: 0.0424s/iter; left time: 201.7542s
	iters: 700, epoch: 5 | loss: 0.1011259
	speed: 0.0425s/iter; left time: 198.0248s
	iters: 800, epoch: 5 | loss: 0.1025381
	speed: 0.0426s/iter; left time: 194.0126s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.16s
Steps: 893 | Train Loss: 0.1068112 Vali Loss: 0.0196992 Test Loss: 0.0221876
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0923343
	speed: 0.1523s/iter; left time: 665.0950s
	iters: 200, epoch: 6 | loss: 0.1151687
	speed: 0.0424s/iter; left time: 180.9051s
	iters: 300, epoch: 6 | loss: 0.0963678
	speed: 0.0424s/iter; left time: 176.7065s
	iters: 400, epoch: 6 | loss: 0.0901735
	speed: 0.0424s/iter; left time: 172.4124s
	iters: 500, epoch: 6 | loss: 0.0988669
	speed: 0.0427s/iter; left time: 169.2106s
	iters: 600, epoch: 6 | loss: 0.1059128
	speed: 0.0426s/iter; left time: 164.7692s
	iters: 700, epoch: 6 | loss: 0.0918537
	speed: 0.0426s/iter; left time: 160.3288s
	iters: 800, epoch: 6 | loss: 0.1067557
	speed: 0.0424s/iter; left time: 155.5236s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.15s
Steps: 893 | Train Loss: 0.1031106 Vali Loss: 0.0214505 Test Loss: 0.0241462
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021518126130104065, rmse:0.14669057726860046, mae:0.0940595418214798, rse:0.5180417895317078
Original data scale mse:17274290.0, rmse:4156.23486328125, mae:2560.883056640625, rse:0.20665638148784637
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.1545426
	speed: 0.0445s/iter; left time: 393.3964s
	iters: 200, epoch: 1 | loss: 0.1211924
	speed: 0.0424s/iter; left time: 370.4084s
	iters: 300, epoch: 1 | loss: 0.1232815
	speed: 0.0425s/iter; left time: 366.5918s
	iters: 400, epoch: 1 | loss: 0.1164890
	speed: 0.0424s/iter; left time: 361.9116s
	iters: 500, epoch: 1 | loss: 0.1270251
	speed: 0.0424s/iter; left time: 357.7636s
	iters: 600, epoch: 1 | loss: 0.1249656
	speed: 0.0425s/iter; left time: 353.6757s
	iters: 700, epoch: 1 | loss: 0.1255756
	speed: 0.0425s/iter; left time: 350.1521s
	iters: 800, epoch: 1 | loss: 0.1321101
	speed: 0.0425s/iter; left time: 345.7987s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.19s
Steps: 893 | Train Loss: 0.1289450 Vali Loss: 0.0205260 Test Loss: 0.0223603
Validation loss decreased (inf --> 0.020526).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1247080
	speed: 0.1555s/iter; left time: 1234.3744s
	iters: 200, epoch: 2 | loss: 0.1241332
	speed: 0.0424s/iter; left time: 332.6072s
	iters: 300, epoch: 2 | loss: 0.1169892
	speed: 0.0425s/iter; left time: 328.5593s
	iters: 400, epoch: 2 | loss: 0.1169359
	speed: 0.0425s/iter; left time: 324.3965s
	iters: 500, epoch: 2 | loss: 0.1100132
	speed: 0.0424s/iter; left time: 319.7414s
	iters: 600, epoch: 2 | loss: 0.1097182
	speed: 0.0427s/iter; left time: 317.2649s
	iters: 700, epoch: 2 | loss: 0.0934435
	speed: 0.0427s/iter; left time: 313.1296s
	iters: 800, epoch: 2 | loss: 0.1157354
	speed: 0.0425s/iter; left time: 307.9078s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.20s
Steps: 893 | Train Loss: 0.1178395 Vali Loss: 0.0192519 Test Loss: 0.0214008
Validation loss decreased (0.020526 --> 0.019252).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0992918
	speed: 0.1537s/iter; left time: 1082.8968s
	iters: 200, epoch: 3 | loss: 0.1059680
	speed: 0.0425s/iter; left time: 294.9487s
	iters: 300, epoch: 3 | loss: 0.1040523
	speed: 0.0426s/iter; left time: 291.4055s
	iters: 400, epoch: 3 | loss: 0.1044981
	speed: 0.0425s/iter; left time: 286.3297s
	iters: 500, epoch: 3 | loss: 0.1093330
	speed: 0.0424s/iter; left time: 281.7873s
	iters: 600, epoch: 3 | loss: 0.1081880
	speed: 0.0424s/iter; left time: 277.5301s
	iters: 700, epoch: 3 | loss: 0.0950932
	speed: 0.0424s/iter; left time: 273.0997s
	iters: 800, epoch: 3 | loss: 0.1036208
	speed: 0.0425s/iter; left time: 269.7940s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.12s
Steps: 893 | Train Loss: 0.1118597 Vali Loss: 0.0194159 Test Loss: 0.0213597
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1077452
	speed: 0.1516s/iter; left time: 932.9019s
	iters: 200, epoch: 4 | loss: 0.0975025
	speed: 0.0425s/iter; left time: 257.2398s
	iters: 300, epoch: 4 | loss: 0.1057355
	speed: 0.0425s/iter; left time: 252.7828s
	iters: 400, epoch: 4 | loss: 0.1173507
	speed: 0.0425s/iter; left time: 248.8110s
	iters: 500, epoch: 4 | loss: 0.1149111
	speed: 0.0425s/iter; left time: 244.5340s
	iters: 600, epoch: 4 | loss: 0.1181302
	speed: 0.0425s/iter; left time: 240.1403s
	iters: 700, epoch: 4 | loss: 0.1015757
	speed: 0.0424s/iter; left time: 235.5759s
	iters: 800, epoch: 4 | loss: 0.1176182
	speed: 0.0425s/iter; left time: 231.7322s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.12s
Steps: 893 | Train Loss: 0.1092216 Vali Loss: 0.0199139 Test Loss: 0.0219621
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1028859
	speed: 0.1511s/iter; left time: 794.5016s
	iters: 200, epoch: 5 | loss: 0.1025548
	speed: 0.0425s/iter; left time: 219.4566s
	iters: 300, epoch: 5 | loss: 0.1054140
	speed: 0.0425s/iter; left time: 214.8455s
	iters: 400, epoch: 5 | loss: 0.1111270
	speed: 0.0425s/iter; left time: 210.7226s
	iters: 500, epoch: 5 | loss: 0.0901895
	speed: 0.0425s/iter; left time: 206.2743s
	iters: 600, epoch: 5 | loss: 0.1091653
	speed: 0.0425s/iter; left time: 202.0335s
	iters: 700, epoch: 5 | loss: 0.1024881
	speed: 0.0424s/iter; left time: 197.7389s
	iters: 800, epoch: 5 | loss: 0.1036616
	speed: 0.0426s/iter; left time: 194.3663s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.12s
Steps: 893 | Train Loss: 0.1065149 Vali Loss: 0.0199545 Test Loss: 0.0224478
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02140084095299244, rmse:0.14629025757312775, mae:0.09408330172300339, rse:0.5166280269622803
Original data scale mse:17063130.0, rmse:4130.75439453125, mae:2569.022216796875, rse:0.20538942515850067

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.021518126130104065, RMSE: 0.14669057726860046, MAE: 0.0940595418214798, RSE: 0.5180417895317078
Unscaled Metrics - MSE: 17274290.0, RMSE: 4156.23486328125, MAE: 2560.883056640625, RSE: 0.20665638148784637

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.02140084095299244, RMSE: 0.14629025757312775, MAE: 0.09408330172300339, RSE: 0.5166280269622803
Unscaled Metrics - MSE: 17063130.0, RMSE: 4130.75439453125, MAE: 2569.022216796875, RSE: 0.20538942515850067

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1814623
	speed: 0.0676s/iter; left time: 595.9939s
	iters: 200, epoch: 1 | loss: 0.1549098
	speed: 0.0428s/iter; left time: 372.5763s
	iters: 300, epoch: 1 | loss: 0.1584294
	speed: 0.0428s/iter; left time: 368.8041s
	iters: 400, epoch: 1 | loss: 0.1463351
	speed: 0.0428s/iter; left time: 364.0468s
	iters: 500, epoch: 1 | loss: 0.1587598
	speed: 0.0429s/iter; left time: 360.7863s
	iters: 600, epoch: 1 | loss: 0.1465916
	speed: 0.0429s/iter; left time: 356.2721s
	iters: 700, epoch: 1 | loss: 0.1560166
	speed: 0.0428s/iter; left time: 351.3457s
	iters: 800, epoch: 1 | loss: 0.1685595
	speed: 0.0429s/iter; left time: 347.9278s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.61s
Steps: 891 | Train Loss: 0.1594781 Vali Loss: 0.0307007 Test Loss: 0.0356316
Validation loss decreased (inf --> 0.030701).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1568940
	speed: 0.1541s/iter; left time: 1220.4008s
	iters: 200, epoch: 2 | loss: 0.1489389
	speed: 0.0430s/iter; left time: 335.9917s
	iters: 300, epoch: 2 | loss: 0.1422157
	speed: 0.0429s/iter; left time: 331.3679s
	iters: 400, epoch: 2 | loss: 0.1543713
	speed: 0.0428s/iter; left time: 326.0290s
	iters: 500, epoch: 2 | loss: 0.1362207
	speed: 0.0429s/iter; left time: 322.5290s
	iters: 600, epoch: 2 | loss: 0.1331256
	speed: 0.0428s/iter; left time: 317.3910s
	iters: 700, epoch: 2 | loss: 0.1337022
	speed: 0.0428s/iter; left time: 313.4602s
	iters: 800, epoch: 2 | loss: 0.1568871
	speed: 0.0428s/iter; left time: 309.1001s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.39s
Steps: 891 | Train Loss: 0.1500987 Vali Loss: 0.0296340 Test Loss: 0.0350939
Validation loss decreased (0.030701 --> 0.029634).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1377389
	speed: 0.1593s/iter; left time: 1119.9292s
	iters: 200, epoch: 3 | loss: 0.1435285
	speed: 0.0429s/iter; left time: 297.3758s
	iters: 300, epoch: 3 | loss: 0.1495669
	speed: 0.0430s/iter; left time: 293.4450s
	iters: 400, epoch: 3 | loss: 0.1420835
	speed: 0.0429s/iter; left time: 288.8701s
	iters: 500, epoch: 3 | loss: 0.1486267
	speed: 0.0429s/iter; left time: 284.1410s
	iters: 600, epoch: 3 | loss: 0.1295402
	speed: 0.0428s/iter; left time: 279.2172s
	iters: 700, epoch: 3 | loss: 0.1468042
	speed: 0.0428s/iter; left time: 275.2522s
	iters: 800, epoch: 3 | loss: 0.1282526
	speed: 0.0427s/iter; left time: 270.4116s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.40s
Steps: 891 | Train Loss: 0.1414028 Vali Loss: 0.0320937 Test Loss: 0.0387196
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1363539
	speed: 0.1522s/iter; left time: 934.2523s
	iters: 200, epoch: 4 | loss: 0.1375028
	speed: 0.0428s/iter; left time: 258.4950s
	iters: 300, epoch: 4 | loss: 0.1330649
	speed: 0.0428s/iter; left time: 253.9744s
	iters: 400, epoch: 4 | loss: 0.1284030
	speed: 0.0429s/iter; left time: 250.5335s
	iters: 500, epoch: 4 | loss: 0.1296627
	speed: 0.0428s/iter; left time: 245.4922s
	iters: 600, epoch: 4 | loss: 0.1217408
	speed: 0.0428s/iter; left time: 241.3009s
	iters: 700, epoch: 4 | loss: 0.1244254
	speed: 0.0428s/iter; left time: 237.0389s
	iters: 800, epoch: 4 | loss: 0.1128398
	speed: 0.0428s/iter; left time: 232.7588s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.33s
Steps: 891 | Train Loss: 0.1260484 Vali Loss: 0.0348196 Test Loss: 0.0468632
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1105387
	speed: 0.1519s/iter; left time: 796.8976s
	iters: 200, epoch: 5 | loss: 0.1118334
	speed: 0.0428s/iter; left time: 220.1709s
	iters: 300, epoch: 5 | loss: 0.1173432
	speed: 0.0430s/iter; left time: 217.1784s
	iters: 400, epoch: 5 | loss: 0.1127749
	speed: 0.0429s/iter; left time: 212.2728s
	iters: 500, epoch: 5 | loss: 0.1049295
	speed: 0.0430s/iter; left time: 208.4322s
	iters: 600, epoch: 5 | loss: 0.1025971
	speed: 0.0430s/iter; left time: 203.9761s
	iters: 700, epoch: 5 | loss: 0.0991172
	speed: 0.0430s/iter; left time: 199.7494s
	iters: 800, epoch: 5 | loss: 0.0887636
	speed: 0.0429s/iter; left time: 194.8710s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.42s
Steps: 891 | Train Loss: 0.1064233 Vali Loss: 0.0383373 Test Loss: 0.0480545
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03509388864040375, rmse:0.1873336285352707, mae:0.1296379417181015, rse:0.6633862853050232
Original data scale mse:31071448.0, rmse:5574.1767578125, mae:3584.55615234375, rse:0.27759599685668945
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1584388
	speed: 0.0446s/iter; left time: 393.3571s
	iters: 200, epoch: 1 | loss: 0.1495694
	speed: 0.0428s/iter; left time: 372.7798s
	iters: 300, epoch: 1 | loss: 0.1723920
	speed: 0.0427s/iter; left time: 367.9340s
	iters: 400, epoch: 1 | loss: 0.1723190
	speed: 0.0428s/iter; left time: 363.9423s
	iters: 500, epoch: 1 | loss: 0.1466329
	speed: 0.0429s/iter; left time: 360.4431s
	iters: 600, epoch: 1 | loss: 0.1658001
	speed: 0.0429s/iter; left time: 356.3060s
	iters: 700, epoch: 1 | loss: 0.1555168
	speed: 0.0428s/iter; left time: 351.3839s
	iters: 800, epoch: 1 | loss: 0.1498767
	speed: 0.0427s/iter; left time: 346.4501s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.36s
Steps: 891 | Train Loss: 0.1593405 Vali Loss: 0.0307201 Test Loss: 0.0355679
Validation loss decreased (inf --> 0.030720).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1528472
	speed: 0.1564s/iter; left time: 1238.8918s
	iters: 200, epoch: 2 | loss: 0.1434784
	speed: 0.0429s/iter; left time: 335.3442s
	iters: 300, epoch: 2 | loss: 0.1505392
	speed: 0.0427s/iter; left time: 329.8248s
	iters: 400, epoch: 2 | loss: 0.1501380
	speed: 0.0428s/iter; left time: 325.8127s
	iters: 500, epoch: 2 | loss: 0.1336639
	speed: 0.0430s/iter; left time: 323.3080s
	iters: 600, epoch: 2 | loss: 0.1500371
	speed: 0.0429s/iter; left time: 317.9597s
	iters: 700, epoch: 2 | loss: 0.1574402
	speed: 0.0429s/iter; left time: 313.8828s
	iters: 800, epoch: 2 | loss: 0.1472396
	speed: 0.0429s/iter; left time: 309.3815s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.46s
Steps: 891 | Train Loss: 0.1503738 Vali Loss: 0.0293700 Test Loss: 0.0361260
Validation loss decreased (0.030720 --> 0.029370).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1470705
	speed: 0.1549s/iter; left time: 1088.5264s
	iters: 200, epoch: 3 | loss: 0.1376615
	speed: 0.0428s/iter; left time: 296.8484s
	iters: 300, epoch: 3 | loss: 0.1335509
	speed: 0.0430s/iter; left time: 293.6047s
	iters: 400, epoch: 3 | loss: 0.1365210
	speed: 0.0429s/iter; left time: 288.8365s
	iters: 500, epoch: 3 | loss: 0.1323292
	speed: 0.0428s/iter; left time: 283.5409s
	iters: 600, epoch: 3 | loss: 0.1371632
	speed: 0.0428s/iter; left time: 279.5432s
	iters: 700, epoch: 3 | loss: 0.1484529
	speed: 0.0428s/iter; left time: 275.3581s
	iters: 800, epoch: 3 | loss: 0.1351569
	speed: 0.0428s/iter; left time: 271.1522s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.39s
Steps: 891 | Train Loss: 0.1398348 Vali Loss: 0.0332601 Test Loss: 0.0410655
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1267863
	speed: 0.1523s/iter; left time: 934.6339s
	iters: 200, epoch: 4 | loss: 0.1216621
	speed: 0.0429s/iter; left time: 259.0478s
	iters: 300, epoch: 4 | loss: 0.1244940
	speed: 0.0428s/iter; left time: 254.0617s
	iters: 400, epoch: 4 | loss: 0.1225908
	speed: 0.0428s/iter; left time: 249.8053s
	iters: 500, epoch: 4 | loss: 0.1150749
	speed: 0.0426s/iter; left time: 244.2097s
	iters: 600, epoch: 4 | loss: 0.1234124
	speed: 0.0426s/iter; left time: 240.3710s
	iters: 700, epoch: 4 | loss: 0.1311453
	speed: 0.0428s/iter; left time: 237.1677s
	iters: 800, epoch: 4 | loss: 0.1176136
	speed: 0.0428s/iter; left time: 232.8463s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.1248351 Vali Loss: 0.0351462 Test Loss: 0.0437282
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1090962
	speed: 0.1532s/iter; left time: 803.6812s
	iters: 200, epoch: 5 | loss: 0.1051212
	speed: 0.0429s/iter; left time: 220.7234s
	iters: 300, epoch: 5 | loss: 0.1058841
	speed: 0.0427s/iter; left time: 215.6150s
	iters: 400, epoch: 5 | loss: 0.1100815
	speed: 0.0425s/iter; left time: 210.0150s
	iters: 500, epoch: 5 | loss: 0.1009246
	speed: 0.0427s/iter; left time: 206.7734s
	iters: 600, epoch: 5 | loss: 0.0994223
	speed: 0.0428s/iter; left time: 203.1194s
	iters: 700, epoch: 5 | loss: 0.0988644
	speed: 0.0428s/iter; left time: 199.0226s
	iters: 800, epoch: 5 | loss: 0.1001475
	speed: 0.0428s/iter; left time: 194.7315s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.1068320 Vali Loss: 0.0393032 Test Loss: 0.0478743
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03612596541643143, rmse:0.190068319439888, mae:0.1320345103740692, rse:0.6730703115463257
Original data scale mse:32765476.0, rmse:5724.11376953125, mae:3690.989990234375, rse:0.28506290912628174

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.03509388864040375, RMSE: 0.1873336285352707, MAE: 0.1296379417181015, RSE: 0.6633862853050232
Unscaled Metrics - MSE: 31071448.0, RMSE: 5574.1767578125, MAE: 3584.55615234375, RSE: 0.27759599685668945

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.03612596541643143, RMSE: 0.190068319439888, MAE: 0.1320345103740692, RSE: 0.6730703115463257
Unscaled Metrics - MSE: 32765476.0, RMSE: 5724.11376953125, MAE: 3690.989990234375, RSE: 0.28506290912628174

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1833597
	speed: 0.0671s/iter; left time: 589.5732s
	iters: 200, epoch: 1 | loss: 0.1659133
	speed: 0.0433s/iter; left time: 375.9150s
	iters: 300, epoch: 1 | loss: 0.1663503
	speed: 0.0433s/iter; left time: 371.8674s
	iters: 400, epoch: 1 | loss: 0.1786418
	speed: 0.0432s/iter; left time: 367.1758s
	iters: 500, epoch: 1 | loss: 0.1744389
	speed: 0.0432s/iter; left time: 362.8451s
	iters: 600, epoch: 1 | loss: 0.1627810
	speed: 0.0433s/iter; left time: 358.7164s
	iters: 700, epoch: 1 | loss: 0.1605619
	speed: 0.0433s/iter; left time: 354.5673s
	iters: 800, epoch: 1 | loss: 0.1629204
	speed: 0.0433s/iter; left time: 350.0684s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.93s
Steps: 889 | Train Loss: 0.1653704 Vali Loss: 0.0321301 Test Loss: 0.0376642
Validation loss decreased (inf --> 0.032130).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1640930
	speed: 0.1550s/iter; left time: 1224.7653s
	iters: 200, epoch: 2 | loss: 0.1498783
	speed: 0.0433s/iter; left time: 337.5559s
	iters: 300, epoch: 2 | loss: 0.1684814
	speed: 0.0434s/iter; left time: 333.9663s
	iters: 400, epoch: 2 | loss: 0.1556837
	speed: 0.0434s/iter; left time: 329.6220s
	iters: 500, epoch: 2 | loss: 0.1532064
	speed: 0.0434s/iter; left time: 325.4889s
	iters: 600, epoch: 2 | loss: 0.1554348
	speed: 0.0433s/iter; left time: 320.2604s
	iters: 700, epoch: 2 | loss: 0.1436202
	speed: 0.0433s/iter; left time: 316.2454s
	iters: 800, epoch: 2 | loss: 0.1553872
	speed: 0.0434s/iter; left time: 312.7635s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.74s
Steps: 889 | Train Loss: 0.1559100 Vali Loss: 0.0321198 Test Loss: 0.0385519
Validation loss decreased (0.032130 --> 0.032120).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1463879
	speed: 0.1570s/iter; left time: 1100.7400s
	iters: 200, epoch: 3 | loss: 0.1366018
	speed: 0.0433s/iter; left time: 299.0091s
	iters: 300, epoch: 3 | loss: 0.1475531
	speed: 0.0433s/iter; left time: 294.7994s
	iters: 400, epoch: 3 | loss: 0.1528376
	speed: 0.0433s/iter; left time: 290.8106s
	iters: 500, epoch: 3 | loss: 0.1497862
	speed: 0.0432s/iter; left time: 285.7162s
	iters: 600, epoch: 3 | loss: 0.1434129
	speed: 0.0433s/iter; left time: 281.7983s
	iters: 700, epoch: 3 | loss: 0.1414113
	speed: 0.0432s/iter; left time: 277.3371s
	iters: 800, epoch: 3 | loss: 0.1361767
	speed: 0.0432s/iter; left time: 272.8447s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.64s
Steps: 889 | Train Loss: 0.1413851 Vali Loss: 0.0361166 Test Loss: 0.0448900
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1258863
	speed: 0.1529s/iter; left time: 936.1930s
	iters: 200, epoch: 4 | loss: 0.1157237
	speed: 0.0433s/iter; left time: 260.5720s
	iters: 300, epoch: 4 | loss: 0.1304979
	speed: 0.0433s/iter; left time: 256.2144s
	iters: 400, epoch: 4 | loss: 0.1218902
	speed: 0.0433s/iter; left time: 252.0212s
	iters: 500, epoch: 4 | loss: 0.1187251
	speed: 0.0434s/iter; left time: 248.4861s
	iters: 600, epoch: 4 | loss: 0.1098248
	speed: 0.0433s/iter; left time: 243.4990s
	iters: 700, epoch: 4 | loss: 0.1150657
	speed: 0.0433s/iter; left time: 239.2571s
	iters: 800, epoch: 4 | loss: 0.1137168
	speed: 0.0433s/iter; left time: 235.0367s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.1197595 Vali Loss: 0.0386829 Test Loss: 0.0492161
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1095584
	speed: 0.1527s/iter; left time: 799.4026s
	iters: 200, epoch: 5 | loss: 0.0997966
	speed: 0.0433s/iter; left time: 222.5521s
	iters: 300, epoch: 5 | loss: 0.1038068
	speed: 0.0434s/iter; left time: 218.4263s
	iters: 400, epoch: 5 | loss: 0.1009282
	speed: 0.0432s/iter; left time: 213.4164s
	iters: 500, epoch: 5 | loss: 0.1003426
	speed: 0.0433s/iter; left time: 209.1226s
	iters: 600, epoch: 5 | loss: 0.0962209
	speed: 0.0433s/iter; left time: 204.9426s
	iters: 700, epoch: 5 | loss: 0.1001341
	speed: 0.0432s/iter; left time: 200.3518s
	iters: 800, epoch: 5 | loss: 0.0953031
	speed: 0.0433s/iter; left time: 196.4846s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.1005519 Vali Loss: 0.0405882 Test Loss: 0.0512522
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03855190426111221, rmse:0.19634638726711273, mae:0.13726891577243805, rse:0.6955961585044861
Original data scale mse:34756880.0, rmse:5895.49658203125, mae:3835.135009765625, rse:0.29374197125434875
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1893356
	speed: 0.0456s/iter; left time: 400.8901s
	iters: 200, epoch: 1 | loss: 0.1745470
	speed: 0.0433s/iter; left time: 376.3877s
	iters: 300, epoch: 1 | loss: 0.1811636
	speed: 0.0433s/iter; left time: 371.8289s
	iters: 400, epoch: 1 | loss: 0.1759656
	speed: 0.0433s/iter; left time: 367.7388s
	iters: 500, epoch: 1 | loss: 0.1655199
	speed: 0.0433s/iter; left time: 363.4309s
	iters: 600, epoch: 1 | loss: 0.1480404
	speed: 0.0435s/iter; left time: 360.7893s
	iters: 700, epoch: 1 | loss: 0.1595656
	speed: 0.0433s/iter; left time: 354.3005s
	iters: 800, epoch: 1 | loss: 0.1515472
	speed: 0.0433s/iter; left time: 350.3796s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.79s
Steps: 889 | Train Loss: 0.1655817 Vali Loss: 0.0319932 Test Loss: 0.0375708
Validation loss decreased (inf --> 0.031993).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1651777
	speed: 0.1572s/iter; left time: 1242.3328s
	iters: 200, epoch: 2 | loss: 0.1581006
	speed: 0.0433s/iter; left time: 337.7233s
	iters: 300, epoch: 2 | loss: 0.1623181
	speed: 0.0434s/iter; left time: 334.3975s
	iters: 400, epoch: 2 | loss: 0.1586005
	speed: 0.0435s/iter; left time: 330.8515s
	iters: 500, epoch: 2 | loss: 0.1598203
	speed: 0.0436s/iter; left time: 326.7911s
	iters: 600, epoch: 2 | loss: 0.1567608
	speed: 0.0434s/iter; left time: 321.0831s
	iters: 700, epoch: 2 | loss: 0.1486650
	speed: 0.0434s/iter; left time: 317.1089s
	iters: 800, epoch: 2 | loss: 0.1487565
	speed: 0.0434s/iter; left time: 312.6277s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.82s
Steps: 889 | Train Loss: 0.1560612 Vali Loss: 0.0327080 Test Loss: 0.0405051
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1369832
	speed: 0.1558s/iter; left time: 1092.6650s
	iters: 200, epoch: 3 | loss: 0.1387993
	speed: 0.0433s/iter; left time: 299.3142s
	iters: 300, epoch: 3 | loss: 0.1552020
	speed: 0.0434s/iter; left time: 295.7429s
	iters: 400, epoch: 3 | loss: 0.1466940
	speed: 0.0434s/iter; left time: 291.1661s
	iters: 500, epoch: 3 | loss: 0.1334032
	speed: 0.0435s/iter; left time: 287.8082s
	iters: 600, epoch: 3 | loss: 0.1432761
	speed: 0.0433s/iter; left time: 282.0641s
	iters: 700, epoch: 3 | loss: 0.1340335
	speed: 0.0434s/iter; left time: 278.4751s
	iters: 800, epoch: 3 | loss: 0.1315754
	speed: 0.0434s/iter; left time: 273.8204s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.81s
Steps: 889 | Train Loss: 0.1402110 Vali Loss: 0.0368857 Test Loss: 0.0443950
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1251242
	speed: 0.1545s/iter; left time: 945.8634s
	iters: 200, epoch: 4 | loss: 0.1200764
	speed: 0.0434s/iter; left time: 261.5699s
	iters: 300, epoch: 4 | loss: 0.1197645
	speed: 0.0433s/iter; left time: 256.5109s
	iters: 400, epoch: 4 | loss: 0.1145095
	speed: 0.0434s/iter; left time: 252.7418s
	iters: 500, epoch: 4 | loss: 0.1136019
	speed: 0.0434s/iter; left time: 248.2165s
	iters: 600, epoch: 4 | loss: 0.1082838
	speed: 0.0433s/iter; left time: 243.2750s
	iters: 700, epoch: 4 | loss: 0.1237357
	speed: 0.0434s/iter; left time: 239.6804s
	iters: 800, epoch: 4 | loss: 0.1096122
	speed: 0.0433s/iter; left time: 234.9662s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.77s
Steps: 889 | Train Loss: 0.1184306 Vali Loss: 0.0396475 Test Loss: 0.0498719
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03757075220346451, rmse:0.19383175671100616, mae:0.13670550286769867, rse:0.6866875886917114
Original data scale mse:33994724.0, rmse:5830.49951171875, mae:3832.401611328125, rse:0.29050347208976746

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.03855190426111221, RMSE: 0.19634638726711273, MAE: 0.13726891577243805, RSE: 0.6955961585044861
Unscaled Metrics - MSE: 34756880.0, RMSE: 5895.49658203125, MAE: 3835.135009765625, RSE: 0.29374197125434875

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.03757075220346451, RMSE: 0.19383175671100616, MAE: 0.13670550286769867, RSE: 0.6866875886917114
Unscaled Metrics - MSE: 33994724.0, RMSE: 5830.49951171875, MAE: 3832.401611328125, RSE: 0.29050347208976746

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0982269
	speed: 0.0685s/iter; left time: 604.5934s
	iters: 200, epoch: 1 | loss: 0.1013101
	speed: 0.0425s/iter; left time: 370.7379s
	iters: 300, epoch: 1 | loss: 0.0868055
	speed: 0.0424s/iter; left time: 366.0140s
	iters: 400, epoch: 1 | loss: 0.0897896
	speed: 0.0425s/iter; left time: 362.3425s
	iters: 500, epoch: 1 | loss: 0.0854713
	speed: 0.0424s/iter; left time: 357.5310s
	iters: 600, epoch: 1 | loss: 0.0940049
	speed: 0.0425s/iter; left time: 353.8167s
	iters: 700, epoch: 1 | loss: 0.0845092
	speed: 0.0425s/iter; left time: 349.8106s
	iters: 800, epoch: 1 | loss: 0.0827740
	speed: 0.0423s/iter; left time: 343.6473s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.33s
Steps: 893 | Train Loss: 0.0894404 Vali Loss: 0.0932369 Test Loss: 0.0948404
Validation loss decreased (inf --> 0.093237).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0930060
	speed: 0.1547s/iter; left time: 1227.8678s
	iters: 200, epoch: 2 | loss: 0.0909547
	speed: 0.0422s/iter; left time: 330.4414s
	iters: 300, epoch: 2 | loss: 0.0749568
	speed: 0.0423s/iter; left time: 327.0418s
	iters: 400, epoch: 2 | loss: 0.0837843
	speed: 0.0421s/iter; left time: 321.5717s
	iters: 500, epoch: 2 | loss: 0.0746110
	speed: 0.0424s/iter; left time: 319.6912s
	iters: 600, epoch: 2 | loss: 0.0760855
	speed: 0.0424s/iter; left time: 315.5403s
	iters: 700, epoch: 2 | loss: 0.0800584
	speed: 0.0424s/iter; left time: 311.4405s
	iters: 800, epoch: 2 | loss: 0.0686675
	speed: 0.0424s/iter; left time: 306.9893s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.0785074 Vali Loss: 0.0889835 Test Loss: 0.0917395
Validation loss decreased (0.093237 --> 0.088983).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0594261
	speed: 0.1537s/iter; left time: 1082.9652s
	iters: 200, epoch: 3 | loss: 0.0736717
	speed: 0.0424s/iter; left time: 294.4839s
	iters: 300, epoch: 3 | loss: 0.0689235
	speed: 0.0424s/iter; left time: 290.1999s
	iters: 400, epoch: 3 | loss: 0.0703454
	speed: 0.0424s/iter; left time: 285.8444s
	iters: 500, epoch: 3 | loss: 0.0640562
	speed: 0.0426s/iter; left time: 282.7980s
	iters: 600, epoch: 3 | loss: 0.0739933
	speed: 0.0425s/iter; left time: 277.9191s
	iters: 700, epoch: 3 | loss: 0.0605377
	speed: 0.0424s/iter; left time: 273.3293s
	iters: 800, epoch: 3 | loss: 0.0779187
	speed: 0.0424s/iter; left time: 269.1755s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.10s
Steps: 893 | Train Loss: 0.0719159 Vali Loss: 0.0878696 Test Loss: 0.0904880
Validation loss decreased (0.088983 --> 0.087870).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0705446
	speed: 0.1535s/iter; left time: 944.5809s
	iters: 200, epoch: 4 | loss: 0.0677454
	speed: 0.0424s/iter; left time: 256.4181s
	iters: 300, epoch: 4 | loss: 0.0742365
	speed: 0.0423s/iter; left time: 251.9970s
	iters: 400, epoch: 4 | loss: 0.0595334
	speed: 0.0424s/iter; left time: 247.9410s
	iters: 500, epoch: 4 | loss: 0.0863025
	speed: 0.0424s/iter; left time: 243.6109s
	iters: 600, epoch: 4 | loss: 0.0667366
	speed: 0.0424s/iter; left time: 239.3752s
	iters: 700, epoch: 4 | loss: 0.0623034
	speed: 0.0424s/iter; left time: 235.3015s
	iters: 800, epoch: 4 | loss: 0.0761746
	speed: 0.0426s/iter; left time: 232.0264s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0699605 Vali Loss: 0.0880479 Test Loss: 0.0909868
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0689419
	speed: 0.1506s/iter; left time: 792.2078s
	iters: 200, epoch: 5 | loss: 0.0578706
	speed: 0.0424s/iter; left time: 218.5295s
	iters: 300, epoch: 5 | loss: 0.0662531
	speed: 0.0424s/iter; left time: 214.3156s
	iters: 400, epoch: 5 | loss: 0.0638737
	speed: 0.0424s/iter; left time: 210.0910s
	iters: 500, epoch: 5 | loss: 0.0668011
	speed: 0.0425s/iter; left time: 206.3862s
	iters: 600, epoch: 5 | loss: 0.0606949
	speed: 0.0425s/iter; left time: 202.3035s
	iters: 700, epoch: 5 | loss: 0.0667649
	speed: 0.0424s/iter; left time: 197.6456s
	iters: 800, epoch: 5 | loss: 0.0646159
	speed: 0.0424s/iter; left time: 193.3645s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0685865 Vali Loss: 0.0866732 Test Loss: 0.0901949
Validation loss decreased (0.087870 --> 0.086673).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0605314
	speed: 0.1537s/iter; left time: 670.9046s
	iters: 200, epoch: 6 | loss: 0.0723072
	speed: 0.0425s/iter; left time: 181.1335s
	iters: 300, epoch: 6 | loss: 0.0621333
	speed: 0.0423s/iter; left time: 176.2196s
	iters: 400, epoch: 6 | loss: 0.0597321
	speed: 0.0424s/iter; left time: 172.4385s
	iters: 500, epoch: 6 | loss: 0.0682577
	speed: 0.0424s/iter; left time: 167.9765s
	iters: 600, epoch: 6 | loss: 0.0698579
	speed: 0.0424s/iter; left time: 163.8742s
	iters: 700, epoch: 6 | loss: 0.0574603
	speed: 0.0424s/iter; left time: 159.5559s
	iters: 800, epoch: 6 | loss: 0.0658379
	speed: 0.0425s/iter; left time: 155.8791s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0670818 Vali Loss: 0.0868470 Test Loss: 0.0906652
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0681261
	speed: 0.1512s/iter; left time: 525.0611s
	iters: 200, epoch: 7 | loss: 0.0641372
	speed: 0.0427s/iter; left time: 143.8685s
	iters: 300, epoch: 7 | loss: 0.0653514
	speed: 0.0425s/iter; left time: 139.0200s
	iters: 400, epoch: 7 | loss: 0.0666691
	speed: 0.0424s/iter; left time: 134.6223s
	iters: 500, epoch: 7 | loss: 0.0718581
	speed: 0.0423s/iter; left time: 130.1402s
	iters: 600, epoch: 7 | loss: 0.0614609
	speed: 0.0424s/iter; left time: 126.0281s
	iters: 700, epoch: 7 | loss: 0.0597905
	speed: 0.0424s/iter; left time: 121.8266s
	iters: 800, epoch: 7 | loss: 0.0616782
	speed: 0.0423s/iter; left time: 117.4241s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0654795 Vali Loss: 0.0877799 Test Loss: 0.0917357
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0623620
	speed: 0.1513s/iter; left time: 390.4644s
	iters: 200, epoch: 8 | loss: 0.0624125
	speed: 0.0425s/iter; left time: 105.4512s
	iters: 300, epoch: 8 | loss: 0.0587036
	speed: 0.0424s/iter; left time: 100.9106s
	iters: 400, epoch: 8 | loss: 0.0662080
	speed: 0.0424s/iter; left time: 96.6471s
	iters: 500, epoch: 8 | loss: 0.0704325
	speed: 0.0424s/iter; left time: 92.4376s
	iters: 600, epoch: 8 | loss: 0.0537593
	speed: 0.0424s/iter; left time: 88.2434s
	iters: 700, epoch: 8 | loss: 0.0606119
	speed: 0.0423s/iter; left time: 83.7985s
	iters: 800, epoch: 8 | loss: 0.0711017
	speed: 0.0424s/iter; left time: 79.6650s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.06s
Steps: 893 | Train Loss: 0.0634904 Vali Loss: 0.0889440 Test Loss: 0.0918915
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021896962076425552, rmse:0.14797621965408325, mae:0.09019491076469421, rse:0.5225819945335388
Original data scale mse:16924342.0, rmse:4113.92041015625, mae:2418.190673828125, rse:0.20455242693424225
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0992375
	speed: 0.0443s/iter; left time: 391.3833s
	iters: 200, epoch: 1 | loss: 0.0934699
	speed: 0.0424s/iter; left time: 370.4709s
	iters: 300, epoch: 1 | loss: 0.0782871
	speed: 0.0424s/iter; left time: 366.2412s
	iters: 400, epoch: 1 | loss: 0.0772246
	speed: 0.0424s/iter; left time: 361.4961s
	iters: 500, epoch: 1 | loss: 0.0751684
	speed: 0.0424s/iter; left time: 357.1913s
	iters: 600, epoch: 1 | loss: 0.0776297
	speed: 0.0424s/iter; left time: 353.0025s
	iters: 700, epoch: 1 | loss: 0.0724057
	speed: 0.0425s/iter; left time: 349.9609s
	iters: 800, epoch: 1 | loss: 0.0723183
	speed: 0.0424s/iter; left time: 344.5254s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.11s
Steps: 893 | Train Loss: 0.0892226 Vali Loss: 0.0935710 Test Loss: 0.0953618
Validation loss decreased (inf --> 0.093571).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0877377
	speed: 0.1548s/iter; left time: 1229.1005s
	iters: 200, epoch: 2 | loss: 0.0765526
	speed: 0.0424s/iter; left time: 332.6611s
	iters: 300, epoch: 2 | loss: 0.0742970
	speed: 0.0424s/iter; left time: 327.7887s
	iters: 400, epoch: 2 | loss: 0.0868176
	speed: 0.0424s/iter; left time: 323.6582s
	iters: 500, epoch: 2 | loss: 0.0724310
	speed: 0.0424s/iter; left time: 319.3410s
	iters: 600, epoch: 2 | loss: 0.0747986
	speed: 0.0425s/iter; left time: 316.0833s
	iters: 700, epoch: 2 | loss: 0.0763848
	speed: 0.0425s/iter; left time: 311.6705s
	iters: 800, epoch: 2 | loss: 0.0782857
	speed: 0.0424s/iter; left time: 306.9712s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.10s
Steps: 893 | Train Loss: 0.0785560 Vali Loss: 0.0900949 Test Loss: 0.0926300
Validation loss decreased (0.093571 --> 0.090095).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0660076
	speed: 0.1559s/iter; left time: 1098.1421s
	iters: 200, epoch: 3 | loss: 0.0703183
	speed: 0.0424s/iter; left time: 294.4382s
	iters: 300, epoch: 3 | loss: 0.0690660
	speed: 0.0425s/iter; left time: 290.6555s
	iters: 400, epoch: 3 | loss: 0.0783872
	speed: 0.0425s/iter; left time: 286.8301s
	iters: 500, epoch: 3 | loss: 0.0600328
	speed: 0.0425s/iter; left time: 282.4685s
	iters: 600, epoch: 3 | loss: 0.0638266
	speed: 0.0424s/iter; left time: 277.7843s
	iters: 700, epoch: 3 | loss: 0.0695692
	speed: 0.0424s/iter; left time: 273.2920s
	iters: 800, epoch: 3 | loss: 0.0735985
	speed: 0.0424s/iter; left time: 269.0299s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.12s
Steps: 893 | Train Loss: 0.0718675 Vali Loss: 0.0914021 Test Loss: 0.0939478
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0765364
	speed: 0.1514s/iter; left time: 931.6673s
	iters: 200, epoch: 4 | loss: 0.0741287
	speed: 0.0424s/iter; left time: 256.4916s
	iters: 300, epoch: 4 | loss: 0.0738798
	speed: 0.0424s/iter; left time: 252.5723s
	iters: 400, epoch: 4 | loss: 0.0612318
	speed: 0.0424s/iter; left time: 247.9087s
	iters: 500, epoch: 4 | loss: 0.0693761
	speed: 0.0424s/iter; left time: 243.7100s
	iters: 600, epoch: 4 | loss: 0.0697355
	speed: 0.0424s/iter; left time: 239.6710s
	iters: 700, epoch: 4 | loss: 0.0700700
	speed: 0.0424s/iter; left time: 235.6105s
	iters: 800, epoch: 4 | loss: 0.0630878
	speed: 0.0425s/iter; left time: 231.8952s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.0706836 Vali Loss: 0.0880876 Test Loss: 0.0918040
Validation loss decreased (0.090095 --> 0.088088).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0688232
	speed: 0.1544s/iter; left time: 811.9215s
	iters: 200, epoch: 5 | loss: 0.0646626
	speed: 0.0425s/iter; left time: 219.2256s
	iters: 300, epoch: 5 | loss: 0.0689990
	speed: 0.0424s/iter; left time: 214.5066s
	iters: 400, epoch: 5 | loss: 0.0776107
	speed: 0.0424s/iter; left time: 210.2767s
	iters: 500, epoch: 5 | loss: 0.0861132
	speed: 0.0424s/iter; left time: 205.9477s
	iters: 600, epoch: 5 | loss: 0.0704510
	speed: 0.0424s/iter; left time: 201.7200s
	iters: 700, epoch: 5 | loss: 0.0740028
	speed: 0.0424s/iter; left time: 197.3903s
	iters: 800, epoch: 5 | loss: 0.0660616
	speed: 0.0424s/iter; left time: 193.2704s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.11s
Steps: 893 | Train Loss: 0.0687371 Vali Loss: 0.0862890 Test Loss: 0.0896654
Validation loss decreased (0.088088 --> 0.086289).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0763484
	speed: 0.1543s/iter; left time: 673.4607s
	iters: 200, epoch: 6 | loss: 0.0589041
	speed: 0.0422s/iter; left time: 180.1654s
	iters: 300, epoch: 6 | loss: 0.0648005
	speed: 0.0423s/iter; left time: 176.2567s
	iters: 400, epoch: 6 | loss: 0.0721593
	speed: 0.0424s/iter; left time: 172.2236s
	iters: 500, epoch: 6 | loss: 0.0596429
	speed: 0.0424s/iter; left time: 168.2345s
	iters: 600, epoch: 6 | loss: 0.0690015
	speed: 0.0424s/iter; left time: 163.8142s
	iters: 700, epoch: 6 | loss: 0.0736667
	speed: 0.0424s/iter; left time: 159.7389s
	iters: 800, epoch: 6 | loss: 0.0691755
	speed: 0.0423s/iter; left time: 155.1796s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.0676042 Vali Loss: 0.0860627 Test Loss: 0.0895480
Validation loss decreased (0.086289 --> 0.086063).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0711707
	speed: 0.1550s/iter; left time: 538.1762s
	iters: 200, epoch: 7 | loss: 0.0754958
	speed: 0.0424s/iter; left time: 142.9924s
	iters: 300, epoch: 7 | loss: 0.0697669
	speed: 0.0424s/iter; left time: 138.7071s
	iters: 400, epoch: 7 | loss: 0.0649212
	speed: 0.0424s/iter; left time: 134.5828s
	iters: 500, epoch: 7 | loss: 0.0594330
	speed: 0.0424s/iter; left time: 130.1759s
	iters: 600, epoch: 7 | loss: 0.0632876
	speed: 0.0424s/iter; left time: 126.0848s
	iters: 700, epoch: 7 | loss: 0.0637645
	speed: 0.0424s/iter; left time: 121.7083s
	iters: 800, epoch: 7 | loss: 0.0697547
	speed: 0.0424s/iter; left time: 117.5493s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.09s
Steps: 893 | Train Loss: 0.0658465 Vali Loss: 0.0862527 Test Loss: 0.0907334
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0606774
	speed: 0.1524s/iter; left time: 393.1962s
	iters: 200, epoch: 8 | loss: 0.0595161
	speed: 0.0426s/iter; left time: 105.6261s
	iters: 300, epoch: 8 | loss: 0.0535491
	speed: 0.0424s/iter; left time: 100.8890s
	iters: 400, epoch: 8 | loss: 0.0670822
	speed: 0.0425s/iter; left time: 96.8624s
	iters: 500, epoch: 8 | loss: 0.0586945
	speed: 0.0424s/iter; left time: 92.3912s
	iters: 600, epoch: 8 | loss: 0.0657744
	speed: 0.0424s/iter; left time: 88.0980s
	iters: 700, epoch: 8 | loss: 0.0653217
	speed: 0.0425s/iter; left time: 84.0540s
	iters: 800, epoch: 8 | loss: 0.0639375
	speed: 0.0424s/iter; left time: 79.7295s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.16s
Steps: 893 | Train Loss: 0.0641070 Vali Loss: 0.0877166 Test Loss: 0.0916218
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0738917
	speed: 0.1527s/iter; left time: 257.6140s
	iters: 200, epoch: 9 | loss: 0.0668606
	speed: 0.0424s/iter; left time: 67.2771s
	iters: 300, epoch: 9 | loss: 0.0544539
	speed: 0.0424s/iter; left time: 63.0541s
	iters: 400, epoch: 9 | loss: 0.0573254
	speed: 0.0424s/iter; left time: 58.8119s
	iters: 500, epoch: 9 | loss: 0.0561938
	speed: 0.0424s/iter; left time: 54.6251s
	iters: 600, epoch: 9 | loss: 0.0634413
	speed: 0.0425s/iter; left time: 50.4472s
	iters: 700, epoch: 9 | loss: 0.0612848
	speed: 0.0425s/iter; left time: 46.1514s
	iters: 800, epoch: 9 | loss: 0.0573156
	speed: 0.0424s/iter; left time: 41.8458s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:38.09s
Steps: 893 | Train Loss: 0.0622550 Vali Loss: 0.0885687 Test Loss: 0.0938942
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.021253786981105804, rmse:0.14578679203987122, mae:0.0895480364561081, rse:0.5148499608039856
Original data scale mse:16638304.0, rmse:4079.0078125, mae:2411.266845703125, rse:0.20281648635864258

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.021896962076425552, RMSE: 0.14797621965408325, MAE: 0.09019491076469421, RSE: 0.5225819945335388
Unscaled Metrics - MSE: 16924342.0, RMSE: 4113.92041015625, MAE: 2418.190673828125, RSE: 0.20455242693424225

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.021253786981105804, RMSE: 0.14578679203987122, MAE: 0.0895480364561081, RSE: 0.5148499608039856
Unscaled Metrics - MSE: 16638304.0, RMSE: 4079.0078125, MAE: 2411.266845703125, RSE: 0.20281648635864258

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1334426
	speed: 0.0676s/iter; left time: 595.3266s
	iters: 200, epoch: 1 | loss: 0.1103007
	speed: 0.0427s/iter; left time: 372.3552s
	iters: 300, epoch: 1 | loss: 0.1152367
	speed: 0.0428s/iter; left time: 368.4814s
	iters: 400, epoch: 1 | loss: 0.1013051
	speed: 0.0428s/iter; left time: 364.5939s
	iters: 500, epoch: 1 | loss: 0.1121939
	speed: 0.0429s/iter; left time: 360.7216s
	iters: 600, epoch: 1 | loss: 0.1019219
	speed: 0.0429s/iter; left time: 356.5013s
	iters: 700, epoch: 1 | loss: 0.1099762
	speed: 0.0427s/iter; left time: 350.9776s
	iters: 800, epoch: 1 | loss: 0.1171699
	speed: 0.0427s/iter; left time: 346.7401s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.61s
Steps: 891 | Train Loss: 0.1133261 Vali Loss: 0.1209122 Test Loss: 0.1280698
Validation loss decreased (inf --> 0.120912).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1131083
	speed: 0.1545s/iter; left time: 1223.2759s
	iters: 200, epoch: 2 | loss: 0.1019299
	speed: 0.0427s/iter; left time: 333.8170s
	iters: 300, epoch: 2 | loss: 0.0981942
	speed: 0.0427s/iter; left time: 329.8722s
	iters: 400, epoch: 2 | loss: 0.1060563
	speed: 0.0427s/iter; left time: 325.4710s
	iters: 500, epoch: 2 | loss: 0.0967019
	speed: 0.0427s/iter; left time: 321.4287s
	iters: 600, epoch: 2 | loss: 0.0905631
	speed: 0.0427s/iter; left time: 317.1375s
	iters: 700, epoch: 2 | loss: 0.0895246
	speed: 0.0427s/iter; left time: 312.6622s
	iters: 800, epoch: 2 | loss: 0.1078703
	speed: 0.0427s/iter; left time: 308.4500s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.29s
Steps: 891 | Train Loss: 0.1039308 Vali Loss: 0.1175602 Test Loss: 0.1257358
Validation loss decreased (0.120912 --> 0.117560).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0929911
	speed: 0.1533s/iter; left time: 1077.6925s
	iters: 200, epoch: 3 | loss: 0.0966166
	speed: 0.0427s/iter; left time: 296.0208s
	iters: 300, epoch: 3 | loss: 0.1044126
	speed: 0.0428s/iter; left time: 292.1870s
	iters: 400, epoch: 3 | loss: 0.0966799
	speed: 0.0427s/iter; left time: 287.2806s
	iters: 500, epoch: 3 | loss: 0.0936324
	speed: 0.0427s/iter; left time: 282.9075s
	iters: 600, epoch: 3 | loss: 0.0916234
	speed: 0.0427s/iter; left time: 278.7239s
	iters: 700, epoch: 3 | loss: 0.0973616
	speed: 0.0425s/iter; left time: 273.3839s
	iters: 800, epoch: 3 | loss: 0.0827569
	speed: 0.0425s/iter; left time: 269.2444s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.22s
Steps: 891 | Train Loss: 0.0964571 Vali Loss: 0.1191284 Test Loss: 0.1293793
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0983466
	speed: 0.1522s/iter; left time: 934.4355s
	iters: 200, epoch: 4 | loss: 0.1001360
	speed: 0.0429s/iter; left time: 259.0395s
	iters: 300, epoch: 4 | loss: 0.1007725
	speed: 0.0428s/iter; left time: 254.2022s
	iters: 400, epoch: 4 | loss: 0.0891830
	speed: 0.0429s/iter; left time: 250.2723s
	iters: 500, epoch: 4 | loss: 0.0891175
	speed: 0.0427s/iter; left time: 245.1813s
	iters: 600, epoch: 4 | loss: 0.0923178
	speed: 0.0427s/iter; left time: 240.8333s
	iters: 700, epoch: 4 | loss: 0.0921811
	speed: 0.0428s/iter; left time: 237.2184s
	iters: 800, epoch: 4 | loss: 0.0803595
	speed: 0.0427s/iter; left time: 232.2007s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.33s
Steps: 891 | Train Loss: 0.0896301 Vali Loss: 0.1220919 Test Loss: 0.1360420
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0865810
	speed: 0.1512s/iter; left time: 793.3066s
	iters: 200, epoch: 5 | loss: 0.0802722
	speed: 0.0430s/iter; left time: 221.2712s
	iters: 300, epoch: 5 | loss: 0.0982361
	speed: 0.0428s/iter; left time: 215.9371s
	iters: 400, epoch: 5 | loss: 0.0758405
	speed: 0.0428s/iter; left time: 211.6121s
	iters: 500, epoch: 5 | loss: 0.0794196
	speed: 0.0428s/iter; left time: 207.4097s
	iters: 600, epoch: 5 | loss: 0.0786633
	speed: 0.0428s/iter; left time: 202.9780s
	iters: 700, epoch: 5 | loss: 0.0719079
	speed: 0.0428s/iter; left time: 198.9922s
	iters: 800, epoch: 5 | loss: 0.0690903
	speed: 0.0427s/iter; left time: 194.2744s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.34s
Steps: 891 | Train Loss: 0.0804969 Vali Loss: 0.1255576 Test Loss: 0.1390364
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03539472818374634, rmse:0.18813486397266388, mae:0.1257358193397522, rse:0.6662235856056213
Original data scale mse:31024660.0, rmse:5569.978515625, mae:3461.25146484375, rse:0.2773869037628174
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.1164240
	speed: 0.0444s/iter; left time: 391.2675s
	iters: 200, epoch: 1 | loss: 0.1082931
	speed: 0.0427s/iter; left time: 371.7160s
	iters: 300, epoch: 1 | loss: 0.1195490
	speed: 0.0427s/iter; left time: 367.4500s
	iters: 400, epoch: 1 | loss: 0.1225900
	speed: 0.0427s/iter; left time: 363.4643s
	iters: 500, epoch: 1 | loss: 0.1040627
	speed: 0.0426s/iter; left time: 358.5863s
	iters: 600, epoch: 1 | loss: 0.1160977
	speed: 0.0427s/iter; left time: 355.2786s
	iters: 700, epoch: 1 | loss: 0.1054960
	speed: 0.0427s/iter; left time: 350.8912s
	iters: 800, epoch: 1 | loss: 0.1049798
	speed: 0.0427s/iter; left time: 346.4658s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.1133533 Vali Loss: 0.1207216 Test Loss: 0.1277026
Validation loss decreased (inf --> 0.120722).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1122422
	speed: 0.1548s/iter; left time: 1226.1465s
	iters: 200, epoch: 2 | loss: 0.0985058
	speed: 0.0428s/iter; left time: 334.5103s
	iters: 300, epoch: 2 | loss: 0.1053138
	speed: 0.0427s/iter; left time: 329.8008s
	iters: 400, epoch: 2 | loss: 0.1024959
	speed: 0.0427s/iter; left time: 325.7378s
	iters: 500, epoch: 2 | loss: 0.0940722
	speed: 0.0427s/iter; left time: 321.4620s
	iters: 600, epoch: 2 | loss: 0.0998174
	speed: 0.0428s/iter; left time: 317.4071s
	iters: 700, epoch: 2 | loss: 0.1079098
	speed: 0.0428s/iter; left time: 313.4563s
	iters: 800, epoch: 2 | loss: 0.1000197
	speed: 0.0428s/iter; left time: 309.0182s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.36s
Steps: 891 | Train Loss: 0.1038058 Vali Loss: 0.1185285 Test Loss: 0.1285185
Validation loss decreased (0.120722 --> 0.118529).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1014842
	speed: 0.1564s/iter; left time: 1099.5696s
	iters: 200, epoch: 3 | loss: 0.0938777
	speed: 0.0428s/iter; left time: 296.3505s
	iters: 300, epoch: 3 | loss: 0.0884656
	speed: 0.0427s/iter; left time: 291.9129s
	iters: 400, epoch: 3 | loss: 0.0926556
	speed: 0.0426s/iter; left time: 286.9812s
	iters: 500, epoch: 3 | loss: 0.0902297
	speed: 0.0427s/iter; left time: 282.9399s
	iters: 600, epoch: 3 | loss: 0.0933597
	speed: 0.0428s/iter; left time: 279.1819s
	iters: 700, epoch: 3 | loss: 0.1058115
	speed: 0.0428s/iter; left time: 275.4824s
	iters: 800, epoch: 3 | loss: 0.0954820
	speed: 0.0427s/iter; left time: 270.4419s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.30s
Steps: 891 | Train Loss: 0.0961568 Vali Loss: 0.1192591 Test Loss: 0.1301049
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0917138
	speed: 0.1514s/iter; left time: 929.2653s
	iters: 200, epoch: 4 | loss: 0.0832180
	speed: 0.0427s/iter; left time: 257.8285s
	iters: 300, epoch: 4 | loss: 0.0878894
	speed: 0.0427s/iter; left time: 253.5029s
	iters: 400, epoch: 4 | loss: 0.0908128
	speed: 0.0427s/iter; left time: 249.3812s
	iters: 500, epoch: 4 | loss: 0.0796713
	speed: 0.0428s/iter; left time: 245.5945s
	iters: 600, epoch: 4 | loss: 0.0906177
	speed: 0.0427s/iter; left time: 240.9307s
	iters: 700, epoch: 4 | loss: 0.0917859
	speed: 0.0427s/iter; left time: 236.5848s
	iters: 800, epoch: 4 | loss: 0.0861579
	speed: 0.0427s/iter; left time: 232.1890s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.25s
Steps: 891 | Train Loss: 0.0894545 Vali Loss: 0.1225607 Test Loss: 0.1323293
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0785693
	speed: 0.1510s/iter; left time: 792.0939s
	iters: 200, epoch: 5 | loss: 0.0785203
	speed: 0.0427s/iter; left time: 219.6958s
	iters: 300, epoch: 5 | loss: 0.0808796
	speed: 0.0428s/iter; left time: 215.8889s
	iters: 400, epoch: 5 | loss: 0.0829185
	speed: 0.0429s/iter; left time: 212.0397s
	iters: 500, epoch: 5 | loss: 0.0714023
	speed: 0.0428s/iter; left time: 207.3207s
	iters: 600, epoch: 5 | loss: 0.0729096
	speed: 0.0428s/iter; left time: 203.2341s
	iters: 700, epoch: 5 | loss: 0.0732635
	speed: 0.0427s/iter; left time: 198.6462s
	iters: 800, epoch: 5 | loss: 0.0749141
	speed: 0.0427s/iter; left time: 194.2157s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.31s
Steps: 891 | Train Loss: 0.0799470 Vali Loss: 0.1262512 Test Loss: 0.1356284
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.03782464563846588, rmse:0.1944855898618698, mae:0.12851838767528534, rse:0.6887127757072449
Original data scale mse:33443530.0, rmse:5783.0380859375, mae:3538.765869140625, rse:0.28799739480018616

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.03539472818374634, RMSE: 0.18813486397266388, MAE: 0.1257358193397522, RSE: 0.6662235856056213
Unscaled Metrics - MSE: 31024660.0, RMSE: 5569.978515625, MAE: 3461.25146484375, RSE: 0.2773869037628174

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.03782464563846588, RMSE: 0.1944855898618698, MAE: 0.12851838767528534, RSE: 0.6887127757072449
Unscaled Metrics - MSE: 33443530.0, RMSE: 5783.0380859375, MAE: 3538.765869140625, RSE: 0.28799739480018616

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1349828
	speed: 0.0682s/iter; left time: 599.9826s
	iters: 200, epoch: 1 | loss: 0.1171150
	speed: 0.0434s/iter; left time: 377.0507s
	iters: 300, epoch: 1 | loss: 0.1186465
	speed: 0.0433s/iter; left time: 372.2884s
	iters: 400, epoch: 1 | loss: 0.1300746
	speed: 0.0433s/iter; left time: 367.7777s
	iters: 500, epoch: 1 | loss: 0.1262776
	speed: 0.0432s/iter; left time: 362.6258s
	iters: 600, epoch: 1 | loss: 0.1169523
	speed: 0.0433s/iter; left time: 358.8795s
	iters: 700, epoch: 1 | loss: 0.1133561
	speed: 0.0433s/iter; left time: 354.3301s
	iters: 800, epoch: 1 | loss: 0.1126298
	speed: 0.0433s/iter; left time: 350.4882s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.94s
Steps: 889 | Train Loss: 0.1184658 Vali Loss: 0.1249427 Test Loss: 0.1337868
Validation loss decreased (inf --> 0.124943).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1202174
	speed: 0.1566s/iter; left time: 1237.2609s
	iters: 200, epoch: 2 | loss: 0.1027493
	speed: 0.0433s/iter; left time: 337.9787s
	iters: 300, epoch: 2 | loss: 0.1184897
	speed: 0.0433s/iter; left time: 333.5297s
	iters: 400, epoch: 2 | loss: 0.1071200
	speed: 0.0433s/iter; left time: 329.1377s
	iters: 500, epoch: 2 | loss: 0.1045601
	speed: 0.0433s/iter; left time: 324.9134s
	iters: 600, epoch: 2 | loss: 0.1052938
	speed: 0.0433s/iter; left time: 320.4096s
	iters: 700, epoch: 2 | loss: 0.0975450
	speed: 0.0433s/iter; left time: 316.1600s
	iters: 800, epoch: 2 | loss: 0.1092773
	speed: 0.0433s/iter; left time: 311.7083s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.68s
Steps: 889 | Train Loss: 0.1081579 Vali Loss: 0.1224794 Test Loss: 0.1339633
Validation loss decreased (0.124943 --> 0.122479).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1025385
	speed: 0.1561s/iter; left time: 1094.7564s
	iters: 200, epoch: 3 | loss: 0.0882827
	speed: 0.0433s/iter; left time: 299.2001s
	iters: 300, epoch: 3 | loss: 0.0990098
	speed: 0.0433s/iter; left time: 294.9712s
	iters: 400, epoch: 3 | loss: 0.1090137
	speed: 0.0433s/iter; left time: 290.4176s
	iters: 500, epoch: 3 | loss: 0.1056821
	speed: 0.0435s/iter; left time: 287.5143s
	iters: 600, epoch: 3 | loss: 0.1015013
	speed: 0.0434s/iter; left time: 282.8398s
	iters: 700, epoch: 3 | loss: 0.0988214
	speed: 0.0432s/iter; left time: 277.3490s
	iters: 800, epoch: 3 | loss: 0.0921170
	speed: 0.0434s/iter; left time: 273.8060s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.69s
Steps: 889 | Train Loss: 0.0983127 Vali Loss: 0.1265134 Test Loss: 0.1395640
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0880410
	speed: 0.1510s/iter; left time: 924.5625s
	iters: 200, epoch: 4 | loss: 0.0798025
	speed: 0.0432s/iter; left time: 260.3133s
	iters: 300, epoch: 4 | loss: 0.0979441
	speed: 0.0434s/iter; left time: 257.0936s
	iters: 400, epoch: 4 | loss: 0.0861223
	speed: 0.0433s/iter; left time: 252.3061s
	iters: 500, epoch: 4 | loss: 0.0869310
	speed: 0.0433s/iter; left time: 247.7644s
	iters: 600, epoch: 4 | loss: 0.0757373
	speed: 0.0434s/iter; left time: 244.2571s
	iters: 700, epoch: 4 | loss: 0.0835298
	speed: 0.0433s/iter; left time: 238.9210s
	iters: 800, epoch: 4 | loss: 0.0831103
	speed: 0.0434s/iter; left time: 235.2642s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.72s
Steps: 889 | Train Loss: 0.0864388 Vali Loss: 0.1293963 Test Loss: 0.1473150
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0775075
	speed: 0.1507s/iter; left time: 789.0607s
	iters: 200, epoch: 5 | loss: 0.0723159
	speed: 0.0435s/iter; left time: 223.1570s
	iters: 300, epoch: 5 | loss: 0.0751024
	speed: 0.0434s/iter; left time: 218.2749s
	iters: 400, epoch: 5 | loss: 0.0762491
	speed: 0.0435s/iter; left time: 214.5913s
	iters: 500, epoch: 5 | loss: 0.0781353
	speed: 0.0433s/iter; left time: 209.4697s
	iters: 600, epoch: 5 | loss: 0.0721987
	speed: 0.0433s/iter; left time: 204.9027s
	iters: 700, epoch: 5 | loss: 0.0738901
	speed: 0.0432s/iter; left time: 200.4601s
	iters: 800, epoch: 5 | loss: 0.0699378
	speed: 0.0433s/iter; left time: 196.3203s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.72s
Steps: 889 | Train Loss: 0.0739823 Vali Loss: 0.1330833 Test Loss: 0.1492142
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03864600136876106, rmse:0.19658586382865906, mae:0.13396330177783966, rse:0.696444571018219
Original data scale mse:34850600.0, rmse:5903.439453125, mae:3733.352783203125, rse:0.29413774609565735
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.1386947
	speed: 0.0450s/iter; left time: 395.3493s
	iters: 200, epoch: 1 | loss: 0.1249647
	speed: 0.0433s/iter; left time: 375.9273s
	iters: 300, epoch: 1 | loss: 0.1322309
	speed: 0.0433s/iter; left time: 371.5956s
	iters: 400, epoch: 1 | loss: 0.1278038
	speed: 0.0433s/iter; left time: 367.3453s
	iters: 500, epoch: 1 | loss: 0.1187004
	speed: 0.0434s/iter; left time: 364.1323s
	iters: 600, epoch: 1 | loss: 0.1030896
	speed: 0.0434s/iter; left time: 359.7246s
	iters: 700, epoch: 1 | loss: 0.1130229
	speed: 0.0433s/iter; left time: 354.3209s
	iters: 800, epoch: 1 | loss: 0.1079229
	speed: 0.0432s/iter; left time: 349.8533s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.1185558 Vali Loss: 0.1246863 Test Loss: 0.1332831
Validation loss decreased (inf --> 0.124686).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1147446
	speed: 0.1543s/iter; left time: 1219.5108s
	iters: 200, epoch: 2 | loss: 0.1133322
	speed: 0.0434s/iter; left time: 338.6678s
	iters: 300, epoch: 2 | loss: 0.1136076
	speed: 0.0433s/iter; left time: 333.6482s
	iters: 400, epoch: 2 | loss: 0.1091938
	speed: 0.0434s/iter; left time: 329.8867s
	iters: 500, epoch: 2 | loss: 0.1148756
	speed: 0.0432s/iter; left time: 324.2885s
	iters: 600, epoch: 2 | loss: 0.1102323
	speed: 0.0432s/iter; left time: 319.9440s
	iters: 700, epoch: 2 | loss: 0.1040421
	speed: 0.0432s/iter; left time: 315.6592s
	iters: 800, epoch: 2 | loss: 0.1039490
	speed: 0.0432s/iter; left time: 311.3327s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.66s
Steps: 889 | Train Loss: 0.1088817 Vali Loss: 0.1228524 Test Loss: 0.1343368
Validation loss decreased (0.124686 --> 0.122852).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0963996
	speed: 0.1539s/iter; left time: 1079.1743s
	iters: 200, epoch: 3 | loss: 0.0965821
	speed: 0.0433s/iter; left time: 299.0419s
	iters: 300, epoch: 3 | loss: 0.1092963
	speed: 0.0432s/iter; left time: 294.5014s
	iters: 400, epoch: 3 | loss: 0.1067763
	speed: 0.0432s/iter; left time: 290.0873s
	iters: 500, epoch: 3 | loss: 0.0976135
	speed: 0.0433s/iter; left time: 286.1568s
	iters: 600, epoch: 3 | loss: 0.1015769
	speed: 0.0433s/iter; left time: 282.0217s
	iters: 700, epoch: 3 | loss: 0.0944862
	speed: 0.0432s/iter; left time: 277.2727s
	iters: 800, epoch: 3 | loss: 0.0962675
	speed: 0.0433s/iter; left time: 273.0921s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.64s
Steps: 889 | Train Loss: 0.0989200 Vali Loss: 0.1238697 Test Loss: 0.1394016
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0953746
	speed: 0.1514s/iter; left time: 927.4587s
	iters: 200, epoch: 4 | loss: 0.0847741
	speed: 0.0433s/iter; left time: 260.8284s
	iters: 300, epoch: 4 | loss: 0.0851369
	speed: 0.0433s/iter; left time: 256.7374s
	iters: 400, epoch: 4 | loss: 0.0809225
	speed: 0.0433s/iter; left time: 252.3377s
	iters: 500, epoch: 4 | loss: 0.0888828
	speed: 0.0433s/iter; left time: 247.7859s
	iters: 600, epoch: 4 | loss: 0.0775692
	speed: 0.0433s/iter; left time: 243.2575s
	iters: 700, epoch: 4 | loss: 0.0932631
	speed: 0.0433s/iter; left time: 239.0073s
	iters: 800, epoch: 4 | loss: 0.0834410
	speed: 0.0433s/iter; left time: 235.0520s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.67s
Steps: 889 | Train Loss: 0.0869942 Vali Loss: 0.1296563 Test Loss: 0.1460391
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0808855
	speed: 0.1516s/iter; left time: 793.7185s
	iters: 200, epoch: 5 | loss: 0.0774749
	speed: 0.0433s/iter; left time: 222.2263s
	iters: 300, epoch: 5 | loss: 0.0710423
	speed: 0.0432s/iter; left time: 217.7287s
	iters: 400, epoch: 5 | loss: 0.0726677
	speed: 0.0433s/iter; left time: 213.5688s
	iters: 500, epoch: 5 | loss: 0.0670229
	speed: 0.0433s/iter; left time: 209.3161s
	iters: 600, epoch: 5 | loss: 0.0768453
	speed: 0.0433s/iter; left time: 205.0339s
	iters: 700, epoch: 5 | loss: 0.0667815
	speed: 0.0432s/iter; left time: 200.4275s
	iters: 800, epoch: 5 | loss: 0.0742408
	speed: 0.0434s/iter; left time: 196.8042s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.68s
Steps: 889 | Train Loss: 0.0746226 Vali Loss: 0.1301747 Test Loss: 0.1443116
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.03962956741452217, rmse:0.1990717649459839, mae:0.13433684408664703, rse:0.7052512764930725
Original data scale mse:35550684.0, rmse:5962.439453125, mae:3720.859130859375, rse:0.29707738757133484

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.03864600136876106, RMSE: 0.19658586382865906, MAE: 0.13396330177783966, RSE: 0.696444571018219
Unscaled Metrics - MSE: 34850600.0, RMSE: 5903.439453125, MAE: 3733.352783203125, RSE: 0.29413774609565735

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.03962956741452217, RMSE: 0.1990717649459839, MAE: 0.13433684408664703, RSE: 0.7052512764930725
Unscaled Metrics - MSE: 35550684.0, RMSE: 5962.439453125, MAE: 3720.859130859375, RSE: 0.29707738757133484
