
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2182888
	speed: 0.0671s/iter; left time: 592.4143s
	iters: 200, epoch: 1 | loss: 0.2483146
	speed: 0.0423s/iter; left time: 369.5671s
	iters: 300, epoch: 1 | loss: 0.1819766
	speed: 0.0424s/iter; left time: 366.0528s
	iters: 400, epoch: 1 | loss: 0.2401925
	speed: 0.0423s/iter; left time: 361.0620s
	iters: 500, epoch: 1 | loss: 0.2119175
	speed: 0.0423s/iter; left time: 356.3942s
	iters: 600, epoch: 1 | loss: 0.2411313
	speed: 0.0423s/iter; left time: 352.5340s
	iters: 700, epoch: 1 | loss: 0.2019983
	speed: 0.0423s/iter; left time: 348.0317s
	iters: 800, epoch: 1 | loss: 0.1758891
	speed: 0.0423s/iter; left time: 343.6937s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.21s
Steps: 893 | Train Loss: 0.2087825 Vali Loss: 0.2227851 Test Loss: 0.2488865
Validation loss decreased (inf --> 0.222785).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2542633
	speed: 0.1523s/iter; left time: 1208.9493s
	iters: 200, epoch: 2 | loss: 0.2285584
	speed: 0.0420s/iter; left time: 328.9201s
	iters: 300, epoch: 2 | loss: 0.1769358
	speed: 0.0420s/iter; left time: 324.7187s
	iters: 400, epoch: 2 | loss: 0.1626719
	speed: 0.0420s/iter; left time: 320.5407s
	iters: 500, epoch: 2 | loss: 0.1487459
	speed: 0.0420s/iter; left time: 316.5330s
	iters: 600, epoch: 2 | loss: 0.1563893
	speed: 0.0420s/iter; left time: 312.4074s
	iters: 700, epoch: 2 | loss: 0.2029024
	speed: 0.0420s/iter; left time: 307.9137s
	iters: 800, epoch: 2 | loss: 0.1471206
	speed: 0.0420s/iter; left time: 303.6876s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.70s
Steps: 893 | Train Loss: 0.1764989 Vali Loss: 0.2093719 Test Loss: 0.2462091
Validation loss decreased (0.222785 --> 0.209372).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1130430
	speed: 0.1520s/iter; left time: 1070.8532s
	iters: 200, epoch: 3 | loss: 0.1681836
	speed: 0.0422s/iter; left time: 293.2178s
	iters: 300, epoch: 3 | loss: 0.1295601
	speed: 0.0422s/iter; left time: 289.1402s
	iters: 400, epoch: 3 | loss: 0.1543368
	speed: 0.0422s/iter; left time: 284.8950s
	iters: 500, epoch: 3 | loss: 0.1253413
	speed: 0.0422s/iter; left time: 280.5928s
	iters: 600, epoch: 3 | loss: 0.1647429
	speed: 0.0422s/iter; left time: 276.4056s
	iters: 700, epoch: 3 | loss: 0.0972432
	speed: 0.0422s/iter; left time: 272.2859s
	iters: 800, epoch: 3 | loss: 0.1882071
	speed: 0.0422s/iter; left time: 268.0605s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.92s
Steps: 893 | Train Loss: 0.1538710 Vali Loss: 0.2072558 Test Loss: 0.2366833
Validation loss decreased (0.209372 --> 0.207256).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1382889
	speed: 0.1527s/iter; left time: 939.5439s
	iters: 200, epoch: 4 | loss: 0.1295988
	speed: 0.0423s/iter; left time: 255.9756s
	iters: 300, epoch: 4 | loss: 0.1384621
	speed: 0.0423s/iter; left time: 251.9077s
	iters: 400, epoch: 4 | loss: 0.0996958
	speed: 0.0424s/iter; left time: 247.9146s
	iters: 500, epoch: 4 | loss: 0.1963269
	speed: 0.0423s/iter; left time: 243.5882s
	iters: 600, epoch: 4 | loss: 0.1216139
	speed: 0.0423s/iter; left time: 239.3059s
	iters: 700, epoch: 4 | loss: 0.1279448
	speed: 0.0423s/iter; left time: 234.8436s
	iters: 800, epoch: 4 | loss: 0.1715954
	speed: 0.0423s/iter; left time: 230.6529s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.1435643 Vali Loss: 0.2129144 Test Loss: 0.2448330
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1146317
	speed: 0.1519s/iter; left time: 798.9322s
	iters: 200, epoch: 5 | loss: 0.0990961
	speed: 0.0423s/iter; left time: 218.0007s
	iters: 300, epoch: 5 | loss: 0.1344358
	speed: 0.0423s/iter; left time: 213.8701s
	iters: 400, epoch: 5 | loss: 0.1065817
	speed: 0.0422s/iter; left time: 209.1114s
	iters: 500, epoch: 5 | loss: 0.1366770
	speed: 0.0420s/iter; left time: 203.8968s
	iters: 600, epoch: 5 | loss: 0.0995290
	speed: 0.0421s/iter; left time: 200.2429s
	iters: 700, epoch: 5 | loss: 0.1291941
	speed: 0.0423s/iter; left time: 196.9853s
	iters: 800, epoch: 5 | loss: 0.1187898
	speed: 0.0423s/iter; left time: 192.7039s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.88s
Steps: 893 | Train Loss: 0.1356922 Vali Loss: 0.2070860 Test Loss: 0.2437721
Validation loss decreased (0.207256 --> 0.207086).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1052267
	speed: 0.1527s/iter; left time: 666.5302s
	iters: 200, epoch: 6 | loss: 0.1539435
	speed: 0.0423s/iter; left time: 180.4593s
	iters: 300, epoch: 6 | loss: 0.1016026
	speed: 0.0423s/iter; left time: 176.1273s
	iters: 400, epoch: 6 | loss: 0.0981144
	speed: 0.0423s/iter; left time: 171.9055s
	iters: 500, epoch: 6 | loss: 0.1160137
	speed: 0.0423s/iter; left time: 167.7247s
	iters: 600, epoch: 6 | loss: 0.1246929
	speed: 0.0423s/iter; left time: 163.4481s
	iters: 700, epoch: 6 | loss: 0.0993796
	speed: 0.0423s/iter; left time: 159.2700s
	iters: 800, epoch: 6 | loss: 0.1143529
	speed: 0.0423s/iter; left time: 154.9532s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.98s
Steps: 893 | Train Loss: 0.1223197 Vali Loss: 0.2111784 Test Loss: 0.2512260
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1277153
	speed: 0.1510s/iter; left time: 524.3166s
	iters: 200, epoch: 7 | loss: 0.0998712
	speed: 0.0423s/iter; left time: 142.6868s
	iters: 300, epoch: 7 | loss: 0.1116811
	speed: 0.0423s/iter; left time: 138.4256s
	iters: 400, epoch: 7 | loss: 0.1238142
	speed: 0.0422s/iter; left time: 134.0547s
	iters: 500, epoch: 7 | loss: 0.1123730
	speed: 0.0423s/iter; left time: 129.8465s
	iters: 600, epoch: 7 | loss: 0.1097642
	speed: 0.0423s/iter; left time: 125.7097s
	iters: 700, epoch: 7 | loss: 0.0841276
	speed: 0.0423s/iter; left time: 121.4399s
	iters: 800, epoch: 7 | loss: 0.0980608
	speed: 0.0423s/iter; left time: 117.1913s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.95s
Steps: 893 | Train Loss: 0.1080896 Vali Loss: 0.2169513 Test Loss: 0.2719207
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0982211
	speed: 0.1511s/iter; left time: 389.7795s
	iters: 200, epoch: 8 | loss: 0.0946582
	speed: 0.0423s/iter; left time: 104.8453s
	iters: 300, epoch: 8 | loss: 0.0831800
	speed: 0.0423s/iter; left time: 100.5986s
	iters: 400, epoch: 8 | loss: 0.1077355
	speed: 0.0423s/iter; left time: 96.3900s
	iters: 500, epoch: 8 | loss: 0.1004587
	speed: 0.0423s/iter; left time: 92.1275s
	iters: 600, epoch: 8 | loss: 0.0869073
	speed: 0.0423s/iter; left time: 87.8975s
	iters: 700, epoch: 8 | loss: 0.0918937
	speed: 0.0423s/iter; left time: 83.7088s
	iters: 800, epoch: 8 | loss: 0.1065189
	speed: 0.0423s/iter; left time: 79.4432s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.94s
Steps: 893 | Train Loss: 0.0947981 Vali Loss: 0.2311867 Test Loss: 0.2736874
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.24377213418483734, rmse:0.49373286962509155, mae:0.32709261775016785, rse:0.47993603348731995
Original data scale mse:18229302.0, rmse:4269.57861328125, mae:2643.64306640625, rse:0.21229206025600433
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2206414
	speed: 0.0443s/iter; left time: 391.6088s
	iters: 200, epoch: 1 | loss: 0.2375478
	speed: 0.0423s/iter; left time: 369.1894s
	iters: 300, epoch: 1 | loss: 0.1452305
	speed: 0.0423s/iter; left time: 364.9231s
	iters: 400, epoch: 1 | loss: 0.1465522
	speed: 0.0423s/iter; left time: 360.8159s
	iters: 500, epoch: 1 | loss: 0.1584292
	speed: 0.0423s/iter; left time: 356.3088s
	iters: 600, epoch: 1 | loss: 0.1645278
	speed: 0.0423s/iter; left time: 352.3695s
	iters: 700, epoch: 1 | loss: 0.1320945
	speed: 0.0423s/iter; left time: 348.0273s
	iters: 800, epoch: 1 | loss: 0.1485924
	speed: 0.0423s/iter; left time: 344.0073s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.2064389 Vali Loss: 0.2237854 Test Loss: 0.2495932
Validation loss decreased (inf --> 0.223785).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1912019
	speed: 0.1556s/iter; left time: 1234.7611s
	iters: 200, epoch: 2 | loss: 0.1532453
	speed: 0.0423s/iter; left time: 331.8465s
	iters: 300, epoch: 2 | loss: 0.1540545
	speed: 0.0424s/iter; left time: 327.7185s
	iters: 400, epoch: 2 | loss: 0.1902761
	speed: 0.0423s/iter; left time: 322.9039s
	iters: 500, epoch: 2 | loss: 0.1828902
	speed: 0.0423s/iter; left time: 318.9055s
	iters: 600, epoch: 2 | loss: 0.1684876
	speed: 0.0423s/iter; left time: 314.6219s
	iters: 700, epoch: 2 | loss: 0.1584103
	speed: 0.0423s/iter; left time: 310.2867s
	iters: 800, epoch: 2 | loss: 0.1902631
	speed: 0.0423s/iter; left time: 306.0857s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.07s
Steps: 893 | Train Loss: 0.1782395 Vali Loss: 0.2117519 Test Loss: 0.2409998
Validation loss decreased (0.223785 --> 0.211752).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1524419
	speed: 0.1535s/iter; left time: 1081.2843s
	iters: 200, epoch: 3 | loss: 0.1627001
	speed: 0.0423s/iter; left time: 293.7571s
	iters: 300, epoch: 3 | loss: 0.1591595
	speed: 0.0423s/iter; left time: 289.7706s
	iters: 400, epoch: 3 | loss: 0.1622191
	speed: 0.0423s/iter; left time: 285.3798s
	iters: 500, epoch: 3 | loss: 0.1084869
	speed: 0.0424s/iter; left time: 281.4775s
	iters: 600, epoch: 3 | loss: 0.1607718
	speed: 0.0423s/iter; left time: 276.6985s
	iters: 700, epoch: 3 | loss: 0.1469914
	speed: 0.0423s/iter; left time: 272.5152s
	iters: 800, epoch: 3 | loss: 0.1555944
	speed: 0.0423s/iter; left time: 268.2608s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.00s
Steps: 893 | Train Loss: 0.1535924 Vali Loss: 0.2054644 Test Loss: 0.2340896
Validation loss decreased (0.211752 --> 0.205464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1761414
	speed: 0.1529s/iter; left time: 940.8861s
	iters: 200, epoch: 4 | loss: 0.1489290
	speed: 0.0423s/iter; left time: 255.8050s
	iters: 300, epoch: 4 | loss: 0.1410414
	speed: 0.0422s/iter; left time: 251.3510s
	iters: 400, epoch: 4 | loss: 0.1234727
	speed: 0.0423s/iter; left time: 247.2712s
	iters: 500, epoch: 4 | loss: 0.1392564
	speed: 0.0423s/iter; left time: 243.1773s
	iters: 600, epoch: 4 | loss: 0.1366114
	speed: 0.0423s/iter; left time: 238.9896s
	iters: 700, epoch: 4 | loss: 0.1602959
	speed: 0.0423s/iter; left time: 234.6935s
	iters: 800, epoch: 4 | loss: 0.1197448
	speed: 0.0423s/iter; left time: 230.4317s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.97s
Steps: 893 | Train Loss: 0.1465536 Vali Loss: 0.2101973 Test Loss: 0.2404596
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1367753
	speed: 0.1511s/iter; left time: 794.8858s
	iters: 200, epoch: 5 | loss: 0.1272282
	speed: 0.0423s/iter; left time: 218.2070s
	iters: 300, epoch: 5 | loss: 0.1496442
	speed: 0.0423s/iter; left time: 214.1654s
	iters: 400, epoch: 5 | loss: 0.1521624
	speed: 0.0424s/iter; left time: 210.0168s
	iters: 500, epoch: 5 | loss: 0.2145675
	speed: 0.0423s/iter; left time: 205.7225s
	iters: 600, epoch: 5 | loss: 0.1506090
	speed: 0.0423s/iter; left time: 201.2500s
	iters: 700, epoch: 5 | loss: 0.1555046
	speed: 0.0423s/iter; left time: 197.0498s
	iters: 800, epoch: 5 | loss: 0.1273113
	speed: 0.0423s/iter; left time: 192.7440s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.97s
Steps: 893 | Train Loss: 0.1361860 Vali Loss: 0.2075765 Test Loss: 0.2429294
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1674313
	speed: 0.1531s/iter; left time: 668.3991s
	iters: 200, epoch: 6 | loss: 0.1083477
	speed: 0.0423s/iter; left time: 180.6613s
	iters: 300, epoch: 6 | loss: 0.1070889
	speed: 0.0423s/iter; left time: 176.3479s
	iters: 400, epoch: 6 | loss: 0.1446198
	speed: 0.0424s/iter; left time: 172.2337s
	iters: 500, epoch: 6 | loss: 0.1063484
	speed: 0.0423s/iter; left time: 167.9490s
	iters: 600, epoch: 6 | loss: 0.1296085
	speed: 0.0424s/iter; left time: 163.9010s
	iters: 700, epoch: 6 | loss: 0.1381496
	speed: 0.0425s/iter; left time: 159.9501s
	iters: 800, epoch: 6 | loss: 0.1257187
	speed: 0.0425s/iter; left time: 155.6277s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.14s
Steps: 893 | Train Loss: 0.1262082 Vali Loss: 0.2218472 Test Loss: 0.2574605
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2340896874666214, rmse:0.4838281571865082, mae:0.3247095048427582, rse:0.4703080952167511
Original data scale mse:17448062.0, rmse:4177.087890625, mae:2625.818359375, rse:0.20769323408603668

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.24377213418483734, RMSE: 0.49373286962509155, MAE: 0.32709261775016785, RSE: 0.47993603348731995
Unscaled Metrics - MSE: 18229302.0, RMSE: 4269.57861328125, MAE: 2643.64306640625, RSE: 0.21229206025600433

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.2340896874666214, RMSE: 0.4838281571865082, MAE: 0.3247095048427582, RSE: 0.4703080952167511
Unscaled Metrics - MSE: 17448062.0, RMSE: 4177.087890625, MAE: 2625.818359375, RSE: 0.20769323408603668

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.4049923
	speed: 0.0689s/iter; left time: 606.8800s
	iters: 200, epoch: 1 | loss: 0.2957990
	speed: 0.0428s/iter; left time: 372.7498s
	iters: 300, epoch: 1 | loss: 0.3107244
	speed: 0.0427s/iter; left time: 367.4864s
	iters: 400, epoch: 1 | loss: 0.2609153
	speed: 0.0427s/iter; left time: 363.3368s
	iters: 500, epoch: 1 | loss: 0.3021559
	speed: 0.0427s/iter; left time: 358.8438s
	iters: 600, epoch: 1 | loss: 0.2765362
	speed: 0.0427s/iter; left time: 354.6060s
	iters: 700, epoch: 1 | loss: 0.3019718
	speed: 0.0426s/iter; left time: 350.1938s
	iters: 800, epoch: 1 | loss: 0.3384129
	speed: 0.0427s/iter; left time: 346.0070s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.47s
Steps: 891 | Train Loss: 0.3137484 Vali Loss: 0.3350134 Test Loss: 0.4042231
Validation loss decreased (inf --> 0.335013).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3234335
	speed: 0.1540s/iter; left time: 1220.0525s
	iters: 200, epoch: 2 | loss: 0.2690896
	speed: 0.0427s/iter; left time: 333.8863s
	iters: 300, epoch: 2 | loss: 0.2604612
	speed: 0.0427s/iter; left time: 329.5562s
	iters: 400, epoch: 2 | loss: 0.3257959
	speed: 0.0427s/iter; left time: 325.2546s
	iters: 500, epoch: 2 | loss: 0.2276038
	speed: 0.0427s/iter; left time: 321.0410s
	iters: 600, epoch: 2 | loss: 0.2075093
	speed: 0.0427s/iter; left time: 316.9933s
	iters: 700, epoch: 2 | loss: 0.2199426
	speed: 0.0427s/iter; left time: 312.4776s
	iters: 800, epoch: 2 | loss: 0.3054669
	speed: 0.0427s/iter; left time: 307.9747s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.23s
Steps: 891 | Train Loss: 0.2844034 Vali Loss: 0.3334920 Test Loss: 0.4056434
Validation loss decreased (0.335013 --> 0.333492).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2273551
	speed: 0.1550s/iter; left time: 1089.2230s
	iters: 200, epoch: 3 | loss: 0.2722374
	speed: 0.0428s/iter; left time: 296.6875s
	iters: 300, epoch: 3 | loss: 0.2850189
	speed: 0.0428s/iter; left time: 292.4647s
	iters: 400, epoch: 3 | loss: 0.2466170
	speed: 0.0428s/iter; left time: 288.3025s
	iters: 500, epoch: 3 | loss: 0.2558402
	speed: 0.0429s/iter; left time: 284.1932s
	iters: 600, epoch: 3 | loss: 0.2083510
	speed: 0.0429s/iter; left time: 279.8767s
	iters: 700, epoch: 3 | loss: 0.2529962
	speed: 0.0428s/iter; left time: 275.1767s
	iters: 800, epoch: 3 | loss: 0.2187040
	speed: 0.0428s/iter; left time: 270.5660s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.38s
Steps: 891 | Train Loss: 0.2485018 Vali Loss: 0.3550677 Test Loss: 0.4583389
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2168615
	speed: 0.1521s/iter; left time: 933.5163s
	iters: 200, epoch: 4 | loss: 0.2235389
	speed: 0.0426s/iter; left time: 257.3139s
	iters: 300, epoch: 4 | loss: 0.2161325
	speed: 0.0426s/iter; left time: 252.9119s
	iters: 400, epoch: 4 | loss: 0.2032050
	speed: 0.0426s/iter; left time: 248.5449s
	iters: 500, epoch: 4 | loss: 0.1802410
	speed: 0.0426s/iter; left time: 244.2919s
	iters: 600, epoch: 4 | loss: 0.2107882
	speed: 0.0426s/iter; left time: 240.0479s
	iters: 700, epoch: 4 | loss: 0.1768880
	speed: 0.0426s/iter; left time: 235.8910s
	iters: 800, epoch: 4 | loss: 0.1494804
	speed: 0.0426s/iter; left time: 231.5110s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.12s
Steps: 891 | Train Loss: 0.1942186 Vali Loss: 0.3718321 Test Loss: 0.5154957
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1428668
	speed: 0.1512s/iter; left time: 793.4876s
	iters: 200, epoch: 5 | loss: 0.1403580
	speed: 0.0428s/iter; left time: 220.3215s
	iters: 300, epoch: 5 | loss: 0.1688989
	speed: 0.0428s/iter; left time: 216.2106s
	iters: 400, epoch: 5 | loss: 0.1395124
	speed: 0.0429s/iter; left time: 211.9929s
	iters: 500, epoch: 5 | loss: 0.1450117
	speed: 0.0428s/iter; left time: 207.6597s
	iters: 600, epoch: 5 | loss: 0.1385178
	speed: 0.0427s/iter; left time: 202.5236s
	iters: 700, epoch: 5 | loss: 0.1198406
	speed: 0.0427s/iter; left time: 198.4644s
	iters: 800, epoch: 5 | loss: 0.1080823
	speed: 0.0428s/iter; left time: 194.4907s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.31s
Steps: 891 | Train Loss: 0.1442858 Vali Loss: 0.4074320 Test Loss: 0.5274310
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.4056432843208313, rmse:0.636901319026947, mae:0.4532889127731323, rse:0.6194678544998169
Original data scale mse:31905132.0, rmse:5648.462890625, mae:3713.9365234375, rse:0.28129544854164124
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2911865
	speed: 0.0443s/iter; left time: 390.5713s
	iters: 200, epoch: 1 | loss: 0.2554933
	speed: 0.0427s/iter; left time: 371.6443s
	iters: 300, epoch: 1 | loss: 0.3690168
	speed: 0.0426s/iter; left time: 366.9870s
	iters: 400, epoch: 1 | loss: 0.3681073
	speed: 0.0426s/iter; left time: 362.8232s
	iters: 500, epoch: 1 | loss: 0.2588452
	speed: 0.0427s/iter; left time: 358.8153s
	iters: 600, epoch: 1 | loss: 0.3433743
	speed: 0.0426s/iter; left time: 354.0899s
	iters: 700, epoch: 1 | loss: 0.2982317
	speed: 0.0426s/iter; left time: 349.8697s
	iters: 800, epoch: 1 | loss: 0.2857746
	speed: 0.0426s/iter; left time: 345.6468s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.19s
Steps: 891 | Train Loss: 0.3132502 Vali Loss: 0.3342929 Test Loss: 0.4064146
Validation loss decreased (inf --> 0.334293).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2956440
	speed: 0.1539s/iter; left time: 1219.1017s
	iters: 200, epoch: 2 | loss: 0.2711323
	speed: 0.0427s/iter; left time: 333.9687s
	iters: 300, epoch: 2 | loss: 0.2761405
	speed: 0.0426s/iter; left time: 328.8849s
	iters: 400, epoch: 2 | loss: 0.2718239
	speed: 0.0426s/iter; left time: 324.6965s
	iters: 500, epoch: 2 | loss: 0.2233150
	speed: 0.0427s/iter; left time: 320.8067s
	iters: 600, epoch: 2 | loss: 0.2687964
	speed: 0.0426s/iter; left time: 316.2735s
	iters: 700, epoch: 2 | loss: 0.3107231
	speed: 0.0426s/iter; left time: 312.0622s
	iters: 800, epoch: 2 | loss: 0.2536783
	speed: 0.0426s/iter; left time: 307.7887s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.22s
Steps: 891 | Train Loss: 0.2821826 Vali Loss: 0.3187537 Test Loss: 0.4230867
Validation loss decreased (0.334293 --> 0.318754).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2730467
	speed: 0.1563s/iter; left time: 1098.3708s
	iters: 200, epoch: 3 | loss: 0.2214015
	speed: 0.0428s/iter; left time: 296.7806s
	iters: 300, epoch: 3 | loss: 0.1991722
	speed: 0.0427s/iter; left time: 291.8211s
	iters: 400, epoch: 3 | loss: 0.2438296
	speed: 0.0427s/iter; left time: 287.6403s
	iters: 500, epoch: 3 | loss: 0.2184707
	speed: 0.0427s/iter; left time: 283.0747s
	iters: 600, epoch: 3 | loss: 0.2162259
	speed: 0.0428s/iter; left time: 279.1217s
	iters: 700, epoch: 3 | loss: 0.2521574
	speed: 0.0428s/iter; left time: 274.8871s
	iters: 800, epoch: 3 | loss: 0.2256935
	speed: 0.0428s/iter; left time: 270.6487s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.34s
Steps: 891 | Train Loss: 0.2377315 Vali Loss: 0.3662227 Test Loss: 0.4909471
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1883862
	speed: 0.1519s/iter; left time: 932.5947s
	iters: 200, epoch: 4 | loss: 0.1755034
	speed: 0.0426s/iter; left time: 257.3751s
	iters: 300, epoch: 4 | loss: 0.1892222
	speed: 0.0426s/iter; left time: 253.1909s
	iters: 400, epoch: 4 | loss: 0.1656071
	speed: 0.0426s/iter; left time: 248.8671s
	iters: 500, epoch: 4 | loss: 0.1632601
	speed: 0.0427s/iter; left time: 244.8986s
	iters: 600, epoch: 4 | loss: 0.1775828
	speed: 0.0428s/iter; left time: 241.5719s
	iters: 700, epoch: 4 | loss: 0.1985904
	speed: 0.0428s/iter; left time: 236.9068s
	iters: 800, epoch: 4 | loss: 0.1739397
	speed: 0.0426s/iter; left time: 231.8410s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.22s
Steps: 891 | Train Loss: 0.1840022 Vali Loss: 0.3693338 Test Loss: 0.5031531
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1468196
	speed: 0.1509s/iter; left time: 791.7974s
	iters: 200, epoch: 5 | loss: 0.1186915
	speed: 0.0427s/iter; left time: 219.6282s
	iters: 300, epoch: 5 | loss: 0.1432089
	speed: 0.0427s/iter; left time: 215.4314s
	iters: 400, epoch: 5 | loss: 0.1392983
	speed: 0.0427s/iter; left time: 211.1448s
	iters: 500, epoch: 5 | loss: 0.1237556
	speed: 0.0427s/iter; left time: 206.9695s
	iters: 600, epoch: 5 | loss: 0.1113769
	speed: 0.0428s/iter; left time: 203.2917s
	iters: 700, epoch: 5 | loss: 0.1409771
	speed: 0.0428s/iter; left time: 199.0124s
	iters: 800, epoch: 5 | loss: 0.1170147
	speed: 0.0428s/iter; left time: 194.6181s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.1372502 Vali Loss: 0.3961888 Test Loss: 0.5232928
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.42308685183525085, rmse:0.6504512429237366, mae:0.45941707491874695, rse:0.6326469779014587
Original data scale mse:34005252.0, rmse:5831.40234375, mae:3790.419677734375, rse:0.29040592908859253

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.4056432843208313, RMSE: 0.636901319026947, MAE: 0.4532889127731323, RSE: 0.6194678544998169
Unscaled Metrics - MSE: 31905132.0, RMSE: 5648.462890625, MAE: 3713.9365234375, RSE: 0.28129544854164124

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.42308685183525085, RMSE: 0.6504512429237366, MAE: 0.45941707491874695, RSE: 0.6326469779014587
Unscaled Metrics - MSE: 34005252.0, RMSE: 5831.40234375, MAE: 3790.419677734375, RSE: 0.29040592908859253

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4219725
	speed: 0.0714s/iter; left time: 627.3441s
	iters: 200, epoch: 1 | loss: 0.3213577
	speed: 0.0432s/iter; left time: 375.7531s
	iters: 300, epoch: 1 | loss: 0.3374341
	speed: 0.0432s/iter; left time: 371.0781s
	iters: 400, epoch: 1 | loss: 0.3923987
	speed: 0.0432s/iter; left time: 366.9837s
	iters: 500, epoch: 1 | loss: 0.3712656
	speed: 0.0432s/iter; left time: 362.8432s
	iters: 600, epoch: 1 | loss: 0.3270575
	speed: 0.0432s/iter; left time: 358.4755s
	iters: 700, epoch: 1 | loss: 0.3183230
	speed: 0.0432s/iter; left time: 353.9584s
	iters: 800, epoch: 1 | loss: 0.3355043
	speed: 0.0432s/iter; left time: 349.6947s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.87s
Steps: 889 | Train Loss: 0.3379270 Vali Loss: 0.3487453 Test Loss: 0.4337278
Validation loss decreased (inf --> 0.348745).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3505492
	speed: 0.1562s/iter; left time: 1234.2560s
	iters: 200, epoch: 2 | loss: 0.2815456
	speed: 0.0432s/iter; left time: 337.3393s
	iters: 300, epoch: 2 | loss: 0.3684201
	speed: 0.0432s/iter; left time: 332.4921s
	iters: 400, epoch: 2 | loss: 0.3003347
	speed: 0.0432s/iter; left time: 328.2750s
	iters: 500, epoch: 2 | loss: 0.2899017
	speed: 0.0432s/iter; left time: 323.9465s
	iters: 600, epoch: 2 | loss: 0.2943653
	speed: 0.0431s/iter; left time: 319.2990s
	iters: 700, epoch: 2 | loss: 0.2408169
	speed: 0.0431s/iter; left time: 314.9757s
	iters: 800, epoch: 2 | loss: 0.2967852
	speed: 0.0432s/iter; left time: 311.4780s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.62s
Steps: 889 | Train Loss: 0.3040860 Vali Loss: 0.3452318 Test Loss: 0.4300068
Validation loss decreased (0.348745 --> 0.345232).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2656941
	speed: 0.1578s/iter; left time: 1106.8775s
	iters: 200, epoch: 3 | loss: 0.2192199
	speed: 0.0431s/iter; left time: 298.1325s
	iters: 300, epoch: 3 | loss: 0.2572608
	speed: 0.0431s/iter; left time: 293.7830s
	iters: 400, epoch: 3 | loss: 0.2765799
	speed: 0.0431s/iter; left time: 289.5822s
	iters: 500, epoch: 3 | loss: 0.2829485
	speed: 0.0432s/iter; left time: 285.8724s
	iters: 600, epoch: 3 | loss: 0.2353772
	speed: 0.0432s/iter; left time: 281.2424s
	iters: 700, epoch: 3 | loss: 0.2344825
	speed: 0.0431s/iter; left time: 276.4197s
	iters: 800, epoch: 3 | loss: 0.2090407
	speed: 0.0431s/iter; left time: 272.2415s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.57s
Steps: 889 | Train Loss: 0.2437451 Vali Loss: 0.3876502 Test Loss: 0.5172561
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1679521
	speed: 0.1535s/iter; left time: 939.9233s
	iters: 200, epoch: 4 | loss: 0.1774218
	speed: 0.0433s/iter; left time: 260.7681s
	iters: 300, epoch: 4 | loss: 0.2058694
	speed: 0.0434s/iter; left time: 256.8529s
	iters: 400, epoch: 4 | loss: 0.1830022
	speed: 0.0434s/iter; left time: 252.5259s
	iters: 500, epoch: 4 | loss: 0.1770386
	speed: 0.0433s/iter; left time: 247.7507s
	iters: 600, epoch: 4 | loss: 0.1469374
	speed: 0.0434s/iter; left time: 244.0048s
	iters: 700, epoch: 4 | loss: 0.1893812
	speed: 0.0434s/iter; left time: 239.7172s
	iters: 800, epoch: 4 | loss: 0.1701941
	speed: 0.0433s/iter; left time: 234.6032s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.74s
Steps: 889 | Train Loss: 0.1826646 Vali Loss: 0.3969426 Test Loss: 0.5706749
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1446595
	speed: 0.1537s/iter; left time: 804.5972s
	iters: 200, epoch: 5 | loss: 0.1312882
	speed: 0.0432s/iter; left time: 222.0357s
	iters: 300, epoch: 5 | loss: 0.1305957
	speed: 0.0432s/iter; left time: 217.6116s
	iters: 400, epoch: 5 | loss: 0.1302079
	speed: 0.0432s/iter; left time: 213.2307s
	iters: 500, epoch: 5 | loss: 0.1266844
	speed: 0.0432s/iter; left time: 209.0294s
	iters: 600, epoch: 5 | loss: 0.1237143
	speed: 0.0432s/iter; left time: 204.7879s
	iters: 700, epoch: 5 | loss: 0.1116356
	speed: 0.0432s/iter; left time: 200.2983s
	iters: 800, epoch: 5 | loss: 0.1180200
	speed: 0.0433s/iter; left time: 196.1806s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.65s
Steps: 889 | Train Loss: 0.1277201 Vali Loss: 0.4241887 Test Loss: 0.5817598
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.43000683188438416, rmse:0.6557490825653076, mae:0.4732247292995453, rse:0.6358470320701599
Original data scale mse:34134564.0, rmse:5842.4794921875, mae:3888.266845703125, rse:0.2911003828048706
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4407575
	speed: 0.0450s/iter; left time: 395.7944s
	iters: 200, epoch: 1 | loss: 0.3782762
	speed: 0.0432s/iter; left time: 375.4750s
	iters: 300, epoch: 1 | loss: 0.4144816
	speed: 0.0433s/iter; left time: 372.0573s
	iters: 400, epoch: 1 | loss: 0.3776525
	speed: 0.0433s/iter; left time: 367.7289s
	iters: 500, epoch: 1 | loss: 0.3336774
	speed: 0.0432s/iter; left time: 362.0939s
	iters: 600, epoch: 1 | loss: 0.2712955
	speed: 0.0432s/iter; left time: 357.9453s
	iters: 700, epoch: 1 | loss: 0.3227006
	speed: 0.0432s/iter; left time: 353.4853s
	iters: 800, epoch: 1 | loss: 0.2782703
	speed: 0.0432s/iter; left time: 349.1774s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.63s
Steps: 889 | Train Loss: 0.3393388 Vali Loss: 0.3470966 Test Loss: 0.4314443
Validation loss decreased (inf --> 0.347097).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3569445
	speed: 0.1562s/iter; left time: 1234.3920s
	iters: 200, epoch: 2 | loss: 0.3173552
	speed: 0.0432s/iter; left time: 336.9127s
	iters: 300, epoch: 2 | loss: 0.3198369
	speed: 0.0432s/iter; left time: 332.5283s
	iters: 400, epoch: 2 | loss: 0.2892367
	speed: 0.0432s/iter; left time: 328.0513s
	iters: 500, epoch: 2 | loss: 0.3043633
	speed: 0.0432s/iter; left time: 323.7601s
	iters: 600, epoch: 2 | loss: 0.3062617
	speed: 0.0432s/iter; left time: 319.5736s
	iters: 700, epoch: 2 | loss: 0.2757693
	speed: 0.0432s/iter; left time: 315.2731s
	iters: 800, epoch: 2 | loss: 0.2658074
	speed: 0.0432s/iter; left time: 310.9256s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.62s
Steps: 889 | Train Loss: 0.3037361 Vali Loss: 0.3466612 Test Loss: 0.4409137
Validation loss decreased (0.347097 --> 0.346661).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2411756
	speed: 0.1595s/iter; left time: 1118.7216s
	iters: 200, epoch: 3 | loss: 0.2372409
	speed: 0.0432s/iter; left time: 298.6042s
	iters: 300, epoch: 3 | loss: 0.3133474
	speed: 0.0432s/iter; left time: 294.1087s
	iters: 400, epoch: 3 | loss: 0.2907278
	speed: 0.0432s/iter; left time: 289.8311s
	iters: 500, epoch: 3 | loss: 0.2493317
	speed: 0.0433s/iter; left time: 286.0561s
	iters: 600, epoch: 3 | loss: 0.2681441
	speed: 0.0432s/iter; left time: 281.1875s
	iters: 700, epoch: 3 | loss: 0.2291876
	speed: 0.0432s/iter; left time: 276.7867s
	iters: 800, epoch: 3 | loss: 0.2249457
	speed: 0.0432s/iter; left time: 272.7989s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.63s
Steps: 889 | Train Loss: 0.2516279 Vali Loss: 0.3914679 Test Loss: 0.5096662
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2386205
	speed: 0.1524s/iter; left time: 933.3497s
	iters: 200, epoch: 4 | loss: 0.1759195
	speed: 0.0433s/iter; left time: 260.6938s
	iters: 300, epoch: 4 | loss: 0.1840650
	speed: 0.0432s/iter; left time: 255.9961s
	iters: 400, epoch: 4 | loss: 0.1511063
	speed: 0.0433s/iter; left time: 252.2814s
	iters: 500, epoch: 4 | loss: 0.1705367
	speed: 0.0433s/iter; left time: 247.6009s
	iters: 600, epoch: 4 | loss: 0.1474632
	speed: 0.0431s/iter; left time: 242.5532s
	iters: 700, epoch: 4 | loss: 0.2182209
	speed: 0.0431s/iter; left time: 238.2039s
	iters: 800, epoch: 4 | loss: 0.1727867
	speed: 0.0431s/iter; left time: 234.0123s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.60s
Steps: 889 | Train Loss: 0.1821432 Vali Loss: 0.4079411 Test Loss: 0.5562986
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1476289
	speed: 0.1528s/iter; left time: 799.8046s
	iters: 200, epoch: 5 | loss: 0.1366095
	speed: 0.0431s/iter; left time: 221.4838s
	iters: 300, epoch: 5 | loss: 0.1219677
	speed: 0.0431s/iter; left time: 217.1397s
	iters: 400, epoch: 5 | loss: 0.1347326
	speed: 0.0431s/iter; left time: 212.8904s
	iters: 500, epoch: 5 | loss: 0.1075135
	speed: 0.0431s/iter; left time: 208.5982s
	iters: 600, epoch: 5 | loss: 0.1352350
	speed: 0.0432s/iter; left time: 204.3307s
	iters: 700, epoch: 5 | loss: 0.1199284
	speed: 0.0431s/iter; left time: 199.8920s
	iters: 800, epoch: 5 | loss: 0.1189027
	speed: 0.0431s/iter; left time: 195.5191s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.53s
Steps: 889 | Train Loss: 0.1323440 Vali Loss: 0.4090794 Test Loss: 0.5391755
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4409139156341553, rmse:0.6640135049819946, mae:0.4773784875869751, rse:0.6438606381416321
Original data scale mse:35157356.0, rmse:5929.36376953125, mae:3919.80126953125, rse:0.29542940855026245

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.43000683188438416, RMSE: 0.6557490825653076, MAE: 0.4732247292995453, RSE: 0.6358470320701599
Unscaled Metrics - MSE: 34134564.0, RMSE: 5842.4794921875, MAE: 3888.266845703125, RSE: 0.2911003828048706

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.4409139156341553, RMSE: 0.6640135049819946, MAE: 0.4773784875869751, RSE: 0.6438606381416321
Unscaled Metrics - MSE: 35157356.0, RMSE: 5929.36376953125, MAE: 3919.80126953125, RSE: 0.29542940855026245

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4612264
	speed: 0.0703s/iter; left time: 620.6735s
	iters: 200, epoch: 1 | loss: 0.4931367
	speed: 0.0424s/iter; left time: 369.9290s
	iters: 300, epoch: 1 | loss: 0.4238130
	speed: 0.0424s/iter; left time: 365.5662s
	iters: 400, epoch: 1 | loss: 0.4851383
	speed: 0.0424s/iter; left time: 361.3446s
	iters: 500, epoch: 1 | loss: 0.4581392
	speed: 0.0424s/iter; left time: 357.2157s
	iters: 600, epoch: 1 | loss: 0.4889456
	speed: 0.0424s/iter; left time: 352.9831s
	iters: 700, epoch: 1 | loss: 0.4440142
	speed: 0.0424s/iter; left time: 348.7187s
	iters: 800, epoch: 1 | loss: 0.4172545
	speed: 0.0424s/iter; left time: 344.6893s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.29s
Steps: 893 | Train Loss: 0.4478988 Vali Loss: 0.2211551 Test Loss: 0.2469547
Validation loss decreased (inf --> 0.221155).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4969963
	speed: 0.1545s/iter; left time: 1226.6377s
	iters: 200, epoch: 2 | loss: 0.4799438
	speed: 0.0427s/iter; left time: 334.3108s
	iters: 300, epoch: 2 | loss: 0.4172078
	speed: 0.0426s/iter; left time: 329.8421s
	iters: 400, epoch: 2 | loss: 0.4173856
	speed: 0.0426s/iter; left time: 325.6524s
	iters: 500, epoch: 2 | loss: 0.3859967
	speed: 0.0427s/iter; left time: 321.7328s
	iters: 600, epoch: 2 | loss: 0.3960185
	speed: 0.0426s/iter; left time: 316.6852s
	iters: 700, epoch: 2 | loss: 0.4558703
	speed: 0.0423s/iter; left time: 310.1533s
	iters: 800, epoch: 2 | loss: 0.3944112
	speed: 0.0422s/iter; left time: 305.2265s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.12s
Steps: 893 | Train Loss: 0.4187160 Vali Loss: 0.2119642 Test Loss: 0.2481652
Validation loss decreased (0.221155 --> 0.211964).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3558697
	speed: 0.1531s/iter; left time: 1078.4734s
	iters: 200, epoch: 3 | loss: 0.4031888
	speed: 0.0424s/iter; left time: 294.2475s
	iters: 300, epoch: 3 | loss: 0.3752215
	speed: 0.0424s/iter; left time: 290.0653s
	iters: 400, epoch: 3 | loss: 0.3727610
	speed: 0.0426s/iter; left time: 287.1306s
	iters: 500, epoch: 3 | loss: 0.3592518
	speed: 0.0426s/iter; left time: 283.0151s
	iters: 600, epoch: 3 | loss: 0.4104393
	speed: 0.0426s/iter; left time: 278.7167s
	iters: 700, epoch: 3 | loss: 0.3167129
	speed: 0.0426s/iter; left time: 274.3454s
	iters: 800, epoch: 3 | loss: 0.4401841
	speed: 0.0426s/iter; left time: 270.1755s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.19s
Steps: 893 | Train Loss: 0.3928169 Vali Loss: 0.2130078 Test Loss: 0.2390562
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3682080
	speed: 0.1503s/iter; left time: 924.6140s
	iters: 200, epoch: 4 | loss: 0.3599137
	speed: 0.0424s/iter; left time: 256.7060s
	iters: 300, epoch: 4 | loss: 0.4109510
	speed: 0.0425s/iter; left time: 252.8530s
	iters: 400, epoch: 4 | loss: 0.3691692
	speed: 0.0423s/iter; left time: 247.7092s
	iters: 500, epoch: 4 | loss: 0.4784911
	speed: 0.0423s/iter; left time: 243.4482s
	iters: 600, epoch: 4 | loss: 0.3593989
	speed: 0.0423s/iter; left time: 239.1844s
	iters: 700, epoch: 4 | loss: 0.3556636
	speed: 0.0423s/iter; left time: 235.0332s
	iters: 800, epoch: 4 | loss: 0.4085686
	speed: 0.0423s/iter; left time: 230.5882s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.99s
Steps: 893 | Train Loss: 0.3901668 Vali Loss: 0.2179164 Test Loss: 0.2440517
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3726523
	speed: 0.1512s/iter; left time: 795.3797s
	iters: 200, epoch: 5 | loss: 0.3119459
	speed: 0.0424s/iter; left time: 218.9842s
	iters: 300, epoch: 5 | loss: 0.3757663
	speed: 0.0425s/iter; left time: 214.8649s
	iters: 400, epoch: 5 | loss: 0.3228470
	speed: 0.0424s/iter; left time: 210.2669s
	iters: 500, epoch: 5 | loss: 0.3623497
	speed: 0.0424s/iter; left time: 206.2594s
	iters: 600, epoch: 5 | loss: 0.3463914
	speed: 0.0427s/iter; left time: 203.0576s
	iters: 700, epoch: 5 | loss: 0.3652623
	speed: 0.0426s/iter; left time: 198.6190s
	iters: 800, epoch: 5 | loss: 0.3501074
	speed: 0.0426s/iter; left time: 194.2261s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.13s
Steps: 893 | Train Loss: 0.3693833 Vali Loss: 0.2104208 Test Loss: 0.2432195
Validation loss decreased (0.211964 --> 0.210421).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3216523
	speed: 0.1531s/iter; left time: 668.5719s
	iters: 200, epoch: 6 | loss: 0.3791971
	speed: 0.0424s/iter; left time: 180.7690s
	iters: 300, epoch: 6 | loss: 0.3138337
	speed: 0.0424s/iter; left time: 176.5228s
	iters: 400, epoch: 6 | loss: 0.3159437
	speed: 0.0424s/iter; left time: 172.3101s
	iters: 500, epoch: 6 | loss: 0.3236097
	speed: 0.0424s/iter; left time: 168.0682s
	iters: 600, epoch: 6 | loss: 0.3602601
	speed: 0.0424s/iter; left time: 163.8196s
	iters: 700, epoch: 6 | loss: 0.3172666
	speed: 0.0424s/iter; left time: 159.5473s
	iters: 800, epoch: 6 | loss: 0.3505700
	speed: 0.0424s/iter; left time: 155.3130s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.3529901 Vali Loss: 0.2172078 Test Loss: 0.2523130
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3618367
	speed: 0.1508s/iter; left time: 523.5932s
	iters: 200, epoch: 7 | loss: 0.3543028
	speed: 0.0425s/iter; left time: 143.2367s
	iters: 300, epoch: 7 | loss: 0.3426455
	speed: 0.0424s/iter; left time: 138.6854s
	iters: 400, epoch: 7 | loss: 0.3477319
	speed: 0.0423s/iter; left time: 134.2996s
	iters: 500, epoch: 7 | loss: 0.3414739
	speed: 0.0423s/iter; left time: 130.1410s
	iters: 600, epoch: 7 | loss: 0.3208058
	speed: 0.0424s/iter; left time: 125.9220s
	iters: 700, epoch: 7 | loss: 0.2930879
	speed: 0.0424s/iter; left time: 121.7094s
	iters: 800, epoch: 7 | loss: 0.3072974
	speed: 0.0423s/iter; left time: 117.3962s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.03s
Steps: 893 | Train Loss: 0.3350942 Vali Loss: 0.2205501 Test Loss: 0.2730061
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.3361881
	speed: 0.1509s/iter; left time: 389.3314s
	iters: 200, epoch: 8 | loss: 0.3133093
	speed: 0.0424s/iter; left time: 105.1967s
	iters: 300, epoch: 8 | loss: 0.2900985
	speed: 0.0424s/iter; left time: 100.8443s
	iters: 400, epoch: 8 | loss: 0.3482691
	speed: 0.0424s/iter; left time: 96.6245s
	iters: 500, epoch: 8 | loss: 0.3318945
	speed: 0.0423s/iter; left time: 92.3116s
	iters: 600, epoch: 8 | loss: 0.2822109
	speed: 0.0423s/iter; left time: 88.0182s
	iters: 700, epoch: 8 | loss: 0.3060897
	speed: 0.0424s/iter; left time: 83.9099s
	iters: 800, epoch: 8 | loss: 0.3357830
	speed: 0.0424s/iter; left time: 79.6328s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.3131295 Vali Loss: 0.2335430 Test Loss: 0.2739078
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2432195246219635, rmse:0.49317291378974915, mae:0.32862284779548645, rse:0.4793917238712311
Original data scale mse:18199538.0, rmse:4266.091796875, mae:2667.862060546875, rse:0.21211868524551392
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4627249
	speed: 0.0441s/iter; left time: 389.0936s
	iters: 200, epoch: 1 | loss: 0.4810070
	speed: 0.0423s/iter; left time: 369.7337s
	iters: 300, epoch: 1 | loss: 0.3775995
	speed: 0.0424s/iter; left time: 365.6905s
	iters: 400, epoch: 1 | loss: 0.3788279
	speed: 0.0424s/iter; left time: 361.4481s
	iters: 500, epoch: 1 | loss: 0.3954695
	speed: 0.0424s/iter; left time: 357.2624s
	iters: 600, epoch: 1 | loss: 0.4038344
	speed: 0.0423s/iter; left time: 352.5639s
	iters: 700, epoch: 1 | loss: 0.3603105
	speed: 0.0423s/iter; left time: 348.5498s
	iters: 800, epoch: 1 | loss: 0.3826021
	speed: 0.0423s/iter; left time: 344.3063s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.04s
Steps: 893 | Train Loss: 0.4462209 Vali Loss: 0.2220088 Test Loss: 0.2474589
Validation loss decreased (inf --> 0.222009).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4468117
	speed: 0.1545s/iter; left time: 1226.0742s
	iters: 200, epoch: 2 | loss: 0.3882646
	speed: 0.0425s/iter; left time: 333.3921s
	iters: 300, epoch: 2 | loss: 0.3921411
	speed: 0.0425s/iter; left time: 328.5391s
	iters: 400, epoch: 2 | loss: 0.4408219
	speed: 0.0425s/iter; left time: 324.2496s
	iters: 500, epoch: 2 | loss: 0.4288436
	speed: 0.0425s/iter; left time: 320.1669s
	iters: 600, epoch: 2 | loss: 0.4248250
	speed: 0.0425s/iter; left time: 315.8468s
	iters: 700, epoch: 2 | loss: 0.3980495
	speed: 0.0425s/iter; left time: 311.7407s
	iters: 800, epoch: 2 | loss: 0.4369488
	speed: 0.0425s/iter; left time: 307.4664s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.20s
Steps: 893 | Train Loss: 0.4213050 Vali Loss: 0.2097122 Test Loss: 0.2390324
Validation loss decreased (0.222009 --> 0.209712).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4233243
	speed: 0.1535s/iter; left time: 1081.4250s
	iters: 200, epoch: 3 | loss: 0.4000756
	speed: 0.0424s/iter; left time: 294.7136s
	iters: 300, epoch: 3 | loss: 0.3975570
	speed: 0.0426s/iter; left time: 291.6814s
	iters: 400, epoch: 3 | loss: 0.4036248
	speed: 0.0428s/iter; left time: 288.7328s
	iters: 500, epoch: 3 | loss: 0.3283674
	speed: 0.0428s/iter; left time: 284.5081s
	iters: 600, epoch: 3 | loss: 0.3974990
	speed: 0.0428s/iter; left time: 280.0580s
	iters: 700, epoch: 3 | loss: 0.3839193
	speed: 0.0428s/iter; left time: 275.5819s
	iters: 800, epoch: 3 | loss: 0.4012060
	speed: 0.0425s/iter; left time: 269.7055s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.27s
Steps: 893 | Train Loss: 0.3911129 Vali Loss: 0.2123895 Test Loss: 0.2398590
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4230535
	speed: 0.1529s/iter; left time: 940.3885s
	iters: 200, epoch: 4 | loss: 0.3863612
	speed: 0.0425s/iter; left time: 257.0466s
	iters: 300, epoch: 4 | loss: 0.3751012
	speed: 0.0425s/iter; left time: 253.0282s
	iters: 400, epoch: 4 | loss: 0.3567015
	speed: 0.0427s/iter; left time: 249.7753s
	iters: 500, epoch: 4 | loss: 0.3692994
	speed: 0.0425s/iter; left time: 244.2765s
	iters: 600, epoch: 4 | loss: 0.3690723
	speed: 0.0425s/iter; left time: 240.1361s
	iters: 700, epoch: 4 | loss: 0.3942787
	speed: 0.0425s/iter; left time: 235.7881s
	iters: 800, epoch: 4 | loss: 0.3504765
	speed: 0.0425s/iter; left time: 231.5134s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.17s
Steps: 893 | Train Loss: 0.3797200 Vali Loss: 0.2056763 Test Loss: 0.2373357
Validation loss decreased (0.209712 --> 0.205676).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3825168
	speed: 0.1554s/iter; left time: 817.1957s
	iters: 200, epoch: 5 | loss: 0.3447078
	speed: 0.0425s/iter; left time: 219.0883s
	iters: 300, epoch: 5 | loss: 0.3645397
	speed: 0.0426s/iter; left time: 215.2974s
	iters: 400, epoch: 5 | loss: 0.4045370
	speed: 0.0426s/iter; left time: 211.2526s
	iters: 500, epoch: 5 | loss: 0.4360555
	speed: 0.0426s/iter; left time: 206.9996s
	iters: 600, epoch: 5 | loss: 0.3904092
	speed: 0.0428s/iter; left time: 203.5662s
	iters: 700, epoch: 5 | loss: 0.4079309
	speed: 0.0428s/iter; left time: 199.1745s
	iters: 800, epoch: 5 | loss: 0.3473741
	speed: 0.0428s/iter; left time: 194.9087s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.39s
Steps: 893 | Train Loss: 0.3669088 Vali Loss: 0.2076001 Test Loss: 0.2412341
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4358069
	speed: 0.1538s/iter; left time: 671.6840s
	iters: 200, epoch: 6 | loss: 0.3262861
	speed: 0.0427s/iter; left time: 182.3221s
	iters: 300, epoch: 6 | loss: 0.3337511
	speed: 0.0427s/iter; left time: 177.8897s
	iters: 400, epoch: 6 | loss: 0.3791381
	speed: 0.0425s/iter; left time: 172.8758s
	iters: 500, epoch: 6 | loss: 0.3326493
	speed: 0.0425s/iter; left time: 168.4972s
	iters: 600, epoch: 6 | loss: 0.3490874
	speed: 0.0426s/iter; left time: 164.6048s
	iters: 700, epoch: 6 | loss: 0.3610901
	speed: 0.0426s/iter; left time: 160.2520s
	iters: 800, epoch: 6 | loss: 0.3445083
	speed: 0.0425s/iter; left time: 155.9353s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.29s
Steps: 893 | Train Loss: 0.3520390 Vali Loss: 0.2155766 Test Loss: 0.2493458
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3519499
	speed: 0.1529s/iter; left time: 530.9237s
	iters: 200, epoch: 7 | loss: 0.3816791
	speed: 0.0425s/iter; left time: 143.5045s
	iters: 300, epoch: 7 | loss: 0.3123848
	speed: 0.0425s/iter; left time: 139.0378s
	iters: 400, epoch: 7 | loss: 0.3204518
	speed: 0.0425s/iter; left time: 134.8396s
	iters: 500, epoch: 7 | loss: 0.2937274
	speed: 0.0425s/iter; left time: 130.5625s
	iters: 600, epoch: 7 | loss: 0.3157093
	speed: 0.0425s/iter; left time: 126.3152s
	iters: 700, epoch: 7 | loss: 0.3109202
	speed: 0.0425s/iter; left time: 122.1029s
	iters: 800, epoch: 7 | loss: 0.3189745
	speed: 0.0425s/iter; left time: 117.8670s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.19s
Steps: 893 | Train Loss: 0.3303891 Vali Loss: 0.2250563 Test Loss: 0.2799367
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.23733577132225037, rmse:0.4871712028980255, mae:0.3286206126213074, rse:0.473557710647583
Original data scale mse:17552708.0, rmse:4189.59521484375, mae:2641.27880859375, rse:0.20831511914730072

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2432195246219635, RMSE: 0.49317291378974915, MAE: 0.32862284779548645, RSE: 0.4793917238712311
Unscaled Metrics - MSE: 18199538.0, RMSE: 4266.091796875, MAE: 2667.862060546875, RSE: 0.21211868524551392

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.23733577132225037, RMSE: 0.4871712028980255, MAE: 0.3286206126213074, RSE: 0.473557710647583
Unscaled Metrics - MSE: 17552708.0, RMSE: 4189.59521484375, MAE: 2641.27880859375, RSE: 0.20831511914730072

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6345074
	speed: 0.0691s/iter; left time: 609.2619s
	iters: 200, epoch: 1 | loss: 0.5412972
	speed: 0.0428s/iter; left time: 372.5770s
	iters: 300, epoch: 1 | loss: 0.5562449
	speed: 0.0427s/iter; left time: 367.8249s
	iters: 400, epoch: 1 | loss: 0.5097930
	speed: 0.0427s/iter; left time: 363.5319s
	iters: 500, epoch: 1 | loss: 0.5492460
	speed: 0.0428s/iter; left time: 359.7909s
	iters: 600, epoch: 1 | loss: 0.5247215
	speed: 0.0428s/iter; left time: 355.9429s
	iters: 700, epoch: 1 | loss: 0.5481805
	speed: 0.0428s/iter; left time: 351.2185s
	iters: 800, epoch: 1 | loss: 0.5801686
	speed: 0.0428s/iter; left time: 346.7808s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.54s
Steps: 891 | Train Loss: 0.5569856 Vali Loss: 0.3342626 Test Loss: 0.4036690
Validation loss decreased (inf --> 0.334263).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5640212
	speed: 0.1534s/iter; left time: 1214.6715s
	iters: 200, epoch: 2 | loss: 0.5194572
	speed: 0.0427s/iter; left time: 334.2129s
	iters: 300, epoch: 2 | loss: 0.5155885
	speed: 0.0428s/iter; left time: 330.3211s
	iters: 400, epoch: 2 | loss: 0.5696425
	speed: 0.0427s/iter; left time: 325.4819s
	iters: 500, epoch: 2 | loss: 0.4769734
	speed: 0.0428s/iter; left time: 321.5096s
	iters: 600, epoch: 2 | loss: 0.4558331
	speed: 0.0427s/iter; left time: 316.9321s
	iters: 700, epoch: 2 | loss: 0.4634367
	speed: 0.0428s/iter; left time: 313.0361s
	iters: 800, epoch: 2 | loss: 0.5508001
	speed: 0.0428s/iter; left time: 308.7255s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.30s
Steps: 891 | Train Loss: 0.5325205 Vali Loss: 0.3381830 Test Loss: 0.4116932
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4698816
	speed: 0.1519s/iter; left time: 1067.8639s
	iters: 200, epoch: 3 | loss: 0.5208798
	speed: 0.0428s/iter; left time: 296.4992s
	iters: 300, epoch: 3 | loss: 0.5191745
	speed: 0.0427s/iter; left time: 291.5807s
	iters: 400, epoch: 3 | loss: 0.5005776
	speed: 0.0427s/iter; left time: 287.1588s
	iters: 500, epoch: 3 | loss: 0.5024170
	speed: 0.0427s/iter; left time: 282.9332s
	iters: 600, epoch: 3 | loss: 0.4613788
	speed: 0.0427s/iter; left time: 278.5374s
	iters: 700, epoch: 3 | loss: 0.5163460
	speed: 0.0427s/iter; left time: 274.7261s
	iters: 800, epoch: 3 | loss: 0.4546890
	speed: 0.0427s/iter; left time: 270.1427s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.4972181 Vali Loss: 0.3756260 Test Loss: 0.4761226
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4737630
	speed: 0.1513s/iter; left time: 928.4065s
	iters: 200, epoch: 4 | loss: 0.4687172
	speed: 0.0427s/iter; left time: 257.9800s
	iters: 300, epoch: 4 | loss: 0.4597653
	speed: 0.0427s/iter; left time: 253.6618s
	iters: 400, epoch: 4 | loss: 0.4724765
	speed: 0.0427s/iter; left time: 249.3522s
	iters: 500, epoch: 4 | loss: 0.4457217
	speed: 0.0427s/iter; left time: 245.1885s
	iters: 600, epoch: 4 | loss: 0.4597476
	speed: 0.0427s/iter; left time: 240.6676s
	iters: 700, epoch: 4 | loss: 0.4234651
	speed: 0.0427s/iter; left time: 236.3710s
	iters: 800, epoch: 4 | loss: 0.3789759
	speed: 0.0427s/iter; left time: 232.1223s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.24s
Steps: 891 | Train Loss: 0.4404088 Vali Loss: 0.3992287 Test Loss: 0.5203529
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.4036690294742584, rmse:0.6353495121002197, mae:0.4568611979484558, rse:0.6179585456848145
Original data scale mse:32573556.0, rmse:5707.32470703125, mae:3834.916748046875, rse:0.28422680497169495
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6040326
	speed: 0.0445s/iter; left time: 392.1222s
	iters: 200, epoch: 1 | loss: 0.4955250
	speed: 0.0428s/iter; left time: 372.7255s
	iters: 300, epoch: 1 | loss: 0.6056259
	speed: 0.0427s/iter; left time: 367.3216s
	iters: 400, epoch: 1 | loss: 0.5453749
	speed: 0.0427s/iter; left time: 363.1428s
	iters: 500, epoch: 1 | loss: 0.5231329
	speed: 0.0427s/iter; left time: 358.9036s
	iters: 600, epoch: 1 | loss: 0.4840289
	speed: 0.0427s/iter; left time: 354.8231s
	iters: 700, epoch: 1 | loss: 0.5079355
	speed: 0.0427s/iter; left time: 350.3205s
	iters: 800, epoch: 1 | loss: 0.4609497
	speed: 0.0427s/iter; left time: 346.5687s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.5556409 Vali Loss: 0.3335489 Test Loss: 0.4002578
Validation loss decreased (inf --> 0.333549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5311090
	speed: 0.1564s/iter; left time: 1238.9464s
	iters: 200, epoch: 2 | loss: 0.4929393
	speed: 0.0428s/iter; left time: 334.9083s
	iters: 300, epoch: 2 | loss: 0.5975280
	speed: 0.0428s/iter; left time: 330.4302s
	iters: 400, epoch: 2 | loss: 0.5767192
	speed: 0.0429s/iter; left time: 326.7495s
	iters: 500, epoch: 2 | loss: 0.4910087
	speed: 0.0429s/iter; left time: 322.8307s
	iters: 600, epoch: 2 | loss: 0.5547670
	speed: 0.0430s/iter; left time: 319.3152s
	iters: 700, epoch: 2 | loss: 0.5132957
	speed: 0.0429s/iter; left time: 314.2849s
	iters: 800, epoch: 2 | loss: 0.5068620
	speed: 0.0428s/iter; left time: 309.2517s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.50s
Steps: 891 | Train Loss: 0.5305442 Vali Loss: 0.3430454 Test Loss: 0.4259739
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5168265
	speed: 0.1549s/iter; left time: 1088.4429s
	iters: 200, epoch: 3 | loss: 0.4956676
	speed: 0.0430s/iter; left time: 297.6317s
	iters: 300, epoch: 3 | loss: 0.5157908
	speed: 0.0429s/iter; left time: 293.1327s
	iters: 400, epoch: 3 | loss: 0.5067684
	speed: 0.0429s/iter; left time: 288.8872s
	iters: 500, epoch: 3 | loss: 0.4548647
	speed: 0.0429s/iter; left time: 284.6853s
	iters: 600, epoch: 3 | loss: 0.4573902
	speed: 0.0429s/iter; left time: 280.3237s
	iters: 700, epoch: 3 | loss: 0.4979976
	speed: 0.0429s/iter; left time: 275.8182s
	iters: 800, epoch: 3 | loss: 0.4394158
	speed: 0.0428s/iter; left time: 270.8534s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.48s
Steps: 891 | Train Loss: 0.4911427 Vali Loss: 0.3692628 Test Loss: 0.4977124
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4704323
	speed: 0.1544s/iter; left time: 947.4916s
	iters: 200, epoch: 4 | loss: 0.4102717
	speed: 0.0430s/iter; left time: 259.5974s
	iters: 300, epoch: 4 | loss: 0.4254036
	speed: 0.0429s/iter; left time: 254.9136s
	iters: 400, epoch: 4 | loss: 0.4254311
	speed: 0.0429s/iter; left time: 250.1880s
	iters: 500, epoch: 4 | loss: 0.4057109
	speed: 0.0429s/iter; left time: 246.3262s
	iters: 600, epoch: 4 | loss: 0.4167624
	speed: 0.0430s/iter; left time: 242.4912s
	iters: 700, epoch: 4 | loss: 0.4556670
	speed: 0.0430s/iter; left time: 238.1178s
	iters: 800, epoch: 4 | loss: 0.4121064
	speed: 0.0430s/iter; left time: 233.9707s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.50s
Steps: 891 | Train Loss: 0.4327600 Vali Loss: 0.3784308 Test Loss: 0.5389258
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.40025779604911804, rmse:0.6326593160629272, mae:0.45186686515808105, rse:0.6153419613838196
Original data scale mse:32110734.0, rmse:5666.63330078125, mae:3774.54248046875, rse:0.2822003662586212

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.4036690294742584, RMSE: 0.6353495121002197, MAE: 0.4568611979484558, RSE: 0.6179585456848145
Unscaled Metrics - MSE: 32573556.0, RMSE: 5707.32470703125, MAE: 3834.916748046875, RSE: 0.28422680497169495

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.40025779604911804, RMSE: 0.6326593160629272, MAE: 0.45186686515808105, RSE: 0.6153419613838196
Unscaled Metrics - MSE: 32110734.0, RMSE: 5666.63330078125, MAE: 3774.54248046875, RSE: 0.2822003662586212

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.6487415
	speed: 0.0704s/iter; left time: 618.9872s
	iters: 200, epoch: 1 | loss: 0.5665378
	speed: 0.0434s/iter; left time: 377.3207s
	iters: 300, epoch: 1 | loss: 0.5798368
	speed: 0.0434s/iter; left time: 372.8620s
	iters: 400, epoch: 1 | loss: 0.6252718
	speed: 0.0434s/iter; left time: 368.4850s
	iters: 500, epoch: 1 | loss: 0.6081845
	speed: 0.0434s/iter; left time: 364.1391s
	iters: 600, epoch: 1 | loss: 0.5711913
	speed: 0.0434s/iter; left time: 360.2027s
	iters: 700, epoch: 1 | loss: 0.5641771
	speed: 0.0434s/iter; left time: 355.6172s
	iters: 800, epoch: 1 | loss: 0.5788223
	speed: 0.0434s/iter; left time: 351.3518s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.00s
Steps: 889 | Train Loss: 0.5784869 Vali Loss: 0.3481130 Test Loss: 0.4330794
Validation loss decreased (inf --> 0.348113).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5929089
	speed: 0.1593s/iter; left time: 1259.0297s
	iters: 200, epoch: 2 | loss: 0.5337034
	speed: 0.0432s/iter; left time: 337.2797s
	iters: 300, epoch: 2 | loss: 0.6033278
	speed: 0.0432s/iter; left time: 333.0272s
	iters: 400, epoch: 2 | loss: 0.5481176
	speed: 0.0432s/iter; left time: 328.6308s
	iters: 500, epoch: 2 | loss: 0.5433515
	speed: 0.0434s/iter; left time: 325.5672s
	iters: 600, epoch: 2 | loss: 0.5433046
	speed: 0.0434s/iter; left time: 321.0102s
	iters: 700, epoch: 2 | loss: 0.5226781
	speed: 0.0432s/iter; left time: 315.6562s
	iters: 800, epoch: 2 | loss: 0.5602379
	speed: 0.0432s/iter; left time: 311.4547s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.71s
Steps: 889 | Train Loss: 0.5536581 Vali Loss: 0.3503735 Test Loss: 0.4435634
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5247940
	speed: 0.1541s/iter; left time: 1080.6327s
	iters: 200, epoch: 3 | loss: 0.4666578
	speed: 0.0436s/iter; left time: 301.0711s
	iters: 300, epoch: 3 | loss: 0.4915379
	speed: 0.0436s/iter; left time: 297.1110s
	iters: 400, epoch: 3 | loss: 0.5265747
	speed: 0.0434s/iter; left time: 291.5574s
	iters: 500, epoch: 3 | loss: 0.5261526
	speed: 0.0435s/iter; left time: 287.8618s
	iters: 600, epoch: 3 | loss: 0.4984049
	speed: 0.0436s/iter; left time: 283.6791s
	iters: 700, epoch: 3 | loss: 0.4938059
	speed: 0.0435s/iter; left time: 278.9440s
	iters: 800, epoch: 3 | loss: 0.4697720
	speed: 0.0434s/iter; left time: 274.0722s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.95s
Steps: 889 | Train Loss: 0.4933211 Vali Loss: 0.3897238 Test Loss: 0.5161418
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4248726
	speed: 0.1536s/iter; left time: 940.5743s
	iters: 200, epoch: 4 | loss: 0.4227059
	speed: 0.0434s/iter; left time: 261.4773s
	iters: 300, epoch: 4 | loss: 0.4484168
	speed: 0.0434s/iter; left time: 257.1222s
	iters: 400, epoch: 4 | loss: 0.4374381
	speed: 0.0433s/iter; left time: 252.3886s
	iters: 500, epoch: 4 | loss: 0.4159889
	speed: 0.0433s/iter; left time: 247.5729s
	iters: 600, epoch: 4 | loss: 0.3730746
	speed: 0.0433s/iter; left time: 243.4629s
	iters: 700, epoch: 4 | loss: 0.4663849
	speed: 0.0434s/iter; left time: 239.7770s
	iters: 800, epoch: 4 | loss: 0.4110291
	speed: 0.0434s/iter; left time: 235.1407s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.71s
Steps: 889 | Train Loss: 0.4278258 Vali Loss: 0.3949634 Test Loss: 0.5482817
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.43307942152023315, rmse:0.6580876708030701, mae:0.4750068783760071, rse:0.6381146907806396
Original data scale mse:35332576.0, rmse:5944.12109375, mae:3983.261962890625, rse:0.2961646616458893
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5541797
	speed: 0.0449s/iter; left time: 394.4930s
	iters: 200, epoch: 1 | loss: 0.6447560
	speed: 0.0433s/iter; left time: 376.7359s
	iters: 300, epoch: 1 | loss: 0.6078178
	speed: 0.0433s/iter; left time: 372.3166s
	iters: 400, epoch: 1 | loss: 0.5680565
	speed: 0.0433s/iter; left time: 367.9043s
	iters: 500, epoch: 1 | loss: 0.5506138
	speed: 0.0432s/iter; left time: 362.5799s
	iters: 600, epoch: 1 | loss: 0.5916827
	speed: 0.0433s/iter; left time: 358.9773s
	iters: 700, epoch: 1 | loss: 0.5238413
	speed: 0.0432s/iter; left time: 353.7496s
	iters: 800, epoch: 1 | loss: 0.5558631
	speed: 0.0431s/iter; left time: 349.0624s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.66s
Steps: 889 | Train Loss: 0.5795735 Vali Loss: 0.3490178 Test Loss: 0.4349462
Validation loss decreased (inf --> 0.349018).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6458588
	speed: 0.1573s/iter; left time: 1243.1764s
	iters: 200, epoch: 2 | loss: 0.5979521
	speed: 0.0433s/iter; left time: 337.6882s
	iters: 300, epoch: 2 | loss: 0.6093858
	speed: 0.0433s/iter; left time: 333.6957s
	iters: 400, epoch: 2 | loss: 0.5543461
	speed: 0.0433s/iter; left time: 329.3861s
	iters: 500, epoch: 2 | loss: 0.5239897
	speed: 0.0434s/iter; left time: 325.3004s
	iters: 600, epoch: 2 | loss: 0.4797231
	speed: 0.0433s/iter; left time: 320.8067s
	iters: 700, epoch: 2 | loss: 0.5349596
	speed: 0.0433s/iter; left time: 316.4395s
	iters: 800, epoch: 2 | loss: 0.5079510
	speed: 0.0433s/iter; left time: 312.0840s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.73s
Steps: 889 | Train Loss: 0.5485454 Vali Loss: 0.3758105 Test Loss: 0.4721995
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5296508
	speed: 0.1533s/iter; left time: 1075.1520s
	iters: 200, epoch: 3 | loss: 0.5096095
	speed: 0.0432s/iter; left time: 298.5468s
	iters: 300, epoch: 3 | loss: 0.5181944
	speed: 0.0432s/iter; left time: 294.2351s
	iters: 400, epoch: 3 | loss: 0.5009753
	speed: 0.0433s/iter; left time: 290.7663s
	iters: 500, epoch: 3 | loss: 0.5160809
	speed: 0.0433s/iter; left time: 286.5293s
	iters: 600, epoch: 3 | loss: 0.4707217
	speed: 0.0433s/iter; left time: 282.3188s
	iters: 700, epoch: 3 | loss: 0.4547001
	speed: 0.0434s/iter; left time: 278.0078s
	iters: 800, epoch: 3 | loss: 0.4301299
	speed: 0.0433s/iter; left time: 273.5309s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.70s
Steps: 889 | Train Loss: 0.4927791 Vali Loss: 0.3916558 Test Loss: 0.5282715
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4355078
	speed: 0.1530s/iter; left time: 936.9614s
	iters: 200, epoch: 4 | loss: 0.4094014
	speed: 0.0435s/iter; left time: 261.9613s
	iters: 300, epoch: 4 | loss: 0.4425901
	speed: 0.0434s/iter; left time: 256.8307s
	iters: 400, epoch: 4 | loss: 0.4454512
	speed: 0.0434s/iter; left time: 252.5337s
	iters: 500, epoch: 4 | loss: 0.3985242
	speed: 0.0434s/iter; left time: 248.3329s
	iters: 600, epoch: 4 | loss: 0.4066934
	speed: 0.0433s/iter; left time: 243.7769s
	iters: 700, epoch: 4 | loss: 0.4044339
	speed: 0.0434s/iter; left time: 239.5480s
	iters: 800, epoch: 4 | loss: 0.3898852
	speed: 0.0434s/iter; left time: 235.2005s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.76s
Steps: 889 | Train Loss: 0.4138639 Vali Loss: 0.4066092 Test Loss: 0.5992306
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4349460303783417, rmse:0.6595043540000916, mae:0.4763880968093872, rse:0.6394883394241333
Original data scale mse:35436588.0, rmse:5952.86376953125, mae:3990.803466796875, rse:0.29660025238990784

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.43307942152023315, RMSE: 0.6580876708030701, MAE: 0.4750068783760071, RSE: 0.6381146907806396
Unscaled Metrics - MSE: 35332576.0, RMSE: 5944.12109375, MAE: 3983.261962890625, RSE: 0.2961646616458893

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.4349460303783417, RMSE: 0.6595043540000916, MAE: 0.4763880968093872, RSE: 0.6394883394241333
Unscaled Metrics - MSE: 35436588.0, RMSE: 5952.86376953125, MAE: 3990.803466796875, RSE: 0.29660025238990784

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_24_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3407999
	speed: 0.0697s/iter; left time: 615.3187s
	iters: 200, epoch: 1 | loss: 0.3598070
	speed: 0.0421s/iter; left time: 367.7602s
	iters: 300, epoch: 1 | loss: 0.3071695
	speed: 0.0424s/iter; left time: 365.8797s
	iters: 400, epoch: 1 | loss: 0.3217622
	speed: 0.0424s/iter; left time: 361.3499s
	iters: 500, epoch: 1 | loss: 0.3050108
	speed: 0.0424s/iter; left time: 357.3816s
	iters: 600, epoch: 1 | loss: 0.3329523
	speed: 0.0424s/iter; left time: 352.8376s
	iters: 700, epoch: 1 | loss: 0.2990830
	speed: 0.0424s/iter; left time: 348.6590s
	iters: 800, epoch: 1 | loss: 0.2877811
	speed: 0.0423s/iter; left time: 344.3195s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.26s
Steps: 893 | Train Loss: 0.3166869 Vali Loss: 0.3205190 Test Loss: 0.3306546
Validation loss decreased (inf --> 0.320519).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3504318
	speed: 0.1525s/iter; left time: 1210.9338s
	iters: 200, epoch: 2 | loss: 0.3321462
	speed: 0.0424s/iter; left time: 332.2146s
	iters: 300, epoch: 2 | loss: 0.2899115
	speed: 0.0424s/iter; left time: 327.7598s
	iters: 400, epoch: 2 | loss: 0.2918292
	speed: 0.0424s/iter; left time: 323.6287s
	iters: 500, epoch: 2 | loss: 0.2904305
	speed: 0.0424s/iter; left time: 319.5672s
	iters: 600, epoch: 2 | loss: 0.2945925
	speed: 0.0424s/iter; left time: 315.1284s
	iters: 700, epoch: 2 | loss: 0.2926659
	speed: 0.0424s/iter; left time: 311.0399s
	iters: 800, epoch: 2 | loss: 0.2831026
	speed: 0.0424s/iter; left time: 306.6248s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.05s
Steps: 893 | Train Loss: 0.2996101 Vali Loss: 0.3356258 Test Loss: 0.3559322
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2392561
	speed: 0.1501s/iter; left time: 1057.6539s
	iters: 200, epoch: 3 | loss: 0.2852877
	speed: 0.0423s/iter; left time: 293.9754s
	iters: 300, epoch: 3 | loss: 0.2525412
	speed: 0.0424s/iter; left time: 290.3136s
	iters: 400, epoch: 3 | loss: 0.2729546
	speed: 0.0424s/iter; left time: 285.8616s
	iters: 500, epoch: 3 | loss: 0.2617796
	speed: 0.0424s/iter; left time: 281.7719s
	iters: 600, epoch: 3 | loss: 0.2953496
	speed: 0.0424s/iter; left time: 277.8198s
	iters: 700, epoch: 3 | loss: 0.2387735
	speed: 0.0426s/iter; left time: 274.3965s
	iters: 800, epoch: 3 | loss: 0.2972452
	speed: 0.0425s/iter; left time: 269.9364s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.07s
Steps: 893 | Train Loss: 0.2766799 Vali Loss: 0.3361943 Test Loss: 0.3511512
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2737566
	speed: 0.1508s/iter; left time: 927.5392s
	iters: 200, epoch: 4 | loss: 0.2433610
	speed: 0.0423s/iter; left time: 255.9719s
	iters: 300, epoch: 4 | loss: 0.2543726
	speed: 0.0423s/iter; left time: 251.6670s
	iters: 400, epoch: 4 | loss: 0.2220378
	speed: 0.0423s/iter; left time: 247.5232s
	iters: 500, epoch: 4 | loss: 0.3129626
	speed: 0.0424s/iter; left time: 243.9160s
	iters: 600, epoch: 4 | loss: 0.2391707
	speed: 0.0423s/iter; left time: 239.2810s
	iters: 700, epoch: 4 | loss: 0.2357916
	speed: 0.0423s/iter; left time: 234.9157s
	iters: 800, epoch: 4 | loss: 0.2973626
	speed: 0.0425s/iter; left time: 231.6065s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.99s
Steps: 893 | Train Loss: 0.2566382 Vali Loss: 0.3036595 Test Loss: 0.3120285
Validation loss decreased (0.320519 --> 0.303660).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2369801
	speed: 0.1533s/iter; left time: 806.3813s
	iters: 200, epoch: 5 | loss: 0.2127407
	speed: 0.0423s/iter; left time: 218.2689s
	iters: 300, epoch: 5 | loss: 0.2476412
	speed: 0.0424s/iter; left time: 214.2930s
	iters: 400, epoch: 5 | loss: 0.2261378
	speed: 0.0423s/iter; left time: 209.9362s
	iters: 500, epoch: 5 | loss: 0.2450154
	speed: 0.0423s/iter; left time: 205.6001s
	iters: 600, epoch: 5 | loss: 0.2148946
	speed: 0.0423s/iter; left time: 201.4148s
	iters: 700, epoch: 5 | loss: 0.2560253
	speed: 0.0423s/iter; left time: 197.2089s
	iters: 800, epoch: 5 | loss: 0.2288969
	speed: 0.0423s/iter; left time: 193.0101s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.2457368 Vali Loss: 0.3050472 Test Loss: 0.3138959
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2109427
	speed: 0.1508s/iter; left time: 658.4415s
	iters: 200, epoch: 6 | loss: 0.2650115
	speed: 0.0423s/iter; left time: 180.4568s
	iters: 300, epoch: 6 | loss: 0.2831419
	speed: 0.0423s/iter; left time: 176.0496s
	iters: 400, epoch: 6 | loss: 0.2267048
	speed: 0.0423s/iter; left time: 171.9640s
	iters: 500, epoch: 6 | loss: 0.2382194
	speed: 0.0423s/iter; left time: 167.6327s
	iters: 600, epoch: 6 | loss: 0.2519537
	speed: 0.0423s/iter; left time: 163.5303s
	iters: 700, epoch: 6 | loss: 0.2022270
	speed: 0.0423s/iter; left time: 159.1781s
	iters: 800, epoch: 6 | loss: 0.2319725
	speed: 0.0423s/iter; left time: 155.0073s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.93s
Steps: 893 | Train Loss: 0.2408286 Vali Loss: 0.2955035 Test Loss: 0.3079064
Validation loss decreased (0.303660 --> 0.295503).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2475756
	speed: 0.1530s/iter; left time: 531.3682s
	iters: 200, epoch: 7 | loss: 0.2347258
	speed: 0.0423s/iter; left time: 142.8418s
	iters: 300, epoch: 7 | loss: 0.2438284
	speed: 0.0423s/iter; left time: 138.5680s
	iters: 400, epoch: 7 | loss: 0.2352685
	speed: 0.0423s/iter; left time: 134.2759s
	iters: 500, epoch: 7 | loss: 0.2425852
	speed: 0.0423s/iter; left time: 129.9323s
	iters: 600, epoch: 7 | loss: 0.2188660
	speed: 0.0423s/iter; left time: 125.6779s
	iters: 700, epoch: 7 | loss: 0.2236696
	speed: 0.0423s/iter; left time: 121.5110s
	iters: 800, epoch: 7 | loss: 0.2287398
	speed: 0.0424s/iter; left time: 117.4817s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.01s
Steps: 893 | Train Loss: 0.2348060 Vali Loss: 0.3015920 Test Loss: 0.3169947
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2366807
	speed: 0.1505s/iter; left time: 388.2172s
	iters: 200, epoch: 8 | loss: 0.2345567
	speed: 0.0423s/iter; left time: 104.9477s
	iters: 300, epoch: 8 | loss: 0.2331254
	speed: 0.0424s/iter; left time: 100.8302s
	iters: 400, epoch: 8 | loss: 0.2523240
	speed: 0.0424s/iter; left time: 96.5976s
	iters: 500, epoch: 8 | loss: 0.2475058
	speed: 0.0424s/iter; left time: 92.3311s
	iters: 600, epoch: 8 | loss: 0.1926418
	speed: 0.0423s/iter; left time: 88.0733s
	iters: 700, epoch: 8 | loss: 0.2304193
	speed: 0.0423s/iter; left time: 83.7921s
	iters: 800, epoch: 8 | loss: 0.2657511
	speed: 0.0423s/iter; left time: 79.5602s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.98s
Steps: 893 | Train Loss: 0.2285872 Vali Loss: 0.2974900 Test Loss: 0.3135431
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.1835249
	speed: 0.1505s/iter; left time: 253.8225s
	iters: 200, epoch: 9 | loss: 0.2128022
	speed: 0.0423s/iter; left time: 67.1860s
	iters: 300, epoch: 9 | loss: 0.2322543
	speed: 0.0423s/iter; left time: 62.9407s
	iters: 400, epoch: 9 | loss: 0.2192557
	speed: 0.0424s/iter; left time: 58.7532s
	iters: 500, epoch: 9 | loss: 0.2268734
	speed: 0.0423s/iter; left time: 54.4791s
	iters: 600, epoch: 9 | loss: 0.2262852
	speed: 0.0423s/iter; left time: 50.2410s
	iters: 700, epoch: 9 | loss: 0.2455889
	speed: 0.0423s/iter; left time: 45.9851s
	iters: 800, epoch: 9 | loss: 0.2084319
	speed: 0.0423s/iter; left time: 41.7791s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:37.97s
Steps: 893 | Train Loss: 0.2212555 Vali Loss: 0.2979143 Test Loss: 0.3168210
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2377876341342926, rmse:0.4876347482204437, mae:0.3079063892364502, rse:0.47400835156440735
Original data scale mse:17101788.0, rmse:4135.4306640625, mae:2451.934326171875, rse:0.20562195777893066
Use GPU: cuda:0
>>>>>>>start training : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3492706
	speed: 0.0441s/iter; left time: 389.5203s
	iters: 200, epoch: 1 | loss: 0.3223646
	speed: 0.0423s/iter; left time: 369.4906s
	iters: 300, epoch: 1 | loss: 0.2889603
	speed: 0.0423s/iter; left time: 365.1428s
	iters: 400, epoch: 1 | loss: 0.3188570
	speed: 0.0423s/iter; left time: 360.7758s
	iters: 500, epoch: 1 | loss: 0.2894336
	speed: 0.0423s/iter; left time: 356.8956s
	iters: 600, epoch: 1 | loss: 0.2879969
	speed: 0.0423s/iter; left time: 352.6754s
	iters: 700, epoch: 1 | loss: 0.2803269
	speed: 0.0423s/iter; left time: 348.3860s
	iters: 800, epoch: 1 | loss: 0.3026388
	speed: 0.0423s/iter; left time: 344.3426s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.03s
Steps: 893 | Train Loss: 0.3160063 Vali Loss: 0.3210048 Test Loss: 0.3320904
Validation loss decreased (inf --> 0.321005).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2829548
	speed: 0.1547s/iter; left time: 1227.7542s
	iters: 200, epoch: 2 | loss: 0.2896182
	speed: 0.0426s/iter; left time: 334.2216s
	iters: 300, epoch: 2 | loss: 0.3115814
	speed: 0.0426s/iter; left time: 329.7647s
	iters: 400, epoch: 2 | loss: 0.3041964
	speed: 0.0425s/iter; left time: 324.9654s
	iters: 500, epoch: 2 | loss: 0.2696025
	speed: 0.0425s/iter; left time: 320.4307s
	iters: 600, epoch: 2 | loss: 0.2711208
	speed: 0.0425s/iter; left time: 316.1814s
	iters: 700, epoch: 2 | loss: 0.2873453
	speed: 0.0425s/iter; left time: 312.1943s
	iters: 800, epoch: 2 | loss: 0.2799840
	speed: 0.0425s/iter; left time: 307.5763s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.33s
Steps: 893 | Train Loss: 0.2978686 Vali Loss: 0.3381143 Test Loss: 0.3496448
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2987165
	speed: 0.1516s/iter; left time: 1067.9577s
	iters: 200, epoch: 3 | loss: 0.2989759
	speed: 0.0425s/iter; left time: 294.8670s
	iters: 300, epoch: 3 | loss: 0.2987199
	speed: 0.0424s/iter; left time: 290.1841s
	iters: 400, epoch: 3 | loss: 0.2439609
	speed: 0.0424s/iter; left time: 285.7858s
	iters: 500, epoch: 3 | loss: 0.2935893
	speed: 0.0424s/iter; left time: 281.7523s
	iters: 600, epoch: 3 | loss: 0.2593340
	speed: 0.0424s/iter; left time: 277.4921s
	iters: 700, epoch: 3 | loss: 0.2762191
	speed: 0.0424s/iter; left time: 273.0630s
	iters: 800, epoch: 3 | loss: 0.2418674
	speed: 0.0424s/iter; left time: 268.8040s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.07s
Steps: 893 | Train Loss: 0.2761183 Vali Loss: 0.3319752 Test Loss: 0.3455724
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2644875
	speed: 0.1527s/iter; left time: 939.1049s
	iters: 200, epoch: 4 | loss: 0.2581673
	speed: 0.0424s/iter; left time: 256.3613s
	iters: 300, epoch: 4 | loss: 0.2791232
	speed: 0.0423s/iter; left time: 252.0342s
	iters: 400, epoch: 4 | loss: 0.2887608
	speed: 0.0423s/iter; left time: 247.7439s
	iters: 500, epoch: 4 | loss: 0.3367523
	speed: 0.0423s/iter; left time: 243.5163s
	iters: 600, epoch: 4 | loss: 0.2712596
	speed: 0.0423s/iter; left time: 239.3620s
	iters: 700, epoch: 4 | loss: 0.2736810
	speed: 0.0424s/iter; left time: 235.2783s
	iters: 800, epoch: 4 | loss: 0.2366427
	speed: 0.0424s/iter; left time: 231.3671s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.09s
Steps: 893 | Train Loss: 0.2635901 Vali Loss: 0.2953023 Test Loss: 0.3092164
Validation loss decreased (0.321005 --> 0.295302).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2878520
	speed: 0.1544s/iter; left time: 812.0742s
	iters: 200, epoch: 5 | loss: 0.2102588
	speed: 0.0423s/iter; left time: 218.4423s
	iters: 300, epoch: 5 | loss: 0.2345979
	speed: 0.0424s/iter; left time: 214.5795s
	iters: 400, epoch: 5 | loss: 0.2620084
	speed: 0.0424s/iter; left time: 210.2182s
	iters: 500, epoch: 5 | loss: 0.2468795
	speed: 0.0424s/iter; left time: 205.9627s
	iters: 600, epoch: 5 | loss: 0.2531159
	speed: 0.0424s/iter; left time: 201.6793s
	iters: 700, epoch: 5 | loss: 0.2624674
	speed: 0.0424s/iter; left time: 197.4906s
	iters: 800, epoch: 5 | loss: 0.2523279
	speed: 0.0424s/iter; left time: 193.3633s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.08s
Steps: 893 | Train Loss: 0.2496463 Vali Loss: 0.2956663 Test Loss: 0.3079102
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2645135
	speed: 0.1516s/iter; left time: 661.8346s
	iters: 200, epoch: 6 | loss: 0.2888856
	speed: 0.0424s/iter; left time: 180.8638s
	iters: 300, epoch: 6 | loss: 0.2524284
	speed: 0.0424s/iter; left time: 176.5309s
	iters: 400, epoch: 6 | loss: 0.2396919
	speed: 0.0424s/iter; left time: 172.2338s
	iters: 500, epoch: 6 | loss: 0.2145966
	speed: 0.0423s/iter; left time: 167.9257s
	iters: 600, epoch: 6 | loss: 0.2417455
	speed: 0.0423s/iter; left time: 163.6817s
	iters: 700, epoch: 6 | loss: 0.2306209
	speed: 0.0424s/iter; left time: 159.7886s
	iters: 800, epoch: 6 | loss: 0.2561377
	speed: 0.0424s/iter; left time: 155.2935s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.03s
Steps: 893 | Train Loss: 0.2426151 Vali Loss: 0.2960870 Test Loss: 0.3072562
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2144406
	speed: 0.1508s/iter; left time: 523.6642s
	iters: 200, epoch: 7 | loss: 0.2333319
	speed: 0.0423s/iter; left time: 142.8095s
	iters: 300, epoch: 7 | loss: 0.1970526
	speed: 0.0423s/iter; left time: 138.5929s
	iters: 400, epoch: 7 | loss: 0.3026087
	speed: 0.0424s/iter; left time: 134.4080s
	iters: 500, epoch: 7 | loss: 0.2297455
	speed: 0.0424s/iter; left time: 130.2529s
	iters: 600, epoch: 7 | loss: 0.2446831
	speed: 0.0424s/iter; left time: 125.9492s
	iters: 700, epoch: 7 | loss: 0.2462345
	speed: 0.0424s/iter; left time: 121.6947s
	iters: 800, epoch: 7 | loss: 0.2369884
	speed: 0.0424s/iter; left time: 117.4509s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:38.02s
Steps: 893 | Train Loss: 0.2370268 Vali Loss: 0.2942532 Test Loss: 0.3022617
Validation loss decreased (0.295302 --> 0.294253).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2856607
	speed: 0.1538s/iter; left time: 396.7044s
	iters: 200, epoch: 8 | loss: 0.2385260
	speed: 0.0426s/iter; left time: 105.5903s
	iters: 300, epoch: 8 | loss: 0.2134833
	speed: 0.0426s/iter; left time: 101.3815s
	iters: 400, epoch: 8 | loss: 0.2082520
	speed: 0.0424s/iter; left time: 96.6366s
	iters: 500, epoch: 8 | loss: 0.1990080
	speed: 0.0424s/iter; left time: 92.4528s
	iters: 600, epoch: 8 | loss: 0.2227144
	speed: 0.0424s/iter; left time: 88.2767s
	iters: 700, epoch: 8 | loss: 0.2333554
	speed: 0.0424s/iter; left time: 83.9102s
	iters: 800, epoch: 8 | loss: 0.2240583
	speed: 0.0422s/iter; left time: 79.3158s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:38.13s
Steps: 893 | Train Loss: 0.2323620 Vali Loss: 0.2965825 Test Loss: 0.3090989
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2148220
	speed: 0.1533s/iter; left time: 258.6684s
	iters: 200, epoch: 9 | loss: 0.2325328
	speed: 0.0425s/iter; left time: 67.4742s
	iters: 300, epoch: 9 | loss: 0.2081405
	speed: 0.0425s/iter; left time: 63.2401s
	iters: 400, epoch: 9 | loss: 0.2322678
	speed: 0.0425s/iter; left time: 59.0138s
	iters: 500, epoch: 9 | loss: 0.2300684
	speed: 0.0425s/iter; left time: 54.7037s
	iters: 600, epoch: 9 | loss: 0.2085957
	speed: 0.0425s/iter; left time: 50.4728s
	iters: 700, epoch: 9 | loss: 0.2004253
	speed: 0.0425s/iter; left time: 46.1802s
	iters: 800, epoch: 9 | loss: 0.2524276
	speed: 0.0425s/iter; left time: 41.9405s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:38.23s
Steps: 893 | Train Loss: 0.2249389 Vali Loss: 0.2973551 Test Loss: 0.3165964
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.2028467
	speed: 0.1523s/iter; left time: 120.9030s
	iters: 200, epoch: 10 | loss: 0.2189615
	speed: 0.0425s/iter; left time: 29.4652s
	iters: 300, epoch: 10 | loss: 0.2061844
	speed: 0.0424s/iter; left time: 25.1700s
	iters: 400, epoch: 10 | loss: 0.2266684
	speed: 0.0424s/iter; left time: 20.9451s
	iters: 500, epoch: 10 | loss: 0.2374375
	speed: 0.0424s/iter; left time: 16.7075s
	iters: 600, epoch: 10 | loss: 0.2025374
	speed: 0.0424s/iter; left time: 12.4613s
	iters: 700, epoch: 10 | loss: 0.2168925
	speed: 0.0423s/iter; left time: 8.2123s
	iters: 800, epoch: 10 | loss: 0.2289431
	speed: 0.0423s/iter; left time: 3.9805s
-------------------------------------------------------------------------------------
Epoch: 10
Cost time: 00h:00m:38.05s
Steps: 893 | Train Loss: 0.2178133 Vali Loss: 0.2988171 Test Loss: 0.3171611
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_24_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.23179012537002563, rmse:0.48144587874412537, mae:0.3022615611553192, rse:0.4679924249649048
Original data scale mse:16840840.0, rmse:4103.75927734375, mae:2404.939697265625, rse:0.20404717326164246

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2377876341342926, RMSE: 0.4876347482204437, MAE: 0.3079063892364502, RSE: 0.47400835156440735
Unscaled Metrics - MSE: 17101788.0, RMSE: 4135.4306640625, MAE: 2451.934326171875, RSE: 0.20562195777893066

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.23179012537002563, RMSE: 0.48144587874412537, MAE: 0.3022615611553192, RSE: 0.4679924249649048
Unscaled Metrics - MSE: 16840840.0, RMSE: 4103.75927734375, MAE: 2404.939697265625, RSE: 0.20404717326164246

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_96_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.4684884
	speed: 0.0704s/iter; left time: 620.1388s
	iters: 200, epoch: 1 | loss: 0.3876328
	speed: 0.0427s/iter; left time: 371.9052s
	iters: 300, epoch: 1 | loss: 0.4045758
	speed: 0.0427s/iter; left time: 367.7011s
	iters: 400, epoch: 1 | loss: 0.3567076
	speed: 0.0427s/iter; left time: 363.5386s
	iters: 500, epoch: 1 | loss: 0.3886242
	speed: 0.0428s/iter; left time: 359.6369s
	iters: 600, epoch: 1 | loss: 0.3619347
	speed: 0.0427s/iter; left time: 355.0105s
	iters: 700, epoch: 1 | loss: 0.3875395
	speed: 0.0427s/iter; left time: 350.8063s
	iters: 800, epoch: 1 | loss: 0.4044845
	speed: 0.0427s/iter; left time: 346.5733s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.51s
Steps: 891 | Train Loss: 0.3969716 Vali Loss: 0.4126247 Test Loss: 0.4411414
Validation loss decreased (inf --> 0.412625).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3930952
	speed: 0.1537s/iter; left time: 1217.6215s
	iters: 200, epoch: 2 | loss: 0.3762832
	speed: 0.0427s/iter; left time: 333.9568s
	iters: 300, epoch: 2 | loss: 0.3693455
	speed: 0.0427s/iter; left time: 329.6515s
	iters: 400, epoch: 2 | loss: 0.4095068
	speed: 0.0427s/iter; left time: 325.5429s
	iters: 500, epoch: 2 | loss: 0.3498340
	speed: 0.0427s/iter; left time: 321.2291s
	iters: 600, epoch: 2 | loss: 0.3334362
	speed: 0.0427s/iter; left time: 316.8363s
	iters: 700, epoch: 2 | loss: 0.3262864
	speed: 0.0427s/iter; left time: 312.4941s
	iters: 800, epoch: 2 | loss: 0.3890919
	speed: 0.0427s/iter; left time: 308.2111s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.27s
Steps: 891 | Train Loss: 0.3827000 Vali Loss: 0.4105951 Test Loss: 0.4732466
Validation loss decreased (0.412625 --> 0.410595).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3412500
	speed: 0.1530s/iter; left time: 1075.6923s
	iters: 200, epoch: 3 | loss: 0.3567889
	speed: 0.0427s/iter; left time: 296.2061s
	iters: 300, epoch: 3 | loss: 0.3673129
	speed: 0.0427s/iter; left time: 291.8884s
	iters: 400, epoch: 3 | loss: 0.3337844
	speed: 0.0427s/iter; left time: 287.5245s
	iters: 500, epoch: 3 | loss: 0.3484310
	speed: 0.0427s/iter; left time: 283.2105s
	iters: 600, epoch: 3 | loss: 0.3459015
	speed: 0.0427s/iter; left time: 279.0733s
	iters: 700, epoch: 3 | loss: 0.3497356
	speed: 0.0427s/iter; left time: 274.7621s
	iters: 800, epoch: 3 | loss: 0.3012187
	speed: 0.0428s/iter; left time: 270.6203s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.28s
Steps: 891 | Train Loss: 0.3451515 Vali Loss: 0.4153292 Test Loss: 0.4852614
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3396926
	speed: 0.1509s/iter; left time: 926.4915s
	iters: 200, epoch: 4 | loss: 0.3588603
	speed: 0.0427s/iter; left time: 258.0120s
	iters: 300, epoch: 4 | loss: 0.3529438
	speed: 0.0427s/iter; left time: 253.7474s
	iters: 400, epoch: 4 | loss: 0.3635230
	speed: 0.0427s/iter; left time: 249.4269s
	iters: 500, epoch: 4 | loss: 0.3119981
	speed: 0.0427s/iter; left time: 245.1838s
	iters: 600, epoch: 4 | loss: 0.3348911
	speed: 0.0427s/iter; left time: 240.8692s
	iters: 700, epoch: 4 | loss: 0.3236400
	speed: 0.0427s/iter; left time: 236.6809s
	iters: 800, epoch: 4 | loss: 0.2864905
	speed: 0.0427s/iter; left time: 232.2317s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.26s
Steps: 891 | Train Loss: 0.3211430 Vali Loss: 0.4266058 Test Loss: 0.5030828
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2955221
	speed: 0.1506s/iter; left time: 790.0143s
	iters: 200, epoch: 5 | loss: 0.2874321
	speed: 0.0429s/iter; left time: 220.9262s
	iters: 300, epoch: 5 | loss: 0.3218697
	speed: 0.0429s/iter; left time: 216.3066s
	iters: 400, epoch: 5 | loss: 0.2892837
	speed: 0.0428s/iter; left time: 211.8519s
	iters: 500, epoch: 5 | loss: 0.2901415
	speed: 0.0428s/iter; left time: 207.5334s
	iters: 600, epoch: 5 | loss: 0.2946918
	speed: 0.0428s/iter; left time: 203.2781s
	iters: 700, epoch: 5 | loss: 0.2595286
	speed: 0.0428s/iter; left time: 198.9766s
	iters: 800, epoch: 5 | loss: 0.2591929
	speed: 0.0427s/iter; left time: 194.3041s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.35s
Steps: 891 | Train Loss: 0.2920518 Vali Loss: 0.4303524 Test Loss: 0.5138320
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.5228630304336548, rmse:0.7230926752090454, mae:0.47324660420417786, rse:0.7032999992370605
Original data scale mse:37380588.0, rmse:6113.966796875, mae:3756.436767578125, rse:0.304477721452713
Use GPU: cuda:0
>>>>>>>start training : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.4066630
	speed: 0.0445s/iter; left time: 392.5133s
	iters: 200, epoch: 1 | loss: 0.3719214
	speed: 0.0427s/iter; left time: 371.8552s
	iters: 300, epoch: 1 | loss: 0.4187882
	speed: 0.0427s/iter; left time: 367.6375s
	iters: 400, epoch: 1 | loss: 0.4305293
	speed: 0.0427s/iter; left time: 363.6047s
	iters: 500, epoch: 1 | loss: 0.3620389
	speed: 0.0427s/iter; left time: 359.1316s
	iters: 600, epoch: 1 | loss: 0.4129305
	speed: 0.0427s/iter; left time: 355.1640s
	iters: 700, epoch: 1 | loss: 0.3711313
	speed: 0.0427s/iter; left time: 350.8624s
	iters: 800, epoch: 1 | loss: 0.3716925
	speed: 0.0427s/iter; left time: 346.4740s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.30s
Steps: 891 | Train Loss: 0.3972458 Vali Loss: 0.4115500 Test Loss: 0.4406545
Validation loss decreased (inf --> 0.411550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4028302
	speed: 0.1533s/iter; left time: 1214.2669s
	iters: 200, epoch: 2 | loss: 0.3742743
	speed: 0.0427s/iter; left time: 333.7863s
	iters: 300, epoch: 2 | loss: 0.3932038
	speed: 0.0427s/iter; left time: 329.5074s
	iters: 400, epoch: 2 | loss: 0.3760182
	speed: 0.0427s/iter; left time: 325.1327s
	iters: 500, epoch: 2 | loss: 0.3723770
	speed: 0.0427s/iter; left time: 321.0985s
	iters: 600, epoch: 2 | loss: 0.3611200
	speed: 0.0427s/iter; left time: 316.6957s
	iters: 700, epoch: 2 | loss: 0.4004166
	speed: 0.0427s/iter; left time: 312.3201s
	iters: 800, epoch: 2 | loss: 0.3619330
	speed: 0.0427s/iter; left time: 308.0910s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.25s
Steps: 891 | Train Loss: 0.3844349 Vali Loss: 0.4448619 Test Loss: 0.4925394
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3688284
	speed: 0.1503s/iter; left time: 1056.3377s
	iters: 200, epoch: 3 | loss: 0.3374178
	speed: 0.0427s/iter; left time: 295.8017s
	iters: 300, epoch: 3 | loss: 0.3261121
	speed: 0.0427s/iter; left time: 291.5532s
	iters: 400, epoch: 3 | loss: 0.3530890
	speed: 0.0427s/iter; left time: 287.3141s
	iters: 500, epoch: 3 | loss: 0.3203424
	speed: 0.0427s/iter; left time: 283.2038s
	iters: 600, epoch: 3 | loss: 0.3498648
	speed: 0.0427s/iter; left time: 278.8635s
	iters: 700, epoch: 3 | loss: 0.3799568
	speed: 0.0427s/iter; left time: 274.5547s
	iters: 800, epoch: 3 | loss: 0.3457251
	speed: 0.0427s/iter; left time: 270.5482s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.23s
Steps: 891 | Train Loss: 0.3539214 Vali Loss: 0.4222977 Test Loss: 0.4667308
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3712475
	speed: 0.1524s/iter; left time: 935.4222s
	iters: 200, epoch: 4 | loss: 0.3155898
	speed: 0.0427s/iter; left time: 257.9800s
	iters: 300, epoch: 4 | loss: 0.3220321
	speed: 0.0426s/iter; left time: 253.2353s
	iters: 400, epoch: 4 | loss: 0.3338384
	speed: 0.0427s/iter; left time: 249.0726s
	iters: 500, epoch: 4 | loss: 0.2876443
	speed: 0.0427s/iter; left time: 245.1514s
	iters: 600, epoch: 4 | loss: 0.3284000
	speed: 0.0427s/iter; left time: 240.6321s
	iters: 700, epoch: 4 | loss: 0.3487631
	speed: 0.0427s/iter; left time: 236.4535s
	iters: 800, epoch: 4 | loss: 0.3167527
	speed: 0.0427s/iter; left time: 232.2059s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.30s
Steps: 891 | Train Loss: 0.3331307 Vali Loss: 0.4358769 Test Loss: 0.4705009
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_96_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.4096048176288605, rmse:0.6400037407875061, mae:0.44065436720848083, rse:0.6224853992462158
Original data scale mse:32031288.0, rmse:5659.619140625, mae:3615.173583984375, rse:0.28185105323791504

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.5228630304336548, RMSE: 0.7230926752090454, MAE: 0.47324660420417786, RSE: 0.7032999992370605
Unscaled Metrics - MSE: 37380588.0, RMSE: 6113.966796875, MAE: 3756.436767578125, RSE: 0.304477721452713

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.4096048176288605, RMSE: 0.6400037407875061, MAE: 0.44065436720848083, RSE: 0.6224853992462158
Unscaled Metrics - MSE: 32031288.0, RMSE: 5659.619140625, MAE: 3615.173583984375, RSE: 0.28185105323791504

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_512_168_loss_choice_for_DE', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4762464
	speed: 0.0698s/iter; left time: 613.1802s
	iters: 200, epoch: 1 | loss: 0.4044638
	speed: 0.0432s/iter; left time: 375.7523s
	iters: 300, epoch: 1 | loss: 0.4141133
	speed: 0.0432s/iter; left time: 371.4893s
	iters: 400, epoch: 1 | loss: 0.4548874
	speed: 0.0433s/iter; left time: 367.2673s
	iters: 500, epoch: 1 | loss: 0.4367705
	speed: 0.0433s/iter; left time: 363.7355s
	iters: 600, epoch: 1 | loss: 0.4084821
	speed: 0.0432s/iter; left time: 358.3047s
	iters: 700, epoch: 1 | loss: 0.3975303
	speed: 0.0432s/iter; left time: 353.7288s
	iters: 800, epoch: 1 | loss: 0.3965552
	speed: 0.0432s/iter; left time: 349.6155s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.88s
Steps: 889 | Train Loss: 0.4141807 Vali Loss: 0.4243684 Test Loss: 0.4601092
Validation loss decreased (inf --> 0.424368).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4300737
	speed: 0.1577s/iter; left time: 1246.2801s
	iters: 200, epoch: 2 | loss: 0.3933316
	speed: 0.0432s/iter; left time: 337.3625s
	iters: 300, epoch: 2 | loss: 0.4373253
	speed: 0.0432s/iter; left time: 332.6225s
	iters: 400, epoch: 2 | loss: 0.4031954
	speed: 0.0432s/iter; left time: 328.4360s
	iters: 500, epoch: 2 | loss: 0.3785727
	speed: 0.0432s/iter; left time: 324.3987s
	iters: 600, epoch: 2 | loss: 0.3911959
	speed: 0.0432s/iter; left time: 319.7632s
	iters: 700, epoch: 2 | loss: 0.3645288
	speed: 0.0432s/iter; left time: 315.2958s
	iters: 800, epoch: 2 | loss: 0.3864062
	speed: 0.0432s/iter; left time: 311.0595s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.62s
Steps: 889 | Train Loss: 0.3935670 Vali Loss: 0.4280627 Test Loss: 0.5137021
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3668686
	speed: 0.1517s/iter; left time: 1063.9828s
	iters: 200, epoch: 3 | loss: 0.3259976
	speed: 0.0432s/iter; left time: 298.9398s
	iters: 300, epoch: 3 | loss: 0.3444952
	speed: 0.0432s/iter; left time: 294.5388s
	iters: 400, epoch: 3 | loss: 0.3990349
	speed: 0.0432s/iter; left time: 290.2631s
	iters: 500, epoch: 3 | loss: 0.3777921
	speed: 0.0432s/iter; left time: 285.8708s
	iters: 600, epoch: 3 | loss: 0.3382579
	speed: 0.0432s/iter; left time: 281.3408s
	iters: 700, epoch: 3 | loss: 0.3370208
	speed: 0.0432s/iter; left time: 277.3431s
	iters: 800, epoch: 3 | loss: 0.3277113
	speed: 0.0433s/iter; left time: 273.1573s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.63s
Steps: 889 | Train Loss: 0.3484925 Vali Loss: 0.4450209 Test Loss: 0.5042545
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3274429
	speed: 0.1513s/iter; left time: 926.2675s
	iters: 200, epoch: 4 | loss: 0.2927153
	speed: 0.0432s/iter; left time: 260.0865s
	iters: 300, epoch: 4 | loss: 0.3465253
	speed: 0.0432s/iter; left time: 255.7508s
	iters: 400, epoch: 4 | loss: 0.2953821
	speed: 0.0432s/iter; left time: 251.4553s
	iters: 500, epoch: 4 | loss: 0.3188933
	speed: 0.0432s/iter; left time: 247.5413s
	iters: 600, epoch: 4 | loss: 0.2916814
	speed: 0.0432s/iter; left time: 242.8962s
	iters: 700, epoch: 4 | loss: 0.3051240
	speed: 0.0432s/iter; left time: 238.6241s
	iters: 800, epoch: 4 | loss: 0.3008286
	speed: 0.0432s/iter; left time: 234.3801s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.59s
Steps: 889 | Train Loss: 0.3087744 Vali Loss: 0.4448800 Test Loss: 0.5246037
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.43595191836357117, rmse:0.6602665781974792, mae:0.460109144449234, rse:0.6402274370193481
Original data scale mse:34436244.0, rmse:5868.240234375, mae:3779.667236328125, rse:0.29238390922546387
Use GPU: cuda:0
>>>>>>>start training : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4119244
	speed: 0.0452s/iter; left time: 397.1317s
	iters: 200, epoch: 1 | loss: 0.4654200
	speed: 0.0432s/iter; left time: 375.3839s
	iters: 300, epoch: 1 | loss: 0.4333512
	speed: 0.0432s/iter; left time: 370.7699s
	iters: 400, epoch: 1 | loss: 0.4041139
	speed: 0.0432s/iter; left time: 366.6090s
	iters: 500, epoch: 1 | loss: 0.3992240
	speed: 0.0432s/iter; left time: 362.7811s
	iters: 600, epoch: 1 | loss: 0.4176375
	speed: 0.0432s/iter; left time: 358.2323s
	iters: 700, epoch: 1 | loss: 0.3749172
	speed: 0.0432s/iter; left time: 353.6500s
	iters: 800, epoch: 1 | loss: 0.3851109
	speed: 0.0432s/iter; left time: 349.4809s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.64s
Steps: 889 | Train Loss: 0.4149217 Vali Loss: 0.4246492 Test Loss: 0.4598440
Validation loss decreased (inf --> 0.424649).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4789046
	speed: 0.1550s/iter; left time: 1225.1736s
	iters: 200, epoch: 2 | loss: 0.4431178
	speed: 0.0432s/iter; left time: 336.7023s
	iters: 300, epoch: 2 | loss: 0.4717377
	speed: 0.0432s/iter; left time: 332.3623s
	iters: 400, epoch: 2 | loss: 0.4151293
	speed: 0.0432s/iter; left time: 328.2372s
	iters: 500, epoch: 2 | loss: 0.3897159
	speed: 0.0432s/iter; left time: 323.9363s
	iters: 600, epoch: 2 | loss: 0.3489036
	speed: 0.0432s/iter; left time: 319.5512s
	iters: 700, epoch: 2 | loss: 0.3845072
	speed: 0.0432s/iter; left time: 315.5498s
	iters: 800, epoch: 2 | loss: 0.3695348
	speed: 0.0432s/iter; left time: 311.1094s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.62s
Steps: 889 | Train Loss: 0.4010219 Vali Loss: 0.4262091 Test Loss: 0.4661326
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3860887
	speed: 0.1515s/iter; left time: 1062.6268s
	iters: 200, epoch: 3 | loss: 0.3692849
	speed: 0.0431s/iter; left time: 298.1589s
	iters: 300, epoch: 3 | loss: 0.3794353
	speed: 0.0432s/iter; left time: 294.1893s
	iters: 400, epoch: 3 | loss: 0.3844395
	speed: 0.0432s/iter; left time: 289.8401s
	iters: 500, epoch: 3 | loss: 0.3778097
	speed: 0.0433s/iter; left time: 286.0733s
	iters: 600, epoch: 3 | loss: 0.3696763
	speed: 0.0432s/iter; left time: 281.5654s
	iters: 700, epoch: 3 | loss: 0.3511351
	speed: 0.0432s/iter; left time: 277.1471s
	iters: 800, epoch: 3 | loss: 0.3305629
	speed: 0.0432s/iter; left time: 272.8776s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.62s
Steps: 889 | Train Loss: 0.3650697 Vali Loss: 0.4287660 Test Loss: 0.4760078
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3313957
	speed: 0.1522s/iter; left time: 931.7679s
	iters: 200, epoch: 4 | loss: 0.3167084
	speed: 0.0432s/iter; left time: 260.0871s
	iters: 300, epoch: 4 | loss: 0.3513306
	speed: 0.0432s/iter; left time: 255.8811s
	iters: 400, epoch: 4 | loss: 0.3763891
	speed: 0.0432s/iter; left time: 251.4039s
	iters: 500, epoch: 4 | loss: 0.3395450
	speed: 0.0432s/iter; left time: 247.1329s
	iters: 600, epoch: 4 | loss: 0.3299132
	speed: 0.0433s/iter; left time: 243.3341s
	iters: 700, epoch: 4 | loss: 0.3232048
	speed: 0.0432s/iter; left time: 238.6018s
	iters: 800, epoch: 4 | loss: 0.3140013
	speed: 0.0433s/iter; left time: 234.6607s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.63s
Steps: 889 | Train Loss: 0.3307437 Vali Loss: 0.4614118 Test Loss: 0.5043946
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_512_168_loss_choice_for_DE_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.43597641587257385, rmse:0.6602851152420044, mae:0.4598439037799835, rse:0.6402454376220703
Original data scale mse:34408188.0, rmse:5865.84912109375, mae:3774.69189453125, rse:0.29226478934288025

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.43595191836357117, RMSE: 0.6602665781974792, MAE: 0.460109144449234, RSE: 0.6402274370193481
Unscaled Metrics - MSE: 34436244.0, RMSE: 5868.240234375, MAE: 3779.667236328125, RSE: 0.29238390922546387

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.43597641587257385, RMSE: 0.6602851152420044, MAE: 0.4598439037799835, RSE: 0.6402454376220703
Unscaled Metrics - MSE: 34408188.0, RMSE: 5865.84912109375, MAE: 3774.69189453125, RSE: 0.29226478934288025
