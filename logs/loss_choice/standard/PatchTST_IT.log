
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3635459
	speed: 0.0542s/iter; left time: 478.6631s
	iters: 200, epoch: 1 | loss: 0.2805775
	speed: 0.0271s/iter; left time: 236.9114s
	iters: 300, epoch: 1 | loss: 0.2656712
	speed: 0.0271s/iter; left time: 234.0820s
	iters: 400, epoch: 1 | loss: 0.2690398
	speed: 0.0272s/iter; left time: 231.9384s
	iters: 500, epoch: 1 | loss: 0.2713995
	speed: 0.0271s/iter; left time: 228.5942s
	iters: 600, epoch: 1 | loss: 0.2403878
	speed: 0.0272s/iter; left time: 226.2509s
	iters: 700, epoch: 1 | loss: 0.1892182
	speed: 0.0272s/iter; left time: 224.2675s
	iters: 800, epoch: 1 | loss: 0.1730661
	speed: 0.0271s/iter; left time: 220.7344s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.74s
Steps: 893 | Train Loss: 0.2722955 Vali Loss: 0.2083140 Test Loss: 0.2306726
Validation loss decreased (inf --> 0.208314).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2297700
	speed: 0.1030s/iter; left time: 817.9982s
	iters: 200, epoch: 2 | loss: 0.1827487
	speed: 0.0272s/iter; left time: 213.0022s
	iters: 300, epoch: 2 | loss: 0.3307474
	speed: 0.0271s/iter; left time: 209.9619s
	iters: 400, epoch: 2 | loss: 0.1958842
	speed: 0.0272s/iter; left time: 207.3940s
	iters: 500, epoch: 2 | loss: 0.1813766
	speed: 0.0271s/iter; left time: 204.3261s
	iters: 600, epoch: 2 | loss: 0.1378947
	speed: 0.0271s/iter; left time: 201.6415s
	iters: 700, epoch: 2 | loss: 0.2011338
	speed: 0.0271s/iter; left time: 199.1600s
	iters: 800, epoch: 2 | loss: 0.1787648
	speed: 0.0271s/iter; left time: 196.3236s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.48s
Steps: 893 | Train Loss: 0.2128299 Vali Loss: 0.2104993 Test Loss: 0.2398966
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1543451
	speed: 0.1009s/iter; left time: 710.7130s
	iters: 200, epoch: 3 | loss: 0.1950878
	speed: 0.0272s/iter; left time: 188.6697s
	iters: 300, epoch: 3 | loss: 0.1569649
	speed: 0.0272s/iter; left time: 186.4873s
	iters: 400, epoch: 3 | loss: 0.1656069
	speed: 0.0272s/iter; left time: 183.6697s
	iters: 500, epoch: 3 | loss: 0.1343244
	speed: 0.0273s/iter; left time: 181.5732s
	iters: 600, epoch: 3 | loss: 0.2523668
	speed: 0.0274s/iter; left time: 179.5167s
	iters: 700, epoch: 3 | loss: 0.1386041
	speed: 0.0273s/iter; left time: 176.1772s
	iters: 800, epoch: 3 | loss: 0.2347610
	speed: 0.0271s/iter; left time: 171.9558s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.51s
Steps: 893 | Train Loss: 0.1871872 Vali Loss: 0.1969667 Test Loss: 0.2162626
Validation loss decreased (0.208314 --> 0.196967).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1806695
	speed: 0.1030s/iter; left time: 633.4800s
	iters: 200, epoch: 4 | loss: 0.1568108
	speed: 0.0273s/iter; left time: 165.1250s
	iters: 300, epoch: 4 | loss: 0.1915195
	speed: 0.0271s/iter; left time: 161.3141s
	iters: 400, epoch: 4 | loss: 0.1531768
	speed: 0.0271s/iter; left time: 158.5219s
	iters: 500, epoch: 4 | loss: 0.1485633
	speed: 0.0270s/iter; left time: 155.5819s
	iters: 600, epoch: 4 | loss: 0.1880901
	speed: 0.0271s/iter; left time: 152.8917s
	iters: 700, epoch: 4 | loss: 0.2071106
	speed: 0.0271s/iter; left time: 150.4938s
	iters: 800, epoch: 4 | loss: 0.2123736
	speed: 0.0272s/iter; left time: 148.1529s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.47s
Steps: 893 | Train Loss: 0.1810817 Vali Loss: 0.2134311 Test Loss: 0.2322863
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2083255
	speed: 0.1009s/iter; left time: 530.4417s
	iters: 200, epoch: 5 | loss: 0.1980859
	speed: 0.0272s/iter; left time: 140.1149s
	iters: 300, epoch: 5 | loss: 0.2196559
	speed: 0.0273s/iter; left time: 137.9876s
	iters: 400, epoch: 5 | loss: 0.2421175
	speed: 0.0271s/iter; left time: 134.3294s
	iters: 500, epoch: 5 | loss: 0.1255061
	speed: 0.0271s/iter; left time: 131.4676s
	iters: 600, epoch: 5 | loss: 0.1598472
	speed: 0.0271s/iter; left time: 128.8016s
	iters: 700, epoch: 5 | loss: 0.1327443
	speed: 0.0271s/iter; left time: 126.2239s
	iters: 800, epoch: 5 | loss: 0.1169138
	speed: 0.0271s/iter; left time: 123.5189s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.42s
Steps: 893 | Train Loss: 0.1681948 Vali Loss: 0.2159996 Test Loss: 0.2342876
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1540388
	speed: 0.1009s/iter; left time: 440.4122s
	iters: 200, epoch: 6 | loss: 0.1664404
	speed: 0.0272s/iter; left time: 115.8666s
	iters: 300, epoch: 6 | loss: 0.1399041
	speed: 0.0272s/iter; left time: 113.1747s
	iters: 400, epoch: 6 | loss: 0.1538104
	speed: 0.0272s/iter; left time: 110.4310s
	iters: 500, epoch: 6 | loss: 0.1333307
	speed: 0.0272s/iter; left time: 107.7163s
	iters: 600, epoch: 6 | loss: 0.1269390
	speed: 0.0272s/iter; left time: 105.0883s
	iters: 700, epoch: 6 | loss: 0.1030411
	speed: 0.0272s/iter; left time: 102.3427s
	iters: 800, epoch: 6 | loss: 0.1270916
	speed: 0.0272s/iter; left time: 99.5455s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.47s
Steps: 893 | Train Loss: 0.1532911 Vali Loss: 0.2195591 Test Loss: 0.2325050
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.21626265347003937, rmse:0.4650404751300812, mae:0.29809749126434326, rse:0.42590153217315674
Original data scale mse:1452499.0, rmse:1205.1966552734375, mae:853.6145629882812, rse:0.08469200879335403
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3057511
	speed: 0.0292s/iter; left time: 258.0217s
	iters: 200, epoch: 1 | loss: 0.3766607
	speed: 0.0272s/iter; left time: 237.5128s
	iters: 300, epoch: 1 | loss: 0.1694278
	speed: 0.0272s/iter; left time: 234.8061s
	iters: 400, epoch: 1 | loss: 0.2313353
	speed: 0.0272s/iter; left time: 232.0450s
	iters: 500, epoch: 1 | loss: 0.2432228
	speed: 0.0272s/iter; left time: 229.4852s
	iters: 600, epoch: 1 | loss: 0.2211705
	speed: 0.0272s/iter; left time: 226.4947s
	iters: 700, epoch: 1 | loss: 0.1884585
	speed: 0.0272s/iter; left time: 223.5899s
	iters: 800, epoch: 1 | loss: 0.1608226
	speed: 0.0272s/iter; left time: 220.7569s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.52s
Steps: 893 | Train Loss: 0.2723556 Vali Loss: 0.2083244 Test Loss: 0.2288543
Validation loss decreased (inf --> 0.208324).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2157083
	speed: 0.1033s/iter; left time: 820.2446s
	iters: 200, epoch: 2 | loss: 0.2846986
	speed: 0.0271s/iter; left time: 212.7034s
	iters: 300, epoch: 2 | loss: 0.2502058
	speed: 0.0271s/iter; left time: 209.8424s
	iters: 400, epoch: 2 | loss: 0.1894063
	speed: 0.0271s/iter; left time: 207.2322s
	iters: 500, epoch: 2 | loss: 0.2280945
	speed: 0.0271s/iter; left time: 204.4967s
	iters: 600, epoch: 2 | loss: 0.1676389
	speed: 0.0271s/iter; left time: 201.7831s
	iters: 700, epoch: 2 | loss: 0.1686165
	speed: 0.0272s/iter; left time: 199.4822s
	iters: 800, epoch: 2 | loss: 0.2155954
	speed: 0.0273s/iter; left time: 197.6054s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.54s
Steps: 893 | Train Loss: 0.2131931 Vali Loss: 0.1983032 Test Loss: 0.2232880
Validation loss decreased (0.208324 --> 0.198303).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2333016
	speed: 0.1037s/iter; left time: 730.3471s
	iters: 200, epoch: 3 | loss: 0.1563112
	speed: 0.0272s/iter; left time: 188.8753s
	iters: 300, epoch: 3 | loss: 0.2018332
	speed: 0.0272s/iter; left time: 186.1883s
	iters: 400, epoch: 3 | loss: 0.1736123
	speed: 0.0272s/iter; left time: 183.4327s
	iters: 500, epoch: 3 | loss: 0.2209650
	speed: 0.0272s/iter; left time: 180.5244s
	iters: 600, epoch: 3 | loss: 0.1831442
	speed: 0.0271s/iter; left time: 177.4441s
	iters: 700, epoch: 3 | loss: 0.1832564
	speed: 0.0271s/iter; left time: 174.8251s
	iters: 800, epoch: 3 | loss: 0.1833694
	speed: 0.0272s/iter; left time: 172.4476s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.51s
Steps: 893 | Train Loss: 0.1875819 Vali Loss: 0.1993237 Test Loss: 0.2258587
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1364285
	speed: 0.1031s/iter; left time: 634.5720s
	iters: 200, epoch: 4 | loss: 0.1749617
	speed: 0.0273s/iter; left time: 165.3398s
	iters: 300, epoch: 4 | loss: 0.1866059
	speed: 0.0272s/iter; left time: 161.6806s
	iters: 400, epoch: 4 | loss: 0.1793955
	speed: 0.0271s/iter; left time: 158.7667s
	iters: 500, epoch: 4 | loss: 0.1895661
	speed: 0.0271s/iter; left time: 156.1079s
	iters: 600, epoch: 4 | loss: 0.2337200
	speed: 0.0271s/iter; left time: 153.3052s
	iters: 700, epoch: 4 | loss: 0.1283857
	speed: 0.0271s/iter; left time: 150.7204s
	iters: 800, epoch: 4 | loss: 0.1522544
	speed: 0.0272s/iter; left time: 148.0818s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.54s
Steps: 893 | Train Loss: 0.1758463 Vali Loss: 0.1958492 Test Loss: 0.2256963
Validation loss decreased (0.198303 --> 0.195849).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1313110
	speed: 0.1037s/iter; left time: 545.6094s
	iters: 200, epoch: 5 | loss: 0.1357504
	speed: 0.0271s/iter; left time: 140.0049s
	iters: 300, epoch: 5 | loss: 0.1926280
	speed: 0.0272s/iter; left time: 137.7075s
	iters: 400, epoch: 5 | loss: 0.1461151
	speed: 0.0272s/iter; left time: 134.9396s
	iters: 500, epoch: 5 | loss: 0.1402283
	speed: 0.0272s/iter; left time: 132.1745s
	iters: 600, epoch: 5 | loss: 0.1360821
	speed: 0.0272s/iter; left time: 129.4944s
	iters: 700, epoch: 5 | loss: 0.1236910
	speed: 0.0272s/iter; left time: 126.7332s
	iters: 800, epoch: 5 | loss: 0.1784343
	speed: 0.0272s/iter; left time: 123.9120s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.51s
Steps: 893 | Train Loss: 0.1659438 Vali Loss: 0.2187443 Test Loss: 0.2488500
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1426838
	speed: 0.1013s/iter; left time: 442.4550s
	iters: 200, epoch: 6 | loss: 0.1724035
	speed: 0.0272s/iter; left time: 116.1692s
	iters: 300, epoch: 6 | loss: 0.1549564
	speed: 0.0272s/iter; left time: 113.4812s
	iters: 400, epoch: 6 | loss: 0.1326089
	speed: 0.0273s/iter; left time: 110.8319s
	iters: 500, epoch: 6 | loss: 0.1519395
	speed: 0.0273s/iter; left time: 108.3886s
	iters: 600, epoch: 6 | loss: 0.1250428
	speed: 0.0273s/iter; left time: 105.6173s
	iters: 700, epoch: 6 | loss: 0.1527456
	speed: 0.0273s/iter; left time: 102.6310s
	iters: 800, epoch: 6 | loss: 0.1621509
	speed: 0.0273s/iter; left time: 99.9382s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.55s
Steps: 893 | Train Loss: 0.1500327 Vali Loss: 0.2242219 Test Loss: 0.2437714
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1677540
	speed: 0.1022s/iter; left time: 354.9270s
	iters: 200, epoch: 7 | loss: 0.1435072
	speed: 0.0273s/iter; left time: 92.2515s
	iters: 300, epoch: 7 | loss: 0.1411973
	speed: 0.0273s/iter; left time: 89.3073s
	iters: 400, epoch: 7 | loss: 0.1633041
	speed: 0.0272s/iter; left time: 86.2747s
	iters: 500, epoch: 7 | loss: 0.1872418
	speed: 0.0272s/iter; left time: 83.5609s
	iters: 600, epoch: 7 | loss: 0.1307618
	speed: 0.0272s/iter; left time: 80.7937s
	iters: 700, epoch: 7 | loss: 0.1255017
	speed: 0.0272s/iter; left time: 78.0292s
	iters: 800, epoch: 7 | loss: 0.1601506
	speed: 0.0272s/iter; left time: 75.3183s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.54s
Steps: 893 | Train Loss: 0.1343246 Vali Loss: 0.2221738 Test Loss: 0.2466845
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.22569629549980164, rmse:0.47507503628730774, mae:0.3016783595085144, rse:0.4350915849208832
Original data scale mse:1513613.875, rmse:1230.2901611328125, mae:866.8262939453125, rse:0.08645538985729218

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.21626265347003937, RMSE: 0.4650404751300812, MAE: 0.29809749126434326, RSE: 0.42590153217315674
Unscaled Metrics - MSE: 1452499.0, RMSE: 1205.1966552734375, MAE: 853.6145629882812, RSE: 0.08469200879335403

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.22569629549980164, RMSE: 0.47507503628730774, MAE: 0.3016783595085144, RSE: 0.4350915849208832
Unscaled Metrics - MSE: 1513613.875, RMSE: 1230.2901611328125, MAE: 866.8262939453125, RSE: 0.08645538985729218

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5269921
	speed: 0.0550s/iter; left time: 484.4798s
	iters: 200, epoch: 1 | loss: 0.4430048
	speed: 0.0276s/iter; left time: 240.2683s
	iters: 300, epoch: 1 | loss: 0.4705806
	speed: 0.0274s/iter; left time: 236.1269s
	iters: 400, epoch: 1 | loss: 0.3526207
	speed: 0.0274s/iter; left time: 233.4473s
	iters: 500, epoch: 1 | loss: 0.3564092
	speed: 0.0274s/iter; left time: 230.8080s
	iters: 600, epoch: 1 | loss: 0.3783470
	speed: 0.0278s/iter; left time: 231.1822s
	iters: 700, epoch: 1 | loss: 0.3289588
	speed: 0.0276s/iter; left time: 226.6636s
	iters: 800, epoch: 1 | loss: 0.2960959
	speed: 0.0276s/iter; left time: 223.9021s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.06s
Steps: 891 | Train Loss: 0.4058778 Vali Loss: 0.3439578 Test Loss: 0.3642919
Validation loss decreased (inf --> 0.343958).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4018326
	speed: 0.1056s/iter; left time: 836.1480s
	iters: 200, epoch: 2 | loss: 0.2365161
	speed: 0.0276s/iter; left time: 215.7050s
	iters: 300, epoch: 2 | loss: 0.3322780
	speed: 0.0275s/iter; left time: 212.5408s
	iters: 400, epoch: 2 | loss: 0.3504823
	speed: 0.0276s/iter; left time: 210.1294s
	iters: 500, epoch: 2 | loss: 0.2935279
	speed: 0.0276s/iter; left time: 207.5151s
	iters: 600, epoch: 2 | loss: 0.3237322
	speed: 0.0276s/iter; left time: 204.5100s
	iters: 700, epoch: 2 | loss: 0.3889388
	speed: 0.0276s/iter; left time: 201.8552s
	iters: 800, epoch: 2 | loss: 0.3492727
	speed: 0.0276s/iter; left time: 199.1390s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.85s
Steps: 891 | Train Loss: 0.3461054 Vali Loss: 0.3667676 Test Loss: 0.3928088
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3273766
	speed: 0.1038s/iter; left time: 729.8951s
	iters: 200, epoch: 3 | loss: 0.2906062
	speed: 0.0276s/iter; left time: 191.1948s
	iters: 300, epoch: 3 | loss: 0.2565724
	speed: 0.0276s/iter; left time: 188.3745s
	iters: 400, epoch: 3 | loss: 0.2998137
	speed: 0.0276s/iter; left time: 185.4693s
	iters: 500, epoch: 3 | loss: 0.2926842
	speed: 0.0275s/iter; left time: 182.6163s
	iters: 600, epoch: 3 | loss: 0.2503683
	speed: 0.0276s/iter; left time: 180.1321s
	iters: 700, epoch: 3 | loss: 0.2693202
	speed: 0.0276s/iter; left time: 177.3886s
	iters: 800, epoch: 3 | loss: 0.2316684
	speed: 0.0276s/iter; left time: 174.5246s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.87s
Steps: 891 | Train Loss: 0.2836274 Vali Loss: 0.4651813 Test Loss: 0.4757255
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2572417
	speed: 0.1029s/iter; left time: 631.5639s
	iters: 200, epoch: 4 | loss: 0.2740072
	speed: 0.0278s/iter; left time: 167.9596s
	iters: 300, epoch: 4 | loss: 0.2362313
	speed: 0.0278s/iter; left time: 165.1675s
	iters: 400, epoch: 4 | loss: 0.2240959
	speed: 0.0277s/iter; left time: 161.5101s
	iters: 500, epoch: 4 | loss: 0.2704002
	speed: 0.0277s/iter; left time: 158.8244s
	iters: 600, epoch: 4 | loss: 0.1861728
	speed: 0.0276s/iter; left time: 155.5169s
	iters: 700, epoch: 4 | loss: 0.2025268
	speed: 0.0276s/iter; left time: 152.6397s
	iters: 800, epoch: 4 | loss: 0.2089435
	speed: 0.0274s/iter; left time: 149.1472s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.83s
Steps: 891 | Train Loss: 0.2202944 Vali Loss: 0.4665594 Test Loss: 0.5207399
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.36429208517074585, rmse:0.6035661101341248, mae:0.39916014671325684, rse:0.5526279807090759
Original data scale mse:3107539.25, rmse:1762.8214111328125, mae:1208.146484375, rse:0.12405694276094437
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.4669119
	speed: 0.0305s/iter; left time: 268.7806s
	iters: 200, epoch: 1 | loss: 0.4411197
	speed: 0.0276s/iter; left time: 240.3445s
	iters: 300, epoch: 1 | loss: 0.3626571
	speed: 0.0276s/iter; left time: 237.7429s
	iters: 400, epoch: 1 | loss: 0.3450604
	speed: 0.0276s/iter; left time: 235.1635s
	iters: 500, epoch: 1 | loss: 0.3635704
	speed: 0.0276s/iter; left time: 232.3413s
	iters: 600, epoch: 1 | loss: 0.3686855
	speed: 0.0276s/iter; left time: 229.5892s
	iters: 700, epoch: 1 | loss: 0.3114695
	speed: 0.0276s/iter; left time: 226.7432s
	iters: 800, epoch: 1 | loss: 0.3882768
	speed: 0.0276s/iter; left time: 224.2010s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.94s
Steps: 891 | Train Loss: 0.4065910 Vali Loss: 0.3413068 Test Loss: 0.3614863
Validation loss decreased (inf --> 0.341307).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4536988
	speed: 0.1062s/iter; left time: 841.0605s
	iters: 200, epoch: 2 | loss: 0.3592976
	speed: 0.0276s/iter; left time: 215.6038s
	iters: 300, epoch: 2 | loss: 0.3085806
	speed: 0.0274s/iter; left time: 211.7937s
	iters: 400, epoch: 2 | loss: 0.4239842
	speed: 0.0274s/iter; left time: 208.7738s
	iters: 500, epoch: 2 | loss: 0.2659479
	speed: 0.0278s/iter; left time: 208.7359s
	iters: 600, epoch: 2 | loss: 0.3847721
	speed: 0.0279s/iter; left time: 206.7832s
	iters: 700, epoch: 2 | loss: 0.3171270
	speed: 0.0278s/iter; left time: 203.1451s
	iters: 800, epoch: 2 | loss: 0.3149118
	speed: 0.0278s/iter; left time: 200.7128s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.94s
Steps: 891 | Train Loss: 0.3498805 Vali Loss: 0.3451549 Test Loss: 0.3783731
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2774376
	speed: 0.1040s/iter; left time: 731.2834s
	iters: 200, epoch: 3 | loss: 0.2847988
	speed: 0.0278s/iter; left time: 192.7047s
	iters: 300, epoch: 3 | loss: 0.3040265
	speed: 0.0278s/iter; left time: 189.7006s
	iters: 400, epoch: 3 | loss: 0.2981822
	speed: 0.0276s/iter; left time: 185.8012s
	iters: 500, epoch: 3 | loss: 0.2673360
	speed: 0.0281s/iter; left time: 186.3997s
	iters: 600, epoch: 3 | loss: 0.3411404
	speed: 0.0282s/iter; left time: 183.8530s
	iters: 700, epoch: 3 | loss: 0.2696168
	speed: 0.0279s/iter; left time: 179.1124s
	iters: 800, epoch: 3 | loss: 0.2534254
	speed: 0.0276s/iter; left time: 174.5383s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.03s
Steps: 891 | Train Loss: 0.2931912 Vali Loss: 0.3913490 Test Loss: 0.4515366
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3399134
	speed: 0.1034s/iter; left time: 634.4564s
	iters: 200, epoch: 4 | loss: 0.2928011
	speed: 0.0276s/iter; left time: 166.3838s
	iters: 300, epoch: 4 | loss: 0.2476880
	speed: 0.0276s/iter; left time: 163.7366s
	iters: 400, epoch: 4 | loss: 0.2119861
	speed: 0.0276s/iter; left time: 161.3844s
	iters: 500, epoch: 4 | loss: 0.2496020
	speed: 0.0276s/iter; left time: 158.3876s
	iters: 600, epoch: 4 | loss: 0.2363061
	speed: 0.0276s/iter; left time: 155.3949s
	iters: 700, epoch: 4 | loss: 0.2201386
	speed: 0.0276s/iter; left time: 152.7302s
	iters: 800, epoch: 4 | loss: 0.2289553
	speed: 0.0276s/iter; left time: 149.9873s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.83s
Steps: 891 | Train Loss: 0.2369383 Vali Loss: 0.3876536 Test Loss: 0.4807457
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3614860475063324, rmse:0.6012371182441711, mae:0.3974400758743286, rse:0.5504955053329468
Original data scale mse:3066246.25, rmse:1751.070068359375, mae:1197.7283935546875, rse:0.12322995811700821

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.36429208517074585, RMSE: 0.6035661101341248, MAE: 0.39916014671325684, RSE: 0.5526279807090759
Unscaled Metrics - MSE: 3107539.25, RMSE: 1762.8214111328125, MAE: 1208.146484375, RSE: 0.12405694276094437

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.3614860475063324, RMSE: 0.6012371182441711, MAE: 0.3974400758743286, RSE: 0.5504955053329468
Unscaled Metrics - MSE: 3066246.25, RMSE: 1751.070068359375, MAE: 1197.7283935546875, RSE: 0.12322995811700821

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4769155
	speed: 0.0565s/iter; left time: 496.5367s
	iters: 200, epoch: 1 | loss: 0.3731868
	speed: 0.0282s/iter; left time: 244.9108s
	iters: 300, epoch: 1 | loss: 0.4026124
	speed: 0.0281s/iter; left time: 241.6042s
	iters: 400, epoch: 1 | loss: 0.5181973
	speed: 0.0281s/iter; left time: 238.2857s
	iters: 500, epoch: 1 | loss: 0.4882845
	speed: 0.0283s/iter; left time: 237.4980s
	iters: 600, epoch: 1 | loss: 0.4162966
	speed: 0.0282s/iter; left time: 234.2084s
	iters: 700, epoch: 1 | loss: 0.4295485
	speed: 0.0282s/iter; left time: 230.8365s
	iters: 800, epoch: 1 | loss: 0.3872631
	speed: 0.0282s/iter; left time: 228.3459s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.60s
Steps: 889 | Train Loss: 0.4332306 Vali Loss: 0.3750491 Test Loss: 0.3863738
Validation loss decreased (inf --> 0.375049).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4287454
	speed: 0.1090s/iter; left time: 861.1431s
	iters: 200, epoch: 2 | loss: 0.3523136
	speed: 0.0282s/iter; left time: 219.7598s
	iters: 300, epoch: 2 | loss: 0.4268894
	speed: 0.0283s/iter; left time: 217.7326s
	iters: 400, epoch: 2 | loss: 0.3694565
	speed: 0.0284s/iter; left time: 215.8891s
	iters: 500, epoch: 2 | loss: 0.3529244
	speed: 0.0284s/iter; left time: 212.7454s
	iters: 600, epoch: 2 | loss: 0.3845339
	speed: 0.0284s/iter; left time: 210.1491s
	iters: 700, epoch: 2 | loss: 0.3364713
	speed: 0.0286s/iter; left time: 209.1821s
	iters: 800, epoch: 2 | loss: 0.3727314
	speed: 0.0282s/iter; left time: 203.3051s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.44s
Steps: 889 | Train Loss: 0.3695354 Vali Loss: 0.3981650 Test Loss: 0.4239213
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2968167
	speed: 0.1056s/iter; left time: 740.4406s
	iters: 200, epoch: 3 | loss: 0.3074887
	speed: 0.0282s/iter; left time: 195.0284s
	iters: 300, epoch: 3 | loss: 0.3189294
	speed: 0.0281s/iter; left time: 191.6510s
	iters: 400, epoch: 3 | loss: 0.3007113
	speed: 0.0282s/iter; left time: 189.1803s
	iters: 500, epoch: 3 | loss: 0.2617878
	speed: 0.0282s/iter; left time: 186.2771s
	iters: 600, epoch: 3 | loss: 0.2618390
	speed: 0.0282s/iter; left time: 183.7656s
	iters: 700, epoch: 3 | loss: 0.2497126
	speed: 0.0282s/iter; left time: 180.8584s
	iters: 800, epoch: 3 | loss: 0.2865746
	speed: 0.0282s/iter; left time: 177.9001s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.31s
Steps: 889 | Train Loss: 0.2816691 Vali Loss: 0.4657136 Test Loss: 0.4966543
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2196847
	speed: 0.1054s/iter; left time: 645.5908s
	iters: 200, epoch: 4 | loss: 0.2207316
	speed: 0.0283s/iter; left time: 170.4949s
	iters: 300, epoch: 4 | loss: 0.2411210
	speed: 0.0283s/iter; left time: 167.5022s
	iters: 400, epoch: 4 | loss: 0.2022579
	speed: 0.0281s/iter; left time: 163.8365s
	iters: 500, epoch: 4 | loss: 0.1847117
	speed: 0.0281s/iter; left time: 160.5826s
	iters: 600, epoch: 4 | loss: 0.1999831
	speed: 0.0281s/iter; left time: 157.8157s
	iters: 700, epoch: 4 | loss: 0.2008164
	speed: 0.0281s/iter; left time: 154.9658s
	iters: 800, epoch: 4 | loss: 0.1936449
	speed: 0.0280s/iter; left time: 152.1230s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.28s
Steps: 889 | Train Loss: 0.2086127 Vali Loss: 0.4762350 Test Loss: 0.5384367
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.38637396693229675, rmse:0.6215898990631104, mae:0.41775429248809814, rse:0.5693001747131348
Original data scale mse:3617150.25, rmse:1901.8807373046875, mae:1296.1768798828125, rse:0.1339688003063202
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5005850
	speed: 0.0303s/iter; left time: 266.5746s
	iters: 200, epoch: 1 | loss: 0.5275720
	speed: 0.0280s/iter; left time: 243.3614s
	iters: 300, epoch: 1 | loss: 0.3961472
	speed: 0.0280s/iter; left time: 240.6943s
	iters: 400, epoch: 1 | loss: 0.4622277
	speed: 0.0280s/iter; left time: 237.6522s
	iters: 500, epoch: 1 | loss: 0.3886003
	speed: 0.0280s/iter; left time: 234.6089s
	iters: 600, epoch: 1 | loss: 0.3756400
	speed: 0.0284s/iter; left time: 235.5422s
	iters: 700, epoch: 1 | loss: 0.3411804
	speed: 0.0285s/iter; left time: 233.8007s
	iters: 800, epoch: 1 | loss: 0.3707665
	speed: 0.0282s/iter; left time: 227.7929s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.29s
Steps: 889 | Train Loss: 0.4343986 Vali Loss: 0.3737172 Test Loss: 0.3866062
Validation loss decreased (inf --> 0.373717).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4668116
	speed: 0.1087s/iter; left time: 859.1124s
	iters: 200, epoch: 2 | loss: 0.4182538
	speed: 0.0281s/iter; left time: 219.1715s
	iters: 300, epoch: 2 | loss: 0.4579510
	speed: 0.0280s/iter; left time: 215.6021s
	iters: 400, epoch: 2 | loss: 0.3012876
	speed: 0.0280s/iter; left time: 212.7470s
	iters: 500, epoch: 2 | loss: 0.3778625
	speed: 0.0281s/iter; left time: 211.0058s
	iters: 600, epoch: 2 | loss: 0.3702523
	speed: 0.0281s/iter; left time: 208.0809s
	iters: 700, epoch: 2 | loss: 0.3196153
	speed: 0.0281s/iter; left time: 205.3865s
	iters: 800, epoch: 2 | loss: 0.2943163
	speed: 0.0282s/iter; left time: 203.3734s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.25s
Steps: 889 | Train Loss: 0.3689520 Vali Loss: 0.3951502 Test Loss: 0.4582271
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2989108
	speed: 0.1062s/iter; left time: 744.9302s
	iters: 200, epoch: 3 | loss: 0.3104348
	speed: 0.0281s/iter; left time: 194.2123s
	iters: 300, epoch: 3 | loss: 0.2996868
	speed: 0.0281s/iter; left time: 191.2881s
	iters: 400, epoch: 3 | loss: 0.2827693
	speed: 0.0281s/iter; left time: 188.4507s
	iters: 500, epoch: 3 | loss: 0.2922589
	speed: 0.0281s/iter; left time: 185.7553s
	iters: 600, epoch: 3 | loss: 0.2895942
	speed: 0.0281s/iter; left time: 182.8578s
	iters: 700, epoch: 3 | loss: 0.2762637
	speed: 0.0281s/iter; left time: 180.1711s
	iters: 800, epoch: 3 | loss: 0.2557964
	speed: 0.0281s/iter; left time: 177.4582s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.23s
Steps: 889 | Train Loss: 0.2799410 Vali Loss: 0.4454358 Test Loss: 0.5095913
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2443987
	speed: 0.1049s/iter; left time: 642.4546s
	iters: 200, epoch: 4 | loss: 0.2261381
	speed: 0.0281s/iter; left time: 169.4522s
	iters: 300, epoch: 4 | loss: 0.2306883
	speed: 0.0281s/iter; left time: 166.5424s
	iters: 400, epoch: 4 | loss: 0.2140014
	speed: 0.0283s/iter; left time: 164.6419s
	iters: 500, epoch: 4 | loss: 0.2048028
	speed: 0.0285s/iter; left time: 163.1526s
	iters: 600, epoch: 4 | loss: 0.2299541
	speed: 0.0284s/iter; left time: 159.4707s
	iters: 700, epoch: 4 | loss: 0.1911043
	speed: 0.0286s/iter; left time: 157.7692s
	iters: 800, epoch: 4 | loss: 0.1704575
	speed: 0.0287s/iter; left time: 155.4848s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.50s
Steps: 889 | Train Loss: 0.2027502 Vali Loss: 0.4716992 Test Loss: 0.5424255
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.3866064250469208, rmse:0.621776819229126, mae:0.417871356010437, rse:0.5694714188575745
Original data scale mse:3511273.5, rmse:1873.8392333984375, mae:1283.415771484375, rse:0.13199356198310852

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.38637396693229675, RMSE: 0.6215898990631104, MAE: 0.41775429248809814, RSE: 0.5693001747131348
Unscaled Metrics - MSE: 3617150.25, RMSE: 1901.8807373046875, MAE: 1296.1768798828125, RSE: 0.1339688003063202

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.3866064250469208, RMSE: 0.621776819229126, MAE: 0.417871356010437, RSE: 0.5694714188575745
Unscaled Metrics - MSE: 3511273.5, RMSE: 1873.8392333984375, MAE: 1283.415771484375, RSE: 0.13199356198310852

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.6013967
	speed: 0.0539s/iter; left time: 476.1086s
	iters: 200, epoch: 1 | loss: 0.5205783
	speed: 0.0272s/iter; left time: 237.2165s
	iters: 300, epoch: 1 | loss: 0.5003030
	speed: 0.0271s/iter; left time: 234.3237s
	iters: 400, epoch: 1 | loss: 0.5089628
	speed: 0.0272s/iter; left time: 231.6753s
	iters: 500, epoch: 1 | loss: 0.5104517
	speed: 0.0271s/iter; left time: 228.8622s
	iters: 600, epoch: 1 | loss: 0.4885173
	speed: 0.0272s/iter; left time: 226.2714s
	iters: 700, epoch: 1 | loss: 0.4317326
	speed: 0.0273s/iter; left time: 225.0400s
	iters: 800, epoch: 1 | loss: 0.4124345
	speed: 0.0272s/iter; left time: 221.3934s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.77s
Steps: 893 | Train Loss: 0.5063845 Vali Loss: 0.2050318 Test Loss: 0.2275732
Validation loss decreased (inf --> 0.205032).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4779246
	speed: 0.1036s/iter; left time: 822.3472s
	iters: 200, epoch: 2 | loss: 0.4364364
	speed: 0.0273s/iter; left time: 213.8969s
	iters: 300, epoch: 2 | loss: 0.5687235
	speed: 0.0273s/iter; left time: 211.4726s
	iters: 400, epoch: 2 | loss: 0.4493312
	speed: 0.0273s/iter; left time: 208.3385s
	iters: 500, epoch: 2 | loss: 0.4299622
	speed: 0.0273s/iter; left time: 205.6278s
	iters: 600, epoch: 2 | loss: 0.3654965
	speed: 0.0273s/iter; left time: 203.1326s
	iters: 700, epoch: 2 | loss: 0.4399397
	speed: 0.0272s/iter; left time: 199.6134s
	iters: 800, epoch: 2 | loss: 0.4418285
	speed: 0.0272s/iter; left time: 196.6564s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.57s
Steps: 893 | Train Loss: 0.4631838 Vali Loss: 0.2170873 Test Loss: 0.2467448
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3936575
	speed: 0.1010s/iter; left time: 711.5070s
	iters: 200, epoch: 3 | loss: 0.4492846
	speed: 0.0271s/iter; left time: 188.5241s
	iters: 300, epoch: 3 | loss: 0.4062623
	speed: 0.0271s/iter; left time: 185.8029s
	iters: 400, epoch: 3 | loss: 0.4094024
	speed: 0.0272s/iter; left time: 183.1655s
	iters: 500, epoch: 3 | loss: 0.3679922
	speed: 0.0272s/iter; left time: 180.4329s
	iters: 600, epoch: 3 | loss: 0.4897153
	speed: 0.0272s/iter; left time: 177.8519s
	iters: 700, epoch: 3 | loss: 0.3901091
	speed: 0.0272s/iter; left time: 175.4050s
	iters: 800, epoch: 3 | loss: 0.4995311
	speed: 0.0273s/iter; left time: 173.0309s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.47s
Steps: 893 | Train Loss: 0.4355155 Vali Loss: 0.2020699 Test Loss: 0.2188240
Validation loss decreased (0.205032 --> 0.202070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4361203
	speed: 0.1040s/iter; left time: 639.9786s
	iters: 200, epoch: 4 | loss: 0.3982719
	speed: 0.0271s/iter; left time: 163.9056s
	iters: 300, epoch: 4 | loss: 0.4671853
	speed: 0.0271s/iter; left time: 161.3483s
	iters: 400, epoch: 4 | loss: 0.4052918
	speed: 0.0271s/iter; left time: 158.6100s
	iters: 500, epoch: 4 | loss: 0.3898463
	speed: 0.0271s/iter; left time: 155.9114s
	iters: 600, epoch: 4 | loss: 0.4218423
	speed: 0.0271s/iter; left time: 153.3366s
	iters: 700, epoch: 4 | loss: 0.4440588
	speed: 0.0271s/iter; left time: 150.4777s
	iters: 800, epoch: 4 | loss: 0.4461469
	speed: 0.0272s/iter; left time: 148.0313s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.46s
Steps: 893 | Train Loss: 0.4304227 Vali Loss: 0.2090230 Test Loss: 0.2290595
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4460913
	speed: 0.1009s/iter; left time: 530.7491s
	iters: 200, epoch: 5 | loss: 0.4150039
	speed: 0.0273s/iter; left time: 141.0291s
	iters: 300, epoch: 5 | loss: 0.4605816
	speed: 0.0272s/iter; left time: 137.4927s
	iters: 400, epoch: 5 | loss: 0.4961806
	speed: 0.0272s/iter; left time: 134.7557s
	iters: 500, epoch: 5 | loss: 0.3636013
	speed: 0.0271s/iter; left time: 131.8994s
	iters: 600, epoch: 5 | loss: 0.4122947
	speed: 0.0271s/iter; left time: 129.1623s
	iters: 700, epoch: 5 | loss: 0.3935414
	speed: 0.0272s/iter; left time: 126.5055s
	iters: 800, epoch: 5 | loss: 0.3457866
	speed: 0.0271s/iter; left time: 123.6560s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.47s
Steps: 893 | Train Loss: 0.4081111 Vali Loss: 0.2166937 Test Loss: 0.2344911
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4081523
	speed: 0.1025s/iter; left time: 447.6929s
	iters: 200, epoch: 6 | loss: 0.4218064
	speed: 0.0273s/iter; left time: 116.4641s
	iters: 300, epoch: 6 | loss: 0.3855322
	speed: 0.0273s/iter; left time: 113.6493s
	iters: 400, epoch: 6 | loss: 0.3756188
	speed: 0.0273s/iter; left time: 110.9089s
	iters: 500, epoch: 6 | loss: 0.3623589
	speed: 0.0272s/iter; left time: 107.7820s
	iters: 600, epoch: 6 | loss: 0.3822198
	speed: 0.0272s/iter; left time: 104.9628s
	iters: 700, epoch: 6 | loss: 0.3043307
	speed: 0.0272s/iter; left time: 102.3550s
	iters: 800, epoch: 6 | loss: 0.3572811
	speed: 0.0272s/iter; left time: 99.6148s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.3908278 Vali Loss: 0.2209009 Test Loss: 0.2346357
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2188238948583603, rmse:0.46778616309165955, mae:0.3056754171848297, rse:0.4284161329269409
Original data scale mse:1550383.25, rmse:1245.1439208984375, mae:886.2723999023438, rse:0.08749919384717941
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.5444213
	speed: 0.0303s/iter; left time: 267.7409s
	iters: 200, epoch: 1 | loss: 0.6009977
	speed: 0.0272s/iter; left time: 237.8872s
	iters: 300, epoch: 1 | loss: 0.4026956
	speed: 0.0273s/iter; left time: 235.2001s
	iters: 400, epoch: 1 | loss: 0.4701005
	speed: 0.0272s/iter; left time: 232.3480s
	iters: 500, epoch: 1 | loss: 0.4895530
	speed: 0.0272s/iter; left time: 229.5553s
	iters: 600, epoch: 1 | loss: 0.4619623
	speed: 0.0272s/iter; left time: 226.7724s
	iters: 700, epoch: 1 | loss: 0.4321673
	speed: 0.0273s/iter; left time: 224.4559s
	iters: 800, epoch: 1 | loss: 0.3974353
	speed: 0.0272s/iter; left time: 221.2111s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.68s
Steps: 893 | Train Loss: 0.5065211 Vali Loss: 0.2049187 Test Loss: 0.2255049
Validation loss decreased (inf --> 0.204919).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4632991
	speed: 0.1041s/iter; left time: 826.6065s
	iters: 200, epoch: 2 | loss: 0.5350261
	speed: 0.0272s/iter; left time: 213.4792s
	iters: 300, epoch: 2 | loss: 0.5018640
	speed: 0.0272s/iter; left time: 210.7746s
	iters: 400, epoch: 2 | loss: 0.4453875
	speed: 0.0275s/iter; left time: 210.2828s
	iters: 500, epoch: 2 | loss: 0.4813590
	speed: 0.0272s/iter; left time: 204.9118s
	iters: 600, epoch: 2 | loss: 0.4219689
	speed: 0.0272s/iter; left time: 202.2385s
	iters: 700, epoch: 2 | loss: 0.4213796
	speed: 0.0272s/iter; left time: 199.4635s
	iters: 800, epoch: 2 | loss: 0.4689682
	speed: 0.0272s/iter; left time: 196.8306s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.59s
Steps: 893 | Train Loss: 0.4621659 Vali Loss: 0.2013766 Test Loss: 0.2260190
Validation loss decreased (0.204919 --> 0.201377).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4864102
	speed: 0.1037s/iter; left time: 730.6086s
	iters: 200, epoch: 3 | loss: 0.4186493
	speed: 0.0272s/iter; left time: 188.7003s
	iters: 300, epoch: 3 | loss: 0.4470059
	speed: 0.0274s/iter; left time: 187.6179s
	iters: 400, epoch: 3 | loss: 0.4122368
	speed: 0.0272s/iter; left time: 183.2098s
	iters: 500, epoch: 3 | loss: 0.4615060
	speed: 0.0272s/iter; left time: 180.5503s
	iters: 600, epoch: 3 | loss: 0.4317300
	speed: 0.0272s/iter; left time: 177.8225s
	iters: 700, epoch: 3 | loss: 0.4248719
	speed: 0.0272s/iter; left time: 175.2282s
	iters: 800, epoch: 3 | loss: 0.4373144
	speed: 0.0271s/iter; left time: 172.2523s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.53s
Steps: 893 | Train Loss: 0.4328221 Vali Loss: 0.1995491 Test Loss: 0.2228109
Validation loss decreased (0.201377 --> 0.199549).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3740870
	speed: 0.1049s/iter; left time: 645.1239s
	iters: 200, epoch: 4 | loss: 0.4252093
	speed: 0.0272s/iter; left time: 164.6992s
	iters: 300, epoch: 4 | loss: 0.4209940
	speed: 0.0272s/iter; left time: 161.9143s
	iters: 400, epoch: 4 | loss: 0.4173118
	speed: 0.0273s/iter; left time: 159.5905s
	iters: 500, epoch: 4 | loss: 0.4368830
	speed: 0.0273s/iter; left time: 156.9270s
	iters: 600, epoch: 4 | loss: 0.4859622
	speed: 0.0273s/iter; left time: 154.3574s
	iters: 700, epoch: 4 | loss: 0.3627327
	speed: 0.0273s/iter; left time: 151.4832s
	iters: 800, epoch: 4 | loss: 0.4003553
	speed: 0.0273s/iter; left time: 148.6815s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.67s
Steps: 893 | Train Loss: 0.4234424 Vali Loss: 0.1963134 Test Loss: 0.2227803
Validation loss decreased (0.199549 --> 0.196313).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3753532
	speed: 0.1042s/iter; left time: 548.0372s
	iters: 200, epoch: 5 | loss: 0.3731111
	speed: 0.0272s/iter; left time: 140.5150s
	iters: 300, epoch: 5 | loss: 0.4691473
	speed: 0.0273s/iter; left time: 137.9954s
	iters: 400, epoch: 5 | loss: 0.3787996
	speed: 0.0273s/iter; left time: 135.3187s
	iters: 500, epoch: 5 | loss: 0.3906888
	speed: 0.0273s/iter; left time: 132.4405s
	iters: 600, epoch: 5 | loss: 0.3738882
	speed: 0.0272s/iter; left time: 129.6475s
	iters: 700, epoch: 5 | loss: 0.3521083
	speed: 0.0272s/iter; left time: 126.6278s
	iters: 800, epoch: 5 | loss: 0.4147491
	speed: 0.0272s/iter; left time: 124.1884s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.4087857 Vali Loss: 0.2155775 Test Loss: 0.2355453
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3788167
	speed: 0.1015s/iter; left time: 443.2746s
	iters: 200, epoch: 6 | loss: 0.4167462
	speed: 0.0272s/iter; left time: 116.1866s
	iters: 300, epoch: 6 | loss: 0.3896540
	speed: 0.0272s/iter; left time: 113.3145s
	iters: 400, epoch: 6 | loss: 0.3992472
	speed: 0.0272s/iter; left time: 110.5538s
	iters: 500, epoch: 6 | loss: 0.3757845
	speed: 0.0272s/iter; left time: 107.8738s
	iters: 600, epoch: 6 | loss: 0.3588927
	speed: 0.0272s/iter; left time: 105.1934s
	iters: 700, epoch: 6 | loss: 0.3925796
	speed: 0.0272s/iter; left time: 102.4955s
	iters: 800, epoch: 6 | loss: 0.3853908
	speed: 0.0272s/iter; left time: 99.8431s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.50s
Steps: 893 | Train Loss: 0.3884232 Vali Loss: 0.2193920 Test Loss: 0.2429107
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4092107
	speed: 0.1023s/iter; left time: 355.4607s
	iters: 200, epoch: 7 | loss: 0.3485813
	speed: 0.0274s/iter; left time: 92.4630s
	iters: 300, epoch: 7 | loss: 0.3633334
	speed: 0.0273s/iter; left time: 89.3699s
	iters: 400, epoch: 7 | loss: 0.4105852
	speed: 0.0273s/iter; left time: 86.5110s
	iters: 500, epoch: 7 | loss: 0.4533424
	speed: 0.0274s/iter; left time: 84.2151s
	iters: 600, epoch: 7 | loss: 0.3510210
	speed: 0.0272s/iter; left time: 80.8822s
	iters: 700, epoch: 7 | loss: 0.3403434
	speed: 0.0272s/iter; left time: 78.1663s
	iters: 800, epoch: 7 | loss: 0.4050323
	speed: 0.0272s/iter; left time: 75.4752s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.60s
Steps: 893 | Train Loss: 0.3636644 Vali Loss: 0.2209337 Test Loss: 0.2397166
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.22278033196926117, rmse:0.47199612855911255, mae:0.296539843082428, rse:0.4322717487812042
Original data scale mse:1480387.625, rmse:1216.7117919921875, mae:848.03173828125, rse:0.08550120890140533

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2188238948583603, RMSE: 0.46778616309165955, MAE: 0.3056754171848297, RSE: 0.4284161329269409
Unscaled Metrics - MSE: 1550383.25, RMSE: 1245.1439208984375, MAE: 886.2723999023438, RSE: 0.08749919384717941

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.22278033196926117, RMSE: 0.47199612855911255, MAE: 0.296539843082428, RSE: 0.4322717487812042
Unscaled Metrics - MSE: 1480387.625, RMSE: 1216.7117919921875, MAE: 848.03173828125, RSE: 0.08550120890140533

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7208821
	speed: 0.0549s/iter; left time: 483.3089s
	iters: 200, epoch: 1 | loss: 0.6609174
	speed: 0.0276s/iter; left time: 240.2400s
	iters: 300, epoch: 1 | loss: 0.6829153
	speed: 0.0275s/iter; left time: 236.9295s
	iters: 400, epoch: 1 | loss: 0.5907691
	speed: 0.0275s/iter; left time: 234.0920s
	iters: 500, epoch: 1 | loss: 0.5937178
	speed: 0.0274s/iter; left time: 230.4839s
	iters: 600, epoch: 1 | loss: 0.6095825
	speed: 0.0273s/iter; left time: 227.0033s
	iters: 700, epoch: 1 | loss: 0.5706614
	speed: 0.0273s/iter; left time: 224.0630s
	iters: 800, epoch: 1 | loss: 0.5402766
	speed: 0.0273s/iter; left time: 221.3723s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.92s
Steps: 891 | Train Loss: 0.6302069 Vali Loss: 0.3424637 Test Loss: 0.3632891
Validation loss decreased (inf --> 0.342464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6352274
	speed: 0.1057s/iter; left time: 836.8328s
	iters: 200, epoch: 2 | loss: 0.4938740
	speed: 0.0276s/iter; left time: 215.5378s
	iters: 300, epoch: 2 | loss: 0.5808967
	speed: 0.0275s/iter; left time: 212.4274s
	iters: 400, epoch: 2 | loss: 0.5924057
	speed: 0.0275s/iter; left time: 209.5342s
	iters: 500, epoch: 2 | loss: 0.5385586
	speed: 0.0273s/iter; left time: 205.3280s
	iters: 600, epoch: 2 | loss: 0.5716851
	speed: 0.0275s/iter; left time: 204.0642s
	iters: 700, epoch: 2 | loss: 0.6173254
	speed: 0.0274s/iter; left time: 200.7844s
	iters: 800, epoch: 2 | loss: 0.5928860
	speed: 0.0276s/iter; left time: 199.0969s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.78s
Steps: 891 | Train Loss: 0.5899783 Vali Loss: 0.3775397 Test Loss: 0.3987587
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5721514
	speed: 0.1010s/iter; left time: 710.0983s
	iters: 200, epoch: 3 | loss: 0.5509554
	speed: 0.0275s/iter; left time: 190.5876s
	iters: 300, epoch: 3 | loss: 0.5126132
	speed: 0.0276s/iter; left time: 188.3726s
	iters: 400, epoch: 3 | loss: 0.5703170
	speed: 0.0276s/iter; left time: 185.5621s
	iters: 500, epoch: 3 | loss: 0.5580385
	speed: 0.0276s/iter; left time: 182.8923s
	iters: 600, epoch: 3 | loss: 0.4987105
	speed: 0.0275s/iter; left time: 179.6174s
	iters: 700, epoch: 3 | loss: 0.5137191
	speed: 0.0275s/iter; left time: 176.5800s
	iters: 800, epoch: 3 | loss: 0.4870943
	speed: 0.0274s/iter; left time: 173.6832s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.70s
Steps: 891 | Train Loss: 0.5341660 Vali Loss: 0.4180090 Test Loss: 0.4813174
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5014291
	speed: 0.1014s/iter; left time: 622.2271s
	iters: 200, epoch: 4 | loss: 0.5364285
	speed: 0.0278s/iter; left time: 167.5695s
	iters: 300, epoch: 4 | loss: 0.5021194
	speed: 0.0278s/iter; left time: 165.0553s
	iters: 400, epoch: 4 | loss: 0.4731693
	speed: 0.0278s/iter; left time: 162.2255s
	iters: 500, epoch: 4 | loss: 0.5249455
	speed: 0.0278s/iter; left time: 159.4250s
	iters: 600, epoch: 4 | loss: 0.4130467
	speed: 0.0277s/iter; left time: 156.4520s
	iters: 700, epoch: 4 | loss: 0.4548444
	speed: 0.0277s/iter; left time: 153.6423s
	iters: 800, epoch: 4 | loss: 0.4567111
	speed: 0.0277s/iter; left time: 150.6329s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.94s
Steps: 891 | Train Loss: 0.4669559 Vali Loss: 0.4383838 Test Loss: 0.5462883
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.36328914761543274, rmse:0.6027347445487976, mae:0.3974633812904358, rse:0.5518667697906494
Original data scale mse:3056700.25, rmse:1748.3421630859375, mae:1198.005615234375, rse:0.12303797900676727
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6765779
	speed: 0.0296s/iter; left time: 260.3867s
	iters: 200, epoch: 1 | loss: 0.6603055
	speed: 0.0276s/iter; left time: 240.5186s
	iters: 300, epoch: 1 | loss: 0.5982847
	speed: 0.0276s/iter; left time: 237.4581s
	iters: 400, epoch: 1 | loss: 0.5823344
	speed: 0.0275s/iter; left time: 234.2681s
	iters: 500, epoch: 1 | loss: 0.5942928
	speed: 0.0275s/iter; left time: 231.3422s
	iters: 600, epoch: 1 | loss: 0.6032392
	speed: 0.0275s/iter; left time: 228.7689s
	iters: 700, epoch: 1 | loss: 0.5559143
	speed: 0.0275s/iter; left time: 225.7735s
	iters: 800, epoch: 1 | loss: 0.6188536
	speed: 0.0274s/iter; left time: 222.1421s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.76s
Steps: 891 | Train Loss: 0.6300424 Vali Loss: 0.3397463 Test Loss: 0.3602683
Validation loss decreased (inf --> 0.339746).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6776056
	speed: 0.1048s/iter; left time: 829.8665s
	iters: 200, epoch: 2 | loss: 0.6050072
	speed: 0.0275s/iter; left time: 215.2721s
	iters: 300, epoch: 2 | loss: 0.5580308
	speed: 0.0275s/iter; left time: 212.6457s
	iters: 400, epoch: 2 | loss: 0.6543216
	speed: 0.0275s/iter; left time: 209.7077s
	iters: 500, epoch: 2 | loss: 0.5166084
	speed: 0.0276s/iter; left time: 207.8366s
	iters: 600, epoch: 2 | loss: 0.6206093
	speed: 0.0276s/iter; left time: 204.9596s
	iters: 700, epoch: 2 | loss: 0.5579513
	speed: 0.0275s/iter; left time: 201.3876s
	iters: 800, epoch: 2 | loss: 0.5569283
	speed: 0.0276s/iter; left time: 198.9533s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.81s
Steps: 891 | Train Loss: 0.5907024 Vali Loss: 0.3437263 Test Loss: 0.3724694
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5290252
	speed: 0.1045s/iter; left time: 734.7523s
	iters: 200, epoch: 3 | loss: 0.5278088
	speed: 0.0275s/iter; left time: 190.3573s
	iters: 300, epoch: 3 | loss: 0.5455511
	speed: 0.0274s/iter; left time: 187.3721s
	iters: 400, epoch: 3 | loss: 0.5481491
	speed: 0.0275s/iter; left time: 184.8768s
	iters: 500, epoch: 3 | loss: 0.5107419
	speed: 0.0276s/iter; left time: 182.7737s
	iters: 600, epoch: 3 | loss: 0.5909939
	speed: 0.0276s/iter; left time: 180.4060s
	iters: 700, epoch: 3 | loss: 0.5415440
	speed: 0.0276s/iter; left time: 177.6053s
	iters: 800, epoch: 3 | loss: 0.5035570
	speed: 0.0273s/iter; left time: 172.8316s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.84s
Steps: 891 | Train Loss: 0.5446765 Vali Loss: 0.3687639 Test Loss: 0.4264843
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5847052
	speed: 0.1017s/iter; left time: 624.4997s
	iters: 200, epoch: 4 | loss: 0.5530033
	speed: 0.0275s/iter; left time: 165.7885s
	iters: 300, epoch: 4 | loss: 0.4961517
	speed: 0.0275s/iter; left time: 163.3539s
	iters: 400, epoch: 4 | loss: 0.4756521
	speed: 0.0275s/iter; left time: 160.3910s
	iters: 500, epoch: 4 | loss: 0.5069587
	speed: 0.0275s/iter; left time: 158.0301s
	iters: 600, epoch: 4 | loss: 0.4963061
	speed: 0.0277s/iter; left time: 155.9315s
	iters: 700, epoch: 4 | loss: 0.4607827
	speed: 0.0275s/iter; left time: 152.4298s
	iters: 800, epoch: 4 | loss: 0.4664532
	speed: 0.0275s/iter; left time: 149.6904s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.72s
Steps: 891 | Train Loss: 0.4908367 Vali Loss: 0.3892277 Test Loss: 0.4640316
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.36026856303215027, rmse:0.6002237796783447, mae:0.39556941390037537, rse:0.549567699432373
Original data scale mse:3011115.0, rmse:1735.2564697265625, mae:1186.3692626953125, rse:0.12211708724498749

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.36328914761543274, RMSE: 0.6027347445487976, MAE: 0.3974633812904358, RSE: 0.5518667697906494
Unscaled Metrics - MSE: 3056700.25, RMSE: 1748.3421630859375, MAE: 1198.005615234375, RSE: 0.12303797900676727

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.36026856303215027, RMSE: 0.6002237796783447, MAE: 0.39556941390037537, RSE: 0.549567699432373
Unscaled Metrics - MSE: 3011115.0, RMSE: 1735.2564697265625, MAE: 1186.3692626953125, RSE: 0.12211708724498749

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.6868879
	speed: 0.0540s/iter; left time: 474.6310s
	iters: 200, epoch: 1 | loss: 0.6082063
	speed: 0.0282s/iter; left time: 245.0586s
	iters: 300, epoch: 1 | loss: 0.6320158
	speed: 0.0281s/iter; left time: 241.0930s
	iters: 400, epoch: 1 | loss: 0.7154368
	speed: 0.0281s/iter; left time: 238.6409s
	iters: 500, epoch: 1 | loss: 0.6939788
	speed: 0.0280s/iter; left time: 235.1256s
	iters: 600, epoch: 1 | loss: 0.6417535
	speed: 0.0281s/iter; left time: 232.6483s
	iters: 700, epoch: 1 | loss: 0.6524583
	speed: 0.0280s/iter; left time: 229.6292s
	iters: 800, epoch: 1 | loss: 0.6207916
	speed: 0.0281s/iter; left time: 227.1080s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.45s
Steps: 889 | Train Loss: 0.6519346 Vali Loss: 0.3736502 Test Loss: 0.3849083
Validation loss decreased (inf --> 0.373650).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6524412
	speed: 0.1056s/iter; left time: 834.2498s
	iters: 200, epoch: 2 | loss: 0.5924922
	speed: 0.0283s/iter; left time: 220.4228s
	iters: 300, epoch: 2 | loss: 0.6570303
	speed: 0.0281s/iter; left time: 216.8055s
	iters: 400, epoch: 2 | loss: 0.6069839
	speed: 0.0282s/iter; left time: 214.5653s
	iters: 500, epoch: 2 | loss: 0.5969630
	speed: 0.0282s/iter; left time: 211.2057s
	iters: 600, epoch: 2 | loss: 0.6170304
	speed: 0.0281s/iter; left time: 208.2093s
	iters: 700, epoch: 2 | loss: 0.5799345
	speed: 0.0282s/iter; left time: 206.0509s
	iters: 800, epoch: 2 | loss: 0.6086529
	speed: 0.0282s/iter; left time: 202.8323s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.28s
Steps: 889 | Train Loss: 0.6074108 Vali Loss: 0.3982124 Test Loss: 0.4384148
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5499582
	speed: 0.1050s/iter; left time: 736.6011s
	iters: 200, epoch: 3 | loss: 0.5662563
	speed: 0.0281s/iter; left time: 193.9282s
	iters: 300, epoch: 3 | loss: 0.5721222
	speed: 0.0281s/iter; left time: 191.1539s
	iters: 400, epoch: 3 | loss: 0.5577896
	speed: 0.0282s/iter; left time: 189.1205s
	iters: 500, epoch: 3 | loss: 0.4842646
	speed: 0.0281s/iter; left time: 185.9158s
	iters: 600, epoch: 3 | loss: 0.5165036
	speed: 0.0281s/iter; left time: 183.0764s
	iters: 700, epoch: 3 | loss: 0.5020054
	speed: 0.0282s/iter; left time: 181.0977s
	iters: 800, epoch: 3 | loss: 0.5366038
	speed: 0.0282s/iter; left time: 177.8977s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.23s
Steps: 889 | Train Loss: 0.5327646 Vali Loss: 0.4396427 Test Loss: 0.4794930
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4764272
	speed: 0.1049s/iter; left time: 642.3430s
	iters: 200, epoch: 4 | loss: 0.4589262
	speed: 0.0282s/iter; left time: 169.6284s
	iters: 300, epoch: 4 | loss: 0.4915803
	speed: 0.0280s/iter; left time: 166.1172s
	iters: 400, epoch: 4 | loss: 0.4568203
	speed: 0.0280s/iter; left time: 163.3348s
	iters: 500, epoch: 4 | loss: 0.4134367
	speed: 0.0281s/iter; left time: 160.8550s
	iters: 600, epoch: 4 | loss: 0.4231523
	speed: 0.0281s/iter; left time: 158.3113s
	iters: 700, epoch: 4 | loss: 0.4628023
	speed: 0.0283s/iter; left time: 156.2836s
	iters: 800, epoch: 4 | loss: 0.4566928
	speed: 0.0282s/iter; left time: 153.1404s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.33s
Steps: 889 | Train Loss: 0.4580494 Vali Loss: 0.4871185 Test Loss: 0.5130420
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.38490840792655945, rmse:0.6204098463058472, mae:0.41569945216178894, rse:0.5682194232940674
Original data scale mse:3557823.25, rmse:1886.2193603515625, mae:1284.5880126953125, rse:0.13286560773849487
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7033080
	speed: 0.0304s/iter; left time: 266.9511s
	iters: 200, epoch: 1 | loss: 0.7224817
	speed: 0.0282s/iter; left time: 245.3140s
	iters: 300, epoch: 1 | loss: 0.6254590
	speed: 0.0282s/iter; left time: 242.3698s
	iters: 400, epoch: 1 | loss: 0.6764609
	speed: 0.0281s/iter; left time: 238.8627s
	iters: 500, epoch: 1 | loss: 0.6194031
	speed: 0.0281s/iter; left time: 235.6923s
	iters: 600, epoch: 1 | loss: 0.6091042
	speed: 0.0281s/iter; left time: 232.8378s
	iters: 700, epoch: 1 | loss: 0.5800869
	speed: 0.0282s/iter; left time: 230.6796s
	iters: 800, epoch: 1 | loss: 0.6073012
	speed: 0.0281s/iter; left time: 227.3237s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.30s
Steps: 889 | Train Loss: 0.6528101 Vali Loss: 0.3721938 Test Loss: 0.3846243
Validation loss decreased (inf --> 0.372194).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6874964
	speed: 0.1082s/iter; left time: 854.7374s
	iters: 200, epoch: 2 | loss: 0.6492323
	speed: 0.0280s/iter; left time: 218.5348s
	iters: 300, epoch: 2 | loss: 0.6785272
	speed: 0.0280s/iter; left time: 215.8748s
	iters: 400, epoch: 2 | loss: 0.5470212
	speed: 0.0281s/iter; left time: 213.7360s
	iters: 500, epoch: 2 | loss: 0.6077131
	speed: 0.0280s/iter; left time: 210.2461s
	iters: 600, epoch: 2 | loss: 0.6100425
	speed: 0.0281s/iter; left time: 207.6576s
	iters: 700, epoch: 2 | loss: 0.5672733
	speed: 0.0282s/iter; left time: 205.7792s
	iters: 800, epoch: 2 | loss: 0.5391125
	speed: 0.0280s/iter; left time: 201.8219s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.17s
Steps: 889 | Train Loss: 0.6083806 Vali Loss: 0.3980633 Test Loss: 0.4491718
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5492510
	speed: 0.1043s/iter; left time: 731.6119s
	iters: 200, epoch: 3 | loss: 0.5626449
	speed: 0.0283s/iter; left time: 195.5498s
	iters: 300, epoch: 3 | loss: 0.5619338
	speed: 0.0282s/iter; left time: 191.9375s
	iters: 400, epoch: 3 | loss: 0.5451636
	speed: 0.0281s/iter; left time: 188.5133s
	iters: 500, epoch: 3 | loss: 0.5382028
	speed: 0.0281s/iter; left time: 185.5281s
	iters: 600, epoch: 3 | loss: 0.5589658
	speed: 0.0281s/iter; left time: 182.7095s
	iters: 700, epoch: 3 | loss: 0.5221357
	speed: 0.0281s/iter; left time: 179.8880s
	iters: 800, epoch: 3 | loss: 0.5027313
	speed: 0.0280s/iter; left time: 177.0490s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.23s
Steps: 889 | Train Loss: 0.5309688 Vali Loss: 0.4570640 Test Loss: 0.4775769
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5000302
	speed: 0.1041s/iter; left time: 637.4518s
	iters: 200, epoch: 4 | loss: 0.4898553
	speed: 0.0281s/iter; left time: 169.4133s
	iters: 300, epoch: 4 | loss: 0.4538411
	speed: 0.0281s/iter; left time: 166.2888s
	iters: 400, epoch: 4 | loss: 0.4693536
	speed: 0.0281s/iter; left time: 163.4935s
	iters: 500, epoch: 4 | loss: 0.4536646
	speed: 0.0281s/iter; left time: 160.5959s
	iters: 600, epoch: 4 | loss: 0.4722016
	speed: 0.0280s/iter; left time: 157.4740s
	iters: 700, epoch: 4 | loss: 0.4489239
	speed: 0.0281s/iter; left time: 155.1306s
	iters: 800, epoch: 4 | loss: 0.4133125
	speed: 0.0281s/iter; left time: 152.5920s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.18s
Steps: 889 | Train Loss: 0.4539766 Vali Loss: 0.4806791 Test Loss: 0.5313826
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.38462451100349426, rmse:0.6201810240745544, mae:0.4157201945781708, rse:0.5680098533630371
Original data scale mse:3453479.0, rmse:1858.3538818359375, mae:1271.8232421875, rse:0.13090276718139648

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.38490840792655945, RMSE: 0.6204098463058472, MAE: 0.41569945216178894, RSE: 0.5682194232940674
Unscaled Metrics - MSE: 3557823.25, RMSE: 1886.2193603515625, MAE: 1284.5880126953125, RSE: 0.13286560773849487

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.38462451100349426, RMSE: 0.6201810240745544, MAE: 0.4157201945781708, RSE: 0.5680098533630371
Unscaled Metrics - MSE: 3453479.0, RMSE: 1858.3538818359375, MAE: 1271.8232421875, RSE: 0.13090276718139648

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_24_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4197298
	speed: 0.0555s/iter; left time: 489.9425s
	iters: 200, epoch: 1 | loss: 0.3719425
	speed: 0.0272s/iter; left time: 237.2516s
	iters: 300, epoch: 1 | loss: 0.3549241
	speed: 0.0273s/iter; left time: 235.4815s
	iters: 400, epoch: 1 | loss: 0.3420426
	speed: 0.0272s/iter; left time: 232.0957s
	iters: 500, epoch: 1 | loss: 0.3428261
	speed: 0.0272s/iter; left time: 229.1959s
	iters: 600, epoch: 1 | loss: 0.3204548
	speed: 0.0272s/iter; left time: 226.2742s
	iters: 700, epoch: 1 | loss: 0.2980059
	speed: 0.0271s/iter; left time: 223.3191s
	iters: 800, epoch: 1 | loss: 0.2765057
	speed: 0.0271s/iter; left time: 220.6697s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.78s
Steps: 893 | Train Loss: 0.3523570 Vali Loss: 0.2899220 Test Loss: 0.3008270
Validation loss decreased (inf --> 0.289922).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3425682
	speed: 0.1042s/iter; left time: 827.0674s
	iters: 200, epoch: 2 | loss: 0.3123498
	speed: 0.0274s/iter; left time: 214.6194s
	iters: 300, epoch: 2 | loss: 0.4055543
	speed: 0.0274s/iter; left time: 212.2695s
	iters: 400, epoch: 2 | loss: 0.3156208
	speed: 0.0274s/iter; left time: 209.3876s
	iters: 500, epoch: 2 | loss: 0.3267983
	speed: 0.0274s/iter; left time: 206.6785s
	iters: 600, epoch: 2 | loss: 0.2764085
	speed: 0.0274s/iter; left time: 203.7539s
	iters: 700, epoch: 2 | loss: 0.3015693
	speed: 0.0274s/iter; left time: 200.9684s
	iters: 800, epoch: 2 | loss: 0.3063100
	speed: 0.0273s/iter; left time: 197.8756s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.68s
Steps: 893 | Train Loss: 0.3265962 Vali Loss: 0.3364859 Test Loss: 0.3096833
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2943792
	speed: 0.1017s/iter; left time: 716.4226s
	iters: 200, epoch: 3 | loss: 0.2800589
	speed: 0.0272s/iter; left time: 188.7165s
	iters: 300, epoch: 3 | loss: 0.2842633
	speed: 0.0271s/iter; left time: 185.7734s
	iters: 400, epoch: 3 | loss: 0.2960793
	speed: 0.0271s/iter; left time: 183.1100s
	iters: 500, epoch: 3 | loss: 0.2664571
	speed: 0.0272s/iter; left time: 180.5344s
	iters: 600, epoch: 3 | loss: 0.3084440
	speed: 0.0272s/iter; left time: 177.7398s
	iters: 700, epoch: 3 | loss: 0.2555942
	speed: 0.0272s/iter; left time: 174.9901s
	iters: 800, epoch: 3 | loss: 0.3035484
	speed: 0.0271s/iter; left time: 172.2133s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.51s
Steps: 893 | Train Loss: 0.2983019 Vali Loss: 0.3194009 Test Loss: 0.2943364
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3005413
	speed: 0.1031s/iter; left time: 634.1016s
	iters: 200, epoch: 4 | loss: 0.2660448
	speed: 0.0274s/iter; left time: 165.7172s
	iters: 300, epoch: 4 | loss: 0.2842539
	speed: 0.0276s/iter; left time: 164.0341s
	iters: 400, epoch: 4 | loss: 0.2401366
	speed: 0.0274s/iter; left time: 160.0962s
	iters: 500, epoch: 4 | loss: 0.2548580
	speed: 0.0271s/iter; left time: 156.0725s
	iters: 600, epoch: 4 | loss: 0.2438653
	speed: 0.0271s/iter; left time: 153.2598s
	iters: 700, epoch: 4 | loss: 0.2796047
	speed: 0.0271s/iter; left time: 150.5718s
	iters: 800, epoch: 4 | loss: 0.2764925
	speed: 0.0272s/iter; left time: 148.3303s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.2778553 Vali Loss: 0.3184720 Test Loss: 0.2888238
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.23465076088905334, rmse:0.4844076335430145, mae:0.3008269965648651, rse:0.4436386823654175
Original data scale mse:1737740.625, rmse:1318.23388671875, mae:870.5348510742188, rse:0.09263540804386139
Use GPU: cuda:0
>>>>>>>start training : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28601
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4371723
	speed: 0.0291s/iter; left time: 256.7493s
	iters: 200, epoch: 1 | loss: 0.3609392
	speed: 0.0271s/iter; left time: 236.7669s
	iters: 300, epoch: 1 | loss: 0.3956319
	speed: 0.0274s/iter; left time: 236.8411s
	iters: 400, epoch: 1 | loss: 0.3346788
	speed: 0.0274s/iter; left time: 233.9696s
	iters: 500, epoch: 1 | loss: 0.3077095
	speed: 0.0274s/iter; left time: 231.3430s
	iters: 600, epoch: 1 | loss: 0.3153960
	speed: 0.0272s/iter; left time: 226.4703s
	iters: 700, epoch: 1 | loss: 0.3018442
	speed: 0.0271s/iter; left time: 222.8223s
	iters: 800, epoch: 1 | loss: 0.3021125
	speed: 0.0274s/iter; left time: 222.3889s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.61s
Steps: 893 | Train Loss: 0.3556547 Vali Loss: 0.2920985 Test Loss: 0.3039580
Validation loss decreased (inf --> 0.292098).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3706978
	speed: 0.1061s/iter; left time: 842.0030s
	iters: 200, epoch: 2 | loss: 0.2966510
	speed: 0.0273s/iter; left time: 213.8601s
	iters: 300, epoch: 2 | loss: 0.3602779
	speed: 0.0272s/iter; left time: 210.7115s
	iters: 400, epoch: 2 | loss: 0.3386261
	speed: 0.0272s/iter; left time: 207.8695s
	iters: 500, epoch: 2 | loss: 0.3215255
	speed: 0.0274s/iter; left time: 206.3710s
	iters: 600, epoch: 2 | loss: 0.3141547
	speed: 0.0274s/iter; left time: 203.8425s
	iters: 700, epoch: 2 | loss: 0.2952349
	speed: 0.0273s/iter; left time: 200.6925s
	iters: 800, epoch: 2 | loss: 0.3320257
	speed: 0.0273s/iter; left time: 197.7129s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.70s
Steps: 893 | Train Loss: 0.3247859 Vali Loss: 0.3201315 Test Loss: 0.2973356
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2733711
	speed: 0.1027s/iter; left time: 723.6557s
	iters: 200, epoch: 3 | loss: 0.3248109
	speed: 0.0273s/iter; left time: 189.7828s
	iters: 300, epoch: 3 | loss: 0.2257117
	speed: 0.0272s/iter; left time: 186.3969s
	iters: 400, epoch: 3 | loss: 0.2731641
	speed: 0.0272s/iter; left time: 183.4775s
	iters: 500, epoch: 3 | loss: 0.2779773
	speed: 0.0273s/iter; left time: 181.1962s
	iters: 600, epoch: 3 | loss: 0.2573780
	speed: 0.0273s/iter; left time: 178.4901s
	iters: 700, epoch: 3 | loss: 0.2458740
	speed: 0.0273s/iter; left time: 175.7113s
	iters: 800, epoch: 3 | loss: 0.2732427
	speed: 0.0273s/iter; left time: 173.0578s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.60s
Steps: 893 | Train Loss: 0.2874371 Vali Loss: 0.3134867 Test Loss: 0.2830081
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2891310
	speed: 0.1025s/iter; left time: 630.3034s
	iters: 200, epoch: 4 | loss: 0.3713713
	speed: 0.0274s/iter; left time: 165.7653s
	iters: 300, epoch: 4 | loss: 0.2729061
	speed: 0.0275s/iter; left time: 163.4856s
	iters: 400, epoch: 4 | loss: 0.2645756
	speed: 0.0274s/iter; left time: 160.0859s
	iters: 500, epoch: 4 | loss: 0.3139978
	speed: 0.0273s/iter; left time: 156.8439s
	iters: 600, epoch: 4 | loss: 0.2714025
	speed: 0.0270s/iter; left time: 152.4914s
	iters: 700, epoch: 4 | loss: 0.2414389
	speed: 0.0272s/iter; left time: 150.7536s
	iters: 800, epoch: 4 | loss: 0.2565933
	speed: 0.0272s/iter; left time: 148.5161s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.58s
Steps: 893 | Train Loss: 0.2756752 Vali Loss: 0.2654778 Test Loss: 0.2705120
Validation loss decreased (0.292098 --> 0.265478).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2990750
	speed: 0.1051s/iter; left time: 552.7014s
	iters: 200, epoch: 5 | loss: 0.2412163
	speed: 0.0275s/iter; left time: 141.7452s
	iters: 300, epoch: 5 | loss: 0.2579147
	speed: 0.0274s/iter; left time: 138.8572s
	iters: 400, epoch: 5 | loss: 0.2580310
	speed: 0.0274s/iter; left time: 135.8696s
	iters: 500, epoch: 5 | loss: 0.2835760
	speed: 0.0274s/iter; left time: 133.1580s
	iters: 600, epoch: 5 | loss: 0.2596518
	speed: 0.0272s/iter; left time: 129.5726s
	iters: 700, epoch: 5 | loss: 0.2723984
	speed: 0.0273s/iter; left time: 127.2304s
	iters: 800, epoch: 5 | loss: 0.2674299
	speed: 0.0272s/iter; left time: 124.0246s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:24.72s
Steps: 893 | Train Loss: 0.2648823 Vali Loss: 0.2740279 Test Loss: 0.2736182
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2216048
	speed: 0.1024s/iter; left time: 447.1373s
	iters: 200, epoch: 6 | loss: 0.2511810
	speed: 0.0272s/iter; left time: 116.1833s
	iters: 300, epoch: 6 | loss: 0.2358657
	speed: 0.0272s/iter; left time: 113.3618s
	iters: 400, epoch: 6 | loss: 0.2595595
	speed: 0.0272s/iter; left time: 110.6020s
	iters: 500, epoch: 6 | loss: 0.3095907
	speed: 0.0272s/iter; left time: 107.7490s
	iters: 600, epoch: 6 | loss: 0.2614948
	speed: 0.0272s/iter; left time: 105.0254s
	iters: 700, epoch: 6 | loss: 0.2063620
	speed: 0.0272s/iter; left time: 102.4601s
	iters: 800, epoch: 6 | loss: 0.2354636
	speed: 0.0272s/iter; left time: 99.5691s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:24.49s
Steps: 893 | Train Loss: 0.2533990 Vali Loss: 0.2662660 Test Loss: 0.2667550
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2483694
	speed: 0.1025s/iter; left time: 355.9091s
	iters: 200, epoch: 7 | loss: 0.2179991
	speed: 0.0273s/iter; left time: 91.9566s
	iters: 300, epoch: 7 | loss: 0.2910841
	speed: 0.0273s/iter; left time: 89.4237s
	iters: 400, epoch: 7 | loss: 0.2312266
	speed: 0.0273s/iter; left time: 86.6708s
	iters: 500, epoch: 7 | loss: 0.2366821
	speed: 0.0275s/iter; left time: 84.4072s
	iters: 600, epoch: 7 | loss: 0.2357767
	speed: 0.0273s/iter; left time: 81.2330s
	iters: 700, epoch: 7 | loss: 0.1950151
	speed: 0.0273s/iter; left time: 78.3715s
	iters: 800, epoch: 7 | loss: 0.2377862
	speed: 0.0273s/iter; left time: 75.6521s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:24.71s
Steps: 893 | Train Loss: 0.2462534 Vali Loss: 0.2928742 Test Loss: 0.2734101
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_24_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.21791434288024902, rmse:0.46681296825408936, mae:0.27051201462745667, rse:0.4275248646736145
Original data scale mse:1284505.75, rmse:1133.3603515625, mae:733.4088134765625, rse:0.07964391261339188

Extracted Metrics for IT, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.23465076088905334, RMSE: 0.4844076335430145, MAE: 0.3008269965648651, RSE: 0.4436386823654175
Unscaled Metrics - MSE: 1737740.625, RMSE: 1318.23388671875, MAE: 870.5348510742188, RSE: 0.09263540804386139

Extracted Metrics for IT, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.21791434288024902, RMSE: 0.46681296825408936, MAE: 0.27051201462745667, RSE: 0.4275248646736145
Unscaled Metrics - MSE: 1284505.75, RMSE: 1133.3603515625, MAE: 733.4088134765625, RSE: 0.07964391261339188

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_96_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.5048910
	speed: 0.0557s/iter; left time: 491.1504s
	iters: 200, epoch: 1 | loss: 0.4624923
	speed: 0.0274s/iter; left time: 238.5250s
	iters: 300, epoch: 1 | loss: 0.4738801
	speed: 0.0273s/iter; left time: 234.8183s
	iters: 400, epoch: 1 | loss: 0.3941330
	speed: 0.0274s/iter; left time: 233.2464s
	iters: 500, epoch: 1 | loss: 0.3995663
	speed: 0.0275s/iter; left time: 231.1262s
	iters: 600, epoch: 1 | loss: 0.4141737
	speed: 0.0274s/iter; left time: 227.6912s
	iters: 700, epoch: 1 | loss: 0.3811809
	speed: 0.0273s/iter; left time: 224.0744s
	iters: 800, epoch: 1 | loss: 0.3673746
	speed: 0.0273s/iter; left time: 221.1297s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.92s
Steps: 891 | Train Loss: 0.4314201 Vali Loss: 0.3762588 Test Loss: 0.3902533
Validation loss decreased (inf --> 0.376259).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4149987
	speed: 0.1032s/iter; left time: 817.7132s
	iters: 200, epoch: 2 | loss: 0.3848574
	speed: 0.0275s/iter; left time: 215.3417s
	iters: 300, epoch: 2 | loss: 0.4092552
	speed: 0.0275s/iter; left time: 212.1982s
	iters: 400, epoch: 2 | loss: 0.4131490
	speed: 0.0275s/iter; left time: 209.5481s
	iters: 500, epoch: 2 | loss: 0.3783213
	speed: 0.0274s/iter; left time: 205.8877s
	iters: 600, epoch: 2 | loss: 0.4112385
	speed: 0.0274s/iter; left time: 203.3975s
	iters: 700, epoch: 2 | loss: 0.4174444
	speed: 0.0275s/iter; left time: 200.9782s
	iters: 800, epoch: 2 | loss: 0.3943548
	speed: 0.0273s/iter; left time: 197.1145s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.67s
Steps: 891 | Train Loss: 0.4036418 Vali Loss: 0.4197529 Test Loss: 0.3881394
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3931260
	speed: 0.1009s/iter; left time: 709.4100s
	iters: 200, epoch: 3 | loss: 0.3495661
	speed: 0.0276s/iter; left time: 190.9274s
	iters: 300, epoch: 3 | loss: 0.3346368
	speed: 0.0275s/iter; left time: 187.9595s
	iters: 400, epoch: 3 | loss: 0.3523859
	speed: 0.0275s/iter; left time: 185.0476s
	iters: 500, epoch: 3 | loss: 0.4031612
	speed: 0.0275s/iter; left time: 182.5078s
	iters: 600, epoch: 3 | loss: 0.3515646
	speed: 0.0275s/iter; left time: 179.7076s
	iters: 700, epoch: 3 | loss: 0.4025802
	speed: 0.0274s/iter; left time: 176.3705s
	iters: 800, epoch: 3 | loss: 0.3301155
	speed: 0.0274s/iter; left time: 173.6038s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.68s
Steps: 891 | Train Loss: 0.3675560 Vali Loss: 0.4102313 Test Loss: 0.3816121
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3832389
	speed: 0.1008s/iter; left time: 618.9117s
	iters: 200, epoch: 4 | loss: 0.3587969
	speed: 0.0275s/iter; left time: 166.2981s
	iters: 300, epoch: 4 | loss: 0.3775885
	speed: 0.0275s/iter; left time: 163.5060s
	iters: 400, epoch: 4 | loss: 0.4245037
	speed: 0.0276s/iter; left time: 160.8832s
	iters: 500, epoch: 4 | loss: 0.4385809
	speed: 0.0277s/iter; left time: 158.7697s
	iters: 600, epoch: 4 | loss: 0.3671278
	speed: 0.0276s/iter; left time: 155.6560s
	iters: 700, epoch: 4 | loss: 0.3382820
	speed: 0.0276s/iter; left time: 152.6003s
	iters: 800, epoch: 4 | loss: 0.3439263
	speed: 0.0276s/iter; left time: 150.2417s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.77s
Steps: 891 | Train Loss: 0.3564063 Vali Loss: 0.4448601 Test Loss: 0.4366408
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3722892701625824, rmse:0.6101551055908203, mae:0.3902531862258911, rse:0.5586609244346619
Original data scale mse:2971120.25, rmse:1723.6937255859375, mae:1153.3736572265625, rse:0.12130337953567505
Use GPU: cuda:0
>>>>>>>start training : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28529
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.4786096
	speed: 0.0297s/iter; left time: 261.6953s
	iters: 200, epoch: 1 | loss: 0.4580492
	speed: 0.0278s/iter; left time: 242.0267s
	iters: 300, epoch: 1 | loss: 0.4185181
	speed: 0.0278s/iter; left time: 239.6002s
	iters: 400, epoch: 1 | loss: 0.3995733
	speed: 0.0278s/iter; left time: 236.1842s
	iters: 500, epoch: 1 | loss: 0.4123164
	speed: 0.0275s/iter; left time: 231.5803s
	iters: 600, epoch: 1 | loss: 0.4048673
	speed: 0.0275s/iter; left time: 228.7802s
	iters: 700, epoch: 1 | loss: 0.3646207
	speed: 0.0275s/iter; left time: 226.1215s
	iters: 800, epoch: 1 | loss: 0.4078133
	speed: 0.0276s/iter; left time: 223.4627s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:24.87s
Steps: 891 | Train Loss: 0.4319501 Vali Loss: 0.3758786 Test Loss: 0.3904696
Validation loss decreased (inf --> 0.375879).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4535407
	speed: 0.1057s/iter; left time: 836.9052s
	iters: 200, epoch: 2 | loss: 0.4283198
	speed: 0.0278s/iter; left time: 217.4439s
	iters: 300, epoch: 2 | loss: 0.3830183
	speed: 0.0278s/iter; left time: 214.9843s
	iters: 400, epoch: 2 | loss: 0.4614796
	speed: 0.0278s/iter; left time: 211.6511s
	iters: 500, epoch: 2 | loss: 0.3612100
	speed: 0.0276s/iter; left time: 207.3700s
	iters: 600, epoch: 2 | loss: 0.4451167
	speed: 0.0276s/iter; left time: 204.6104s
	iters: 700, epoch: 2 | loss: 0.3536181
	speed: 0.0278s/iter; left time: 203.2071s
	iters: 800, epoch: 2 | loss: 0.3656040
	speed: 0.0275s/iter; left time: 198.8911s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:24.91s
Steps: 891 | Train Loss: 0.4015411 Vali Loss: 0.5508094 Test Loss: 0.4440978
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3547257
	speed: 0.1016s/iter; left time: 714.3549s
	iters: 200, epoch: 3 | loss: 0.3623811
	speed: 0.0275s/iter; left time: 190.8539s
	iters: 300, epoch: 3 | loss: 0.3390434
	speed: 0.0276s/iter; left time: 188.1998s
	iters: 400, epoch: 3 | loss: 0.3500589
	speed: 0.0276s/iter; left time: 185.4987s
	iters: 500, epoch: 3 | loss: 0.3446547
	speed: 0.0276s/iter; left time: 182.8453s
	iters: 600, epoch: 3 | loss: 0.3729407
	speed: 0.0276s/iter; left time: 179.9796s
	iters: 700, epoch: 3 | loss: 0.3565905
	speed: 0.0275s/iter; left time: 177.0555s
	iters: 800, epoch: 3 | loss: 0.3344237
	speed: 0.0275s/iter; left time: 174.3264s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:24.75s
Steps: 891 | Train Loss: 0.3634622 Vali Loss: 0.4031188 Test Loss: 0.3943823
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4017072
	speed: 0.1016s/iter; left time: 623.6284s
	iters: 200, epoch: 4 | loss: 0.3978628
	speed: 0.0276s/iter; left time: 166.4218s
	iters: 300, epoch: 4 | loss: 0.3608368
	speed: 0.0276s/iter; left time: 163.6300s
	iters: 400, epoch: 4 | loss: 0.3582010
	speed: 0.0276s/iter; left time: 160.9401s
	iters: 500, epoch: 4 | loss: 0.3416453
	speed: 0.0276s/iter; left time: 158.1649s
	iters: 600, epoch: 4 | loss: 0.3526659
	speed: 0.0276s/iter; left time: 155.3705s
	iters: 700, epoch: 4 | loss: 0.3325384
	speed: 0.0276s/iter; left time: 152.8127s
	iters: 800, epoch: 4 | loss: 0.3479073
	speed: 0.0276s/iter; left time: 149.9510s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:24.77s
Steps: 891 | Train Loss: 0.3513284 Vali Loss: 0.3923279 Test Loss: 0.4050016
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_96_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.3720118999481201, rmse:0.609927773475647, mae:0.390469491481781, rse:0.5584527254104614
Original data scale mse:2962697.0, rmse:1721.2486572265625, mae:1151.7640380859375, rse:0.1211312934756279

Extracted Metrics for IT, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.3722892701625824, RMSE: 0.6101551055908203, MAE: 0.3902531862258911, RSE: 0.5586609244346619
Unscaled Metrics - MSE: 2971120.25, RMSE: 1723.6937255859375, MAE: 1153.3736572265625, RSE: 0.12130337953567505

Extracted Metrics for IT, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.3720118999481201, RMSE: 0.609927773475647, MAE: 0.390469491481781, RSE: 0.5584527254104614
Unscaled Metrics - MSE: 2962697.0, RMSE: 1721.2486572265625, MAE: 1151.7640380859375, RSE: 0.1211312934756279

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='IT_512_168_loss_choice_for_IT', model='PatchTST', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='IT_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='standard', seq_len=512, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=3, dec_in=3, c_out=3, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4882123
	speed: 0.0552s/iter; left time: 485.3823s
	iters: 200, epoch: 1 | loss: 0.4255947
	speed: 0.0280s/iter; left time: 243.6851s
	iters: 300, epoch: 1 | loss: 0.4338664
	speed: 0.0280s/iter; left time: 240.9691s
	iters: 400, epoch: 1 | loss: 0.4778512
	speed: 0.0280s/iter; left time: 238.1218s
	iters: 500, epoch: 1 | loss: 0.4622410
	speed: 0.0281s/iter; left time: 235.4172s
	iters: 600, epoch: 1 | loss: 0.4301345
	speed: 0.0280s/iter; left time: 232.3313s
	iters: 700, epoch: 1 | loss: 0.4353366
	speed: 0.0280s/iter; left time: 229.6614s
	iters: 800, epoch: 1 | loss: 0.4069046
	speed: 0.0281s/iter; left time: 227.0031s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.38s
Steps: 889 | Train Loss: 0.4473399 Vali Loss: 0.3978793 Test Loss: 0.4102175
Validation loss decreased (inf --> 0.397879).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4614058
	speed: 0.1054s/iter; left time: 833.2069s
	iters: 200, epoch: 2 | loss: 0.4189624
	speed: 0.0281s/iter; left time: 218.8848s
	iters: 300, epoch: 2 | loss: 0.4494941
	speed: 0.0281s/iter; left time: 216.0547s
	iters: 400, epoch: 2 | loss: 0.4063901
	speed: 0.0280s/iter; left time: 213.2130s
	iters: 500, epoch: 2 | loss: 0.3859436
	speed: 0.0280s/iter; left time: 210.4148s
	iters: 600, epoch: 2 | loss: 0.4369733
	speed: 0.0281s/iter; left time: 207.6490s
	iters: 700, epoch: 2 | loss: 0.4517567
	speed: 0.0282s/iter; left time: 205.6991s
	iters: 800, epoch: 2 | loss: 0.4252723
	speed: 0.0281s/iter; left time: 202.5642s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.19s
Steps: 889 | Train Loss: 0.4156616 Vali Loss: 0.4196915 Test Loss: 0.4071267
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3611205
	speed: 0.1026s/iter; left time: 719.2214s
	iters: 200, epoch: 3 | loss: 0.3910709
	speed: 0.0280s/iter; left time: 193.4649s
	iters: 300, epoch: 3 | loss: 0.3830313
	speed: 0.0280s/iter; left time: 190.6784s
	iters: 400, epoch: 3 | loss: 0.3939875
	speed: 0.0280s/iter; left time: 187.9154s
	iters: 500, epoch: 3 | loss: 0.3462081
	speed: 0.0280s/iter; left time: 185.2126s
	iters: 600, epoch: 3 | loss: 0.3378207
	speed: 0.0280s/iter; left time: 182.4086s
	iters: 700, epoch: 3 | loss: 0.3638391
	speed: 0.0281s/iter; left time: 180.0098s
	iters: 800, epoch: 3 | loss: 0.3769526
	speed: 0.0281s/iter; left time: 177.2312s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.14s
Steps: 889 | Train Loss: 0.3724418 Vali Loss: 0.4664101 Test Loss: 0.4459947
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3428098
	speed: 0.1024s/iter; left time: 627.2297s
	iters: 200, epoch: 4 | loss: 0.3485061
	speed: 0.0281s/iter; left time: 169.5358s
	iters: 300, epoch: 4 | loss: 0.3779067
	speed: 0.0281s/iter; left time: 166.6227s
	iters: 400, epoch: 4 | loss: 0.4184667
	speed: 0.0281s/iter; left time: 163.8453s
	iters: 500, epoch: 4 | loss: 0.3098816
	speed: 0.0281s/iter; left time: 161.0011s
	iters: 600, epoch: 4 | loss: 0.3472888
	speed: 0.0281s/iter; left time: 157.9193s
	iters: 700, epoch: 4 | loss: 0.3746775
	speed: 0.0281s/iter; left time: 155.2691s
	iters: 800, epoch: 4 | loss: 0.3369662
	speed: 0.0281s/iter; left time: 152.6500s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.21s
Steps: 889 | Train Loss: 0.3532491 Vali Loss: 0.4262153 Test Loss: 0.4548399
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.3948919177055359, rmse:0.6284042596817017, mae:0.4102174639701843, rse:0.5755413174629211
Original data scale mse:3482605.25, rmse:1866.1739501953125, mae:1247.342529296875, rse:0.13145360350608826
Use GPU: cuda:0
>>>>>>>start training : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28457
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.4988396
	speed: 0.0311s/iter; left time: 273.1878s
	iters: 200, epoch: 1 | loss: 0.4959015
	speed: 0.0282s/iter; left time: 244.9690s
	iters: 300, epoch: 1 | loss: 0.4229558
	speed: 0.0281s/iter; left time: 241.6489s
	iters: 400, epoch: 1 | loss: 0.4465075
	speed: 0.0281s/iter; left time: 238.8605s
	iters: 500, epoch: 1 | loss: 0.4229743
	speed: 0.0282s/iter; left time: 236.2491s
	iters: 600, epoch: 1 | loss: 0.4205169
	speed: 0.0282s/iter; left time: 233.5636s
	iters: 700, epoch: 1 | loss: 0.4050072
	speed: 0.0282s/iter; left time: 231.0353s
	iters: 800, epoch: 1 | loss: 0.4098848
	speed: 0.0281s/iter; left time: 227.7297s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:25.38s
Steps: 889 | Train Loss: 0.4482730 Vali Loss: 0.3975321 Test Loss: 0.4101898
Validation loss decreased (inf --> 0.397532).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4882390
	speed: 0.1061s/iter; left time: 838.3556s
	iters: 200, epoch: 2 | loss: 0.4344603
	speed: 0.0283s/iter; left time: 220.9025s
	iters: 300, epoch: 2 | loss: 0.4864512
	speed: 0.0281s/iter; left time: 216.2412s
	iters: 400, epoch: 2 | loss: 0.3861863
	speed: 0.0282s/iter; left time: 214.3145s
	iters: 500, epoch: 2 | loss: 0.3924901
	speed: 0.0281s/iter; left time: 210.8275s
	iters: 600, epoch: 2 | loss: 0.4161739
	speed: 0.0281s/iter; left time: 208.3031s
	iters: 700, epoch: 2 | loss: 0.3904049
	speed: 0.0283s/iter; left time: 206.3229s
	iters: 800, epoch: 2 | loss: 0.3767627
	speed: 0.0282s/iter; left time: 203.4171s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:25.29s
Steps: 889 | Train Loss: 0.4224887 Vali Loss: 0.4820433 Test Loss: 0.4436995
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4021910
	speed: 0.1028s/iter; left time: 721.2344s
	iters: 200, epoch: 3 | loss: 0.3955979
	speed: 0.0281s/iter; left time: 194.3270s
	iters: 300, epoch: 3 | loss: 0.4424662
	speed: 0.0281s/iter; left time: 191.5419s
	iters: 400, epoch: 3 | loss: 0.3891844
	speed: 0.0284s/iter; left time: 190.3219s
	iters: 500, epoch: 3 | loss: 0.4070046
	speed: 0.0285s/iter; left time: 188.2027s
	iters: 600, epoch: 3 | loss: 0.3801282
	speed: 0.0283s/iter; left time: 184.2635s
	iters: 700, epoch: 3 | loss: 0.3632169
	speed: 0.0282s/iter; left time: 180.9102s
	iters: 800, epoch: 3 | loss: 0.3710393
	speed: 0.0283s/iter; left time: 178.7221s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:25.29s
Steps: 889 | Train Loss: 0.3824787 Vali Loss: 0.4141027 Test Loss: 0.4120091
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3827431
	speed: 0.1054s/iter; left time: 645.5236s
	iters: 200, epoch: 4 | loss: 0.3719378
	speed: 0.0283s/iter; left time: 170.3316s
	iters: 300, epoch: 4 | loss: 0.3741429
	speed: 0.0282s/iter; left time: 167.2736s
	iters: 400, epoch: 4 | loss: 0.3633974
	speed: 0.0282s/iter; left time: 164.3953s
	iters: 500, epoch: 4 | loss: 0.3920256
	speed: 0.0282s/iter; left time: 161.6762s
	iters: 600, epoch: 4 | loss: 0.3855481
	speed: 0.0282s/iter; left time: 158.7393s
	iters: 700, epoch: 4 | loss: 0.3787815
	speed: 0.0283s/iter; left time: 156.0698s
	iters: 800, epoch: 4 | loss: 0.3422233
	speed: 0.0284s/iter; left time: 153.8561s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:25.39s
Steps: 889 | Train Loss: 0.3635866 Vali Loss: 0.4851521 Test Loss: 0.4669451
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : IT_512_168_loss_choice_for_IT_PatchTST_custom_ftM_sl512_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.39474543929100037, rmse:0.6282877326011658, mae:0.41018983721733093, rse:0.5754345655441284
Original data scale mse:3453181.5, rmse:1858.2738037109375, mae:1243.2384033203125, rse:0.13089711964130402

Extracted Metrics for IT, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.3948919177055359, RMSE: 0.6284042596817017, MAE: 0.4102174639701843, RSE: 0.5755413174629211
Unscaled Metrics - MSE: 3482605.25, RMSE: 1866.1739501953125, MAE: 1247.342529296875, RSE: 0.13145360350608826

Extracted Metrics for IT, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.39474543929100037, RMSE: 0.6282877326011658, MAE: 0.41018983721733093, RSE: 0.5754345655441284
Unscaled Metrics - MSE: 3453181.5, RMSE: 1858.2738037109375, MAE: 1243.2384033203125, RSE: 0.13089711964130402
