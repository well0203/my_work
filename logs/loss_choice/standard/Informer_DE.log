
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0942546
	speed: 0.0683s/iter; left time: 612.3586s
	iters: 200, epoch: 1 | loss: 0.0667797
	speed: 0.0403s/iter; left time: 357.4144s
	iters: 300, epoch: 1 | loss: 0.0588467
	speed: 0.0403s/iter; left time: 352.9619s
	iters: 400, epoch: 1 | loss: 0.0457102
	speed: 0.0401s/iter; left time: 347.7160s
	iters: 500, epoch: 1 | loss: 0.0421427
	speed: 0.0401s/iter; left time: 343.1341s
	iters: 600, epoch: 1 | loss: 0.0368923
	speed: 0.0404s/iter; left time: 341.6386s
	iters: 700, epoch: 1 | loss: 0.0460224
	speed: 0.0405s/iter; left time: 338.2764s
	iters: 800, epoch: 1 | loss: 0.0355560
	speed: 0.0403s/iter; left time: 333.2710s
	iters: 900, epoch: 1 | loss: 0.0282983
	speed: 0.0399s/iter; left time: 325.9436s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.21s
Steps: 906 | Train Loss: 0.0578716 Vali Loss: 0.0328540 Test Loss: 0.0360874
Validation loss decreased (inf --> 0.032854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0200453
	speed: 0.1022s/iter; left time: 823.0344s
	iters: 200, epoch: 2 | loss: 0.0261499
	speed: 0.0403s/iter; left time: 320.2797s
	iters: 300, epoch: 2 | loss: 0.0187321
	speed: 0.0403s/iter; left time: 316.8211s
	iters: 400, epoch: 2 | loss: 0.0183808
	speed: 0.0392s/iter; left time: 303.6850s
	iters: 500, epoch: 2 | loss: 0.0152190
	speed: 0.0394s/iter; left time: 301.3273s
	iters: 600, epoch: 2 | loss: 0.0156461
	speed: 0.0401s/iter; left time: 302.6508s
	iters: 700, epoch: 2 | loss: 0.0146780
	speed: 0.0405s/iter; left time: 302.1127s
	iters: 800, epoch: 2 | loss: 0.0206594
	speed: 0.0392s/iter; left time: 288.4665s
	iters: 900, epoch: 2 | loss: 0.0144302
	speed: 0.0404s/iter; left time: 293.0066s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.41s
Steps: 906 | Train Loss: 0.0199861 Vali Loss: 0.0212579 Test Loss: 0.0242976
Validation loss decreased (0.032854 --> 0.021258).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0159689
	speed: 0.0975s/iter; left time: 697.2086s
	iters: 200, epoch: 3 | loss: 0.0128649
	speed: 0.0402s/iter; left time: 283.5731s
	iters: 300, epoch: 3 | loss: 0.0146372
	speed: 0.0406s/iter; left time: 281.9015s
	iters: 400, epoch: 3 | loss: 0.0158485
	speed: 0.0401s/iter; left time: 274.6169s
	iters: 500, epoch: 3 | loss: 0.0186484
	speed: 0.0404s/iter; left time: 272.7815s
	iters: 600, epoch: 3 | loss: 0.0192382
	speed: 0.0404s/iter; left time: 268.3858s
	iters: 700, epoch: 3 | loss: 0.0138006
	speed: 0.0405s/iter; left time: 265.1888s
	iters: 800, epoch: 3 | loss: 0.0132834
	speed: 0.0405s/iter; left time: 260.9073s
	iters: 900, epoch: 3 | loss: 0.0159991
	speed: 0.0404s/iter; left time: 256.7395s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.73s
Steps: 906 | Train Loss: 0.0146077 Vali Loss: 0.0212980 Test Loss: 0.0228801
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0104485
	speed: 0.0934s/iter; left time: 583.0037s
	iters: 200, epoch: 4 | loss: 0.0125054
	speed: 0.0401s/iter; left time: 246.0977s
	iters: 300, epoch: 4 | loss: 0.0128581
	speed: 0.0404s/iter; left time: 244.3430s
	iters: 400, epoch: 4 | loss: 0.0100157
	speed: 0.0404s/iter; left time: 240.2736s
	iters: 500, epoch: 4 | loss: 0.0132754
	speed: 0.0404s/iter; left time: 236.2772s
	iters: 600, epoch: 4 | loss: 0.0139050
	speed: 0.0404s/iter; left time: 232.0682s
	iters: 700, epoch: 4 | loss: 0.0112287
	speed: 0.0405s/iter; left time: 228.7898s
	iters: 800, epoch: 4 | loss: 0.0141093
	speed: 0.0403s/iter; left time: 223.3993s
	iters: 900, epoch: 4 | loss: 0.0116282
	speed: 0.0405s/iter; left time: 220.5520s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.78s
Steps: 906 | Train Loss: 0.0129339 Vali Loss: 0.0229334 Test Loss: 0.0247191
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0140071
	speed: 0.0930s/iter; left time: 496.3576s
	iters: 200, epoch: 5 | loss: 0.0111624
	speed: 0.0403s/iter; left time: 210.8969s
	iters: 300, epoch: 5 | loss: 0.0104040
	speed: 0.0404s/iter; left time: 207.5353s
	iters: 400, epoch: 5 | loss: 0.0135564
	speed: 0.0402s/iter; left time: 202.2497s
	iters: 500, epoch: 5 | loss: 0.0099290
	speed: 0.0405s/iter; left time: 199.9081s
	iters: 600, epoch: 5 | loss: 0.0110839
	speed: 0.0406s/iter; left time: 196.1880s
	iters: 700, epoch: 5 | loss: 0.0107402
	speed: 0.0403s/iter; left time: 190.8791s
	iters: 800, epoch: 5 | loss: 0.0121734
	speed: 0.0404s/iter; left time: 187.4898s
	iters: 900, epoch: 5 | loss: 0.0128513
	speed: 0.0405s/iter; left time: 183.7024s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.80s
Steps: 906 | Train Loss: 0.0116328 Vali Loss: 0.0209129 Test Loss: 0.0249126
Validation loss decreased (0.021258 --> 0.020913).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0121859
	speed: 0.0958s/iter; left time: 424.4172s
	iters: 200, epoch: 6 | loss: 0.0115178
	speed: 0.0404s/iter; left time: 175.0162s
	iters: 300, epoch: 6 | loss: 0.0104146
	speed: 0.0403s/iter; left time: 170.6231s
	iters: 400, epoch: 6 | loss: 0.0115494
	speed: 0.0401s/iter; left time: 165.5231s
	iters: 500, epoch: 6 | loss: 0.0119643
	speed: 0.0404s/iter; left time: 162.8805s
	iters: 600, epoch: 6 | loss: 0.0081770
	speed: 0.0403s/iter; left time: 158.5380s
	iters: 700, epoch: 6 | loss: 0.0123818
	speed: 0.0404s/iter; left time: 154.9052s
	iters: 800, epoch: 6 | loss: 0.0079767
	speed: 0.0403s/iter; left time: 150.2897s
	iters: 900, epoch: 6 | loss: 0.0072877
	speed: 0.0404s/iter; left time: 146.5626s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.70s
Steps: 906 | Train Loss: 0.0099782 Vali Loss: 0.0219904 Test Loss: 0.0262837
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0073663
	speed: 0.0928s/iter; left time: 327.0644s
	iters: 200, epoch: 7 | loss: 0.0101608
	speed: 0.0399s/iter; left time: 136.7544s
	iters: 300, epoch: 7 | loss: 0.0081983
	speed: 0.0403s/iter; left time: 134.0983s
	iters: 400, epoch: 7 | loss: 0.0104248
	speed: 0.0403s/iter; left time: 130.0435s
	iters: 500, epoch: 7 | loss: 0.0086621
	speed: 0.0405s/iter; left time: 126.4430s
	iters: 600, epoch: 7 | loss: 0.0076589
	speed: 0.0404s/iter; left time: 122.1034s
	iters: 700, epoch: 7 | loss: 0.0073568
	speed: 0.0401s/iter; left time: 117.3609s
	iters: 800, epoch: 7 | loss: 0.0081911
	speed: 0.0404s/iter; left time: 114.0124s
	iters: 900, epoch: 7 | loss: 0.0091360
	speed: 0.0403s/iter; left time: 109.7523s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.71s
Steps: 906 | Train Loss: 0.0087739 Vali Loss: 0.0225039 Test Loss: 0.0279977
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0083496
	speed: 0.0927s/iter; left time: 242.7993s
	iters: 200, epoch: 8 | loss: 0.0081475
	speed: 0.0404s/iter; left time: 101.8811s
	iters: 300, epoch: 8 | loss: 0.0073608
	speed: 0.0403s/iter; left time: 97.5834s
	iters: 400, epoch: 8 | loss: 0.0073632
	speed: 0.0404s/iter; left time: 93.7783s
	iters: 500, epoch: 8 | loss: 0.0064928
	speed: 0.0404s/iter; left time: 89.6554s
	iters: 600, epoch: 8 | loss: 0.0057923
	speed: 0.0404s/iter; left time: 85.5362s
	iters: 700, epoch: 8 | loss: 0.0083221
	speed: 0.0400s/iter; left time: 80.6717s
	iters: 800, epoch: 8 | loss: 0.0076627
	speed: 0.0397s/iter; left time: 76.2366s
	iters: 900, epoch: 8 | loss: 0.0086224
	speed: 0.0404s/iter; left time: 73.5216s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:36.67s
Steps: 906 | Train Loss: 0.0077076 Vali Loss: 0.0230374 Test Loss: 0.0285441
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02496965043246746, rmse:0.15801787376403809, mae:0.10408886522054672, rse:0.55804443359375
Original data scale mse:21478470.0, rmse:4634.48681640625, mae:2927.15283203125, rse:0.2304360270500183
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.0938398
	speed: 0.0424s/iter; left time: 379.5402s
	iters: 200, epoch: 1 | loss: 0.0642789
	speed: 0.0403s/iter; left time: 356.7991s
	iters: 300, epoch: 1 | loss: 0.0629560
	speed: 0.0405s/iter; left time: 354.4314s
	iters: 400, epoch: 1 | loss: 0.0477485
	speed: 0.0398s/iter; left time: 344.9105s
	iters: 500, epoch: 1 | loss: 0.0532036
	speed: 0.0424s/iter; left time: 362.9572s
	iters: 600, epoch: 1 | loss: 0.0478263
	speed: 0.0402s/iter; left time: 340.2141s
	iters: 700, epoch: 1 | loss: 0.0405289
	speed: 0.0405s/iter; left time: 338.4288s
	iters: 800, epoch: 1 | loss: 0.0288731
	speed: 0.0403s/iter; left time: 332.7812s
	iters: 900, epoch: 1 | loss: 0.0323386
	speed: 0.0400s/iter; left time: 326.7000s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:36.93s
Steps: 906 | Train Loss: 0.0581791 Vali Loss: 0.0334077 Test Loss: 0.0377991
Validation loss decreased (inf --> 0.033408).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0285942
	speed: 0.1005s/iter; left time: 809.3566s
	iters: 200, epoch: 2 | loss: 0.0189234
	speed: 0.0404s/iter; left time: 321.4174s
	iters: 300, epoch: 2 | loss: 0.0159083
	speed: 0.0405s/iter; left time: 317.9023s
	iters: 400, epoch: 2 | loss: 0.0204149
	speed: 0.0403s/iter; left time: 312.7259s
	iters: 500, epoch: 2 | loss: 0.0143734
	speed: 0.0401s/iter; left time: 306.9729s
	iters: 600, epoch: 2 | loss: 0.0182881
	speed: 0.0405s/iter; left time: 306.2926s
	iters: 700, epoch: 2 | loss: 0.0160795
	speed: 0.0404s/iter; left time: 301.5443s
	iters: 800, epoch: 2 | loss: 0.0160197
	speed: 0.0404s/iter; left time: 297.0222s
	iters: 900, epoch: 2 | loss: 0.0163546
	speed: 0.0394s/iter; left time: 285.9588s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.71s
Steps: 906 | Train Loss: 0.0199710 Vali Loss: 0.0215980 Test Loss: 0.0231432
Validation loss decreased (0.033408 --> 0.021598).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0140854
	speed: 0.0995s/iter; left time: 711.2374s
	iters: 200, epoch: 3 | loss: 0.0205783
	speed: 0.0404s/iter; left time: 285.0350s
	iters: 300, epoch: 3 | loss: 0.0187233
	speed: 0.0405s/iter; left time: 281.0904s
	iters: 400, epoch: 3 | loss: 0.0169409
	speed: 0.0405s/iter; left time: 277.2805s
	iters: 500, epoch: 3 | loss: 0.0176392
	speed: 0.0404s/iter; left time: 272.4446s
	iters: 600, epoch: 3 | loss: 0.0134549
	speed: 0.0403s/iter; left time: 267.6806s
	iters: 700, epoch: 3 | loss: 0.0117885
	speed: 0.0405s/iter; left time: 265.0472s
	iters: 800, epoch: 3 | loss: 0.0129310
	speed: 0.0405s/iter; left time: 261.1409s
	iters: 900, epoch: 3 | loss: 0.0140353
	speed: 0.0404s/iter; left time: 256.2412s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.85s
Steps: 906 | Train Loss: 0.0143454 Vali Loss: 0.0208516 Test Loss: 0.0233106
Validation loss decreased (0.021598 --> 0.020852).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0143937
	speed: 0.0994s/iter; left time: 620.8627s
	iters: 200, epoch: 4 | loss: 0.0103517
	speed: 0.0404s/iter; left time: 248.1144s
	iters: 300, epoch: 4 | loss: 0.0144832
	speed: 0.0405s/iter; left time: 244.7205s
	iters: 400, epoch: 4 | loss: 0.0151069
	speed: 0.0405s/iter; left time: 240.6540s
	iters: 500, epoch: 4 | loss: 0.0142648
	speed: 0.0405s/iter; left time: 236.4304s
	iters: 600, epoch: 4 | loss: 0.0151003
	speed: 0.0405s/iter; left time: 232.6209s
	iters: 700, epoch: 4 | loss: 0.0103973
	speed: 0.0406s/iter; left time: 228.8288s
	iters: 800, epoch: 4 | loss: 0.0104725
	speed: 0.0405s/iter; left time: 224.5247s
	iters: 900, epoch: 4 | loss: 0.0114167
	speed: 0.0405s/iter; left time: 220.2864s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.87s
Steps: 906 | Train Loss: 0.0127303 Vali Loss: 0.0203258 Test Loss: 0.0228659
Validation loss decreased (0.020852 --> 0.020326).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0112127
	speed: 0.0987s/iter; left time: 527.0123s
	iters: 200, epoch: 5 | loss: 0.0120055
	speed: 0.0405s/iter; left time: 212.1772s
	iters: 300, epoch: 5 | loss: 0.0105872
	speed: 0.0406s/iter; left time: 208.3055s
	iters: 400, epoch: 5 | loss: 0.0095046
	speed: 0.0402s/iter; left time: 202.3271s
	iters: 500, epoch: 5 | loss: 0.0124287
	speed: 0.0397s/iter; left time: 196.1016s
	iters: 600, epoch: 5 | loss: 0.0123740
	speed: 0.0399s/iter; left time: 192.8847s
	iters: 700, epoch: 5 | loss: 0.0126600
	speed: 0.0401s/iter; left time: 190.1581s
	iters: 800, epoch: 5 | loss: 0.0142700
	speed: 0.0392s/iter; left time: 181.9390s
	iters: 900, epoch: 5 | loss: 0.0119086
	speed: 0.0403s/iter; left time: 183.0486s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.52s
Steps: 906 | Train Loss: 0.0110497 Vali Loss: 0.0213849 Test Loss: 0.0252486
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0091037
	speed: 0.0910s/iter; left time: 403.0770s
	iters: 200, epoch: 6 | loss: 0.0097279
	speed: 0.0285s/iter; left time: 123.5195s
	iters: 300, epoch: 6 | loss: 0.0106359
	speed: 0.0284s/iter; left time: 120.1227s
	iters: 400, epoch: 6 | loss: 0.0091133
	speed: 0.0285s/iter; left time: 117.5364s
	iters: 500, epoch: 6 | loss: 0.0097699
	speed: 0.0284s/iter; left time: 114.4401s
	iters: 600, epoch: 6 | loss: 0.0069945
	speed: 0.0285s/iter; left time: 111.9791s
	iters: 700, epoch: 6 | loss: 0.0091658
	speed: 0.0287s/iter; left time: 110.0897s
	iters: 800, epoch: 6 | loss: 0.0087391
	speed: 0.0284s/iter; left time: 106.0581s
	iters: 900, epoch: 6 | loss: 0.0090745
	speed: 0.0286s/iter; left time: 103.7416s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:26.93s
Steps: 906 | Train Loss: 0.0096277 Vali Loss: 0.0212603 Test Loss: 0.0247180
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0102733
	speed: 0.0928s/iter; left time: 327.2907s
	iters: 200, epoch: 7 | loss: 0.0070053
	speed: 0.0403s/iter; left time: 137.9949s
	iters: 300, epoch: 7 | loss: 0.0102707
	speed: 0.0402s/iter; left time: 133.6681s
	iters: 400, epoch: 7 | loss: 0.0087207
	speed: 0.0403s/iter; left time: 129.9662s
	iters: 500, epoch: 7 | loss: 0.0102770
	speed: 0.0402s/iter; left time: 125.7619s
	iters: 600, epoch: 7 | loss: 0.0107841
	speed: 0.0405s/iter; left time: 122.5470s
	iters: 700, epoch: 7 | loss: 0.0091903
	speed: 0.0404s/iter; left time: 118.1663s
	iters: 800, epoch: 7 | loss: 0.0090340
	speed: 0.0403s/iter; left time: 113.8960s
	iters: 900, epoch: 7 | loss: 0.0084766
	speed: 0.0404s/iter; left time: 110.0459s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.77s
Steps: 906 | Train Loss: 0.0083809 Vali Loss: 0.0239215 Test Loss: 0.0280777
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.022877730429172516, rmse:0.1512538641691208, mae:0.10139743983745575, rse:0.5341570973396301
Original data scale mse:19517502.0, rmse:4417.86181640625, mae:2843.488037109375, rse:0.21966499090194702

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.02496965043246746, RMSE: 0.15801787376403809, MAE: 0.10408886522054672, RSE: 0.55804443359375
Unscaled Metrics - MSE: 21478470.0, RMSE: 4634.48681640625, MAE: 2927.15283203125, RSE: 0.2304360270500183

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.022877730429172516, RMSE: 0.1512538641691208, MAE: 0.10139743983745575, RSE: 0.5341570973396301
Unscaled Metrics - MSE: 19517502.0, RMSE: 4417.86181640625, MAE: 2843.488037109375, RSE: 0.21966499090194702

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0945499
	speed: 0.0754s/iter; left time: 673.8599s
	iters: 200, epoch: 1 | loss: 0.0813206
	speed: 0.0481s/iter; left time: 424.9686s
	iters: 300, epoch: 1 | loss: 0.0689713
	speed: 0.0479s/iter; left time: 418.8308s
	iters: 400, epoch: 1 | loss: 0.0582750
	speed: 0.0448s/iter; left time: 386.8468s
	iters: 500, epoch: 1 | loss: 0.0542483
	speed: 0.0467s/iter; left time: 398.9630s
	iters: 600, epoch: 1 | loss: 0.0503807
	speed: 0.0477s/iter; left time: 402.7184s
	iters: 700, epoch: 1 | loss: 0.0456270
	speed: 0.0459s/iter; left time: 383.1424s
	iters: 800, epoch: 1 | loss: 0.0463673
	speed: 0.0459s/iter; left time: 378.2425s
	iters: 900, epoch: 1 | loss: 0.0438126
	speed: 0.0457s/iter; left time: 372.2836s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.02s
Steps: 904 | Train Loss: 0.0647476 Vali Loss: 0.0486602 Test Loss: 0.0615587
Validation loss decreased (inf --> 0.048660).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0290388
	speed: 0.1181s/iter; left time: 949.1157s
	iters: 200, epoch: 2 | loss: 0.0303201
	speed: 0.0474s/iter; left time: 376.0747s
	iters: 300, epoch: 2 | loss: 0.0295338
	speed: 0.0480s/iter; left time: 376.0643s
	iters: 400, epoch: 2 | loss: 0.0259183
	speed: 0.0461s/iter; left time: 356.5283s
	iters: 500, epoch: 2 | loss: 0.0269378
	speed: 0.0461s/iter; left time: 351.7734s
	iters: 600, epoch: 2 | loss: 0.0310408
	speed: 0.0450s/iter; left time: 339.3363s
	iters: 700, epoch: 2 | loss: 0.0253571
	speed: 0.0458s/iter; left time: 340.8428s
	iters: 800, epoch: 2 | loss: 0.0286073
	speed: 0.0462s/iter; left time: 339.3081s
	iters: 900, epoch: 2 | loss: 0.0237425
	speed: 0.0463s/iter; left time: 334.9781s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.34s
Steps: 904 | Train Loss: 0.0288204 Vali Loss: 0.0342063 Test Loss: 0.0416341
Validation loss decreased (0.048660 --> 0.034206).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0266491
	speed: 0.1144s/iter; left time: 815.9528s
	iters: 200, epoch: 3 | loss: 0.0200128
	speed: 0.0459s/iter; left time: 322.5379s
	iters: 300, epoch: 3 | loss: 0.0205474
	speed: 0.0462s/iter; left time: 320.2643s
	iters: 400, epoch: 3 | loss: 0.0209371
	speed: 0.0457s/iter; left time: 312.2234s
	iters: 500, epoch: 3 | loss: 0.0211199
	speed: 0.0461s/iter; left time: 310.6061s
	iters: 600, epoch: 3 | loss: 0.0268021
	speed: 0.0441s/iter; left time: 292.5935s
	iters: 700, epoch: 3 | loss: 0.0192956
	speed: 0.0450s/iter; left time: 293.8172s
	iters: 800, epoch: 3 | loss: 0.0224315
	speed: 0.0442s/iter; left time: 284.5315s
	iters: 900, epoch: 3 | loss: 0.0214192
	speed: 0.0454s/iter; left time: 287.4172s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.10s
Steps: 904 | Train Loss: 0.0229189 Vali Loss: 0.0342457 Test Loss: 0.0418113
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0187121
	speed: 0.1111s/iter; left time: 691.8936s
	iters: 200, epoch: 4 | loss: 0.0181936
	speed: 0.0460s/iter; left time: 282.0567s
	iters: 300, epoch: 4 | loss: 0.0200255
	speed: 0.0458s/iter; left time: 276.0574s
	iters: 400, epoch: 4 | loss: 0.0162172
	speed: 0.0461s/iter; left time: 273.2977s
	iters: 500, epoch: 4 | loss: 0.0216165
	speed: 0.0460s/iter; left time: 267.8434s
	iters: 600, epoch: 4 | loss: 0.0161444
	speed: 0.0462s/iter; left time: 264.6955s
	iters: 700, epoch: 4 | loss: 0.0214690
	speed: 0.0462s/iter; left time: 260.2801s
	iters: 800, epoch: 4 | loss: 0.0181671
	speed: 0.0457s/iter; left time: 252.7773s
	iters: 900, epoch: 4 | loss: 0.0226844
	speed: 0.0458s/iter; left time: 248.4610s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.76s
Steps: 904 | Train Loss: 0.0199593 Vali Loss: 0.0352827 Test Loss: 0.0429098
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0180635
	speed: 0.1109s/iter; left time: 590.7668s
	iters: 200, epoch: 5 | loss: 0.0210786
	speed: 0.0459s/iter; left time: 239.7637s
	iters: 300, epoch: 5 | loss: 0.0164446
	speed: 0.0461s/iter; left time: 236.3641s
	iters: 400, epoch: 5 | loss: 0.0171539
	speed: 0.0460s/iter; left time: 230.9838s
	iters: 500, epoch: 5 | loss: 0.0164758
	speed: 0.0454s/iter; left time: 223.7010s
	iters: 600, epoch: 5 | loss: 0.0173010
	speed: 0.0458s/iter; left time: 220.7588s
	iters: 700, epoch: 5 | loss: 0.0152048
	speed: 0.0443s/iter; left time: 209.3848s
	iters: 800, epoch: 5 | loss: 0.0145456
	speed: 0.0443s/iter; left time: 204.8016s
	iters: 900, epoch: 5 | loss: 0.0151162
	speed: 0.0463s/iter; left time: 209.3921s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.37s
Steps: 904 | Train Loss: 0.0170921 Vali Loss: 0.0348996 Test Loss: 0.0446376
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041615840047597885, rmse:0.2039996087551117, mae:0.14690826833248138, rse:0.7224038243293762
Original data scale mse:38027972.0, rmse:6166.6826171875, mae:4192.33154296875, rse:0.3071029782295227
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.0934298
	speed: 0.0475s/iter; left time: 424.6590s
	iters: 200, epoch: 1 | loss: 0.0724698
	speed: 0.0471s/iter; left time: 416.5948s
	iters: 300, epoch: 1 | loss: 0.0670248
	speed: 0.0476s/iter; left time: 416.5041s
	iters: 400, epoch: 1 | loss: 0.0601231
	speed: 0.0472s/iter; left time: 407.6145s
	iters: 500, epoch: 1 | loss: 0.0589422
	speed: 0.0464s/iter; left time: 396.5011s
	iters: 600, epoch: 1 | loss: 0.0493249
	speed: 0.0462s/iter; left time: 390.1863s
	iters: 700, epoch: 1 | loss: 0.0617602
	speed: 0.0483s/iter; left time: 403.0038s
	iters: 800, epoch: 1 | loss: 0.0475968
	speed: 0.0485s/iter; left time: 399.4486s
	iters: 900, epoch: 1 | loss: 0.0497684
	speed: 0.0482s/iter; left time: 392.2565s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.97s
Steps: 904 | Train Loss: 0.0670265 Vali Loss: 0.0486257 Test Loss: 0.0613907
Validation loss decreased (inf --> 0.048626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0374997
	speed: 0.1172s/iter; left time: 942.2621s
	iters: 200, epoch: 2 | loss: 0.0309897
	speed: 0.0460s/iter; left time: 365.2437s
	iters: 300, epoch: 2 | loss: 0.0294268
	speed: 0.0459s/iter; left time: 359.7976s
	iters: 400, epoch: 2 | loss: 0.0241191
	speed: 0.0455s/iter; left time: 352.3753s
	iters: 500, epoch: 2 | loss: 0.0253514
	speed: 0.0461s/iter; left time: 352.4350s
	iters: 600, epoch: 2 | loss: 0.0310746
	speed: 0.0460s/iter; left time: 346.6476s
	iters: 700, epoch: 2 | loss: 0.0256869
	speed: 0.0457s/iter; left time: 339.7181s
	iters: 800, epoch: 2 | loss: 0.0268583
	speed: 0.0445s/iter; left time: 326.2400s
	iters: 900, epoch: 2 | loss: 0.0207889
	speed: 0.0449s/iter; left time: 325.2337s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.52s
Steps: 904 | Train Loss: 0.0290841 Vali Loss: 0.0344298 Test Loss: 0.0417856
Validation loss decreased (0.048626 --> 0.034430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0261266
	speed: 0.1174s/iter; left time: 837.4760s
	iters: 200, epoch: 3 | loss: 0.0260678
	speed: 0.0476s/iter; left time: 334.5553s
	iters: 300, epoch: 3 | loss: 0.0206129
	speed: 0.0477s/iter; left time: 330.8836s
	iters: 400, epoch: 3 | loss: 0.0226454
	speed: 0.0484s/iter; left time: 330.9682s
	iters: 500, epoch: 3 | loss: 0.0228899
	speed: 0.0492s/iter; left time: 331.0523s
	iters: 600, epoch: 3 | loss: 0.0228538
	speed: 0.0498s/iter; left time: 330.6042s
	iters: 700, epoch: 3 | loss: 0.0218899
	speed: 0.0495s/iter; left time: 323.0747s
	iters: 800, epoch: 3 | loss: 0.0265811
	speed: 0.0453s/iter; left time: 291.3422s
	iters: 900, epoch: 3 | loss: 0.0242745
	speed: 0.0452s/iter; left time: 286.0518s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.29s
Steps: 904 | Train Loss: 0.0228451 Vali Loss: 0.0336392 Test Loss: 0.0409652
Validation loss decreased (0.034430 --> 0.033639).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0228310
	speed: 0.1142s/iter; left time: 711.3721s
	iters: 200, epoch: 4 | loss: 0.0209504
	speed: 0.0454s/iter; left time: 278.0087s
	iters: 300, epoch: 4 | loss: 0.0185800
	speed: 0.0462s/iter; left time: 278.8157s
	iters: 400, epoch: 4 | loss: 0.0181875
	speed: 0.0461s/iter; left time: 273.1168s
	iters: 500, epoch: 4 | loss: 0.0187002
	speed: 0.0445s/iter; left time: 259.4738s
	iters: 600, epoch: 4 | loss: 0.0216594
	speed: 0.0455s/iter; left time: 260.4324s
	iters: 700, epoch: 4 | loss: 0.0190073
	speed: 0.0461s/iter; left time: 259.3018s
	iters: 800, epoch: 4 | loss: 0.0199375
	speed: 0.0460s/iter; left time: 254.2903s
	iters: 900, epoch: 4 | loss: 0.0178906
	speed: 0.0458s/iter; left time: 248.9182s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.49s
Steps: 904 | Train Loss: 0.0203049 Vali Loss: 0.0356499 Test Loss: 0.0466749
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0140134
	speed: 0.1125s/iter; left time: 598.9738s
	iters: 200, epoch: 5 | loss: 0.0168959
	speed: 0.0464s/iter; left time: 242.2564s
	iters: 300, epoch: 5 | loss: 0.0174581
	speed: 0.0454s/iter; left time: 232.7042s
	iters: 400, epoch: 5 | loss: 0.0161702
	speed: 0.0462s/iter; left time: 232.2459s
	iters: 500, epoch: 5 | loss: 0.0201695
	speed: 0.0460s/iter; left time: 226.6826s
	iters: 600, epoch: 5 | loss: 0.0151612
	speed: 0.0455s/iter; left time: 219.6925s
	iters: 700, epoch: 5 | loss: 0.0207555
	speed: 0.0453s/iter; left time: 214.2382s
	iters: 800, epoch: 5 | loss: 0.0172408
	speed: 0.0451s/iter; left time: 208.4996s
	iters: 900, epoch: 5 | loss: 0.0148860
	speed: 0.0458s/iter; left time: 207.4520s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.66s
Steps: 904 | Train Loss: 0.0178362 Vali Loss: 0.0331190 Test Loss: 0.0419096
Validation loss decreased (0.033639 --> 0.033119).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0144145
	speed: 0.1142s/iter; left time: 505.0906s
	iters: 200, epoch: 6 | loss: 0.0169662
	speed: 0.0451s/iter; left time: 194.8171s
	iters: 300, epoch: 6 | loss: 0.0174153
	speed: 0.0451s/iter; left time: 190.4855s
	iters: 400, epoch: 6 | loss: 0.0158803
	speed: 0.0458s/iter; left time: 188.6142s
	iters: 500, epoch: 6 | loss: 0.0153488
	speed: 0.0451s/iter; left time: 181.5221s
	iters: 600, epoch: 6 | loss: 0.0144447
	speed: 0.0459s/iter; left time: 180.0824s
	iters: 700, epoch: 6 | loss: 0.0143681
	speed: 0.0457s/iter; left time: 174.7292s
	iters: 800, epoch: 6 | loss: 0.0135953
	speed: 0.0459s/iter; left time: 170.6355s
	iters: 900, epoch: 6 | loss: 0.0135909
	speed: 0.0460s/iter; left time: 166.5485s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.40s
Steps: 904 | Train Loss: 0.0152141 Vali Loss: 0.0362119 Test Loss: 0.0441905
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0117771
	speed: 0.1126s/iter; left time: 395.9964s
	iters: 200, epoch: 7 | loss: 0.0153151
	speed: 0.0462s/iter; left time: 157.8068s
	iters: 300, epoch: 7 | loss: 0.0163094
	speed: 0.0462s/iter; left time: 153.1293s
	iters: 400, epoch: 7 | loss: 0.0121797
	speed: 0.0446s/iter; left time: 143.5213s
	iters: 500, epoch: 7 | loss: 0.0131824
	speed: 0.0482s/iter; left time: 150.3045s
	iters: 600, epoch: 7 | loss: 0.0118811
	speed: 0.0468s/iter; left time: 141.1904s
	iters: 700, epoch: 7 | loss: 0.0120821
	speed: 0.0461s/iter; left time: 134.3848s
	iters: 800, epoch: 7 | loss: 0.0115689
	speed: 0.0481s/iter; left time: 135.5800s
	iters: 900, epoch: 7 | loss: 0.0110598
	speed: 0.0482s/iter; left time: 131.0877s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.47s
Steps: 904 | Train Loss: 0.0131583 Vali Loss: 0.0358438 Test Loss: 0.0466085
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0126066
	speed: 0.1125s/iter; left time: 294.0468s
	iters: 200, epoch: 8 | loss: 0.0109178
	speed: 0.0460s/iter; left time: 115.6087s
	iters: 300, epoch: 8 | loss: 0.0105501
	speed: 0.0439s/iter; left time: 106.0062s
	iters: 400, epoch: 8 | loss: 0.0104000
	speed: 0.0453s/iter; left time: 104.7649s
	iters: 500, epoch: 8 | loss: 0.0107914
	speed: 0.0452s/iter; left time: 100.0825s
	iters: 600, epoch: 8 | loss: 0.0112817
	speed: 0.0451s/iter; left time: 95.1999s
	iters: 700, epoch: 8 | loss: 0.0132655
	speed: 0.0459s/iter; left time: 92.4326s
	iters: 800, epoch: 8 | loss: 0.0105933
	speed: 0.0463s/iter; left time: 88.5998s
	iters: 900, epoch: 8 | loss: 0.0097098
	speed: 0.0462s/iter; left time: 83.6711s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:41.40s
Steps: 904 | Train Loss: 0.0114334 Vali Loss: 0.0356914 Test Loss: 0.0472074
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.041922442615032196, rmse:0.2047497034072876, mae:0.14136722683906555, rse:0.7250601053237915
Original data scale mse:38741736.0, rmse:6224.2861328125, mae:4020.862548828125, rse:0.3099716603755951

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.041615840047597885, RMSE: 0.2039996087551117, MAE: 0.14690826833248138, RSE: 0.7224038243293762
Unscaled Metrics - MSE: 38027972.0, RMSE: 6166.6826171875, MAE: 4192.33154296875, RSE: 0.3071029782295227

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.041922442615032196, RMSE: 0.2047497034072876, MAE: 0.14136722683906555, RSE: 0.7250601053237915
Unscaled Metrics - MSE: 38741736.0, RMSE: 6224.2861328125, MAE: 4020.862548828125, RSE: 0.3099716603755951

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0873523
	speed: 0.0777s/iter; left time: 693.1777s
	iters: 200, epoch: 1 | loss: 0.0789642
	speed: 0.0515s/iter; left time: 454.4937s
	iters: 300, epoch: 1 | loss: 0.0649056
	speed: 0.0516s/iter; left time: 450.3613s
	iters: 400, epoch: 1 | loss: 0.0617752
	speed: 0.0514s/iter; left time: 443.0172s
	iters: 500, epoch: 1 | loss: 0.0583439
	speed: 0.0519s/iter; left time: 442.0977s
	iters: 600, epoch: 1 | loss: 0.0582502
	speed: 0.0517s/iter; left time: 435.2378s
	iters: 700, epoch: 1 | loss: 0.0537353
	speed: 0.0517s/iter; left time: 429.9141s
	iters: 800, epoch: 1 | loss: 0.0514252
	speed: 0.0518s/iter; left time: 425.8395s
	iters: 900, epoch: 1 | loss: 0.0530902
	speed: 0.0457s/iter; left time: 370.7499s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.66s
Steps: 902 | Train Loss: 0.0672486 Vali Loss: 0.0566032 Test Loss: 0.0734987
Validation loss decreased (inf --> 0.056603).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0474865
	speed: 0.1314s/iter; left time: 1054.0754s
	iters: 200, epoch: 2 | loss: 0.0358440
	speed: 0.0522s/iter; left time: 413.4757s
	iters: 300, epoch: 2 | loss: 0.0414159
	speed: 0.0520s/iter; left time: 406.7687s
	iters: 400, epoch: 2 | loss: 0.0342225
	speed: 0.0521s/iter; left time: 401.9739s
	iters: 500, epoch: 2 | loss: 0.0330931
	speed: 0.0518s/iter; left time: 394.9242s
	iters: 600, epoch: 2 | loss: 0.0289756
	speed: 0.0519s/iter; left time: 389.8816s
	iters: 700, epoch: 2 | loss: 0.0288790
	speed: 0.0519s/iter; left time: 385.1564s
	iters: 800, epoch: 2 | loss: 0.0331658
	speed: 0.0521s/iter; left time: 381.2746s
	iters: 900, epoch: 2 | loss: 0.0241773
	speed: 0.0520s/iter; left time: 375.0456s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.09s
Steps: 902 | Train Loss: 0.0342880 Vali Loss: 0.0365227 Test Loss: 0.0451551
Validation loss decreased (0.056603 --> 0.036523).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0288659
	speed: 0.1311s/iter; left time: 933.0086s
	iters: 200, epoch: 3 | loss: 0.0243717
	speed: 0.0517s/iter; left time: 362.8317s
	iters: 300, epoch: 3 | loss: 0.0256150
	speed: 0.0520s/iter; left time: 359.5283s
	iters: 400, epoch: 3 | loss: 0.0281696
	speed: 0.0514s/iter; left time: 350.5732s
	iters: 500, epoch: 3 | loss: 0.0227520
	speed: 0.0518s/iter; left time: 347.6544s
	iters: 600, epoch: 3 | loss: 0.0243430
	speed: 0.0513s/iter; left time: 339.6072s
	iters: 700, epoch: 3 | loss: 0.0243500
	speed: 0.0514s/iter; left time: 334.8622s
	iters: 800, epoch: 3 | loss: 0.0246347
	speed: 0.0517s/iter; left time: 331.8250s
	iters: 900, epoch: 3 | loss: 0.0226484
	speed: 0.0519s/iter; left time: 328.1225s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:46.81s
Steps: 902 | Train Loss: 0.0242081 Vali Loss: 0.0350496 Test Loss: 0.0419213
Validation loss decreased (0.036523 --> 0.035050).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0195246
	speed: 0.1312s/iter; left time: 815.4128s
	iters: 200, epoch: 4 | loss: 0.0185972
	speed: 0.0520s/iter; left time: 317.9936s
	iters: 300, epoch: 4 | loss: 0.0225250
	speed: 0.0521s/iter; left time: 313.1252s
	iters: 400, epoch: 4 | loss: 0.0223284
	speed: 0.0520s/iter; left time: 307.6728s
	iters: 500, epoch: 4 | loss: 0.0223749
	speed: 0.0518s/iter; left time: 301.2771s
	iters: 600, epoch: 4 | loss: 0.0182441
	speed: 0.0515s/iter; left time: 294.0820s
	iters: 700, epoch: 4 | loss: 0.0231301
	speed: 0.0519s/iter; left time: 291.3827s
	iters: 800, epoch: 4 | loss: 0.0219780
	speed: 0.0520s/iter; left time: 286.5153s
	iters: 900, epoch: 4 | loss: 0.0195454
	speed: 0.0518s/iter; left time: 280.6637s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:46.94s
Steps: 902 | Train Loss: 0.0208355 Vali Loss: 0.0383455 Test Loss: 0.0469129
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0197092
	speed: 0.1275s/iter; left time: 677.2606s
	iters: 200, epoch: 5 | loss: 0.0191564
	speed: 0.0518s/iter; left time: 270.1412s
	iters: 300, epoch: 5 | loss: 0.0180140
	speed: 0.0520s/iter; left time: 265.7936s
	iters: 400, epoch: 5 | loss: 0.0199376
	speed: 0.0515s/iter; left time: 258.1043s
	iters: 500, epoch: 5 | loss: 0.0148208
	speed: 0.0519s/iter; left time: 255.0767s
	iters: 600, epoch: 5 | loss: 0.0175141
	speed: 0.0514s/iter; left time: 247.4098s
	iters: 700, epoch: 5 | loss: 0.0173887
	speed: 0.0520s/iter; left time: 244.9696s
	iters: 800, epoch: 5 | loss: 0.0157184
	speed: 0.0521s/iter; left time: 240.4271s
	iters: 900, epoch: 5 | loss: 0.0148864
	speed: 0.0518s/iter; left time: 233.9593s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:46.95s
Steps: 902 | Train Loss: 0.0178738 Vali Loss: 0.0387645 Test Loss: 0.0473018
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0163559
	speed: 0.1275s/iter; left time: 562.4230s
	iters: 200, epoch: 6 | loss: 0.0168228
	speed: 0.0518s/iter; left time: 223.3560s
	iters: 300, epoch: 6 | loss: 0.0148977
	speed: 0.0521s/iter; left time: 219.5057s
	iters: 400, epoch: 6 | loss: 0.0183019
	speed: 0.0518s/iter; left time: 212.9816s
	iters: 500, epoch: 6 | loss: 0.0140002
	speed: 0.0522s/iter; left time: 209.3813s
	iters: 600, epoch: 6 | loss: 0.0141699
	speed: 0.0519s/iter; left time: 202.9125s
	iters: 700, epoch: 6 | loss: 0.0162823
	speed: 0.0520s/iter; left time: 198.3494s
	iters: 800, epoch: 6 | loss: 0.0132826
	speed: 0.0521s/iter; left time: 193.3173s
	iters: 900, epoch: 6 | loss: 0.0166660
	speed: 0.0522s/iter; left time: 188.5700s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.10s
Steps: 902 | Train Loss: 0.0152689 Vali Loss: 0.0395027 Test Loss: 0.0494608
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04194251820445061, rmse:0.20479872822761536, mae:0.14613044261932373, rse:0.7255402207374573
Original data scale mse:38667512.0, rmse:6218.32080078125, mae:4159.83203125, rse:0.3098265826702118
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.0996415
	speed: 0.0537s/iter; left time: 478.9193s
	iters: 200, epoch: 1 | loss: 0.0730885
	speed: 0.0522s/iter; left time: 460.8188s
	iters: 300, epoch: 1 | loss: 0.0679008
	speed: 0.0522s/iter; left time: 454.8106s
	iters: 400, epoch: 1 | loss: 0.0527211
	speed: 0.0522s/iter; left time: 450.2976s
	iters: 500, epoch: 1 | loss: 0.0611140
	speed: 0.0520s/iter; left time: 443.4445s
	iters: 600, epoch: 1 | loss: 0.0541079
	speed: 0.0524s/iter; left time: 441.0979s
	iters: 700, epoch: 1 | loss: 0.0524976
	speed: 0.0522s/iter; left time: 433.9433s
	iters: 800, epoch: 1 | loss: 0.0498116
	speed: 0.0517s/iter; left time: 424.8928s
	iters: 900, epoch: 1 | loss: 0.0514907
	speed: 0.0518s/iter; left time: 420.4873s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.21s
Steps: 902 | Train Loss: 0.0677858 Vali Loss: 0.0552768 Test Loss: 0.0721760
Validation loss decreased (inf --> 0.055277).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.0399472
	speed: 0.1315s/iter; left time: 1054.2271s
	iters: 200, epoch: 2 | loss: 0.0345920
	speed: 0.0523s/iter; left time: 414.1940s
	iters: 300, epoch: 2 | loss: 0.0327963
	speed: 0.0522s/iter; left time: 407.9570s
	iters: 400, epoch: 2 | loss: 0.0300119
	speed: 0.0520s/iter; left time: 401.6240s
	iters: 500, epoch: 2 | loss: 0.0309086
	speed: 0.0518s/iter; left time: 394.6002s
	iters: 600, epoch: 2 | loss: 0.0327205
	speed: 0.0519s/iter; left time: 390.0919s
	iters: 700, epoch: 2 | loss: 0.0301898
	speed: 0.0517s/iter; left time: 383.4849s
	iters: 800, epoch: 2 | loss: 0.0246733
	speed: 0.0518s/iter; left time: 379.0826s
	iters: 900, epoch: 2 | loss: 0.0267641
	speed: 0.0517s/iter; left time: 373.5569s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.04s
Steps: 902 | Train Loss: 0.0344061 Vali Loss: 0.0406078 Test Loss: 0.0490091
Validation loss decreased (0.055277 --> 0.040608).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0244818
	speed: 0.1324s/iter; left time: 942.0392s
	iters: 200, epoch: 3 | loss: 0.0276308
	speed: 0.0519s/iter; left time: 364.1808s
	iters: 300, epoch: 3 | loss: 0.0285101
	speed: 0.0520s/iter; left time: 359.6247s
	iters: 400, epoch: 3 | loss: 0.0247908
	speed: 0.0521s/iter; left time: 355.0039s
	iters: 500, epoch: 3 | loss: 0.0248932
	speed: 0.0520s/iter; left time: 349.5810s
	iters: 600, epoch: 3 | loss: 0.0240189
	speed: 0.0520s/iter; left time: 344.0352s
	iters: 700, epoch: 3 | loss: 0.0220240
	speed: 0.0520s/iter; left time: 338.6045s
	iters: 800, epoch: 3 | loss: 0.0212572
	speed: 0.0521s/iter; left time: 334.2020s
	iters: 900, epoch: 3 | loss: 0.0232297
	speed: 0.0522s/iter; left time: 329.8949s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.15s
Steps: 902 | Train Loss: 0.0245630 Vali Loss: 0.0353295 Test Loss: 0.0427999
Validation loss decreased (0.040608 --> 0.035330).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0222516
	speed: 0.1314s/iter; left time: 816.6276s
	iters: 200, epoch: 4 | loss: 0.0187717
	speed: 0.0519s/iter; left time: 317.5495s
	iters: 300, epoch: 4 | loss: 0.0205009
	speed: 0.0520s/iter; left time: 313.0240s
	iters: 400, epoch: 4 | loss: 0.0192620
	speed: 0.0520s/iter; left time: 307.7019s
	iters: 500, epoch: 4 | loss: 0.0217269
	speed: 0.0518s/iter; left time: 301.1429s
	iters: 600, epoch: 4 | loss: 0.0232268
	speed: 0.0522s/iter; left time: 298.1737s
	iters: 700, epoch: 4 | loss: 0.0181606
	speed: 0.0522s/iter; left time: 293.3362s
	iters: 800, epoch: 4 | loss: 0.0204242
	speed: 0.0517s/iter; left time: 284.8644s
	iters: 900, epoch: 4 | loss: 0.0196388
	speed: 0.0521s/iter; left time: 282.1120s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.08s
Steps: 902 | Train Loss: 0.0210388 Vali Loss: 0.0377036 Test Loss: 0.0474297
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0165764
	speed: 0.1281s/iter; left time: 680.8012s
	iters: 200, epoch: 5 | loss: 0.0184076
	speed: 0.0519s/iter; left time: 270.7191s
	iters: 300, epoch: 5 | loss: 0.0180536
	speed: 0.0515s/iter; left time: 263.3774s
	iters: 400, epoch: 5 | loss: 0.0186979
	speed: 0.0519s/iter; left time: 260.0663s
	iters: 500, epoch: 5 | loss: 0.0193929
	speed: 0.0519s/iter; left time: 254.8049s
	iters: 600, epoch: 5 | loss: 0.0152829
	speed: 0.0518s/iter; left time: 249.5462s
	iters: 700, epoch: 5 | loss: 0.0181565
	speed: 0.0521s/iter; left time: 245.5057s
	iters: 800, epoch: 5 | loss: 0.0155313
	speed: 0.0513s/iter; left time: 236.6548s
	iters: 900, epoch: 5 | loss: 0.0167628
	speed: 0.0518s/iter; left time: 233.9206s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:46.88s
Steps: 902 | Train Loss: 0.0181379 Vali Loss: 0.0366080 Test Loss: 0.0473259
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0165936
	speed: 0.1281s/iter; left time: 565.1997s
	iters: 200, epoch: 6 | loss: 0.0156297
	speed: 0.0514s/iter; left time: 221.5110s
	iters: 300, epoch: 6 | loss: 0.0156377
	speed: 0.0514s/iter; left time: 216.4007s
	iters: 400, epoch: 6 | loss: 0.0153034
	speed: 0.0514s/iter; left time: 211.2638s
	iters: 500, epoch: 6 | loss: 0.0144845
	speed: 0.0510s/iter; left time: 204.3732s
	iters: 600, epoch: 6 | loss: 0.0171050
	speed: 0.0511s/iter; left time: 199.9400s
	iters: 700, epoch: 6 | loss: 0.0161407
	speed: 0.0514s/iter; left time: 196.0383s
	iters: 800, epoch: 6 | loss: 0.0129499
	speed: 0.0520s/iter; left time: 193.0135s
	iters: 900, epoch: 6 | loss: 0.0129710
	speed: 0.0520s/iter; left time: 187.9178s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.67s
Steps: 902 | Train Loss: 0.0157268 Vali Loss: 0.0384959 Test Loss: 0.0500071
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.042809925973415375, rmse:0.20690560340881348, mae:0.14824068546295166, rse:0.7330042123794556
Original data scale mse:40122660.0, rmse:6334.2451171875, mae:4268.5029296875, rse:0.31560251116752625

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.04194251820445061, RMSE: 0.20479872822761536, MAE: 0.14613044261932373, RSE: 0.7255402207374573
Unscaled Metrics - MSE: 38667512.0, RMSE: 6218.32080078125, MAE: 4159.83203125, RSE: 0.3098265826702118

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.042809925973415375, RMSE: 0.20690560340881348, MAE: 0.14824068546295166, RSE: 0.7330042123794556
Unscaled Metrics - MSE: 40122660.0, RMSE: 6334.2451171875, MAE: 4268.5029296875, RSE: 0.31560251116752625

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.3044245
	speed: 0.0709s/iter; left time: 635.7565s
	iters: 200, epoch: 1 | loss: 0.2541756
	speed: 0.0410s/iter; left time: 363.0227s
	iters: 300, epoch: 1 | loss: 0.2359411
	speed: 0.0413s/iter; left time: 361.5013s
	iters: 400, epoch: 1 | loss: 0.2080690
	speed: 0.0405s/iter; left time: 350.4687s
	iters: 500, epoch: 1 | loss: 0.1993576
	speed: 0.0403s/iter; left time: 345.3462s
	iters: 600, epoch: 1 | loss: 0.1850158
	speed: 0.0404s/iter; left time: 341.5789s
	iters: 700, epoch: 1 | loss: 0.2074167
	speed: 0.0404s/iter; left time: 337.7997s
	iters: 800, epoch: 1 | loss: 0.1798474
	speed: 0.0405s/iter; left time: 334.4632s
	iters: 900, epoch: 1 | loss: 0.1626024
	speed: 0.0403s/iter; left time: 329.2031s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.56s
Steps: 906 | Train Loss: 0.2292621 Vali Loss: 0.0312259 Test Loss: 0.0339099
Validation loss decreased (inf --> 0.031226).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1436080
	speed: 0.1013s/iter; left time: 815.9394s
	iters: 200, epoch: 2 | loss: 0.1658469
	speed: 0.0404s/iter; left time: 321.6291s
	iters: 300, epoch: 2 | loss: 0.1337088
	speed: 0.0404s/iter; left time: 316.9650s
	iters: 400, epoch: 2 | loss: 0.1365202
	speed: 0.0405s/iter; left time: 314.2767s
	iters: 500, epoch: 2 | loss: 0.1223429
	speed: 0.0405s/iter; left time: 309.8017s
	iters: 600, epoch: 2 | loss: 0.1205767
	speed: 0.0403s/iter; left time: 304.2447s
	iters: 700, epoch: 2 | loss: 0.1182104
	speed: 0.0428s/iter; left time: 319.3633s
	iters: 800, epoch: 2 | loss: 0.1484690
	speed: 0.0424s/iter; left time: 311.8187s
	iters: 900, epoch: 2 | loss: 0.1202950
	speed: 0.0404s/iter; left time: 292.8371s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.33s
Steps: 906 | Train Loss: 0.1393169 Vali Loss: 0.0213747 Test Loss: 0.0251196
Validation loss decreased (0.031226 --> 0.021375).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1234659
	speed: 0.1007s/iter; left time: 719.8406s
	iters: 200, epoch: 3 | loss: 0.1091781
	speed: 0.0404s/iter; left time: 284.7397s
	iters: 300, epoch: 3 | loss: 0.1174415
	speed: 0.0402s/iter; left time: 279.4744s
	iters: 400, epoch: 3 | loss: 0.1293539
	speed: 0.0403s/iter; left time: 276.2565s
	iters: 500, epoch: 3 | loss: 0.1327087
	speed: 0.0405s/iter; left time: 273.0803s
	iters: 600, epoch: 3 | loss: 0.1358925
	speed: 0.0403s/iter; left time: 267.9387s
	iters: 700, epoch: 3 | loss: 0.1168140
	speed: 0.0426s/iter; left time: 279.0128s
	iters: 800, epoch: 3 | loss: 0.1123386
	speed: 0.0416s/iter; left time: 268.2896s
	iters: 900, epoch: 3 | loss: 0.1164839
	speed: 0.0427s/iter; left time: 270.9253s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.40s
Steps: 906 | Train Loss: 0.1189934 Vali Loss: 0.0215323 Test Loss: 0.0226174
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1026148
	speed: 0.0956s/iter; left time: 597.1310s
	iters: 200, epoch: 4 | loss: 0.1106264
	speed: 0.0403s/iter; left time: 247.2613s
	iters: 300, epoch: 4 | loss: 0.1169095
	speed: 0.0402s/iter; left time: 243.1454s
	iters: 400, epoch: 4 | loss: 0.1024052
	speed: 0.0403s/iter; left time: 239.7901s
	iters: 500, epoch: 4 | loss: 0.1161740
	speed: 0.0402s/iter; left time: 234.6553s
	iters: 600, epoch: 4 | loss: 0.1163085
	speed: 0.0410s/iter; left time: 235.3708s
	iters: 700, epoch: 4 | loss: 0.1058583
	speed: 0.0408s/iter; left time: 229.9896s
	iters: 800, epoch: 4 | loss: 0.1178173
	speed: 0.0406s/iter; left time: 225.0041s
	iters: 900, epoch: 4 | loss: 0.1051704
	speed: 0.0402s/iter; left time: 218.9706s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.90s
Steps: 906 | Train Loss: 0.1120337 Vali Loss: 0.0215291 Test Loss: 0.0237347
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1136920
	speed: 0.0950s/iter; left time: 507.1531s
	iters: 200, epoch: 5 | loss: 0.0999234
	speed: 0.0405s/iter; left time: 212.2739s
	iters: 300, epoch: 5 | loss: 0.1005163
	speed: 0.0403s/iter; left time: 207.1499s
	iters: 400, epoch: 5 | loss: 0.1132154
	speed: 0.0403s/iter; left time: 202.8455s
	iters: 500, epoch: 5 | loss: 0.0953875
	speed: 0.0404s/iter; left time: 199.6666s
	iters: 600, epoch: 5 | loss: 0.1069302
	speed: 0.0404s/iter; left time: 195.6096s
	iters: 700, epoch: 5 | loss: 0.1032498
	speed: 0.0407s/iter; left time: 192.7110s
	iters: 800, epoch: 5 | loss: 0.1120966
	speed: 0.0410s/iter; left time: 190.2989s
	iters: 900, epoch: 5 | loss: 0.1105405
	speed: 0.0405s/iter; left time: 183.6457s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.77s
Steps: 906 | Train Loss: 0.1057751 Vali Loss: 0.0214539 Test Loss: 0.0253474
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.025140458717942238, rmse:0.15855742990970612, mae:0.10656960308551788, rse:0.5599498748779297
Original data scale mse:20226732.0, rmse:4497.4140625, mae:2958.59619140625, rse:0.2236204892396927
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2595895
	speed: 0.0422s/iter; left time: 377.8127s
	iters: 200, epoch: 1 | loss: 0.2608878
	speed: 0.0399s/iter; left time: 353.3218s
	iters: 300, epoch: 1 | loss: 0.2372577
	speed: 0.0397s/iter; left time: 347.7116s
	iters: 400, epoch: 1 | loss: 0.2196511
	speed: 0.0401s/iter; left time: 346.9118s
	iters: 500, epoch: 1 | loss: 0.2175351
	speed: 0.0406s/iter; left time: 347.7636s
	iters: 600, epoch: 1 | loss: 0.1980118
	speed: 0.0402s/iter; left time: 340.3797s
	iters: 700, epoch: 1 | loss: 0.1874889
	speed: 0.0406s/iter; left time: 339.8357s
	iters: 800, epoch: 1 | loss: 0.1916354
	speed: 0.0405s/iter; left time: 334.8005s
	iters: 900, epoch: 1 | loss: 0.1750810
	speed: 0.0401s/iter; left time: 327.6322s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:36.72s
Steps: 906 | Train Loss: 0.2307725 Vali Loss: 0.0320970 Test Loss: 0.0358286
Validation loss decreased (inf --> 0.032097).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1507739
	speed: 0.1020s/iter; left time: 821.4534s
	iters: 200, epoch: 2 | loss: 0.1655973
	speed: 0.0400s/iter; left time: 318.4732s
	iters: 300, epoch: 2 | loss: 0.1238459
	speed: 0.0400s/iter; left time: 314.4216s
	iters: 400, epoch: 2 | loss: 0.1277618
	speed: 0.0399s/iter; left time: 309.6567s
	iters: 500, epoch: 2 | loss: 0.1319637
	speed: 0.0400s/iter; left time: 306.3530s
	iters: 600, epoch: 2 | loss: 0.1444153
	speed: 0.0399s/iter; left time: 301.4248s
	iters: 700, epoch: 2 | loss: 0.1221743
	speed: 0.0405s/iter; left time: 301.5718s
	iters: 800, epoch: 2 | loss: 0.1195042
	speed: 0.0402s/iter; left time: 295.7569s
	iters: 900, epoch: 2 | loss: 0.1323075
	speed: 0.0402s/iter; left time: 291.9731s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.65s
Steps: 906 | Train Loss: 0.1392018 Vali Loss: 0.0237769 Test Loss: 0.0260980
Validation loss decreased (0.032097 --> 0.023777).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1315212
	speed: 0.1001s/iter; left time: 715.8499s
	iters: 200, epoch: 3 | loss: 0.1110490
	speed: 0.0401s/iter; left time: 282.9053s
	iters: 300, epoch: 3 | loss: 0.1065218
	speed: 0.0291s/iter; left time: 202.2883s
	iters: 400, epoch: 3 | loss: 0.1213241
	speed: 0.0383s/iter; left time: 262.2273s
	iters: 500, epoch: 3 | loss: 0.1188660
	speed: 0.0405s/iter; left time: 273.1896s
	iters: 600, epoch: 3 | loss: 0.1148553
	speed: 0.0405s/iter; left time: 269.3065s
	iters: 700, epoch: 3 | loss: 0.1197077
	speed: 0.0405s/iter; left time: 264.9705s
	iters: 800, epoch: 3 | loss: 0.1219010
	speed: 0.0404s/iter; left time: 260.7640s
	iters: 900, epoch: 3 | loss: 0.1039494
	speed: 0.0405s/iter; left time: 256.8733s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:35.58s
Steps: 906 | Train Loss: 0.1192013 Vali Loss: 0.0214143 Test Loss: 0.0234998
Validation loss decreased (0.023777 --> 0.021414).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1082590
	speed: 0.0982s/iter; left time: 612.7569s
	iters: 200, epoch: 4 | loss: 0.1080726
	speed: 0.0404s/iter; left time: 248.1596s
	iters: 300, epoch: 4 | loss: 0.1309506
	speed: 0.0401s/iter; left time: 242.6160s
	iters: 400, epoch: 4 | loss: 0.1074475
	speed: 0.0404s/iter; left time: 240.3190s
	iters: 500, epoch: 4 | loss: 0.1255920
	speed: 0.0405s/iter; left time: 236.6144s
	iters: 600, epoch: 4 | loss: 0.1189473
	speed: 0.0404s/iter; left time: 232.2545s
	iters: 700, epoch: 4 | loss: 0.1094264
	speed: 0.0405s/iter; left time: 228.6138s
	iters: 800, epoch: 4 | loss: 0.0985998
	speed: 0.0403s/iter; left time: 223.6018s
	iters: 900, epoch: 4 | loss: 0.0951604
	speed: 0.0403s/iter; left time: 219.4881s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.86s
Steps: 906 | Train Loss: 0.1119296 Vali Loss: 0.0210033 Test Loss: 0.0229962
Validation loss decreased (0.021414 --> 0.021003).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1206323
	speed: 0.0990s/iter; left time: 528.6131s
	iters: 200, epoch: 5 | loss: 0.1025492
	speed: 0.0404s/iter; left time: 211.6194s
	iters: 300, epoch: 5 | loss: 0.0958860
	speed: 0.0404s/iter; left time: 207.6376s
	iters: 400, epoch: 5 | loss: 0.1053028
	speed: 0.0402s/iter; left time: 202.6268s
	iters: 500, epoch: 5 | loss: 0.0911213
	speed: 0.0404s/iter; left time: 199.2576s
	iters: 600, epoch: 5 | loss: 0.1147761
	speed: 0.0405s/iter; left time: 195.7160s
	iters: 700, epoch: 5 | loss: 0.0964720
	speed: 0.0403s/iter; left time: 191.0576s
	iters: 800, epoch: 5 | loss: 0.0956109
	speed: 0.0400s/iter; left time: 185.6283s
	iters: 900, epoch: 5 | loss: 0.1076336
	speed: 0.0404s/iter; left time: 183.2456s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.81s
Steps: 906 | Train Loss: 0.1052212 Vali Loss: 0.0230487 Test Loss: 0.0248546
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0975094
	speed: 0.0948s/iter; left time: 420.1575s
	iters: 200, epoch: 6 | loss: 0.1022177
	speed: 0.0401s/iter; left time: 173.8595s
	iters: 300, epoch: 6 | loss: 0.1188942
	speed: 0.0406s/iter; left time: 171.5672s
	iters: 400, epoch: 6 | loss: 0.1018972
	speed: 0.0402s/iter; left time: 166.1074s
	iters: 500, epoch: 6 | loss: 0.1062510
	speed: 0.0403s/iter; left time: 162.5884s
	iters: 600, epoch: 6 | loss: 0.0971001
	speed: 0.0404s/iter; left time: 158.6718s
	iters: 700, epoch: 6 | loss: 0.0943823
	speed: 0.0402s/iter; left time: 154.0495s
	iters: 800, epoch: 6 | loss: 0.0997844
	speed: 0.0403s/iter; left time: 150.3237s
	iters: 900, epoch: 6 | loss: 0.0909821
	speed: 0.0402s/iter; left time: 146.0435s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.78s
Steps: 906 | Train Loss: 0.0983646 Vali Loss: 0.0231138 Test Loss: 0.0255483
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1109275
	speed: 0.0874s/iter; left time: 307.9563s
	iters: 200, epoch: 7 | loss: 0.0878093
	speed: 0.0405s/iter; left time: 138.5610s
	iters: 300, epoch: 7 | loss: 0.0889100
	speed: 0.0401s/iter; left time: 133.2210s
	iters: 400, epoch: 7 | loss: 0.1003922
	speed: 0.0405s/iter; left time: 130.6618s
	iters: 500, epoch: 7 | loss: 0.0935495
	speed: 0.0402s/iter; left time: 125.5238s
	iters: 600, epoch: 7 | loss: 0.0867671
	speed: 0.0405s/iter; left time: 122.4342s
	iters: 700, epoch: 7 | loss: 0.0835018
	speed: 0.0403s/iter; left time: 117.8210s
	iters: 800, epoch: 7 | loss: 0.0924193
	speed: 0.0403s/iter; left time: 113.9270s
	iters: 900, epoch: 7 | loss: 0.0836910
	speed: 0.0403s/iter; left time: 109.9368s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.07s
Steps: 906 | Train Loss: 0.0906459 Vali Loss: 0.0246819 Test Loss: 0.0273251
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.022993577644228935, rmse:0.15163633227348328, mae:0.10003083199262619, rse:0.53550785779953
Original data scale mse:19474288.0, rmse:4412.96826171875, mae:2820.479248046875, rse:0.21942166984081268

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.025140458717942238, RMSE: 0.15855742990970612, MAE: 0.10656960308551788, RSE: 0.5599498748779297
Unscaled Metrics - MSE: 20226732.0, RMSE: 4497.4140625, MAE: 2958.59619140625, RSE: 0.2236204892396927

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.022993577644228935, RMSE: 0.15163633227348328, MAE: 0.10003083199262619, RSE: 0.53550785779953
Unscaled Metrics - MSE: 19474288.0, RMSE: 4412.96826171875, MAE: 2820.479248046875, RSE: 0.21942166984081268

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.3050602
	speed: 0.0737s/iter; left time: 658.6087s
	iters: 200, epoch: 1 | loss: 0.2792929
	speed: 0.0460s/iter; left time: 406.6971s
	iters: 300, epoch: 1 | loss: 0.2580291
	speed: 0.0461s/iter; left time: 402.5989s
	iters: 400, epoch: 1 | loss: 0.2379579
	speed: 0.0460s/iter; left time: 397.0572s
	iters: 500, epoch: 1 | loss: 0.2285644
	speed: 0.0459s/iter; left time: 391.7746s
	iters: 600, epoch: 1 | loss: 0.2200543
	speed: 0.0460s/iter; left time: 388.5672s
	iters: 700, epoch: 1 | loss: 0.2084320
	speed: 0.0448s/iter; left time: 373.9758s
	iters: 800, epoch: 1 | loss: 0.2090365
	speed: 0.0465s/iter; left time: 382.9380s
	iters: 900, epoch: 1 | loss: 0.2044081
	speed: 0.0463s/iter; left time: 377.0839s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.28s
Steps: 904 | Train Loss: 0.2474488 Vali Loss: 0.0465068 Test Loss: 0.0587189
Validation loss decreased (inf --> 0.046507).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1707423
	speed: 0.1133s/iter; left time: 910.5811s
	iters: 200, epoch: 2 | loss: 0.1756015
	speed: 0.0466s/iter; left time: 369.4824s
	iters: 300, epoch: 2 | loss: 0.1726436
	speed: 0.0461s/iter; left time: 361.1389s
	iters: 400, epoch: 2 | loss: 0.1585707
	speed: 0.0463s/iter; left time: 358.2750s
	iters: 500, epoch: 2 | loss: 0.1642121
	speed: 0.0462s/iter; left time: 352.6863s
	iters: 600, epoch: 2 | loss: 0.1724601
	speed: 0.0460s/iter; left time: 346.9188s
	iters: 700, epoch: 2 | loss: 0.1577658
	speed: 0.0460s/iter; left time: 341.9057s
	iters: 800, epoch: 2 | loss: 0.1684639
	speed: 0.0460s/iter; left time: 337.3998s
	iters: 900, epoch: 2 | loss: 0.1521902
	speed: 0.0462s/iter; left time: 334.6384s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.73s
Steps: 904 | Train Loss: 0.1675332 Vali Loss: 0.0336258 Test Loss: 0.0410545
Validation loss decreased (0.046507 --> 0.033626).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1651728
	speed: 0.1151s/iter; left time: 821.1560s
	iters: 200, epoch: 3 | loss: 0.1408958
	speed: 0.0364s/iter; left time: 255.7035s
	iters: 300, epoch: 3 | loss: 0.1396739
	speed: 0.0356s/iter; left time: 246.5449s
	iters: 400, epoch: 3 | loss: 0.1394162
	speed: 0.0356s/iter; left time: 243.0197s
	iters: 500, epoch: 3 | loss: 0.1471861
	speed: 0.0355s/iter; left time: 239.2227s
	iters: 600, epoch: 3 | loss: 0.1604891
	speed: 0.0356s/iter; left time: 235.8190s
	iters: 700, epoch: 3 | loss: 0.1398279
	speed: 0.0358s/iter; left time: 233.9649s
	iters: 800, epoch: 3 | loss: 0.1480567
	speed: 0.0356s/iter; left time: 228.7479s
	iters: 900, epoch: 3 | loss: 0.1475054
	speed: 0.0356s/iter; left time: 225.4845s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.44s
Steps: 904 | Train Loss: 0.1492850 Vali Loss: 0.0337527 Test Loss: 0.0420692
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1347107
	speed: 0.1007s/iter; left time: 627.4031s
	iters: 200, epoch: 4 | loss: 0.1328156
	speed: 0.0354s/iter; left time: 216.9679s
	iters: 300, epoch: 4 | loss: 0.1383835
	speed: 0.0370s/iter; left time: 223.1311s
	iters: 400, epoch: 4 | loss: 0.1231011
	speed: 0.0454s/iter; left time: 269.4154s
	iters: 500, epoch: 4 | loss: 0.1435674
	speed: 0.0465s/iter; left time: 271.1280s
	iters: 600, epoch: 4 | loss: 0.1305622
	speed: 0.0462s/iter; left time: 264.9370s
	iters: 700, epoch: 4 | loss: 0.1443142
	speed: 0.0459s/iter; left time: 258.2481s
	iters: 800, epoch: 4 | loss: 0.1291650
	speed: 0.0461s/iter; left time: 254.7399s
	iters: 900, epoch: 4 | loss: 0.1457163
	speed: 0.0451s/iter; left time: 244.6287s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.74s
Steps: 904 | Train Loss: 0.1390550 Vali Loss: 0.0356938 Test Loss: 0.0444108
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1368660
	speed: 0.1128s/iter; left time: 600.9106s
	iters: 200, epoch: 5 | loss: 0.1410505
	speed: 0.0457s/iter; left time: 238.8530s
	iters: 300, epoch: 5 | loss: 0.1253819
	speed: 0.0457s/iter; left time: 234.3564s
	iters: 400, epoch: 5 | loss: 0.1291719
	speed: 0.0456s/iter; left time: 229.1478s
	iters: 500, epoch: 5 | loss: 0.1253986
	speed: 0.0453s/iter; left time: 223.1407s
	iters: 600, epoch: 5 | loss: 0.1274677
	speed: 0.0458s/iter; left time: 221.0945s
	iters: 700, epoch: 5 | loss: 0.1198974
	speed: 0.0457s/iter; left time: 215.8800s
	iters: 800, epoch: 5 | loss: 0.1168309
	speed: 0.0463s/iter; left time: 214.1595s
	iters: 900, epoch: 5 | loss: 0.1229431
	speed: 0.0460s/iter; left time: 207.9647s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.61s
Steps: 904 | Train Loss: 0.1276485 Vali Loss: 0.0351315 Test Loss: 0.0445958
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04103325307369232, rmse:0.20256666839122772, mae:0.1448090672492981, rse:0.7173295021057129
Original data scale mse:36910216.0, rmse:6075.3779296875, mae:4103.126953125, rse:0.30255600810050964
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.3033006
	speed: 0.0477s/iter; left time: 426.2165s
	iters: 200, epoch: 1 | loss: 0.2656540
	speed: 0.0459s/iter; left time: 405.6163s
	iters: 300, epoch: 1 | loss: 0.2539203
	speed: 0.0463s/iter; left time: 404.5329s
	iters: 400, epoch: 1 | loss: 0.2405170
	speed: 0.0459s/iter; left time: 397.0012s
	iters: 500, epoch: 1 | loss: 0.2386315
	speed: 0.0456s/iter; left time: 389.4626s
	iters: 600, epoch: 1 | loss: 0.2180775
	speed: 0.0361s/iter; left time: 304.5332s
	iters: 700, epoch: 1 | loss: 0.2443407
	speed: 0.0355s/iter; left time: 295.7656s
	iters: 800, epoch: 1 | loss: 0.2130085
	speed: 0.0424s/iter; left time: 349.0225s
	iters: 900, epoch: 1 | loss: 0.2177016
	speed: 0.0382s/iter; left time: 310.6951s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.59s
Steps: 904 | Train Loss: 0.2510130 Vali Loss: 0.0469525 Test Loss: 0.0592683
Validation loss decreased (inf --> 0.046953).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1928810
	speed: 0.1161s/iter; left time: 932.7887s
	iters: 200, epoch: 2 | loss: 0.1737615
	speed: 0.0457s/iter; left time: 362.9286s
	iters: 300, epoch: 2 | loss: 0.1708919
	speed: 0.0482s/iter; left time: 377.9348s
	iters: 400, epoch: 2 | loss: 0.1574111
	speed: 0.0481s/iter; left time: 372.0721s
	iters: 500, epoch: 2 | loss: 0.1583550
	speed: 0.0475s/iter; left time: 362.9447s
	iters: 600, epoch: 2 | loss: 0.1736619
	speed: 0.0482s/iter; left time: 363.2644s
	iters: 700, epoch: 2 | loss: 0.1612795
	speed: 0.0473s/iter; left time: 351.4441s
	iters: 800, epoch: 2 | loss: 0.1629753
	speed: 0.0460s/iter; left time: 337.4098s
	iters: 900, epoch: 2 | loss: 0.1445371
	speed: 0.0440s/iter; left time: 318.4479s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.50s
Steps: 904 | Train Loss: 0.1683245 Vali Loss: 0.0335551 Test Loss: 0.0415100
Validation loss decreased (0.046953 --> 0.033555).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1596928
	speed: 0.1151s/iter; left time: 821.3490s
	iters: 200, epoch: 3 | loss: 0.1593727
	speed: 0.0446s/iter; left time: 313.4323s
	iters: 300, epoch: 3 | loss: 0.1426084
	speed: 0.0457s/iter; left time: 317.1663s
	iters: 400, epoch: 3 | loss: 0.1490009
	speed: 0.0464s/iter; left time: 316.7997s
	iters: 500, epoch: 3 | loss: 0.1475351
	speed: 0.0459s/iter; left time: 308.8553s
	iters: 600, epoch: 3 | loss: 0.1512032
	speed: 0.0459s/iter; left time: 304.5008s
	iters: 700, epoch: 3 | loss: 0.1463389
	speed: 0.0459s/iter; left time: 300.1654s
	iters: 800, epoch: 3 | loss: 0.1608187
	speed: 0.0459s/iter; left time: 295.3685s
	iters: 900, epoch: 3 | loss: 0.1560631
	speed: 0.0459s/iter; left time: 290.4734s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.69s
Steps: 904 | Train Loss: 0.1491675 Vali Loss: 0.0331871 Test Loss: 0.0418654
Validation loss decreased (0.033555 --> 0.033187).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1472884
	speed: 0.1147s/iter; left time: 714.7154s
	iters: 200, epoch: 4 | loss: 0.1476162
	speed: 0.0456s/iter; left time: 279.2834s
	iters: 300, epoch: 4 | loss: 0.1375844
	speed: 0.0453s/iter; left time: 272.9867s
	iters: 400, epoch: 4 | loss: 0.1338737
	speed: 0.0455s/iter; left time: 269.9514s
	iters: 500, epoch: 4 | loss: 0.1385023
	speed: 0.0454s/iter; left time: 264.6499s
	iters: 600, epoch: 4 | loss: 0.1450797
	speed: 0.0484s/iter; left time: 277.0158s
	iters: 700, epoch: 4 | loss: 0.1402115
	speed: 0.0477s/iter; left time: 268.2994s
	iters: 800, epoch: 4 | loss: 0.1368200
	speed: 0.0484s/iter; left time: 267.7397s
	iters: 900, epoch: 4 | loss: 0.1321137
	speed: 0.0464s/iter; left time: 251.8197s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.18s
Steps: 904 | Train Loss: 0.1401779 Vali Loss: 0.0347146 Test Loss: 0.0455525
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1162099
	speed: 0.1022s/iter; left time: 544.0194s
	iters: 200, epoch: 5 | loss: 0.1308444
	speed: 0.0356s/iter; left time: 185.9915s
	iters: 300, epoch: 5 | loss: 0.1344330
	speed: 0.0355s/iter; left time: 181.7817s
	iters: 400, epoch: 5 | loss: 0.1229379
	speed: 0.0355s/iter; left time: 178.5082s
	iters: 500, epoch: 5 | loss: 0.1343827
	speed: 0.0355s/iter; left time: 174.6194s
	iters: 600, epoch: 5 | loss: 0.1198288
	speed: 0.0424s/iter; left time: 204.6855s
	iters: 700, epoch: 5 | loss: 0.1365760
	speed: 0.0476s/iter; left time: 224.8928s
	iters: 800, epoch: 5 | loss: 0.1273134
	speed: 0.0484s/iter; left time: 223.9163s
	iters: 900, epoch: 5 | loss: 0.1240884
	speed: 0.0478s/iter; left time: 216.2812s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.91s
Steps: 904 | Train Loss: 0.1306954 Vali Loss: 0.0344826 Test Loss: 0.0431674
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1184841
	speed: 0.1132s/iter; left time: 500.4423s
	iters: 200, epoch: 6 | loss: 0.1300571
	speed: 0.0483s/iter; left time: 208.6160s
	iters: 300, epoch: 6 | loss: 0.1251907
	speed: 0.0459s/iter; left time: 193.7045s
	iters: 400, epoch: 6 | loss: 0.1189657
	speed: 0.0453s/iter; left time: 186.5466s
	iters: 500, epoch: 6 | loss: 0.1225212
	speed: 0.0433s/iter; left time: 174.2603s
	iters: 600, epoch: 6 | loss: 0.1154039
	speed: 0.0460s/iter; left time: 180.3079s
	iters: 700, epoch: 6 | loss: 0.1176639
	speed: 0.0456s/iter; left time: 174.3190s
	iters: 800, epoch: 6 | loss: 0.1150488
	speed: 0.0462s/iter; left time: 171.7705s
	iters: 900, epoch: 6 | loss: 0.1111033
	speed: 0.0459s/iter; left time: 166.1618s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.73s
Steps: 904 | Train Loss: 0.1199580 Vali Loss: 0.0392481 Test Loss: 0.0465440
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04188527911901474, rmse:0.20465894043445587, mae:0.1424560695886612, rse:0.7247387170791626
Original data scale mse:38137348.0, rmse:6175.54443359375, mae:4037.75927734375, rse:0.3075443208217621

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.04103325307369232, RMSE: 0.20256666839122772, MAE: 0.1448090672492981, RSE: 0.7173295021057129
Unscaled Metrics - MSE: 36910216.0, RMSE: 6075.3779296875, MAE: 4103.126953125, RSE: 0.30255600810050964

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.04188527911901474, RMSE: 0.20465894043445587, MAE: 0.1424560695886612, RSE: 0.7247387170791626
Unscaled Metrics - MSE: 38137348.0, RMSE: 6175.54443359375, MAE: 4037.75927734375, RSE: 0.3075443208217621

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2926495
	speed: 0.0780s/iter; left time: 695.6896s
	iters: 200, epoch: 1 | loss: 0.2759382
	speed: 0.0519s/iter; left time: 457.6151s
	iters: 300, epoch: 1 | loss: 0.2516454
	speed: 0.0522s/iter; left time: 455.0498s
	iters: 400, epoch: 1 | loss: 0.2446894
	speed: 0.0518s/iter; left time: 446.3239s
	iters: 500, epoch: 1 | loss: 0.2390247
	speed: 0.0515s/iter; left time: 438.8017s
	iters: 600, epoch: 1 | loss: 0.2378901
	speed: 0.0525s/iter; left time: 442.1942s
	iters: 700, epoch: 1 | loss: 0.2287076
	speed: 0.0523s/iter; left time: 435.5581s
	iters: 800, epoch: 1 | loss: 0.2237932
	speed: 0.0520s/iter; left time: 427.2995s
	iters: 900, epoch: 1 | loss: 0.2274978
	speed: 0.0521s/iter; left time: 423.3652s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.64s
Steps: 902 | Train Loss: 0.2537300 Vali Loss: 0.0554739 Test Loss: 0.0720860
Validation loss decreased (inf --> 0.055474).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2111945
	speed: 0.1318s/iter; left time: 1056.9175s
	iters: 200, epoch: 2 | loss: 0.1888788
	speed: 0.0527s/iter; left time: 417.1057s
	iters: 300, epoch: 2 | loss: 0.2003660
	speed: 0.0523s/iter; left time: 408.5794s
	iters: 400, epoch: 2 | loss: 0.1833679
	speed: 0.0523s/iter; left time: 403.4089s
	iters: 500, epoch: 2 | loss: 0.1778117
	speed: 0.0527s/iter; left time: 401.3266s
	iters: 600, epoch: 2 | loss: 0.1675996
	speed: 0.0525s/iter; left time: 394.7089s
	iters: 700, epoch: 2 | loss: 0.1670957
	speed: 0.0524s/iter; left time: 388.9504s
	iters: 800, epoch: 2 | loss: 0.1790987
	speed: 0.0524s/iter; left time: 383.4868s
	iters: 900, epoch: 2 | loss: 0.1498518
	speed: 0.0523s/iter; left time: 377.8162s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.52s
Steps: 902 | Train Loss: 0.1816401 Vali Loss: 0.0353314 Test Loss: 0.0436157
Validation loss decreased (0.055474 --> 0.035331).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1658780
	speed: 0.1327s/iter; left time: 944.3623s
	iters: 200, epoch: 3 | loss: 0.1539436
	speed: 0.0522s/iter; left time: 366.1980s
	iters: 300, epoch: 3 | loss: 0.1573724
	speed: 0.0522s/iter; left time: 360.9157s
	iters: 400, epoch: 3 | loss: 0.1706105
	speed: 0.0520s/iter; left time: 354.5194s
	iters: 500, epoch: 3 | loss: 0.1472732
	speed: 0.0523s/iter; left time: 351.3927s
	iters: 600, epoch: 3 | loss: 0.1535669
	speed: 0.0523s/iter; left time: 346.1665s
	iters: 700, epoch: 3 | loss: 0.1553864
	speed: 0.0523s/iter; left time: 341.1597s
	iters: 800, epoch: 3 | loss: 0.1544610
	speed: 0.0521s/iter; left time: 334.1136s
	iters: 900, epoch: 3 | loss: 0.1476951
	speed: 0.0523s/iter; left time: 330.5126s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.34s
Steps: 902 | Train Loss: 0.1532935 Vali Loss: 0.0348557 Test Loss: 0.0415470
Validation loss decreased (0.035331 --> 0.034856).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1365672
	speed: 0.1325s/iter; left time: 823.7864s
	iters: 200, epoch: 4 | loss: 0.1337031
	speed: 0.0520s/iter; left time: 317.8711s
	iters: 300, epoch: 4 | loss: 0.1502062
	speed: 0.0524s/iter; left time: 315.0304s
	iters: 400, epoch: 4 | loss: 0.1468889
	speed: 0.0524s/iter; left time: 309.9373s
	iters: 500, epoch: 4 | loss: 0.1529484
	speed: 0.0528s/iter; left time: 306.8908s
	iters: 600, epoch: 4 | loss: 0.1329334
	speed: 0.0521s/iter; left time: 297.6829s
	iters: 700, epoch: 4 | loss: 0.1536939
	speed: 0.0523s/iter; left time: 293.8271s
	iters: 800, epoch: 4 | loss: 0.1441478
	speed: 0.0521s/iter; left time: 287.3117s
	iters: 900, epoch: 4 | loss: 0.1344999
	speed: 0.0521s/iter; left time: 282.3607s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.36s
Steps: 902 | Train Loss: 0.1418212 Vali Loss: 0.0379184 Test Loss: 0.0469089
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1399765
	speed: 0.1301s/iter; left time: 691.4105s
	iters: 200, epoch: 5 | loss: 0.1334775
	speed: 0.0521s/iter; left time: 271.7324s
	iters: 300, epoch: 5 | loss: 0.1285665
	speed: 0.0524s/iter; left time: 268.1108s
	iters: 400, epoch: 5 | loss: 0.1392056
	speed: 0.0523s/iter; left time: 262.4170s
	iters: 500, epoch: 5 | loss: 0.1215379
	speed: 0.0517s/iter; left time: 253.9828s
	iters: 600, epoch: 5 | loss: 0.1303193
	speed: 0.0521s/iter; left time: 250.5883s
	iters: 700, epoch: 5 | loss: 0.1267691
	speed: 0.0525s/iter; left time: 247.3406s
	iters: 800, epoch: 5 | loss: 0.1245160
	speed: 0.0526s/iter; left time: 242.5474s
	iters: 900, epoch: 5 | loss: 0.1172705
	speed: 0.0524s/iter; left time: 236.6848s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.37s
Steps: 902 | Train Loss: 0.1298998 Vali Loss: 0.0396953 Test Loss: 0.0485864
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1218988
	speed: 0.1289s/iter; left time: 568.3900s
	iters: 200, epoch: 6 | loss: 0.1267436
	speed: 0.0524s/iter; left time: 225.7244s
	iters: 300, epoch: 6 | loss: 0.1143450
	speed: 0.0524s/iter; left time: 220.6757s
	iters: 400, epoch: 6 | loss: 0.1284699
	speed: 0.0522s/iter; left time: 214.4979s
	iters: 500, epoch: 6 | loss: 0.1149280
	speed: 0.0524s/iter; left time: 210.3371s
	iters: 600, epoch: 6 | loss: 0.1126125
	speed: 0.0522s/iter; left time: 203.9725s
	iters: 700, epoch: 6 | loss: 0.1189998
	speed: 0.0522s/iter; left time: 198.8536s
	iters: 800, epoch: 6 | loss: 0.1114934
	speed: 0.0519s/iter; left time: 192.7135s
	iters: 900, epoch: 6 | loss: 0.1228147
	speed: 0.0517s/iter; left time: 186.5777s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.25s
Steps: 902 | Train Loss: 0.1195825 Vali Loss: 0.0401932 Test Loss: 0.0509725
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.041561320424079895, rmse:0.2038659304380417, mae:0.14510895311832428, rse:0.7222356200218201
Original data scale mse:38455032.0, rmse:6201.2119140625, mae:4132.53271484375, rse:0.30897417664527893
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.3113247
	speed: 0.0543s/iter; left time: 484.5639s
	iters: 200, epoch: 1 | loss: 0.2668369
	speed: 0.0522s/iter; left time: 460.3312s
	iters: 300, epoch: 1 | loss: 0.2556839
	speed: 0.0524s/iter; left time: 456.5798s
	iters: 400, epoch: 1 | loss: 0.2252100
	speed: 0.0524s/iter; left time: 451.4172s
	iters: 500, epoch: 1 | loss: 0.2424131
	speed: 0.0520s/iter; left time: 442.9054s
	iters: 600, epoch: 1 | loss: 0.2288676
	speed: 0.0523s/iter; left time: 440.5027s
	iters: 700, epoch: 1 | loss: 0.2255107
	speed: 0.0524s/iter; left time: 436.0923s
	iters: 800, epoch: 1 | loss: 0.2196986
	speed: 0.0517s/iter; left time: 425.3780s
	iters: 900, epoch: 1 | loss: 0.2234770
	speed: 0.0522s/iter; left time: 423.6573s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.36s
Steps: 902 | Train Loss: 0.2539692 Vali Loss: 0.0544385 Test Loss: 0.0711512
Validation loss decreased (inf --> 0.054439).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2002301
	speed: 0.1441s/iter; left time: 1155.2509s
	iters: 200, epoch: 2 | loss: 0.1902201
	speed: 0.0520s/iter; left time: 411.8140s
	iters: 300, epoch: 2 | loss: 0.1814798
	speed: 0.0523s/iter; left time: 408.7018s
	iters: 400, epoch: 2 | loss: 0.1707954
	speed: 0.0518s/iter; left time: 399.5654s
	iters: 500, epoch: 2 | loss: 0.1734090
	speed: 0.0521s/iter; left time: 396.8823s
	iters: 600, epoch: 2 | loss: 0.1803765
	speed: 0.0517s/iter; left time: 388.6235s
	iters: 700, epoch: 2 | loss: 0.1676639
	speed: 0.0518s/iter; left time: 384.5062s
	iters: 800, epoch: 2 | loss: 0.1515651
	speed: 0.0522s/iter; left time: 382.1448s
	iters: 900, epoch: 2 | loss: 0.1576114
	speed: 0.0516s/iter; left time: 372.7957s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.06s
Steps: 902 | Train Loss: 0.1831233 Vali Loss: 0.0411337 Test Loss: 0.0487919
Validation loss decreased (0.054439 --> 0.041134).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1539670
	speed: 0.1384s/iter; left time: 984.8019s
	iters: 200, epoch: 3 | loss: 0.1628677
	speed: 0.0526s/iter; left time: 369.1374s
	iters: 300, epoch: 3 | loss: 0.1688538
	speed: 0.0523s/iter; left time: 362.0196s
	iters: 400, epoch: 3 | loss: 0.1600339
	speed: 0.0524s/iter; left time: 357.3456s
	iters: 500, epoch: 3 | loss: 0.1580702
	speed: 0.0522s/iter; left time: 350.4851s
	iters: 600, epoch: 3 | loss: 0.1543265
	speed: 0.0520s/iter; left time: 344.3259s
	iters: 700, epoch: 3 | loss: 0.1496884
	speed: 0.0522s/iter; left time: 339.9516s
	iters: 800, epoch: 3 | loss: 0.1444830
	speed: 0.0522s/iter; left time: 334.6945s
	iters: 900, epoch: 3 | loss: 0.1467203
	speed: 0.0520s/iter; left time: 328.6034s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.33s
Steps: 902 | Train Loss: 0.1542953 Vali Loss: 0.0354638 Test Loss: 0.0431497
Validation loss decreased (0.041134 --> 0.035464).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1480040
	speed: 0.1329s/iter; left time: 826.0701s
	iters: 200, epoch: 4 | loss: 0.1369039
	speed: 0.0524s/iter; left time: 320.5149s
	iters: 300, epoch: 4 | loss: 0.1432847
	speed: 0.0522s/iter; left time: 313.7214s
	iters: 400, epoch: 4 | loss: 0.1397676
	speed: 0.0524s/iter; left time: 310.0423s
	iters: 500, epoch: 4 | loss: 0.1429798
	speed: 0.0523s/iter; left time: 304.1592s
	iters: 600, epoch: 4 | loss: 0.1483091
	speed: 0.0522s/iter; left time: 298.5825s
	iters: 700, epoch: 4 | loss: 0.1336518
	speed: 0.0521s/iter; left time: 292.3265s
	iters: 800, epoch: 4 | loss: 0.1385359
	speed: 0.0519s/iter; left time: 285.9971s
	iters: 900, epoch: 4 | loss: 0.1367240
	speed: 0.0519s/iter; left time: 281.1080s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.32s
Steps: 902 | Train Loss: 0.1427702 Vali Loss: 0.0372985 Test Loss: 0.0459323
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1259555
	speed: 0.1285s/iter; left time: 682.6808s
	iters: 200, epoch: 5 | loss: 0.1316517
	speed: 0.0520s/iter; left time: 271.0694s
	iters: 300, epoch: 5 | loss: 0.1307634
	speed: 0.0524s/iter; left time: 267.7164s
	iters: 400, epoch: 5 | loss: 0.1369316
	speed: 0.0522s/iter; left time: 261.6954s
	iters: 500, epoch: 5 | loss: 0.1391668
	speed: 0.0524s/iter; left time: 257.5682s
	iters: 600, epoch: 5 | loss: 0.1236826
	speed: 0.0523s/iter; left time: 251.7794s
	iters: 700, epoch: 5 | loss: 0.1305160
	speed: 0.0523s/iter; left time: 246.6655s
	iters: 800, epoch: 5 | loss: 0.1278001
	speed: 0.0524s/iter; left time: 241.6628s
	iters: 900, epoch: 5 | loss: 0.1261872
	speed: 0.0523s/iter; left time: 236.2208s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.32s
Steps: 902 | Train Loss: 0.1319320 Vali Loss: 0.0381629 Test Loss: 0.0498999
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1268972
	speed: 0.1287s/iter; left time: 567.8623s
	iters: 200, epoch: 6 | loss: 0.1211389
	speed: 0.0524s/iter; left time: 225.8130s
	iters: 300, epoch: 6 | loss: 0.1249150
	speed: 0.0523s/iter; left time: 220.0594s
	iters: 400, epoch: 6 | loss: 0.1167591
	speed: 0.0527s/iter; left time: 216.5284s
	iters: 500, epoch: 6 | loss: 0.1198143
	speed: 0.0531s/iter; left time: 213.0714s
	iters: 600, epoch: 6 | loss: 0.1263515
	speed: 0.0526s/iter; left time: 205.6764s
	iters: 700, epoch: 6 | loss: 0.1237719
	speed: 0.0524s/iter; left time: 199.5570s
	iters: 800, epoch: 6 | loss: 0.1125178
	speed: 0.0523s/iter; left time: 194.1103s
	iters: 900, epoch: 6 | loss: 0.1126838
	speed: 0.0523s/iter; left time: 189.0138s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.52s
Steps: 902 | Train Loss: 0.1220499 Vali Loss: 0.0388611 Test Loss: 0.0490557
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04315508157014847, rmse:0.2077380120754242, mae:0.1485593318939209, rse:0.7359532117843628
Original data scale mse:40330176.0, rmse:6350.6044921875, mae:4271.23583984375, rse:0.3164176046848297

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.041561320424079895, RMSE: 0.2038659304380417, MAE: 0.14510895311832428, RSE: 0.7222356200218201
Unscaled Metrics - MSE: 38455032.0, RMSE: 6201.2119140625, MAE: 4132.53271484375, RSE: 0.30897417664527893

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.04315508157014847, RMSE: 0.2077380120754242, MAE: 0.1485593318939209, RSE: 0.7359532117843628
Unscaled Metrics - MSE: 40330176.0, RMSE: 6350.6044921875, MAE: 4271.23583984375, RSE: 0.3164176046848297

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2242578
	speed: 0.0670s/iter; left time: 600.2598s
	iters: 200, epoch: 1 | loss: 0.1898357
	speed: 0.0404s/iter; left time: 357.9292s
	iters: 300, epoch: 1 | loss: 0.1789733
	speed: 0.0397s/iter; left time: 347.5529s
	iters: 400, epoch: 1 | loss: 0.1563358
	speed: 0.0405s/iter; left time: 350.3857s
	iters: 500, epoch: 1 | loss: 0.1528879
	speed: 0.0400s/iter; left time: 342.6619s
	iters: 600, epoch: 1 | loss: 0.1442027
	speed: 0.0397s/iter; left time: 336.2437s
	iters: 700, epoch: 1 | loss: 0.1612527
	speed: 0.0404s/iter; left time: 337.4610s
	iters: 800, epoch: 1 | loss: 0.1469584
	speed: 0.0404s/iter; left time: 333.4733s
	iters: 900, epoch: 1 | loss: 0.1317047
	speed: 0.0401s/iter; left time: 327.5772s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.14s
Steps: 906 | Train Loss: 0.1751491 Vali Loss: 0.1478380 Test Loss: 0.1567377
Validation loss decreased (inf --> 0.147838).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1182877
	speed: 0.0992s/iter; left time: 799.2347s
	iters: 200, epoch: 2 | loss: 0.1345648
	speed: 0.0405s/iter; left time: 322.1027s
	iters: 300, epoch: 2 | loss: 0.1065895
	speed: 0.0403s/iter; left time: 316.6996s
	iters: 400, epoch: 2 | loss: 0.0933015
	speed: 0.0401s/iter; left time: 310.7681s
	iters: 500, epoch: 2 | loss: 0.0904975
	speed: 0.0407s/iter; left time: 311.1995s
	iters: 600, epoch: 2 | loss: 0.0893114
	speed: 0.0404s/iter; left time: 305.5590s
	iters: 700, epoch: 2 | loss: 0.0859625
	speed: 0.0404s/iter; left time: 301.3663s
	iters: 800, epoch: 2 | loss: 0.1043300
	speed: 0.0402s/iter; left time: 295.8961s
	iters: 900, epoch: 2 | loss: 0.0872503
	speed: 0.0403s/iter; left time: 292.7381s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.79s
Steps: 906 | Train Loss: 0.1040518 Vali Loss: 0.0984693 Test Loss: 0.1067379
Validation loss decreased (0.147838 --> 0.098469).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.0818719
	speed: 0.0988s/iter; left time: 706.4776s
	iters: 200, epoch: 3 | loss: 0.0733229
	speed: 0.0404s/iter; left time: 284.9547s
	iters: 300, epoch: 3 | loss: 0.0786101
	speed: 0.0396s/iter; left time: 275.2136s
	iters: 400, epoch: 3 | loss: 0.0841790
	speed: 0.0405s/iter; left time: 277.0523s
	iters: 500, epoch: 3 | loss: 0.0886876
	speed: 0.0405s/iter; left time: 273.4483s
	iters: 600, epoch: 3 | loss: 0.0879167
	speed: 0.0401s/iter; left time: 266.4143s
	iters: 700, epoch: 3 | loss: 0.0797993
	speed: 0.0404s/iter; left time: 264.3068s
	iters: 800, epoch: 3 | loss: 0.0734361
	speed: 0.0404s/iter; left time: 260.6956s
	iters: 900, epoch: 3 | loss: 0.0759469
	speed: 0.0399s/iter; left time: 253.4332s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.66s
Steps: 906 | Train Loss: 0.0804971 Vali Loss: 0.0948412 Test Loss: 0.0987356
Validation loss decreased (0.098469 --> 0.094841).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0642318
	speed: 0.0970s/iter; left time: 605.3061s
	iters: 200, epoch: 4 | loss: 0.0718670
	speed: 0.0401s/iter; left time: 246.5804s
	iters: 300, epoch: 4 | loss: 0.0737519
	speed: 0.0405s/iter; left time: 244.5368s
	iters: 400, epoch: 4 | loss: 0.0626771
	speed: 0.0401s/iter; left time: 238.0233s
	iters: 500, epoch: 4 | loss: 0.0802833
	speed: 0.0404s/iter; left time: 236.2427s
	iters: 600, epoch: 4 | loss: 0.0729032
	speed: 0.0407s/iter; left time: 233.4550s
	iters: 700, epoch: 4 | loss: 0.0714076
	speed: 0.0403s/iter; left time: 227.4190s
	iters: 800, epoch: 4 | loss: 0.0793254
	speed: 0.0405s/iter; left time: 224.2882s
	iters: 900, epoch: 4 | loss: 0.0715816
	speed: 0.0404s/iter; left time: 220.1565s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.85s
Steps: 906 | Train Loss: 0.0747579 Vali Loss: 0.0942132 Test Loss: 0.0991149
Validation loss decreased (0.094841 --> 0.094213).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0734457
	speed: 0.1005s/iter; left time: 536.5463s
	iters: 200, epoch: 5 | loss: 0.0635436
	speed: 0.0404s/iter; left time: 211.6336s
	iters: 300, epoch: 5 | loss: 0.0630266
	speed: 0.0403s/iter; left time: 207.2045s
	iters: 400, epoch: 5 | loss: 0.0745912
	speed: 0.0403s/iter; left time: 203.1131s
	iters: 500, epoch: 5 | loss: 0.0656142
	speed: 0.0403s/iter; left time: 199.1101s
	iters: 600, epoch: 5 | loss: 0.0726853
	speed: 0.0404s/iter; left time: 195.5516s
	iters: 700, epoch: 5 | loss: 0.0620390
	speed: 0.0403s/iter; left time: 190.9909s
	iters: 800, epoch: 5 | loss: 0.0712027
	speed: 0.0404s/iter; left time: 187.5140s
	iters: 900, epoch: 5 | loss: 0.0770849
	speed: 0.0404s/iter; left time: 183.3355s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.82s
Steps: 906 | Train Loss: 0.0701890 Vali Loss: 0.0943323 Test Loss: 0.1031515
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0754840
	speed: 0.0930s/iter; left time: 412.0697s
	iters: 200, epoch: 6 | loss: 0.0691707
	speed: 0.0398s/iter; left time: 172.4944s
	iters: 300, epoch: 6 | loss: 0.0682686
	speed: 0.0400s/iter; left time: 169.3121s
	iters: 400, epoch: 6 | loss: 0.0671632
	speed: 0.0401s/iter; left time: 165.6750s
	iters: 500, epoch: 6 | loss: 0.0660435
	speed: 0.0387s/iter; left time: 155.9670s
	iters: 600, epoch: 6 | loss: 0.0615367
	speed: 0.0402s/iter; left time: 158.1539s
	iters: 700, epoch: 6 | loss: 0.0730367
	speed: 0.0401s/iter; left time: 153.4629s
	iters: 800, epoch: 6 | loss: 0.0604000
	speed: 0.0403s/iter; left time: 150.3161s
	iters: 900, epoch: 6 | loss: 0.0591007
	speed: 0.0403s/iter; left time: 146.4549s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.41s
Steps: 906 | Train Loss: 0.0658827 Vali Loss: 0.0926875 Test Loss: 0.1001576
Validation loss decreased (0.094213 --> 0.092688).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0595968
	speed: 0.1011s/iter; left time: 356.4838s
	iters: 200, epoch: 7 | loss: 0.0638212
	speed: 0.0403s/iter; left time: 138.1767s
	iters: 300, epoch: 7 | loss: 0.0653568
	speed: 0.0404s/iter; left time: 134.4435s
	iters: 400, epoch: 7 | loss: 0.0698452
	speed: 0.0402s/iter; left time: 129.6803s
	iters: 500, epoch: 7 | loss: 0.0636178
	speed: 0.0395s/iter; left time: 123.4286s
	iters: 600, epoch: 7 | loss: 0.0604861
	speed: 0.0403s/iter; left time: 121.9569s
	iters: 700, epoch: 7 | loss: 0.0573631
	speed: 0.0404s/iter; left time: 118.2828s
	iters: 800, epoch: 7 | loss: 0.0619043
	speed: 0.0400s/iter; left time: 113.0869s
	iters: 900, epoch: 7 | loss: 0.0663653
	speed: 0.0404s/iter; left time: 109.9718s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.66s
Steps: 906 | Train Loss: 0.0620958 Vali Loss: 0.0929043 Test Loss: 0.1012591
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0586540
	speed: 0.0942s/iter; left time: 246.8036s
	iters: 200, epoch: 8 | loss: 0.0570356
	speed: 0.0402s/iter; left time: 101.3024s
	iters: 300, epoch: 8 | loss: 0.0614286
	speed: 0.0404s/iter; left time: 97.7675s
	iters: 400, epoch: 8 | loss: 0.0557369
	speed: 0.0403s/iter; left time: 93.4820s
	iters: 500, epoch: 8 | loss: 0.0580302
	speed: 0.0401s/iter; left time: 89.0883s
	iters: 600, epoch: 8 | loss: 0.0533425
	speed: 0.0403s/iter; left time: 85.3482s
	iters: 700, epoch: 8 | loss: 0.0671045
	speed: 0.0401s/iter; left time: 81.0212s
	iters: 800, epoch: 8 | loss: 0.0617950
	speed: 0.0405s/iter; left time: 77.6511s
	iters: 900, epoch: 8 | loss: 0.0624347
	speed: 0.0403s/iter; left time: 73.3857s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:36.75s
Steps: 906 | Train Loss: 0.0588377 Vali Loss: 0.0950490 Test Loss: 0.1016366
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.0547856
	speed: 0.0940s/iter; left time: 161.0184s
	iters: 200, epoch: 9 | loss: 0.0544514
	speed: 0.0401s/iter; left time: 64.6507s
	iters: 300, epoch: 9 | loss: 0.0549416
	speed: 0.0403s/iter; left time: 61.0202s
	iters: 400, epoch: 9 | loss: 0.0452026
	speed: 0.0405s/iter; left time: 57.2221s
	iters: 500, epoch: 9 | loss: 0.0623649
	speed: 0.0406s/iter; left time: 53.3409s
	iters: 600, epoch: 9 | loss: 0.0527327
	speed: 0.0404s/iter; left time: 48.9741s
	iters: 700, epoch: 9 | loss: 0.0464450
	speed: 0.0405s/iter; left time: 45.0229s
	iters: 800, epoch: 9 | loss: 0.0578498
	speed: 0.0401s/iter; left time: 40.6234s
	iters: 900, epoch: 9 | loss: 0.0538073
	speed: 0.0403s/iter; left time: 36.8147s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:36.80s
Steps: 906 | Train Loss: 0.0553605 Vali Loss: 0.0962622 Test Loss: 0.1036498
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.02428990602493286, rmse:0.15585219860076904, mae:0.10028143227100372, rse:0.5503962635993958
Original data scale mse:21054224.0, rmse:4588.48828125, mae:2843.177734375, rse:0.22814887762069702
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.2398754
	speed: 0.0420s/iter; left time: 375.9936s
	iters: 200, epoch: 1 | loss: 0.1856430
	speed: 0.0404s/iter; left time: 358.3269s
	iters: 300, epoch: 1 | loss: 0.1713152
	speed: 0.0402s/iter; left time: 352.3429s
	iters: 400, epoch: 1 | loss: 0.1687666
	speed: 0.0403s/iter; left time: 348.9417s
	iters: 500, epoch: 1 | loss: 0.1446649
	speed: 0.0402s/iter; left time: 344.3009s
	iters: 600, epoch: 1 | loss: 0.1513872
	speed: 0.0404s/iter; left time: 341.5249s
	iters: 700, epoch: 1 | loss: 0.1499691
	speed: 0.0404s/iter; left time: 337.6440s
	iters: 800, epoch: 1 | loss: 0.1507011
	speed: 0.0405s/iter; left time: 334.1786s
	iters: 900, epoch: 1 | loss: 0.1491221
	speed: 0.0404s/iter; left time: 329.8803s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:36.78s
Steps: 906 | Train Loss: 0.1721454 Vali Loss: 0.1453274 Test Loss: 0.1554676
Validation loss decreased (inf --> 0.145327).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1367854
	speed: 0.0856s/iter; left time: 689.6735s
	iters: 200, epoch: 2 | loss: 0.1436689
	speed: 0.0352s/iter; left time: 279.9704s
	iters: 300, epoch: 2 | loss: 0.1178042
	speed: 0.0403s/iter; left time: 316.8240s
	iters: 400, epoch: 2 | loss: 0.1216650
	speed: 0.0404s/iter; left time: 313.5754s
	iters: 500, epoch: 2 | loss: 0.1117384
	speed: 0.0402s/iter; left time: 307.4658s
	iters: 600, epoch: 2 | loss: 0.1006765
	speed: 0.0405s/iter; left time: 305.6935s
	iters: 700, epoch: 2 | loss: 0.1048252
	speed: 0.0404s/iter; left time: 300.8928s
	iters: 800, epoch: 2 | loss: 0.1010501
	speed: 0.0407s/iter; left time: 299.0531s
	iters: 900, epoch: 2 | loss: 0.0956941
	speed: 0.0301s/iter; left time: 218.5190s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:34.02s
Steps: 906 | Train Loss: 0.1168003 Vali Loss: 0.1239653 Test Loss: 0.1346233
Validation loss decreased (0.145327 --> 0.123965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1117251
	speed: 0.0954s/iter; left time: 682.1296s
	iters: 200, epoch: 3 | loss: 0.0945623
	speed: 0.0404s/iter; left time: 285.0884s
	iters: 300, epoch: 3 | loss: 0.1088686
	speed: 0.0405s/iter; left time: 281.2017s
	iters: 400, epoch: 3 | loss: 0.1032642
	speed: 0.0405s/iter; left time: 277.2312s
	iters: 500, epoch: 3 | loss: 0.1057146
	speed: 0.0392s/iter; left time: 264.8624s
	iters: 600, epoch: 3 | loss: 0.1101636
	speed: 0.0405s/iter; left time: 269.3090s
	iters: 700, epoch: 3 | loss: 0.0980100
	speed: 0.0405s/iter; left time: 264.9444s
	iters: 800, epoch: 3 | loss: 0.0908421
	speed: 0.0405s/iter; left time: 260.9343s
	iters: 900, epoch: 3 | loss: 0.0937770
	speed: 0.0402s/iter; left time: 255.0502s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.72s
Steps: 906 | Train Loss: 0.0995902 Vali Loss: 0.1212749 Test Loss: 0.1346379
Validation loss decreased (0.123965 --> 0.121275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0892682
	speed: 0.0975s/iter; left time: 608.6661s
	iters: 200, epoch: 4 | loss: 0.0957315
	speed: 0.0403s/iter; left time: 247.3064s
	iters: 300, epoch: 4 | loss: 0.1004061
	speed: 0.0393s/iter; left time: 237.6804s
	iters: 400, epoch: 4 | loss: 0.0986237
	speed: 0.0405s/iter; left time: 240.5130s
	iters: 500, epoch: 4 | loss: 0.1025814
	speed: 0.0404s/iter; left time: 236.2193s
	iters: 600, epoch: 4 | loss: 0.0974615
	speed: 0.0404s/iter; left time: 232.2968s
	iters: 700, epoch: 4 | loss: 0.0962705
	speed: 0.0399s/iter; left time: 225.1923s
	iters: 800, epoch: 4 | loss: 0.1142599
	speed: 0.0400s/iter; left time: 221.5276s
	iters: 900, epoch: 4 | loss: 0.1030049
	speed: 0.0397s/iter; left time: 216.1002s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.55s
Steps: 906 | Train Loss: 0.0947139 Vali Loss: 0.1200141 Test Loss: 0.1341392
Validation loss decreased (0.121275 --> 0.120014).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0791858
	speed: 0.1015s/iter; left time: 541.5084s
	iters: 200, epoch: 5 | loss: 0.0867286
	speed: 0.0403s/iter; left time: 211.2589s
	iters: 300, epoch: 5 | loss: 0.0983167
	speed: 0.0405s/iter; left time: 207.8173s
	iters: 400, epoch: 5 | loss: 0.0940453
	speed: 0.0403s/iter; left time: 203.0487s
	iters: 500, epoch: 5 | loss: 0.0883916
	speed: 0.0404s/iter; left time: 199.2940s
	iters: 600, epoch: 5 | loss: 0.0810032
	speed: 0.0404s/iter; left time: 195.2636s
	iters: 700, epoch: 5 | loss: 0.0885094
	speed: 0.0381s/iter; left time: 180.3550s
	iters: 800, epoch: 5 | loss: 0.0834468
	speed: 0.0393s/iter; left time: 182.0270s
	iters: 900, epoch: 5 | loss: 0.0845016
	speed: 0.0401s/iter; left time: 182.1541s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.46s
Steps: 906 | Train Loss: 0.0901976 Vali Loss: 0.1183101 Test Loss: 0.1362442
Validation loss decreased (0.120014 --> 0.118310).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0904852
	speed: 0.0973s/iter; left time: 431.0014s
	iters: 200, epoch: 6 | loss: 0.0860661
	speed: 0.0404s/iter; left time: 174.8420s
	iters: 300, epoch: 6 | loss: 0.0953179
	speed: 0.0405s/iter; left time: 171.1526s
	iters: 400, epoch: 6 | loss: 0.0882991
	speed: 0.0405s/iter; left time: 167.2770s
	iters: 500, epoch: 6 | loss: 0.0900472
	speed: 0.0403s/iter; left time: 162.3504s
	iters: 600, epoch: 6 | loss: 0.0927474
	speed: 0.0404s/iter; left time: 158.8722s
	iters: 700, epoch: 6 | loss: 0.0931357
	speed: 0.0404s/iter; left time: 154.8616s
	iters: 800, epoch: 6 | loss: 0.0883807
	speed: 0.0406s/iter; left time: 151.6237s
	iters: 900, epoch: 6 | loss: 0.0831026
	speed: 0.0404s/iter; left time: 146.7051s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.88s
Steps: 906 | Train Loss: 0.0864103 Vali Loss: 0.1206650 Test Loss: 0.1355586
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0921505
	speed: 0.0924s/iter; left time: 325.7205s
	iters: 200, epoch: 7 | loss: 0.0885938
	speed: 0.0404s/iter; left time: 138.4256s
	iters: 300, epoch: 7 | loss: 0.0844395
	speed: 0.0404s/iter; left time: 134.3904s
	iters: 400, epoch: 7 | loss: 0.0734793
	speed: 0.0404s/iter; left time: 130.3307s
	iters: 500, epoch: 7 | loss: 0.0862103
	speed: 0.0404s/iter; left time: 126.3080s
	iters: 600, epoch: 7 | loss: 0.0811895
	speed: 0.0404s/iter; left time: 122.2965s
	iters: 700, epoch: 7 | loss: 0.0868509
	speed: 0.0406s/iter; left time: 118.6169s
	iters: 800, epoch: 7 | loss: 0.0813473
	speed: 0.0404s/iter; left time: 114.1166s
	iters: 900, epoch: 7 | loss: 0.0785179
	speed: 0.0403s/iter; left time: 109.8881s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.70s
Steps: 906 | Train Loss: 0.0824528 Vali Loss: 0.1243991 Test Loss: 0.1378392
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0794904
	speed: 0.0941s/iter; left time: 246.3859s
	iters: 200, epoch: 8 | loss: 0.0707949
	speed: 0.0399s/iter; left time: 100.6076s
	iters: 300, epoch: 8 | loss: 0.0853107
	speed: 0.0403s/iter; left time: 97.5365s
	iters: 400, epoch: 8 | loss: 0.0743418
	speed: 0.0391s/iter; left time: 90.7780s
	iters: 500, epoch: 8 | loss: 0.0784529
	speed: 0.0403s/iter; left time: 89.3290s
	iters: 600, epoch: 8 | loss: 0.0759883
	speed: 0.0394s/iter; left time: 83.3959s
	iters: 700, epoch: 8 | loss: 0.0777603
	speed: 0.0402s/iter; left time: 81.0889s
	iters: 800, epoch: 8 | loss: 0.0783959
	speed: 0.0404s/iter; left time: 77.6208s
	iters: 900, epoch: 8 | loss: 0.0811906
	speed: 0.0403s/iter; left time: 73.2644s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:36.56s
Steps: 906 | Train Loss: 0.0787350 Vali Loss: 0.1227477 Test Loss: 0.1377678
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.049023713916540146, rmse:0.2214130014181137, mae:0.1361154168844223, rse:0.7819259762763977
Original data scale mse:43415168.0, rmse:6589.0185546875, mae:3892.1005859375, rse:0.3276193141937256

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.02428990602493286, RMSE: 0.15585219860076904, MAE: 0.10028143227100372, RSE: 0.5503962635993958
Unscaled Metrics - MSE: 21054224.0, RMSE: 4588.48828125, MAE: 2843.177734375, RSE: 0.22814887762069702

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.049023713916540146, RMSE: 0.2214130014181137, MAE: 0.1361154168844223, RSE: 0.7819259762763977
Unscaled Metrics - MSE: 43415168.0, RMSE: 6589.0185546875, MAE: 3892.1005859375, RSE: 0.3276193141937256

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2246122
	speed: 0.0765s/iter; left time: 683.7545s
	iters: 200, epoch: 1 | loss: 0.2081167
	speed: 0.0478s/iter; left time: 422.4299s
	iters: 300, epoch: 1 | loss: 0.1920674
	speed: 0.0489s/iter; left time: 427.4917s
	iters: 400, epoch: 1 | loss: 0.1789065
	speed: 0.0468s/iter; left time: 404.0667s
	iters: 500, epoch: 1 | loss: 0.1717356
	speed: 0.0461s/iter; left time: 393.4172s
	iters: 600, epoch: 1 | loss: 0.1616433
	speed: 0.0443s/iter; left time: 374.2263s
	iters: 700, epoch: 1 | loss: 0.1571472
	speed: 0.0458s/iter; left time: 382.4306s
	iters: 800, epoch: 1 | loss: 0.1616814
	speed: 0.0452s/iter; left time: 372.7661s
	iters: 900, epoch: 1 | loss: 0.1596366
	speed: 0.0455s/iter; left time: 370.5213s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.85s
Steps: 904 | Train Loss: 0.1861247 Vali Loss: 0.1693542 Test Loss: 0.1905535
Validation loss decreased (inf --> 0.169354).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1489258
	speed: 0.1208s/iter; left time: 970.6363s
	iters: 200, epoch: 2 | loss: 0.1441848
	speed: 0.0442s/iter; left time: 351.0548s
	iters: 300, epoch: 2 | loss: 0.1349168
	speed: 0.0450s/iter; left time: 353.0052s
	iters: 400, epoch: 2 | loss: 0.1247658
	speed: 0.0465s/iter; left time: 359.5312s
	iters: 500, epoch: 2 | loss: 0.1154853
	speed: 0.0445s/iter; left time: 339.9878s
	iters: 600, epoch: 2 | loss: 0.1227886
	speed: 0.0456s/iter; left time: 343.7343s
	iters: 700, epoch: 2 | loss: 0.1144098
	speed: 0.0446s/iter; left time: 331.7271s
	iters: 800, epoch: 2 | loss: 0.1222551
	speed: 0.0402s/iter; left time: 295.1753s
	iters: 900, epoch: 2 | loss: 0.1097277
	speed: 0.0427s/iter; left time: 308.8267s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.61s
Steps: 904 | Train Loss: 0.1286928 Vali Loss: 0.1329564 Test Loss: 0.1465919
Validation loss decreased (0.169354 --> 0.132956).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1156913
	speed: 0.1212s/iter; left time: 864.7172s
	iters: 200, epoch: 3 | loss: 0.0975211
	speed: 0.0476s/iter; left time: 334.4885s
	iters: 300, epoch: 3 | loss: 0.1011100
	speed: 0.0452s/iter; left time: 313.2519s
	iters: 400, epoch: 3 | loss: 0.0964197
	speed: 0.0447s/iter; left time: 305.2745s
	iters: 500, epoch: 3 | loss: 0.1049682
	speed: 0.0458s/iter; left time: 308.3824s
	iters: 600, epoch: 3 | loss: 0.1179357
	speed: 0.0455s/iter; left time: 301.5828s
	iters: 700, epoch: 3 | loss: 0.0949325
	speed: 0.0457s/iter; left time: 298.4558s
	iters: 800, epoch: 3 | loss: 0.1066777
	speed: 0.0458s/iter; left time: 294.9383s
	iters: 900, epoch: 3 | loss: 0.1093972
	speed: 0.0459s/iter; left time: 290.8120s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.63s
Steps: 904 | Train Loss: 0.1063339 Vali Loss: 0.1264300 Test Loss: 0.1395350
Validation loss decreased (0.132956 --> 0.126430).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0966239
	speed: 0.1216s/iter; left time: 757.3275s
	iters: 200, epoch: 4 | loss: 0.0967393
	speed: 0.0486s/iter; left time: 297.7614s
	iters: 300, epoch: 4 | loss: 0.0974483
	speed: 0.0485s/iter; left time: 292.5882s
	iters: 400, epoch: 4 | loss: 0.0835162
	speed: 0.0474s/iter; left time: 280.7699s
	iters: 500, epoch: 4 | loss: 0.1076640
	speed: 0.0462s/iter; left time: 269.4464s
	iters: 600, epoch: 4 | loss: 0.0894532
	speed: 0.0473s/iter; left time: 270.8753s
	iters: 700, epoch: 4 | loss: 0.1045760
	speed: 0.0469s/iter; left time: 263.7879s
	iters: 800, epoch: 4 | loss: 0.0914320
	speed: 0.0466s/iter; left time: 257.4260s
	iters: 900, epoch: 4 | loss: 0.1015885
	speed: 0.0441s/iter; left time: 239.3963s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.83s
Steps: 904 | Train Loss: 0.0977769 Vali Loss: 0.1318640 Test Loss: 0.1405835
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0893329
	speed: 0.1157s/iter; left time: 616.1523s
	iters: 200, epoch: 5 | loss: 0.1042083
	speed: 0.0468s/iter; left time: 244.3466s
	iters: 300, epoch: 5 | loss: 0.0933421
	speed: 0.0482s/iter; left time: 246.8709s
	iters: 400, epoch: 5 | loss: 0.0931832
	speed: 0.0444s/iter; left time: 222.8648s
	iters: 500, epoch: 5 | loss: 0.0885474
	speed: 0.0462s/iter; left time: 227.4058s
	iters: 600, epoch: 5 | loss: 0.0869318
	speed: 0.0467s/iter; left time: 225.2862s
	iters: 700, epoch: 5 | loss: 0.0834743
	speed: 0.0480s/iter; left time: 226.9712s
	iters: 800, epoch: 5 | loss: 0.0820703
	speed: 0.0462s/iter; left time: 213.5476s
	iters: 900, epoch: 5 | loss: 0.0915056
	speed: 0.0473s/iter; left time: 213.9858s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.62s
Steps: 904 | Train Loss: 0.0905559 Vali Loss: 0.1254451 Test Loss: 0.1421491
Validation loss decreased (0.126430 --> 0.125445).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0856860
	speed: 0.1192s/iter; left time: 526.9330s
	iters: 200, epoch: 6 | loss: 0.0736776
	speed: 0.0473s/iter; left time: 204.3503s
	iters: 300, epoch: 6 | loss: 0.0857565
	speed: 0.0456s/iter; left time: 192.2749s
	iters: 400, epoch: 6 | loss: 0.0888394
	speed: 0.0449s/iter; left time: 185.1177s
	iters: 500, epoch: 6 | loss: 0.0817830
	speed: 0.0436s/iter; left time: 175.5102s
	iters: 600, epoch: 6 | loss: 0.0856055
	speed: 0.0487s/iter; left time: 191.1030s
	iters: 700, epoch: 6 | loss: 0.0784503
	speed: 0.0479s/iter; left time: 182.8957s
	iters: 800, epoch: 6 | loss: 0.0899893
	speed: 0.0463s/iter; left time: 172.2094s
	iters: 900, epoch: 6 | loss: 0.0813079
	speed: 0.0482s/iter; left time: 174.6095s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.53s
Steps: 904 | Train Loss: 0.0840287 Vali Loss: 0.1298426 Test Loss: 0.1410313
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0734346
	speed: 0.1136s/iter; left time: 399.5339s
	iters: 200, epoch: 7 | loss: 0.0739107
	speed: 0.0487s/iter; left time: 166.2935s
	iters: 300, epoch: 7 | loss: 0.0758579
	speed: 0.0499s/iter; left time: 165.4390s
	iters: 400, epoch: 7 | loss: 0.0730996
	speed: 0.0468s/iter; left time: 150.5060s
	iters: 500, epoch: 7 | loss: 0.0801694
	speed: 0.0462s/iter; left time: 143.9064s
	iters: 600, epoch: 7 | loss: 0.0745910
	speed: 0.0462s/iter; left time: 139.3243s
	iters: 700, epoch: 7 | loss: 0.0786007
	speed: 0.0462s/iter; left time: 134.8378s
	iters: 800, epoch: 7 | loss: 0.0737484
	speed: 0.0459s/iter; left time: 129.2315s
	iters: 900, epoch: 7 | loss: 0.0823639
	speed: 0.0482s/iter; left time: 131.0869s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:42.78s
Steps: 904 | Train Loss: 0.0780969 Vali Loss: 0.1301674 Test Loss: 0.1462440
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0773419
	speed: 0.1158s/iter; left time: 302.6521s
	iters: 200, epoch: 8 | loss: 0.0745791
	speed: 0.0458s/iter; left time: 115.1194s
	iters: 300, epoch: 8 | loss: 0.0757380
	speed: 0.0456s/iter; left time: 109.9358s
	iters: 400, epoch: 8 | loss: 0.0745323
	speed: 0.0490s/iter; left time: 113.2853s
	iters: 500, epoch: 8 | loss: 0.0775097
	speed: 0.0491s/iter; left time: 108.7497s
	iters: 600, epoch: 8 | loss: 0.0751869
	speed: 0.0468s/iter; left time: 98.8434s
	iters: 700, epoch: 8 | loss: 0.0781270
	speed: 0.0456s/iter; left time: 91.7241s
	iters: 800, epoch: 8 | loss: 0.0685896
	speed: 0.0457s/iter; left time: 87.3303s
	iters: 900, epoch: 8 | loss: 0.0697254
	speed: 0.0456s/iter; left time: 82.7072s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.56s
Steps: 904 | Train Loss: 0.0732840 Vali Loss: 0.1306358 Test Loss: 0.1448181
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.045397039502859116, rmse:0.21306580305099487, mae:0.14210247993469238, rse:0.7545090913772583
Original data scale mse:40688736.0, rmse:6378.7724609375, mae:4003.507568359375, rse:0.31766512989997864
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.2301333
	speed: 0.0501s/iter; left time: 448.0618s
	iters: 200, epoch: 1 | loss: 0.1951126
	speed: 0.0493s/iter; left time: 436.0386s
	iters: 300, epoch: 1 | loss: 0.1723979
	speed: 0.0487s/iter; left time: 425.5063s
	iters: 400, epoch: 1 | loss: 0.1629347
	speed: 0.0493s/iter; left time: 426.3125s
	iters: 500, epoch: 1 | loss: 0.1636003
	speed: 0.0488s/iter; left time: 416.4035s
	iters: 600, epoch: 1 | loss: 0.1724814
	speed: 0.0486s/iter; left time: 410.4025s
	iters: 700, epoch: 1 | loss: 0.1671904
	speed: 0.0485s/iter; left time: 404.8524s
	iters: 800, epoch: 1 | loss: 0.1681524
	speed: 0.0442s/iter; left time: 364.2438s
	iters: 900, epoch: 1 | loss: 0.1574399
	speed: 0.0501s/iter; left time: 407.6124s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.03s
Steps: 904 | Train Loss: 0.1846326 Vali Loss: 0.1673415 Test Loss: 0.1887328
Validation loss decreased (inf --> 0.167341).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1451383
	speed: 0.1188s/iter; left time: 955.0649s
	iters: 200, epoch: 2 | loss: 0.1455005
	speed: 0.0479s/iter; left time: 380.5209s
	iters: 300, epoch: 2 | loss: 0.1271278
	speed: 0.0458s/iter; left time: 359.2484s
	iters: 400, epoch: 2 | loss: 0.1205615
	speed: 0.0459s/iter; left time: 355.2620s
	iters: 500, epoch: 2 | loss: 0.1160921
	speed: 0.0462s/iter; left time: 352.6688s
	iters: 600, epoch: 2 | loss: 0.1196285
	speed: 0.0459s/iter; left time: 346.2595s
	iters: 700, epoch: 2 | loss: 0.1190385
	speed: 0.0461s/iter; left time: 342.9142s
	iters: 800, epoch: 2 | loss: 0.1101898
	speed: 0.0462s/iter; left time: 339.1493s
	iters: 900, epoch: 2 | loss: 0.1044184
	speed: 0.0460s/iter; left time: 333.0363s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.29s
Steps: 904 | Train Loss: 0.1283991 Vali Loss: 0.1355134 Test Loss: 0.1446352
Validation loss decreased (0.167341 --> 0.135513).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1039385
	speed: 0.1156s/iter; left time: 824.4580s
	iters: 200, epoch: 3 | loss: 0.1261861
	speed: 0.0460s/iter; left time: 323.5151s
	iters: 300, epoch: 3 | loss: 0.1150491
	speed: 0.0460s/iter; left time: 318.8276s
	iters: 400, epoch: 3 | loss: 0.1001509
	speed: 0.0464s/iter; left time: 316.8712s
	iters: 500, epoch: 3 | loss: 0.0977131
	speed: 0.0462s/iter; left time: 311.1388s
	iters: 600, epoch: 3 | loss: 0.1125626
	speed: 0.0462s/iter; left time: 306.4029s
	iters: 700, epoch: 3 | loss: 0.0982501
	speed: 0.0463s/iter; left time: 302.3582s
	iters: 800, epoch: 3 | loss: 0.1015485
	speed: 0.0462s/iter; left time: 297.2007s
	iters: 900, epoch: 3 | loss: 0.1056257
	speed: 0.0458s/iter; left time: 290.0103s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.89s
Steps: 904 | Train Loss: 0.1050790 Vali Loss: 0.1275464 Test Loss: 0.1397778
Validation loss decreased (0.135513 --> 0.127546).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0961418
	speed: 0.1165s/iter; left time: 725.6999s
	iters: 200, epoch: 4 | loss: 0.1005371
	speed: 0.0450s/iter; left time: 276.0191s
	iters: 300, epoch: 4 | loss: 0.0996916
	speed: 0.0443s/iter; left time: 267.0273s
	iters: 400, epoch: 4 | loss: 0.0910206
	speed: 0.0434s/iter; left time: 257.5411s
	iters: 500, epoch: 4 | loss: 0.1074546
	speed: 0.0441s/iter; left time: 257.3144s
	iters: 600, epoch: 4 | loss: 0.0947664
	speed: 0.0441s/iter; left time: 252.8394s
	iters: 700, epoch: 4 | loss: 0.0980362
	speed: 0.0441s/iter; left time: 248.2241s
	iters: 800, epoch: 4 | loss: 0.0869908
	speed: 0.0439s/iter; left time: 242.5362s
	iters: 900, epoch: 4 | loss: 0.0859004
	speed: 0.0456s/iter; left time: 247.4953s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.53s
Steps: 904 | Train Loss: 0.0974901 Vali Loss: 0.1262636 Test Loss: 0.1426535
Validation loss decreased (0.127546 --> 0.126264).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0958850
	speed: 0.1157s/iter; left time: 615.8834s
	iters: 200, epoch: 5 | loss: 0.0915819
	speed: 0.0463s/iter; left time: 241.6840s
	iters: 300, epoch: 5 | loss: 0.0879767
	speed: 0.0458s/iter; left time: 234.7468s
	iters: 400, epoch: 5 | loss: 0.0803326
	speed: 0.0455s/iter; left time: 228.7642s
	iters: 500, epoch: 5 | loss: 0.0850065
	speed: 0.0443s/iter; left time: 218.2547s
	iters: 600, epoch: 5 | loss: 0.0890771
	speed: 0.0447s/iter; left time: 215.5605s
	iters: 700, epoch: 5 | loss: 0.0929132
	speed: 0.0457s/iter; left time: 215.7066s
	iters: 800, epoch: 5 | loss: 0.0846247
	speed: 0.0466s/iter; left time: 215.4346s
	iters: 900, epoch: 5 | loss: 0.0851368
	speed: 0.0460s/iter; left time: 208.0332s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.51s
Steps: 904 | Train Loss: 0.0912254 Vali Loss: 0.1260705 Test Loss: 0.1398559
Validation loss decreased (0.126264 --> 0.126071).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0966838
	speed: 0.1164s/iter; left time: 514.5073s
	iters: 200, epoch: 6 | loss: 0.0888424
	speed: 0.0459s/iter; left time: 198.4029s
	iters: 300, epoch: 6 | loss: 0.0831272
	speed: 0.0458s/iter; left time: 193.1120s
	iters: 400, epoch: 6 | loss: 0.0903139
	speed: 0.0461s/iter; left time: 189.7779s
	iters: 500, epoch: 6 | loss: 0.0874166
	speed: 0.0459s/iter; left time: 184.5362s
	iters: 600, epoch: 6 | loss: 0.0912243
	speed: 0.0436s/iter; left time: 170.9524s
	iters: 700, epoch: 6 | loss: 0.0895760
	speed: 0.0459s/iter; left time: 175.2412s
	iters: 800, epoch: 6 | loss: 0.0793183
	speed: 0.0458s/iter; left time: 170.4258s
	iters: 900, epoch: 6 | loss: 0.0831427
	speed: 0.0459s/iter; left time: 166.1759s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:41.40s
Steps: 904 | Train Loss: 0.0851726 Vali Loss: 0.1282148 Test Loss: 0.1443390
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.0754341
	speed: 0.1086s/iter; left time: 382.0529s
	iters: 200, epoch: 7 | loss: 0.0798553
	speed: 0.0460s/iter; left time: 157.2098s
	iters: 300, epoch: 7 | loss: 0.0775340
	speed: 0.0452s/iter; left time: 149.8752s
	iters: 400, epoch: 7 | loss: 0.0785744
	speed: 0.0459s/iter; left time: 147.8104s
	iters: 500, epoch: 7 | loss: 0.0772450
	speed: 0.0457s/iter; left time: 142.3728s
	iters: 600, epoch: 7 | loss: 0.0841917
	speed: 0.0461s/iter; left time: 139.1993s
	iters: 700, epoch: 7 | loss: 0.0775137
	speed: 0.0464s/iter; left time: 135.2660s
	iters: 800, epoch: 7 | loss: 0.0842347
	speed: 0.0461s/iter; left time: 129.9650s
	iters: 900, epoch: 7 | loss: 0.0790158
	speed: 0.0461s/iter; left time: 125.3765s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:41.49s
Steps: 904 | Train Loss: 0.0794048 Vali Loss: 0.1288580 Test Loss: 0.1445608
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.0741648
	speed: 0.1133s/iter; left time: 295.9799s
	iters: 200, epoch: 8 | loss: 0.0693042
	speed: 0.0462s/iter; left time: 116.1176s
	iters: 300, epoch: 8 | loss: 0.0753945
	speed: 0.0465s/iter; left time: 112.1229s
	iters: 400, epoch: 8 | loss: 0.0730816
	speed: 0.0460s/iter; left time: 106.3904s
	iters: 500, epoch: 8 | loss: 0.0720230
	speed: 0.0463s/iter; left time: 102.4023s
	iters: 600, epoch: 8 | loss: 0.0695945
	speed: 0.0472s/iter; left time: 99.7812s
	iters: 700, epoch: 8 | loss: 0.0733338
	speed: 0.0476s/iter; left time: 95.8936s
	iters: 800, epoch: 8 | loss: 0.0721483
	speed: 0.0460s/iter; left time: 87.9729s
	iters: 900, epoch: 8 | loss: 0.0699571
	speed: 0.0460s/iter; left time: 83.4475s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:42.41s
Steps: 904 | Train Loss: 0.0741621 Vali Loss: 0.1269441 Test Loss: 0.1441041
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.04406126216053963, rmse:0.20990774035453796, mae:0.13983353972434998, rse:0.7433257699012756
Original data scale mse:38573712.0, rmse:6210.77392578125, mae:3890.927490234375, rse:0.3092987537384033

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.045397039502859116, RMSE: 0.21306580305099487, MAE: 0.14210247993469238, RSE: 0.7545090913772583
Unscaled Metrics - MSE: 40688736.0, RMSE: 6378.7724609375, MAE: 4003.507568359375, RSE: 0.31766512989997864

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.04406126216053963, RMSE: 0.20990774035453796, MAE: 0.13983353972434998, RSE: 0.7433257699012756
Unscaled Metrics - MSE: 38573712.0, RMSE: 6210.77392578125, MAE: 3890.927490234375, RSE: 0.3092987537384033

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2147408
	speed: 0.0795s/iter; left time: 709.5074s
	iters: 200, epoch: 1 | loss: 0.2049752
	speed: 0.0525s/iter; left time: 462.6950s
	iters: 300, epoch: 1 | loss: 0.1858589
	speed: 0.0524s/iter; left time: 457.0736s
	iters: 400, epoch: 1 | loss: 0.1819223
	speed: 0.0522s/iter; left time: 449.7698s
	iters: 500, epoch: 1 | loss: 0.1769616
	speed: 0.0525s/iter; left time: 447.7437s
	iters: 600, epoch: 1 | loss: 0.1786938
	speed: 0.0521s/iter; left time: 438.9204s
	iters: 700, epoch: 1 | loss: 0.1688549
	speed: 0.0524s/iter; left time: 436.0249s
	iters: 800, epoch: 1 | loss: 0.1654620
	speed: 0.0521s/iter; left time: 428.1297s
	iters: 900, epoch: 1 | loss: 0.1702404
	speed: 0.0522s/iter; left time: 423.8963s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.91s
Steps: 902 | Train Loss: 0.1895083 Vali Loss: 0.1759074 Test Loss: 0.1999528
Validation loss decreased (inf --> 0.175907).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1651679
	speed: 0.1252s/iter; left time: 1004.2108s
	iters: 200, epoch: 2 | loss: 0.1541310
	speed: 0.0431s/iter; left time: 341.6584s
	iters: 300, epoch: 2 | loss: 0.1586817
	speed: 0.0431s/iter; left time: 336.9501s
	iters: 400, epoch: 2 | loss: 0.1454573
	speed: 0.0494s/iter; left time: 380.9884s
	iters: 500, epoch: 2 | loss: 0.1384664
	speed: 0.0523s/iter; left time: 398.1117s
	iters: 600, epoch: 2 | loss: 0.1333779
	speed: 0.0520s/iter; left time: 390.6469s
	iters: 700, epoch: 2 | loss: 0.1278873
	speed: 0.0518s/iter; left time: 383.9648s
	iters: 800, epoch: 2 | loss: 0.1431116
	speed: 0.0522s/iter; left time: 381.7046s
	iters: 900, epoch: 2 | loss: 0.1280995
	speed: 0.0522s/iter; left time: 377.0512s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:44.44s
Steps: 902 | Train Loss: 0.1441035 Vali Loss: 0.1519851 Test Loss: 0.1711886
Validation loss decreased (0.175907 --> 0.151985).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1377297
	speed: 0.1317s/iter; left time: 937.3467s
	iters: 200, epoch: 3 | loss: 0.1210781
	speed: 0.0521s/iter; left time: 365.4917s
	iters: 300, epoch: 3 | loss: 0.1198194
	speed: 0.0520s/iter; left time: 359.9547s
	iters: 400, epoch: 3 | loss: 0.1224196
	speed: 0.0523s/iter; left time: 356.5510s
	iters: 500, epoch: 3 | loss: 0.1074672
	speed: 0.0526s/iter; left time: 353.5985s
	iters: 600, epoch: 3 | loss: 0.1116899
	speed: 0.0522s/iter; left time: 345.5971s
	iters: 700, epoch: 3 | loss: 0.1112872
	speed: 0.0524s/iter; left time: 341.5410s
	iters: 800, epoch: 3 | loss: 0.1100388
	speed: 0.0523s/iter; left time: 335.4984s
	iters: 900, epoch: 3 | loss: 0.1070697
	speed: 0.0522s/iter; left time: 329.9343s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.32s
Steps: 902 | Train Loss: 0.1143792 Vali Loss: 0.1312807 Test Loss: 0.1447967
Validation loss decreased (0.151985 --> 0.131281).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.0993531
	speed: 0.1312s/iter; left time: 815.5230s
	iters: 200, epoch: 4 | loss: 0.0976536
	speed: 0.0523s/iter; left time: 319.7128s
	iters: 300, epoch: 4 | loss: 0.1099965
	speed: 0.0525s/iter; left time: 315.5717s
	iters: 400, epoch: 4 | loss: 0.1085633
	speed: 0.0525s/iter; left time: 310.3860s
	iters: 500, epoch: 4 | loss: 0.1053810
	speed: 0.0526s/iter; left time: 305.5970s
	iters: 600, epoch: 4 | loss: 0.0958832
	speed: 0.0524s/iter; left time: 299.5219s
	iters: 700, epoch: 4 | loss: 0.1085369
	speed: 0.0523s/iter; left time: 293.7707s
	iters: 800, epoch: 4 | loss: 0.1051037
	speed: 0.0525s/iter; left time: 289.3370s
	iters: 900, epoch: 4 | loss: 0.0943609
	speed: 0.0526s/iter; left time: 284.7648s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.48s
Steps: 902 | Train Loss: 0.1017112 Vali Loss: 0.1352619 Test Loss: 0.1506488
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1000706
	speed: 0.1283s/iter; left time: 681.6462s
	iters: 200, epoch: 5 | loss: 0.0926405
	speed: 0.0521s/iter; left time: 271.6179s
	iters: 300, epoch: 5 | loss: 0.0950490
	speed: 0.0523s/iter; left time: 267.3856s
	iters: 400, epoch: 5 | loss: 0.0976274
	speed: 0.0523s/iter; left time: 262.1272s
	iters: 500, epoch: 5 | loss: 0.0843251
	speed: 0.0524s/iter; left time: 257.4485s
	iters: 600, epoch: 5 | loss: 0.0954909
	speed: 0.0526s/iter; left time: 253.2660s
	iters: 700, epoch: 5 | loss: 0.0944040
	speed: 0.0525s/iter; left time: 247.6306s
	iters: 800, epoch: 5 | loss: 0.0896012
	speed: 0.0523s/iter; left time: 241.4330s
	iters: 900, epoch: 5 | loss: 0.0822994
	speed: 0.0523s/iter; left time: 236.0262s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.42s
Steps: 902 | Train Loss: 0.0932891 Vali Loss: 0.1389595 Test Loss: 0.1535437
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0876330
	speed: 0.1280s/iter; left time: 564.7996s
	iters: 200, epoch: 6 | loss: 0.0893045
	speed: 0.0518s/iter; left time: 223.3768s
	iters: 300, epoch: 6 | loss: 0.0815809
	speed: 0.0519s/iter; left time: 218.5045s
	iters: 400, epoch: 6 | loss: 0.0949811
	speed: 0.0516s/iter; left time: 212.3145s
	iters: 500, epoch: 6 | loss: 0.0837089
	speed: 0.0521s/iter; left time: 208.9091s
	iters: 600, epoch: 6 | loss: 0.0823262
	speed: 0.0525s/iter; left time: 205.4874s
	iters: 700, epoch: 6 | loss: 0.0879384
	speed: 0.0524s/iter; left time: 199.6043s
	iters: 800, epoch: 6 | loss: 0.0795501
	speed: 0.0524s/iter; left time: 194.5301s
	iters: 900, epoch: 6 | loss: 0.0906194
	speed: 0.0525s/iter; left time: 189.4602s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.25s
Steps: 902 | Train Loss: 0.0859014 Vali Loss: 0.1372263 Test Loss: 0.1539112
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04394709691405296, rmse:0.2096356302499771, mae:0.14478307962417603, rse:0.7426759004592896
Original data scale mse:39822152.0, rmse:6310.4794921875, mae:4082.469482421875, rse:0.31441840529441833
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.2321397
	speed: 0.0539s/iter; left time: 480.6555s
	iters: 200, epoch: 1 | loss: 0.1973691
	speed: 0.0518s/iter; left time: 457.0700s
	iters: 300, epoch: 1 | loss: 0.1899634
	speed: 0.0524s/iter; left time: 457.3362s
	iters: 400, epoch: 1 | loss: 0.1636305
	speed: 0.0522s/iter; left time: 450.1247s
	iters: 500, epoch: 1 | loss: 0.1814534
	speed: 0.0524s/iter; left time: 446.4545s
	iters: 600, epoch: 1 | loss: 0.1696513
	speed: 0.0522s/iter; left time: 439.2433s
	iters: 700, epoch: 1 | loss: 0.1682921
	speed: 0.0524s/iter; left time: 436.3699s
	iters: 800, epoch: 1 | loss: 0.1633812
	speed: 0.0521s/iter; left time: 428.3641s
	iters: 900, epoch: 1 | loss: 0.1687731
	speed: 0.0522s/iter; left time: 423.5784s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.34s
Steps: 902 | Train Loss: 0.1893847 Vali Loss: 0.1745064 Test Loss: 0.1995509
Validation loss decreased (inf --> 0.174506).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1527932
	speed: 0.1334s/iter; left time: 1069.8679s
	iters: 200, epoch: 2 | loss: 0.1483294
	speed: 0.0525s/iter; left time: 415.4271s
	iters: 300, epoch: 2 | loss: 0.1427017
	speed: 0.0521s/iter; left time: 407.7295s
	iters: 400, epoch: 2 | loss: 0.1373652
	speed: 0.0522s/iter; left time: 403.2463s
	iters: 500, epoch: 2 | loss: 0.1404201
	speed: 0.0525s/iter; left time: 399.6711s
	iters: 600, epoch: 2 | loss: 0.1426174
	speed: 0.0522s/iter; left time: 392.5757s
	iters: 700, epoch: 2 | loss: 0.1350924
	speed: 0.0524s/iter; left time: 388.4953s
	iters: 800, epoch: 2 | loss: 0.1242686
	speed: 0.0525s/iter; left time: 384.2925s
	iters: 900, epoch: 2 | loss: 0.1295320
	speed: 0.0522s/iter; left time: 376.9828s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.43s
Steps: 902 | Train Loss: 0.1452574 Vali Loss: 0.1592431 Test Loss: 0.1785243
Validation loss decreased (0.174506 --> 0.159243).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1216370
	speed: 0.1347s/iter; left time: 958.3678s
	iters: 200, epoch: 3 | loss: 0.1274602
	speed: 0.0519s/iter; left time: 364.0258s
	iters: 300, epoch: 3 | loss: 0.1250435
	speed: 0.0517s/iter; left time: 357.8245s
	iters: 400, epoch: 3 | loss: 0.1166226
	speed: 0.0522s/iter; left time: 356.0219s
	iters: 500, epoch: 3 | loss: 0.1175315
	speed: 0.0520s/iter; left time: 349.2527s
	iters: 600, epoch: 3 | loss: 0.1078033
	speed: 0.0521s/iter; left time: 344.7139s
	iters: 700, epoch: 3 | loss: 0.1084212
	speed: 0.0519s/iter; left time: 338.4658s
	iters: 800, epoch: 3 | loss: 0.1020218
	speed: 0.0517s/iter; left time: 331.4819s
	iters: 900, epoch: 3 | loss: 0.1084920
	speed: 0.0519s/iter; left time: 328.1581s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.06s
Steps: 902 | Train Loss: 0.1151611 Vali Loss: 0.1308115 Test Loss: 0.1448318
Validation loss decreased (0.159243 --> 0.130811).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1048867
	speed: 0.1325s/iter; left time: 823.4408s
	iters: 200, epoch: 4 | loss: 0.0964195
	speed: 0.0526s/iter; left time: 321.4594s
	iters: 300, epoch: 4 | loss: 0.1035071
	speed: 0.0528s/iter; left time: 317.3769s
	iters: 400, epoch: 4 | loss: 0.1002823
	speed: 0.0519s/iter; left time: 307.0108s
	iters: 500, epoch: 4 | loss: 0.1016895
	speed: 0.0520s/iter; left time: 302.5399s
	iters: 600, epoch: 4 | loss: 0.1110194
	speed: 0.0520s/iter; left time: 297.0532s
	iters: 700, epoch: 4 | loss: 0.0958979
	speed: 0.0524s/iter; left time: 294.1537s
	iters: 800, epoch: 4 | loss: 0.1013383
	speed: 0.0523s/iter; left time: 288.5677s
	iters: 900, epoch: 4 | loss: 0.0973082
	speed: 0.0512s/iter; left time: 277.2046s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.23s
Steps: 902 | Train Loss: 0.1012365 Vali Loss: 0.1355156 Test Loss: 0.1474784
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0882527
	speed: 0.1275s/iter; left time: 677.5994s
	iters: 200, epoch: 5 | loss: 0.0935989
	speed: 0.0524s/iter; left time: 273.0937s
	iters: 300, epoch: 5 | loss: 0.0921567
	speed: 0.0525s/iter; left time: 268.4771s
	iters: 400, epoch: 5 | loss: 0.0977337
	speed: 0.0522s/iter; left time: 261.6063s
	iters: 500, epoch: 5 | loss: 0.1000321
	speed: 0.0520s/iter; left time: 255.3592s
	iters: 600, epoch: 5 | loss: 0.0865251
	speed: 0.0522s/iter; left time: 251.4365s
	iters: 700, epoch: 5 | loss: 0.0922151
	speed: 0.0522s/iter; left time: 246.1901s
	iters: 800, epoch: 5 | loss: 0.0845081
	speed: 0.0521s/iter; left time: 240.4155s
	iters: 900, epoch: 5 | loss: 0.0910032
	speed: 0.0523s/iter; left time: 235.9395s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.26s
Steps: 902 | Train Loss: 0.0929604 Vali Loss: 0.1366524 Test Loss: 0.1539558
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0900509
	speed: 0.1285s/iter; left time: 566.8714s
	iters: 200, epoch: 6 | loss: 0.0848731
	speed: 0.0523s/iter; left time: 225.5568s
	iters: 300, epoch: 6 | loss: 0.0875704
	speed: 0.0522s/iter; left time: 219.7915s
	iters: 400, epoch: 6 | loss: 0.0834398
	speed: 0.0519s/iter; left time: 213.2139s
	iters: 500, epoch: 6 | loss: 0.0816596
	speed: 0.0522s/iter; left time: 209.3765s
	iters: 600, epoch: 6 | loss: 0.0911666
	speed: 0.0517s/iter; left time: 202.3451s
	iters: 700, epoch: 6 | loss: 0.0888930
	speed: 0.0522s/iter; left time: 198.9736s
	iters: 800, epoch: 6 | loss: 0.0769717
	speed: 0.0491s/iter; left time: 182.2114s
	iters: 900, epoch: 6 | loss: 0.0764168
	speed: 0.0482s/iter; left time: 174.0753s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:46.53s
Steps: 902 | Train Loss: 0.0858187 Vali Loss: 0.1359175 Test Loss: 0.1564617
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.04477142170071602, rmse:0.21159258484840393, mae:0.14479929208755493, rse:0.7496087551116943
Original data scale mse:41195184.0, rmse:6418.34765625, mae:4090.05419921875, rse:0.31979289650917053

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.04394709691405296, RMSE: 0.2096356302499771, MAE: 0.14478307962417603, RSE: 0.7426759004592896
Unscaled Metrics - MSE: 39822152.0, RMSE: 6310.4794921875, MAE: 4082.469482421875, RSE: 0.31441840529441833

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.04477142170071602, RMSE: 0.21159258484840393, MAE: 0.14479929208755493, RSE: 0.7496087551116943
Unscaled Metrics - MSE: 41195184.0, RMSE: 6418.34765625, MAE: 4090.05419921875, RSE: 0.31979289650917053
