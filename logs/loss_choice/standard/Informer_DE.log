
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.5645647
	speed: 0.0665s/iter; left time: 595.8050s
	iters: 200, epoch: 1 | loss: 0.4373353
	speed: 0.0404s/iter; left time: 358.1548s
	iters: 300, epoch: 1 | loss: 0.3493574
	speed: 0.0391s/iter; left time: 342.1404s
	iters: 400, epoch: 1 | loss: 0.2721123
	speed: 0.0354s/iter; left time: 306.3129s
	iters: 500, epoch: 1 | loss: 0.2334988
	speed: 0.0381s/iter; left time: 326.4242s
	iters: 600, epoch: 1 | loss: 0.2227996
	speed: 0.0325s/iter; left time: 274.9865s
	iters: 700, epoch: 1 | loss: 0.3459783
	speed: 0.0322s/iter; left time: 268.9289s
	iters: 800, epoch: 1 | loss: 0.2465952
	speed: 0.0332s/iter; left time: 274.1634s
	iters: 900, epoch: 1 | loss: 0.1890533
	speed: 0.0377s/iter; left time: 308.0736s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:34.20s
Steps: 906 | Train Loss: 0.3521562 Vali Loss: 0.2837784 Test Loss: 0.3351012
Validation loss decreased (inf --> 0.283778).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.1369602
	speed: 0.0999s/iter; left time: 805.0881s
	iters: 200, epoch: 2 | loss: 0.2333409
	speed: 0.0403s/iter; left time: 320.7781s
	iters: 300, epoch: 2 | loss: 0.1687464
	speed: 0.0403s/iter; left time: 316.9220s
	iters: 400, epoch: 2 | loss: 0.2259671
	speed: 0.0432s/iter; left time: 335.0799s
	iters: 500, epoch: 2 | loss: 0.1321825
	speed: 0.0398s/iter; left time: 305.0102s
	iters: 600, epoch: 2 | loss: 0.1529523
	speed: 0.0409s/iter; left time: 309.2151s
	iters: 700, epoch: 2 | loss: 0.1427845
	speed: 0.0404s/iter; left time: 300.9197s
	iters: 800, epoch: 2 | loss: 0.2272940
	speed: 0.0404s/iter; left time: 296.8068s
	iters: 900, epoch: 2 | loss: 0.1502392
	speed: 0.0405s/iter; left time: 293.7648s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.04s
Steps: 906 | Train Loss: 0.1839136 Vali Loss: 0.2242827 Test Loss: 0.2588198
Validation loss decreased (0.283778 --> 0.224283).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.1715890
	speed: 0.0978s/iter; left time: 698.8574s
	iters: 200, epoch: 3 | loss: 0.1321808
	speed: 0.0400s/iter; left time: 281.6743s
	iters: 300, epoch: 3 | loss: 0.1483532
	speed: 0.0402s/iter; left time: 279.1535s
	iters: 400, epoch: 3 | loss: 0.1454668
	speed: 0.0404s/iter; left time: 276.8472s
	iters: 500, epoch: 3 | loss: 0.1974567
	speed: 0.0398s/iter; left time: 268.3864s
	iters: 600, epoch: 3 | loss: 0.1696863
	speed: 0.0408s/iter; left time: 270.9935s
	iters: 700, epoch: 3 | loss: 0.1523357
	speed: 0.0405s/iter; left time: 265.0208s
	iters: 800, epoch: 3 | loss: 0.1443707
	speed: 0.0410s/iter; left time: 264.6578s
	iters: 900, epoch: 3 | loss: 0.1538004
	speed: 0.0436s/iter; left time: 277.1165s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.18s
Steps: 906 | Train Loss: 0.1533073 Vali Loss: 0.2284155 Test Loss: 0.2478931
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1093198
	speed: 0.0950s/iter; left time: 593.1976s
	iters: 200, epoch: 4 | loss: 0.1387891
	speed: 0.0402s/iter; left time: 246.7946s
	iters: 300, epoch: 4 | loss: 0.1146336
	speed: 0.0405s/iter; left time: 244.6846s
	iters: 400, epoch: 4 | loss: 0.1190760
	speed: 0.0404s/iter; left time: 240.1403s
	iters: 500, epoch: 4 | loss: 0.1434983
	speed: 0.0403s/iter; left time: 235.5522s
	iters: 600, epoch: 4 | loss: 0.1207120
	speed: 0.0394s/iter; left time: 226.3982s
	iters: 700, epoch: 4 | loss: 0.1220007
	speed: 0.0388s/iter; left time: 218.8415s
	iters: 800, epoch: 4 | loss: 0.1703660
	speed: 0.0413s/iter; left time: 229.0255s
	iters: 900, epoch: 4 | loss: 0.1145186
	speed: 0.0411s/iter; left time: 223.8082s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.61s
Steps: 906 | Train Loss: 0.1316574 Vali Loss: 0.2245228 Test Loss: 0.2522752
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.0990685
	speed: 0.0830s/iter; left time: 443.0504s
	iters: 200, epoch: 5 | loss: 0.0903148
	speed: 0.0302s/iter; left time: 158.3494s
	iters: 300, epoch: 5 | loss: 0.1039879
	speed: 0.0304s/iter; left time: 156.1569s
	iters: 400, epoch: 5 | loss: 0.1156793
	speed: 0.0357s/iter; left time: 179.9279s
	iters: 500, epoch: 5 | loss: 0.0939077
	speed: 0.0406s/iter; left time: 200.4014s
	iters: 600, epoch: 5 | loss: 0.1067051
	speed: 0.0406s/iter; left time: 196.2075s
	iters: 700, epoch: 5 | loss: 0.1100522
	speed: 0.0404s/iter; left time: 191.3231s
	iters: 800, epoch: 5 | loss: 0.1199708
	speed: 0.0404s/iter; left time: 187.2705s
	iters: 900, epoch: 5 | loss: 0.1084228
	speed: 0.0406s/iter; left time: 184.2524s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:33.24s
Steps: 906 | Train Loss: 0.1093506 Vali Loss: 0.2453700 Test Loss: 0.2733004
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.25892117619514465, rmse:0.5088430047035217, mae:0.35830968618392944, rse:0.49462392926216125
Original data scale mse:20458642.0, rmse:4523.123046875, mae:3016.656982421875, rse:0.2248988002538681
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.4966164
	speed: 0.0423s/iter; left time: 379.2225s
	iters: 200, epoch: 1 | loss: 0.3942728
	speed: 0.0409s/iter; left time: 362.1130s
	iters: 300, epoch: 1 | loss: 0.4101226
	speed: 0.0405s/iter; left time: 355.0102s
	iters: 400, epoch: 1 | loss: 0.3164099
	speed: 0.0416s/iter; left time: 360.5283s
	iters: 500, epoch: 1 | loss: 0.2853692
	speed: 0.0406s/iter; left time: 347.2866s
	iters: 600, epoch: 1 | loss: 0.2630173
	speed: 0.0402s/iter; left time: 339.8587s
	iters: 700, epoch: 1 | loss: 0.2321014
	speed: 0.0402s/iter; left time: 336.4704s
	iters: 800, epoch: 1 | loss: 0.2764530
	speed: 0.0404s/iter; left time: 334.0555s
	iters: 900, epoch: 1 | loss: 0.2417925
	speed: 0.0408s/iter; left time: 333.0561s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.06s
Steps: 906 | Train Loss: 0.3609091 Vali Loss: 0.2814071 Test Loss: 0.3389556
Validation loss decreased (inf --> 0.281407).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2036290
	speed: 0.1004s/iter; left time: 808.8777s
	iters: 200, epoch: 2 | loss: 0.1889317
	speed: 0.0404s/iter; left time: 321.4373s
	iters: 300, epoch: 2 | loss: 0.1521505
	speed: 0.0405s/iter; left time: 318.1357s
	iters: 400, epoch: 2 | loss: 0.1442502
	speed: 0.0406s/iter; left time: 315.2211s
	iters: 500, epoch: 2 | loss: 0.1653206
	speed: 0.0426s/iter; left time: 325.9240s
	iters: 600, epoch: 2 | loss: 0.1897358
	speed: 0.0460s/iter; left time: 347.6526s
	iters: 700, epoch: 2 | loss: 0.1712558
	speed: 0.0434s/iter; left time: 323.8007s
	iters: 800, epoch: 2 | loss: 0.1548272
	speed: 0.0335s/iter; left time: 246.6527s
	iters: 900, epoch: 2 | loss: 0.1804415
	speed: 0.0372s/iter; left time: 270.2162s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.00s
Steps: 906 | Train Loss: 0.1869595 Vali Loss: 0.2361160 Test Loss: 0.2602846
Validation loss decreased (0.281407 --> 0.236116).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2022747
	speed: 0.0977s/iter; left time: 698.2814s
	iters: 200, epoch: 3 | loss: 0.1417277
	speed: 0.0320s/iter; left time: 225.9084s
	iters: 300, epoch: 3 | loss: 0.1230821
	speed: 0.0309s/iter; left time: 215.0355s
	iters: 400, epoch: 3 | loss: 0.1371556
	speed: 0.0317s/iter; left time: 217.0210s
	iters: 500, epoch: 3 | loss: 0.1450782
	speed: 0.0369s/iter; left time: 248.9286s
	iters: 600, epoch: 3 | loss: 0.1288812
	speed: 0.0379s/iter; left time: 252.1479s
	iters: 700, epoch: 3 | loss: 0.1775876
	speed: 0.0329s/iter; left time: 215.1863s
	iters: 800, epoch: 3 | loss: 0.1696465
	speed: 0.0344s/iter; left time: 221.9881s
	iters: 900, epoch: 3 | loss: 0.1122214
	speed: 0.0380s/iter; left time: 240.9934s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:31.80s
Steps: 906 | Train Loss: 0.1547121 Vali Loss: 0.2188322 Test Loss: 0.2404817
Validation loss decreased (0.236116 --> 0.218832).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1234310
	speed: 0.0977s/iter; left time: 609.6995s
	iters: 200, epoch: 4 | loss: 0.1373686
	speed: 0.0366s/iter; left time: 225.0563s
	iters: 300, epoch: 4 | loss: 0.1926513
	speed: 0.0375s/iter; left time: 226.8003s
	iters: 400, epoch: 4 | loss: 0.1139159
	speed: 0.0380s/iter; left time: 225.7806s
	iters: 500, epoch: 4 | loss: 0.1539346
	speed: 0.0373s/iter; left time: 217.9122s
	iters: 600, epoch: 4 | loss: 0.1449407
	speed: 0.0375s/iter; left time: 215.1549s
	iters: 700, epoch: 4 | loss: 0.1607359
	speed: 0.0386s/iter; left time: 218.0108s
	iters: 800, epoch: 4 | loss: 0.0864749
	speed: 0.0378s/iter; left time: 209.2507s
	iters: 900, epoch: 4 | loss: 0.0848118
	speed: 0.0370s/iter; left time: 201.5581s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:34.25s
Steps: 906 | Train Loss: 0.1330943 Vali Loss: 0.2275613 Test Loss: 0.2438716
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1344619
	speed: 0.1005s/iter; left time: 536.3949s
	iters: 200, epoch: 5 | loss: 0.0850486
	speed: 0.0389s/iter; left time: 203.5588s
	iters: 300, epoch: 5 | loss: 0.0993451
	speed: 0.0395s/iter; left time: 202.7753s
	iters: 400, epoch: 5 | loss: 0.1076651
	speed: 0.0439s/iter; left time: 220.8951s
	iters: 500, epoch: 5 | loss: 0.0834811
	speed: 0.0425s/iter; left time: 209.7423s
	iters: 600, epoch: 5 | loss: 0.1155935
	speed: 0.0444s/iter; left time: 214.6402s
	iters: 700, epoch: 5 | loss: 0.0924196
	speed: 0.0408s/iter; left time: 193.2083s
	iters: 800, epoch: 5 | loss: 0.1086210
	speed: 0.0418s/iter; left time: 193.8174s
	iters: 900, epoch: 5 | loss: 0.0984064
	speed: 0.0412s/iter; left time: 187.1006s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.85s
Steps: 906 | Train Loss: 0.1108767 Vali Loss: 0.2400857 Test Loss: 0.2565831
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.0821117
	speed: 0.0995s/iter; left time: 441.0534s
	iters: 200, epoch: 6 | loss: 0.1051194
	speed: 0.0451s/iter; left time: 195.3229s
	iters: 300, epoch: 6 | loss: 0.1453785
	speed: 0.0439s/iter; left time: 185.8644s
	iters: 400, epoch: 6 | loss: 0.0906615
	speed: 0.0456s/iter; left time: 188.2250s
	iters: 500, epoch: 6 | loss: 0.0889096
	speed: 0.0415s/iter; left time: 167.4831s
	iters: 600, epoch: 6 | loss: 0.0854225
	speed: 0.0398s/iter; left time: 156.6141s
	iters: 700, epoch: 6 | loss: 0.1034291
	speed: 0.0431s/iter; left time: 164.9790s
	iters: 800, epoch: 6 | loss: 0.0754498
	speed: 0.0403s/iter; left time: 150.2563s
	iters: 900, epoch: 6 | loss: 0.0861971
	speed: 0.0407s/iter; left time: 147.8509s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.89s
Steps: 906 | Train Loss: 0.0925012 Vali Loss: 0.2468222 Test Loss: 0.2661139
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.23997162282466888, rmse:0.48986899852752686, mae:0.3382326066493988, rse:0.47618016600608826
Original data scale mse:18265502.0, rmse:4273.81591796875, mae:2791.9541015625, rse:0.21250274777412415

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.25892117619514465, RMSE: 0.5088430047035217, MAE: 0.35830968618392944, RSE: 0.49462392926216125
Unscaled Metrics - MSE: 20458642.0, RMSE: 4523.123046875, MAE: 3016.656982421875, RSE: 0.2248988002538681

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.23997162282466888, RMSE: 0.48986899852752686, MAE: 0.3382326066493988, RSE: 0.47618016600608826
Unscaled Metrics - MSE: 18265502.0, RMSE: 4273.81591796875, MAE: 2791.9541015625, RSE: 0.21250274777412415

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6546724
	speed: 0.0762s/iter; left time: 681.6704s
	iters: 200, epoch: 1 | loss: 0.5917277
	speed: 0.0450s/iter; left time: 397.5332s
	iters: 300, epoch: 1 | loss: 0.5455086
	speed: 0.0462s/iter; left time: 404.1082s
	iters: 400, epoch: 1 | loss: 0.4482757
	speed: 0.0462s/iter; left time: 399.0896s
	iters: 500, epoch: 1 | loss: 0.4275625
	speed: 0.0449s/iter; left time: 383.7808s
	iters: 600, epoch: 1 | loss: 0.3429817
	speed: 0.0461s/iter; left time: 389.2570s
	iters: 700, epoch: 1 | loss: 0.3445232
	speed: 0.0466s/iter; left time: 388.9749s
	iters: 800, epoch: 1 | loss: 0.3594815
	speed: 0.0466s/iter; left time: 383.7271s
	iters: 900, epoch: 1 | loss: 0.3681027
	speed: 0.0465s/iter; left time: 378.4126s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.54s
Steps: 904 | Train Loss: 0.4762494 Vali Loss: 0.4285059 Test Loss: 0.5598444
Validation loss decreased (inf --> 0.428506).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2989585
	speed: 0.1190s/iter; left time: 956.7349s
	iters: 200, epoch: 2 | loss: 0.3341390
	speed: 0.0460s/iter; left time: 364.9507s
	iters: 300, epoch: 2 | loss: 0.3089204
	speed: 0.0463s/iter; left time: 362.8152s
	iters: 400, epoch: 2 | loss: 0.2703228
	speed: 0.0464s/iter; left time: 358.9036s
	iters: 500, epoch: 2 | loss: 0.2890018
	speed: 0.0443s/iter; left time: 338.4020s
	iters: 600, epoch: 2 | loss: 0.3287902
	speed: 0.0464s/iter; left time: 350.0071s
	iters: 700, epoch: 2 | loss: 0.2626685
	speed: 0.0479s/iter; left time: 356.2692s
	iters: 800, epoch: 2 | loss: 0.3108012
	speed: 0.0495s/iter; left time: 362.8964s
	iters: 900, epoch: 2 | loss: 0.2511025
	speed: 0.0496s/iter; left time: 359.2948s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.80s
Steps: 904 | Train Loss: 0.3040894 Vali Loss: 0.3595099 Test Loss: 0.4340324
Validation loss decreased (0.428506 --> 0.359510).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3092229
	speed: 0.1213s/iter; left time: 864.9135s
	iters: 200, epoch: 3 | loss: 0.2202515
	speed: 0.0474s/iter; left time: 333.2600s
	iters: 300, epoch: 3 | loss: 0.2092332
	speed: 0.0475s/iter; left time: 329.3006s
	iters: 400, epoch: 3 | loss: 0.2289536
	speed: 0.0450s/iter; left time: 307.3094s
	iters: 500, epoch: 3 | loss: 0.2403625
	speed: 0.0468s/iter; left time: 314.8969s
	iters: 600, epoch: 3 | loss: 0.2494952
	speed: 0.0444s/iter; left time: 294.5056s
	iters: 700, epoch: 3 | loss: 0.2256481
	speed: 0.0466s/iter; left time: 304.6591s
	iters: 800, epoch: 3 | loss: 0.2503496
	speed: 0.0499s/iter; left time: 321.2960s
	iters: 900, epoch: 3 | loss: 0.2428420
	speed: 0.0471s/iter; left time: 298.1679s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.80s
Steps: 904 | Train Loss: 0.2430000 Vali Loss: 0.3543893 Test Loss: 0.4415607
Validation loss decreased (0.359510 --> 0.354389).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1979982
	speed: 0.1164s/iter; left time: 724.8426s
	iters: 200, epoch: 4 | loss: 0.2111989
	speed: 0.0435s/iter; left time: 266.4801s
	iters: 300, epoch: 4 | loss: 0.1935357
	speed: 0.0433s/iter; left time: 261.1182s
	iters: 400, epoch: 4 | loss: 0.1566828
	speed: 0.0433s/iter; left time: 256.5897s
	iters: 500, epoch: 4 | loss: 0.2228490
	speed: 0.0427s/iter; left time: 249.1554s
	iters: 600, epoch: 4 | loss: 0.1653641
	speed: 0.0442s/iter; left time: 253.1142s
	iters: 700, epoch: 4 | loss: 0.2101256
	speed: 0.0439s/iter; left time: 247.1517s
	iters: 800, epoch: 4 | loss: 0.1827935
	speed: 0.0430s/iter; left time: 237.9455s
	iters: 900, epoch: 4 | loss: 0.2207310
	speed: 0.0439s/iter; left time: 238.2167s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:39.60s
Steps: 904 | Train Loss: 0.2000465 Vali Loss: 0.3768986 Test Loss: 0.4664588
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1634137
	speed: 0.1114s/iter; left time: 593.1064s
	iters: 200, epoch: 5 | loss: 0.2103482
	speed: 0.0460s/iter; left time: 240.4412s
	iters: 300, epoch: 5 | loss: 0.1699097
	speed: 0.0483s/iter; left time: 247.5357s
	iters: 400, epoch: 5 | loss: 0.1680366
	speed: 0.0467s/iter; left time: 234.5862s
	iters: 500, epoch: 5 | loss: 0.1486269
	speed: 0.0462s/iter; left time: 227.7463s
	iters: 600, epoch: 5 | loss: 0.1546813
	speed: 0.0426s/iter; left time: 205.6913s
	iters: 700, epoch: 5 | loss: 0.1439729
	speed: 0.0425s/iter; left time: 201.0203s
	iters: 800, epoch: 5 | loss: 0.1317349
	speed: 0.0439s/iter; left time: 202.8822s
	iters: 900, epoch: 5 | loss: 0.1457338
	speed: 0.0440s/iter; left time: 199.1435s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.06s
Steps: 904 | Train Loss: 0.1641401 Vali Loss: 0.3885486 Test Loss: 0.4919951
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1399367
	speed: 0.1160s/iter; left time: 512.7463s
	iters: 200, epoch: 6 | loss: 0.1144286
	speed: 0.0407s/iter; left time: 175.9932s
	iters: 300, epoch: 6 | loss: 0.1403850
	speed: 0.0428s/iter; left time: 180.5859s
	iters: 400, epoch: 6 | loss: 0.1323826
	speed: 0.0413s/iter; left time: 170.1083s
	iters: 500, epoch: 6 | loss: 0.1317175
	speed: 0.0417s/iter; left time: 167.7451s
	iters: 600, epoch: 6 | loss: 0.1453847
	speed: 0.0415s/iter; left time: 162.6731s
	iters: 700, epoch: 6 | loss: 0.1293670
	speed: 0.0461s/iter; left time: 176.2985s
	iters: 800, epoch: 6 | loss: 0.1634474
	speed: 0.0474s/iter; left time: 176.4694s
	iters: 900, epoch: 6 | loss: 0.1342661
	speed: 0.0473s/iter; left time: 171.1382s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:39.69s
Steps: 904 | Train Loss: 0.1395794 Vali Loss: 0.4038204 Test Loss: 0.5043370
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.4419127106666565, rmse:0.6647651791572571, mae:0.4733096659183502, rse:0.646569013595581
Original data scale mse:36498908.0, rmse:6041.4326171875, mae:3972.61376953125, rse:0.3008655309677124
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6162369
	speed: 0.0452s/iter; left time: 403.9180s
	iters: 200, epoch: 1 | loss: 0.5928781
	speed: 0.0479s/iter; left time: 423.3046s
	iters: 300, epoch: 1 | loss: 0.4926288
	speed: 0.0481s/iter; left time: 420.5127s
	iters: 400, epoch: 1 | loss: 0.4147618
	speed: 0.0392s/iter; left time: 338.3812s
	iters: 500, epoch: 1 | loss: 0.4681771
	speed: 0.0377s/iter; left time: 322.2926s
	iters: 600, epoch: 1 | loss: 0.4539061
	speed: 0.0476s/iter; left time: 401.6178s
	iters: 700, epoch: 1 | loss: 0.3761141
	speed: 0.0476s/iter; left time: 397.0902s
	iters: 800, epoch: 1 | loss: 0.4220415
	speed: 0.0475s/iter; left time: 391.3020s
	iters: 900, epoch: 1 | loss: 0.3255250
	speed: 0.0475s/iter; left time: 386.7998s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.09s
Steps: 904 | Train Loss: 0.4757864 Vali Loss: 0.4285903 Test Loss: 0.5639002
Validation loss decreased (inf --> 0.428590).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3665039
	speed: 0.1175s/iter; left time: 944.4311s
	iters: 200, epoch: 2 | loss: 0.3647703
	speed: 0.0474s/iter; left time: 376.1827s
	iters: 300, epoch: 2 | loss: 0.2680736
	speed: 0.0472s/iter; left time: 369.7283s
	iters: 400, epoch: 2 | loss: 0.2768405
	speed: 0.0472s/iter; left time: 365.3940s
	iters: 500, epoch: 2 | loss: 0.2867185
	speed: 0.0472s/iter; left time: 360.4352s
	iters: 600, epoch: 2 | loss: 0.2977949
	speed: 0.0474s/iter; left time: 357.5699s
	iters: 700, epoch: 2 | loss: 0.2797135
	speed: 0.0474s/iter; left time: 352.3078s
	iters: 800, epoch: 2 | loss: 0.3295987
	speed: 0.0473s/iter; left time: 347.0406s
	iters: 900, epoch: 2 | loss: 0.2671846
	speed: 0.0469s/iter; left time: 339.2475s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.98s
Steps: 904 | Train Loss: 0.3036662 Vali Loss: 0.3695144 Test Loss: 0.4423220
Validation loss decreased (0.428590 --> 0.369514).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2837098
	speed: 0.1173s/iter; left time: 836.5372s
	iters: 200, epoch: 3 | loss: 0.2514321
	speed: 0.0478s/iter; left time: 336.5144s
	iters: 300, epoch: 3 | loss: 0.2103887
	speed: 0.0429s/iter; left time: 297.6180s
	iters: 400, epoch: 3 | loss: 0.2059026
	speed: 0.0479s/iter; left time: 327.1647s
	iters: 500, epoch: 3 | loss: 0.1989901
	speed: 0.0478s/iter; left time: 321.6039s
	iters: 600, epoch: 3 | loss: 0.2754957
	speed: 0.0477s/iter; left time: 316.5512s
	iters: 700, epoch: 3 | loss: 0.2409394
	speed: 0.0478s/iter; left time: 312.2856s
	iters: 800, epoch: 3 | loss: 0.2474875
	speed: 0.0475s/iter; left time: 305.8016s
	iters: 900, epoch: 3 | loss: 0.1864163
	speed: 0.0478s/iter; left time: 302.6757s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.94s
Steps: 904 | Train Loss: 0.2469032 Vali Loss: 0.3693818 Test Loss: 0.5008774
Validation loss decreased (0.369514 --> 0.369382).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1604201
	speed: 0.1201s/iter; left time: 748.1303s
	iters: 200, epoch: 4 | loss: 0.2122452
	speed: 0.0480s/iter; left time: 294.2486s
	iters: 300, epoch: 4 | loss: 0.2110735
	speed: 0.0479s/iter; left time: 288.9838s
	iters: 400, epoch: 4 | loss: 0.1941804
	speed: 0.0480s/iter; left time: 284.6908s
	iters: 500, epoch: 4 | loss: 0.2281753
	speed: 0.0478s/iter; left time: 278.9157s
	iters: 600, epoch: 4 | loss: 0.1882456
	speed: 0.0478s/iter; left time: 273.9929s
	iters: 700, epoch: 4 | loss: 0.2477907
	speed: 0.0479s/iter; left time: 269.5466s
	iters: 800, epoch: 4 | loss: 0.1979517
	speed: 0.0480s/iter; left time: 265.4489s
	iters: 900, epoch: 4 | loss: 0.1732447
	speed: 0.0479s/iter; left time: 259.8777s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.65s
Steps: 904 | Train Loss: 0.2056369 Vali Loss: 0.3753512 Test Loss: 0.4872772
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1660488
	speed: 0.1138s/iter; left time: 606.2151s
	iters: 200, epoch: 5 | loss: 0.1781305
	speed: 0.0479s/iter; left time: 250.0496s
	iters: 300, epoch: 5 | loss: 0.1806497
	speed: 0.0479s/iter; left time: 245.7192s
	iters: 400, epoch: 5 | loss: 0.1743275
	speed: 0.0478s/iter; left time: 240.3583s
	iters: 500, epoch: 5 | loss: 0.1676579
	speed: 0.0481s/iter; left time: 236.7245s
	iters: 600, epoch: 5 | loss: 0.1889997
	speed: 0.0480s/iter; left time: 231.4133s
	iters: 700, epoch: 5 | loss: 0.1634367
	speed: 0.0480s/iter; left time: 226.5826s
	iters: 800, epoch: 5 | loss: 0.1637001
	speed: 0.0478s/iter; left time: 221.0903s
	iters: 900, epoch: 5 | loss: 0.1383694
	speed: 0.0479s/iter; left time: 216.7232s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.52s
Steps: 904 | Train Loss: 0.1678519 Vali Loss: 0.3705670 Test Loss: 0.4764751
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1255683
	speed: 0.1140s/iter; left time: 504.0310s
	iters: 200, epoch: 6 | loss: 0.1423870
	speed: 0.0477s/iter; left time: 206.3230s
	iters: 300, epoch: 6 | loss: 0.1751436
	speed: 0.0477s/iter; left time: 201.4837s
	iters: 400, epoch: 6 | loss: 0.1283779
	speed: 0.0477s/iter; left time: 196.7157s
	iters: 500, epoch: 6 | loss: 0.1471216
	speed: 0.0478s/iter; left time: 192.2720s
	iters: 600, epoch: 6 | loss: 0.1371356
	speed: 0.0478s/iter; left time: 187.4798s
	iters: 700, epoch: 6 | loss: 0.1250925
	speed: 0.0473s/iter; left time: 180.8255s
	iters: 800, epoch: 6 | loss: 0.1131927
	speed: 0.0479s/iter; left time: 178.1336s
	iters: 900, epoch: 6 | loss: 0.1198367
	speed: 0.0465s/iter; left time: 168.4999s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.23s
Steps: 904 | Train Loss: 0.1412776 Vali Loss: 0.3726344 Test Loss: 0.5208377
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.5002959370613098, rmse:0.707315981388092, mae:0.5115302801132202, rse:0.6879551410675049
Original data scale mse:42418092.0, rmse:6512.91748046875, mae:4375.43310546875, rse:0.3243456184864044

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.4419127106666565, RMSE: 0.6647651791572571, MAE: 0.4733096659183502, RSE: 0.646569013595581
Unscaled Metrics - MSE: 36498908.0, RMSE: 6041.4326171875, MAE: 3972.61376953125, RSE: 0.3008655309677124

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.5002959370613098, RMSE: 0.707315981388092, MAE: 0.5115302801132202, RSE: 0.6879551410675049
Unscaled Metrics - MSE: 42418092.0, RMSE: 6512.91748046875, MAE: 4375.43310546875, RSE: 0.3243456184864044

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5661607
	speed: 0.0834s/iter; left time: 744.4359s
	iters: 200, epoch: 1 | loss: 0.5773467
	speed: 0.0534s/iter; left time: 470.8143s
	iters: 300, epoch: 1 | loss: 0.5367654
	speed: 0.0534s/iter; left time: 466.0954s
	iters: 400, epoch: 1 | loss: 0.5356638
	speed: 0.0535s/iter; left time: 461.1928s
	iters: 500, epoch: 1 | loss: 0.5021951
	speed: 0.0537s/iter; left time: 457.5255s
	iters: 600, epoch: 1 | loss: 0.5039054
	speed: 0.0537s/iter; left time: 452.0268s
	iters: 700, epoch: 1 | loss: 0.4795872
	speed: 0.0537s/iter; left time: 447.0132s
	iters: 800, epoch: 1 | loss: 0.4552305
	speed: 0.0535s/iter; left time: 440.0517s
	iters: 900, epoch: 1 | loss: 0.4847772
	speed: 0.0536s/iter; left time: 435.1530s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.01s
Steps: 902 | Train Loss: 0.5303793 Vali Loss: 0.5360001 Test Loss: 0.7330878
Validation loss decreased (inf --> 0.536000).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4942363
	speed: 0.1341s/iter; left time: 1075.5835s
	iters: 200, epoch: 2 | loss: 0.4150608
	speed: 0.0535s/iter; left time: 423.7173s
	iters: 300, epoch: 2 | loss: 0.4309613
	speed: 0.0537s/iter; left time: 419.6996s
	iters: 400, epoch: 2 | loss: 0.3440691
	speed: 0.0536s/iter; left time: 413.6222s
	iters: 500, epoch: 2 | loss: 0.3228416
	speed: 0.0535s/iter; left time: 407.7934s
	iters: 600, epoch: 2 | loss: 0.2760397
	speed: 0.0537s/iter; left time: 403.4280s
	iters: 700, epoch: 2 | loss: 0.2734423
	speed: 0.0536s/iter; left time: 397.8374s
	iters: 800, epoch: 2 | loss: 0.3485744
	speed: 0.0537s/iter; left time: 392.7331s
	iters: 900, epoch: 2 | loss: 0.2771853
	speed: 0.0533s/iter; left time: 384.7055s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.53s
Steps: 902 | Train Loss: 0.3442728 Vali Loss: 0.3790651 Test Loss: 0.4672030
Validation loss decreased (0.536000 --> 0.379065).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2745140
	speed: 0.1337s/iter; left time: 951.7490s
	iters: 200, epoch: 3 | loss: 0.2703827
	speed: 0.0536s/iter; left time: 376.1864s
	iters: 300, epoch: 3 | loss: 0.2475511
	speed: 0.0536s/iter; left time: 370.7523s
	iters: 400, epoch: 3 | loss: 0.2924908
	speed: 0.0538s/iter; left time: 366.7699s
	iters: 500, epoch: 3 | loss: 0.2411224
	speed: 0.0536s/iter; left time: 360.0040s
	iters: 600, epoch: 3 | loss: 0.2614779
	speed: 0.0537s/iter; left time: 355.1677s
	iters: 700, epoch: 3 | loss: 0.2655052
	speed: 0.0537s/iter; left time: 350.2530s
	iters: 800, epoch: 3 | loss: 0.2397417
	speed: 0.0537s/iter; left time: 344.5468s
	iters: 900, epoch: 3 | loss: 0.2333572
	speed: 0.0536s/iter; left time: 338.4147s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.2522247 Vali Loss: 0.4058542 Test Loss: 0.4791397
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2076626
	speed: 0.1290s/iter; left time: 801.9073s
	iters: 200, epoch: 4 | loss: 0.1823039
	speed: 0.0535s/iter; left time: 326.8779s
	iters: 300, epoch: 4 | loss: 0.2445515
	speed: 0.0535s/iter; left time: 321.6321s
	iters: 400, epoch: 4 | loss: 0.2183089
	speed: 0.0534s/iter; left time: 315.8086s
	iters: 500, epoch: 4 | loss: 0.2147775
	speed: 0.0537s/iter; left time: 312.3732s
	iters: 600, epoch: 4 | loss: 0.1803208
	speed: 0.0534s/iter; left time: 305.3755s
	iters: 700, epoch: 4 | loss: 0.2064019
	speed: 0.0535s/iter; left time: 300.5236s
	iters: 800, epoch: 4 | loss: 0.2078039
	speed: 0.0536s/iter; left time: 295.4519s
	iters: 900, epoch: 4 | loss: 0.1913311
	speed: 0.0536s/iter; left time: 290.4280s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.2068389 Vali Loss: 0.4290836 Test Loss: 0.5045133
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2150669
	speed: 0.1302s/iter; left time: 691.5577s
	iters: 200, epoch: 5 | loss: 0.1831185
	speed: 0.0544s/iter; left time: 283.6110s
	iters: 300, epoch: 5 | loss: 0.1753126
	speed: 0.0545s/iter; left time: 278.8622s
	iters: 400, epoch: 5 | loss: 0.1991033
	speed: 0.0537s/iter; left time: 269.3088s
	iters: 500, epoch: 5 | loss: 0.1462441
	speed: 0.0544s/iter; left time: 267.3069s
	iters: 600, epoch: 5 | loss: 0.1777929
	speed: 0.0533s/iter; left time: 256.7189s
	iters: 700, epoch: 5 | loss: 0.1745093
	speed: 0.0534s/iter; left time: 251.7675s
	iters: 800, epoch: 5 | loss: 0.1517237
	speed: 0.0535s/iter; left time: 246.9778s
	iters: 900, epoch: 5 | loss: 0.1393686
	speed: 0.0535s/iter; left time: 241.2464s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.82s
Steps: 902 | Train Loss: 0.1729458 Vali Loss: 0.4391145 Test Loss: 0.5485419
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4672527015209198, rmse:0.6835588216781616, mae:0.5047345757484436, rse:0.6628128290176392
Original data scale mse:39235132.0, rmse:6263.79541015625, mae:4307.79296875, rse:0.3120923936367035
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7005892
	speed: 0.0559s/iter; left time: 498.8072s
	iters: 200, epoch: 1 | loss: 0.5440720
	speed: 0.0540s/iter; left time: 475.9243s
	iters: 300, epoch: 1 | loss: 0.4664656
	speed: 0.0540s/iter; left time: 470.8347s
	iters: 400, epoch: 1 | loss: 0.5177964
	speed: 0.0538s/iter; left time: 464.0242s
	iters: 500, epoch: 1 | loss: 0.4846527
	speed: 0.0538s/iter; left time: 458.6007s
	iters: 600, epoch: 1 | loss: 0.5070472
	speed: 0.0543s/iter; left time: 457.4081s
	iters: 700, epoch: 1 | loss: 0.5154229
	speed: 0.0544s/iter; left time: 452.4743s
	iters: 800, epoch: 1 | loss: 0.4440692
	speed: 0.0541s/iter; left time: 444.4924s
	iters: 900, epoch: 1 | loss: 0.4513678
	speed: 0.0539s/iter; left time: 437.4451s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.00s
Steps: 902 | Train Loss: 0.5260653 Vali Loss: 0.5406291 Test Loss: 0.7387776
Validation loss decreased (inf --> 0.540629).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4946011
	speed: 0.1333s/iter; left time: 1068.9107s
	iters: 200, epoch: 2 | loss: 0.3835197
	speed: 0.0538s/iter; left time: 425.6792s
	iters: 300, epoch: 2 | loss: 0.4058985
	speed: 0.0536s/iter; left time: 419.1813s
	iters: 400, epoch: 2 | loss: 0.2835086
	speed: 0.0535s/iter; left time: 412.9563s
	iters: 500, epoch: 2 | loss: 0.3513405
	speed: 0.0536s/iter; left time: 408.5779s
	iters: 600, epoch: 2 | loss: 0.2929164
	speed: 0.0536s/iter; left time: 402.6733s
	iters: 700, epoch: 2 | loss: 0.3086975
	speed: 0.0536s/iter; left time: 397.4702s
	iters: 800, epoch: 2 | loss: 0.2758642
	speed: 0.0537s/iter; left time: 392.7753s
	iters: 900, epoch: 2 | loss: 0.2786883
	speed: 0.0535s/iter; left time: 386.3511s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.3549529 Vali Loss: 0.3977152 Test Loss: 0.4635265
Validation loss decreased (0.540629 --> 0.397715).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2768619
	speed: 0.1347s/iter; left time: 958.7518s
	iters: 200, epoch: 3 | loss: 0.2381207
	speed: 0.0536s/iter; left time: 376.1993s
	iters: 300, epoch: 3 | loss: 0.2398777
	speed: 0.0535s/iter; left time: 370.0418s
	iters: 400, epoch: 3 | loss: 0.2269317
	speed: 0.0537s/iter; left time: 365.9528s
	iters: 500, epoch: 3 | loss: 0.2643320
	speed: 0.0536s/iter; left time: 359.8064s
	iters: 600, epoch: 3 | loss: 0.2446325
	speed: 0.0534s/iter; left time: 353.3040s
	iters: 700, epoch: 3 | loss: 0.2594030
	speed: 0.0534s/iter; left time: 348.2019s
	iters: 800, epoch: 3 | loss: 0.2039291
	speed: 0.0535s/iter; left time: 343.6192s
	iters: 900, epoch: 3 | loss: 0.2343226
	speed: 0.0536s/iter; left time: 338.4184s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.52s
Steps: 902 | Train Loss: 0.2570016 Vali Loss: 0.4234625 Test Loss: 0.4815665
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.1915036
	speed: 0.1295s/iter; left time: 804.7385s
	iters: 200, epoch: 4 | loss: 0.2288480
	speed: 0.0538s/iter; left time: 329.1341s
	iters: 300, epoch: 4 | loss: 0.2517293
	speed: 0.0537s/iter; left time: 322.9278s
	iters: 400, epoch: 4 | loss: 0.2164890
	speed: 0.0537s/iter; left time: 317.7915s
	iters: 500, epoch: 4 | loss: 0.2290688
	speed: 0.0536s/iter; left time: 311.9111s
	iters: 600, epoch: 4 | loss: 0.2107725
	speed: 0.0536s/iter; left time: 306.3217s
	iters: 700, epoch: 4 | loss: 0.2010569
	speed: 0.0537s/iter; left time: 301.6399s
	iters: 800, epoch: 4 | loss: 0.1858583
	speed: 0.0535s/iter; left time: 294.7926s
	iters: 900, epoch: 4 | loss: 0.1948081
	speed: 0.0538s/iter; left time: 291.4293s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.61s
Steps: 902 | Train Loss: 0.2112538 Vali Loss: 0.4369511 Test Loss: 0.5081213
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.1695156
	speed: 0.1295s/iter; left time: 687.8829s
	iters: 200, epoch: 5 | loss: 0.1669810
	speed: 0.0537s/iter; left time: 279.8404s
	iters: 300, epoch: 5 | loss: 0.1833070
	speed: 0.0537s/iter; left time: 274.5467s
	iters: 400, epoch: 5 | loss: 0.1643036
	speed: 0.0538s/iter; left time: 269.5751s
	iters: 500, epoch: 5 | loss: 0.1790071
	speed: 0.0535s/iter; left time: 262.9803s
	iters: 600, epoch: 5 | loss: 0.1698678
	speed: 0.0538s/iter; left time: 258.7818s
	iters: 700, epoch: 5 | loss: 0.1591146
	speed: 0.0538s/iter; left time: 253.6107s
	iters: 800, epoch: 5 | loss: 0.1756431
	speed: 0.0539s/iter; left time: 248.6112s
	iters: 900, epoch: 5 | loss: 0.1827278
	speed: 0.0534s/iter; left time: 240.8934s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.61s
Steps: 902 | Train Loss: 0.1758139 Vali Loss: 0.4381305 Test Loss: 0.5416551
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4635637104511261, rmse:0.6808551549911499, mae:0.5041408538818359, rse:0.6601911783218384
Original data scale mse:37890544.0, rmse:6155.52978515625, mae:4260.3515625, rse:0.3066980540752411

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.4672527015209198, RMSE: 0.6835588216781616, MAE: 0.5047345757484436, RSE: 0.6628128290176392
Unscaled Metrics - MSE: 39235132.0, RMSE: 6263.79541015625, MAE: 4307.79296875, RSE: 0.3120923936367035

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.4635637104511261, RMSE: 0.6808551549911499, MAE: 0.5041408538818359, RSE: 0.6601911783218384
Unscaled Metrics - MSE: 37890544.0, RMSE: 6155.52978515625, MAE: 4260.3515625, RSE: 0.3066980540752411

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.7461114
	speed: 0.0729s/iter; left time: 653.2421s
	iters: 200, epoch: 1 | loss: 0.6529073
	speed: 0.0452s/iter; left time: 400.7829s
	iters: 300, epoch: 1 | loss: 0.5782019
	speed: 0.0447s/iter; left time: 391.2271s
	iters: 400, epoch: 1 | loss: 0.4998610
	speed: 0.0417s/iter; left time: 361.1327s
	iters: 500, epoch: 1 | loss: 0.4716066
	speed: 0.0422s/iter; left time: 361.3435s
	iters: 600, epoch: 1 | loss: 0.4612486
	speed: 0.0420s/iter; left time: 355.2164s
	iters: 700, epoch: 1 | loss: 0.5836230
	speed: 0.0412s/iter; left time: 344.5760s
	iters: 800, epoch: 1 | loss: 0.4892212
	speed: 0.0417s/iter; left time: 344.8892s
	iters: 900, epoch: 1 | loss: 0.4281857
	speed: 0.0425s/iter; left time: 347.0908s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:39.37s
Steps: 906 | Train Loss: 0.5736664 Vali Loss: 0.2776520 Test Loss: 0.3264864
Validation loss decreased (inf --> 0.277652).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3683157
	speed: 0.0995s/iter; left time: 801.7695s
	iters: 200, epoch: 2 | loss: 0.4829518
	speed: 0.0422s/iter; left time: 336.0627s
	iters: 300, epoch: 2 | loss: 0.4098303
	speed: 0.0424s/iter; left time: 332.9070s
	iters: 400, epoch: 2 | loss: 0.4821565
	speed: 0.0421s/iter; left time: 326.3029s
	iters: 500, epoch: 2 | loss: 0.3629837
	speed: 0.0418s/iter; left time: 319.9717s
	iters: 600, epoch: 2 | loss: 0.3894433
	speed: 0.0424s/iter; left time: 320.2136s
	iters: 700, epoch: 2 | loss: 0.3796617
	speed: 0.0425s/iter; left time: 316.8922s
	iters: 800, epoch: 2 | loss: 0.4837652
	speed: 0.0423s/iter; left time: 311.0812s
	iters: 900, epoch: 2 | loss: 0.3858483
	speed: 0.0421s/iter; left time: 305.1908s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.50s
Steps: 906 | Train Loss: 0.4253383 Vali Loss: 0.2241649 Test Loss: 0.2627058
Validation loss decreased (0.277652 --> 0.224165).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4184601
	speed: 0.1024s/iter; left time: 731.9409s
	iters: 200, epoch: 3 | loss: 0.3589702
	speed: 0.0426s/iter; left time: 300.3382s
	iters: 300, epoch: 3 | loss: 0.3864741
	speed: 0.0422s/iter; left time: 293.3764s
	iters: 400, epoch: 3 | loss: 0.3798923
	speed: 0.0429s/iter; left time: 294.0842s
	iters: 500, epoch: 3 | loss: 0.4409139
	speed: 0.0431s/iter; left time: 290.7996s
	iters: 600, epoch: 3 | loss: 0.4163352
	speed: 0.0430s/iter; left time: 285.8029s
	iters: 700, epoch: 3 | loss: 0.3735642
	speed: 0.0424s/iter; left time: 277.7434s
	iters: 800, epoch: 3 | loss: 0.3934213
	speed: 0.0427s/iter; left time: 275.1484s
	iters: 900, epoch: 3 | loss: 0.4092320
	speed: 0.0420s/iter; left time: 266.9058s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.79s
Steps: 906 | Train Loss: 0.3886658 Vali Loss: 0.2281934 Test Loss: 0.2456208
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3426898
	speed: 0.0962s/iter; left time: 600.6490s
	iters: 200, epoch: 4 | loss: 0.3767607
	speed: 0.0420s/iter; left time: 258.0149s
	iters: 300, epoch: 4 | loss: 0.3620969
	speed: 0.0423s/iter; left time: 255.4610s
	iters: 400, epoch: 4 | loss: 0.3348826
	speed: 0.0417s/iter; left time: 247.7296s
	iters: 500, epoch: 4 | loss: 0.3849360
	speed: 0.0424s/iter; left time: 248.0058s
	iters: 600, epoch: 4 | loss: 0.3511573
	speed: 0.0416s/iter; left time: 238.9739s
	iters: 700, epoch: 4 | loss: 0.3626874
	speed: 0.0420s/iter; left time: 237.0702s
	iters: 800, epoch: 4 | loss: 0.4081291
	speed: 0.0416s/iter; left time: 230.4969s
	iters: 900, epoch: 4 | loss: 0.3658917
	speed: 0.0420s/iter; left time: 228.5584s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.25s
Steps: 906 | Train Loss: 0.3597047 Vali Loss: 0.2268562 Test Loss: 0.2519057
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3171598
	speed: 0.0956s/iter; left time: 509.9764s
	iters: 200, epoch: 5 | loss: 0.3283252
	speed: 0.0431s/iter; left time: 225.8955s
	iters: 300, epoch: 5 | loss: 0.3180558
	speed: 0.0424s/iter; left time: 217.6807s
	iters: 400, epoch: 5 | loss: 0.3296632
	speed: 0.0429s/iter; left time: 216.3145s
	iters: 500, epoch: 5 | loss: 0.3155017
	speed: 0.0431s/iter; left time: 212.6097s
	iters: 600, epoch: 5 | loss: 0.3432666
	speed: 0.0425s/iter; left time: 205.6570s
	iters: 700, epoch: 5 | loss: 0.3247659
	speed: 0.0426s/iter; left time: 201.6626s
	iters: 800, epoch: 5 | loss: 0.3334618
	speed: 0.0424s/iter; left time: 196.5720s
	iters: 900, epoch: 5 | loss: 0.3186741
	speed: 0.0427s/iter; left time: 193.5198s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.86s
Steps: 906 | Train Loss: 0.3285794 Vali Loss: 0.2464904 Test Loss: 0.2767749
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.26270100474357605, rmse:0.5125436782836914, mae:0.35968947410583496, rse:0.49822118878364563
Original data scale mse:20469224.0, rmse:4524.29248046875, mae:3007.160888671875, rse:0.2249569594860077
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.6982029
	speed: 0.0435s/iter; left time: 389.9003s
	iters: 200, epoch: 1 | loss: 0.6159171
	speed: 0.0411s/iter; left time: 363.7823s
	iters: 300, epoch: 1 | loss: 0.6252606
	speed: 0.0415s/iter; left time: 363.8841s
	iters: 400, epoch: 1 | loss: 0.5463977
	speed: 0.0425s/iter; left time: 367.9656s
	iters: 500, epoch: 1 | loss: 0.5218451
	speed: 0.0424s/iter; left time: 362.9303s
	iters: 600, epoch: 1 | loss: 0.5027246
	speed: 0.0421s/iter; left time: 356.4968s
	iters: 700, epoch: 1 | loss: 0.4774190
	speed: 0.0418s/iter; left time: 349.7281s
	iters: 800, epoch: 1 | loss: 0.5212248
	speed: 0.0417s/iter; left time: 344.8048s
	iters: 900, epoch: 1 | loss: 0.4854899
	speed: 0.0416s/iter; left time: 339.2083s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.12s
Steps: 906 | Train Loss: 0.5787885 Vali Loss: 0.2744367 Test Loss: 0.3292162
Validation loss decreased (inf --> 0.274437).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4447467
	speed: 0.0983s/iter; left time: 792.1504s
	iters: 200, epoch: 2 | loss: 0.4412494
	speed: 0.0427s/iter; left time: 339.7156s
	iters: 300, epoch: 2 | loss: 0.3834315
	speed: 0.0420s/iter; left time: 330.0989s
	iters: 400, epoch: 2 | loss: 0.3791665
	speed: 0.0424s/iter; left time: 328.5550s
	iters: 500, epoch: 2 | loss: 0.4030372
	speed: 0.0422s/iter; left time: 323.1161s
	iters: 600, epoch: 2 | loss: 0.4322845
	speed: 0.0424s/iter; left time: 320.5036s
	iters: 700, epoch: 2 | loss: 0.4121600
	speed: 0.0423s/iter; left time: 315.6476s
	iters: 800, epoch: 2 | loss: 0.3963506
	speed: 0.0427s/iter; left time: 314.3304s
	iters: 900, epoch: 2 | loss: 0.4162798
	speed: 0.0423s/iter; left time: 306.7681s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:38.57s
Steps: 906 | Train Loss: 0.4284949 Vali Loss: 0.2428965 Test Loss: 0.2610460
Validation loss decreased (0.274437 --> 0.242897).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4397380
	speed: 0.1002s/iter; left time: 716.5522s
	iters: 200, epoch: 3 | loss: 0.3714135
	speed: 0.0424s/iter; left time: 298.8899s
	iters: 300, epoch: 3 | loss: 0.3511816
	speed: 0.0417s/iter; left time: 289.6677s
	iters: 400, epoch: 3 | loss: 0.3657738
	speed: 0.0420s/iter; left time: 287.4150s
	iters: 500, epoch: 3 | loss: 0.3857349
	speed: 0.0425s/iter; left time: 286.9333s
	iters: 600, epoch: 3 | loss: 0.3564664
	speed: 0.0426s/iter; left time: 282.9222s
	iters: 700, epoch: 3 | loss: 0.4113604
	speed: 0.0415s/iter; left time: 272.0022s
	iters: 800, epoch: 3 | loss: 0.4029407
	speed: 0.0423s/iter; left time: 272.6296s
	iters: 900, epoch: 3 | loss: 0.3328545
	speed: 0.0421s/iter; left time: 267.1321s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:38.37s
Steps: 906 | Train Loss: 0.3896632 Vali Loss: 0.2230347 Test Loss: 0.2456640
Validation loss decreased (0.242897 --> 0.223035).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3423200
	speed: 0.0989s/iter; left time: 617.3377s
	iters: 200, epoch: 4 | loss: 0.3631905
	speed: 0.0424s/iter; left time: 260.3886s
	iters: 300, epoch: 4 | loss: 0.4438168
	speed: 0.0424s/iter; left time: 256.2967s
	iters: 400, epoch: 4 | loss: 0.3389303
	speed: 0.0422s/iter; left time: 251.0473s
	iters: 500, epoch: 4 | loss: 0.4199861
	speed: 0.0427s/iter; left time: 249.6348s
	iters: 600, epoch: 4 | loss: 0.3683004
	speed: 0.0427s/iter; left time: 245.3397s
	iters: 700, epoch: 4 | loss: 0.4172399
	speed: 0.0427s/iter; left time: 241.1295s
	iters: 800, epoch: 4 | loss: 0.2912661
	speed: 0.0429s/iter; left time: 237.6079s
	iters: 900, epoch: 4 | loss: 0.2848796
	speed: 0.0423s/iter; left time: 230.4467s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:38.80s
Steps: 906 | Train Loss: 0.3617161 Vali Loss: 0.2258493 Test Loss: 0.2433495
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3664494
	speed: 0.0955s/iter; left time: 509.5410s
	iters: 200, epoch: 5 | loss: 0.3080376
	speed: 0.0429s/iter; left time: 224.7448s
	iters: 300, epoch: 5 | loss: 0.3119627
	speed: 0.0430s/iter; left time: 221.1460s
	iters: 400, epoch: 5 | loss: 0.3210239
	speed: 0.0422s/iter; left time: 212.7514s
	iters: 500, epoch: 5 | loss: 0.2903818
	speed: 0.0426s/iter; left time: 210.5273s
	iters: 600, epoch: 5 | loss: 0.3254892
	speed: 0.0431s/iter; left time: 208.3971s
	iters: 700, epoch: 5 | loss: 0.3048323
	speed: 0.0432s/iter; left time: 204.4320s
	iters: 800, epoch: 5 | loss: 0.3096336
	speed: 0.0429s/iter; left time: 198.7381s
	iters: 900, epoch: 5 | loss: 0.3121783
	speed: 0.0426s/iter; left time: 193.2483s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:38.95s
Steps: 906 | Train Loss: 0.3286614 Vali Loss: 0.2403434 Test Loss: 0.2644661
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2932463
	speed: 0.0961s/iter; left time: 425.8249s
	iters: 200, epoch: 6 | loss: 0.3175998
	speed: 0.0421s/iter; left time: 182.2357s
	iters: 300, epoch: 6 | loss: 0.3656258
	speed: 0.0420s/iter; left time: 177.7870s
	iters: 400, epoch: 6 | loss: 0.3123351
	speed: 0.0429s/iter; left time: 177.0281s
	iters: 500, epoch: 6 | loss: 0.2891043
	speed: 0.0430s/iter; left time: 173.3351s
	iters: 600, epoch: 6 | loss: 0.3142055
	speed: 0.0422s/iter; left time: 165.9260s
	iters: 700, epoch: 6 | loss: 0.2970073
	speed: 0.0429s/iter; left time: 164.3137s
	iters: 800, epoch: 6 | loss: 0.2884398
	speed: 0.0426s/iter; left time: 158.9496s
	iters: 900, epoch: 6 | loss: 0.2932458
	speed: 0.0430s/iter; left time: 156.0366s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.77s
Steps: 906 | Train Loss: 0.3011564 Vali Loss: 0.2485842 Test Loss: 0.2648035
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.24519793689250946, rmse:0.4951746463775635, mae:0.34172382950782776, rse:0.4813375771045685
Original data scale mse:18739230.0, rmse:4328.88330078125, mae:2822.332763671875, rse:0.21524080634117126

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.26270100474357605, RMSE: 0.5125436782836914, MAE: 0.35968947410583496, RSE: 0.49822118878364563
Unscaled Metrics - MSE: 20469224.0, RMSE: 4524.29248046875, MAE: 3007.160888671875, RSE: 0.2249569594860077

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.24519793689250946, RMSE: 0.4951746463775635, MAE: 0.34172382950782776, RSE: 0.4813375771045685
Unscaled Metrics - MSE: 18739230.0, RMSE: 4328.88330078125, MAE: 2822.332763671875, RSE: 0.21524080634117126

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8064664
	speed: 0.0802s/iter; left time: 717.3188s
	iters: 200, epoch: 1 | loss: 0.7664227
	speed: 0.0487s/iter; left time: 430.4098s
	iters: 300, epoch: 1 | loss: 0.7341076
	speed: 0.0501s/iter; left time: 437.7773s
	iters: 400, epoch: 1 | loss: 0.6616915
	speed: 0.0499s/iter; left time: 431.1638s
	iters: 500, epoch: 1 | loss: 0.6488833
	speed: 0.0482s/iter; left time: 411.2656s
	iters: 600, epoch: 1 | loss: 0.5803346
	speed: 0.0472s/iter; left time: 398.4665s
	iters: 700, epoch: 1 | loss: 0.5828353
	speed: 0.0468s/iter; left time: 390.5578s
	iters: 800, epoch: 1 | loss: 0.5948309
	speed: 0.0472s/iter; left time: 389.2518s
	iters: 900, epoch: 1 | loss: 0.6047560
	speed: 0.0471s/iter; left time: 383.3846s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.45s
Steps: 904 | Train Loss: 0.6821177 Vali Loss: 0.4251803 Test Loss: 0.5550168
Validation loss decreased (inf --> 0.425180).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5454522
	speed: 0.1172s/iter; left time: 942.1691s
	iters: 200, epoch: 2 | loss: 0.5770916
	speed: 0.0477s/iter; left time: 378.3477s
	iters: 300, epoch: 2 | loss: 0.5515141
	speed: 0.0478s/iter; left time: 374.2195s
	iters: 400, epoch: 2 | loss: 0.5206445
	speed: 0.0478s/iter; left time: 370.0396s
	iters: 500, epoch: 2 | loss: 0.5356205
	speed: 0.0478s/iter; left time: 365.1989s
	iters: 600, epoch: 2 | loss: 0.5716960
	speed: 0.0478s/iter; left time: 360.2306s
	iters: 700, epoch: 2 | loss: 0.5138907
	speed: 0.0477s/iter; left time: 354.6510s
	iters: 800, epoch: 2 | loss: 0.5554817
	speed: 0.0477s/iter; left time: 349.9415s
	iters: 900, epoch: 2 | loss: 0.4969156
	speed: 0.0475s/iter; left time: 343.8054s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.36s
Steps: 904 | Train Loss: 0.5482871 Vali Loss: 0.3588398 Test Loss: 0.4320123
Validation loss decreased (0.425180 --> 0.358840).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5557590
	speed: 0.1085s/iter; left time: 773.6815s
	iters: 200, epoch: 3 | loss: 0.4666590
	speed: 0.0354s/iter; left time: 248.8538s
	iters: 300, epoch: 3 | loss: 0.4575912
	speed: 0.0354s/iter; left time: 245.3698s
	iters: 400, epoch: 3 | loss: 0.4686307
	speed: 0.0354s/iter; left time: 241.8925s
	iters: 500, epoch: 3 | loss: 0.4880049
	speed: 0.0354s/iter; left time: 238.3754s
	iters: 600, epoch: 3 | loss: 0.4762916
	speed: 0.0354s/iter; left time: 234.7235s
	iters: 700, epoch: 3 | loss: 0.4483458
	speed: 0.0354s/iter; left time: 231.4640s
	iters: 800, epoch: 3 | loss: 0.4853708
	speed: 0.0354s/iter; left time: 227.7342s
	iters: 900, epoch: 3 | loss: 0.4844504
	speed: 0.0354s/iter; left time: 224.0594s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:32.25s
Steps: 904 | Train Loss: 0.4905927 Vali Loss: 0.3460696 Test Loss: 0.4395411
Validation loss decreased (0.358840 --> 0.346070).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4397926
	speed: 0.1145s/iter; left time: 713.2366s
	iters: 200, epoch: 4 | loss: 0.4575310
	speed: 0.0474s/iter; left time: 290.4533s
	iters: 300, epoch: 4 | loss: 0.4385205
	speed: 0.0473s/iter; left time: 285.2149s
	iters: 400, epoch: 4 | loss: 0.3930130
	speed: 0.0473s/iter; left time: 280.5210s
	iters: 500, epoch: 4 | loss: 0.4680209
	speed: 0.0473s/iter; left time: 275.6596s
	iters: 600, epoch: 4 | loss: 0.4003425
	speed: 0.0472s/iter; left time: 270.2244s
	iters: 700, epoch: 4 | loss: 0.4485963
	speed: 0.0470s/iter; left time: 264.3728s
	iters: 800, epoch: 4 | loss: 0.4115075
	speed: 0.0471s/iter; left time: 260.6856s
	iters: 900, epoch: 4 | loss: 0.4709758
	speed: 0.0472s/iter; left time: 256.4659s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.94s
Steps: 904 | Train Loss: 0.4433273 Vali Loss: 0.3830858 Test Loss: 0.4687644
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4058290
	speed: 0.1122s/iter; left time: 597.5045s
	iters: 200, epoch: 5 | loss: 0.4450139
	speed: 0.0476s/iter; left time: 248.4615s
	iters: 300, epoch: 5 | loss: 0.4318683
	speed: 0.0474s/iter; left time: 242.7717s
	iters: 400, epoch: 5 | loss: 0.3999391
	speed: 0.0475s/iter; left time: 238.5622s
	iters: 500, epoch: 5 | loss: 0.3851315
	speed: 0.0476s/iter; left time: 234.3907s
	iters: 600, epoch: 5 | loss: 0.4026952
	speed: 0.0476s/iter; left time: 229.6545s
	iters: 700, epoch: 5 | loss: 0.3947259
	speed: 0.0476s/iter; left time: 224.7579s
	iters: 800, epoch: 5 | loss: 0.3597316
	speed: 0.0476s/iter; left time: 219.9202s
	iters: 900, epoch: 5 | loss: 0.3766596
	speed: 0.0476s/iter; left time: 215.5402s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.18s
Steps: 904 | Train Loss: 0.4016175 Vali Loss: 0.3793854 Test Loss: 0.4840747
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3668042
	speed: 0.1124s/iter; left time: 496.9763s
	iters: 200, epoch: 6 | loss: 0.3568165
	speed: 0.0471s/iter; left time: 203.4176s
	iters: 300, epoch: 6 | loss: 0.3732386
	speed: 0.0473s/iter; left time: 199.4929s
	iters: 400, epoch: 6 | loss: 0.3572828
	speed: 0.0473s/iter; left time: 194.9045s
	iters: 500, epoch: 6 | loss: 0.3612566
	speed: 0.0473s/iter; left time: 190.0639s
	iters: 600, epoch: 6 | loss: 0.3670929
	speed: 0.0473s/iter; left time: 185.5566s
	iters: 700, epoch: 6 | loss: 0.3390908
	speed: 0.0473s/iter; left time: 180.7646s
	iters: 800, epoch: 6 | loss: 0.3877013
	speed: 0.0474s/iter; left time: 176.3508s
	iters: 900, epoch: 6 | loss: 0.3606498
	speed: 0.0473s/iter; left time: 171.1370s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:42.96s
Steps: 904 | Train Loss: 0.3698651 Vali Loss: 0.3972877 Test Loss: 0.5082203
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.4387984275817871, rmse:0.6624186038970947, mae:0.4693324565887451, rse:0.6442867517471313
Original data scale mse:35833200.0, rmse:5986.083984375, mae:3917.44970703125, rse:0.29810911417007446
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.7826722
	speed: 0.0491s/iter; left time: 439.0545s
	iters: 200, epoch: 1 | loss: 0.7669095
	speed: 0.0476s/iter; left time: 420.5458s
	iters: 300, epoch: 1 | loss: 0.6981553
	speed: 0.0476s/iter; left time: 416.4479s
	iters: 400, epoch: 1 | loss: 0.6360794
	speed: 0.0476s/iter; left time: 410.9331s
	iters: 500, epoch: 1 | loss: 0.6758806
	speed: 0.0478s/iter; left time: 407.9704s
	iters: 600, epoch: 1 | loss: 0.6679193
	speed: 0.0478s/iter; left time: 403.3673s
	iters: 700, epoch: 1 | loss: 0.6072015
	speed: 0.0475s/iter; left time: 396.3501s
	iters: 800, epoch: 1 | loss: 0.6476004
	speed: 0.0476s/iter; left time: 392.4991s
	iters: 900, epoch: 1 | loss: 0.5657718
	speed: 0.0475s/iter; left time: 387.0963s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.29s
Steps: 904 | Train Loss: 0.6816599 Vali Loss: 0.4242748 Test Loss: 0.5577038
Validation loss decreased (inf --> 0.424275).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6051634
	speed: 0.1178s/iter; left time: 946.4430s
	iters: 200, epoch: 2 | loss: 0.6035539
	speed: 0.0471s/iter; left time: 373.8651s
	iters: 300, epoch: 2 | loss: 0.5138240
	speed: 0.0473s/iter; left time: 370.3984s
	iters: 400, epoch: 2 | loss: 0.5254555
	speed: 0.0473s/iter; left time: 365.7251s
	iters: 500, epoch: 2 | loss: 0.5307585
	speed: 0.0472s/iter; left time: 360.1987s
	iters: 600, epoch: 2 | loss: 0.5466508
	speed: 0.0472s/iter; left time: 356.0068s
	iters: 700, epoch: 2 | loss: 0.5277196
	speed: 0.0472s/iter; left time: 350.7495s
	iters: 800, epoch: 2 | loss: 0.5726936
	speed: 0.0473s/iter; left time: 346.7067s
	iters: 900, epoch: 2 | loss: 0.5164347
	speed: 0.0472s/iter; left time: 341.6183s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.94s
Steps: 904 | Train Loss: 0.5480284 Vali Loss: 0.3702663 Test Loss: 0.4406294
Validation loss decreased (0.424275 --> 0.370266).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5355127
	speed: 0.1200s/iter; left time: 855.7171s
	iters: 200, epoch: 3 | loss: 0.5054911
	speed: 0.0479s/iter; left time: 336.7354s
	iters: 300, epoch: 3 | loss: 0.4564782
	speed: 0.0354s/iter; left time: 245.3342s
	iters: 400, epoch: 3 | loss: 0.4572828
	speed: 0.0354s/iter; left time: 242.1407s
	iters: 500, epoch: 3 | loss: 0.4448029
	speed: 0.0354s/iter; left time: 238.1931s
	iters: 600, epoch: 3 | loss: 0.5135291
	speed: 0.0353s/iter; left time: 234.3718s
	iters: 700, epoch: 3 | loss: 0.4969874
	speed: 0.0354s/iter; left time: 231.1370s
	iters: 800, epoch: 3 | loss: 0.4942554
	speed: 0.0354s/iter; left time: 227.6863s
	iters: 900, epoch: 3 | loss: 0.4294151
	speed: 0.0354s/iter; left time: 224.0248s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:34.95s
Steps: 904 | Train Loss: 0.4949856 Vali Loss: 0.3723978 Test Loss: 0.4794962
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4060275
	speed: 0.1118s/iter; left time: 696.2451s
	iters: 200, epoch: 4 | loss: 0.4581123
	speed: 0.0472s/iter; left time: 288.9836s
	iters: 300, epoch: 4 | loss: 0.4457313
	speed: 0.0472s/iter; left time: 284.7329s
	iters: 400, epoch: 4 | loss: 0.4425646
	speed: 0.0471s/iter; left time: 279.2792s
	iters: 500, epoch: 4 | loss: 0.4735631
	speed: 0.0473s/iter; left time: 275.7013s
	iters: 600, epoch: 4 | loss: 0.4367875
	speed: 0.0470s/iter; left time: 269.0201s
	iters: 700, epoch: 4 | loss: 0.4670251
	speed: 0.0472s/iter; left time: 265.8329s
	iters: 800, epoch: 4 | loss: 0.4425907
	speed: 0.0472s/iter; left time: 260.8610s
	iters: 900, epoch: 4 | loss: 0.4075777
	speed: 0.0472s/iter; left time: 256.4630s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:42.86s
Steps: 904 | Train Loss: 0.4485817 Vali Loss: 0.3547851 Test Loss: 0.4712861
Validation loss decreased (0.370266 --> 0.354785).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3921745
	speed: 0.1199s/iter; left time: 638.2794s
	iters: 200, epoch: 5 | loss: 0.4282338
	speed: 0.0472s/iter; left time: 246.7555s
	iters: 300, epoch: 5 | loss: 0.4185658
	speed: 0.0472s/iter; left time: 241.7247s
	iters: 400, epoch: 5 | loss: 0.3942061
	speed: 0.0470s/iter; left time: 236.3538s
	iters: 500, epoch: 5 | loss: 0.4057429
	speed: 0.0473s/iter; left time: 232.7615s
	iters: 600, epoch: 5 | loss: 0.4259904
	speed: 0.0468s/iter; left time: 225.7994s
	iters: 700, epoch: 5 | loss: 0.3964215
	speed: 0.0473s/iter; left time: 223.5740s
	iters: 800, epoch: 5 | loss: 0.3993809
	speed: 0.0474s/iter; left time: 219.0562s
	iters: 900, epoch: 5 | loss: 0.3567997
	speed: 0.0469s/iter; left time: 212.1430s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:42.87s
Steps: 904 | Train Loss: 0.4005559 Vali Loss: 0.3649893 Test Loss: 0.4830398
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3387131
	speed: 0.1124s/iter; left time: 496.8624s
	iters: 200, epoch: 6 | loss: 0.3641458
	speed: 0.0475s/iter; left time: 205.2727s
	iters: 300, epoch: 6 | loss: 0.4022169
	speed: 0.0475s/iter; left time: 200.6078s
	iters: 400, epoch: 6 | loss: 0.3523118
	speed: 0.0475s/iter; left time: 195.6034s
	iters: 500, epoch: 6 | loss: 0.3746400
	speed: 0.0474s/iter; left time: 190.7827s
	iters: 600, epoch: 6 | loss: 0.3501792
	speed: 0.0475s/iter; left time: 186.0868s
	iters: 700, epoch: 6 | loss: 0.3256495
	speed: 0.0388s/iter; left time: 148.2782s
	iters: 800, epoch: 6 | loss: 0.3425799
	speed: 0.0354s/iter; left time: 131.6598s
	iters: 900, epoch: 6 | loss: 0.3267003
	speed: 0.0354s/iter; left time: 128.1811s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:39.77s
Steps: 904 | Train Loss: 0.3663364 Vali Loss: 0.3792255 Test Loss: 0.5282541
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3471676
	speed: 0.1123s/iter; left time: 395.0729s
	iters: 200, epoch: 7 | loss: 0.3320793
	speed: 0.0478s/iter; left time: 163.2199s
	iters: 300, epoch: 7 | loss: 0.3283722
	speed: 0.0476s/iter; left time: 157.7901s
	iters: 400, epoch: 7 | loss: 0.3186728
	speed: 0.0477s/iter; left time: 153.3283s
	iters: 500, epoch: 7 | loss: 0.3287959
	speed: 0.0475s/iter; left time: 148.0350s
	iters: 600, epoch: 7 | loss: 0.3218990
	speed: 0.0476s/iter; left time: 143.7037s
	iters: 700, epoch: 7 | loss: 0.3686137
	speed: 0.0477s/iter; left time: 139.0567s
	iters: 800, epoch: 7 | loss: 0.3285244
	speed: 0.0477s/iter; left time: 134.3893s
	iters: 900, epoch: 7 | loss: 0.3177367
	speed: 0.0477s/iter; left time: 129.5875s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:43.27s
Steps: 904 | Train Loss: 0.3364941 Vali Loss: 0.3665204 Test Loss: 0.5042919
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.471591055393219, rmse:0.6867249011993408, mae:0.48673340678215027, rse:0.667927622795105
Original data scale mse:39601956.0, rmse:6293.00830078125, mae:4131.7314453125, rse:0.31339406967163086

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.4387984275817871, RMSE: 0.6624186038970947, MAE: 0.4693324565887451, RSE: 0.6442867517471313
Unscaled Metrics - MSE: 35833200.0, RMSE: 5986.083984375, MAE: 3917.44970703125, RSE: 0.29810911417007446

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.471591055393219, RMSE: 0.6867249011993408, MAE: 0.48673340678215027, RSE: 0.667927622795105
Unscaled Metrics - MSE: 39601956.0, RMSE: 6293.00830078125, MAE: 4131.7314453125, RSE: 0.31339406967163086

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.7501633
	speed: 0.0825s/iter; left time: 735.6923s
	iters: 200, epoch: 1 | loss: 0.7569238
	speed: 0.0537s/iter; left time: 473.6315s
	iters: 300, epoch: 1 | loss: 0.7307299
	speed: 0.0537s/iter; left time: 468.7290s
	iters: 400, epoch: 1 | loss: 0.7293500
	speed: 0.0535s/iter; left time: 461.4926s
	iters: 500, epoch: 1 | loss: 0.7057337
	speed: 0.0534s/iter; left time: 454.6385s
	iters: 600, epoch: 1 | loss: 0.7072594
	speed: 0.0534s/iter; left time: 449.3014s
	iters: 700, epoch: 1 | loss: 0.6900529
	speed: 0.0534s/iter; left time: 444.2312s
	iters: 800, epoch: 1 | loss: 0.6720834
	speed: 0.0531s/iter; left time: 436.8159s
	iters: 900, epoch: 1 | loss: 0.6936437
	speed: 0.0531s/iter; left time: 431.3310s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.92s
Steps: 902 | Train Loss: 0.7238418 Vali Loss: 0.5320662 Test Loss: 0.7281205
Validation loss decreased (inf --> 0.532066).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7019882
	speed: 0.1333s/iter; left time: 1069.1662s
	iters: 200, epoch: 2 | loss: 0.6359353
	speed: 0.0539s/iter; left time: 426.4663s
	iters: 300, epoch: 2 | loss: 0.6494266
	speed: 0.0536s/iter; left time: 419.1846s
	iters: 400, epoch: 2 | loss: 0.5800546
	speed: 0.0538s/iter; left time: 415.4109s
	iters: 500, epoch: 2 | loss: 0.5660743
	speed: 0.0537s/iter; left time: 409.1051s
	iters: 600, epoch: 2 | loss: 0.5282308
	speed: 0.0537s/iter; left time: 403.7605s
	iters: 700, epoch: 2 | loss: 0.5169588
	speed: 0.0536s/iter; left time: 397.5123s
	iters: 800, epoch: 2 | loss: 0.5812657
	speed: 0.0537s/iter; left time: 392.8220s
	iters: 900, epoch: 2 | loss: 0.5165561
	speed: 0.0535s/iter; left time: 386.4265s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.5807301 Vali Loss: 0.3836309 Test Loss: 0.4612122
Validation loss decreased (0.532066 --> 0.383631).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5295238
	speed: 0.1358s/iter; left time: 966.5868s
	iters: 200, epoch: 3 | loss: 0.5225747
	speed: 0.0544s/iter; left time: 381.9487s
	iters: 300, epoch: 3 | loss: 0.5027869
	speed: 0.0541s/iter; left time: 374.1713s
	iters: 400, epoch: 3 | loss: 0.5515996
	speed: 0.0538s/iter; left time: 366.5063s
	iters: 500, epoch: 3 | loss: 0.5002297
	speed: 0.0536s/iter; left time: 359.8260s
	iters: 600, epoch: 3 | loss: 0.5084694
	speed: 0.0537s/iter; left time: 355.0624s
	iters: 700, epoch: 3 | loss: 0.5194324
	speed: 0.0537s/iter; left time: 349.9077s
	iters: 800, epoch: 3 | loss: 0.4972505
	speed: 0.0537s/iter; left time: 344.5919s
	iters: 900, epoch: 3 | loss: 0.4840217
	speed: 0.0537s/iter; left time: 339.3027s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.87s
Steps: 902 | Train Loss: 0.4992432 Vali Loss: 0.3879341 Test Loss: 0.4769197
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4472435
	speed: 0.1301s/iter; left time: 808.5982s
	iters: 200, epoch: 4 | loss: 0.4252438
	speed: 0.0537s/iter; left time: 328.2038s
	iters: 300, epoch: 4 | loss: 0.4829215
	speed: 0.0536s/iter; left time: 322.5101s
	iters: 400, epoch: 4 | loss: 0.4546541
	speed: 0.0537s/iter; left time: 317.4775s
	iters: 500, epoch: 4 | loss: 0.4641887
	speed: 0.0539s/iter; left time: 313.4692s
	iters: 600, epoch: 4 | loss: 0.4187097
	speed: 0.0537s/iter; left time: 306.8215s
	iters: 700, epoch: 4 | loss: 0.4351173
	speed: 0.0536s/iter; left time: 301.0412s
	iters: 800, epoch: 4 | loss: 0.4638724
	speed: 0.0538s/iter; left time: 296.4928s
	iters: 900, epoch: 4 | loss: 0.4366152
	speed: 0.0537s/iter; left time: 290.8160s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.65s
Steps: 902 | Train Loss: 0.4500228 Vali Loss: 0.4257467 Test Loss: 0.5126336
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4453283
	speed: 0.1306s/iter; left time: 693.9804s
	iters: 200, epoch: 5 | loss: 0.4337400
	speed: 0.0537s/iter; left time: 279.8776s
	iters: 300, epoch: 5 | loss: 0.4144468
	speed: 0.0538s/iter; left time: 275.0815s
	iters: 400, epoch: 5 | loss: 0.4377461
	speed: 0.0539s/iter; left time: 270.2999s
	iters: 500, epoch: 5 | loss: 0.3671501
	speed: 0.0537s/iter; left time: 263.9733s
	iters: 600, epoch: 5 | loss: 0.3930199
	speed: 0.0538s/iter; left time: 258.7675s
	iters: 700, epoch: 5 | loss: 0.4070324
	speed: 0.0537s/iter; left time: 253.2159s
	iters: 800, epoch: 5 | loss: 0.3946013
	speed: 0.0538s/iter; left time: 248.1880s
	iters: 900, epoch: 5 | loss: 0.3659644
	speed: 0.0538s/iter; left time: 242.7858s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.73s
Steps: 902 | Train Loss: 0.4093621 Vali Loss: 0.4312938 Test Loss: 0.5392915
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4609777629375458, rmse:0.6789534091949463, mae:0.5002171397209167, rse:0.6583471894264221
Original data scale mse:38069076.0, rmse:6170.01416015625, mae:4236.10498046875, rse:0.3074197471141815
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8362218
	speed: 0.0557s/iter; left time: 496.8167s
	iters: 200, epoch: 1 | loss: 0.7356129
	speed: 0.0539s/iter; left time: 475.4105s
	iters: 300, epoch: 1 | loss: 0.6807122
	speed: 0.0537s/iter; left time: 468.3342s
	iters: 400, epoch: 1 | loss: 0.7171140
	speed: 0.0538s/iter; left time: 463.6323s
	iters: 500, epoch: 1 | loss: 0.6935529
	speed: 0.0537s/iter; left time: 457.5074s
	iters: 600, epoch: 1 | loss: 0.7096789
	speed: 0.0541s/iter; left time: 455.4460s
	iters: 700, epoch: 1 | loss: 0.7152407
	speed: 0.0542s/iter; left time: 451.2115s
	iters: 800, epoch: 1 | loss: 0.6635863
	speed: 0.0541s/iter; left time: 445.0003s
	iters: 900, epoch: 1 | loss: 0.6691676
	speed: 0.0542s/iter; left time: 440.4967s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.94s
Steps: 902 | Train Loss: 0.7214302 Vali Loss: 0.5380124 Test Loss: 0.7357840
Validation loss decreased (inf --> 0.538012).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6983247
	speed: 0.1357s/iter; left time: 1088.3214s
	iters: 200, epoch: 2 | loss: 0.6180595
	speed: 0.0543s/iter; left time: 429.6240s
	iters: 300, epoch: 2 | loss: 0.6322026
	speed: 0.0544s/iter; left time: 425.4625s
	iters: 400, epoch: 2 | loss: 0.5258986
	speed: 0.0541s/iter; left time: 417.4338s
	iters: 500, epoch: 2 | loss: 0.5912980
	speed: 0.0540s/iter; left time: 411.6743s
	iters: 600, epoch: 2 | loss: 0.5387182
	speed: 0.0542s/iter; left time: 407.7321s
	iters: 700, epoch: 2 | loss: 0.5565358
	speed: 0.0543s/iter; left time: 402.6399s
	iters: 800, epoch: 2 | loss: 0.5232177
	speed: 0.0537s/iter; left time: 393.3298s
	iters: 900, epoch: 2 | loss: 0.5223538
	speed: 0.0537s/iter; left time: 387.5001s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:49.08s
Steps: 902 | Train Loss: 0.5906084 Vali Loss: 0.3991819 Test Loss: 0.4598295
Validation loss decreased (0.538012 --> 0.399182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5225666
	speed: 0.1351s/iter; left time: 961.8050s
	iters: 200, epoch: 3 | loss: 0.4791816
	speed: 0.0545s/iter; left time: 382.3426s
	iters: 300, epoch: 3 | loss: 0.4841701
	speed: 0.0541s/iter; left time: 374.0404s
	iters: 400, epoch: 3 | loss: 0.4705889
	speed: 0.0546s/iter; left time: 371.9224s
	iters: 500, epoch: 3 | loss: 0.5152424
	speed: 0.0540s/iter; left time: 362.7564s
	iters: 600, epoch: 3 | loss: 0.5077010
	speed: 0.0538s/iter; left time: 355.9449s
	iters: 700, epoch: 3 | loss: 0.5025519
	speed: 0.0534s/iter; left time: 348.2476s
	iters: 800, epoch: 3 | loss: 0.4465362
	speed: 0.0536s/iter; left time: 343.7727s
	iters: 900, epoch: 3 | loss: 0.4787401
	speed: 0.0535s/iter; left time: 338.0894s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.93s
Steps: 902 | Train Loss: 0.5040131 Vali Loss: 0.3924748 Test Loss: 0.4811535
Validation loss decreased (0.399182 --> 0.392475).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4340003
	speed: 0.1335s/iter; left time: 829.8872s
	iters: 200, epoch: 4 | loss: 0.4777999
	speed: 0.0534s/iter; left time: 326.7195s
	iters: 300, epoch: 4 | loss: 0.4901440
	speed: 0.0536s/iter; left time: 322.3338s
	iters: 400, epoch: 4 | loss: 0.4576968
	speed: 0.0536s/iter; left time: 316.9316s
	iters: 500, epoch: 4 | loss: 0.4644936
	speed: 0.0536s/iter; left time: 311.6435s
	iters: 600, epoch: 4 | loss: 0.4516342
	speed: 0.0533s/iter; left time: 304.6272s
	iters: 700, epoch: 4 | loss: 0.4495443
	speed: 0.0535s/iter; left time: 300.4960s
	iters: 800, epoch: 4 | loss: 0.4224161
	speed: 0.0536s/iter; left time: 295.6912s
	iters: 900, epoch: 4 | loss: 0.4253691
	speed: 0.0536s/iter; left time: 290.0032s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.51s
Steps: 902 | Train Loss: 0.4550309 Vali Loss: 0.4289837 Test Loss: 0.5100748
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4204411
	speed: 0.1297s/iter; left time: 689.2079s
	iters: 200, epoch: 5 | loss: 0.4049948
	speed: 0.0534s/iter; left time: 278.2820s
	iters: 300, epoch: 5 | loss: 0.4274650
	speed: 0.0535s/iter; left time: 273.6162s
	iters: 400, epoch: 5 | loss: 0.4168011
	speed: 0.0538s/iter; left time: 269.7115s
	iters: 500, epoch: 5 | loss: 0.4206059
	speed: 0.0536s/iter; left time: 263.3751s
	iters: 600, epoch: 5 | loss: 0.4025565
	speed: 0.0537s/iter; left time: 258.3072s
	iters: 700, epoch: 5 | loss: 0.3950890
	speed: 0.0535s/iter; left time: 252.3747s
	iters: 800, epoch: 5 | loss: 0.4090600
	speed: 0.0536s/iter; left time: 247.4201s
	iters: 900, epoch: 5 | loss: 0.4090587
	speed: 0.0537s/iter; left time: 242.2657s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.54s
Steps: 902 | Train Loss: 0.4136486 Vali Loss: 0.4345170 Test Loss: 0.5279194
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3809133
	speed: 0.1299s/iter; left time: 573.1468s
	iters: 200, epoch: 6 | loss: 0.3715863
	speed: 0.0535s/iter; left time: 230.6196s
	iters: 300, epoch: 6 | loss: 0.3729623
	speed: 0.0536s/iter; left time: 225.6296s
	iters: 400, epoch: 6 | loss: 0.3830902
	speed: 0.0537s/iter; left time: 220.7359s
	iters: 500, epoch: 6 | loss: 0.4015138
	speed: 0.0536s/iter; left time: 215.1846s
	iters: 600, epoch: 6 | loss: 0.3586400
	speed: 0.0537s/iter; left time: 209.9872s
	iters: 700, epoch: 6 | loss: 0.3749744
	speed: 0.0536s/iter; left time: 204.2672s
	iters: 800, epoch: 6 | loss: 0.3658184
	speed: 0.0537s/iter; left time: 199.3586s
	iters: 900, epoch: 6 | loss: 0.3755621
	speed: 0.0537s/iter; left time: 193.9775s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.61s
Steps: 902 | Train Loss: 0.3807046 Vali Loss: 0.4451516 Test Loss: 0.5592123
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.4807005226612091, rmse:0.6933256983757019, mae:0.5033847689628601, rse:0.6722832322120667
Original data scale mse:39885020.0, rmse:6315.458984375, mae:4252.66259765625, rse:0.3146664798259735

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.4609777629375458, RMSE: 0.6789534091949463, MAE: 0.5002171397209167, RSE: 0.6583471894264221
Unscaled Metrics - MSE: 38069076.0, RMSE: 6170.01416015625, MAE: 4236.10498046875, RSE: 0.3074197471141815

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.4807005226612091, RMSE: 0.6933256983757019, MAE: 0.5033847689628601, RSE: 0.6722832322120667
Unscaled Metrics - MSE: 39885020.0, RMSE: 6315.458984375, MAE: 4252.66259765625, RSE: 0.3146664798259735

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.5668260
	speed: 0.0706s/iter; left time: 632.3595s
	iters: 200, epoch: 1 | loss: 0.5016366
	speed: 0.0420s/iter; left time: 372.4571s
	iters: 300, epoch: 1 | loss: 0.4471771
	speed: 0.0424s/iter; left time: 371.5963s
	iters: 400, epoch: 1 | loss: 0.3983449
	speed: 0.0415s/iter; left time: 359.2925s
	iters: 500, epoch: 1 | loss: 0.3730129
	speed: 0.0407s/iter; left time: 348.6474s
	iters: 600, epoch: 1 | loss: 0.3658692
	speed: 0.0415s/iter; left time: 351.0720s
	iters: 700, epoch: 1 | loss: 0.4430440
	speed: 0.0421s/iter; left time: 352.0726s
	iters: 800, epoch: 1 | loss: 0.3778132
	speed: 0.0418s/iter; left time: 345.1932s
	iters: 900, epoch: 1 | loss: 0.3254126
	speed: 0.0419s/iter; left time: 342.2593s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:38.52s
Steps: 906 | Train Loss: 0.4427820 Vali Loss: 0.3982988 Test Loss: 0.4282602
Validation loss decreased (inf --> 0.398299).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2804739
	speed: 0.0988s/iter; left time: 796.0292s
	iters: 200, epoch: 2 | loss: 0.3377495
	speed: 0.0414s/iter; left time: 329.6927s
	iters: 300, epoch: 2 | loss: 0.2773281
	speed: 0.0419s/iter; left time: 328.7367s
	iters: 400, epoch: 2 | loss: 0.3087983
	speed: 0.0409s/iter; left time: 317.3040s
	iters: 500, epoch: 2 | loss: 0.2562788
	speed: 0.0410s/iter; left time: 313.9234s
	iters: 600, epoch: 2 | loss: 0.2656093
	speed: 0.0412s/iter; left time: 311.3232s
	iters: 700, epoch: 2 | loss: 0.2561977
	speed: 0.0411s/iter; left time: 306.7177s
	iters: 800, epoch: 2 | loss: 0.3150825
	speed: 0.0412s/iter; left time: 303.1276s
	iters: 900, epoch: 2 | loss: 0.2776596
	speed: 0.0411s/iter; left time: 298.3807s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.70s
Steps: 906 | Train Loss: 0.2973151 Vali Loss: 0.3205824 Test Loss: 0.3422310
Validation loss decreased (0.398299 --> 0.320582).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2690117
	speed: 0.0993s/iter; left time: 709.7462s
	iters: 200, epoch: 3 | loss: 0.2384343
	speed: 0.0405s/iter; left time: 285.2551s
	iters: 300, epoch: 3 | loss: 0.2611229
	speed: 0.0406s/iter; left time: 282.3370s
	iters: 400, epoch: 3 | loss: 0.2572706
	speed: 0.0410s/iter; left time: 280.9500s
	iters: 500, epoch: 3 | loss: 0.3080456
	speed: 0.0406s/iter; left time: 273.8350s
	iters: 600, epoch: 3 | loss: 0.2688888
	speed: 0.0408s/iter; left time: 271.4271s
	iters: 700, epoch: 3 | loss: 0.2642769
	speed: 0.0406s/iter; left time: 265.9083s
	iters: 800, epoch: 3 | loss: 0.2454304
	speed: 0.0408s/iter; left time: 263.3297s
	iters: 900, epoch: 3 | loss: 0.2539083
	speed: 0.0407s/iter; left time: 258.5624s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.19s
Steps: 906 | Train Loss: 0.2597370 Vali Loss: 0.3142181 Test Loss: 0.3285995
Validation loss decreased (0.320582 --> 0.314218).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2250671
	speed: 0.0968s/iter; left time: 604.3000s
	iters: 200, epoch: 4 | loss: 0.2457324
	speed: 0.0408s/iter; left time: 250.4107s
	iters: 300, epoch: 4 | loss: 0.2128700
	speed: 0.0402s/iter; left time: 242.6676s
	iters: 400, epoch: 4 | loss: 0.2110046
	speed: 0.0408s/iter; left time: 242.3396s
	iters: 500, epoch: 4 | loss: 0.2696874
	speed: 0.0411s/iter; left time: 239.8895s
	iters: 600, epoch: 4 | loss: 0.2251461
	speed: 0.0385s/iter; left time: 221.3158s
	iters: 700, epoch: 4 | loss: 0.2191906
	speed: 0.0408s/iter; left time: 230.1066s
	iters: 800, epoch: 4 | loss: 0.2617375
	speed: 0.0410s/iter; left time: 227.4752s
	iters: 900, epoch: 4 | loss: 0.2439935
	speed: 0.0406s/iter; left time: 220.8899s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.92s
Steps: 906 | Train Loss: 0.2418955 Vali Loss: 0.3180152 Test Loss: 0.3273972
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2380923
	speed: 0.0951s/iter; left time: 507.4897s
	iters: 200, epoch: 5 | loss: 0.2289899
	speed: 0.0411s/iter; left time: 215.0195s
	iters: 300, epoch: 5 | loss: 0.2038423
	speed: 0.0412s/iter; left time: 211.5357s
	iters: 400, epoch: 5 | loss: 0.2334992
	speed: 0.0404s/iter; left time: 203.3877s
	iters: 500, epoch: 5 | loss: 0.2128963
	speed: 0.0406s/iter; left time: 200.6080s
	iters: 600, epoch: 5 | loss: 0.2266824
	speed: 0.0410s/iter; left time: 198.3568s
	iters: 700, epoch: 5 | loss: 0.2089754
	speed: 0.0409s/iter; left time: 193.5792s
	iters: 800, epoch: 5 | loss: 0.2322671
	speed: 0.0415s/iter; left time: 192.2096s
	iters: 900, epoch: 5 | loss: 0.2445696
	speed: 0.0406s/iter; left time: 184.4162s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.38s
Steps: 906 | Train Loss: 0.2234831 Vali Loss: 0.3125368 Test Loss: 0.3303335
Validation loss decreased (0.314218 --> 0.312537).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2415015
	speed: 0.0985s/iter; left time: 436.4454s
	iters: 200, epoch: 6 | loss: 0.2221936
	speed: 0.0408s/iter; left time: 176.8517s
	iters: 300, epoch: 6 | loss: 0.2190171
	speed: 0.0410s/iter; left time: 173.4680s
	iters: 400, epoch: 6 | loss: 0.1934973
	speed: 0.0415s/iter; left time: 171.3316s
	iters: 500, epoch: 6 | loss: 0.2184666
	speed: 0.0413s/iter; left time: 166.3530s
	iters: 600, epoch: 6 | loss: 0.1856182
	speed: 0.0408s/iter; left time: 160.2082s
	iters: 700, epoch: 6 | loss: 0.2177500
	speed: 0.0411s/iter; left time: 157.5764s
	iters: 800, epoch: 6 | loss: 0.1806344
	speed: 0.0399s/iter; left time: 148.9734s
	iters: 900, epoch: 6 | loss: 0.1849925
	speed: 0.0414s/iter; left time: 150.3122s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.39s
Steps: 906 | Train Loss: 0.2066747 Vali Loss: 0.3162780 Test Loss: 0.3311647
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1853101
	speed: 0.0949s/iter; left time: 334.6788s
	iters: 200, epoch: 7 | loss: 0.2129820
	speed: 0.0417s/iter; left time: 142.7853s
	iters: 300, epoch: 7 | loss: 0.2126344
	speed: 0.0413s/iter; left time: 137.1671s
	iters: 400, epoch: 7 | loss: 0.2076884
	speed: 0.0412s/iter; left time: 132.7986s
	iters: 500, epoch: 7 | loss: 0.1888626
	speed: 0.0414s/iter; left time: 129.3626s
	iters: 600, epoch: 7 | loss: 0.1700548
	speed: 0.0411s/iter; left time: 124.1805s
	iters: 700, epoch: 7 | loss: 0.1932032
	speed: 0.0413s/iter; left time: 120.8929s
	iters: 800, epoch: 7 | loss: 0.1791998
	speed: 0.0412s/iter; left time: 116.5253s
	iters: 900, epoch: 7 | loss: 0.1883053
	speed: 0.0410s/iter; left time: 111.7766s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.63s
Steps: 906 | Train Loss: 0.1914722 Vali Loss: 0.3156435 Test Loss: 0.3311698
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2017332
	speed: 0.0952s/iter; left time: 249.2589s
	iters: 200, epoch: 8 | loss: 0.1626274
	speed: 0.0417s/iter; left time: 105.0512s
	iters: 300, epoch: 8 | loss: 0.1812320
	speed: 0.0421s/iter; left time: 101.8968s
	iters: 400, epoch: 8 | loss: 0.1838018
	speed: 0.0415s/iter; left time: 96.1870s
	iters: 500, epoch: 8 | loss: 0.1742301
	speed: 0.0413s/iter; left time: 91.5576s
	iters: 600, epoch: 8 | loss: 0.1731493
	speed: 0.0417s/iter; left time: 88.3938s
	iters: 700, epoch: 8 | loss: 0.1972015
	speed: 0.0416s/iter; left time: 83.9809s
	iters: 800, epoch: 8 | loss: 0.1981479
	speed: 0.0411s/iter; left time: 78.9621s
	iters: 900, epoch: 8 | loss: 0.1921657
	speed: 0.0409s/iter; left time: 74.4545s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.83s
Steps: 906 | Train Loss: 0.1776122 Vali Loss: 0.3201008 Test Loss: 0.3358350
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2680671215057373, rmse:0.5177519917488098, mae:0.3305746614933014, rse:0.5032839775085449
Original data scale mse:20925334.0, rmse:4574.421875, mae:2752.579833984375, rse:0.2274494618177414
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.5566037
	speed: 0.0438s/iter; left time: 392.5990s
	iters: 200, epoch: 1 | loss: 0.4855234
	speed: 0.0411s/iter; left time: 363.9307s
	iters: 300, epoch: 1 | loss: 0.4929893
	speed: 0.0413s/iter; left time: 362.1254s
	iters: 400, epoch: 1 | loss: 0.3975788
	speed: 0.0412s/iter; left time: 357.1858s
	iters: 500, epoch: 1 | loss: 0.4330063
	speed: 0.0411s/iter; left time: 351.6737s
	iters: 600, epoch: 1 | loss: 0.4184310
	speed: 0.0414s/iter; left time: 350.0614s
	iters: 700, epoch: 1 | loss: 0.3660325
	speed: 0.0413s/iter; left time: 344.9100s
	iters: 800, epoch: 1 | loss: 0.3101686
	speed: 0.0415s/iter; left time: 342.8760s
	iters: 900, epoch: 1 | loss: 0.3513955
	speed: 0.0408s/iter; left time: 333.1889s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.66s
Steps: 906 | Train Loss: 0.4423631 Vali Loss: 0.3976679 Test Loss: 0.4292906
Validation loss decreased (inf --> 0.397668).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3478977
	speed: 0.0986s/iter; left time: 794.1546s
	iters: 200, epoch: 2 | loss: 0.2805927
	speed: 0.0410s/iter; left time: 326.1892s
	iters: 300, epoch: 2 | loss: 0.2551276
	speed: 0.0409s/iter; left time: 321.4632s
	iters: 400, epoch: 2 | loss: 0.3163478
	speed: 0.0411s/iter; left time: 318.8201s
	iters: 500, epoch: 2 | loss: 0.2456428
	speed: 0.0412s/iter; left time: 315.1961s
	iters: 600, epoch: 2 | loss: 0.2977647
	speed: 0.0410s/iter; left time: 310.0350s
	iters: 700, epoch: 2 | loss: 0.2762544
	speed: 0.0411s/iter; left time: 306.6163s
	iters: 800, epoch: 2 | loss: 0.2769859
	speed: 0.0411s/iter; left time: 302.3655s
	iters: 900, epoch: 2 | loss: 0.2938291
	speed: 0.0412s/iter; left time: 298.8095s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.49s
Steps: 906 | Train Loss: 0.2961741 Vali Loss: 0.3188580 Test Loss: 0.3396104
Validation loss decreased (0.397668 --> 0.318858).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.2537711
	speed: 0.0989s/iter; left time: 707.3695s
	iters: 200, epoch: 3 | loss: 0.3213524
	speed: 0.0412s/iter; left time: 290.5745s
	iters: 300, epoch: 3 | loss: 0.2701304
	speed: 0.0413s/iter; left time: 287.2167s
	iters: 400, epoch: 3 | loss: 0.3002693
	speed: 0.0415s/iter; left time: 284.4513s
	iters: 500, epoch: 3 | loss: 0.2725642
	speed: 0.0414s/iter; left time: 279.3967s
	iters: 600, epoch: 3 | loss: 0.2312220
	speed: 0.0413s/iter; left time: 274.7013s
	iters: 700, epoch: 3 | loss: 0.2424035
	speed: 0.0411s/iter; left time: 269.3769s
	iters: 800, epoch: 3 | loss: 0.2456405
	speed: 0.0420s/iter; left time: 270.7028s
	iters: 900, epoch: 3 | loss: 0.2441261
	speed: 0.0414s/iter; left time: 262.8582s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.77s
Steps: 906 | Train Loss: 0.2592560 Vali Loss: 0.3163091 Test Loss: 0.3191819
Validation loss decreased (0.318858 --> 0.316309).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2610521
	speed: 0.0991s/iter; left time: 618.4895s
	iters: 200, epoch: 4 | loss: 0.2230835
	speed: 0.0408s/iter; left time: 250.6327s
	iters: 300, epoch: 4 | loss: 0.2567629
	speed: 0.0415s/iter; left time: 250.8134s
	iters: 400, epoch: 4 | loss: 0.2564912
	speed: 0.0415s/iter; left time: 246.7440s
	iters: 500, epoch: 4 | loss: 0.2714780
	speed: 0.0414s/iter; left time: 242.0717s
	iters: 600, epoch: 4 | loss: 0.2738412
	speed: 0.0412s/iter; left time: 236.4260s
	iters: 700, epoch: 4 | loss: 0.2382569
	speed: 0.0413s/iter; left time: 232.8950s
	iters: 800, epoch: 4 | loss: 0.2262008
	speed: 0.0413s/iter; left time: 229.0016s
	iters: 900, epoch: 4 | loss: 0.2340984
	speed: 0.0414s/iter; left time: 225.4275s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:37.72s
Steps: 906 | Train Loss: 0.2395558 Vali Loss: 0.3143098 Test Loss: 0.3239972
Validation loss decreased (0.316309 --> 0.314310).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2121494
	speed: 0.0985s/iter; left time: 525.5184s
	iters: 200, epoch: 5 | loss: 0.2297910
	speed: 0.0412s/iter; left time: 215.7144s
	iters: 300, epoch: 5 | loss: 0.2057274
	speed: 0.0415s/iter; left time: 213.0884s
	iters: 400, epoch: 5 | loss: 0.2403576
	speed: 0.0409s/iter; left time: 206.0549s
	iters: 500, epoch: 5 | loss: 0.2741929
	speed: 0.0411s/iter; left time: 202.8714s
	iters: 600, epoch: 5 | loss: 0.2258921
	speed: 0.0410s/iter; left time: 198.3803s
	iters: 700, epoch: 5 | loss: 0.2325047
	speed: 0.0413s/iter; left time: 195.7010s
	iters: 800, epoch: 5 | loss: 0.2602603
	speed: 0.0405s/iter; left time: 187.8126s
	iters: 900, epoch: 5 | loss: 0.2216712
	speed: 0.0414s/iter; left time: 187.8377s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.55s
Steps: 906 | Train Loss: 0.2190568 Vali Loss: 0.3184572 Test Loss: 0.3248944
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.1876422
	speed: 0.0950s/iter; left time: 420.9275s
	iters: 200, epoch: 6 | loss: 0.2033045
	speed: 0.0418s/iter; left time: 181.1851s
	iters: 300, epoch: 6 | loss: 0.2030822
	speed: 0.0421s/iter; left time: 178.3249s
	iters: 400, epoch: 6 | loss: 0.2027894
	speed: 0.0422s/iter; left time: 174.3821s
	iters: 500, epoch: 6 | loss: 0.2005013
	speed: 0.0425s/iter; left time: 171.1191s
	iters: 600, epoch: 6 | loss: 0.1730578
	speed: 0.0424s/iter; left time: 166.6613s
	iters: 700, epoch: 6 | loss: 0.1952004
	speed: 0.0422s/iter; left time: 161.8134s
	iters: 800, epoch: 6 | loss: 0.1946093
	speed: 0.0415s/iter; left time: 154.8508s
	iters: 900, epoch: 6 | loss: 0.1947548
	speed: 0.0425s/iter; left time: 154.1712s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:38.35s
Steps: 906 | Train Loss: 0.2006993 Vali Loss: 0.3187766 Test Loss: 0.3294612
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2075318
	speed: 0.0956s/iter; left time: 336.9367s
	iters: 200, epoch: 7 | loss: 0.1894392
	speed: 0.0411s/iter; left time: 140.8365s
	iters: 300, epoch: 7 | loss: 0.2006222
	speed: 0.0411s/iter; left time: 136.5702s
	iters: 400, epoch: 7 | loss: 0.1985264
	speed: 0.0411s/iter; left time: 132.6394s
	iters: 500, epoch: 7 | loss: 0.1957365
	speed: 0.0413s/iter; left time: 128.9065s
	iters: 600, epoch: 7 | loss: 0.2047793
	speed: 0.0416s/iter; left time: 125.9257s
	iters: 700, epoch: 7 | loss: 0.1904843
	speed: 0.0411s/iter; left time: 120.0979s
	iters: 800, epoch: 7 | loss: 0.1808072
	speed: 0.0408s/iter; left time: 115.2810s
	iters: 900, epoch: 7 | loss: 0.1779598
	speed: 0.0408s/iter; left time: 111.3081s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.48s
Steps: 906 | Train Loss: 0.1857852 Vali Loss: 0.3266283 Test Loss: 0.3319425
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.2553166449069977, rmse:0.5052886605262756, mae:0.3241082429885864, rse:0.49116891622543335
Original data scale mse:19889488.0, rmse:4459.76318359375, mae:2691.116943359375, rse:0.22174841165542603

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.2680671215057373, RMSE: 0.5177519917488098, MAE: 0.3305746614933014, RSE: 0.5032839775085449
Unscaled Metrics - MSE: 20925334.0, RMSE: 4574.421875, MAE: 2752.579833984375, RSE: 0.2274494618177414

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.2553166449069977, RMSE: 0.5052886605262756, MAE: 0.3241082429885864, RSE: 0.49116891622543335
Unscaled Metrics - MSE: 19889488.0, RMSE: 4459.76318359375, MAE: 2691.116943359375, RSE: 0.22174841165542603

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6115588
	speed: 0.0797s/iter; left time: 712.2854s
	iters: 200, epoch: 1 | loss: 0.5830034
	speed: 0.0498s/iter; left time: 440.4276s
	iters: 300, epoch: 1 | loss: 0.5585816
	speed: 0.0502s/iter; left time: 439.0679s
	iters: 400, epoch: 1 | loss: 0.5200341
	speed: 0.0501s/iter; left time: 433.0990s
	iters: 500, epoch: 1 | loss: 0.5049127
	speed: 0.0490s/iter; left time: 418.2705s
	iters: 600, epoch: 1 | loss: 0.4407553
	speed: 0.0477s/iter; left time: 402.6346s
	iters: 700, epoch: 1 | loss: 0.4462834
	speed: 0.0476s/iter; left time: 397.2090s
	iters: 800, epoch: 1 | loss: 0.4579721
	speed: 0.0477s/iter; left time: 393.2951s
	iters: 900, epoch: 1 | loss: 0.4630652
	speed: 0.0477s/iter; left time: 387.9237s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.89s
Steps: 904 | Train Loss: 0.5222275 Vali Loss: 0.5014924 Test Loss: 0.5682946
Validation loss decreased (inf --> 0.501492).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4238201
	speed: 0.1163s/iter; left time: 934.7350s
	iters: 200, epoch: 2 | loss: 0.4197856
	speed: 0.0478s/iter; left time: 379.6160s
	iters: 300, epoch: 2 | loss: 0.4010336
	speed: 0.0477s/iter; left time: 373.4727s
	iters: 400, epoch: 2 | loss: 0.3804184
	speed: 0.0476s/iter; left time: 368.6671s
	iters: 500, epoch: 2 | loss: 0.3713737
	speed: 0.0478s/iter; left time: 365.3334s
	iters: 600, epoch: 2 | loss: 0.3904136
	speed: 0.0478s/iter; left time: 360.5583s
	iters: 700, epoch: 2 | loss: 0.3579198
	speed: 0.0477s/iter; left time: 354.7340s
	iters: 800, epoch: 2 | loss: 0.4012666
	speed: 0.0477s/iter; left time: 349.7325s
	iters: 900, epoch: 2 | loss: 0.3565502
	speed: 0.0477s/iter; left time: 345.5361s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.43s
Steps: 904 | Train Loss: 0.3944836 Vali Loss: 0.4238538 Test Loss: 0.4699799
Validation loss decreased (0.501492 --> 0.423854).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3834203
	speed: 0.1183s/iter; left time: 844.1135s
	iters: 200, epoch: 3 | loss: 0.3331022
	speed: 0.0465s/iter; left time: 326.9839s
	iters: 300, epoch: 3 | loss: 0.3204759
	speed: 0.0475s/iter; left time: 329.4874s
	iters: 400, epoch: 3 | loss: 0.3179659
	speed: 0.0476s/iter; left time: 325.1116s
	iters: 500, epoch: 3 | loss: 0.3535420
	speed: 0.0476s/iter; left time: 320.3981s
	iters: 600, epoch: 3 | loss: 0.3607985
	speed: 0.0471s/iter; left time: 312.2394s
	iters: 700, epoch: 3 | loss: 0.3019953
	speed: 0.0478s/iter; left time: 312.4561s
	iters: 800, epoch: 3 | loss: 0.3429635
	speed: 0.0477s/iter; left time: 306.7711s
	iters: 900, epoch: 3 | loss: 0.3431078
	speed: 0.0474s/iter; left time: 300.3698s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.10s
Steps: 904 | Train Loss: 0.3435943 Vali Loss: 0.4145606 Test Loss: 0.4659684
Validation loss decreased (0.423854 --> 0.414561).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3050880
	speed: 0.1148s/iter; left time: 715.1471s
	iters: 200, epoch: 4 | loss: 0.3034989
	speed: 0.0476s/iter; left time: 291.5346s
	iters: 300, epoch: 4 | loss: 0.2979394
	speed: 0.0475s/iter; left time: 286.6201s
	iters: 400, epoch: 4 | loss: 0.2685758
	speed: 0.0477s/iter; left time: 282.9583s
	iters: 500, epoch: 4 | loss: 0.3442597
	speed: 0.0477s/iter; left time: 278.2956s
	iters: 600, epoch: 4 | loss: 0.2796071
	speed: 0.0480s/iter; left time: 274.8312s
	iters: 700, epoch: 4 | loss: 0.3278911
	speed: 0.0479s/iter; left time: 269.5798s
	iters: 800, epoch: 4 | loss: 0.2960745
	speed: 0.0478s/iter; left time: 264.0864s
	iters: 900, epoch: 4 | loss: 0.3270479
	speed: 0.0477s/iter; left time: 259.1941s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.36s
Steps: 904 | Train Loss: 0.3128055 Vali Loss: 0.4168210 Test Loss: 0.4725619
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2866268
	speed: 0.1125s/iter; left time: 599.0107s
	iters: 200, epoch: 5 | loss: 0.3179915
	speed: 0.0478s/iter; left time: 249.5503s
	iters: 300, epoch: 5 | loss: 0.2972972
	speed: 0.0478s/iter; left time: 244.9077s
	iters: 400, epoch: 5 | loss: 0.2920378
	speed: 0.0477s/iter; left time: 239.7471s
	iters: 500, epoch: 5 | loss: 0.2694999
	speed: 0.0477s/iter; left time: 234.8159s
	iters: 600, epoch: 5 | loss: 0.2672861
	speed: 0.0477s/iter; left time: 230.1917s
	iters: 700, epoch: 5 | loss: 0.2841391
	speed: 0.0478s/iter; left time: 225.9362s
	iters: 800, epoch: 5 | loss: 0.2562101
	speed: 0.0477s/iter; left time: 220.7512s
	iters: 900, epoch: 5 | loss: 0.2718032
	speed: 0.0475s/iter; left time: 215.1013s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.34s
Steps: 904 | Train Loss: 0.2853150 Vali Loss: 0.4071884 Test Loss: 0.4732395
Validation loss decreased (0.414561 --> 0.407188).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2535943
	speed: 0.1151s/iter; left time: 508.7409s
	iters: 200, epoch: 6 | loss: 0.2458549
	speed: 0.0478s/iter; left time: 206.3470s
	iters: 300, epoch: 6 | loss: 0.2757922
	speed: 0.0476s/iter; left time: 201.1151s
	iters: 400, epoch: 6 | loss: 0.2618496
	speed: 0.0475s/iter; left time: 195.6966s
	iters: 500, epoch: 6 | loss: 0.2467890
	speed: 0.0475s/iter; left time: 191.0373s
	iters: 600, epoch: 6 | loss: 0.2800977
	speed: 0.0475s/iter; left time: 186.2829s
	iters: 700, epoch: 6 | loss: 0.2484103
	speed: 0.0475s/iter; left time: 181.6139s
	iters: 800, epoch: 6 | loss: 0.2790080
	speed: 0.0473s/iter; left time: 176.1074s
	iters: 900, epoch: 6 | loss: 0.2538236
	speed: 0.0474s/iter; left time: 171.7301s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:43.20s
Steps: 904 | Train Loss: 0.2627822 Vali Loss: 0.4273484 Test Loss: 0.4729554
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2240744
	speed: 0.1142s/iter; left time: 401.7001s
	iters: 200, epoch: 7 | loss: 0.2229967
	speed: 0.0485s/iter; left time: 165.6490s
	iters: 300, epoch: 7 | loss: 0.2495193
	speed: 0.0503s/iter; left time: 166.9682s
	iters: 400, epoch: 7 | loss: 0.2350299
	speed: 0.0481s/iter; left time: 154.5851s
	iters: 500, epoch: 7 | loss: 0.2283342
	speed: 0.0484s/iter; left time: 150.7682s
	iters: 600, epoch: 7 | loss: 0.2313164
	speed: 0.0504s/iter; left time: 152.0069s
	iters: 700, epoch: 7 | loss: 0.2368815
	speed: 0.0481s/iter; left time: 140.3163s
	iters: 800, epoch: 7 | loss: 0.2292707
	speed: 0.0477s/iter; left time: 134.3031s
	iters: 900, epoch: 7 | loss: 0.2431902
	speed: 0.0477s/iter; left time: 129.6621s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:44.10s
Steps: 904 | Train Loss: 0.2428129 Vali Loss: 0.4339893 Test Loss: 0.4815975
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2290939
	speed: 0.1175s/iter; left time: 306.9440s
	iters: 200, epoch: 8 | loss: 0.2398908
	speed: 0.0493s/iter; left time: 123.8572s
	iters: 300, epoch: 8 | loss: 0.2407383
	speed: 0.0476s/iter; left time: 114.7567s
	iters: 400, epoch: 8 | loss: 0.2275654
	speed: 0.0474s/iter; left time: 109.5560s
	iters: 500, epoch: 8 | loss: 0.2447397
	speed: 0.0475s/iter; left time: 105.2197s
	iters: 600, epoch: 8 | loss: 0.2316028
	speed: 0.0477s/iter; left time: 100.8635s
	iters: 700, epoch: 8 | loss: 0.2377874
	speed: 0.0476s/iter; left time: 95.7187s
	iters: 800, epoch: 8 | loss: 0.2231112
	speed: 0.0475s/iter; left time: 90.8132s
	iters: 900, epoch: 8 | loss: 0.2186633
	speed: 0.0475s/iter; left time: 86.1243s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.63s
Steps: 904 | Train Loss: 0.2271254 Vali Loss: 0.4367002 Test Loss: 0.4786476
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.49115902185440063, rmse:0.7008273601531982, mae:0.47365128993988037, rse:0.6816441416740417
Original data scale mse:40326344.0, rmse:6350.302734375, mae:3975.054931640625, rse:0.3162473440170288
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.6034825
	speed: 0.0502s/iter; left time: 449.1263s
	iters: 200, epoch: 1 | loss: 0.5507028
	speed: 0.0474s/iter; left time: 418.7115s
	iters: 300, epoch: 1 | loss: 0.5007508
	speed: 0.0473s/iter; left time: 413.3687s
	iters: 400, epoch: 1 | loss: 0.4743139
	speed: 0.0476s/iter; left time: 411.2996s
	iters: 500, epoch: 1 | loss: 0.4567157
	speed: 0.0487s/iter; left time: 415.6614s
	iters: 600, epoch: 1 | loss: 0.4999577
	speed: 0.0477s/iter; left time: 402.7384s
	iters: 700, epoch: 1 | loss: 0.4845823
	speed: 0.0488s/iter; left time: 406.7401s
	iters: 800, epoch: 1 | loss: 0.4760923
	speed: 0.0478s/iter; left time: 393.8507s
	iters: 900, epoch: 1 | loss: 0.4509124
	speed: 0.0477s/iter; left time: 387.9328s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:43.58s
Steps: 904 | Train Loss: 0.5182869 Vali Loss: 0.5017161 Test Loss: 0.5734323
Validation loss decreased (inf --> 0.501716).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3873321
	speed: 0.1236s/iter; left time: 993.7370s
	iters: 200, epoch: 2 | loss: 0.4113899
	speed: 0.0478s/iter; left time: 378.9980s
	iters: 300, epoch: 2 | loss: 0.3677758
	speed: 0.0478s/iter; left time: 374.3053s
	iters: 400, epoch: 2 | loss: 0.3784696
	speed: 0.0476s/iter; left time: 368.5128s
	iters: 500, epoch: 2 | loss: 0.3737342
	speed: 0.0473s/iter; left time: 360.9292s
	iters: 600, epoch: 2 | loss: 0.3858809
	speed: 0.0476s/iter; left time: 358.9158s
	iters: 700, epoch: 2 | loss: 0.3894660
	speed: 0.0476s/iter; left time: 353.9038s
	iters: 800, epoch: 2 | loss: 0.3639689
	speed: 0.0475s/iter; left time: 348.2904s
	iters: 900, epoch: 2 | loss: 0.3597989
	speed: 0.0476s/iter; left time: 344.4746s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:43.29s
Steps: 904 | Train Loss: 0.3961964 Vali Loss: 0.4373525 Test Loss: 0.4658424
Validation loss decreased (0.501716 --> 0.437353).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3567201
	speed: 0.1175s/iter; left time: 838.2160s
	iters: 200, epoch: 3 | loss: 0.4051770
	speed: 0.0480s/iter; left time: 337.6048s
	iters: 300, epoch: 3 | loss: 0.3684655
	speed: 0.0478s/iter; left time: 331.5409s
	iters: 400, epoch: 3 | loss: 0.3487606
	speed: 0.0478s/iter; left time: 326.4767s
	iters: 500, epoch: 3 | loss: 0.3234715
	speed: 0.0478s/iter; left time: 322.0905s
	iters: 600, epoch: 3 | loss: 0.3506857
	speed: 0.0479s/iter; left time: 317.9064s
	iters: 700, epoch: 3 | loss: 0.3182862
	speed: 0.0478s/iter; left time: 312.4605s
	iters: 800, epoch: 3 | loss: 0.3413826
	speed: 0.0478s/iter; left time: 307.6318s
	iters: 900, epoch: 3 | loss: 0.3494556
	speed: 0.0477s/iter; left time: 301.7996s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:43.46s
Steps: 904 | Train Loss: 0.3447624 Vali Loss: 0.4335651 Test Loss: 0.4499207
Validation loss decreased (0.437353 --> 0.433565).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2904501
	speed: 0.1185s/iter; left time: 738.3520s
	iters: 200, epoch: 4 | loss: 0.3086890
	speed: 0.0478s/iter; left time: 293.0076s
	iters: 300, epoch: 4 | loss: 0.3202746
	speed: 0.0480s/iter; left time: 289.3755s
	iters: 400, epoch: 4 | loss: 0.2983309
	speed: 0.0480s/iter; left time: 284.5372s
	iters: 500, epoch: 4 | loss: 0.3225928
	speed: 0.0478s/iter; left time: 278.4072s
	iters: 600, epoch: 4 | loss: 0.3050541
	speed: 0.0479s/iter; left time: 274.2229s
	iters: 700, epoch: 4 | loss: 0.3180465
	speed: 0.0477s/iter; left time: 268.3103s
	iters: 800, epoch: 4 | loss: 0.2744825
	speed: 0.0481s/iter; left time: 266.1402s
	iters: 900, epoch: 4 | loss: 0.2725351
	speed: 0.0479s/iter; left time: 260.0583s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:43.53s
Steps: 904 | Train Loss: 0.3125584 Vali Loss: 0.4253437 Test Loss: 0.4791566
Validation loss decreased (0.433565 --> 0.425344).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2844376
	speed: 0.1177s/iter; left time: 626.9919s
	iters: 200, epoch: 5 | loss: 0.2873303
	speed: 0.0470s/iter; left time: 245.8163s
	iters: 300, epoch: 5 | loss: 0.2829492
	speed: 0.0480s/iter; left time: 246.1455s
	iters: 400, epoch: 5 | loss: 0.2643508
	speed: 0.0478s/iter; left time: 240.2072s
	iters: 500, epoch: 5 | loss: 0.2685104
	speed: 0.0479s/iter; left time: 236.0348s
	iters: 600, epoch: 5 | loss: 0.2810370
	speed: 0.0480s/iter; left time: 231.5605s
	iters: 700, epoch: 5 | loss: 0.2994999
	speed: 0.0479s/iter; left time: 226.2039s
	iters: 800, epoch: 5 | loss: 0.2662688
	speed: 0.0479s/iter; left time: 221.3614s
	iters: 900, epoch: 5 | loss: 0.2622414
	speed: 0.0476s/iter; left time: 215.2954s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.45s
Steps: 904 | Train Loss: 0.2855324 Vali Loss: 0.4168544 Test Loss: 0.4586405
Validation loss decreased (0.425344 --> 0.416854).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2860955
	speed: 0.1171s/iter; left time: 517.6671s
	iters: 200, epoch: 6 | loss: 0.2661182
	speed: 0.0504s/iter; left time: 217.9829s
	iters: 300, epoch: 6 | loss: 0.2680987
	speed: 0.0499s/iter; left time: 210.7430s
	iters: 400, epoch: 6 | loss: 0.2909117
	speed: 0.0504s/iter; left time: 207.5001s
	iters: 500, epoch: 6 | loss: 0.2655762
	speed: 0.0492s/iter; left time: 197.9556s
	iters: 600, epoch: 6 | loss: 0.2552939
	speed: 0.0480s/iter; left time: 188.2318s
	iters: 700, epoch: 6 | loss: 0.2736236
	speed: 0.0505s/iter; left time: 193.0812s
	iters: 800, epoch: 6 | loss: 0.2536016
	speed: 0.0504s/iter; left time: 187.6034s
	iters: 900, epoch: 6 | loss: 0.2610558
	speed: 0.0501s/iter; left time: 181.5607s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:45.17s
Steps: 904 | Train Loss: 0.2605563 Vali Loss: 0.4307886 Test Loss: 0.4689623
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2389380
	speed: 0.1130s/iter; left time: 397.5951s
	iters: 200, epoch: 7 | loss: 0.2423452
	speed: 0.0475s/iter; left time: 162.3969s
	iters: 300, epoch: 7 | loss: 0.2450469
	speed: 0.0476s/iter; left time: 157.9749s
	iters: 400, epoch: 7 | loss: 0.2339684
	speed: 0.0469s/iter; left time: 150.9223s
	iters: 500, epoch: 7 | loss: 0.2215564
	speed: 0.0433s/iter; left time: 134.8236s
	iters: 600, epoch: 7 | loss: 0.2500869
	speed: 0.0354s/iter; left time: 106.6975s
	iters: 700, epoch: 7 | loss: 0.2422784
	speed: 0.0354s/iter; left time: 103.1211s
	iters: 800, epoch: 7 | loss: 0.2440853
	speed: 0.0353s/iter; left time: 99.5181s
	iters: 900, epoch: 7 | loss: 0.2354862
	speed: 0.0353s/iter; left time: 96.0458s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:37.77s
Steps: 904 | Train Loss: 0.2408905 Vali Loss: 0.4327017 Test Loss: 0.4888551
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2328618
	speed: 0.1119s/iter; left time: 292.3571s
	iters: 200, epoch: 8 | loss: 0.2090433
	speed: 0.0475s/iter; left time: 119.3137s
	iters: 300, epoch: 8 | loss: 0.2129289
	speed: 0.0473s/iter; left time: 114.1972s
	iters: 400, epoch: 8 | loss: 0.2188863
	speed: 0.0475s/iter; left time: 109.7770s
	iters: 500, epoch: 8 | loss: 0.2201189
	speed: 0.0474s/iter; left time: 104.8719s
	iters: 600, epoch: 8 | loss: 0.2083899
	speed: 0.0474s/iter; left time: 100.0564s
	iters: 700, epoch: 8 | loss: 0.2089313
	speed: 0.0476s/iter; left time: 95.7690s
	iters: 800, epoch: 8 | loss: 0.2221401
	speed: 0.0474s/iter; left time: 90.6682s
	iters: 900, epoch: 8 | loss: 0.2166971
	speed: 0.0476s/iter; left time: 86.2511s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:43.11s
Steps: 904 | Train Loss: 0.2233746 Vali Loss: 0.4315720 Test Loss: 0.4907541
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.46618911623954773, rmse:0.6827804446220398, mae:0.458564430475235, rse:0.664091169834137
Original data scale mse:37853992.0, rmse:6152.5595703125, mae:3816.9462890625, rse:0.3063996732234955

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.49115902185440063, RMSE: 0.7008273601531982, MAE: 0.47365128993988037, RSE: 0.6816441416740417
Unscaled Metrics - MSE: 40326344.0, RMSE: 6350.302734375, MAE: 3975.054931640625, RSE: 0.3162473440170288

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 0.46618911623954773, RMSE: 0.6827804446220398, MAE: 0.458564430475235, RSE: 0.664091169834137
Unscaled Metrics - MSE: 37853992.0, RMSE: 6152.5595703125, MAE: 3816.9462890625, RSE: 0.3063996732234955

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/fob-vol3/nebenf24/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, scaler_type='robust', seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', if_relu=False, fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5665159
	speed: 0.0838s/iter; left time: 747.1695s
	iters: 200, epoch: 1 | loss: 0.5884684
	speed: 0.0539s/iter; left time: 475.4272s
	iters: 300, epoch: 1 | loss: 0.5519950
	speed: 0.0538s/iter; left time: 468.9913s
	iters: 400, epoch: 1 | loss: 0.5502739
	speed: 0.0537s/iter; left time: 463.1759s
	iters: 500, epoch: 1 | loss: 0.5368783
	speed: 0.0536s/iter; left time: 456.9799s
	iters: 600, epoch: 1 | loss: 0.5454326
	speed: 0.0536s/iter; left time: 451.1709s
	iters: 700, epoch: 1 | loss: 0.5227320
	speed: 0.0536s/iter; left time: 445.7072s
	iters: 800, epoch: 1 | loss: 0.5035548
	speed: 0.0538s/iter; left time: 442.3618s
	iters: 900, epoch: 1 | loss: 0.5218879
	speed: 0.0537s/iter; left time: 436.4146s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:49.22s
Steps: 902 | Train Loss: 0.5507321 Vali Loss: 0.5634081 Test Loss: 0.6531137
Validation loss decreased (inf --> 0.563408).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5101866
	speed: 0.1340s/iter; left time: 1074.8517s
	iters: 200, epoch: 2 | loss: 0.4751575
	speed: 0.0538s/iter; left time: 425.8834s
	iters: 300, epoch: 2 | loss: 0.4759747
	speed: 0.0536s/iter; left time: 419.3303s
	iters: 400, epoch: 2 | loss: 0.4305736
	speed: 0.0534s/iter; left time: 412.5197s
	iters: 500, epoch: 2 | loss: 0.4167421
	speed: 0.0534s/iter; left time: 407.0465s
	iters: 600, epoch: 2 | loss: 0.3776212
	speed: 0.0537s/iter; left time: 403.4505s
	iters: 700, epoch: 2 | loss: 0.3848957
	speed: 0.0537s/iter; left time: 398.1465s
	iters: 800, epoch: 2 | loss: 0.4178534
	speed: 0.0536s/iter; left time: 392.1942s
	iters: 900, epoch: 2 | loss: 0.3925001
	speed: 0.0535s/iter; left time: 386.2945s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.60s
Steps: 902 | Train Loss: 0.4299240 Vali Loss: 0.4529567 Test Loss: 0.5070729
Validation loss decreased (0.563408 --> 0.452957).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3886993
	speed: 0.1351s/iter; left time: 961.2627s
	iters: 200, epoch: 3 | loss: 0.3620102
	speed: 0.0538s/iter; left time: 377.4551s
	iters: 300, epoch: 3 | loss: 0.3674082
	speed: 0.0537s/iter; left time: 371.2189s
	iters: 400, epoch: 3 | loss: 0.3940060
	speed: 0.0537s/iter; left time: 365.8347s
	iters: 500, epoch: 3 | loss: 0.3436573
	speed: 0.0537s/iter; left time: 360.4923s
	iters: 600, epoch: 3 | loss: 0.3622456
	speed: 0.0538s/iter; left time: 356.0556s
	iters: 700, epoch: 3 | loss: 0.3702312
	speed: 0.0535s/iter; left time: 348.9745s
	iters: 800, epoch: 3 | loss: 0.3639712
	speed: 0.0536s/iter; left time: 343.8868s
	iters: 900, epoch: 3 | loss: 0.3532930
	speed: 0.0538s/iter; left time: 339.5642s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.75s
Steps: 902 | Train Loss: 0.3588001 Vali Loss: 0.4448532 Test Loss: 0.5038010
Validation loss decreased (0.452957 --> 0.444853).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3079253
	speed: 0.1336s/iter; left time: 830.1163s
	iters: 200, epoch: 4 | loss: 0.3025079
	speed: 0.0537s/iter; left time: 328.2827s
	iters: 300, epoch: 4 | loss: 0.3541246
	speed: 0.0537s/iter; left time: 322.7246s
	iters: 400, epoch: 4 | loss: 0.3398260
	speed: 0.0536s/iter; left time: 317.1288s
	iters: 500, epoch: 4 | loss: 0.3500948
	speed: 0.0536s/iter; left time: 311.6731s
	iters: 600, epoch: 4 | loss: 0.3118173
	speed: 0.0538s/iter; left time: 307.3911s
	iters: 700, epoch: 4 | loss: 0.3327943
	speed: 0.0537s/iter; left time: 301.5044s
	iters: 800, epoch: 4 | loss: 0.3290806
	speed: 0.0536s/iter; left time: 295.6559s
	iters: 900, epoch: 4 | loss: 0.3236909
	speed: 0.0537s/iter; left time: 290.5605s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.66s
Steps: 902 | Train Loss: 0.3237214 Vali Loss: 0.4423192 Test Loss: 0.5003442
Validation loss decreased (0.444853 --> 0.442319).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3168175
	speed: 0.1350s/iter; left time: 717.1128s
	iters: 200, epoch: 5 | loss: 0.3164908
	speed: 0.0538s/iter; left time: 280.3630s
	iters: 300, epoch: 5 | loss: 0.2981934
	speed: 0.0537s/iter; left time: 274.7287s
	iters: 400, epoch: 5 | loss: 0.3222495
	speed: 0.0537s/iter; left time: 269.0692s
	iters: 500, epoch: 5 | loss: 0.2552517
	speed: 0.0537s/iter; left time: 263.5994s
	iters: 600, epoch: 5 | loss: 0.2978690
	speed: 0.0538s/iter; left time: 259.0397s
	iters: 700, epoch: 5 | loss: 0.2936289
	speed: 0.0537s/iter; left time: 252.9585s
	iters: 800, epoch: 5 | loss: 0.2867786
	speed: 0.0536s/iter; left time: 247.4829s
	iters: 900, epoch: 5 | loss: 0.2679510
	speed: 0.0536s/iter; left time: 241.8969s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.71s
Steps: 902 | Train Loss: 0.2953930 Vali Loss: 0.4466900 Test Loss: 0.5076823
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2913139
	speed: 0.1303s/iter; left time: 574.6056s
	iters: 200, epoch: 6 | loss: 0.2818365
	speed: 0.0536s/iter; left time: 230.8838s
	iters: 300, epoch: 6 | loss: 0.2597834
	speed: 0.0536s/iter; left time: 225.5147s
	iters: 400, epoch: 6 | loss: 0.2885118
	speed: 0.0536s/iter; left time: 220.3492s
	iters: 500, epoch: 6 | loss: 0.2647938
	speed: 0.0537s/iter; left time: 215.5103s
	iters: 600, epoch: 6 | loss: 0.2637225
	speed: 0.0537s/iter; left time: 209.8740s
	iters: 700, epoch: 6 | loss: 0.2808955
	speed: 0.0535s/iter; left time: 203.7058s
	iters: 800, epoch: 6 | loss: 0.2594467
	speed: 0.0536s/iter; left time: 198.9415s
	iters: 900, epoch: 6 | loss: 0.2856370
	speed: 0.0535s/iter; left time: 193.3219s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.56s
Steps: 902 | Train Loss: 0.2722189 Vali Loss: 0.4587447 Test Loss: 0.5145693
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2384547
	speed: 0.1302s/iter; left time: 457.0042s
	iters: 200, epoch: 7 | loss: 0.2461951
	speed: 0.0526s/iter; left time: 179.3746s
	iters: 300, epoch: 7 | loss: 0.2451284
	speed: 0.0536s/iter; left time: 177.4252s
	iters: 400, epoch: 7 | loss: 0.2482292
	speed: 0.0536s/iter; left time: 172.0546s
	iters: 500, epoch: 7 | loss: 0.2463433
	speed: 0.0536s/iter; left time: 166.7734s
	iters: 600, epoch: 7 | loss: 0.2425788
	speed: 0.0536s/iter; left time: 161.3664s
	iters: 700, epoch: 7 | loss: 0.2472399
	speed: 0.0537s/iter; left time: 156.1295s
	iters: 800, epoch: 7 | loss: 0.2364642
	speed: 0.0536s/iter; left time: 150.6007s
	iters: 900, epoch: 7 | loss: 0.2476634
	speed: 0.0536s/iter; left time: 145.2469s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.47s
Steps: 902 | Train Loss: 0.2527197 Vali Loss: 0.4603270 Test Loss: 0.5185730
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.5403303503990173, rmse:0.7350716590881348, mae:0.5003021359443665, rse:0.7127622365951538
Original data scale mse:44810908.0, rmse:6694.09521484375, mae:4207.599609375, rse:0.3335319757461548
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.5699619
	speed: 0.0553s/iter; left time: 493.5435s
	iters: 200, epoch: 1 | loss: 0.5475079
	speed: 0.0537s/iter; left time: 473.9988s
	iters: 300, epoch: 1 | loss: 0.5417031
	speed: 0.0537s/iter; left time: 468.6000s
	iters: 400, epoch: 1 | loss: 0.5082975
	speed: 0.0532s/iter; left time: 458.2316s
	iters: 500, epoch: 1 | loss: 0.5247245
	speed: 0.0536s/iter; left time: 456.9518s
	iters: 600, epoch: 1 | loss: 0.5380745
	speed: 0.0537s/iter; left time: 452.2378s
	iters: 700, epoch: 1 | loss: 0.5192104
	speed: 0.0531s/iter; left time: 441.4557s
	iters: 800, epoch: 1 | loss: 0.4973854
	speed: 0.0536s/iter; left time: 440.6661s
	iters: 900, epoch: 1 | loss: 0.5090938
	speed: 0.0535s/iter; left time: 434.2922s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:48.52s
Steps: 902 | Train Loss: 0.5505299 Vali Loss: 0.5693076 Test Loss: 0.6601585
Validation loss decreased (inf --> 0.569308).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4725834
	speed: 0.1347s/iter; left time: 1080.2065s
	iters: 200, epoch: 2 | loss: 0.5003747
	speed: 0.0536s/iter; left time: 424.3304s
	iters: 300, epoch: 2 | loss: 0.4856316
	speed: 0.0536s/iter; left time: 419.4547s
	iters: 400, epoch: 2 | loss: 0.4231773
	speed: 0.0535s/iter; left time: 413.2790s
	iters: 500, epoch: 2 | loss: 0.4233780
	speed: 0.0536s/iter; left time: 408.5820s
	iters: 600, epoch: 2 | loss: 0.4037501
	speed: 0.0534s/iter; left time: 401.8683s
	iters: 700, epoch: 2 | loss: 0.4091046
	speed: 0.0536s/iter; left time: 397.8873s
	iters: 800, epoch: 2 | loss: 0.3730760
	speed: 0.0533s/iter; left time: 390.0606s
	iters: 900, epoch: 2 | loss: 0.4009513
	speed: 0.0536s/iter; left time: 386.9071s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:48.56s
Steps: 902 | Train Loss: 0.4317535 Vali Loss: 0.4519477 Test Loss: 0.4982342
Validation loss decreased (0.569308 --> 0.451948).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3727932
	speed: 0.1346s/iter; left time: 958.2392s
	iters: 200, epoch: 3 | loss: 0.3425841
	speed: 0.0535s/iter; left time: 375.6508s
	iters: 300, epoch: 3 | loss: 0.3626783
	speed: 0.0534s/iter; left time: 369.0600s
	iters: 400, epoch: 3 | loss: 0.3433390
	speed: 0.0536s/iter; left time: 365.1928s
	iters: 500, epoch: 3 | loss: 0.3574099
	speed: 0.0535s/iter; left time: 359.2338s
	iters: 600, epoch: 3 | loss: 0.3801520
	speed: 0.0533s/iter; left time: 352.9509s
	iters: 700, epoch: 3 | loss: 0.3325544
	speed: 0.0535s/iter; left time: 348.8115s
	iters: 800, epoch: 3 | loss: 0.3610157
	speed: 0.0534s/iter; left time: 342.4128s
	iters: 900, epoch: 3 | loss: 0.3277501
	speed: 0.0536s/iter; left time: 338.4306s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:48.46s
Steps: 902 | Train Loss: 0.3594171 Vali Loss: 0.4539334 Test Loss: 0.4856634
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3178980
	speed: 0.1310s/iter; left time: 813.9097s
	iters: 200, epoch: 4 | loss: 0.3338085
	speed: 0.0534s/iter; left time: 326.4811s
	iters: 300, epoch: 4 | loss: 0.3219782
	speed: 0.0535s/iter; left time: 321.6389s
	iters: 400, epoch: 4 | loss: 0.3341945
	speed: 0.0533s/iter; left time: 315.2018s
	iters: 500, epoch: 4 | loss: 0.3553307
	speed: 0.0536s/iter; left time: 311.4773s
	iters: 600, epoch: 4 | loss: 0.2912029
	speed: 0.0535s/iter; left time: 305.9248s
	iters: 700, epoch: 4 | loss: 0.3311034
	speed: 0.0535s/iter; left time: 300.5272s
	iters: 800, epoch: 4 | loss: 0.3025007
	speed: 0.0534s/iter; left time: 294.7086s
	iters: 900, epoch: 4 | loss: 0.3260762
	speed: 0.0535s/iter; left time: 289.9018s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:48.47s
Steps: 902 | Train Loss: 0.3236151 Vali Loss: 0.4479893 Test Loss: 0.4924225
Validation loss decreased (0.451948 --> 0.447989).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2995123
	speed: 0.1370s/iter; left time: 727.7490s
	iters: 200, epoch: 5 | loss: 0.2919329
	speed: 0.0535s/iter; left time: 278.9356s
	iters: 300, epoch: 5 | loss: 0.3060902
	speed: 0.0534s/iter; left time: 273.2232s
	iters: 400, epoch: 5 | loss: 0.2908042
	speed: 0.0535s/iter; left time: 268.3196s
	iters: 500, epoch: 5 | loss: 0.2746396
	speed: 0.0536s/iter; left time: 263.4237s
	iters: 600, epoch: 5 | loss: 0.3225055
	speed: 0.0536s/iter; left time: 258.0525s
	iters: 700, epoch: 5 | loss: 0.3016998
	speed: 0.0535s/iter; left time: 252.3802s
	iters: 800, epoch: 5 | loss: 0.2617193
	speed: 0.0536s/iter; left time: 247.0927s
	iters: 900, epoch: 5 | loss: 0.2697368
	speed: 0.0531s/iter; left time: 239.5991s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:48.50s
Steps: 902 | Train Loss: 0.2958051 Vali Loss: 0.4436080 Test Loss: 0.5030437
Validation loss decreased (0.447989 --> 0.443608).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2939356
	speed: 0.1338s/iter; left time: 590.3229s
	iters: 200, epoch: 6 | loss: 0.2909550
	speed: 0.0537s/iter; left time: 231.3267s
	iters: 300, epoch: 6 | loss: 0.2864723
	speed: 0.0536s/iter; left time: 225.6815s
	iters: 400, epoch: 6 | loss: 0.2644904
	speed: 0.0536s/iter; left time: 220.3287s
	iters: 500, epoch: 6 | loss: 0.2466046
	speed: 0.0536s/iter; left time: 215.0778s
	iters: 600, epoch: 6 | loss: 0.2899375
	speed: 0.0535s/iter; left time: 209.3229s
	iters: 700, epoch: 6 | loss: 0.2669733
	speed: 0.0537s/iter; left time: 204.7518s
	iters: 800, epoch: 6 | loss: 0.2824681
	speed: 0.0537s/iter; left time: 199.3660s
	iters: 900, epoch: 6 | loss: 0.2672931
	speed: 0.0536s/iter; left time: 193.6765s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:48.62s
Steps: 902 | Train Loss: 0.2728003 Vali Loss: 0.4493155 Test Loss: 0.5087178
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2655763
	speed: 0.1309s/iter; left time: 459.2576s
	iters: 200, epoch: 7 | loss: 0.2581416
	speed: 0.0538s/iter; left time: 183.4266s
	iters: 300, epoch: 7 | loss: 0.2538862
	speed: 0.0538s/iter; left time: 177.9046s
	iters: 400, epoch: 7 | loss: 0.2699839
	speed: 0.0537s/iter; left time: 172.4262s
	iters: 500, epoch: 7 | loss: 0.2533457
	speed: 0.0533s/iter; left time: 165.7140s
	iters: 600, epoch: 7 | loss: 0.2446761
	speed: 0.0534s/iter; left time: 160.6416s
	iters: 700, epoch: 7 | loss: 0.2600569
	speed: 0.0536s/iter; left time: 155.9984s
	iters: 800, epoch: 7 | loss: 0.2456962
	speed: 0.0535s/iter; left time: 150.2102s
	iters: 900, epoch: 7 | loss: 0.2567835
	speed: 0.0535s/iter; left time: 144.9571s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:48.59s
Steps: 902 | Train Loss: 0.2515624 Vali Loss: 0.4564816 Test Loss: 0.5059831
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2437757
	speed: 0.1312s/iter; left time: 342.0210s
	iters: 200, epoch: 8 | loss: 0.2522405
	speed: 0.0536s/iter; left time: 134.3220s
	iters: 300, epoch: 8 | loss: 0.2425012
	speed: 0.0533s/iter; left time: 128.3676s
	iters: 400, epoch: 8 | loss: 0.2660030
	speed: 0.0535s/iter; left time: 123.4884s
	iters: 500, epoch: 8 | loss: 0.2334926
	speed: 0.0535s/iter; left time: 118.1185s
	iters: 600, epoch: 8 | loss: 0.2308565
	speed: 0.0535s/iter; left time: 112.7324s
	iters: 700, epoch: 8 | loss: 0.2352480
	speed: 0.0534s/iter; left time: 107.2613s
	iters: 800, epoch: 8 | loss: 0.2330101
	speed: 0.0533s/iter; left time: 101.7147s
	iters: 900, epoch: 8 | loss: 0.2594745
	speed: 0.0532s/iter; left time: 96.1366s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:48.45s
Steps: 902 | Train Loss: 0.2352301 Vali Loss: 0.4511191 Test Loss: 0.5154700
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:0.5429455637931824, rmse:0.7368484139442444, mae:0.5033326745033264, rse:0.7144849896430969
Original data scale mse:44440940.0, rmse:6666.40380859375, mae:4218.42333984375, rse:0.33215227723121643

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 0.5403303503990173, RMSE: 0.7350716590881348, MAE: 0.5003021359443665, RSE: 0.7127622365951538
Unscaled Metrics - MSE: 44810908.0, RMSE: 6694.09521484375, MAE: 4207.599609375, RSE: 0.3335319757461548

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 0.5429455637931824, RMSE: 0.7368484139442444, MAE: 0.5033326745033264, RSE: 0.7144849896430969
Unscaled Metrics - MSE: 44440940.0, RMSE: 6666.40380859375, MAE: 4218.42333984375, RSE: 0.33215227723121643
