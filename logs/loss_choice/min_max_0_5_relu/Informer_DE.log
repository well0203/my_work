
=== Starting experiments for loss function: MSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 1.2161953
	speed: 0.0672s/iter; left time: 602.3072s
	iters: 200, epoch: 1 | loss: 0.9424956
	speed: 0.0404s/iter; left time: 357.5639s
	iters: 300, epoch: 1 | loss: 0.7740156
	speed: 0.0400s/iter; left time: 350.5582s
	iters: 400, epoch: 1 | loss: 0.6563158
	speed: 0.0405s/iter; left time: 350.5269s
	iters: 500, epoch: 1 | loss: 0.5595735
	speed: 0.0400s/iter; left time: 342.0128s
	iters: 600, epoch: 1 | loss: 0.4890181
	speed: 0.0403s/iter; left time: 341.3288s
	iters: 700, epoch: 1 | loss: 0.7046200
	speed: 0.0404s/iter; left time: 337.7337s
	iters: 800, epoch: 1 | loss: 0.5471768
	speed: 0.0402s/iter; left time: 332.2642s
	iters: 900, epoch: 1 | loss: 0.4177144
	speed: 0.0401s/iter; left time: 327.4180s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.18s
Steps: 906 | Train Loss: 0.8316623 Vali Loss: 0.6757563 Test Loss: 0.7737271
Validation loss decreased (inf --> 0.675756).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.2896777
	speed: 0.0967s/iter; left time: 778.8956s
	iters: 200, epoch: 2 | loss: 0.4969665
	speed: 0.0406s/iter; left time: 322.9437s
	iters: 300, epoch: 2 | loss: 0.3529795
	speed: 0.0401s/iter; left time: 314.7971s
	iters: 400, epoch: 2 | loss: 0.4440337
	speed: 0.0403s/iter; left time: 312.8442s
	iters: 500, epoch: 2 | loss: 0.2866517
	speed: 0.0406s/iter; left time: 310.9409s
	iters: 600, epoch: 2 | loss: 0.3346031
	speed: 0.0404s/iter; left time: 305.2299s
	iters: 700, epoch: 2 | loss: 0.2979956
	speed: 0.0404s/iter; left time: 301.0127s
	iters: 800, epoch: 2 | loss: 0.4452663
	speed: 0.0401s/iter; left time: 295.1793s
	iters: 900, epoch: 2 | loss: 0.3409314
	speed: 0.0404s/iter; left time: 292.7493s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.72s
Steps: 906 | Train Loss: 0.3940226 Vali Loss: 0.5297096 Test Loss: 0.6036869
Validation loss decreased (0.675756 --> 0.529710).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3631833
	speed: 0.0991s/iter; left time: 708.2526s
	iters: 200, epoch: 3 | loss: 0.2776881
	speed: 0.0406s/iter; left time: 285.9269s
	iters: 300, epoch: 3 | loss: 0.3248253
	speed: 0.0403s/iter; left time: 280.2249s
	iters: 400, epoch: 3 | loss: 0.3231229
	speed: 0.0404s/iter; left time: 276.8693s
	iters: 500, epoch: 3 | loss: 0.4147694
	speed: 0.0403s/iter; left time: 272.0023s
	iters: 600, epoch: 3 | loss: 0.4031588
	speed: 0.0404s/iter; left time: 268.3427s
	iters: 700, epoch: 3 | loss: 0.3707412
	speed: 0.0402s/iter; left time: 263.2782s
	iters: 800, epoch: 3 | loss: 0.3190041
	speed: 0.0402s/iter; left time: 259.5140s
	iters: 900, epoch: 3 | loss: 0.3246175
	speed: 0.0402s/iter; left time: 255.4435s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.76s
Steps: 906 | Train Loss: 0.3363409 Vali Loss: 0.5515546 Test Loss: 0.5875731
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2832943
	speed: 0.0931s/iter; left time: 581.2579s
	iters: 200, epoch: 4 | loss: 0.2798142
	speed: 0.0402s/iter; left time: 247.0721s
	iters: 300, epoch: 4 | loss: 0.3372446
	speed: 0.0399s/iter; left time: 241.2202s
	iters: 400, epoch: 4 | loss: 0.2213932
	speed: 0.0405s/iter; left time: 240.4034s
	iters: 500, epoch: 4 | loss: 0.3650001
	speed: 0.0403s/iter; left time: 235.2041s
	iters: 600, epoch: 4 | loss: 0.3261223
	speed: 0.0401s/iter; left time: 230.0835s
	iters: 700, epoch: 4 | loss: 0.2725509
	speed: 0.0403s/iter; left time: 227.3868s
	iters: 800, epoch: 4 | loss: 0.3461410
	speed: 0.0402s/iter; left time: 223.0846s
	iters: 900, epoch: 4 | loss: 0.2856041
	speed: 0.0404s/iter; left time: 220.0575s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.67s
Steps: 906 | Train Loss: 0.3031701 Vali Loss: 0.5233427 Test Loss: 0.5905153
Validation loss decreased (0.529710 --> 0.523343).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.2913541
	speed: 0.0991s/iter; left time: 528.9958s
	iters: 200, epoch: 5 | loss: 0.2619628
	speed: 0.0405s/iter; left time: 212.2458s
	iters: 300, epoch: 5 | loss: 0.2266959
	speed: 0.0405s/iter; left time: 208.2642s
	iters: 400, epoch: 5 | loss: 0.3305013
	speed: 0.0405s/iter; left time: 203.9280s
	iters: 500, epoch: 5 | loss: 0.2430154
	speed: 0.0405s/iter; left time: 199.7886s
	iters: 600, epoch: 5 | loss: 0.3076798
	speed: 0.0403s/iter; left time: 194.7990s
	iters: 700, epoch: 5 | loss: 0.2223362
	speed: 0.0405s/iter; left time: 191.6433s
	iters: 800, epoch: 5 | loss: 0.2674076
	speed: 0.0402s/iter; left time: 186.6157s
	iters: 900, epoch: 5 | loss: 0.2828737
	speed: 0.0404s/iter; left time: 183.4873s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.86s
Steps: 906 | Train Loss: 0.2704099 Vali Loss: 0.5460497 Test Loss: 0.6322929
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3038553
	speed: 0.0933s/iter; left time: 413.5459s
	iters: 200, epoch: 6 | loss: 0.2482949
	speed: 0.0345s/iter; left time: 149.3183s
	iters: 300, epoch: 6 | loss: 0.2199771
	speed: 0.0403s/iter; left time: 170.6947s
	iters: 400, epoch: 6 | loss: 0.2454004
	speed: 0.0403s/iter; left time: 166.4646s
	iters: 500, epoch: 6 | loss: 0.2364182
	speed: 0.0401s/iter; left time: 161.6426s
	iters: 600, epoch: 6 | loss: 0.1791325
	speed: 0.0397s/iter; left time: 155.9213s
	iters: 700, epoch: 6 | loss: 0.2863941
	speed: 0.0403s/iter; left time: 154.5466s
	iters: 800, epoch: 6 | loss: 0.1640818
	speed: 0.0402s/iter; left time: 150.0604s
	iters: 900, epoch: 6 | loss: 0.1933517
	speed: 0.0405s/iter; left time: 146.9343s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.08s
Steps: 906 | Train Loss: 0.2366088 Vali Loss: 0.5506063 Test Loss: 0.6512180
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.1848911
	speed: 0.0936s/iter; left time: 329.8255s
	iters: 200, epoch: 7 | loss: 0.2112785
	speed: 0.0402s/iter; left time: 137.6602s
	iters: 300, epoch: 7 | loss: 0.2609186
	speed: 0.0404s/iter; left time: 134.4434s
	iters: 400, epoch: 7 | loss: 0.2640437
	speed: 0.0404s/iter; left time: 130.2756s
	iters: 500, epoch: 7 | loss: 0.1973124
	speed: 0.0404s/iter; left time: 126.4048s
	iters: 600, epoch: 7 | loss: 0.2073535
	speed: 0.0404s/iter; left time: 122.2431s
	iters: 700, epoch: 7 | loss: 0.1994414
	speed: 0.0406s/iter; left time: 118.8230s
	iters: 800, epoch: 7 | loss: 0.2090729
	speed: 0.0404s/iter; left time: 114.2099s
	iters: 900, epoch: 7 | loss: 0.1944106
	speed: 0.0402s/iter; left time: 109.6177s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.85s
Steps: 906 | Train Loss: 0.2052130 Vali Loss: 0.5502725 Test Loss: 0.7042128
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.5899971127510071, rmse:0.7681127190589905, mae:0.5133547186851501, rse:0.542522132396698
Original data scale mse:20480482.0, rmse:4525.53662109375, mae:2909.485107421875, rse:0.22501879930496216
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 1.3391657
	speed: 0.0424s/iter; left time: 380.2379s
	iters: 200, epoch: 1 | loss: 0.9888523
	speed: 0.0402s/iter; left time: 356.2523s
	iters: 300, epoch: 1 | loss: 0.8413484
	speed: 0.0405s/iter; left time: 354.6633s
	iters: 400, epoch: 1 | loss: 0.6959186
	speed: 0.0402s/iter; left time: 348.3716s
	iters: 500, epoch: 1 | loss: 0.6618991
	speed: 0.0401s/iter; left time: 342.9661s
	iters: 600, epoch: 1 | loss: 0.5353283
	speed: 0.0402s/iter; left time: 339.8769s
	iters: 700, epoch: 1 | loss: 0.5555183
	speed: 0.0404s/iter; left time: 337.6268s
	iters: 800, epoch: 1 | loss: 0.5328173
	speed: 0.0405s/iter; left time: 334.7002s
	iters: 900, epoch: 1 | loss: 0.4505516
	speed: 0.0402s/iter; left time: 327.9366s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:36.77s
Steps: 906 | Train Loss: 0.8221332 Vali Loss: 0.6815782 Test Loss: 0.7850534
Validation loss decreased (inf --> 0.681578).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3492578
	speed: 0.0962s/iter; left time: 774.8478s
	iters: 200, epoch: 2 | loss: 0.4012568
	speed: 0.0405s/iter; left time: 322.4038s
	iters: 300, epoch: 2 | loss: 0.5414430
	speed: 0.0402s/iter; left time: 315.4065s
	iters: 400, epoch: 2 | loss: 0.3410038
	speed: 0.0403s/iter; left time: 312.2125s
	iters: 500, epoch: 2 | loss: 0.4425186
	speed: 0.0401s/iter; left time: 307.0616s
	iters: 600, epoch: 2 | loss: 0.4587216
	speed: 0.0401s/iter; left time: 302.9581s
	iters: 700, epoch: 2 | loss: 0.3536194
	speed: 0.0404s/iter; left time: 301.3849s
	iters: 800, epoch: 2 | loss: 0.2347606
	speed: 0.0401s/iter; left time: 295.2437s
	iters: 900, epoch: 2 | loss: 0.2839611
	speed: 0.0404s/iter; left time: 293.3634s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.62s
Steps: 906 | Train Loss: 0.3925778 Vali Loss: 0.5372196 Test Loss: 0.6032253
Validation loss decreased (0.681578 --> 0.537220).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3792018
	speed: 0.0959s/iter; left time: 685.7060s
	iters: 200, epoch: 3 | loss: 0.2756544
	speed: 0.0402s/iter; left time: 283.2840s
	iters: 300, epoch: 3 | loss: 0.2722667
	speed: 0.0406s/iter; left time: 282.2463s
	iters: 400, epoch: 3 | loss: 0.3713734
	speed: 0.0398s/iter; left time: 272.8368s
	iters: 500, epoch: 3 | loss: 0.2374981
	speed: 0.0304s/iter; left time: 204.9295s
	iters: 600, epoch: 3 | loss: 0.3596402
	speed: 0.0284s/iter; left time: 188.8488s
	iters: 700, epoch: 3 | loss: 0.2946671
	speed: 0.0327s/iter; left time: 214.0803s
	iters: 800, epoch: 3 | loss: 0.3268695
	speed: 0.0397s/iter; left time: 255.9397s
	iters: 900, epoch: 3 | loss: 0.3521222
	speed: 0.0397s/iter; left time: 252.2717s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:33.60s
Steps: 906 | Train Loss: 0.3347217 Vali Loss: 0.5220914 Test Loss: 0.5574713
Validation loss decreased (0.537220 --> 0.522091).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.2803137
	speed: 0.0978s/iter; left time: 610.3184s
	iters: 200, epoch: 4 | loss: 0.4072022
	speed: 0.0405s/iter; left time: 248.7637s
	iters: 300, epoch: 4 | loss: 0.4092380
	speed: 0.0403s/iter; left time: 243.4861s
	iters: 400, epoch: 4 | loss: 0.3679118
	speed: 0.0402s/iter; left time: 238.7503s
	iters: 500, epoch: 4 | loss: 0.3249450
	speed: 0.0406s/iter; left time: 237.2030s
	iters: 600, epoch: 4 | loss: 0.2672132
	speed: 0.0403s/iter; left time: 231.6681s
	iters: 700, epoch: 4 | loss: 0.2783791
	speed: 0.0403s/iter; left time: 227.3561s
	iters: 800, epoch: 4 | loss: 0.3221961
	speed: 0.0405s/iter; left time: 224.4528s
	iters: 900, epoch: 4 | loss: 0.3108084
	speed: 0.0399s/iter; left time: 216.9831s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.76s
Steps: 906 | Train Loss: 0.3040630 Vali Loss: 0.5226288 Test Loss: 0.5688264
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3196789
	speed: 0.0932s/iter; left time: 497.2614s
	iters: 200, epoch: 5 | loss: 0.2247525
	speed: 0.0403s/iter; left time: 211.1957s
	iters: 300, epoch: 5 | loss: 0.3040352
	speed: 0.0404s/iter; left time: 207.6662s
	iters: 400, epoch: 5 | loss: 0.3372777
	speed: 0.0405s/iter; left time: 203.7737s
	iters: 500, epoch: 5 | loss: 0.3534835
	speed: 0.0406s/iter; left time: 200.3474s
	iters: 600, epoch: 5 | loss: 0.3353474
	speed: 0.0403s/iter; left time: 195.1396s
	iters: 700, epoch: 5 | loss: 0.2310981
	speed: 0.0402s/iter; left time: 190.5356s
	iters: 800, epoch: 5 | loss: 0.2242709
	speed: 0.0403s/iter; left time: 186.6893s
	iters: 900, epoch: 5 | loss: 0.2579302
	speed: 0.0405s/iter; left time: 183.5869s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.77s
Steps: 906 | Train Loss: 0.2737698 Vali Loss: 0.5776108 Test Loss: 0.6245275
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.2149563
	speed: 0.0938s/iter; left time: 415.7667s
	iters: 200, epoch: 6 | loss: 0.2353265
	speed: 0.0402s/iter; left time: 174.2045s
	iters: 300, epoch: 6 | loss: 0.2392858
	speed: 0.0402s/iter; left time: 170.2565s
	iters: 400, epoch: 6 | loss: 0.2223994
	speed: 0.0404s/iter; left time: 167.0279s
	iters: 500, epoch: 6 | loss: 0.2752545
	speed: 0.0406s/iter; left time: 163.5453s
	iters: 600, epoch: 6 | loss: 0.2510081
	speed: 0.0418s/iter; left time: 164.3321s
	iters: 700, epoch: 6 | loss: 0.2627388
	speed: 0.0409s/iter; left time: 156.6847s
	iters: 800, epoch: 6 | loss: 0.3808318
	speed: 0.0406s/iter; left time: 151.3986s
	iters: 900, epoch: 6 | loss: 0.2744061
	speed: 0.0404s/iter; left time: 146.5474s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:37.02s
Steps: 906 | Train Loss: 0.2403413 Vali Loss: 0.5737603 Test Loss: 0.6485444
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.5564568638801575, rmse:0.7459603548049927, mae:0.5017440319061279, rse:0.5268758535385132
Original data scale mse:18213778.0, rmse:4267.76025390625, mae:2791.681640625, rse:0.21220164000988007

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.5899971127510071, RMSE: 0.7681127190589905, MAE: 0.5133547186851501, RSE: 0.542522132396698
Unscaled Metrics - MSE: 20480482.0, RMSE: 4525.53662109375, MAE: 2909.485107421875, RSE: 0.22501879930496216

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.5564568638801575, RMSE: 0.7459603548049927, MAE: 0.5017440319061279, RSE: 0.5268758535385132
Unscaled Metrics - MSE: 18213778.0, RMSE: 4267.76025390625, MAE: 2791.681640625, RSE: 0.21220164000988007

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.4364378
	speed: 0.0732s/iter; left time: 654.8065s
	iters: 200, epoch: 1 | loss: 1.1598252
	speed: 0.0459s/iter; left time: 405.4776s
	iters: 300, epoch: 1 | loss: 1.1067549
	speed: 0.0460s/iter; left time: 402.3896s
	iters: 400, epoch: 1 | loss: 0.9570055
	speed: 0.0461s/iter; left time: 397.9282s
	iters: 500, epoch: 1 | loss: 0.9231172
	speed: 0.0457s/iter; left time: 390.2962s
	iters: 600, epoch: 1 | loss: 0.7783369
	speed: 0.0458s/iter; left time: 386.6509s
	iters: 700, epoch: 1 | loss: 0.7586346
	speed: 0.0458s/iter; left time: 381.7381s
	iters: 800, epoch: 1 | loss: 0.7712030
	speed: 0.0456s/iter; left time: 376.1352s
	iters: 900, epoch: 1 | loss: 0.7576305
	speed: 0.0448s/iter; left time: 364.9161s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.09s
Steps: 904 | Train Loss: 1.0757898 Vali Loss: 1.0057359 Test Loss: 1.2458102
Validation loss decreased (inf --> 1.005736).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5986958
	speed: 0.1147s/iter; left time: 921.8860s
	iters: 200, epoch: 2 | loss: 0.6515172
	speed: 0.0457s/iter; left time: 362.9896s
	iters: 300, epoch: 2 | loss: 0.6456214
	speed: 0.0459s/iter; left time: 359.8697s
	iters: 400, epoch: 2 | loss: 0.5596751
	speed: 0.0458s/iter; left time: 354.4351s
	iters: 500, epoch: 2 | loss: 0.5824897
	speed: 0.0454s/iter; left time: 346.3667s
	iters: 600, epoch: 2 | loss: 0.6912509
	speed: 0.0466s/iter; left time: 350.9869s
	iters: 700, epoch: 2 | loss: 0.5478158
	speed: 0.0469s/iter; left time: 349.0674s
	iters: 800, epoch: 2 | loss: 0.6608341
	speed: 0.0460s/iter; left time: 337.6192s
	iters: 900, epoch: 2 | loss: 0.5338354
	speed: 0.0461s/iter; left time: 333.3333s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.75s
Steps: 904 | Train Loss: 0.6220955 Vali Loss: 0.8056815 Test Loss: 0.9740282
Validation loss decreased (1.005736 --> 0.805682).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6724384
	speed: 0.1168s/iter; left time: 833.1967s
	iters: 200, epoch: 3 | loss: 0.4530379
	speed: 0.0463s/iter; left time: 325.3416s
	iters: 300, epoch: 3 | loss: 0.4661729
	speed: 0.0449s/iter; left time: 311.0256s
	iters: 400, epoch: 3 | loss: 0.4943846
	speed: 0.0454s/iter; left time: 310.4666s
	iters: 500, epoch: 3 | loss: 0.5174448
	speed: 0.0469s/iter; left time: 315.5033s
	iters: 600, epoch: 3 | loss: 0.5947012
	speed: 0.0486s/iter; left time: 322.3807s
	iters: 700, epoch: 3 | loss: 0.4996810
	speed: 0.0465s/iter; left time: 304.0785s
	iters: 800, epoch: 3 | loss: 0.5118477
	speed: 0.0460s/iter; left time: 295.6682s
	iters: 900, epoch: 3 | loss: 0.4572067
	speed: 0.0462s/iter; left time: 292.8489s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:42.16s
Steps: 904 | Train Loss: 0.5293227 Vali Loss: 0.8155631 Test Loss: 1.0004238
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4552996
	speed: 0.1136s/iter; left time: 707.8800s
	iters: 200, epoch: 4 | loss: 0.4508196
	speed: 0.0479s/iter; left time: 293.7670s
	iters: 300, epoch: 4 | loss: 0.5002626
	speed: 0.0465s/iter; left time: 280.0956s
	iters: 400, epoch: 4 | loss: 0.3651407
	speed: 0.0459s/iter; left time: 272.2284s
	iters: 500, epoch: 4 | loss: 0.4720355
	speed: 0.0458s/iter; left time: 266.8594s
	iters: 600, epoch: 4 | loss: 0.4254288
	speed: 0.0460s/iter; left time: 263.6246s
	iters: 700, epoch: 4 | loss: 0.4942198
	speed: 0.0459s/iter; left time: 258.1807s
	iters: 800, epoch: 4 | loss: 0.4959442
	speed: 0.0443s/iter; left time: 244.8309s
	iters: 900, epoch: 4 | loss: 0.5533671
	speed: 0.0456s/iter; left time: 247.7445s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.79s
Steps: 904 | Train Loss: 0.4758206 Vali Loss: 0.8537440 Test Loss: 1.1117724
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3836651
	speed: 0.1165s/iter; left time: 620.2660s
	iters: 200, epoch: 5 | loss: 0.5287719
	speed: 0.0484s/iter; left time: 253.0882s
	iters: 300, epoch: 5 | loss: 0.4663406
	speed: 0.0470s/iter; left time: 241.0476s
	iters: 400, epoch: 5 | loss: 0.4098881
	speed: 0.0440s/iter; left time: 221.2812s
	iters: 500, epoch: 5 | loss: 0.3349856
	speed: 0.0404s/iter; left time: 199.2112s
	iters: 600, epoch: 5 | loss: 0.4023745
	speed: 0.0487s/iter; left time: 235.0934s
	iters: 700, epoch: 5 | loss: 0.3627478
	speed: 0.0481s/iter; left time: 227.0440s
	iters: 800, epoch: 5 | loss: 0.3631817
	speed: 0.0471s/iter; left time: 218.0648s
	iters: 900, epoch: 5 | loss: 0.3745475
	speed: 0.0418s/iter; left time: 189.1932s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.78s
Steps: 904 | Train Loss: 0.4125108 Vali Loss: 0.8396685 Test Loss: 1.0667289
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.9737030863761902, rmse:0.9867639541625977, mae:0.7140384912490845, rse:0.6988663077354431
Original data scale mse:35709004.0, rmse:5975.701171875, mae:4075.11083984375, rse:0.2975921034812927
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.3733890
	speed: 0.0499s/iter; left time: 446.0563s
	iters: 200, epoch: 1 | loss: 1.0366954
	speed: 0.0494s/iter; left time: 436.7279s
	iters: 300, epoch: 1 | loss: 1.0533051
	speed: 0.0481s/iter; left time: 420.1104s
	iters: 400, epoch: 1 | loss: 1.0050308
	speed: 0.0475s/iter; left time: 410.6295s
	iters: 500, epoch: 1 | loss: 1.0078546
	speed: 0.0456s/iter; left time: 389.8661s
	iters: 600, epoch: 1 | loss: 0.7826719
	speed: 0.0457s/iter; left time: 385.8995s
	iters: 700, epoch: 1 | loss: 1.0407343
	speed: 0.0453s/iter; left time: 377.7784s
	iters: 800, epoch: 1 | loss: 0.8054749
	speed: 0.0447s/iter; left time: 368.4118s
	iters: 900, epoch: 1 | loss: 0.8402656
	speed: 0.0460s/iter; left time: 374.4424s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:42.47s
Steps: 904 | Train Loss: 1.0958304 Vali Loss: 1.0005749 Test Loss: 1.2502023
Validation loss decreased (inf --> 1.000575).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7431842
	speed: 0.1139s/iter; left time: 915.6064s
	iters: 200, epoch: 2 | loss: 0.7043104
	speed: 0.0461s/iter; left time: 365.9308s
	iters: 300, epoch: 2 | loss: 0.6785800
	speed: 0.0458s/iter; left time: 358.9622s
	iters: 400, epoch: 2 | loss: 0.5244013
	speed: 0.0457s/iter; left time: 353.5955s
	iters: 500, epoch: 2 | loss: 0.5778711
	speed: 0.0455s/iter; left time: 347.7997s
	iters: 600, epoch: 2 | loss: 0.7242225
	speed: 0.0454s/iter; left time: 342.0335s
	iters: 700, epoch: 2 | loss: 0.6179404
	speed: 0.0453s/iter; left time: 336.9306s
	iters: 800, epoch: 2 | loss: 0.6326412
	speed: 0.0456s/iter; left time: 334.2789s
	iters: 900, epoch: 2 | loss: 0.4830694
	speed: 0.0458s/iter; left time: 331.3008s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.34s
Steps: 904 | Train Loss: 0.6197756 Vali Loss: 0.8305495 Test Loss: 1.0279979
Validation loss decreased (1.000575 --> 0.830550).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5895966
	speed: 0.1138s/iter; left time: 811.7937s
	iters: 200, epoch: 3 | loss: 0.6152219
	speed: 0.0461s/iter; left time: 324.4961s
	iters: 300, epoch: 3 | loss: 0.4819514
	speed: 0.0464s/iter; left time: 321.4957s
	iters: 400, epoch: 3 | loss: 0.4804656
	speed: 0.0456s/iter; left time: 311.8506s
	iters: 500, epoch: 3 | loss: 0.5198215
	speed: 0.0460s/iter; left time: 309.9130s
	iters: 600, epoch: 3 | loss: 0.5419685
	speed: 0.0459s/iter; left time: 304.3803s
	iters: 700, epoch: 3 | loss: 0.5140393
	speed: 0.0456s/iter; left time: 297.9990s
	iters: 800, epoch: 3 | loss: 0.6442379
	speed: 0.0443s/iter; left time: 284.8244s
	iters: 900, epoch: 3 | loss: 0.4891041
	speed: 0.0459s/iter; left time: 290.8639s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.50s
Steps: 904 | Train Loss: 0.5249637 Vali Loss: 0.8689520 Test Loss: 0.9814434
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4907143
	speed: 0.1112s/iter; left time: 692.6335s
	iters: 200, epoch: 4 | loss: 0.4936803
	speed: 0.0457s/iter; left time: 280.1758s
	iters: 300, epoch: 4 | loss: 0.4140792
	speed: 0.0452s/iter; left time: 272.2695s
	iters: 400, epoch: 4 | loss: 0.4117990
	speed: 0.0444s/iter; left time: 262.9952s
	iters: 500, epoch: 4 | loss: 0.4239112
	speed: 0.0451s/iter; left time: 263.0225s
	iters: 600, epoch: 4 | loss: 0.5231403
	speed: 0.0459s/iter; left time: 262.9384s
	iters: 700, epoch: 4 | loss: 0.4724452
	speed: 0.0459s/iter; left time: 258.1671s
	iters: 800, epoch: 4 | loss: 0.5031200
	speed: 0.0459s/iter; left time: 253.7337s
	iters: 900, epoch: 4 | loss: 0.4118849
	speed: 0.0452s/iter; left time: 245.2757s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.31s
Steps: 904 | Train Loss: 0.4687083 Vali Loss: 0.8451064 Test Loss: 1.0684121
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3297511
	speed: 0.1117s/iter; left time: 594.9368s
	iters: 200, epoch: 5 | loss: 0.4854363
	speed: 0.0462s/iter; left time: 241.2723s
	iters: 300, epoch: 5 | loss: 0.4151743
	speed: 0.0452s/iter; left time: 231.5945s
	iters: 400, epoch: 5 | loss: 0.3823123
	speed: 0.0452s/iter; left time: 227.0211s
	iters: 500, epoch: 5 | loss: 0.4447263
	speed: 0.0443s/iter; left time: 218.2418s
	iters: 600, epoch: 5 | loss: 0.3791458
	speed: 0.0354s/iter; left time: 170.6102s
	iters: 700, epoch: 5 | loss: 0.5040178
	speed: 0.0354s/iter; left time: 167.3342s
	iters: 800, epoch: 5 | loss: 0.4054351
	speed: 0.0356s/iter; left time: 164.5032s
	iters: 900, epoch: 5 | loss: 0.3675851
	speed: 0.0354s/iter; left time: 160.1984s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:37.20s
Steps: 904 | Train Loss: 0.4090191 Vali Loss: 0.8587462 Test Loss: 1.0722184
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:1.028056025505066, rmse:1.0139310359954834, mae:0.7082775235176086, rse:0.7181071043014526
Original data scale mse:36943168.0, rmse:6078.08935546875, mae:3976.282958984375, rse:0.3026910722255707

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.9737030863761902, RMSE: 0.9867639541625977, MAE: 0.7140384912490845, RSE: 0.6988663077354431
Unscaled Metrics - MSE: 35709004.0, RMSE: 5975.701171875, MAE: 4075.11083984375, RSE: 0.2975921034812927

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 1.028056025505066, RMSE: 1.0139310359954834, MAE: 0.7082775235176086, RSE: 0.7181071043014526
Unscaled Metrics - MSE: 36943168.0, RMSE: 6078.08935546875, MAE: 3976.282958984375, RSE: 0.3026910722255707

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.3745859
	speed: 0.0785s/iter; left time: 700.0948s
	iters: 200, epoch: 1 | loss: 1.1702946
	speed: 0.0522s/iter; left time: 460.1523s
	iters: 300, epoch: 1 | loss: 1.0531942
	speed: 0.0523s/iter; left time: 456.4294s
	iters: 400, epoch: 1 | loss: 1.0512502
	speed: 0.0520s/iter; left time: 448.1887s
	iters: 500, epoch: 1 | loss: 1.0022836
	speed: 0.0518s/iter; left time: 441.0100s
	iters: 600, epoch: 1 | loss: 1.0554776
	speed: 0.0520s/iter; left time: 438.1138s
	iters: 700, epoch: 1 | loss: 0.9907944
	speed: 0.0519s/iter; left time: 432.1088s
	iters: 800, epoch: 1 | loss: 0.9281198
	speed: 0.0473s/iter; left time: 388.8867s
	iters: 900, epoch: 1 | loss: 0.9796230
	speed: 0.0429s/iter; left time: 348.1090s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.22s
Steps: 902 | Train Loss: 1.1513286 Vali Loss: 1.2190248 Test Loss: 1.5499952
Validation loss decreased (inf --> 1.219025).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9484702
	speed: 0.1264s/iter; left time: 1013.8146s
	iters: 200, epoch: 2 | loss: 0.8109980
	speed: 0.0523s/iter; left time: 414.5457s
	iters: 300, epoch: 2 | loss: 0.8867019
	speed: 0.0520s/iter; left time: 406.4728s
	iters: 400, epoch: 2 | loss: 0.7061905
	speed: 0.0520s/iter; left time: 401.5260s
	iters: 500, epoch: 2 | loss: 0.6661617
	speed: 0.0517s/iter; left time: 394.2728s
	iters: 600, epoch: 2 | loss: 0.5889626
	speed: 0.0522s/iter; left time: 392.2778s
	iters: 700, epoch: 2 | loss: 0.5765019
	speed: 0.0520s/iter; left time: 385.8825s
	iters: 800, epoch: 2 | loss: 0.7177598
	speed: 0.0518s/iter; left time: 379.3059s
	iters: 900, epoch: 2 | loss: 0.5458984
	speed: 0.0523s/iter; left time: 377.7081s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.67s
Steps: 902 | Train Loss: 0.7026403 Vali Loss: 0.8414673 Test Loss: 1.0187247
Validation loss decreased (1.219025 --> 0.841467).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6698905
	speed: 0.1334s/iter; left time: 949.6152s
	iters: 200, epoch: 3 | loss: 0.5784551
	speed: 0.0515s/iter; left time: 361.4741s
	iters: 300, epoch: 3 | loss: 0.5692095
	speed: 0.0518s/iter; left time: 358.5269s
	iters: 400, epoch: 3 | loss: 0.6479097
	speed: 0.0522s/iter; left time: 355.8084s
	iters: 500, epoch: 3 | loss: 0.5724992
	speed: 0.0520s/iter; left time: 349.2612s
	iters: 600, epoch: 3 | loss: 0.5907867
	speed: 0.0517s/iter; left time: 342.1700s
	iters: 700, epoch: 3 | loss: 0.5809578
	speed: 0.0518s/iter; left time: 337.6190s
	iters: 800, epoch: 3 | loss: 0.5968349
	speed: 0.0522s/iter; left time: 335.0167s
	iters: 900, epoch: 3 | loss: 0.5313306
	speed: 0.0522s/iter; left time: 329.9173s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.06s
Steps: 902 | Train Loss: 0.5623373 Vali Loss: 0.8512719 Test Loss: 1.0175885
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4577109
	speed: 0.1277s/iter; left time: 793.7645s
	iters: 200, epoch: 4 | loss: 0.4526280
	speed: 0.0517s/iter; left time: 316.4107s
	iters: 300, epoch: 4 | loss: 0.5374820
	speed: 0.0522s/iter; left time: 314.0513s
	iters: 400, epoch: 4 | loss: 0.4949814
	speed: 0.0523s/iter; left time: 309.2529s
	iters: 500, epoch: 4 | loss: 0.5505146
	speed: 0.0523s/iter; left time: 304.2927s
	iters: 600, epoch: 4 | loss: 0.4595668
	speed: 0.0519s/iter; left time: 296.4963s
	iters: 700, epoch: 4 | loss: 0.5024803
	speed: 0.0519s/iter; left time: 291.4997s
	iters: 800, epoch: 4 | loss: 0.4706160
	speed: 0.0519s/iter; left time: 286.1802s
	iters: 900, epoch: 4 | loss: 0.4669259
	speed: 0.0518s/iter; left time: 280.5717s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.09s
Steps: 902 | Train Loss: 0.4868319 Vali Loss: 0.8985002 Test Loss: 1.1229521
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4818591
	speed: 0.1280s/iter; left time: 680.2427s
	iters: 200, epoch: 5 | loss: 0.4531398
	speed: 0.0519s/iter; left time: 270.3582s
	iters: 300, epoch: 5 | loss: 0.4356573
	speed: 0.0518s/iter; left time: 264.9867s
	iters: 400, epoch: 5 | loss: 0.4680046
	speed: 0.0519s/iter; left time: 260.2286s
	iters: 500, epoch: 5 | loss: 0.3488860
	speed: 0.0519s/iter; left time: 255.0751s
	iters: 600, epoch: 5 | loss: 0.3822190
	speed: 0.0522s/iter; left time: 251.3372s
	iters: 700, epoch: 5 | loss: 0.4051428
	speed: 0.0517s/iter; left time: 243.5739s
	iters: 800, epoch: 5 | loss: 0.3814742
	speed: 0.0515s/iter; left time: 237.7025s
	iters: 900, epoch: 5 | loss: 0.3089029
	speed: 0.0520s/iter; left time: 234.5272s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.00s
Steps: 902 | Train Loss: 0.4091236 Vali Loss: 0.9202779 Test Loss: 1.1480784
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:1.0187760591506958, rmse:1.0093443393707275, mae:0.7099193930625916, rse:0.7151606678962708
Original data scale mse:36735616.0, rmse:6060.9912109375, mae:3992.347900390625, rse:0.3019877076148987
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.4953830
	speed: 0.0536s/iter; left time: 477.7855s
	iters: 200, epoch: 1 | loss: 1.0752630
	speed: 0.0518s/iter; left time: 456.6646s
	iters: 300, epoch: 1 | loss: 0.9210144
	speed: 0.0516s/iter; left time: 450.3124s
	iters: 400, epoch: 1 | loss: 1.0476022
	speed: 0.0520s/iter; left time: 448.1548s
	iters: 500, epoch: 1 | loss: 0.9651564
	speed: 0.0519s/iter; left time: 442.6112s
	iters: 600, epoch: 1 | loss: 1.0233231
	speed: 0.0520s/iter; left time: 437.6406s
	iters: 700, epoch: 1 | loss: 1.0334811
	speed: 0.0519s/iter; left time: 432.2598s
	iters: 800, epoch: 1 | loss: 0.9086421
	speed: 0.0516s/iter; left time: 424.5400s
	iters: 900, epoch: 1 | loss: 0.9369379
	speed: 0.0516s/iter; left time: 419.2239s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:46.97s
Steps: 902 | Train Loss: 1.1434105 Vali Loss: 1.2190293 Test Loss: 1.5419244
Validation loss decreased (inf --> 1.219029).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9495101
	speed: 0.1340s/iter; left time: 1074.4917s
	iters: 200, epoch: 2 | loss: 0.7249999
	speed: 0.0517s/iter; left time: 409.1167s
	iters: 300, epoch: 2 | loss: 0.7872232
	speed: 0.0521s/iter; left time: 407.5589s
	iters: 400, epoch: 2 | loss: 0.5683339
	speed: 0.0520s/iter; left time: 401.4876s
	iters: 500, epoch: 2 | loss: 0.7424693
	speed: 0.0518s/iter; left time: 394.6097s
	iters: 600, epoch: 2 | loss: 0.5929024
	speed: 0.0520s/iter; left time: 390.8397s
	iters: 700, epoch: 2 | loss: 0.6338698
	speed: 0.0518s/iter; left time: 384.2044s
	iters: 800, epoch: 2 | loss: 0.5652323
	speed: 0.0519s/iter; left time: 379.8590s
	iters: 900, epoch: 2 | loss: 0.5701886
	speed: 0.0516s/iter; left time: 372.5726s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.03s
Steps: 902 | Train Loss: 0.7081383 Vali Loss: 0.8662287 Test Loss: 1.0496217
Validation loss decreased (1.219029 --> 0.866229).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5793532
	speed: 0.1322s/iter; left time: 940.5788s
	iters: 200, epoch: 3 | loss: 0.5346143
	speed: 0.0521s/iter; left time: 365.2849s
	iters: 300, epoch: 3 | loss: 0.5093194
	speed: 0.0521s/iter; left time: 360.1269s
	iters: 400, epoch: 3 | loss: 0.4644130
	speed: 0.0522s/iter; left time: 355.8399s
	iters: 500, epoch: 3 | loss: 0.5417706
	speed: 0.0522s/iter; left time: 350.3275s
	iters: 600, epoch: 3 | loss: 0.5409910
	speed: 0.0522s/iter; left time: 345.1887s
	iters: 700, epoch: 3 | loss: 0.5331252
	speed: 0.0439s/iter; left time: 286.2078s
	iters: 800, epoch: 3 | loss: 0.4450013
	speed: 0.0427s/iter; left time: 274.1025s
	iters: 900, epoch: 3 | loss: 0.5331306
	speed: 0.0426s/iter; left time: 269.3726s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:44.51s
Steps: 902 | Train Loss: 0.5615010 Vali Loss: 0.8738716 Test Loss: 1.0468290
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4688885
	speed: 0.1285s/iter; left time: 798.5531s
	iters: 200, epoch: 4 | loss: 0.5186148
	speed: 0.0522s/iter; left time: 319.4386s
	iters: 300, epoch: 4 | loss: 0.6041689
	speed: 0.0520s/iter; left time: 312.6413s
	iters: 400, epoch: 4 | loss: 0.5151629
	speed: 0.0519s/iter; left time: 306.7103s
	iters: 500, epoch: 4 | loss: 0.5432757
	speed: 0.0517s/iter; left time: 300.8698s
	iters: 600, epoch: 4 | loss: 0.5016103
	speed: 0.0520s/iter; left time: 296.9415s
	iters: 700, epoch: 4 | loss: 0.4520583
	speed: 0.0520s/iter; left time: 291.8774s
	iters: 800, epoch: 4 | loss: 0.4216853
	speed: 0.0517s/iter; left time: 285.0099s
	iters: 900, epoch: 4 | loss: 0.4881199
	speed: 0.0516s/iter; left time: 279.5704s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.04s
Steps: 902 | Train Loss: 0.4967183 Vali Loss: 0.8769358 Test Loss: 1.1720126
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4657465
	speed: 0.1278s/iter; left time: 678.9108s
	iters: 200, epoch: 5 | loss: 0.3934326
	speed: 0.0521s/iter; left time: 271.6366s
	iters: 300, epoch: 5 | loss: 0.4102286
	speed: 0.0517s/iter; left time: 264.2940s
	iters: 400, epoch: 5 | loss: 0.4243727
	speed: 0.0513s/iter; left time: 257.3552s
	iters: 500, epoch: 5 | loss: 0.4177071
	speed: 0.0517s/iter; left time: 253.7812s
	iters: 600, epoch: 5 | loss: 0.4192641
	speed: 0.0513s/iter; left time: 246.6906s
	iters: 700, epoch: 5 | loss: 0.3981318
	speed: 0.0513s/iter; left time: 241.5546s
	iters: 800, epoch: 5 | loss: 0.4508173
	speed: 0.0515s/iter; left time: 237.4926s
	iters: 900, epoch: 5 | loss: 0.3909015
	speed: 0.0514s/iter; left time: 232.1673s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:46.67s
Steps: 902 | Train Loss: 0.4265282 Vali Loss: 0.9092080 Test Loss: 1.1404788
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:1.0489619970321655, rmse:1.0241883993148804, mae:0.7395305037498474, rse:0.7256783246994019
Original data scale mse:38725652.0, rmse:6222.99365234375, mae:4226.7587890625, rse:0.31005945801734924

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 1.0187760591506958, RMSE: 1.0093443393707275, MAE: 0.7099193930625916, RSE: 0.7151606678962708
Unscaled Metrics - MSE: 36735616.0, RMSE: 6060.9912109375, MAE: 3992.347900390625, RSE: 0.3019877076148987

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 1.0489619970321655, RMSE: 1.0241883993148804, MAE: 0.7395305037498474, RSE: 0.7256783246994019
Unscaled Metrics - MSE: 38725652.0, RMSE: 6222.99365234375, MAE: 4226.7587890625, RSE: 0.31005945801734924

=== Starting experiments for loss function: RMSE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 1.0893705
	speed: 0.0663s/iter; left time: 594.4005s
	iters: 200, epoch: 1 | loss: 0.9512289
	speed: 0.0403s/iter; left time: 357.1222s
	iters: 300, epoch: 1 | loss: 0.8506984
	speed: 0.0402s/iter; left time: 352.4968s
	iters: 400, epoch: 1 | loss: 0.7763177
	speed: 0.0400s/iter; left time: 346.6279s
	iters: 500, epoch: 1 | loss: 0.7202011
	speed: 0.0398s/iter; left time: 340.9341s
	iters: 600, epoch: 1 | loss: 0.6781369
	speed: 0.0396s/iter; left time: 335.2652s
	iters: 700, epoch: 1 | loss: 0.8244737
	speed: 0.0401s/iter; left time: 335.4327s
	iters: 800, epoch: 1 | loss: 0.7220547
	speed: 0.0404s/iter; left time: 333.7260s
	iters: 900, epoch: 1 | loss: 0.6331048
	speed: 0.0405s/iter; left time: 330.4678s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:37.09s
Steps: 906 | Train Loss: 0.8610380 Vali Loss: 0.6556163 Test Loss: 0.7476696
Validation loss decreased (inf --> 0.655616).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5439448
	speed: 0.0972s/iter; left time: 782.6716s
	iters: 200, epoch: 2 | loss: 0.7190135
	speed: 0.0400s/iter; left time: 318.5171s
	iters: 300, epoch: 2 | loss: 0.5957596
	speed: 0.0402s/iter; left time: 315.5601s
	iters: 400, epoch: 2 | loss: 0.6530741
	speed: 0.0401s/iter; left time: 310.9351s
	iters: 500, epoch: 2 | loss: 0.5317350
	speed: 0.0405s/iter; left time: 309.7394s
	iters: 600, epoch: 2 | loss: 0.5626906
	speed: 0.0403s/iter; left time: 304.1066s
	iters: 700, epoch: 2 | loss: 0.5537284
	speed: 0.0403s/iter; left time: 300.1308s
	iters: 800, epoch: 2 | loss: 0.6625579
	speed: 0.0403s/iter; left time: 296.0959s
	iters: 900, epoch: 2 | loss: 0.5929010
	speed: 0.0403s/iter; left time: 292.7234s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.71s
Steps: 906 | Train Loss: 0.6229504 Vali Loss: 0.5268389 Test Loss: 0.6051754
Validation loss decreased (0.655616 --> 0.526839).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6032529
	speed: 0.0971s/iter; left time: 694.3647s
	iters: 200, epoch: 3 | loss: 0.5263888
	speed: 0.0397s/iter; left time: 279.4938s
	iters: 300, epoch: 3 | loss: 0.5730927
	speed: 0.0399s/iter; left time: 277.2005s
	iters: 400, epoch: 3 | loss: 0.5744143
	speed: 0.0405s/iter; left time: 277.0661s
	iters: 500, epoch: 3 | loss: 0.6342534
	speed: 0.0404s/iter; left time: 272.4862s
	iters: 600, epoch: 3 | loss: 0.6302583
	speed: 0.0404s/iter; left time: 268.6032s
	iters: 700, epoch: 3 | loss: 0.6075535
	speed: 0.0402s/iter; left time: 262.9916s
	iters: 800, epoch: 3 | loss: 0.5772125
	speed: 0.0403s/iter; left time: 260.1643s
	iters: 900, epoch: 3 | loss: 0.5734351
	speed: 0.0404s/iter; left time: 256.4817s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.65s
Steps: 906 | Train Loss: 0.5757536 Vali Loss: 0.5444868 Test Loss: 0.5959973
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5060974
	speed: 0.0937s/iter; left time: 585.0359s
	iters: 200, epoch: 4 | loss: 0.5604421
	speed: 0.0404s/iter; left time: 248.3030s
	iters: 300, epoch: 4 | loss: 0.5364972
	speed: 0.0404s/iter; left time: 243.9382s
	iters: 400, epoch: 4 | loss: 0.4714419
	speed: 0.0404s/iter; left time: 240.2079s
	iters: 500, epoch: 4 | loss: 0.6106148
	speed: 0.0388s/iter; left time: 226.8807s
	iters: 600, epoch: 4 | loss: 0.5718138
	speed: 0.0402s/iter; left time: 230.6092s
	iters: 700, epoch: 4 | loss: 0.5396762
	speed: 0.0405s/iter; left time: 228.6090s
	iters: 800, epoch: 4 | loss: 0.5925730
	speed: 0.0402s/iter; left time: 222.8180s
	iters: 900, epoch: 4 | loss: 0.5284407
	speed: 0.0402s/iter; left time: 218.7953s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.61s
Steps: 906 | Train Loss: 0.5480513 Vali Loss: 0.5250769 Test Loss: 0.5773783
Validation loss decreased (0.526839 --> 0.525077).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5529761
	speed: 0.0991s/iter; left time: 528.7627s
	iters: 200, epoch: 5 | loss: 0.5360772
	speed: 0.0399s/iter; left time: 208.9799s
	iters: 300, epoch: 5 | loss: 0.4747599
	speed: 0.0402s/iter; left time: 206.7019s
	iters: 400, epoch: 5 | loss: 0.5710815
	speed: 0.0404s/iter; left time: 203.3457s
	iters: 500, epoch: 5 | loss: 0.4878625
	speed: 0.0406s/iter; left time: 200.3091s
	iters: 600, epoch: 5 | loss: 0.5515639
	speed: 0.0405s/iter; left time: 195.7215s
	iters: 700, epoch: 5 | loss: 0.4939330
	speed: 0.0405s/iter; left time: 191.7920s
	iters: 800, epoch: 5 | loss: 0.5224929
	speed: 0.0403s/iter; left time: 187.0776s
	iters: 900, epoch: 5 | loss: 0.5200915
	speed: 0.0404s/iter; left time: 183.2970s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.82s
Steps: 906 | Train Loss: 0.5164797 Vali Loss: 0.5493622 Test Loss: 0.6422522
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5230393
	speed: 0.0935s/iter; left time: 414.3937s
	iters: 200, epoch: 6 | loss: 0.4774376
	speed: 0.0401s/iter; left time: 173.8537s
	iters: 300, epoch: 6 | loss: 0.4615297
	speed: 0.0400s/iter; left time: 169.1166s
	iters: 400, epoch: 6 | loss: 0.4964353
	speed: 0.0399s/iter; left time: 164.8775s
	iters: 500, epoch: 6 | loss: 0.4837426
	speed: 0.0405s/iter; left time: 163.3297s
	iters: 600, epoch: 6 | loss: 0.4396252
	speed: 0.0403s/iter; left time: 158.5337s
	iters: 700, epoch: 6 | loss: 0.5233650
	speed: 0.0405s/iter; left time: 155.0975s
	iters: 800, epoch: 6 | loss: 0.4214927
	speed: 0.0403s/iter; left time: 150.2452s
	iters: 900, epoch: 6 | loss: 0.4138309
	speed: 0.0405s/iter; left time: 147.2085s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.72s
Steps: 906 | Train Loss: 0.4801822 Vali Loss: 0.5435560 Test Loss: 0.6278403
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.4256660
	speed: 0.0942s/iter; left time: 332.1438s
	iters: 200, epoch: 7 | loss: 0.4825665
	speed: 0.0407s/iter; left time: 139.3084s
	iters: 300, epoch: 7 | loss: 0.4817990
	speed: 0.0343s/iter; left time: 114.1439s
	iters: 400, epoch: 7 | loss: 0.5077376
	speed: 0.0391s/iter; left time: 125.9738s
	iters: 500, epoch: 7 | loss: 0.4178159
	speed: 0.0390s/iter; left time: 122.0056s
	iters: 600, epoch: 7 | loss: 0.4644975
	speed: 0.0400s/iter; left time: 120.9885s
	iters: 700, epoch: 7 | loss: 0.4296982
	speed: 0.0399s/iter; left time: 116.7592s
	iters: 800, epoch: 7 | loss: 0.4410520
	speed: 0.0396s/iter; left time: 111.8889s
	iters: 900, epoch: 7 | loss: 0.4226002
	speed: 0.0398s/iter; left time: 108.3210s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:35.74s
Steps: 906 | Train Loss: 0.4469262 Vali Loss: 0.5317947 Test Loss: 0.6283857
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.5770782232284546, rmse:0.7596566677093506, mae:0.5050341486930847, rse:0.5365495681762695
Original data scale mse:19703646.0, rmse:4438.87890625, mae:2844.352294921875, rse:0.22071000933647156
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 1.1428912
	speed: 0.0418s/iter; left time: 374.1805s
	iters: 200, epoch: 1 | loss: 0.9737824
	speed: 0.0402s/iter; left time: 355.8210s
	iters: 300, epoch: 1 | loss: 0.8888040
	speed: 0.0400s/iter; left time: 350.4883s
	iters: 400, epoch: 1 | loss: 0.8050730
	speed: 0.0398s/iter; left time: 344.4689s
	iters: 500, epoch: 1 | loss: 0.7757652
	speed: 0.0398s/iter; left time: 341.1283s
	iters: 600, epoch: 1 | loss: 0.7022007
	speed: 0.0394s/iter; left time: 333.2316s
	iters: 700, epoch: 1 | loss: 0.7239096
	speed: 0.0338s/iter; left time: 282.8975s
	iters: 800, epoch: 1 | loss: 0.7146141
	speed: 0.0399s/iter; left time: 329.2980s
	iters: 900, epoch: 1 | loss: 0.6560689
	speed: 0.0403s/iter; left time: 328.7983s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:35.78s
Steps: 906 | Train Loss: 0.8614392 Vali Loss: 0.6573020 Test Loss: 0.7553095
Validation loss decreased (inf --> 0.657302).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.5857936
	speed: 0.0995s/iter; left time: 801.0838s
	iters: 200, epoch: 2 | loss: 0.6344243
	speed: 0.0402s/iter; left time: 319.5909s
	iters: 300, epoch: 2 | loss: 0.7321730
	speed: 0.0397s/iter; left time: 311.6164s
	iters: 400, epoch: 2 | loss: 0.5941128
	speed: 0.0403s/iter; left time: 312.8480s
	iters: 500, epoch: 2 | loss: 0.6601084
	speed: 0.0399s/iter; left time: 305.7607s
	iters: 600, epoch: 2 | loss: 0.6725516
	speed: 0.0397s/iter; left time: 299.8444s
	iters: 700, epoch: 2 | loss: 0.5984154
	speed: 0.0398s/iter; left time: 296.3429s
	iters: 800, epoch: 2 | loss: 0.4842073
	speed: 0.0405s/iter; left time: 297.8941s
	iters: 900, epoch: 2 | loss: 0.5145763
	speed: 0.0399s/iter; left time: 289.2077s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:36.49s
Steps: 906 | Train Loss: 0.6210184 Vali Loss: 0.5195295 Test Loss: 0.5807799
Validation loss decreased (0.657302 --> 0.519530).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.6175659
	speed: 0.0994s/iter; left time: 710.7058s
	iters: 200, epoch: 3 | loss: 0.5203048
	speed: 0.0396s/iter; left time: 279.2533s
	iters: 300, epoch: 3 | loss: 0.5094767
	speed: 0.0403s/iter; left time: 280.3290s
	iters: 400, epoch: 3 | loss: 0.6046188
	speed: 0.0400s/iter; left time: 274.1667s
	iters: 500, epoch: 3 | loss: 0.4947087
	speed: 0.0396s/iter; left time: 267.3650s
	iters: 600, epoch: 3 | loss: 0.5956973
	speed: 0.0393s/iter; left time: 261.5198s
	iters: 700, epoch: 3 | loss: 0.5496719
	speed: 0.0399s/iter; left time: 261.0510s
	iters: 800, epoch: 3 | loss: 0.5555005
	speed: 0.0398s/iter; left time: 256.6133s
	iters: 900, epoch: 3 | loss: 0.5963997
	speed: 0.0403s/iter; left time: 255.6966s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:36.31s
Steps: 906 | Train Loss: 0.5740571 Vali Loss: 0.5227128 Test Loss: 0.5508002
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.5212364
	speed: 0.0960s/iter; left time: 599.2168s
	iters: 200, epoch: 4 | loss: 0.6462222
	speed: 0.0404s/iter; left time: 248.4194s
	iters: 300, epoch: 4 | loss: 0.6257039
	speed: 0.0404s/iter; left time: 244.3060s
	iters: 400, epoch: 4 | loss: 0.6105024
	speed: 0.0403s/iter; left time: 239.5283s
	iters: 500, epoch: 4 | loss: 0.5493617
	speed: 0.0405s/iter; left time: 236.6357s
	iters: 600, epoch: 4 | loss: 0.5384201
	speed: 0.0404s/iter; left time: 232.2293s
	iters: 700, epoch: 4 | loss: 0.5126185
	speed: 0.0405s/iter; left time: 228.4605s
	iters: 800, epoch: 4 | loss: 0.5846488
	speed: 0.0404s/iter; left time: 224.2117s
	iters: 900, epoch: 4 | loss: 0.5466056
	speed: 0.0406s/iter; left time: 220.8061s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.93s
Steps: 906 | Train Loss: 0.5460667 Vali Loss: 0.5223329 Test Loss: 0.5715632
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5707991
	speed: 0.0947s/iter; left time: 505.4198s
	iters: 200, epoch: 5 | loss: 0.4737735
	speed: 0.0386s/iter; left time: 201.9320s
	iters: 300, epoch: 5 | loss: 0.5521416
	speed: 0.0402s/iter; left time: 206.5330s
	iters: 400, epoch: 5 | loss: 0.5731253
	speed: 0.0405s/iter; left time: 203.8247s
	iters: 500, epoch: 5 | loss: 0.5957470
	speed: 0.0406s/iter; left time: 200.4662s
	iters: 600, epoch: 5 | loss: 0.5403872
	speed: 0.0405s/iter; left time: 195.6569s
	iters: 700, epoch: 5 | loss: 0.4529695
	speed: 0.0406s/iter; left time: 192.5102s
	iters: 800, epoch: 5 | loss: 0.4702152
	speed: 0.0406s/iter; left time: 188.1354s
	iters: 900, epoch: 5 | loss: 0.4908158
	speed: 0.0397s/iter; left time: 179.9072s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.45s
Steps: 906 | Train Loss: 0.5175677 Vali Loss: 0.5529737 Test Loss: 0.5992799
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.5795415043830872, rmse:0.7612762451171875, mae:0.5109877586364746, rse:0.5376935005187988
Original data scale mse:19322682.0, rmse:4395.75732421875, mae:2863.135009765625, rse:0.2185659110546112

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.5770782232284546, RMSE: 0.7596566677093506, MAE: 0.5050341486930847, RSE: 0.5365495681762695
Unscaled Metrics - MSE: 19703646.0, RMSE: 4438.87890625, MAE: 2844.352294921875, RSE: 0.22071000933647156

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.5795415043830872, RMSE: 0.7612762451171875, MAE: 0.5109877586364746, RSE: 0.5376935005187988
Unscaled Metrics - MSE: 19322682.0, RMSE: 4395.75732421875, MAE: 2863.135009765625, RSE: 0.2185659110546112

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.1864200
	speed: 0.0938s/iter; left time: 839.0351s
	iters: 200, epoch: 1 | loss: 1.0694504
	speed: 0.0747s/iter; left time: 660.1009s
	iters: 300, epoch: 1 | loss: 1.0419170
	speed: 0.1126s/iter; left time: 984.1358s
	iters: 400, epoch: 1 | loss: 0.9653840
	speed: 0.0947s/iter; left time: 818.6240s
	iters: 500, epoch: 1 | loss: 0.9470886
	speed: 0.0893s/iter; left time: 762.4802s
	iters: 600, epoch: 1 | loss: 0.8588463
	speed: 0.0523s/iter; left time: 441.8677s
	iters: 700, epoch: 1 | loss: 0.8537890
	speed: 0.0556s/iter; left time: 463.5036s
	iters: 800, epoch: 1 | loss: 0.8622568
	speed: 0.0960s/iter; left time: 790.9038s
	iters: 900, epoch: 1 | loss: 0.8627577
	speed: 0.0541s/iter; left time: 440.2783s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:10.41s
Steps: 904 | Train Loss: 1.0099906 Vali Loss: 0.9872365 Test Loss: 1.2190046
Validation loss decreased (inf --> 0.987236).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7630579
	speed: 0.2482s/iter; left time: 1994.4969s
	iters: 200, epoch: 2 | loss: 0.7959623
	speed: 0.0924s/iter; left time: 733.0564s
	iters: 300, epoch: 2 | loss: 0.7983449
	speed: 0.0446s/iter; left time: 349.1602s
	iters: 400, epoch: 2 | loss: 0.7440619
	speed: 0.0430s/iter; left time: 332.5874s
	iters: 500, epoch: 2 | loss: 0.7593584
	speed: 0.0450s/iter; left time: 343.3618s
	iters: 600, epoch: 2 | loss: 0.8311790
	speed: 0.0460s/iter; left time: 346.5232s
	iters: 700, epoch: 2 | loss: 0.7398415
	speed: 0.0434s/iter; left time: 322.5054s
	iters: 800, epoch: 2 | loss: 0.8105848
	speed: 0.0458s/iter; left time: 335.8800s
	iters: 900, epoch: 2 | loss: 0.7366433
	speed: 0.0408s/iter; left time: 295.3030s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:51.19s
Steps: 904 | Train Loss: 0.7830952 Vali Loss: 0.8073614 Test Loss: 0.9815933
Validation loss decreased (0.987236 --> 0.807361).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.8203081
	speed: 0.1161s/iter; left time: 828.4296s
	iters: 200, epoch: 3 | loss: 0.6773463
	speed: 0.0441s/iter; left time: 310.3369s
	iters: 300, epoch: 3 | loss: 0.6842815
	speed: 0.0441s/iter; left time: 306.0241s
	iters: 400, epoch: 3 | loss: 0.7110403
	speed: 0.0436s/iter; left time: 297.8008s
	iters: 500, epoch: 3 | loss: 0.7149786
	speed: 0.0403s/iter; left time: 271.5398s
	iters: 600, epoch: 3 | loss: 0.7476578
	speed: 0.0417s/iter; left time: 276.3170s
	iters: 700, epoch: 3 | loss: 0.6963635
	speed: 0.0437s/iter; left time: 285.3471s
	iters: 800, epoch: 3 | loss: 0.7178509
	speed: 0.0438s/iter; left time: 281.7158s
	iters: 900, epoch: 3 | loss: 0.7047575
	speed: 0.0437s/iter; left time: 276.7244s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:39.29s
Steps: 904 | Train Loss: 0.7226166 Vali Loss: 0.8088574 Test Loss: 0.9755690
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6689600
	speed: 0.1109s/iter; left time: 690.7020s
	iters: 200, epoch: 4 | loss: 0.6645071
	speed: 0.0433s/iter; left time: 265.5185s
	iters: 300, epoch: 4 | loss: 0.7001191
	speed: 0.0453s/iter; left time: 272.8789s
	iters: 400, epoch: 4 | loss: 0.5787080
	speed: 0.0453s/iter; left time: 268.7266s
	iters: 500, epoch: 4 | loss: 0.6820773
	speed: 0.0438s/iter; left time: 255.4227s
	iters: 600, epoch: 4 | loss: 0.6402148
	speed: 0.0443s/iter; left time: 254.0285s
	iters: 700, epoch: 4 | loss: 0.7012712
	speed: 0.0435s/iter; left time: 244.9052s
	iters: 800, epoch: 4 | loss: 0.6876411
	speed: 0.0434s/iter; left time: 240.1326s
	iters: 900, epoch: 4 | loss: 0.7174248
	speed: 0.0447s/iter; left time: 242.5355s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:40.26s
Steps: 904 | Train Loss: 0.6844954 Vali Loss: 0.8713527 Test Loss: 1.0559355
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6203896
	speed: 0.1114s/iter; left time: 593.4556s
	iters: 200, epoch: 5 | loss: 0.7167701
	speed: 0.0457s/iter; left time: 238.9472s
	iters: 300, epoch: 5 | loss: 0.6696028
	speed: 0.0437s/iter; left time: 223.8651s
	iters: 400, epoch: 5 | loss: 0.6345533
	speed: 0.0460s/iter; left time: 231.0084s
	iters: 500, epoch: 5 | loss: 0.5755187
	speed: 0.0458s/iter; left time: 225.6082s
	iters: 600, epoch: 5 | loss: 0.6366954
	speed: 0.0457s/iter; left time: 220.4735s
	iters: 700, epoch: 5 | loss: 0.6165271
	speed: 0.0445s/iter; left time: 210.0552s
	iters: 800, epoch: 5 | loss: 0.5808907
	speed: 0.0456s/iter; left time: 211.0655s
	iters: 900, epoch: 5 | loss: 0.5922693
	speed: 0.0433s/iter; left time: 196.0939s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.00s
Steps: 904 | Train Loss: 0.6344748 Vali Loss: 0.8234618 Test Loss: 1.0511380
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.9811739325523376, rmse:0.9905422329902649, mae:0.7066802382469177, rse:0.7015422582626343
Original data scale mse:35458704.0, rmse:5954.72119140625, mae:4002.440185546875, rse:0.2965472936630249
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 1.1487782
	speed: 0.0466s/iter; left time: 416.2316s
	iters: 200, epoch: 1 | loss: 1.0065224
	speed: 0.0461s/iter; left time: 407.9297s
	iters: 300, epoch: 1 | loss: 1.0161097
	speed: 0.0438s/iter; left time: 382.9112s
	iters: 400, epoch: 1 | loss: 0.9922448
	speed: 0.0454s/iter; left time: 392.6107s
	iters: 500, epoch: 1 | loss: 0.9912800
	speed: 0.0461s/iter; left time: 393.9909s
	iters: 600, epoch: 1 | loss: 0.8629833
	speed: 0.0442s/iter; left time: 373.0270s
	iters: 700, epoch: 1 | loss: 1.0088410
	speed: 0.0453s/iter; left time: 378.1894s
	iters: 800, epoch: 1 | loss: 0.8819415
	speed: 0.0459s/iter; left time: 378.5491s
	iters: 900, epoch: 1 | loss: 0.9015248
	speed: 0.0442s/iter; left time: 359.4503s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.03s
Steps: 904 | Train Loss: 1.0168758 Vali Loss: 0.9740047 Test Loss: 1.2116605
Validation loss decreased (inf --> 0.974005).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.8573585
	speed: 0.1229s/iter; left time: 987.5552s
	iters: 200, epoch: 2 | loss: 0.8309094
	speed: 0.0460s/iter; left time: 364.7056s
	iters: 300, epoch: 2 | loss: 0.8259976
	speed: 0.0452s/iter; left time: 354.0755s
	iters: 400, epoch: 2 | loss: 0.7171270
	speed: 0.0453s/iter; left time: 350.7639s
	iters: 500, epoch: 2 | loss: 0.7571544
	speed: 0.0427s/iter; left time: 326.4755s
	iters: 600, epoch: 2 | loss: 0.8359039
	speed: 0.0459s/iter; left time: 345.5874s
	iters: 700, epoch: 2 | loss: 0.7676290
	speed: 0.0452s/iter; left time: 335.8196s
	iters: 800, epoch: 2 | loss: 0.7887233
	speed: 0.0445s/iter; left time: 326.1538s
	iters: 900, epoch: 2 | loss: 0.6954601
	speed: 0.0432s/iter; left time: 312.8481s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:40.88s
Steps: 904 | Train Loss: 0.7817654 Vali Loss: 0.8096108 Test Loss: 1.0182480
Validation loss decreased (0.974005 --> 0.809611).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7582366
	speed: 0.1100s/iter; left time: 784.7141s
	iters: 200, epoch: 3 | loss: 0.7908609
	speed: 0.0357s/iter; left time: 250.7670s
	iters: 300, epoch: 3 | loss: 0.6887024
	speed: 0.0356s/iter; left time: 247.0661s
	iters: 400, epoch: 3 | loss: 0.6855975
	speed: 0.0362s/iter; left time: 247.5557s
	iters: 500, epoch: 3 | loss: 0.6976668
	speed: 0.0453s/iter; left time: 305.1798s
	iters: 600, epoch: 3 | loss: 0.7248797
	speed: 0.0448s/iter; left time: 297.1579s
	iters: 700, epoch: 3 | loss: 0.7118469
	speed: 0.0445s/iter; left time: 290.5153s
	iters: 800, epoch: 3 | loss: 0.7700001
	speed: 0.0462s/iter; left time: 297.4770s
	iters: 900, epoch: 3 | loss: 0.7122335
	speed: 0.0467s/iter; left time: 295.5143s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:37.92s
Steps: 904 | Train Loss: 0.7194997 Vali Loss: 0.8413067 Test Loss: 0.9960473
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.7177252
	speed: 0.1115s/iter; left time: 694.7127s
	iters: 200, epoch: 4 | loss: 0.6865547
	speed: 0.0459s/iter; left time: 281.0927s
	iters: 300, epoch: 4 | loss: 0.6483680
	speed: 0.0443s/iter; left time: 266.9672s
	iters: 400, epoch: 4 | loss: 0.6435378
	speed: 0.0462s/iter; left time: 274.0177s
	iters: 500, epoch: 4 | loss: 0.6381339
	speed: 0.0459s/iter; left time: 267.6342s
	iters: 600, epoch: 4 | loss: 0.7057079
	speed: 0.0456s/iter; left time: 261.0397s
	iters: 700, epoch: 4 | loss: 0.6644964
	speed: 0.0454s/iter; left time: 255.6807s
	iters: 800, epoch: 4 | loss: 0.6909872
	speed: 0.0458s/iter; left time: 253.0076s
	iters: 900, epoch: 4 | loss: 0.6325614
	speed: 0.0455s/iter; left time: 246.9767s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.46s
Steps: 904 | Train Loss: 0.6791242 Vali Loss: 0.8642149 Test Loss: 1.1855516
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.5720766
	speed: 0.1116s/iter; left time: 594.5231s
	iters: 200, epoch: 5 | loss: 0.6623684
	speed: 0.0456s/iter; left time: 238.2561s
	iters: 300, epoch: 5 | loss: 0.6595019
	speed: 0.0459s/iter; left time: 235.4899s
	iters: 400, epoch: 5 | loss: 0.5994071
	speed: 0.0457s/iter; left time: 229.8026s
	iters: 500, epoch: 5 | loss: 0.6437799
	speed: 0.0443s/iter; left time: 217.9647s
	iters: 600, epoch: 5 | loss: 0.5970235
	speed: 0.0459s/iter; left time: 221.3479s
	iters: 700, epoch: 5 | loss: 0.6496777
	speed: 0.0448s/iter; left time: 211.4799s
	iters: 800, epoch: 5 | loss: 0.6190311
	speed: 0.0441s/iter; left time: 204.1163s
	iters: 900, epoch: 5 | loss: 0.5946650
	speed: 0.0453s/iter; left time: 204.8141s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:41.10s
Steps: 904 | Train Loss: 0.6301337 Vali Loss: 0.8389202 Test Loss: 1.1036042
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:1.0183629989624023, rmse:1.0091397762298584, mae:0.7146351933479309, rse:0.7147137522697449
Original data scale mse:36999436.0, rmse:6082.71630859375, mae:4040.15283203125, rse:0.30292147397994995

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.9811739325523376, RMSE: 0.9905422329902649, MAE: 0.7066802382469177, RSE: 0.7015422582626343
Unscaled Metrics - MSE: 35458704.0, RMSE: 5954.72119140625, MAE: 4002.440185546875, RSE: 0.2965472936630249

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 1.0183629989624023, RMSE: 1.0091397762298584, MAE: 0.7146351933479309, RSE: 0.7147137522697449
Unscaled Metrics - MSE: 36999436.0, RMSE: 6082.71630859375, MAE: 4040.15283203125, RSE: 0.30292147397994995

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='RMSE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.1597805
	speed: 0.0784s/iter; left time: 699.0967s
	iters: 200, epoch: 1 | loss: 1.0776324
	speed: 0.0522s/iter; left time: 460.1724s
	iters: 300, epoch: 1 | loss: 1.0184716
	speed: 0.0519s/iter; left time: 452.9948s
	iters: 400, epoch: 1 | loss: 1.0197612
	speed: 0.0524s/iter; left time: 451.5416s
	iters: 500, epoch: 1 | loss: 0.9952710
	speed: 0.0517s/iter; left time: 440.2563s
	iters: 600, epoch: 1 | loss: 1.0218533
	speed: 0.0514s/iter; left time: 432.7468s
	iters: 700, epoch: 1 | loss: 0.9886962
	speed: 0.0516s/iter; left time: 429.4332s
	iters: 800, epoch: 1 | loss: 0.9557036
	speed: 0.0519s/iter; left time: 426.8637s
	iters: 900, epoch: 1 | loss: 0.9824368
	speed: 0.0519s/iter; left time: 421.4325s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.53s
Steps: 902 | Train Loss: 1.0548297 Vali Loss: 1.2021821 Test Loss: 1.5275030
Validation loss decreased (inf --> 1.202182).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9696259
	speed: 0.1327s/iter; left time: 1063.9714s
	iters: 200, epoch: 2 | loss: 0.8894382
	speed: 0.0518s/iter; left time: 409.9993s
	iters: 300, epoch: 2 | loss: 0.9249482
	speed: 0.0519s/iter; left time: 405.8093s
	iters: 400, epoch: 2 | loss: 0.8231868
	speed: 0.0520s/iter; left time: 401.6944s
	iters: 500, epoch: 2 | loss: 0.8113850
	speed: 0.0514s/iter; left time: 391.6599s
	iters: 600, epoch: 2 | loss: 0.7634131
	speed: 0.0512s/iter; left time: 384.6349s
	iters: 700, epoch: 2 | loss: 0.7417505
	speed: 0.0507s/iter; left time: 376.4708s
	iters: 800, epoch: 2 | loss: 0.8408574
	speed: 0.0513s/iter; left time: 375.7430s
	iters: 900, epoch: 2 | loss: 0.7264004
	speed: 0.0514s/iter; left time: 371.2976s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:46.71s
Steps: 902 | Train Loss: 0.8278057 Vali Loss: 0.8287358 Test Loss: 1.0023630
Validation loss decreased (1.202182 --> 0.828736).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.8223383
	speed: 0.1334s/iter; left time: 949.5890s
	iters: 200, epoch: 3 | loss: 0.7424904
	speed: 0.0522s/iter; left time: 366.3161s
	iters: 300, epoch: 3 | loss: 0.7488179
	speed: 0.0524s/iter; left time: 362.7270s
	iters: 400, epoch: 3 | loss: 0.8077708
	speed: 0.0519s/iter; left time: 353.7450s
	iters: 500, epoch: 3 | loss: 0.7467992
	speed: 0.0516s/iter; left time: 346.7211s
	iters: 600, epoch: 3 | loss: 0.7538170
	speed: 0.0519s/iter; left time: 343.1735s
	iters: 700, epoch: 3 | loss: 0.7480911
	speed: 0.0519s/iter; left time: 338.5187s
	iters: 800, epoch: 3 | loss: 0.7563569
	speed: 0.0522s/iter; left time: 334.8233s
	iters: 900, epoch: 3 | loss: 0.7135862
	speed: 0.0518s/iter; left time: 327.4610s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.13s
Steps: 902 | Train Loss: 0.7429061 Vali Loss: 0.8434182 Test Loss: 1.0407698
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6498799
	speed: 0.1284s/iter; left time: 798.1558s
	iters: 200, epoch: 4 | loss: 0.6550081
	speed: 0.0521s/iter; left time: 318.7186s
	iters: 300, epoch: 4 | loss: 0.7204486
	speed: 0.0519s/iter; left time: 311.9968s
	iters: 400, epoch: 4 | loss: 0.6977853
	speed: 0.0520s/iter; left time: 307.3405s
	iters: 500, epoch: 4 | loss: 0.7174703
	speed: 0.0519s/iter; left time: 301.6285s
	iters: 600, epoch: 4 | loss: 0.6483393
	speed: 0.0516s/iter; left time: 294.9191s
	iters: 700, epoch: 4 | loss: 0.6750784
	speed: 0.0518s/iter; left time: 290.6142s
	iters: 800, epoch: 4 | loss: 0.6787724
	speed: 0.0520s/iter; left time: 286.7994s
	iters: 900, epoch: 4 | loss: 0.6631458
	speed: 0.0521s/iter; left time: 281.9507s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.04s
Steps: 902 | Train Loss: 0.6856844 Vali Loss: 0.8842355 Test Loss: 1.1565092
EarlyStopping counter: 2 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6685364
	speed: 0.1281s/iter; left time: 680.4461s
	iters: 200, epoch: 5 | loss: 0.6495664
	speed: 0.0519s/iter; left time: 270.7728s
	iters: 300, epoch: 5 | loss: 0.6547515
	speed: 0.0516s/iter; left time: 263.7697s
	iters: 400, epoch: 5 | loss: 0.6598015
	speed: 0.0517s/iter; left time: 259.0707s
	iters: 500, epoch: 5 | loss: 0.5628071
	speed: 0.0517s/iter; left time: 254.1160s
	iters: 600, epoch: 5 | loss: 0.6109987
	speed: 0.0513s/iter; left time: 247.1057s
	iters: 700, epoch: 5 | loss: 0.6276555
	speed: 0.0520s/iter; left time: 245.0588s
	iters: 800, epoch: 5 | loss: 0.5901897
	speed: 0.0521s/iter; left time: 240.3549s
	iters: 900, epoch: 5 | loss: 0.5495667
	speed: 0.0519s/iter; left time: 234.2279s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:46.93s
Steps: 902 | Train Loss: 0.6231554 Vali Loss: 0.9483962 Test Loss: 1.2713853
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:1.0020085573196411, rmse:1.0010037422180176, mae:0.7066735029220581, rse:0.7092510461807251
Original data scale mse:36233816.0, rmse:6019.453125, mae:3968.357177734375, rse:0.2999180853366852
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 1.2026445
	speed: 0.0547s/iter; left time: 487.5859s
	iters: 200, epoch: 1 | loss: 1.0309768
	speed: 0.0523s/iter; left time: 460.9499s
	iters: 300, epoch: 1 | loss: 0.9542477
	speed: 0.0522s/iter; left time: 455.4222s
	iters: 400, epoch: 1 | loss: 1.0180411
	speed: 0.0519s/iter; left time: 447.1310s
	iters: 500, epoch: 1 | loss: 0.9771541
	speed: 0.0463s/iter; left time: 394.5638s
	iters: 600, epoch: 1 | loss: 1.0059955
	speed: 0.0436s/iter; left time: 367.5349s
	iters: 700, epoch: 1 | loss: 1.0112431
	speed: 0.0441s/iter; left time: 366.5671s
	iters: 800, epoch: 1 | loss: 0.9444002
	speed: 0.0519s/iter; left time: 426.8207s
	iters: 900, epoch: 1 | loss: 0.9584193
	speed: 0.0448s/iter; left time: 363.9670s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:44.36s
Steps: 902 | Train Loss: 1.0506853 Vali Loss: 1.2058837 Test Loss: 1.5235751
Validation loss decreased (inf --> 1.205884).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.9619111
	speed: 0.1332s/iter; left time: 1068.2966s
	iters: 200, epoch: 2 | loss: 0.8439412
	speed: 0.0518s/iter; left time: 410.2523s
	iters: 300, epoch: 2 | loss: 0.8918315
	speed: 0.0519s/iter; left time: 405.4378s
	iters: 400, epoch: 2 | loss: 0.7360515
	speed: 0.0519s/iter; left time: 400.3437s
	iters: 500, epoch: 2 | loss: 0.8456510
	speed: 0.0521s/iter; left time: 396.6114s
	iters: 600, epoch: 2 | loss: 0.7723247
	speed: 0.0521s/iter; left time: 391.6557s
	iters: 700, epoch: 2 | loss: 0.7909253
	speed: 0.0518s/iter; left time: 384.0964s
	iters: 800, epoch: 2 | loss: 0.7493600
	speed: 0.0519s/iter; left time: 380.0647s
	iters: 900, epoch: 2 | loss: 0.7471166
	speed: 0.0519s/iter; left time: 374.5427s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.12s
Steps: 902 | Train Loss: 0.8316559 Vali Loss: 0.8782447 Test Loss: 1.0547318
Validation loss decreased (1.205884 --> 0.878245).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7576450
	speed: 0.1346s/iter; left time: 958.1664s
	iters: 200, epoch: 3 | loss: 0.7303810
	speed: 0.0516s/iter; left time: 362.0697s
	iters: 300, epoch: 3 | loss: 0.7079574
	speed: 0.0518s/iter; left time: 358.0175s
	iters: 400, epoch: 3 | loss: 0.6965265
	speed: 0.0516s/iter; left time: 351.8640s
	iters: 500, epoch: 3 | loss: 0.7316749
	speed: 0.0516s/iter; left time: 346.5653s
	iters: 600, epoch: 3 | loss: 0.7272930
	speed: 0.0518s/iter; left time: 342.9655s
	iters: 700, epoch: 3 | loss: 0.7338450
	speed: 0.0519s/iter; left time: 338.3494s
	iters: 800, epoch: 3 | loss: 0.6591452
	speed: 0.0519s/iter; left time: 333.1951s
	iters: 900, epoch: 3 | loss: 0.7306710
	speed: 0.0520s/iter; left time: 328.3374s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:46.98s
Steps: 902 | Train Loss: 0.7462477 Vali Loss: 0.9015519 Test Loss: 1.0959234
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.6607708
	speed: 0.1298s/iter; left time: 806.8887s
	iters: 200, epoch: 4 | loss: 0.7010192
	speed: 0.0520s/iter; left time: 317.8774s
	iters: 300, epoch: 4 | loss: 0.7556845
	speed: 0.0519s/iter; left time: 311.8972s
	iters: 400, epoch: 4 | loss: 0.7069370
	speed: 0.0518s/iter; left time: 306.1471s
	iters: 500, epoch: 4 | loss: 0.7312095
	speed: 0.0518s/iter; left time: 301.0192s
	iters: 600, epoch: 4 | loss: 0.7061058
	speed: 0.0520s/iter; left time: 297.0724s
	iters: 700, epoch: 4 | loss: 0.6798738
	speed: 0.0520s/iter; left time: 292.0784s
	iters: 800, epoch: 4 | loss: 0.6457863
	speed: 0.0517s/iter; left time: 285.3427s
	iters: 900, epoch: 4 | loss: 0.6939569
	speed: 0.0519s/iter; left time: 281.0403s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.07s
Steps: 902 | Train Loss: 0.6985911 Vali Loss: 0.8754300 Test Loss: 1.1640816
Validation loss decreased (0.878245 --> 0.875430).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.6912273
	speed: 0.1361s/iter; left time: 723.2921s
	iters: 200, epoch: 5 | loss: 0.6216817
	speed: 0.0519s/iter; left time: 270.5747s
	iters: 300, epoch: 5 | loss: 0.6354576
	speed: 0.0519s/iter; left time: 265.3001s
	iters: 400, epoch: 5 | loss: 0.6395905
	speed: 0.0518s/iter; left time: 259.8360s
	iters: 500, epoch: 5 | loss: 0.6315575
	speed: 0.0512s/iter; left time: 251.5504s
	iters: 600, epoch: 5 | loss: 0.6504869
	speed: 0.0522s/iter; left time: 251.0015s
	iters: 700, epoch: 5 | loss: 0.6268111
	speed: 0.0520s/iter; left time: 245.2417s
	iters: 800, epoch: 5 | loss: 0.6520101
	speed: 0.0522s/iter; left time: 240.6490s
	iters: 900, epoch: 5 | loss: 0.6499465
	speed: 0.0520s/iter; left time: 234.5247s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.10s
Steps: 902 | Train Loss: 0.6442575 Vali Loss: 0.9224558 Test Loss: 1.1791975
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.5791699
	speed: 0.1300s/iter; left time: 573.2117s
	iters: 200, epoch: 6 | loss: 0.6009138
	speed: 0.0522s/iter; left time: 224.8906s
	iters: 300, epoch: 6 | loss: 0.5816373
	speed: 0.0507s/iter; left time: 213.4653s
	iters: 400, epoch: 6 | loss: 0.6087787
	speed: 0.0536s/iter; left time: 220.3989s
	iters: 500, epoch: 6 | loss: 0.5963082
	speed: 0.0508s/iter; left time: 203.7270s
	iters: 600, epoch: 6 | loss: 0.5731124
	speed: 0.0579s/iter; left time: 226.4862s
	iters: 700, epoch: 6 | loss: 0.5906433
	speed: 0.0544s/iter; left time: 207.3537s
	iters: 800, epoch: 6 | loss: 0.5655519
	speed: 0.0582s/iter; left time: 215.9920s
	iters: 900, epoch: 6 | loss: 0.5869715
	speed: 0.0627s/iter; left time: 226.3500s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:49.69s
Steps: 902 | Train Loss: 0.5909686 Vali Loss: 0.9322640 Test Loss: 1.2514750
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.5663298
	speed: 0.1448s/iter; left time: 508.1171s
	iters: 200, epoch: 7 | loss: 0.5538169
	speed: 0.0637s/iter; left time: 217.2835s
	iters: 300, epoch: 7 | loss: 0.5630110
	speed: 0.0610s/iter; left time: 201.9066s
	iters: 400, epoch: 7 | loss: 0.5266260
	speed: 0.0601s/iter; left time: 192.7664s
	iters: 500, epoch: 7 | loss: 0.5321192
	speed: 0.0522s/iter; left time: 162.3605s
	iters: 600, epoch: 7 | loss: 0.5700552
	speed: 0.0571s/iter; left time: 171.7431s
	iters: 700, epoch: 7 | loss: 0.5503536
	speed: 0.0554s/iter; left time: 161.0423s
	iters: 800, epoch: 7 | loss: 0.5140398
	speed: 0.0521s/iter; left time: 146.2679s
	iters: 900, epoch: 7 | loss: 0.5221188
	speed: 0.0603s/iter; left time: 163.3316s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:52.54s
Steps: 902 | Train Loss: 0.5483150 Vali Loss: 0.9517448 Test Loss: 1.2345361
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossRMSE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:1.1629170179367065, rmse:1.0783863067626953, mae:0.7697740793228149, rse:0.7640796303749084
Original data scale mse:45239896.0, rmse:6726.06103515625, mae:4444.7421875, rse:0.335124671459198

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 1.0020085573196411, RMSE: 1.0010037422180176, MAE: 0.7066735029220581, RSE: 0.7092510461807251
Unscaled Metrics - MSE: 36233816.0, RMSE: 6019.453125, MAE: 3968.357177734375, RSE: 0.2999180853366852

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 1.1629170179367065, RMSE: 1.0783863067626953, MAE: 0.7697740793228149, RSE: 0.7640796303749084
Unscaled Metrics - MSE: 45239896.0, RMSE: 6726.06103515625, MAE: 4444.7421875, RSE: 0.335124671459198

=== Starting experiments for loss function: MAE ===

=== Starting experiments for pred_len: 24 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_24_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=24, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.8038437
	speed: 0.1004s/iter; left time: 899.3615s
	iters: 200, epoch: 1 | loss: 0.7331856
	speed: 0.0561s/iter; left time: 497.0153s
	iters: 300, epoch: 1 | loss: 0.6668693
	speed: 0.0594s/iter; left time: 520.3056s
	iters: 400, epoch: 1 | loss: 0.6052286
	speed: 0.0608s/iter; left time: 526.6663s
	iters: 500, epoch: 1 | loss: 0.5762401
	speed: 0.0594s/iter; left time: 508.1109s
	iters: 600, epoch: 1 | loss: 0.5280858
	speed: 0.0563s/iter; left time: 476.1159s
	iters: 700, epoch: 1 | loss: 0.6367781
	speed: 0.0532s/iter; left time: 444.9971s
	iters: 800, epoch: 1 | loss: 0.5345128
	speed: 0.0531s/iter; left time: 438.8745s
	iters: 900, epoch: 1 | loss: 0.4654481
	speed: 0.0539s/iter; left time: 439.8112s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:52.55s
Steps: 906 | Train Loss: 0.6586676 Vali Loss: 0.5799649 Test Loss: 0.6177639
Validation loss decreased (inf --> 0.579965).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.3806353
	speed: 0.1013s/iter; left time: 816.2099s
	iters: 200, epoch: 2 | loss: 0.4976635
	speed: 0.0459s/iter; left time: 365.3086s
	iters: 300, epoch: 2 | loss: 0.4148512
	speed: 0.0384s/iter; left time: 302.0064s
	iters: 400, epoch: 2 | loss: 0.4344557
	speed: 0.0385s/iter; left time: 298.9255s
	iters: 500, epoch: 2 | loss: 0.3748959
	speed: 0.0407s/iter; left time: 311.6749s
	iters: 600, epoch: 2 | loss: 0.3970804
	speed: 0.0555s/iter; left time: 419.3959s
	iters: 700, epoch: 2 | loss: 0.3858233
	speed: 0.0600s/iter; left time: 447.6419s
	iters: 800, epoch: 2 | loss: 0.4513211
	speed: 0.0411s/iter; left time: 302.6098s
	iters: 900, epoch: 2 | loss: 0.4223839
	speed: 0.0531s/iter; left time: 384.9439s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:42.00s
Steps: 906 | Train Loss: 0.4313743 Vali Loss: 0.4818961 Test Loss: 0.5209025
Validation loss decreased (0.579965 --> 0.481896).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.4001895
	speed: 0.1515s/iter; left time: 1083.0403s
	iters: 200, epoch: 3 | loss: 0.3485223
	speed: 0.0525s/iter; left time: 370.3783s
	iters: 300, epoch: 3 | loss: 0.3849287
	speed: 0.0542s/iter; left time: 376.9131s
	iters: 400, epoch: 3 | loss: 0.3873689
	speed: 0.0496s/iter; left time: 340.0454s
	iters: 500, epoch: 3 | loss: 0.4484354
	speed: 0.0519s/iter; left time: 350.2521s
	iters: 600, epoch: 3 | loss: 0.3978086
	speed: 0.0547s/iter; left time: 363.5348s
	iters: 700, epoch: 3 | loss: 0.3947946
	speed: 0.0495s/iter; left time: 324.3903s
	iters: 800, epoch: 3 | loss: 0.3718744
	speed: 0.0499s/iter; left time: 321.6247s
	iters: 900, epoch: 3 | loss: 0.3768500
	speed: 0.0450s/iter; left time: 285.8173s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.57s
Steps: 906 | Train Loss: 0.3841880 Vali Loss: 0.4787252 Test Loss: 0.5031539
Validation loss decreased (0.481896 --> 0.478725).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3181368
	speed: 0.0964s/iter; left time: 601.6552s
	iters: 200, epoch: 4 | loss: 0.3640067
	speed: 0.0440s/iter; left time: 270.4480s
	iters: 300, epoch: 4 | loss: 0.3476256
	speed: 0.0516s/iter; left time: 311.9896s
	iters: 400, epoch: 4 | loss: 0.3052091
	speed: 0.0550s/iter; left time: 326.7895s
	iters: 500, epoch: 4 | loss: 0.3968227
	speed: 0.0510s/iter; left time: 297.7681s
	iters: 600, epoch: 4 | loss: 0.3430394
	speed: 0.0487s/iter; left time: 279.9686s
	iters: 700, epoch: 4 | loss: 0.3266373
	speed: 0.0514s/iter; left time: 289.9555s
	iters: 800, epoch: 4 | loss: 0.3776953
	speed: 0.0536s/iter; left time: 297.2784s
	iters: 900, epoch: 4 | loss: 0.3536694
	speed: 0.0498s/iter; left time: 271.1077s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:45.17s
Steps: 906 | Train Loss: 0.3605863 Vali Loss: 0.4665823 Test Loss: 0.4867301
Validation loss decreased (0.478725 --> 0.466582).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3592063
	speed: 0.1260s/iter; left time: 672.5721s
	iters: 200, epoch: 5 | loss: 0.3245224
	speed: 0.0498s/iter; left time: 260.8942s
	iters: 300, epoch: 5 | loss: 0.2922925
	speed: 0.0425s/iter; left time: 218.2617s
	iters: 400, epoch: 5 | loss: 0.3647384
	speed: 0.0405s/iter; left time: 203.7749s
	iters: 500, epoch: 5 | loss: 0.3409252
	speed: 0.0404s/iter; left time: 199.6696s
	iters: 600, epoch: 5 | loss: 0.3622978
	speed: 0.0404s/iter; left time: 195.2254s
	iters: 700, epoch: 5 | loss: 0.3023126
	speed: 0.0406s/iter; left time: 192.1803s
	iters: 800, epoch: 5 | loss: 0.3503203
	speed: 0.0403s/iter; left time: 187.0426s
	iters: 900, epoch: 5 | loss: 0.3749907
	speed: 0.0404s/iter; left time: 183.4519s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:39.12s
Steps: 906 | Train Loss: 0.3384353 Vali Loss: 0.4631047 Test Loss: 0.5002678
Validation loss decreased (0.466582 --> 0.463105).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3422346
	speed: 0.0999s/iter; left time: 442.5847s
	iters: 200, epoch: 6 | loss: 0.3168294
	speed: 0.0403s/iter; left time: 174.4493s
	iters: 300, epoch: 6 | loss: 0.3110196
	speed: 0.0404s/iter; left time: 170.7465s
	iters: 400, epoch: 6 | loss: 0.3071467
	speed: 0.0402s/iter; left time: 165.9723s
	iters: 500, epoch: 6 | loss: 0.3376027
	speed: 0.0403s/iter; left time: 162.5312s
	iters: 600, epoch: 6 | loss: 0.2899701
	speed: 0.0404s/iter; left time: 158.9292s
	iters: 700, epoch: 6 | loss: 0.3309028
	speed: 0.0405s/iter; left time: 155.1538s
	iters: 800, epoch: 6 | loss: 0.3000650
	speed: 0.0406s/iter; left time: 151.5241s
	iters: 900, epoch: 6 | loss: 0.2894369
	speed: 0.0406s/iter; left time: 147.5395s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:36.91s
Steps: 906 | Train Loss: 0.3197219 Vali Loss: 0.4522893 Test Loss: 0.4907224
Validation loss decreased (0.463105 --> 0.452289).  Saving model ...
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.2799000
	speed: 0.1376s/iter; left time: 485.0964s
	iters: 200, epoch: 7 | loss: 0.3462871
	speed: 0.0591s/iter; left time: 202.4657s
	iters: 300, epoch: 7 | loss: 0.3407768
	speed: 0.0732s/iter; left time: 243.4208s
	iters: 400, epoch: 7 | loss: 0.3451464
	speed: 0.0880s/iter; left time: 283.8392s
	iters: 500, epoch: 7 | loss: 0.2957410
	speed: 0.0638s/iter; left time: 199.5225s
	iters: 600, epoch: 7 | loss: 0.3115674
	speed: 0.0529s/iter; left time: 159.9193s
	iters: 700, epoch: 7 | loss: 0.2890563
	speed: 0.0526s/iter; left time: 153.7333s
	iters: 800, epoch: 7 | loss: 0.2947488
	speed: 0.0515s/iter; left time: 145.5880s
	iters: 900, epoch: 7 | loss: 0.2953752
	speed: 0.0512s/iter; left time: 139.4021s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:55.01s
Steps: 906 | Train Loss: 0.2994021 Vali Loss: 0.4663136 Test Loss: 0.5230260
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2934699
	speed: 0.1368s/iter; left time: 358.3218s
	iters: 200, epoch: 8 | loss: 0.3107466
	speed: 0.0458s/iter; left time: 115.4616s
	iters: 300, epoch: 8 | loss: 0.2664189
	speed: 0.0405s/iter; left time: 97.9277s
	iters: 400, epoch: 8 | loss: 0.2852261
	speed: 0.0402s/iter; left time: 93.3305s
	iters: 500, epoch: 8 | loss: 0.2816809
	speed: 0.0352s/iter; left time: 78.1339s
	iters: 600, epoch: 8 | loss: 0.2598825
	speed: 0.0324s/iter; left time: 68.5632s
	iters: 700, epoch: 8 | loss: 0.2954670
	speed: 0.0404s/iter; left time: 81.5626s
	iters: 800, epoch: 8 | loss: 0.3041478
	speed: 0.0403s/iter; left time: 77.4265s
	iters: 900, epoch: 8 | loss: 0.2760029
	speed: 0.0403s/iter; left time: 73.2734s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.29s
Steps: 906 | Train Loss: 0.2797867 Vali Loss: 0.4678017 Test Loss: 0.5061944
EarlyStopping counter: 2 out of 3
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.2616944
	speed: 0.0951s/iter; left time: 162.9817s
	iters: 200, epoch: 9 | loss: 0.2545205
	speed: 0.0402s/iter; left time: 64.9160s
	iters: 300, epoch: 9 | loss: 0.2485715
	speed: 0.0405s/iter; left time: 61.2254s
	iters: 400, epoch: 9 | loss: 0.2401361
	speed: 0.0405s/iter; left time: 57.2012s
	iters: 500, epoch: 9 | loss: 0.2973980
	speed: 0.0404s/iter; left time: 53.0925s
	iters: 600, epoch: 9 | loss: 0.2592918
	speed: 0.0404s/iter; left time: 48.9770s
	iters: 700, epoch: 9 | loss: 0.2351604
	speed: 0.0404s/iter; left time: 44.9838s
	iters: 800, epoch: 9 | loss: 0.2553390
	speed: 0.0404s/iter; left time: 40.9392s
	iters: 900, epoch: 9 | loss: 0.2763037
	speed: 0.0403s/iter; left time: 36.7518s
-------------------------------------------------------------------------------------
Epoch: 9
Cost time: 00h:00m:36.83s
Steps: 906 | Train Loss: 0.2622480 Vali Loss: 0.4800941 Test Loss: 0.5121170
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.6073285341262817, rmse:0.7793128490447998, mae:0.4909898638725281, rse:0.5504329204559326
Original data scale mse:20904604.0, rmse:4572.1552734375, mae:2763.469482421875, rse:0.22733676433563232
Use GPU: cuda:0
>>>>>>>start training : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 29017
val 6217
test 6217
	iters: 100, epoch: 1 | loss: 0.8492765
	speed: 0.0427s/iter; left time: 382.2260s
	iters: 200, epoch: 1 | loss: 0.7284167
	speed: 0.0311s/iter; left time: 275.4168s
	iters: 300, epoch: 1 | loss: 0.6388370
	speed: 0.0285s/iter; left time: 250.0594s
	iters: 400, epoch: 1 | loss: 0.6862904
	speed: 0.0286s/iter; left time: 248.1356s
	iters: 500, epoch: 1 | loss: 0.5747236
	speed: 0.0286s/iter; left time: 244.9444s
	iters: 600, epoch: 1 | loss: 0.6150644
	speed: 0.0386s/iter; left time: 326.7725s
	iters: 700, epoch: 1 | loss: 0.5665997
	speed: 0.0418s/iter; left time: 349.8274s
	iters: 800, epoch: 1 | loss: 0.5225601
	speed: 0.0412s/iter; left time: 340.3682s
	iters: 900, epoch: 1 | loss: 0.4991756
	speed: 0.0407s/iter; left time: 331.8328s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:32.51s
Steps: 906 | Train Loss: 0.6660475 Vali Loss: 0.5798903 Test Loss: 0.6210235
Validation loss decreased (inf --> 0.579890).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.4622726
	speed: 0.0976s/iter; left time: 786.1051s
	iters: 200, epoch: 2 | loss: 0.5431398
	speed: 0.0407s/iter; left time: 323.8527s
	iters: 300, epoch: 2 | loss: 0.4748887
	speed: 0.0405s/iter; left time: 317.8861s
	iters: 400, epoch: 2 | loss: 0.4822165
	speed: 0.0401s/iter; left time: 310.7438s
	iters: 500, epoch: 2 | loss: 0.4401821
	speed: 0.0404s/iter; left time: 309.4916s
	iters: 600, epoch: 2 | loss: 0.3750862
	speed: 0.0404s/iter; left time: 305.5021s
	iters: 700, epoch: 2 | loss: 0.3731662
	speed: 0.0405s/iter; left time: 302.1920s
	iters: 800, epoch: 2 | loss: 0.3923979
	speed: 0.0415s/iter; left time: 304.9739s
	iters: 900, epoch: 2 | loss: 0.3896466
	speed: 0.0430s/iter; left time: 311.6413s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:37.25s
Steps: 906 | Train Loss: 0.4288170 Vali Loss: 0.4781379 Test Loss: 0.4963254
Validation loss decreased (0.579890 --> 0.478138).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.3808986
	speed: 0.0878s/iter; left time: 627.7443s
	iters: 200, epoch: 3 | loss: 0.3671446
	speed: 0.0285s/iter; left time: 201.1483s
	iters: 300, epoch: 3 | loss: 0.4167452
	speed: 0.0285s/iter; left time: 197.8621s
	iters: 400, epoch: 3 | loss: 0.4218857
	speed: 0.0288s/iter; left time: 197.5871s
	iters: 500, epoch: 3 | loss: 0.4256923
	speed: 0.0285s/iter; left time: 192.3681s
	iters: 600, epoch: 3 | loss: 0.4336916
	speed: 0.0285s/iter; left time: 189.7467s
	iters: 700, epoch: 3 | loss: 0.3920349
	speed: 0.0285s/iter; left time: 186.7531s
	iters: 800, epoch: 3 | loss: 0.3559323
	speed: 0.0343s/iter; left time: 221.1615s
	iters: 900, epoch: 3 | loss: 0.3510977
	speed: 0.0404s/iter; left time: 256.7937s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:27.98s
Steps: 906 | Train Loss: 0.3802813 Vali Loss: 0.4590129 Test Loss: 0.4866460
Validation loss decreased (0.478138 --> 0.459013).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.3369796
	speed: 0.0974s/iter; left time: 608.0425s
	iters: 200, epoch: 4 | loss: 0.3648232
	speed: 0.0403s/iter; left time: 247.6503s
	iters: 300, epoch: 4 | loss: 0.3612067
	speed: 0.0405s/iter; left time: 244.5028s
	iters: 400, epoch: 4 | loss: 0.3533951
	speed: 0.0403s/iter; left time: 239.7866s
	iters: 500, epoch: 4 | loss: 0.3980736
	speed: 0.0404s/iter; left time: 236.1724s
	iters: 600, epoch: 4 | loss: 0.3366678
	speed: 0.0404s/iter; left time: 232.2173s
	iters: 700, epoch: 4 | loss: 0.3703833
	speed: 0.0404s/iter; left time: 228.0589s
	iters: 800, epoch: 4 | loss: 0.4400032
	speed: 0.0403s/iter; left time: 223.5756s
	iters: 900, epoch: 4 | loss: 0.3993558
	speed: 0.0404s/iter; left time: 220.0145s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:36.86s
Steps: 906 | Train Loss: 0.3563971 Vali Loss: 0.4625781 Test Loss: 0.4847875
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.3194893
	speed: 0.0956s/iter; left time: 510.3629s
	iters: 200, epoch: 5 | loss: 0.3551884
	speed: 0.0404s/iter; left time: 211.7491s
	iters: 300, epoch: 5 | loss: 0.3635031
	speed: 0.0404s/iter; left time: 207.5365s
	iters: 400, epoch: 5 | loss: 0.3530314
	speed: 0.0403s/iter; left time: 202.8944s
	iters: 500, epoch: 5 | loss: 0.3442268
	speed: 0.0405s/iter; left time: 199.7943s
	iters: 600, epoch: 5 | loss: 0.2749610
	speed: 0.0404s/iter; left time: 195.6124s
	iters: 700, epoch: 5 | loss: 0.3248474
	speed: 0.0405s/iter; left time: 191.6659s
	iters: 800, epoch: 5 | loss: 0.3362274
	speed: 0.0404s/iter; left time: 187.2803s
	iters: 900, epoch: 5 | loss: 0.3126804
	speed: 0.0405s/iter; left time: 183.6196s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:36.86s
Steps: 906 | Train Loss: 0.3369792 Vali Loss: 0.4587534 Test Loss: 0.4940870
Validation loss decreased (0.459013 --> 0.458753).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3498919
	speed: 0.0980s/iter; left time: 434.3037s
	iters: 200, epoch: 6 | loss: 0.2917059
	speed: 0.0401s/iter; left time: 173.8111s
	iters: 300, epoch: 6 | loss: 0.3605081
	speed: 0.0285s/iter; left time: 120.5672s
	iters: 400, epoch: 6 | loss: 0.3259206
	speed: 0.0285s/iter; left time: 117.7179s
	iters: 500, epoch: 6 | loss: 0.3337653
	speed: 0.0287s/iter; left time: 115.5352s
	iters: 600, epoch: 6 | loss: 0.3319323
	speed: 0.0285s/iter; left time: 112.2205s
	iters: 700, epoch: 6 | loss: 0.3443570
	speed: 0.0285s/iter; left time: 109.2152s
	iters: 800, epoch: 6 | loss: 0.2996170
	speed: 0.0330s/iter; left time: 123.0813s
	iters: 900, epoch: 6 | loss: 0.2914031
	speed: 0.0406s/iter; left time: 147.3322s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:30.16s
Steps: 906 | Train Loss: 0.3178846 Vali Loss: 0.4746178 Test Loss: 0.5063152
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3092026
	speed: 0.0874s/iter; left time: 307.9248s
	iters: 200, epoch: 7 | loss: 0.3438716
	speed: 0.0405s/iter; left time: 138.6410s
	iters: 300, epoch: 7 | loss: 0.2887012
	speed: 0.0405s/iter; left time: 134.5594s
	iters: 400, epoch: 7 | loss: 0.2597434
	speed: 0.0404s/iter; left time: 130.4097s
	iters: 500, epoch: 7 | loss: 0.2902605
	speed: 0.0404s/iter; left time: 126.2260s
	iters: 600, epoch: 7 | loss: 0.2975330
	speed: 0.0405s/iter; left time: 122.4274s
	iters: 700, epoch: 7 | loss: 0.2966838
	speed: 0.0404s/iter; left time: 118.0648s
	iters: 800, epoch: 7 | loss: 0.3122207
	speed: 0.0405s/iter; left time: 114.3840s
	iters: 900, epoch: 7 | loss: 0.2848450
	speed: 0.0403s/iter; left time: 109.7057s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:36.14s
Steps: 906 | Train Loss: 0.2987776 Vali Loss: 0.4833230 Test Loss: 0.5144623
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.2940669
	speed: 0.0955s/iter; left time: 250.0562s
	iters: 200, epoch: 8 | loss: 0.2591698
	speed: 0.0415s/iter; left time: 104.4268s
	iters: 300, epoch: 8 | loss: 0.3038163
	speed: 0.0427s/iter; left time: 103.3683s
	iters: 400, epoch: 8 | loss: 0.2556615
	speed: 0.0419s/iter; left time: 97.2492s
	iters: 500, epoch: 8 | loss: 0.2543467
	speed: 0.0401s/iter; left time: 88.9877s
	iters: 600, epoch: 8 | loss: 0.2348695
	speed: 0.0404s/iter; left time: 85.6191s
	iters: 700, epoch: 8 | loss: 0.2421684
	speed: 0.0404s/iter; left time: 81.6433s
	iters: 800, epoch: 8 | loss: 0.2746622
	speed: 0.0391s/iter; left time: 74.9851s
	iters: 900, epoch: 8 | loss: 0.2660978
	speed: 0.0404s/iter; left time: 73.4568s
-------------------------------------------------------------------------------------
Epoch: 8
Cost time: 00h:00m:37.30s
Steps: 906 | Train Loss: 0.2792557 Vali Loss: 0.4761744 Test Loss: 0.5092862
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_24_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl24_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6217
Scaled mse:0.587742030620575, rmse:0.7666433453559875, mae:0.4943862855434418, rse:0.5414843559265137
Original data scale mse:19740060.0, rmse:4442.978515625, mae:2748.16845703125, rse:0.2209138572216034

Extracted Metrics for DE, pred_len=24, iteration=1:
Scaled Metrics - MSE: 0.6073285341262817, RMSE: 0.7793128490447998, MAE: 0.4909898638725281, RSE: 0.5504329204559326
Unscaled Metrics - MSE: 20904604.0, RMSE: 4572.1552734375, MAE: 2763.469482421875, RSE: 0.22733676433563232

Extracted Metrics for DE, pred_len=24, iteration=2:
Scaled Metrics - MSE: 0.587742030620575, RMSE: 0.7666433453559875, MAE: 0.4943862855434418, RSE: 0.5414843559265137
Unscaled Metrics - MSE: 19740060.0, RMSE: 4442.978515625, MAE: 2748.16845703125, RSE: 0.2209138572216034

=== Starting experiments for pred_len: 96 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_96_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=96, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8919124
	speed: 0.0749s/iter; left time: 669.4877s
	iters: 200, epoch: 1 | loss: 0.8324354
	speed: 0.0457s/iter; left time: 404.2335s
	iters: 300, epoch: 1 | loss: 0.8141674
	speed: 0.0480s/iter; left time: 419.6256s
	iters: 400, epoch: 1 | loss: 0.7697250
	speed: 0.0464s/iter; left time: 401.2993s
	iters: 500, epoch: 1 | loss: 0.7556046
	speed: 0.0460s/iter; left time: 392.4992s
	iters: 600, epoch: 1 | loss: 0.6984519
	speed: 0.0453s/iter; left time: 382.1615s
	iters: 700, epoch: 1 | loss: 0.6814703
	speed: 0.0458s/iter; left time: 382.1837s
	iters: 800, epoch: 1 | loss: 0.6835958
	speed: 0.0459s/iter; left time: 378.5773s
	iters: 900, epoch: 1 | loss: 0.6823773
	speed: 0.0373s/iter; left time: 303.4008s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:41.61s
Steps: 904 | Train Loss: 0.7880077 Vali Loss: 0.7667711 Test Loss: 0.8589951
Validation loss decreased (inf --> 0.766771).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6007543
	speed: 0.1151s/iter; left time: 925.1747s
	iters: 200, epoch: 2 | loss: 0.5920090
	speed: 0.0458s/iter; left time: 363.2637s
	iters: 300, epoch: 2 | loss: 0.5895162
	speed: 0.0457s/iter; left time: 358.2949s
	iters: 400, epoch: 2 | loss: 0.5496033
	speed: 0.0452s/iter; left time: 349.4670s
	iters: 500, epoch: 2 | loss: 0.5287231
	speed: 0.0450s/iter; left time: 343.9077s
	iters: 600, epoch: 2 | loss: 0.5544938
	speed: 0.0465s/iter; left time: 350.4680s
	iters: 700, epoch: 2 | loss: 0.5190691
	speed: 0.0464s/iter; left time: 345.0111s
	iters: 800, epoch: 2 | loss: 0.5679701
	speed: 0.0454s/iter; left time: 333.2795s
	iters: 900, epoch: 2 | loss: 0.5308801
	speed: 0.0458s/iter; left time: 331.5979s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:41.57s
Steps: 904 | Train Loss: 0.5636949 Vali Loss: 0.6220934 Test Loss: 0.6982384
Validation loss decreased (0.766771 --> 0.622093).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5593746
	speed: 0.1160s/iter; left time: 827.0972s
	iters: 200, epoch: 3 | loss: 0.4729904
	speed: 0.0460s/iter; left time: 323.6561s
	iters: 300, epoch: 3 | loss: 0.4709025
	speed: 0.0460s/iter; left time: 318.6357s
	iters: 400, epoch: 3 | loss: 0.4794918
	speed: 0.0459s/iter; left time: 313.7762s
	iters: 500, epoch: 3 | loss: 0.5166730
	speed: 0.0457s/iter; left time: 307.6262s
	iters: 600, epoch: 3 | loss: 0.5334119
	speed: 0.0467s/iter; left time: 309.7080s
	iters: 700, epoch: 3 | loss: 0.4592513
	speed: 0.0460s/iter; left time: 300.5976s
	iters: 800, epoch: 3 | loss: 0.4859753
	speed: 0.0451s/iter; left time: 290.4147s
	iters: 900, epoch: 3 | loss: 0.5000921
	speed: 0.0445s/iter; left time: 281.5503s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:41.61s
Steps: 904 | Train Loss: 0.5003692 Vali Loss: 0.6150355 Test Loss: 0.6899471
Validation loss decreased (0.622093 --> 0.615035).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4531993
	speed: 0.1157s/iter; left time: 720.7573s
	iters: 200, epoch: 4 | loss: 0.4423296
	speed: 0.0456s/iter; left time: 279.4732s
	iters: 300, epoch: 4 | loss: 0.4914958
	speed: 0.0451s/iter; left time: 271.8542s
	iters: 400, epoch: 4 | loss: 0.3985665
	speed: 0.0451s/iter; left time: 267.2948s
	iters: 500, epoch: 4 | loss: 0.4869038
	speed: 0.0462s/iter; left time: 269.4613s
	iters: 600, epoch: 4 | loss: 0.4413212
	speed: 0.0447s/iter; left time: 256.0621s
	iters: 700, epoch: 4 | loss: 0.4877134
	speed: 0.0460s/iter; left time: 258.8626s
	iters: 800, epoch: 4 | loss: 0.4514368
	speed: 0.0462s/iter; left time: 255.4036s
	iters: 900, epoch: 4 | loss: 0.4864437
	speed: 0.0459s/iter; left time: 249.3680s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:41.49s
Steps: 904 | Train Loss: 0.4716496 Vali Loss: 0.6324537 Test Loss: 0.7076868
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4167914
	speed: 0.1120s/iter; left time: 596.5740s
	iters: 200, epoch: 5 | loss: 0.4937267
	speed: 0.0461s/iter; left time: 240.7275s
	iters: 300, epoch: 5 | loss: 0.4816508
	speed: 0.0453s/iter; left time: 231.9380s
	iters: 400, epoch: 5 | loss: 0.4520880
	speed: 0.0463s/iter; left time: 232.4298s
	iters: 500, epoch: 5 | loss: 0.4180858
	speed: 0.0383s/iter; left time: 188.7436s
	iters: 600, epoch: 5 | loss: 0.4204776
	speed: 0.0374s/iter; left time: 180.4048s
	iters: 700, epoch: 5 | loss: 0.4121168
	speed: 0.0438s/iter; left time: 206.9540s
	iters: 800, epoch: 5 | loss: 0.3980674
	speed: 0.0436s/iter; left time: 201.6892s
	iters: 900, epoch: 5 | loss: 0.4155729
	speed: 0.0453s/iter; left time: 204.9787s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:39.52s
Steps: 904 | Train Loss: 0.4395470 Vali Loss: 0.6212764 Test Loss: 0.7169315
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3998491
	speed: 0.1132s/iter; left time: 500.5828s
	iters: 200, epoch: 6 | loss: 0.3812305
	speed: 0.0445s/iter; left time: 192.3408s
	iters: 300, epoch: 6 | loss: 0.4177758
	speed: 0.0382s/iter; left time: 161.3107s
	iters: 400, epoch: 6 | loss: 0.4316984
	speed: 0.0354s/iter; left time: 145.7622s
	iters: 500, epoch: 6 | loss: 0.4090197
	speed: 0.0354s/iter; left time: 142.2758s
	iters: 600, epoch: 6 | loss: 0.4382144
	speed: 0.0405s/iter; left time: 158.6164s
	iters: 700, epoch: 6 | loss: 0.3742636
	speed: 0.0462s/iter; left time: 176.3651s
	iters: 800, epoch: 6 | loss: 0.4278563
	speed: 0.0455s/iter; left time: 169.4771s
	iters: 900, epoch: 6 | loss: 0.3942557
	speed: 0.0481s/iter; left time: 174.2900s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:39.07s
Steps: 904 | Train Loss: 0.4075547 Vali Loss: 0.6228523 Test Loss: 0.6912438
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:0.9910956621170044, rmse:0.9955378770828247, mae:0.6898636221885681, rse:0.7050803303718567
Original data scale mse:35747956.0, rmse:5978.95947265625, mae:3889.906982421875, rse:0.29775434732437134
Use GPU: cuda:0
>>>>>>>start training : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28945
val 6145
test 6145
	iters: 100, epoch: 1 | loss: 0.8927611
	speed: 0.0641s/iter; left time: 572.9203s
	iters: 200, epoch: 1 | loss: 0.8466201
	speed: 0.0860s/iter; left time: 760.2348s
	iters: 300, epoch: 1 | loss: 0.7940499
	speed: 0.0877s/iter; left time: 766.6553s
	iters: 400, epoch: 1 | loss: 0.7297717
	speed: 0.1030s/iter; left time: 889.8950s
	iters: 500, epoch: 1 | loss: 0.7842326
	speed: 0.0801s/iter; left time: 684.3799s
	iters: 600, epoch: 1 | loss: 0.7523308
	speed: 0.0610s/iter; left time: 515.2929s
	iters: 700, epoch: 1 | loss: 0.6654821
	speed: 0.0536s/iter; left time: 447.4048s
	iters: 800, epoch: 1 | loss: 0.7108966
	speed: 0.0585s/iter; left time: 482.2160s
	iters: 900, epoch: 1 | loss: 0.6178483
	speed: 0.0611s/iter; left time: 497.6935s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:05.83s
Steps: 904 | Train Loss: 0.7747318 Vali Loss: 0.7504398 Test Loss: 0.8433343
Validation loss decreased (inf --> 0.750440).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6035743
	speed: 0.1657s/iter; left time: 1331.9988s
	iters: 200, epoch: 2 | loss: 0.6198358
	speed: 0.0604s/iter; left time: 479.2674s
	iters: 300, epoch: 2 | loss: 0.5474858
	speed: 0.0617s/iter; left time: 483.8834s
	iters: 400, epoch: 2 | loss: 0.5458998
	speed: 0.0622s/iter; left time: 481.2060s
	iters: 500, epoch: 2 | loss: 0.5274774
	speed: 0.0625s/iter; left time: 477.6473s
	iters: 600, epoch: 2 | loss: 0.5386297
	speed: 0.0838s/iter; left time: 631.5193s
	iters: 700, epoch: 2 | loss: 0.5303003
	speed: 0.0532s/iter; left time: 395.3059s
	iters: 800, epoch: 2 | loss: 0.6034204
	speed: 0.0522s/iter; left time: 383.0154s
	iters: 900, epoch: 2 | loss: 0.5167993
	speed: 0.0534s/iter; left time: 386.5204s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:55.63s
Steps: 904 | Train Loss: 0.5625067 Vali Loss: 0.6370009 Test Loss: 0.6860432
Validation loss decreased (0.750440 --> 0.637001).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5349829
	speed: 0.1673s/iter; left time: 1193.4916s
	iters: 200, epoch: 3 | loss: 0.5004704
	speed: 0.0600s/iter; left time: 422.1681s
	iters: 300, epoch: 3 | loss: 0.4481666
	speed: 0.0618s/iter; left time: 428.1136s
	iters: 400, epoch: 3 | loss: 0.4389992
	speed: 0.0603s/iter; left time: 412.3681s
	iters: 500, epoch: 3 | loss: 0.4448408
	speed: 0.0612s/iter; left time: 411.9247s
	iters: 600, epoch: 3 | loss: 0.5289855
	speed: 0.0713s/iter; left time: 473.2383s
	iters: 700, epoch: 3 | loss: 0.4905417
	speed: 0.0719s/iter; left time: 469.8940s
	iters: 800, epoch: 3 | loss: 0.5070170
	speed: 0.0534s/iter; left time: 343.2160s
	iters: 900, epoch: 3 | loss: 0.4762918
	speed: 0.0528s/iter; left time: 334.1544s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:56.04s
Steps: 904 | Train Loss: 0.5011570 Vali Loss: 0.6224758 Test Loss: 0.6914842
Validation loss decreased (0.637001 --> 0.622476).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4086703
	speed: 0.1628s/iter; left time: 1014.0954s
	iters: 200, epoch: 4 | loss: 0.4925497
	speed: 0.0598s/iter; left time: 366.7604s
	iters: 300, epoch: 4 | loss: 0.4522484
	speed: 0.0614s/iter; left time: 370.0021s
	iters: 400, epoch: 4 | loss: 0.4398236
	speed: 0.0611s/iter; left time: 361.9790s
	iters: 500, epoch: 4 | loss: 0.4645492
	speed: 0.0609s/iter; left time: 355.0904s
	iters: 600, epoch: 4 | loss: 0.4405809
	speed: 0.0607s/iter; left time: 347.9159s
	iters: 700, epoch: 4 | loss: 0.5104945
	speed: 0.0716s/iter; left time: 403.2990s
	iters: 800, epoch: 4 | loss: 0.4584569
	speed: 0.0605s/iter; left time: 334.4071s
	iters: 900, epoch: 4 | loss: 0.4421364
	speed: 0.0602s/iter; left time: 326.8333s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:56.15s
Steps: 904 | Train Loss: 0.4691070 Vali Loss: 0.6093934 Test Loss: 0.7021170
Validation loss decreased (0.622476 --> 0.609393).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4136518
	speed: 0.1314s/iter; left time: 699.9388s
	iters: 200, epoch: 5 | loss: 0.4773750
	speed: 0.0484s/iter; left time: 252.9264s
	iters: 300, epoch: 5 | loss: 0.4432423
	speed: 0.0480s/iter; left time: 246.1049s
	iters: 400, epoch: 5 | loss: 0.4457091
	speed: 0.0450s/iter; left time: 226.2645s
	iters: 500, epoch: 5 | loss: 0.4198727
	speed: 0.0448s/iter; left time: 220.4327s
	iters: 600, epoch: 5 | loss: 0.4442365
	speed: 0.0462s/iter; left time: 222.6841s
	iters: 700, epoch: 5 | loss: 0.4161825
	speed: 0.0489s/iter; left time: 231.1805s
	iters: 800, epoch: 5 | loss: 0.4117984
	speed: 0.0484s/iter; left time: 223.9196s
	iters: 900, epoch: 5 | loss: 0.4197798
	speed: 0.0476s/iter; left time: 215.2612s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:43.09s
Steps: 904 | Train Loss: 0.4316212 Vali Loss: 0.6144752 Test Loss: 0.6686152
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.3678614
	speed: 0.1131s/iter; left time: 500.1177s
	iters: 200, epoch: 6 | loss: 0.3921595
	speed: 0.0462s/iter; left time: 199.7979s
	iters: 300, epoch: 6 | loss: 0.4240045
	speed: 0.0374s/iter; left time: 157.8537s
	iters: 400, epoch: 6 | loss: 0.3890944
	speed: 0.0374s/iter; left time: 154.1494s
	iters: 500, epoch: 6 | loss: 0.4057988
	speed: 0.0435s/iter; left time: 175.0674s
	iters: 600, epoch: 6 | loss: 0.3996486
	speed: 0.0450s/iter; left time: 176.5766s
	iters: 700, epoch: 6 | loss: 0.3720926
	speed: 0.0459s/iter; left time: 175.3389s
	iters: 800, epoch: 6 | loss: 0.3648214
	speed: 0.0462s/iter; left time: 171.7887s
	iters: 900, epoch: 6 | loss: 0.3447641
	speed: 0.0483s/iter; left time: 174.7181s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:39.98s
Steps: 904 | Train Loss: 0.3997851 Vali Loss: 0.6333534 Test Loss: 0.7190750
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.3727855
	speed: 0.2188s/iter; left time: 769.4573s
	iters: 200, epoch: 7 | loss: 0.3649044
	speed: 0.0615s/iter; left time: 210.0802s
	iters: 300, epoch: 7 | loss: 0.3611807
	speed: 0.0609s/iter; left time: 201.8530s
	iters: 400, epoch: 7 | loss: 0.3461803
	speed: 0.0609s/iter; left time: 195.9506s
	iters: 500, epoch: 7 | loss: 0.3600289
	speed: 0.0900s/iter; left time: 280.6602s
	iters: 600, epoch: 7 | loss: 0.3702766
	speed: 0.0458s/iter; left time: 138.1269s
	iters: 700, epoch: 7 | loss: 0.3993715
	speed: 0.0467s/iter; left time: 136.2092s
	iters: 800, epoch: 7 | loss: 0.3605424
	speed: 0.0465s/iter; left time: 131.1010s
	iters: 900, epoch: 7 | loss: 0.3578334
	speed: 0.0456s/iter; left time: 123.8633s
-------------------------------------------------------------------------------------
Epoch: 7
Cost time: 00h:00m:55.46s
Steps: 904 | Train Loss: 0.3709675 Vali Loss: 0.6277240 Test Loss: 0.6991509
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_96_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl96_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6145
Scaled mse:1.0453687906265259, rmse:1.022432804107666, mae:0.7025923728942871, rse:0.7241284251213074
Original data scale mse:38837292.0, rmse:6231.95751953125, mae:4011.778076171875, rse:0.31035372614860535

Extracted Metrics for DE, pred_len=96, iteration=1:
Scaled Metrics - MSE: 0.9910956621170044, RMSE: 0.9955378770828247, MAE: 0.6898636221885681, RSE: 0.7050803303718567
Unscaled Metrics - MSE: 35747956.0, RMSE: 5978.95947265625, MAE: 3889.906982421875, RSE: 0.29775434732437134

Extracted Metrics for DE, pred_len=96, iteration=2:
Scaled Metrics - MSE: 1.0453687906265259, RMSE: 1.022432804107666, MAE: 0.7025923728942871, RSE: 0.7241284251213074
Unscaled Metrics - MSE: 38837292.0, RMSE: 6231.95751953125, MAE: 4011.778076171875, RSE: 0.31035372614860535

=== Starting experiments for pred_len: 168 ===
Args in experiment:
Namespace(random_seed=2021, is_training=1, model_id='DE_96_168_loss_choice_for_DE', model='Informer', data='custom', root_path='/vol/cs-hu/riabchuv/my_work/datasets/', data_path='DE_data.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', overlapping_windows=True, seq_len=96, label_len=5, pred_len=168, inverse=True, loss_fnc='MAE', fc_dropout=0.05, head_dropout=0.0, patch_len=16, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, embed_type=0, enc_in=5, dec_in=5, c_out=5, d_model=512, n_heads=8, e_layers=2, d_layers=1, d_ff=2048, moving_avg=25, factor=5, distil=True, dropout=0.05, embed='timeF', activation='relu', output_attention=False, do_predict=False, num_workers=10, itr=2, train_epochs=10, batch_size=32, patience=3, learning_rate=0.0001, des='Exp', lradj='type3', pct_start=0.3, use_amp=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3', test_flop=False)
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.8579770
	speed: 0.1241s/iter; left time: 1107.0365s
	iters: 200, epoch: 1 | loss: 0.8484170
	speed: 0.0996s/iter; left time: 878.8302s
	iters: 300, epoch: 1 | loss: 0.7925210
	speed: 0.1250s/iter; left time: 1090.3592s
	iters: 400, epoch: 1 | loss: 0.7956039
	speed: 0.0762s/iter; left time: 656.8506s
	iters: 500, epoch: 1 | loss: 0.7769541
	speed: 0.0729s/iter; left time: 621.1923s
	iters: 600, epoch: 1 | loss: 0.7999327
	speed: 0.0734s/iter; left time: 618.4344s
	iters: 700, epoch: 1 | loss: 0.7666406
	speed: 0.0737s/iter; left time: 613.3381s
	iters: 800, epoch: 1 | loss: 0.7408665
	speed: 0.0733s/iter; left time: 602.5973s
	iters: 900, epoch: 1 | loss: 0.7637591
	speed: 0.0734s/iter; left time: 595.7140s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:01m:17.54s
Steps: 902 | Train Loss: 0.8167503 Vali Loss: 0.8606378 Test Loss: 0.9759129
Validation loss decreased (inf --> 0.860638).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7369804
	speed: 0.1936s/iter; left time: 1552.7708s
	iters: 200, epoch: 2 | loss: 0.6751167
	speed: 0.0739s/iter; left time: 585.3967s
	iters: 300, epoch: 2 | loss: 0.6856260
	speed: 0.1000s/iter; left time: 781.5881s
	iters: 400, epoch: 2 | loss: 0.6000232
	speed: 0.0711s/iter; left time: 549.0603s
	iters: 500, epoch: 2 | loss: 0.5788766
	speed: 0.0713s/iter; left time: 543.0317s
	iters: 600, epoch: 2 | loss: 0.5458137
	speed: 0.0738s/iter; left time: 555.2354s
	iters: 700, epoch: 2 | loss: 0.5398213
	speed: 0.0713s/iter; left time: 528.7911s
	iters: 800, epoch: 2 | loss: 0.5901358
	speed: 0.0719s/iter; left time: 526.1597s
	iters: 900, epoch: 2 | loss: 0.5248378
	speed: 0.0734s/iter; left time: 529.8491s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:01m:08.46s
Steps: 902 | Train Loss: 0.6117260 Vali Loss: 0.6447060 Test Loss: 0.7072390
Validation loss decreased (0.860638 --> 0.644706).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5873076
	speed: 0.1847s/iter; left time: 1314.6752s
	iters: 200, epoch: 3 | loss: 0.5145650
	speed: 0.0881s/iter; left time: 618.1809s
	iters: 300, epoch: 3 | loss: 0.5320204
	speed: 0.0744s/iter; left time: 514.8430s
	iters: 400, epoch: 3 | loss: 0.5488604
	speed: 0.0687s/iter; left time: 468.5763s
	iters: 500, epoch: 3 | loss: 0.5163637
	speed: 0.0687s/iter; left time: 461.5991s
	iters: 600, epoch: 3 | loss: 0.5207859
	speed: 0.0693s/iter; left time: 458.4915s
	iters: 700, epoch: 3 | loss: 0.5383745
	speed: 0.0666s/iter; left time: 433.7447s
	iters: 800, epoch: 3 | loss: 0.5246914
	speed: 0.0612s/iter; left time: 393.0075s
	iters: 900, epoch: 3 | loss: 0.5088722
	speed: 0.0651s/iter; left time: 411.0046s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:01m:03.53s
Steps: 902 | Train Loss: 0.5221048 Vali Loss: 0.6266778 Test Loss: 0.7205943
Validation loss decreased (0.644706 --> 0.626678).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4567742
	speed: 0.1823s/iter; left time: 1132.8977s
	iters: 200, epoch: 4 | loss: 0.4688732
	speed: 0.0625s/iter; left time: 382.1090s
	iters: 300, epoch: 4 | loss: 0.5068307
	speed: 0.0720s/iter; left time: 433.2832s
	iters: 400, epoch: 4 | loss: 0.4870287
	speed: 0.0788s/iter; left time: 466.2195s
	iters: 500, epoch: 4 | loss: 0.5219422
	speed: 0.0716s/iter; left time: 416.5802s
	iters: 600, epoch: 4 | loss: 0.4649534
	speed: 0.0710s/iter; left time: 405.5340s
	iters: 700, epoch: 4 | loss: 0.4868213
	speed: 0.1244s/iter; left time: 698.7800s
	iters: 800, epoch: 4 | loss: 0.4953838
	speed: 0.0574s/iter; left time: 316.4977s
	iters: 900, epoch: 4 | loss: 0.4621152
	speed: 0.1558s/iter; left time: 843.7044s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:01m:16.32s
Steps: 902 | Train Loss: 0.4848371 Vali Loss: 0.6316609 Test Loss: 0.7205402
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4864957
	speed: 0.2280s/iter; left time: 1211.1912s
	iters: 200, epoch: 5 | loss: 0.4568502
	speed: 0.0671s/iter; left time: 349.7840s
	iters: 300, epoch: 5 | loss: 0.4644727
	speed: 0.0711s/iter; left time: 363.3037s
	iters: 400, epoch: 5 | loss: 0.4712815
	speed: 0.0703s/iter; left time: 352.5606s
	iters: 500, epoch: 5 | loss: 0.3933282
	speed: 0.1457s/iter; left time: 715.6109s
	iters: 600, epoch: 5 | loss: 0.4424691
	speed: 0.0969s/iter; left time: 466.1860s
	iters: 700, epoch: 5 | loss: 0.4357106
	speed: 0.0520s/iter; left time: 245.1523s
	iters: 800, epoch: 5 | loss: 0.4131833
	speed: 0.0519s/iter; left time: 239.6285s
	iters: 900, epoch: 5 | loss: 0.4138071
	speed: 0.0511s/iter; left time: 230.6288s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:01m:07.78s
Steps: 902 | Train Loss: 0.4450420 Vali Loss: 0.6581843 Test Loss: 0.7569572
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4248691
	speed: 0.1307s/iter; left time: 576.7329s
	iters: 200, epoch: 6 | loss: 0.4382971
	speed: 0.0524s/iter; left time: 225.8253s
	iters: 300, epoch: 6 | loss: 0.4023294
	speed: 0.0523s/iter; left time: 220.4414s
	iters: 400, epoch: 6 | loss: 0.4718330
	speed: 0.0522s/iter; left time: 214.5670s
	iters: 500, epoch: 6 | loss: 0.4019898
	speed: 0.0527s/iter; left time: 211.3789s
	iters: 600, epoch: 6 | loss: 0.4134818
	speed: 0.0523s/iter; left time: 204.3870s
	iters: 700, epoch: 6 | loss: 0.4222208
	speed: 0.0524s/iter; left time: 199.6871s
	iters: 800, epoch: 6 | loss: 0.3787909
	speed: 0.0521s/iter; left time: 193.4948s
	iters: 900, epoch: 6 | loss: 0.4335270
	speed: 0.0524s/iter; left time: 189.3552s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.46s
Steps: 902 | Train Loss: 0.4118419 Vali Loss: 0.6531008 Test Loss: 0.7365076
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:1.0631446838378906, rmse:1.0310890674591064, mae:0.7204919457435608, rse:0.7305676341056824
Original data scale mse:38654340.0, rmse:6217.26123046875, mae:4107.84375, rse:0.30977383255958557
Use GPU: cuda:0
>>>>>>>start training : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 28873
val 6073
test 6073
	iters: 100, epoch: 1 | loss: 0.9455371
	speed: 0.0557s/iter; left time: 496.9920s
	iters: 200, epoch: 1 | loss: 0.8029093
	speed: 0.0523s/iter; left time: 461.4043s
	iters: 300, epoch: 1 | loss: 0.7934075
	speed: 0.0524s/iter; left time: 457.0416s
	iters: 400, epoch: 1 | loss: 0.7079924
	speed: 0.0522s/iter; left time: 449.7918s
	iters: 500, epoch: 1 | loss: 0.8199793
	speed: 0.0530s/iter; left time: 451.5293s
	iters: 600, epoch: 1 | loss: 0.7637523
	speed: 0.0536s/iter; left time: 451.4203s
	iters: 700, epoch: 1 | loss: 0.7527794
	speed: 0.0539s/iter; left time: 448.1693s
	iters: 800, epoch: 1 | loss: 0.7346628
	speed: 0.0528s/iter; left time: 434.2545s
	iters: 900, epoch: 1 | loss: 0.7579607
	speed: 0.0520s/iter; left time: 422.3046s
-------------------------------------------------------------------------------------
Epoch: 1
Cost time: 00h:00m:47.97s
Steps: 902 | Train Loss: 0.8191060 Vali Loss: 0.8572268 Test Loss: 0.9773271
Validation loss decreased (inf --> 0.857227).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.6854655
	speed: 0.1350s/iter; left time: 1082.3307s
	iters: 200, epoch: 2 | loss: 0.6344528
	speed: 0.0521s/iter; left time: 412.9377s
	iters: 300, epoch: 2 | loss: 0.6081983
	speed: 0.0522s/iter; left time: 407.9031s
	iters: 400, epoch: 2 | loss: 0.5526931
	speed: 0.0523s/iter; left time: 403.3796s
	iters: 500, epoch: 2 | loss: 0.5581761
	speed: 0.0520s/iter; left time: 395.9650s
	iters: 600, epoch: 2 | loss: 0.5725591
	speed: 0.0520s/iter; left time: 390.6256s
	iters: 700, epoch: 2 | loss: 0.5632264
	speed: 0.0519s/iter; left time: 385.2600s
	iters: 800, epoch: 2 | loss: 0.4986510
	speed: 0.0520s/iter; left time: 380.3042s
	iters: 900, epoch: 2 | loss: 0.5415157
	speed: 0.0521s/iter; left time: 376.0474s
-------------------------------------------------------------------------------------
Epoch: 2
Cost time: 00h:00m:47.29s
Steps: 902 | Train Loss: 0.6152878 Vali Loss: 0.6662238 Test Loss: 0.7233377
Validation loss decreased (0.857227 --> 0.666224).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.5032926
	speed: 0.1347s/iter; left time: 958.3972s
	iters: 200, epoch: 3 | loss: 0.5536438
	speed: 0.0523s/iter; left time: 366.7371s
	iters: 300, epoch: 3 | loss: 0.5751204
	speed: 0.0520s/iter; left time: 359.8536s
	iters: 400, epoch: 3 | loss: 0.5266014
	speed: 0.0520s/iter; left time: 354.5615s
	iters: 500, epoch: 3 | loss: 0.5478982
	speed: 0.0523s/iter; left time: 351.2187s
	iters: 600, epoch: 3 | loss: 0.5121132
	speed: 0.0520s/iter; left time: 344.2894s
	iters: 700, epoch: 3 | loss: 0.5186089
	speed: 0.0520s/iter; left time: 338.8761s
	iters: 800, epoch: 3 | loss: 0.4938173
	speed: 0.0522s/iter; left time: 334.6574s
	iters: 900, epoch: 3 | loss: 0.5060926
	speed: 0.0518s/iter; left time: 327.3541s
-------------------------------------------------------------------------------------
Epoch: 3
Cost time: 00h:00m:47.28s
Steps: 902 | Train Loss: 0.5213449 Vali Loss: 0.6291911 Test Loss: 0.7105850
Validation loss decreased (0.666224 --> 0.629191).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.4907471
	speed: 0.1324s/iter; left time: 823.0228s
	iters: 200, epoch: 4 | loss: 0.4606079
	speed: 0.0522s/iter; left time: 319.2230s
	iters: 300, epoch: 4 | loss: 0.4859736
	speed: 0.0522s/iter; left time: 313.8174s
	iters: 400, epoch: 4 | loss: 0.4602063
	speed: 0.0521s/iter; left time: 308.2313s
	iters: 500, epoch: 4 | loss: 0.5056749
	speed: 0.0523s/iter; left time: 303.9470s
	iters: 600, epoch: 4 | loss: 0.5249248
	speed: 0.0522s/iter; left time: 298.2985s
	iters: 700, epoch: 4 | loss: 0.4636818
	speed: 0.0521s/iter; left time: 292.8021s
	iters: 800, epoch: 4 | loss: 0.4871118
	speed: 0.0520s/iter; left time: 286.9848s
	iters: 900, epoch: 4 | loss: 0.4664106
	speed: 0.0521s/iter; left time: 282.3224s
-------------------------------------------------------------------------------------
Epoch: 4
Cost time: 00h:00m:47.32s
Steps: 902 | Train Loss: 0.4836708 Vali Loss: 0.6383954 Test Loss: 0.7244627
EarlyStopping counter: 1 out of 3
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 0.4187244
	speed: 0.1320s/iter; left time: 701.5237s
	iters: 200, epoch: 5 | loss: 0.4512014
	speed: 0.0520s/iter; left time: 270.9465s
	iters: 300, epoch: 5 | loss: 0.4692739
	speed: 0.0518s/iter; left time: 264.9588s
	iters: 400, epoch: 5 | loss: 0.4471989
	speed: 0.0520s/iter; left time: 260.9206s
	iters: 500, epoch: 5 | loss: 0.4707272
	speed: 0.0518s/iter; left time: 254.2602s
	iters: 600, epoch: 5 | loss: 0.4202227
	speed: 0.0522s/iter; left time: 251.2950s
	iters: 700, epoch: 5 | loss: 0.4374258
	speed: 0.0518s/iter; left time: 244.0042s
	iters: 800, epoch: 5 | loss: 0.4137995
	speed: 0.0519s/iter; left time: 239.5821s
	iters: 900, epoch: 5 | loss: 0.4330456
	speed: 0.0521s/iter; left time: 235.2230s
-------------------------------------------------------------------------------------
Epoch: 5
Cost time: 00h:00m:47.17s
Steps: 902 | Train Loss: 0.4429475 Vali Loss: 0.6439341 Test Loss: 0.7584599
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.4120018
	speed: 0.1325s/iter; left time: 584.4651s
	iters: 200, epoch: 6 | loss: 0.4070293
	speed: 0.0523s/iter; left time: 225.3472s
	iters: 300, epoch: 6 | loss: 0.4301813
	speed: 0.0521s/iter; left time: 219.4349s
	iters: 400, epoch: 6 | loss: 0.4028601
	speed: 0.0520s/iter; left time: 213.8420s
	iters: 500, epoch: 6 | loss: 0.3855380
	speed: 0.0522s/iter; left time: 209.5629s
	iters: 600, epoch: 6 | loss: 0.4389481
	speed: 0.0521s/iter; left time: 203.6033s
	iters: 700, epoch: 6 | loss: 0.4260710
	speed: 0.0524s/iter; left time: 199.7571s
	iters: 800, epoch: 6 | loss: 0.3684973
	speed: 0.0523s/iter; left time: 194.1959s
	iters: 900, epoch: 6 | loss: 0.3702451
	speed: 0.0519s/iter; left time: 187.5474s
-------------------------------------------------------------------------------------
Epoch: 6
Cost time: 00h:00m:47.39s
Steps: 902 | Train Loss: 0.4091474 Vali Loss: 0.6527020 Test Loss: 0.7527001
EarlyStopping counter: 3 out of 3
Early stopping
-------------------------------------------------------------------------------------
>>>>>>>testing : DE_96_168_loss_choice_for_DE_Informer_custom_ftM_sl96_ll5_pl168_dm512_nh8_el2_dl1_df2048_fc5_ebtimeF_dtTrue_lossMAE_Exp_1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 6073
Scaled mse:1.0520626306533813, rmse:1.0257010459899902, mae:0.7103391289710999, rse:0.7267500162124634
Original data scale mse:38850424.0, rmse:6233.0107421875, mae:4030.03076171875, rse:0.3105585277080536

Extracted Metrics for DE, pred_len=168, iteration=1:
Scaled Metrics - MSE: 1.0631446838378906, RMSE: 1.0310890674591064, MAE: 0.7204919457435608, RSE: 0.7305676341056824
Unscaled Metrics - MSE: 38654340.0, RMSE: 6217.26123046875, MAE: 4107.84375, RSE: 0.30977383255958557

Extracted Metrics for DE, pred_len=168, iteration=2:
Scaled Metrics - MSE: 1.0520626306533813, RMSE: 1.0257010459899902, MAE: 0.7103391289710999, RSE: 0.7267500162124634
Unscaled Metrics - MSE: 38850424.0, RMSE: 6233.0107421875, MAE: 4030.03076171875, RSE: 0.3105585277080536
